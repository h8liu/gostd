<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/elliptic</h2>
<ul>
<li><a href="/gostd/crypto/elliptic/elliptic.go.html">elliptic.go</a></li>
<li><a href="/gostd/crypto/elliptic/elliptic_test.go.html">elliptic_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224.go.html">p224.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224_test.go.html">p224_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p256.go.html">p256.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4446497">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4446553">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4446607">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4446658">package</span>&nbsp;<span class="ident" id="4446666">elliptic</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4446676">//&nbsp;This&nbsp;is&nbsp;a&nbsp;constant-time,&nbsp;32-bit&nbsp;implementation&nbsp;of&nbsp;P224.&nbsp;See&nbsp;FIPS&nbsp;186-3,</span><br>
<span class="lineno"></span><span class="comment" id="4446751">//&nbsp;section&nbsp;D.2.2.</span><br>
<span class="lineno"></span><span class="comment" id="4446769">//</span><br>
<span class="lineno">10</span><span class="comment" id="4446772">//&nbsp;See&nbsp;http://www.imperialviolet.org/2010/12/04/ecc.html&nbsp;([1])&nbsp;for&nbsp;background.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4446852">import</span>&nbsp;<span class="op" id="4446859">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4446862">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="4446873">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="4446876">var</span>&nbsp;<span class="ident" id="4446880">p224</span>&nbsp;<span class="ident" id="4446885">p224Curve</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4446896">type</span>&nbsp;<span class="ident" id="4446901">p224Curve</span>&nbsp;<span class="keyword" id="4446911">struct</span>&nbsp;<span class="op" id="4446918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4446921">*</span><span class="ident" id="4446922">CurveParams</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4446935">gx</span><span class="op" id="4446937">,</span>&nbsp;<span class="ident" id="4446939">gy</span><span class="op" id="4446941">,</span>&nbsp;<span class="ident" id="4446943">b</span>&nbsp;<span class="ident" id="4446945">p224FieldElement</span><br>
<span class="lineno"></span><span class="op" id="4446962">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4446965">func</span>&nbsp;<span class="ident" id="4446970">initP224</span><span class="op" id="4446978">(</span><span class="op" id="4446979">)</span>&nbsp;<span class="op" id="4446981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4446984">//&nbsp;See&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.2</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447018">p224</span><span class="op" id="4447022">.</span><span class="ident" id="4447023">CurveParams</span>&nbsp;<span class="op" id="4447035">=</span>&nbsp;<span class="builtinfunc" id="4447037">new</span><span class="op" id="4447040">(</span><span class="ident" id="4447041">CurveParams</span><span class="op" id="4447052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447055">p224</span><span class="op" id="4447059">.</span><span class="ident" id="4447060">P</span><span class="op" id="4447061">,</span>&nbsp;<span class="ident" id="4447063">_</span>&nbsp;<span class="op" id="4447065">=</span>&nbsp;<span class="builtinfunc" id="4447067">new</span><span class="op" id="4447070">(</span><span class="ident" id="4447071">big</span><span class="op" id="4447074">.</span><span class="ident" id="4447075">Int</span><span class="op" id="4447078">)</span><span class="op" id="4447079">.</span><span class="ident" id="4447080">SetString</span><span class="op" id="4447089">(</span><span class="string" id="4447090">&#34;26959946667150639794667015087019630673557916260026308143510066298881&#34;</span><span class="op" id="4447160">,</span>&nbsp;<span class="num" id="4447162">10</span><span class="op" id="4447164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447167">p224</span><span class="op" id="4447171">.</span><span class="ident" id="4447172">N</span><span class="op" id="4447173">,</span>&nbsp;<span class="ident" id="4447175">_</span>&nbsp;<span class="op" id="4447177">=</span>&nbsp;<span class="builtinfunc" id="4447179">new</span><span class="op" id="4447182">(</span><span class="ident" id="4447183">big</span><span class="op" id="4447186">.</span><span class="ident" id="4447187">Int</span><span class="op" id="4447190">)</span><span class="op" id="4447191">.</span><span class="ident" id="4447192">SetString</span><span class="op" id="4447201">(</span><span class="string" id="4447202">&#34;26959946667150639794667015087019625940457807714424391721682722368061&#34;</span><span class="op" id="4447272">,</span>&nbsp;<span class="num" id="4447274">10</span><span class="op" id="4447276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447279">p224</span><span class="op" id="4447283">.</span><span class="ident" id="4447284">B</span><span class="op" id="4447285">,</span>&nbsp;<span class="ident" id="4447287">_</span>&nbsp;<span class="op" id="4447289">=</span>&nbsp;<span class="builtinfunc" id="4447291">new</span><span class="op" id="4447294">(</span><span class="ident" id="4447295">big</span><span class="op" id="4447298">.</span><span class="ident" id="4447299">Int</span><span class="op" id="4447302">)</span><span class="op" id="4447303">.</span><span class="ident" id="4447304">SetString</span><span class="op" id="4447313">(</span><span class="string" id="4447314">&#34;b4050a850c04b3abf54132565044b0b7d7bfd8ba270b39432355ffb4&#34;</span><span class="op" id="4447372">,</span>&nbsp;<span class="num" id="4447374">16</span><span class="op" id="4447376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447379">p224</span><span class="op" id="4447383">.</span><span class="ident" id="4447384">Gx</span><span class="op" id="4447386">,</span>&nbsp;<span class="ident" id="4447388">_</span>&nbsp;<span class="op" id="4447390">=</span>&nbsp;<span class="builtinfunc" id="4447392">new</span><span class="op" id="4447395">(</span><span class="ident" id="4447396">big</span><span class="op" id="4447399">.</span><span class="ident" id="4447400">Int</span><span class="op" id="4447403">)</span><span class="op" id="4447404">.</span><span class="ident" id="4447405">SetString</span><span class="op" id="4447414">(</span><span class="string" id="4447415">&#34;b70e0cbd6bb4bf7f321390b94a03c1d356c21122343280d6115c1d21&#34;</span><span class="op" id="4447473">,</span>&nbsp;<span class="num" id="4447475">16</span><span class="op" id="4447477">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447480">p224</span><span class="op" id="4447484">.</span><span class="ident" id="4447485">Gy</span><span class="op" id="4447487">,</span>&nbsp;<span class="ident" id="4447489">_</span>&nbsp;<span class="op" id="4447491">=</span>&nbsp;<span class="builtinfunc" id="4447493">new</span><span class="op" id="4447496">(</span><span class="ident" id="4447497">big</span><span class="op" id="4447500">.</span><span class="ident" id="4447501">Int</span><span class="op" id="4447504">)</span><span class="op" id="4447505">.</span><span class="ident" id="4447506">SetString</span><span class="op" id="4447515">(</span><span class="string" id="4447516">&#34;bd376388b5f723fb4c22dfe6cd4375a05a07476444d5819985007e34&#34;</span><span class="op" id="4447574">,</span>&nbsp;<span class="num" id="4447576">16</span><span class="op" id="4447578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447581">p224</span><span class="op" id="4447585">.</span><span class="ident" id="4447586">BitSize</span>&nbsp;<span class="op" id="4447594">=</span>&nbsp;<span class="num" id="4447596">224</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447602">p224FromBig</span><span class="op" id="4447613">(</span><span class="op" id="4447614">&amp;</span><span class="ident" id="4447615">p224</span><span class="op" id="4447619">.</span><span class="ident" id="4447620">gx</span><span class="op" id="4447622">,</span>&nbsp;<span class="ident" id="4447624">p224</span><span class="op" id="4447628">.</span><span class="ident" id="4447629">Gx</span><span class="op" id="4447631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447634">p224FromBig</span><span class="op" id="4447645">(</span><span class="op" id="4447646">&amp;</span><span class="ident" id="4447647">p224</span><span class="op" id="4447651">.</span><span class="ident" id="4447652">gy</span><span class="op" id="4447654">,</span>&nbsp;<span class="ident" id="4447656">p224</span><span class="op" id="4447660">.</span><span class="ident" id="4447661">Gy</span><span class="op" id="4447663">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447666">p224FromBig</span><span class="op" id="4447677">(</span><span class="op" id="4447678">&amp;</span><span class="ident" id="4447679">p224</span><span class="op" id="4447683">.</span><span class="ident" id="4447684">b</span><span class="op" id="4447685">,</span>&nbsp;<span class="ident" id="4447687">p224</span><span class="op" id="4447691">.</span><span class="ident" id="4447692">B</span><span class="op" id="4447693">)</span><br>
<span class="lineno"></span><span class="op" id="4447695">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4447698">//&nbsp;P224&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-224&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.2)</span><br>
<span class="lineno"></span><span class="keyword" id="4447777">func</span>&nbsp;<span class="ident" id="4447782">P224</span><span class="op" id="4447786">(</span><span class="op" id="4447787">)</span>&nbsp;<span class="ident" id="4447789">Curve</span>&nbsp;<span class="op" id="4447795">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447798">initonce</span><span class="op" id="4447806">.</span><span class="ident" id="4447807">Do</span><span class="op" id="4447809">(</span><span class="ident" id="4447810">initAll</span><span class="op" id="4447817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4447820">return</span>&nbsp;<span class="ident" id="4447827">p224</span><br>
<span class="lineno"></span><span class="op" id="4447832">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4447835">func</span>&nbsp;<span class="op" id="4447840">(</span><span class="ident" id="4447841">curve</span>&nbsp;<span class="ident" id="4447847">p224Curve</span><span class="op" id="4447856">)</span>&nbsp;<span class="ident" id="4447858">Params</span><span class="op" id="4447864">(</span><span class="op" id="4447865">)</span>&nbsp;<span class="op" id="4447867">*</span><span class="ident" id="4447868">CurveParams</span>&nbsp;<span class="op" id="4447880">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4447883">return</span>&nbsp;<span class="ident" id="4447890">curve</span><span class="op" id="4447895">.</span><span class="ident" id="4447896">CurveParams</span><br>
<span class="lineno"></span><span class="op" id="4447908">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4447911">func</span>&nbsp;<span class="op" id="4447916">(</span><span class="ident" id="4447917">curve</span>&nbsp;<span class="ident" id="4447923">p224Curve</span><span class="op" id="4447932">)</span>&nbsp;<span class="ident" id="4447934">IsOnCurve</span><span class="op" id="4447943">(</span><span class="ident" id="4447944">bigX</span><span class="op" id="4447948">,</span>&nbsp;<span class="ident" id="4447950">bigY</span>&nbsp;<span class="op" id="4447955">*</span><span class="ident" id="4447956">big</span><span class="op" id="4447959">.</span><span class="ident" id="4447960">Int</span><span class="op" id="4447963">)</span>&nbsp;<span class="builtintype" id="4447965">bool</span>&nbsp;<span class="op" id="4447970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4447973">var</span>&nbsp;<span class="ident" id="4447977">x</span><span class="op" id="4447978">,</span>&nbsp;<span class="ident" id="4447980">y</span>&nbsp;<span class="ident" id="4447982">p224FieldElement</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448000">p224FromBig</span><span class="op" id="4448011">(</span><span class="op" id="4448012">&amp;</span><span class="ident" id="4448013">x</span><span class="op" id="4448014">,</span>&nbsp;<span class="ident" id="4448016">bigX</span><span class="op" id="4448020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448023">p224FromBig</span><span class="op" id="4448034">(</span><span class="op" id="4448035">&amp;</span><span class="ident" id="4448036">y</span><span class="op" id="4448037">,</span>&nbsp;<span class="ident" id="4448039">bigY</span><span class="op" id="4448043">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4448047">//&nbsp;y²&nbsp;=&nbsp;x³&nbsp;-&nbsp;3x&nbsp;+&nbsp;b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4448070">var</span>&nbsp;<span class="ident" id="4448074">tmp</span>&nbsp;<span class="ident" id="4448078">p224LargeFieldElement</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4448101">var</span>&nbsp;<span class="ident" id="4448105">x3</span>&nbsp;<span class="ident" id="4448108">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448126">p224Square</span><span class="op" id="4448136">(</span><span class="op" id="4448137">&amp;</span><span class="ident" id="4448138">x3</span><span class="op" id="4448140">,</span>&nbsp;<span class="op" id="4448142">&amp;</span><span class="ident" id="4448143">x</span><span class="op" id="4448144">,</span>&nbsp;<span class="op" id="4448146">&amp;</span><span class="ident" id="4448147">tmp</span><span class="op" id="4448150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448153">p224Mul</span><span class="op" id="4448160">(</span><span class="op" id="4448161">&amp;</span><span class="ident" id="4448162">x3</span><span class="op" id="4448164">,</span>&nbsp;<span class="op" id="4448166">&amp;</span><span class="ident" id="4448167">x3</span><span class="op" id="4448169">,</span>&nbsp;<span class="op" id="4448171">&amp;</span><span class="ident" id="4448172">x</span><span class="op" id="4448173">,</span>&nbsp;<span class="op" id="4448175">&amp;</span><span class="ident" id="4448176">tmp</span><span class="op" id="4448179">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4448183">for</span>&nbsp;<span class="ident" id="4448187">i</span>&nbsp;<span class="op" id="4448189">:=</span>&nbsp;<span class="num" id="4448192">0</span><span class="op" id="4448193">;</span>&nbsp;<span class="ident" id="4448195">i</span>&nbsp;<span class="op" id="4448197">&lt;</span>&nbsp;<span class="num" id="4448199">8</span><span class="op" id="4448200">;</span>&nbsp;<span class="ident" id="4448202">i</span><span class="op" id="4448203">++</span>&nbsp;<span class="op" id="4448206">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448210">x</span><span class="op" id="4448211">[</span><span class="ident" id="4448212">i</span><span class="op" id="4448213">]</span>&nbsp;<span class="op" id="4448215">*=</span>&nbsp;<span class="num" id="4448218">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4448221">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448224">p224Sub</span><span class="op" id="4448231">(</span><span class="op" id="4448232">&amp;</span><span class="ident" id="4448233">x3</span><span class="op" id="4448235">,</span>&nbsp;<span class="op" id="4448237">&amp;</span><span class="ident" id="4448238">x3</span><span class="op" id="4448240">,</span>&nbsp;<span class="op" id="4448242">&amp;</span><span class="ident" id="4448243">x</span><span class="op" id="4448244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448247">p224Reduce</span><span class="op" id="4448257">(</span><span class="op" id="4448258">&amp;</span><span class="ident" id="4448259">x3</span><span class="op" id="4448261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448264">p224Add</span><span class="op" id="4448271">(</span><span class="op" id="4448272">&amp;</span><span class="ident" id="4448273">x3</span><span class="op" id="4448275">,</span>&nbsp;<span class="op" id="4448277">&amp;</span><span class="ident" id="4448278">x3</span><span class="op" id="4448280">,</span>&nbsp;<span class="op" id="4448282">&amp;</span><span class="ident" id="4448283">curve</span><span class="op" id="4448288">.</span><span class="ident" id="4448289">b</span><span class="op" id="4448290">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448293">p224Contract</span><span class="op" id="4448305">(</span><span class="op" id="4448306">&amp;</span><span class="ident" id="4448307">x3</span><span class="op" id="4448309">,</span>&nbsp;<span class="op" id="4448311">&amp;</span><span class="ident" id="4448312">x3</span><span class="op" id="4448314">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448318">p224Square</span><span class="op" id="4448328">(</span><span class="op" id="4448329">&amp;</span><span class="ident" id="4448330">y</span><span class="op" id="4448331">,</span>&nbsp;<span class="op" id="4448333">&amp;</span><span class="ident" id="4448334">y</span><span class="op" id="4448335">,</span>&nbsp;<span class="op" id="4448337">&amp;</span><span class="ident" id="4448338">tmp</span><span class="op" id="4448341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448344">p224Contract</span><span class="op" id="4448356">(</span><span class="op" id="4448357">&amp;</span><span class="ident" id="4448358">y</span><span class="op" id="4448359">,</span>&nbsp;<span class="op" id="4448361">&amp;</span><span class="ident" id="4448362">y</span><span class="op" id="4448363">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4448367">for</span>&nbsp;<span class="ident" id="4448371">i</span>&nbsp;<span class="op" id="4448373">:=</span>&nbsp;<span class="num" id="4448376">0</span><span class="op" id="4448377">;</span>&nbsp;<span class="ident" id="4448379">i</span>&nbsp;<span class="op" id="4448381">&lt;</span>&nbsp;<span class="num" id="4448383">8</span><span class="op" id="4448384">;</span>&nbsp;<span class="ident" id="4448386">i</span><span class="op" id="4448387">++</span>&nbsp;<span class="op" id="4448390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4448394">if</span>&nbsp;<span class="ident" id="4448397">y</span><span class="op" id="4448398">[</span><span class="ident" id="4448399">i</span><span class="op" id="4448400">]</span>&nbsp;<span class="op" id="4448402">!=</span>&nbsp;<span class="ident" id="4448405">x3</span><span class="op" id="4448407">[</span><span class="ident" id="4448408">i</span><span class="op" id="4448409">]</span>&nbsp;<span class="op" id="4448411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4448416">return</span>&nbsp;<span class="builtintype" id="4448423">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4448431">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4448434">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4448437">return</span>&nbsp;<span class="builtintype" id="4448444">true</span><br>
<span class="lineno"></span><span class="op" id="4448449">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4448452">func</span>&nbsp;<span class="op" id="4448457">(</span><span class="ident" id="4448458">p224Curve</span><span class="op" id="4448467">)</span>&nbsp;<span class="ident" id="4448469">Add</span><span class="op" id="4448472">(</span><span class="ident" id="4448473">bigX1</span><span class="op" id="4448478">,</span>&nbsp;<span class="ident" id="4448480">bigY1</span><span class="op" id="4448485">,</span>&nbsp;<span class="ident" id="4448487">bigX2</span><span class="op" id="4448492">,</span>&nbsp;<span class="ident" id="4448494">bigY2</span>&nbsp;<span class="op" id="4448500">*</span><span class="ident" id="4448501">big</span><span class="op" id="4448504">.</span><span class="ident" id="4448505">Int</span><span class="op" id="4448508">)</span>&nbsp;<span class="op" id="4448510">(</span><span class="ident" id="4448511">x</span><span class="op" id="4448512">,</span>&nbsp;<span class="ident" id="4448514">y</span>&nbsp;<span class="op" id="4448516">*</span><span class="ident" id="4448517">big</span><span class="op" id="4448520">.</span><span class="ident" id="4448521">Int</span><span class="op" id="4448524">)</span>&nbsp;<span class="op" id="4448526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4448529">var</span>&nbsp;<span class="ident" id="4448533">x1</span><span class="op" id="4448535">,</span>&nbsp;<span class="ident" id="4448537">y1</span><span class="op" id="4448539">,</span>&nbsp;<span class="ident" id="4448541">z1</span><span class="op" id="4448543">,</span>&nbsp;<span class="ident" id="4448545">x2</span><span class="op" id="4448547">,</span>&nbsp;<span class="ident" id="4448549">y2</span><span class="op" id="4448551">,</span>&nbsp;<span class="ident" id="4448553">z2</span><span class="op" id="4448555">,</span>&nbsp;<span class="ident" id="4448557">x3</span><span class="op" id="4448559">,</span>&nbsp;<span class="ident" id="4448561">y3</span><span class="op" id="4448563">,</span>&nbsp;<span class="ident" id="4448565">z3</span>&nbsp;<span class="ident" id="4448568">p224FieldElement</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448587">p224FromBig</span><span class="op" id="4448598">(</span><span class="op" id="4448599">&amp;</span><span class="ident" id="4448600">x1</span><span class="op" id="4448602">,</span>&nbsp;<span class="ident" id="4448604">bigX1</span><span class="op" id="4448609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448612">p224FromBig</span><span class="op" id="4448623">(</span><span class="op" id="4448624">&amp;</span><span class="ident" id="4448625">y1</span><span class="op" id="4448627">,</span>&nbsp;<span class="ident" id="4448629">bigY1</span><span class="op" id="4448634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4448637">if</span>&nbsp;<span class="ident" id="4448640">bigX1</span><span class="op" id="4448645">.</span><span class="ident" id="4448646">Sign</span><span class="op" id="4448650">(</span><span class="op" id="4448651">)</span>&nbsp;<span class="op" id="4448653">!=</span>&nbsp;<span class="num" id="4448656">0</span>&nbsp;<span class="op" id="4448658">||</span>&nbsp;<span class="ident" id="4448661">bigY1</span><span class="op" id="4448666">.</span><span class="ident" id="4448667">Sign</span><span class="op" id="4448671">(</span><span class="op" id="4448672">)</span>&nbsp;<span class="op" id="4448674">!=</span>&nbsp;<span class="num" id="4448677">0</span>&nbsp;<span class="op" id="4448679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448683">z1</span><span class="op" id="4448685">[</span><span class="num" id="4448686">0</span><span class="op" id="4448687">]</span>&nbsp;<span class="op" id="4448689">=</span>&nbsp;<span class="num" id="4448691">1</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4448694">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448697">p224FromBig</span><span class="op" id="4448708">(</span><span class="op" id="4448709">&amp;</span><span class="ident" id="4448710">x2</span><span class="op" id="4448712">,</span>&nbsp;<span class="ident" id="4448714">bigX2</span><span class="op" id="4448719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448722">p224FromBig</span><span class="op" id="4448733">(</span><span class="op" id="4448734">&amp;</span><span class="ident" id="4448735">y2</span><span class="op" id="4448737">,</span>&nbsp;<span class="ident" id="4448739">bigY2</span><span class="op" id="4448744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4448747">if</span>&nbsp;<span class="ident" id="4448750">bigX2</span><span class="op" id="4448755">.</span><span class="ident" id="4448756">Sign</span><span class="op" id="4448760">(</span><span class="op" id="4448761">)</span>&nbsp;<span class="op" id="4448763">!=</span>&nbsp;<span class="num" id="4448766">0</span>&nbsp;<span class="op" id="4448768">||</span>&nbsp;<span class="ident" id="4448771">bigY2</span><span class="op" id="4448776">.</span><span class="ident" id="4448777">Sign</span><span class="op" id="4448781">(</span><span class="op" id="4448782">)</span>&nbsp;<span class="op" id="4448784">!=</span>&nbsp;<span class="num" id="4448787">0</span>&nbsp;<span class="op" id="4448789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448793">z2</span><span class="op" id="4448795">[</span><span class="num" id="4448796">0</span><span class="op" id="4448797">]</span>&nbsp;<span class="op" id="4448799">=</span>&nbsp;<span class="num" id="4448801">1</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4448804">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448808">p224AddJacobian</span><span class="op" id="4448823">(</span><span class="op" id="4448824">&amp;</span><span class="ident" id="4448825">x3</span><span class="op" id="4448827">,</span>&nbsp;<span class="op" id="4448829">&amp;</span><span class="ident" id="4448830">y3</span><span class="op" id="4448832">,</span>&nbsp;<span class="op" id="4448834">&amp;</span><span class="ident" id="4448835">z3</span><span class="op" id="4448837">,</span>&nbsp;<span class="op" id="4448839">&amp;</span><span class="ident" id="4448840">x1</span><span class="op" id="4448842">,</span>&nbsp;<span class="op" id="4448844">&amp;</span><span class="ident" id="4448845">y1</span><span class="op" id="4448847">,</span>&nbsp;<span class="op" id="4448849">&amp;</span><span class="ident" id="4448850">z1</span><span class="op" id="4448852">,</span>&nbsp;<span class="op" id="4448854">&amp;</span><span class="ident" id="4448855">x2</span><span class="op" id="4448857">,</span>&nbsp;<span class="op" id="4448859">&amp;</span><span class="ident" id="4448860">y2</span><span class="op" id="4448862">,</span>&nbsp;<span class="op" id="4448864">&amp;</span><span class="ident" id="4448865">z2</span><span class="op" id="4448867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4448870">return</span>&nbsp;<span class="ident" id="4448877">p224ToAffine</span><span class="op" id="4448889">(</span><span class="op" id="4448890">&amp;</span><span class="ident" id="4448891">x3</span><span class="op" id="4448893">,</span>&nbsp;<span class="op" id="4448895">&amp;</span><span class="ident" id="4448896">y3</span><span class="op" id="4448898">,</span>&nbsp;<span class="op" id="4448900">&amp;</span><span class="ident" id="4448901">z3</span><span class="op" id="4448903">)</span><br>
<span class="lineno"></span><span class="op" id="4448905">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="4448908">func</span>&nbsp;<span class="op" id="4448913">(</span><span class="ident" id="4448914">p224Curve</span><span class="op" id="4448923">)</span>&nbsp;<span class="ident" id="4448925">Double</span><span class="op" id="4448931">(</span><span class="ident" id="4448932">bigX1</span><span class="op" id="4448937">,</span>&nbsp;<span class="ident" id="4448939">bigY1</span>&nbsp;<span class="op" id="4448945">*</span><span class="ident" id="4448946">big</span><span class="op" id="4448949">.</span><span class="ident" id="4448950">Int</span><span class="op" id="4448953">)</span>&nbsp;<span class="op" id="4448955">(</span><span class="ident" id="4448956">x</span><span class="op" id="4448957">,</span>&nbsp;<span class="ident" id="4448959">y</span>&nbsp;<span class="op" id="4448961">*</span><span class="ident" id="4448962">big</span><span class="op" id="4448965">.</span><span class="ident" id="4448966">Int</span><span class="op" id="4448969">)</span>&nbsp;<span class="op" id="4448971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4448974">var</span>&nbsp;<span class="ident" id="4448978">x1</span><span class="op" id="4448980">,</span>&nbsp;<span class="ident" id="4448982">y1</span><span class="op" id="4448984">,</span>&nbsp;<span class="ident" id="4448986">z1</span><span class="op" id="4448988">,</span>&nbsp;<span class="ident" id="4448990">x2</span><span class="op" id="4448992">,</span>&nbsp;<span class="ident" id="4448994">y2</span><span class="op" id="4448996">,</span>&nbsp;<span class="ident" id="4448998">z2</span>&nbsp;<span class="ident" id="4449001">p224FieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4449020">p224FromBig</span><span class="op" id="4449031">(</span><span class="op" id="4449032">&amp;</span><span class="ident" id="4449033">x1</span><span class="op" id="4449035">,</span>&nbsp;<span class="ident" id="4449037">bigX1</span><span class="op" id="4449042">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4449045">p224FromBig</span><span class="op" id="4449056">(</span><span class="op" id="4449057">&amp;</span><span class="ident" id="4449058">y1</span><span class="op" id="4449060">,</span>&nbsp;<span class="ident" id="4449062">bigY1</span><span class="op" id="4449067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4449070">z1</span><span class="op" id="4449072">[</span><span class="num" id="4449073">0</span><span class="op" id="4449074">]</span>&nbsp;<span class="op" id="4449076">=</span>&nbsp;<span class="num" id="4449078">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4449082">p224DoubleJacobian</span><span class="op" id="4449100">(</span><span class="op" id="4449101">&amp;</span><span class="ident" id="4449102">x2</span><span class="op" id="4449104">,</span>&nbsp;<span class="op" id="4449106">&amp;</span><span class="ident" id="4449107">y2</span><span class="op" id="4449109">,</span>&nbsp;<span class="op" id="4449111">&amp;</span><span class="ident" id="4449112">z2</span><span class="op" id="4449114">,</span>&nbsp;<span class="op" id="4449116">&amp;</span><span class="ident" id="4449117">x1</span><span class="op" id="4449119">,</span>&nbsp;<span class="op" id="4449121">&amp;</span><span class="ident" id="4449122">y1</span><span class="op" id="4449124">,</span>&nbsp;<span class="op" id="4449126">&amp;</span><span class="ident" id="4449127">z1</span><span class="op" id="4449129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4449132">return</span>&nbsp;<span class="ident" id="4449139">p224ToAffine</span><span class="op" id="4449151">(</span><span class="op" id="4449152">&amp;</span><span class="ident" id="4449153">x2</span><span class="op" id="4449155">,</span>&nbsp;<span class="op" id="4449157">&amp;</span><span class="ident" id="4449158">y2</span><span class="op" id="4449160">,</span>&nbsp;<span class="op" id="4449162">&amp;</span><span class="ident" id="4449163">z2</span><span class="op" id="4449165">)</span><br>
<span class="lineno">105</span><span class="op" id="4449167">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4449170">func</span>&nbsp;<span class="op" id="4449175">(</span><span class="ident" id="4449176">p224Curve</span><span class="op" id="4449185">)</span>&nbsp;<span class="ident" id="4449187">ScalarMult</span><span class="op" id="4449197">(</span><span class="ident" id="4449198">bigX1</span><span class="op" id="4449203">,</span>&nbsp;<span class="ident" id="4449205">bigY1</span>&nbsp;<span class="op" id="4449211">*</span><span class="ident" id="4449212">big</span><span class="op" id="4449215">.</span><span class="ident" id="4449216">Int</span><span class="op" id="4449219">,</span>&nbsp;<span class="ident" id="4449221">scalar</span>&nbsp;<span class="op" id="4449228">[</span><span class="op" id="4449229">]</span><span class="builtintype" id="4449230">byte</span><span class="op" id="4449234">)</span>&nbsp;<span class="op" id="4449236">(</span><span class="ident" id="4449237">x</span><span class="op" id="4449238">,</span>&nbsp;<span class="ident" id="4449240">y</span>&nbsp;<span class="op" id="4449242">*</span><span class="ident" id="4449243">big</span><span class="op" id="4449246">.</span><span class="ident" id="4449247">Int</span><span class="op" id="4449250">)</span>&nbsp;<span class="op" id="4449252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4449255">var</span>&nbsp;<span class="ident" id="4449259">x1</span><span class="op" id="4449261">,</span>&nbsp;<span class="ident" id="4449263">y1</span><span class="op" id="4449265">,</span>&nbsp;<span class="ident" id="4449267">z1</span><span class="op" id="4449269">,</span>&nbsp;<span class="ident" id="4449271">x2</span><span class="op" id="4449273">,</span>&nbsp;<span class="ident" id="4449275">y2</span><span class="op" id="4449277">,</span>&nbsp;<span class="ident" id="4449279">z2</span>&nbsp;<span class="ident" id="4449282">p224FieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4449301">p224FromBig</span><span class="op" id="4449312">(</span><span class="op" id="4449313">&amp;</span><span class="ident" id="4449314">x1</span><span class="op" id="4449316">,</span>&nbsp;<span class="ident" id="4449318">bigX1</span><span class="op" id="4449323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4449326">p224FromBig</span><span class="op" id="4449337">(</span><span class="op" id="4449338">&amp;</span><span class="ident" id="4449339">y1</span><span class="op" id="4449341">,</span>&nbsp;<span class="ident" id="4449343">bigY1</span><span class="op" id="4449348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4449351">z1</span><span class="op" id="4449353">[</span><span class="num" id="4449354">0</span><span class="op" id="4449355">]</span>&nbsp;<span class="op" id="4449357">=</span>&nbsp;<span class="num" id="4449359">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4449363">p224ScalarMult</span><span class="op" id="4449377">(</span><span class="op" id="4449378">&amp;</span><span class="ident" id="4449379">x2</span><span class="op" id="4449381">,</span>&nbsp;<span class="op" id="4449383">&amp;</span><span class="ident" id="4449384">y2</span><span class="op" id="4449386">,</span>&nbsp;<span class="op" id="4449388">&amp;</span><span class="ident" id="4449389">z2</span><span class="op" id="4449391">,</span>&nbsp;<span class="op" id="4449393">&amp;</span><span class="ident" id="4449394">x1</span><span class="op" id="4449396">,</span>&nbsp;<span class="op" id="4449398">&amp;</span><span class="ident" id="4449399">y1</span><span class="op" id="4449401">,</span>&nbsp;<span class="op" id="4449403">&amp;</span><span class="ident" id="4449404">z1</span><span class="op" id="4449406">,</span>&nbsp;<span class="ident" id="4449408">scalar</span><span class="op" id="4449414">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4449417">return</span>&nbsp;<span class="ident" id="4449424">p224ToAffine</span><span class="op" id="4449436">(</span><span class="op" id="4449437">&amp;</span><span class="ident" id="4449438">x2</span><span class="op" id="4449440">,</span>&nbsp;<span class="op" id="4449442">&amp;</span><span class="ident" id="4449443">y2</span><span class="op" id="4449445">,</span>&nbsp;<span class="op" id="4449447">&amp;</span><span class="ident" id="4449448">z2</span><span class="op" id="4449450">)</span><br>
<span class="lineno"></span><span class="op" id="4449452">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4449455">func</span>&nbsp;<span class="op" id="4449460">(</span><span class="ident" id="4449461">curve</span>&nbsp;<span class="ident" id="4449467">p224Curve</span><span class="op" id="4449476">)</span>&nbsp;<span class="ident" id="4449478">ScalarBaseMult</span><span class="op" id="4449492">(</span><span class="ident" id="4449493">scalar</span>&nbsp;<span class="op" id="4449500">[</span><span class="op" id="4449501">]</span><span class="builtintype" id="4449502">byte</span><span class="op" id="4449506">)</span>&nbsp;<span class="op" id="4449508">(</span><span class="ident" id="4449509">x</span><span class="op" id="4449510">,</span>&nbsp;<span class="ident" id="4449512">y</span>&nbsp;<span class="op" id="4449514">*</span><span class="ident" id="4449515">big</span><span class="op" id="4449518">.</span><span class="ident" id="4449519">Int</span><span class="op" id="4449522">)</span>&nbsp;<span class="op" id="4449524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4449527">var</span>&nbsp;<span class="ident" id="4449531">z1</span><span class="op" id="4449533">,</span>&nbsp;<span class="ident" id="4449535">x2</span><span class="op" id="4449537">,</span>&nbsp;<span class="ident" id="4449539">y2</span><span class="op" id="4449541">,</span>&nbsp;<span class="ident" id="4449543">z2</span>&nbsp;<span class="ident" id="4449546">p224FieldElement</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4449565">z1</span><span class="op" id="4449567">[</span><span class="num" id="4449568">0</span><span class="op" id="4449569">]</span>&nbsp;<span class="op" id="4449571">=</span>&nbsp;<span class="num" id="4449573">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4449576">p224ScalarMult</span><span class="op" id="4449590">(</span><span class="op" id="4449591">&amp;</span><span class="ident" id="4449592">x2</span><span class="op" id="4449594">,</span>&nbsp;<span class="op" id="4449596">&amp;</span><span class="ident" id="4449597">y2</span><span class="op" id="4449599">,</span>&nbsp;<span class="op" id="4449601">&amp;</span><span class="ident" id="4449602">z2</span><span class="op" id="4449604">,</span>&nbsp;<span class="op" id="4449606">&amp;</span><span class="ident" id="4449607">curve</span><span class="op" id="4449612">.</span><span class="ident" id="4449613">gx</span><span class="op" id="4449615">,</span>&nbsp;<span class="op" id="4449617">&amp;</span><span class="ident" id="4449618">curve</span><span class="op" id="4449623">.</span><span class="ident" id="4449624">gy</span><span class="op" id="4449626">,</span>&nbsp;<span class="op" id="4449628">&amp;</span><span class="ident" id="4449629">z1</span><span class="op" id="4449631">,</span>&nbsp;<span class="ident" id="4449633">scalar</span><span class="op" id="4449639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4449642">return</span>&nbsp;<span class="ident" id="4449649">p224ToAffine</span><span class="op" id="4449661">(</span><span class="op" id="4449662">&amp;</span><span class="ident" id="4449663">x2</span><span class="op" id="4449665">,</span>&nbsp;<span class="op" id="4449667">&amp;</span><span class="ident" id="4449668">y2</span><span class="op" id="4449670">,</span>&nbsp;<span class="op" id="4449672">&amp;</span><span class="ident" id="4449673">z2</span><span class="op" id="4449675">)</span><br>
<span class="lineno"></span><span class="op" id="4449677">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="4449680">//&nbsp;Field&nbsp;element&nbsp;functions.</span><br>
<span class="lineno"></span><span class="comment" id="4449708">//</span><br>
<span class="lineno"></span><span class="comment" id="4449711">//&nbsp;The&nbsp;field&nbsp;that&nbsp;we&#39;re&nbsp;dealing&nbsp;with&nbsp;is&nbsp;ℤ/pℤ&nbsp;where&nbsp;p&nbsp;=&nbsp;2**224&nbsp;-&nbsp;2**96&nbsp;+&nbsp;1.</span><br>
<span class="lineno"></span><span class="comment" id="4449790">//</span><br>
<span class="lineno">130</span><span class="comment" id="4449793">//&nbsp;Field&nbsp;elements&nbsp;are&nbsp;represented&nbsp;by&nbsp;a&nbsp;FieldElement,&nbsp;which&nbsp;is&nbsp;a&nbsp;typedef&nbsp;to&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="4449871">//&nbsp;array&nbsp;of&nbsp;8&nbsp;uint32&#39;s.&nbsp;The&nbsp;value&nbsp;of&nbsp;a&nbsp;FieldElement,&nbsp;a,&nbsp;is:</span><br>
<span class="lineno"></span><span class="comment" id="4449931">//&nbsp;&nbsp;&nbsp;a[0]&nbsp;+&nbsp;2**28·a[1]&nbsp;+&nbsp;2**56·a[1]&nbsp;+&nbsp;...&nbsp;+&nbsp;2**196·a[7]</span><br>
<span class="lineno"></span><span class="comment" id="4449990">//</span><br>
<span class="lineno"></span><span class="comment" id="4449993">//&nbsp;Using&nbsp;28-bit&nbsp;limbs&nbsp;means&nbsp;that&nbsp;there&#39;s&nbsp;only&nbsp;4&nbsp;bits&nbsp;of&nbsp;headroom,&nbsp;which&nbsp;is&nbsp;less</span><br>
<span class="lineno">135</span><span class="comment" id="4450073">//&nbsp;than&nbsp;we&nbsp;would&nbsp;really&nbsp;like.&nbsp;But&nbsp;it&nbsp;has&nbsp;the&nbsp;useful&nbsp;feature&nbsp;that&nbsp;we&nbsp;hit&nbsp;2**224</span><br>
<span class="lineno"></span><span class="comment" id="4450152">//&nbsp;exactly,&nbsp;making&nbsp;the&nbsp;reflections&nbsp;during&nbsp;a&nbsp;reduce&nbsp;much&nbsp;nicer.</span><br>
<span class="lineno"></span><span class="keyword" id="4450215">type</span>&nbsp;<span class="ident" id="4450220">p224FieldElement</span>&nbsp;<span class="op" id="4450237">[</span><span class="num" id="4450238">8</span><span class="op" id="4450239">]</span><span class="builtintype" id="4450240">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4450248">//&nbsp;p224P&nbsp;is&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;field,&nbsp;represented&nbsp;as&nbsp;a&nbsp;p224FieldElement.</span><br>
<span class="lineno">140</span><span class="keyword" id="4450319">var</span>&nbsp;<span class="ident" id="4450323">p224P</span>&nbsp;<span class="op" id="4450329">=</span>&nbsp;<span class="op" id="4450331">[</span><span class="num" id="4450332">8</span><span class="op" id="4450333">]</span><span class="builtintype" id="4450334">uint32</span><span class="op" id="4450340">{</span><span class="num" id="4450341">1</span><span class="op" id="4450342">,</span>&nbsp;<span class="num" id="4450344">0</span><span class="op" id="4450345">,</span>&nbsp;<span class="num" id="4450347">0</span><span class="op" id="4450348">,</span>&nbsp;<span class="num" id="4450350">0xffff000</span><span class="op" id="4450359">,</span>&nbsp;<span class="num" id="4450361">0xfffffff</span><span class="op" id="4450370">,</span>&nbsp;<span class="num" id="4450372">0xfffffff</span><span class="op" id="4450381">,</span>&nbsp;<span class="num" id="4450383">0xfffffff</span><span class="op" id="4450392">,</span>&nbsp;<span class="num" id="4450394">0xfffffff</span><span class="op" id="4450403">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4450406">//&nbsp;p224IsZero&nbsp;returns&nbsp;1&nbsp;if&nbsp;a&nbsp;==&nbsp;0&nbsp;mod&nbsp;p&nbsp;and&nbsp;0&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="comment" id="4450463">//</span><br>
<span class="lineno"></span><span class="comment" id="4450466">//&nbsp;a[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">145</span><span class="keyword" id="4450482">func</span>&nbsp;<span class="ident" id="4450487">p224IsZero</span><span class="op" id="4450497">(</span><span class="ident" id="4450498">a</span>&nbsp;<span class="op" id="4450500">*</span><span class="ident" id="4450501">p224FieldElement</span><span class="op" id="4450517">)</span>&nbsp;<span class="builtintype" id="4450519">uint32</span>&nbsp;<span class="op" id="4450526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4450529">//&nbsp;Since&nbsp;a&nbsp;p224FieldElement&nbsp;contains&nbsp;224&nbsp;bits&nbsp;there&nbsp;are&nbsp;two&nbsp;possible</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4450599">//&nbsp;representations&nbsp;of&nbsp;0:&nbsp;0&nbsp;and&nbsp;p.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4450634">var</span>&nbsp;<span class="ident" id="4450638">minimal</span>&nbsp;<span class="ident" id="4450646">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4450664">p224Contract</span><span class="op" id="4450676">(</span><span class="op" id="4450677">&amp;</span><span class="ident" id="4450678">minimal</span><span class="op" id="4450685">,</span>&nbsp;<span class="ident" id="4450687">a</span><span class="op" id="4450688">)</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4450692">var</span>&nbsp;<span class="ident" id="4450696">isZero</span><span class="op" id="4450702">,</span>&nbsp;<span class="ident" id="4450704">isP</span>&nbsp;<span class="builtintype" id="4450708">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4450716">for</span>&nbsp;<span class="ident" id="4450720">i</span><span class="op" id="4450721">,</span>&nbsp;<span class="ident" id="4450723">v</span>&nbsp;<span class="op" id="4450725">:=</span>&nbsp;<span class="keyword" id="4450728">range</span>&nbsp;<span class="ident" id="4450734">minimal</span>&nbsp;<span class="op" id="4450742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4450746">isZero</span>&nbsp;<span class="op" id="4450753">|=</span>&nbsp;<span class="ident" id="4450756">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4450760">isP</span>&nbsp;<span class="op" id="4450764">|=</span>&nbsp;<span class="ident" id="4450767">v</span>&nbsp;<span class="op" id="4450769">-</span>&nbsp;<span class="ident" id="4450771">p224P</span><span class="op" id="4450776">[</span><span class="ident" id="4450777">i</span><span class="op" id="4450778">]</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4450781">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4450785">//&nbsp;If&nbsp;either&nbsp;isZero&nbsp;or&nbsp;isP&nbsp;is&nbsp;0,&nbsp;then&nbsp;we&nbsp;should&nbsp;return&nbsp;1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4450844">isZero</span>&nbsp;<span class="op" id="4450851">|=</span>&nbsp;<span class="ident" id="4450854">isZero</span>&nbsp;<span class="op" id="4450861">&gt;&gt;</span>&nbsp;<span class="num" id="4450864">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4450868">isZero</span>&nbsp;<span class="op" id="4450875">|=</span>&nbsp;<span class="ident" id="4450878">isZero</span>&nbsp;<span class="op" id="4450885">&gt;&gt;</span>&nbsp;<span class="num" id="4450888">8</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4450891">isZero</span>&nbsp;<span class="op" id="4450898">|=</span>&nbsp;<span class="ident" id="4450901">isZero</span>&nbsp;<span class="op" id="4450908">&gt;&gt;</span>&nbsp;<span class="num" id="4450911">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4450914">isZero</span>&nbsp;<span class="op" id="4450921">|=</span>&nbsp;<span class="ident" id="4450924">isZero</span>&nbsp;<span class="op" id="4450931">&gt;&gt;</span>&nbsp;<span class="num" id="4450934">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4450937">isZero</span>&nbsp;<span class="op" id="4450944">|=</span>&nbsp;<span class="ident" id="4450947">isZero</span>&nbsp;<span class="op" id="4450954">&gt;&gt;</span>&nbsp;<span class="num" id="4450957">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4450961">isP</span>&nbsp;<span class="op" id="4450965">|=</span>&nbsp;<span class="ident" id="4450968">isP</span>&nbsp;<span class="op" id="4450972">&gt;&gt;</span>&nbsp;<span class="num" id="4450975">16</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4450979">isP</span>&nbsp;<span class="op" id="4450983">|=</span>&nbsp;<span class="ident" id="4450986">isP</span>&nbsp;<span class="op" id="4450990">&gt;&gt;</span>&nbsp;<span class="num" id="4450993">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4450996">isP</span>&nbsp;<span class="op" id="4451000">|=</span>&nbsp;<span class="ident" id="4451003">isP</span>&nbsp;<span class="op" id="4451007">&gt;&gt;</span>&nbsp;<span class="num" id="4451010">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4451013">isP</span>&nbsp;<span class="op" id="4451017">|=</span>&nbsp;<span class="ident" id="4451020">isP</span>&nbsp;<span class="op" id="4451024">&gt;&gt;</span>&nbsp;<span class="num" id="4451027">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4451030">isP</span>&nbsp;<span class="op" id="4451034">|=</span>&nbsp;<span class="ident" id="4451037">isP</span>&nbsp;<span class="op" id="4451041">&gt;&gt;</span>&nbsp;<span class="num" id="4451044">1</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4451048">//&nbsp;For&nbsp;isZero&nbsp;and&nbsp;isP,&nbsp;the&nbsp;LSB&nbsp;is&nbsp;0&nbsp;iff&nbsp;all&nbsp;the&nbsp;bits&nbsp;are&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4451112">result</span>&nbsp;<span class="op" id="4451119">:=</span>&nbsp;<span class="ident" id="4451122">isZero</span>&nbsp;<span class="op" id="4451129">&amp;</span>&nbsp;<span class="ident" id="4451131">isP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4451136">result</span>&nbsp;<span class="op" id="4451143">=</span>&nbsp;<span class="op" id="4451145">(</span><span class="op" id="4451146">^</span><span class="ident" id="4451147">result</span><span class="op" id="4451153">)</span>&nbsp;<span class="op" id="4451155">&amp;</span>&nbsp;<span class="num" id="4451157">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4451161">return</span>&nbsp;<span class="ident" id="4451168">result</span><br>
<span class="lineno">175</span><span class="op" id="4451175">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4451178">//&nbsp;p224Add&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a+b</span><br>
<span class="lineno"></span><span class="comment" id="4451209">//</span><br>
<span class="lineno"></span><span class="comment" id="4451212">//&nbsp;a[i]&nbsp;+&nbsp;b[i]&nbsp;&lt;&nbsp;2**32</span><br>
<span class="lineno">180</span><span class="keyword" id="4451235">func</span>&nbsp;<span class="ident" id="4451240">p224Add</span><span class="op" id="4451247">(</span><span class="ident" id="4451248">out</span><span class="op" id="4451251">,</span>&nbsp;<span class="ident" id="4451253">a</span><span class="op" id="4451254">,</span>&nbsp;<span class="ident" id="4451256">b</span>&nbsp;<span class="op" id="4451258">*</span><span class="ident" id="4451259">p224FieldElement</span><span class="op" id="4451275">)</span>&nbsp;<span class="op" id="4451277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4451280">for</span>&nbsp;<span class="ident" id="4451284">i</span>&nbsp;<span class="op" id="4451286">:=</span>&nbsp;<span class="num" id="4451289">0</span><span class="op" id="4451290">;</span>&nbsp;<span class="ident" id="4451292">i</span>&nbsp;<span class="op" id="4451294">&lt;</span>&nbsp;<span class="num" id="4451296">8</span><span class="op" id="4451297">;</span>&nbsp;<span class="ident" id="4451299">i</span><span class="op" id="4451300">++</span>&nbsp;<span class="op" id="4451303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4451307">out</span><span class="op" id="4451310">[</span><span class="ident" id="4451311">i</span><span class="op" id="4451312">]</span>&nbsp;<span class="op" id="4451314">=</span>&nbsp;<span class="ident" id="4451316">a</span><span class="op" id="4451317">[</span><span class="ident" id="4451318">i</span><span class="op" id="4451319">]</span>&nbsp;<span class="op" id="4451321">+</span>&nbsp;<span class="ident" id="4451323">b</span><span class="op" id="4451324">[</span><span class="ident" id="4451325">i</span><span class="op" id="4451326">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4451329">}</span><br>
<span class="lineno"></span><span class="op" id="4451331">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="4451334">const</span>&nbsp;<span class="ident" id="4451340">two31p3</span>&nbsp;<span class="op" id="4451348">=</span>&nbsp;<span class="num" id="4451350">1</span><span class="op" id="4451351">&lt;&lt;</span><span class="num" id="4451353">31</span>&nbsp;<span class="op" id="4451356">+</span>&nbsp;<span class="num" id="4451358">1</span><span class="op" id="4451359">&lt;&lt;</span><span class="num" id="4451361">3</span><br>
<span class="lineno"></span><span class="keyword" id="4451363">const</span>&nbsp;<span class="ident" id="4451369">two31m3</span>&nbsp;<span class="op" id="4451377">=</span>&nbsp;<span class="num" id="4451379">1</span><span class="op" id="4451380">&lt;&lt;</span><span class="num" id="4451382">31</span>&nbsp;<span class="op" id="4451385">-</span>&nbsp;<span class="num" id="4451387">1</span><span class="op" id="4451388">&lt;&lt;</span><span class="num" id="4451390">3</span><br>
<span class="lineno"></span><span class="keyword" id="4451392">const</span>&nbsp;<span class="ident" id="4451398">two31m15m3</span>&nbsp;<span class="op" id="4451409">=</span>&nbsp;<span class="num" id="4451411">1</span><span class="op" id="4451412">&lt;&lt;</span><span class="num" id="4451414">31</span>&nbsp;<span class="op" id="4451417">-</span>&nbsp;<span class="num" id="4451419">1</span><span class="op" id="4451420">&lt;&lt;</span><span class="num" id="4451422">15</span>&nbsp;<span class="op" id="4451425">-</span>&nbsp;<span class="num" id="4451427">1</span><span class="op" id="4451428">&lt;&lt;</span><span class="num" id="4451430">3</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="comment" id="4451433">//&nbsp;p224ZeroModP31&nbsp;is&nbsp;0&nbsp;mod&nbsp;p&nbsp;where&nbsp;bit&nbsp;31&nbsp;is&nbsp;set&nbsp;in&nbsp;all&nbsp;limbs&nbsp;so&nbsp;that&nbsp;we&nbsp;can</span><br>
<span class="lineno"></span><span class="comment" id="4451510">//&nbsp;subtract&nbsp;smaller&nbsp;amounts&nbsp;without&nbsp;underflow.&nbsp;See&nbsp;the&nbsp;section&nbsp;&#34;Subtraction&#34;&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4451590">//&nbsp;[1]&nbsp;for&nbsp;reasoning.</span><br>
<span class="lineno"></span><span class="keyword" id="4451612">var</span>&nbsp;<span class="ident" id="4451616">p224ZeroModP31</span>&nbsp;<span class="op" id="4451631">=</span>&nbsp;<span class="op" id="4451633">[</span><span class="op" id="4451634">]</span><span class="builtintype" id="4451635">uint32</span><span class="op" id="4451641">{</span><span class="ident" id="4451642">two31p3</span><span class="op" id="4451649">,</span>&nbsp;<span class="ident" id="4451651">two31m3</span><span class="op" id="4451658">,</span>&nbsp;<span class="ident" id="4451660">two31m3</span><span class="op" id="4451667">,</span>&nbsp;<span class="ident" id="4451669">two31m15m3</span><span class="op" id="4451679">,</span>&nbsp;<span class="ident" id="4451681">two31m3</span><span class="op" id="4451688">,</span>&nbsp;<span class="ident" id="4451690">two31m3</span><span class="op" id="4451697">,</span>&nbsp;<span class="ident" id="4451699">two31m3</span><span class="op" id="4451706">,</span>&nbsp;<span class="ident" id="4451708">two31m3</span><span class="op" id="4451715">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span><span class="comment" id="4451718">//&nbsp;p224Sub&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a-b</span><br>
<span class="lineno"></span><span class="comment" id="4451749">//</span><br>
<span class="lineno"></span><span class="comment" id="4451752">//&nbsp;a[i],&nbsp;b[i]&nbsp;&lt;&nbsp;2**30</span><br>
<span class="lineno"></span><span class="comment" id="4451774">//&nbsp;out[i]&nbsp;&lt;&nbsp;2**32</span><br>
<span class="lineno"></span><span class="keyword" id="4451792">func</span>&nbsp;<span class="ident" id="4451797">p224Sub</span><span class="op" id="4451804">(</span><span class="ident" id="4451805">out</span><span class="op" id="4451808">,</span>&nbsp;<span class="ident" id="4451810">a</span><span class="op" id="4451811">,</span>&nbsp;<span class="ident" id="4451813">b</span>&nbsp;<span class="op" id="4451815">*</span><span class="ident" id="4451816">p224FieldElement</span><span class="op" id="4451832">)</span>&nbsp;<span class="op" id="4451834">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4451837">for</span>&nbsp;<span class="ident" id="4451841">i</span>&nbsp;<span class="op" id="4451843">:=</span>&nbsp;<span class="num" id="4451846">0</span><span class="op" id="4451847">;</span>&nbsp;<span class="ident" id="4451849">i</span>&nbsp;<span class="op" id="4451851">&lt;</span>&nbsp;<span class="num" id="4451853">8</span><span class="op" id="4451854">;</span>&nbsp;<span class="ident" id="4451856">i</span><span class="op" id="4451857">++</span>&nbsp;<span class="op" id="4451860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4451864">out</span><span class="op" id="4451867">[</span><span class="ident" id="4451868">i</span><span class="op" id="4451869">]</span>&nbsp;<span class="op" id="4451871">=</span>&nbsp;<span class="ident" id="4451873">a</span><span class="op" id="4451874">[</span><span class="ident" id="4451875">i</span><span class="op" id="4451876">]</span>&nbsp;<span class="op" id="4451878">+</span>&nbsp;<span class="ident" id="4451880">p224ZeroModP31</span><span class="op" id="4451894">[</span><span class="ident" id="4451895">i</span><span class="op" id="4451896">]</span>&nbsp;<span class="op" id="4451898">-</span>&nbsp;<span class="ident" id="4451900">b</span><span class="op" id="4451901">[</span><span class="ident" id="4451902">i</span><span class="op" id="4451903">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4451906">}</span><br>
<span class="lineno"></span><span class="op" id="4451908">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="comment" id="4451911">//&nbsp;LargeFieldElement&nbsp;also&nbsp;represents&nbsp;an&nbsp;element&nbsp;of&nbsp;the&nbsp;field.&nbsp;The&nbsp;limbs&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="4451987">//&nbsp;still&nbsp;spaced&nbsp;28-bits&nbsp;apart&nbsp;and&nbsp;in&nbsp;little-endian&nbsp;order.&nbsp;So&nbsp;the&nbsp;limbs&nbsp;are&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="4452065">//&nbsp;0,&nbsp;28,&nbsp;56,&nbsp;...,&nbsp;392&nbsp;bits,&nbsp;each&nbsp;64-bits&nbsp;wide.</span><br>
<span class="lineno"></span><span class="keyword" id="4452113">type</span>&nbsp;<span class="ident" id="4452118">p224LargeFieldElement</span>&nbsp;<span class="op" id="4452140">[</span><span class="num" id="4452141">15</span><span class="op" id="4452143">]</span><span class="ident" id="4452144">uint64</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span><span class="keyword" id="4452152">const</span>&nbsp;<span class="ident" id="4452158">two63p35</span>&nbsp;<span class="op" id="4452167">=</span>&nbsp;<span class="num" id="4452169">1</span><span class="op" id="4452170">&lt;&lt;</span><span class="num" id="4452172">63</span>&nbsp;<span class="op" id="4452175">+</span>&nbsp;<span class="num" id="4452177">1</span><span class="op" id="4452178">&lt;&lt;</span><span class="num" id="4452180">35</span><br>
<span class="lineno"></span><span class="keyword" id="4452183">const</span>&nbsp;<span class="ident" id="4452189">two63m35</span>&nbsp;<span class="op" id="4452198">=</span>&nbsp;<span class="num" id="4452200">1</span><span class="op" id="4452201">&lt;&lt;</span><span class="num" id="4452203">63</span>&nbsp;<span class="op" id="4452206">-</span>&nbsp;<span class="num" id="4452208">1</span><span class="op" id="4452209">&lt;&lt;</span><span class="num" id="4452211">35</span><br>
<span class="lineno"></span><span class="keyword" id="4452214">const</span>&nbsp;<span class="ident" id="4452220">two63m35m19</span>&nbsp;<span class="op" id="4452232">=</span>&nbsp;<span class="num" id="4452234">1</span><span class="op" id="4452235">&lt;&lt;</span><span class="num" id="4452237">63</span>&nbsp;<span class="op" id="4452240">-</span>&nbsp;<span class="num" id="4452242">1</span><span class="op" id="4452243">&lt;&lt;</span><span class="num" id="4452245">35</span>&nbsp;<span class="op" id="4452248">-</span>&nbsp;<span class="num" id="4452250">1</span><span class="op" id="4452251">&lt;&lt;</span><span class="num" id="4452253">19</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4452257">//&nbsp;p224ZeroModP63&nbsp;is&nbsp;0&nbsp;mod&nbsp;p&nbsp;where&nbsp;bit&nbsp;63&nbsp;is&nbsp;set&nbsp;in&nbsp;all&nbsp;limbs.&nbsp;See&nbsp;the&nbsp;section</span><br>
<span class="lineno">215</span><span class="comment" id="4452336">//&nbsp;&#34;Subtraction&#34;&nbsp;in&nbsp;[1]&nbsp;for&nbsp;why.</span><br>
<span class="lineno"></span><span class="keyword" id="4452369">var</span>&nbsp;<span class="ident" id="4452373">p224ZeroModP63</span>&nbsp;<span class="op" id="4452388">=</span>&nbsp;<span class="op" id="4452390">[</span><span class="num" id="4452391">8</span><span class="op" id="4452392">]</span><span class="ident" id="4452393">uint64</span><span class="op" id="4452399">{</span><span class="ident" id="4452400">two63p35</span><span class="op" id="4452408">,</span>&nbsp;<span class="ident" id="4452410">two63m35</span><span class="op" id="4452418">,</span>&nbsp;<span class="ident" id="4452420">two63m35</span><span class="op" id="4452428">,</span>&nbsp;<span class="ident" id="4452430">two63m35</span><span class="op" id="4452438">,</span>&nbsp;<span class="ident" id="4452440">two63m35m19</span><span class="op" id="4452451">,</span>&nbsp;<span class="ident" id="4452453">two63m35</span><span class="op" id="4452461">,</span>&nbsp;<span class="ident" id="4452463">two63m35</span><span class="op" id="4452471">,</span>&nbsp;<span class="ident" id="4452473">two63m35</span><span class="op" id="4452481">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4452484">const</span>&nbsp;<span class="ident" id="4452490">bottom12Bits</span>&nbsp;<span class="op" id="4452503">=</span>&nbsp;<span class="num" id="4452505">0xfff</span><br>
<span class="lineno"></span><span class="keyword" id="4452511">const</span>&nbsp;<span class="ident" id="4452517">bottom28Bits</span>&nbsp;<span class="op" id="4452530">=</span>&nbsp;<span class="num" id="4452532">0xfffffff</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="comment" id="4452543">//&nbsp;p224Mul&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a*b</span><br>
<span class="lineno"></span><span class="comment" id="4452574">//</span><br>
<span class="lineno"></span><span class="comment" id="4452577">//&nbsp;a[i]&nbsp;&lt;&nbsp;2**29,&nbsp;b[i]&nbsp;&lt;&nbsp;2**30&nbsp;(or&nbsp;vice&nbsp;versa)</span><br>
<span class="lineno"></span><span class="comment" id="4452623">//&nbsp;out[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">225</span><span class="keyword" id="4452641">func</span>&nbsp;<span class="ident" id="4452646">p224Mul</span><span class="op" id="4452653">(</span><span class="ident" id="4452654">out</span><span class="op" id="4452657">,</span>&nbsp;<span class="ident" id="4452659">a</span><span class="op" id="4452660">,</span>&nbsp;<span class="ident" id="4452662">b</span>&nbsp;<span class="op" id="4452664">*</span><span class="ident" id="4452665">p224FieldElement</span><span class="op" id="4452681">,</span>&nbsp;<span class="ident" id="4452683">tmp</span>&nbsp;<span class="op" id="4452687">*</span><span class="ident" id="4452688">p224LargeFieldElement</span><span class="op" id="4452709">)</span>&nbsp;<span class="op" id="4452711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4452714">for</span>&nbsp;<span class="ident" id="4452718">i</span>&nbsp;<span class="op" id="4452720">:=</span>&nbsp;<span class="num" id="4452723">0</span><span class="op" id="4452724">;</span>&nbsp;<span class="ident" id="4452726">i</span>&nbsp;<span class="op" id="4452728">&lt;</span>&nbsp;<span class="num" id="4452730">15</span><span class="op" id="4452732">;</span>&nbsp;<span class="ident" id="4452734">i</span><span class="op" id="4452735">++</span>&nbsp;<span class="op" id="4452738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4452742">tmp</span><span class="op" id="4452745">[</span><span class="ident" id="4452746">i</span><span class="op" id="4452747">]</span>&nbsp;<span class="op" id="4452749">=</span>&nbsp;<span class="num" id="4452751">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4452754">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4452758">for</span>&nbsp;<span class="ident" id="4452762">i</span>&nbsp;<span class="op" id="4452764">:=</span>&nbsp;<span class="num" id="4452767">0</span><span class="op" id="4452768">;</span>&nbsp;<span class="ident" id="4452770">i</span>&nbsp;<span class="op" id="4452772">&lt;</span>&nbsp;<span class="num" id="4452774">8</span><span class="op" id="4452775">;</span>&nbsp;<span class="ident" id="4452777">i</span><span class="op" id="4452778">++</span>&nbsp;<span class="op" id="4452781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4452785">for</span>&nbsp;<span class="ident" id="4452789">j</span>&nbsp;<span class="op" id="4452791">:=</span>&nbsp;<span class="num" id="4452794">0</span><span class="op" id="4452795">;</span>&nbsp;<span class="ident" id="4452797">j</span>&nbsp;<span class="op" id="4452799">&lt;</span>&nbsp;<span class="num" id="4452801">8</span><span class="op" id="4452802">;</span>&nbsp;<span class="ident" id="4452804">j</span><span class="op" id="4452805">++</span>&nbsp;<span class="op" id="4452808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4452813">tmp</span><span class="op" id="4452816">[</span><span class="ident" id="4452817">i</span><span class="op" id="4452818">+</span><span class="ident" id="4452819">j</span><span class="op" id="4452820">]</span>&nbsp;<span class="op" id="4452822">+=</span>&nbsp;<span class="ident" id="4452825">uint64</span><span class="op" id="4452831">(</span><span class="ident" id="4452832">a</span><span class="op" id="4452833">[</span><span class="ident" id="4452834">i</span><span class="op" id="4452835">]</span><span class="op" id="4452836">)</span>&nbsp;<span class="op" id="4452838">*</span>&nbsp;<span class="ident" id="4452840">uint64</span><span class="op" id="4452846">(</span><span class="ident" id="4452847">b</span><span class="op" id="4452848">[</span><span class="ident" id="4452849">j</span><span class="op" id="4452850">]</span><span class="op" id="4452851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4452855">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4452858">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4452862">p224ReduceLarge</span><span class="op" id="4452877">(</span><span class="ident" id="4452878">out</span><span class="op" id="4452881">,</span>&nbsp;<span class="ident" id="4452883">tmp</span><span class="op" id="4452886">)</span><br>
<span class="lineno"></span><span class="op" id="4452888">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4452891">//&nbsp;Square&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a*a</span><br>
<span class="lineno">240</span><span class="comment" id="4452921">//</span><br>
<span class="lineno"></span><span class="comment" id="4452924">//&nbsp;a[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span><span class="comment" id="4452940">//&nbsp;out[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span><span class="keyword" id="4452958">func</span>&nbsp;<span class="ident" id="4452963">p224Square</span><span class="op" id="4452973">(</span><span class="ident" id="4452974">out</span><span class="op" id="4452977">,</span>&nbsp;<span class="ident" id="4452979">a</span>&nbsp;<span class="op" id="4452981">*</span><span class="ident" id="4452982">p224FieldElement</span><span class="op" id="4452998">,</span>&nbsp;<span class="ident" id="4453000">tmp</span>&nbsp;<span class="op" id="4453004">*</span><span class="ident" id="4453005">p224LargeFieldElement</span><span class="op" id="4453026">)</span>&nbsp;<span class="op" id="4453028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4453031">for</span>&nbsp;<span class="ident" id="4453035">i</span>&nbsp;<span class="op" id="4453037">:=</span>&nbsp;<span class="num" id="4453040">0</span><span class="op" id="4453041">;</span>&nbsp;<span class="ident" id="4453043">i</span>&nbsp;<span class="op" id="4453045">&lt;</span>&nbsp;<span class="num" id="4453047">15</span><span class="op" id="4453049">;</span>&nbsp;<span class="ident" id="4453051">i</span><span class="op" id="4453052">++</span>&nbsp;<span class="op" id="4453055">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4453059">tmp</span><span class="op" id="4453062">[</span><span class="ident" id="4453063">i</span><span class="op" id="4453064">]</span>&nbsp;<span class="op" id="4453066">=</span>&nbsp;<span class="num" id="4453068">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4453071">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4453075">for</span>&nbsp;<span class="ident" id="4453079">i</span>&nbsp;<span class="op" id="4453081">:=</span>&nbsp;<span class="num" id="4453084">0</span><span class="op" id="4453085">;</span>&nbsp;<span class="ident" id="4453087">i</span>&nbsp;<span class="op" id="4453089">&lt;</span>&nbsp;<span class="num" id="4453091">8</span><span class="op" id="4453092">;</span>&nbsp;<span class="ident" id="4453094">i</span><span class="op" id="4453095">++</span>&nbsp;<span class="op" id="4453098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4453102">for</span>&nbsp;<span class="ident" id="4453106">j</span>&nbsp;<span class="op" id="4453108">:=</span>&nbsp;<span class="num" id="4453111">0</span><span class="op" id="4453112">;</span>&nbsp;<span class="ident" id="4453114">j</span>&nbsp;<span class="op" id="4453116">&lt;=</span>&nbsp;<span class="ident" id="4453119">i</span><span class="op" id="4453120">;</span>&nbsp;<span class="ident" id="4453122">j</span><span class="op" id="4453123">++</span>&nbsp;<span class="op" id="4453126">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4453131">r</span>&nbsp;<span class="op" id="4453133">:=</span>&nbsp;<span class="ident" id="4453136">uint64</span><span class="op" id="4453142">(</span><span class="ident" id="4453143">a</span><span class="op" id="4453144">[</span><span class="ident" id="4453145">i</span><span class="op" id="4453146">]</span><span class="op" id="4453147">)</span>&nbsp;<span class="op" id="4453149">*</span>&nbsp;<span class="ident" id="4453151">uint64</span><span class="op" id="4453157">(</span><span class="ident" id="4453158">a</span><span class="op" id="4453159">[</span><span class="ident" id="4453160">j</span><span class="op" id="4453161">]</span><span class="op" id="4453162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4453167">if</span>&nbsp;<span class="ident" id="4453170">i</span>&nbsp;<span class="op" id="4453172">==</span>&nbsp;<span class="ident" id="4453175">j</span>&nbsp;<span class="op" id="4453177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4453183">tmp</span><span class="op" id="4453186">[</span><span class="ident" id="4453187">i</span><span class="op" id="4453188">+</span><span class="ident" id="4453189">j</span><span class="op" id="4453190">]</span>&nbsp;<span class="op" id="4453192">+=</span>&nbsp;<span class="ident" id="4453195">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4453200">}</span>&nbsp;<span class="keyword" id="4453202">else</span>&nbsp;<span class="op" id="4453207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4453213">tmp</span><span class="op" id="4453216">[</span><span class="ident" id="4453217">i</span><span class="op" id="4453218">+</span><span class="ident" id="4453219">j</span><span class="op" id="4453220">]</span>&nbsp;<span class="op" id="4453222">+=</span>&nbsp;<span class="ident" id="4453225">r</span>&nbsp;<span class="op" id="4453227">&lt;&lt;</span>&nbsp;<span class="num" id="4453230">1</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4453235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4453239">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4453242">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4453246">p224ReduceLarge</span><span class="op" id="4453261">(</span><span class="ident" id="4453262">out</span><span class="op" id="4453265">,</span>&nbsp;<span class="ident" id="4453267">tmp</span><span class="op" id="4453270">)</span><br>
<span class="lineno">260</span><span class="op" id="4453272">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4453275">//&nbsp;ReduceLarge&nbsp;converts&nbsp;a&nbsp;p224LargeFieldElement&nbsp;to&nbsp;a&nbsp;p224FieldElement.</span><br>
<span class="lineno"></span><span class="comment" id="4453346">//</span><br>
<span class="lineno"></span><span class="comment" id="4453349">//&nbsp;in[i]&nbsp;&lt;&nbsp;2**62</span><br>
<span class="lineno">265</span><span class="keyword" id="4453366">func</span>&nbsp;<span class="ident" id="4453371">p224ReduceLarge</span><span class="op" id="4453386">(</span><span class="ident" id="4453387">out</span>&nbsp;<span class="op" id="4453391">*</span><span class="ident" id="4453392">p224FieldElement</span><span class="op" id="4453408">,</span>&nbsp;<span class="ident" id="4453410">in</span>&nbsp;<span class="op" id="4453413">*</span><span class="ident" id="4453414">p224LargeFieldElement</span><span class="op" id="4453435">)</span>&nbsp;<span class="op" id="4453437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4453440">for</span>&nbsp;<span class="ident" id="4453444">i</span>&nbsp;<span class="op" id="4453446">:=</span>&nbsp;<span class="num" id="4453449">0</span><span class="op" id="4453450">;</span>&nbsp;<span class="ident" id="4453452">i</span>&nbsp;<span class="op" id="4453454">&lt;</span>&nbsp;<span class="num" id="4453456">8</span><span class="op" id="4453457">;</span>&nbsp;<span class="ident" id="4453459">i</span><span class="op" id="4453460">++</span>&nbsp;<span class="op" id="4453463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4453467">in</span><span class="op" id="4453469">[</span><span class="ident" id="4453470">i</span><span class="op" id="4453471">]</span>&nbsp;<span class="op" id="4453473">+=</span>&nbsp;<span class="ident" id="4453476">p224ZeroModP63</span><span class="op" id="4453490">[</span><span class="ident" id="4453491">i</span><span class="op" id="4453492">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4453495">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4453499">//&nbsp;Eliminate&nbsp;the&nbsp;coefficients&nbsp;at&nbsp;2**224&nbsp;and&nbsp;greater.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4453553">for</span>&nbsp;<span class="ident" id="4453557">i</span>&nbsp;<span class="op" id="4453559">:=</span>&nbsp;<span class="num" id="4453562">14</span><span class="op" id="4453564">;</span>&nbsp;<span class="ident" id="4453566">i</span>&nbsp;<span class="op" id="4453568">&gt;=</span>&nbsp;<span class="num" id="4453571">8</span><span class="op" id="4453572">;</span>&nbsp;<span class="ident" id="4453574">i</span><span class="op" id="4453575">--</span>&nbsp;<span class="op" id="4453578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4453582">in</span><span class="op" id="4453584">[</span><span class="ident" id="4453585">i</span><span class="op" id="4453586">-</span><span class="num" id="4453587">8</span><span class="op" id="4453588">]</span>&nbsp;<span class="op" id="4453590">-=</span>&nbsp;<span class="ident" id="4453593">in</span><span class="op" id="4453595">[</span><span class="ident" id="4453596">i</span><span class="op" id="4453597">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4453601">in</span><span class="op" id="4453603">[</span><span class="ident" id="4453604">i</span><span class="op" id="4453605">-</span><span class="num" id="4453606">5</span><span class="op" id="4453607">]</span>&nbsp;<span class="op" id="4453609">+=</span>&nbsp;<span class="op" id="4453612">(</span><span class="ident" id="4453613">in</span><span class="op" id="4453615">[</span><span class="ident" id="4453616">i</span><span class="op" id="4453617">]</span>&nbsp;<span class="op" id="4453619">&amp;</span>&nbsp;<span class="num" id="4453621">0xffff</span><span class="op" id="4453627">)</span>&nbsp;<span class="op" id="4453629">&lt;&lt;</span>&nbsp;<span class="num" id="4453632">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4453637">in</span><span class="op" id="4453639">[</span><span class="ident" id="4453640">i</span><span class="op" id="4453641">-</span><span class="num" id="4453642">4</span><span class="op" id="4453643">]</span>&nbsp;<span class="op" id="4453645">+=</span>&nbsp;<span class="ident" id="4453648">in</span><span class="op" id="4453650">[</span><span class="ident" id="4453651">i</span><span class="op" id="4453652">]</span>&nbsp;<span class="op" id="4453654">&gt;&gt;</span>&nbsp;<span class="num" id="4453657">16</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4453661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4453664">in</span><span class="op" id="4453666">[</span><span class="num" id="4453667">8</span><span class="op" id="4453668">]</span>&nbsp;<span class="op" id="4453670">=</span>&nbsp;<span class="num" id="4453672">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4453675">//&nbsp;in[0..8]&nbsp;&lt;&nbsp;2**64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4453697">//&nbsp;As&nbsp;the&nbsp;values&nbsp;become&nbsp;small&nbsp;enough,&nbsp;we&nbsp;start&nbsp;to&nbsp;store&nbsp;them&nbsp;in&nbsp;|out|</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4453768">//&nbsp;and&nbsp;use&nbsp;32-bit&nbsp;operations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4453799">for</span>&nbsp;<span class="ident" id="4453803">i</span>&nbsp;<span class="op" id="4453805">:=</span>&nbsp;<span class="num" id="4453808">1</span><span class="op" id="4453809">;</span>&nbsp;<span class="ident" id="4453811">i</span>&nbsp;<span class="op" id="4453813">&lt;</span>&nbsp;<span class="num" id="4453815">8</span><span class="op" id="4453816">;</span>&nbsp;<span class="ident" id="4453818">i</span><span class="op" id="4453819">++</span>&nbsp;<span class="op" id="4453822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4453826">in</span><span class="op" id="4453828">[</span><span class="ident" id="4453829">i</span><span class="op" id="4453830">+</span><span class="num" id="4453831">1</span><span class="op" id="4453832">]</span>&nbsp;<span class="op" id="4453834">+=</span>&nbsp;<span class="ident" id="4453837">in</span><span class="op" id="4453839">[</span><span class="ident" id="4453840">i</span><span class="op" id="4453841">]</span>&nbsp;<span class="op" id="4453843">&gt;&gt;</span>&nbsp;<span class="num" id="4453846">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4453851">out</span><span class="op" id="4453854">[</span><span class="ident" id="4453855">i</span><span class="op" id="4453856">]</span>&nbsp;<span class="op" id="4453858">=</span>&nbsp;<span class="builtintype" id="4453860">uint32</span><span class="op" id="4453866">(</span><span class="ident" id="4453867">in</span><span class="op" id="4453869">[</span><span class="ident" id="4453870">i</span><span class="op" id="4453871">]</span>&nbsp;<span class="op" id="4453873">&amp;</span>&nbsp;<span class="ident" id="4453875">bottom28Bits</span><span class="op" id="4453887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4453890">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4453893">in</span><span class="op" id="4453895">[</span><span class="num" id="4453896">0</span><span class="op" id="4453897">]</span>&nbsp;<span class="op" id="4453899">-=</span>&nbsp;<span class="ident" id="4453902">in</span><span class="op" id="4453904">[</span><span class="num" id="4453905">8</span><span class="op" id="4453906">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4453909">out</span><span class="op" id="4453912">[</span><span class="num" id="4453913">3</span><span class="op" id="4453914">]</span>&nbsp;<span class="op" id="4453916">+=</span>&nbsp;<span class="builtintype" id="4453919">uint32</span><span class="op" id="4453925">(</span><span class="ident" id="4453926">in</span><span class="op" id="4453928">[</span><span class="num" id="4453929">8</span><span class="op" id="4453930">]</span><span class="op" id="4453931">&amp;</span><span class="num" id="4453932">0xffff</span><span class="op" id="4453938">)</span>&nbsp;<span class="op" id="4453940">&lt;&lt;</span>&nbsp;<span class="num" id="4453943">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4453947">out</span><span class="op" id="4453950">[</span><span class="num" id="4453951">4</span><span class="op" id="4453952">]</span>&nbsp;<span class="op" id="4453954">+=</span>&nbsp;<span class="builtintype" id="4453957">uint32</span><span class="op" id="4453963">(</span><span class="ident" id="4453964">in</span><span class="op" id="4453966">[</span><span class="num" id="4453967">8</span><span class="op" id="4453968">]</span>&nbsp;<span class="op" id="4453970">&gt;&gt;</span>&nbsp;<span class="num" id="4453973">16</span><span class="op" id="4453975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4453978">//&nbsp;in[0]&nbsp;&lt;&nbsp;2**64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4453996">//&nbsp;out[3]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4454015">//&nbsp;out[4]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4454034">//&nbsp;out[1,2,5..7]&nbsp;&lt;&nbsp;2**28</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4454061">out</span><span class="op" id="4454064">[</span><span class="num" id="4454065">0</span><span class="op" id="4454066">]</span>&nbsp;<span class="op" id="4454068">=</span>&nbsp;<span class="builtintype" id="4454070">uint32</span><span class="op" id="4454076">(</span><span class="ident" id="4454077">in</span><span class="op" id="4454079">[</span><span class="num" id="4454080">0</span><span class="op" id="4454081">]</span>&nbsp;<span class="op" id="4454083">&amp;</span>&nbsp;<span class="ident" id="4454085">bottom28Bits</span><span class="op" id="4454097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4454100">out</span><span class="op" id="4454103">[</span><span class="num" id="4454104">1</span><span class="op" id="4454105">]</span>&nbsp;<span class="op" id="4454107">+=</span>&nbsp;<span class="builtintype" id="4454110">uint32</span><span class="op" id="4454116">(</span><span class="op" id="4454117">(</span><span class="ident" id="4454118">in</span><span class="op" id="4454120">[</span><span class="num" id="4454121">0</span><span class="op" id="4454122">]</span>&nbsp;<span class="op" id="4454124">&gt;&gt;</span>&nbsp;<span class="num" id="4454127">28</span><span class="op" id="4454129">)</span>&nbsp;<span class="op" id="4454131">&amp;</span>&nbsp;<span class="ident" id="4454133">bottom28Bits</span><span class="op" id="4454145">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4454148">out</span><span class="op" id="4454151">[</span><span class="num" id="4454152">2</span><span class="op" id="4454153">]</span>&nbsp;<span class="op" id="4454155">+=</span>&nbsp;<span class="builtintype" id="4454158">uint32</span><span class="op" id="4454164">(</span><span class="ident" id="4454165">in</span><span class="op" id="4454167">[</span><span class="num" id="4454168">0</span><span class="op" id="4454169">]</span>&nbsp;<span class="op" id="4454171">&gt;&gt;</span>&nbsp;<span class="num" id="4454174">56</span><span class="op" id="4454176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4454179">//&nbsp;out[0]&nbsp;&lt;&nbsp;2**28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4454198">//&nbsp;out[1..4]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4454220">//&nbsp;out[5..7]&nbsp;&lt;&nbsp;2**28</span><br>
<span class="lineno"></span><span class="op" id="4454241">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="4454244">//&nbsp;Reduce&nbsp;reduces&nbsp;the&nbsp;coefficients&nbsp;of&nbsp;a&nbsp;to&nbsp;smaller&nbsp;bounds.</span><br>
<span class="lineno"></span><span class="comment" id="4454303">//</span><br>
<span class="lineno"></span><span class="comment" id="4454306">//&nbsp;On&nbsp;entry:&nbsp;a[i]&nbsp;&lt;&nbsp;2**31&nbsp;+&nbsp;2**30</span><br>
<span class="lineno"></span><span class="comment" id="4454340">//&nbsp;On&nbsp;exit:&nbsp;a[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">305</span><span class="keyword" id="4454365">func</span>&nbsp;<span class="ident" id="4454370">p224Reduce</span><span class="op" id="4454380">(</span><span class="ident" id="4454381">a</span>&nbsp;<span class="op" id="4454383">*</span><span class="ident" id="4454384">p224FieldElement</span><span class="op" id="4454400">)</span>&nbsp;<span class="op" id="4454402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4454405">for</span>&nbsp;<span class="ident" id="4454409">i</span>&nbsp;<span class="op" id="4454411">:=</span>&nbsp;<span class="num" id="4454414">0</span><span class="op" id="4454415">;</span>&nbsp;<span class="ident" id="4454417">i</span>&nbsp;<span class="op" id="4454419">&lt;</span>&nbsp;<span class="num" id="4454421">7</span><span class="op" id="4454422">;</span>&nbsp;<span class="ident" id="4454424">i</span><span class="op" id="4454425">++</span>&nbsp;<span class="op" id="4454428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4454432">a</span><span class="op" id="4454433">[</span><span class="ident" id="4454434">i</span><span class="op" id="4454435">+</span><span class="num" id="4454436">1</span><span class="op" id="4454437">]</span>&nbsp;<span class="op" id="4454439">+=</span>&nbsp;<span class="ident" id="4454442">a</span><span class="op" id="4454443">[</span><span class="ident" id="4454444">i</span><span class="op" id="4454445">]</span>&nbsp;<span class="op" id="4454447">&gt;&gt;</span>&nbsp;<span class="num" id="4454450">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4454455">a</span><span class="op" id="4454456">[</span><span class="ident" id="4454457">i</span><span class="op" id="4454458">]</span>&nbsp;<span class="op" id="4454460">&amp;=</span>&nbsp;<span class="ident" id="4454463">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4454477">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4454480">top</span>&nbsp;<span class="op" id="4454484">:=</span>&nbsp;<span class="ident" id="4454487">a</span><span class="op" id="4454488">[</span><span class="num" id="4454489">7</span><span class="op" id="4454490">]</span>&nbsp;<span class="op" id="4454492">&gt;&gt;</span>&nbsp;<span class="num" id="4454495">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4454499">a</span><span class="op" id="4454500">[</span><span class="num" id="4454501">7</span><span class="op" id="4454502">]</span>&nbsp;<span class="op" id="4454504">&amp;=</span>&nbsp;<span class="ident" id="4454507">bottom28Bits</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4454522">//&nbsp;top&nbsp;&lt;&nbsp;2**4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4454537">mask</span>&nbsp;<span class="op" id="4454542">:=</span>&nbsp;<span class="ident" id="4454545">top</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4454550">mask</span>&nbsp;<span class="op" id="4454555">|=</span>&nbsp;<span class="ident" id="4454558">mask</span>&nbsp;<span class="op" id="4454563">&gt;&gt;</span>&nbsp;<span class="num" id="4454566">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4454569">mask</span>&nbsp;<span class="op" id="4454574">|=</span>&nbsp;<span class="ident" id="4454577">mask</span>&nbsp;<span class="op" id="4454582">&gt;&gt;</span>&nbsp;<span class="num" id="4454585">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4454588">mask</span>&nbsp;<span class="op" id="4454593">&lt;&lt;=</span>&nbsp;<span class="num" id="4454597">31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4454601">mask</span>&nbsp;<span class="op" id="4454606">=</span>&nbsp;<span class="builtintype" id="4454608">uint32</span><span class="op" id="4454614">(</span><span class="builtintype" id="4454615">int32</span><span class="op" id="4454620">(</span><span class="ident" id="4454621">mask</span><span class="op" id="4454625">)</span>&nbsp;<span class="op" id="4454627">&gt;&gt;</span>&nbsp;<span class="num" id="4454630">31</span><span class="op" id="4454632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4454635">//&nbsp;Mask&nbsp;is&nbsp;all&nbsp;ones&nbsp;if&nbsp;top&nbsp;!=&nbsp;0,&nbsp;all&nbsp;zero&nbsp;otherwise</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4454689">a</span><span class="op" id="4454690">[</span><span class="num" id="4454691">0</span><span class="op" id="4454692">]</span>&nbsp;<span class="op" id="4454694">-=</span>&nbsp;<span class="ident" id="4454697">top</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4454702">a</span><span class="op" id="4454703">[</span><span class="num" id="4454704">3</span><span class="op" id="4454705">]</span>&nbsp;<span class="op" id="4454707">+=</span>&nbsp;<span class="ident" id="4454710">top</span>&nbsp;<span class="op" id="4454714">&lt;&lt;</span>&nbsp;<span class="num" id="4454717">12</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4454722">//&nbsp;We&nbsp;may&nbsp;have&nbsp;just&nbsp;made&nbsp;a[0]&nbsp;negative&nbsp;but,&nbsp;if&nbsp;we&nbsp;did,&nbsp;then&nbsp;we&nbsp;must</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4454791">//&nbsp;have&nbsp;added&nbsp;something&nbsp;to&nbsp;a[3],&nbsp;this&nbsp;it&#39;s&nbsp;&gt;&nbsp;2**12.&nbsp;Therefore&nbsp;we&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4454861">//&nbsp;carry&nbsp;down&nbsp;to&nbsp;a[0].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4454885">a</span><span class="op" id="4454886">[</span><span class="num" id="4454887">3</span><span class="op" id="4454888">]</span>&nbsp;<span class="op" id="4454890">-=</span>&nbsp;<span class="num" id="4454893">1</span>&nbsp;<span class="op" id="4454895">&amp;</span>&nbsp;<span class="ident" id="4454897">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4454903">a</span><span class="op" id="4454904">[</span><span class="num" id="4454905">2</span><span class="op" id="4454906">]</span>&nbsp;<span class="op" id="4454908">+=</span>&nbsp;<span class="ident" id="4454911">mask</span>&nbsp;<span class="op" id="4454916">&amp;</span>&nbsp;<span class="op" id="4454918">(</span><span class="num" id="4454919">1</span><span class="op" id="4454920">&lt;&lt;</span><span class="num" id="4454922">28</span>&nbsp;<span class="op" id="4454925">-</span>&nbsp;<span class="num" id="4454927">1</span><span class="op" id="4454928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4454931">a</span><span class="op" id="4454932">[</span><span class="num" id="4454933">1</span><span class="op" id="4454934">]</span>&nbsp;<span class="op" id="4454936">+=</span>&nbsp;<span class="ident" id="4454939">mask</span>&nbsp;<span class="op" id="4454944">&amp;</span>&nbsp;<span class="op" id="4454946">(</span><span class="num" id="4454947">1</span><span class="op" id="4454948">&lt;&lt;</span><span class="num" id="4454950">28</span>&nbsp;<span class="op" id="4454953">-</span>&nbsp;<span class="num" id="4454955">1</span><span class="op" id="4454956">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4454959">a</span><span class="op" id="4454960">[</span><span class="num" id="4454961">0</span><span class="op" id="4454962">]</span>&nbsp;<span class="op" id="4454964">+=</span>&nbsp;<span class="ident" id="4454967">mask</span>&nbsp;<span class="op" id="4454972">&amp;</span>&nbsp;<span class="op" id="4454974">(</span><span class="num" id="4454975">1</span>&nbsp;<span class="op" id="4454977">&lt;&lt;</span>&nbsp;<span class="num" id="4454980">28</span><span class="op" id="4454982">)</span><br>
<span class="lineno"></span><span class="op" id="4454984">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4454987">//&nbsp;p224Invert&nbsp;calculates&nbsp;*out&nbsp;=&nbsp;in**-1&nbsp;by&nbsp;computing&nbsp;in**(2**224&nbsp;-&nbsp;2**96&nbsp;-&nbsp;1),</span><br>
<span class="lineno"></span><span class="comment" id="4455065">//&nbsp;i.e.&nbsp;Fermat&#39;s&nbsp;little&nbsp;theorem.</span><br>
<span class="lineno">335</span><span class="keyword" id="4455098">func</span>&nbsp;<span class="ident" id="4455103">p224Invert</span><span class="op" id="4455113">(</span><span class="ident" id="4455114">out</span><span class="op" id="4455117">,</span>&nbsp;<span class="ident" id="4455119">in</span>&nbsp;<span class="op" id="4455122">*</span><span class="ident" id="4455123">p224FieldElement</span><span class="op" id="4455139">)</span>&nbsp;<span class="op" id="4455141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4455144">var</span>&nbsp;<span class="ident" id="4455148">f1</span><span class="op" id="4455150">,</span>&nbsp;<span class="ident" id="4455152">f2</span><span class="op" id="4455154">,</span>&nbsp;<span class="ident" id="4455156">f3</span><span class="op" id="4455158">,</span>&nbsp;<span class="ident" id="4455160">f4</span>&nbsp;<span class="ident" id="4455163">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4455181">var</span>&nbsp;<span class="ident" id="4455185">c</span>&nbsp;<span class="ident" id="4455187">p224LargeFieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4455211">p224Square</span><span class="op" id="4455221">(</span><span class="op" id="4455222">&amp;</span><span class="ident" id="4455223">f1</span><span class="op" id="4455225">,</span>&nbsp;<span class="ident" id="4455227">in</span><span class="op" id="4455229">,</span>&nbsp;<span class="op" id="4455231">&amp;</span><span class="ident" id="4455232">c</span><span class="op" id="4455233">)</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4455238">//&nbsp;2</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4455244">p224Mul</span><span class="op" id="4455251">(</span><span class="op" id="4455252">&amp;</span><span class="ident" id="4455253">f1</span><span class="op" id="4455255">,</span>&nbsp;<span class="op" id="4455257">&amp;</span><span class="ident" id="4455258">f1</span><span class="op" id="4455260">,</span>&nbsp;<span class="ident" id="4455262">in</span><span class="op" id="4455264">,</span>&nbsp;<span class="op" id="4455266">&amp;</span><span class="ident" id="4455267">c</span><span class="op" id="4455268">)</span>&nbsp;&nbsp;<span class="comment" id="4455271">//&nbsp;2**2&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4455284">p224Square</span><span class="op" id="4455294">(</span><span class="op" id="4455295">&amp;</span><span class="ident" id="4455296">f1</span><span class="op" id="4455298">,</span>&nbsp;<span class="op" id="4455300">&amp;</span><span class="ident" id="4455301">f1</span><span class="op" id="4455303">,</span>&nbsp;<span class="op" id="4455305">&amp;</span><span class="ident" id="4455306">c</span><span class="op" id="4455307">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4455311">//&nbsp;2**3&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4455324">p224Mul</span><span class="op" id="4455331">(</span><span class="op" id="4455332">&amp;</span><span class="ident" id="4455333">f1</span><span class="op" id="4455335">,</span>&nbsp;<span class="op" id="4455337">&amp;</span><span class="ident" id="4455338">f1</span><span class="op" id="4455340">,</span>&nbsp;<span class="ident" id="4455342">in</span><span class="op" id="4455344">,</span>&nbsp;<span class="op" id="4455346">&amp;</span><span class="ident" id="4455347">c</span><span class="op" id="4455348">)</span>&nbsp;&nbsp;<span class="comment" id="4455351">//&nbsp;2**3&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4455364">p224Square</span><span class="op" id="4455374">(</span><span class="op" id="4455375">&amp;</span><span class="ident" id="4455376">f2</span><span class="op" id="4455378">,</span>&nbsp;<span class="op" id="4455380">&amp;</span><span class="ident" id="4455381">f1</span><span class="op" id="4455383">,</span>&nbsp;<span class="op" id="4455385">&amp;</span><span class="ident" id="4455386">c</span><span class="op" id="4455387">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4455391">//&nbsp;2**4&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4455404">p224Square</span><span class="op" id="4455414">(</span><span class="op" id="4455415">&amp;</span><span class="ident" id="4455416">f2</span><span class="op" id="4455418">,</span>&nbsp;<span class="op" id="4455420">&amp;</span><span class="ident" id="4455421">f2</span><span class="op" id="4455423">,</span>&nbsp;<span class="op" id="4455425">&amp;</span><span class="ident" id="4455426">c</span><span class="op" id="4455427">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4455431">//&nbsp;2**5&nbsp;-&nbsp;4</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4455444">p224Square</span><span class="op" id="4455454">(</span><span class="op" id="4455455">&amp;</span><span class="ident" id="4455456">f2</span><span class="op" id="4455458">,</span>&nbsp;<span class="op" id="4455460">&amp;</span><span class="ident" id="4455461">f2</span><span class="op" id="4455463">,</span>&nbsp;<span class="op" id="4455465">&amp;</span><span class="ident" id="4455466">c</span><span class="op" id="4455467">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4455471">//&nbsp;2**6&nbsp;-&nbsp;8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4455484">p224Mul</span><span class="op" id="4455491">(</span><span class="op" id="4455492">&amp;</span><span class="ident" id="4455493">f1</span><span class="op" id="4455495">,</span>&nbsp;<span class="op" id="4455497">&amp;</span><span class="ident" id="4455498">f1</span><span class="op" id="4455500">,</span>&nbsp;<span class="op" id="4455502">&amp;</span><span class="ident" id="4455503">f2</span><span class="op" id="4455505">,</span>&nbsp;<span class="op" id="4455507">&amp;</span><span class="ident" id="4455508">c</span><span class="op" id="4455509">)</span>&nbsp;<span class="comment" id="4455511">//&nbsp;2**6&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4455524">p224Square</span><span class="op" id="4455534">(</span><span class="op" id="4455535">&amp;</span><span class="ident" id="4455536">f2</span><span class="op" id="4455538">,</span>&nbsp;<span class="op" id="4455540">&amp;</span><span class="ident" id="4455541">f1</span><span class="op" id="4455543">,</span>&nbsp;<span class="op" id="4455545">&amp;</span><span class="ident" id="4455546">c</span><span class="op" id="4455547">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4455551">//&nbsp;2**7&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4455564">for</span>&nbsp;<span class="ident" id="4455568">i</span>&nbsp;<span class="op" id="4455570">:=</span>&nbsp;<span class="num" id="4455573">0</span><span class="op" id="4455574">;</span>&nbsp;<span class="ident" id="4455576">i</span>&nbsp;<span class="op" id="4455578">&lt;</span>&nbsp;<span class="num" id="4455580">5</span><span class="op" id="4455581">;</span>&nbsp;<span class="ident" id="4455583">i</span><span class="op" id="4455584">++</span>&nbsp;<span class="op" id="4455587">{</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4455591">//&nbsp;2**12&nbsp;-&nbsp;2**6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4455609">p224Square</span><span class="op" id="4455619">(</span><span class="op" id="4455620">&amp;</span><span class="ident" id="4455621">f2</span><span class="op" id="4455623">,</span>&nbsp;<span class="op" id="4455625">&amp;</span><span class="ident" id="4455626">f2</span><span class="op" id="4455628">,</span>&nbsp;<span class="op" id="4455630">&amp;</span><span class="ident" id="4455631">c</span><span class="op" id="4455632">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4455635">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4455638">p224Mul</span><span class="op" id="4455645">(</span><span class="op" id="4455646">&amp;</span><span class="ident" id="4455647">f2</span><span class="op" id="4455649">,</span>&nbsp;<span class="op" id="4455651">&amp;</span><span class="ident" id="4455652">f2</span><span class="op" id="4455654">,</span>&nbsp;<span class="op" id="4455656">&amp;</span><span class="ident" id="4455657">f1</span><span class="op" id="4455659">,</span>&nbsp;<span class="op" id="4455661">&amp;</span><span class="ident" id="4455662">c</span><span class="op" id="4455663">)</span>&nbsp;<span class="comment" id="4455665">//&nbsp;2**12&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4455679">p224Square</span><span class="op" id="4455689">(</span><span class="op" id="4455690">&amp;</span><span class="ident" id="4455691">f3</span><span class="op" id="4455693">,</span>&nbsp;<span class="op" id="4455695">&amp;</span><span class="ident" id="4455696">f2</span><span class="op" id="4455698">,</span>&nbsp;<span class="op" id="4455700">&amp;</span><span class="ident" id="4455701">c</span><span class="op" id="4455702">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4455706">//&nbsp;2**13&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4455720">for</span>&nbsp;<span class="ident" id="4455724">i</span>&nbsp;<span class="op" id="4455726">:=</span>&nbsp;<span class="num" id="4455729">0</span><span class="op" id="4455730">;</span>&nbsp;<span class="ident" id="4455732">i</span>&nbsp;<span class="op" id="4455734">&lt;</span>&nbsp;<span class="num" id="4455736">11</span><span class="op" id="4455738">;</span>&nbsp;<span class="ident" id="4455740">i</span><span class="op" id="4455741">++</span>&nbsp;<span class="op" id="4455744">{</span>&nbsp;&nbsp;<span class="comment" id="4455747">//&nbsp;2**24&nbsp;-&nbsp;2**12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4455766">p224Square</span><span class="op" id="4455776">(</span><span class="op" id="4455777">&amp;</span><span class="ident" id="4455778">f3</span><span class="op" id="4455780">,</span>&nbsp;<span class="op" id="4455782">&amp;</span><span class="ident" id="4455783">f3</span><span class="op" id="4455785">,</span>&nbsp;<span class="op" id="4455787">&amp;</span><span class="ident" id="4455788">c</span><span class="op" id="4455789">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4455792">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4455795">p224Mul</span><span class="op" id="4455802">(</span><span class="op" id="4455803">&amp;</span><span class="ident" id="4455804">f2</span><span class="op" id="4455806">,</span>&nbsp;<span class="op" id="4455808">&amp;</span><span class="ident" id="4455809">f3</span><span class="op" id="4455811">,</span>&nbsp;<span class="op" id="4455813">&amp;</span><span class="ident" id="4455814">f2</span><span class="op" id="4455816">,</span>&nbsp;<span class="op" id="4455818">&amp;</span><span class="ident" id="4455819">c</span><span class="op" id="4455820">)</span>&nbsp;<span class="comment" id="4455822">//&nbsp;2**24&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4455836">p224Square</span><span class="op" id="4455846">(</span><span class="op" id="4455847">&amp;</span><span class="ident" id="4455848">f3</span><span class="op" id="4455850">,</span>&nbsp;<span class="op" id="4455852">&amp;</span><span class="ident" id="4455853">f2</span><span class="op" id="4455855">,</span>&nbsp;<span class="op" id="4455857">&amp;</span><span class="ident" id="4455858">c</span><span class="op" id="4455859">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4455863">//&nbsp;2**25&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4455877">for</span>&nbsp;<span class="ident" id="4455881">i</span>&nbsp;<span class="op" id="4455883">:=</span>&nbsp;<span class="num" id="4455886">0</span><span class="op" id="4455887">;</span>&nbsp;<span class="ident" id="4455889">i</span>&nbsp;<span class="op" id="4455891">&lt;</span>&nbsp;<span class="num" id="4455893">23</span><span class="op" id="4455895">;</span>&nbsp;<span class="ident" id="4455897">i</span><span class="op" id="4455898">++</span>&nbsp;<span class="op" id="4455901">{</span>&nbsp;&nbsp;<span class="comment" id="4455904">//&nbsp;2**48&nbsp;-&nbsp;2**24</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4455923">p224Square</span><span class="op" id="4455933">(</span><span class="op" id="4455934">&amp;</span><span class="ident" id="4455935">f3</span><span class="op" id="4455937">,</span>&nbsp;<span class="op" id="4455939">&amp;</span><span class="ident" id="4455940">f3</span><span class="op" id="4455942">,</span>&nbsp;<span class="op" id="4455944">&amp;</span><span class="ident" id="4455945">c</span><span class="op" id="4455946">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4455949">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4455952">p224Mul</span><span class="op" id="4455959">(</span><span class="op" id="4455960">&amp;</span><span class="ident" id="4455961">f3</span><span class="op" id="4455963">,</span>&nbsp;<span class="op" id="4455965">&amp;</span><span class="ident" id="4455966">f3</span><span class="op" id="4455968">,</span>&nbsp;<span class="op" id="4455970">&amp;</span><span class="ident" id="4455971">f2</span><span class="op" id="4455973">,</span>&nbsp;<span class="op" id="4455975">&amp;</span><span class="ident" id="4455976">c</span><span class="op" id="4455977">)</span>&nbsp;<span class="comment" id="4455979">//&nbsp;2**48&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4455993">p224Square</span><span class="op" id="4456003">(</span><span class="op" id="4456004">&amp;</span><span class="ident" id="4456005">f4</span><span class="op" id="4456007">,</span>&nbsp;<span class="op" id="4456009">&amp;</span><span class="ident" id="4456010">f3</span><span class="op" id="4456012">,</span>&nbsp;<span class="op" id="4456014">&amp;</span><span class="ident" id="4456015">c</span><span class="op" id="4456016">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4456020">//&nbsp;2**49&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4456034">for</span>&nbsp;<span class="ident" id="4456038">i</span>&nbsp;<span class="op" id="4456040">:=</span>&nbsp;<span class="num" id="4456043">0</span><span class="op" id="4456044">;</span>&nbsp;<span class="ident" id="4456046">i</span>&nbsp;<span class="op" id="4456048">&lt;</span>&nbsp;<span class="num" id="4456050">47</span><span class="op" id="4456052">;</span>&nbsp;<span class="ident" id="4456054">i</span><span class="op" id="4456055">++</span>&nbsp;<span class="op" id="4456058">{</span>&nbsp;&nbsp;<span class="comment" id="4456061">//&nbsp;2**96&nbsp;-&nbsp;2**48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4456080">p224Square</span><span class="op" id="4456090">(</span><span class="op" id="4456091">&amp;</span><span class="ident" id="4456092">f4</span><span class="op" id="4456094">,</span>&nbsp;<span class="op" id="4456096">&amp;</span><span class="ident" id="4456097">f4</span><span class="op" id="4456099">,</span>&nbsp;<span class="op" id="4456101">&amp;</span><span class="ident" id="4456102">c</span><span class="op" id="4456103">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4456106">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4456109">p224Mul</span><span class="op" id="4456116">(</span><span class="op" id="4456117">&amp;</span><span class="ident" id="4456118">f3</span><span class="op" id="4456120">,</span>&nbsp;<span class="op" id="4456122">&amp;</span><span class="ident" id="4456123">f3</span><span class="op" id="4456125">,</span>&nbsp;<span class="op" id="4456127">&amp;</span><span class="ident" id="4456128">f4</span><span class="op" id="4456130">,</span>&nbsp;<span class="op" id="4456132">&amp;</span><span class="ident" id="4456133">c</span><span class="op" id="4456134">)</span>&nbsp;<span class="comment" id="4456136">//&nbsp;2**96&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4456150">p224Square</span><span class="op" id="4456160">(</span><span class="op" id="4456161">&amp;</span><span class="ident" id="4456162">f4</span><span class="op" id="4456164">,</span>&nbsp;<span class="op" id="4456166">&amp;</span><span class="ident" id="4456167">f3</span><span class="op" id="4456169">,</span>&nbsp;<span class="op" id="4456171">&amp;</span><span class="ident" id="4456172">c</span><span class="op" id="4456173">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4456177">//&nbsp;2**97&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4456191">for</span>&nbsp;<span class="ident" id="4456195">i</span>&nbsp;<span class="op" id="4456197">:=</span>&nbsp;<span class="num" id="4456200">0</span><span class="op" id="4456201">;</span>&nbsp;<span class="ident" id="4456203">i</span>&nbsp;<span class="op" id="4456205">&lt;</span>&nbsp;<span class="num" id="4456207">23</span><span class="op" id="4456209">;</span>&nbsp;<span class="ident" id="4456211">i</span><span class="op" id="4456212">++</span>&nbsp;<span class="op" id="4456215">{</span>&nbsp;&nbsp;<span class="comment" id="4456218">//&nbsp;2**120&nbsp;-&nbsp;2**24</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4456238">p224Square</span><span class="op" id="4456248">(</span><span class="op" id="4456249">&amp;</span><span class="ident" id="4456250">f4</span><span class="op" id="4456252">,</span>&nbsp;<span class="op" id="4456254">&amp;</span><span class="ident" id="4456255">f4</span><span class="op" id="4456257">,</span>&nbsp;<span class="op" id="4456259">&amp;</span><span class="ident" id="4456260">c</span><span class="op" id="4456261">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4456264">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4456267">p224Mul</span><span class="op" id="4456274">(</span><span class="op" id="4456275">&amp;</span><span class="ident" id="4456276">f2</span><span class="op" id="4456278">,</span>&nbsp;<span class="op" id="4456280">&amp;</span><span class="ident" id="4456281">f4</span><span class="op" id="4456283">,</span>&nbsp;<span class="op" id="4456285">&amp;</span><span class="ident" id="4456286">f2</span><span class="op" id="4456288">,</span>&nbsp;<span class="op" id="4456290">&amp;</span><span class="ident" id="4456291">c</span><span class="op" id="4456292">)</span>&nbsp;<span class="comment" id="4456294">//&nbsp;2**120&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4456309">for</span>&nbsp;<span class="ident" id="4456313">i</span>&nbsp;<span class="op" id="4456315">:=</span>&nbsp;<span class="num" id="4456318">0</span><span class="op" id="4456319">;</span>&nbsp;<span class="ident" id="4456321">i</span>&nbsp;<span class="op" id="4456323">&lt;</span>&nbsp;<span class="num" id="4456325">6</span><span class="op" id="4456326">;</span>&nbsp;<span class="ident" id="4456328">i</span><span class="op" id="4456329">++</span>&nbsp;<span class="op" id="4456332">{</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4456336">//&nbsp;2**126&nbsp;-&nbsp;2**6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4456355">p224Square</span><span class="op" id="4456365">(</span><span class="op" id="4456366">&amp;</span><span class="ident" id="4456367">f2</span><span class="op" id="4456369">,</span>&nbsp;<span class="op" id="4456371">&amp;</span><span class="ident" id="4456372">f2</span><span class="op" id="4456374">,</span>&nbsp;<span class="op" id="4456376">&amp;</span><span class="ident" id="4456377">c</span><span class="op" id="4456378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4456381">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4456384">p224Mul</span><span class="op" id="4456391">(</span><span class="op" id="4456392">&amp;</span><span class="ident" id="4456393">f1</span><span class="op" id="4456395">,</span>&nbsp;<span class="op" id="4456397">&amp;</span><span class="ident" id="4456398">f1</span><span class="op" id="4456400">,</span>&nbsp;<span class="op" id="4456402">&amp;</span><span class="ident" id="4456403">f2</span><span class="op" id="4456405">,</span>&nbsp;<span class="op" id="4456407">&amp;</span><span class="ident" id="4456408">c</span><span class="op" id="4456409">)</span>&nbsp;<span class="comment" id="4456411">//&nbsp;2**126&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4456426">p224Square</span><span class="op" id="4456436">(</span><span class="op" id="4456437">&amp;</span><span class="ident" id="4456438">f1</span><span class="op" id="4456440">,</span>&nbsp;<span class="op" id="4456442">&amp;</span><span class="ident" id="4456443">f1</span><span class="op" id="4456445">,</span>&nbsp;<span class="op" id="4456447">&amp;</span><span class="ident" id="4456448">c</span><span class="op" id="4456449">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4456453">//&nbsp;2**127&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4456468">p224Mul</span><span class="op" id="4456475">(</span><span class="op" id="4456476">&amp;</span><span class="ident" id="4456477">f1</span><span class="op" id="4456479">,</span>&nbsp;<span class="op" id="4456481">&amp;</span><span class="ident" id="4456482">f1</span><span class="op" id="4456484">,</span>&nbsp;<span class="ident" id="4456486">in</span><span class="op" id="4456488">,</span>&nbsp;<span class="op" id="4456490">&amp;</span><span class="ident" id="4456491">c</span><span class="op" id="4456492">)</span>&nbsp;&nbsp;<span class="comment" id="4456495">//&nbsp;2**127&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4456510">for</span>&nbsp;<span class="ident" id="4456514">i</span>&nbsp;<span class="op" id="4456516">:=</span>&nbsp;<span class="num" id="4456519">0</span><span class="op" id="4456520">;</span>&nbsp;<span class="ident" id="4456522">i</span>&nbsp;<span class="op" id="4456524">&lt;</span>&nbsp;<span class="num" id="4456526">97</span><span class="op" id="4456528">;</span>&nbsp;<span class="ident" id="4456530">i</span><span class="op" id="4456531">++</span>&nbsp;<span class="op" id="4456534">{</span>&nbsp;&nbsp;<span class="comment" id="4456537">//&nbsp;2**224&nbsp;-&nbsp;2**97</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4456557">p224Square</span><span class="op" id="4456567">(</span><span class="op" id="4456568">&amp;</span><span class="ident" id="4456569">f1</span><span class="op" id="4456571">,</span>&nbsp;<span class="op" id="4456573">&amp;</span><span class="ident" id="4456574">f1</span><span class="op" id="4456576">,</span>&nbsp;<span class="op" id="4456578">&amp;</span><span class="ident" id="4456579">c</span><span class="op" id="4456580">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4456583">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4456586">p224Mul</span><span class="op" id="4456593">(</span><span class="ident" id="4456594">out</span><span class="op" id="4456597">,</span>&nbsp;<span class="op" id="4456599">&amp;</span><span class="ident" id="4456600">f1</span><span class="op" id="4456602">,</span>&nbsp;<span class="op" id="4456604">&amp;</span><span class="ident" id="4456605">f3</span><span class="op" id="4456607">,</span>&nbsp;<span class="op" id="4456609">&amp;</span><span class="ident" id="4456610">c</span><span class="op" id="4456611">)</span>&nbsp;<span class="comment" id="4456613">//&nbsp;2**224&nbsp;-&nbsp;2**96&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span><span class="op" id="4456635">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4456638">//&nbsp;p224Contract&nbsp;converts&nbsp;a&nbsp;FieldElement&nbsp;to&nbsp;its&nbsp;unique,&nbsp;minimal&nbsp;form.</span><br>
<span class="lineno">385</span><span class="comment" id="4456707">//</span><br>
<span class="lineno"></span><span class="comment" id="4456710">//&nbsp;On&nbsp;entry,&nbsp;in[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span><span class="comment" id="4456737">//&nbsp;On&nbsp;exit,&nbsp;in[i]&nbsp;&lt;&nbsp;2**28</span><br>
<span class="lineno"></span><span class="keyword" id="4456763">func</span>&nbsp;<span class="ident" id="4456768">p224Contract</span><span class="op" id="4456780">(</span><span class="ident" id="4456781">out</span><span class="op" id="4456784">,</span>&nbsp;<span class="ident" id="4456786">in</span>&nbsp;<span class="op" id="4456789">*</span><span class="ident" id="4456790">p224FieldElement</span><span class="op" id="4456806">)</span>&nbsp;<span class="op" id="4456808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4456811">copy</span><span class="op" id="4456815">(</span><span class="ident" id="4456816">out</span><span class="op" id="4456819">[</span><span class="op" id="4456820">:</span><span class="op" id="4456821">]</span><span class="op" id="4456822">,</span>&nbsp;<span class="ident" id="4456824">in</span><span class="op" id="4456826">[</span><span class="op" id="4456827">:</span><span class="op" id="4456828">]</span><span class="op" id="4456829">)</span><br>
<span class="lineno">390</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4456833">for</span>&nbsp;<span class="ident" id="4456837">i</span>&nbsp;<span class="op" id="4456839">:=</span>&nbsp;<span class="num" id="4456842">0</span><span class="op" id="4456843">;</span>&nbsp;<span class="ident" id="4456845">i</span>&nbsp;<span class="op" id="4456847">&lt;</span>&nbsp;<span class="num" id="4456849">7</span><span class="op" id="4456850">;</span>&nbsp;<span class="ident" id="4456852">i</span><span class="op" id="4456853">++</span>&nbsp;<span class="op" id="4456856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4456860">out</span><span class="op" id="4456863">[</span><span class="ident" id="4456864">i</span><span class="op" id="4456865">+</span><span class="num" id="4456866">1</span><span class="op" id="4456867">]</span>&nbsp;<span class="op" id="4456869">+=</span>&nbsp;<span class="ident" id="4456872">out</span><span class="op" id="4456875">[</span><span class="ident" id="4456876">i</span><span class="op" id="4456877">]</span>&nbsp;<span class="op" id="4456879">&gt;&gt;</span>&nbsp;<span class="num" id="4456882">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4456887">out</span><span class="op" id="4456890">[</span><span class="ident" id="4456891">i</span><span class="op" id="4456892">]</span>&nbsp;<span class="op" id="4456894">&amp;=</span>&nbsp;<span class="ident" id="4456897">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4456911">}</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4456914">top</span>&nbsp;<span class="op" id="4456918">:=</span>&nbsp;<span class="ident" id="4456921">out</span><span class="op" id="4456924">[</span><span class="num" id="4456925">7</span><span class="op" id="4456926">]</span>&nbsp;<span class="op" id="4456928">&gt;&gt;</span>&nbsp;<span class="num" id="4456931">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4456935">out</span><span class="op" id="4456938">[</span><span class="num" id="4456939">7</span><span class="op" id="4456940">]</span>&nbsp;<span class="op" id="4456942">&amp;=</span>&nbsp;<span class="ident" id="4456945">bottom28Bits</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4456960">out</span><span class="op" id="4456963">[</span><span class="num" id="4456964">0</span><span class="op" id="4456965">]</span>&nbsp;<span class="op" id="4456967">-=</span>&nbsp;<span class="ident" id="4456970">top</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4456975">out</span><span class="op" id="4456978">[</span><span class="num" id="4456979">3</span><span class="op" id="4456980">]</span>&nbsp;<span class="op" id="4456982">+=</span>&nbsp;<span class="ident" id="4456985">top</span>&nbsp;<span class="op" id="4456989">&lt;&lt;</span>&nbsp;<span class="num" id="4456992">12</span><br>
<span class="lineno">400</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4456997">//&nbsp;We&nbsp;may&nbsp;just&nbsp;have&nbsp;made&nbsp;out[i]&nbsp;negative.&nbsp;So&nbsp;we&nbsp;carry&nbsp;down.&nbsp;If&nbsp;we&nbsp;made</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4457069">//&nbsp;out[0]&nbsp;negative&nbsp;then&nbsp;we&nbsp;know&nbsp;that&nbsp;out[3]&nbsp;is&nbsp;sufficiently&nbsp;positive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4457139">//&nbsp;because&nbsp;we&nbsp;just&nbsp;added&nbsp;to&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4457172">for</span>&nbsp;<span class="ident" id="4457176">i</span>&nbsp;<span class="op" id="4457178">:=</span>&nbsp;<span class="num" id="4457181">0</span><span class="op" id="4457182">;</span>&nbsp;<span class="ident" id="4457184">i</span>&nbsp;<span class="op" id="4457186">&lt;</span>&nbsp;<span class="num" id="4457188">3</span><span class="op" id="4457189">;</span>&nbsp;<span class="ident" id="4457191">i</span><span class="op" id="4457192">++</span>&nbsp;<span class="op" id="4457195">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4457199">mask</span>&nbsp;<span class="op" id="4457204">:=</span>&nbsp;<span class="builtintype" id="4457207">uint32</span><span class="op" id="4457213">(</span><span class="builtintype" id="4457214">int32</span><span class="op" id="4457219">(</span><span class="ident" id="4457220">out</span><span class="op" id="4457223">[</span><span class="ident" id="4457224">i</span><span class="op" id="4457225">]</span><span class="op" id="4457226">)</span>&nbsp;<span class="op" id="4457228">&gt;&gt;</span>&nbsp;<span class="num" id="4457231">31</span><span class="op" id="4457233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4457237">out</span><span class="op" id="4457240">[</span><span class="ident" id="4457241">i</span><span class="op" id="4457242">]</span>&nbsp;<span class="op" id="4457244">+=</span>&nbsp;<span class="op" id="4457247">(</span><span class="num" id="4457248">1</span>&nbsp;<span class="op" id="4457250">&lt;&lt;</span>&nbsp;<span class="num" id="4457253">28</span><span class="op" id="4457255">)</span>&nbsp;<span class="op" id="4457257">&amp;</span>&nbsp;<span class="ident" id="4457259">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4457266">out</span><span class="op" id="4457269">[</span><span class="ident" id="4457270">i</span><span class="op" id="4457271">+</span><span class="num" id="4457272">1</span><span class="op" id="4457273">]</span>&nbsp;<span class="op" id="4457275">-=</span>&nbsp;<span class="num" id="4457278">1</span>&nbsp;<span class="op" id="4457280">&amp;</span>&nbsp;<span class="ident" id="4457282">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4457288">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4457292">//&nbsp;We&nbsp;might&nbsp;have&nbsp;pushed&nbsp;out[3]&nbsp;over&nbsp;2**28&nbsp;so&nbsp;we&nbsp;perform&nbsp;another,&nbsp;partial,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4457367">//&nbsp;carry&nbsp;chain.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4457384">for</span>&nbsp;<span class="ident" id="4457388">i</span>&nbsp;<span class="op" id="4457390">:=</span>&nbsp;<span class="num" id="4457393">3</span><span class="op" id="4457394">;</span>&nbsp;<span class="ident" id="4457396">i</span>&nbsp;<span class="op" id="4457398">&lt;</span>&nbsp;<span class="num" id="4457400">7</span><span class="op" id="4457401">;</span>&nbsp;<span class="ident" id="4457403">i</span><span class="op" id="4457404">++</span>&nbsp;<span class="op" id="4457407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4457411">out</span><span class="op" id="4457414">[</span><span class="ident" id="4457415">i</span><span class="op" id="4457416">+</span><span class="num" id="4457417">1</span><span class="op" id="4457418">]</span>&nbsp;<span class="op" id="4457420">+=</span>&nbsp;<span class="ident" id="4457423">out</span><span class="op" id="4457426">[</span><span class="ident" id="4457427">i</span><span class="op" id="4457428">]</span>&nbsp;<span class="op" id="4457430">&gt;&gt;</span>&nbsp;<span class="num" id="4457433">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4457438">out</span><span class="op" id="4457441">[</span><span class="ident" id="4457442">i</span><span class="op" id="4457443">]</span>&nbsp;<span class="op" id="4457445">&amp;=</span>&nbsp;<span class="ident" id="4457448">bottom28Bits</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4457462">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4457465">top</span>&nbsp;<span class="op" id="4457469">=</span>&nbsp;<span class="ident" id="4457471">out</span><span class="op" id="4457474">[</span><span class="num" id="4457475">7</span><span class="op" id="4457476">]</span>&nbsp;<span class="op" id="4457478">&gt;&gt;</span>&nbsp;<span class="num" id="4457481">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4457485">out</span><span class="op" id="4457488">[</span><span class="num" id="4457489">7</span><span class="op" id="4457490">]</span>&nbsp;<span class="op" id="4457492">&amp;=</span>&nbsp;<span class="ident" id="4457495">bottom28Bits</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4457510">//&nbsp;Eliminate&nbsp;top&nbsp;while&nbsp;maintaining&nbsp;the&nbsp;same&nbsp;value&nbsp;mod&nbsp;p.</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4457568">out</span><span class="op" id="4457571">[</span><span class="num" id="4457572">0</span><span class="op" id="4457573">]</span>&nbsp;<span class="op" id="4457575">-=</span>&nbsp;<span class="ident" id="4457578">top</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4457583">out</span><span class="op" id="4457586">[</span><span class="num" id="4457587">3</span><span class="op" id="4457588">]</span>&nbsp;<span class="op" id="4457590">+=</span>&nbsp;<span class="ident" id="4457593">top</span>&nbsp;<span class="op" id="4457597">&lt;&lt;</span>&nbsp;<span class="num" id="4457600">12</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4457605">//&nbsp;There&nbsp;are&nbsp;two&nbsp;cases&nbsp;to&nbsp;consider&nbsp;for&nbsp;out[3]:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4457653">//&nbsp;&nbsp;&nbsp;1)&nbsp;The&nbsp;first&nbsp;time&nbsp;that&nbsp;we&nbsp;eliminated&nbsp;top,&nbsp;we&nbsp;didn&#39;t&nbsp;push&nbsp;out[3]&nbsp;over</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4457728">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2**28.&nbsp;In&nbsp;this&nbsp;case,&nbsp;the&nbsp;partial&nbsp;carry&nbsp;chain&nbsp;didn&#39;t&nbsp;change&nbsp;any&nbsp;values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4457807">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;top&nbsp;is&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4457833">//&nbsp;&nbsp;&nbsp;2)&nbsp;We&nbsp;did&nbsp;push&nbsp;out[3]&nbsp;over&nbsp;2**28&nbsp;the&nbsp;first&nbsp;time&nbsp;that&nbsp;we&nbsp;eliminated&nbsp;top.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4457911">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;first&nbsp;value&nbsp;of&nbsp;top&nbsp;was&nbsp;in&nbsp;[0..16),&nbsp;therefore,&nbsp;prior&nbsp;to&nbsp;eliminating</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4457991">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;first&nbsp;top,&nbsp;0xfff1000&nbsp;&lt;=&nbsp;out[3]&nbsp;&lt;=&nbsp;0xfffffff.&nbsp;Therefore,&nbsp;after</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4458066">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;overflowing&nbsp;and&nbsp;being&nbsp;reduced&nbsp;by&nbsp;the&nbsp;second&nbsp;carry&nbsp;chain,&nbsp;out[3]&nbsp;&lt;=</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4458142">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0xf000.&nbsp;Thus&nbsp;it&nbsp;cannot&nbsp;have&nbsp;overflowed&nbsp;when&nbsp;we&nbsp;eliminated&nbsp;top&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4458221">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;second&nbsp;time.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4458244">//&nbsp;Again,&nbsp;we&nbsp;may&nbsp;just&nbsp;have&nbsp;made&nbsp;out[0]&nbsp;negative,&nbsp;so&nbsp;do&nbsp;the&nbsp;same&nbsp;carry&nbsp;down.</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4458321">//&nbsp;As&nbsp;before,&nbsp;if&nbsp;we&nbsp;made&nbsp;out[0]&nbsp;negative&nbsp;then&nbsp;we&nbsp;know&nbsp;that&nbsp;out[3]&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4458391">//&nbsp;sufficiently&nbsp;positive.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4458418">for</span>&nbsp;<span class="ident" id="4458422">i</span>&nbsp;<span class="op" id="4458424">:=</span>&nbsp;<span class="num" id="4458427">0</span><span class="op" id="4458428">;</span>&nbsp;<span class="ident" id="4458430">i</span>&nbsp;<span class="op" id="4458432">&lt;</span>&nbsp;<span class="num" id="4458434">3</span><span class="op" id="4458435">;</span>&nbsp;<span class="ident" id="4458437">i</span><span class="op" id="4458438">++</span>&nbsp;<span class="op" id="4458441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4458445">mask</span>&nbsp;<span class="op" id="4458450">:=</span>&nbsp;<span class="builtintype" id="4458453">uint32</span><span class="op" id="4458459">(</span><span class="builtintype" id="4458460">int32</span><span class="op" id="4458465">(</span><span class="ident" id="4458466">out</span><span class="op" id="4458469">[</span><span class="ident" id="4458470">i</span><span class="op" id="4458471">]</span><span class="op" id="4458472">)</span>&nbsp;<span class="op" id="4458474">&gt;&gt;</span>&nbsp;<span class="num" id="4458477">31</span><span class="op" id="4458479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4458483">out</span><span class="op" id="4458486">[</span><span class="ident" id="4458487">i</span><span class="op" id="4458488">]</span>&nbsp;<span class="op" id="4458490">+=</span>&nbsp;<span class="op" id="4458493">(</span><span class="num" id="4458494">1</span>&nbsp;<span class="op" id="4458496">&lt;&lt;</span>&nbsp;<span class="num" id="4458499">28</span><span class="op" id="4458501">)</span>&nbsp;<span class="op" id="4458503">&amp;</span>&nbsp;<span class="ident" id="4458505">mask</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4458512">out</span><span class="op" id="4458515">[</span><span class="ident" id="4458516">i</span><span class="op" id="4458517">+</span><span class="num" id="4458518">1</span><span class="op" id="4458519">]</span>&nbsp;<span class="op" id="4458521">-=</span>&nbsp;<span class="num" id="4458524">1</span>&nbsp;<span class="op" id="4458526">&amp;</span>&nbsp;<span class="ident" id="4458528">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4458534">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4458538">//&nbsp;Now&nbsp;we&nbsp;see&nbsp;if&nbsp;the&nbsp;value&nbsp;is&nbsp;&gt;=&nbsp;p&nbsp;and,&nbsp;if&nbsp;so,&nbsp;subtract&nbsp;p.</span><br>
<span class="lineno"></span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4458599">//&nbsp;First&nbsp;we&nbsp;build&nbsp;a&nbsp;mask&nbsp;from&nbsp;the&nbsp;top&nbsp;four&nbsp;limbs,&nbsp;which&nbsp;must&nbsp;all&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4458668">//&nbsp;equal&nbsp;to&nbsp;bottom28Bits&nbsp;if&nbsp;the&nbsp;whole&nbsp;value&nbsp;is&nbsp;&gt;=&nbsp;p.&nbsp;If&nbsp;top4AllOnes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4458737">//&nbsp;ends&nbsp;up&nbsp;with&nbsp;any&nbsp;zero&nbsp;bits&nbsp;in&nbsp;the&nbsp;bottom&nbsp;28&nbsp;bits,&nbsp;then&nbsp;this&nbsp;wasn&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4458808">//&nbsp;true.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4458818">top4AllOnes</span>&nbsp;<span class="op" id="4458830">:=</span>&nbsp;<span class="builtintype" id="4458833">uint32</span><span class="op" id="4458839">(</span><span class="num" id="4458840">0xffffffff</span><span class="op" id="4458850">)</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4458853">for</span>&nbsp;<span class="ident" id="4458857">i</span>&nbsp;<span class="op" id="4458859">:=</span>&nbsp;<span class="num" id="4458862">4</span><span class="op" id="4458863">;</span>&nbsp;<span class="ident" id="4458865">i</span>&nbsp;<span class="op" id="4458867">&lt;</span>&nbsp;<span class="num" id="4458869">8</span><span class="op" id="4458870">;</span>&nbsp;<span class="ident" id="4458872">i</span><span class="op" id="4458873">++</span>&nbsp;<span class="op" id="4458876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4458880">top4AllOnes</span>&nbsp;<span class="op" id="4458892">&amp;=</span>&nbsp;<span class="ident" id="4458895">out</span><span class="op" id="4458898">[</span><span class="ident" id="4458899">i</span><span class="op" id="4458900">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4458903">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4458906">top4AllOnes</span>&nbsp;<span class="op" id="4458918">|=</span>&nbsp;<span class="num" id="4458921">0xf0000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4458933">//&nbsp;Now&nbsp;we&nbsp;replicate&nbsp;any&nbsp;zero&nbsp;bits&nbsp;to&nbsp;all&nbsp;the&nbsp;bits&nbsp;in&nbsp;top4AllOnes.</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459000">top4AllOnes</span>&nbsp;<span class="op" id="4459012">&amp;=</span>&nbsp;<span class="ident" id="4459015">top4AllOnes</span>&nbsp;<span class="op" id="4459027">&gt;&gt;</span>&nbsp;<span class="num" id="4459030">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459034">top4AllOnes</span>&nbsp;<span class="op" id="4459046">&amp;=</span>&nbsp;<span class="ident" id="4459049">top4AllOnes</span>&nbsp;<span class="op" id="4459061">&gt;&gt;</span>&nbsp;<span class="num" id="4459064">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459067">top4AllOnes</span>&nbsp;<span class="op" id="4459079">&amp;=</span>&nbsp;<span class="ident" id="4459082">top4AllOnes</span>&nbsp;<span class="op" id="4459094">&gt;&gt;</span>&nbsp;<span class="num" id="4459097">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459100">top4AllOnes</span>&nbsp;<span class="op" id="4459112">&amp;=</span>&nbsp;<span class="ident" id="4459115">top4AllOnes</span>&nbsp;<span class="op" id="4459127">&gt;&gt;</span>&nbsp;<span class="num" id="4459130">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459133">top4AllOnes</span>&nbsp;<span class="op" id="4459145">&amp;=</span>&nbsp;<span class="ident" id="4459148">top4AllOnes</span>&nbsp;<span class="op" id="4459160">&gt;&gt;</span>&nbsp;<span class="num" id="4459163">1</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459166">top4AllOnes</span>&nbsp;<span class="op" id="4459178">=</span>&nbsp;<span class="builtintype" id="4459180">uint32</span><span class="op" id="4459186">(</span><span class="builtintype" id="4459187">int32</span><span class="op" id="4459192">(</span><span class="ident" id="4459193">top4AllOnes</span><span class="op" id="4459204">&lt;&lt;</span><span class="num" id="4459206">31</span><span class="op" id="4459208">)</span>&nbsp;<span class="op" id="4459210">&gt;&gt;</span>&nbsp;<span class="num" id="4459213">31</span><span class="op" id="4459215">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4459219">//&nbsp;Now&nbsp;we&nbsp;test&nbsp;whether&nbsp;the&nbsp;bottom&nbsp;three&nbsp;limbs&nbsp;are&nbsp;non-zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459280">bottom3NonZero</span>&nbsp;<span class="op" id="4459295">:=</span>&nbsp;<span class="ident" id="4459298">out</span><span class="op" id="4459301">[</span><span class="num" id="4459302">0</span><span class="op" id="4459303">]</span>&nbsp;<span class="op" id="4459305">|</span>&nbsp;<span class="ident" id="4459307">out</span><span class="op" id="4459310">[</span><span class="num" id="4459311">1</span><span class="op" id="4459312">]</span>&nbsp;<span class="op" id="4459314">|</span>&nbsp;<span class="ident" id="4459316">out</span><span class="op" id="4459319">[</span><span class="num" id="4459320">2</span><span class="op" id="4459321">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459324">bottom3NonZero</span>&nbsp;<span class="op" id="4459339">|=</span>&nbsp;<span class="ident" id="4459342">bottom3NonZero</span>&nbsp;<span class="op" id="4459357">&gt;&gt;</span>&nbsp;<span class="num" id="4459360">16</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459364">bottom3NonZero</span>&nbsp;<span class="op" id="4459379">|=</span>&nbsp;<span class="ident" id="4459382">bottom3NonZero</span>&nbsp;<span class="op" id="4459397">&gt;&gt;</span>&nbsp;<span class="num" id="4459400">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459403">bottom3NonZero</span>&nbsp;<span class="op" id="4459418">|=</span>&nbsp;<span class="ident" id="4459421">bottom3NonZero</span>&nbsp;<span class="op" id="4459436">&gt;&gt;</span>&nbsp;<span class="num" id="4459439">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459442">bottom3NonZero</span>&nbsp;<span class="op" id="4459457">|=</span>&nbsp;<span class="ident" id="4459460">bottom3NonZero</span>&nbsp;<span class="op" id="4459475">&gt;&gt;</span>&nbsp;<span class="num" id="4459478">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459481">bottom3NonZero</span>&nbsp;<span class="op" id="4459496">|=</span>&nbsp;<span class="ident" id="4459499">bottom3NonZero</span>&nbsp;<span class="op" id="4459514">&gt;&gt;</span>&nbsp;<span class="num" id="4459517">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459520">bottom3NonZero</span>&nbsp;<span class="op" id="4459535">=</span>&nbsp;<span class="builtintype" id="4459537">uint32</span><span class="op" id="4459543">(</span><span class="builtintype" id="4459544">int32</span><span class="op" id="4459549">(</span><span class="ident" id="4459550">bottom3NonZero</span><span class="op" id="4459564">&lt;&lt;</span><span class="num" id="4459566">31</span><span class="op" id="4459568">)</span>&nbsp;<span class="op" id="4459570">&gt;&gt;</span>&nbsp;<span class="num" id="4459573">31</span><span class="op" id="4459575">)</span><br>
<span class="lineno">470</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4459579">//&nbsp;Everything&nbsp;depends&nbsp;on&nbsp;the&nbsp;value&nbsp;of&nbsp;out[3].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4459626">//&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;it&#39;s&nbsp;&gt;&nbsp;0xffff000&nbsp;and&nbsp;top4AllOnes&nbsp;!=&nbsp;0&nbsp;then&nbsp;the&nbsp;whole&nbsp;value&nbsp;is&nbsp;&gt;=&nbsp;p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4459703">//&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;it&#39;s&nbsp;=&nbsp;0xffff000&nbsp;and&nbsp;top4AllOnes&nbsp;!=&nbsp;0&nbsp;and&nbsp;bottom3NonZero&nbsp;!=&nbsp;0,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4459776">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;the&nbsp;whole&nbsp;value&nbsp;is&nbsp;&gt;=&nbsp;p</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4459814">//&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;it&#39;s&nbsp;&lt;&nbsp;0xffff000,&nbsp;then&nbsp;the&nbsp;whole&nbsp;value&nbsp;is&nbsp;&lt;&nbsp;p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459870">n</span>&nbsp;<span class="op" id="4459872">:=</span>&nbsp;<span class="ident" id="4459875">out</span><span class="op" id="4459878">[</span><span class="num" id="4459879">3</span><span class="op" id="4459880">]</span>&nbsp;<span class="op" id="4459882">-</span>&nbsp;<span class="num" id="4459884">0xffff000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459895">out3Equal</span>&nbsp;<span class="op" id="4459905">:=</span>&nbsp;<span class="ident" id="4459908">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459911">out3Equal</span>&nbsp;<span class="op" id="4459921">|=</span>&nbsp;<span class="ident" id="4459924">out3Equal</span>&nbsp;<span class="op" id="4459934">&gt;&gt;</span>&nbsp;<span class="num" id="4459937">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459941">out3Equal</span>&nbsp;<span class="op" id="4459951">|=</span>&nbsp;<span class="ident" id="4459954">out3Equal</span>&nbsp;<span class="op" id="4459964">&gt;&gt;</span>&nbsp;<span class="num" id="4459967">8</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459970">out3Equal</span>&nbsp;<span class="op" id="4459980">|=</span>&nbsp;<span class="ident" id="4459983">out3Equal</span>&nbsp;<span class="op" id="4459993">&gt;&gt;</span>&nbsp;<span class="num" id="4459996">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459999">out3Equal</span>&nbsp;<span class="op" id="4460009">|=</span>&nbsp;<span class="ident" id="4460012">out3Equal</span>&nbsp;<span class="op" id="4460022">&gt;&gt;</span>&nbsp;<span class="num" id="4460025">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4460028">out3Equal</span>&nbsp;<span class="op" id="4460038">|=</span>&nbsp;<span class="ident" id="4460041">out3Equal</span>&nbsp;<span class="op" id="4460051">&gt;&gt;</span>&nbsp;<span class="num" id="4460054">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4460057">out3Equal</span>&nbsp;<span class="op" id="4460067">=</span>&nbsp;<span class="op" id="4460069">^</span><span class="builtintype" id="4460070">uint32</span><span class="op" id="4460076">(</span><span class="builtintype" id="4460077">int32</span><span class="op" id="4460082">(</span><span class="ident" id="4460083">out3Equal</span><span class="op" id="4460092">&lt;&lt;</span><span class="num" id="4460094">31</span><span class="op" id="4460096">)</span>&nbsp;<span class="op" id="4460098">&gt;&gt;</span>&nbsp;<span class="num" id="4460101">31</span><span class="op" id="4460103">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4460107">//&nbsp;If&nbsp;out[3]&nbsp;&gt;&nbsp;0xffff000&nbsp;then&nbsp;n&#39;s&nbsp;MSB&nbsp;will&nbsp;be&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4460160">out3GT</span>&nbsp;<span class="op" id="4460167">:=</span>&nbsp;<span class="op" id="4460170">^</span><span class="builtintype" id="4460171">uint32</span><span class="op" id="4460177">(</span><span class="builtintype" id="4460178">int32</span><span class="op" id="4460183">(</span><span class="ident" id="4460184">n</span><span class="op" id="4460185">)</span>&nbsp;<span class="op" id="4460187">&gt;&gt;</span>&nbsp;<span class="num" id="4460190">31</span><span class="op" id="4460192">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4460196">mask</span>&nbsp;<span class="op" id="4460201">:=</span>&nbsp;<span class="ident" id="4460204">top4AllOnes</span>&nbsp;<span class="op" id="4460216">&amp;</span>&nbsp;<span class="op" id="4460218">(</span><span class="op" id="4460219">(</span><span class="ident" id="4460220">out3Equal</span>&nbsp;<span class="op" id="4460230">&amp;</span>&nbsp;<span class="ident" id="4460232">bottom3NonZero</span><span class="op" id="4460246">)</span>&nbsp;<span class="op" id="4460248">|</span>&nbsp;<span class="ident" id="4460250">out3GT</span><span class="op" id="4460256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4460259">out</span><span class="op" id="4460262">[</span><span class="num" id="4460263">0</span><span class="op" id="4460264">]</span>&nbsp;<span class="op" id="4460266">-=</span>&nbsp;<span class="num" id="4460269">1</span>&nbsp;<span class="op" id="4460271">&amp;</span>&nbsp;<span class="ident" id="4460273">mask</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4460279">out</span><span class="op" id="4460282">[</span><span class="num" id="4460283">3</span><span class="op" id="4460284">]</span>&nbsp;<span class="op" id="4460286">-=</span>&nbsp;<span class="num" id="4460289">0xffff000</span>&nbsp;<span class="op" id="4460299">&amp;</span>&nbsp;<span class="ident" id="4460301">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4460307">out</span><span class="op" id="4460310">[</span><span class="num" id="4460311">4</span><span class="op" id="4460312">]</span>&nbsp;<span class="op" id="4460314">-=</span>&nbsp;<span class="num" id="4460317">0xfffffff</span>&nbsp;<span class="op" id="4460327">&amp;</span>&nbsp;<span class="ident" id="4460329">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4460335">out</span><span class="op" id="4460338">[</span><span class="num" id="4460339">5</span><span class="op" id="4460340">]</span>&nbsp;<span class="op" id="4460342">-=</span>&nbsp;<span class="num" id="4460345">0xfffffff</span>&nbsp;<span class="op" id="4460355">&amp;</span>&nbsp;<span class="ident" id="4460357">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4460363">out</span><span class="op" id="4460366">[</span><span class="num" id="4460367">6</span><span class="op" id="4460368">]</span>&nbsp;<span class="op" id="4460370">-=</span>&nbsp;<span class="num" id="4460373">0xfffffff</span>&nbsp;<span class="op" id="4460383">&amp;</span>&nbsp;<span class="ident" id="4460385">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4460391">out</span><span class="op" id="4460394">[</span><span class="num" id="4460395">7</span><span class="op" id="4460396">]</span>&nbsp;<span class="op" id="4460398">-=</span>&nbsp;<span class="num" id="4460401">0xfffffff</span>&nbsp;<span class="op" id="4460411">&amp;</span>&nbsp;<span class="ident" id="4460413">mask</span><br>
<span class="lineno">495</span><span class="op" id="4460418">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4460421">//&nbsp;Group&nbsp;element&nbsp;functions.</span><br>
<span class="lineno"></span><span class="comment" id="4460449">//</span><br>
<span class="lineno"></span><span class="comment" id="4460452">//&nbsp;These&nbsp;functions&nbsp;deal&nbsp;with&nbsp;group&nbsp;elements.&nbsp;The&nbsp;group&nbsp;is&nbsp;an&nbsp;elliptic&nbsp;curve</span><br>
<span class="lineno">500</span><span class="comment" id="4460528">//&nbsp;group&nbsp;with&nbsp;a&nbsp;=&nbsp;-3&nbsp;defined&nbsp;in&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.2.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4460588">//&nbsp;p224AddJacobian&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a+b&nbsp;where&nbsp;a&nbsp;!=&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="4460641">func</span>&nbsp;<span class="ident" id="4460646">p224AddJacobian</span><span class="op" id="4460661">(</span><span class="ident" id="4460662">x3</span><span class="op" id="4460664">,</span>&nbsp;<span class="ident" id="4460666">y3</span><span class="op" id="4460668">,</span>&nbsp;<span class="ident" id="4460670">z3</span><span class="op" id="4460672">,</span>&nbsp;<span class="ident" id="4460674">x1</span><span class="op" id="4460676">,</span>&nbsp;<span class="ident" id="4460678">y1</span><span class="op" id="4460680">,</span>&nbsp;<span class="ident" id="4460682">z1</span><span class="op" id="4460684">,</span>&nbsp;<span class="ident" id="4460686">x2</span><span class="op" id="4460688">,</span>&nbsp;<span class="ident" id="4460690">y2</span><span class="op" id="4460692">,</span>&nbsp;<span class="ident" id="4460694">z2</span>&nbsp;<span class="op" id="4460697">*</span><span class="ident" id="4460698">p224FieldElement</span><span class="op" id="4460714">)</span>&nbsp;<span class="op" id="4460716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4460719">//&nbsp;See&nbsp;http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-3.html#addition-p224Add-2007-bl</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4460813">var</span>&nbsp;<span class="ident" id="4460817">z1z1</span><span class="op" id="4460821">,</span>&nbsp;<span class="ident" id="4460823">z2z2</span><span class="op" id="4460827">,</span>&nbsp;<span class="ident" id="4460829">u1</span><span class="op" id="4460831">,</span>&nbsp;<span class="ident" id="4460833">u2</span><span class="op" id="4460835">,</span>&nbsp;<span class="ident" id="4460837">s1</span><span class="op" id="4460839">,</span>&nbsp;<span class="ident" id="4460841">s2</span><span class="op" id="4460843">,</span>&nbsp;<span class="ident" id="4460845">h</span><span class="op" id="4460846">,</span>&nbsp;<span class="ident" id="4460848">i</span><span class="op" id="4460849">,</span>&nbsp;<span class="ident" id="4460851">j</span><span class="op" id="4460852">,</span>&nbsp;<span class="ident" id="4460854">r</span><span class="op" id="4460855">,</span>&nbsp;<span class="ident" id="4460857">v</span>&nbsp;<span class="ident" id="4460859">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4460877">var</span>&nbsp;<span class="ident" id="4460881">c</span>&nbsp;<span class="ident" id="4460883">p224LargeFieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4460907">z1IsZero</span>&nbsp;<span class="op" id="4460916">:=</span>&nbsp;<span class="ident" id="4460919">p224IsZero</span><span class="op" id="4460929">(</span><span class="ident" id="4460930">z1</span><span class="op" id="4460932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4460935">z2IsZero</span>&nbsp;<span class="op" id="4460944">:=</span>&nbsp;<span class="ident" id="4460947">p224IsZero</span><span class="op" id="4460957">(</span><span class="ident" id="4460958">z2</span><span class="op" id="4460960">)</span><br>
<span class="lineno">510</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4460964">//&nbsp;Z1Z1&nbsp;=&nbsp;Z1²</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4460980">p224Square</span><span class="op" id="4460990">(</span><span class="op" id="4460991">&amp;</span><span class="ident" id="4460992">z1z1</span><span class="op" id="4460996">,</span>&nbsp;<span class="ident" id="4460998">z1</span><span class="op" id="4461000">,</span>&nbsp;<span class="op" id="4461002">&amp;</span><span class="ident" id="4461003">c</span><span class="op" id="4461004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4461007">//&nbsp;Z2Z2&nbsp;=&nbsp;Z2²</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461023">p224Square</span><span class="op" id="4461033">(</span><span class="op" id="4461034">&amp;</span><span class="ident" id="4461035">z2z2</span><span class="op" id="4461039">,</span>&nbsp;<span class="ident" id="4461041">z2</span><span class="op" id="4461043">,</span>&nbsp;<span class="op" id="4461045">&amp;</span><span class="ident" id="4461046">c</span><span class="op" id="4461047">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4461050">//&nbsp;U1&nbsp;=&nbsp;X1*Z2Z2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461067">p224Mul</span><span class="op" id="4461074">(</span><span class="op" id="4461075">&amp;</span><span class="ident" id="4461076">u1</span><span class="op" id="4461078">,</span>&nbsp;<span class="ident" id="4461080">x1</span><span class="op" id="4461082">,</span>&nbsp;<span class="op" id="4461084">&amp;</span><span class="ident" id="4461085">z2z2</span><span class="op" id="4461089">,</span>&nbsp;<span class="op" id="4461091">&amp;</span><span class="ident" id="4461092">c</span><span class="op" id="4461093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4461096">//&nbsp;U2&nbsp;=&nbsp;X2*Z1Z1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461113">p224Mul</span><span class="op" id="4461120">(</span><span class="op" id="4461121">&amp;</span><span class="ident" id="4461122">u2</span><span class="op" id="4461124">,</span>&nbsp;<span class="ident" id="4461126">x2</span><span class="op" id="4461128">,</span>&nbsp;<span class="op" id="4461130">&amp;</span><span class="ident" id="4461131">z1z1</span><span class="op" id="4461135">,</span>&nbsp;<span class="op" id="4461137">&amp;</span><span class="ident" id="4461138">c</span><span class="op" id="4461139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4461142">//&nbsp;S1&nbsp;=&nbsp;Y1*Z2*Z2Z2</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461162">p224Mul</span><span class="op" id="4461169">(</span><span class="op" id="4461170">&amp;</span><span class="ident" id="4461171">s1</span><span class="op" id="4461173">,</span>&nbsp;<span class="ident" id="4461175">z2</span><span class="op" id="4461177">,</span>&nbsp;<span class="op" id="4461179">&amp;</span><span class="ident" id="4461180">z2z2</span><span class="op" id="4461184">,</span>&nbsp;<span class="op" id="4461186">&amp;</span><span class="ident" id="4461187">c</span><span class="op" id="4461188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461191">p224Mul</span><span class="op" id="4461198">(</span><span class="op" id="4461199">&amp;</span><span class="ident" id="4461200">s1</span><span class="op" id="4461202">,</span>&nbsp;<span class="ident" id="4461204">y1</span><span class="op" id="4461206">,</span>&nbsp;<span class="op" id="4461208">&amp;</span><span class="ident" id="4461209">s1</span><span class="op" id="4461211">,</span>&nbsp;<span class="op" id="4461213">&amp;</span><span class="ident" id="4461214">c</span><span class="op" id="4461215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4461218">//&nbsp;S2&nbsp;=&nbsp;Y2*Z1*Z1Z1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461238">p224Mul</span><span class="op" id="4461245">(</span><span class="op" id="4461246">&amp;</span><span class="ident" id="4461247">s2</span><span class="op" id="4461249">,</span>&nbsp;<span class="ident" id="4461251">z1</span><span class="op" id="4461253">,</span>&nbsp;<span class="op" id="4461255">&amp;</span><span class="ident" id="4461256">z1z1</span><span class="op" id="4461260">,</span>&nbsp;<span class="op" id="4461262">&amp;</span><span class="ident" id="4461263">c</span><span class="op" id="4461264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461267">p224Mul</span><span class="op" id="4461274">(</span><span class="op" id="4461275">&amp;</span><span class="ident" id="4461276">s2</span><span class="op" id="4461278">,</span>&nbsp;<span class="ident" id="4461280">y2</span><span class="op" id="4461282">,</span>&nbsp;<span class="op" id="4461284">&amp;</span><span class="ident" id="4461285">s2</span><span class="op" id="4461287">,</span>&nbsp;<span class="op" id="4461289">&amp;</span><span class="ident" id="4461290">c</span><span class="op" id="4461291">)</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4461294">//&nbsp;H&nbsp;=&nbsp;U2-U1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461308">p224Sub</span><span class="op" id="4461315">(</span><span class="op" id="4461316">&amp;</span><span class="ident" id="4461317">h</span><span class="op" id="4461318">,</span>&nbsp;<span class="op" id="4461320">&amp;</span><span class="ident" id="4461321">u2</span><span class="op" id="4461323">,</span>&nbsp;<span class="op" id="4461325">&amp;</span><span class="ident" id="4461326">u1</span><span class="op" id="4461328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461331">p224Reduce</span><span class="op" id="4461341">(</span><span class="op" id="4461342">&amp;</span><span class="ident" id="4461343">h</span><span class="op" id="4461344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461347">xEqual</span>&nbsp;<span class="op" id="4461354">:=</span>&nbsp;<span class="ident" id="4461357">p224IsZero</span><span class="op" id="4461367">(</span><span class="op" id="4461368">&amp;</span><span class="ident" id="4461369">h</span><span class="op" id="4461370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4461373">//&nbsp;I&nbsp;=&nbsp;(2*H)²</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4461389">for</span>&nbsp;<span class="ident" id="4461393">j</span>&nbsp;<span class="op" id="4461395">:=</span>&nbsp;<span class="num" id="4461398">0</span><span class="op" id="4461399">;</span>&nbsp;<span class="ident" id="4461401">j</span>&nbsp;<span class="op" id="4461403">&lt;</span>&nbsp;<span class="num" id="4461405">8</span><span class="op" id="4461406">;</span>&nbsp;<span class="ident" id="4461408">j</span><span class="op" id="4461409">++</span>&nbsp;<span class="op" id="4461412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461416">i</span><span class="op" id="4461417">[</span><span class="ident" id="4461418">j</span><span class="op" id="4461419">]</span>&nbsp;<span class="op" id="4461421">=</span>&nbsp;<span class="ident" id="4461423">h</span><span class="op" id="4461424">[</span><span class="ident" id="4461425">j</span><span class="op" id="4461426">]</span>&nbsp;<span class="op" id="4461428">&lt;&lt;</span>&nbsp;<span class="num" id="4461431">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4461434">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461437">p224Reduce</span><span class="op" id="4461447">(</span><span class="op" id="4461448">&amp;</span><span class="ident" id="4461449">i</span><span class="op" id="4461450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461453">p224Square</span><span class="op" id="4461463">(</span><span class="op" id="4461464">&amp;</span><span class="ident" id="4461465">i</span><span class="op" id="4461466">,</span>&nbsp;<span class="op" id="4461468">&amp;</span><span class="ident" id="4461469">i</span><span class="op" id="4461470">,</span>&nbsp;<span class="op" id="4461472">&amp;</span><span class="ident" id="4461473">c</span><span class="op" id="4461474">)</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4461477">//&nbsp;J&nbsp;=&nbsp;H*I</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461489">p224Mul</span><span class="op" id="4461496">(</span><span class="op" id="4461497">&amp;</span><span class="ident" id="4461498">j</span><span class="op" id="4461499">,</span>&nbsp;<span class="op" id="4461501">&amp;</span><span class="ident" id="4461502">h</span><span class="op" id="4461503">,</span>&nbsp;<span class="op" id="4461505">&amp;</span><span class="ident" id="4461506">i</span><span class="op" id="4461507">,</span>&nbsp;<span class="op" id="4461509">&amp;</span><span class="ident" id="4461510">c</span><span class="op" id="4461511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4461514">//&nbsp;r&nbsp;=&nbsp;2*(S2-S1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461532">p224Sub</span><span class="op" id="4461539">(</span><span class="op" id="4461540">&amp;</span><span class="ident" id="4461541">r</span><span class="op" id="4461542">,</span>&nbsp;<span class="op" id="4461544">&amp;</span><span class="ident" id="4461545">s2</span><span class="op" id="4461547">,</span>&nbsp;<span class="op" id="4461549">&amp;</span><span class="ident" id="4461550">s1</span><span class="op" id="4461552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461555">p224Reduce</span><span class="op" id="4461565">(</span><span class="op" id="4461566">&amp;</span><span class="ident" id="4461567">r</span><span class="op" id="4461568">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461571">yEqual</span>&nbsp;<span class="op" id="4461578">:=</span>&nbsp;<span class="ident" id="4461581">p224IsZero</span><span class="op" id="4461591">(</span><span class="op" id="4461592">&amp;</span><span class="ident" id="4461593">r</span><span class="op" id="4461594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4461597">if</span>&nbsp;<span class="ident" id="4461600">xEqual</span>&nbsp;<span class="op" id="4461607">==</span>&nbsp;<span class="num" id="4461610">1</span>&nbsp;<span class="op" id="4461612">&amp;&amp;</span>&nbsp;<span class="ident" id="4461615">yEqual</span>&nbsp;<span class="op" id="4461622">==</span>&nbsp;<span class="num" id="4461625">1</span>&nbsp;<span class="op" id="4461627">&amp;&amp;</span>&nbsp;<span class="ident" id="4461630">z1IsZero</span>&nbsp;<span class="op" id="4461639">==</span>&nbsp;<span class="num" id="4461642">0</span>&nbsp;<span class="op" id="4461644">&amp;&amp;</span>&nbsp;<span class="ident" id="4461647">z2IsZero</span>&nbsp;<span class="op" id="4461656">==</span>&nbsp;<span class="num" id="4461659">0</span>&nbsp;<span class="op" id="4461661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461665">p224DoubleJacobian</span><span class="op" id="4461683">(</span><span class="ident" id="4461684">x3</span><span class="op" id="4461686">,</span>&nbsp;<span class="ident" id="4461688">y3</span><span class="op" id="4461690">,</span>&nbsp;<span class="ident" id="4461692">z3</span><span class="op" id="4461694">,</span>&nbsp;<span class="ident" id="4461696">x1</span><span class="op" id="4461698">,</span>&nbsp;<span class="ident" id="4461700">y1</span><span class="op" id="4461702">,</span>&nbsp;<span class="ident" id="4461704">z1</span><span class="op" id="4461706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4461710">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4461718">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4461721">for</span>&nbsp;<span class="ident" id="4461725">i</span>&nbsp;<span class="op" id="4461727">:=</span>&nbsp;<span class="num" id="4461730">0</span><span class="op" id="4461731">;</span>&nbsp;<span class="ident" id="4461733">i</span>&nbsp;<span class="op" id="4461735">&lt;</span>&nbsp;<span class="num" id="4461737">8</span><span class="op" id="4461738">;</span>&nbsp;<span class="ident" id="4461740">i</span><span class="op" id="4461741">++</span>&nbsp;<span class="op" id="4461744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461748">r</span><span class="op" id="4461749">[</span><span class="ident" id="4461750">i</span><span class="op" id="4461751">]</span>&nbsp;<span class="op" id="4461753">&lt;&lt;=</span>&nbsp;<span class="num" id="4461757">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4461760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461763">p224Reduce</span><span class="op" id="4461773">(</span><span class="op" id="4461774">&amp;</span><span class="ident" id="4461775">r</span><span class="op" id="4461776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4461779">//&nbsp;V&nbsp;=&nbsp;U1*I</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461792">p224Mul</span><span class="op" id="4461799">(</span><span class="op" id="4461800">&amp;</span><span class="ident" id="4461801">v</span><span class="op" id="4461802">,</span>&nbsp;<span class="op" id="4461804">&amp;</span><span class="ident" id="4461805">u1</span><span class="op" id="4461807">,</span>&nbsp;<span class="op" id="4461809">&amp;</span><span class="ident" id="4461810">i</span><span class="op" id="4461811">,</span>&nbsp;<span class="op" id="4461813">&amp;</span><span class="ident" id="4461814">c</span><span class="op" id="4461815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4461818">//&nbsp;Z3&nbsp;=&nbsp;((Z1+Z2)²-Z1Z1-Z2Z2)*H</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461851">p224Add</span><span class="op" id="4461858">(</span><span class="op" id="4461859">&amp;</span><span class="ident" id="4461860">z1z1</span><span class="op" id="4461864">,</span>&nbsp;<span class="op" id="4461866">&amp;</span><span class="ident" id="4461867">z1z1</span><span class="op" id="4461871">,</span>&nbsp;<span class="op" id="4461873">&amp;</span><span class="ident" id="4461874">z2z2</span><span class="op" id="4461878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461881">p224Add</span><span class="op" id="4461888">(</span><span class="op" id="4461889">&amp;</span><span class="ident" id="4461890">z2z2</span><span class="op" id="4461894">,</span>&nbsp;<span class="ident" id="4461896">z1</span><span class="op" id="4461898">,</span>&nbsp;<span class="ident" id="4461900">z2</span><span class="op" id="4461902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461905">p224Reduce</span><span class="op" id="4461915">(</span><span class="op" id="4461916">&amp;</span><span class="ident" id="4461917">z2z2</span><span class="op" id="4461921">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461924">p224Square</span><span class="op" id="4461934">(</span><span class="op" id="4461935">&amp;</span><span class="ident" id="4461936">z2z2</span><span class="op" id="4461940">,</span>&nbsp;<span class="op" id="4461942">&amp;</span><span class="ident" id="4461943">z2z2</span><span class="op" id="4461947">,</span>&nbsp;<span class="op" id="4461949">&amp;</span><span class="ident" id="4461950">c</span><span class="op" id="4461951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461954">p224Sub</span><span class="op" id="4461961">(</span><span class="ident" id="4461962">z3</span><span class="op" id="4461964">,</span>&nbsp;<span class="op" id="4461966">&amp;</span><span class="ident" id="4461967">z2z2</span><span class="op" id="4461971">,</span>&nbsp;<span class="op" id="4461973">&amp;</span><span class="ident" id="4461974">z1z1</span><span class="op" id="4461978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461981">p224Reduce</span><span class="op" id="4461991">(</span><span class="ident" id="4461992">z3</span><span class="op" id="4461994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461997">p224Mul</span><span class="op" id="4462004">(</span><span class="ident" id="4462005">z3</span><span class="op" id="4462007">,</span>&nbsp;<span class="ident" id="4462009">z3</span><span class="op" id="4462011">,</span>&nbsp;<span class="op" id="4462013">&amp;</span><span class="ident" id="4462014">h</span><span class="op" id="4462015">,</span>&nbsp;<span class="op" id="4462017">&amp;</span><span class="ident" id="4462018">c</span><span class="op" id="4462019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4462022">//&nbsp;X3&nbsp;=&nbsp;r²-J-2*V</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4462041">for</span>&nbsp;<span class="ident" id="4462045">i</span>&nbsp;<span class="op" id="4462047">:=</span>&nbsp;<span class="num" id="4462050">0</span><span class="op" id="4462051">;</span>&nbsp;<span class="ident" id="4462053">i</span>&nbsp;<span class="op" id="4462055">&lt;</span>&nbsp;<span class="num" id="4462057">8</span><span class="op" id="4462058">;</span>&nbsp;<span class="ident" id="4462060">i</span><span class="op" id="4462061">++</span>&nbsp;<span class="op" id="4462064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462068">z1z1</span><span class="op" id="4462072">[</span><span class="ident" id="4462073">i</span><span class="op" id="4462074">]</span>&nbsp;<span class="op" id="4462076">=</span>&nbsp;<span class="ident" id="4462078">v</span><span class="op" id="4462079">[</span><span class="ident" id="4462080">i</span><span class="op" id="4462081">]</span>&nbsp;<span class="op" id="4462083">&lt;&lt;</span>&nbsp;<span class="num" id="4462086">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4462089">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462092">p224Add</span><span class="op" id="4462099">(</span><span class="op" id="4462100">&amp;</span><span class="ident" id="4462101">z1z1</span><span class="op" id="4462105">,</span>&nbsp;<span class="op" id="4462107">&amp;</span><span class="ident" id="4462108">j</span><span class="op" id="4462109">,</span>&nbsp;<span class="op" id="4462111">&amp;</span><span class="ident" id="4462112">z1z1</span><span class="op" id="4462116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462119">p224Reduce</span><span class="op" id="4462129">(</span><span class="op" id="4462130">&amp;</span><span class="ident" id="4462131">z1z1</span><span class="op" id="4462135">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462138">p224Square</span><span class="op" id="4462148">(</span><span class="ident" id="4462149">x3</span><span class="op" id="4462151">,</span>&nbsp;<span class="op" id="4462153">&amp;</span><span class="ident" id="4462154">r</span><span class="op" id="4462155">,</span>&nbsp;<span class="op" id="4462157">&amp;</span><span class="ident" id="4462158">c</span><span class="op" id="4462159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462162">p224Sub</span><span class="op" id="4462169">(</span><span class="ident" id="4462170">x3</span><span class="op" id="4462172">,</span>&nbsp;<span class="ident" id="4462174">x3</span><span class="op" id="4462176">,</span>&nbsp;<span class="op" id="4462178">&amp;</span><span class="ident" id="4462179">z1z1</span><span class="op" id="4462183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462186">p224Reduce</span><span class="op" id="4462196">(</span><span class="ident" id="4462197">x3</span><span class="op" id="4462199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4462202">//&nbsp;Y3&nbsp;=&nbsp;r*(V-X3)-2*S1*J</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4462227">for</span>&nbsp;<span class="ident" id="4462231">i</span>&nbsp;<span class="op" id="4462233">:=</span>&nbsp;<span class="num" id="4462236">0</span><span class="op" id="4462237">;</span>&nbsp;<span class="ident" id="4462239">i</span>&nbsp;<span class="op" id="4462241">&lt;</span>&nbsp;<span class="num" id="4462243">8</span><span class="op" id="4462244">;</span>&nbsp;<span class="ident" id="4462246">i</span><span class="op" id="4462247">++</span>&nbsp;<span class="op" id="4462250">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462254">s1</span><span class="op" id="4462256">[</span><span class="ident" id="4462257">i</span><span class="op" id="4462258">]</span>&nbsp;<span class="op" id="4462260">&lt;&lt;=</span>&nbsp;<span class="num" id="4462264">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4462267">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462270">p224Mul</span><span class="op" id="4462277">(</span><span class="op" id="4462278">&amp;</span><span class="ident" id="4462279">s1</span><span class="op" id="4462281">,</span>&nbsp;<span class="op" id="4462283">&amp;</span><span class="ident" id="4462284">s1</span><span class="op" id="4462286">,</span>&nbsp;<span class="op" id="4462288">&amp;</span><span class="ident" id="4462289">j</span><span class="op" id="4462290">,</span>&nbsp;<span class="op" id="4462292">&amp;</span><span class="ident" id="4462293">c</span><span class="op" id="4462294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462297">p224Sub</span><span class="op" id="4462304">(</span><span class="op" id="4462305">&amp;</span><span class="ident" id="4462306">z1z1</span><span class="op" id="4462310">,</span>&nbsp;<span class="op" id="4462312">&amp;</span><span class="ident" id="4462313">v</span><span class="op" id="4462314">,</span>&nbsp;<span class="ident" id="4462316">x3</span><span class="op" id="4462318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462321">p224Reduce</span><span class="op" id="4462331">(</span><span class="op" id="4462332">&amp;</span><span class="ident" id="4462333">z1z1</span><span class="op" id="4462337">)</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462340">p224Mul</span><span class="op" id="4462347">(</span><span class="op" id="4462348">&amp;</span><span class="ident" id="4462349">z1z1</span><span class="op" id="4462353">,</span>&nbsp;<span class="op" id="4462355">&amp;</span><span class="ident" id="4462356">z1z1</span><span class="op" id="4462360">,</span>&nbsp;<span class="op" id="4462362">&amp;</span><span class="ident" id="4462363">r</span><span class="op" id="4462364">,</span>&nbsp;<span class="op" id="4462366">&amp;</span><span class="ident" id="4462367">c</span><span class="op" id="4462368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462371">p224Sub</span><span class="op" id="4462378">(</span><span class="ident" id="4462379">y3</span><span class="op" id="4462381">,</span>&nbsp;<span class="op" id="4462383">&amp;</span><span class="ident" id="4462384">z1z1</span><span class="op" id="4462388">,</span>&nbsp;<span class="op" id="4462390">&amp;</span><span class="ident" id="4462391">s1</span><span class="op" id="4462393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462396">p224Reduce</span><span class="op" id="4462406">(</span><span class="ident" id="4462407">y3</span><span class="op" id="4462409">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462413">p224CopyConditional</span><span class="op" id="4462432">(</span><span class="ident" id="4462433">x3</span><span class="op" id="4462435">,</span>&nbsp;<span class="ident" id="4462437">x2</span><span class="op" id="4462439">,</span>&nbsp;<span class="ident" id="4462441">z1IsZero</span><span class="op" id="4462449">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462452">p224CopyConditional</span><span class="op" id="4462471">(</span><span class="ident" id="4462472">x3</span><span class="op" id="4462474">,</span>&nbsp;<span class="ident" id="4462476">x1</span><span class="op" id="4462478">,</span>&nbsp;<span class="ident" id="4462480">z2IsZero</span><span class="op" id="4462488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462491">p224CopyConditional</span><span class="op" id="4462510">(</span><span class="ident" id="4462511">y3</span><span class="op" id="4462513">,</span>&nbsp;<span class="ident" id="4462515">y2</span><span class="op" id="4462517">,</span>&nbsp;<span class="ident" id="4462519">z1IsZero</span><span class="op" id="4462527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462530">p224CopyConditional</span><span class="op" id="4462549">(</span><span class="ident" id="4462550">y3</span><span class="op" id="4462552">,</span>&nbsp;<span class="ident" id="4462554">y1</span><span class="op" id="4462556">,</span>&nbsp;<span class="ident" id="4462558">z2IsZero</span><span class="op" id="4462566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462569">p224CopyConditional</span><span class="op" id="4462588">(</span><span class="ident" id="4462589">z3</span><span class="op" id="4462591">,</span>&nbsp;<span class="ident" id="4462593">z2</span><span class="op" id="4462595">,</span>&nbsp;<span class="ident" id="4462597">z1IsZero</span><span class="op" id="4462605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462608">p224CopyConditional</span><span class="op" id="4462627">(</span><span class="ident" id="4462628">z3</span><span class="op" id="4462630">,</span>&nbsp;<span class="ident" id="4462632">z1</span><span class="op" id="4462634">,</span>&nbsp;<span class="ident" id="4462636">z2IsZero</span><span class="op" id="4462644">)</span><br>
<span class="lineno">585</span><span class="op" id="4462646">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4462649">//&nbsp;p224DoubleJacobian&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a+a.</span><br>
<span class="lineno"></span><span class="keyword" id="4462692">func</span>&nbsp;<span class="ident" id="4462697">p224DoubleJacobian</span><span class="op" id="4462715">(</span><span class="ident" id="4462716">x3</span><span class="op" id="4462718">,</span>&nbsp;<span class="ident" id="4462720">y3</span><span class="op" id="4462722">,</span>&nbsp;<span class="ident" id="4462724">z3</span><span class="op" id="4462726">,</span>&nbsp;<span class="ident" id="4462728">x1</span><span class="op" id="4462730">,</span>&nbsp;<span class="ident" id="4462732">y1</span><span class="op" id="4462734">,</span>&nbsp;<span class="ident" id="4462736">z1</span>&nbsp;<span class="op" id="4462739">*</span><span class="ident" id="4462740">p224FieldElement</span><span class="op" id="4462756">)</span>&nbsp;<span class="op" id="4462758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4462761">var</span>&nbsp;<span class="ident" id="4462765">delta</span><span class="op" id="4462770">,</span>&nbsp;<span class="ident" id="4462772">gamma</span><span class="op" id="4462777">,</span>&nbsp;<span class="ident" id="4462779">beta</span><span class="op" id="4462783">,</span>&nbsp;<span class="ident" id="4462785">alpha</span><span class="op" id="4462790">,</span>&nbsp;<span class="ident" id="4462792">t</span>&nbsp;<span class="ident" id="4462794">p224FieldElement</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4462812">var</span>&nbsp;<span class="ident" id="4462816">c</span>&nbsp;<span class="ident" id="4462818">p224LargeFieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462842">p224Square</span><span class="op" id="4462852">(</span><span class="op" id="4462853">&amp;</span><span class="ident" id="4462854">delta</span><span class="op" id="4462859">,</span>&nbsp;<span class="ident" id="4462861">z1</span><span class="op" id="4462863">,</span>&nbsp;<span class="op" id="4462865">&amp;</span><span class="ident" id="4462866">c</span><span class="op" id="4462867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462870">p224Square</span><span class="op" id="4462880">(</span><span class="op" id="4462881">&amp;</span><span class="ident" id="4462882">gamma</span><span class="op" id="4462887">,</span>&nbsp;<span class="ident" id="4462889">y1</span><span class="op" id="4462891">,</span>&nbsp;<span class="op" id="4462893">&amp;</span><span class="ident" id="4462894">c</span><span class="op" id="4462895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462898">p224Mul</span><span class="op" id="4462905">(</span><span class="op" id="4462906">&amp;</span><span class="ident" id="4462907">beta</span><span class="op" id="4462911">,</span>&nbsp;<span class="ident" id="4462913">x1</span><span class="op" id="4462915">,</span>&nbsp;<span class="op" id="4462917">&amp;</span><span class="ident" id="4462918">gamma</span><span class="op" id="4462923">,</span>&nbsp;<span class="op" id="4462925">&amp;</span><span class="ident" id="4462926">c</span><span class="op" id="4462927">)</span><br>
<span class="lineno">595</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4462931">//&nbsp;alpha&nbsp;=&nbsp;3*(X1-delta)*(X1+delta)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462967">p224Add</span><span class="op" id="4462974">(</span><span class="op" id="4462975">&amp;</span><span class="ident" id="4462976">t</span><span class="op" id="4462977">,</span>&nbsp;<span class="ident" id="4462979">x1</span><span class="op" id="4462981">,</span>&nbsp;<span class="op" id="4462983">&amp;</span><span class="ident" id="4462984">delta</span><span class="op" id="4462989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4462992">for</span>&nbsp;<span class="ident" id="4462996">i</span>&nbsp;<span class="op" id="4462998">:=</span>&nbsp;<span class="num" id="4463001">0</span><span class="op" id="4463002">;</span>&nbsp;<span class="ident" id="4463004">i</span>&nbsp;<span class="op" id="4463006">&lt;</span>&nbsp;<span class="num" id="4463008">8</span><span class="op" id="4463009">;</span>&nbsp;<span class="ident" id="4463011">i</span><span class="op" id="4463012">++</span>&nbsp;<span class="op" id="4463015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463019">t</span><span class="op" id="4463020">[</span><span class="ident" id="4463021">i</span><span class="op" id="4463022">]</span>&nbsp;<span class="op" id="4463024">+=</span>&nbsp;<span class="ident" id="4463027">t</span><span class="op" id="4463028">[</span><span class="ident" id="4463029">i</span><span class="op" id="4463030">]</span>&nbsp;<span class="op" id="4463032">&lt;&lt;</span>&nbsp;<span class="num" id="4463035">1</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4463038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463041">p224Reduce</span><span class="op" id="4463051">(</span><span class="op" id="4463052">&amp;</span><span class="ident" id="4463053">t</span><span class="op" id="4463054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463057">p224Sub</span><span class="op" id="4463064">(</span><span class="op" id="4463065">&amp;</span><span class="ident" id="4463066">alpha</span><span class="op" id="4463071">,</span>&nbsp;<span class="ident" id="4463073">x1</span><span class="op" id="4463075">,</span>&nbsp;<span class="op" id="4463077">&amp;</span><span class="ident" id="4463078">delta</span><span class="op" id="4463083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463086">p224Reduce</span><span class="op" id="4463096">(</span><span class="op" id="4463097">&amp;</span><span class="ident" id="4463098">alpha</span><span class="op" id="4463103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463106">p224Mul</span><span class="op" id="4463113">(</span><span class="op" id="4463114">&amp;</span><span class="ident" id="4463115">alpha</span><span class="op" id="4463120">,</span>&nbsp;<span class="op" id="4463122">&amp;</span><span class="ident" id="4463123">alpha</span><span class="op" id="4463128">,</span>&nbsp;<span class="op" id="4463130">&amp;</span><span class="ident" id="4463131">t</span><span class="op" id="4463132">,</span>&nbsp;<span class="op" id="4463134">&amp;</span><span class="ident" id="4463135">c</span><span class="op" id="4463136">)</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4463140">//&nbsp;Z3&nbsp;=&nbsp;(Y1+Z1)²-gamma-delta</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463171">p224Add</span><span class="op" id="4463178">(</span><span class="ident" id="4463179">z3</span><span class="op" id="4463181">,</span>&nbsp;<span class="ident" id="4463183">y1</span><span class="op" id="4463185">,</span>&nbsp;<span class="ident" id="4463187">z1</span><span class="op" id="4463189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463192">p224Reduce</span><span class="op" id="4463202">(</span><span class="ident" id="4463203">z3</span><span class="op" id="4463205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463208">p224Square</span><span class="op" id="4463218">(</span><span class="ident" id="4463219">z3</span><span class="op" id="4463221">,</span>&nbsp;<span class="ident" id="4463223">z3</span><span class="op" id="4463225">,</span>&nbsp;<span class="op" id="4463227">&amp;</span><span class="ident" id="4463228">c</span><span class="op" id="4463229">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463232">p224Sub</span><span class="op" id="4463239">(</span><span class="ident" id="4463240">z3</span><span class="op" id="4463242">,</span>&nbsp;<span class="ident" id="4463244">z3</span><span class="op" id="4463246">,</span>&nbsp;<span class="op" id="4463248">&amp;</span><span class="ident" id="4463249">gamma</span><span class="op" id="4463254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463257">p224Reduce</span><span class="op" id="4463267">(</span><span class="ident" id="4463268">z3</span><span class="op" id="4463270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463273">p224Sub</span><span class="op" id="4463280">(</span><span class="ident" id="4463281">z3</span><span class="op" id="4463283">,</span>&nbsp;<span class="ident" id="4463285">z3</span><span class="op" id="4463287">,</span>&nbsp;<span class="op" id="4463289">&amp;</span><span class="ident" id="4463290">delta</span><span class="op" id="4463295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463298">p224Reduce</span><span class="op" id="4463308">(</span><span class="ident" id="4463309">z3</span><span class="op" id="4463311">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4463315">//&nbsp;X3&nbsp;=&nbsp;alpha²-8*beta</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4463339">for</span>&nbsp;<span class="ident" id="4463343">i</span>&nbsp;<span class="op" id="4463345">:=</span>&nbsp;<span class="num" id="4463348">0</span><span class="op" id="4463349">;</span>&nbsp;<span class="ident" id="4463351">i</span>&nbsp;<span class="op" id="4463353">&lt;</span>&nbsp;<span class="num" id="4463355">8</span><span class="op" id="4463356">;</span>&nbsp;<span class="ident" id="4463358">i</span><span class="op" id="4463359">++</span>&nbsp;<span class="op" id="4463362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463366">delta</span><span class="op" id="4463371">[</span><span class="ident" id="4463372">i</span><span class="op" id="4463373">]</span>&nbsp;<span class="op" id="4463375">=</span>&nbsp;<span class="ident" id="4463377">beta</span><span class="op" id="4463381">[</span><span class="ident" id="4463382">i</span><span class="op" id="4463383">]</span>&nbsp;<span class="op" id="4463385">&lt;&lt;</span>&nbsp;<span class="num" id="4463388">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4463391">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463394">p224Reduce</span><span class="op" id="4463404">(</span><span class="op" id="4463405">&amp;</span><span class="ident" id="4463406">delta</span><span class="op" id="4463411">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463414">p224Square</span><span class="op" id="4463424">(</span><span class="ident" id="4463425">x3</span><span class="op" id="4463427">,</span>&nbsp;<span class="op" id="4463429">&amp;</span><span class="ident" id="4463430">alpha</span><span class="op" id="4463435">,</span>&nbsp;<span class="op" id="4463437">&amp;</span><span class="ident" id="4463438">c</span><span class="op" id="4463439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463442">p224Sub</span><span class="op" id="4463449">(</span><span class="ident" id="4463450">x3</span><span class="op" id="4463452">,</span>&nbsp;<span class="ident" id="4463454">x3</span><span class="op" id="4463456">,</span>&nbsp;<span class="op" id="4463458">&amp;</span><span class="ident" id="4463459">delta</span><span class="op" id="4463464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463467">p224Reduce</span><span class="op" id="4463477">(</span><span class="ident" id="4463478">x3</span><span class="op" id="4463480">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4463484">//&nbsp;Y3&nbsp;=&nbsp;alpha*(4*beta-X3)-8*gamma²</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4463521">for</span>&nbsp;<span class="ident" id="4463525">i</span>&nbsp;<span class="op" id="4463527">:=</span>&nbsp;<span class="num" id="4463530">0</span><span class="op" id="4463531">;</span>&nbsp;<span class="ident" id="4463533">i</span>&nbsp;<span class="op" id="4463535">&lt;</span>&nbsp;<span class="num" id="4463537">8</span><span class="op" id="4463538">;</span>&nbsp;<span class="ident" id="4463540">i</span><span class="op" id="4463541">++</span>&nbsp;<span class="op" id="4463544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463548">beta</span><span class="op" id="4463552">[</span><span class="ident" id="4463553">i</span><span class="op" id="4463554">]</span>&nbsp;<span class="op" id="4463556">&lt;&lt;=</span>&nbsp;<span class="num" id="4463560">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4463563">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463566">p224Sub</span><span class="op" id="4463573">(</span><span class="op" id="4463574">&amp;</span><span class="ident" id="4463575">beta</span><span class="op" id="4463579">,</span>&nbsp;<span class="op" id="4463581">&amp;</span><span class="ident" id="4463582">beta</span><span class="op" id="4463586">,</span>&nbsp;<span class="ident" id="4463588">x3</span><span class="op" id="4463590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463593">p224Reduce</span><span class="op" id="4463603">(</span><span class="op" id="4463604">&amp;</span><span class="ident" id="4463605">beta</span><span class="op" id="4463609">)</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463612">p224Square</span><span class="op" id="4463622">(</span><span class="op" id="4463623">&amp;</span><span class="ident" id="4463624">gamma</span><span class="op" id="4463629">,</span>&nbsp;<span class="op" id="4463631">&amp;</span><span class="ident" id="4463632">gamma</span><span class="op" id="4463637">,</span>&nbsp;<span class="op" id="4463639">&amp;</span><span class="ident" id="4463640">c</span><span class="op" id="4463641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4463644">for</span>&nbsp;<span class="ident" id="4463648">i</span>&nbsp;<span class="op" id="4463650">:=</span>&nbsp;<span class="num" id="4463653">0</span><span class="op" id="4463654">;</span>&nbsp;<span class="ident" id="4463656">i</span>&nbsp;<span class="op" id="4463658">&lt;</span>&nbsp;<span class="num" id="4463660">8</span><span class="op" id="4463661">;</span>&nbsp;<span class="ident" id="4463663">i</span><span class="op" id="4463664">++</span>&nbsp;<span class="op" id="4463667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463671">gamma</span><span class="op" id="4463676">[</span><span class="ident" id="4463677">i</span><span class="op" id="4463678">]</span>&nbsp;<span class="op" id="4463680">&lt;&lt;=</span>&nbsp;<span class="num" id="4463684">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4463687">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463690">p224Reduce</span><span class="op" id="4463700">(</span><span class="op" id="4463701">&amp;</span><span class="ident" id="4463702">gamma</span><span class="op" id="4463707">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463710">p224Mul</span><span class="op" id="4463717">(</span><span class="ident" id="4463718">y3</span><span class="op" id="4463720">,</span>&nbsp;<span class="op" id="4463722">&amp;</span><span class="ident" id="4463723">alpha</span><span class="op" id="4463728">,</span>&nbsp;<span class="op" id="4463730">&amp;</span><span class="ident" id="4463731">beta</span><span class="op" id="4463735">,</span>&nbsp;<span class="op" id="4463737">&amp;</span><span class="ident" id="4463738">c</span><span class="op" id="4463739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463742">p224Sub</span><span class="op" id="4463749">(</span><span class="ident" id="4463750">y3</span><span class="op" id="4463752">,</span>&nbsp;<span class="ident" id="4463754">y3</span><span class="op" id="4463756">,</span>&nbsp;<span class="op" id="4463758">&amp;</span><span class="ident" id="4463759">gamma</span><span class="op" id="4463764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463767">p224Reduce</span><span class="op" id="4463777">(</span><span class="ident" id="4463778">y3</span><span class="op" id="4463780">)</span><br>
<span class="lineno"></span><span class="op" id="4463782">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">640</span><span class="comment" id="4463785">//&nbsp;p224CopyConditional&nbsp;sets&nbsp;*out&nbsp;=&nbsp;*in&nbsp;iff&nbsp;the&nbsp;least-significant-bit&nbsp;of&nbsp;control</span><br>
<span class="lineno"></span><span class="comment" id="4463865">//&nbsp;is&nbsp;true,&nbsp;and&nbsp;it&nbsp;runs&nbsp;in&nbsp;constant&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="4463907">func</span>&nbsp;<span class="ident" id="4463912">p224CopyConditional</span><span class="op" id="4463931">(</span><span class="ident" id="4463932">out</span><span class="op" id="4463935">,</span>&nbsp;<span class="ident" id="4463937">in</span>&nbsp;<span class="op" id="4463940">*</span><span class="ident" id="4463941">p224FieldElement</span><span class="op" id="4463957">,</span>&nbsp;<span class="ident" id="4463959">control</span>&nbsp;<span class="builtintype" id="4463967">uint32</span><span class="op" id="4463973">)</span>&nbsp;<span class="op" id="4463975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463978">control</span>&nbsp;<span class="op" id="4463986">&lt;&lt;=</span>&nbsp;<span class="num" id="4463990">31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463994">control</span>&nbsp;<span class="op" id="4464002">=</span>&nbsp;<span class="builtintype" id="4464004">uint32</span><span class="op" id="4464010">(</span><span class="builtintype" id="4464011">int32</span><span class="op" id="4464016">(</span><span class="ident" id="4464017">control</span><span class="op" id="4464024">)</span>&nbsp;<span class="op" id="4464026">&gt;&gt;</span>&nbsp;<span class="num" id="4464029">31</span><span class="op" id="4464031">)</span><br>
<span class="lineno">645</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4464035">for</span>&nbsp;<span class="ident" id="4464039">i</span>&nbsp;<span class="op" id="4464041">:=</span>&nbsp;<span class="num" id="4464044">0</span><span class="op" id="4464045">;</span>&nbsp;<span class="ident" id="4464047">i</span>&nbsp;<span class="op" id="4464049">&lt;</span>&nbsp;<span class="num" id="4464051">8</span><span class="op" id="4464052">;</span>&nbsp;<span class="ident" id="4464054">i</span><span class="op" id="4464055">++</span>&nbsp;<span class="op" id="4464058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4464062">out</span><span class="op" id="4464065">[</span><span class="ident" id="4464066">i</span><span class="op" id="4464067">]</span>&nbsp;<span class="op" id="4464069">^=</span>&nbsp;<span class="op" id="4464072">(</span><span class="ident" id="4464073">out</span><span class="op" id="4464076">[</span><span class="ident" id="4464077">i</span><span class="op" id="4464078">]</span>&nbsp;<span class="op" id="4464080">^</span>&nbsp;<span class="ident" id="4464082">in</span><span class="op" id="4464084">[</span><span class="ident" id="4464085">i</span><span class="op" id="4464086">]</span><span class="op" id="4464087">)</span>&nbsp;<span class="op" id="4464089">&amp;</span>&nbsp;<span class="ident" id="4464091">control</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4464100">}</span><br>
<span class="lineno"></span><span class="op" id="4464102">}</span><br>
<span class="lineno">650</span><br>
<span class="lineno"></span><span class="keyword" id="4464105">func</span>&nbsp;<span class="ident" id="4464110">p224ScalarMult</span><span class="op" id="4464124">(</span><span class="ident" id="4464125">outX</span><span class="op" id="4464129">,</span>&nbsp;<span class="ident" id="4464131">outY</span><span class="op" id="4464135">,</span>&nbsp;<span class="ident" id="4464137">outZ</span><span class="op" id="4464141">,</span>&nbsp;<span class="ident" id="4464143">inX</span><span class="op" id="4464146">,</span>&nbsp;<span class="ident" id="4464148">inY</span><span class="op" id="4464151">,</span>&nbsp;<span class="ident" id="4464153">inZ</span>&nbsp;<span class="op" id="4464157">*</span><span class="ident" id="4464158">p224FieldElement</span><span class="op" id="4464174">,</span>&nbsp;<span class="ident" id="4464176">scalar</span>&nbsp;<span class="op" id="4464183">[</span><span class="op" id="4464184">]</span><span class="builtintype" id="4464185">byte</span><span class="op" id="4464189">)</span>&nbsp;<span class="op" id="4464191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4464194">var</span>&nbsp;<span class="ident" id="4464198">xx</span><span class="op" id="4464200">,</span>&nbsp;<span class="ident" id="4464202">yy</span><span class="op" id="4464204">,</span>&nbsp;<span class="ident" id="4464206">zz</span>&nbsp;<span class="ident" id="4464209">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4464227">for</span>&nbsp;<span class="ident" id="4464231">i</span>&nbsp;<span class="op" id="4464233">:=</span>&nbsp;<span class="num" id="4464236">0</span><span class="op" id="4464237">;</span>&nbsp;<span class="ident" id="4464239">i</span>&nbsp;<span class="op" id="4464241">&lt;</span>&nbsp;<span class="num" id="4464243">8</span><span class="op" id="4464244">;</span>&nbsp;<span class="ident" id="4464246">i</span><span class="op" id="4464247">++</span>&nbsp;<span class="op" id="4464250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4464254">outX</span><span class="op" id="4464258">[</span><span class="ident" id="4464259">i</span><span class="op" id="4464260">]</span>&nbsp;<span class="op" id="4464262">=</span>&nbsp;<span class="num" id="4464264">0</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4464268">outY</span><span class="op" id="4464272">[</span><span class="ident" id="4464273">i</span><span class="op" id="4464274">]</span>&nbsp;<span class="op" id="4464276">=</span>&nbsp;<span class="num" id="4464278">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4464282">outZ</span><span class="op" id="4464286">[</span><span class="ident" id="4464287">i</span><span class="op" id="4464288">]</span>&nbsp;<span class="op" id="4464290">=</span>&nbsp;<span class="num" id="4464292">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4464295">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4464299">for</span>&nbsp;<span class="ident" id="4464303">_</span><span class="op" id="4464304">,</span>&nbsp;<span class="builtintype" id="4464306">byte</span>&nbsp;<span class="op" id="4464311">:=</span>&nbsp;<span class="keyword" id="4464314">range</span>&nbsp;<span class="ident" id="4464320">scalar</span>&nbsp;<span class="op" id="4464327">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4464331">for</span>&nbsp;<span class="ident" id="4464335">bitNum</span>&nbsp;<span class="op" id="4464342">:=</span>&nbsp;<span class="builtintype" id="4464345">uint</span><span class="op" id="4464349">(</span><span class="num" id="4464350">0</span><span class="op" id="4464351">)</span><span class="op" id="4464352">;</span>&nbsp;<span class="ident" id="4464354">bitNum</span>&nbsp;<span class="op" id="4464361">&lt;</span>&nbsp;<span class="num" id="4464363">8</span><span class="op" id="4464364">;</span>&nbsp;<span class="ident" id="4464366">bitNum</span><span class="op" id="4464372">++</span>&nbsp;<span class="op" id="4464375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4464380">p224DoubleJacobian</span><span class="op" id="4464398">(</span><span class="ident" id="4464399">outX</span><span class="op" id="4464403">,</span>&nbsp;<span class="ident" id="4464405">outY</span><span class="op" id="4464409">,</span>&nbsp;<span class="ident" id="4464411">outZ</span><span class="op" id="4464415">,</span>&nbsp;<span class="ident" id="4464417">outX</span><span class="op" id="4464421">,</span>&nbsp;<span class="ident" id="4464423">outY</span><span class="op" id="4464427">,</span>&nbsp;<span class="ident" id="4464429">outZ</span><span class="op" id="4464433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4464438">bit</span>&nbsp;<span class="op" id="4464442">:=</span>&nbsp;<span class="builtintype" id="4464445">uint32</span><span class="op" id="4464451">(</span><span class="op" id="4464452">(</span><span class="builtintype" id="4464453">byte</span>&nbsp;<span class="op" id="4464458">&gt;&gt;</span>&nbsp;<span class="op" id="4464461">(</span><span class="num" id="4464462">7</span>&nbsp;<span class="op" id="4464464">-</span>&nbsp;<span class="ident" id="4464466">bitNum</span><span class="op" id="4464472">)</span><span class="op" id="4464473">)</span>&nbsp;<span class="op" id="4464475">&amp;</span>&nbsp;<span class="num" id="4464477">1</span><span class="op" id="4464478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4464483">p224AddJacobian</span><span class="op" id="4464498">(</span><span class="op" id="4464499">&amp;</span><span class="ident" id="4464500">xx</span><span class="op" id="4464502">,</span>&nbsp;<span class="op" id="4464504">&amp;</span><span class="ident" id="4464505">yy</span><span class="op" id="4464507">,</span>&nbsp;<span class="op" id="4464509">&amp;</span><span class="ident" id="4464510">zz</span><span class="op" id="4464512">,</span>&nbsp;<span class="ident" id="4464514">inX</span><span class="op" id="4464517">,</span>&nbsp;<span class="ident" id="4464519">inY</span><span class="op" id="4464522">,</span>&nbsp;<span class="ident" id="4464524">inZ</span><span class="op" id="4464527">,</span>&nbsp;<span class="ident" id="4464529">outX</span><span class="op" id="4464533">,</span>&nbsp;<span class="ident" id="4464535">outY</span><span class="op" id="4464539">,</span>&nbsp;<span class="ident" id="4464541">outZ</span><span class="op" id="4464545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4464550">p224CopyConditional</span><span class="op" id="4464569">(</span><span class="ident" id="4464570">outX</span><span class="op" id="4464574">,</span>&nbsp;<span class="op" id="4464576">&amp;</span><span class="ident" id="4464577">xx</span><span class="op" id="4464579">,</span>&nbsp;<span class="ident" id="4464581">bit</span><span class="op" id="4464584">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4464589">p224CopyConditional</span><span class="op" id="4464608">(</span><span class="ident" id="4464609">outY</span><span class="op" id="4464613">,</span>&nbsp;<span class="op" id="4464615">&amp;</span><span class="ident" id="4464616">yy</span><span class="op" id="4464618">,</span>&nbsp;<span class="ident" id="4464620">bit</span><span class="op" id="4464623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4464628">p224CopyConditional</span><span class="op" id="4464647">(</span><span class="ident" id="4464648">outZ</span><span class="op" id="4464652">,</span>&nbsp;<span class="op" id="4464654">&amp;</span><span class="ident" id="4464655">zz</span><span class="op" id="4464657">,</span>&nbsp;<span class="ident" id="4464659">bit</span><span class="op" id="4464662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4464666">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4464669">}</span><br>
<span class="lineno"></span><span class="op" id="4464671">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span><span class="comment" id="4464674">//&nbsp;p224ToAffine&nbsp;converts&nbsp;from&nbsp;Jacobian&nbsp;to&nbsp;affine&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="4464729">func</span>&nbsp;<span class="ident" id="4464734">p224ToAffine</span><span class="op" id="4464746">(</span><span class="ident" id="4464747">x</span><span class="op" id="4464748">,</span>&nbsp;<span class="ident" id="4464750">y</span><span class="op" id="4464751">,</span>&nbsp;<span class="ident" id="4464753">z</span>&nbsp;<span class="op" id="4464755">*</span><span class="ident" id="4464756">p224FieldElement</span><span class="op" id="4464772">)</span>&nbsp;<span class="op" id="4464774">(</span><span class="op" id="4464775">*</span><span class="ident" id="4464776">big</span><span class="op" id="4464779">.</span><span class="ident" id="4464780">Int</span><span class="op" id="4464783">,</span>&nbsp;<span class="op" id="4464785">*</span><span class="ident" id="4464786">big</span><span class="op" id="4464789">.</span><span class="ident" id="4464790">Int</span><span class="op" id="4464793">)</span>&nbsp;<span class="op" id="4464795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4464798">var</span>&nbsp;<span class="ident" id="4464802">zinv</span><span class="op" id="4464806">,</span>&nbsp;<span class="ident" id="4464808">zinvsq</span><span class="op" id="4464814">,</span>&nbsp;<span class="ident" id="4464816">outx</span><span class="op" id="4464820">,</span>&nbsp;<span class="ident" id="4464822">outy</span>&nbsp;<span class="ident" id="4464827">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4464845">var</span>&nbsp;<span class="ident" id="4464849">tmp</span>&nbsp;<span class="ident" id="4464853">p224LargeFieldElement</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4464877">if</span>&nbsp;<span class="ident" id="4464880">isPointAtInfinity</span>&nbsp;<span class="op" id="4464898">:=</span>&nbsp;<span class="ident" id="4464901">p224IsZero</span><span class="op" id="4464911">(</span><span class="ident" id="4464912">z</span><span class="op" id="4464913">)</span><span class="op" id="4464914">;</span>&nbsp;<span class="ident" id="4464916">isPointAtInfinity</span>&nbsp;<span class="op" id="4464934">==</span>&nbsp;<span class="num" id="4464937">1</span>&nbsp;<span class="op" id="4464939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4464943">return</span>&nbsp;<span class="builtinfunc" id="4464950">new</span><span class="op" id="4464953">(</span><span class="ident" id="4464954">big</span><span class="op" id="4464957">.</span><span class="ident" id="4464958">Int</span><span class="op" id="4464961">)</span><span class="op" id="4464962">,</span>&nbsp;<span class="builtinfunc" id="4464964">new</span><span class="op" id="4464967">(</span><span class="ident" id="4464968">big</span><span class="op" id="4464971">.</span><span class="ident" id="4464972">Int</span><span class="op" id="4464975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4464978">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4464982">p224Invert</span><span class="op" id="4464992">(</span><span class="op" id="4464993">&amp;</span><span class="ident" id="4464994">zinv</span><span class="op" id="4464998">,</span>&nbsp;<span class="ident" id="4465000">z</span><span class="op" id="4465001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4465004">p224Square</span><span class="op" id="4465014">(</span><span class="op" id="4465015">&amp;</span><span class="ident" id="4465016">zinvsq</span><span class="op" id="4465022">,</span>&nbsp;<span class="op" id="4465024">&amp;</span><span class="ident" id="4465025">zinv</span><span class="op" id="4465029">,</span>&nbsp;<span class="op" id="4465031">&amp;</span><span class="ident" id="4465032">tmp</span><span class="op" id="4465035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4465038">p224Mul</span><span class="op" id="4465045">(</span><span class="ident" id="4465046">x</span><span class="op" id="4465047">,</span>&nbsp;<span class="ident" id="4465049">x</span><span class="op" id="4465050">,</span>&nbsp;<span class="op" id="4465052">&amp;</span><span class="ident" id="4465053">zinvsq</span><span class="op" id="4465059">,</span>&nbsp;<span class="op" id="4465061">&amp;</span><span class="ident" id="4465062">tmp</span><span class="op" id="4465065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4465068">p224Mul</span><span class="op" id="4465075">(</span><span class="op" id="4465076">&amp;</span><span class="ident" id="4465077">zinvsq</span><span class="op" id="4465083">,</span>&nbsp;<span class="op" id="4465085">&amp;</span><span class="ident" id="4465086">zinvsq</span><span class="op" id="4465092">,</span>&nbsp;<span class="op" id="4465094">&amp;</span><span class="ident" id="4465095">zinv</span><span class="op" id="4465099">,</span>&nbsp;<span class="op" id="4465101">&amp;</span><span class="ident" id="4465102">tmp</span><span class="op" id="4465105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4465108">p224Mul</span><span class="op" id="4465115">(</span><span class="ident" id="4465116">y</span><span class="op" id="4465117">,</span>&nbsp;<span class="ident" id="4465119">y</span><span class="op" id="4465120">,</span>&nbsp;<span class="op" id="4465122">&amp;</span><span class="ident" id="4465123">zinvsq</span><span class="op" id="4465129">,</span>&nbsp;<span class="op" id="4465131">&amp;</span><span class="ident" id="4465132">tmp</span><span class="op" id="4465135">)</span><br>
<span class="lineno">685</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4465139">p224Contract</span><span class="op" id="4465151">(</span><span class="op" id="4465152">&amp;</span><span class="ident" id="4465153">outx</span><span class="op" id="4465157">,</span>&nbsp;<span class="ident" id="4465159">x</span><span class="op" id="4465160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4465163">p224Contract</span><span class="op" id="4465175">(</span><span class="op" id="4465176">&amp;</span><span class="ident" id="4465177">outy</span><span class="op" id="4465181">,</span>&nbsp;<span class="ident" id="4465183">y</span><span class="op" id="4465184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4465187">return</span>&nbsp;<span class="ident" id="4465194">p224ToBig</span><span class="op" id="4465203">(</span><span class="op" id="4465204">&amp;</span><span class="ident" id="4465205">outx</span><span class="op" id="4465209">)</span><span class="op" id="4465210">,</span>&nbsp;<span class="ident" id="4465212">p224ToBig</span><span class="op" id="4465221">(</span><span class="op" id="4465222">&amp;</span><span class="ident" id="4465223">outy</span><span class="op" id="4465227">)</span><br>
<span class="lineno"></span><span class="op" id="4465229">}</span><br>
<span class="lineno">690</span><br>
<span class="lineno"></span><span class="comment" id="4465232">//&nbsp;get28BitsFromEnd&nbsp;returns&nbsp;the&nbsp;least-significant&nbsp;28&nbsp;bits&nbsp;from&nbsp;buf&gt;&gt;shift,</span><br>
<span class="lineno"></span><span class="comment" id="4465307">//&nbsp;where&nbsp;buf&nbsp;is&nbsp;interpreted&nbsp;as&nbsp;a&nbsp;big-endian&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="4465359">func</span>&nbsp;<span class="ident" id="4465364">get28BitsFromEnd</span><span class="op" id="4465380">(</span><span class="ident" id="4465381">buf</span>&nbsp;<span class="op" id="4465385">[</span><span class="op" id="4465386">]</span><span class="builtintype" id="4465387">byte</span><span class="op" id="4465391">,</span>&nbsp;<span class="ident" id="4465393">shift</span>&nbsp;<span class="builtintype" id="4465399">uint</span><span class="op" id="4465403">)</span>&nbsp;<span class="op" id="4465405">(</span><span class="builtintype" id="4465406">uint32</span><span class="op" id="4465412">,</span>&nbsp;<span class="op" id="4465414">[</span><span class="op" id="4465415">]</span><span class="builtintype" id="4465416">byte</span><span class="op" id="4465420">)</span>&nbsp;<span class="op" id="4465422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4465425">var</span>&nbsp;<span class="ident" id="4465429">ret</span>&nbsp;<span class="builtintype" id="4465433">uint32</span><br>
<span class="lineno">695</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4465442">for</span>&nbsp;<span class="ident" id="4465446">i</span>&nbsp;<span class="op" id="4465448">:=</span>&nbsp;<span class="builtintype" id="4465451">uint</span><span class="op" id="4465455">(</span><span class="num" id="4465456">0</span><span class="op" id="4465457">)</span><span class="op" id="4465458">;</span>&nbsp;<span class="ident" id="4465460">i</span>&nbsp;<span class="op" id="4465462">&lt;</span>&nbsp;<span class="num" id="4465464">4</span><span class="op" id="4465465">;</span>&nbsp;<span class="ident" id="4465467">i</span><span class="op" id="4465468">++</span>&nbsp;<span class="op" id="4465471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4465475">var</span>&nbsp;<span class="ident" id="4465479">b</span>&nbsp;<span class="builtintype" id="4465481">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4465488">if</span>&nbsp;<span class="ident" id="4465491">l</span>&nbsp;<span class="op" id="4465493">:=</span>&nbsp;<span class="builtinfunc" id="4465496">len</span><span class="op" id="4465499">(</span><span class="ident" id="4465500">buf</span><span class="op" id="4465503">)</span><span class="op" id="4465504">;</span>&nbsp;<span class="ident" id="4465506">l</span>&nbsp;<span class="op" id="4465508">&gt;</span>&nbsp;<span class="num" id="4465510">0</span>&nbsp;<span class="op" id="4465512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4465517">b</span>&nbsp;<span class="op" id="4465519">=</span>&nbsp;<span class="ident" id="4465521">buf</span><span class="op" id="4465524">[</span><span class="ident" id="4465525">l</span><span class="op" id="4465526">-</span><span class="num" id="4465527">1</span><span class="op" id="4465528">]</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4465533">//&nbsp;We&nbsp;don&#39;t&nbsp;remove&nbsp;the&nbsp;byte&nbsp;if&nbsp;we&#39;re&nbsp;about&nbsp;to&nbsp;return&nbsp;and&nbsp;we&#39;re&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4465603">//&nbsp;reading&nbsp;all&nbsp;of&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4465628">if</span>&nbsp;<span class="ident" id="4465631">i</span>&nbsp;<span class="op" id="4465633">!=</span>&nbsp;<span class="num" id="4465636">3</span>&nbsp;<span class="op" id="4465638">||</span>&nbsp;<span class="ident" id="4465641">shift</span>&nbsp;<span class="op" id="4465647">==</span>&nbsp;<span class="num" id="4465650">4</span>&nbsp;<span class="op" id="4465652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4465658">buf</span>&nbsp;<span class="op" id="4465662">=</span>&nbsp;<span class="ident" id="4465664">buf</span><span class="op" id="4465667">[</span><span class="op" id="4465668">:</span><span class="ident" id="4465669">l</span><span class="op" id="4465670">-</span><span class="num" id="4465671">1</span><span class="op" id="4465672">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4465677">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4465681">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4465685">ret</span>&nbsp;<span class="op" id="4465689">|=</span>&nbsp;<span class="builtintype" id="4465692">uint32</span><span class="op" id="4465698">(</span><span class="ident" id="4465699">b</span><span class="op" id="4465700">)</span>&nbsp;<span class="op" id="4465702">&lt;&lt;</span>&nbsp;<span class="op" id="4465705">(</span><span class="num" id="4465706">8</span>&nbsp;<span class="op" id="4465708">*</span>&nbsp;<span class="ident" id="4465710">i</span><span class="op" id="4465711">)</span>&nbsp;<span class="op" id="4465713">&gt;&gt;</span>&nbsp;<span class="ident" id="4465716">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4465723">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4465726">ret</span>&nbsp;<span class="op" id="4465730">&amp;=</span>&nbsp;<span class="ident" id="4465733">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4465747">return</span>&nbsp;<span class="ident" id="4465754">ret</span><span class="op" id="4465757">,</span>&nbsp;<span class="ident" id="4465759">buf</span><br>
<span class="lineno">710</span><span class="op" id="4465763">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4465766">//&nbsp;p224FromBig&nbsp;sets&nbsp;*out&nbsp;=&nbsp;*in.</span><br>
<span class="lineno"></span><span class="keyword" id="4465798">func</span>&nbsp;<span class="ident" id="4465803">p224FromBig</span><span class="op" id="4465814">(</span><span class="ident" id="4465815">out</span>&nbsp;<span class="op" id="4465819">*</span><span class="ident" id="4465820">p224FieldElement</span><span class="op" id="4465836">,</span>&nbsp;<span class="ident" id="4465838">in</span>&nbsp;<span class="op" id="4465841">*</span><span class="ident" id="4465842">big</span><span class="op" id="4465845">.</span><span class="ident" id="4465846">Int</span><span class="op" id="4465849">)</span>&nbsp;<span class="op" id="4465851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4465854">bytes</span>&nbsp;<span class="op" id="4465860">:=</span>&nbsp;<span class="ident" id="4465863">in</span><span class="op" id="4465865">.</span><span class="ident" id="4465866">Bytes</span><span class="op" id="4465871">(</span><span class="op" id="4465872">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4465875">out</span><span class="op" id="4465878">[</span><span class="num" id="4465879">0</span><span class="op" id="4465880">]</span><span class="op" id="4465881">,</span>&nbsp;<span class="ident" id="4465883">bytes</span>&nbsp;<span class="op" id="4465889">=</span>&nbsp;<span class="ident" id="4465891">get28BitsFromEnd</span><span class="op" id="4465907">(</span><span class="ident" id="4465908">bytes</span><span class="op" id="4465913">,</span>&nbsp;<span class="num" id="4465915">0</span><span class="op" id="4465916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4465919">out</span><span class="op" id="4465922">[</span><span class="num" id="4465923">1</span><span class="op" id="4465924">]</span><span class="op" id="4465925">,</span>&nbsp;<span class="ident" id="4465927">bytes</span>&nbsp;<span class="op" id="4465933">=</span>&nbsp;<span class="ident" id="4465935">get28BitsFromEnd</span><span class="op" id="4465951">(</span><span class="ident" id="4465952">bytes</span><span class="op" id="4465957">,</span>&nbsp;<span class="num" id="4465959">4</span><span class="op" id="4465960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4465963">out</span><span class="op" id="4465966">[</span><span class="num" id="4465967">2</span><span class="op" id="4465968">]</span><span class="op" id="4465969">,</span>&nbsp;<span class="ident" id="4465971">bytes</span>&nbsp;<span class="op" id="4465977">=</span>&nbsp;<span class="ident" id="4465979">get28BitsFromEnd</span><span class="op" id="4465995">(</span><span class="ident" id="4465996">bytes</span><span class="op" id="4466001">,</span>&nbsp;<span class="num" id="4466003">0</span><span class="op" id="4466004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4466007">out</span><span class="op" id="4466010">[</span><span class="num" id="4466011">3</span><span class="op" id="4466012">]</span><span class="op" id="4466013">,</span>&nbsp;<span class="ident" id="4466015">bytes</span>&nbsp;<span class="op" id="4466021">=</span>&nbsp;<span class="ident" id="4466023">get28BitsFromEnd</span><span class="op" id="4466039">(</span><span class="ident" id="4466040">bytes</span><span class="op" id="4466045">,</span>&nbsp;<span class="num" id="4466047">4</span><span class="op" id="4466048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4466051">out</span><span class="op" id="4466054">[</span><span class="num" id="4466055">4</span><span class="op" id="4466056">]</span><span class="op" id="4466057">,</span>&nbsp;<span class="ident" id="4466059">bytes</span>&nbsp;<span class="op" id="4466065">=</span>&nbsp;<span class="ident" id="4466067">get28BitsFromEnd</span><span class="op" id="4466083">(</span><span class="ident" id="4466084">bytes</span><span class="op" id="4466089">,</span>&nbsp;<span class="num" id="4466091">0</span><span class="op" id="4466092">)</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4466095">out</span><span class="op" id="4466098">[</span><span class="num" id="4466099">5</span><span class="op" id="4466100">]</span><span class="op" id="4466101">,</span>&nbsp;<span class="ident" id="4466103">bytes</span>&nbsp;<span class="op" id="4466109">=</span>&nbsp;<span class="ident" id="4466111">get28BitsFromEnd</span><span class="op" id="4466127">(</span><span class="ident" id="4466128">bytes</span><span class="op" id="4466133">,</span>&nbsp;<span class="num" id="4466135">4</span><span class="op" id="4466136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4466139">out</span><span class="op" id="4466142">[</span><span class="num" id="4466143">6</span><span class="op" id="4466144">]</span><span class="op" id="4466145">,</span>&nbsp;<span class="ident" id="4466147">bytes</span>&nbsp;<span class="op" id="4466153">=</span>&nbsp;<span class="ident" id="4466155">get28BitsFromEnd</span><span class="op" id="4466171">(</span><span class="ident" id="4466172">bytes</span><span class="op" id="4466177">,</span>&nbsp;<span class="num" id="4466179">0</span><span class="op" id="4466180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4466183">out</span><span class="op" id="4466186">[</span><span class="num" id="4466187">7</span><span class="op" id="4466188">]</span><span class="op" id="4466189">,</span>&nbsp;<span class="ident" id="4466191">bytes</span>&nbsp;<span class="op" id="4466197">=</span>&nbsp;<span class="ident" id="4466199">get28BitsFromEnd</span><span class="op" id="4466215">(</span><span class="ident" id="4466216">bytes</span><span class="op" id="4466221">,</span>&nbsp;<span class="num" id="4466223">4</span><span class="op" id="4466224">)</span><br>
<span class="lineno"></span><span class="op" id="4466226">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">725</span><span class="comment" id="4466229">//&nbsp;p224ToBig&nbsp;returns&nbsp;in&nbsp;as&nbsp;a&nbsp;big.Int.</span><br>
<span class="lineno"></span><span class="keyword" id="4466267">func</span>&nbsp;<span class="ident" id="4466272">p224ToBig</span><span class="op" id="4466281">(</span><span class="ident" id="4466282">in</span>&nbsp;<span class="op" id="4466285">*</span><span class="ident" id="4466286">p224FieldElement</span><span class="op" id="4466302">)</span>&nbsp;<span class="op" id="4466304">*</span><span class="ident" id="4466305">big</span><span class="op" id="4466308">.</span><span class="ident" id="4466309">Int</span>&nbsp;<span class="op" id="4466313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4466316">var</span>&nbsp;<span class="ident" id="4466320">buf</span>&nbsp;<span class="op" id="4466324">[</span><span class="num" id="4466325">28</span><span class="op" id="4466327">]</span><span class="builtintype" id="4466328">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4466334">buf</span><span class="op" id="4466337">[</span><span class="num" id="4466338">27</span><span class="op" id="4466340">]</span>&nbsp;<span class="op" id="4466342">=</span>&nbsp;<span class="builtintype" id="4466344">byte</span><span class="op" id="4466348">(</span><span class="ident" id="4466349">in</span><span class="op" id="4466351">[</span><span class="num" id="4466352">0</span><span class="op" id="4466353">]</span><span class="op" id="4466354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4466357">buf</span><span class="op" id="4466360">[</span><span class="num" id="4466361">26</span><span class="op" id="4466363">]</span>&nbsp;<span class="op" id="4466365">=</span>&nbsp;<span class="builtintype" id="4466367">byte</span><span class="op" id="4466371">(</span><span class="ident" id="4466372">in</span><span class="op" id="4466374">[</span><span class="num" id="4466375">0</span><span class="op" id="4466376">]</span>&nbsp;<span class="op" id="4466378">&gt;&gt;</span>&nbsp;<span class="num" id="4466381">8</span><span class="op" id="4466382">)</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4466385">buf</span><span class="op" id="4466388">[</span><span class="num" id="4466389">25</span><span class="op" id="4466391">]</span>&nbsp;<span class="op" id="4466393">=</span>&nbsp;<span class="builtintype" id="4466395">byte</span><span class="op" id="4466399">(</span><span class="ident" id="4466400">in</span><span class="op" id="4466402">[</span><span class="num" id="4466403">0</span><span class="op" id="4466404">]</span>&nbsp;<span class="op" id="4466406">&gt;&gt;</span>&nbsp;<span class="num" id="4466409">16</span><span class="op" id="4466411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4466414">buf</span><span class="op" id="4466417">[</span><span class="num" id="4466418">24</span><span class="op" id="4466420">]</span>&nbsp;<span class="op" id="4466422">=</span>&nbsp;<span class="builtintype" id="4466424">byte</span><span class="op" id="4466428">(</span><span class="op" id="4466429">(</span><span class="op" id="4466430">(</span><span class="ident" id="4466431">in</span><span class="op" id="4466433">[</span><span class="num" id="4466434">0</span><span class="op" id="4466435">]</span>&nbsp;<span class="op" id="4466437">&gt;&gt;</span>&nbsp;<span class="num" id="4466440">24</span><span class="op" id="4466442">)</span>&nbsp;<span class="op" id="4466444">&amp;</span>&nbsp;<span class="num" id="4466446">0x0f</span><span class="op" id="4466450">)</span>&nbsp;<span class="op" id="4466452">|</span>&nbsp;<span class="op" id="4466454">(</span><span class="ident" id="4466455">in</span><span class="op" id="4466457">[</span><span class="num" id="4466458">1</span><span class="op" id="4466459">]</span><span class="op" id="4466460">&lt;&lt;</span><span class="num" id="4466462">4</span><span class="op" id="4466463">)</span><span class="op" id="4466464">&amp;</span><span class="num" id="4466465">0xf0</span><span class="op" id="4466469">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4466473">buf</span><span class="op" id="4466476">[</span><span class="num" id="4466477">23</span><span class="op" id="4466479">]</span>&nbsp;<span class="op" id="4466481">=</span>&nbsp;<span class="builtintype" id="4466483">byte</span><span class="op" id="4466487">(</span><span class="ident" id="4466488">in</span><span class="op" id="4466490">[</span><span class="num" id="4466491">1</span><span class="op" id="4466492">]</span>&nbsp;<span class="op" id="4466494">&gt;&gt;</span>&nbsp;<span class="num" id="4466497">4</span><span class="op" id="4466498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4466501">buf</span><span class="op" id="4466504">[</span><span class="num" id="4466505">22</span><span class="op" id="4466507">]</span>&nbsp;<span class="op" id="4466509">=</span>&nbsp;<span class="builtintype" id="4466511">byte</span><span class="op" id="4466515">(</span><span class="ident" id="4466516">in</span><span class="op" id="4466518">[</span><span class="num" id="4466519">1</span><span class="op" id="4466520">]</span>&nbsp;<span class="op" id="4466522">&gt;&gt;</span>&nbsp;<span class="num" id="4466525">12</span><span class="op" id="4466527">)</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4466530">buf</span><span class="op" id="4466533">[</span><span class="num" id="4466534">21</span><span class="op" id="4466536">]</span>&nbsp;<span class="op" id="4466538">=</span>&nbsp;<span class="builtintype" id="4466540">byte</span><span class="op" id="4466544">(</span><span class="ident" id="4466545">in</span><span class="op" id="4466547">[</span><span class="num" id="4466548">1</span><span class="op" id="4466549">]</span>&nbsp;<span class="op" id="4466551">&gt;&gt;</span>&nbsp;<span class="num" id="4466554">20</span><span class="op" id="4466556">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4466560">buf</span><span class="op" id="4466563">[</span><span class="num" id="4466564">20</span><span class="op" id="4466566">]</span>&nbsp;<span class="op" id="4466568">=</span>&nbsp;<span class="builtintype" id="4466570">byte</span><span class="op" id="4466574">(</span><span class="ident" id="4466575">in</span><span class="op" id="4466577">[</span><span class="num" id="4466578">2</span><span class="op" id="4466579">]</span><span class="op" id="4466580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4466583">buf</span><span class="op" id="4466586">[</span><span class="num" id="4466587">19</span><span class="op" id="4466589">]</span>&nbsp;<span class="op" id="4466591">=</span>&nbsp;<span class="builtintype" id="4466593">byte</span><span class="op" id="4466597">(</span><span class="ident" id="4466598">in</span><span class="op" id="4466600">[</span><span class="num" id="4466601">2</span><span class="op" id="4466602">]</span>&nbsp;<span class="op" id="4466604">&gt;&gt;</span>&nbsp;<span class="num" id="4466607">8</span><span class="op" id="4466608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4466611">buf</span><span class="op" id="4466614">[</span><span class="num" id="4466615">18</span><span class="op" id="4466617">]</span>&nbsp;<span class="op" id="4466619">=</span>&nbsp;<span class="builtintype" id="4466621">byte</span><span class="op" id="4466625">(</span><span class="ident" id="4466626">in</span><span class="op" id="4466628">[</span><span class="num" id="4466629">2</span><span class="op" id="4466630">]</span>&nbsp;<span class="op" id="4466632">&gt;&gt;</span>&nbsp;<span class="num" id="4466635">16</span><span class="op" id="4466637">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4466640">buf</span><span class="op" id="4466643">[</span><span class="num" id="4466644">17</span><span class="op" id="4466646">]</span>&nbsp;<span class="op" id="4466648">=</span>&nbsp;<span class="builtintype" id="4466650">byte</span><span class="op" id="4466654">(</span><span class="op" id="4466655">(</span><span class="op" id="4466656">(</span><span class="ident" id="4466657">in</span><span class="op" id="4466659">[</span><span class="num" id="4466660">2</span><span class="op" id="4466661">]</span>&nbsp;<span class="op" id="4466663">&gt;&gt;</span>&nbsp;<span class="num" id="4466666">24</span><span class="op" id="4466668">)</span>&nbsp;<span class="op" id="4466670">&amp;</span>&nbsp;<span class="num" id="4466672">0x0f</span><span class="op" id="4466676">)</span>&nbsp;<span class="op" id="4466678">|</span>&nbsp;<span class="op" id="4466680">(</span><span class="ident" id="4466681">in</span><span class="op" id="4466683">[</span><span class="num" id="4466684">3</span><span class="op" id="4466685">]</span><span class="op" id="4466686">&lt;&lt;</span><span class="num" id="4466688">4</span><span class="op" id="4466689">)</span><span class="op" id="4466690">&amp;</span><span class="num" id="4466691">0xf0</span><span class="op" id="4466695">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4466699">buf</span><span class="op" id="4466702">[</span><span class="num" id="4466703">16</span><span class="op" id="4466705">]</span>&nbsp;<span class="op" id="4466707">=</span>&nbsp;<span class="builtintype" id="4466709">byte</span><span class="op" id="4466713">(</span><span class="ident" id="4466714">in</span><span class="op" id="4466716">[</span><span class="num" id="4466717">3</span><span class="op" id="4466718">]</span>&nbsp;<span class="op" id="4466720">&gt;&gt;</span>&nbsp;<span class="num" id="4466723">4</span><span class="op" id="4466724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4466727">buf</span><span class="op" id="4466730">[</span><span class="num" id="4466731">15</span><span class="op" id="4466733">]</span>&nbsp;<span class="op" id="4466735">=</span>&nbsp;<span class="builtintype" id="4466737">byte</span><span class="op" id="4466741">(</span><span class="ident" id="4466742">in</span><span class="op" id="4466744">[</span><span class="num" id="4466745">3</span><span class="op" id="4466746">]</span>&nbsp;<span class="op" id="4466748">&gt;&gt;</span>&nbsp;<span class="num" id="4466751">12</span><span class="op" id="4466753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4466756">buf</span><span class="op" id="4466759">[</span><span class="num" id="4466760">14</span><span class="op" id="4466762">]</span>&nbsp;<span class="op" id="4466764">=</span>&nbsp;<span class="builtintype" id="4466766">byte</span><span class="op" id="4466770">(</span><span class="ident" id="4466771">in</span><span class="op" id="4466773">[</span><span class="num" id="4466774">3</span><span class="op" id="4466775">]</span>&nbsp;<span class="op" id="4466777">&gt;&gt;</span>&nbsp;<span class="num" id="4466780">20</span><span class="op" id="4466782">)</span><br>
<span class="lineno">745</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4466786">buf</span><span class="op" id="4466789">[</span><span class="num" id="4466790">13</span><span class="op" id="4466792">]</span>&nbsp;<span class="op" id="4466794">=</span>&nbsp;<span class="builtintype" id="4466796">byte</span><span class="op" id="4466800">(</span><span class="ident" id="4466801">in</span><span class="op" id="4466803">[</span><span class="num" id="4466804">4</span><span class="op" id="4466805">]</span><span class="op" id="4466806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4466809">buf</span><span class="op" id="4466812">[</span><span class="num" id="4466813">12</span><span class="op" id="4466815">]</span>&nbsp;<span class="op" id="4466817">=</span>&nbsp;<span class="builtintype" id="4466819">byte</span><span class="op" id="4466823">(</span><span class="ident" id="4466824">in</span><span class="op" id="4466826">[</span><span class="num" id="4466827">4</span><span class="op" id="4466828">]</span>&nbsp;<span class="op" id="4466830">&gt;&gt;</span>&nbsp;<span class="num" id="4466833">8</span><span class="op" id="4466834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4466837">buf</span><span class="op" id="4466840">[</span><span class="num" id="4466841">11</span><span class="op" id="4466843">]</span>&nbsp;<span class="op" id="4466845">=</span>&nbsp;<span class="builtintype" id="4466847">byte</span><span class="op" id="4466851">(</span><span class="ident" id="4466852">in</span><span class="op" id="4466854">[</span><span class="num" id="4466855">4</span><span class="op" id="4466856">]</span>&nbsp;<span class="op" id="4466858">&gt;&gt;</span>&nbsp;<span class="num" id="4466861">16</span><span class="op" id="4466863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4466866">buf</span><span class="op" id="4466869">[</span><span class="num" id="4466870">10</span><span class="op" id="4466872">]</span>&nbsp;<span class="op" id="4466874">=</span>&nbsp;<span class="builtintype" id="4466876">byte</span><span class="op" id="4466880">(</span><span class="op" id="4466881">(</span><span class="op" id="4466882">(</span><span class="ident" id="4466883">in</span><span class="op" id="4466885">[</span><span class="num" id="4466886">4</span><span class="op" id="4466887">]</span>&nbsp;<span class="op" id="4466889">&gt;&gt;</span>&nbsp;<span class="num" id="4466892">24</span><span class="op" id="4466894">)</span>&nbsp;<span class="op" id="4466896">&amp;</span>&nbsp;<span class="num" id="4466898">0x0f</span><span class="op" id="4466902">)</span>&nbsp;<span class="op" id="4466904">|</span>&nbsp;<span class="op" id="4466906">(</span><span class="ident" id="4466907">in</span><span class="op" id="4466909">[</span><span class="num" id="4466910">5</span><span class="op" id="4466911">]</span><span class="op" id="4466912">&lt;&lt;</span><span class="num" id="4466914">4</span><span class="op" id="4466915">)</span><span class="op" id="4466916">&amp;</span><span class="num" id="4466917">0xf0</span><span class="op" id="4466921">)</span><br>
<span class="lineno">750</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4466925">buf</span><span class="op" id="4466928">[</span><span class="num" id="4466929">9</span><span class="op" id="4466930">]</span>&nbsp;<span class="op" id="4466932">=</span>&nbsp;<span class="builtintype" id="4466934">byte</span><span class="op" id="4466938">(</span><span class="ident" id="4466939">in</span><span class="op" id="4466941">[</span><span class="num" id="4466942">5</span><span class="op" id="4466943">]</span>&nbsp;<span class="op" id="4466945">&gt;&gt;</span>&nbsp;<span class="num" id="4466948">4</span><span class="op" id="4466949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4466952">buf</span><span class="op" id="4466955">[</span><span class="num" id="4466956">8</span><span class="op" id="4466957">]</span>&nbsp;<span class="op" id="4466959">=</span>&nbsp;<span class="builtintype" id="4466961">byte</span><span class="op" id="4466965">(</span><span class="ident" id="4466966">in</span><span class="op" id="4466968">[</span><span class="num" id="4466969">5</span><span class="op" id="4466970">]</span>&nbsp;<span class="op" id="4466972">&gt;&gt;</span>&nbsp;<span class="num" id="4466975">12</span><span class="op" id="4466977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4466980">buf</span><span class="op" id="4466983">[</span><span class="num" id="4466984">7</span><span class="op" id="4466985">]</span>&nbsp;<span class="op" id="4466987">=</span>&nbsp;<span class="builtintype" id="4466989">byte</span><span class="op" id="4466993">(</span><span class="ident" id="4466994">in</span><span class="op" id="4466996">[</span><span class="num" id="4466997">5</span><span class="op" id="4466998">]</span>&nbsp;<span class="op" id="4467000">&gt;&gt;</span>&nbsp;<span class="num" id="4467003">20</span><span class="op" id="4467005">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4467009">buf</span><span class="op" id="4467012">[</span><span class="num" id="4467013">6</span><span class="op" id="4467014">]</span>&nbsp;<span class="op" id="4467016">=</span>&nbsp;<span class="builtintype" id="4467018">byte</span><span class="op" id="4467022">(</span><span class="ident" id="4467023">in</span><span class="op" id="4467025">[</span><span class="num" id="4467026">6</span><span class="op" id="4467027">]</span><span class="op" id="4467028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4467031">buf</span><span class="op" id="4467034">[</span><span class="num" id="4467035">5</span><span class="op" id="4467036">]</span>&nbsp;<span class="op" id="4467038">=</span>&nbsp;<span class="builtintype" id="4467040">byte</span><span class="op" id="4467044">(</span><span class="ident" id="4467045">in</span><span class="op" id="4467047">[</span><span class="num" id="4467048">6</span><span class="op" id="4467049">]</span>&nbsp;<span class="op" id="4467051">&gt;&gt;</span>&nbsp;<span class="num" id="4467054">8</span><span class="op" id="4467055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4467058">buf</span><span class="op" id="4467061">[</span><span class="num" id="4467062">4</span><span class="op" id="4467063">]</span>&nbsp;<span class="op" id="4467065">=</span>&nbsp;<span class="builtintype" id="4467067">byte</span><span class="op" id="4467071">(</span><span class="ident" id="4467072">in</span><span class="op" id="4467074">[</span><span class="num" id="4467075">6</span><span class="op" id="4467076">]</span>&nbsp;<span class="op" id="4467078">&gt;&gt;</span>&nbsp;<span class="num" id="4467081">16</span><span class="op" id="4467083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4467086">buf</span><span class="op" id="4467089">[</span><span class="num" id="4467090">3</span><span class="op" id="4467091">]</span>&nbsp;<span class="op" id="4467093">=</span>&nbsp;<span class="builtintype" id="4467095">byte</span><span class="op" id="4467099">(</span><span class="op" id="4467100">(</span><span class="op" id="4467101">(</span><span class="ident" id="4467102">in</span><span class="op" id="4467104">[</span><span class="num" id="4467105">6</span><span class="op" id="4467106">]</span>&nbsp;<span class="op" id="4467108">&gt;&gt;</span>&nbsp;<span class="num" id="4467111">24</span><span class="op" id="4467113">)</span>&nbsp;<span class="op" id="4467115">&amp;</span>&nbsp;<span class="num" id="4467117">0x0f</span><span class="op" id="4467121">)</span>&nbsp;<span class="op" id="4467123">|</span>&nbsp;<span class="op" id="4467125">(</span><span class="ident" id="4467126">in</span><span class="op" id="4467128">[</span><span class="num" id="4467129">7</span><span class="op" id="4467130">]</span><span class="op" id="4467131">&lt;&lt;</span><span class="num" id="4467133">4</span><span class="op" id="4467134">)</span><span class="op" id="4467135">&amp;</span><span class="num" id="4467136">0xf0</span><span class="op" id="4467140">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4467144">buf</span><span class="op" id="4467147">[</span><span class="num" id="4467148">2</span><span class="op" id="4467149">]</span>&nbsp;<span class="op" id="4467151">=</span>&nbsp;<span class="builtintype" id="4467153">byte</span><span class="op" id="4467157">(</span><span class="ident" id="4467158">in</span><span class="op" id="4467160">[</span><span class="num" id="4467161">7</span><span class="op" id="4467162">]</span>&nbsp;<span class="op" id="4467164">&gt;&gt;</span>&nbsp;<span class="num" id="4467167">4</span><span class="op" id="4467168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4467171">buf</span><span class="op" id="4467174">[</span><span class="num" id="4467175">1</span><span class="op" id="4467176">]</span>&nbsp;<span class="op" id="4467178">=</span>&nbsp;<span class="builtintype" id="4467180">byte</span><span class="op" id="4467184">(</span><span class="ident" id="4467185">in</span><span class="op" id="4467187">[</span><span class="num" id="4467188">7</span><span class="op" id="4467189">]</span>&nbsp;<span class="op" id="4467191">&gt;&gt;</span>&nbsp;<span class="num" id="4467194">12</span><span class="op" id="4467196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4467199">buf</span><span class="op" id="4467202">[</span><span class="num" id="4467203">0</span><span class="op" id="4467204">]</span>&nbsp;<span class="op" id="4467206">=</span>&nbsp;<span class="builtintype" id="4467208">byte</span><span class="op" id="4467212">(</span><span class="ident" id="4467213">in</span><span class="op" id="4467215">[</span><span class="num" id="4467216">7</span><span class="op" id="4467217">]</span>&nbsp;<span class="op" id="4467219">&gt;&gt;</span>&nbsp;<span class="num" id="4467222">20</span><span class="op" id="4467224">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4467228">return</span>&nbsp;<span class="builtinfunc" id="4467235">new</span><span class="op" id="4467238">(</span><span class="ident" id="4467239">big</span><span class="op" id="4467242">.</span><span class="ident" id="4467243">Int</span><span class="op" id="4467246">)</span><span class="op" id="4467247">.</span><span class="ident" id="4467248">SetBytes</span><span class="op" id="4467256">(</span><span class="ident" id="4467257">buf</span><span class="op" id="4467260">[</span><span class="op" id="4467261">:</span><span class="op" id="4467262">]</span><span class="op" id="4467263">)</span><br>
<span class="lineno">765</span><span class="op" id="4467265">}</span>
</div>
</body>
</html>
