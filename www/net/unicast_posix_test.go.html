<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="8008243">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8008299">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8008353">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="8008404">//&nbsp;+build&nbsp;!plan9</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8008422">package</span>&nbsp;<span class="ident" id="8008430">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8008435">import</span>&nbsp;<span class="op" id="8008442">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8008445">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8008456">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8008467">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8008477">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="8008480">var</span>&nbsp;<span class="ident" id="8008484">listenerTests</span>&nbsp;<span class="op" id="8008498">=</span>&nbsp;<span class="op" id="8008500">[</span><span class="op" id="8008501">]</span><span class="keyword" id="8008502">struct</span>&nbsp;<span class="op" id="8008509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8008512">net</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8008521">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8008529">laddr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8008538">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8008546">ipv6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8008555">bool</span>&nbsp;<span class="comment" id="8008560">//&nbsp;test&nbsp;with&nbsp;underlying&nbsp;AF_INET6&nbsp;socket</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8008601">wildcard</span>&nbsp;<span class="builtintype" id="8008610">bool</span>&nbsp;<span class="comment" id="8008615">//&nbsp;test&nbsp;with&nbsp;wildcard&nbsp;address</span><br>
<span class="lineno">20</span><span class="op" id="8008645">}</span><span class="op" id="8008646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8008649">{</span><span class="ident" id="8008650">net</span><span class="op" id="8008653">:</span>&nbsp;<span class="string" id="8008655">&#34;tcp&#34;</span><span class="op" id="8008660">,</span>&nbsp;<span class="ident" id="8008662">laddr</span><span class="op" id="8008667">:</span>&nbsp;<span class="string" id="8008669">&#34;&#34;</span><span class="op" id="8008671">,</span>&nbsp;<span class="ident" id="8008673">wildcard</span><span class="op" id="8008681">:</span>&nbsp;<span class="builtintype" id="8008683">true</span><span class="op" id="8008687">}</span><span class="op" id="8008688">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8008691">{</span><span class="ident" id="8008692">net</span><span class="op" id="8008695">:</span>&nbsp;<span class="string" id="8008697">&#34;tcp&#34;</span><span class="op" id="8008702">,</span>&nbsp;<span class="ident" id="8008704">laddr</span><span class="op" id="8008709">:</span>&nbsp;<span class="string" id="8008711">&#34;0.0.0.0&#34;</span><span class="op" id="8008720">,</span>&nbsp;<span class="ident" id="8008722">wildcard</span><span class="op" id="8008730">:</span>&nbsp;<span class="builtintype" id="8008732">true</span><span class="op" id="8008736">}</span><span class="op" id="8008737">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8008740">{</span><span class="ident" id="8008741">net</span><span class="op" id="8008744">:</span>&nbsp;<span class="string" id="8008746">&#34;tcp&#34;</span><span class="op" id="8008751">,</span>&nbsp;<span class="ident" id="8008753">laddr</span><span class="op" id="8008758">:</span>&nbsp;<span class="string" id="8008760">&#34;[::ffff:0.0.0.0]&#34;</span><span class="op" id="8008778">,</span>&nbsp;<span class="ident" id="8008780">wildcard</span><span class="op" id="8008788">:</span>&nbsp;<span class="builtintype" id="8008790">true</span><span class="op" id="8008794">}</span><span class="op" id="8008795">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8008798">{</span><span class="ident" id="8008799">net</span><span class="op" id="8008802">:</span>&nbsp;<span class="string" id="8008804">&#34;tcp&#34;</span><span class="op" id="8008809">,</span>&nbsp;<span class="ident" id="8008811">laddr</span><span class="op" id="8008816">:</span>&nbsp;<span class="string" id="8008818">&#34;[::]&#34;</span><span class="op" id="8008824">,</span>&nbsp;<span class="ident" id="8008826">ipv6</span><span class="op" id="8008830">:</span>&nbsp;<span class="builtintype" id="8008832">true</span><span class="op" id="8008836">,</span>&nbsp;<span class="ident" id="8008838">wildcard</span><span class="op" id="8008846">:</span>&nbsp;<span class="builtintype" id="8008848">true</span><span class="op" id="8008852">}</span><span class="op" id="8008853">,</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8008857">{</span><span class="ident" id="8008858">net</span><span class="op" id="8008861">:</span>&nbsp;<span class="string" id="8008863">&#34;tcp&#34;</span><span class="op" id="8008868">,</span>&nbsp;<span class="ident" id="8008870">laddr</span><span class="op" id="8008875">:</span>&nbsp;<span class="string" id="8008877">&#34;127.0.0.1&#34;</span><span class="op" id="8008888">}</span><span class="op" id="8008889">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8008892">{</span><span class="ident" id="8008893">net</span><span class="op" id="8008896">:</span>&nbsp;<span class="string" id="8008898">&#34;tcp&#34;</span><span class="op" id="8008903">,</span>&nbsp;<span class="ident" id="8008905">laddr</span><span class="op" id="8008910">:</span>&nbsp;<span class="string" id="8008912">&#34;[::ffff:127.0.0.1]&#34;</span><span class="op" id="8008932">}</span><span class="op" id="8008933">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8008936">{</span><span class="ident" id="8008937">net</span><span class="op" id="8008940">:</span>&nbsp;<span class="string" id="8008942">&#34;tcp&#34;</span><span class="op" id="8008947">,</span>&nbsp;<span class="ident" id="8008949">laddr</span><span class="op" id="8008954">:</span>&nbsp;<span class="string" id="8008956">&#34;[::1]&#34;</span><span class="op" id="8008963">,</span>&nbsp;<span class="ident" id="8008965">ipv6</span><span class="op" id="8008969">:</span>&nbsp;<span class="builtintype" id="8008971">true</span><span class="op" id="8008975">}</span><span class="op" id="8008976">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8008980">{</span><span class="ident" id="8008981">net</span><span class="op" id="8008984">:</span>&nbsp;<span class="string" id="8008986">&#34;tcp4&#34;</span><span class="op" id="8008992">,</span>&nbsp;<span class="ident" id="8008994">laddr</span><span class="op" id="8008999">:</span>&nbsp;<span class="string" id="8009001">&#34;&#34;</span><span class="op" id="8009003">,</span>&nbsp;<span class="ident" id="8009005">wildcard</span><span class="op" id="8009013">:</span>&nbsp;<span class="builtintype" id="8009015">true</span><span class="op" id="8009019">}</span><span class="op" id="8009020">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8009023">{</span><span class="ident" id="8009024">net</span><span class="op" id="8009027">:</span>&nbsp;<span class="string" id="8009029">&#34;tcp4&#34;</span><span class="op" id="8009035">,</span>&nbsp;<span class="ident" id="8009037">laddr</span><span class="op" id="8009042">:</span>&nbsp;<span class="string" id="8009044">&#34;0.0.0.0&#34;</span><span class="op" id="8009053">,</span>&nbsp;<span class="ident" id="8009055">wildcard</span><span class="op" id="8009063">:</span>&nbsp;<span class="builtintype" id="8009065">true</span><span class="op" id="8009069">}</span><span class="op" id="8009070">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8009073">{</span><span class="ident" id="8009074">net</span><span class="op" id="8009077">:</span>&nbsp;<span class="string" id="8009079">&#34;tcp4&#34;</span><span class="op" id="8009085">,</span>&nbsp;<span class="ident" id="8009087">laddr</span><span class="op" id="8009092">:</span>&nbsp;<span class="string" id="8009094">&#34;[::ffff:0.0.0.0]&#34;</span><span class="op" id="8009112">,</span>&nbsp;<span class="ident" id="8009114">wildcard</span><span class="op" id="8009122">:</span>&nbsp;<span class="builtintype" id="8009124">true</span><span class="op" id="8009128">}</span><span class="op" id="8009129">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8009133">{</span><span class="ident" id="8009134">net</span><span class="op" id="8009137">:</span>&nbsp;<span class="string" id="8009139">&#34;tcp4&#34;</span><span class="op" id="8009145">,</span>&nbsp;<span class="ident" id="8009147">laddr</span><span class="op" id="8009152">:</span>&nbsp;<span class="string" id="8009154">&#34;127.0.0.1&#34;</span><span class="op" id="8009165">}</span><span class="op" id="8009166">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8009169">{</span><span class="ident" id="8009170">net</span><span class="op" id="8009173">:</span>&nbsp;<span class="string" id="8009175">&#34;tcp4&#34;</span><span class="op" id="8009181">,</span>&nbsp;<span class="ident" id="8009183">laddr</span><span class="op" id="8009188">:</span>&nbsp;<span class="string" id="8009190">&#34;[::ffff:127.0.0.1]&#34;</span><span class="op" id="8009210">}</span><span class="op" id="8009211">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8009215">{</span><span class="ident" id="8009216">net</span><span class="op" id="8009219">:</span>&nbsp;<span class="string" id="8009221">&#34;tcp6&#34;</span><span class="op" id="8009227">,</span>&nbsp;<span class="ident" id="8009229">laddr</span><span class="op" id="8009234">:</span>&nbsp;<span class="string" id="8009236">&#34;&#34;</span><span class="op" id="8009238">,</span>&nbsp;<span class="ident" id="8009240">ipv6</span><span class="op" id="8009244">:</span>&nbsp;<span class="builtintype" id="8009246">true</span><span class="op" id="8009250">,</span>&nbsp;<span class="ident" id="8009252">wildcard</span><span class="op" id="8009260">:</span>&nbsp;<span class="builtintype" id="8009262">true</span><span class="op" id="8009266">}</span><span class="op" id="8009267">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8009270">{</span><span class="ident" id="8009271">net</span><span class="op" id="8009274">:</span>&nbsp;<span class="string" id="8009276">&#34;tcp6&#34;</span><span class="op" id="8009282">,</span>&nbsp;<span class="ident" id="8009284">laddr</span><span class="op" id="8009289">:</span>&nbsp;<span class="string" id="8009291">&#34;[::]&#34;</span><span class="op" id="8009297">,</span>&nbsp;<span class="ident" id="8009299">ipv6</span><span class="op" id="8009303">:</span>&nbsp;<span class="builtintype" id="8009305">true</span><span class="op" id="8009309">,</span>&nbsp;<span class="ident" id="8009311">wildcard</span><span class="op" id="8009319">:</span>&nbsp;<span class="builtintype" id="8009321">true</span><span class="op" id="8009325">}</span><span class="op" id="8009326">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8009330">{</span><span class="ident" id="8009331">net</span><span class="op" id="8009334">:</span>&nbsp;<span class="string" id="8009336">&#34;tcp6&#34;</span><span class="op" id="8009342">,</span>&nbsp;<span class="ident" id="8009344">laddr</span><span class="op" id="8009349">:</span>&nbsp;<span class="string" id="8009351">&#34;[::1]&#34;</span><span class="op" id="8009358">,</span>&nbsp;<span class="ident" id="8009360">ipv6</span><span class="op" id="8009364">:</span>&nbsp;<span class="builtintype" id="8009366">true</span><span class="op" id="8009370">}</span><span class="op" id="8009371">,</span><br>
<span class="lineno"></span><span class="op" id="8009373">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8009376">//&nbsp;TestTCPListener&nbsp;tests&nbsp;both&nbsp;single&nbsp;and&nbsp;double&nbsp;listen&nbsp;to&nbsp;a&nbsp;test</span><br>
<span class="lineno"></span><span class="comment" id="8009441">//&nbsp;listener&nbsp;with&nbsp;same&nbsp;address&nbsp;family,&nbsp;same&nbsp;listening&nbsp;address&nbsp;and</span><br>
<span class="lineno">45</span><span class="comment" id="8009506">//&nbsp;same&nbsp;port.</span><br>
<span class="lineno"></span><span class="keyword" id="8009520">func</span>&nbsp;<span class="ident" id="8009525">TestTCPListener</span><span class="op" id="8009540">(</span><span class="ident" id="8009541">t</span>&nbsp;<span class="op" id="8009543">*</span><span class="ident" id="8009544"><a href="/net/unicast_posix_test.go.html#8008467">testing</a></span><span class="op" id="8009551">.</span><span class="ident" id="8009552">T</span><span class="op" id="8009553">)</span>&nbsp;<span class="op" id="8009555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8009558">switch</span>&nbsp;<span class="ident" id="8009565"><a href="/net/unicast_posix_test.go.html#8008445">runtime</a></span><span class="op" id="8009572">.</span><span class="ident" id="8009573">GOOS</span>&nbsp;<span class="op" id="8009578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8009581">case</span>&nbsp;<span class="string" id="8009586">&#34;plan9&#34;</span><span class="op" id="8009593">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8009597"><a href="/net/unicast_posix_test.go.html#8009541">t</a></span><span class="op" id="8009598">.</span><span class="ident" id="8009599">Skipf</span><span class="op" id="8009604">(</span><span class="string" id="8009605">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="8009626">,</span>&nbsp;<span class="ident" id="8009628"><a href="/net/unicast_posix_test.go.html#8008445">runtime</a></span><span class="op" id="8009635">.</span><span class="ident" id="8009636">GOOS</span><span class="op" id="8009640">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8009643">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8009647">for</span>&nbsp;<span class="ident" id="8009651">_</span><span class="op" id="8009652">,</span>&nbsp;<span class="ident" id="8009654">tt</span>&nbsp;<span class="op" id="8009657">:=</span>&nbsp;<span class="keyword" id="8009660">range</span>&nbsp;<span class="ident" id="8009666"><a href="/net/unicast_posix_test.go.html#8008484">listenerTests</a></span>&nbsp;<span class="op" id="8009680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8009684">if</span>&nbsp;<span class="ident" id="8009687"><a href="/net/unicast_posix_test.go.html#8009654">tt</a></span><span class="op" id="8009689">.</span><span class="ident" id="8009690">wildcard</span>&nbsp;<span class="op" id="8009699">&amp;&amp;</span>&nbsp;<span class="op" id="8009702">(</span><span class="ident" id="8009703"><a href="/net/unicast_posix_test.go.html#8008467">testing</a></span><span class="op" id="8009710">.</span><span class="ident" id="8009711">Short</span><span class="op" id="8009716">(</span><span class="op" id="8009717">)</span>&nbsp;<span class="op" id="8009719">||</span>&nbsp;<span class="op" id="8009722">!</span><span class="op" id="8009723">*</span><span class="ident" id="8009724"><a href="/net/lookup_test.go.html#7913432">testExternal</a></span><span class="op" id="8009736">)</span>&nbsp;<span class="op" id="8009738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8009743">continue</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8009754">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8009758">if</span>&nbsp;<span class="ident" id="8009761"><a href="/net/unicast_posix_test.go.html#8009654">tt</a></span><span class="op" id="8009763">.</span><span class="ident" id="8009764">ipv6</span>&nbsp;<span class="op" id="8009769">&amp;&amp;</span>&nbsp;<span class="op" id="8009772">!</span><span class="ident" id="8009773"><a href="/net/ipsock.go.html#1440628">supportsIPv6</a></span>&nbsp;<span class="op" id="8009786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8009791">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8009802">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8009806">l1</span><span class="op" id="8009808">,</span>&nbsp;<span class="ident" id="8009810">port</span>&nbsp;<span class="op" id="8009815">:=</span>&nbsp;<span class="ident" id="8009818"><a href="/net/unicast_posix_test.go.html#8017310">usableListenPort</a></span><span class="op" id="8009834">(</span><span class="ident" id="8009835"><a href="/net/unicast_posix_test.go.html#8009541">t</a></span><span class="op" id="8009836">,</span>&nbsp;<span class="ident" id="8009838"><a href="/net/unicast_posix_test.go.html#8009654">tt</a></span><span class="op" id="8009840">.</span><span class="ident" id="8009841">net</span><span class="op" id="8009844">,</span>&nbsp;<span class="ident" id="8009846"><a href="/net/unicast_posix_test.go.html#8009654">tt</a></span><span class="op" id="8009848">.</span><span class="ident" id="8009849">laddr</span><span class="op" id="8009854">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8009858"><a href="/net/unicast_posix_test.go.html#8018580">checkFirstListener</a></span><span class="op" id="8009876">(</span><span class="ident" id="8009877"><a href="/net/unicast_posix_test.go.html#8009541">t</a></span><span class="op" id="8009878">,</span>&nbsp;<span class="ident" id="8009880"><a href="/net/unicast_posix_test.go.html#8009654">tt</a></span><span class="op" id="8009882">.</span><span class="ident" id="8009883">net</span><span class="op" id="8009886">,</span>&nbsp;<span class="ident" id="8009888"><a href="/net/unicast_posix_test.go.html#8009654">tt</a></span><span class="op" id="8009890">.</span><span class="ident" id="8009891">laddr</span><span class="op" id="8009896">+</span><span class="string" id="8009897">&#34;:&#34;</span><span class="op" id="8009900">+</span><span class="ident" id="8009901"><a href="/net/unicast_posix_test.go.html#8009810">port</a></span><span class="op" id="8009905">,</span>&nbsp;<span class="ident" id="8009907"><a href="/net/unicast_posix_test.go.html#8009806">l1</a></span><span class="op" id="8009909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8009913">l2</span><span class="op" id="8009915">,</span>&nbsp;<span class="ident" id="8009917">err</span>&nbsp;<span class="op" id="8009921">:=</span>&nbsp;<span class="ident" id="8009924"><a href="/net/dial.go.html#1338035">Listen</a></span><span class="op" id="8009930">(</span><span class="ident" id="8009931"><a href="/net/unicast_posix_test.go.html#8009654">tt</a></span><span class="op" id="8009933">.</span><span class="ident" id="8009934">net</span><span class="op" id="8009937">,</span>&nbsp;<span class="ident" id="8009939"><a href="/net/unicast_posix_test.go.html#8009654">tt</a></span><span class="op" id="8009941">.</span><span class="ident" id="8009942">laddr</span><span class="op" id="8009947">+</span><span class="string" id="8009948">&#34;:&#34;</span><span class="op" id="8009951">+</span><span class="ident" id="8009952"><a href="/net/unicast_posix_test.go.html#8009810">port</a></span><span class="op" id="8009956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8009960"><a href="/net/unicast_posix_test.go.html#8019692">checkSecondListener</a></span><span class="op" id="8009979">(</span><span class="ident" id="8009980"><a href="/net/unicast_posix_test.go.html#8009541">t</a></span><span class="op" id="8009981">,</span>&nbsp;<span class="ident" id="8009983"><a href="/net/unicast_posix_test.go.html#8009654">tt</a></span><span class="op" id="8009985">.</span><span class="ident" id="8009986">net</span><span class="op" id="8009989">,</span>&nbsp;<span class="ident" id="8009991"><a href="/net/unicast_posix_test.go.html#8009654">tt</a></span><span class="op" id="8009993">.</span><span class="ident" id="8009994">laddr</span><span class="op" id="8009999">+</span><span class="string" id="8010000">&#34;:&#34;</span><span class="op" id="8010003">+</span><span class="ident" id="8010004"><a href="/net/unicast_posix_test.go.html#8009810">port</a></span><span class="op" id="8010008">,</span>&nbsp;<span class="ident" id="8010010"><a href="/net/unicast_posix_test.go.html#8009917">err</a></span><span class="op" id="8010013">,</span>&nbsp;<span class="ident" id="8010015"><a href="/net/unicast_posix_test.go.html#8009913">l2</a></span><span class="op" id="8010017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8010021"><a href="/net/unicast_posix_test.go.html#8009806">l1</a></span><span class="op" id="8010023">.</span><span class="ident" id="8010024">Close</span><span class="op" id="8010029">(</span><span class="op" id="8010030">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8010033">}</span><br>
<span class="lineno">65</span><span class="op" id="8010035">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8010038">//&nbsp;TestUDPListener&nbsp;tests&nbsp;both&nbsp;single&nbsp;and&nbsp;double&nbsp;listen&nbsp;to&nbsp;a&nbsp;test</span><br>
<span class="lineno"></span><span class="comment" id="8010103">//&nbsp;listener&nbsp;with&nbsp;same&nbsp;address&nbsp;family,&nbsp;same&nbsp;listening&nbsp;address&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="8010168">//&nbsp;same&nbsp;port.</span><br>
<span class="lineno">70</span><span class="keyword" id="8010182">func</span>&nbsp;<span class="ident" id="8010187">TestUDPListener</span><span class="op" id="8010202">(</span><span class="ident" id="8010203">t</span>&nbsp;<span class="op" id="8010205">*</span><span class="ident" id="8010206"><a href="/net/unicast_posix_test.go.html#8008467">testing</a></span><span class="op" id="8010213">.</span><span class="ident" id="8010214">T</span><span class="op" id="8010215">)</span>&nbsp;<span class="op" id="8010217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8010220">switch</span>&nbsp;<span class="ident" id="8010227"><a href="/net/unicast_posix_test.go.html#8008445">runtime</a></span><span class="op" id="8010234">.</span><span class="ident" id="8010235">GOOS</span>&nbsp;<span class="op" id="8010240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8010243">case</span>&nbsp;<span class="string" id="8010248">&#34;plan9&#34;</span><span class="op" id="8010255">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8010259"><a href="/net/unicast_posix_test.go.html#8010203">t</a></span><span class="op" id="8010260">.</span><span class="ident" id="8010261">Skipf</span><span class="op" id="8010266">(</span><span class="string" id="8010267">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="8010288">,</span>&nbsp;<span class="ident" id="8010290"><a href="/net/unicast_posix_test.go.html#8008445">runtime</a></span><span class="op" id="8010297">.</span><span class="ident" id="8010298">GOOS</span><span class="op" id="8010302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8010305">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8010309">toudpnet</span>&nbsp;<span class="op" id="8010318">:=</span>&nbsp;<span class="keyword" id="8010321">func</span><span class="op" id="8010325">(</span><span class="ident" id="8010326">net</span>&nbsp;<span class="builtintype" id="8010330">string</span><span class="op" id="8010336">)</span>&nbsp;<span class="builtintype" id="8010338">string</span>&nbsp;<span class="op" id="8010345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8010349">switch</span>&nbsp;<span class="ident" id="8010356"><a href="/net/unicast_posix_test.go.html#8010326">net</a></span>&nbsp;<span class="op" id="8010360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8010364">case</span>&nbsp;<span class="string" id="8010369">&#34;tcp&#34;</span><span class="op" id="8010374">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8010379">return</span>&nbsp;<span class="string" id="8010386">&#34;udp&#34;</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8010394">case</span>&nbsp;<span class="string" id="8010399">&#34;tcp4&#34;</span><span class="op" id="8010405">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8010410">return</span>&nbsp;<span class="string" id="8010417">&#34;udp4&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8010426">case</span>&nbsp;<span class="string" id="8010431">&#34;tcp6&#34;</span><span class="op" id="8010437">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8010442">return</span>&nbsp;<span class="string" id="8010449">&#34;udp6&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8010458">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8010462">return</span>&nbsp;<span class="string" id="8010469">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8010478">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8010482">for</span>&nbsp;<span class="ident" id="8010486">_</span><span class="op" id="8010487">,</span>&nbsp;<span class="ident" id="8010489">tt</span>&nbsp;<span class="op" id="8010492">:=</span>&nbsp;<span class="keyword" id="8010495">range</span>&nbsp;<span class="ident" id="8010501"><a href="/net/unicast_posix_test.go.html#8008484">listenerTests</a></span>&nbsp;<span class="op" id="8010515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8010519">if</span>&nbsp;<span class="ident" id="8010522"><a href="/net/unicast_posix_test.go.html#8010489">tt</a></span><span class="op" id="8010524">.</span><span class="ident" id="8010525">wildcard</span>&nbsp;<span class="op" id="8010534">&amp;&amp;</span>&nbsp;<span class="op" id="8010537">(</span><span class="ident" id="8010538"><a href="/net/unicast_posix_test.go.html#8008467">testing</a></span><span class="op" id="8010545">.</span><span class="ident" id="8010546">Short</span><span class="op" id="8010551">(</span><span class="op" id="8010552">)</span>&nbsp;<span class="op" id="8010554">||</span>&nbsp;<span class="op" id="8010557">!</span><span class="op" id="8010558">*</span><span class="ident" id="8010559"><a href="/net/lookup_test.go.html#7913432">testExternal</a></span><span class="op" id="8010571">)</span>&nbsp;<span class="op" id="8010573">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8010578">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8010589">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8010593">if</span>&nbsp;<span class="ident" id="8010596"><a href="/net/unicast_posix_test.go.html#8010489">tt</a></span><span class="op" id="8010598">.</span><span class="ident" id="8010599">ipv6</span>&nbsp;<span class="op" id="8010604">&amp;&amp;</span>&nbsp;<span class="op" id="8010607">!</span><span class="ident" id="8010608"><a href="/net/ipsock.go.html#1440628">supportsIPv6</a></span>&nbsp;<span class="op" id="8010621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8010626">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8010637">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8010641"><a href="/net/unicast_posix_test.go.html#8010489">tt</a></span><span class="op" id="8010643">.</span><span class="ident" id="8010644">net</span>&nbsp;<span class="op" id="8010648">=</span>&nbsp;<span class="ident" id="8010650"><a href="/net/unicast_posix_test.go.html#8010309">toudpnet</a></span><span class="op" id="8010658">(</span><span class="ident" id="8010659"><a href="/net/unicast_posix_test.go.html#8010489">tt</a></span><span class="op" id="8010661">.</span><span class="ident" id="8010662">net</span><span class="op" id="8010665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8010669">l1</span><span class="op" id="8010671">,</span>&nbsp;<span class="ident" id="8010673">port</span>&nbsp;<span class="op" id="8010678">:=</span>&nbsp;<span class="ident" id="8010681"><a href="/net/unicast_posix_test.go.html#8017808">usableListenPacketPort</a></span><span class="op" id="8010703">(</span><span class="ident" id="8010704"><a href="/net/unicast_posix_test.go.html#8010203">t</a></span><span class="op" id="8010705">,</span>&nbsp;<span class="ident" id="8010707"><a href="/net/unicast_posix_test.go.html#8010489">tt</a></span><span class="op" id="8010709">.</span><span class="ident" id="8010710">net</span><span class="op" id="8010713">,</span>&nbsp;<span class="ident" id="8010715"><a href="/net/unicast_posix_test.go.html#8010489">tt</a></span><span class="op" id="8010717">.</span><span class="ident" id="8010718">laddr</span><span class="op" id="8010723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8010727"><a href="/net/unicast_posix_test.go.html#8018580">checkFirstListener</a></span><span class="op" id="8010745">(</span><span class="ident" id="8010746"><a href="/net/unicast_posix_test.go.html#8010203">t</a></span><span class="op" id="8010747">,</span>&nbsp;<span class="ident" id="8010749"><a href="/net/unicast_posix_test.go.html#8010489">tt</a></span><span class="op" id="8010751">.</span><span class="ident" id="8010752">net</span><span class="op" id="8010755">,</span>&nbsp;<span class="ident" id="8010757"><a href="/net/unicast_posix_test.go.html#8010489">tt</a></span><span class="op" id="8010759">.</span><span class="ident" id="8010760">laddr</span><span class="op" id="8010765">+</span><span class="string" id="8010766">&#34;:&#34;</span><span class="op" id="8010769">+</span><span class="ident" id="8010770"><a href="/net/unicast_posix_test.go.html#8010673">port</a></span><span class="op" id="8010774">,</span>&nbsp;<span class="ident" id="8010776"><a href="/net/unicast_posix_test.go.html#8010669">l1</a></span><span class="op" id="8010778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8010782">l2</span><span class="op" id="8010784">,</span>&nbsp;<span class="ident" id="8010786">err</span>&nbsp;<span class="op" id="8010790">:=</span>&nbsp;<span class="ident" id="8010793"><a href="/net/dial.go.html#1338827">ListenPacket</a></span><span class="op" id="8010805">(</span><span class="ident" id="8010806"><a href="/net/unicast_posix_test.go.html#8010489">tt</a></span><span class="op" id="8010808">.</span><span class="ident" id="8010809">net</span><span class="op" id="8010812">,</span>&nbsp;<span class="ident" id="8010814"><a href="/net/unicast_posix_test.go.html#8010489">tt</a></span><span class="op" id="8010816">.</span><span class="ident" id="8010817">laddr</span><span class="op" id="8010822">+</span><span class="string" id="8010823">&#34;:&#34;</span><span class="op" id="8010826">+</span><span class="ident" id="8010827"><a href="/net/unicast_posix_test.go.html#8010673">port</a></span><span class="op" id="8010831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8010835"><a href="/net/unicast_posix_test.go.html#8019692">checkSecondListener</a></span><span class="op" id="8010854">(</span><span class="ident" id="8010855"><a href="/net/unicast_posix_test.go.html#8010203">t</a></span><span class="op" id="8010856">,</span>&nbsp;<span class="ident" id="8010858"><a href="/net/unicast_posix_test.go.html#8010489">tt</a></span><span class="op" id="8010860">.</span><span class="ident" id="8010861">net</span><span class="op" id="8010864">,</span>&nbsp;<span class="ident" id="8010866"><a href="/net/unicast_posix_test.go.html#8010489">tt</a></span><span class="op" id="8010868">.</span><span class="ident" id="8010869">laddr</span><span class="op" id="8010874">+</span><span class="string" id="8010875">&#34;:&#34;</span><span class="op" id="8010878">+</span><span class="ident" id="8010879"><a href="/net/unicast_posix_test.go.html#8010673">port</a></span><span class="op" id="8010883">,</span>&nbsp;<span class="ident" id="8010885"><a href="/net/unicast_posix_test.go.html#8010786">err</a></span><span class="op" id="8010888">,</span>&nbsp;<span class="ident" id="8010890"><a href="/net/unicast_posix_test.go.html#8010782">l2</a></span><span class="op" id="8010892">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8010896"><a href="/net/unicast_posix_test.go.html#8010669">l1</a></span><span class="op" id="8010898">.</span><span class="ident" id="8010899">Close</span><span class="op" id="8010904">(</span><span class="op" id="8010905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8010908">}</span><br>
<span class="lineno"></span><span class="op" id="8010910">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8010913">var</span>&nbsp;<span class="ident" id="8010917">dualStackListenerTests</span>&nbsp;<span class="op" id="8010940">=</span>&nbsp;<span class="op" id="8010942">[</span><span class="op" id="8010943">]</span><span class="keyword" id="8010944">struct</span>&nbsp;<span class="op" id="8010951">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8010954">net1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8010963">string</span>&nbsp;<span class="comment" id="8010970">//&nbsp;first&nbsp;listener</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8010989">laddr1</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8010998">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8011006">net2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8011015">string</span>&nbsp;<span class="comment" id="8011022">//&nbsp;second&nbsp;listener</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8011042">laddr2</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8011051">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8011059">wildcard</span>&nbsp;<span class="builtintype" id="8011068">bool</span>&nbsp;&nbsp;<span class="comment" id="8011074">//&nbsp;test&nbsp;with&nbsp;wildcard&nbsp;address</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8011105">xerr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8011114">error</span>&nbsp;<span class="comment" id="8011120">//&nbsp;expected&nbsp;error&nbsp;value,&nbsp;nil&nbsp;or&nbsp;other</span><br>
<span class="lineno"></span><span class="op" id="8011158">}</span><span class="op" id="8011159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8011162">//&nbsp;Test&nbsp;cases&nbsp;and&nbsp;expected&nbsp;results&nbsp;for&nbsp;the&nbsp;attemping&nbsp;2nd&nbsp;listen&nbsp;on&nbsp;the&nbsp;same&nbsp;port</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8011244">//&nbsp;1st&nbsp;listen&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2nd&nbsp;listen&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;darwin&nbsp;&nbsp;freebsd&nbsp;&nbsp;linux&nbsp;&nbsp;openbsd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8011333">//&nbsp;------------------------------------------------------------------------------------</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8011422">//&nbsp;&#34;tcp&#34;&nbsp;&nbsp;&#34;&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;tcp&#34;&nbsp;&nbsp;&#34;&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8011508">//&nbsp;&#34;tcp&#34;&nbsp;&nbsp;&#34;&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;tcp&#34;&nbsp;&nbsp;&#34;0.0.0.0&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8011594">//&nbsp;&#34;tcp&#34;&nbsp;&nbsp;&#34;0.0.0.0&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;tcp&#34;&nbsp;&nbsp;&#34;&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8011680">//&nbsp;------------------------------------------------------------------------------------</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8011769">//&nbsp;&#34;tcp&#34;&nbsp;&nbsp;&#34;&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;tcp&#34;&nbsp;&nbsp;&#34;[::]&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8011856">//&nbsp;&#34;tcp&#34;&nbsp;&nbsp;&#34;[::]&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;tcp&#34;&nbsp;&nbsp;&#34;&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8011943">//&nbsp;&#34;tcp&#34;&nbsp;&nbsp;&#34;0.0.0.0&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;tcp&#34;&nbsp;&nbsp;&#34;[::]&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8012030">//&nbsp;&#34;tcp&#34;&nbsp;&nbsp;&#34;[::]&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;tcp&#34;&nbsp;&nbsp;&#34;0.0.0.0&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8012117">//&nbsp;&#34;tcp&#34;&nbsp;&nbsp;&#34;[::ffff:0.0.0.0]&#34;&nbsp;&#34;tcp&#34;&nbsp;&nbsp;&#34;[::]&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8012204">//&nbsp;&#34;tcp&#34;&nbsp;&nbsp;&#34;[::]&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;tcp&#34;&nbsp;&nbsp;&#34;[::ffff:0.0.0.0]&#34;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8012291">//&nbsp;------------------------------------------------------------------------------------</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8012380">//&nbsp;&#34;tcp4&#34;&nbsp;&#34;&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;tcp6&#34;&nbsp;&#34;&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8012467">//&nbsp;&#34;tcp6&#34;&nbsp;&#34;&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;tcp4&#34;&nbsp;&#34;&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8012554">//&nbsp;&#34;tcp4&#34;&nbsp;&#34;0.0.0.0&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;tcp6&#34;&nbsp;&#34;[::]&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8012641">//&nbsp;&#34;tcp6&#34;&nbsp;&#34;[::]&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;tcp4&#34;&nbsp;&#34;0.0.0.0&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8012728">//&nbsp;------------------------------------------------------------------------------------</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8012817">//&nbsp;&#34;tcp&#34;&nbsp;&nbsp;&#34;127.0.0.1&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;tcp&#34;&nbsp;&nbsp;&#34;[::1]&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8012904">//&nbsp;&#34;tcp&#34;&nbsp;&nbsp;&#34;[::1]&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;tcp&#34;&nbsp;&nbsp;&#34;127.0.0.1&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8012991">//&nbsp;&#34;tcp4&#34;&nbsp;&#34;127.0.0.1&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;tcp6&#34;&nbsp;&#34;[::1]&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8013078">//&nbsp;&#34;tcp6&#34;&nbsp;&#34;[::1]&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;tcp4&#34;&nbsp;&#34;127.0.0.1&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8013165">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8013169">//&nbsp;Platform&nbsp;default&nbsp;configurations:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8013206">//&nbsp;darwin,&nbsp;kernel&nbsp;version&nbsp;11.3.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8013240">//&nbsp;&nbsp;&nbsp;&nbspnet.inet6.ip6.v6only=0&nbsp;(overridable&nbsp;by&nbsp;sysctl&nbsp;or&nbsp;IPV6_V6ONLY&nbsp;option)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8013313">//&nbsp;freebsd,&nbsp;kernel&nbsp;version&nbsp;8.2</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8013345">//&nbsp;&nbsp;&nbsp;&nbspnet.inet6.ip6.v6only=1&nbsp;(overridable&nbsp;by&nbsp;sysctl&nbsp;or&nbsp;IPV6_V6ONLY&nbsp;option)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8013418">//&nbsp;linux,&nbsp;kernel&nbsp;version&nbsp;3.0.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8013450">//&nbsp;&nbsp;&nbsp;&nbspnet.ipv6.bindv6only=0&nbsp;(overridable&nbsp;by&nbsp;sysctl&nbsp;or&nbsp;IPV6_V6ONLY&nbsp;option)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8013522">//&nbsp;openbsd,&nbsp;kernel&nbsp;version&nbsp;5.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8013554">//&nbsp;&nbsp;&nbsp;&nbspnet.inet6.ip6.v6only=1&nbsp;(overriding&nbsp;is&nbsp;prohibited)</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8013609">{</span><span class="ident" id="8013610">net1</span><span class="op" id="8013614">:</span>&nbsp;<span class="string" id="8013616">&#34;tcp&#34;</span><span class="op" id="8013621">,</span>&nbsp;<span class="ident" id="8013623">laddr1</span><span class="op" id="8013629">:</span>&nbsp;<span class="string" id="8013631">&#34;&#34;</span><span class="op" id="8013633">,</span>&nbsp;<span class="ident" id="8013635">net2</span><span class="op" id="8013639">:</span>&nbsp;<span class="string" id="8013641">&#34;tcp&#34;</span><span class="op" id="8013646">,</span>&nbsp;<span class="ident" id="8013648">laddr2</span><span class="op" id="8013654">:</span>&nbsp;<span class="string" id="8013656">&#34;&#34;</span><span class="op" id="8013658">,</span>&nbsp;<span class="ident" id="8013660">wildcard</span><span class="op" id="8013668">:</span>&nbsp;<span class="builtintype" id="8013670">true</span><span class="op" id="8013674">,</span>&nbsp;<span class="ident" id="8013676">xerr</span><span class="op" id="8013680">:</span>&nbsp;<span class="ident" id="8013682"><a href="/net/unicast_posix_test.go.html#8008456">syscall</a></span><span class="op" id="8013689">.</span><span class="ident" id="8013690">EADDRINUSE</span><span class="op" id="8013700">}</span><span class="op" id="8013701">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8013704">{</span><span class="ident" id="8013705">net1</span><span class="op" id="8013709">:</span>&nbsp;<span class="string" id="8013711">&#34;tcp&#34;</span><span class="op" id="8013716">,</span>&nbsp;<span class="ident" id="8013718">laddr1</span><span class="op" id="8013724">:</span>&nbsp;<span class="string" id="8013726">&#34;&#34;</span><span class="op" id="8013728">,</span>&nbsp;<span class="ident" id="8013730">net2</span><span class="op" id="8013734">:</span>&nbsp;<span class="string" id="8013736">&#34;tcp&#34;</span><span class="op" id="8013741">,</span>&nbsp;<span class="ident" id="8013743">laddr2</span><span class="op" id="8013749">:</span>&nbsp;<span class="string" id="8013751">&#34;0.0.0.0&#34;</span><span class="op" id="8013760">,</span>&nbsp;<span class="ident" id="8013762">wildcard</span><span class="op" id="8013770">:</span>&nbsp;<span class="builtintype" id="8013772">true</span><span class="op" id="8013776">,</span>&nbsp;<span class="ident" id="8013778">xerr</span><span class="op" id="8013782">:</span>&nbsp;<span class="ident" id="8013784"><a href="/net/unicast_posix_test.go.html#8008456">syscall</a></span><span class="op" id="8013791">.</span><span class="ident" id="8013792">EADDRINUSE</span><span class="op" id="8013802">}</span><span class="op" id="8013803">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8013806">{</span><span class="ident" id="8013807">net1</span><span class="op" id="8013811">:</span>&nbsp;<span class="string" id="8013813">&#34;tcp&#34;</span><span class="op" id="8013818">,</span>&nbsp;<span class="ident" id="8013820">laddr1</span><span class="op" id="8013826">:</span>&nbsp;<span class="string" id="8013828">&#34;0.0.0.0&#34;</span><span class="op" id="8013837">,</span>&nbsp;<span class="ident" id="8013839">net2</span><span class="op" id="8013843">:</span>&nbsp;<span class="string" id="8013845">&#34;tcp&#34;</span><span class="op" id="8013850">,</span>&nbsp;<span class="ident" id="8013852">laddr2</span><span class="op" id="8013858">:</span>&nbsp;<span class="string" id="8013860">&#34;&#34;</span><span class="op" id="8013862">,</span>&nbsp;<span class="ident" id="8013864">wildcard</span><span class="op" id="8013872">:</span>&nbsp;<span class="builtintype" id="8013874">true</span><span class="op" id="8013878">,</span>&nbsp;<span class="ident" id="8013880">xerr</span><span class="op" id="8013884">:</span>&nbsp;<span class="ident" id="8013886"><a href="/net/unicast_posix_test.go.html#8008456">syscall</a></span><span class="op" id="8013893">.</span><span class="ident" id="8013894">EADDRINUSE</span><span class="op" id="8013904">}</span><span class="op" id="8013905">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8013909">{</span><span class="ident" id="8013910">net1</span><span class="op" id="8013914">:</span>&nbsp;<span class="string" id="8013916">&#34;tcp&#34;</span><span class="op" id="8013921">,</span>&nbsp;<span class="ident" id="8013923">laddr1</span><span class="op" id="8013929">:</span>&nbsp;<span class="string" id="8013931">&#34;&#34;</span><span class="op" id="8013933">,</span>&nbsp;<span class="ident" id="8013935">net2</span><span class="op" id="8013939">:</span>&nbsp;<span class="string" id="8013941">&#34;tcp&#34;</span><span class="op" id="8013946">,</span>&nbsp;<span class="ident" id="8013948">laddr2</span><span class="op" id="8013954">:</span>&nbsp;<span class="string" id="8013956">&#34;[::]&#34;</span><span class="op" id="8013962">,</span>&nbsp;<span class="ident" id="8013964">wildcard</span><span class="op" id="8013972">:</span>&nbsp;<span class="builtintype" id="8013974">true</span><span class="op" id="8013978">,</span>&nbsp;<span class="ident" id="8013980">xerr</span><span class="op" id="8013984">:</span>&nbsp;<span class="ident" id="8013986"><a href="/net/unicast_posix_test.go.html#8008456">syscall</a></span><span class="op" id="8013993">.</span><span class="ident" id="8013994">EADDRINUSE</span><span class="op" id="8014004">}</span><span class="op" id="8014005">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8014008">{</span><span class="ident" id="8014009">net1</span><span class="op" id="8014013">:</span>&nbsp;<span class="string" id="8014015">&#34;tcp&#34;</span><span class="op" id="8014020">,</span>&nbsp;<span class="ident" id="8014022">laddr1</span><span class="op" id="8014028">:</span>&nbsp;<span class="string" id="8014030">&#34;[::]&#34;</span><span class="op" id="8014036">,</span>&nbsp;<span class="ident" id="8014038">net2</span><span class="op" id="8014042">:</span>&nbsp;<span class="string" id="8014044">&#34;tcp&#34;</span><span class="op" id="8014049">,</span>&nbsp;<span class="ident" id="8014051">laddr2</span><span class="op" id="8014057">:</span>&nbsp;<span class="string" id="8014059">&#34;&#34;</span><span class="op" id="8014061">,</span>&nbsp;<span class="ident" id="8014063">wildcard</span><span class="op" id="8014071">:</span>&nbsp;<span class="builtintype" id="8014073">true</span><span class="op" id="8014077">,</span>&nbsp;<span class="ident" id="8014079">xerr</span><span class="op" id="8014083">:</span>&nbsp;<span class="ident" id="8014085"><a href="/net/unicast_posix_test.go.html#8008456">syscall</a></span><span class="op" id="8014092">.</span><span class="ident" id="8014093">EADDRINUSE</span><span class="op" id="8014103">}</span><span class="op" id="8014104">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8014107">{</span><span class="ident" id="8014108">net1</span><span class="op" id="8014112">:</span>&nbsp;<span class="string" id="8014114">&#34;tcp&#34;</span><span class="op" id="8014119">,</span>&nbsp;<span class="ident" id="8014121">laddr1</span><span class="op" id="8014127">:</span>&nbsp;<span class="string" id="8014129">&#34;0.0.0.0&#34;</span><span class="op" id="8014138">,</span>&nbsp;<span class="ident" id="8014140">net2</span><span class="op" id="8014144">:</span>&nbsp;<span class="string" id="8014146">&#34;tcp&#34;</span><span class="op" id="8014151">,</span>&nbsp;<span class="ident" id="8014153">laddr2</span><span class="op" id="8014159">:</span>&nbsp;<span class="string" id="8014161">&#34;[::]&#34;</span><span class="op" id="8014167">,</span>&nbsp;<span class="ident" id="8014169">wildcard</span><span class="op" id="8014177">:</span>&nbsp;<span class="builtintype" id="8014179">true</span><span class="op" id="8014183">,</span>&nbsp;<span class="ident" id="8014185">xerr</span><span class="op" id="8014189">:</span>&nbsp;<span class="ident" id="8014191"><a href="/net/unicast_posix_test.go.html#8008456">syscall</a></span><span class="op" id="8014198">.</span><span class="ident" id="8014199">EADDRINUSE</span><span class="op" id="8014209">}</span><span class="op" id="8014210">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8014213">{</span><span class="ident" id="8014214">net1</span><span class="op" id="8014218">:</span>&nbsp;<span class="string" id="8014220">&#34;tcp&#34;</span><span class="op" id="8014225">,</span>&nbsp;<span class="ident" id="8014227">laddr1</span><span class="op" id="8014233">:</span>&nbsp;<span class="string" id="8014235">&#34;[::]&#34;</span><span class="op" id="8014241">,</span>&nbsp;<span class="ident" id="8014243">net2</span><span class="op" id="8014247">:</span>&nbsp;<span class="string" id="8014249">&#34;tcp&#34;</span><span class="op" id="8014254">,</span>&nbsp;<span class="ident" id="8014256">laddr2</span><span class="op" id="8014262">:</span>&nbsp;<span class="string" id="8014264">&#34;0.0.0.0&#34;</span><span class="op" id="8014273">,</span>&nbsp;<span class="ident" id="8014275">wildcard</span><span class="op" id="8014283">:</span>&nbsp;<span class="builtintype" id="8014285">true</span><span class="op" id="8014289">,</span>&nbsp;<span class="ident" id="8014291">xerr</span><span class="op" id="8014295">:</span>&nbsp;<span class="ident" id="8014297"><a href="/net/unicast_posix_test.go.html#8008456">syscall</a></span><span class="op" id="8014304">.</span><span class="ident" id="8014305">EADDRINUSE</span><span class="op" id="8014315">}</span><span class="op" id="8014316">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8014319">{</span><span class="ident" id="8014320">net1</span><span class="op" id="8014324">:</span>&nbsp;<span class="string" id="8014326">&#34;tcp&#34;</span><span class="op" id="8014331">,</span>&nbsp;<span class="ident" id="8014333">laddr1</span><span class="op" id="8014339">:</span>&nbsp;<span class="string" id="8014341">&#34;[::ffff:0.0.0.0]&#34;</span><span class="op" id="8014359">,</span>&nbsp;<span class="ident" id="8014361">net2</span><span class="op" id="8014365">:</span>&nbsp;<span class="string" id="8014367">&#34;tcp&#34;</span><span class="op" id="8014372">,</span>&nbsp;<span class="ident" id="8014374">laddr2</span><span class="op" id="8014380">:</span>&nbsp;<span class="string" id="8014382">&#34;[::]&#34;</span><span class="op" id="8014388">,</span>&nbsp;<span class="ident" id="8014390">wildcard</span><span class="op" id="8014398">:</span>&nbsp;<span class="builtintype" id="8014400">true</span><span class="op" id="8014404">,</span>&nbsp;<span class="ident" id="8014406">xerr</span><span class="op" id="8014410">:</span>&nbsp;<span class="ident" id="8014412"><a href="/net/unicast_posix_test.go.html#8008456">syscall</a></span><span class="op" id="8014419">.</span><span class="ident" id="8014420">EADDRINUSE</span><span class="op" id="8014430">}</span><span class="op" id="8014431">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8014434">{</span><span class="ident" id="8014435">net1</span><span class="op" id="8014439">:</span>&nbsp;<span class="string" id="8014441">&#34;tcp&#34;</span><span class="op" id="8014446">,</span>&nbsp;<span class="ident" id="8014448">laddr1</span><span class="op" id="8014454">:</span>&nbsp;<span class="string" id="8014456">&#34;[::]&#34;</span><span class="op" id="8014462">,</span>&nbsp;<span class="ident" id="8014464">net2</span><span class="op" id="8014468">:</span>&nbsp;<span class="string" id="8014470">&#34;tcp&#34;</span><span class="op" id="8014475">,</span>&nbsp;<span class="ident" id="8014477">laddr2</span><span class="op" id="8014483">:</span>&nbsp;<span class="string" id="8014485">&#34;[::ffff:0.0.0.0]&#34;</span><span class="op" id="8014503">,</span>&nbsp;<span class="ident" id="8014505">wildcard</span><span class="op" id="8014513">:</span>&nbsp;<span class="builtintype" id="8014515">true</span><span class="op" id="8014519">,</span>&nbsp;<span class="ident" id="8014521">xerr</span><span class="op" id="8014525">:</span>&nbsp;<span class="ident" id="8014527"><a href="/net/unicast_posix_test.go.html#8008456">syscall</a></span><span class="op" id="8014534">.</span><span class="ident" id="8014535">EADDRINUSE</span><span class="op" id="8014545">}</span><span class="op" id="8014546">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8014550">{</span><span class="ident" id="8014551">net1</span><span class="op" id="8014555">:</span>&nbsp;<span class="string" id="8014557">&#34;tcp4&#34;</span><span class="op" id="8014563">,</span>&nbsp;<span class="ident" id="8014565">laddr1</span><span class="op" id="8014571">:</span>&nbsp;<span class="string" id="8014573">&#34;&#34;</span><span class="op" id="8014575">,</span>&nbsp;<span class="ident" id="8014577">net2</span><span class="op" id="8014581">:</span>&nbsp;<span class="string" id="8014583">&#34;tcp6&#34;</span><span class="op" id="8014589">,</span>&nbsp;<span class="ident" id="8014591">laddr2</span><span class="op" id="8014597">:</span>&nbsp;<span class="string" id="8014599">&#34;&#34;</span><span class="op" id="8014601">,</span>&nbsp;<span class="ident" id="8014603">wildcard</span><span class="op" id="8014611">:</span>&nbsp;<span class="builtintype" id="8014613">true</span><span class="op" id="8014617">}</span><span class="op" id="8014618">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8014621">{</span><span class="ident" id="8014622">net1</span><span class="op" id="8014626">:</span>&nbsp;<span class="string" id="8014628">&#34;tcp6&#34;</span><span class="op" id="8014634">,</span>&nbsp;<span class="ident" id="8014636">laddr1</span><span class="op" id="8014642">:</span>&nbsp;<span class="string" id="8014644">&#34;&#34;</span><span class="op" id="8014646">,</span>&nbsp;<span class="ident" id="8014648">net2</span><span class="op" id="8014652">:</span>&nbsp;<span class="string" id="8014654">&#34;tcp4&#34;</span><span class="op" id="8014660">,</span>&nbsp;<span class="ident" id="8014662">laddr2</span><span class="op" id="8014668">:</span>&nbsp;<span class="string" id="8014670">&#34;&#34;</span><span class="op" id="8014672">,</span>&nbsp;<span class="ident" id="8014674">wildcard</span><span class="op" id="8014682">:</span>&nbsp;<span class="builtintype" id="8014684">true</span><span class="op" id="8014688">}</span><span class="op" id="8014689">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8014692">{</span><span class="ident" id="8014693">net1</span><span class="op" id="8014697">:</span>&nbsp;<span class="string" id="8014699">&#34;tcp4&#34;</span><span class="op" id="8014705">,</span>&nbsp;<span class="ident" id="8014707">laddr1</span><span class="op" id="8014713">:</span>&nbsp;<span class="string" id="8014715">&#34;0.0.0.0&#34;</span><span class="op" id="8014724">,</span>&nbsp;<span class="ident" id="8014726">net2</span><span class="op" id="8014730">:</span>&nbsp;<span class="string" id="8014732">&#34;tcp6&#34;</span><span class="op" id="8014738">,</span>&nbsp;<span class="ident" id="8014740">laddr2</span><span class="op" id="8014746">:</span>&nbsp;<span class="string" id="8014748">&#34;[::]&#34;</span><span class="op" id="8014754">,</span>&nbsp;<span class="ident" id="8014756">wildcard</span><span class="op" id="8014764">:</span>&nbsp;<span class="builtintype" id="8014766">true</span><span class="op" id="8014770">}</span><span class="op" id="8014771">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8014774">{</span><span class="ident" id="8014775">net1</span><span class="op" id="8014779">:</span>&nbsp;<span class="string" id="8014781">&#34;tcp6&#34;</span><span class="op" id="8014787">,</span>&nbsp;<span class="ident" id="8014789">laddr1</span><span class="op" id="8014795">:</span>&nbsp;<span class="string" id="8014797">&#34;[::]&#34;</span><span class="op" id="8014803">,</span>&nbsp;<span class="ident" id="8014805">net2</span><span class="op" id="8014809">:</span>&nbsp;<span class="string" id="8014811">&#34;tcp4&#34;</span><span class="op" id="8014817">,</span>&nbsp;<span class="ident" id="8014819">laddr2</span><span class="op" id="8014825">:</span>&nbsp;<span class="string" id="8014827">&#34;0.0.0.0&#34;</span><span class="op" id="8014836">,</span>&nbsp;<span class="ident" id="8014838">wildcard</span><span class="op" id="8014846">:</span>&nbsp;<span class="builtintype" id="8014848">true</span><span class="op" id="8014852">}</span><span class="op" id="8014853">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8014857">{</span><span class="ident" id="8014858">net1</span><span class="op" id="8014862">:</span>&nbsp;<span class="string" id="8014864">&#34;tcp&#34;</span><span class="op" id="8014869">,</span>&nbsp;<span class="ident" id="8014871">laddr1</span><span class="op" id="8014877">:</span>&nbsp;<span class="string" id="8014879">&#34;127.0.0.1&#34;</span><span class="op" id="8014890">,</span>&nbsp;<span class="ident" id="8014892">net2</span><span class="op" id="8014896">:</span>&nbsp;<span class="string" id="8014898">&#34;tcp&#34;</span><span class="op" id="8014903">,</span>&nbsp;<span class="ident" id="8014905">laddr2</span><span class="op" id="8014911">:</span>&nbsp;<span class="string" id="8014913">&#34;[::1]&#34;</span><span class="op" id="8014920">}</span><span class="op" id="8014921">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8014924">{</span><span class="ident" id="8014925">net1</span><span class="op" id="8014929">:</span>&nbsp;<span class="string" id="8014931">&#34;tcp&#34;</span><span class="op" id="8014936">,</span>&nbsp;<span class="ident" id="8014938">laddr1</span><span class="op" id="8014944">:</span>&nbsp;<span class="string" id="8014946">&#34;[::1]&#34;</span><span class="op" id="8014953">,</span>&nbsp;<span class="ident" id="8014955">net2</span><span class="op" id="8014959">:</span>&nbsp;<span class="string" id="8014961">&#34;tcp&#34;</span><span class="op" id="8014966">,</span>&nbsp;<span class="ident" id="8014968">laddr2</span><span class="op" id="8014974">:</span>&nbsp;<span class="string" id="8014976">&#34;127.0.0.1&#34;</span><span class="op" id="8014987">}</span><span class="op" id="8014988">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8014991">{</span><span class="ident" id="8014992">net1</span><span class="op" id="8014996">:</span>&nbsp;<span class="string" id="8014998">&#34;tcp4&#34;</span><span class="op" id="8015004">,</span>&nbsp;<span class="ident" id="8015006">laddr1</span><span class="op" id="8015012">:</span>&nbsp;<span class="string" id="8015014">&#34;127.0.0.1&#34;</span><span class="op" id="8015025">,</span>&nbsp;<span class="ident" id="8015027">net2</span><span class="op" id="8015031">:</span>&nbsp;<span class="string" id="8015033">&#34;tcp6&#34;</span><span class="op" id="8015039">,</span>&nbsp;<span class="ident" id="8015041">laddr2</span><span class="op" id="8015047">:</span>&nbsp;<span class="string" id="8015049">&#34;[::1]&#34;</span><span class="op" id="8015056">}</span><span class="op" id="8015057">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8015060">{</span><span class="ident" id="8015061">net1</span><span class="op" id="8015065">:</span>&nbsp;<span class="string" id="8015067">&#34;tcp6&#34;</span><span class="op" id="8015073">,</span>&nbsp;<span class="ident" id="8015075">laddr1</span><span class="op" id="8015081">:</span>&nbsp;<span class="string" id="8015083">&#34;[::1]&#34;</span><span class="op" id="8015090">,</span>&nbsp;<span class="ident" id="8015092">net2</span><span class="op" id="8015096">:</span>&nbsp;<span class="string" id="8015098">&#34;tcp4&#34;</span><span class="op" id="8015104">,</span>&nbsp;<span class="ident" id="8015106">laddr2</span><span class="op" id="8015112">:</span>&nbsp;<span class="string" id="8015114">&#34;127.0.0.1&#34;</span><span class="op" id="8015125">}</span><span class="op" id="8015126">,</span><br>
<span class="lineno"></span><span class="op" id="8015128">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8015131">//&nbsp;TestDualStackTCPListener&nbsp;tests&nbsp;both&nbsp;single&nbsp;and&nbsp;double&nbsp;listen</span><br>
<span class="lineno"></span><span class="comment" id="8015195">//&nbsp;to&nbsp;a&nbsp;test&nbsp;listener&nbsp;with&nbsp;various&nbsp;address&nbsp;families,&nbsp;different</span><br>
<span class="lineno">170</span><span class="comment" id="8015258">//&nbsp;listening&nbsp;address&nbsp;and&nbsp;same&nbsp;port.</span><br>
<span class="lineno"></span><span class="keyword" id="8015294">func</span>&nbsp;<span class="ident" id="8015299">TestDualStackTCPListener</span><span class="op" id="8015323">(</span><span class="ident" id="8015324">t</span>&nbsp;<span class="op" id="8015326">*</span><span class="ident" id="8015327"><a href="/net/unicast_posix_test.go.html#8008467">testing</a></span><span class="op" id="8015334">.</span><span class="ident" id="8015335">T</span><span class="op" id="8015336">)</span>&nbsp;<span class="op" id="8015338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8015341">if</span>&nbsp;<span class="ident" id="8015344"><a href="/net/unicast_posix_test.go.html#8008467">testing</a></span><span class="op" id="8015351">.</span><span class="ident" id="8015352">Short</span><span class="op" id="8015357">(</span><span class="op" id="8015358">)</span>&nbsp;<span class="op" id="8015360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8015364"><a href="/net/unicast_posix_test.go.html#8015324">t</a></span><span class="op" id="8015365">.</span><span class="ident" id="8015366">Skip</span><span class="op" id="8015370">(</span><span class="string" id="8015371">&#34;skipping&nbsp;in&nbsp;-short&nbsp;mode,&nbsp;see&nbsp;issue&nbsp;5001&#34;</span><span class="op" id="8015412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8015415">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8015418">switch</span>&nbsp;<span class="ident" id="8015425"><a href="/net/unicast_posix_test.go.html#8008445">runtime</a></span><span class="op" id="8015432">.</span><span class="ident" id="8015433">GOOS</span>&nbsp;<span class="op" id="8015438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8015441">case</span>&nbsp;<span class="string" id="8015446">&#34;plan9&#34;</span><span class="op" id="8015453">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8015457"><a href="/net/unicast_posix_test.go.html#8015324">t</a></span><span class="op" id="8015458">.</span><span class="ident" id="8015459">Skipf</span><span class="op" id="8015464">(</span><span class="string" id="8015465">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="8015486">,</span>&nbsp;<span class="ident" id="8015488"><a href="/net/unicast_posix_test.go.html#8008445">runtime</a></span><span class="op" id="8015495">.</span><span class="ident" id="8015496">GOOS</span><span class="op" id="8015500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8015503">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8015506">if</span>&nbsp;<span class="op" id="8015509">!</span><span class="ident" id="8015510"><a href="/net/ipsock.go.html#1440628">supportsIPv6</a></span>&nbsp;<span class="op" id="8015523">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8015527"><a href="/net/unicast_posix_test.go.html#8015324">t</a></span><span class="op" id="8015528">.</span><span class="ident" id="8015529">Skip</span><span class="op" id="8015533">(</span><span class="string" id="8015534">&#34;ipv6&nbsp;is&nbsp;not&nbsp;supported&#34;</span><span class="op" id="8015557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8015560">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8015564">for</span>&nbsp;<span class="ident" id="8015568">_</span><span class="op" id="8015569">,</span>&nbsp;<span class="ident" id="8015571">tt</span>&nbsp;<span class="op" id="8015574">:=</span>&nbsp;<span class="keyword" id="8015577">range</span>&nbsp;<span class="ident" id="8015583"><a href="/net/unicast_posix_test.go.html#8010917">dualStackListenerTests</a></span>&nbsp;<span class="op" id="8015606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8015610">if</span>&nbsp;<span class="ident" id="8015613"><a href="/net/unicast_posix_test.go.html#8015571">tt</a></span><span class="op" id="8015615">.</span><span class="ident" id="8015616">wildcard</span>&nbsp;<span class="op" id="8015625">&amp;&amp;</span>&nbsp;<span class="op" id="8015628">!</span><span class="op" id="8015629">*</span><span class="ident" id="8015630"><a href="/net/lookup_test.go.html#7913432">testExternal</a></span>&nbsp;<span class="op" id="8015643">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8015648">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8015659">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8015663">switch</span>&nbsp;<span class="ident" id="8015670"><a href="/net/unicast_posix_test.go.html#8008445">runtime</a></span><span class="op" id="8015677">.</span><span class="ident" id="8015678">GOOS</span>&nbsp;<span class="op" id="8015683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8015687">case</span>&nbsp;<span class="string" id="8015692">&#34;openbsd&#34;</span><span class="op" id="8015701">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8015706">if</span>&nbsp;<span class="ident" id="8015709"><a href="/net/unicast_posix_test.go.html#8015571">tt</a></span><span class="op" id="8015711">.</span><span class="ident" id="8015712">wildcard</span>&nbsp;<span class="op" id="8015721">&amp;&amp;</span>&nbsp;<span class="ident" id="8015724"><a href="/net/unicast_posix_test.go.html#8018333">differentWildcardAddr</a></span><span class="op" id="8015745">(</span><span class="ident" id="8015746"><a href="/net/unicast_posix_test.go.html#8015571">tt</a></span><span class="op" id="8015748">.</span><span class="ident" id="8015749">laddr1</span><span class="op" id="8015755">,</span>&nbsp;<span class="ident" id="8015757"><a href="/net/unicast_posix_test.go.html#8015571">tt</a></span><span class="op" id="8015759">.</span><span class="ident" id="8015760">laddr2</span><span class="op" id="8015766">)</span>&nbsp;<span class="op" id="8015768">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8015774"><a href="/net/unicast_posix_test.go.html#8015571">tt</a></span><span class="op" id="8015776">.</span><span class="ident" id="8015777">xerr</span>&nbsp;<span class="op" id="8015782">=</span>&nbsp;<span class="ident" id="8015784">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8015791">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8015795">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8015799">l1</span><span class="op" id="8015801">,</span>&nbsp;<span class="ident" id="8015803">port</span>&nbsp;<span class="op" id="8015808">:=</span>&nbsp;<span class="ident" id="8015811"><a href="/net/unicast_posix_test.go.html#8017310">usableListenPort</a></span><span class="op" id="8015827">(</span><span class="ident" id="8015828"><a href="/net/unicast_posix_test.go.html#8015324">t</a></span><span class="op" id="8015829">,</span>&nbsp;<span class="ident" id="8015831"><a href="/net/unicast_posix_test.go.html#8015571">tt</a></span><span class="op" id="8015833">.</span><span class="ident" id="8015834">net1</span><span class="op" id="8015838">,</span>&nbsp;<span class="ident" id="8015840"><a href="/net/unicast_posix_test.go.html#8015571">tt</a></span><span class="op" id="8015842">.</span><span class="ident" id="8015843">laddr1</span><span class="op" id="8015849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8015853">laddr</span>&nbsp;<span class="op" id="8015859">:=</span>&nbsp;<span class="ident" id="8015862"><a href="/net/unicast_posix_test.go.html#8015571">tt</a></span><span class="op" id="8015864">.</span><span class="ident" id="8015865">laddr1</span>&nbsp;<span class="op" id="8015872">+</span>&nbsp;<span class="string" id="8015874">&#34;:&#34;</span>&nbsp;<span class="op" id="8015878">+</span>&nbsp;<span class="ident" id="8015880"><a href="/net/unicast_posix_test.go.html#8015803">port</a></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8015887"><a href="/net/unicast_posix_test.go.html#8018580">checkFirstListener</a></span><span class="op" id="8015905">(</span><span class="ident" id="8015906"><a href="/net/unicast_posix_test.go.html#8015324">t</a></span><span class="op" id="8015907">,</span>&nbsp;<span class="ident" id="8015909"><a href="/net/unicast_posix_test.go.html#8015571">tt</a></span><span class="op" id="8015911">.</span><span class="ident" id="8015912">net1</span><span class="op" id="8015916">,</span>&nbsp;<span class="ident" id="8015918"><a href="/net/unicast_posix_test.go.html#8015853">laddr</a></span><span class="op" id="8015923">,</span>&nbsp;<span class="ident" id="8015925"><a href="/net/unicast_posix_test.go.html#8015799">l1</a></span><span class="op" id="8015927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8015931"><a href="/net/unicast_posix_test.go.html#8015853">laddr</a></span>&nbsp;<span class="op" id="8015937">=</span>&nbsp;<span class="ident" id="8015939"><a href="/net/unicast_posix_test.go.html#8015571">tt</a></span><span class="op" id="8015941">.</span><span class="ident" id="8015942">laddr2</span>&nbsp;<span class="op" id="8015949">+</span>&nbsp;<span class="string" id="8015951">&#34;:&#34;</span>&nbsp;<span class="op" id="8015955">+</span>&nbsp;<span class="ident" id="8015957"><a href="/net/unicast_posix_test.go.html#8015803">port</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8015964">l2</span><span class="op" id="8015966">,</span>&nbsp;<span class="ident" id="8015968">err</span>&nbsp;<span class="op" id="8015972">:=</span>&nbsp;<span class="ident" id="8015975"><a href="/net/dial.go.html#1338035">Listen</a></span><span class="op" id="8015981">(</span><span class="ident" id="8015982"><a href="/net/unicast_posix_test.go.html#8015571">tt</a></span><span class="op" id="8015984">.</span><span class="ident" id="8015985">net2</span><span class="op" id="8015989">,</span>&nbsp;<span class="ident" id="8015991"><a href="/net/unicast_posix_test.go.html#8015853">laddr</a></span><span class="op" id="8015996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8016000"><a href="/net/unicast_posix_test.go.html#8020132">checkDualStackSecondListener</a></span><span class="op" id="8016028">(</span><span class="ident" id="8016029"><a href="/net/unicast_posix_test.go.html#8015324">t</a></span><span class="op" id="8016030">,</span>&nbsp;<span class="ident" id="8016032"><a href="/net/unicast_posix_test.go.html#8015571">tt</a></span><span class="op" id="8016034">.</span><span class="ident" id="8016035">net2</span><span class="op" id="8016039">,</span>&nbsp;<span class="ident" id="8016041"><a href="/net/unicast_posix_test.go.html#8015853">laddr</a></span><span class="op" id="8016046">,</span>&nbsp;<span class="ident" id="8016048"><a href="/net/unicast_posix_test.go.html#8015571">tt</a></span><span class="op" id="8016050">.</span><span class="ident" id="8016051">xerr</span><span class="op" id="8016055">,</span>&nbsp;<span class="ident" id="8016057"><a href="/net/unicast_posix_test.go.html#8015968">err</a></span><span class="op" id="8016060">,</span>&nbsp;<span class="ident" id="8016062"><a href="/net/unicast_posix_test.go.html#8015964">l2</a></span><span class="op" id="8016064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8016068"><a href="/net/unicast_posix_test.go.html#8015799">l1</a></span><span class="op" id="8016070">.</span><span class="ident" id="8016071">Close</span><span class="op" id="8016076">(</span><span class="op" id="8016077">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8016080">}</span><br>
<span class="lineno"></span><span class="op" id="8016082">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8016085">//&nbsp;TestDualStackUDPListener&nbsp;tests&nbsp;both&nbsp;single&nbsp;and&nbsp;double&nbsp;listen</span><br>
<span class="lineno"></span><span class="comment" id="8016149">//&nbsp;to&nbsp;a&nbsp;test&nbsp;listener&nbsp;with&nbsp;various&nbsp;address&nbsp;families,&nbsp;differnet</span><br>
<span class="lineno">205</span><span class="comment" id="8016212">//&nbsp;listening&nbsp;address&nbsp;and&nbsp;same&nbsp;port.</span><br>
<span class="lineno"></span><span class="keyword" id="8016248">func</span>&nbsp;<span class="ident" id="8016253">TestDualStackUDPListener</span><span class="op" id="8016277">(</span><span class="ident" id="8016278">t</span>&nbsp;<span class="op" id="8016280">*</span><span class="ident" id="8016281"><a href="/net/unicast_posix_test.go.html#8008467">testing</a></span><span class="op" id="8016288">.</span><span class="ident" id="8016289">T</span><span class="op" id="8016290">)</span>&nbsp;<span class="op" id="8016292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8016295">if</span>&nbsp;<span class="ident" id="8016298"><a href="/net/unicast_posix_test.go.html#8008467">testing</a></span><span class="op" id="8016305">.</span><span class="ident" id="8016306">Short</span><span class="op" id="8016311">(</span><span class="op" id="8016312">)</span>&nbsp;<span class="op" id="8016314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8016318"><a href="/net/unicast_posix_test.go.html#8016278">t</a></span><span class="op" id="8016319">.</span><span class="ident" id="8016320">Skip</span><span class="op" id="8016324">(</span><span class="string" id="8016325">&#34;skipping&nbsp;in&nbsp;-short&nbsp;mode,&nbsp;see&nbsp;issue&nbsp;5001&#34;</span><span class="op" id="8016366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8016369">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8016372">switch</span>&nbsp;<span class="ident" id="8016379"><a href="/net/unicast_posix_test.go.html#8008445">runtime</a></span><span class="op" id="8016386">.</span><span class="ident" id="8016387">GOOS</span>&nbsp;<span class="op" id="8016392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8016395">case</span>&nbsp;<span class="string" id="8016400">&#34;plan9&#34;</span><span class="op" id="8016407">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8016411"><a href="/net/unicast_posix_test.go.html#8016278">t</a></span><span class="op" id="8016412">.</span><span class="ident" id="8016413">Skipf</span><span class="op" id="8016418">(</span><span class="string" id="8016419">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="8016440">,</span>&nbsp;<span class="ident" id="8016442"><a href="/net/unicast_posix_test.go.html#8008445">runtime</a></span><span class="op" id="8016449">.</span><span class="ident" id="8016450">GOOS</span><span class="op" id="8016454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8016457">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8016460">if</span>&nbsp;<span class="op" id="8016463">!</span><span class="ident" id="8016464"><a href="/net/ipsock.go.html#1440628">supportsIPv6</a></span>&nbsp;<span class="op" id="8016477">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8016481"><a href="/net/unicast_posix_test.go.html#8016278">t</a></span><span class="op" id="8016482">.</span><span class="ident" id="8016483">Skip</span><span class="op" id="8016487">(</span><span class="string" id="8016488">&#34;ipv6&nbsp;is&nbsp;not&nbsp;supported&#34;</span><span class="op" id="8016511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8016514">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8016518">toudpnet</span>&nbsp;<span class="op" id="8016527">:=</span>&nbsp;<span class="keyword" id="8016530">func</span><span class="op" id="8016534">(</span><span class="ident" id="8016535">net</span>&nbsp;<span class="builtintype" id="8016539">string</span><span class="op" id="8016545">)</span>&nbsp;<span class="builtintype" id="8016547">string</span>&nbsp;<span class="op" id="8016554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8016558">switch</span>&nbsp;<span class="ident" id="8016565"><a href="/net/unicast_posix_test.go.html#8016535">net</a></span>&nbsp;<span class="op" id="8016569">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8016573">case</span>&nbsp;<span class="string" id="8016578">&#34;tcp&#34;</span><span class="op" id="8016583">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8016588">return</span>&nbsp;<span class="string" id="8016595">&#34;udp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8016603">case</span>&nbsp;<span class="string" id="8016608">&#34;tcp4&#34;</span><span class="op" id="8016614">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8016619">return</span>&nbsp;<span class="string" id="8016626">&#34;udp4&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8016635">case</span>&nbsp;<span class="string" id="8016640">&#34;tcp6&#34;</span><span class="op" id="8016646">:</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8016651">return</span>&nbsp;<span class="string" id="8016658">&#34;udp6&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8016667">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8016671">return</span>&nbsp;<span class="string" id="8016678">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8016687">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8016691">for</span>&nbsp;<span class="ident" id="8016695">_</span><span class="op" id="8016696">,</span>&nbsp;<span class="ident" id="8016698">tt</span>&nbsp;<span class="op" id="8016701">:=</span>&nbsp;<span class="keyword" id="8016704">range</span>&nbsp;<span class="ident" id="8016710"><a href="/net/unicast_posix_test.go.html#8010917">dualStackListenerTests</a></span>&nbsp;<span class="op" id="8016733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8016737">if</span>&nbsp;<span class="ident" id="8016740"><a href="/net/unicast_posix_test.go.html#8016698">tt</a></span><span class="op" id="8016742">.</span><span class="ident" id="8016743">wildcard</span>&nbsp;<span class="op" id="8016752">&amp;&amp;</span>&nbsp;<span class="op" id="8016755">(</span><span class="ident" id="8016756"><a href="/net/unicast_posix_test.go.html#8008467">testing</a></span><span class="op" id="8016763">.</span><span class="ident" id="8016764">Short</span><span class="op" id="8016769">(</span><span class="op" id="8016770">)</span>&nbsp;<span class="op" id="8016772">||</span>&nbsp;<span class="op" id="8016775">!</span><span class="op" id="8016776">*</span><span class="ident" id="8016777"><a href="/net/lookup_test.go.html#7913432">testExternal</a></span><span class="op" id="8016789">)</span>&nbsp;<span class="op" id="8016791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8016796">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8016807">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8016811"><a href="/net/unicast_posix_test.go.html#8016698">tt</a></span><span class="op" id="8016813">.</span><span class="ident" id="8016814">net1</span>&nbsp;<span class="op" id="8016819">=</span>&nbsp;<span class="ident" id="8016821"><a href="/net/unicast_posix_test.go.html#8016518">toudpnet</a></span><span class="op" id="8016829">(</span><span class="ident" id="8016830"><a href="/net/unicast_posix_test.go.html#8016698">tt</a></span><span class="op" id="8016832">.</span><span class="ident" id="8016833">net1</span><span class="op" id="8016837">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8016841"><a href="/net/unicast_posix_test.go.html#8016698">tt</a></span><span class="op" id="8016843">.</span><span class="ident" id="8016844">net2</span>&nbsp;<span class="op" id="8016849">=</span>&nbsp;<span class="ident" id="8016851"><a href="/net/unicast_posix_test.go.html#8016518">toudpnet</a></span><span class="op" id="8016859">(</span><span class="ident" id="8016860"><a href="/net/unicast_posix_test.go.html#8016698">tt</a></span><span class="op" id="8016862">.</span><span class="ident" id="8016863">net2</span><span class="op" id="8016867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8016871">switch</span>&nbsp;<span class="ident" id="8016878"><a href="/net/unicast_posix_test.go.html#8008445">runtime</a></span><span class="op" id="8016885">.</span><span class="ident" id="8016886">GOOS</span>&nbsp;<span class="op" id="8016891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8016895">case</span>&nbsp;<span class="string" id="8016900">&#34;openbsd&#34;</span><span class="op" id="8016909">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8016914">if</span>&nbsp;<span class="ident" id="8016917"><a href="/net/unicast_posix_test.go.html#8016698">tt</a></span><span class="op" id="8016919">.</span><span class="ident" id="8016920">wildcard</span>&nbsp;<span class="op" id="8016929">&amp;&amp;</span>&nbsp;<span class="ident" id="8016932"><a href="/net/unicast_posix_test.go.html#8018333">differentWildcardAddr</a></span><span class="op" id="8016953">(</span><span class="ident" id="8016954"><a href="/net/unicast_posix_test.go.html#8016698">tt</a></span><span class="op" id="8016956">.</span><span class="ident" id="8016957">laddr1</span><span class="op" id="8016963">,</span>&nbsp;<span class="ident" id="8016965"><a href="/net/unicast_posix_test.go.html#8016698">tt</a></span><span class="op" id="8016967">.</span><span class="ident" id="8016968">laddr2</span><span class="op" id="8016974">)</span>&nbsp;<span class="op" id="8016976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8016982"><a href="/net/unicast_posix_test.go.html#8016698">tt</a></span><span class="op" id="8016984">.</span><span class="ident" id="8016985">xerr</span>&nbsp;<span class="op" id="8016990">=</span>&nbsp;<span class="ident" id="8016992">nil</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8016999">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8017003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8017007">l1</span><span class="op" id="8017009">,</span>&nbsp;<span class="ident" id="8017011">port</span>&nbsp;<span class="op" id="8017016">:=</span>&nbsp;<span class="ident" id="8017019"><a href="/net/unicast_posix_test.go.html#8017808">usableListenPacketPort</a></span><span class="op" id="8017041">(</span><span class="ident" id="8017042"><a href="/net/unicast_posix_test.go.html#8016278">t</a></span><span class="op" id="8017043">,</span>&nbsp;<span class="ident" id="8017045"><a href="/net/unicast_posix_test.go.html#8016698">tt</a></span><span class="op" id="8017047">.</span><span class="ident" id="8017048">net1</span><span class="op" id="8017052">,</span>&nbsp;<span class="ident" id="8017054"><a href="/net/unicast_posix_test.go.html#8016698">tt</a></span><span class="op" id="8017056">.</span><span class="ident" id="8017057">laddr1</span><span class="op" id="8017063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8017067">laddr</span>&nbsp;<span class="op" id="8017073">:=</span>&nbsp;<span class="ident" id="8017076"><a href="/net/unicast_posix_test.go.html#8016698">tt</a></span><span class="op" id="8017078">.</span><span class="ident" id="8017079">laddr1</span>&nbsp;<span class="op" id="8017086">+</span>&nbsp;<span class="string" id="8017088">&#34;:&#34;</span>&nbsp;<span class="op" id="8017092">+</span>&nbsp;<span class="ident" id="8017094"><a href="/net/unicast_posix_test.go.html#8017011">port</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8017101"><a href="/net/unicast_posix_test.go.html#8018580">checkFirstListener</a></span><span class="op" id="8017119">(</span><span class="ident" id="8017120"><a href="/net/unicast_posix_test.go.html#8016278">t</a></span><span class="op" id="8017121">,</span>&nbsp;<span class="ident" id="8017123"><a href="/net/unicast_posix_test.go.html#8016698">tt</a></span><span class="op" id="8017125">.</span><span class="ident" id="8017126">net1</span><span class="op" id="8017130">,</span>&nbsp;<span class="ident" id="8017132"><a href="/net/unicast_posix_test.go.html#8017067">laddr</a></span><span class="op" id="8017137">,</span>&nbsp;<span class="ident" id="8017139"><a href="/net/unicast_posix_test.go.html#8017007">l1</a></span><span class="op" id="8017141">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8017145"><a href="/net/unicast_posix_test.go.html#8017067">laddr</a></span>&nbsp;<span class="op" id="8017151">=</span>&nbsp;<span class="ident" id="8017153"><a href="/net/unicast_posix_test.go.html#8016698">tt</a></span><span class="op" id="8017155">.</span><span class="ident" id="8017156">laddr2</span>&nbsp;<span class="op" id="8017163">+</span>&nbsp;<span class="string" id="8017165">&#34;:&#34;</span>&nbsp;<span class="op" id="8017169">+</span>&nbsp;<span class="ident" id="8017171"><a href="/net/unicast_posix_test.go.html#8017011">port</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8017178">l2</span><span class="op" id="8017180">,</span>&nbsp;<span class="ident" id="8017182">err</span>&nbsp;<span class="op" id="8017186">:=</span>&nbsp;<span class="ident" id="8017189"><a href="/net/dial.go.html#1338827">ListenPacket</a></span><span class="op" id="8017201">(</span><span class="ident" id="8017202"><a href="/net/unicast_posix_test.go.html#8016698">tt</a></span><span class="op" id="8017204">.</span><span class="ident" id="8017205">net2</span><span class="op" id="8017209">,</span>&nbsp;<span class="ident" id="8017211"><a href="/net/unicast_posix_test.go.html#8017067">laddr</a></span><span class="op" id="8017216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8017220"><a href="/net/unicast_posix_test.go.html#8020132">checkDualStackSecondListener</a></span><span class="op" id="8017248">(</span><span class="ident" id="8017249"><a href="/net/unicast_posix_test.go.html#8016278">t</a></span><span class="op" id="8017250">,</span>&nbsp;<span class="ident" id="8017252"><a href="/net/unicast_posix_test.go.html#8016698">tt</a></span><span class="op" id="8017254">.</span><span class="ident" id="8017255">net2</span><span class="op" id="8017259">,</span>&nbsp;<span class="ident" id="8017261"><a href="/net/unicast_posix_test.go.html#8017067">laddr</a></span><span class="op" id="8017266">,</span>&nbsp;<span class="ident" id="8017268"><a href="/net/unicast_posix_test.go.html#8016698">tt</a></span><span class="op" id="8017270">.</span><span class="ident" id="8017271">xerr</span><span class="op" id="8017275">,</span>&nbsp;<span class="ident" id="8017277"><a href="/net/unicast_posix_test.go.html#8017182">err</a></span><span class="op" id="8017280">,</span>&nbsp;<span class="ident" id="8017282"><a href="/net/unicast_posix_test.go.html#8017178">l2</a></span><span class="op" id="8017284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8017288"><a href="/net/unicast_posix_test.go.html#8017007">l1</a></span><span class="op" id="8017290">.</span><span class="ident" id="8017291">Close</span><span class="op" id="8017296">(</span><span class="op" id="8017297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8017300">}</span><br>
<span class="lineno">250</span><span class="op" id="8017302">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8017305">func</span>&nbsp;<span class="ident" id="8017310">usableListenPort</span><span class="op" id="8017326">(</span><span class="ident" id="8017327">t</span>&nbsp;<span class="op" id="8017329">*</span><span class="ident" id="8017330"><a href="/net/unicast_posix_test.go.html#8008467">testing</a></span><span class="op" id="8017337">.</span><span class="ident" id="8017338">T</span><span class="op" id="8017339">,</span>&nbsp;<span class="ident" id="8017341">net</span><span class="op" id="8017344">,</span>&nbsp;<span class="ident" id="8017346">laddr</span>&nbsp;<span class="builtintype" id="8017352">string</span><span class="op" id="8017358">)</span>&nbsp;<span class="op" id="8017360">(</span><span class="ident" id="8017361">l</span>&nbsp;<span class="ident" id="8017363"><a href="/net/net.go.html#1471621">Listener</a></span><span class="op" id="8017371">,</span>&nbsp;<span class="ident" id="8017373">port</span>&nbsp;<span class="builtintype" id="8017378">string</span><span class="op" id="8017384">)</span>&nbsp;<span class="op" id="8017386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8017389">var</span>&nbsp;<span class="ident" id="8017393">nladdr</span>&nbsp;<span class="builtintype" id="8017400">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8017408">var</span>&nbsp;<span class="ident" id="8017412">err</span>&nbsp;<span class="builtintype" id="8017416">error</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8017423">switch</span>&nbsp;<span class="ident" id="8017430"><a href="/net/unicast_posix_test.go.html#8017341">net</a></span>&nbsp;<span class="op" id="8017434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8017437">default</span><span class="op" id="8017444">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8017448">panic</span><span class="op" id="8017453">(</span><span class="string" id="8017454">&#34;usableListenPort&nbsp;net=&#34;</span>&nbsp;<span class="op" id="8017478">+</span>&nbsp;<span class="ident" id="8017480"><a href="/net/unicast_posix_test.go.html#8017341">net</a></span><span class="op" id="8017483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8017486">case</span>&nbsp;<span class="string" id="8017491">&#34;tcp&#34;</span><span class="op" id="8017496">,</span>&nbsp;<span class="string" id="8017498">&#34;tcp4&#34;</span><span class="op" id="8017504">,</span>&nbsp;<span class="string" id="8017506">&#34;tcp6&#34;</span><span class="op" id="8017512">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8017516"><a href="/net/unicast_posix_test.go.html#8017361">l</a></span><span class="op" id="8017517">,</span>&nbsp;<span class="ident" id="8017519"><a href="/net/unicast_posix_test.go.html#8017412">err</a></span>&nbsp;<span class="op" id="8017523">=</span>&nbsp;<span class="ident" id="8017525"><a href="/net/dial.go.html#1338035">Listen</a></span><span class="op" id="8017531">(</span><span class="ident" id="8017532"><a href="/net/unicast_posix_test.go.html#8017341">net</a></span><span class="op" id="8017535">,</span>&nbsp;<span class="ident" id="8017537"><a href="/net/unicast_posix_test.go.html#8017346">laddr</a></span><span class="op" id="8017542">+</span><span class="string" id="8017543">&#34;:0&#34;</span><span class="op" id="8017547">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8017551">if</span>&nbsp;<span class="ident" id="8017554"><a href="/net/unicast_posix_test.go.html#8017412">err</a></span>&nbsp;<span class="op" id="8017558">!=</span>&nbsp;<span class="ident" id="8017561">nil</span>&nbsp;<span class="op" id="8017565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8017570"><a href="/net/unicast_posix_test.go.html#8017327">t</a></span><span class="op" id="8017571">.</span><span class="ident" id="8017572">Fatalf</span><span class="op" id="8017578">(</span><span class="string" id="8017579">&#34;Probe&nbsp;Listen(%q,&nbsp;%q)&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8017612">,</span>&nbsp;<span class="ident" id="8017614"><a href="/net/unicast_posix_test.go.html#8017341">net</a></span><span class="op" id="8017617">,</span>&nbsp;<span class="ident" id="8017619"><a href="/net/unicast_posix_test.go.html#8017346">laddr</a></span><span class="op" id="8017624">,</span>&nbsp;<span class="ident" id="8017626"><a href="/net/unicast_posix_test.go.html#8017412">err</a></span><span class="op" id="8017629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8017633">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8017637"><a href="/net/unicast_posix_test.go.html#8017393">nladdr</a></span>&nbsp;<span class="op" id="8017644">=</span>&nbsp;<span class="ident" id="8017646"><a href="/net/unicast_posix_test.go.html#8017361">l</a></span><span class="op" id="8017647">.</span><span class="op" id="8017648">(</span><span class="op" id="8017649">*</span><span class="ident" id="8017650"><a href="/net/tcpsock_posix.go.html#1512824">TCPListener</a></span><span class="op" id="8017661">)</span><span class="op" id="8017662">.</span><span class="ident" id="8017663">Addr</span><span class="op" id="8017667">(</span><span class="op" id="8017668">)</span><span class="op" id="8017669">.</span><span class="ident" id="8017670">String</span><span class="op" id="8017676">(</span><span class="op" id="8017677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8017680">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8017683">_</span><span class="op" id="8017684">,</span>&nbsp;<span class="ident" id="8017686"><a href="/net/unicast_posix_test.go.html#8017373">port</a></span><span class="op" id="8017690">,</span>&nbsp;<span class="ident" id="8017692"><a href="/net/unicast_posix_test.go.html#8017412">err</a></span>&nbsp;<span class="op" id="8017696">=</span>&nbsp;<span class="ident" id="8017698"><a href="/net/ipsock.go.html#1444126">SplitHostPort</a></span><span class="op" id="8017711">(</span><span class="ident" id="8017712"><a href="/net/unicast_posix_test.go.html#8017393">nladdr</a></span><span class="op" id="8017718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8017721">if</span>&nbsp;<span class="ident" id="8017724"><a href="/net/unicast_posix_test.go.html#8017412">err</a></span>&nbsp;<span class="op" id="8017728">!=</span>&nbsp;<span class="ident" id="8017731">nil</span>&nbsp;<span class="op" id="8017735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8017739"><a href="/net/unicast_posix_test.go.html#8017327">t</a></span><span class="op" id="8017740">.</span><span class="ident" id="8017741">Fatalf</span><span class="op" id="8017747">(</span><span class="string" id="8017748">&#34;SplitHostPort&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8017774">,</span>&nbsp;<span class="ident" id="8017776"><a href="/net/unicast_posix_test.go.html#8017412">err</a></span><span class="op" id="8017779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8017782">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8017785">return</span>&nbsp;<span class="ident" id="8017792"><a href="/net/unicast_posix_test.go.html#8017361">l</a></span><span class="op" id="8017793">,</span>&nbsp;<span class="ident" id="8017795"><a href="/net/unicast_posix_test.go.html#8017373">port</a></span><br>
<span class="lineno">270</span><span class="op" id="8017800">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8017803">func</span>&nbsp;<span class="ident" id="8017808">usableListenPacketPort</span><span class="op" id="8017830">(</span><span class="ident" id="8017831">t</span>&nbsp;<span class="op" id="8017833">*</span><span class="ident" id="8017834"><a href="/net/unicast_posix_test.go.html#8008467">testing</a></span><span class="op" id="8017841">.</span><span class="ident" id="8017842">T</span><span class="op" id="8017843">,</span>&nbsp;<span class="ident" id="8017845">net</span><span class="op" id="8017848">,</span>&nbsp;<span class="ident" id="8017850">laddr</span>&nbsp;<span class="builtintype" id="8017856">string</span><span class="op" id="8017862">)</span>&nbsp;<span class="op" id="8017864">(</span><span class="ident" id="8017865">l</span>&nbsp;<span class="ident" id="8017867"><a href="/net/net.go.html#1469751">PacketConn</a></span><span class="op" id="8017877">,</span>&nbsp;<span class="ident" id="8017879">port</span>&nbsp;<span class="builtintype" id="8017884">string</span><span class="op" id="8017890">)</span>&nbsp;<span class="op" id="8017892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8017895">var</span>&nbsp;<span class="ident" id="8017899">nladdr</span>&nbsp;<span class="builtintype" id="8017906">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8017914">var</span>&nbsp;<span class="ident" id="8017918">err</span>&nbsp;<span class="builtintype" id="8017922">error</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8017929">switch</span>&nbsp;<span class="ident" id="8017936"><a href="/net/unicast_posix_test.go.html#8017845">net</a></span>&nbsp;<span class="op" id="8017940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8017943">default</span><span class="op" id="8017950">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8017954">panic</span><span class="op" id="8017959">(</span><span class="string" id="8017960">&#34;usableListenPacketPort&nbsp;net=&#34;</span>&nbsp;<span class="op" id="8017990">+</span>&nbsp;<span class="ident" id="8017992"><a href="/net/unicast_posix_test.go.html#8017845">net</a></span><span class="op" id="8017995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8017998">case</span>&nbsp;<span class="string" id="8018003">&#34;udp&#34;</span><span class="op" id="8018008">,</span>&nbsp;<span class="string" id="8018010">&#34;udp4&#34;</span><span class="op" id="8018016">,</span>&nbsp;<span class="string" id="8018018">&#34;udp6&#34;</span><span class="op" id="8018024">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8018028"><a href="/net/unicast_posix_test.go.html#8017865">l</a></span><span class="op" id="8018029">,</span>&nbsp;<span class="ident" id="8018031"><a href="/net/unicast_posix_test.go.html#8017918">err</a></span>&nbsp;<span class="op" id="8018035">=</span>&nbsp;<span class="ident" id="8018037"><a href="/net/dial.go.html#1338827">ListenPacket</a></span><span class="op" id="8018049">(</span><span class="ident" id="8018050"><a href="/net/unicast_posix_test.go.html#8017845">net</a></span><span class="op" id="8018053">,</span>&nbsp;<span class="ident" id="8018055"><a href="/net/unicast_posix_test.go.html#8017850">laddr</a></span><span class="op" id="8018060">+</span><span class="string" id="8018061">&#34;:0&#34;</span><span class="op" id="8018065">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8018069">if</span>&nbsp;<span class="ident" id="8018072"><a href="/net/unicast_posix_test.go.html#8017918">err</a></span>&nbsp;<span class="op" id="8018076">!=</span>&nbsp;<span class="ident" id="8018079">nil</span>&nbsp;<span class="op" id="8018083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8018088"><a href="/net/unicast_posix_test.go.html#8017831">t</a></span><span class="op" id="8018089">.</span><span class="ident" id="8018090">Fatalf</span><span class="op" id="8018096">(</span><span class="string" id="8018097">&#34;Probe&nbsp;ListenPacket(%q,&nbsp;%q)&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8018136">,</span>&nbsp;<span class="ident" id="8018138"><a href="/net/unicast_posix_test.go.html#8017845">net</a></span><span class="op" id="8018141">,</span>&nbsp;<span class="ident" id="8018143"><a href="/net/unicast_posix_test.go.html#8017850">laddr</a></span><span class="op" id="8018148">,</span>&nbsp;<span class="ident" id="8018150"><a href="/net/unicast_posix_test.go.html#8017918">err</a></span><span class="op" id="8018153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8018157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8018161"><a href="/net/unicast_posix_test.go.html#8017899">nladdr</a></span>&nbsp;<span class="op" id="8018168">=</span>&nbsp;<span class="ident" id="8018170"><a href="/net/unicast_posix_test.go.html#8017865">l</a></span><span class="op" id="8018171">.</span><span class="op" id="8018172">(</span><span class="op" id="8018173">*</span><span class="ident" id="8018174"><a href="/net/udpsock_posix.go.html#1519094">UDPConn</a></span><span class="op" id="8018181">)</span><span class="op" id="8018182">.</span><span class="ident" id="8018183">LocalAddr</span><span class="op" id="8018192">(</span><span class="op" id="8018193">)</span><span class="op" id="8018194">.</span><span class="ident" id="8018195">String</span><span class="op" id="8018201">(</span><span class="op" id="8018202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8018205">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8018208">_</span><span class="op" id="8018209">,</span>&nbsp;<span class="ident" id="8018211"><a href="/net/unicast_posix_test.go.html#8017879">port</a></span><span class="op" id="8018215">,</span>&nbsp;<span class="ident" id="8018217"><a href="/net/unicast_posix_test.go.html#8017918">err</a></span>&nbsp;<span class="op" id="8018221">=</span>&nbsp;<span class="ident" id="8018223"><a href="/net/ipsock.go.html#1444126">SplitHostPort</a></span><span class="op" id="8018236">(</span><span class="ident" id="8018237"><a href="/net/unicast_posix_test.go.html#8017899">nladdr</a></span><span class="op" id="8018243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8018246">if</span>&nbsp;<span class="ident" id="8018249"><a href="/net/unicast_posix_test.go.html#8017918">err</a></span>&nbsp;<span class="op" id="8018253">!=</span>&nbsp;<span class="ident" id="8018256">nil</span>&nbsp;<span class="op" id="8018260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8018264"><a href="/net/unicast_posix_test.go.html#8017831">t</a></span><span class="op" id="8018265">.</span><span class="ident" id="8018266">Fatalf</span><span class="op" id="8018272">(</span><span class="string" id="8018273">&#34;SplitHostPort&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8018299">,</span>&nbsp;<span class="ident" id="8018301"><a href="/net/unicast_posix_test.go.html#8017918">err</a></span><span class="op" id="8018304">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8018307">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8018310">return</span>&nbsp;<span class="ident" id="8018317"><a href="/net/unicast_posix_test.go.html#8017865">l</a></span><span class="op" id="8018318">,</span>&nbsp;<span class="ident" id="8018320"><a href="/net/unicast_posix_test.go.html#8017879">port</a></span><br>
<span class="lineno">290</span><span class="op" id="8018325">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8018328">func</span>&nbsp;<span class="ident" id="8018333">differentWildcardAddr</span><span class="op" id="8018354">(</span><span class="ident" id="8018355">i</span><span class="op" id="8018356">,</span>&nbsp;<span class="ident" id="8018358">j</span>&nbsp;<span class="builtintype" id="8018360">string</span><span class="op" id="8018366">)</span>&nbsp;<span class="builtintype" id="8018368">bool</span>&nbsp;<span class="op" id="8018373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8018376">if</span>&nbsp;<span class="op" id="8018379">(</span><span class="ident" id="8018380"><a href="/net/unicast_posix_test.go.html#8018355">i</a></span>&nbsp;<span class="op" id="8018382">==</span>&nbsp;<span class="string" id="8018385">&#34;&#34;</span>&nbsp;<span class="op" id="8018388">||</span>&nbsp;<span class="ident" id="8018391"><a href="/net/unicast_posix_test.go.html#8018355">i</a></span>&nbsp;<span class="op" id="8018393">==</span>&nbsp;<span class="string" id="8018396">&#34;0.0.0.0&#34;</span>&nbsp;<span class="op" id="8018406">||</span>&nbsp;<span class="ident" id="8018409"><a href="/net/unicast_posix_test.go.html#8018355">i</a></span>&nbsp;<span class="op" id="8018411">==</span>&nbsp;<span class="string" id="8018414">&#34;::ffff:0.0.0.0&#34;</span><span class="op" id="8018430">)</span>&nbsp;<span class="op" id="8018432">&amp;&amp;</span>&nbsp;<span class="op" id="8018435">(</span><span class="ident" id="8018436"><a href="/net/unicast_posix_test.go.html#8018358">j</a></span>&nbsp;<span class="op" id="8018438">==</span>&nbsp;<span class="string" id="8018441">&#34;&#34;</span>&nbsp;<span class="op" id="8018444">||</span>&nbsp;<span class="ident" id="8018447"><a href="/net/unicast_posix_test.go.html#8018358">j</a></span>&nbsp;<span class="op" id="8018449">==</span>&nbsp;<span class="string" id="8018452">&#34;0.0.0.0&#34;</span>&nbsp;<span class="op" id="8018462">||</span>&nbsp;<span class="ident" id="8018465"><a href="/net/unicast_posix_test.go.html#8018358">j</a></span>&nbsp;<span class="op" id="8018467">==</span>&nbsp;<span class="string" id="8018470">&#34;::ffff:0.0.0.0&#34;</span><span class="op" id="8018486">)</span>&nbsp;<span class="op" id="8018488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8018492">return</span>&nbsp;<span class="builtintype" id="8018499">false</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8018506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8018509">if</span>&nbsp;<span class="ident" id="8018512"><a href="/net/unicast_posix_test.go.html#8018355">i</a></span>&nbsp;<span class="op" id="8018514">==</span>&nbsp;<span class="string" id="8018517">&#34;[::]&#34;</span>&nbsp;<span class="op" id="8018524">&amp;&amp;</span>&nbsp;<span class="ident" id="8018527"><a href="/net/unicast_posix_test.go.html#8018358">j</a></span>&nbsp;<span class="op" id="8018529">==</span>&nbsp;<span class="string" id="8018532">&#34;[::]&#34;</span>&nbsp;<span class="op" id="8018539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8018543">return</span>&nbsp;<span class="builtintype" id="8018550">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8018557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8018560">return</span>&nbsp;<span class="builtintype" id="8018567">true</span><br>
<span class="lineno">300</span><span class="op" id="8018572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8018575">func</span>&nbsp;<span class="ident" id="8018580">checkFirstListener</span><span class="op" id="8018598">(</span><span class="ident" id="8018599">t</span>&nbsp;<span class="op" id="8018601">*</span><span class="ident" id="8018602"><a href="/net/unicast_posix_test.go.html#8008467">testing</a></span><span class="op" id="8018609">.</span><span class="ident" id="8018610">T</span><span class="op" id="8018611">,</span>&nbsp;<span class="ident" id="8018613">net</span><span class="op" id="8018616">,</span>&nbsp;<span class="ident" id="8018618">laddr</span>&nbsp;<span class="builtintype" id="8018624">string</span><span class="op" id="8018630">,</span>&nbsp;<span class="ident" id="8018632">l</span>&nbsp;<span class="keyword" id="8018634">interface</span><span class="op" id="8018643">{</span><span class="op" id="8018644">}</span><span class="op" id="8018645">)</span>&nbsp;<span class="op" id="8018647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8018650">switch</span>&nbsp;<span class="ident" id="8018657"><a href="/net/unicast_posix_test.go.html#8018613">net</a></span>&nbsp;<span class="op" id="8018661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8018664">case</span>&nbsp;<span class="string" id="8018669">&#34;tcp&#34;</span><span class="op" id="8018674">:</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8018678">fd</span>&nbsp;<span class="op" id="8018681">:=</span>&nbsp;<span class="ident" id="8018684"><a href="/net/unicast_posix_test.go.html#8018632">l</a></span><span class="op" id="8018685">.</span><span class="op" id="8018686">(</span><span class="op" id="8018687">*</span><span class="ident" id="8018688"><a href="/net/tcpsock_posix.go.html#1512824">TCPListener</a></span><span class="op" id="8018699">)</span><span class="op" id="8018700">.</span><span class="ident" id="8018701">fd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8018706"><a href="/net/unicast_posix_test.go.html#8020765">checkDualStackAddrFamily</a></span><span class="op" id="8018730">(</span><span class="ident" id="8018731"><a href="/net/unicast_posix_test.go.html#8018599">t</a></span><span class="op" id="8018732">,</span>&nbsp;<span class="ident" id="8018734"><a href="/net/unicast_posix_test.go.html#8018613">net</a></span><span class="op" id="8018737">,</span>&nbsp;<span class="ident" id="8018739"><a href="/net/unicast_posix_test.go.html#8018618">laddr</a></span><span class="op" id="8018744">,</span>&nbsp;<span class="ident" id="8018746"><a href="/net/unicast_posix_test.go.html#8018678">fd</a></span><span class="op" id="8018748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8018751">case</span>&nbsp;<span class="string" id="8018756">&#34;tcp4&#34;</span><span class="op" id="8018762">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8018766">fd</span>&nbsp;<span class="op" id="8018769">:=</span>&nbsp;<span class="ident" id="8018772"><a href="/net/unicast_posix_test.go.html#8018632">l</a></span><span class="op" id="8018773">.</span><span class="op" id="8018774">(</span><span class="op" id="8018775">*</span><span class="ident" id="8018776"><a href="/net/tcpsock_posix.go.html#1512824">TCPListener</a></span><span class="op" id="8018787">)</span><span class="op" id="8018788">.</span><span class="ident" id="8018789">fd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8018794">if</span>&nbsp;<span class="ident" id="8018797"><a href="/net/unicast_posix_test.go.html#8018766">fd</a></span><span class="op" id="8018799">.</span><span class="ident" id="8018800">family</span>&nbsp;<span class="op" id="8018807">!=</span>&nbsp;<span class="ident" id="8018810"><a href="/net/unicast_posix_test.go.html#8008456">syscall</a></span><span class="op" id="8018817">.</span><span class="ident" id="8018818">AF_INET</span>&nbsp;<span class="op" id="8018826">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8018831"><a href="/net/unicast_posix_test.go.html#8018599">t</a></span><span class="op" id="8018832">.</span><span class="ident" id="8018833">Fatalf</span><span class="op" id="8018839">(</span><span class="string" id="8018840">&#34;First&nbsp;Listen(%q,&nbsp;%q)&nbsp;returns&nbsp;address&nbsp;family&nbsp;%v,&nbsp;expected&nbsp;%v&#34;</span><span class="op" id="8018901">,</span>&nbsp;<span class="ident" id="8018903"><a href="/net/unicast_posix_test.go.html#8018613">net</a></span><span class="op" id="8018906">,</span>&nbsp;<span class="ident" id="8018908"><a href="/net/unicast_posix_test.go.html#8018618">laddr</a></span><span class="op" id="8018913">,</span>&nbsp;<span class="ident" id="8018915"><a href="/net/unicast_posix_test.go.html#8018766">fd</a></span><span class="op" id="8018917">.</span><span class="ident" id="8018918">family</span><span class="op" id="8018924">,</span>&nbsp;<span class="ident" id="8018926"><a href="/net/unicast_posix_test.go.html#8008456">syscall</a></span><span class="op" id="8018933">.</span><span class="ident" id="8018934">AF_INET</span><span class="op" id="8018941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8018945">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8018948">case</span>&nbsp;<span class="string" id="8018953">&#34;tcp6&#34;</span><span class="op" id="8018959">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8018963">fd</span>&nbsp;<span class="op" id="8018966">:=</span>&nbsp;<span class="ident" id="8018969"><a href="/net/unicast_posix_test.go.html#8018632">l</a></span><span class="op" id="8018970">.</span><span class="op" id="8018971">(</span><span class="op" id="8018972">*</span><span class="ident" id="8018973"><a href="/net/tcpsock_posix.go.html#1512824">TCPListener</a></span><span class="op" id="8018984">)</span><span class="op" id="8018985">.</span><span class="ident" id="8018986">fd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8018991">if</span>&nbsp;<span class="ident" id="8018994"><a href="/net/unicast_posix_test.go.html#8018963">fd</a></span><span class="op" id="8018996">.</span><span class="ident" id="8018997">family</span>&nbsp;<span class="op" id="8019004">!=</span>&nbsp;<span class="ident" id="8019007"><a href="/net/unicast_posix_test.go.html#8008456">syscall</a></span><span class="op" id="8019014">.</span><span class="ident" id="8019015">AF_INET6</span>&nbsp;<span class="op" id="8019024">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8019029"><a href="/net/unicast_posix_test.go.html#8018599">t</a></span><span class="op" id="8019030">.</span><span class="ident" id="8019031">Fatalf</span><span class="op" id="8019037">(</span><span class="string" id="8019038">&#34;First&nbsp;Listen(%q,&nbsp;%q)&nbsp;returns&nbsp;address&nbsp;family&nbsp;%v,&nbsp;expected&nbsp;%v&#34;</span><span class="op" id="8019099">,</span>&nbsp;<span class="ident" id="8019101"><a href="/net/unicast_posix_test.go.html#8018613">net</a></span><span class="op" id="8019104">,</span>&nbsp;<span class="ident" id="8019106"><a href="/net/unicast_posix_test.go.html#8018618">laddr</a></span><span class="op" id="8019111">,</span>&nbsp;<span class="ident" id="8019113"><a href="/net/unicast_posix_test.go.html#8018963">fd</a></span><span class="op" id="8019115">.</span><span class="ident" id="8019116">family</span><span class="op" id="8019122">,</span>&nbsp;<span class="ident" id="8019124"><a href="/net/unicast_posix_test.go.html#8008456">syscall</a></span><span class="op" id="8019131">.</span><span class="ident" id="8019132">AF_INET6</span><span class="op" id="8019140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8019144">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8019147">case</span>&nbsp;<span class="string" id="8019152">&#34;udp&#34;</span><span class="op" id="8019157">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8019161">fd</span>&nbsp;<span class="op" id="8019164">:=</span>&nbsp;<span class="ident" id="8019167"><a href="/net/unicast_posix_test.go.html#8018632">l</a></span><span class="op" id="8019168">.</span><span class="op" id="8019169">(</span><span class="op" id="8019170">*</span><span class="ident" id="8019171"><a href="/net/udpsock_posix.go.html#1519094">UDPConn</a></span><span class="op" id="8019178">)</span><span class="op" id="8019179">.</span><span class="ident" id="8019180">fd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8019185"><a href="/net/unicast_posix_test.go.html#8020765">checkDualStackAddrFamily</a></span><span class="op" id="8019209">(</span><span class="ident" id="8019210"><a href="/net/unicast_posix_test.go.html#8018599">t</a></span><span class="op" id="8019211">,</span>&nbsp;<span class="ident" id="8019213"><a href="/net/unicast_posix_test.go.html#8018613">net</a></span><span class="op" id="8019216">,</span>&nbsp;<span class="ident" id="8019218"><a href="/net/unicast_posix_test.go.html#8018618">laddr</a></span><span class="op" id="8019223">,</span>&nbsp;<span class="ident" id="8019225"><a href="/net/unicast_posix_test.go.html#8019161">fd</a></span><span class="op" id="8019227">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8019230">case</span>&nbsp;<span class="string" id="8019235">&#34;udp4&#34;</span><span class="op" id="8019241">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8019245">fd</span>&nbsp;<span class="op" id="8019248">:=</span>&nbsp;<span class="ident" id="8019251"><a href="/net/unicast_posix_test.go.html#8018632">l</a></span><span class="op" id="8019252">.</span><span class="op" id="8019253">(</span><span class="op" id="8019254">*</span><span class="ident" id="8019255"><a href="/net/udpsock_posix.go.html#1519094">UDPConn</a></span><span class="op" id="8019262">)</span><span class="op" id="8019263">.</span><span class="ident" id="8019264">fd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8019269">if</span>&nbsp;<span class="ident" id="8019272"><a href="/net/unicast_posix_test.go.html#8019245">fd</a></span><span class="op" id="8019274">.</span><span class="ident" id="8019275">family</span>&nbsp;<span class="op" id="8019282">!=</span>&nbsp;<span class="ident" id="8019285"><a href="/net/unicast_posix_test.go.html#8008456">syscall</a></span><span class="op" id="8019292">.</span><span class="ident" id="8019293">AF_INET</span>&nbsp;<span class="op" id="8019301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8019306"><a href="/net/unicast_posix_test.go.html#8018599">t</a></span><span class="op" id="8019307">.</span><span class="ident" id="8019308">Fatalf</span><span class="op" id="8019314">(</span><span class="string" id="8019315">&#34;First&nbsp;ListenPacket(%q,&nbsp;%q)&nbsp;returns&nbsp;address&nbsp;family&nbsp;%v,&nbsp;expected&nbsp;%v&#34;</span><span class="op" id="8019382">,</span>&nbsp;<span class="ident" id="8019384"><a href="/net/unicast_posix_test.go.html#8018613">net</a></span><span class="op" id="8019387">,</span>&nbsp;<span class="ident" id="8019389"><a href="/net/unicast_posix_test.go.html#8018618">laddr</a></span><span class="op" id="8019394">,</span>&nbsp;<span class="ident" id="8019396"><a href="/net/unicast_posix_test.go.html#8019245">fd</a></span><span class="op" id="8019398">.</span><span class="ident" id="8019399">family</span><span class="op" id="8019405">,</span>&nbsp;<span class="ident" id="8019407"><a href="/net/unicast_posix_test.go.html#8008456">syscall</a></span><span class="op" id="8019414">.</span><span class="ident" id="8019415">AF_INET</span><span class="op" id="8019422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8019426">}</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8019429">case</span>&nbsp;<span class="string" id="8019434">&#34;udp6&#34;</span><span class="op" id="8019440">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8019444">fd</span>&nbsp;<span class="op" id="8019447">:=</span>&nbsp;<span class="ident" id="8019450"><a href="/net/unicast_posix_test.go.html#8018632">l</a></span><span class="op" id="8019451">.</span><span class="op" id="8019452">(</span><span class="op" id="8019453">*</span><span class="ident" id="8019454"><a href="/net/udpsock_posix.go.html#1519094">UDPConn</a></span><span class="op" id="8019461">)</span><span class="op" id="8019462">.</span><span class="ident" id="8019463">fd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8019468">if</span>&nbsp;<span class="ident" id="8019471"><a href="/net/unicast_posix_test.go.html#8019444">fd</a></span><span class="op" id="8019473">.</span><span class="ident" id="8019474">family</span>&nbsp;<span class="op" id="8019481">!=</span>&nbsp;<span class="ident" id="8019484"><a href="/net/unicast_posix_test.go.html#8008456">syscall</a></span><span class="op" id="8019491">.</span><span class="ident" id="8019492">AF_INET6</span>&nbsp;<span class="op" id="8019501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8019506"><a href="/net/unicast_posix_test.go.html#8018599">t</a></span><span class="op" id="8019507">.</span><span class="ident" id="8019508">Fatalf</span><span class="op" id="8019514">(</span><span class="string" id="8019515">&#34;First&nbsp;ListenPacket(%q,&nbsp;%q)&nbsp;returns&nbsp;address&nbsp;family&nbsp;%v,&nbsp;expected&nbsp;%v&#34;</span><span class="op" id="8019582">,</span>&nbsp;<span class="ident" id="8019584"><a href="/net/unicast_posix_test.go.html#8018613">net</a></span><span class="op" id="8019587">,</span>&nbsp;<span class="ident" id="8019589"><a href="/net/unicast_posix_test.go.html#8018618">laddr</a></span><span class="op" id="8019594">,</span>&nbsp;<span class="ident" id="8019596"><a href="/net/unicast_posix_test.go.html#8019444">fd</a></span><span class="op" id="8019598">.</span><span class="ident" id="8019599">family</span><span class="op" id="8019605">,</span>&nbsp;<span class="ident" id="8019607"><a href="/net/unicast_posix_test.go.html#8008456">syscall</a></span><span class="op" id="8019614">.</span><span class="ident" id="8019615">AF_INET6</span><span class="op" id="8019623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8019627">}</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8019630">default</span><span class="op" id="8019637">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8019641"><a href="/net/unicast_posix_test.go.html#8018599">t</a></span><span class="op" id="8019642">.</span><span class="ident" id="8019643">Fatalf</span><span class="op" id="8019649">(</span><span class="string" id="8019650">&#34;Unexpected&nbsp;network:&nbsp;%q&#34;</span><span class="op" id="8019674">,</span>&nbsp;<span class="ident" id="8019676"><a href="/net/unicast_posix_test.go.html#8018613">net</a></span><span class="op" id="8019679">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8019682">}</span><br>
<span class="lineno"></span><span class="op" id="8019684">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="keyword" id="8019687">func</span>&nbsp;<span class="ident" id="8019692">checkSecondListener</span><span class="op" id="8019711">(</span><span class="ident" id="8019712">t</span>&nbsp;<span class="op" id="8019714">*</span><span class="ident" id="8019715"><a href="/net/unicast_posix_test.go.html#8008467">testing</a></span><span class="op" id="8019722">.</span><span class="ident" id="8019723">T</span><span class="op" id="8019724">,</span>&nbsp;<span class="ident" id="8019726">net</span><span class="op" id="8019729">,</span>&nbsp;<span class="ident" id="8019731">laddr</span>&nbsp;<span class="builtintype" id="8019737">string</span><span class="op" id="8019743">,</span>&nbsp;<span class="ident" id="8019745">err</span>&nbsp;<span class="builtintype" id="8019749">error</span><span class="op" id="8019754">,</span>&nbsp;<span class="ident" id="8019756">l</span>&nbsp;<span class="keyword" id="8019758">interface</span><span class="op" id="8019767">{</span><span class="op" id="8019768">}</span><span class="op" id="8019769">)</span>&nbsp;<span class="op" id="8019771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8019774">switch</span>&nbsp;<span class="ident" id="8019781"><a href="/net/unicast_posix_test.go.html#8019726">net</a></span>&nbsp;<span class="op" id="8019785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8019788">case</span>&nbsp;<span class="string" id="8019793">&#34;tcp&#34;</span><span class="op" id="8019798">,</span>&nbsp;<span class="string" id="8019800">&#34;tcp4&#34;</span><span class="op" id="8019806">,</span>&nbsp;<span class="string" id="8019808">&#34;tcp6&#34;</span><span class="op" id="8019814">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8019818">if</span>&nbsp;<span class="ident" id="8019821"><a href="/net/unicast_posix_test.go.html#8019745">err</a></span>&nbsp;<span class="op" id="8019825">==</span>&nbsp;<span class="ident" id="8019828">nil</span>&nbsp;<span class="op" id="8019832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8019837"><a href="/net/unicast_posix_test.go.html#8019756">l</a></span><span class="op" id="8019838">.</span><span class="op" id="8019839">(</span><span class="op" id="8019840">*</span><span class="ident" id="8019841"><a href="/net/tcpsock_posix.go.html#1512824">TCPListener</a></span><span class="op" id="8019852">)</span><span class="op" id="8019853">.</span><span class="ident" id="8019854">Close</span><span class="op" id="8019859">(</span><span class="op" id="8019860">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8019865"><a href="/net/unicast_posix_test.go.html#8019712">t</a></span><span class="op" id="8019866">.</span><span class="ident" id="8019867">Fatalf</span><span class="op" id="8019873">(</span><span class="string" id="8019874">&#34;Second&nbsp;Listen(%q,&nbsp;%q)&nbsp;should&nbsp;fail&#34;</span><span class="op" id="8019909">,</span>&nbsp;<span class="ident" id="8019911"><a href="/net/unicast_posix_test.go.html#8019726">net</a></span><span class="op" id="8019914">,</span>&nbsp;<span class="ident" id="8019916"><a href="/net/unicast_posix_test.go.html#8019731">laddr</a></span><span class="op" id="8019921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8019925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8019928">case</span>&nbsp;<span class="string" id="8019933">&#34;udp&#34;</span><span class="op" id="8019938">,</span>&nbsp;<span class="string" id="8019940">&#34;udp4&#34;</span><span class="op" id="8019946">,</span>&nbsp;<span class="string" id="8019948">&#34;udp6&#34;</span><span class="op" id="8019954">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8019958">if</span>&nbsp;<span class="ident" id="8019961"><a href="/net/unicast_posix_test.go.html#8019745">err</a></span>&nbsp;<span class="op" id="8019965">==</span>&nbsp;<span class="ident" id="8019968">nil</span>&nbsp;<span class="op" id="8019972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8019977"><a href="/net/unicast_posix_test.go.html#8019756">l</a></span><span class="op" id="8019978">.</span><span class="op" id="8019979">(</span><span class="op" id="8019980">*</span><span class="ident" id="8019981"><a href="/net/udpsock_posix.go.html#1519094">UDPConn</a></span><span class="op" id="8019988">)</span><span class="op" id="8019989">.</span><span class="ident" id="8019990">Close</span><span class="op" id="8019995">(</span><span class="op" id="8019996">)</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8020001"><a href="/net/unicast_posix_test.go.html#8019712">t</a></span><span class="op" id="8020002">.</span><span class="ident" id="8020003">Fatalf</span><span class="op" id="8020009">(</span><span class="string" id="8020010">&#34;Second&nbsp;ListenPacket(%q,&nbsp;%q)&nbsp;should&nbsp;fail&#34;</span><span class="op" id="8020051">,</span>&nbsp;<span class="ident" id="8020053"><a href="/net/unicast_posix_test.go.html#8019726">net</a></span><span class="op" id="8020056">,</span>&nbsp;<span class="ident" id="8020058"><a href="/net/unicast_posix_test.go.html#8019731">laddr</a></span><span class="op" id="8020063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8020067">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8020070">default</span><span class="op" id="8020077">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8020081"><a href="/net/unicast_posix_test.go.html#8019712">t</a></span><span class="op" id="8020082">.</span><span class="ident" id="8020083">Fatalf</span><span class="op" id="8020089">(</span><span class="string" id="8020090">&#34;Unexpected&nbsp;network:&nbsp;%q&#34;</span><span class="op" id="8020114">,</span>&nbsp;<span class="ident" id="8020116"><a href="/net/unicast_posix_test.go.html#8019726">net</a></span><span class="op" id="8020119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8020122">}</span><br>
<span class="lineno">350</span><span class="op" id="8020124">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8020127">func</span>&nbsp;<span class="ident" id="8020132">checkDualStackSecondListener</span><span class="op" id="8020160">(</span><span class="ident" id="8020161">t</span>&nbsp;<span class="op" id="8020163">*</span><span class="ident" id="8020164"><a href="/net/unicast_posix_test.go.html#8008467">testing</a></span><span class="op" id="8020171">.</span><span class="ident" id="8020172">T</span><span class="op" id="8020173">,</span>&nbsp;<span class="ident" id="8020175">net</span><span class="op" id="8020178">,</span>&nbsp;<span class="ident" id="8020180">laddr</span>&nbsp;<span class="builtintype" id="8020186">string</span><span class="op" id="8020192">,</span>&nbsp;<span class="ident" id="8020194">xerr</span><span class="op" id="8020198">,</span>&nbsp;<span class="ident" id="8020200">err</span>&nbsp;<span class="builtintype" id="8020204">error</span><span class="op" id="8020209">,</span>&nbsp;<span class="ident" id="8020211">l</span>&nbsp;<span class="keyword" id="8020213">interface</span><span class="op" id="8020222">{</span><span class="op" id="8020223">}</span><span class="op" id="8020224">)</span>&nbsp;<span class="op" id="8020226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8020229">switch</span>&nbsp;<span class="ident" id="8020236"><a href="/net/unicast_posix_test.go.html#8020175">net</a></span>&nbsp;<span class="op" id="8020240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8020243">case</span>&nbsp;<span class="string" id="8020248">&#34;tcp&#34;</span><span class="op" id="8020253">,</span>&nbsp;<span class="string" id="8020255">&#34;tcp4&#34;</span><span class="op" id="8020261">,</span>&nbsp;<span class="string" id="8020263">&#34;tcp6&#34;</span><span class="op" id="8020269">:</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8020273">if</span>&nbsp;<span class="ident" id="8020276"><a href="/net/unicast_posix_test.go.html#8020194">xerr</a></span>&nbsp;<span class="op" id="8020281">==</span>&nbsp;<span class="ident" id="8020284">nil</span>&nbsp;<span class="op" id="8020288">&amp;&amp;</span>&nbsp;<span class="ident" id="8020291"><a href="/net/unicast_posix_test.go.html#8020200">err</a></span>&nbsp;<span class="op" id="8020295">!=</span>&nbsp;<span class="ident" id="8020298">nil</span>&nbsp;<span class="op" id="8020302">||</span>&nbsp;<span class="ident" id="8020305"><a href="/net/unicast_posix_test.go.html#8020194">xerr</a></span>&nbsp;<span class="op" id="8020310">!=</span>&nbsp;<span class="ident" id="8020313">nil</span>&nbsp;<span class="op" id="8020317">&amp;&amp;</span>&nbsp;<span class="ident" id="8020320"><a href="/net/unicast_posix_test.go.html#8020200">err</a></span>&nbsp;<span class="op" id="8020324">==</span>&nbsp;<span class="ident" id="8020327">nil</span>&nbsp;<span class="op" id="8020331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8020336"><a href="/net/unicast_posix_test.go.html#8020161">t</a></span><span class="op" id="8020337">.</span><span class="ident" id="8020338">Fatalf</span><span class="op" id="8020344">(</span><span class="string" id="8020345">&#34;Second&nbsp;Listen(%q,&nbsp;%q)&nbsp;returns&nbsp;%v,&nbsp;expected&nbsp;%v&#34;</span><span class="op" id="8020392">,</span>&nbsp;<span class="ident" id="8020394"><a href="/net/unicast_posix_test.go.html#8020175">net</a></span><span class="op" id="8020397">,</span>&nbsp;<span class="ident" id="8020399"><a href="/net/unicast_posix_test.go.html#8020180">laddr</a></span><span class="op" id="8020404">,</span>&nbsp;<span class="ident" id="8020406"><a href="/net/unicast_posix_test.go.html#8020200">err</a></span><span class="op" id="8020409">,</span>&nbsp;<span class="ident" id="8020411"><a href="/net/unicast_posix_test.go.html#8020194">xerr</a></span><span class="op" id="8020415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8020419">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8020423">if</span>&nbsp;<span class="ident" id="8020426"><a href="/net/unicast_posix_test.go.html#8020200">err</a></span>&nbsp;<span class="op" id="8020430">==</span>&nbsp;<span class="ident" id="8020433">nil</span>&nbsp;<span class="op" id="8020437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8020442"><a href="/net/unicast_posix_test.go.html#8020211">l</a></span><span class="op" id="8020443">.</span><span class="op" id="8020444">(</span><span class="op" id="8020445">*</span><span class="ident" id="8020446"><a href="/net/tcpsock_posix.go.html#1512824">TCPListener</a></span><span class="op" id="8020457">)</span><span class="op" id="8020458">.</span><span class="ident" id="8020459">Close</span><span class="op" id="8020464">(</span><span class="op" id="8020465">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8020469">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8020472">case</span>&nbsp;<span class="string" id="8020477">&#34;udp&#34;</span><span class="op" id="8020482">,</span>&nbsp;<span class="string" id="8020484">&#34;udp4&#34;</span><span class="op" id="8020490">,</span>&nbsp;<span class="string" id="8020492">&#34;udp6&#34;</span><span class="op" id="8020498">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8020502">if</span>&nbsp;<span class="ident" id="8020505"><a href="/net/unicast_posix_test.go.html#8020194">xerr</a></span>&nbsp;<span class="op" id="8020510">==</span>&nbsp;<span class="ident" id="8020513">nil</span>&nbsp;<span class="op" id="8020517">&amp;&amp;</span>&nbsp;<span class="ident" id="8020520"><a href="/net/unicast_posix_test.go.html#8020200">err</a></span>&nbsp;<span class="op" id="8020524">!=</span>&nbsp;<span class="ident" id="8020527">nil</span>&nbsp;<span class="op" id="8020531">||</span>&nbsp;<span class="ident" id="8020534"><a href="/net/unicast_posix_test.go.html#8020194">xerr</a></span>&nbsp;<span class="op" id="8020539">!=</span>&nbsp;<span class="ident" id="8020542">nil</span>&nbsp;<span class="op" id="8020546">&amp;&amp;</span>&nbsp;<span class="ident" id="8020549"><a href="/net/unicast_posix_test.go.html#8020200">err</a></span>&nbsp;<span class="op" id="8020553">==</span>&nbsp;<span class="ident" id="8020556">nil</span>&nbsp;<span class="op" id="8020560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8020565"><a href="/net/unicast_posix_test.go.html#8020161">t</a></span><span class="op" id="8020566">.</span><span class="ident" id="8020567">Fatalf</span><span class="op" id="8020573">(</span><span class="string" id="8020574">&#34;Second&nbsp;ListenPacket(%q,&nbsp;%q)&nbsp;returns&nbsp;%v,&nbsp;expected&nbsp;%v&#34;</span><span class="op" id="8020627">,</span>&nbsp;<span class="ident" id="8020629"><a href="/net/unicast_posix_test.go.html#8020175">net</a></span><span class="op" id="8020632">,</span>&nbsp;<span class="ident" id="8020634"><a href="/net/unicast_posix_test.go.html#8020180">laddr</a></span><span class="op" id="8020639">,</span>&nbsp;<span class="ident" id="8020641"><a href="/net/unicast_posix_test.go.html#8020200">err</a></span><span class="op" id="8020644">,</span>&nbsp;<span class="ident" id="8020646"><a href="/net/unicast_posix_test.go.html#8020194">xerr</a></span><span class="op" id="8020650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8020654">}</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8020658">if</span>&nbsp;<span class="ident" id="8020661"><a href="/net/unicast_posix_test.go.html#8020200">err</a></span>&nbsp;<span class="op" id="8020665">==</span>&nbsp;<span class="ident" id="8020668">nil</span>&nbsp;<span class="op" id="8020672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8020677"><a href="/net/unicast_posix_test.go.html#8020211">l</a></span><span class="op" id="8020678">.</span><span class="op" id="8020679">(</span><span class="op" id="8020680">*</span><span class="ident" id="8020681"><a href="/net/udpsock_posix.go.html#1519094">UDPConn</a></span><span class="op" id="8020688">)</span><span class="op" id="8020689">.</span><span class="ident" id="8020690">Close</span><span class="op" id="8020695">(</span><span class="op" id="8020696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8020700">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8020703">default</span><span class="op" id="8020710">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8020714"><a href="/net/unicast_posix_test.go.html#8020161">t</a></span><span class="op" id="8020715">.</span><span class="ident" id="8020716">Fatalf</span><span class="op" id="8020722">(</span><span class="string" id="8020723">&#34;Unexpected&nbsp;network:&nbsp;%q&#34;</span><span class="op" id="8020747">,</span>&nbsp;<span class="ident" id="8020749"><a href="/net/unicast_posix_test.go.html#8020175">net</a></span><span class="op" id="8020752">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8020755">}</span><br>
<span class="lineno"></span><span class="op" id="8020757">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8020760">func</span>&nbsp;<span class="ident" id="8020765">checkDualStackAddrFamily</span><span class="op" id="8020789">(</span><span class="ident" id="8020790">t</span>&nbsp;<span class="op" id="8020792">*</span><span class="ident" id="8020793"><a href="/net/unicast_posix_test.go.html#8008467">testing</a></span><span class="op" id="8020800">.</span><span class="ident" id="8020801">T</span><span class="op" id="8020802">,</span>&nbsp;<span class="ident" id="8020804">net</span><span class="op" id="8020807">,</span>&nbsp;<span class="ident" id="8020809">laddr</span>&nbsp;<span class="builtintype" id="8020815">string</span><span class="op" id="8020821">,</span>&nbsp;<span class="ident" id="8020823">fd</span>&nbsp;<span class="op" id="8020826">*</span><span class="ident" id="8020827"><a href="/net/fd_unix.go.html#1388279">netFD</a></span><span class="op" id="8020832">)</span>&nbsp;<span class="op" id="8020834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8020837">switch</span>&nbsp;<span class="ident" id="8020844">a</span>&nbsp;<span class="op" id="8020846">:=</span>&nbsp;<span class="ident" id="8020849"><a href="/net/unicast_posix_test.go.html#8020823">fd</a></span><span class="op" id="8020851">.</span><span class="ident" id="8020852">laddr</span><span class="op" id="8020857">.</span><span class="op" id="8020858">(</span><span class="keyword" id="8020859">type</span><span class="op" id="8020863">)</span>&nbsp;<span class="op" id="8020865">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8020868">case</span>&nbsp;<span class="op" id="8020873">*</span><span class="ident" id="8020874"><a href="/net/tcpsock.go.html#1504387">TCPAddr</a></span><span class="op" id="8020881">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8020885">//&nbsp;If&nbsp;a&nbsp;node&nbsp;under&nbsp;test&nbsp;supports&nbsp;both&nbsp;IPv6&nbsp;capability</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8020941">//&nbsp;and&nbsp;IPv6&nbsp;IPv4-mapping&nbsp;capability,&nbsp;we&nbsp;can&nbsp;assume</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8020994">//&nbsp;that&nbsp;the&nbsp;node&nbsp;listens&nbsp;on&nbsp;a&nbsp;wildcard&nbsp;address&nbsp;with&nbsp;an</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8021051">//&nbsp;AF_INET6&nbsp;socket.</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8021073">if</span>&nbsp;<span class="ident" id="8021076"><a href="/net/ipsock.go.html#1440829">supportsIPv4map</a></span>&nbsp;<span class="op" id="8021092">&amp;&amp;</span>&nbsp;<span class="ident" id="8021095"><a href="/net/unicast_posix_test.go.html#8020823">fd</a></span><span class="op" id="8021097">.</span><span class="ident" id="8021098">laddr</span><span class="op" id="8021103">.</span><span class="op" id="8021104">(</span><span class="op" id="8021105">*</span><span class="ident" id="8021106"><a href="/net/tcpsock.go.html#1504387">TCPAddr</a></span><span class="op" id="8021113">)</span><span class="op" id="8021114">.</span><span class="ident" id="8021115">isWildcard</span><span class="op" id="8021125">(</span><span class="op" id="8021126">)</span>&nbsp;<span class="op" id="8021128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8021133">if</span>&nbsp;<span class="ident" id="8021136"><a href="/net/unicast_posix_test.go.html#8020823">fd</a></span><span class="op" id="8021138">.</span><span class="ident" id="8021139">family</span>&nbsp;<span class="op" id="8021146">!=</span>&nbsp;<span class="ident" id="8021149"><a href="/net/unicast_posix_test.go.html#8008456">syscall</a></span><span class="op" id="8021156">.</span><span class="ident" id="8021157">AF_INET6</span>&nbsp;<span class="op" id="8021166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8021172"><a href="/net/unicast_posix_test.go.html#8020790">t</a></span><span class="op" id="8021173">.</span><span class="ident" id="8021174">Fatalf</span><span class="op" id="8021180">(</span><span class="string" id="8021181">&#34;Listen(%q,&nbsp;%q)&nbsp;returns&nbsp;address&nbsp;family&nbsp;%v,&nbsp;expected&nbsp;%v&#34;</span><span class="op" id="8021236">,</span>&nbsp;<span class="ident" id="8021238"><a href="/net/unicast_posix_test.go.html#8020804">net</a></span><span class="op" id="8021241">,</span>&nbsp;<span class="ident" id="8021243"><a href="/net/unicast_posix_test.go.html#8020809">laddr</a></span><span class="op" id="8021248">,</span>&nbsp;<span class="ident" id="8021250"><a href="/net/unicast_posix_test.go.html#8020823">fd</a></span><span class="op" id="8021252">.</span><span class="ident" id="8021253">family</span><span class="op" id="8021259">,</span>&nbsp;<span class="ident" id="8021261"><a href="/net/unicast_posix_test.go.html#8008456">syscall</a></span><span class="op" id="8021268">.</span><span class="ident" id="8021269">AF_INET6</span><span class="op" id="8021277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8021282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8021286">}</span>&nbsp;<span class="keyword" id="8021288">else</span>&nbsp;<span class="op" id="8021293">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8021298">if</span>&nbsp;<span class="ident" id="8021301"><a href="/net/unicast_posix_test.go.html#8020823">fd</a></span><span class="op" id="8021303">.</span><span class="ident" id="8021304">family</span>&nbsp;<span class="op" id="8021311">!=</span>&nbsp;<span class="ident" id="8021314"><a href="/net/unicast_posix_test.go.html#8020844">a</a></span><span class="op" id="8021315">.</span><span class="ident" id="8021316">family</span><span class="op" id="8021322">(</span><span class="op" id="8021323">)</span>&nbsp;<span class="op" id="8021325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8021331"><a href="/net/unicast_posix_test.go.html#8020790">t</a></span><span class="op" id="8021332">.</span><span class="ident" id="8021333">Fatalf</span><span class="op" id="8021339">(</span><span class="string" id="8021340">&#34;Listen(%q,&nbsp;%q)&nbsp;returns&nbsp;address&nbsp;family&nbsp;%v,&nbsp;expected&nbsp;%v&#34;</span><span class="op" id="8021395">,</span>&nbsp;<span class="ident" id="8021397"><a href="/net/unicast_posix_test.go.html#8020804">net</a></span><span class="op" id="8021400">,</span>&nbsp;<span class="ident" id="8021402"><a href="/net/unicast_posix_test.go.html#8020809">laddr</a></span><span class="op" id="8021407">,</span>&nbsp;<span class="ident" id="8021409"><a href="/net/unicast_posix_test.go.html#8020823">fd</a></span><span class="op" id="8021411">.</span><span class="ident" id="8021412">family</span><span class="op" id="8021418">,</span>&nbsp;<span class="ident" id="8021420"><a href="/net/unicast_posix_test.go.html#8020844">a</a></span><span class="op" id="8021421">.</span><span class="ident" id="8021422">family</span><span class="op" id="8021428">(</span><span class="op" id="8021429">)</span><span class="op" id="8021430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8021435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8021439">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8021442">case</span>&nbsp;<span class="op" id="8021447">*</span><span class="ident" id="8021448"><a href="/net/udpsock.go.html#1516760">UDPAddr</a></span><span class="op" id="8021455">:</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8021459">//&nbsp;If&nbsp;a&nbsp;node&nbsp;under&nbsp;test&nbsp;supports&nbsp;both&nbsp;IPv6&nbsp;capability</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8021515">//&nbsp;and&nbsp;IPv6&nbsp;IPv4-mapping&nbsp;capability,&nbsp;we&nbsp;can&nbsp;assume</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8021568">//&nbsp;that&nbsp;the&nbsp;node&nbsp;listens&nbsp;on&nbsp;a&nbsp;wildcard&nbsp;address&nbsp;with&nbsp;an</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8021625">//&nbsp;AF_INET6&nbsp;socket.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8021647">if</span>&nbsp;<span class="ident" id="8021650"><a href="/net/ipsock.go.html#1440829">supportsIPv4map</a></span>&nbsp;<span class="op" id="8021666">&amp;&amp;</span>&nbsp;<span class="ident" id="8021669"><a href="/net/unicast_posix_test.go.html#8020823">fd</a></span><span class="op" id="8021671">.</span><span class="ident" id="8021672">laddr</span><span class="op" id="8021677">.</span><span class="op" id="8021678">(</span><span class="op" id="8021679">*</span><span class="ident" id="8021680"><a href="/net/udpsock.go.html#1516760">UDPAddr</a></span><span class="op" id="8021687">)</span><span class="op" id="8021688">.</span><span class="ident" id="8021689">isWildcard</span><span class="op" id="8021699">(</span><span class="op" id="8021700">)</span>&nbsp;<span class="op" id="8021702">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8021707">if</span>&nbsp;<span class="ident" id="8021710"><a href="/net/unicast_posix_test.go.html#8020823">fd</a></span><span class="op" id="8021712">.</span><span class="ident" id="8021713">family</span>&nbsp;<span class="op" id="8021720">!=</span>&nbsp;<span class="ident" id="8021723"><a href="/net/unicast_posix_test.go.html#8008456">syscall</a></span><span class="op" id="8021730">.</span><span class="ident" id="8021731">AF_INET6</span>&nbsp;<span class="op" id="8021740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8021746"><a href="/net/unicast_posix_test.go.html#8020790">t</a></span><span class="op" id="8021747">.</span><span class="ident" id="8021748">Fatalf</span><span class="op" id="8021754">(</span><span class="string" id="8021755">&#34;ListenPacket(%q,&nbsp;%q)&nbsp;returns&nbsp;address&nbsp;family&nbsp;%v,&nbsp;expected&nbsp;%v&#34;</span><span class="op" id="8021816">,</span>&nbsp;<span class="ident" id="8021818"><a href="/net/unicast_posix_test.go.html#8020804">net</a></span><span class="op" id="8021821">,</span>&nbsp;<span class="ident" id="8021823"><a href="/net/unicast_posix_test.go.html#8020809">laddr</a></span><span class="op" id="8021828">,</span>&nbsp;<span class="ident" id="8021830"><a href="/net/unicast_posix_test.go.html#8020823">fd</a></span><span class="op" id="8021832">.</span><span class="ident" id="8021833">family</span><span class="op" id="8021839">,</span>&nbsp;<span class="ident" id="8021841"><a href="/net/unicast_posix_test.go.html#8008456">syscall</a></span><span class="op" id="8021848">.</span><span class="ident" id="8021849">AF_INET6</span><span class="op" id="8021857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8021862">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8021866">}</span>&nbsp;<span class="keyword" id="8021868">else</span>&nbsp;<span class="op" id="8021873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8021878">if</span>&nbsp;<span class="ident" id="8021881"><a href="/net/unicast_posix_test.go.html#8020823">fd</a></span><span class="op" id="8021883">.</span><span class="ident" id="8021884">family</span>&nbsp;<span class="op" id="8021891">!=</span>&nbsp;<span class="ident" id="8021894"><a href="/net/unicast_posix_test.go.html#8020844">a</a></span><span class="op" id="8021895">.</span><span class="ident" id="8021896">family</span><span class="op" id="8021902">(</span><span class="op" id="8021903">)</span>&nbsp;<span class="op" id="8021905">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8021911"><a href="/net/unicast_posix_test.go.html#8020790">t</a></span><span class="op" id="8021912">.</span><span class="ident" id="8021913">Fatalf</span><span class="op" id="8021919">(</span><span class="string" id="8021920">&#34;ListenPacket(%q,&nbsp;%q)&nbsp;returns&nbsp;address&nbsp;family&nbsp;%v,&nbsp;expected&nbsp;%v&#34;</span><span class="op" id="8021981">,</span>&nbsp;<span class="ident" id="8021983"><a href="/net/unicast_posix_test.go.html#8020804">net</a></span><span class="op" id="8021986">,</span>&nbsp;<span class="ident" id="8021988"><a href="/net/unicast_posix_test.go.html#8020809">laddr</a></span><span class="op" id="8021993">,</span>&nbsp;<span class="ident" id="8021995"><a href="/net/unicast_posix_test.go.html#8020823">fd</a></span><span class="op" id="8021997">.</span><span class="ident" id="8021998">family</span><span class="op" id="8022004">,</span>&nbsp;<span class="ident" id="8022006"><a href="/net/unicast_posix_test.go.html#8020844">a</a></span><span class="op" id="8022007">.</span><span class="ident" id="8022008">family</span><span class="op" id="8022014">(</span><span class="op" id="8022015">)</span><span class="op" id="8022016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8022021">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8022025">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8022028">default</span><span class="op" id="8022035">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8022039"><a href="/net/unicast_posix_test.go.html#8020790">t</a></span><span class="op" id="8022040">.</span><span class="ident" id="8022041">Fatalf</span><span class="op" id="8022047">(</span><span class="string" id="8022048">&#34;Unexpected&nbsp;protocol&nbsp;address&nbsp;type:&nbsp;%T&#34;</span><span class="op" id="8022086">,</span>&nbsp;<span class="ident" id="8022088"><a href="/net/unicast_posix_test.go.html#8020844">a</a></span><span class="op" id="8022089">)</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8022092">}</span><br>
<span class="lineno"></span><span class="op" id="8022094">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8022097">var</span>&nbsp;<span class="ident" id="8022101">prohibitionaryDialArgTests</span>&nbsp;<span class="op" id="8022128">=</span>&nbsp;<span class="op" id="8022130">[</span><span class="op" id="8022131">]</span><span class="keyword" id="8022132">struct</span>&nbsp;<span class="op" id="8022139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8022142">net</span>&nbsp;&nbsp;<span class="builtintype" id="8022147">string</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8022155">addr</span>&nbsp;<span class="builtintype" id="8022160">string</span><br>
<span class="lineno"></span><span class="op" id="8022167">}</span><span class="op" id="8022168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8022171">{</span><span class="string" id="8022172">&#34;tcp6&#34;</span><span class="op" id="8022178">,</span>&nbsp;<span class="string" id="8022180">&#34;127.0.0.1&#34;</span><span class="op" id="8022191">}</span><span class="op" id="8022192">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8022195">{</span><span class="string" id="8022196">&#34;tcp6&#34;</span><span class="op" id="8022202">,</span>&nbsp;<span class="string" id="8022204">&#34;[::ffff:127.0.0.1]&#34;</span><span class="op" id="8022224">}</span><span class="op" id="8022225">,</span><br>
<span class="lineno"></span><span class="op" id="8022227">}</span><br>
<span class="lineno">415</span><br>
<span class="lineno"></span><span class="keyword" id="8022230">func</span>&nbsp;<span class="ident" id="8022235">TestProhibitionaryDialArgs</span><span class="op" id="8022261">(</span><span class="ident" id="8022262">t</span>&nbsp;<span class="op" id="8022264">*</span><span class="ident" id="8022265"><a href="/net/unicast_posix_test.go.html#8008467">testing</a></span><span class="op" id="8022272">.</span><span class="ident" id="8022273">T</span><span class="op" id="8022274">)</span>&nbsp;<span class="op" id="8022276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8022279">switch</span>&nbsp;<span class="ident" id="8022286"><a href="/net/unicast_posix_test.go.html#8008445">runtime</a></span><span class="op" id="8022293">.</span><span class="ident" id="8022294">GOOS</span>&nbsp;<span class="op" id="8022299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8022302">case</span>&nbsp;<span class="string" id="8022307">&#34;plan9&#34;</span><span class="op" id="8022314">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8022318"><a href="/net/unicast_posix_test.go.html#8022262">t</a></span><span class="op" id="8022319">.</span><span class="ident" id="8022320">Skipf</span><span class="op" id="8022325">(</span><span class="string" id="8022326">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="8022347">,</span>&nbsp;<span class="ident" id="8022349"><a href="/net/unicast_posix_test.go.html#8008445">runtime</a></span><span class="op" id="8022356">.</span><span class="ident" id="8022357">GOOS</span><span class="op" id="8022361">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8022364">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8022367">//&nbsp;This&nbsp;test&nbsp;requires&nbsp;both&nbsp;IPv6&nbsp;and&nbsp;IPv6&nbsp;IPv4-mapping&nbsp;functionality.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8022437">if</span>&nbsp;<span class="op" id="8022440">!</span><span class="ident" id="8022441"><a href="/net/ipsock.go.html#1440829">supportsIPv4map</a></span>&nbsp;<span class="op" id="8022457">||</span>&nbsp;<span class="ident" id="8022460"><a href="/net/unicast_posix_test.go.html#8008467">testing</a></span><span class="op" id="8022467">.</span><span class="ident" id="8022468">Short</span><span class="op" id="8022473">(</span><span class="op" id="8022474">)</span>&nbsp;<span class="op" id="8022476">||</span>&nbsp;<span class="op" id="8022479">!</span><span class="op" id="8022480">*</span><span class="ident" id="8022481"><a href="/net/lookup_test.go.html#7913432">testExternal</a></span>&nbsp;<span class="op" id="8022494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8022498">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8022506">}</span><br>
<span class="lineno">425</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8022510">l</span><span class="op" id="8022511">,</span>&nbsp;<span class="ident" id="8022513">port</span>&nbsp;<span class="op" id="8022518">:=</span>&nbsp;<span class="ident" id="8022521"><a href="/net/unicast_posix_test.go.html#8017310">usableListenPort</a></span><span class="op" id="8022537">(</span><span class="ident" id="8022538"><a href="/net/unicast_posix_test.go.html#8022262">t</a></span><span class="op" id="8022539">,</span>&nbsp;<span class="string" id="8022541">&#34;tcp&#34;</span><span class="op" id="8022546">,</span>&nbsp;<span class="string" id="8022548">&#34;[::]&#34;</span><span class="op" id="8022554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8022557">defer</span>&nbsp;<span class="ident" id="8022563"><a href="/net/unicast_posix_test.go.html#8022510">l</a></span><span class="op" id="8022564">.</span><span class="ident" id="8022565">Close</span><span class="op" id="8022570">(</span><span class="op" id="8022571">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8022575">for</span>&nbsp;<span class="ident" id="8022579">_</span><span class="op" id="8022580">,</span>&nbsp;<span class="ident" id="8022582">tt</span>&nbsp;<span class="op" id="8022585">:=</span>&nbsp;<span class="keyword" id="8022588">range</span>&nbsp;<span class="ident" id="8022594"><a href="/net/unicast_posix_test.go.html#8022101">prohibitionaryDialArgTests</a></span>&nbsp;<span class="op" id="8022621">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8022625">c</span><span class="op" id="8022626">,</span>&nbsp;<span class="ident" id="8022628">err</span>&nbsp;<span class="op" id="8022632">:=</span>&nbsp;<span class="ident" id="8022635"><a href="/net/dial.go.html#1334377">Dial</a></span><span class="op" id="8022639">(</span><span class="ident" id="8022640"><a href="/net/unicast_posix_test.go.html#8022582">tt</a></span><span class="op" id="8022642">.</span><span class="ident" id="8022643">net</span><span class="op" id="8022646">,</span>&nbsp;<span class="ident" id="8022648"><a href="/net/unicast_posix_test.go.html#8022582">tt</a></span><span class="op" id="8022650">.</span><span class="ident" id="8022651">addr</span><span class="op" id="8022655">+</span><span class="string" id="8022656">&#34;:&#34;</span><span class="op" id="8022659">+</span><span class="ident" id="8022660"><a href="/net/unicast_posix_test.go.html#8022513">port</a></span><span class="op" id="8022664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8022668">if</span>&nbsp;<span class="ident" id="8022671"><a href="/net/unicast_posix_test.go.html#8022628">err</a></span>&nbsp;<span class="op" id="8022675">==</span>&nbsp;<span class="ident" id="8022678">nil</span>&nbsp;<span class="op" id="8022682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8022687"><a href="/net/unicast_posix_test.go.html#8022625">c</a></span><span class="op" id="8022688">.</span><span class="ident" id="8022689">Close</span><span class="op" id="8022694">(</span><span class="op" id="8022695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8022700"><a href="/net/unicast_posix_test.go.html#8022262">t</a></span><span class="op" id="8022701">.</span><span class="ident" id="8022702">Fatalf</span><span class="op" id="8022708">(</span><span class="string" id="8022709">&#34;Dial(%q,&nbsp;%q)&nbsp;should&nbsp;fail&#34;</span><span class="op" id="8022735">,</span>&nbsp;<span class="ident" id="8022737"><a href="/net/unicast_posix_test.go.html#8022582">tt</a></span><span class="op" id="8022739">.</span><span class="ident" id="8022740">net</span><span class="op" id="8022743">,</span>&nbsp;<span class="ident" id="8022745"><a href="/net/unicast_posix_test.go.html#8022582">tt</a></span><span class="op" id="8022747">.</span><span class="ident" id="8022748">addr</span><span class="op" id="8022752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8022756">}</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8022759">}</span><br>
<span class="lineno"></span><span class="op" id="8022761">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8022764">func</span>&nbsp;<span class="ident" id="8022769">TestWildWildcardListener</span><span class="op" id="8022793">(</span><span class="ident" id="8022794">t</span>&nbsp;<span class="op" id="8022796">*</span><span class="ident" id="8022797"><a href="/net/unicast_posix_test.go.html#8008467">testing</a></span><span class="op" id="8022804">.</span><span class="ident" id="8022805">T</span><span class="op" id="8022806">)</span>&nbsp;<span class="op" id="8022808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8022811">switch</span>&nbsp;<span class="ident" id="8022818"><a href="/net/unicast_posix_test.go.html#8008445">runtime</a></span><span class="op" id="8022825">.</span><span class="ident" id="8022826">GOOS</span>&nbsp;<span class="op" id="8022831">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8022834">case</span>&nbsp;<span class="string" id="8022839">&#34;plan9&#34;</span><span class="op" id="8022846">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8022850"><a href="/net/unicast_posix_test.go.html#8022794">t</a></span><span class="op" id="8022851">.</span><span class="ident" id="8022852">Skipf</span><span class="op" id="8022857">(</span><span class="string" id="8022858">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="8022879">,</span>&nbsp;<span class="ident" id="8022881"><a href="/net/unicast_posix_test.go.html#8008445">runtime</a></span><span class="op" id="8022888">.</span><span class="ident" id="8022889">GOOS</span><span class="op" id="8022893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8022896">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8022900">if</span>&nbsp;<span class="ident" id="8022903"><a href="/net/unicast_posix_test.go.html#8008467">testing</a></span><span class="op" id="8022910">.</span><span class="ident" id="8022911">Short</span><span class="op" id="8022916">(</span><span class="op" id="8022917">)</span>&nbsp;<span class="op" id="8022919">||</span>&nbsp;<span class="op" id="8022922">!</span><span class="op" id="8022923">*</span><span class="ident" id="8022924"><a href="/net/lookup_test.go.html#7913432">testExternal</a></span>&nbsp;<span class="op" id="8022937">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8022941"><a href="/net/unicast_posix_test.go.html#8022794">t</a></span><span class="op" id="8022942">.</span><span class="ident" id="8022943">Skip</span><span class="op" id="8022947">(</span><span class="string" id="8022948">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="8022989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8022992">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8022996">defer</span>&nbsp;<span class="keyword" id="8023002">func</span><span class="op" id="8023006">(</span><span class="op" id="8023007">)</span>&nbsp;<span class="op" id="8023009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8023013">if</span>&nbsp;<span class="ident" id="8023016">p</span>&nbsp;<span class="op" id="8023018">:=</span>&nbsp;<span class="builtinfunc" id="8023021">recover</span><span class="op" id="8023028">(</span><span class="op" id="8023029">)</span><span class="op" id="8023030">;</span>&nbsp;<span class="ident" id="8023032"><a href="/net/unicast_posix_test.go.html#8023016">p</a></span>&nbsp;<span class="op" id="8023034">!=</span>&nbsp;<span class="ident" id="8023037">nil</span>&nbsp;<span class="op" id="8023041">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8023046"><a href="/net/unicast_posix_test.go.html#8022794">t</a></span><span class="op" id="8023047">.</span><span class="ident" id="8023048">Fatalf</span><span class="op" id="8023054">(</span><span class="string" id="8023055">&#34;Listen,&nbsp;ListenPacket&nbsp;or&nbsp;protocol-specific&nbsp;Listen&nbsp;panicked:&nbsp;%v&#34;</span><span class="op" id="8023118">,</span>&nbsp;<span class="ident" id="8023120"><a href="/net/unicast_posix_test.go.html#8023016">p</a></span><span class="op" id="8023121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8023125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8023128">}</span><span class="op" id="8023129">(</span><span class="op" id="8023130">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8023134">if</span>&nbsp;<span class="ident" id="8023137">ln</span><span class="op" id="8023139">,</span>&nbsp;<span class="ident" id="8023141">err</span>&nbsp;<span class="op" id="8023145">:=</span>&nbsp;<span class="ident" id="8023148"><a href="/net/dial.go.html#1338035">Listen</a></span><span class="op" id="8023154">(</span><span class="string" id="8023155">&#34;tcp&#34;</span><span class="op" id="8023160">,</span>&nbsp;<span class="string" id="8023162">&#34;&#34;</span><span class="op" id="8023164">)</span><span class="op" id="8023165">;</span>&nbsp;<span class="ident" id="8023167"><a href="/net/unicast_posix_test.go.html#8023141">err</a></span>&nbsp;<span class="op" id="8023171">==</span>&nbsp;<span class="ident" id="8023174">nil</span>&nbsp;<span class="op" id="8023178">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8023182"><a href="/net/unicast_posix_test.go.html#8023137">ln</a></span><span class="op" id="8023184">.</span><span class="ident" id="8023185">Close</span><span class="op" id="8023190">(</span><span class="op" id="8023191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8023194">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8023197">if</span>&nbsp;<span class="ident" id="8023200">ln</span><span class="op" id="8023202">,</span>&nbsp;<span class="ident" id="8023204">err</span>&nbsp;<span class="op" id="8023208">:=</span>&nbsp;<span class="ident" id="8023211"><a href="/net/dial.go.html#1338827">ListenPacket</a></span><span class="op" id="8023223">(</span><span class="string" id="8023224">&#34;udp&#34;</span><span class="op" id="8023229">,</span>&nbsp;<span class="string" id="8023231">&#34;&#34;</span><span class="op" id="8023233">)</span><span class="op" id="8023234">;</span>&nbsp;<span class="ident" id="8023236"><a href="/net/unicast_posix_test.go.html#8023204">err</a></span>&nbsp;<span class="op" id="8023240">==</span>&nbsp;<span class="ident" id="8023243">nil</span>&nbsp;<span class="op" id="8023247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8023251"><a href="/net/unicast_posix_test.go.html#8023200">ln</a></span><span class="op" id="8023253">.</span><span class="ident" id="8023254">Close</span><span class="op" id="8023259">(</span><span class="op" id="8023260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8023263">}</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8023266">if</span>&nbsp;<span class="ident" id="8023269">ln</span><span class="op" id="8023271">,</span>&nbsp;<span class="ident" id="8023273">err</span>&nbsp;<span class="op" id="8023277">:=</span>&nbsp;<span class="ident" id="8023280"><a href="/net/tcpsock_posix.go.html#1514734">ListenTCP</a></span><span class="op" id="8023289">(</span><span class="string" id="8023290">&#34;tcp&#34;</span><span class="op" id="8023295">,</span>&nbsp;<span class="ident" id="8023297">nil</span><span class="op" id="8023300">)</span><span class="op" id="8023301">;</span>&nbsp;<span class="ident" id="8023303"><a href="/net/unicast_posix_test.go.html#8023273">err</a></span>&nbsp;<span class="op" id="8023307">==</span>&nbsp;<span class="ident" id="8023310">nil</span>&nbsp;<span class="op" id="8023314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8023318"><a href="/net/unicast_posix_test.go.html#8023269">ln</a></span><span class="op" id="8023320">.</span><span class="ident" id="8023321">Close</span><span class="op" id="8023326">(</span><span class="op" id="8023327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8023330">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8023333">if</span>&nbsp;<span class="ident" id="8023336">ln</span><span class="op" id="8023338">,</span>&nbsp;<span class="ident" id="8023340">err</span>&nbsp;<span class="op" id="8023344">:=</span>&nbsp;<span class="ident" id="8023347"><a href="/net/udpsock_posix.go.html#1523853">ListenUDP</a></span><span class="op" id="8023356">(</span><span class="string" id="8023357">&#34;udp&#34;</span><span class="op" id="8023362">,</span>&nbsp;<span class="ident" id="8023364">nil</span><span class="op" id="8023367">)</span><span class="op" id="8023368">;</span>&nbsp;<span class="ident" id="8023370"><a href="/net/unicast_posix_test.go.html#8023340">err</a></span>&nbsp;<span class="op" id="8023374">==</span>&nbsp;<span class="ident" id="8023377">nil</span>&nbsp;<span class="op" id="8023381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8023385"><a href="/net/unicast_posix_test.go.html#8023336">ln</a></span><span class="op" id="8023387">.</span><span class="ident" id="8023388">Close</span><span class="op" id="8023393">(</span><span class="op" id="8023394">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8023397">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8023400">if</span>&nbsp;<span class="ident" id="8023403">ln</span><span class="op" id="8023405">,</span>&nbsp;<span class="ident" id="8023407">err</span>&nbsp;<span class="op" id="8023411">:=</span>&nbsp;<span class="ident" id="8023414"><a href="/net/iprawsock_posix.go.html#1439614">ListenIP</a></span><span class="op" id="8023422">(</span><span class="string" id="8023423">&#34;ip:icmp&#34;</span><span class="op" id="8023432">,</span>&nbsp;<span class="ident" id="8023434">nil</span><span class="op" id="8023437">)</span><span class="op" id="8023438">;</span>&nbsp;<span class="ident" id="8023440"><a href="/net/unicast_posix_test.go.html#8023407">err</a></span>&nbsp;<span class="op" id="8023444">==</span>&nbsp;<span class="ident" id="8023447">nil</span>&nbsp;<span class="op" id="8023451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8023455"><a href="/net/unicast_posix_test.go.html#8023403">ln</a></span><span class="op" id="8023457">.</span><span class="ident" id="8023458">Close</span><span class="op" id="8023463">(</span><span class="op" id="8023464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8023467">}</span><br>
<span class="lineno"></span><span class="op" id="8023469">}</span>
</div>
</body>
</html>
