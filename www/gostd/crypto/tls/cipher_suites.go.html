<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html" class="current">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4432616">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4432671">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4432725">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4432776">package</span>&nbsp;<span class="ident" id="4432784">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4432789">import</span>&nbsp;<span class="op" id="4432796">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4432799">&#34;crypto/aes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4432813">&#34;crypto/cipher&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4432830">&#34;crypto/des&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4432844">&#34;crypto/hmac&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4432859">&#34;crypto/rc4&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4432873">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4432888">&#34;crypto/x509&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4432903">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="4432910">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4432913">//&nbsp;a&nbsp;keyAgreement&nbsp;implements&nbsp;the&nbsp;client&nbsp;and&nbsp;server&nbsp;side&nbsp;of&nbsp;a&nbsp;TLS&nbsp;key&nbsp;agreement</span><br>
<span class="lineno"></span><span class="comment" id="4432992">//&nbsp;protocol&nbsp;by&nbsp;generating&nbsp;and&nbsp;processing&nbsp;key&nbsp;exchange&nbsp;messages.</span><br>
<span class="lineno">20</span><span class="keyword" id="4433056">type</span>&nbsp;<span class="ident" id="4433061">keyAgreement</span>&nbsp;<span class="keyword" id="4433074">interface</span>&nbsp;<span class="op" id="4433084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4433087">//&nbsp;On&nbsp;the&nbsp;server&nbsp;side,&nbsp;the&nbsp;first&nbsp;two&nbsp;methods&nbsp;are&nbsp;called&nbsp;in&nbsp;order.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4433155">//&nbsp;In&nbsp;the&nbsp;case&nbsp;that&nbsp;the&nbsp;key&nbsp;agreement&nbsp;protocol&nbsp;doesn&#39;t&nbsp;use&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4433217">//&nbsp;ServerKeyExchange&nbsp;message,&nbsp;generateServerKeyExchange&nbsp;can&nbsp;return&nbsp;nil,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4433290">//&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4433299">generateServerKeyExchange</span><span class="op" id="4433324">(</span><span class="op" id="4433325">*</span><span class="ident" id="4433326"><a href="/gostd/crypto/tls/common.go.html#4450481">Config</a></span><span class="op" id="4433332">,</span>&nbsp;<span class="op" id="4433334">*</span><span class="ident" id="4433335"><a href="/gostd/crypto/tls/common.go.html#4457987">Certificate</a></span><span class="op" id="4433346">,</span>&nbsp;<span class="op" id="4433348">*</span><span class="ident" id="4433349"><a href="/gostd/crypto/tls/handshake_messages.go.html#4508266">clientHelloMsg</a></span><span class="op" id="4433363">,</span>&nbsp;<span class="op" id="4433365">*</span><span class="ident" id="4433366"><a href="/gostd/crypto/tls/handshake_messages.go.html#4519382">serverHelloMsg</a></span><span class="op" id="4433380">)</span>&nbsp;<span class="op" id="4433382">(</span><span class="op" id="4433383">*</span><span class="ident" id="4433384"><a href="/gostd/crypto/tls/handshake_messages.go.html#4526463">serverKeyExchangeMsg</a></span><span class="op" id="4433404">,</span>&nbsp;<span class="builtintype" id="4433406">error</span><span class="op" id="4433411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4433414">processClientKeyExchange</span><span class="op" id="4433438">(</span><span class="op" id="4433439">*</span><span class="ident" id="4433440"><a href="/gostd/crypto/tls/common.go.html#4450481">Config</a></span><span class="op" id="4433446">,</span>&nbsp;<span class="op" id="4433448">*</span><span class="ident" id="4433449"><a href="/gostd/crypto/tls/common.go.html#4457987">Certificate</a></span><span class="op" id="4433460">,</span>&nbsp;<span class="op" id="4433462">*</span><span class="ident" id="4433463"><a href="/gostd/crypto/tls/handshake_messages.go.html#4528753">clientKeyExchangeMsg</a></span><span class="op" id="4433483">,</span>&nbsp;<span class="builtintype" id="4433485">uint16</span><span class="op" id="4433491">)</span>&nbsp;<span class="op" id="4433493">(</span><span class="op" id="4433494">[</span><span class="op" id="4433495">]</span><span class="builtintype" id="4433496">byte</span><span class="op" id="4433500">,</span>&nbsp;<span class="builtintype" id="4433502">error</span><span class="op" id="4433507">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4433511">//&nbsp;On&nbsp;the&nbsp;client&nbsp;side,&nbsp;the&nbsp;next&nbsp;two&nbsp;methods&nbsp;are&nbsp;called&nbsp;in&nbsp;order.</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4433578">//&nbsp;This&nbsp;method&nbsp;may&nbsp;not&nbsp;be&nbsp;called&nbsp;if&nbsp;the&nbsp;server&nbsp;doesn&#39;t&nbsp;send&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4433641">//&nbsp;ServerKeyExchange&nbsp;message.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4433672">processServerKeyExchange</span><span class="op" id="4433696">(</span><span class="op" id="4433697">*</span><span class="ident" id="4433698"><a href="/gostd/crypto/tls/common.go.html#4450481">Config</a></span><span class="op" id="4433704">,</span>&nbsp;<span class="op" id="4433706">*</span><span class="ident" id="4433707"><a href="/gostd/crypto/tls/handshake_messages.go.html#4508266">clientHelloMsg</a></span><span class="op" id="4433721">,</span>&nbsp;<span class="op" id="4433723">*</span><span class="ident" id="4433724"><a href="/gostd/crypto/tls/handshake_messages.go.html#4519382">serverHelloMsg</a></span><span class="op" id="4433738">,</span>&nbsp;<span class="op" id="4433740">*</span><span class="ident" id="4433741"><a href="/gostd/crypto/tls/cipher_suites.go.html#4432888">x509</a></span><span class="op" id="4433745">.</span><span class="ident" id="4433746"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span><span class="op" id="4433757">,</span>&nbsp;<span class="op" id="4433759">*</span><span class="ident" id="4433760"><a href="/gostd/crypto/tls/handshake_messages.go.html#4526463">serverKeyExchangeMsg</a></span><span class="op" id="4433780">)</span>&nbsp;<span class="builtintype" id="4433782">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4433789">generateClientKeyExchange</span><span class="op" id="4433814">(</span><span class="op" id="4433815">*</span><span class="ident" id="4433816"><a href="/gostd/crypto/tls/common.go.html#4450481">Config</a></span><span class="op" id="4433822">,</span>&nbsp;<span class="op" id="4433824">*</span><span class="ident" id="4433825"><a href="/gostd/crypto/tls/handshake_messages.go.html#4508266">clientHelloMsg</a></span><span class="op" id="4433839">,</span>&nbsp;<span class="op" id="4433841">*</span><span class="ident" id="4433842"><a href="/gostd/crypto/tls/cipher_suites.go.html#4432888">x509</a></span><span class="op" id="4433846">.</span><span class="ident" id="4433847"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span><span class="op" id="4433858">)</span>&nbsp;<span class="op" id="4433860">(</span><span class="op" id="4433861">[</span><span class="op" id="4433862">]</span><span class="builtintype" id="4433863">byte</span><span class="op" id="4433867">,</span>&nbsp;<span class="op" id="4433869">*</span><span class="ident" id="4433870"><a href="/gostd/crypto/tls/handshake_messages.go.html#4528753">clientKeyExchangeMsg</a></span><span class="op" id="4433890">,</span>&nbsp;<span class="builtintype" id="4433892">error</span><span class="op" id="4433897">)</span><br>
<span class="lineno">35</span><span class="op" id="4433899">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4433902">const</span>&nbsp;<span class="op" id="4433908">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4433911">//&nbsp;suiteECDH&nbsp;indicates&nbsp;that&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;involves&nbsp;elliptic&nbsp;curve</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4433981">//&nbsp;Diffie-Hellman.&nbsp;This&nbsp;means&nbsp;that&nbsp;it&nbsp;should&nbsp;only&nbsp;be&nbsp;selected&nbsp;when&nbsp;the</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4434053">//&nbsp;client&nbsp;indicates&nbsp;that&nbsp;it&nbsp;supports&nbsp;ECC&nbsp;with&nbsp;a&nbsp;curve&nbsp;and&nbsp;point&nbsp;format</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4434125">//&nbsp;that&nbsp;we&#39;re&nbsp;happy&nbsp;with.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4434152">suiteECDHE</span>&nbsp;<span class="op" id="4434163">=</span>&nbsp;<span class="num" id="4434165">1</span>&nbsp;<span class="op" id="4434167">&lt;&lt;</span>&nbsp;<span class="ident" id="4434170">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4434176">//&nbsp;suiteECDSA&nbsp;indicates&nbsp;that&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;involves&nbsp;an&nbsp;ECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4434241">//&nbsp;signature&nbsp;and&nbsp;therefore&nbsp;may&nbsp;only&nbsp;be&nbsp;selected&nbsp;when&nbsp;the&nbsp;server&#39;s</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4434308">//&nbsp;certificate&nbsp;is&nbsp;ECDSA.&nbsp;If&nbsp;this&nbsp;is&nbsp;not&nbsp;set&nbsp;then&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4434378">//&nbsp;RSA&nbsp;based.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4434393">suiteECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4434405">//&nbsp;suiteTLS12&nbsp;indicates&nbsp;that&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;should&nbsp;only&nbsp;be&nbsp;advertised</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4434478">//&nbsp;and&nbsp;accepted&nbsp;when&nbsp;using&nbsp;TLS&nbsp;1.2.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4434515">suiteTLS12</span><br>
<span class="lineno"></span><span class="op" id="4434526">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4434529">//&nbsp;A&nbsp;cipherSuite&nbsp;is&nbsp;a&nbsp;specific&nbsp;combination&nbsp;of&nbsp;key&nbsp;agreement,&nbsp;cipher&nbsp;and&nbsp;MAC</span><br>
<span class="lineno"></span><span class="comment" id="4434605">//&nbsp;function.&nbsp;All&nbsp;cipher&nbsp;suites&nbsp;currently&nbsp;assume&nbsp;RSA&nbsp;key&nbsp;agreement.</span><br>
<span class="lineno">55</span><span class="keyword" id="4434672">type</span>&nbsp;<span class="ident" id="4434677">cipherSuite</span>&nbsp;<span class="keyword" id="4434689">struct</span>&nbsp;<span class="op" id="4434696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4434699">id</span>&nbsp;<span class="builtintype" id="4434702">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4434710">//&nbsp;the&nbsp;lengths,&nbsp;in&nbsp;bytes,&nbsp;of&nbsp;the&nbsp;key&nbsp;material&nbsp;needed&nbsp;for&nbsp;each&nbsp;component.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4434784">keyLen</span>&nbsp;<span class="builtintype" id="4434791">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4434796">macLen</span>&nbsp;<span class="builtintype" id="4434803">int</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4434808">ivLen</span>&nbsp;&nbsp;<span class="builtintype" id="4434815">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4434820">ka</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4434827">func</span><span class="op" id="4434831">(</span><span class="ident" id="4434832">version</span>&nbsp;<span class="builtintype" id="4434840">uint16</span><span class="op" id="4434846">)</span>&nbsp;<span class="ident" id="4434848"><a href="/gostd/crypto/tls/cipher_suites.go.html#4433061">keyAgreement</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4434862">//&nbsp;flags&nbsp;is&nbsp;a&nbsp;bitmask&nbsp;of&nbsp;the&nbsp;suite*&nbsp;values,&nbsp;above.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4434914">flags</span>&nbsp;&nbsp;<span class="builtintype" id="4434921">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4434926">cipher</span>&nbsp;<span class="keyword" id="4434933">func</span><span class="op" id="4434937">(</span><span class="ident" id="4434938">key</span><span class="op" id="4434941">,</span>&nbsp;<span class="ident" id="4434943">iv</span>&nbsp;<span class="op" id="4434946">[</span><span class="op" id="4434947">]</span><span class="builtintype" id="4434948">byte</span><span class="op" id="4434952">,</span>&nbsp;<span class="ident" id="4434954">isRead</span>&nbsp;<span class="builtintype" id="4434961">bool</span><span class="op" id="4434965">)</span>&nbsp;<span class="keyword" id="4434967">interface</span><span class="op" id="4434976">{</span><span class="op" id="4434977">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4434980">mac</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4434987">func</span><span class="op" id="4434991">(</span><span class="ident" id="4434992">version</span>&nbsp;<span class="builtintype" id="4435000">uint16</span><span class="op" id="4435006">,</span>&nbsp;<span class="ident" id="4435008">macKey</span>&nbsp;<span class="op" id="4435015">[</span><span class="op" id="4435016">]</span><span class="builtintype" id="4435017">byte</span><span class="op" id="4435021">)</span>&nbsp;<span class="ident" id="4435023"><a href="/gostd/crypto/tls/cipher_suites.go.html#4437372">macFunction</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4435036">aead</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="4435043">func</span><span class="op" id="4435047">(</span><span class="ident" id="4435048">key</span><span class="op" id="4435051">,</span>&nbsp;<span class="ident" id="4435053">fixedNonce</span>&nbsp;<span class="op" id="4435064">[</span><span class="op" id="4435065">]</span><span class="builtintype" id="4435066">byte</span><span class="op" id="4435070">)</span>&nbsp;<span class="ident" id="4435072"><a href="/gostd/crypto/tls/cipher_suites.go.html#4432813">cipher</a></span><span class="op" id="4435078">.</span><span class="ident" id="4435079"><a href="/gostd/crypto/cipher/gcm.go.html#4413722">AEAD</a></span><br>
<span class="lineno"></span><span class="op" id="4435084">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4435087">var</span>&nbsp;<span class="ident" id="4435091">cipherSuites</span>&nbsp;<span class="op" id="4435104">=</span>&nbsp;<span class="op" id="4435106">[</span><span class="op" id="4435107">]</span><span class="op" id="4435108">*</span><span class="ident" id="4435109"><a href="/gostd/crypto/tls/cipher_suites.go.html#4434677">cipherSuite</a></span><span class="op" id="4435120">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4435123">//&nbsp;Ciphersuite&nbsp;order&nbsp;is&nbsp;chosen&nbsp;so&nbsp;that&nbsp;ECDHE&nbsp;comes&nbsp;before&nbsp;plain&nbsp;RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4435192">//&nbsp;and&nbsp;RC4&nbsp;comes&nbsp;before&nbsp;AES&nbsp;(because&nbsp;of&nbsp;the&nbsp;Lucky13&nbsp;attack).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4435254">{</span><span class="ident" id="4435255"><a href="/gostd/crypto/tls/cipher_suites.go.html#4441798">TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</a></span><span class="op" id="4435292">,</span>&nbsp;<span class="num" id="4435294">16</span><span class="op" id="4435296">,</span>&nbsp;<span class="num" id="4435298">0</span><span class="op" id="4435299">,</span>&nbsp;<span class="num" id="4435301">4</span><span class="op" id="4435302">,</span>&nbsp;<span class="ident" id="4435304"><a href="/gostd/crypto/tls/cipher_suites.go.html#4440556">ecdheRSAKA</a></span><span class="op" id="4435314">,</span>&nbsp;<span class="ident" id="4435316"><a href="/gostd/crypto/tls/cipher_suites.go.html#4434152">suiteECDHE</a></span>&nbsp;<span class="op" id="4435327">|</span>&nbsp;<span class="ident" id="4435329"><a href="/gostd/crypto/tls/cipher_suites.go.html#4434515">suiteTLS12</a></span><span class="op" id="4435339">,</span>&nbsp;<span class="builtintype" id="4435341">nil</span><span class="op" id="4435344">,</span>&nbsp;<span class="builtintype" id="4435346">nil</span><span class="op" id="4435349">,</span>&nbsp;<span class="ident" id="4435351"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438375">aeadAESGCM</a></span><span class="op" id="4435361">}</span><span class="op" id="4435362">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4435365">{</span><span class="ident" id="4435366"><a href="/gostd/crypto/tls/cipher_suites.go.html#4441855">TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</a></span><span class="op" id="4435405">,</span>&nbsp;<span class="num" id="4435407">16</span><span class="op" id="4435409">,</span>&nbsp;<span class="num" id="4435411">0</span><span class="op" id="4435412">,</span>&nbsp;<span class="num" id="4435414">4</span><span class="op" id="4435415">,</span>&nbsp;<span class="ident" id="4435417"><a href="/gostd/crypto/tls/cipher_suites.go.html#4440426">ecdheECDSAKA</a></span><span class="op" id="4435429">,</span>&nbsp;<span class="ident" id="4435431"><a href="/gostd/crypto/tls/cipher_suites.go.html#4434152">suiteECDHE</a></span>&nbsp;<span class="op" id="4435442">|</span>&nbsp;<span class="ident" id="4435444"><a href="/gostd/crypto/tls/cipher_suites.go.html#4434393">suiteECDSA</a></span>&nbsp;<span class="op" id="4435455">|</span>&nbsp;<span class="ident" id="4435457"><a href="/gostd/crypto/tls/cipher_suites.go.html#4434515">suiteTLS12</a></span><span class="op" id="4435467">,</span>&nbsp;<span class="builtintype" id="4435469">nil</span><span class="op" id="4435472">,</span>&nbsp;<span class="builtintype" id="4435474">nil</span><span class="op" id="4435477">,</span>&nbsp;<span class="ident" id="4435479"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438375">aeadAESGCM</a></span><span class="op" id="4435489">}</span><span class="op" id="4435490">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4435493">{</span><span class="ident" id="4435494"><a href="/gostd/crypto/tls/cipher_suites.go.html#4441570">TLS_ECDHE_RSA_WITH_RC4_128_SHA</a></span><span class="op" id="4435524">,</span>&nbsp;<span class="num" id="4435526">16</span><span class="op" id="4435528">,</span>&nbsp;<span class="num" id="4435530">20</span><span class="op" id="4435532">,</span>&nbsp;<span class="num" id="4435534">0</span><span class="op" id="4435535">,</span>&nbsp;<span class="ident" id="4435537"><a href="/gostd/crypto/tls/cipher_suites.go.html#4440556">ecdheRSAKA</a></span><span class="op" id="4435547">,</span>&nbsp;<span class="ident" id="4435549"><a href="/gostd/crypto/tls/cipher_suites.go.html#4434152">suiteECDHE</a></span><span class="op" id="4435559">,</span>&nbsp;<span class="ident" id="4435561"><a href="/gostd/crypto/tls/cipher_suites.go.html#4436558">cipherRC4</a></span><span class="op" id="4435570">,</span>&nbsp;<span class="ident" id="4435572"><a href="/gostd/crypto/tls/cipher_suites.go.html#4437130">macSHA1</a></span><span class="op" id="4435579">,</span>&nbsp;<span class="builtintype" id="4435581">nil</span><span class="op" id="4435584">}</span><span class="op" id="4435585">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4435588">{</span><span class="ident" id="4435589"><a href="/gostd/crypto/tls/cipher_suites.go.html#4441399">TLS_ECDHE_ECDSA_WITH_RC4_128_SHA</a></span><span class="op" id="4435621">,</span>&nbsp;<span class="num" id="4435623">16</span><span class="op" id="4435625">,</span>&nbsp;<span class="num" id="4435627">20</span><span class="op" id="4435629">,</span>&nbsp;<span class="num" id="4435631">0</span><span class="op" id="4435632">,</span>&nbsp;<span class="ident" id="4435634"><a href="/gostd/crypto/tls/cipher_suites.go.html#4440426">ecdheECDSAKA</a></span><span class="op" id="4435646">,</span>&nbsp;<span class="ident" id="4435648"><a href="/gostd/crypto/tls/cipher_suites.go.html#4434152">suiteECDHE</a></span>&nbsp;<span class="op" id="4435659">|</span>&nbsp;<span class="ident" id="4435661"><a href="/gostd/crypto/tls/cipher_suites.go.html#4434393">suiteECDSA</a></span><span class="op" id="4435671">,</span>&nbsp;<span class="ident" id="4435673"><a href="/gostd/crypto/tls/cipher_suites.go.html#4436558">cipherRC4</a></span><span class="op" id="4435682">,</span>&nbsp;<span class="ident" id="4435684"><a href="/gostd/crypto/tls/cipher_suites.go.html#4437130">macSHA1</a></span><span class="op" id="4435691">,</span>&nbsp;<span class="builtintype" id="4435693">nil</span><span class="op" id="4435696">}</span><span class="op" id="4435697">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4435700">{</span><span class="ident" id="4435701"><a href="/gostd/crypto/tls/cipher_suites.go.html#4441684">TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA</a></span><span class="op" id="4435735">,</span>&nbsp;<span class="num" id="4435737">16</span><span class="op" id="4435739">,</span>&nbsp;<span class="num" id="4435741">20</span><span class="op" id="4435743">,</span>&nbsp;<span class="num" id="4435745">16</span><span class="op" id="4435747">,</span>&nbsp;<span class="ident" id="4435749"><a href="/gostd/crypto/tls/cipher_suites.go.html#4440556">ecdheRSAKA</a></span><span class="op" id="4435759">,</span>&nbsp;<span class="ident" id="4435761"><a href="/gostd/crypto/tls/cipher_suites.go.html#4434152">suiteECDHE</a></span><span class="op" id="4435771">,</span>&nbsp;<span class="ident" id="4435773"><a href="/gostd/crypto/tls/cipher_suites.go.html#4436871">cipherAES</a></span><span class="op" id="4435782">,</span>&nbsp;<span class="ident" id="4435784"><a href="/gostd/crypto/tls/cipher_suites.go.html#4437130">macSHA1</a></span><span class="op" id="4435791">,</span>&nbsp;<span class="builtintype" id="4435793">nil</span><span class="op" id="4435796">}</span><span class="op" id="4435797">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4435800">{</span><span class="ident" id="4435801"><a href="/gostd/crypto/tls/cipher_suites.go.html#4441456">TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA</a></span><span class="op" id="4435837">,</span>&nbsp;<span class="num" id="4435839">16</span><span class="op" id="4435841">,</span>&nbsp;<span class="num" id="4435843">20</span><span class="op" id="4435845">,</span>&nbsp;<span class="num" id="4435847">16</span><span class="op" id="4435849">,</span>&nbsp;<span class="ident" id="4435851"><a href="/gostd/crypto/tls/cipher_suites.go.html#4440426">ecdheECDSAKA</a></span><span class="op" id="4435863">,</span>&nbsp;<span class="ident" id="4435865"><a href="/gostd/crypto/tls/cipher_suites.go.html#4434152">suiteECDHE</a></span>&nbsp;<span class="op" id="4435876">|</span>&nbsp;<span class="ident" id="4435878"><a href="/gostd/crypto/tls/cipher_suites.go.html#4434393">suiteECDSA</a></span><span class="op" id="4435888">,</span>&nbsp;<span class="ident" id="4435890"><a href="/gostd/crypto/tls/cipher_suites.go.html#4436871">cipherAES</a></span><span class="op" id="4435899">,</span>&nbsp;<span class="ident" id="4435901"><a href="/gostd/crypto/tls/cipher_suites.go.html#4437130">macSHA1</a></span><span class="op" id="4435908">,</span>&nbsp;<span class="builtintype" id="4435910">nil</span><span class="op" id="4435913">}</span><span class="op" id="4435914">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4435917">{</span><span class="ident" id="4435918"><a href="/gostd/crypto/tls/cipher_suites.go.html#4441741">TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA</a></span><span class="op" id="4435952">,</span>&nbsp;<span class="num" id="4435954">32</span><span class="op" id="4435956">,</span>&nbsp;<span class="num" id="4435958">20</span><span class="op" id="4435960">,</span>&nbsp;<span class="num" id="4435962">16</span><span class="op" id="4435964">,</span>&nbsp;<span class="ident" id="4435966"><a href="/gostd/crypto/tls/cipher_suites.go.html#4440556">ecdheRSAKA</a></span><span class="op" id="4435976">,</span>&nbsp;<span class="ident" id="4435978"><a href="/gostd/crypto/tls/cipher_suites.go.html#4434152">suiteECDHE</a></span><span class="op" id="4435988">,</span>&nbsp;<span class="ident" id="4435990"><a href="/gostd/crypto/tls/cipher_suites.go.html#4436871">cipherAES</a></span><span class="op" id="4435999">,</span>&nbsp;<span class="ident" id="4436001"><a href="/gostd/crypto/tls/cipher_suites.go.html#4437130">macSHA1</a></span><span class="op" id="4436008">,</span>&nbsp;<span class="builtintype" id="4436010">nil</span><span class="op" id="4436013">}</span><span class="op" id="4436014">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4436017">{</span><span class="ident" id="4436018"><a href="/gostd/crypto/tls/cipher_suites.go.html#4441513">TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA</a></span><span class="op" id="4436054">,</span>&nbsp;<span class="num" id="4436056">32</span><span class="op" id="4436058">,</span>&nbsp;<span class="num" id="4436060">20</span><span class="op" id="4436062">,</span>&nbsp;<span class="num" id="4436064">16</span><span class="op" id="4436066">,</span>&nbsp;<span class="ident" id="4436068"><a href="/gostd/crypto/tls/cipher_suites.go.html#4440426">ecdheECDSAKA</a></span><span class="op" id="4436080">,</span>&nbsp;<span class="ident" id="4436082"><a href="/gostd/crypto/tls/cipher_suites.go.html#4434152">suiteECDHE</a></span>&nbsp;<span class="op" id="4436093">|</span>&nbsp;<span class="ident" id="4436095"><a href="/gostd/crypto/tls/cipher_suites.go.html#4434393">suiteECDSA</a></span><span class="op" id="4436105">,</span>&nbsp;<span class="ident" id="4436107"><a href="/gostd/crypto/tls/cipher_suites.go.html#4436871">cipherAES</a></span><span class="op" id="4436116">,</span>&nbsp;<span class="ident" id="4436118"><a href="/gostd/crypto/tls/cipher_suites.go.html#4437130">macSHA1</a></span><span class="op" id="4436125">,</span>&nbsp;<span class="builtintype" id="4436127">nil</span><span class="op" id="4436130">}</span><span class="op" id="4436131">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4436134">{</span><span class="ident" id="4436135"><a href="/gostd/crypto/tls/cipher_suites.go.html#4441171">TLS_RSA_WITH_RC4_128_SHA</a></span><span class="op" id="4436159">,</span>&nbsp;<span class="num" id="4436161">16</span><span class="op" id="4436163">,</span>&nbsp;<span class="num" id="4436165">20</span><span class="op" id="4436167">,</span>&nbsp;<span class="num" id="4436169">0</span><span class="op" id="4436170">,</span>&nbsp;<span class="ident" id="4436172"><a href="/gostd/crypto/tls/cipher_suites.go.html#4440355">rsaKA</a></span><span class="op" id="4436177">,</span>&nbsp;<span class="num" id="4436179">0</span><span class="op" id="4436180">,</span>&nbsp;<span class="ident" id="4436182"><a href="/gostd/crypto/tls/cipher_suites.go.html#4436558">cipherRC4</a></span><span class="op" id="4436191">,</span>&nbsp;<span class="ident" id="4436193"><a href="/gostd/crypto/tls/cipher_suites.go.html#4437130">macSHA1</a></span><span class="op" id="4436200">,</span>&nbsp;<span class="builtintype" id="4436202">nil</span><span class="op" id="4436205">}</span><span class="op" id="4436206">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4436209">{</span><span class="ident" id="4436210"><a href="/gostd/crypto/tls/cipher_suites.go.html#4441285">TLS_RSA_WITH_AES_128_CBC_SHA</a></span><span class="op" id="4436238">,</span>&nbsp;<span class="num" id="4436240">16</span><span class="op" id="4436242">,</span>&nbsp;<span class="num" id="4436244">20</span><span class="op" id="4436246">,</span>&nbsp;<span class="num" id="4436248">16</span><span class="op" id="4436250">,</span>&nbsp;<span class="ident" id="4436252"><a href="/gostd/crypto/tls/cipher_suites.go.html#4440355">rsaKA</a></span><span class="op" id="4436257">,</span>&nbsp;<span class="num" id="4436259">0</span><span class="op" id="4436260">,</span>&nbsp;<span class="ident" id="4436262"><a href="/gostd/crypto/tls/cipher_suites.go.html#4436871">cipherAES</a></span><span class="op" id="4436271">,</span>&nbsp;<span class="ident" id="4436273"><a href="/gostd/crypto/tls/cipher_suites.go.html#4437130">macSHA1</a></span><span class="op" id="4436280">,</span>&nbsp;<span class="builtintype" id="4436282">nil</span><span class="op" id="4436285">}</span><span class="op" id="4436286">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4436289">{</span><span class="ident" id="4436290"><a href="/gostd/crypto/tls/cipher_suites.go.html#4441342">TLS_RSA_WITH_AES_256_CBC_SHA</a></span><span class="op" id="4436318">,</span>&nbsp;<span class="num" id="4436320">32</span><span class="op" id="4436322">,</span>&nbsp;<span class="num" id="4436324">20</span><span class="op" id="4436326">,</span>&nbsp;<span class="num" id="4436328">16</span><span class="op" id="4436330">,</span>&nbsp;<span class="ident" id="4436332"><a href="/gostd/crypto/tls/cipher_suites.go.html#4440355">rsaKA</a></span><span class="op" id="4436337">,</span>&nbsp;<span class="num" id="4436339">0</span><span class="op" id="4436340">,</span>&nbsp;<span class="ident" id="4436342"><a href="/gostd/crypto/tls/cipher_suites.go.html#4436871">cipherAES</a></span><span class="op" id="4436351">,</span>&nbsp;<span class="ident" id="4436353"><a href="/gostd/crypto/tls/cipher_suites.go.html#4437130">macSHA1</a></span><span class="op" id="4436360">,</span>&nbsp;<span class="builtintype" id="4436362">nil</span><span class="op" id="4436365">}</span><span class="op" id="4436366">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4436369">{</span><span class="ident" id="4436370"><a href="/gostd/crypto/tls/cipher_suites.go.html#4441627">TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA</a></span><span class="op" id="4436405">,</span>&nbsp;<span class="num" id="4436407">24</span><span class="op" id="4436409">,</span>&nbsp;<span class="num" id="4436411">20</span><span class="op" id="4436413">,</span>&nbsp;<span class="num" id="4436415">8</span><span class="op" id="4436416">,</span>&nbsp;<span class="ident" id="4436418"><a href="/gostd/crypto/tls/cipher_suites.go.html#4440556">ecdheRSAKA</a></span><span class="op" id="4436428">,</span>&nbsp;<span class="ident" id="4436430"><a href="/gostd/crypto/tls/cipher_suites.go.html#4434152">suiteECDHE</a></span><span class="op" id="4436440">,</span>&nbsp;<span class="ident" id="4436442"><a href="/gostd/crypto/tls/cipher_suites.go.html#4436667">cipher3DES</a></span><span class="op" id="4436452">,</span>&nbsp;<span class="ident" id="4436454"><a href="/gostd/crypto/tls/cipher_suites.go.html#4437130">macSHA1</a></span><span class="op" id="4436461">,</span>&nbsp;<span class="builtintype" id="4436463">nil</span><span class="op" id="4436466">}</span><span class="op" id="4436467">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4436470">{</span><span class="ident" id="4436471"><a href="/gostd/crypto/tls/cipher_suites.go.html#4441228">TLS_RSA_WITH_3DES_EDE_CBC_SHA</a></span><span class="op" id="4436500">,</span>&nbsp;<span class="num" id="4436502">24</span><span class="op" id="4436504">,</span>&nbsp;<span class="num" id="4436506">20</span><span class="op" id="4436508">,</span>&nbsp;<span class="num" id="4436510">8</span><span class="op" id="4436511">,</span>&nbsp;<span class="ident" id="4436513"><a href="/gostd/crypto/tls/cipher_suites.go.html#4440355">rsaKA</a></span><span class="op" id="4436518">,</span>&nbsp;<span class="num" id="4436520">0</span><span class="op" id="4436521">,</span>&nbsp;<span class="ident" id="4436523"><a href="/gostd/crypto/tls/cipher_suites.go.html#4436667">cipher3DES</a></span><span class="op" id="4436533">,</span>&nbsp;<span class="ident" id="4436535"><a href="/gostd/crypto/tls/cipher_suites.go.html#4437130">macSHA1</a></span><span class="op" id="4436542">,</span>&nbsp;<span class="builtintype" id="4436544">nil</span><span class="op" id="4436547">}</span><span class="op" id="4436548">,</span><br>
<span class="lineno">85</span><span class="op" id="4436550">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4436553">func</span>&nbsp;<span class="ident" id="4436558">cipherRC4</span><span class="op" id="4436567">(</span><span class="ident" id="4436568">key</span><span class="op" id="4436571">,</span>&nbsp;<span class="ident" id="4436573">iv</span>&nbsp;<span class="op" id="4436576">[</span><span class="op" id="4436577">]</span><span class="builtintype" id="4436578">byte</span><span class="op" id="4436582">,</span>&nbsp;<span class="ident" id="4436584">isRead</span>&nbsp;<span class="builtintype" id="4436591">bool</span><span class="op" id="4436595">)</span>&nbsp;<span class="keyword" id="4436597">interface</span><span class="op" id="4436606">{</span><span class="op" id="4436607">}</span>&nbsp;<span class="op" id="4436609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4436612">cipher</span><span class="op" id="4436618">,</span>&nbsp;<span class="ident" id="4436620">_</span>&nbsp;<span class="op" id="4436622">:=</span>&nbsp;<span class="ident" id="4436625"><a href="/gostd/crypto/tls/cipher_suites.go.html#4432859">rc4</a></span><span class="op" id="4436628">.</span><span class="ident" id="4436629"><a href="/gostd/crypto/rc4/rc4.go.html#4606644">NewCipher</a></span><span class="op" id="4436638">(</span><span class="ident" id="4436639"><a href="/gostd/crypto/tls/cipher_suites.go.html#4436568">key</a></span><span class="op" id="4436642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4436645">return</span>&nbsp;<span class="ident" id="4436652"><a href="/gostd/crypto/tls/cipher_suites.go.html#4436612">cipher</a></span><br>
<span class="lineno">90</span><span class="op" id="4436659">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4436662">func</span>&nbsp;<span class="ident" id="4436667">cipher3DES</span><span class="op" id="4436677">(</span><span class="ident" id="4436678">key</span><span class="op" id="4436681">,</span>&nbsp;<span class="ident" id="4436683">iv</span>&nbsp;<span class="op" id="4436686">[</span><span class="op" id="4436687">]</span><span class="builtintype" id="4436688">byte</span><span class="op" id="4436692">,</span>&nbsp;<span class="ident" id="4436694">isRead</span>&nbsp;<span class="builtintype" id="4436701">bool</span><span class="op" id="4436705">)</span>&nbsp;<span class="keyword" id="4436707">interface</span><span class="op" id="4436716">{</span><span class="op" id="4436717">}</span>&nbsp;<span class="op" id="4436719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4436722">block</span><span class="op" id="4436727">,</span>&nbsp;<span class="ident" id="4436729">_</span>&nbsp;<span class="op" id="4436731">:=</span>&nbsp;<span class="ident" id="4436734"><a href="/gostd/crypto/tls/cipher_suites.go.html#4432830">des</a></span><span class="op" id="4436737">.</span><span class="ident" id="4436738"><a href="/gostd/crypto/des/cipher.go.html#4597979">NewTripleDESCipher</a></span><span class="op" id="4436756">(</span><span class="ident" id="4436757"><a href="/gostd/crypto/tls/cipher_suites.go.html#4436678">key</a></span><span class="op" id="4436760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4436763">if</span>&nbsp;<span class="ident" id="4436766"><a href="/gostd/crypto/tls/cipher_suites.go.html#4436694">isRead</a></span>&nbsp;<span class="op" id="4436773">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4436777">return</span>&nbsp;<span class="ident" id="4436784"><a href="/gostd/crypto/tls/cipher_suites.go.html#4432813">cipher</a></span><span class="op" id="4436790">.</span><span class="ident" id="4436791"><a href="/gostd/crypto/cipher/cbc.go.html#4406839">NewCBCDecrypter</a></span><span class="op" id="4436806">(</span><span class="ident" id="4436807"><a href="/gostd/crypto/tls/cipher_suites.go.html#4436722">block</a></span><span class="op" id="4436812">,</span>&nbsp;<span class="ident" id="4436814"><a href="/gostd/crypto/tls/cipher_suites.go.html#4436683">iv</a></span><span class="op" id="4436816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4436819">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4436822">return</span>&nbsp;<span class="ident" id="4436829"><a href="/gostd/crypto/tls/cipher_suites.go.html#4432813">cipher</a></span><span class="op" id="4436835">.</span><span class="ident" id="4436836"><a href="/gostd/crypto/cipher/cbc.go.html#4405590">NewCBCEncrypter</a></span><span class="op" id="4436851">(</span><span class="ident" id="4436852"><a href="/gostd/crypto/tls/cipher_suites.go.html#4436722">block</a></span><span class="op" id="4436857">,</span>&nbsp;<span class="ident" id="4436859"><a href="/gostd/crypto/tls/cipher_suites.go.html#4436683">iv</a></span><span class="op" id="4436861">)</span><br>
<span class="lineno"></span><span class="op" id="4436863">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="4436866">func</span>&nbsp;<span class="ident" id="4436871">cipherAES</span><span class="op" id="4436880">(</span><span class="ident" id="4436881">key</span><span class="op" id="4436884">,</span>&nbsp;<span class="ident" id="4436886">iv</span>&nbsp;<span class="op" id="4436889">[</span><span class="op" id="4436890">]</span><span class="builtintype" id="4436891">byte</span><span class="op" id="4436895">,</span>&nbsp;<span class="ident" id="4436897">isRead</span>&nbsp;<span class="builtintype" id="4436904">bool</span><span class="op" id="4436908">)</span>&nbsp;<span class="keyword" id="4436910">interface</span><span class="op" id="4436919">{</span><span class="op" id="4436920">}</span>&nbsp;<span class="op" id="4436922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4436925">block</span><span class="op" id="4436930">,</span>&nbsp;<span class="ident" id="4436932">_</span>&nbsp;<span class="op" id="4436934">:=</span>&nbsp;<span class="ident" id="4436937"><a href="/gostd/crypto/tls/cipher_suites.go.html#4432799">aes</a></span><span class="op" id="4436940">.</span><span class="ident" id="4436941"><a href="/gostd/crypto/aes/cipher.go.html#4373344">NewCipher</a></span><span class="op" id="4436950">(</span><span class="ident" id="4436951"><a href="/gostd/crypto/tls/cipher_suites.go.html#4436881">key</a></span><span class="op" id="4436954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4436957">if</span>&nbsp;<span class="ident" id="4436960"><a href="/gostd/crypto/tls/cipher_suites.go.html#4436897">isRead</a></span>&nbsp;<span class="op" id="4436967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4436971">return</span>&nbsp;<span class="ident" id="4436978"><a href="/gostd/crypto/tls/cipher_suites.go.html#4432813">cipher</a></span><span class="op" id="4436984">.</span><span class="ident" id="4436985"><a href="/gostd/crypto/cipher/cbc.go.html#4406839">NewCBCDecrypter</a></span><span class="op" id="4437000">(</span><span class="ident" id="4437001"><a href="/gostd/crypto/tls/cipher_suites.go.html#4436925">block</a></span><span class="op" id="4437006">,</span>&nbsp;<span class="ident" id="4437008"><a href="/gostd/crypto/tls/cipher_suites.go.html#4436886">iv</a></span><span class="op" id="4437010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4437013">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4437016">return</span>&nbsp;<span class="ident" id="4437023"><a href="/gostd/crypto/tls/cipher_suites.go.html#4432813">cipher</a></span><span class="op" id="4437029">.</span><span class="ident" id="4437030"><a href="/gostd/crypto/cipher/cbc.go.html#4405590">NewCBCEncrypter</a></span><span class="op" id="4437045">(</span><span class="ident" id="4437046"><a href="/gostd/crypto/tls/cipher_suites.go.html#4436925">block</a></span><span class="op" id="4437051">,</span>&nbsp;<span class="ident" id="4437053"><a href="/gostd/crypto/tls/cipher_suites.go.html#4436886">iv</a></span><span class="op" id="4437055">)</span><br>
<span class="lineno"></span><span class="op" id="4437057">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4437060">//&nbsp;macSHA1&nbsp;returns&nbsp;a&nbsp;macFunction&nbsp;for&nbsp;the&nbsp;given&nbsp;protocol&nbsp;version.</span><br>
<span class="lineno"></span><span class="keyword" id="4437125">func</span>&nbsp;<span class="ident" id="4437130">macSHA1</span><span class="op" id="4437137">(</span><span class="ident" id="4437138">version</span>&nbsp;<span class="builtintype" id="4437146">uint16</span><span class="op" id="4437152">,</span>&nbsp;<span class="ident" id="4437154">key</span>&nbsp;<span class="op" id="4437158">[</span><span class="op" id="4437159">]</span><span class="builtintype" id="4437160">byte</span><span class="op" id="4437164">)</span>&nbsp;<span class="ident" id="4437166"><a href="/gostd/crypto/tls/cipher_suites.go.html#4437372">macFunction</a></span>&nbsp;<span class="op" id="4437178">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4437181">if</span>&nbsp;<span class="ident" id="4437184"><a href="/gostd/crypto/tls/cipher_suites.go.html#4437138">version</a></span>&nbsp;<span class="op" id="4437192">==</span>&nbsp;<span class="ident" id="4437195"><a href="/gostd/crypto/tls/common.go.html#4442440">VersionSSL30</a></span>&nbsp;<span class="op" id="4437208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4437212">mac</span>&nbsp;<span class="op" id="4437216">:=</span>&nbsp;<span class="ident" id="4437219"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438856">ssl30MAC</a></span><span class="op" id="4437227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4437232"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438875">h</a></span><span class="op" id="4437233">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4437237"><a href="/gostd/crypto/tls/cipher_suites.go.html#4432873">sha1</a></span><span class="op" id="4437241">.</span><span class="ident" id="4437242"><a href="/gostd/crypto/sha1/sha1.go.html#4609140">New</a></span><span class="op" id="4437245">(</span><span class="op" id="4437246">)</span><span class="op" id="4437247">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4437252"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438890">key</a></span><span class="op" id="4437255">:</span>&nbsp;<span class="builtinfunc" id="4437257">make</span><span class="op" id="4437261">(</span><span class="op" id="4437262">[</span><span class="op" id="4437263">]</span><span class="builtintype" id="4437264">byte</span><span class="op" id="4437268">,</span>&nbsp;<span class="builtinfunc" id="4437270">len</span><span class="op" id="4437273">(</span><span class="ident" id="4437274"><a href="/gostd/crypto/tls/cipher_suites.go.html#4437154">key</a></span><span class="op" id="4437277">)</span><span class="op" id="4437278">)</span><span class="op" id="4437279">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4437283">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4437287">copy</span><span class="op" id="4437291">(</span><span class="ident" id="4437292"><a href="/gostd/crypto/tls/cipher_suites.go.html#4437212">mac</a></span><span class="op" id="4437295">.</span><span class="ident" id="4437296"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438890">key</a></span><span class="op" id="4437299">,</span>&nbsp;<span class="ident" id="4437301"><a href="/gostd/crypto/tls/cipher_suites.go.html#4437154">key</a></span><span class="op" id="4437304">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4437308">return</span>&nbsp;<span class="ident" id="4437315"><a href="/gostd/crypto/tls/cipher_suites.go.html#4437212">mac</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4437320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4437323">return</span>&nbsp;<span class="ident" id="4437330"><a href="/gostd/crypto/tls/cipher_suites.go.html#4440096">tls10MAC</a></span><span class="op" id="4437338">{</span><span class="ident" id="4437339"><a href="/gostd/crypto/tls/cipher_suites.go.html#4432844">hmac</a></span><span class="op" id="4437343">.</span><span class="ident" id="4437344"><a href="/gostd/crypto/hmac/hmac.go.html#4605122">New</a></span><span class="op" id="4437347">(</span><span class="ident" id="4437348"><a href="/gostd/crypto/tls/cipher_suites.go.html#4432873">sha1</a></span><span class="op" id="4437352">.</span><span class="ident" id="4437353"><a href="/gostd/crypto/sha1/sha1.go.html#4609140">New</a></span><span class="op" id="4437356">,</span>&nbsp;<span class="ident" id="4437358"><a href="/gostd/crypto/tls/cipher_suites.go.html#4437154">key</a></span><span class="op" id="4437361">)</span><span class="op" id="4437362">}</span><br>
<span class="lineno"></span><span class="op" id="4437364">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="4437367">type</span>&nbsp;<span class="ident" id="4437372">macFunction</span>&nbsp;<span class="keyword" id="4437384">interface</span>&nbsp;<span class="op" id="4437394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4437397">Size</span><span class="op" id="4437401">(</span><span class="op" id="4437402">)</span>&nbsp;<span class="builtintype" id="4437404">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4437409">MAC</span><span class="op" id="4437412">(</span><span class="ident" id="4437413">digestBuf</span><span class="op" id="4437422">,</span>&nbsp;<span class="ident" id="4437424">seq</span><span class="op" id="4437427">,</span>&nbsp;<span class="ident" id="4437429">header</span><span class="op" id="4437435">,</span>&nbsp;<span class="ident" id="4437437">data</span>&nbsp;<span class="op" id="4437442">[</span><span class="op" id="4437443">]</span><span class="builtintype" id="4437444">byte</span><span class="op" id="4437448">)</span>&nbsp;<span class="op" id="4437450">[</span><span class="op" id="4437451">]</span><span class="builtintype" id="4437452">byte</span><br>
<span class="lineno"></span><span class="op" id="4437457">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="4437460">//&nbsp;fixedNonceAEAD&nbsp;wraps&nbsp;an&nbsp;AEAD&nbsp;and&nbsp;prefixes&nbsp;a&nbsp;fixed&nbsp;portion&nbsp;of&nbsp;the&nbsp;nonce&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="4437537">//&nbsp;each&nbsp;call.</span><br>
<span class="lineno"></span><span class="keyword" id="4437551">type</span>&nbsp;<span class="ident" id="4437556">fixedNonceAEAD</span>&nbsp;<span class="keyword" id="4437571">struct</span>&nbsp;<span class="op" id="4437578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4437581">//&nbsp;sealNonce&nbsp;and&nbsp;openNonce&nbsp;are&nbsp;buffers&nbsp;where&nbsp;the&nbsp;larger&nbsp;nonce&nbsp;will&nbsp;be</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4437652">//&nbsp;constructed.&nbsp;Since&nbsp;a&nbsp;seal&nbsp;and&nbsp;open&nbsp;operation&nbsp;may&nbsp;be&nbsp;running</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4437716">//&nbsp;concurrently,&nbsp;there&nbsp;is&nbsp;a&nbsp;separate&nbsp;buffer&nbsp;for&nbsp;each.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4437771">sealNonce</span><span class="op" id="4437780">,</span>&nbsp;<span class="ident" id="4437782">openNonce</span>&nbsp;<span class="op" id="4437792">[</span><span class="op" id="4437793">]</span><span class="builtintype" id="4437794">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4437800">aead</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4437821"><a href="/gostd/crypto/tls/cipher_suites.go.html#4432813">cipher</a></span><span class="op" id="4437827">.</span><span class="ident" id="4437828"><a href="/gostd/crypto/cipher/gcm.go.html#4413722">AEAD</a></span><br>
<span class="lineno"></span><span class="op" id="4437833">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="keyword" id="4437836">func</span>&nbsp;<span class="op" id="4437841">(</span><span class="ident" id="4437842">f</span>&nbsp;<span class="op" id="4437844">*</span><span class="ident" id="4437845"><a href="/gostd/crypto/tls/cipher_suites.go.html#4437556">fixedNonceAEAD</a></span><span class="op" id="4437859">)</span>&nbsp;<span class="ident" id="4437861">NonceSize</span><span class="op" id="4437870">(</span><span class="op" id="4437871">)</span>&nbsp;<span class="builtintype" id="4437873">int</span>&nbsp;<span class="op" id="4437877">{</span>&nbsp;<span class="keyword" id="4437879">return</span>&nbsp;<span class="num" id="4437886">8</span>&nbsp;<span class="op" id="4437888">}</span><br>
<span class="lineno"></span><span class="keyword" id="4437890">func</span>&nbsp;<span class="op" id="4437895">(</span><span class="ident" id="4437896">f</span>&nbsp;<span class="op" id="4437898">*</span><span class="ident" id="4437899"><a href="/gostd/crypto/tls/cipher_suites.go.html#4437556">fixedNonceAEAD</a></span><span class="op" id="4437913">)</span>&nbsp;<span class="ident" id="4437915">Overhead</span><span class="op" id="4437923">(</span><span class="op" id="4437924">)</span>&nbsp;<span class="builtintype" id="4437926">int</span>&nbsp;&nbsp;<span class="op" id="4437931">{</span>&nbsp;<span class="keyword" id="4437933">return</span>&nbsp;<span class="ident" id="4437940"><a href="/gostd/crypto/tls/cipher_suites.go.html#4437896">f</a></span><span class="op" id="4437941">.</span><span class="ident" id="4437942"><a href="/gostd/crypto/tls/cipher_suites.go.html#4437800">aead</a></span><span class="op" id="4437946">.</span><span class="ident" id="4437947"><a href="/gostd/crypto/cipher/gcm.go.html#4413943">Overhead</a></span><span class="op" id="4437955">(</span><span class="op" id="4437956">)</span>&nbsp;<span class="op" id="4437958">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4437961">func</span>&nbsp;<span class="op" id="4437966">(</span><span class="ident" id="4437967">f</span>&nbsp;<span class="op" id="4437969">*</span><span class="ident" id="4437970"><a href="/gostd/crypto/tls/cipher_suites.go.html#4437556">fixedNonceAEAD</a></span><span class="op" id="4437984">)</span>&nbsp;<span class="ident" id="4437986">Seal</span><span class="op" id="4437990">(</span><span class="ident" id="4437991">out</span><span class="op" id="4437994">,</span>&nbsp;<span class="ident" id="4437996">nonce</span><span class="op" id="4438001">,</span>&nbsp;<span class="ident" id="4438003">plaintext</span><span class="op" id="4438012">,</span>&nbsp;<span class="ident" id="4438014">additionalData</span>&nbsp;<span class="op" id="4438029">[</span><span class="op" id="4438030">]</span><span class="builtintype" id="4438031">byte</span><span class="op" id="4438035">)</span>&nbsp;<span class="op" id="4438037">[</span><span class="op" id="4438038">]</span><span class="builtintype" id="4438039">byte</span>&nbsp;<span class="op" id="4438044">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4438047">copy</span><span class="op" id="4438051">(</span><span class="ident" id="4438052"><a href="/gostd/crypto/tls/cipher_suites.go.html#4437967">f</a></span><span class="op" id="4438053">.</span><span class="ident" id="4438054"><a href="/gostd/crypto/tls/cipher_suites.go.html#4437771">sealNonce</a></span><span class="op" id="4438063">[</span><span class="builtinfunc" id="4438064">len</span><span class="op" id="4438067">(</span><span class="ident" id="4438068"><a href="/gostd/crypto/tls/cipher_suites.go.html#4437967">f</a></span><span class="op" id="4438069">.</span><span class="ident" id="4438070"><a href="/gostd/crypto/tls/cipher_suites.go.html#4437771">sealNonce</a></span><span class="op" id="4438079">)</span><span class="op" id="4438080">-</span><span class="num" id="4438081">8</span><span class="op" id="4438082">:</span><span class="op" id="4438083">]</span><span class="op" id="4438084">,</span>&nbsp;<span class="ident" id="4438086"><a href="/gostd/crypto/tls/cipher_suites.go.html#4437996">nonce</a></span><span class="op" id="4438091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4438094">return</span>&nbsp;<span class="ident" id="4438101"><a href="/gostd/crypto/tls/cipher_suites.go.html#4437967">f</a></span><span class="op" id="4438102">.</span><span class="ident" id="4438103"><a href="/gostd/crypto/tls/cipher_suites.go.html#4437800">aead</a></span><span class="op" id="4438107">.</span><span class="ident" id="4438108"><a href="/gostd/crypto/cipher/gcm.go.html#4414259">Seal</a></span><span class="op" id="4438112">(</span><span class="ident" id="4438113"><a href="/gostd/crypto/tls/cipher_suites.go.html#4437991">out</a></span><span class="op" id="4438116">,</span>&nbsp;<span class="ident" id="4438118"><a href="/gostd/crypto/tls/cipher_suites.go.html#4437967">f</a></span><span class="op" id="4438119">.</span><span class="ident" id="4438120"><a href="/gostd/crypto/tls/cipher_suites.go.html#4437771">sealNonce</a></span><span class="op" id="4438129">,</span>&nbsp;<span class="ident" id="4438131"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438003">plaintext</a></span><span class="op" id="4438140">,</span>&nbsp;<span class="ident" id="4438142"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438014">additionalData</a></span><span class="op" id="4438156">)</span><br>
<span class="lineno"></span><span class="op" id="4438158">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4438161">func</span>&nbsp;<span class="op" id="4438166">(</span><span class="ident" id="4438167">f</span>&nbsp;<span class="op" id="4438169">*</span><span class="ident" id="4438170"><a href="/gostd/crypto/tls/cipher_suites.go.html#4437556">fixedNonceAEAD</a></span><span class="op" id="4438184">)</span>&nbsp;<span class="ident" id="4438186">Open</span><span class="op" id="4438190">(</span><span class="ident" id="4438191">out</span><span class="op" id="4438194">,</span>&nbsp;<span class="ident" id="4438196">nonce</span><span class="op" id="4438201">,</span>&nbsp;<span class="ident" id="4438203">plaintext</span><span class="op" id="4438212">,</span>&nbsp;<span class="ident" id="4438214">additionalData</span>&nbsp;<span class="op" id="4438229">[</span><span class="op" id="4438230">]</span><span class="builtintype" id="4438231">byte</span><span class="op" id="4438235">)</span>&nbsp;<span class="op" id="4438237">(</span><span class="op" id="4438238">[</span><span class="op" id="4438239">]</span><span class="builtintype" id="4438240">byte</span><span class="op" id="4438244">,</span>&nbsp;<span class="builtintype" id="4438246">error</span><span class="op" id="4438251">)</span>&nbsp;<span class="op" id="4438253">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4438256">copy</span><span class="op" id="4438260">(</span><span class="ident" id="4438261"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438167">f</a></span><span class="op" id="4438262">.</span><span class="ident" id="4438263"><a href="/gostd/crypto/tls/cipher_suites.go.html#4437782">openNonce</a></span><span class="op" id="4438272">[</span><span class="builtinfunc" id="4438273">len</span><span class="op" id="4438276">(</span><span class="ident" id="4438277"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438167">f</a></span><span class="op" id="4438278">.</span><span class="ident" id="4438279"><a href="/gostd/crypto/tls/cipher_suites.go.html#4437782">openNonce</a></span><span class="op" id="4438288">)</span><span class="op" id="4438289">-</span><span class="num" id="4438290">8</span><span class="op" id="4438291">:</span><span class="op" id="4438292">]</span><span class="op" id="4438293">,</span>&nbsp;<span class="ident" id="4438295"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438196">nonce</a></span><span class="op" id="4438300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4438303">return</span>&nbsp;<span class="ident" id="4438310"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438167">f</a></span><span class="op" id="4438311">.</span><span class="ident" id="4438312"><a href="/gostd/crypto/tls/cipher_suites.go.html#4437800">aead</a></span><span class="op" id="4438316">.</span><span class="ident" id="4438317"><a href="/gostd/crypto/cipher/gcm.go.html#4414674">Open</a></span><span class="op" id="4438321">(</span><span class="ident" id="4438322"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438191">out</a></span><span class="op" id="4438325">,</span>&nbsp;<span class="ident" id="4438327"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438167">f</a></span><span class="op" id="4438328">.</span><span class="ident" id="4438329"><a href="/gostd/crypto/tls/cipher_suites.go.html#4437782">openNonce</a></span><span class="op" id="4438338">,</span>&nbsp;<span class="ident" id="4438340"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438203">plaintext</a></span><span class="op" id="4438349">,</span>&nbsp;<span class="ident" id="4438351"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438214">additionalData</a></span><span class="op" id="4438365">)</span><br>
<span class="lineno"></span><span class="op" id="4438367">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4438370">func</span>&nbsp;<span class="ident" id="4438375">aeadAESGCM</span><span class="op" id="4438385">(</span><span class="ident" id="4438386">key</span><span class="op" id="4438389">,</span>&nbsp;<span class="ident" id="4438391">fixedNonce</span>&nbsp;<span class="op" id="4438402">[</span><span class="op" id="4438403">]</span><span class="builtintype" id="4438404">byte</span><span class="op" id="4438408">)</span>&nbsp;<span class="ident" id="4438410"><a href="/gostd/crypto/tls/cipher_suites.go.html#4432813">cipher</a></span><span class="op" id="4438416">.</span><span class="ident" id="4438417"><a href="/gostd/crypto/cipher/gcm.go.html#4413722">AEAD</a></span>&nbsp;<span class="op" id="4438422">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4438425">aes</span><span class="op" id="4438428">,</span>&nbsp;<span class="ident" id="4438430">err</span>&nbsp;<span class="op" id="4438434">:=</span>&nbsp;<span class="ident" id="4438437"><a href="/gostd/crypto/tls/cipher_suites.go.html#4432799">aes</a></span><span class="op" id="4438440">.</span><span class="ident" id="4438441"><a href="/gostd/crypto/aes/cipher.go.html#4373344">NewCipher</a></span><span class="op" id="4438450">(</span><span class="ident" id="4438451"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438386">key</a></span><span class="op" id="4438454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4438457">if</span>&nbsp;<span class="ident" id="4438460"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438430">err</a></span>&nbsp;<span class="op" id="4438464">!=</span>&nbsp;<span class="builtintype" id="4438467">nil</span>&nbsp;<span class="op" id="4438471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4438475">panic</span><span class="op" id="4438480">(</span><span class="ident" id="4438481"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438430">err</a></span><span class="op" id="4438484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4438487">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4438490">aead</span><span class="op" id="4438494">,</span>&nbsp;<span class="ident" id="4438496"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438430">err</a></span>&nbsp;<span class="op" id="4438500">:=</span>&nbsp;<span class="ident" id="4438503"><a href="/gostd/crypto/tls/cipher_suites.go.html#4432813">cipher</a></span><span class="op" id="4438509">.</span><span class="ident" id="4438510"><a href="/gostd/crypto/cipher/gcm.go.html#4415675">NewGCM</a></span><span class="op" id="4438516">(</span><span class="ident" id="4438517"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438425">aes</a></span><span class="op" id="4438520">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4438523">if</span>&nbsp;<span class="ident" id="4438526"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438430">err</a></span>&nbsp;<span class="op" id="4438530">!=</span>&nbsp;<span class="builtintype" id="4438533">nil</span>&nbsp;<span class="op" id="4438537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4438541">panic</span><span class="op" id="4438546">(</span><span class="ident" id="4438547"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438430">err</a></span><span class="op" id="4438550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4438553">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4438557">nonce1</span><span class="op" id="4438563">,</span>&nbsp;<span class="ident" id="4438565">nonce2</span>&nbsp;<span class="op" id="4438572">:=</span>&nbsp;<span class="builtinfunc" id="4438575">make</span><span class="op" id="4438579">(</span><span class="op" id="4438580">[</span><span class="op" id="4438581">]</span><span class="builtintype" id="4438582">byte</span><span class="op" id="4438586">,</span>&nbsp;<span class="num" id="4438588">12</span><span class="op" id="4438590">)</span><span class="op" id="4438591">,</span>&nbsp;<span class="builtinfunc" id="4438593">make</span><span class="op" id="4438597">(</span><span class="op" id="4438598">[</span><span class="op" id="4438599">]</span><span class="builtintype" id="4438600">byte</span><span class="op" id="4438604">,</span>&nbsp;<span class="num" id="4438606">12</span><span class="op" id="4438608">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4438611">copy</span><span class="op" id="4438615">(</span><span class="ident" id="4438616"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438557">nonce1</a></span><span class="op" id="4438622">,</span>&nbsp;<span class="ident" id="4438624"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438391">fixedNonce</a></span><span class="op" id="4438634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4438637">copy</span><span class="op" id="4438641">(</span><span class="ident" id="4438642"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438565">nonce2</a></span><span class="op" id="4438648">,</span>&nbsp;<span class="ident" id="4438650"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438391">fixedNonce</a></span><span class="op" id="4438660">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4438664">return</span>&nbsp;<span class="op" id="4438671">&amp;</span><span class="ident" id="4438672"><a href="/gostd/crypto/tls/cipher_suites.go.html#4437556">fixedNonceAEAD</a></span><span class="op" id="4438686">{</span><span class="ident" id="4438687"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438557">nonce1</a></span><span class="op" id="4438693">,</span>&nbsp;<span class="ident" id="4438695"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438565">nonce2</a></span><span class="op" id="4438701">,</span>&nbsp;<span class="ident" id="4438703"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438490">aead</a></span><span class="op" id="4438707">}</span><br>
<span class="lineno"></span><span class="op" id="4438709">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="comment" id="4438712">//&nbsp;ssl30MAC&nbsp;implements&nbsp;the&nbsp;SSLv3&nbsp;MAC&nbsp;function,&nbsp;as&nbsp;defined&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4438773">//&nbsp;www.mozilla.org/projects/security/pki/nss/ssl/draft302.txt&nbsp;section&nbsp;5.2.3.1</span><br>
<span class="lineno"></span><span class="keyword" id="4438851">type</span>&nbsp;<span class="ident" id="4438856">ssl30MAC</span>&nbsp;<span class="keyword" id="4438865">struct</span>&nbsp;<span class="op" id="4438872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4438875">h</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4438879"><a href="/gostd/crypto/tls/cipher_suites.go.html#4432903">hash</a></span><span class="op" id="4438883">.</span><span class="ident" id="4438884"><a href="/gostd/hash/hash.go.html#3014105">Hash</a></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4438890">key</span>&nbsp;<span class="op" id="4438894">[</span><span class="op" id="4438895">]</span><span class="builtintype" id="4438896">byte</span><br>
<span class="lineno"></span><span class="op" id="4438901">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4438904">func</span>&nbsp;<span class="op" id="4438909">(</span><span class="ident" id="4438910">s</span>&nbsp;<span class="ident" id="4438912"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438856">ssl30MAC</a></span><span class="op" id="4438920">)</span>&nbsp;<span class="ident" id="4438922">Size</span><span class="op" id="4438926">(</span><span class="op" id="4438927">)</span>&nbsp;<span class="builtintype" id="4438929">int</span>&nbsp;<span class="op" id="4438933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4438936">return</span>&nbsp;<span class="ident" id="4438943"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438910">s</a></span><span class="op" id="4438944">.</span><span class="ident" id="4438945"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438875">h</a></span><span class="op" id="4438946">.</span><span class="ident" id="4438947"><a href="/gostd/hash/hash.go.html#3014507">Size</a></span><span class="op" id="4438951">(</span><span class="op" id="4438952">)</span><br>
<span class="lineno">175</span><span class="op" id="4438954">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4438957">var</span>&nbsp;<span class="ident" id="4438961">ssl30Pad1</span>&nbsp;<span class="op" id="4438971">=</span>&nbsp;<span class="op" id="4438973">[</span><span class="num" id="4438974">48</span><span class="op" id="4438976">]</span><span class="builtintype" id="4438977">byte</span><span class="op" id="4438981">{</span><span class="num" id="4438982">0x36</span><span class="op" id="4438986">,</span>&nbsp;<span class="num" id="4438988">0x36</span><span class="op" id="4438992">,</span>&nbsp;<span class="num" id="4438994">0x36</span><span class="op" id="4438998">,</span>&nbsp;<span class="num" id="4439000">0x36</span><span class="op" id="4439004">,</span>&nbsp;<span class="num" id="4439006">0x36</span><span class="op" id="4439010">,</span>&nbsp;<span class="num" id="4439012">0x36</span><span class="op" id="4439016">,</span>&nbsp;<span class="num" id="4439018">0x36</span><span class="op" id="4439022">,</span>&nbsp;<span class="num" id="4439024">0x36</span><span class="op" id="4439028">,</span>&nbsp;<span class="num" id="4439030">0x36</span><span class="op" id="4439034">,</span>&nbsp;<span class="num" id="4439036">0x36</span><span class="op" id="4439040">,</span>&nbsp;<span class="num" id="4439042">0x36</span><span class="op" id="4439046">,</span>&nbsp;<span class="num" id="4439048">0x36</span><span class="op" id="4439052">,</span>&nbsp;<span class="num" id="4439054">0x36</span><span class="op" id="4439058">,</span>&nbsp;<span class="num" id="4439060">0x36</span><span class="op" id="4439064">,</span>&nbsp;<span class="num" id="4439066">0x36</span><span class="op" id="4439070">,</span>&nbsp;<span class="num" id="4439072">0x36</span><span class="op" id="4439076">,</span>&nbsp;<span class="num" id="4439078">0x36</span><span class="op" id="4439082">,</span>&nbsp;<span class="num" id="4439084">0x36</span><span class="op" id="4439088">,</span>&nbsp;<span class="num" id="4439090">0x36</span><span class="op" id="4439094">,</span>&nbsp;<span class="num" id="4439096">0x36</span><span class="op" id="4439100">,</span>&nbsp;<span class="num" id="4439102">0x36</span><span class="op" id="4439106">,</span>&nbsp;<span class="num" id="4439108">0x36</span><span class="op" id="4439112">,</span>&nbsp;<span class="num" id="4439114">0x36</span><span class="op" id="4439118">,</span>&nbsp;<span class="num" id="4439120">0x36</span><span class="op" id="4439124">,</span>&nbsp;<span class="num" id="4439126">0x36</span><span class="op" id="4439130">,</span>&nbsp;<span class="num" id="4439132">0x36</span><span class="op" id="4439136">,</span>&nbsp;<span class="num" id="4439138">0x36</span><span class="op" id="4439142">,</span>&nbsp;<span class="num" id="4439144">0x36</span><span class="op" id="4439148">,</span>&nbsp;<span class="num" id="4439150">0x36</span><span class="op" id="4439154">,</span>&nbsp;<span class="num" id="4439156">0x36</span><span class="op" id="4439160">,</span>&nbsp;<span class="num" id="4439162">0x36</span><span class="op" id="4439166">,</span>&nbsp;<span class="num" id="4439168">0x36</span><span class="op" id="4439172">,</span>&nbsp;<span class="num" id="4439174">0x36</span><span class="op" id="4439178">,</span>&nbsp;<span class="num" id="4439180">0x36</span><span class="op" id="4439184">,</span>&nbsp;<span class="num" id="4439186">0x36</span><span class="op" id="4439190">,</span>&nbsp;<span class="num" id="4439192">0x36</span><span class="op" id="4439196">,</span>&nbsp;<span class="num" id="4439198">0x36</span><span class="op" id="4439202">,</span>&nbsp;<span class="num" id="4439204">0x36</span><span class="op" id="4439208">,</span>&nbsp;<span class="num" id="4439210">0x36</span><span class="op" id="4439214">,</span>&nbsp;<span class="num" id="4439216">0x36</span><span class="op" id="4439220">,</span>&nbsp;<span class="num" id="4439222">0x36</span><span class="op" id="4439226">,</span>&nbsp;<span class="num" id="4439228">0x36</span><span class="op" id="4439232">,</span>&nbsp;<span class="num" id="4439234">0x36</span><span class="op" id="4439238">,</span>&nbsp;<span class="num" id="4439240">0x36</span><span class="op" id="4439244">,</span>&nbsp;<span class="num" id="4439246">0x36</span><span class="op" id="4439250">,</span>&nbsp;<span class="num" id="4439252">0x36</span><span class="op" id="4439256">,</span>&nbsp;<span class="num" id="4439258">0x36</span><span class="op" id="4439262">,</span>&nbsp;<span class="num" id="4439264">0x36</span><span class="op" id="4439268">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4439271">var</span>&nbsp;<span class="ident" id="4439275">ssl30Pad2</span>&nbsp;<span class="op" id="4439285">=</span>&nbsp;<span class="op" id="4439287">[</span><span class="num" id="4439288">48</span><span class="op" id="4439290">]</span><span class="builtintype" id="4439291">byte</span><span class="op" id="4439295">{</span><span class="num" id="4439296">0x5c</span><span class="op" id="4439300">,</span>&nbsp;<span class="num" id="4439302">0x5c</span><span class="op" id="4439306">,</span>&nbsp;<span class="num" id="4439308">0x5c</span><span class="op" id="4439312">,</span>&nbsp;<span class="num" id="4439314">0x5c</span><span class="op" id="4439318">,</span>&nbsp;<span class="num" id="4439320">0x5c</span><span class="op" id="4439324">,</span>&nbsp;<span class="num" id="4439326">0x5c</span><span class="op" id="4439330">,</span>&nbsp;<span class="num" id="4439332">0x5c</span><span class="op" id="4439336">,</span>&nbsp;<span class="num" id="4439338">0x5c</span><span class="op" id="4439342">,</span>&nbsp;<span class="num" id="4439344">0x5c</span><span class="op" id="4439348">,</span>&nbsp;<span class="num" id="4439350">0x5c</span><span class="op" id="4439354">,</span>&nbsp;<span class="num" id="4439356">0x5c</span><span class="op" id="4439360">,</span>&nbsp;<span class="num" id="4439362">0x5c</span><span class="op" id="4439366">,</span>&nbsp;<span class="num" id="4439368">0x5c</span><span class="op" id="4439372">,</span>&nbsp;<span class="num" id="4439374">0x5c</span><span class="op" id="4439378">,</span>&nbsp;<span class="num" id="4439380">0x5c</span><span class="op" id="4439384">,</span>&nbsp;<span class="num" id="4439386">0x5c</span><span class="op" id="4439390">,</span>&nbsp;<span class="num" id="4439392">0x5c</span><span class="op" id="4439396">,</span>&nbsp;<span class="num" id="4439398">0x5c</span><span class="op" id="4439402">,</span>&nbsp;<span class="num" id="4439404">0x5c</span><span class="op" id="4439408">,</span>&nbsp;<span class="num" id="4439410">0x5c</span><span class="op" id="4439414">,</span>&nbsp;<span class="num" id="4439416">0x5c</span><span class="op" id="4439420">,</span>&nbsp;<span class="num" id="4439422">0x5c</span><span class="op" id="4439426">,</span>&nbsp;<span class="num" id="4439428">0x5c</span><span class="op" id="4439432">,</span>&nbsp;<span class="num" id="4439434">0x5c</span><span class="op" id="4439438">,</span>&nbsp;<span class="num" id="4439440">0x5c</span><span class="op" id="4439444">,</span>&nbsp;<span class="num" id="4439446">0x5c</span><span class="op" id="4439450">,</span>&nbsp;<span class="num" id="4439452">0x5c</span><span class="op" id="4439456">,</span>&nbsp;<span class="num" id="4439458">0x5c</span><span class="op" id="4439462">,</span>&nbsp;<span class="num" id="4439464">0x5c</span><span class="op" id="4439468">,</span>&nbsp;<span class="num" id="4439470">0x5c</span><span class="op" id="4439474">,</span>&nbsp;<span class="num" id="4439476">0x5c</span><span class="op" id="4439480">,</span>&nbsp;<span class="num" id="4439482">0x5c</span><span class="op" id="4439486">,</span>&nbsp;<span class="num" id="4439488">0x5c</span><span class="op" id="4439492">,</span>&nbsp;<span class="num" id="4439494">0x5c</span><span class="op" id="4439498">,</span>&nbsp;<span class="num" id="4439500">0x5c</span><span class="op" id="4439504">,</span>&nbsp;<span class="num" id="4439506">0x5c</span><span class="op" id="4439510">,</span>&nbsp;<span class="num" id="4439512">0x5c</span><span class="op" id="4439516">,</span>&nbsp;<span class="num" id="4439518">0x5c</span><span class="op" id="4439522">,</span>&nbsp;<span class="num" id="4439524">0x5c</span><span class="op" id="4439528">,</span>&nbsp;<span class="num" id="4439530">0x5c</span><span class="op" id="4439534">,</span>&nbsp;<span class="num" id="4439536">0x5c</span><span class="op" id="4439540">,</span>&nbsp;<span class="num" id="4439542">0x5c</span><span class="op" id="4439546">,</span>&nbsp;<span class="num" id="4439548">0x5c</span><span class="op" id="4439552">,</span>&nbsp;<span class="num" id="4439554">0x5c</span><span class="op" id="4439558">,</span>&nbsp;<span class="num" id="4439560">0x5c</span><span class="op" id="4439564">,</span>&nbsp;<span class="num" id="4439566">0x5c</span><span class="op" id="4439570">,</span>&nbsp;<span class="num" id="4439572">0x5c</span><span class="op" id="4439576">,</span>&nbsp;<span class="num" id="4439578">0x5c</span><span class="op" id="4439582">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="keyword" id="4439585">func</span>&nbsp;<span class="op" id="4439590">(</span><span class="ident" id="4439591">s</span>&nbsp;<span class="ident" id="4439593"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438856">ssl30MAC</a></span><span class="op" id="4439601">)</span>&nbsp;<span class="ident" id="4439603">MAC</span><span class="op" id="4439606">(</span><span class="ident" id="4439607">digestBuf</span><span class="op" id="4439616">,</span>&nbsp;<span class="ident" id="4439618">seq</span><span class="op" id="4439621">,</span>&nbsp;<span class="ident" id="4439623">header</span><span class="op" id="4439629">,</span>&nbsp;<span class="ident" id="4439631">data</span>&nbsp;<span class="op" id="4439636">[</span><span class="op" id="4439637">]</span><span class="builtintype" id="4439638">byte</span><span class="op" id="4439642">)</span>&nbsp;<span class="op" id="4439644">[</span><span class="op" id="4439645">]</span><span class="builtintype" id="4439646">byte</span>&nbsp;<span class="op" id="4439651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4439654">padLength</span>&nbsp;<span class="op" id="4439664">:=</span>&nbsp;<span class="num" id="4439667">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4439671">if</span>&nbsp;<span class="ident" id="4439674"><a href="/gostd/crypto/tls/cipher_suites.go.html#4439591">s</a></span><span class="op" id="4439675">.</span><span class="ident" id="4439676"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438875">h</a></span><span class="op" id="4439677">.</span><span class="ident" id="4439678"><a href="/gostd/hash/hash.go.html#3014507">Size</a></span><span class="op" id="4439682">(</span><span class="op" id="4439683">)</span>&nbsp;<span class="op" id="4439685">==</span>&nbsp;<span class="num" id="4439688">20</span>&nbsp;<span class="op" id="4439691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4439695"><a href="/gostd/crypto/tls/cipher_suites.go.html#4439654">padLength</a></span>&nbsp;<span class="op" id="4439705">=</span>&nbsp;<span class="num" id="4439707">40</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4439711">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4439715"><a href="/gostd/crypto/tls/cipher_suites.go.html#4439591">s</a></span><span class="op" id="4439716">.</span><span class="ident" id="4439717"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438875">h</a></span><span class="op" id="4439718">.</span><span class="ident" id="4439719"><a href="/gostd/hash/hash.go.html#3014443">Reset</a></span><span class="op" id="4439724">(</span><span class="op" id="4439725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4439728"><a href="/gostd/crypto/tls/cipher_suites.go.html#4439591">s</a></span><span class="op" id="4439729">.</span><span class="ident" id="4439730"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438875">h</a></span><span class="op" id="4439731">.</span><span class="ident" id="4439732"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4439737">(</span><span class="ident" id="4439738"><a href="/gostd/crypto/tls/cipher_suites.go.html#4439591">s</a></span><span class="op" id="4439739">.</span><span class="ident" id="4439740"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438890">key</a></span><span class="op" id="4439743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4439746"><a href="/gostd/crypto/tls/cipher_suites.go.html#4439591">s</a></span><span class="op" id="4439747">.</span><span class="ident" id="4439748"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438875">h</a></span><span class="op" id="4439749">.</span><span class="ident" id="4439750"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4439755">(</span><span class="ident" id="4439756"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438961">ssl30Pad1</a></span><span class="op" id="4439765">[</span><span class="op" id="4439766">:</span><span class="ident" id="4439767"><a href="/gostd/crypto/tls/cipher_suites.go.html#4439654">padLength</a></span><span class="op" id="4439776">]</span><span class="op" id="4439777">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4439780"><a href="/gostd/crypto/tls/cipher_suites.go.html#4439591">s</a></span><span class="op" id="4439781">.</span><span class="ident" id="4439782"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438875">h</a></span><span class="op" id="4439783">.</span><span class="ident" id="4439784"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4439789">(</span><span class="ident" id="4439790"><a href="/gostd/crypto/tls/cipher_suites.go.html#4439618">seq</a></span><span class="op" id="4439793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4439796"><a href="/gostd/crypto/tls/cipher_suites.go.html#4439591">s</a></span><span class="op" id="4439797">.</span><span class="ident" id="4439798"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438875">h</a></span><span class="op" id="4439799">.</span><span class="ident" id="4439800"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4439805">(</span><span class="ident" id="4439806"><a href="/gostd/crypto/tls/cipher_suites.go.html#4439623">header</a></span><span class="op" id="4439812">[</span><span class="op" id="4439813">:</span><span class="num" id="4439814">1</span><span class="op" id="4439815">]</span><span class="op" id="4439816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4439819"><a href="/gostd/crypto/tls/cipher_suites.go.html#4439591">s</a></span><span class="op" id="4439820">.</span><span class="ident" id="4439821"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438875">h</a></span><span class="op" id="4439822">.</span><span class="ident" id="4439823"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4439828">(</span><span class="ident" id="4439829"><a href="/gostd/crypto/tls/cipher_suites.go.html#4439623">header</a></span><span class="op" id="4439835">[</span><span class="num" id="4439836">3</span><span class="op" id="4439837">:</span><span class="num" id="4439838">5</span><span class="op" id="4439839">]</span><span class="op" id="4439840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4439843"><a href="/gostd/crypto/tls/cipher_suites.go.html#4439591">s</a></span><span class="op" id="4439844">.</span><span class="ident" id="4439845"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438875">h</a></span><span class="op" id="4439846">.</span><span class="ident" id="4439847"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4439852">(</span><span class="ident" id="4439853"><a href="/gostd/crypto/tls/cipher_suites.go.html#4439631">data</a></span><span class="op" id="4439857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4439860"><a href="/gostd/crypto/tls/cipher_suites.go.html#4439607">digestBuf</a></span>&nbsp;<span class="op" id="4439870">=</span>&nbsp;<span class="ident" id="4439872"><a href="/gostd/crypto/tls/cipher_suites.go.html#4439591">s</a></span><span class="op" id="4439873">.</span><span class="ident" id="4439874"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438875">h</a></span><span class="op" id="4439875">.</span><span class="ident" id="4439876"><a href="/gostd/hash/hash.go.html#3014372">Sum</a></span><span class="op" id="4439879">(</span><span class="ident" id="4439880"><a href="/gostd/crypto/tls/cipher_suites.go.html#4439607">digestBuf</a></span><span class="op" id="4439889">[</span><span class="op" id="4439890">:</span><span class="num" id="4439891">0</span><span class="op" id="4439892">]</span><span class="op" id="4439893">)</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4439897"><a href="/gostd/crypto/tls/cipher_suites.go.html#4439591">s</a></span><span class="op" id="4439898">.</span><span class="ident" id="4439899"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438875">h</a></span><span class="op" id="4439900">.</span><span class="ident" id="4439901"><a href="/gostd/hash/hash.go.html#3014443">Reset</a></span><span class="op" id="4439906">(</span><span class="op" id="4439907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4439910"><a href="/gostd/crypto/tls/cipher_suites.go.html#4439591">s</a></span><span class="op" id="4439911">.</span><span class="ident" id="4439912"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438875">h</a></span><span class="op" id="4439913">.</span><span class="ident" id="4439914"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4439919">(</span><span class="ident" id="4439920"><a href="/gostd/crypto/tls/cipher_suites.go.html#4439591">s</a></span><span class="op" id="4439921">.</span><span class="ident" id="4439922"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438890">key</a></span><span class="op" id="4439925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4439928"><a href="/gostd/crypto/tls/cipher_suites.go.html#4439591">s</a></span><span class="op" id="4439929">.</span><span class="ident" id="4439930"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438875">h</a></span><span class="op" id="4439931">.</span><span class="ident" id="4439932"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4439937">(</span><span class="ident" id="4439938"><a href="/gostd/crypto/tls/cipher_suites.go.html#4439275">ssl30Pad2</a></span><span class="op" id="4439947">[</span><span class="op" id="4439948">:</span><span class="ident" id="4439949"><a href="/gostd/crypto/tls/cipher_suites.go.html#4439654">padLength</a></span><span class="op" id="4439958">]</span><span class="op" id="4439959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4439962"><a href="/gostd/crypto/tls/cipher_suites.go.html#4439591">s</a></span><span class="op" id="4439963">.</span><span class="ident" id="4439964"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438875">h</a></span><span class="op" id="4439965">.</span><span class="ident" id="4439966"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4439971">(</span><span class="ident" id="4439972"><a href="/gostd/crypto/tls/cipher_suites.go.html#4439607">digestBuf</a></span><span class="op" id="4439981">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4439984">return</span>&nbsp;<span class="ident" id="4439991"><a href="/gostd/crypto/tls/cipher_suites.go.html#4439591">s</a></span><span class="op" id="4439992">.</span><span class="ident" id="4439993"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438875">h</a></span><span class="op" id="4439994">.</span><span class="ident" id="4439995"><a href="/gostd/hash/hash.go.html#3014372">Sum</a></span><span class="op" id="4439998">(</span><span class="ident" id="4439999"><a href="/gostd/crypto/tls/cipher_suites.go.html#4439607">digestBuf</a></span><span class="op" id="4440008">[</span><span class="op" id="4440009">:</span><span class="num" id="4440010">0</span><span class="op" id="4440011">]</span><span class="op" id="4440012">)</span><br>
<span class="lineno"></span><span class="op" id="4440014">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4440017">//&nbsp;tls10MAC&nbsp;implements&nbsp;the&nbsp;TLS&nbsp;1.0&nbsp;MAC&nbsp;function.&nbsp;RFC&nbsp;2246,&nbsp;section&nbsp;6.2.3.</span><br>
<span class="lineno"></span><span class="keyword" id="4440091">type</span>&nbsp;<span class="ident" id="4440096">tls10MAC</span>&nbsp;<span class="keyword" id="4440105">struct</span>&nbsp;<span class="op" id="4440112">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4440115">h</span>&nbsp;<span class="ident" id="4440117"><a href="/gostd/crypto/tls/cipher_suites.go.html#4432903">hash</a></span><span class="op" id="4440121">.</span><span class="ident" id="4440122"><a href="/gostd/hash/hash.go.html#3014105">Hash</a></span><br>
<span class="lineno"></span><span class="op" id="4440127">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4440130">func</span>&nbsp;<span class="op" id="4440135">(</span><span class="ident" id="4440136">s</span>&nbsp;<span class="ident" id="4440138"><a href="/gostd/crypto/tls/cipher_suites.go.html#4440096">tls10MAC</a></span><span class="op" id="4440146">)</span>&nbsp;<span class="ident" id="4440148">Size</span><span class="op" id="4440152">(</span><span class="op" id="4440153">)</span>&nbsp;<span class="builtintype" id="4440155">int</span>&nbsp;<span class="op" id="4440159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4440162">return</span>&nbsp;<span class="ident" id="4440169"><a href="/gostd/crypto/tls/cipher_suites.go.html#4440136">s</a></span><span class="op" id="4440170">.</span><span class="ident" id="4440171"><a href="/gostd/crypto/tls/cipher_suites.go.html#4440115">h</a></span><span class="op" id="4440172">.</span><span class="ident" id="4440173"><a href="/gostd/hash/hash.go.html#3014507">Size</a></span><span class="op" id="4440177">(</span><span class="op" id="4440178">)</span><br>
<span class="lineno">210</span><span class="op" id="4440180">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4440183">func</span>&nbsp;<span class="op" id="4440188">(</span><span class="ident" id="4440189">s</span>&nbsp;<span class="ident" id="4440191"><a href="/gostd/crypto/tls/cipher_suites.go.html#4440096">tls10MAC</a></span><span class="op" id="4440199">)</span>&nbsp;<span class="ident" id="4440201">MAC</span><span class="op" id="4440204">(</span><span class="ident" id="4440205">digestBuf</span><span class="op" id="4440214">,</span>&nbsp;<span class="ident" id="4440216">seq</span><span class="op" id="4440219">,</span>&nbsp;<span class="ident" id="4440221">header</span><span class="op" id="4440227">,</span>&nbsp;<span class="ident" id="4440229">data</span>&nbsp;<span class="op" id="4440234">[</span><span class="op" id="4440235">]</span><span class="builtintype" id="4440236">byte</span><span class="op" id="4440240">)</span>&nbsp;<span class="op" id="4440242">[</span><span class="op" id="4440243">]</span><span class="builtintype" id="4440244">byte</span>&nbsp;<span class="op" id="4440249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4440252"><a href="/gostd/crypto/tls/cipher_suites.go.html#4440189">s</a></span><span class="op" id="4440253">.</span><span class="ident" id="4440254"><a href="/gostd/crypto/tls/cipher_suites.go.html#4440115">h</a></span><span class="op" id="4440255">.</span><span class="ident" id="4440256"><a href="/gostd/hash/hash.go.html#3014443">Reset</a></span><span class="op" id="4440261">(</span><span class="op" id="4440262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4440265"><a href="/gostd/crypto/tls/cipher_suites.go.html#4440189">s</a></span><span class="op" id="4440266">.</span><span class="ident" id="4440267"><a href="/gostd/crypto/tls/cipher_suites.go.html#4440115">h</a></span><span class="op" id="4440268">.</span><span class="ident" id="4440269"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4440274">(</span><span class="ident" id="4440275"><a href="/gostd/crypto/tls/cipher_suites.go.html#4440216">seq</a></span><span class="op" id="4440278">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4440281"><a href="/gostd/crypto/tls/cipher_suites.go.html#4440189">s</a></span><span class="op" id="4440282">.</span><span class="ident" id="4440283"><a href="/gostd/crypto/tls/cipher_suites.go.html#4440115">h</a></span><span class="op" id="4440284">.</span><span class="ident" id="4440285"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4440290">(</span><span class="ident" id="4440291"><a href="/gostd/crypto/tls/cipher_suites.go.html#4440221">header</a></span><span class="op" id="4440297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4440300"><a href="/gostd/crypto/tls/cipher_suites.go.html#4440189">s</a></span><span class="op" id="4440301">.</span><span class="ident" id="4440302"><a href="/gostd/crypto/tls/cipher_suites.go.html#4440115">h</a></span><span class="op" id="4440303">.</span><span class="ident" id="4440304"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4440309">(</span><span class="ident" id="4440310"><a href="/gostd/crypto/tls/cipher_suites.go.html#4440229">data</a></span><span class="op" id="4440314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4440317">return</span>&nbsp;<span class="ident" id="4440324"><a href="/gostd/crypto/tls/cipher_suites.go.html#4440189">s</a></span><span class="op" id="4440325">.</span><span class="ident" id="4440326"><a href="/gostd/crypto/tls/cipher_suites.go.html#4440115">h</a></span><span class="op" id="4440327">.</span><span class="ident" id="4440328"><a href="/gostd/hash/hash.go.html#3014372">Sum</a></span><span class="op" id="4440331">(</span><span class="ident" id="4440332"><a href="/gostd/crypto/tls/cipher_suites.go.html#4440205">digestBuf</a></span><span class="op" id="4440341">[</span><span class="op" id="4440342">:</span><span class="num" id="4440343">0</span><span class="op" id="4440344">]</span><span class="op" id="4440345">)</span><br>
<span class="lineno"></span><span class="op" id="4440347">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="keyword" id="4440350">func</span>&nbsp;<span class="ident" id="4440355">rsaKA</span><span class="op" id="4440360">(</span><span class="ident" id="4440361">version</span>&nbsp;<span class="builtintype" id="4440369">uint16</span><span class="op" id="4440375">)</span>&nbsp;<span class="ident" id="4440377"><a href="/gostd/crypto/tls/cipher_suites.go.html#4433061">keyAgreement</a></span>&nbsp;<span class="op" id="4440390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4440393">return</span>&nbsp;<span class="ident" id="4440400"><a href="/gostd/crypto/tls/key_agreement.go.html#4558411">rsaKeyAgreement</a></span><span class="op" id="4440415">{</span><span class="op" id="4440416">}</span><br>
<span class="lineno"></span><span class="op" id="4440418">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4440421">func</span>&nbsp;<span class="ident" id="4440426">ecdheECDSAKA</span><span class="op" id="4440438">(</span><span class="ident" id="4440439">version</span>&nbsp;<span class="builtintype" id="4440447">uint16</span><span class="op" id="4440453">)</span>&nbsp;<span class="ident" id="4440455"><a href="/gostd/crypto/tls/cipher_suites.go.html#4433061">keyAgreement</a></span>&nbsp;<span class="op" id="4440468">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4440471">return</span>&nbsp;<span class="op" id="4440478">&amp;</span><span class="ident" id="4440479"><a href="/gostd/crypto/tls/key_agreement.go.html#4563715">ecdheKeyAgreement</a></span><span class="op" id="4440496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4440500"><a href="/gostd/crypto/tls/key_agreement.go.html#4563762">sigType</a></span><span class="op" id="4440507">:</span>&nbsp;<span class="ident" id="4440509"><a href="/gostd/crypto/tls/common.go.html#4445618">signatureECDSA</a></span><span class="op" id="4440523">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4440527"><a href="/gostd/crypto/tls/key_agreement.go.html#4563743">version</a></span><span class="op" id="4440534">:</span>&nbsp;<span class="ident" id="4440536"><a href="/gostd/crypto/tls/cipher_suites.go.html#4440439">version</a></span><span class="op" id="4440543">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4440546">}</span><br>
<span class="lineno"></span><span class="op" id="4440548">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="4440551">func</span>&nbsp;<span class="ident" id="4440556">ecdheRSAKA</span><span class="op" id="4440566">(</span><span class="ident" id="4440567">version</span>&nbsp;<span class="builtintype" id="4440575">uint16</span><span class="op" id="4440581">)</span>&nbsp;<span class="ident" id="4440583"><a href="/gostd/crypto/tls/cipher_suites.go.html#4433061">keyAgreement</a></span>&nbsp;<span class="op" id="4440596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4440599">return</span>&nbsp;<span class="op" id="4440606">&amp;</span><span class="ident" id="4440607"><a href="/gostd/crypto/tls/key_agreement.go.html#4563715">ecdheKeyAgreement</a></span><span class="op" id="4440624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4440628"><a href="/gostd/crypto/tls/key_agreement.go.html#4563762">sigType</a></span><span class="op" id="4440635">:</span>&nbsp;<span class="ident" id="4440637"><a href="/gostd/crypto/tls/common.go.html#4445592">signatureRSA</a></span><span class="op" id="4440649">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4440653"><a href="/gostd/crypto/tls/key_agreement.go.html#4563743">version</a></span><span class="op" id="4440660">:</span>&nbsp;<span class="ident" id="4440662"><a href="/gostd/crypto/tls/cipher_suites.go.html#4440567">version</a></span><span class="op" id="4440669">,</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4440672">}</span><br>
<span class="lineno"></span><span class="op" id="4440674">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4440677">//&nbsp;mutualCipherSuite&nbsp;returns&nbsp;a&nbsp;cipherSuite&nbsp;given&nbsp;a&nbsp;list&nbsp;of&nbsp;supported</span><br>
<span class="lineno"></span><span class="comment" id="4440746">//&nbsp;ciphersuites&nbsp;and&nbsp;the&nbsp;id&nbsp;requested&nbsp;by&nbsp;the&nbsp;peer.</span><br>
<span class="lineno">240</span><span class="keyword" id="4440796">func</span>&nbsp;<span class="ident" id="4440801">mutualCipherSuite</span><span class="op" id="4440818">(</span><span class="ident" id="4440819">have</span>&nbsp;<span class="op" id="4440824">[</span><span class="op" id="4440825">]</span><span class="builtintype" id="4440826">uint16</span><span class="op" id="4440832">,</span>&nbsp;<span class="ident" id="4440834">want</span>&nbsp;<span class="builtintype" id="4440839">uint16</span><span class="op" id="4440845">)</span>&nbsp;<span class="op" id="4440847">*</span><span class="ident" id="4440848"><a href="/gostd/crypto/tls/cipher_suites.go.html#4434677">cipherSuite</a></span>&nbsp;<span class="op" id="4440860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4440863">for</span>&nbsp;<span class="ident" id="4440867">_</span><span class="op" id="4440868">,</span>&nbsp;<span class="ident" id="4440870">id</span>&nbsp;<span class="op" id="4440873">:=</span>&nbsp;<span class="keyword" id="4440876">range</span>&nbsp;<span class="ident" id="4440882"><a href="/gostd/crypto/tls/cipher_suites.go.html#4440819">have</a></span>&nbsp;<span class="op" id="4440887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4440891">if</span>&nbsp;<span class="ident" id="4440894"><a href="/gostd/crypto/tls/cipher_suites.go.html#4440870">id</a></span>&nbsp;<span class="op" id="4440897">==</span>&nbsp;<span class="ident" id="4440900"><a href="/gostd/crypto/tls/cipher_suites.go.html#4440834">want</a></span>&nbsp;<span class="op" id="4440905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4440910">for</span>&nbsp;<span class="ident" id="4440914">_</span><span class="op" id="4440915">,</span>&nbsp;<span class="ident" id="4440917">suite</span>&nbsp;<span class="op" id="4440923">:=</span>&nbsp;<span class="keyword" id="4440926">range</span>&nbsp;<span class="ident" id="4440932"><a href="/gostd/crypto/tls/cipher_suites.go.html#4435091">cipherSuites</a></span>&nbsp;<span class="op" id="4440945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4440951">if</span>&nbsp;<span class="ident" id="4440954"><a href="/gostd/crypto/tls/cipher_suites.go.html#4440917">suite</a></span><span class="op" id="4440959">.</span><span class="ident" id="4440960"><a href="/gostd/crypto/tls/cipher_suites.go.html#4434699">id</a></span>&nbsp;<span class="op" id="4440963">==</span>&nbsp;<span class="ident" id="4440966"><a href="/gostd/crypto/tls/cipher_suites.go.html#4440834">want</a></span>&nbsp;<span class="op" id="4440971">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4440978">return</span>&nbsp;<span class="ident" id="4440985"><a href="/gostd/crypto/tls/cipher_suites.go.html#4440917">suite</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4440995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4441000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4441005">return</span>&nbsp;<span class="builtintype" id="4441012">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4441018">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4441021">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4441024">return</span>&nbsp;<span class="builtintype" id="4441031">nil</span><br>
<span class="lineno"></span><span class="op" id="4441035">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4441038">//&nbsp;A&nbsp;list&nbsp;of&nbsp;the&nbsp;possible&nbsp;cipher&nbsp;suite&nbsp;ids.&nbsp;Taken&nbsp;from</span><br>
<span class="lineno">255</span><span class="comment" id="4441093">//&nbsp;http://www.iana.org/assignments/tls-parameters/tls-parameters.xml</span><br>
<span class="lineno"></span><span class="keyword" id="4441162">const</span>&nbsp;<span class="op" id="4441168">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4441171">TLS_RSA_WITH_RC4_128_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4441211">uint16</span>&nbsp;<span class="op" id="4441218">=</span>&nbsp;<span class="num" id="4441220">0x0005</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4441228">TLS_RSA_WITH_3DES_EDE_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4441268">uint16</span>&nbsp;<span class="op" id="4441275">=</span>&nbsp;<span class="num" id="4441277">0x000a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4441285">TLS_RSA_WITH_AES_128_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4441325">uint16</span>&nbsp;<span class="op" id="4441332">=</span>&nbsp;<span class="num" id="4441334">0x002f</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4441342">TLS_RSA_WITH_AES_256_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4441382">uint16</span>&nbsp;<span class="op" id="4441389">=</span>&nbsp;<span class="num" id="4441391">0x0035</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4441399">TLS_ECDHE_ECDSA_WITH_RC4_128_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4441439">uint16</span>&nbsp;<span class="op" id="4441446">=</span>&nbsp;<span class="num" id="4441448">0xc007</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4441456">TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4441496">uint16</span>&nbsp;<span class="op" id="4441503">=</span>&nbsp;<span class="num" id="4441505">0xc009</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4441513">TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4441553">uint16</span>&nbsp;<span class="op" id="4441560">=</span>&nbsp;<span class="num" id="4441562">0xc00a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4441570">TLS_ECDHE_RSA_WITH_RC4_128_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4441610">uint16</span>&nbsp;<span class="op" id="4441617">=</span>&nbsp;<span class="num" id="4441619">0xc011</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4441627">TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4441667">uint16</span>&nbsp;<span class="op" id="4441674">=</span>&nbsp;<span class="num" id="4441676">0xc012</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4441684">TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4441724">uint16</span>&nbsp;<span class="op" id="4441731">=</span>&nbsp;<span class="num" id="4441733">0xc013</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4441741">TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4441781">uint16</span>&nbsp;<span class="op" id="4441788">=</span>&nbsp;<span class="num" id="4441790">0xc014</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4441798">TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4441838">uint16</span>&nbsp;<span class="op" id="4441845">=</span>&nbsp;<span class="num" id="4441847">0xc02f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4441855">TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</span>&nbsp;<span class="builtintype" id="4441895">uint16</span>&nbsp;<span class="op" id="4441902">=</span>&nbsp;<span class="num" id="4441904">0xc02b</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4441913">//&nbsp;TLS_FALLBACK_SCSV&nbsp;isn&#39;t&nbsp;a&nbsp;standard&nbsp;cipher&nbsp;suite&nbsp;but&nbsp;an&nbsp;indicator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4441982">//&nbsp;that&nbsp;the&nbsp;client&nbsp;is&nbsp;doing&nbsp;version&nbsp;fallback.&nbsp;See</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4442033">//&nbsp;https://tools.ietf.org/html/draft-ietf-tls-downgrade-scsv-00.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4442099">TLS_FALLBACK_SCSV</span>&nbsp;<span class="builtintype" id="4442117">uint16</span>&nbsp;<span class="op" id="4442124">=</span>&nbsp;<span class="num" id="4442126">0x5600</span><br>
<span class="lineno">275</span><span class="op" id="4442133">)</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
