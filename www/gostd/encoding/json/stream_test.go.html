<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/json</h2>
<ul>
<li><a href="/gostd/encoding/json/bench_test.go.html">bench_test.go</a></li>
<li><a href="/gostd/encoding/json/decode.go.html">decode.go</a></li>
<li><a href="/gostd/encoding/json/decode_test.go.html">decode_test.go</a></li>
<li><a href="/gostd/encoding/json/encode.go.html">encode.go</a></li>
<li><a href="/gostd/encoding/json/encode_test.go.html">encode_test.go</a></li>
<li><a href="/gostd/encoding/json/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/encoding/json/fold.go.html">fold.go</a></li>
<li><a href="/gostd/encoding/json/fold_test.go.html">fold_test.go</a></li>
<li><a href="/gostd/encoding/json/indent.go.html">indent.go</a></li>
<li><a href="/gostd/encoding/json/scanner.go.html">scanner.go</a></li>
<li><a href="/gostd/encoding/json/scanner_test.go.html">scanner_test.go</a></li>
<li><a href="/gostd/encoding/json/stream.go.html">stream.go</a></li>
<li><a href="/gostd/encoding/json/stream_test.go.html" class="current">stream_test.go</a></li>
<li><a href="/gostd/encoding/json/tagkey_test.go.html">tagkey_test.go</a></li>
<li><a href="/gostd/encoding/json/tags.go.html">tags.go</a></li>
<li><a href="/gostd/encoding/json/tags_test.go.html">tags_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6883775">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6883831">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6883885">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6883936">package</span>&nbsp;<span class="ident" id="6883944">json</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6883950">import</span>&nbsp;<span class="op" id="6883957">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6883960">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6883969">&#34;io/ioutil&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6883982">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6883989">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6884000">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6884011">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6884021">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="6884024">//&nbsp;Test&nbsp;values&nbsp;for&nbsp;the&nbsp;stream&nbsp;test.</span><br>
<span class="lineno"></span><span class="comment" id="6884060">//&nbsp;One&nbsp;of&nbsp;each&nbsp;JSON&nbsp;kind.</span><br>
<span class="lineno"></span><span class="keyword" id="6884086">var</span>&nbsp;<span class="ident" id="6884090">streamTest</span>&nbsp;<span class="op" id="6884101">=</span>&nbsp;<span class="op" id="6884103">[</span><span class="op" id="6884104">]</span><span class="keyword" id="6884105">interface</span><span class="op" id="6884114">{</span><span class="op" id="6884115">}</span><span class="op" id="6884116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6884119">0.1</span><span class="op" id="6884122">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6884125">&#34;hello&#34;</span><span class="op" id="6884132">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6884135">nil</span><span class="op" id="6884138">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6884141">true</span><span class="op" id="6884145">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6884148">false</span><span class="op" id="6884153">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6884156">[</span><span class="op" id="6884157">]</span><span class="keyword" id="6884158">interface</span><span class="op" id="6884167">{</span><span class="op" id="6884168">}</span><span class="op" id="6884169">{</span><span class="string" id="6884170">&#34;a&#34;</span><span class="op" id="6884173">,</span>&nbsp;<span class="string" id="6884175">&#34;b&#34;</span><span class="op" id="6884178">,</span>&nbsp;<span class="string" id="6884180">&#34;c&#34;</span><span class="op" id="6884183">}</span><span class="op" id="6884184">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6884187">map</span><span class="op" id="6884190">[</span><span class="builtintype" id="6884191">string</span><span class="op" id="6884197">]</span><span class="keyword" id="6884198">interface</span><span class="op" id="6884207">{</span><span class="op" id="6884208">}</span><span class="op" id="6884209">{</span><span class="string" id="6884210">&#34;K&#34;</span><span class="op" id="6884215">:</span>&nbsp;<span class="string" id="6884217">&#34;Kelvin&#34;</span><span class="op" id="6884225">,</span>&nbsp;<span class="string" id="6884227">&#34;ß&#34;</span><span class="op" id="6884231">:</span>&nbsp;<span class="string" id="6884233">&#34;long&nbsp;s&#34;</span><span class="op" id="6884241">}</span><span class="op" id="6884242">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6884245">3.14</span><span class="op" id="6884249">,</span>&nbsp;<span class="comment" id="6884251">//&nbsp;another&nbsp;value&nbsp;to&nbsp;make&nbsp;sure&nbsp;something&nbsp;can&nbsp;follow&nbsp;map</span><br>
<span class="lineno"></span><span class="op" id="6884306">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6884309">var</span>&nbsp;<span class="ident" id="6884313">streamEncoded</span>&nbsp;<span class="op" id="6884327">=</span>&nbsp;<span class="string" id="6884329">`0.1<br>
<span class="lineno">30</span>&#34;hello&#34;<br>
<span class="lineno"></span>null<br>
<span class="lineno"></span>true<br>
<span class="lineno"></span>false<br>
<span class="lineno"></span>[&#34;a&#34;,&#34;b&#34;,&#34;c&#34;]<br>
<span class="lineno">35</span>{&#34;ß&#34;:&#34;long&nbsp;s&#34;,&#34;K&#34;:&#34;Kelvin&#34;}<br>
<span class="lineno"></span>3.14<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6884411">func</span>&nbsp;<span class="ident" id="6884416">TestEncoder</span><span class="op" id="6884427">(</span><span class="ident" id="6884428">t</span>&nbsp;<span class="op" id="6884430">*</span><span class="ident" id="6884431"><a href="/gostd/encoding/json/stream_test.go.html#6884011">testing</a></span><span class="op" id="6884438">.</span><span class="ident" id="6884439"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="6884440">)</span>&nbsp;<span class="op" id="6884442">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6884445">for</span>&nbsp;<span class="ident" id="6884449">i</span>&nbsp;<span class="op" id="6884451">:=</span>&nbsp;<span class="num" id="6884454">0</span><span class="op" id="6884455">;</span>&nbsp;<span class="ident" id="6884457"><a href="/gostd/encoding/json/stream_test.go.html#6884449">i</a></span>&nbsp;<span class="op" id="6884459">&lt;=</span>&nbsp;<span class="builtinfunc" id="6884462">len</span><span class="op" id="6884465">(</span><span class="ident" id="6884466"><a href="/gostd/encoding/json/stream_test.go.html#6884090">streamTest</a></span><span class="op" id="6884476">)</span><span class="op" id="6884477">;</span>&nbsp;<span class="ident" id="6884479"><a href="/gostd/encoding/json/stream_test.go.html#6884449">i</a></span><span class="op" id="6884480">++</span>&nbsp;<span class="op" id="6884483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6884487">var</span>&nbsp;<span class="ident" id="6884491">buf</span>&nbsp;<span class="ident" id="6884495"><a href="/gostd/encoding/json/stream_test.go.html#6883960">bytes</a></span><span class="op" id="6884500">.</span><span class="ident" id="6884501"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6884510">enc</span>&nbsp;<span class="op" id="6884514">:=</span>&nbsp;<span class="ident" id="6884517"><a href="/gostd/encoding/json/stream.go.html#4047341">NewEncoder</a></span><span class="op" id="6884527">(</span><span class="op" id="6884528">&amp;</span><span class="ident" id="6884529"><a href="/gostd/encoding/json/stream_test.go.html#6884491">buf</a></span><span class="op" id="6884532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6884536">for</span>&nbsp;<span class="ident" id="6884540">j</span><span class="op" id="6884541">,</span>&nbsp;<span class="ident" id="6884543">v</span>&nbsp;<span class="op" id="6884545">:=</span>&nbsp;<span class="keyword" id="6884548">range</span>&nbsp;<span class="ident" id="6884554"><a href="/gostd/encoding/json/stream_test.go.html#6884090">streamTest</a></span><span class="op" id="6884564">[</span><span class="num" id="6884565">0</span><span class="op" id="6884566">:</span><span class="ident" id="6884567"><a href="/gostd/encoding/json/stream_test.go.html#6884449">i</a></span><span class="op" id="6884568">]</span>&nbsp;<span class="op" id="6884570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6884575">if</span>&nbsp;<span class="ident" id="6884578">err</span>&nbsp;<span class="op" id="6884582">:=</span>&nbsp;<span class="ident" id="6884585"><a href="/gostd/encoding/json/stream_test.go.html#6884510">enc</a></span><span class="op" id="6884588">.</span><span class="ident" id="6884589"><a href="/gostd/encoding/json/stream.go.html#4047611">Encode</a></span><span class="op" id="6884595">(</span><span class="ident" id="6884596"><a href="/gostd/encoding/json/stream_test.go.html#6884543">v</a></span><span class="op" id="6884597">)</span><span class="op" id="6884598">;</span>&nbsp;<span class="ident" id="6884600"><a href="/gostd/encoding/json/stream_test.go.html#6884578">err</a></span>&nbsp;<span class="op" id="6884604">!=</span>&nbsp;<span class="builtintype" id="6884607">nil</span>&nbsp;<span class="op" id="6884611">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6884617"><a href="/gostd/encoding/json/stream_test.go.html#6884428">t</a></span><span class="op" id="6884618">.</span><span class="ident" id="6884619"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="6884625">(</span><span class="string" id="6884626">&#34;encode&nbsp;#%d:&nbsp;%v&#34;</span><span class="op" id="6884642">,</span>&nbsp;<span class="ident" id="6884644"><a href="/gostd/encoding/json/stream_test.go.html#6884540">j</a></span><span class="op" id="6884645">,</span>&nbsp;<span class="ident" id="6884647"><a href="/gostd/encoding/json/stream_test.go.html#6884578">err</a></span><span class="op" id="6884650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6884655">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6884659">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6884663">if</span>&nbsp;<span class="ident" id="6884666">have</span><span class="op" id="6884670">,</span>&nbsp;<span class="ident" id="6884672">want</span>&nbsp;<span class="op" id="6884677">:=</span>&nbsp;<span class="ident" id="6884680"><a href="/gostd/encoding/json/stream_test.go.html#6884491">buf</a></span><span class="op" id="6884683">.</span><span class="ident" id="6884684"><a href="/gostd/bytes/buffer.go.html#1384648">String</a></span><span class="op" id="6884690">(</span><span class="op" id="6884691">)</span><span class="op" id="6884692">,</span>&nbsp;<span class="ident" id="6884694"><a href="/gostd/encoding/json/stream_test.go.html#6886157">nlines</a></span><span class="op" id="6884700">(</span><span class="ident" id="6884701"><a href="/gostd/encoding/json/stream_test.go.html#6884313">streamEncoded</a></span><span class="op" id="6884714">,</span>&nbsp;<span class="ident" id="6884716"><a href="/gostd/encoding/json/stream_test.go.html#6884449">i</a></span><span class="op" id="6884717">)</span><span class="op" id="6884718">;</span>&nbsp;<span class="ident" id="6884720"><a href="/gostd/encoding/json/stream_test.go.html#6884666">have</a></span>&nbsp;<span class="op" id="6884725">!=</span>&nbsp;<span class="ident" id="6884728"><a href="/gostd/encoding/json/stream_test.go.html#6884672">want</a></span>&nbsp;<span class="op" id="6884733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6884738"><a href="/gostd/encoding/json/stream_test.go.html#6884428">t</a></span><span class="op" id="6884739">.</span><span class="ident" id="6884740"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6884746">(</span><span class="string" id="6884747">&#34;encoding&nbsp;%d&nbsp;items:&nbsp;mismatch&#34;</span><span class="op" id="6884776">,</span>&nbsp;<span class="ident" id="6884778"><a href="/gostd/encoding/json/stream_test.go.html#6884449">i</a></span><span class="op" id="6884779">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6884784"><a href="/gostd/encoding/json/scanner_test.go.html#6882132">diff</a></span><span class="op" id="6884788">(</span><span class="ident" id="6884789"><a href="/gostd/encoding/json/stream_test.go.html#6884428">t</a></span><span class="op" id="6884790">,</span>&nbsp;<span class="op" id="6884792">[</span><span class="op" id="6884793">]</span><span class="builtintype" id="6884794">byte</span><span class="op" id="6884798">(</span><span class="ident" id="6884799"><a href="/gostd/encoding/json/stream_test.go.html#6884666">have</a></span><span class="op" id="6884803">)</span><span class="op" id="6884804">,</span>&nbsp;<span class="op" id="6884806">[</span><span class="op" id="6884807">]</span><span class="builtintype" id="6884808">byte</span><span class="op" id="6884812">(</span><span class="ident" id="6884813"><a href="/gostd/encoding/json/stream_test.go.html#6884672">want</a></span><span class="op" id="6884817">)</span><span class="op" id="6884818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6884823">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6884831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6884834">}</span><br>
<span class="lineno"></span><span class="op" id="6884836">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="keyword" id="6884839">func</span>&nbsp;<span class="ident" id="6884844">TestDecoder</span><span class="op" id="6884855">(</span><span class="ident" id="6884856">t</span>&nbsp;<span class="op" id="6884858">*</span><span class="ident" id="6884859"><a href="/gostd/encoding/json/stream_test.go.html#6884011">testing</a></span><span class="op" id="6884866">.</span><span class="ident" id="6884867"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="6884868">)</span>&nbsp;<span class="op" id="6884870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6884873">for</span>&nbsp;<span class="ident" id="6884877">i</span>&nbsp;<span class="op" id="6884879">:=</span>&nbsp;<span class="num" id="6884882">0</span><span class="op" id="6884883">;</span>&nbsp;<span class="ident" id="6884885"><a href="/gostd/encoding/json/stream_test.go.html#6884877">i</a></span>&nbsp;<span class="op" id="6884887">&lt;=</span>&nbsp;<span class="builtinfunc" id="6884890">len</span><span class="op" id="6884893">(</span><span class="ident" id="6884894"><a href="/gostd/encoding/json/stream_test.go.html#6884090">streamTest</a></span><span class="op" id="6884904">)</span><span class="op" id="6884905">;</span>&nbsp;<span class="ident" id="6884907"><a href="/gostd/encoding/json/stream_test.go.html#6884877">i</a></span><span class="op" id="6884908">++</span>&nbsp;<span class="op" id="6884911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6884915">//&nbsp;Use&nbsp;stream&nbsp;without&nbsp;newlines&nbsp;as&nbsp;input,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6884958">//&nbsp;just&nbsp;to&nbsp;stress&nbsp;the&nbsp;decoder&nbsp;even&nbsp;more.</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6885001">//&nbsp;Our&nbsp;test&nbsp;input&nbsp;does&nbsp;not&nbsp;include&nbsp;back-to-back&nbsp;numbers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6885060">//&nbsp;Otherwise&nbsp;stripping&nbsp;the&nbsp;newlines&nbsp;would</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6885104">//&nbsp;merge&nbsp;two&nbsp;adjacent&nbsp;JSON&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6885141">var</span>&nbsp;<span class="ident" id="6885145">buf</span>&nbsp;<span class="ident" id="6885149"><a href="/gostd/encoding/json/stream_test.go.html#6883960">bytes</a></span><span class="op" id="6885154">.</span><span class="ident" id="6885155"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6885164">for</span>&nbsp;<span class="ident" id="6885168">_</span><span class="op" id="6885169">,</span>&nbsp;<span class="ident" id="6885171">c</span>&nbsp;<span class="op" id="6885173">:=</span>&nbsp;<span class="keyword" id="6885176">range</span>&nbsp;<span class="ident" id="6885182"><a href="/gostd/encoding/json/stream_test.go.html#6886157">nlines</a></span><span class="op" id="6885188">(</span><span class="ident" id="6885189"><a href="/gostd/encoding/json/stream_test.go.html#6884313">streamEncoded</a></span><span class="op" id="6885202">,</span>&nbsp;<span class="ident" id="6885204"><a href="/gostd/encoding/json/stream_test.go.html#6884877">i</a></span><span class="op" id="6885205">)</span>&nbsp;<span class="op" id="6885207">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6885212">if</span>&nbsp;<span class="ident" id="6885215"><a href="/gostd/encoding/json/stream_test.go.html#6885171">c</a></span>&nbsp;<span class="op" id="6885217">!=</span>&nbsp;<span class="string" id="6885220">&#39;\n&#39;</span>&nbsp;<span class="op" id="6885225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6885231"><a href="/gostd/encoding/json/stream_test.go.html#6885145">buf</a></span><span class="op" id="6885234">.</span><span class="ident" id="6885235"><a href="/gostd/bytes/buffer.go.html#1390522">WriteRune</a></span><span class="op" id="6885244">(</span><span class="ident" id="6885245"><a href="/gostd/encoding/json/stream_test.go.html#6885171">c</a></span><span class="op" id="6885246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6885251">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6885255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6885259">out</span>&nbsp;<span class="op" id="6885263">:=</span>&nbsp;<span class="builtinfunc" id="6885266">make</span><span class="op" id="6885270">(</span><span class="op" id="6885271">[</span><span class="op" id="6885272">]</span><span class="keyword" id="6885273">interface</span><span class="op" id="6885282">{</span><span class="op" id="6885283">}</span><span class="op" id="6885284">,</span>&nbsp;<span class="ident" id="6885286"><a href="/gostd/encoding/json/stream_test.go.html#6884877">i</a></span><span class="op" id="6885287">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6885291">dec</span>&nbsp;<span class="op" id="6885295">:=</span>&nbsp;<span class="ident" id="6885298"><a href="/gostd/encoding/json/stream.go.html#4044448">NewDecoder</a></span><span class="op" id="6885308">(</span><span class="op" id="6885309">&amp;</span><span class="ident" id="6885310"><a href="/gostd/encoding/json/stream_test.go.html#6885145">buf</a></span><span class="op" id="6885313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6885317">for</span>&nbsp;<span class="ident" id="6885321">j</span>&nbsp;<span class="op" id="6885323">:=</span>&nbsp;<span class="keyword" id="6885326">range</span>&nbsp;<span class="ident" id="6885332"><a href="/gostd/encoding/json/stream_test.go.html#6885259">out</a></span>&nbsp;<span class="op" id="6885336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6885341">if</span>&nbsp;<span class="ident" id="6885344">err</span>&nbsp;<span class="op" id="6885348">:=</span>&nbsp;<span class="ident" id="6885351"><a href="/gostd/encoding/json/stream_test.go.html#6885291">dec</a></span><span class="op" id="6885354">.</span><span class="ident" id="6885355"><a href="/gostd/encoding/json/stream.go.html#4044912">Decode</a></span><span class="op" id="6885361">(</span><span class="op" id="6885362">&amp;</span><span class="ident" id="6885363"><a href="/gostd/encoding/json/stream_test.go.html#6885259">out</a></span><span class="op" id="6885366">[</span><span class="ident" id="6885367"><a href="/gostd/encoding/json/stream_test.go.html#6885321">j</a></span><span class="op" id="6885368">]</span><span class="op" id="6885369">)</span><span class="op" id="6885370">;</span>&nbsp;<span class="ident" id="6885372"><a href="/gostd/encoding/json/stream_test.go.html#6885344">err</a></span>&nbsp;<span class="op" id="6885376">!=</span>&nbsp;<span class="builtintype" id="6885379">nil</span>&nbsp;<span class="op" id="6885383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6885389"><a href="/gostd/encoding/json/stream_test.go.html#6884856">t</a></span><span class="op" id="6885390">.</span><span class="ident" id="6885391"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="6885397">(</span><span class="string" id="6885398">&#34;decode&nbsp;#%d/%d:&nbsp;%v&#34;</span><span class="op" id="6885417">,</span>&nbsp;<span class="ident" id="6885419"><a href="/gostd/encoding/json/stream_test.go.html#6885321">j</a></span><span class="op" id="6885420">,</span>&nbsp;<span class="ident" id="6885422"><a href="/gostd/encoding/json/stream_test.go.html#6884877">i</a></span><span class="op" id="6885423">,</span>&nbsp;<span class="ident" id="6885425"><a href="/gostd/encoding/json/stream_test.go.html#6885344">err</a></span><span class="op" id="6885428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6885433">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6885437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6885441">if</span>&nbsp;<span class="op" id="6885444">!</span><span class="ident" id="6885445"><a href="/gostd/encoding/json/stream_test.go.html#6883989">reflect</a></span><span class="op" id="6885452">.</span><span class="ident" id="6885453"><a href="/gostd/reflect/deepequal.go.html#2775472">DeepEqual</a></span><span class="op" id="6885462">(</span><span class="ident" id="6885463"><a href="/gostd/encoding/json/stream_test.go.html#6885259">out</a></span><span class="op" id="6885466">,</span>&nbsp;<span class="ident" id="6885468"><a href="/gostd/encoding/json/stream_test.go.html#6884090">streamTest</a></span><span class="op" id="6885478">[</span><span class="num" id="6885479">0</span><span class="op" id="6885480">:</span><span class="ident" id="6885481"><a href="/gostd/encoding/json/stream_test.go.html#6884877">i</a></span><span class="op" id="6885482">]</span><span class="op" id="6885483">)</span>&nbsp;<span class="op" id="6885485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6885490"><a href="/gostd/encoding/json/stream_test.go.html#6884856">t</a></span><span class="op" id="6885491">.</span><span class="ident" id="6885492"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6885498">(</span><span class="string" id="6885499">&#34;decoding&nbsp;%d&nbsp;items:&nbsp;mismatch&#34;</span><span class="op" id="6885528">,</span>&nbsp;<span class="ident" id="6885530"><a href="/gostd/encoding/json/stream_test.go.html#6884877">i</a></span><span class="op" id="6885531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6885536">for</span>&nbsp;<span class="ident" id="6885540">j</span>&nbsp;<span class="op" id="6885542">:=</span>&nbsp;<span class="keyword" id="6885545">range</span>&nbsp;<span class="ident" id="6885551"><a href="/gostd/encoding/json/stream_test.go.html#6885259">out</a></span>&nbsp;<span class="op" id="6885555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6885561">if</span>&nbsp;<span class="op" id="6885564">!</span><span class="ident" id="6885565"><a href="/gostd/encoding/json/stream_test.go.html#6883989">reflect</a></span><span class="op" id="6885572">.</span><span class="ident" id="6885573"><a href="/gostd/reflect/deepequal.go.html#2775472">DeepEqual</a></span><span class="op" id="6885582">(</span><span class="ident" id="6885583"><a href="/gostd/encoding/json/stream_test.go.html#6885259">out</a></span><span class="op" id="6885586">[</span><span class="ident" id="6885587"><a href="/gostd/encoding/json/stream_test.go.html#6885540">j</a></span><span class="op" id="6885588">]</span><span class="op" id="6885589">,</span>&nbsp;<span class="ident" id="6885591"><a href="/gostd/encoding/json/stream_test.go.html#6884090">streamTest</a></span><span class="op" id="6885601">[</span><span class="ident" id="6885602"><a href="/gostd/encoding/json/stream_test.go.html#6885540">j</a></span><span class="op" id="6885603">]</span><span class="op" id="6885604">)</span>&nbsp;<span class="op" id="6885606">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6885613"><a href="/gostd/encoding/json/stream_test.go.html#6884856">t</a></span><span class="op" id="6885614">.</span><span class="ident" id="6885615"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6885621">(</span><span class="string" id="6885622">&#34;#%d:&nbsp;have&nbsp;%v&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6885644">,</span>&nbsp;<span class="ident" id="6885646"><a href="/gostd/encoding/json/stream_test.go.html#6885540">j</a></span><span class="op" id="6885647">,</span>&nbsp;<span class="ident" id="6885649"><a href="/gostd/encoding/json/stream_test.go.html#6885259">out</a></span><span class="op" id="6885652">[</span><span class="ident" id="6885653"><a href="/gostd/encoding/json/stream_test.go.html#6885540">j</a></span><span class="op" id="6885654">]</span><span class="op" id="6885655">,</span>&nbsp;<span class="ident" id="6885657"><a href="/gostd/encoding/json/stream_test.go.html#6884090">streamTest</a></span><span class="op" id="6885667">[</span><span class="ident" id="6885668"><a href="/gostd/encoding/json/stream_test.go.html#6885540">j</a></span><span class="op" id="6885669">]</span><span class="op" id="6885670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6885676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6885681">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6885686">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6885694">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6885697">}</span><br>
<span class="lineno"></span><span class="op" id="6885699">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6885702">func</span>&nbsp;<span class="ident" id="6885707">TestDecoderBuffered</span><span class="op" id="6885726">(</span><span class="ident" id="6885727">t</span>&nbsp;<span class="op" id="6885729">*</span><span class="ident" id="6885730"><a href="/gostd/encoding/json/stream_test.go.html#6884011">testing</a></span><span class="op" id="6885737">.</span><span class="ident" id="6885738"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="6885739">)</span>&nbsp;<span class="op" id="6885741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6885744">r</span>&nbsp;<span class="op" id="6885746">:=</span>&nbsp;<span class="ident" id="6885749"><a href="/gostd/encoding/json/stream_test.go.html#6884000">strings</a></span><span class="op" id="6885756">.</span><span class="ident" id="6885757"><a href="/gostd/strings/reader.go.html#2948317">NewReader</a></span><span class="op" id="6885766">(</span><span class="string" id="6885767">`{&#34;Name&#34;:&nbsp;&#34;Gopher&#34;}&nbsp;extra&nbsp;`</span><span class="op" id="6885794">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6885797">var</span>&nbsp;<span class="ident" id="6885801">m</span>&nbsp;<span class="keyword" id="6885803">struct</span>&nbsp;<span class="op" id="6885810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6885814">Name</span>&nbsp;<span class="builtintype" id="6885819">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6885827">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6885830">d</span>&nbsp;<span class="op" id="6885832">:=</span>&nbsp;<span class="ident" id="6885835"><a href="/gostd/encoding/json/stream.go.html#4044448">NewDecoder</a></span><span class="op" id="6885845">(</span><span class="ident" id="6885846"><a href="/gostd/encoding/json/stream_test.go.html#6885744">r</a></span><span class="op" id="6885847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6885850">err</span>&nbsp;<span class="op" id="6885854">:=</span>&nbsp;<span class="ident" id="6885857"><a href="/gostd/encoding/json/stream_test.go.html#6885830">d</a></span><span class="op" id="6885858">.</span><span class="ident" id="6885859"><a href="/gostd/encoding/json/stream.go.html#4044912">Decode</a></span><span class="op" id="6885865">(</span><span class="op" id="6885866">&amp;</span><span class="ident" id="6885867"><a href="/gostd/encoding/json/stream_test.go.html#6885801">m</a></span><span class="op" id="6885868">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6885871">if</span>&nbsp;<span class="ident" id="6885874"><a href="/gostd/encoding/json/stream_test.go.html#6885850">err</a></span>&nbsp;<span class="op" id="6885878">!=</span>&nbsp;<span class="builtintype" id="6885881">nil</span>&nbsp;<span class="op" id="6885885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6885889"><a href="/gostd/encoding/json/stream_test.go.html#6885727">t</a></span><span class="op" id="6885890">.</span><span class="ident" id="6885891"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="6885896">(</span><span class="ident" id="6885897"><a href="/gostd/encoding/json/stream_test.go.html#6885850">err</a></span><span class="op" id="6885900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6885903">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6885906">if</span>&nbsp;<span class="ident" id="6885909"><a href="/gostd/encoding/json/stream_test.go.html#6885801">m</a></span><span class="op" id="6885910">.</span><span class="ident" id="6885911"><a href="/gostd/encoding/json/stream_test.go.html#6885814">Name</a></span>&nbsp;<span class="op" id="6885916">!=</span>&nbsp;<span class="string" id="6885919">&#34;Gopher&#34;</span>&nbsp;<span class="op" id="6885928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6885932"><a href="/gostd/encoding/json/stream_test.go.html#6885727">t</a></span><span class="op" id="6885933">.</span><span class="ident" id="6885934"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6885940">(</span><span class="string" id="6885941">&#34;Name&nbsp;=&nbsp;%q;&nbsp;want&nbsp;Gopher&#34;</span><span class="op" id="6885965">,</span>&nbsp;<span class="ident" id="6885967"><a href="/gostd/encoding/json/stream_test.go.html#6885801">m</a></span><span class="op" id="6885968">.</span><span class="ident" id="6885969"><a href="/gostd/encoding/json/stream_test.go.html#6885814">Name</a></span><span class="op" id="6885973">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6885976">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6885979">rest</span><span class="op" id="6885983">,</span>&nbsp;<span class="ident" id="6885985"><a href="/gostd/encoding/json/stream_test.go.html#6885850">err</a></span>&nbsp;<span class="op" id="6885989">:=</span>&nbsp;<span class="ident" id="6885992"><a href="/gostd/encoding/json/stream_test.go.html#6883969">ioutil</a></span><span class="op" id="6885998">.</span><span class="ident" id="6885999"><a href="/gostd/io/ioutil/ioutil.go.html#3765117">ReadAll</a></span><span class="op" id="6886006">(</span><span class="ident" id="6886007"><a href="/gostd/encoding/json/stream_test.go.html#6885830">d</a></span><span class="op" id="6886008">.</span><span class="ident" id="6886009"><a href="/gostd/encoding/json/stream.go.html#4045515">Buffered</a></span><span class="op" id="6886017">(</span><span class="op" id="6886018">)</span><span class="op" id="6886019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6886022">if</span>&nbsp;<span class="ident" id="6886025"><a href="/gostd/encoding/json/stream_test.go.html#6885850">err</a></span>&nbsp;<span class="op" id="6886029">!=</span>&nbsp;<span class="builtintype" id="6886032">nil</span>&nbsp;<span class="op" id="6886036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6886040"><a href="/gostd/encoding/json/stream_test.go.html#6885727">t</a></span><span class="op" id="6886041">.</span><span class="ident" id="6886042"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="6886047">(</span><span class="ident" id="6886048"><a href="/gostd/encoding/json/stream_test.go.html#6885850">err</a></span><span class="op" id="6886051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6886054">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6886057">if</span>&nbsp;<span class="ident" id="6886060">g</span><span class="op" id="6886061">,</span>&nbsp;<span class="ident" id="6886063">w</span>&nbsp;<span class="op" id="6886065">:=</span>&nbsp;<span class="builtintype" id="6886068">string</span><span class="op" id="6886074">(</span><span class="ident" id="6886075"><a href="/gostd/encoding/json/stream_test.go.html#6885979">rest</a></span><span class="op" id="6886079">)</span><span class="op" id="6886080">,</span>&nbsp;<span class="string" id="6886082">&#34;&nbsp;extra&nbsp;&#34;</span><span class="op" id="6886091">;</span>&nbsp;<span class="ident" id="6886093"><a href="/gostd/encoding/json/stream_test.go.html#6886060">g</a></span>&nbsp;<span class="op" id="6886095">!=</span>&nbsp;<span class="ident" id="6886098"><a href="/gostd/encoding/json/stream_test.go.html#6886063">w</a></span>&nbsp;<span class="op" id="6886100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6886104"><a href="/gostd/encoding/json/stream_test.go.html#6885727">t</a></span><span class="op" id="6886105">.</span><span class="ident" id="6886106"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6886112">(</span><span class="string" id="6886113">&#34;Remaining&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6886138">,</span>&nbsp;<span class="ident" id="6886140"><a href="/gostd/encoding/json/stream_test.go.html#6886060">g</a></span><span class="op" id="6886141">,</span>&nbsp;<span class="ident" id="6886143"><a href="/gostd/encoding/json/stream_test.go.html#6886063">w</a></span><span class="op" id="6886144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6886147">}</span><br>
<span class="lineno"></span><span class="op" id="6886149">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="keyword" id="6886152">func</span>&nbsp;<span class="ident" id="6886157">nlines</span><span class="op" id="6886163">(</span><span class="ident" id="6886164">s</span>&nbsp;<span class="builtintype" id="6886166">string</span><span class="op" id="6886172">,</span>&nbsp;<span class="ident" id="6886174">n</span>&nbsp;<span class="builtintype" id="6886176">int</span><span class="op" id="6886179">)</span>&nbsp;<span class="builtintype" id="6886181">string</span>&nbsp;<span class="op" id="6886188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6886191">if</span>&nbsp;<span class="ident" id="6886194"><a href="/gostd/encoding/json/stream_test.go.html#6886174">n</a></span>&nbsp;<span class="op" id="6886196">&lt;=</span>&nbsp;<span class="num" id="6886199">0</span>&nbsp;<span class="op" id="6886201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6886205">return</span>&nbsp;<span class="string" id="6886212">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6886216">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6886219">for</span>&nbsp;<span class="ident" id="6886223">i</span><span class="op" id="6886224">,</span>&nbsp;<span class="ident" id="6886226">c</span>&nbsp;<span class="op" id="6886228">:=</span>&nbsp;<span class="keyword" id="6886231">range</span>&nbsp;<span class="ident" id="6886237"><a href="/gostd/encoding/json/stream_test.go.html#6886164">s</a></span>&nbsp;<span class="op" id="6886239">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6886243">if</span>&nbsp;<span class="ident" id="6886246"><a href="/gostd/encoding/json/stream_test.go.html#6886226">c</a></span>&nbsp;<span class="op" id="6886248">==</span>&nbsp;<span class="string" id="6886251">&#39;\n&#39;</span>&nbsp;<span class="op" id="6886256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6886261">if</span>&nbsp;<span class="ident" id="6886264"><a href="/gostd/encoding/json/stream_test.go.html#6886174">n</a></span><span class="op" id="6886265">--</span><span class="op" id="6886267">;</span>&nbsp;<span class="ident" id="6886269"><a href="/gostd/encoding/json/stream_test.go.html#6886174">n</a></span>&nbsp;<span class="op" id="6886271">==</span>&nbsp;<span class="num" id="6886274">0</span>&nbsp;<span class="op" id="6886276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6886282">return</span>&nbsp;<span class="ident" id="6886289"><a href="/gostd/encoding/json/stream_test.go.html#6886164">s</a></span><span class="op" id="6886290">[</span><span class="num" id="6886291">0</span>&nbsp;<span class="op" id="6886293">:</span>&nbsp;<span class="ident" id="6886295"><a href="/gostd/encoding/json/stream_test.go.html#6886223">i</a></span><span class="op" id="6886296">+</span><span class="num" id="6886297">1</span><span class="op" id="6886298">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6886303">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6886307">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6886310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6886313">return</span>&nbsp;<span class="ident" id="6886320"><a href="/gostd/encoding/json/stream_test.go.html#6886164">s</a></span><br>
<span class="lineno"></span><span class="op" id="6886322">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6886325">func</span>&nbsp;<span class="ident" id="6886330">TestRawMessage</span><span class="op" id="6886344">(</span><span class="ident" id="6886345">t</span>&nbsp;<span class="op" id="6886347">*</span><span class="ident" id="6886348"><a href="/gostd/encoding/json/stream_test.go.html#6884011">testing</a></span><span class="op" id="6886355">.</span><span class="ident" id="6886356"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="6886357">)</span>&nbsp;<span class="op" id="6886359">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6886362">//&nbsp;TODO(rsc):&nbsp;Should&nbsp;not&nbsp;need&nbsp;the&nbsp;*&nbsp;in&nbsp;*RawMessage</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6886414">var</span>&nbsp;<span class="ident" id="6886418">data</span>&nbsp;<span class="keyword" id="6886423">struct</span>&nbsp;<span class="op" id="6886430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6886434">X</span>&nbsp;&nbsp;<span class="builtintype" id="6886437">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6886447">Id</span>&nbsp;<span class="op" id="6886450">*</span><span class="ident" id="6886451"><a href="/gostd/encoding/json/stream.go.html#4048300">RawMessage</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6886464">Y</span>&nbsp;&nbsp;<span class="builtintype" id="6886467">float32</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6886476">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6886479">const</span>&nbsp;<span class="ident" id="6886485">raw</span>&nbsp;<span class="op" id="6886489">=</span>&nbsp;<span class="string" id="6886491">`[&#34;\u0056&#34;,null]`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6886510">const</span>&nbsp;<span class="ident" id="6886516">msg</span>&nbsp;<span class="op" id="6886520">=</span>&nbsp;<span class="string" id="6886522">`{&#34;X&#34;:0.1,&#34;Id&#34;:[&#34;\u0056&#34;,null],&#34;Y&#34;:0.2}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6886564">err</span>&nbsp;<span class="op" id="6886568">:=</span>&nbsp;<span class="ident" id="6886571"><a href="/gostd/encoding/json/decode.go.html#3965482">Unmarshal</a></span><span class="op" id="6886580">(</span><span class="op" id="6886581">[</span><span class="op" id="6886582">]</span><span class="builtintype" id="6886583">byte</span><span class="op" id="6886587">(</span><span class="ident" id="6886588"><a href="/gostd/encoding/json/stream_test.go.html#6886516">msg</a></span><span class="op" id="6886591">)</span><span class="op" id="6886592">,</span>&nbsp;<span class="op" id="6886594">&amp;</span><span class="ident" id="6886595"><a href="/gostd/encoding/json/stream_test.go.html#6886418">data</a></span><span class="op" id="6886599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6886602">if</span>&nbsp;<span class="ident" id="6886605"><a href="/gostd/encoding/json/stream_test.go.html#6886564">err</a></span>&nbsp;<span class="op" id="6886609">!=</span>&nbsp;<span class="builtintype" id="6886612">nil</span>&nbsp;<span class="op" id="6886616">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6886620"><a href="/gostd/encoding/json/stream_test.go.html#6886345">t</a></span><span class="op" id="6886621">.</span><span class="ident" id="6886622"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="6886628">(</span><span class="string" id="6886629">&#34;Unmarshal:&nbsp;%v&#34;</span><span class="op" id="6886644">,</span>&nbsp;<span class="ident" id="6886646"><a href="/gostd/encoding/json/stream_test.go.html#6886564">err</a></span><span class="op" id="6886649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6886652">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6886655">if</span>&nbsp;<span class="builtintype" id="6886658">string</span><span class="op" id="6886664">(</span><span class="op" id="6886665">[</span><span class="op" id="6886666">]</span><span class="builtintype" id="6886667">byte</span><span class="op" id="6886671">(</span><span class="op" id="6886672">*</span><span class="ident" id="6886673"><a href="/gostd/encoding/json/stream_test.go.html#6886418">data</a></span><span class="op" id="6886677">.</span><span class="ident" id="6886678"><a href="/gostd/encoding/json/stream_test.go.html#6886447">Id</a></span><span class="op" id="6886680">)</span><span class="op" id="6886681">)</span>&nbsp;<span class="op" id="6886683">!=</span>&nbsp;<span class="ident" id="6886686"><a href="/gostd/encoding/json/stream_test.go.html#6886485">raw</a></span>&nbsp;<span class="op" id="6886690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6886694"><a href="/gostd/encoding/json/stream_test.go.html#6886345">t</a></span><span class="op" id="6886695">.</span><span class="ident" id="6886696"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="6886702">(</span><span class="string" id="6886703">&#34;Raw&nbsp;mismatch:&nbsp;have&nbsp;%#q&nbsp;want&nbsp;%#q&#34;</span><span class="op" id="6886736">,</span>&nbsp;<span class="op" id="6886738">[</span><span class="op" id="6886739">]</span><span class="builtintype" id="6886740">byte</span><span class="op" id="6886744">(</span><span class="op" id="6886745">*</span><span class="ident" id="6886746"><a href="/gostd/encoding/json/stream_test.go.html#6886418">data</a></span><span class="op" id="6886750">.</span><span class="ident" id="6886751"><a href="/gostd/encoding/json/stream_test.go.html#6886447">Id</a></span><span class="op" id="6886753">)</span><span class="op" id="6886754">,</span>&nbsp;<span class="ident" id="6886756"><a href="/gostd/encoding/json/stream_test.go.html#6886485">raw</a></span><span class="op" id="6886759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6886762">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6886765">b</span><span class="op" id="6886766">,</span>&nbsp;<span class="ident" id="6886768"><a href="/gostd/encoding/json/stream_test.go.html#6886564">err</a></span>&nbsp;<span class="op" id="6886772">:=</span>&nbsp;<span class="ident" id="6886775"><a href="/gostd/encoding/json/encode.go.html#3995033">Marshal</a></span><span class="op" id="6886782">(</span><span class="op" id="6886783">&amp;</span><span class="ident" id="6886784"><a href="/gostd/encoding/json/stream_test.go.html#6886418">data</a></span><span class="op" id="6886788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6886791">if</span>&nbsp;<span class="ident" id="6886794"><a href="/gostd/encoding/json/stream_test.go.html#6886564">err</a></span>&nbsp;<span class="op" id="6886798">!=</span>&nbsp;<span class="builtintype" id="6886801">nil</span>&nbsp;<span class="op" id="6886805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6886809"><a href="/gostd/encoding/json/stream_test.go.html#6886345">t</a></span><span class="op" id="6886810">.</span><span class="ident" id="6886811"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="6886817">(</span><span class="string" id="6886818">&#34;Marshal:&nbsp;%v&#34;</span><span class="op" id="6886831">,</span>&nbsp;<span class="ident" id="6886833"><a href="/gostd/encoding/json/stream_test.go.html#6886564">err</a></span><span class="op" id="6886836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6886839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6886842">if</span>&nbsp;<span class="builtintype" id="6886845">string</span><span class="op" id="6886851">(</span><span class="ident" id="6886852"><a href="/gostd/encoding/json/stream_test.go.html#6886765">b</a></span><span class="op" id="6886853">)</span>&nbsp;<span class="op" id="6886855">!=</span>&nbsp;<span class="ident" id="6886858"><a href="/gostd/encoding/json/stream_test.go.html#6886516">msg</a></span>&nbsp;<span class="op" id="6886862">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6886866"><a href="/gostd/encoding/json/stream_test.go.html#6886345">t</a></span><span class="op" id="6886867">.</span><span class="ident" id="6886868"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="6886874">(</span><span class="string" id="6886875">&#34;Marshal:&nbsp;have&nbsp;%#q&nbsp;want&nbsp;%#q&#34;</span><span class="op" id="6886903">,</span>&nbsp;<span class="ident" id="6886905"><a href="/gostd/encoding/json/stream_test.go.html#6886765">b</a></span><span class="op" id="6886906">,</span>&nbsp;<span class="ident" id="6886908"><a href="/gostd/encoding/json/stream_test.go.html#6886516">msg</a></span><span class="op" id="6886911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6886914">}</span><br>
<span class="lineno"></span><span class="op" id="6886916">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6886919">func</span>&nbsp;<span class="ident" id="6886924">TestNullRawMessage</span><span class="op" id="6886942">(</span><span class="ident" id="6886943">t</span>&nbsp;<span class="op" id="6886945">*</span><span class="ident" id="6886946"><a href="/gostd/encoding/json/stream_test.go.html#6884011">testing</a></span><span class="op" id="6886953">.</span><span class="ident" id="6886954"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="6886955">)</span>&nbsp;<span class="op" id="6886957">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6886960">//&nbsp;TODO(rsc):&nbsp;Should&nbsp;not&nbsp;need&nbsp;the&nbsp;*&nbsp;in&nbsp;*RawMessage</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6887012">var</span>&nbsp;<span class="ident" id="6887016">data</span>&nbsp;<span class="keyword" id="6887021">struct</span>&nbsp;<span class="op" id="6887028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6887032">X</span>&nbsp;&nbsp;<span class="builtintype" id="6887035">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6887045">Id</span>&nbsp;<span class="op" id="6887048">*</span><span class="ident" id="6887049"><a href="/gostd/encoding/json/stream.go.html#4048300">RawMessage</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6887062">Y</span>&nbsp;&nbsp;<span class="builtintype" id="6887065">float32</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6887074">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6887077"><a href="/gostd/encoding/json/stream_test.go.html#6887016">data</a></span><span class="op" id="6887081">.</span><span class="ident" id="6887082"><a href="/gostd/encoding/json/stream_test.go.html#6887045">Id</a></span>&nbsp;<span class="op" id="6887085">=</span>&nbsp;<span class="builtinfunc" id="6887087">new</span><span class="op" id="6887090">(</span><span class="ident" id="6887091"><a href="/gostd/encoding/json/stream.go.html#4048300">RawMessage</a></span><span class="op" id="6887101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6887104">const</span>&nbsp;<span class="ident" id="6887110">msg</span>&nbsp;<span class="op" id="6887114">=</span>&nbsp;<span class="string" id="6887116">`{&#34;X&#34;:0.1,&#34;Id&#34;:null,&#34;Y&#34;:0.2}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6887147">err</span>&nbsp;<span class="op" id="6887151">:=</span>&nbsp;<span class="ident" id="6887154"><a href="/gostd/encoding/json/decode.go.html#3965482">Unmarshal</a></span><span class="op" id="6887163">(</span><span class="op" id="6887164">[</span><span class="op" id="6887165">]</span><span class="builtintype" id="6887166">byte</span><span class="op" id="6887170">(</span><span class="ident" id="6887171"><a href="/gostd/encoding/json/stream_test.go.html#6887110">msg</a></span><span class="op" id="6887174">)</span><span class="op" id="6887175">,</span>&nbsp;<span class="op" id="6887177">&amp;</span><span class="ident" id="6887178"><a href="/gostd/encoding/json/stream_test.go.html#6887016">data</a></span><span class="op" id="6887182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6887185">if</span>&nbsp;<span class="ident" id="6887188"><a href="/gostd/encoding/json/stream_test.go.html#6887147">err</a></span>&nbsp;<span class="op" id="6887192">!=</span>&nbsp;<span class="builtintype" id="6887195">nil</span>&nbsp;<span class="op" id="6887199">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6887203"><a href="/gostd/encoding/json/stream_test.go.html#6886943">t</a></span><span class="op" id="6887204">.</span><span class="ident" id="6887205"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="6887211">(</span><span class="string" id="6887212">&#34;Unmarshal:&nbsp;%v&#34;</span><span class="op" id="6887227">,</span>&nbsp;<span class="ident" id="6887229"><a href="/gostd/encoding/json/stream_test.go.html#6887147">err</a></span><span class="op" id="6887232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6887235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6887238">if</span>&nbsp;<span class="ident" id="6887241"><a href="/gostd/encoding/json/stream_test.go.html#6887016">data</a></span><span class="op" id="6887245">.</span><span class="ident" id="6887246"><a href="/gostd/encoding/json/stream_test.go.html#6887045">Id</a></span>&nbsp;<span class="op" id="6887249">!=</span>&nbsp;<span class="builtintype" id="6887252">nil</span>&nbsp;<span class="op" id="6887256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6887260"><a href="/gostd/encoding/json/stream_test.go.html#6886943">t</a></span><span class="op" id="6887261">.</span><span class="ident" id="6887262"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="6887268">(</span><span class="string" id="6887269">&#34;Raw&nbsp;mismatch:&nbsp;have&nbsp;non-nil,&nbsp;want&nbsp;nil&#34;</span><span class="op" id="6887307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6887310">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6887313">b</span><span class="op" id="6887314">,</span>&nbsp;<span class="ident" id="6887316"><a href="/gostd/encoding/json/stream_test.go.html#6887147">err</a></span>&nbsp;<span class="op" id="6887320">:=</span>&nbsp;<span class="ident" id="6887323"><a href="/gostd/encoding/json/encode.go.html#3995033">Marshal</a></span><span class="op" id="6887330">(</span><span class="op" id="6887331">&amp;</span><span class="ident" id="6887332"><a href="/gostd/encoding/json/stream_test.go.html#6887016">data</a></span><span class="op" id="6887336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6887339">if</span>&nbsp;<span class="ident" id="6887342"><a href="/gostd/encoding/json/stream_test.go.html#6887147">err</a></span>&nbsp;<span class="op" id="6887346">!=</span>&nbsp;<span class="builtintype" id="6887349">nil</span>&nbsp;<span class="op" id="6887353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6887357"><a href="/gostd/encoding/json/stream_test.go.html#6886943">t</a></span><span class="op" id="6887358">.</span><span class="ident" id="6887359"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="6887365">(</span><span class="string" id="6887366">&#34;Marshal:&nbsp;%v&#34;</span><span class="op" id="6887379">,</span>&nbsp;<span class="ident" id="6887381"><a href="/gostd/encoding/json/stream_test.go.html#6887147">err</a></span><span class="op" id="6887384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6887387">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6887390">if</span>&nbsp;<span class="builtintype" id="6887393">string</span><span class="op" id="6887399">(</span><span class="ident" id="6887400"><a href="/gostd/encoding/json/stream_test.go.html#6887313">b</a></span><span class="op" id="6887401">)</span>&nbsp;<span class="op" id="6887403">!=</span>&nbsp;<span class="ident" id="6887406"><a href="/gostd/encoding/json/stream_test.go.html#6887110">msg</a></span>&nbsp;<span class="op" id="6887410">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6887414"><a href="/gostd/encoding/json/stream_test.go.html#6886943">t</a></span><span class="op" id="6887415">.</span><span class="ident" id="6887416"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="6887422">(</span><span class="string" id="6887423">&#34;Marshal:&nbsp;have&nbsp;%#q&nbsp;want&nbsp;%#q&#34;</span><span class="op" id="6887451">,</span>&nbsp;<span class="ident" id="6887453"><a href="/gostd/encoding/json/stream_test.go.html#6887313">b</a></span><span class="op" id="6887454">,</span>&nbsp;<span class="ident" id="6887456"><a href="/gostd/encoding/json/stream_test.go.html#6887110">msg</a></span><span class="op" id="6887459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6887462">}</span><br>
<span class="lineno"></span><span class="op" id="6887464">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6887467">var</span>&nbsp;<span class="ident" id="6887471">blockingTests</span>&nbsp;<span class="op" id="6887485">=</span>&nbsp;<span class="op" id="6887487">[</span><span class="op" id="6887488">]</span><span class="builtintype" id="6887489">string</span><span class="op" id="6887495">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6887498">`{&#34;x&#34;:&nbsp;1}`</span><span class="op" id="6887508">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6887511">`[1,&nbsp;2,&nbsp;3]`</span><span class="op" id="6887522">,</span><br>
<span class="lineno"></span><span class="op" id="6887524">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6887527">func</span>&nbsp;<span class="ident" id="6887532">TestBlocking</span><span class="op" id="6887544">(</span><span class="ident" id="6887545">t</span>&nbsp;<span class="op" id="6887547">*</span><span class="ident" id="6887548"><a href="/gostd/encoding/json/stream_test.go.html#6884011">testing</a></span><span class="op" id="6887555">.</span><span class="ident" id="6887556"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="6887557">)</span>&nbsp;<span class="op" id="6887559">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6887562">for</span>&nbsp;<span class="ident" id="6887566">_</span><span class="op" id="6887567">,</span>&nbsp;<span class="ident" id="6887569">enc</span>&nbsp;<span class="op" id="6887573">:=</span>&nbsp;<span class="keyword" id="6887576">range</span>&nbsp;<span class="ident" id="6887582"><a href="/gostd/encoding/json/stream_test.go.html#6887471">blockingTests</a></span>&nbsp;<span class="op" id="6887596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6887600">r</span><span class="op" id="6887601">,</span>&nbsp;<span class="ident" id="6887603">w</span>&nbsp;<span class="op" id="6887605">:=</span>&nbsp;<span class="ident" id="6887608"><a href="/gostd/encoding/json/stream_test.go.html#6883982">net</a></span><span class="op" id="6887611">.</span><span class="ident" id="6887612"><a href="/gostd/net/pipe.go.html#3349719">Pipe</a></span><span class="op" id="6887616">(</span><span class="op" id="6887617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6887621">go</span>&nbsp;<span class="ident" id="6887624"><a href="/gostd/encoding/json/stream_test.go.html#6887603">w</a></span><span class="op" id="6887625">.</span><span class="ident" id="6887626"><a href="/gostd/net/net.go.html#3334839">Write</a></span><span class="op" id="6887631">(</span><span class="op" id="6887632">[</span><span class="op" id="6887633">]</span><span class="builtintype" id="6887634">byte</span><span class="op" id="6887638">(</span><span class="ident" id="6887639"><a href="/gostd/encoding/json/stream_test.go.html#6887569">enc</a></span><span class="op" id="6887642">)</span><span class="op" id="6887643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6887647">var</span>&nbsp;<span class="ident" id="6887651">val</span>&nbsp;<span class="keyword" id="6887655">interface</span><span class="op" id="6887664">{</span><span class="op" id="6887665">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6887670">//&nbsp;If&nbsp;Decode&nbsp;reads&nbsp;beyond&nbsp;what&nbsp;w.Write&nbsp;writes&nbsp;above,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6887725">//&nbsp;it&nbsp;will&nbsp;block,&nbsp;and&nbsp;the&nbsp;test&nbsp;will&nbsp;deadlock.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6887773">if</span>&nbsp;<span class="ident" id="6887776">err</span>&nbsp;<span class="op" id="6887780">:=</span>&nbsp;<span class="ident" id="6887783"><a href="/gostd/encoding/json/stream.go.html#4044448">NewDecoder</a></span><span class="op" id="6887793">(</span><span class="ident" id="6887794"><a href="/gostd/encoding/json/stream_test.go.html#6887600">r</a></span><span class="op" id="6887795">)</span><span class="op" id="6887796">.</span><span class="ident" id="6887797"><a href="/gostd/encoding/json/stream.go.html#4044912">Decode</a></span><span class="op" id="6887803">(</span><span class="op" id="6887804">&amp;</span><span class="ident" id="6887805"><a href="/gostd/encoding/json/stream_test.go.html#6887651">val</a></span><span class="op" id="6887808">)</span><span class="op" id="6887809">;</span>&nbsp;<span class="ident" id="6887811"><a href="/gostd/encoding/json/stream_test.go.html#6887776">err</a></span>&nbsp;<span class="op" id="6887815">!=</span>&nbsp;<span class="builtintype" id="6887818">nil</span>&nbsp;<span class="op" id="6887822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6887827"><a href="/gostd/encoding/json/stream_test.go.html#6887545">t</a></span><span class="op" id="6887828">.</span><span class="ident" id="6887829"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6887835">(</span><span class="string" id="6887836">&#34;decoding&nbsp;%s:&nbsp;%v&#34;</span><span class="op" id="6887853">,</span>&nbsp;<span class="ident" id="6887855"><a href="/gostd/encoding/json/stream_test.go.html#6887569">enc</a></span><span class="op" id="6887858">,</span>&nbsp;<span class="ident" id="6887860"><a href="/gostd/encoding/json/stream_test.go.html#6887776">err</a></span><span class="op" id="6887863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6887867">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6887871"><a href="/gostd/encoding/json/stream_test.go.html#6887600">r</a></span><span class="op" id="6887872">.</span><span class="ident" id="6887873"><a href="/gostd/net/net.go.html#3334987">Close</a></span><span class="op" id="6887878">(</span><span class="op" id="6887879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6887883"><a href="/gostd/encoding/json/stream_test.go.html#6887603">w</a></span><span class="op" id="6887884">.</span><span class="ident" id="6887885"><a href="/gostd/net/net.go.html#3334987">Close</a></span><span class="op" id="6887890">(</span><span class="op" id="6887891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6887894">}</span><br>
<span class="lineno"></span><span class="op" id="6887896">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span><span class="keyword" id="6887899">func</span>&nbsp;<span class="ident" id="6887904">BenchmarkEncoderEncode</span><span class="op" id="6887926">(</span><span class="ident" id="6887927">b</span>&nbsp;<span class="op" id="6887929">*</span><span class="ident" id="6887930"><a href="/gostd/encoding/json/stream_test.go.html#6884011">testing</a></span><span class="op" id="6887937">.</span><span class="ident" id="6887938"><a href="/gostd/testing/benchmark.go.html#5450963">B</a></span><span class="op" id="6887939">)</span>&nbsp;<span class="op" id="6887941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6887944"><a href="/gostd/encoding/json/stream_test.go.html#6887927">b</a></span><span class="op" id="6887945">.</span><span class="ident" id="6887946"><a href="/gostd/testing/benchmark.go.html#5453061">ReportAllocs</a></span><span class="op" id="6887958">(</span><span class="op" id="6887959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6887962">type</span>&nbsp;<span class="ident" id="6887967">T</span>&nbsp;<span class="keyword" id="6887969">struct</span>&nbsp;<span class="op" id="6887976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6887980">X</span><span class="op" id="6887981">,</span>&nbsp;<span class="ident" id="6887983">Y</span>&nbsp;<span class="builtintype" id="6887985">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6887993">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6887996">v</span>&nbsp;<span class="op" id="6887998">:=</span>&nbsp;<span class="op" id="6888001">&amp;</span><span class="ident" id="6888002"><a href="/gostd/encoding/json/stream_test.go.html#6887967">T</a></span><span class="op" id="6888003">{</span><span class="string" id="6888004">&#34;foo&#34;</span><span class="op" id="6888009">,</span>&nbsp;<span class="string" id="6888011">&#34;bar&#34;</span><span class="op" id="6888016">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6888019">for</span>&nbsp;<span class="ident" id="6888023">i</span>&nbsp;<span class="op" id="6888025">:=</span>&nbsp;<span class="num" id="6888028">0</span><span class="op" id="6888029">;</span>&nbsp;<span class="ident" id="6888031"><a href="/gostd/encoding/json/stream_test.go.html#6888023">i</a></span>&nbsp;<span class="op" id="6888033">&lt;</span>&nbsp;<span class="ident" id="6888035"><a href="/gostd/encoding/json/stream_test.go.html#6887927">b</a></span><span class="op" id="6888036">.</span><span class="ident" id="6888037"><a href="/gostd/testing/benchmark.go.html#5450983">N</a></span><span class="op" id="6888038">;</span>&nbsp;<span class="ident" id="6888040"><a href="/gostd/encoding/json/stream_test.go.html#6888023">i</a></span><span class="op" id="6888041">++</span>&nbsp;<span class="op" id="6888044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6888048">if</span>&nbsp;<span class="ident" id="6888051">err</span>&nbsp;<span class="op" id="6888055">:=</span>&nbsp;<span class="ident" id="6888058"><a href="/gostd/encoding/json/stream.go.html#4047341">NewEncoder</a></span><span class="op" id="6888068">(</span><span class="ident" id="6888069"><a href="/gostd/encoding/json/stream_test.go.html#6883969">ioutil</a></span><span class="op" id="6888075">.</span><span class="ident" id="6888076"><a href="/gostd/io/ioutil/ioutil.go.html#3768458">Discard</a></span><span class="op" id="6888083">)</span><span class="op" id="6888084">.</span><span class="ident" id="6888085"><a href="/gostd/encoding/json/stream.go.html#4047611">Encode</a></span><span class="op" id="6888091">(</span><span class="ident" id="6888092"><a href="/gostd/encoding/json/stream_test.go.html#6887996">v</a></span><span class="op" id="6888093">)</span><span class="op" id="6888094">;</span>&nbsp;<span class="ident" id="6888096"><a href="/gostd/encoding/json/stream_test.go.html#6888051">err</a></span>&nbsp;<span class="op" id="6888100">!=</span>&nbsp;<span class="builtintype" id="6888103">nil</span>&nbsp;<span class="op" id="6888107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6888112"><a href="/gostd/encoding/json/stream_test.go.html#6887927">b</a></span><span class="op" id="6888113">.</span><span class="ident" id="6888114"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="6888119">(</span><span class="ident" id="6888120"><a href="/gostd/encoding/json/stream_test.go.html#6888051">err</a></span><span class="op" id="6888123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6888127">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6888130">}</span><br>
<span class="lineno"></span><span class="op" id="6888132">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
