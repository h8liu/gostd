<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="8373877">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8373932">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8373986">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8374037">package</span>&nbsp;<span class="ident" id="8374045">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8374050">import</span>&nbsp;<span class="op" id="8374057">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8374060">&#34;flag&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8374068">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8374075">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8374086">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="8374093">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8374096">var</span>&nbsp;<span class="ident" id="8374100">testDNSFlood</span>&nbsp;<span class="op" id="8374113">=</span>&nbsp;<span class="ident" id="8374115">flag</span><span class="op" id="8374119">.</span><span class="ident" id="8374120">Bool</span><span class="op" id="8374124">(</span><span class="string" id="8374125">&#34;dnsflood&#34;</span><span class="op" id="8374135">,</span>&nbsp;<span class="builtintype" id="8374137">false</span><span class="op" id="8374142">,</span>&nbsp;<span class="string" id="8374144">&#34;whether&nbsp;to&nbsp;test&nbsp;dns&nbsp;query&nbsp;flooding&#34;</span><span class="op" id="8374180">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="8374183">func</span>&nbsp;<span class="ident" id="8374188">TestDNSThreadLimit</span><span class="op" id="8374206">(</span><span class="ident" id="8374207">t</span>&nbsp;<span class="op" id="8374209">*</span><span class="ident" id="8374210">testing</span><span class="op" id="8374217">.</span><span class="ident" id="8374218">T</span><span class="op" id="8374219">)</span>&nbsp;<span class="op" id="8374221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8374224">if</span>&nbsp;<span class="op" id="8374227">!</span><span class="op" id="8374228">*</span><span class="ident" id="8374229">testDNSFlood</span>&nbsp;<span class="op" id="8374242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8374246">t</span><span class="op" id="8374247">.</span><span class="ident" id="8374248">Skip</span><span class="op" id="8374252">(</span><span class="string" id="8374253">&#34;test&nbsp;disabled;&nbsp;use&nbsp;-dnsflood&nbsp;to&nbsp;enable&#34;</span><span class="op" id="8374293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8374296">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8374300">const</span>&nbsp;<span class="ident" id="8374306">N</span>&nbsp;<span class="op" id="8374308">=</span>&nbsp;<span class="num" id="8374310">10000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8374317">c</span>&nbsp;<span class="op" id="8374319">:=</span>&nbsp;<span class="builtinfunc" id="8374322">make</span><span class="op" id="8374326">(</span><span class="keyword" id="8374327">chan</span>&nbsp;<span class="builtintype" id="8374332">int</span><span class="op" id="8374335">,</span>&nbsp;<span class="ident" id="8374337">N</span><span class="op" id="8374338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8374341">for</span>&nbsp;<span class="ident" id="8374345">i</span>&nbsp;<span class="op" id="8374347">:=</span>&nbsp;<span class="num" id="8374350">0</span><span class="op" id="8374351">;</span>&nbsp;<span class="ident" id="8374353">i</span>&nbsp;<span class="op" id="8374355">&lt;</span>&nbsp;<span class="ident" id="8374357">N</span><span class="op" id="8374358">;</span>&nbsp;<span class="ident" id="8374360">i</span><span class="op" id="8374361">++</span>&nbsp;<span class="op" id="8374364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8374368">go</span>&nbsp;<span class="keyword" id="8374371">func</span><span class="op" id="8374375">(</span><span class="ident" id="8374376">i</span>&nbsp;<span class="builtintype" id="8374378">int</span><span class="op" id="8374381">)</span>&nbsp;<span class="op" id="8374383">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8374388">LookupIP</span><span class="op" id="8374396">(</span><span class="ident" id="8374397">fmt</span><span class="op" id="8374400">.</span><span class="ident" id="8374401">Sprintf</span><span class="op" id="8374408">(</span><span class="string" id="8374409">&#34;%d.net-test.golang.org&#34;</span><span class="op" id="8374433">,</span>&nbsp;<span class="ident" id="8374435">i</span><span class="op" id="8374436">)</span><span class="op" id="8374437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8374442">c</span>&nbsp;<span class="op" id="8374444">&lt;-</span>&nbsp;<span class="num" id="8374447">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8374451">}</span><span class="op" id="8374452">(</span><span class="ident" id="8374453">i</span><span class="op" id="8374454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8374457">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8374460">//&nbsp;Don&#39;t&nbsp;bother&nbsp;waiting&nbsp;for&nbsp;the&nbsp;stragglers;&nbsp;stop&nbsp;at&nbsp;0.9&nbsp;N.</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8374520">for</span>&nbsp;<span class="ident" id="8374524">i</span>&nbsp;<span class="op" id="8374526">:=</span>&nbsp;<span class="num" id="8374529">0</span><span class="op" id="8374530">;</span>&nbsp;<span class="ident" id="8374532">i</span>&nbsp;<span class="op" id="8374534">&lt;</span>&nbsp;<span class="ident" id="8374536">N</span><span class="op" id="8374537">*</span><span class="num" id="8374538">9</span><span class="op" id="8374539">/</span><span class="num" id="8374540">10</span><span class="op" id="8374542">;</span>&nbsp;<span class="ident" id="8374544">i</span><span class="op" id="8374545">++</span>&nbsp;<span class="op" id="8374548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8374552">if</span>&nbsp;<span class="ident" id="8374555">i</span><span class="op" id="8374556">%</span><span class="num" id="8374557">100</span>&nbsp;<span class="op" id="8374561">==</span>&nbsp;<span class="num" id="8374564">0</span>&nbsp;<span class="op" id="8374566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8374571">//println(&#34;TestDNSThreadLimit:&#34;,&nbsp;i)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8374609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8374613">&lt;-</span><span class="ident" id="8374615">c</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8374618">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8374622">//&nbsp;If&nbsp;we&#39;re&nbsp;still&nbsp;here,&nbsp;it&nbsp;worked.</span><br>
<span class="lineno"></span><span class="op" id="8374657">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="8374660">func</span>&nbsp;<span class="ident" id="8374665">TestLookupIPDeadline</span><span class="op" id="8374685">(</span><span class="ident" id="8374686">t</span>&nbsp;<span class="op" id="8374688">*</span><span class="ident" id="8374689">testing</span><span class="op" id="8374696">.</span><span class="ident" id="8374697">T</span><span class="op" id="8374698">)</span>&nbsp;<span class="op" id="8374700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8374703">if</span>&nbsp;<span class="op" id="8374706">!</span><span class="op" id="8374707">*</span><span class="ident" id="8374708">testDNSFlood</span>&nbsp;<span class="op" id="8374721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8374725">t</span><span class="op" id="8374726">.</span><span class="ident" id="8374727">Skip</span><span class="op" id="8374731">(</span><span class="string" id="8374732">&#34;test&nbsp;disabled;&nbsp;use&nbsp;-dnsflood&nbsp;to&nbsp;enable&#34;</span><span class="op" id="8374772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8374775">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8374779">const</span>&nbsp;<span class="ident" id="8374785">N</span>&nbsp;<span class="op" id="8374787">=</span>&nbsp;<span class="num" id="8374789">5000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8374795">const</span>&nbsp;<span class="ident" id="8374801">timeout</span>&nbsp;<span class="op" id="8374809">=</span>&nbsp;<span class="num" id="8374811">3</span>&nbsp;<span class="op" id="8374813">*</span>&nbsp;<span class="ident" id="8374815">time</span><span class="op" id="8374819">.</span><span class="ident" id="8374820">Second</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8374828">c</span>&nbsp;<span class="op" id="8374830">:=</span>&nbsp;<span class="builtinfunc" id="8374833">make</span><span class="op" id="8374837">(</span><span class="keyword" id="8374838">chan</span>&nbsp;<span class="builtintype" id="8374843">error</span><span class="op" id="8374848">,</span>&nbsp;<span class="num" id="8374850">2</span><span class="op" id="8374851">*</span><span class="ident" id="8374852">N</span><span class="op" id="8374853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8374856">for</span>&nbsp;<span class="ident" id="8374860">i</span>&nbsp;<span class="op" id="8374862">:=</span>&nbsp;<span class="num" id="8374865">0</span><span class="op" id="8374866">;</span>&nbsp;<span class="ident" id="8374868">i</span>&nbsp;<span class="op" id="8374870">&lt;</span>&nbsp;<span class="ident" id="8374872">N</span><span class="op" id="8374873">;</span>&nbsp;<span class="ident" id="8374875">i</span><span class="op" id="8374876">++</span>&nbsp;<span class="op" id="8374879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8374883">name</span>&nbsp;<span class="op" id="8374888">:=</span>&nbsp;<span class="ident" id="8374891">fmt</span><span class="op" id="8374894">.</span><span class="ident" id="8374895">Sprintf</span><span class="op" id="8374902">(</span><span class="string" id="8374903">&#34;%d.net-test.golang.org&#34;</span><span class="op" id="8374927">,</span>&nbsp;<span class="ident" id="8374929">i</span><span class="op" id="8374930">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8374934">go</span>&nbsp;<span class="keyword" id="8374937">func</span><span class="op" id="8374941">(</span><span class="op" id="8374942">)</span>&nbsp;<span class="op" id="8374944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8374949">_</span><span class="op" id="8374950">,</span>&nbsp;<span class="ident" id="8374952">err</span>&nbsp;<span class="op" id="8374956">:=</span>&nbsp;<span class="ident" id="8374959">lookupIPDeadline</span><span class="op" id="8374975">(</span><span class="ident" id="8374976">name</span><span class="op" id="8374980">,</span>&nbsp;<span class="ident" id="8374982">time</span><span class="op" id="8374986">.</span><span class="ident" id="8374987">Now</span><span class="op" id="8374990">(</span><span class="op" id="8374991">)</span><span class="op" id="8374992">.</span><span class="ident" id="8374993">Add</span><span class="op" id="8374996">(</span><span class="ident" id="8374997">timeout</span><span class="op" id="8375004">/</span><span class="num" id="8375005">2</span><span class="op" id="8375006">)</span><span class="op" id="8375007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375012">c</span>&nbsp;<span class="op" id="8375014">&lt;-</span>&nbsp;<span class="ident" id="8375017">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8375023">}</span><span class="op" id="8375024">(</span><span class="op" id="8375025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8375029">go</span>&nbsp;<span class="keyword" id="8375032">func</span><span class="op" id="8375036">(</span><span class="op" id="8375037">)</span>&nbsp;<span class="op" id="8375039">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375044">_</span><span class="op" id="8375045">,</span>&nbsp;<span class="ident" id="8375047">err</span>&nbsp;<span class="op" id="8375051">:=</span>&nbsp;<span class="ident" id="8375054">lookupIPDeadline</span><span class="op" id="8375070">(</span><span class="ident" id="8375071">name</span><span class="op" id="8375075">,</span>&nbsp;<span class="ident" id="8375077">time</span><span class="op" id="8375081">.</span><span class="ident" id="8375082">Now</span><span class="op" id="8375085">(</span><span class="op" id="8375086">)</span><span class="op" id="8375087">.</span><span class="ident" id="8375088">Add</span><span class="op" id="8375091">(</span><span class="ident" id="8375092">timeout</span><span class="op" id="8375099">)</span><span class="op" id="8375100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375105">c</span>&nbsp;<span class="op" id="8375107">&lt;-</span>&nbsp;<span class="ident" id="8375110">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8375116">}</span><span class="op" id="8375117">(</span><span class="op" id="8375118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8375121">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375124">qstats</span>&nbsp;<span class="op" id="8375131">:=</span>&nbsp;<span class="keyword" id="8375134">struct</span>&nbsp;<span class="op" id="8375141">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375145">succeeded</span><span class="op" id="8375154">,</span>&nbsp;<span class="ident" id="8375156">failed</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8375171">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375177">timeout</span><span class="op" id="8375184">,</span>&nbsp;<span class="ident" id="8375186">temporary</span><span class="op" id="8375195">,</span>&nbsp;<span class="ident" id="8375197">other</span>&nbsp;<span class="builtintype" id="8375203">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375209">unknown</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8375235">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8375240">}</span><span class="op" id="8375241">{</span><span class="op" id="8375242">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375245">deadline</span>&nbsp;<span class="op" id="8375254">:=</span>&nbsp;<span class="ident" id="8375257">time</span><span class="op" id="8375261">.</span><span class="ident" id="8375262">After</span><span class="op" id="8375267">(</span><span class="ident" id="8375268">timeout</span>&nbsp;<span class="op" id="8375276">+</span>&nbsp;<span class="ident" id="8375278">time</span><span class="op" id="8375282">.</span><span class="ident" id="8375283">Second</span><span class="op" id="8375289">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8375292">for</span>&nbsp;<span class="ident" id="8375296">i</span>&nbsp;<span class="op" id="8375298">:=</span>&nbsp;<span class="num" id="8375301">0</span><span class="op" id="8375302">;</span>&nbsp;<span class="ident" id="8375304">i</span>&nbsp;<span class="op" id="8375306">&lt;</span>&nbsp;<span class="num" id="8375308">2</span><span class="op" id="8375309">*</span><span class="ident" id="8375310">N</span><span class="op" id="8375311">;</span>&nbsp;<span class="ident" id="8375313">i</span><span class="op" id="8375314">++</span>&nbsp;<span class="op" id="8375317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8375321">select</span>&nbsp;<span class="op" id="8375328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8375332">case</span>&nbsp;<span class="op" id="8375337">&lt;-</span><span class="ident" id="8375339">deadline</span><span class="op" id="8375347">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375352">t</span><span class="op" id="8375353">.</span><span class="ident" id="8375354">Fatal</span><span class="op" id="8375359">(</span><span class="string" id="8375360">&#34;deadline&nbsp;exceeded&#34;</span><span class="op" id="8375379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8375383">case</span>&nbsp;<span class="ident" id="8375388">err</span>&nbsp;<span class="op" id="8375392">:=</span>&nbsp;<span class="op" id="8375395">&lt;-</span><span class="ident" id="8375397">c</span><span class="op" id="8375398">:</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8375403">switch</span>&nbsp;<span class="ident" id="8375410">err</span>&nbsp;<span class="op" id="8375414">:=</span>&nbsp;<span class="ident" id="8375417">err</span><span class="op" id="8375420">.</span><span class="op" id="8375421">(</span><span class="keyword" id="8375422">type</span><span class="op" id="8375426">)</span>&nbsp;<span class="op" id="8375428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8375433">case</span>&nbsp;<span class="ident" id="8375438">nil</span><span class="op" id="8375441">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375447">qstats</span><span class="op" id="8375453">.</span><span class="ident" id="8375454">succeeded</span><span class="op" id="8375463">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8375469">case</span>&nbsp;<span class="ident" id="8375474">Error</span><span class="op" id="8375479">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375485">qstats</span><span class="op" id="8375491">.</span><span class="ident" id="8375492">failed</span><span class="op" id="8375498">++</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8375505">if</span>&nbsp;<span class="ident" id="8375508">err</span><span class="op" id="8375511">.</span><span class="ident" id="8375512">Timeout</span><span class="op" id="8375519">(</span><span class="op" id="8375520">)</span>&nbsp;<span class="op" id="8375522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375529">qstats</span><span class="op" id="8375535">.</span><span class="ident" id="8375536">timeout</span><span class="op" id="8375543">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8375550">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8375556">if</span>&nbsp;<span class="ident" id="8375559">err</span><span class="op" id="8375562">.</span><span class="ident" id="8375563">Temporary</span><span class="op" id="8375572">(</span><span class="op" id="8375573">)</span>&nbsp;<span class="op" id="8375575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375582">qstats</span><span class="op" id="8375588">.</span><span class="ident" id="8375589">temporary</span><span class="op" id="8375598">++</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8375605">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8375611">if</span>&nbsp;<span class="op" id="8375614">!</span><span class="ident" id="8375615">err</span><span class="op" id="8375618">.</span><span class="ident" id="8375619">Timeout</span><span class="op" id="8375626">(</span><span class="op" id="8375627">)</span>&nbsp;<span class="op" id="8375629">&amp;&amp;</span>&nbsp;<span class="op" id="8375632">!</span><span class="ident" id="8375633">err</span><span class="op" id="8375636">.</span><span class="ident" id="8375637">Temporary</span><span class="op" id="8375646">(</span><span class="op" id="8375647">)</span>&nbsp;<span class="op" id="8375649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375656">qstats</span><span class="op" id="8375662">.</span><span class="ident" id="8375663">other</span><span class="op" id="8375668">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8375675">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8375680">default</span><span class="op" id="8375687">:</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375693">qstats</span><span class="op" id="8375699">.</span><span class="ident" id="8375700">failed</span><span class="op" id="8375706">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8375713">qstats</span><span class="op" id="8375719">.</span><span class="ident" id="8375720">unknown</span><span class="op" id="8375727">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8375733">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8375737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8375740">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8375744">//&nbsp;A&nbsp;high&nbsp;volume&nbsp;of&nbsp;DNS&nbsp;queries&nbsp;for&nbsp;sub-domain&nbsp;of&nbsp;golang.org</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8375806">//&nbsp;would&nbsp;be&nbsp;coordinated&nbsp;by&nbsp;authoritative&nbsp;or&nbsp;recursive&nbsp;server,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8375869">//&nbsp;or&nbsp;stub&nbsp;resolver&nbsp;which&nbsp;implements&nbsp;query-response&nbsp;rate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8375927">//&nbsp;limitation,&nbsp;so&nbsp;we&nbsp;can&nbsp;expect&nbsp;some&nbsp;query&nbsp;successes&nbsp;and&nbsp;more</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8375990">//&nbsp;failures&nbsp;including&nbsp;timeout,&nbsp;temporary&nbsp;and&nbsp;other&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8376048">//&nbsp;As&nbsp;a&nbsp;rule,&nbsp;unknown&nbsp;must&nbsp;not&nbsp;be&nbsp;shown&nbsp;but&nbsp;it&nbsp;might&nbsp;possibly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8376111">//&nbsp;happen&nbsp;due&nbsp;to&nbsp;issue&nbsp;4856&nbsp;for&nbsp;now.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8376149">t</span><span class="op" id="8376150">.</span><span class="ident" id="8376151">Logf</span><span class="op" id="8376155">(</span><span class="string" id="8376156">&#34;%v&nbsp;succeeded,&nbsp;%v&nbsp;failed&nbsp;(%v&nbsp;timeout,&nbsp;%v&nbsp;temporary,&nbsp;%v&nbsp;other,&nbsp;%v&nbsp;unknown)&#34;</span><span class="op" id="8376230">,</span>&nbsp;<span class="ident" id="8376232">qstats</span><span class="op" id="8376238">.</span><span class="ident" id="8376239">succeeded</span><span class="op" id="8376248">,</span>&nbsp;<span class="ident" id="8376250">qstats</span><span class="op" id="8376256">.</span><span class="ident" id="8376257">failed</span><span class="op" id="8376263">,</span>&nbsp;<span class="ident" id="8376265">qstats</span><span class="op" id="8376271">.</span><span class="ident" id="8376272">timeout</span><span class="op" id="8376279">,</span>&nbsp;<span class="ident" id="8376281">qstats</span><span class="op" id="8376287">.</span><span class="ident" id="8376288">temporary</span><span class="op" id="8376297">,</span>&nbsp;<span class="ident" id="8376299">qstats</span><span class="op" id="8376305">.</span><span class="ident" id="8376306">other</span><span class="op" id="8376311">,</span>&nbsp;<span class="ident" id="8376313">qstats</span><span class="op" id="8376319">.</span><span class="ident" id="8376320">unknown</span><span class="op" id="8376327">)</span><br>
<span class="lineno"></span><span class="op" id="8376329">}</span>
</div>
</body>
</html>
