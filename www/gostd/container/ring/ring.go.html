<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>container/ring</h2>
<ul>
<li><a href="/gostd/container/ring/ring.go.html">ring.go</a></li>
<li><a href="/gostd/container/ring/ring_test.go.html">ring_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6135909">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6135964">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6136018">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6136069">//&nbsp;Package&nbsp;ring&nbsp;implements&nbsp;operations&nbsp;on&nbsp;circular&nbsp;lists.</span><br>
<span class="lineno"></span><span class="keyword" id="6136126">package</span>&nbsp;<span class="ident" id="6136134">ring</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6136140">//&nbsp;A&nbsp;Ring&nbsp;is&nbsp;an&nbsp;element&nbsp;of&nbsp;a&nbsp;circular&nbsp;list,&nbsp;or&nbsp;ring.</span><br>
<span class="lineno"></span><span class="comment" id="6136193">//&nbsp;Rings&nbsp;do&nbsp;not&nbsp;have&nbsp;a&nbsp;beginning&nbsp;or&nbsp;end;&nbsp;a&nbsp;pointer&nbsp;to&nbsp;any&nbsp;ring&nbsp;element</span><br>
<span class="lineno">10</span><span class="comment" id="6136264">//&nbsp;serves&nbsp;as&nbsp;reference&nbsp;to&nbsp;the&nbsp;entire&nbsp;ring.&nbsp;Empty&nbsp;rings&nbsp;are&nbsp;represented</span><br>
<span class="lineno"></span><span class="comment" id="6136335">//&nbsp;as&nbsp;nil&nbsp;Ring&nbsp;pointers.&nbsp;The&nbsp;zero&nbsp;value&nbsp;for&nbsp;a&nbsp;Ring&nbsp;is&nbsp;a&nbsp;one-element</span><br>
<span class="lineno"></span><span class="comment" id="6136403">//&nbsp;ring&nbsp;with&nbsp;a&nbsp;nil&nbsp;Value.</span><br>
<span class="lineno"></span><span class="comment" id="6136429">//</span><br>
<span class="lineno"></span><span class="keyword" id="6136432">type</span>&nbsp;<span class="ident" id="6136437">Ring</span>&nbsp;<span class="keyword" id="6136442">struct</span>&nbsp;<span class="op" id="6136449">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6136452">next</span><span class="op" id="6136456">,</span>&nbsp;<span class="ident" id="6136458">prev</span>&nbsp;<span class="op" id="6136463">*</span><span class="ident" id="6136464">Ring</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6136470">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6136481">interface</span><span class="op" id="6136490">{</span><span class="op" id="6136491">}</span>&nbsp;<span class="comment" id="6136493">//&nbsp;for&nbsp;use&nbsp;by&nbsp;client;&nbsp;untouched&nbsp;by&nbsp;this&nbsp;library</span><br>
<span class="lineno"></span><span class="op" id="6136541">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6136544">func</span>&nbsp;<span class="op" id="6136549">(</span><span class="ident" id="6136550">r</span>&nbsp;<span class="op" id="6136552">*</span><span class="ident" id="6136553">Ring</span><span class="op" id="6136557">)</span>&nbsp;<span class="ident" id="6136559">init</span><span class="op" id="6136563">(</span><span class="op" id="6136564">)</span>&nbsp;<span class="op" id="6136566">*</span><span class="ident" id="6136567">Ring</span>&nbsp;<span class="op" id="6136572">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6136575">r</span><span class="op" id="6136576">.</span><span class="ident" id="6136577">next</span>&nbsp;<span class="op" id="6136582">=</span>&nbsp;<span class="ident" id="6136584">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6136587">r</span><span class="op" id="6136588">.</span><span class="ident" id="6136589">prev</span>&nbsp;<span class="op" id="6136594">=</span>&nbsp;<span class="ident" id="6136596">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6136599">return</span>&nbsp;<span class="ident" id="6136606">r</span><br>
<span class="lineno"></span><span class="op" id="6136608">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="6136611">//&nbsp;Next&nbsp;returns&nbsp;the&nbsp;next&nbsp;ring&nbsp;element.&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno"></span><span class="keyword" id="6136671">func</span>&nbsp;<span class="op" id="6136676">(</span><span class="ident" id="6136677">r</span>&nbsp;<span class="op" id="6136679">*</span><span class="ident" id="6136680">Ring</span><span class="op" id="6136684">)</span>&nbsp;<span class="ident" id="6136686">Next</span><span class="op" id="6136690">(</span><span class="op" id="6136691">)</span>&nbsp;<span class="op" id="6136693">*</span><span class="ident" id="6136694">Ring</span>&nbsp;<span class="op" id="6136699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6136702">if</span>&nbsp;<span class="ident" id="6136705">r</span><span class="op" id="6136706">.</span><span class="ident" id="6136707">next</span>&nbsp;<span class="op" id="6136712">==</span>&nbsp;<span class="ident" id="6136715">nil</span>&nbsp;<span class="op" id="6136719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6136723">return</span>&nbsp;<span class="ident" id="6136730">r</span><span class="op" id="6136731">.</span><span class="ident" id="6136732">init</span><span class="op" id="6136736">(</span><span class="op" id="6136737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6136740">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6136743">return</span>&nbsp;<span class="ident" id="6136750">r</span><span class="op" id="6136751">.</span><span class="ident" id="6136752">next</span><br>
<span class="lineno"></span><span class="op" id="6136757">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6136760">//&nbsp;Prev&nbsp;returns&nbsp;the&nbsp;previous&nbsp;ring&nbsp;element.&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno"></span><span class="keyword" id="6136824">func</span>&nbsp;<span class="op" id="6136829">(</span><span class="ident" id="6136830">r</span>&nbsp;<span class="op" id="6136832">*</span><span class="ident" id="6136833">Ring</span><span class="op" id="6136837">)</span>&nbsp;<span class="ident" id="6136839">Prev</span><span class="op" id="6136843">(</span><span class="op" id="6136844">)</span>&nbsp;<span class="op" id="6136846">*</span><span class="ident" id="6136847">Ring</span>&nbsp;<span class="op" id="6136852">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6136855">if</span>&nbsp;<span class="ident" id="6136858">r</span><span class="op" id="6136859">.</span><span class="ident" id="6136860">next</span>&nbsp;<span class="op" id="6136865">==</span>&nbsp;<span class="ident" id="6136868">nil</span>&nbsp;<span class="op" id="6136872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6136876">return</span>&nbsp;<span class="ident" id="6136883">r</span><span class="op" id="6136884">.</span><span class="ident" id="6136885">init</span><span class="op" id="6136889">(</span><span class="op" id="6136890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6136893">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6136896">return</span>&nbsp;<span class="ident" id="6136903">r</span><span class="op" id="6136904">.</span><span class="ident" id="6136905">prev</span><br>
<span class="lineno"></span><span class="op" id="6136910">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="6136913">//&nbsp;Move&nbsp;moves&nbsp;n&nbsp;%&nbsp;r.Len()&nbsp;elements&nbsp;backward&nbsp;(n&nbsp;&lt;&nbsp;0)&nbsp;or&nbsp;forward&nbsp;(n&nbsp;&gt;=&nbsp;0)</span><br>
<span class="lineno"></span><span class="comment" id="6136985">//&nbsp;in&nbsp;the&nbsp;ring&nbsp;and&nbsp;returns&nbsp;that&nbsp;ring&nbsp;element.&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno"></span><span class="comment" id="6137052">//</span><br>
<span class="lineno"></span><span class="keyword" id="6137055">func</span>&nbsp;<span class="op" id="6137060">(</span><span class="ident" id="6137061">r</span>&nbsp;<span class="op" id="6137063">*</span><span class="ident" id="6137064">Ring</span><span class="op" id="6137068">)</span>&nbsp;<span class="ident" id="6137070">Move</span><span class="op" id="6137074">(</span><span class="ident" id="6137075">n</span>&nbsp;<span class="builtintype" id="6137077">int</span><span class="op" id="6137080">)</span>&nbsp;<span class="op" id="6137082">*</span><span class="ident" id="6137083">Ring</span>&nbsp;<span class="op" id="6137088">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6137091">if</span>&nbsp;<span class="ident" id="6137094">r</span><span class="op" id="6137095">.</span><span class="ident" id="6137096">next</span>&nbsp;<span class="op" id="6137101">==</span>&nbsp;<span class="ident" id="6137104">nil</span>&nbsp;<span class="op" id="6137108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6137112">return</span>&nbsp;<span class="ident" id="6137119">r</span><span class="op" id="6137120">.</span><span class="ident" id="6137121">init</span><span class="op" id="6137125">(</span><span class="op" id="6137126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6137129">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6137132">switch</span>&nbsp;<span class="op" id="6137139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6137142">case</span>&nbsp;<span class="ident" id="6137147">n</span>&nbsp;<span class="op" id="6137149">&lt;</span>&nbsp;<span class="num" id="6137151">0</span><span class="op" id="6137152">:</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6137156">for</span>&nbsp;<span class="op" id="6137160">;</span>&nbsp;<span class="ident" id="6137162">n</span>&nbsp;<span class="op" id="6137164">&lt;</span>&nbsp;<span class="num" id="6137166">0</span><span class="op" id="6137167">;</span>&nbsp;<span class="ident" id="6137169">n</span><span class="op" id="6137170">++</span>&nbsp;<span class="op" id="6137173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6137178">r</span>&nbsp;<span class="op" id="6137180">=</span>&nbsp;<span class="ident" id="6137182">r</span><span class="op" id="6137183">.</span><span class="ident" id="6137184">prev</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6137191">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6137194">case</span>&nbsp;<span class="ident" id="6137199">n</span>&nbsp;<span class="op" id="6137201">&gt;</span>&nbsp;<span class="num" id="6137203">0</span><span class="op" id="6137204">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6137208">for</span>&nbsp;<span class="op" id="6137212">;</span>&nbsp;<span class="ident" id="6137214">n</span>&nbsp;<span class="op" id="6137216">&gt;</span>&nbsp;<span class="num" id="6137218">0</span><span class="op" id="6137219">;</span>&nbsp;<span class="ident" id="6137221">n</span><span class="op" id="6137222">--</span>&nbsp;<span class="op" id="6137225">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6137230">r</span>&nbsp;<span class="op" id="6137232">=</span>&nbsp;<span class="ident" id="6137234">r</span><span class="op" id="6137235">.</span><span class="ident" id="6137236">next</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6137243">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6137246">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6137249">return</span>&nbsp;<span class="ident" id="6137256">r</span><br>
<span class="lineno"></span><span class="op" id="6137258">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="6137261">//&nbsp;New&nbsp;creates&nbsp;a&nbsp;ring&nbsp;of&nbsp;n&nbsp;elements.</span><br>
<span class="lineno"></span><span class="keyword" id="6137298">func</span>&nbsp;<span class="ident" id="6137303">New</span><span class="op" id="6137306">(</span><span class="ident" id="6137307">n</span>&nbsp;<span class="builtintype" id="6137309">int</span><span class="op" id="6137312">)</span>&nbsp;<span class="op" id="6137314">*</span><span class="ident" id="6137315">Ring</span>&nbsp;<span class="op" id="6137320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6137323">if</span>&nbsp;<span class="ident" id="6137326">n</span>&nbsp;<span class="op" id="6137328">&lt;=</span>&nbsp;<span class="num" id="6137331">0</span>&nbsp;<span class="op" id="6137333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6137337">return</span>&nbsp;<span class="ident" id="6137344">nil</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6137349">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6137352">r</span>&nbsp;<span class="op" id="6137354">:=</span>&nbsp;<span class="builtinfunc" id="6137357">new</span><span class="op" id="6137360">(</span><span class="ident" id="6137361">Ring</span><span class="op" id="6137365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6137368">p</span>&nbsp;<span class="op" id="6137370">:=</span>&nbsp;<span class="ident" id="6137373">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6137376">for</span>&nbsp;<span class="ident" id="6137380">i</span>&nbsp;<span class="op" id="6137382">:=</span>&nbsp;<span class="num" id="6137385">1</span><span class="op" id="6137386">;</span>&nbsp;<span class="ident" id="6137388">i</span>&nbsp;<span class="op" id="6137390">&lt;</span>&nbsp;<span class="ident" id="6137392">n</span><span class="op" id="6137393">;</span>&nbsp;<span class="ident" id="6137395">i</span><span class="op" id="6137396">++</span>&nbsp;<span class="op" id="6137399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6137403">p</span><span class="op" id="6137404">.</span><span class="ident" id="6137405">next</span>&nbsp;<span class="op" id="6137410">=</span>&nbsp;<span class="op" id="6137412">&amp;</span><span class="ident" id="6137413">Ring</span><span class="op" id="6137417">{</span><span class="ident" id="6137418">prev</span><span class="op" id="6137422">:</span>&nbsp;<span class="ident" id="6137424">p</span><span class="op" id="6137425">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6137429">p</span>&nbsp;<span class="op" id="6137431">=</span>&nbsp;<span class="ident" id="6137433">p</span><span class="op" id="6137434">.</span><span class="ident" id="6137435">next</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6137441">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6137444">p</span><span class="op" id="6137445">.</span><span class="ident" id="6137446">next</span>&nbsp;<span class="op" id="6137451">=</span>&nbsp;<span class="ident" id="6137453">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6137456">r</span><span class="op" id="6137457">.</span><span class="ident" id="6137458">prev</span>&nbsp;<span class="op" id="6137463">=</span>&nbsp;<span class="ident" id="6137465">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6137468">return</span>&nbsp;<span class="ident" id="6137475">r</span><br>
<span class="lineno">75</span><span class="op" id="6137477">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6137480">//&nbsp;Link&nbsp;connects&nbsp;ring&nbsp;r&nbsp;with&nbsp;ring&nbsp;s&nbsp;such&nbsp;that&nbsp;r.Next()</span><br>
<span class="lineno"></span><span class="comment" id="6137535">//&nbsp;becomes&nbsp;s&nbsp;and&nbsp;returns&nbsp;the&nbsp;original&nbsp;value&nbsp;for&nbsp;r.Next().</span><br>
<span class="lineno"></span><span class="comment" id="6137593">//&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno">80</span><span class="comment" id="6137617">//</span><br>
<span class="lineno"></span><span class="comment" id="6137620">//&nbsp;If&nbsp;r&nbsp;and&nbsp;s&nbsp;point&nbsp;to&nbsp;the&nbsp;same&nbsp;ring,&nbsp;linking</span><br>
<span class="lineno"></span><span class="comment" id="6137666">//&nbsp;them&nbsp;removes&nbsp;the&nbsp;elements&nbsp;between&nbsp;r&nbsp;and&nbsp;s&nbsp;from&nbsp;the&nbsp;ring.</span><br>
<span class="lineno"></span><span class="comment" id="6137726">//&nbsp;The&nbsp;removed&nbsp;elements&nbsp;form&nbsp;a&nbsp;subring&nbsp;and&nbsp;the&nbsp;result&nbsp;is&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="6137785">//&nbsp;reference&nbsp;to&nbsp;that&nbsp;subring&nbsp;(if&nbsp;no&nbsp;elements&nbsp;were&nbsp;removed,</span><br>
<span class="lineno">85</span><span class="comment" id="6137844">//&nbsp;the&nbsp;result&nbsp;is&nbsp;still&nbsp;the&nbsp;original&nbsp;value&nbsp;for&nbsp;r.Next(),</span><br>
<span class="lineno"></span><span class="comment" id="6137900">//&nbsp;and&nbsp;not&nbsp;nil).</span><br>
<span class="lineno"></span><span class="comment" id="6137917">//</span><br>
<span class="lineno"></span><span class="comment" id="6137920">//&nbsp;If&nbsp;r&nbsp;and&nbsp;s&nbsp;point&nbsp;to&nbsp;different&nbsp;rings,&nbsp;linking</span><br>
<span class="lineno"></span><span class="comment" id="6137968">//&nbsp;them&nbsp;creates&nbsp;a&nbsp;single&nbsp;ring&nbsp;with&nbsp;the&nbsp;elements&nbsp;of&nbsp;s&nbsp;inserted</span><br>
<span class="lineno">90</span><span class="comment" id="6138030">//&nbsp;after&nbsp;r.&nbsp;The&nbsp;result&nbsp;points&nbsp;to&nbsp;the&nbsp;element&nbsp;following&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6138089">//&nbsp;last&nbsp;element&nbsp;of&nbsp;s&nbsp;after&nbsp;insertion.</span><br>
<span class="lineno"></span><span class="comment" id="6138127">//</span><br>
<span class="lineno"></span><span class="keyword" id="6138130">func</span>&nbsp;<span class="op" id="6138135">(</span><span class="ident" id="6138136">r</span>&nbsp;<span class="op" id="6138138">*</span><span class="ident" id="6138139">Ring</span><span class="op" id="6138143">)</span>&nbsp;<span class="ident" id="6138145">Link</span><span class="op" id="6138149">(</span><span class="ident" id="6138150">s</span>&nbsp;<span class="op" id="6138152">*</span><span class="ident" id="6138153">Ring</span><span class="op" id="6138157">)</span>&nbsp;<span class="op" id="6138159">*</span><span class="ident" id="6138160">Ring</span>&nbsp;<span class="op" id="6138165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6138168">n</span>&nbsp;<span class="op" id="6138170">:=</span>&nbsp;<span class="ident" id="6138173">r</span><span class="op" id="6138174">.</span><span class="ident" id="6138175">Next</span><span class="op" id="6138179">(</span><span class="op" id="6138180">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6138183">if</span>&nbsp;<span class="ident" id="6138186">s</span>&nbsp;<span class="op" id="6138188">!=</span>&nbsp;<span class="ident" id="6138191">nil</span>&nbsp;<span class="op" id="6138195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6138199">p</span>&nbsp;<span class="op" id="6138201">:=</span>&nbsp;<span class="ident" id="6138204">s</span><span class="op" id="6138205">.</span><span class="ident" id="6138206">Prev</span><span class="op" id="6138210">(</span><span class="op" id="6138211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6138215">//&nbsp;Note:&nbsp;Cannot&nbsp;use&nbsp;multiple&nbsp;assignment&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6138265">//&nbsp;evaluation&nbsp;order&nbsp;of&nbsp;LHS&nbsp;is&nbsp;not&nbsp;specified.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6138312">r</span><span class="op" id="6138313">.</span><span class="ident" id="6138314">next</span>&nbsp;<span class="op" id="6138319">=</span>&nbsp;<span class="ident" id="6138321">s</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6138325">s</span><span class="op" id="6138326">.</span><span class="ident" id="6138327">prev</span>&nbsp;<span class="op" id="6138332">=</span>&nbsp;<span class="ident" id="6138334">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6138338">n</span><span class="op" id="6138339">.</span><span class="ident" id="6138340">prev</span>&nbsp;<span class="op" id="6138345">=</span>&nbsp;<span class="ident" id="6138347">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6138351">p</span><span class="op" id="6138352">.</span><span class="ident" id="6138353">next</span>&nbsp;<span class="op" id="6138358">=</span>&nbsp;<span class="ident" id="6138360">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6138363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6138366">return</span>&nbsp;<span class="ident" id="6138373">n</span><br>
<span class="lineno">105</span><span class="op" id="6138375">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6138378">//&nbsp;Unlink&nbsp;removes&nbsp;n&nbsp;%&nbsp;r.Len()&nbsp;elements&nbsp;from&nbsp;the&nbsp;ring&nbsp;r,&nbsp;starting</span><br>
<span class="lineno"></span><span class="comment" id="6138443">//&nbsp;at&nbsp;r.Next().&nbsp;If&nbsp;n&nbsp;%&nbsp;r.Len()&nbsp;==&nbsp;0,&nbsp;r&nbsp;remains&nbsp;unchanged.</span><br>
<span class="lineno"></span><span class="comment" id="6138501">//&nbsp;The&nbsp;result&nbsp;is&nbsp;the&nbsp;removed&nbsp;subring.&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno">110</span><span class="comment" id="6138560">//</span><br>
<span class="lineno"></span><span class="keyword" id="6138563">func</span>&nbsp;<span class="op" id="6138568">(</span><span class="ident" id="6138569">r</span>&nbsp;<span class="op" id="6138571">*</span><span class="ident" id="6138572">Ring</span><span class="op" id="6138576">)</span>&nbsp;<span class="ident" id="6138578">Unlink</span><span class="op" id="6138584">(</span><span class="ident" id="6138585">n</span>&nbsp;<span class="builtintype" id="6138587">int</span><span class="op" id="6138590">)</span>&nbsp;<span class="op" id="6138592">*</span><span class="ident" id="6138593">Ring</span>&nbsp;<span class="op" id="6138598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6138601">if</span>&nbsp;<span class="ident" id="6138604">n</span>&nbsp;<span class="op" id="6138606">&lt;=</span>&nbsp;<span class="num" id="6138609">0</span>&nbsp;<span class="op" id="6138611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6138615">return</span>&nbsp;<span class="ident" id="6138622">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6138627">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6138630">return</span>&nbsp;<span class="ident" id="6138637">r</span><span class="op" id="6138638">.</span><span class="ident" id="6138639">Link</span><span class="op" id="6138643">(</span><span class="ident" id="6138644">r</span><span class="op" id="6138645">.</span><span class="ident" id="6138646">Move</span><span class="op" id="6138650">(</span><span class="ident" id="6138651">n</span>&nbsp;<span class="op" id="6138653">+</span>&nbsp;<span class="num" id="6138655">1</span><span class="op" id="6138656">)</span><span class="op" id="6138657">)</span><br>
<span class="lineno"></span><span class="op" id="6138659">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6138662">//&nbsp;Len&nbsp;computes&nbsp;the&nbsp;number&nbsp;of&nbsp;elements&nbsp;in&nbsp;ring&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="6138712">//&nbsp;It&nbsp;executes&nbsp;in&nbsp;time&nbsp;proportional&nbsp;to&nbsp;the&nbsp;number&nbsp;of&nbsp;elements.</span><br>
<span class="lineno">120</span><span class="comment" id="6138775">//</span><br>
<span class="lineno"></span><span class="keyword" id="6138778">func</span>&nbsp;<span class="op" id="6138783">(</span><span class="ident" id="6138784">r</span>&nbsp;<span class="op" id="6138786">*</span><span class="ident" id="6138787">Ring</span><span class="op" id="6138791">)</span>&nbsp;<span class="ident" id="6138793">Len</span><span class="op" id="6138796">(</span><span class="op" id="6138797">)</span>&nbsp;<span class="builtintype" id="6138799">int</span>&nbsp;<span class="op" id="6138803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6138806">n</span>&nbsp;<span class="op" id="6138808">:=</span>&nbsp;<span class="num" id="6138811">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6138814">if</span>&nbsp;<span class="ident" id="6138817">r</span>&nbsp;<span class="op" id="6138819">!=</span>&nbsp;<span class="ident" id="6138822">nil</span>&nbsp;<span class="op" id="6138826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6138830">n</span>&nbsp;<span class="op" id="6138832">=</span>&nbsp;<span class="num" id="6138834">1</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6138838">for</span>&nbsp;<span class="ident" id="6138842">p</span>&nbsp;<span class="op" id="6138844">:=</span>&nbsp;<span class="ident" id="6138847">r</span><span class="op" id="6138848">.</span><span class="ident" id="6138849">Next</span><span class="op" id="6138853">(</span><span class="op" id="6138854">)</span><span class="op" id="6138855">;</span>&nbsp;<span class="ident" id="6138857">p</span>&nbsp;<span class="op" id="6138859">!=</span>&nbsp;<span class="ident" id="6138862">r</span><span class="op" id="6138863">;</span>&nbsp;<span class="ident" id="6138865">p</span>&nbsp;<span class="op" id="6138867">=</span>&nbsp;<span class="ident" id="6138869">p</span><span class="op" id="6138870">.</span><span class="ident" id="6138871">next</span>&nbsp;<span class="op" id="6138876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6138881">n</span><span class="op" id="6138882">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6138887">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6138890">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6138893">return</span>&nbsp;<span class="ident" id="6138900">n</span><br>
<span class="lineno">130</span><span class="op" id="6138902">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6138905">//&nbsp;Do&nbsp;calls&nbsp;function&nbsp;f&nbsp;on&nbsp;each&nbsp;element&nbsp;of&nbsp;the&nbsp;ring,&nbsp;in&nbsp;forward&nbsp;order.</span><br>
<span class="lineno"></span><span class="comment" id="6138975">//&nbsp;The&nbsp;behavior&nbsp;of&nbsp;Do&nbsp;is&nbsp;undefined&nbsp;if&nbsp;f&nbsp;changes&nbsp;*r.</span><br>
<span class="lineno"></span><span class="keyword" id="6139027">func</span>&nbsp;<span class="op" id="6139032">(</span><span class="ident" id="6139033">r</span>&nbsp;<span class="op" id="6139035">*</span><span class="ident" id="6139036">Ring</span><span class="op" id="6139040">)</span>&nbsp;<span class="ident" id="6139042">Do</span><span class="op" id="6139044">(</span><span class="ident" id="6139045">f</span>&nbsp;<span class="keyword" id="6139047">func</span><span class="op" id="6139051">(</span><span class="keyword" id="6139052">interface</span><span class="op" id="6139061">{</span><span class="op" id="6139062">}</span><span class="op" id="6139063">)</span><span class="op" id="6139064">)</span>&nbsp;<span class="op" id="6139066">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6139069">if</span>&nbsp;<span class="ident" id="6139072">r</span>&nbsp;<span class="op" id="6139074">!=</span>&nbsp;<span class="ident" id="6139077">nil</span>&nbsp;<span class="op" id="6139081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6139085">f</span><span class="op" id="6139086">(</span><span class="ident" id="6139087">r</span><span class="op" id="6139088">.</span><span class="ident" id="6139089">Value</span><span class="op" id="6139094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6139098">for</span>&nbsp;<span class="ident" id="6139102">p</span>&nbsp;<span class="op" id="6139104">:=</span>&nbsp;<span class="ident" id="6139107">r</span><span class="op" id="6139108">.</span><span class="ident" id="6139109">Next</span><span class="op" id="6139113">(</span><span class="op" id="6139114">)</span><span class="op" id="6139115">;</span>&nbsp;<span class="ident" id="6139117">p</span>&nbsp;<span class="op" id="6139119">!=</span>&nbsp;<span class="ident" id="6139122">r</span><span class="op" id="6139123">;</span>&nbsp;<span class="ident" id="6139125">p</span>&nbsp;<span class="op" id="6139127">=</span>&nbsp;<span class="ident" id="6139129">p</span><span class="op" id="6139130">.</span><span class="ident" id="6139131">next</span>&nbsp;<span class="op" id="6139136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6139141">f</span><span class="op" id="6139142">(</span><span class="ident" id="6139143">p</span><span class="op" id="6139144">.</span><span class="ident" id="6139145">Value</span><span class="op" id="6139150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6139154">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6139157">}</span><br>
<span class="lineno"></span><span class="op" id="6139159">}</span>
</div>
</body>
</html>
