<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html" class="current">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6494145">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6494200">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6494254">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6494305">//&nbsp;TODO&nbsp;It&nbsp;would&nbsp;be&nbsp;nice&nbsp;to&nbsp;use&nbsp;a&nbsp;mock&nbsp;DNS&nbsp;server,&nbsp;to&nbsp;eliminate</span><br>
<span class="lineno"></span><span class="comment" id="6494369">//&nbsp;external&nbsp;dependencies.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6494396">package</span>&nbsp;<span class="ident" id="6494404">net</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="6494409">import</span>&nbsp;<span class="op" id="6494416">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6494419">&#34;flag&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6494427">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6494438">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6494448">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="6494451">var</span>&nbsp;<span class="ident" id="6494455">testExternal</span>&nbsp;<span class="op" id="6494468">=</span>&nbsp;<span class="ident" id="6494470">flag</span><span class="op" id="6494474">.</span><span class="ident" id="6494475">Bool</span><span class="op" id="6494479">(</span><span class="string" id="6494480">&#34;external&#34;</span><span class="op" id="6494490">,</span>&nbsp;<span class="builtintype" id="6494492">true</span><span class="op" id="6494496">,</span>&nbsp;<span class="string" id="6494498">&#34;allow&nbsp;use&nbsp;of&nbsp;external&nbsp;networks&nbsp;during&nbsp;long&nbsp;test&#34;</span><span class="op" id="6494547">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6494550">var</span>&nbsp;<span class="ident" id="6494554">lookupGoogleSRVTests</span>&nbsp;<span class="op" id="6494575">=</span>&nbsp;<span class="op" id="6494577">[</span><span class="op" id="6494578">]</span><span class="keyword" id="6494579">struct</span>&nbsp;<span class="op" id="6494586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6494589">service</span><span class="op" id="6494596">,</span>&nbsp;<span class="ident" id="6494598">proto</span><span class="op" id="6494603">,</span>&nbsp;<span class="ident" id="6494605">name</span>&nbsp;<span class="builtintype" id="6494610">string</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6494618">cname</span><span class="op" id="6494623">,</span>&nbsp;<span class="ident" id="6494625">target</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6494639">string</span><br>
<span class="lineno"></span><span class="op" id="6494646">}</span><span class="op" id="6494647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6494650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6494654">&#34;xmpp-server&#34;</span><span class="op" id="6494667">,</span>&nbsp;<span class="string" id="6494669">&#34;tcp&#34;</span><span class="op" id="6494674">,</span>&nbsp;<span class="string" id="6494676">&#34;google.com&#34;</span><span class="op" id="6494688">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6494692">&#34;.google.com&#34;</span><span class="op" id="6494705">,</span>&nbsp;<span class="string" id="6494707">&#34;.google.com&#34;</span><span class="op" id="6494720">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6494723">}</span><span class="op" id="6494724">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6494727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6494731">&#34;&#34;</span><span class="op" id="6494733">,</span>&nbsp;<span class="string" id="6494735">&#34;&#34;</span><span class="op" id="6494737">,</span>&nbsp;<span class="string" id="6494739">&#34;_xmpp-server._tcp.google.com&#34;</span><span class="op" id="6494769">,</span>&nbsp;<span class="comment" id="6494771">//&nbsp;non-standard&nbsp;back&nbsp;door</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6494799">&#34;.google.com&#34;</span><span class="op" id="6494812">,</span>&nbsp;<span class="string" id="6494814">&#34;.google.com&#34;</span><span class="op" id="6494827">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6494830">}</span><span class="op" id="6494831">,</span><br>
<span class="lineno">30</span><span class="op" id="6494833">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6494836">func</span>&nbsp;<span class="ident" id="6494841">TestLookupGoogleSRV</span><span class="op" id="6494860">(</span><span class="ident" id="6494861">t</span>&nbsp;<span class="op" id="6494863">*</span><span class="ident" id="6494864">testing</span><span class="op" id="6494871">.</span><span class="ident" id="6494872">T</span><span class="op" id="6494873">)</span>&nbsp;<span class="op" id="6494875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6494878">if</span>&nbsp;<span class="ident" id="6494881">testing</span><span class="op" id="6494888">.</span><span class="ident" id="6494889">Short</span><span class="op" id="6494894">(</span><span class="op" id="6494895">)</span>&nbsp;<span class="op" id="6494897">||</span>&nbsp;<span class="op" id="6494900">!</span><span class="op" id="6494901">*</span><span class="ident" id="6494902">testExternal</span>&nbsp;<span class="op" id="6494915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6494919">t</span><span class="op" id="6494920">.</span><span class="ident" id="6494921">Skip</span><span class="op" id="6494925">(</span><span class="string" id="6494926">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6494967">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6494970">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6494974">for</span>&nbsp;<span class="ident" id="6494978">_</span><span class="op" id="6494979">,</span>&nbsp;<span class="ident" id="6494981">tt</span>&nbsp;<span class="op" id="6494984">:=</span>&nbsp;<span class="keyword" id="6494987">range</span>&nbsp;<span class="ident" id="6494993">lookupGoogleSRVTests</span>&nbsp;<span class="op" id="6495014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6495018">cname</span><span class="op" id="6495023">,</span>&nbsp;<span class="ident" id="6495025">srvs</span><span class="op" id="6495029">,</span>&nbsp;<span class="ident" id="6495031">err</span>&nbsp;<span class="op" id="6495035">:=</span>&nbsp;<span class="ident" id="6495038">LookupSRV</span><span class="op" id="6495047">(</span><span class="ident" id="6495048">tt</span><span class="op" id="6495050">.</span><span class="ident" id="6495051">service</span><span class="op" id="6495058">,</span>&nbsp;<span class="ident" id="6495060">tt</span><span class="op" id="6495062">.</span><span class="ident" id="6495063">proto</span><span class="op" id="6495068">,</span>&nbsp;<span class="ident" id="6495070">tt</span><span class="op" id="6495072">.</span><span class="ident" id="6495073">name</span><span class="op" id="6495077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6495081">if</span>&nbsp;<span class="ident" id="6495084">err</span>&nbsp;<span class="op" id="6495088">!=</span>&nbsp;<span class="builtintype" id="6495091">nil</span>&nbsp;<span class="op" id="6495095">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6495100">t</span><span class="op" id="6495101">.</span><span class="ident" id="6495102">Fatal</span><span class="op" id="6495107">(</span><span class="ident" id="6495108">err</span><span class="op" id="6495111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6495115">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6495119">if</span>&nbsp;<span class="builtinfunc" id="6495122">len</span><span class="op" id="6495125">(</span><span class="ident" id="6495126">srvs</span><span class="op" id="6495130">)</span>&nbsp;<span class="op" id="6495132">==</span>&nbsp;<span class="num" id="6495135">0</span>&nbsp;<span class="op" id="6495137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6495142">t</span><span class="op" id="6495143">.</span><span class="ident" id="6495144">Error</span><span class="op" id="6495149">(</span><span class="string" id="6495150">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="6495165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6495169">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6495173">if</span>&nbsp;<span class="op" id="6495176">!</span><span class="ident" id="6495177">strings</span><span class="op" id="6495184">.</span><span class="ident" id="6495185">Contains</span><span class="op" id="6495193">(</span><span class="ident" id="6495194">cname</span><span class="op" id="6495199">,</span>&nbsp;<span class="ident" id="6495201">tt</span><span class="op" id="6495203">.</span><span class="ident" id="6495204">cname</span><span class="op" id="6495209">)</span>&nbsp;<span class="op" id="6495211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6495216">t</span><span class="op" id="6495217">.</span><span class="ident" id="6495218">Errorf</span><span class="op" id="6495224">(</span><span class="string" id="6495225">&#34;got&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6495242">,</span>&nbsp;<span class="ident" id="6495244">cname</span><span class="op" id="6495249">,</span>&nbsp;<span class="ident" id="6495251">tt</span><span class="op" id="6495253">.</span><span class="ident" id="6495254">cname</span><span class="op" id="6495259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6495263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6495267">for</span>&nbsp;<span class="ident" id="6495271">_</span><span class="op" id="6495272">,</span>&nbsp;<span class="ident" id="6495274">srv</span>&nbsp;<span class="op" id="6495278">:=</span>&nbsp;<span class="keyword" id="6495281">range</span>&nbsp;<span class="ident" id="6495287">srvs</span>&nbsp;<span class="op" id="6495292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6495297">if</span>&nbsp;<span class="op" id="6495300">!</span><span class="ident" id="6495301">strings</span><span class="op" id="6495308">.</span><span class="ident" id="6495309">Contains</span><span class="op" id="6495317">(</span><span class="ident" id="6495318">srv</span><span class="op" id="6495321">.</span><span class="ident" id="6495322">Target</span><span class="op" id="6495328">,</span>&nbsp;<span class="ident" id="6495330">tt</span><span class="op" id="6495332">.</span><span class="ident" id="6495333">target</span><span class="op" id="6495339">)</span>&nbsp;<span class="op" id="6495341">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6495347">t</span><span class="op" id="6495348">.</span><span class="ident" id="6495349">Errorf</span><span class="op" id="6495355">(</span><span class="string" id="6495356">&#34;got&nbsp;%v;&nbsp;want&nbsp;a&nbsp;record&nbsp;containing&nbsp;%q&#34;</span><span class="op" id="6495393">,</span>&nbsp;<span class="ident" id="6495395">srv</span><span class="op" id="6495398">,</span>&nbsp;<span class="ident" id="6495400">tt</span><span class="op" id="6495402">.</span><span class="ident" id="6495403">target</span><span class="op" id="6495409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6495414">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6495418">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6495421">}</span><br>
<span class="lineno"></span><span class="op" id="6495423">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="keyword" id="6495426">func</span>&nbsp;<span class="ident" id="6495431">TestLookupGmailMX</span><span class="op" id="6495448">(</span><span class="ident" id="6495449">t</span>&nbsp;<span class="op" id="6495451">*</span><span class="ident" id="6495452">testing</span><span class="op" id="6495459">.</span><span class="ident" id="6495460">T</span><span class="op" id="6495461">)</span>&nbsp;<span class="op" id="6495463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6495466">if</span>&nbsp;<span class="ident" id="6495469">testing</span><span class="op" id="6495476">.</span><span class="ident" id="6495477">Short</span><span class="op" id="6495482">(</span><span class="op" id="6495483">)</span>&nbsp;<span class="op" id="6495485">||</span>&nbsp;<span class="op" id="6495488">!</span><span class="op" id="6495489">*</span><span class="ident" id="6495490">testExternal</span>&nbsp;<span class="op" id="6495503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6495507">t</span><span class="op" id="6495508">.</span><span class="ident" id="6495509">Skip</span><span class="op" id="6495513">(</span><span class="string" id="6495514">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6495555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6495558">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6495562">mxs</span><span class="op" id="6495565">,</span>&nbsp;<span class="ident" id="6495567">err</span>&nbsp;<span class="op" id="6495571">:=</span>&nbsp;<span class="ident" id="6495574">LookupMX</span><span class="op" id="6495582">(</span><span class="string" id="6495583">&#34;gmail.com&#34;</span><span class="op" id="6495594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6495597">if</span>&nbsp;<span class="ident" id="6495600">err</span>&nbsp;<span class="op" id="6495604">!=</span>&nbsp;<span class="builtintype" id="6495607">nil</span>&nbsp;<span class="op" id="6495611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6495615">t</span><span class="op" id="6495616">.</span><span class="ident" id="6495617">Fatal</span><span class="op" id="6495622">(</span><span class="ident" id="6495623">err</span><span class="op" id="6495626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6495629">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6495632">if</span>&nbsp;<span class="builtinfunc" id="6495635">len</span><span class="op" id="6495638">(</span><span class="ident" id="6495639">mxs</span><span class="op" id="6495642">)</span>&nbsp;<span class="op" id="6495644">==</span>&nbsp;<span class="num" id="6495647">0</span>&nbsp;<span class="op" id="6495649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6495653">t</span><span class="op" id="6495654">.</span><span class="ident" id="6495655">Error</span><span class="op" id="6495660">(</span><span class="string" id="6495661">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="6495676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6495679">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6495682">for</span>&nbsp;<span class="ident" id="6495686">_</span><span class="op" id="6495687">,</span>&nbsp;<span class="ident" id="6495689">mx</span>&nbsp;<span class="op" id="6495692">:=</span>&nbsp;<span class="keyword" id="6495695">range</span>&nbsp;<span class="ident" id="6495701">mxs</span>&nbsp;<span class="op" id="6495705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6495709">if</span>&nbsp;<span class="op" id="6495712">!</span><span class="ident" id="6495713">strings</span><span class="op" id="6495720">.</span><span class="ident" id="6495721">Contains</span><span class="op" id="6495729">(</span><span class="ident" id="6495730">mx</span><span class="op" id="6495732">.</span><span class="ident" id="6495733">Host</span><span class="op" id="6495737">,</span>&nbsp;<span class="string" id="6495739">&#34;.google.com&#34;</span><span class="op" id="6495752">)</span>&nbsp;<span class="op" id="6495754">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6495759">t</span><span class="op" id="6495760">.</span><span class="ident" id="6495761">Errorf</span><span class="op" id="6495767">(</span><span class="string" id="6495768">&#34;got&nbsp;%v;&nbsp;want&nbsp;a&nbsp;record&nbsp;containing&nbsp;.google.com.&#34;</span><span class="op" id="6495815">,</span>&nbsp;<span class="ident" id="6495817">mx</span><span class="op" id="6495819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6495823">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6495826">}</span><br>
<span class="lineno"></span><span class="op" id="6495828">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="6495831">func</span>&nbsp;<span class="ident" id="6495836">TestLookupGmailNS</span><span class="op" id="6495853">(</span><span class="ident" id="6495854">t</span>&nbsp;<span class="op" id="6495856">*</span><span class="ident" id="6495857">testing</span><span class="op" id="6495864">.</span><span class="ident" id="6495865">T</span><span class="op" id="6495866">)</span>&nbsp;<span class="op" id="6495868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6495871">if</span>&nbsp;<span class="ident" id="6495874">testing</span><span class="op" id="6495881">.</span><span class="ident" id="6495882">Short</span><span class="op" id="6495887">(</span><span class="op" id="6495888">)</span>&nbsp;<span class="op" id="6495890">||</span>&nbsp;<span class="op" id="6495893">!</span><span class="op" id="6495894">*</span><span class="ident" id="6495895">testExternal</span>&nbsp;<span class="op" id="6495908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6495912">t</span><span class="op" id="6495913">.</span><span class="ident" id="6495914">Skip</span><span class="op" id="6495918">(</span><span class="string" id="6495919">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6495960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6495963">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6495967">nss</span><span class="op" id="6495970">,</span>&nbsp;<span class="ident" id="6495972">err</span>&nbsp;<span class="op" id="6495976">:=</span>&nbsp;<span class="ident" id="6495979">LookupNS</span><span class="op" id="6495987">(</span><span class="string" id="6495988">&#34;gmail.com&#34;</span><span class="op" id="6495999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6496002">if</span>&nbsp;<span class="ident" id="6496005">err</span>&nbsp;<span class="op" id="6496009">!=</span>&nbsp;<span class="builtintype" id="6496012">nil</span>&nbsp;<span class="op" id="6496016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6496020">t</span><span class="op" id="6496021">.</span><span class="ident" id="6496022">Fatal</span><span class="op" id="6496027">(</span><span class="ident" id="6496028">err</span><span class="op" id="6496031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6496034">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6496037">if</span>&nbsp;<span class="builtinfunc" id="6496040">len</span><span class="op" id="6496043">(</span><span class="ident" id="6496044">nss</span><span class="op" id="6496047">)</span>&nbsp;<span class="op" id="6496049">==</span>&nbsp;<span class="num" id="6496052">0</span>&nbsp;<span class="op" id="6496054">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6496058">t</span><span class="op" id="6496059">.</span><span class="ident" id="6496060">Error</span><span class="op" id="6496065">(</span><span class="string" id="6496066">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="6496081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6496084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6496087">for</span>&nbsp;<span class="ident" id="6496091">_</span><span class="op" id="6496092">,</span>&nbsp;<span class="ident" id="6496094">ns</span>&nbsp;<span class="op" id="6496097">:=</span>&nbsp;<span class="keyword" id="6496100">range</span>&nbsp;<span class="ident" id="6496106">nss</span>&nbsp;<span class="op" id="6496110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6496114">if</span>&nbsp;<span class="op" id="6496117">!</span><span class="ident" id="6496118">strings</span><span class="op" id="6496125">.</span><span class="ident" id="6496126">Contains</span><span class="op" id="6496134">(</span><span class="ident" id="6496135">ns</span><span class="op" id="6496137">.</span><span class="ident" id="6496138">Host</span><span class="op" id="6496142">,</span>&nbsp;<span class="string" id="6496144">&#34;.google.com&#34;</span><span class="op" id="6496157">)</span>&nbsp;<span class="op" id="6496159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6496164">t</span><span class="op" id="6496165">.</span><span class="ident" id="6496166">Errorf</span><span class="op" id="6496172">(</span><span class="string" id="6496173">&#34;got&nbsp;%v;&nbsp;want&nbsp;a&nbsp;record&nbsp;containing&nbsp;.google.com.&#34;</span><span class="op" id="6496220">,</span>&nbsp;<span class="ident" id="6496222">ns</span><span class="op" id="6496224">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6496228">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6496231">}</span><br>
<span class="lineno"></span><span class="op" id="6496233">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6496236">func</span>&nbsp;<span class="ident" id="6496241">TestLookupGmailTXT</span><span class="op" id="6496259">(</span><span class="ident" id="6496260">t</span>&nbsp;<span class="op" id="6496262">*</span><span class="ident" id="6496263">testing</span><span class="op" id="6496270">.</span><span class="ident" id="6496271">T</span><span class="op" id="6496272">)</span>&nbsp;<span class="op" id="6496274">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6496277">if</span>&nbsp;<span class="ident" id="6496280">testing</span><span class="op" id="6496287">.</span><span class="ident" id="6496288">Short</span><span class="op" id="6496293">(</span><span class="op" id="6496294">)</span>&nbsp;<span class="op" id="6496296">||</span>&nbsp;<span class="op" id="6496299">!</span><span class="op" id="6496300">*</span><span class="ident" id="6496301">testExternal</span>&nbsp;<span class="op" id="6496314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6496318">t</span><span class="op" id="6496319">.</span><span class="ident" id="6496320">Skip</span><span class="op" id="6496324">(</span><span class="string" id="6496325">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6496366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6496369">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6496373">txts</span><span class="op" id="6496377">,</span>&nbsp;<span class="ident" id="6496379">err</span>&nbsp;<span class="op" id="6496383">:=</span>&nbsp;<span class="ident" id="6496386">LookupTXT</span><span class="op" id="6496395">(</span><span class="string" id="6496396">&#34;gmail.com&#34;</span><span class="op" id="6496407">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6496410">if</span>&nbsp;<span class="ident" id="6496413">err</span>&nbsp;<span class="op" id="6496417">!=</span>&nbsp;<span class="builtintype" id="6496420">nil</span>&nbsp;<span class="op" id="6496424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6496428">t</span><span class="op" id="6496429">.</span><span class="ident" id="6496430">Fatal</span><span class="op" id="6496435">(</span><span class="ident" id="6496436">err</span><span class="op" id="6496439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6496442">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6496445">if</span>&nbsp;<span class="builtinfunc" id="6496448">len</span><span class="op" id="6496451">(</span><span class="ident" id="6496452">txts</span><span class="op" id="6496456">)</span>&nbsp;<span class="op" id="6496458">==</span>&nbsp;<span class="num" id="6496461">0</span>&nbsp;<span class="op" id="6496463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6496467">t</span><span class="op" id="6496468">.</span><span class="ident" id="6496469">Error</span><span class="op" id="6496474">(</span><span class="string" id="6496475">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="6496490">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6496493">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6496496">for</span>&nbsp;<span class="ident" id="6496500">_</span><span class="op" id="6496501">,</span>&nbsp;<span class="ident" id="6496503">txt</span>&nbsp;<span class="op" id="6496507">:=</span>&nbsp;<span class="keyword" id="6496510">range</span>&nbsp;<span class="ident" id="6496516">txts</span>&nbsp;<span class="op" id="6496521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6496525">if</span>&nbsp;<span class="op" id="6496528">!</span><span class="ident" id="6496529">strings</span><span class="op" id="6496536">.</span><span class="ident" id="6496537">Contains</span><span class="op" id="6496545">(</span><span class="ident" id="6496546">txt</span><span class="op" id="6496549">,</span>&nbsp;<span class="string" id="6496551">&#34;spf&#34;</span><span class="op" id="6496556">)</span>&nbsp;<span class="op" id="6496558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6496563">t</span><span class="op" id="6496564">.</span><span class="ident" id="6496565">Errorf</span><span class="op" id="6496571">(</span><span class="string" id="6496572">&#34;got&nbsp;%q;&nbsp;want&nbsp;a&nbsp;spf&nbsp;record&#34;</span><span class="op" id="6496599">,</span>&nbsp;<span class="ident" id="6496601">txt</span><span class="op" id="6496604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6496608">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6496611">}</span><br>
<span class="lineno"></span><span class="op" id="6496613">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6496616">var</span>&nbsp;<span class="ident" id="6496620">lookupGooglePublicDNSAddrs</span>&nbsp;<span class="op" id="6496647">=</span>&nbsp;<span class="op" id="6496649">[</span><span class="op" id="6496650">]</span><span class="keyword" id="6496651">struct</span>&nbsp;<span class="op" id="6496658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6496661">addr</span>&nbsp;<span class="builtintype" id="6496666">string</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6496674">name</span>&nbsp;<span class="builtintype" id="6496679">string</span><br>
<span class="lineno"></span><span class="op" id="6496686">}</span><span class="op" id="6496687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6496690">{</span><span class="string" id="6496691">&#34;8.8.8.8&#34;</span><span class="op" id="6496700">,</span>&nbsp;<span class="string" id="6496702">&#34;.google.com.&#34;</span><span class="op" id="6496716">}</span><span class="op" id="6496717">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6496720">{</span><span class="string" id="6496721">&#34;8.8.4.4&#34;</span><span class="op" id="6496730">,</span>&nbsp;<span class="string" id="6496732">&#34;.google.com.&#34;</span><span class="op" id="6496746">}</span><span class="op" id="6496747">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6496750">{</span><span class="string" id="6496751">&#34;2001:4860:4860::8888&#34;</span><span class="op" id="6496773">,</span>&nbsp;<span class="string" id="6496775">&#34;.google.com.&#34;</span><span class="op" id="6496789">}</span><span class="op" id="6496790">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6496793">{</span><span class="string" id="6496794">&#34;2001:4860:4860::8844&#34;</span><span class="op" id="6496816">,</span>&nbsp;<span class="string" id="6496818">&#34;.google.com.&#34;</span><span class="op" id="6496832">}</span><span class="op" id="6496833">,</span><br>
<span class="lineno"></span><span class="op" id="6496835">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6496838">func</span>&nbsp;<span class="ident" id="6496843">TestLookupGooglePublicDNSAddr</span><span class="op" id="6496872">(</span><span class="ident" id="6496873">t</span>&nbsp;<span class="op" id="6496875">*</span><span class="ident" id="6496876">testing</span><span class="op" id="6496883">.</span><span class="ident" id="6496884">T</span><span class="op" id="6496885">)</span>&nbsp;<span class="op" id="6496887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6496890">if</span>&nbsp;<span class="ident" id="6496893">testing</span><span class="op" id="6496900">.</span><span class="ident" id="6496901">Short</span><span class="op" id="6496906">(</span><span class="op" id="6496907">)</span>&nbsp;<span class="op" id="6496909">||</span>&nbsp;<span class="op" id="6496912">!</span><span class="op" id="6496913">*</span><span class="ident" id="6496914">testExternal</span>&nbsp;<span class="op" id="6496927">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6496931">t</span><span class="op" id="6496932">.</span><span class="ident" id="6496933">Skip</span><span class="op" id="6496937">(</span><span class="string" id="6496938">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6496979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6496982">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6496986">for</span>&nbsp;<span class="ident" id="6496990">_</span><span class="op" id="6496991">,</span>&nbsp;<span class="ident" id="6496993">tt</span>&nbsp;<span class="op" id="6496996">:=</span>&nbsp;<span class="keyword" id="6496999">range</span>&nbsp;<span class="ident" id="6497005">lookupGooglePublicDNSAddrs</span>&nbsp;<span class="op" id="6497032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6497036">names</span><span class="op" id="6497041">,</span>&nbsp;<span class="ident" id="6497043">err</span>&nbsp;<span class="op" id="6497047">:=</span>&nbsp;<span class="ident" id="6497050">LookupAddr</span><span class="op" id="6497060">(</span><span class="ident" id="6497061">tt</span><span class="op" id="6497063">.</span><span class="ident" id="6497064">addr</span><span class="op" id="6497068">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6497072">if</span>&nbsp;<span class="ident" id="6497075">err</span>&nbsp;<span class="op" id="6497079">!=</span>&nbsp;<span class="builtintype" id="6497082">nil</span>&nbsp;<span class="op" id="6497086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6497091">t</span><span class="op" id="6497092">.</span><span class="ident" id="6497093">Fatal</span><span class="op" id="6497098">(</span><span class="ident" id="6497099">err</span><span class="op" id="6497102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6497106">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6497110">if</span>&nbsp;<span class="builtinfunc" id="6497113">len</span><span class="op" id="6497116">(</span><span class="ident" id="6497117">names</span><span class="op" id="6497122">)</span>&nbsp;<span class="op" id="6497124">==</span>&nbsp;<span class="num" id="6497127">0</span>&nbsp;<span class="op" id="6497129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6497134">t</span><span class="op" id="6497135">.</span><span class="ident" id="6497136">Error</span><span class="op" id="6497141">(</span><span class="string" id="6497142">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="6497157">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6497161">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6497165">for</span>&nbsp;<span class="ident" id="6497169">_</span><span class="op" id="6497170">,</span>&nbsp;<span class="ident" id="6497172">name</span>&nbsp;<span class="op" id="6497177">:=</span>&nbsp;<span class="keyword" id="6497180">range</span>&nbsp;<span class="ident" id="6497186">names</span>&nbsp;<span class="op" id="6497192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6497197">if</span>&nbsp;<span class="op" id="6497200">!</span><span class="ident" id="6497201">strings</span><span class="op" id="6497208">.</span><span class="ident" id="6497209">HasSuffix</span><span class="op" id="6497218">(</span><span class="ident" id="6497219">name</span><span class="op" id="6497223">,</span>&nbsp;<span class="ident" id="6497225">tt</span><span class="op" id="6497227">.</span><span class="ident" id="6497228">name</span><span class="op" id="6497232">)</span>&nbsp;<span class="op" id="6497234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6497240">t</span><span class="op" id="6497241">.</span><span class="ident" id="6497242">Errorf</span><span class="op" id="6497248">(</span><span class="string" id="6497249">&#34;got&nbsp;%q;&nbsp;want&nbsp;a&nbsp;record&nbsp;containing&nbsp;%q&#34;</span><span class="op" id="6497286">,</span>&nbsp;<span class="ident" id="6497288">name</span><span class="op" id="6497292">,</span>&nbsp;<span class="ident" id="6497294">tt</span><span class="op" id="6497296">.</span><span class="ident" id="6497297">name</span><span class="op" id="6497301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6497306">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6497310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6497313">}</span><br>
<span class="lineno"></span><span class="op" id="6497315">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6497318">func</span>&nbsp;<span class="ident" id="6497323">TestLookupIANACNAME</span><span class="op" id="6497342">(</span><span class="ident" id="6497343">t</span>&nbsp;<span class="op" id="6497345">*</span><span class="ident" id="6497346">testing</span><span class="op" id="6497353">.</span><span class="ident" id="6497354">T</span><span class="op" id="6497355">)</span>&nbsp;<span class="op" id="6497357">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6497360">if</span>&nbsp;<span class="ident" id="6497363">testing</span><span class="op" id="6497370">.</span><span class="ident" id="6497371">Short</span><span class="op" id="6497376">(</span><span class="op" id="6497377">)</span>&nbsp;<span class="op" id="6497379">||</span>&nbsp;<span class="op" id="6497382">!</span><span class="op" id="6497383">*</span><span class="ident" id="6497384">testExternal</span>&nbsp;<span class="op" id="6497397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6497401">t</span><span class="op" id="6497402">.</span><span class="ident" id="6497403">Skip</span><span class="op" id="6497407">(</span><span class="string" id="6497408">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6497449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6497452">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6497456">cname</span><span class="op" id="6497461">,</span>&nbsp;<span class="ident" id="6497463">err</span>&nbsp;<span class="op" id="6497467">:=</span>&nbsp;<span class="ident" id="6497470">LookupCNAME</span><span class="op" id="6497481">(</span><span class="string" id="6497482">&#34;www.iana.org&#34;</span><span class="op" id="6497496">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6497499">if</span>&nbsp;<span class="ident" id="6497502">err</span>&nbsp;<span class="op" id="6497506">!=</span>&nbsp;<span class="builtintype" id="6497509">nil</span>&nbsp;<span class="op" id="6497513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6497517">t</span><span class="op" id="6497518">.</span><span class="ident" id="6497519">Fatal</span><span class="op" id="6497524">(</span><span class="ident" id="6497525">err</span><span class="op" id="6497528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6497531">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6497534">if</span>&nbsp;<span class="op" id="6497537">!</span><span class="ident" id="6497538">strings</span><span class="op" id="6497545">.</span><span class="ident" id="6497546">HasSuffix</span><span class="op" id="6497555">(</span><span class="ident" id="6497556">cname</span><span class="op" id="6497561">,</span>&nbsp;<span class="string" id="6497563">&#34;.icann.org.&#34;</span><span class="op" id="6497576">)</span>&nbsp;<span class="op" id="6497578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6497582">t</span><span class="op" id="6497583">.</span><span class="ident" id="6497584">Errorf</span><span class="op" id="6497590">(</span><span class="string" id="6497591">&#34;got&nbsp;%q;&nbsp;want&nbsp;a&nbsp;record&nbsp;containing&nbsp;.icann.org.&#34;</span><span class="op" id="6497637">,</span>&nbsp;<span class="ident" id="6497639">cname</span><span class="op" id="6497644">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6497647">}</span><br>
<span class="lineno"></span><span class="op" id="6497649">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6497652">func</span>&nbsp;<span class="ident" id="6497657">TestLookupGoogleHost</span><span class="op" id="6497677">(</span><span class="ident" id="6497678">t</span>&nbsp;<span class="op" id="6497680">*</span><span class="ident" id="6497681">testing</span><span class="op" id="6497688">.</span><span class="ident" id="6497689">T</span><span class="op" id="6497690">)</span>&nbsp;<span class="op" id="6497692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6497695">if</span>&nbsp;<span class="ident" id="6497698">testing</span><span class="op" id="6497705">.</span><span class="ident" id="6497706">Short</span><span class="op" id="6497711">(</span><span class="op" id="6497712">)</span>&nbsp;<span class="op" id="6497714">||</span>&nbsp;<span class="op" id="6497717">!</span><span class="op" id="6497718">*</span><span class="ident" id="6497719">testExternal</span>&nbsp;<span class="op" id="6497732">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6497736">t</span><span class="op" id="6497737">.</span><span class="ident" id="6497738">Skip</span><span class="op" id="6497742">(</span><span class="string" id="6497743">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6497784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6497787">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6497791">addrs</span><span class="op" id="6497796">,</span>&nbsp;<span class="ident" id="6497798">err</span>&nbsp;<span class="op" id="6497802">:=</span>&nbsp;<span class="ident" id="6497805">LookupHost</span><span class="op" id="6497815">(</span><span class="string" id="6497816">&#34;google.com&#34;</span><span class="op" id="6497828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6497831">if</span>&nbsp;<span class="ident" id="6497834">err</span>&nbsp;<span class="op" id="6497838">!=</span>&nbsp;<span class="builtintype" id="6497841">nil</span>&nbsp;<span class="op" id="6497845">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6497849">t</span><span class="op" id="6497850">.</span><span class="ident" id="6497851">Fatal</span><span class="op" id="6497856">(</span><span class="ident" id="6497857">err</span><span class="op" id="6497860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6497863">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6497866">if</span>&nbsp;<span class="builtinfunc" id="6497869">len</span><span class="op" id="6497872">(</span><span class="ident" id="6497873">addrs</span><span class="op" id="6497878">)</span>&nbsp;<span class="op" id="6497880">==</span>&nbsp;<span class="num" id="6497883">0</span>&nbsp;<span class="op" id="6497885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6497889">t</span><span class="op" id="6497890">.</span><span class="ident" id="6497891">Error</span><span class="op" id="6497896">(</span><span class="string" id="6497897">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="6497912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6497915">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6497918">for</span>&nbsp;<span class="ident" id="6497922">_</span><span class="op" id="6497923">,</span>&nbsp;<span class="ident" id="6497925">addr</span>&nbsp;<span class="op" id="6497930">:=</span>&nbsp;<span class="keyword" id="6497933">range</span>&nbsp;<span class="ident" id="6497939">addrs</span>&nbsp;<span class="op" id="6497945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6497949">if</span>&nbsp;<span class="ident" id="6497952">ParseIP</span><span class="op" id="6497959">(</span><span class="ident" id="6497960">addr</span><span class="op" id="6497964">)</span>&nbsp;<span class="op" id="6497966">==</span>&nbsp;<span class="builtintype" id="6497969">nil</span>&nbsp;<span class="op" id="6497973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6497978">t</span><span class="op" id="6497979">.</span><span class="ident" id="6497980">Errorf</span><span class="op" id="6497986">(</span><span class="string" id="6497987">&#34;got&nbsp;%q;&nbsp;want&nbsp;a&nbsp;literal&nbsp;ip&nbsp;address&#34;</span><span class="op" id="6498022">,</span>&nbsp;<span class="ident" id="6498024">addr</span><span class="op" id="6498028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6498032">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6498035">}</span><br>
<span class="lineno">175</span><span class="op" id="6498037">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6498040">func</span>&nbsp;<span class="ident" id="6498045">TestLookupGoogleIP</span><span class="op" id="6498063">(</span><span class="ident" id="6498064">t</span>&nbsp;<span class="op" id="6498066">*</span><span class="ident" id="6498067">testing</span><span class="op" id="6498074">.</span><span class="ident" id="6498075">T</span><span class="op" id="6498076">)</span>&nbsp;<span class="op" id="6498078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6498081">if</span>&nbsp;<span class="ident" id="6498084">testing</span><span class="op" id="6498091">.</span><span class="ident" id="6498092">Short</span><span class="op" id="6498097">(</span><span class="op" id="6498098">)</span>&nbsp;<span class="op" id="6498100">||</span>&nbsp;<span class="op" id="6498103">!</span><span class="op" id="6498104">*</span><span class="ident" id="6498105">testExternal</span>&nbsp;<span class="op" id="6498118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6498122">t</span><span class="op" id="6498123">.</span><span class="ident" id="6498124">Skip</span><span class="op" id="6498128">(</span><span class="string" id="6498129">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6498170">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6498173">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6498177">ips</span><span class="op" id="6498180">,</span>&nbsp;<span class="ident" id="6498182">err</span>&nbsp;<span class="op" id="6498186">:=</span>&nbsp;<span class="ident" id="6498189">LookupIP</span><span class="op" id="6498197">(</span><span class="string" id="6498198">&#34;google.com&#34;</span><span class="op" id="6498210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6498213">if</span>&nbsp;<span class="ident" id="6498216">err</span>&nbsp;<span class="op" id="6498220">!=</span>&nbsp;<span class="builtintype" id="6498223">nil</span>&nbsp;<span class="op" id="6498227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6498231">t</span><span class="op" id="6498232">.</span><span class="ident" id="6498233">Fatal</span><span class="op" id="6498238">(</span><span class="ident" id="6498239">err</span><span class="op" id="6498242">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6498245">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6498248">if</span>&nbsp;<span class="builtinfunc" id="6498251">len</span><span class="op" id="6498254">(</span><span class="ident" id="6498255">ips</span><span class="op" id="6498258">)</span>&nbsp;<span class="op" id="6498260">==</span>&nbsp;<span class="num" id="6498263">0</span>&nbsp;<span class="op" id="6498265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6498269">t</span><span class="op" id="6498270">.</span><span class="ident" id="6498271">Error</span><span class="op" id="6498276">(</span><span class="string" id="6498277">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="6498292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6498295">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6498298">for</span>&nbsp;<span class="ident" id="6498302">_</span><span class="op" id="6498303">,</span>&nbsp;<span class="ident" id="6498305">ip</span>&nbsp;<span class="op" id="6498308">:=</span>&nbsp;<span class="keyword" id="6498311">range</span>&nbsp;<span class="ident" id="6498317">ips</span>&nbsp;<span class="op" id="6498321">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6498325">if</span>&nbsp;<span class="ident" id="6498328">ip</span><span class="op" id="6498330">.</span><span class="ident" id="6498331">To4</span><span class="op" id="6498334">(</span><span class="op" id="6498335">)</span>&nbsp;<span class="op" id="6498337">==</span>&nbsp;<span class="builtintype" id="6498340">nil</span>&nbsp;<span class="op" id="6498344">&amp;&amp;</span>&nbsp;<span class="ident" id="6498347">ip</span><span class="op" id="6498349">.</span><span class="ident" id="6498350">To16</span><span class="op" id="6498354">(</span><span class="op" id="6498355">)</span>&nbsp;<span class="op" id="6498357">==</span>&nbsp;<span class="builtintype" id="6498360">nil</span>&nbsp;<span class="op" id="6498364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6498369">t</span><span class="op" id="6498370">.</span><span class="ident" id="6498371">Errorf</span><span class="op" id="6498377">(</span><span class="string" id="6498378">&#34;got&nbsp;%v;&nbsp;want&nbsp;an&nbsp;ip&nbsp;address&#34;</span><span class="op" id="6498406">,</span>&nbsp;<span class="ident" id="6498408">ip</span><span class="op" id="6498410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6498414">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6498417">}</span><br>
<span class="lineno"></span><span class="op" id="6498419">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span><span class="keyword" id="6498422">var</span>&nbsp;<span class="ident" id="6498426">revAddrTests</span>&nbsp;<span class="op" id="6498439">=</span>&nbsp;<span class="op" id="6498441">[</span><span class="op" id="6498442">]</span><span class="keyword" id="6498443">struct</span>&nbsp;<span class="op" id="6498450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6498453">Addr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6498463">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6498471">Reverse</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6498481">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6498489">ErrPrefix</span>&nbsp;<span class="builtintype" id="6498499">string</span><br>
<span class="lineno">200</span><span class="op" id="6498506">}</span><span class="op" id="6498507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6498510">{</span><span class="string" id="6498511">&#34;1.2.3.4&#34;</span><span class="op" id="6498520">,</span>&nbsp;<span class="string" id="6498522">&#34;4.3.2.1.in-addr.arpa.&#34;</span><span class="op" id="6498545">,</span>&nbsp;<span class="string" id="6498547">&#34;&#34;</span><span class="op" id="6498549">}</span><span class="op" id="6498550">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6498553">{</span><span class="string" id="6498554">&#34;245.110.36.114&#34;</span><span class="op" id="6498570">,</span>&nbsp;<span class="string" id="6498572">&#34;114.36.110.245.in-addr.arpa.&#34;</span><span class="op" id="6498602">,</span>&nbsp;<span class="string" id="6498604">&#34;&#34;</span><span class="op" id="6498606">}</span><span class="op" id="6498607">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6498610">{</span><span class="string" id="6498611">&#34;::ffff:12.34.56.78&#34;</span><span class="op" id="6498631">,</span>&nbsp;<span class="string" id="6498633">&#34;78.56.34.12.in-addr.arpa.&#34;</span><span class="op" id="6498660">,</span>&nbsp;<span class="string" id="6498662">&#34;&#34;</span><span class="op" id="6498664">}</span><span class="op" id="6498665">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6498668">{</span><span class="string" id="6498669">&#34;::1&#34;</span><span class="op" id="6498674">,</span>&nbsp;<span class="string" id="6498676">&#34;1.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.ip6.arpa.&#34;</span><span class="op" id="6498751">,</span>&nbsp;<span class="string" id="6498753">&#34;&#34;</span><span class="op" id="6498755">}</span><span class="op" id="6498756">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6498759">{</span><span class="string" id="6498760">&#34;1::&#34;</span><span class="op" id="6498765">,</span>&nbsp;<span class="string" id="6498767">&#34;0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.1.0.0.0.ip6.arpa.&#34;</span><span class="op" id="6498842">,</span>&nbsp;<span class="string" id="6498844">&#34;&#34;</span><span class="op" id="6498846">}</span><span class="op" id="6498847">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6498850">{</span><span class="string" id="6498851">&#34;1234:567::89a:bcde&#34;</span><span class="op" id="6498871">,</span>&nbsp;<span class="string" id="6498873">&#34;e.d.c.b.a.9.8.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.7.6.5.0.4.3.2.1.ip6.arpa.&#34;</span><span class="op" id="6498948">,</span>&nbsp;<span class="string" id="6498950">&#34;&#34;</span><span class="op" id="6498952">}</span><span class="op" id="6498953">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6498956">{</span><span class="string" id="6498957">&#34;1234:567:fefe:bcbc:adad:9e4a:89a:bcde&#34;</span><span class="op" id="6498996">,</span>&nbsp;<span class="string" id="6498998">&#34;e.d.c.b.a.9.8.0.a.4.e.9.d.a.d.a.c.b.c.b.e.f.e.f.7.6.5.0.4.3.2.1.ip6.arpa.&#34;</span><span class="op" id="6499073">,</span>&nbsp;<span class="string" id="6499075">&#34;&#34;</span><span class="op" id="6499077">}</span><span class="op" id="6499078">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6499081">{</span><span class="string" id="6499082">&#34;1.2.3&#34;</span><span class="op" id="6499089">,</span>&nbsp;<span class="string" id="6499091">&#34;&#34;</span><span class="op" id="6499093">,</span>&nbsp;<span class="string" id="6499095">&#34;unrecognized&nbsp;address&#34;</span><span class="op" id="6499117">}</span><span class="op" id="6499118">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6499121">{</span><span class="string" id="6499122">&#34;1.2.3.4.5&#34;</span><span class="op" id="6499133">,</span>&nbsp;<span class="string" id="6499135">&#34;&#34;</span><span class="op" id="6499137">,</span>&nbsp;<span class="string" id="6499139">&#34;unrecognized&nbsp;address&#34;</span><span class="op" id="6499161">}</span><span class="op" id="6499162">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6499165">{</span><span class="string" id="6499166">&#34;1234:567:bcbca::89a:bcde&#34;</span><span class="op" id="6499192">,</span>&nbsp;<span class="string" id="6499194">&#34;&#34;</span><span class="op" id="6499196">,</span>&nbsp;<span class="string" id="6499198">&#34;unrecognized&nbsp;address&#34;</span><span class="op" id="6499220">}</span><span class="op" id="6499221">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6499224">{</span><span class="string" id="6499225">&#34;1234:567::bcbc:adad::89a:bcde&#34;</span><span class="op" id="6499256">,</span>&nbsp;<span class="string" id="6499258">&#34;&#34;</span><span class="op" id="6499260">,</span>&nbsp;<span class="string" id="6499262">&#34;unrecognized&nbsp;address&#34;</span><span class="op" id="6499284">}</span><span class="op" id="6499285">,</span><br>
<span class="lineno"></span><span class="op" id="6499287">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6499290">func</span>&nbsp;<span class="ident" id="6499295">TestReverseAddress</span><span class="op" id="6499313">(</span><span class="ident" id="6499314">t</span>&nbsp;<span class="op" id="6499316">*</span><span class="ident" id="6499317">testing</span><span class="op" id="6499324">.</span><span class="ident" id="6499325">T</span><span class="op" id="6499326">)</span>&nbsp;<span class="op" id="6499328">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6499331">for</span>&nbsp;<span class="ident" id="6499335">i</span><span class="op" id="6499336">,</span>&nbsp;<span class="ident" id="6499338">tt</span>&nbsp;<span class="op" id="6499341">:=</span>&nbsp;<span class="keyword" id="6499344">range</span>&nbsp;<span class="ident" id="6499350">revAddrTests</span>&nbsp;<span class="op" id="6499363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6499367">a</span><span class="op" id="6499368">,</span>&nbsp;<span class="ident" id="6499370">err</span>&nbsp;<span class="op" id="6499374">:=</span>&nbsp;<span class="ident" id="6499377">reverseaddr</span><span class="op" id="6499388">(</span><span class="ident" id="6499389">tt</span><span class="op" id="6499391">.</span><span class="ident" id="6499392">Addr</span><span class="op" id="6499396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6499400">if</span>&nbsp;<span class="builtinfunc" id="6499403">len</span><span class="op" id="6499406">(</span><span class="ident" id="6499407">tt</span><span class="op" id="6499409">.</span><span class="ident" id="6499410">ErrPrefix</span><span class="op" id="6499419">)</span>&nbsp;<span class="op" id="6499421">&gt;</span>&nbsp;<span class="num" id="6499423">0</span>&nbsp;<span class="op" id="6499425">&amp;&amp;</span>&nbsp;<span class="ident" id="6499428">err</span>&nbsp;<span class="op" id="6499432">==</span>&nbsp;<span class="builtintype" id="6499435">nil</span>&nbsp;<span class="op" id="6499439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6499444">t</span><span class="op" id="6499445">.</span><span class="ident" id="6499446">Errorf</span><span class="op" id="6499452">(</span><span class="string" id="6499453">&#34;#%d:&nbsp;expected&nbsp;%q,&nbsp;got&nbsp;&lt;nil&gt;&nbsp;(error)&#34;</span><span class="op" id="6499490">,</span>&nbsp;<span class="ident" id="6499492">i</span><span class="op" id="6499493">,</span>&nbsp;<span class="ident" id="6499495">tt</span><span class="op" id="6499497">.</span><span class="ident" id="6499498">ErrPrefix</span><span class="op" id="6499507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6499512">continue</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6499523">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6499527">if</span>&nbsp;<span class="builtinfunc" id="6499530">len</span><span class="op" id="6499533">(</span><span class="ident" id="6499534">tt</span><span class="op" id="6499536">.</span><span class="ident" id="6499537">ErrPrefix</span><span class="op" id="6499546">)</span>&nbsp;<span class="op" id="6499548">==</span>&nbsp;<span class="num" id="6499551">0</span>&nbsp;<span class="op" id="6499553">&amp;&amp;</span>&nbsp;<span class="ident" id="6499556">err</span>&nbsp;<span class="op" id="6499560">!=</span>&nbsp;<span class="builtintype" id="6499563">nil</span>&nbsp;<span class="op" id="6499567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6499572">t</span><span class="op" id="6499573">.</span><span class="ident" id="6499574">Errorf</span><span class="op" id="6499580">(</span><span class="string" id="6499581">&#34;#%d:&nbsp;expected&nbsp;&lt;nil&gt;,&nbsp;got&nbsp;%q&nbsp;(error)&#34;</span><span class="op" id="6499618">,</span>&nbsp;<span class="ident" id="6499620">i</span><span class="op" id="6499621">,</span>&nbsp;<span class="ident" id="6499623">err</span><span class="op" id="6499626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6499630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6499634">if</span>&nbsp;<span class="ident" id="6499637">err</span>&nbsp;<span class="op" id="6499641">!=</span>&nbsp;<span class="builtintype" id="6499644">nil</span>&nbsp;<span class="op" id="6499648">&amp;&amp;</span>&nbsp;<span class="ident" id="6499651">err</span><span class="op" id="6499654">.</span><span class="op" id="6499655">(</span><span class="op" id="6499656">*</span><span class="ident" id="6499657">DNSError</span><span class="op" id="6499665">)</span><span class="op" id="6499666">.</span><span class="ident" id="6499667">Err</span>&nbsp;<span class="op" id="6499671">!=</span>&nbsp;<span class="ident" id="6499674">tt</span><span class="op" id="6499676">.</span><span class="ident" id="6499677">ErrPrefix</span>&nbsp;<span class="op" id="6499687">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6499692">t</span><span class="op" id="6499693">.</span><span class="ident" id="6499694">Errorf</span><span class="op" id="6499700">(</span><span class="string" id="6499701">&#34;#%d:&nbsp;expected&nbsp;%q,&nbsp;got&nbsp;%q&nbsp;(mismatched&nbsp;error)&#34;</span><span class="op" id="6499746">,</span>&nbsp;<span class="ident" id="6499748">i</span><span class="op" id="6499749">,</span>&nbsp;<span class="ident" id="6499751">tt</span><span class="op" id="6499753">.</span><span class="ident" id="6499754">ErrPrefix</span><span class="op" id="6499763">,</span>&nbsp;<span class="ident" id="6499765">err</span><span class="op" id="6499768">.</span><span class="op" id="6499769">(</span><span class="op" id="6499770">*</span><span class="ident" id="6499771">DNSError</span><span class="op" id="6499779">)</span><span class="op" id="6499780">.</span><span class="ident" id="6499781">Err</span><span class="op" id="6499784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6499788">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6499792">if</span>&nbsp;<span class="ident" id="6499795">a</span>&nbsp;<span class="op" id="6499797">!=</span>&nbsp;<span class="ident" id="6499800">tt</span><span class="op" id="6499802">.</span><span class="ident" id="6499803">Reverse</span>&nbsp;<span class="op" id="6499811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6499816">t</span><span class="op" id="6499817">.</span><span class="ident" id="6499818">Errorf</span><span class="op" id="6499824">(</span><span class="string" id="6499825">&#34;#%d:&nbsp;expected&nbsp;%q,&nbsp;got&nbsp;%q&nbsp;(reverse&nbsp;address)&#34;</span><span class="op" id="6499869">,</span>&nbsp;<span class="ident" id="6499871">i</span><span class="op" id="6499872">,</span>&nbsp;<span class="ident" id="6499874">tt</span><span class="op" id="6499876">.</span><span class="ident" id="6499877">Reverse</span><span class="op" id="6499884">,</span>&nbsp;<span class="ident" id="6499886">a</span><span class="op" id="6499887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6499891">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6499894">}</span><br>
<span class="lineno"></span><span class="op" id="6499896">}</span>
</div>
</body>
</html>
