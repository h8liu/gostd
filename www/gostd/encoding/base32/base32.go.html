<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/base32</h2>
<ul>
<li><a href="/gostd/encoding/base32/base32.go.html" class="current">base32.go</a></li>
<li><a href="/gostd/encoding/base32/base32_test.go.html">base32_test.go</a></li>
<li><a href="/gostd/encoding/base32/example_test.go.html">example_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6122771">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6122826">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6122880">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6122931">//&nbsp;Package&nbsp;base32&nbsp;implements&nbsp;base32&nbsp;encoding&nbsp;as&nbsp;specified&nbsp;by&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno"></span><span class="keyword" id="6123002">package</span>&nbsp;<span class="ident" id="6123010">base32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6123018">import</span>&nbsp;<span class="op" id="6123025">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6123028">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6123037">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6123043">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6123054">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="6123064">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="6123067">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Encodings<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6123088">//&nbsp;An&nbsp;Encoding&nbsp;is&nbsp;a&nbsp;radix&nbsp;32&nbsp;encoding/decoding&nbsp;scheme,&nbsp;defined&nbsp;by&nbsp;a</span><br>
<span class="lineno">20</span><span class="comment" id="6123156">//&nbsp;32-character&nbsp;alphabet.&nbsp;&nbsp;The&nbsp;most&nbsp;common&nbsp;is&nbsp;the&nbsp;&#34;base32&#34;&nbsp;encoding</span><br>
<span class="lineno"></span><span class="comment" id="6123224">//&nbsp;introduced&nbsp;for&nbsp;SASL&nbsp;GSSAPI&nbsp;and&nbsp;standardized&nbsp;in&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno"></span><span class="comment" id="6123284">//&nbsp;The&nbsp;alternate&nbsp;&#34;base32hex&#34;&nbsp;encoding&nbsp;is&nbsp;used&nbsp;in&nbsp;DNSSEC.</span><br>
<span class="lineno"></span><span class="keyword" id="6123341">type</span>&nbsp;<span class="ident" id="6123346">Encoding</span>&nbsp;<span class="keyword" id="6123355">struct</span>&nbsp;<span class="op" id="6123362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6123365">encode</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6123375">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6123383">decodeMap</span>&nbsp;<span class="op" id="6123393">[</span><span class="num" id="6123394">256</span><span class="op" id="6123397">]</span><span class="builtintype" id="6123398">byte</span><br>
<span class="lineno"></span><span class="op" id="6123403">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6123406">const</span>&nbsp;<span class="ident" id="6123412">encodeStd</span>&nbsp;<span class="op" id="6123422">=</span>&nbsp;<span class="string" id="6123424">&#34;ABCDEFGHIJKLMNOPQRSTUVWXYZ234567&#34;</span><br>
<span class="lineno"></span><span class="keyword" id="6123459">const</span>&nbsp;<span class="ident" id="6123465">encodeHex</span>&nbsp;<span class="op" id="6123475">=</span>&nbsp;<span class="string" id="6123477">&#34;0123456789ABCDEFGHIJKLMNOPQRSTUV&#34;</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="6123513">//&nbsp;NewEncoding&nbsp;returns&nbsp;a&nbsp;new&nbsp;Encoding&nbsp;defined&nbsp;by&nbsp;the&nbsp;given&nbsp;alphabet,</span><br>
<span class="lineno"></span><span class="comment" id="6123582">//&nbsp;which&nbsp;must&nbsp;be&nbsp;a&nbsp;32-byte&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="6123617">func</span>&nbsp;<span class="ident" id="6123622">NewEncoding</span><span class="op" id="6123633">(</span><span class="ident" id="6123634">encoder</span>&nbsp;<span class="builtintype" id="6123642">string</span><span class="op" id="6123648">)</span>&nbsp;<span class="op" id="6123650">*</span><span class="ident" id="6123651">Encoding</span>&nbsp;<span class="op" id="6123660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6123663">e</span>&nbsp;<span class="op" id="6123665">:=</span>&nbsp;<span class="builtinfunc" id="6123668">new</span><span class="op" id="6123671">(</span><span class="ident" id="6123672">Encoding</span><span class="op" id="6123680">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6123683">e</span><span class="op" id="6123684">.</span><span class="ident" id="6123685">encode</span>&nbsp;<span class="op" id="6123692">=</span>&nbsp;<span class="ident" id="6123694">encoder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6123703">for</span>&nbsp;<span class="ident" id="6123707">i</span>&nbsp;<span class="op" id="6123709">:=</span>&nbsp;<span class="num" id="6123712">0</span><span class="op" id="6123713">;</span>&nbsp;<span class="ident" id="6123715">i</span>&nbsp;<span class="op" id="6123717">&lt;</span>&nbsp;<span class="builtinfunc" id="6123719">len</span><span class="op" id="6123722">(</span><span class="ident" id="6123723">e</span><span class="op" id="6123724">.</span><span class="ident" id="6123725">decodeMap</span><span class="op" id="6123734">)</span><span class="op" id="6123735">;</span>&nbsp;<span class="ident" id="6123737">i</span><span class="op" id="6123738">++</span>&nbsp;<span class="op" id="6123741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6123745">e</span><span class="op" id="6123746">.</span><span class="ident" id="6123747">decodeMap</span><span class="op" id="6123756">[</span><span class="ident" id="6123757">i</span><span class="op" id="6123758">]</span>&nbsp;<span class="op" id="6123760">=</span>&nbsp;<span class="num" id="6123762">0xFF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6123768">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6123771">for</span>&nbsp;<span class="ident" id="6123775">i</span>&nbsp;<span class="op" id="6123777">:=</span>&nbsp;<span class="num" id="6123780">0</span><span class="op" id="6123781">;</span>&nbsp;<span class="ident" id="6123783">i</span>&nbsp;<span class="op" id="6123785">&lt;</span>&nbsp;<span class="builtinfunc" id="6123787">len</span><span class="op" id="6123790">(</span><span class="ident" id="6123791">encoder</span><span class="op" id="6123798">)</span><span class="op" id="6123799">;</span>&nbsp;<span class="ident" id="6123801">i</span><span class="op" id="6123802">++</span>&nbsp;<span class="op" id="6123805">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6123809">e</span><span class="op" id="6123810">.</span><span class="ident" id="6123811">decodeMap</span><span class="op" id="6123820">[</span><span class="ident" id="6123821">encoder</span><span class="op" id="6123828">[</span><span class="ident" id="6123829">i</span><span class="op" id="6123830">]</span><span class="op" id="6123831">]</span>&nbsp;<span class="op" id="6123833">=</span>&nbsp;<span class="builtintype" id="6123835">byte</span><span class="op" id="6123839">(</span><span class="ident" id="6123840">i</span><span class="op" id="6123841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6123844">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6123847">return</span>&nbsp;<span class="ident" id="6123854">e</span><br>
<span class="lineno"></span><span class="op" id="6123856">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="6123859">//&nbsp;StdEncoding&nbsp;is&nbsp;the&nbsp;standard&nbsp;base32&nbsp;encoding,&nbsp;as&nbsp;defined&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="6123921">//&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno"></span><span class="keyword" id="6123934">var</span>&nbsp;<span class="ident" id="6123938">StdEncoding</span>&nbsp;<span class="op" id="6123950">=</span>&nbsp;<span class="ident" id="6123952">NewEncoding</span><span class="op" id="6123963">(</span><span class="ident" id="6123964">encodeStd</span><span class="op" id="6123973">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6123976">//&nbsp;HexEncoding&nbsp;is&nbsp;the&nbsp;``Extended&nbsp;Hex&nbsp;Alphabet&#39;&#39;&nbsp;defined&nbsp;in&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno">50</span><span class="comment" id="6124045">//&nbsp;It&nbsp;is&nbsp;typically&nbsp;used&nbsp;in&nbsp;DNS.</span><br>
<span class="lineno"></span><span class="keyword" id="6124077">var</span>&nbsp;<span class="ident" id="6124081">HexEncoding</span>&nbsp;<span class="op" id="6124093">=</span>&nbsp;<span class="ident" id="6124095">NewEncoding</span><span class="op" id="6124106">(</span><span class="ident" id="6124107">encodeHex</span><span class="op" id="6124116">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6124119">var</span>&nbsp;<span class="ident" id="6124123">removeNewlinesMapper</span>&nbsp;<span class="op" id="6124144">=</span>&nbsp;<span class="keyword" id="6124146">func</span><span class="op" id="6124150">(</span><span class="ident" id="6124151">r</span>&nbsp;<span class="builtintype" id="6124153">rune</span><span class="op" id="6124157">)</span>&nbsp;<span class="builtintype" id="6124159">rune</span>&nbsp;<span class="op" id="6124164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6124167">if</span>&nbsp;<span class="ident" id="6124170">r</span>&nbsp;<span class="op" id="6124172">==</span>&nbsp;<span class="string" id="6124175">&#39;\r&#39;</span>&nbsp;<span class="op" id="6124180">||</span>&nbsp;<span class="ident" id="6124183">r</span>&nbsp;<span class="op" id="6124185">==</span>&nbsp;<span class="string" id="6124188">&#39;\n&#39;</span>&nbsp;<span class="op" id="6124193">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6124197">return</span>&nbsp;<span class="op" id="6124204">-</span><span class="num" id="6124205">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6124208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6124211">return</span>&nbsp;<span class="ident" id="6124218">r</span><br>
<span class="lineno"></span><span class="op" id="6124220">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="comment" id="6124223">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Encoder<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6124242">//&nbsp;Encode&nbsp;encodes&nbsp;src&nbsp;using&nbsp;the&nbsp;encoding&nbsp;enc,&nbsp;writing</span><br>
<span class="lineno">65</span><span class="comment" id="6124296">//&nbsp;EncodedLen(len(src))&nbsp;bytes&nbsp;to&nbsp;dst.</span><br>
<span class="lineno"></span><span class="comment" id="6124334">//</span><br>
<span class="lineno"></span><span class="comment" id="6124337">//&nbsp;The&nbsp;encoding&nbsp;pads&nbsp;the&nbsp;output&nbsp;to&nbsp;a&nbsp;multiple&nbsp;of&nbsp;8&nbsp;bytes,</span><br>
<span class="lineno"></span><span class="comment" id="6124395">//&nbsp;so&nbsp;Encode&nbsp;is&nbsp;not&nbsp;appropriate&nbsp;for&nbsp;use&nbsp;on&nbsp;individual&nbsp;blocks</span><br>
<span class="lineno"></span><span class="comment" id="6124456">//&nbsp;of&nbsp;a&nbsp;large&nbsp;data&nbsp;stream.&nbsp;&nbsp;Use&nbsp;NewEncoder()&nbsp;instead.</span><br>
<span class="lineno">70</span><span class="keyword" id="6124510">func</span>&nbsp;<span class="op" id="6124515">(</span><span class="ident" id="6124516">enc</span>&nbsp;<span class="op" id="6124520">*</span><span class="ident" id="6124521">Encoding</span><span class="op" id="6124529">)</span>&nbsp;<span class="ident" id="6124531">Encode</span><span class="op" id="6124537">(</span><span class="ident" id="6124538">dst</span><span class="op" id="6124541">,</span>&nbsp;<span class="ident" id="6124543">src</span>&nbsp;<span class="op" id="6124547">[</span><span class="op" id="6124548">]</span><span class="builtintype" id="6124549">byte</span><span class="op" id="6124553">)</span>&nbsp;<span class="op" id="6124555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6124558">if</span>&nbsp;<span class="builtinfunc" id="6124561">len</span><span class="op" id="6124564">(</span><span class="ident" id="6124565">src</span><span class="op" id="6124568">)</span>&nbsp;<span class="op" id="6124570">==</span>&nbsp;<span class="num" id="6124573">0</span>&nbsp;<span class="op" id="6124575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6124579">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6124587">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6124591">for</span>&nbsp;<span class="builtinfunc" id="6124595">len</span><span class="op" id="6124598">(</span><span class="ident" id="6124599">src</span><span class="op" id="6124602">)</span>&nbsp;<span class="op" id="6124604">&gt;</span>&nbsp;<span class="num" id="6124606">0</span>&nbsp;<span class="op" id="6124608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6124612">var</span>&nbsp;<span class="ident" id="6124616">b0</span><span class="op" id="6124618">,</span>&nbsp;<span class="ident" id="6124620">b1</span><span class="op" id="6124622">,</span>&nbsp;<span class="ident" id="6124624">b2</span><span class="op" id="6124626">,</span>&nbsp;<span class="ident" id="6124628">b3</span><span class="op" id="6124630">,</span>&nbsp;<span class="ident" id="6124632">b4</span><span class="op" id="6124634">,</span>&nbsp;<span class="ident" id="6124636">b5</span><span class="op" id="6124638">,</span>&nbsp;<span class="ident" id="6124640">b6</span><span class="op" id="6124642">,</span>&nbsp;<span class="ident" id="6124644">b7</span>&nbsp;<span class="builtintype" id="6124647">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6124655">//&nbsp;Unpack&nbsp;8x&nbsp;5-bit&nbsp;source&nbsp;blocks&nbsp;into&nbsp;a&nbsp;5&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6124704">//&nbsp;destination&nbsp;quantum</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6124729">switch</span>&nbsp;<span class="builtinfunc" id="6124736">len</span><span class="op" id="6124739">(</span><span class="ident" id="6124740">src</span><span class="op" id="6124743">)</span>&nbsp;<span class="op" id="6124745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6124749">default</span><span class="op" id="6124756">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6124761">b7</span>&nbsp;<span class="op" id="6124764">=</span>&nbsp;<span class="ident" id="6124766">src</span><span class="op" id="6124769">[</span><span class="num" id="6124770">4</span><span class="op" id="6124771">]</span>&nbsp;<span class="op" id="6124773">&amp;</span>&nbsp;<span class="num" id="6124775">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6124783">b6</span>&nbsp;<span class="op" id="6124786">=</span>&nbsp;<span class="ident" id="6124788">src</span><span class="op" id="6124791">[</span><span class="num" id="6124792">4</span><span class="op" id="6124793">]</span>&nbsp;<span class="op" id="6124795">&gt;&gt;</span>&nbsp;<span class="num" id="6124798">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6124803">fallthrough</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6124817">case</span>&nbsp;<span class="num" id="6124822">4</span><span class="op" id="6124823">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6124828">b6</span>&nbsp;<span class="op" id="6124831">|=</span>&nbsp;<span class="op" id="6124834">(</span><span class="ident" id="6124835">src</span><span class="op" id="6124838">[</span><span class="num" id="6124839">3</span><span class="op" id="6124840">]</span>&nbsp;<span class="op" id="6124842">&lt;&lt;</span>&nbsp;<span class="num" id="6124845">3</span><span class="op" id="6124846">)</span>&nbsp;<span class="op" id="6124848">&amp;</span>&nbsp;<span class="num" id="6124850">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6124858">b5</span>&nbsp;<span class="op" id="6124861">=</span>&nbsp;<span class="op" id="6124863">(</span><span class="ident" id="6124864">src</span><span class="op" id="6124867">[</span><span class="num" id="6124868">3</span><span class="op" id="6124869">]</span>&nbsp;<span class="op" id="6124871">&gt;&gt;</span>&nbsp;<span class="num" id="6124874">2</span><span class="op" id="6124875">)</span>&nbsp;<span class="op" id="6124877">&amp;</span>&nbsp;<span class="num" id="6124879">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6124887">b4</span>&nbsp;<span class="op" id="6124890">=</span>&nbsp;<span class="ident" id="6124892">src</span><span class="op" id="6124895">[</span><span class="num" id="6124896">3</span><span class="op" id="6124897">]</span>&nbsp;<span class="op" id="6124899">&gt;&gt;</span>&nbsp;<span class="num" id="6124902">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6124907">fallthrough</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6124921">case</span>&nbsp;<span class="num" id="6124926">3</span><span class="op" id="6124927">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6124932">b4</span>&nbsp;<span class="op" id="6124935">|=</span>&nbsp;<span class="op" id="6124938">(</span><span class="ident" id="6124939">src</span><span class="op" id="6124942">[</span><span class="num" id="6124943">2</span><span class="op" id="6124944">]</span>&nbsp;<span class="op" id="6124946">&lt;&lt;</span>&nbsp;<span class="num" id="6124949">1</span><span class="op" id="6124950">)</span>&nbsp;<span class="op" id="6124952">&amp;</span>&nbsp;<span class="num" id="6124954">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6124962">b3</span>&nbsp;<span class="op" id="6124965">=</span>&nbsp;<span class="op" id="6124967">(</span><span class="ident" id="6124968">src</span><span class="op" id="6124971">[</span><span class="num" id="6124972">2</span><span class="op" id="6124973">]</span>&nbsp;<span class="op" id="6124975">&gt;&gt;</span>&nbsp;<span class="num" id="6124978">4</span><span class="op" id="6124979">)</span>&nbsp;<span class="op" id="6124981">&amp;</span>&nbsp;<span class="num" id="6124983">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6124991">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6125005">case</span>&nbsp;<span class="num" id="6125010">2</span><span class="op" id="6125011">:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6125016">b3</span>&nbsp;<span class="op" id="6125019">|=</span>&nbsp;<span class="op" id="6125022">(</span><span class="ident" id="6125023">src</span><span class="op" id="6125026">[</span><span class="num" id="6125027">1</span><span class="op" id="6125028">]</span>&nbsp;<span class="op" id="6125030">&lt;&lt;</span>&nbsp;<span class="num" id="6125033">4</span><span class="op" id="6125034">)</span>&nbsp;<span class="op" id="6125036">&amp;</span>&nbsp;<span class="num" id="6125038">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6125046">b2</span>&nbsp;<span class="op" id="6125049">=</span>&nbsp;<span class="op" id="6125051">(</span><span class="ident" id="6125052">src</span><span class="op" id="6125055">[</span><span class="num" id="6125056">1</span><span class="op" id="6125057">]</span>&nbsp;<span class="op" id="6125059">&gt;&gt;</span>&nbsp;<span class="num" id="6125062">1</span><span class="op" id="6125063">)</span>&nbsp;<span class="op" id="6125065">&amp;</span>&nbsp;<span class="num" id="6125067">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6125075">b1</span>&nbsp;<span class="op" id="6125078">=</span>&nbsp;<span class="op" id="6125080">(</span><span class="ident" id="6125081">src</span><span class="op" id="6125084">[</span><span class="num" id="6125085">1</span><span class="op" id="6125086">]</span>&nbsp;<span class="op" id="6125088">&gt;&gt;</span>&nbsp;<span class="num" id="6125091">6</span><span class="op" id="6125092">)</span>&nbsp;<span class="op" id="6125094">&amp;</span>&nbsp;<span class="num" id="6125096">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6125104">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6125118">case</span>&nbsp;<span class="num" id="6125123">1</span><span class="op" id="6125124">:</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6125129">b1</span>&nbsp;<span class="op" id="6125132">|=</span>&nbsp;<span class="op" id="6125135">(</span><span class="ident" id="6125136">src</span><span class="op" id="6125139">[</span><span class="num" id="6125140">0</span><span class="op" id="6125141">]</span>&nbsp;<span class="op" id="6125143">&lt;&lt;</span>&nbsp;<span class="num" id="6125146">2</span><span class="op" id="6125147">)</span>&nbsp;<span class="op" id="6125149">&amp;</span>&nbsp;<span class="num" id="6125151">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6125159">b0</span>&nbsp;<span class="op" id="6125162">=</span>&nbsp;<span class="ident" id="6125164">src</span><span class="op" id="6125167">[</span><span class="num" id="6125168">0</span><span class="op" id="6125169">]</span>&nbsp;<span class="op" id="6125171">&gt;&gt;</span>&nbsp;<span class="num" id="6125174">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6125178">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6125183">//&nbsp;Encode&nbsp;5-bit&nbsp;blocks&nbsp;using&nbsp;the&nbsp;base32&nbsp;alphabet</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6125234">dst</span><span class="op" id="6125237">[</span><span class="num" id="6125238">0</span><span class="op" id="6125239">]</span>&nbsp;<span class="op" id="6125241">=</span>&nbsp;<span class="ident" id="6125243">enc</span><span class="op" id="6125246">.</span><span class="ident" id="6125247">encode</span><span class="op" id="6125253">[</span><span class="ident" id="6125254">b0</span><span class="op" id="6125256">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6125260">dst</span><span class="op" id="6125263">[</span><span class="num" id="6125264">1</span><span class="op" id="6125265">]</span>&nbsp;<span class="op" id="6125267">=</span>&nbsp;<span class="ident" id="6125269">enc</span><span class="op" id="6125272">.</span><span class="ident" id="6125273">encode</span><span class="op" id="6125279">[</span><span class="ident" id="6125280">b1</span><span class="op" id="6125282">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6125286">dst</span><span class="op" id="6125289">[</span><span class="num" id="6125290">2</span><span class="op" id="6125291">]</span>&nbsp;<span class="op" id="6125293">=</span>&nbsp;<span class="ident" id="6125295">enc</span><span class="op" id="6125298">.</span><span class="ident" id="6125299">encode</span><span class="op" id="6125305">[</span><span class="ident" id="6125306">b2</span><span class="op" id="6125308">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6125312">dst</span><span class="op" id="6125315">[</span><span class="num" id="6125316">3</span><span class="op" id="6125317">]</span>&nbsp;<span class="op" id="6125319">=</span>&nbsp;<span class="ident" id="6125321">enc</span><span class="op" id="6125324">.</span><span class="ident" id="6125325">encode</span><span class="op" id="6125331">[</span><span class="ident" id="6125332">b3</span><span class="op" id="6125334">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6125338">dst</span><span class="op" id="6125341">[</span><span class="num" id="6125342">4</span><span class="op" id="6125343">]</span>&nbsp;<span class="op" id="6125345">=</span>&nbsp;<span class="ident" id="6125347">enc</span><span class="op" id="6125350">.</span><span class="ident" id="6125351">encode</span><span class="op" id="6125357">[</span><span class="ident" id="6125358">b4</span><span class="op" id="6125360">]</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6125364">dst</span><span class="op" id="6125367">[</span><span class="num" id="6125368">5</span><span class="op" id="6125369">]</span>&nbsp;<span class="op" id="6125371">=</span>&nbsp;<span class="ident" id="6125373">enc</span><span class="op" id="6125376">.</span><span class="ident" id="6125377">encode</span><span class="op" id="6125383">[</span><span class="ident" id="6125384">b5</span><span class="op" id="6125386">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6125390">dst</span><span class="op" id="6125393">[</span><span class="num" id="6125394">6</span><span class="op" id="6125395">]</span>&nbsp;<span class="op" id="6125397">=</span>&nbsp;<span class="ident" id="6125399">enc</span><span class="op" id="6125402">.</span><span class="ident" id="6125403">encode</span><span class="op" id="6125409">[</span><span class="ident" id="6125410">b6</span><span class="op" id="6125412">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6125416">dst</span><span class="op" id="6125419">[</span><span class="num" id="6125420">7</span><span class="op" id="6125421">]</span>&nbsp;<span class="op" id="6125423">=</span>&nbsp;<span class="ident" id="6125425">enc</span><span class="op" id="6125428">.</span><span class="ident" id="6125429">encode</span><span class="op" id="6125435">[</span><span class="ident" id="6125436">b7</span><span class="op" id="6125438">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6125443">//&nbsp;Pad&nbsp;the&nbsp;final&nbsp;quantum</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6125470">if</span>&nbsp;<span class="builtinfunc" id="6125473">len</span><span class="op" id="6125476">(</span><span class="ident" id="6125477">src</span><span class="op" id="6125480">)</span>&nbsp;<span class="op" id="6125482">&lt;</span>&nbsp;<span class="num" id="6125484">5</span>&nbsp;<span class="op" id="6125486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6125491">dst</span><span class="op" id="6125494">[</span><span class="num" id="6125495">7</span><span class="op" id="6125496">]</span>&nbsp;<span class="op" id="6125498">=</span>&nbsp;<span class="string" id="6125500">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6125507">if</span>&nbsp;<span class="builtinfunc" id="6125510">len</span><span class="op" id="6125513">(</span><span class="ident" id="6125514">src</span><span class="op" id="6125517">)</span>&nbsp;<span class="op" id="6125519">&lt;</span>&nbsp;<span class="num" id="6125521">4</span>&nbsp;<span class="op" id="6125523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6125529">dst</span><span class="op" id="6125532">[</span><span class="num" id="6125533">6</span><span class="op" id="6125534">]</span>&nbsp;<span class="op" id="6125536">=</span>&nbsp;<span class="string" id="6125538">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6125546">dst</span><span class="op" id="6125549">[</span><span class="num" id="6125550">5</span><span class="op" id="6125551">]</span>&nbsp;<span class="op" id="6125553">=</span>&nbsp;<span class="string" id="6125555">&#39;=&#39;</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6125563">if</span>&nbsp;<span class="builtinfunc" id="6125566">len</span><span class="op" id="6125569">(</span><span class="ident" id="6125570">src</span><span class="op" id="6125573">)</span>&nbsp;<span class="op" id="6125575">&lt;</span>&nbsp;<span class="num" id="6125577">3</span>&nbsp;<span class="op" id="6125579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6125586">dst</span><span class="op" id="6125589">[</span><span class="num" id="6125590">4</span><span class="op" id="6125591">]</span>&nbsp;<span class="op" id="6125593">=</span>&nbsp;<span class="string" id="6125595">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6125604">if</span>&nbsp;<span class="builtinfunc" id="6125607">len</span><span class="op" id="6125610">(</span><span class="ident" id="6125611">src</span><span class="op" id="6125614">)</span>&nbsp;<span class="op" id="6125616">&lt;</span>&nbsp;<span class="num" id="6125618">2</span>&nbsp;<span class="op" id="6125620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6125628">dst</span><span class="op" id="6125631">[</span><span class="num" id="6125632">3</span><span class="op" id="6125633">]</span>&nbsp;<span class="op" id="6125635">=</span>&nbsp;<span class="string" id="6125637">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6125647">dst</span><span class="op" id="6125650">[</span><span class="num" id="6125651">2</span><span class="op" id="6125652">]</span>&nbsp;<span class="op" id="6125654">=</span>&nbsp;<span class="string" id="6125656">&#39;=&#39;</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6125665">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6125671">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6125676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6125681">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6125689">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6125693">src</span>&nbsp;<span class="op" id="6125697">=</span>&nbsp;<span class="ident" id="6125699">src</span><span class="op" id="6125702">[</span><span class="num" id="6125703">5</span><span class="op" id="6125704">:</span><span class="op" id="6125705">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6125709">dst</span>&nbsp;<span class="op" id="6125713">=</span>&nbsp;<span class="ident" id="6125715">dst</span><span class="op" id="6125718">[</span><span class="num" id="6125719">8</span><span class="op" id="6125720">:</span><span class="op" id="6125721">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6125724">}</span><br>
<span class="lineno"></span><span class="op" id="6125726">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="6125729">//&nbsp;EncodeToString&nbsp;returns&nbsp;the&nbsp;base32&nbsp;encoding&nbsp;of&nbsp;src.</span><br>
<span class="lineno"></span><span class="keyword" id="6125783">func</span>&nbsp;<span class="op" id="6125788">(</span><span class="ident" id="6125789">enc</span>&nbsp;<span class="op" id="6125793">*</span><span class="ident" id="6125794">Encoding</span><span class="op" id="6125802">)</span>&nbsp;<span class="ident" id="6125804">EncodeToString</span><span class="op" id="6125818">(</span><span class="ident" id="6125819">src</span>&nbsp;<span class="op" id="6125823">[</span><span class="op" id="6125824">]</span><span class="builtintype" id="6125825">byte</span><span class="op" id="6125829">)</span>&nbsp;<span class="builtintype" id="6125831">string</span>&nbsp;<span class="op" id="6125838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6125841">buf</span>&nbsp;<span class="op" id="6125845">:=</span>&nbsp;<span class="builtinfunc" id="6125848">make</span><span class="op" id="6125852">(</span><span class="op" id="6125853">[</span><span class="op" id="6125854">]</span><span class="builtintype" id="6125855">byte</span><span class="op" id="6125859">,</span>&nbsp;<span class="ident" id="6125861">enc</span><span class="op" id="6125864">.</span><span class="ident" id="6125865">EncodedLen</span><span class="op" id="6125875">(</span><span class="builtinfunc" id="6125876">len</span><span class="op" id="6125879">(</span><span class="ident" id="6125880">src</span><span class="op" id="6125883">)</span><span class="op" id="6125884">)</span><span class="op" id="6125885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6125888">enc</span><span class="op" id="6125891">.</span><span class="ident" id="6125892">Encode</span><span class="op" id="6125898">(</span><span class="ident" id="6125899">buf</span><span class="op" id="6125902">,</span>&nbsp;<span class="ident" id="6125904">src</span><span class="op" id="6125907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6125910">return</span>&nbsp;<span class="builtintype" id="6125917">string</span><span class="op" id="6125923">(</span><span class="ident" id="6125924">buf</span><span class="op" id="6125927">)</span><br>
<span class="lineno">140</span><span class="op" id="6125929">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6125932">type</span>&nbsp;<span class="ident" id="6125937">encoder</span>&nbsp;<span class="keyword" id="6125945">struct</span>&nbsp;<span class="op" id="6125952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6125955">err</span>&nbsp;&nbsp;<span class="builtintype" id="6125960">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6125967">enc</span>&nbsp;&nbsp;<span class="op" id="6125972">*</span><span class="ident" id="6125973">Encoding</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6125983">w</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6125988">io</span><span class="op" id="6125990">.</span><span class="ident" id="6125991">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6125999">buf</span>&nbsp;&nbsp;<span class="op" id="6126004">[</span><span class="num" id="6126005">5</span><span class="op" id="6126006">]</span><span class="builtintype" id="6126007">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6126015">//&nbsp;buffered&nbsp;data&nbsp;waiting&nbsp;to&nbsp;be&nbsp;encoded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6126055">nbuf</span>&nbsp;<span class="builtintype" id="6126060">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6126071">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;in&nbsp;buf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6126098">out</span>&nbsp;&nbsp;<span class="op" id="6126103">[</span><span class="num" id="6126104">1024</span><span class="op" id="6126108">]</span><span class="builtintype" id="6126109">byte</span>&nbsp;<span class="comment" id="6126114">//&nbsp;output&nbsp;buffer</span><br>
<span class="lineno"></span><span class="op" id="6126131">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="6126134">func</span>&nbsp;<span class="op" id="6126139">(</span><span class="ident" id="6126140">e</span>&nbsp;<span class="op" id="6126142">*</span><span class="ident" id="6126143">encoder</span><span class="op" id="6126150">)</span>&nbsp;<span class="ident" id="6126152">Write</span><span class="op" id="6126157">(</span><span class="ident" id="6126158">p</span>&nbsp;<span class="op" id="6126160">[</span><span class="op" id="6126161">]</span><span class="builtintype" id="6126162">byte</span><span class="op" id="6126166">)</span>&nbsp;<span class="op" id="6126168">(</span><span class="ident" id="6126169">n</span>&nbsp;<span class="builtintype" id="6126171">int</span><span class="op" id="6126174">,</span>&nbsp;<span class="ident" id="6126176">err</span>&nbsp;<span class="builtintype" id="6126180">error</span><span class="op" id="6126185">)</span>&nbsp;<span class="op" id="6126187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6126190">if</span>&nbsp;<span class="ident" id="6126193">e</span><span class="op" id="6126194">.</span><span class="ident" id="6126195">err</span>&nbsp;<span class="op" id="6126199">!=</span>&nbsp;<span class="ident" id="6126202">nil</span>&nbsp;<span class="op" id="6126206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6126210">return</span>&nbsp;<span class="num" id="6126217">0</span><span class="op" id="6126218">,</span>&nbsp;<span class="ident" id="6126220">e</span><span class="op" id="6126221">.</span><span class="ident" id="6126222">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6126227">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6126231">//&nbsp;Leading&nbsp;fringe.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6126251">if</span>&nbsp;<span class="ident" id="6126254">e</span><span class="op" id="6126255">.</span><span class="ident" id="6126256">nbuf</span>&nbsp;<span class="op" id="6126261">&gt;</span>&nbsp;<span class="num" id="6126263">0</span>&nbsp;<span class="op" id="6126265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6126269">var</span>&nbsp;<span class="ident" id="6126273">i</span>&nbsp;<span class="builtintype" id="6126275">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6126281">for</span>&nbsp;<span class="ident" id="6126285">i</span>&nbsp;<span class="op" id="6126287">=</span>&nbsp;<span class="num" id="6126289">0</span><span class="op" id="6126290">;</span>&nbsp;<span class="ident" id="6126292">i</span>&nbsp;<span class="op" id="6126294">&lt;</span>&nbsp;<span class="builtinfunc" id="6126296">len</span><span class="op" id="6126299">(</span><span class="ident" id="6126300">p</span><span class="op" id="6126301">)</span>&nbsp;<span class="op" id="6126303">&amp;&amp;</span>&nbsp;<span class="ident" id="6126306">e</span><span class="op" id="6126307">.</span><span class="ident" id="6126308">nbuf</span>&nbsp;<span class="op" id="6126313">&lt;</span>&nbsp;<span class="num" id="6126315">5</span><span class="op" id="6126316">;</span>&nbsp;<span class="ident" id="6126318">i</span><span class="op" id="6126319">++</span>&nbsp;<span class="op" id="6126322">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6126327">e</span><span class="op" id="6126328">.</span><span class="ident" id="6126329">buf</span><span class="op" id="6126332">[</span><span class="ident" id="6126333">e</span><span class="op" id="6126334">.</span><span class="ident" id="6126335">nbuf</span><span class="op" id="6126339">]</span>&nbsp;<span class="op" id="6126341">=</span>&nbsp;<span class="ident" id="6126343">p</span><span class="op" id="6126344">[</span><span class="ident" id="6126345">i</span><span class="op" id="6126346">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6126351">e</span><span class="op" id="6126352">.</span><span class="ident" id="6126353">nbuf</span><span class="op" id="6126357">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6126362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6126366">n</span>&nbsp;<span class="op" id="6126368">+=</span>&nbsp;<span class="ident" id="6126371">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6126375">p</span>&nbsp;<span class="op" id="6126377">=</span>&nbsp;<span class="ident" id="6126379">p</span><span class="op" id="6126380">[</span><span class="ident" id="6126381">i</span><span class="op" id="6126382">:</span><span class="op" id="6126383">]</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6126387">if</span>&nbsp;<span class="ident" id="6126390">e</span><span class="op" id="6126391">.</span><span class="ident" id="6126392">nbuf</span>&nbsp;<span class="op" id="6126397">&lt;</span>&nbsp;<span class="num" id="6126399">5</span>&nbsp;<span class="op" id="6126401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6126406">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6126415">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6126419">e</span><span class="op" id="6126420">.</span><span class="ident" id="6126421">enc</span><span class="op" id="6126424">.</span><span class="ident" id="6126425">Encode</span><span class="op" id="6126431">(</span><span class="ident" id="6126432">e</span><span class="op" id="6126433">.</span><span class="ident" id="6126434">out</span><span class="op" id="6126437">[</span><span class="num" id="6126438">0</span><span class="op" id="6126439">:</span><span class="op" id="6126440">]</span><span class="op" id="6126441">,</span>&nbsp;<span class="ident" id="6126443">e</span><span class="op" id="6126444">.</span><span class="ident" id="6126445">buf</span><span class="op" id="6126448">[</span><span class="num" id="6126449">0</span><span class="op" id="6126450">:</span><span class="op" id="6126451">]</span><span class="op" id="6126452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6126456">if</span>&nbsp;<span class="ident" id="6126459">_</span><span class="op" id="6126460">,</span>&nbsp;<span class="ident" id="6126462">e</span><span class="op" id="6126463">.</span><span class="ident" id="6126464">err</span>&nbsp;<span class="op" id="6126468">=</span>&nbsp;<span class="ident" id="6126470">e</span><span class="op" id="6126471">.</span><span class="ident" id="6126472">w</span><span class="op" id="6126473">.</span><span class="ident" id="6126474">Write</span><span class="op" id="6126479">(</span><span class="ident" id="6126480">e</span><span class="op" id="6126481">.</span><span class="ident" id="6126482">out</span><span class="op" id="6126485">[</span><span class="num" id="6126486">0</span><span class="op" id="6126487">:</span><span class="num" id="6126488">8</span><span class="op" id="6126489">]</span><span class="op" id="6126490">)</span><span class="op" id="6126491">;</span>&nbsp;<span class="ident" id="6126493">e</span><span class="op" id="6126494">.</span><span class="ident" id="6126495">err</span>&nbsp;<span class="op" id="6126499">!=</span>&nbsp;<span class="ident" id="6126502">nil</span>&nbsp;<span class="op" id="6126506">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6126511">return</span>&nbsp;<span class="ident" id="6126518">n</span><span class="op" id="6126519">,</span>&nbsp;<span class="ident" id="6126521">e</span><span class="op" id="6126522">.</span><span class="ident" id="6126523">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6126529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6126533">e</span><span class="op" id="6126534">.</span><span class="ident" id="6126535">nbuf</span>&nbsp;<span class="op" id="6126540">=</span>&nbsp;<span class="num" id="6126542">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6126545">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6126549">//&nbsp;Large&nbsp;interior&nbsp;chunks.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6126576">for</span>&nbsp;<span class="builtinfunc" id="6126580">len</span><span class="op" id="6126583">(</span><span class="ident" id="6126584">p</span><span class="op" id="6126585">)</span>&nbsp;<span class="op" id="6126587">&gt;=</span>&nbsp;<span class="num" id="6126590">5</span>&nbsp;<span class="op" id="6126592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6126596">nn</span>&nbsp;<span class="op" id="6126599">:=</span>&nbsp;<span class="builtinfunc" id="6126602">len</span><span class="op" id="6126605">(</span><span class="ident" id="6126606">e</span><span class="op" id="6126607">.</span><span class="ident" id="6126608">out</span><span class="op" id="6126611">)</span>&nbsp;<span class="op" id="6126613">/</span>&nbsp;<span class="num" id="6126615">8</span>&nbsp;<span class="op" id="6126617">*</span>&nbsp;<span class="num" id="6126619">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6126623">if</span>&nbsp;<span class="ident" id="6126626">nn</span>&nbsp;<span class="op" id="6126629">&gt;</span>&nbsp;<span class="builtinfunc" id="6126631">len</span><span class="op" id="6126634">(</span><span class="ident" id="6126635">p</span><span class="op" id="6126636">)</span>&nbsp;<span class="op" id="6126638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6126643">nn</span>&nbsp;<span class="op" id="6126646">=</span>&nbsp;<span class="builtinfunc" id="6126648">len</span><span class="op" id="6126651">(</span><span class="ident" id="6126652">p</span><span class="op" id="6126653">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6126658">nn</span>&nbsp;<span class="op" id="6126661">-=</span>&nbsp;<span class="ident" id="6126664">nn</span>&nbsp;<span class="op" id="6126667">%</span>&nbsp;<span class="num" id="6126669">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6126673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6126677">e</span><span class="op" id="6126678">.</span><span class="ident" id="6126679">enc</span><span class="op" id="6126682">.</span><span class="ident" id="6126683">Encode</span><span class="op" id="6126689">(</span><span class="ident" id="6126690">e</span><span class="op" id="6126691">.</span><span class="ident" id="6126692">out</span><span class="op" id="6126695">[</span><span class="num" id="6126696">0</span><span class="op" id="6126697">:</span><span class="op" id="6126698">]</span><span class="op" id="6126699">,</span>&nbsp;<span class="ident" id="6126701">p</span><span class="op" id="6126702">[</span><span class="num" id="6126703">0</span><span class="op" id="6126704">:</span><span class="ident" id="6126705">nn</span><span class="op" id="6126707">]</span><span class="op" id="6126708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6126712">if</span>&nbsp;<span class="ident" id="6126715">_</span><span class="op" id="6126716">,</span>&nbsp;<span class="ident" id="6126718">e</span><span class="op" id="6126719">.</span><span class="ident" id="6126720">err</span>&nbsp;<span class="op" id="6126724">=</span>&nbsp;<span class="ident" id="6126726">e</span><span class="op" id="6126727">.</span><span class="ident" id="6126728">w</span><span class="op" id="6126729">.</span><span class="ident" id="6126730">Write</span><span class="op" id="6126735">(</span><span class="ident" id="6126736">e</span><span class="op" id="6126737">.</span><span class="ident" id="6126738">out</span><span class="op" id="6126741">[</span><span class="num" id="6126742">0</span>&nbsp;<span class="op" id="6126744">:</span>&nbsp;<span class="ident" id="6126746">nn</span><span class="op" id="6126748">/</span><span class="num" id="6126749">5</span><span class="op" id="6126750">*</span><span class="num" id="6126751">8</span><span class="op" id="6126752">]</span><span class="op" id="6126753">)</span><span class="op" id="6126754">;</span>&nbsp;<span class="ident" id="6126756">e</span><span class="op" id="6126757">.</span><span class="ident" id="6126758">err</span>&nbsp;<span class="op" id="6126762">!=</span>&nbsp;<span class="ident" id="6126765">nil</span>&nbsp;<span class="op" id="6126769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6126774">return</span>&nbsp;<span class="ident" id="6126781">n</span><span class="op" id="6126782">,</span>&nbsp;<span class="ident" id="6126784">e</span><span class="op" id="6126785">.</span><span class="ident" id="6126786">err</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6126792">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6126796">n</span>&nbsp;<span class="op" id="6126798">+=</span>&nbsp;<span class="ident" id="6126801">nn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6126806">p</span>&nbsp;<span class="op" id="6126808">=</span>&nbsp;<span class="ident" id="6126810">p</span><span class="op" id="6126811">[</span><span class="ident" id="6126812">nn</span><span class="op" id="6126814">:</span><span class="op" id="6126815">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6126818">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6126822">//&nbsp;Trailing&nbsp;fringe.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6126843">for</span>&nbsp;<span class="ident" id="6126847">i</span>&nbsp;<span class="op" id="6126849">:=</span>&nbsp;<span class="num" id="6126852">0</span><span class="op" id="6126853">;</span>&nbsp;<span class="ident" id="6126855">i</span>&nbsp;<span class="op" id="6126857">&lt;</span>&nbsp;<span class="builtinfunc" id="6126859">len</span><span class="op" id="6126862">(</span><span class="ident" id="6126863">p</span><span class="op" id="6126864">)</span><span class="op" id="6126865">;</span>&nbsp;<span class="ident" id="6126867">i</span><span class="op" id="6126868">++</span>&nbsp;<span class="op" id="6126871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6126875">e</span><span class="op" id="6126876">.</span><span class="ident" id="6126877">buf</span><span class="op" id="6126880">[</span><span class="ident" id="6126881">i</span><span class="op" id="6126882">]</span>&nbsp;<span class="op" id="6126884">=</span>&nbsp;<span class="ident" id="6126886">p</span><span class="op" id="6126887">[</span><span class="ident" id="6126888">i</span><span class="op" id="6126889">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6126892">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6126895">e</span><span class="op" id="6126896">.</span><span class="ident" id="6126897">nbuf</span>&nbsp;<span class="op" id="6126902">=</span>&nbsp;<span class="builtinfunc" id="6126904">len</span><span class="op" id="6126907">(</span><span class="ident" id="6126908">p</span><span class="op" id="6126909">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6126912">n</span>&nbsp;<span class="op" id="6126914">+=</span>&nbsp;<span class="builtinfunc" id="6126917">len</span><span class="op" id="6126920">(</span><span class="ident" id="6126921">p</span><span class="op" id="6126922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6126925">return</span><br>
<span class="lineno"></span><span class="op" id="6126932">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6126935">//&nbsp;Close&nbsp;flushes&nbsp;any&nbsp;pending&nbsp;output&nbsp;from&nbsp;the&nbsp;encoder.</span><br>
<span class="lineno">200</span><span class="comment" id="6126989">//&nbsp;It&nbsp;is&nbsp;an&nbsp;error&nbsp;to&nbsp;call&nbsp;Write&nbsp;after&nbsp;calling&nbsp;Close.</span><br>
<span class="lineno"></span><span class="keyword" id="6127042">func</span>&nbsp;<span class="op" id="6127047">(</span><span class="ident" id="6127048">e</span>&nbsp;<span class="op" id="6127050">*</span><span class="ident" id="6127051">encoder</span><span class="op" id="6127058">)</span>&nbsp;<span class="ident" id="6127060">Close</span><span class="op" id="6127065">(</span><span class="op" id="6127066">)</span>&nbsp;<span class="builtintype" id="6127068">error</span>&nbsp;<span class="op" id="6127074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6127077">//&nbsp;If&nbsp;there&#39;s&nbsp;anything&nbsp;left&nbsp;in&nbsp;the&nbsp;buffer,&nbsp;flush&nbsp;it&nbsp;out</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6127134">if</span>&nbsp;<span class="ident" id="6127137">e</span><span class="op" id="6127138">.</span><span class="ident" id="6127139">err</span>&nbsp;<span class="op" id="6127143">==</span>&nbsp;<span class="ident" id="6127146">nil</span>&nbsp;<span class="op" id="6127150">&amp;&amp;</span>&nbsp;<span class="ident" id="6127153">e</span><span class="op" id="6127154">.</span><span class="ident" id="6127155">nbuf</span>&nbsp;<span class="op" id="6127160">&gt;</span>&nbsp;<span class="num" id="6127162">0</span>&nbsp;<span class="op" id="6127164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6127168">e</span><span class="op" id="6127169">.</span><span class="ident" id="6127170">enc</span><span class="op" id="6127173">.</span><span class="ident" id="6127174">Encode</span><span class="op" id="6127180">(</span><span class="ident" id="6127181">e</span><span class="op" id="6127182">.</span><span class="ident" id="6127183">out</span><span class="op" id="6127186">[</span><span class="num" id="6127187">0</span><span class="op" id="6127188">:</span><span class="op" id="6127189">]</span><span class="op" id="6127190">,</span>&nbsp;<span class="ident" id="6127192">e</span><span class="op" id="6127193">.</span><span class="ident" id="6127194">buf</span><span class="op" id="6127197">[</span><span class="num" id="6127198">0</span><span class="op" id="6127199">:</span><span class="ident" id="6127200">e</span><span class="op" id="6127201">.</span><span class="ident" id="6127202">nbuf</span><span class="op" id="6127206">]</span><span class="op" id="6127207">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6127211">e</span><span class="op" id="6127212">.</span><span class="ident" id="6127213">nbuf</span>&nbsp;<span class="op" id="6127218">=</span>&nbsp;<span class="num" id="6127220">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6127224">_</span><span class="op" id="6127225">,</span>&nbsp;<span class="ident" id="6127227">e</span><span class="op" id="6127228">.</span><span class="ident" id="6127229">err</span>&nbsp;<span class="op" id="6127233">=</span>&nbsp;<span class="ident" id="6127235">e</span><span class="op" id="6127236">.</span><span class="ident" id="6127237">w</span><span class="op" id="6127238">.</span><span class="ident" id="6127239">Write</span><span class="op" id="6127244">(</span><span class="ident" id="6127245">e</span><span class="op" id="6127246">.</span><span class="ident" id="6127247">out</span><span class="op" id="6127250">[</span><span class="num" id="6127251">0</span><span class="op" id="6127252">:</span><span class="num" id="6127253">8</span><span class="op" id="6127254">]</span><span class="op" id="6127255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6127258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6127261">return</span>&nbsp;<span class="ident" id="6127268">e</span><span class="op" id="6127269">.</span><span class="ident" id="6127270">err</span><br>
<span class="lineno"></span><span class="op" id="6127274">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="comment" id="6127277">//&nbsp;NewEncoder&nbsp;returns&nbsp;a&nbsp;new&nbsp;base32&nbsp;stream&nbsp;encoder.&nbsp;&nbsp;Data&nbsp;written&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="6127345">//&nbsp;the&nbsp;returned&nbsp;writer&nbsp;will&nbsp;be&nbsp;encoded&nbsp;using&nbsp;enc&nbsp;and&nbsp;then&nbsp;written&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="comment" id="6127417">//&nbsp;Base32&nbsp;encodings&nbsp;operate&nbsp;in&nbsp;5-byte&nbsp;blocks;&nbsp;when&nbsp;finished</span><br>
<span class="lineno"></span><span class="comment" id="6127477">//&nbsp;writing,&nbsp;the&nbsp;caller&nbsp;must&nbsp;Close&nbsp;the&nbsp;returned&nbsp;encoder&nbsp;to&nbsp;flush&nbsp;any</span><br>
<span class="lineno">215</span><span class="comment" id="6127545">//&nbsp;partially&nbsp;written&nbsp;blocks.</span><br>
<span class="lineno"></span><span class="keyword" id="6127574">func</span>&nbsp;<span class="ident" id="6127579">NewEncoder</span><span class="op" id="6127589">(</span><span class="ident" id="6127590">enc</span>&nbsp;<span class="op" id="6127594">*</span><span class="ident" id="6127595">Encoding</span><span class="op" id="6127603">,</span>&nbsp;<span class="ident" id="6127605">w</span>&nbsp;<span class="ident" id="6127607">io</span><span class="op" id="6127609">.</span><span class="ident" id="6127610">Writer</span><span class="op" id="6127616">)</span>&nbsp;<span class="ident" id="6127618">io</span><span class="op" id="6127620">.</span><span class="ident" id="6127621">WriteCloser</span>&nbsp;<span class="op" id="6127633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6127636">return</span>&nbsp;<span class="op" id="6127643">&amp;</span><span class="ident" id="6127644">encoder</span><span class="op" id="6127651">{</span><span class="ident" id="6127652">enc</span><span class="op" id="6127655">:</span>&nbsp;<span class="ident" id="6127657">enc</span><span class="op" id="6127660">,</span>&nbsp;<span class="ident" id="6127662">w</span><span class="op" id="6127663">:</span>&nbsp;<span class="ident" id="6127665">w</span><span class="op" id="6127666">}</span><br>
<span class="lineno"></span><span class="op" id="6127668">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="6127671">//&nbsp;EncodedLen&nbsp;returns&nbsp;the&nbsp;length&nbsp;in&nbsp;bytes&nbsp;of&nbsp;the&nbsp;base32&nbsp;encoding</span><br>
<span class="lineno"></span><span class="comment" id="6127736">//&nbsp;of&nbsp;an&nbsp;input&nbsp;buffer&nbsp;of&nbsp;length&nbsp;n.</span><br>
<span class="lineno"></span><span class="keyword" id="6127771">func</span>&nbsp;<span class="op" id="6127776">(</span><span class="ident" id="6127777">enc</span>&nbsp;<span class="op" id="6127781">*</span><span class="ident" id="6127782">Encoding</span><span class="op" id="6127790">)</span>&nbsp;<span class="ident" id="6127792">EncodedLen</span><span class="op" id="6127802">(</span><span class="ident" id="6127803">n</span>&nbsp;<span class="builtintype" id="6127805">int</span><span class="op" id="6127808">)</span>&nbsp;<span class="builtintype" id="6127810">int</span>&nbsp;<span class="op" id="6127814">{</span>&nbsp;<span class="keyword" id="6127816">return</span>&nbsp;<span class="op" id="6127823">(</span><span class="ident" id="6127824">n</span>&nbsp;<span class="op" id="6127826">+</span>&nbsp;<span class="num" id="6127828">4</span><span class="op" id="6127829">)</span>&nbsp;<span class="op" id="6127831">/</span>&nbsp;<span class="num" id="6127833">5</span>&nbsp;<span class="op" id="6127835">*</span>&nbsp;<span class="num" id="6127837">8</span>&nbsp;<span class="op" id="6127839">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6127842">/*<br>
<span class="lineno">225</span>&nbsp;*&nbsp;Decoder<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6127861">type</span>&nbsp;<span class="ident" id="6127866">CorruptInputError</span>&nbsp;<span class="ident" id="6127884">int64</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span><span class="keyword" id="6127891">func</span>&nbsp;<span class="op" id="6127896">(</span><span class="ident" id="6127897">e</span>&nbsp;<span class="ident" id="6127899">CorruptInputError</span><span class="op" id="6127916">)</span>&nbsp;<span class="ident" id="6127918">Error</span><span class="op" id="6127923">(</span><span class="op" id="6127924">)</span>&nbsp;<span class="builtintype" id="6127926">string</span>&nbsp;<span class="op" id="6127933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6127936">return</span>&nbsp;<span class="string" id="6127943">&#34;illegal&nbsp;base32&nbsp;data&nbsp;at&nbsp;input&nbsp;byte&nbsp;&#34;</span>&nbsp;<span class="op" id="6127980">+</span>&nbsp;<span class="ident" id="6127982">strconv</span><span class="op" id="6127989">.</span><span class="ident" id="6127990">FormatInt</span><span class="op" id="6127999">(</span><span class="ident" id="6128000">int64</span><span class="op" id="6128005">(</span><span class="ident" id="6128006">e</span><span class="op" id="6128007">)</span><span class="op" id="6128008">,</span>&nbsp;<span class="num" id="6128010">10</span><span class="op" id="6128012">)</span><br>
<span class="lineno"></span><span class="op" id="6128014">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6128017">//&nbsp;decode&nbsp;is&nbsp;like&nbsp;Decode&nbsp;but&nbsp;returns&nbsp;an&nbsp;additional&nbsp;&#39;end&#39;&nbsp;value,&nbsp;which</span><br>
<span class="lineno">235</span><span class="comment" id="6128087">//&nbsp;indicates&nbsp;if&nbsp;end-of-message&nbsp;padding&nbsp;was&nbsp;encountered&nbsp;and&nbsp;thus&nbsp;any</span><br>
<span class="lineno"></span><span class="comment" id="6128155">//&nbsp;additional&nbsp;data&nbsp;is&nbsp;an&nbsp;error.&nbsp;This&nbsp;method&nbsp;assumes&nbsp;that&nbsp;src&nbsp;has&nbsp;been</span><br>
<span class="lineno"></span><span class="comment" id="6128225">//&nbsp;stripped&nbsp;of&nbsp;all&nbsp;supported&nbsp;whitespace&nbsp;(&#39;\r&#39;&nbsp;and&nbsp;&#39;\n&#39;).</span><br>
<span class="lineno"></span><span class="keyword" id="6128282">func</span>&nbsp;<span class="op" id="6128287">(</span><span class="ident" id="6128288">enc</span>&nbsp;<span class="op" id="6128292">*</span><span class="ident" id="6128293">Encoding</span><span class="op" id="6128301">)</span>&nbsp;<span class="ident" id="6128303">decode</span><span class="op" id="6128309">(</span><span class="ident" id="6128310">dst</span><span class="op" id="6128313">,</span>&nbsp;<span class="ident" id="6128315">src</span>&nbsp;<span class="op" id="6128319">[</span><span class="op" id="6128320">]</span><span class="builtintype" id="6128321">byte</span><span class="op" id="6128325">)</span>&nbsp;<span class="op" id="6128327">(</span><span class="ident" id="6128328">n</span>&nbsp;<span class="builtintype" id="6128330">int</span><span class="op" id="6128333">,</span>&nbsp;<span class="ident" id="6128335">end</span>&nbsp;<span class="builtintype" id="6128339">bool</span><span class="op" id="6128343">,</span>&nbsp;<span class="ident" id="6128345">err</span>&nbsp;<span class="builtintype" id="6128349">error</span><span class="op" id="6128354">)</span>&nbsp;<span class="op" id="6128356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6128359">olen</span>&nbsp;<span class="op" id="6128364">:=</span>&nbsp;<span class="builtinfunc" id="6128367">len</span><span class="op" id="6128370">(</span><span class="ident" id="6128371">src</span><span class="op" id="6128374">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6128377">for</span>&nbsp;<span class="builtinfunc" id="6128381">len</span><span class="op" id="6128384">(</span><span class="ident" id="6128385">src</span><span class="op" id="6128388">)</span>&nbsp;<span class="op" id="6128390">&gt;</span>&nbsp;<span class="num" id="6128392">0</span>&nbsp;<span class="op" id="6128394">&amp;&amp;</span>&nbsp;<span class="op" id="6128397">!</span><span class="ident" id="6128398">end</span>&nbsp;<span class="op" id="6128402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6128406">//&nbsp;Decode&nbsp;quantum&nbsp;using&nbsp;the&nbsp;base32&nbsp;alphabet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6128452">var</span>&nbsp;<span class="ident" id="6128456">dbuf</span>&nbsp;<span class="op" id="6128461">[</span><span class="num" id="6128462">8</span><span class="op" id="6128463">]</span><span class="builtintype" id="6128464">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6128471">dlen</span>&nbsp;<span class="op" id="6128476">:=</span>&nbsp;<span class="num" id="6128479">8</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6128484">for</span>&nbsp;<span class="ident" id="6128488">j</span>&nbsp;<span class="op" id="6128490">:=</span>&nbsp;<span class="num" id="6128493">0</span><span class="op" id="6128494">;</span>&nbsp;<span class="ident" id="6128496">j</span>&nbsp;<span class="op" id="6128498">&lt;</span>&nbsp;<span class="num" id="6128500">8</span><span class="op" id="6128501">;</span>&nbsp;<span class="op" id="6128503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6128508">if</span>&nbsp;<span class="builtinfunc" id="6128511">len</span><span class="op" id="6128514">(</span><span class="ident" id="6128515">src</span><span class="op" id="6128518">)</span>&nbsp;<span class="op" id="6128520">==</span>&nbsp;<span class="num" id="6128523">0</span>&nbsp;<span class="op" id="6128525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6128531">return</span>&nbsp;<span class="ident" id="6128538">n</span><span class="op" id="6128539">,</span>&nbsp;<span class="builtintype" id="6128541">false</span><span class="op" id="6128546">,</span>&nbsp;<span class="ident" id="6128548">CorruptInputError</span><span class="op" id="6128565">(</span><span class="ident" id="6128566">olen</span>&nbsp;<span class="op" id="6128571">-</span>&nbsp;<span class="builtinfunc" id="6128573">len</span><span class="op" id="6128576">(</span><span class="ident" id="6128577">src</span><span class="op" id="6128580">)</span>&nbsp;<span class="op" id="6128582">-</span>&nbsp;<span class="ident" id="6128584">j</span><span class="op" id="6128585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6128590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6128595">in</span>&nbsp;<span class="op" id="6128598">:=</span>&nbsp;<span class="ident" id="6128601">src</span><span class="op" id="6128604">[</span><span class="num" id="6128605">0</span><span class="op" id="6128606">]</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6128611">src</span>&nbsp;<span class="op" id="6128615">=</span>&nbsp;<span class="ident" id="6128617">src</span><span class="op" id="6128620">[</span><span class="num" id="6128621">1</span><span class="op" id="6128622">:</span><span class="op" id="6128623">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6128628">if</span>&nbsp;<span class="ident" id="6128631">in</span>&nbsp;<span class="op" id="6128634">==</span>&nbsp;<span class="string" id="6128637">&#39;=&#39;</span>&nbsp;<span class="op" id="6128641">&amp;&amp;</span>&nbsp;<span class="ident" id="6128644">j</span>&nbsp;<span class="op" id="6128646">&gt;=</span>&nbsp;<span class="num" id="6128649">2</span>&nbsp;<span class="op" id="6128651">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="6128654">len</span><span class="op" id="6128657">(</span><span class="ident" id="6128658">src</span><span class="op" id="6128661">)</span>&nbsp;<span class="op" id="6128663">&lt;</span>&nbsp;<span class="num" id="6128665">8</span>&nbsp;<span class="op" id="6128667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6128673">//&nbsp;We&#39;ve&nbsp;reached&nbsp;the&nbsp;end&nbsp;and&nbsp;there&#39;s&nbsp;padding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6128722">if</span>&nbsp;<span class="builtinfunc" id="6128725">len</span><span class="op" id="6128728">(</span><span class="ident" id="6128729">src</span><span class="op" id="6128732">)</span><span class="op" id="6128733">+</span><span class="ident" id="6128734">j</span>&nbsp;<span class="op" id="6128736">&lt;</span>&nbsp;<span class="num" id="6128738">8</span><span class="op" id="6128739">-</span><span class="num" id="6128740">1</span>&nbsp;<span class="op" id="6128742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6128749">//&nbsp;not&nbsp;enough&nbsp;padding</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6128776">return</span>&nbsp;<span class="ident" id="6128783">n</span><span class="op" id="6128784">,</span>&nbsp;<span class="builtintype" id="6128786">false</span><span class="op" id="6128791">,</span>&nbsp;<span class="ident" id="6128793">CorruptInputError</span><span class="op" id="6128810">(</span><span class="ident" id="6128811">olen</span><span class="op" id="6128815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6128821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6128827">for</span>&nbsp;<span class="ident" id="6128831">k</span>&nbsp;<span class="op" id="6128833">:=</span>&nbsp;<span class="num" id="6128836">0</span><span class="op" id="6128837">;</span>&nbsp;<span class="ident" id="6128839">k</span>&nbsp;<span class="op" id="6128841">&lt;</span>&nbsp;<span class="num" id="6128843">8</span><span class="op" id="6128844">-</span><span class="num" id="6128845">1</span><span class="op" id="6128846">-</span><span class="ident" id="6128847">j</span><span class="op" id="6128848">;</span>&nbsp;<span class="ident" id="6128850">k</span><span class="op" id="6128851">++</span>&nbsp;<span class="op" id="6128854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6128861">if</span>&nbsp;<span class="builtinfunc" id="6128864">len</span><span class="op" id="6128867">(</span><span class="ident" id="6128868">src</span><span class="op" id="6128871">)</span>&nbsp;<span class="op" id="6128873">&gt;</span>&nbsp;<span class="ident" id="6128875">k</span>&nbsp;<span class="op" id="6128877">&amp;&amp;</span>&nbsp;<span class="ident" id="6128880">src</span><span class="op" id="6128883">[</span><span class="ident" id="6128884">k</span><span class="op" id="6128885">]</span>&nbsp;<span class="op" id="6128887">!=</span>&nbsp;<span class="string" id="6128890">&#39;=&#39;</span>&nbsp;<span class="op" id="6128894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6128902">//&nbsp;incorrect&nbsp;padding</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6128929">return</span>&nbsp;<span class="ident" id="6128936">n</span><span class="op" id="6128937">,</span>&nbsp;<span class="builtintype" id="6128939">false</span><span class="op" id="6128944">,</span>&nbsp;<span class="ident" id="6128946">CorruptInputError</span><span class="op" id="6128963">(</span><span class="ident" id="6128964">olen</span>&nbsp;<span class="op" id="6128969">-</span>&nbsp;<span class="builtinfunc" id="6128971">len</span><span class="op" id="6128974">(</span><span class="ident" id="6128975">src</span><span class="op" id="6128978">)</span>&nbsp;<span class="op" id="6128980">+</span>&nbsp;<span class="ident" id="6128982">k</span>&nbsp;<span class="op" id="6128984">-</span>&nbsp;<span class="num" id="6128986">1</span><span class="op" id="6128987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6128994">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6129000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6129006">dlen</span><span class="op" id="6129010">,</span>&nbsp;<span class="ident" id="6129012">end</span>&nbsp;<span class="op" id="6129016">=</span>&nbsp;<span class="ident" id="6129018">j</span><span class="op" id="6129019">,</span>&nbsp;<span class="builtintype" id="6129021">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6129030">//&nbsp;7,&nbsp;5&nbsp;and&nbsp;2&nbsp;are&nbsp;not&nbsp;valid&nbsp;padding&nbsp;lengths,&nbsp;and&nbsp;so&nbsp;1,&nbsp;3&nbsp;and&nbsp;6&nbsp;are&nbsp;not</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6129105">//&nbsp;valid&nbsp;dlen&nbsp;values.&nbsp;See&nbsp;RFC&nbsp;4648&nbsp;Section&nbsp;6&nbsp;&#34;Base&nbsp;32&nbsp;Encoding&#34;&nbsp;listing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6129181">//&nbsp;the&nbsp;five&nbsp;valid&nbsp;padding&nbsp;lengths,&nbsp;and&nbsp;Section&nbsp;9&nbsp;&#34;Illustrations&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6129253">//&nbsp;Examples&#34;&nbsp;for&nbsp;an&nbsp;illustration&nbsp;for&nbsp;how&nbsp;the&nbsp;1st,&nbsp;3rd&nbsp;and&nbsp;6th&nbsp;base32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6129326">//&nbsp;src&nbsp;bytes&nbsp;do&nbsp;not&nbsp;yield&nbsp;enough&nbsp;information&nbsp;to&nbsp;decode&nbsp;a&nbsp;dst&nbsp;byte.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6129397">if</span>&nbsp;<span class="ident" id="6129400">dlen</span>&nbsp;<span class="op" id="6129405">==</span>&nbsp;<span class="num" id="6129408">1</span>&nbsp;<span class="op" id="6129410">||</span>&nbsp;<span class="ident" id="6129413">dlen</span>&nbsp;<span class="op" id="6129418">==</span>&nbsp;<span class="num" id="6129421">3</span>&nbsp;<span class="op" id="6129423">||</span>&nbsp;<span class="ident" id="6129426">dlen</span>&nbsp;<span class="op" id="6129431">==</span>&nbsp;<span class="num" id="6129434">6</span>&nbsp;<span class="op" id="6129436">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6129443">return</span>&nbsp;<span class="ident" id="6129450">n</span><span class="op" id="6129451">,</span>&nbsp;<span class="builtintype" id="6129453">false</span><span class="op" id="6129458">,</span>&nbsp;<span class="ident" id="6129460">CorruptInputError</span><span class="op" id="6129477">(</span><span class="ident" id="6129478">olen</span>&nbsp;<span class="op" id="6129483">-</span>&nbsp;<span class="builtinfunc" id="6129485">len</span><span class="op" id="6129488">(</span><span class="ident" id="6129489">src</span><span class="op" id="6129492">)</span>&nbsp;<span class="op" id="6129494">-</span>&nbsp;<span class="num" id="6129496">1</span><span class="op" id="6129497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6129503">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6129509">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6129518">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6129523">dbuf</span><span class="op" id="6129527">[</span><span class="ident" id="6129528">j</span><span class="op" id="6129529">]</span>&nbsp;<span class="op" id="6129531">=</span>&nbsp;<span class="ident" id="6129533">enc</span><span class="op" id="6129536">.</span><span class="ident" id="6129537">decodeMap</span><span class="op" id="6129546">[</span><span class="ident" id="6129547">in</span><span class="op" id="6129549">]</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6129554">if</span>&nbsp;<span class="ident" id="6129557">dbuf</span><span class="op" id="6129561">[</span><span class="ident" id="6129562">j</span><span class="op" id="6129563">]</span>&nbsp;<span class="op" id="6129565">==</span>&nbsp;<span class="num" id="6129568">0xFF</span>&nbsp;<span class="op" id="6129573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6129579">return</span>&nbsp;<span class="ident" id="6129586">n</span><span class="op" id="6129587">,</span>&nbsp;<span class="builtintype" id="6129589">false</span><span class="op" id="6129594">,</span>&nbsp;<span class="ident" id="6129596">CorruptInputError</span><span class="op" id="6129613">(</span><span class="ident" id="6129614">olen</span>&nbsp;<span class="op" id="6129619">-</span>&nbsp;<span class="builtinfunc" id="6129621">len</span><span class="op" id="6129624">(</span><span class="ident" id="6129625">src</span><span class="op" id="6129628">)</span>&nbsp;<span class="op" id="6129630">-</span>&nbsp;<span class="num" id="6129632">1</span><span class="op" id="6129633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6129638">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6129643">j</span><span class="op" id="6129644">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6129649">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6129654">//&nbsp;Pack&nbsp;8x&nbsp;5-bit&nbsp;source&nbsp;blocks&nbsp;into&nbsp;5&nbsp;byte&nbsp;destination</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6129711">//&nbsp;quantum</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6129724">switch</span>&nbsp;<span class="ident" id="6129731">dlen</span>&nbsp;<span class="op" id="6129736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6129740">case</span>&nbsp;<span class="num" id="6129745">8</span><span class="op" id="6129746">:</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6129751">dst</span><span class="op" id="6129754">[</span><span class="num" id="6129755">4</span><span class="op" id="6129756">]</span>&nbsp;<span class="op" id="6129758">=</span>&nbsp;<span class="ident" id="6129760">dbuf</span><span class="op" id="6129764">[</span><span class="num" id="6129765">6</span><span class="op" id="6129766">]</span><span class="op" id="6129767">&lt;&lt;</span><span class="num" id="6129769">5</span>&nbsp;<span class="op" id="6129771">|</span>&nbsp;<span class="ident" id="6129773">dbuf</span><span class="op" id="6129777">[</span><span class="num" id="6129778">7</span><span class="op" id="6129779">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6129784">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6129798">case</span>&nbsp;<span class="num" id="6129803">7</span><span class="op" id="6129804">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6129809">dst</span><span class="op" id="6129812">[</span><span class="num" id="6129813">3</span><span class="op" id="6129814">]</span>&nbsp;<span class="op" id="6129816">=</span>&nbsp;<span class="ident" id="6129818">dbuf</span><span class="op" id="6129822">[</span><span class="num" id="6129823">4</span><span class="op" id="6129824">]</span><span class="op" id="6129825">&lt;&lt;</span><span class="num" id="6129827">7</span>&nbsp;<span class="op" id="6129829">|</span>&nbsp;<span class="ident" id="6129831">dbuf</span><span class="op" id="6129835">[</span><span class="num" id="6129836">5</span><span class="op" id="6129837">]</span><span class="op" id="6129838">&lt;&lt;</span><span class="num" id="6129840">2</span>&nbsp;<span class="op" id="6129842">|</span>&nbsp;<span class="ident" id="6129844">dbuf</span><span class="op" id="6129848">[</span><span class="num" id="6129849">6</span><span class="op" id="6129850">]</span><span class="op" id="6129851">&gt;&gt;</span><span class="num" id="6129853">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6129858">fallthrough</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6129872">case</span>&nbsp;<span class="num" id="6129877">5</span><span class="op" id="6129878">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6129883">dst</span><span class="op" id="6129886">[</span><span class="num" id="6129887">2</span><span class="op" id="6129888">]</span>&nbsp;<span class="op" id="6129890">=</span>&nbsp;<span class="ident" id="6129892">dbuf</span><span class="op" id="6129896">[</span><span class="num" id="6129897">3</span><span class="op" id="6129898">]</span><span class="op" id="6129899">&lt;&lt;</span><span class="num" id="6129901">4</span>&nbsp;<span class="op" id="6129903">|</span>&nbsp;<span class="ident" id="6129905">dbuf</span><span class="op" id="6129909">[</span><span class="num" id="6129910">4</span><span class="op" id="6129911">]</span><span class="op" id="6129912">&gt;&gt;</span><span class="num" id="6129914">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6129919">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6129933">case</span>&nbsp;<span class="num" id="6129938">4</span><span class="op" id="6129939">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6129944">dst</span><span class="op" id="6129947">[</span><span class="num" id="6129948">1</span><span class="op" id="6129949">]</span>&nbsp;<span class="op" id="6129951">=</span>&nbsp;<span class="ident" id="6129953">dbuf</span><span class="op" id="6129957">[</span><span class="num" id="6129958">1</span><span class="op" id="6129959">]</span><span class="op" id="6129960">&lt;&lt;</span><span class="num" id="6129962">6</span>&nbsp;<span class="op" id="6129964">|</span>&nbsp;<span class="ident" id="6129966">dbuf</span><span class="op" id="6129970">[</span><span class="num" id="6129971">2</span><span class="op" id="6129972">]</span><span class="op" id="6129973">&lt;&lt;</span><span class="num" id="6129975">1</span>&nbsp;<span class="op" id="6129977">|</span>&nbsp;<span class="ident" id="6129979">dbuf</span><span class="op" id="6129983">[</span><span class="num" id="6129984">3</span><span class="op" id="6129985">]</span><span class="op" id="6129986">&gt;&gt;</span><span class="num" id="6129988">4</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6129993">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6130007">case</span>&nbsp;<span class="num" id="6130012">2</span><span class="op" id="6130013">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6130018">dst</span><span class="op" id="6130021">[</span><span class="num" id="6130022">0</span><span class="op" id="6130023">]</span>&nbsp;<span class="op" id="6130025">=</span>&nbsp;<span class="ident" id="6130027">dbuf</span><span class="op" id="6130031">[</span><span class="num" id="6130032">0</span><span class="op" id="6130033">]</span><span class="op" id="6130034">&lt;&lt;</span><span class="num" id="6130036">3</span>&nbsp;<span class="op" id="6130038">|</span>&nbsp;<span class="ident" id="6130040">dbuf</span><span class="op" id="6130044">[</span><span class="num" id="6130045">1</span><span class="op" id="6130046">]</span><span class="op" id="6130047">&gt;&gt;</span><span class="num" id="6130049">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6130053">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6130057">dst</span>&nbsp;<span class="op" id="6130061">=</span>&nbsp;<span class="ident" id="6130063">dst</span><span class="op" id="6130066">[</span><span class="num" id="6130067">5</span><span class="op" id="6130068">:</span><span class="op" id="6130069">]</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6130073">switch</span>&nbsp;<span class="ident" id="6130080">dlen</span>&nbsp;<span class="op" id="6130085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6130089">case</span>&nbsp;<span class="num" id="6130094">2</span><span class="op" id="6130095">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6130100">n</span>&nbsp;<span class="op" id="6130102">+=</span>&nbsp;<span class="num" id="6130105">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6130109">case</span>&nbsp;<span class="num" id="6130114">4</span><span class="op" id="6130115">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6130120">n</span>&nbsp;<span class="op" id="6130122">+=</span>&nbsp;<span class="num" id="6130125">2</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6130129">case</span>&nbsp;<span class="num" id="6130134">5</span><span class="op" id="6130135">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6130140">n</span>&nbsp;<span class="op" id="6130142">+=</span>&nbsp;<span class="num" id="6130145">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6130149">case</span>&nbsp;<span class="num" id="6130154">7</span><span class="op" id="6130155">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6130160">n</span>&nbsp;<span class="op" id="6130162">+=</span>&nbsp;<span class="num" id="6130165">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6130169">case</span>&nbsp;<span class="num" id="6130174">8</span><span class="op" id="6130175">:</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6130180">n</span>&nbsp;<span class="op" id="6130182">+=</span>&nbsp;<span class="num" id="6130185">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6130189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6130192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6130195">return</span>&nbsp;<span class="ident" id="6130202">n</span><span class="op" id="6130203">,</span>&nbsp;<span class="ident" id="6130205">end</span><span class="op" id="6130208">,</span>&nbsp;<span class="ident" id="6130210">nil</span><br>
<span class="lineno"></span><span class="op" id="6130214">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="comment" id="6130217">//&nbsp;Decode&nbsp;decodes&nbsp;src&nbsp;using&nbsp;the&nbsp;encoding&nbsp;enc.&nbsp;&nbsp;It&nbsp;writes&nbsp;at&nbsp;most</span><br>
<span class="lineno"></span><span class="comment" id="6130282">//&nbsp;DecodedLen(len(src))&nbsp;bytes&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno"></span><span class="comment" id="6130351">//&nbsp;written.&nbsp;&nbsp;If&nbsp;src&nbsp;contains&nbsp;invalid&nbsp;base32&nbsp;data,&nbsp;it&nbsp;will&nbsp;return&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6130420">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;successfully&nbsp;written&nbsp;and&nbsp;CorruptInputError.</span><br>
<span class="lineno">320</span><span class="comment" id="6130483">//&nbsp;New&nbsp;line&nbsp;characters&nbsp;(\r&nbsp;and&nbsp;\n)&nbsp;are&nbsp;ignored.</span><br>
<span class="lineno"></span><span class="keyword" id="6130531">func</span>&nbsp;<span class="op" id="6130536">(</span><span class="ident" id="6130537">enc</span>&nbsp;<span class="op" id="6130541">*</span><span class="ident" id="6130542">Encoding</span><span class="op" id="6130550">)</span>&nbsp;<span class="ident" id="6130552">Decode</span><span class="op" id="6130558">(</span><span class="ident" id="6130559">dst</span><span class="op" id="6130562">,</span>&nbsp;<span class="ident" id="6130564">src</span>&nbsp;<span class="op" id="6130568">[</span><span class="op" id="6130569">]</span><span class="builtintype" id="6130570">byte</span><span class="op" id="6130574">)</span>&nbsp;<span class="op" id="6130576">(</span><span class="ident" id="6130577">n</span>&nbsp;<span class="builtintype" id="6130579">int</span><span class="op" id="6130582">,</span>&nbsp;<span class="ident" id="6130584">err</span>&nbsp;<span class="builtintype" id="6130588">error</span><span class="op" id="6130593">)</span>&nbsp;<span class="op" id="6130595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6130598">src</span>&nbsp;<span class="op" id="6130602">=</span>&nbsp;<span class="ident" id="6130604">bytes</span><span class="op" id="6130609">.</span><span class="ident" id="6130610">Map</span><span class="op" id="6130613">(</span><span class="ident" id="6130614">removeNewlinesMapper</span><span class="op" id="6130634">,</span>&nbsp;<span class="ident" id="6130636">src</span><span class="op" id="6130639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6130642">n</span><span class="op" id="6130643">,</span>&nbsp;<span class="ident" id="6130645">_</span><span class="op" id="6130646">,</span>&nbsp;<span class="ident" id="6130648">err</span>&nbsp;<span class="op" id="6130652">=</span>&nbsp;<span class="ident" id="6130654">enc</span><span class="op" id="6130657">.</span><span class="ident" id="6130658">decode</span><span class="op" id="6130664">(</span><span class="ident" id="6130665">dst</span><span class="op" id="6130668">,</span>&nbsp;<span class="ident" id="6130670">src</span><span class="op" id="6130673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6130676">return</span><br>
<span class="lineno">325</span><span class="op" id="6130683">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6130686">//&nbsp;DecodeString&nbsp;returns&nbsp;the&nbsp;bytes&nbsp;represented&nbsp;by&nbsp;the&nbsp;base32&nbsp;string&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="6130756">func</span>&nbsp;<span class="op" id="6130761">(</span><span class="ident" id="6130762">enc</span>&nbsp;<span class="op" id="6130766">*</span><span class="ident" id="6130767">Encoding</span><span class="op" id="6130775">)</span>&nbsp;<span class="ident" id="6130777">DecodeString</span><span class="op" id="6130789">(</span><span class="ident" id="6130790">s</span>&nbsp;<span class="builtintype" id="6130792">string</span><span class="op" id="6130798">)</span>&nbsp;<span class="op" id="6130800">(</span><span class="op" id="6130801">[</span><span class="op" id="6130802">]</span><span class="builtintype" id="6130803">byte</span><span class="op" id="6130807">,</span>&nbsp;<span class="builtintype" id="6130809">error</span><span class="op" id="6130814">)</span>&nbsp;<span class="op" id="6130816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6130819">s</span>&nbsp;<span class="op" id="6130821">=</span>&nbsp;<span class="ident" id="6130823">strings</span><span class="op" id="6130830">.</span><span class="ident" id="6130831">Map</span><span class="op" id="6130834">(</span><span class="ident" id="6130835">removeNewlinesMapper</span><span class="op" id="6130855">,</span>&nbsp;<span class="ident" id="6130857">s</span><span class="op" id="6130858">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6130861">dbuf</span>&nbsp;<span class="op" id="6130866">:=</span>&nbsp;<span class="builtinfunc" id="6130869">make</span><span class="op" id="6130873">(</span><span class="op" id="6130874">[</span><span class="op" id="6130875">]</span><span class="builtintype" id="6130876">byte</span><span class="op" id="6130880">,</span>&nbsp;<span class="ident" id="6130882">enc</span><span class="op" id="6130885">.</span><span class="ident" id="6130886">DecodedLen</span><span class="op" id="6130896">(</span><span class="builtinfunc" id="6130897">len</span><span class="op" id="6130900">(</span><span class="ident" id="6130901">s</span><span class="op" id="6130902">)</span><span class="op" id="6130903">)</span><span class="op" id="6130904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6130907">n</span><span class="op" id="6130908">,</span>&nbsp;<span class="ident" id="6130910">_</span><span class="op" id="6130911">,</span>&nbsp;<span class="ident" id="6130913">err</span>&nbsp;<span class="op" id="6130917">:=</span>&nbsp;<span class="ident" id="6130920">enc</span><span class="op" id="6130923">.</span><span class="ident" id="6130924">decode</span><span class="op" id="6130930">(</span><span class="ident" id="6130931">dbuf</span><span class="op" id="6130935">,</span>&nbsp;<span class="op" id="6130937">[</span><span class="op" id="6130938">]</span><span class="builtintype" id="6130939">byte</span><span class="op" id="6130943">(</span><span class="ident" id="6130944">s</span><span class="op" id="6130945">)</span><span class="op" id="6130946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6130949">return</span>&nbsp;<span class="ident" id="6130956">dbuf</span><span class="op" id="6130960">[</span><span class="op" id="6130961">:</span><span class="ident" id="6130962">n</span><span class="op" id="6130963">]</span><span class="op" id="6130964">,</span>&nbsp;<span class="ident" id="6130966">err</span><br>
<span class="lineno"></span><span class="op" id="6130970">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="keyword" id="6130973">type</span>&nbsp;<span class="ident" id="6130978">decoder</span>&nbsp;<span class="keyword" id="6130986">struct</span>&nbsp;<span class="op" id="6130993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6130996">err</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6131003">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6131010">enc</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6131017">*</span><span class="ident" id="6131018">Encoding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6131028">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6131035">io</span><span class="op" id="6131037">.</span><span class="ident" id="6131038">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6131046">end</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6131053">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6131064">//&nbsp;saw&nbsp;end&nbsp;of&nbsp;message</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6131087">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6131094">[</span><span class="num" id="6131095">1024</span><span class="op" id="6131099">]</span><span class="builtintype" id="6131100">byte</span>&nbsp;<span class="comment" id="6131105">//&nbsp;leftover&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6131124">nbuf</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6131131">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6131136">out</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6131143">[</span><span class="op" id="6131144">]</span><span class="builtintype" id="6131145">byte</span>&nbsp;<span class="comment" id="6131150">//&nbsp;leftover&nbsp;decoded&nbsp;output</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6131178">outbuf</span>&nbsp;<span class="op" id="6131185">[</span><span class="num" id="6131186">1024</span>&nbsp;<span class="op" id="6131191">/</span>&nbsp;<span class="num" id="6131193">8</span>&nbsp;<span class="op" id="6131195">*</span>&nbsp;<span class="num" id="6131197">5</span><span class="op" id="6131198">]</span><span class="builtintype" id="6131199">byte</span><br>
<span class="lineno"></span><span class="op" id="6131204">}</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span><span class="keyword" id="6131207">func</span>&nbsp;<span class="op" id="6131212">(</span><span class="ident" id="6131213">d</span>&nbsp;<span class="op" id="6131215">*</span><span class="ident" id="6131216">decoder</span><span class="op" id="6131223">)</span>&nbsp;<span class="ident" id="6131225">Read</span><span class="op" id="6131229">(</span><span class="ident" id="6131230">p</span>&nbsp;<span class="op" id="6131232">[</span><span class="op" id="6131233">]</span><span class="builtintype" id="6131234">byte</span><span class="op" id="6131238">)</span>&nbsp;<span class="op" id="6131240">(</span><span class="ident" id="6131241">n</span>&nbsp;<span class="builtintype" id="6131243">int</span><span class="op" id="6131246">,</span>&nbsp;<span class="ident" id="6131248">err</span>&nbsp;<span class="builtintype" id="6131252">error</span><span class="op" id="6131257">)</span>&nbsp;<span class="op" id="6131259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6131262">if</span>&nbsp;<span class="ident" id="6131265">d</span><span class="op" id="6131266">.</span><span class="ident" id="6131267">err</span>&nbsp;<span class="op" id="6131271">!=</span>&nbsp;<span class="ident" id="6131274">nil</span>&nbsp;<span class="op" id="6131278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6131282">return</span>&nbsp;<span class="num" id="6131289">0</span><span class="op" id="6131290">,</span>&nbsp;<span class="ident" id="6131292">d</span><span class="op" id="6131293">.</span><span class="ident" id="6131294">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6131299">}</span><br>
<span class="lineno">350</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6131303">//&nbsp;Use&nbsp;leftover&nbsp;decoded&nbsp;output&nbsp;from&nbsp;last&nbsp;read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6131351">if</span>&nbsp;<span class="builtinfunc" id="6131354">len</span><span class="op" id="6131357">(</span><span class="ident" id="6131358">d</span><span class="op" id="6131359">.</span><span class="ident" id="6131360">out</span><span class="op" id="6131363">)</span>&nbsp;<span class="op" id="6131365">&gt;</span>&nbsp;<span class="num" id="6131367">0</span>&nbsp;<span class="op" id="6131369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6131373">n</span>&nbsp;<span class="op" id="6131375">=</span>&nbsp;<span class="builtinfunc" id="6131377">copy</span><span class="op" id="6131381">(</span><span class="ident" id="6131382">p</span><span class="op" id="6131383">,</span>&nbsp;<span class="ident" id="6131385">d</span><span class="op" id="6131386">.</span><span class="ident" id="6131387">out</span><span class="op" id="6131390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6131394">d</span><span class="op" id="6131395">.</span><span class="ident" id="6131396">out</span>&nbsp;<span class="op" id="6131400">=</span>&nbsp;<span class="ident" id="6131402">d</span><span class="op" id="6131403">.</span><span class="ident" id="6131404">out</span><span class="op" id="6131407">[</span><span class="ident" id="6131408">n</span><span class="op" id="6131409">:</span><span class="op" id="6131410">]</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6131414">return</span>&nbsp;<span class="ident" id="6131421">n</span><span class="op" id="6131422">,</span>&nbsp;<span class="ident" id="6131424">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6131429">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6131433">//&nbsp;Read&nbsp;a&nbsp;chunk.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6131451">nn</span>&nbsp;<span class="op" id="6131454">:=</span>&nbsp;<span class="builtinfunc" id="6131457">len</span><span class="op" id="6131460">(</span><span class="ident" id="6131461">p</span><span class="op" id="6131462">)</span>&nbsp;<span class="op" id="6131464">/</span>&nbsp;<span class="num" id="6131466">5</span>&nbsp;<span class="op" id="6131468">*</span>&nbsp;<span class="num" id="6131470">8</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6131473">if</span>&nbsp;<span class="ident" id="6131476">nn</span>&nbsp;<span class="op" id="6131479">&lt;</span>&nbsp;<span class="num" id="6131481">8</span>&nbsp;<span class="op" id="6131483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6131487">nn</span>&nbsp;<span class="op" id="6131490">=</span>&nbsp;<span class="num" id="6131492">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6131495">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6131498">if</span>&nbsp;<span class="ident" id="6131501">nn</span>&nbsp;<span class="op" id="6131504">&gt;</span>&nbsp;<span class="builtinfunc" id="6131506">len</span><span class="op" id="6131509">(</span><span class="ident" id="6131510">d</span><span class="op" id="6131511">.</span><span class="ident" id="6131512">buf</span><span class="op" id="6131515">)</span>&nbsp;<span class="op" id="6131517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6131521">nn</span>&nbsp;<span class="op" id="6131524">=</span>&nbsp;<span class="builtinfunc" id="6131526">len</span><span class="op" id="6131529">(</span><span class="ident" id="6131530">d</span><span class="op" id="6131531">.</span><span class="ident" id="6131532">buf</span><span class="op" id="6131535">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6131538">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6131541">nn</span><span class="op" id="6131543">,</span>&nbsp;<span class="ident" id="6131545">d</span><span class="op" id="6131546">.</span><span class="ident" id="6131547">err</span>&nbsp;<span class="op" id="6131551">=</span>&nbsp;<span class="ident" id="6131553">io</span><span class="op" id="6131555">.</span><span class="ident" id="6131556">ReadAtLeast</span><span class="op" id="6131567">(</span><span class="ident" id="6131568">d</span><span class="op" id="6131569">.</span><span class="ident" id="6131570">r</span><span class="op" id="6131571">,</span>&nbsp;<span class="ident" id="6131573">d</span><span class="op" id="6131574">.</span><span class="ident" id="6131575">buf</span><span class="op" id="6131578">[</span><span class="ident" id="6131579">d</span><span class="op" id="6131580">.</span><span class="ident" id="6131581">nbuf</span><span class="op" id="6131585">:</span><span class="ident" id="6131586">nn</span><span class="op" id="6131588">]</span><span class="op" id="6131589">,</span>&nbsp;<span class="num" id="6131591">8</span><span class="op" id="6131592">-</span><span class="ident" id="6131593">d</span><span class="op" id="6131594">.</span><span class="ident" id="6131595">nbuf</span><span class="op" id="6131599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6131602">d</span><span class="op" id="6131603">.</span><span class="ident" id="6131604">nbuf</span>&nbsp;<span class="op" id="6131609">+=</span>&nbsp;<span class="ident" id="6131612">nn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6131616">if</span>&nbsp;<span class="ident" id="6131619">d</span><span class="op" id="6131620">.</span><span class="ident" id="6131621">nbuf</span>&nbsp;<span class="op" id="6131626">&lt;</span>&nbsp;<span class="num" id="6131628">8</span>&nbsp;<span class="op" id="6131630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6131634">return</span>&nbsp;<span class="num" id="6131641">0</span><span class="op" id="6131642">,</span>&nbsp;<span class="ident" id="6131644">d</span><span class="op" id="6131645">.</span><span class="ident" id="6131646">err</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6131651">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6131655">//&nbsp;Decode&nbsp;chunk&nbsp;into&nbsp;p,&nbsp;or&nbsp;d.out&nbsp;and&nbsp;then&nbsp;p&nbsp;if&nbsp;p&nbsp;is&nbsp;too&nbsp;small.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6131719">nr</span>&nbsp;<span class="op" id="6131722">:=</span>&nbsp;<span class="ident" id="6131725">d</span><span class="op" id="6131726">.</span><span class="ident" id="6131727">nbuf</span>&nbsp;<span class="op" id="6131732">/</span>&nbsp;<span class="num" id="6131734">8</span>&nbsp;<span class="op" id="6131736">*</span>&nbsp;<span class="num" id="6131738">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6131741">nw</span>&nbsp;<span class="op" id="6131744">:=</span>&nbsp;<span class="ident" id="6131747">d</span><span class="op" id="6131748">.</span><span class="ident" id="6131749">nbuf</span>&nbsp;<span class="op" id="6131754">/</span>&nbsp;<span class="num" id="6131756">8</span>&nbsp;<span class="op" id="6131758">*</span>&nbsp;<span class="num" id="6131760">5</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6131763">if</span>&nbsp;<span class="ident" id="6131766">nw</span>&nbsp;<span class="op" id="6131769">&gt;</span>&nbsp;<span class="builtinfunc" id="6131771">len</span><span class="op" id="6131774">(</span><span class="ident" id="6131775">p</span><span class="op" id="6131776">)</span>&nbsp;<span class="op" id="6131778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6131782">nw</span><span class="op" id="6131784">,</span>&nbsp;<span class="ident" id="6131786">d</span><span class="op" id="6131787">.</span><span class="ident" id="6131788">end</span><span class="op" id="6131791">,</span>&nbsp;<span class="ident" id="6131793">d</span><span class="op" id="6131794">.</span><span class="ident" id="6131795">err</span>&nbsp;<span class="op" id="6131799">=</span>&nbsp;<span class="ident" id="6131801">d</span><span class="op" id="6131802">.</span><span class="ident" id="6131803">enc</span><span class="op" id="6131806">.</span><span class="ident" id="6131807">decode</span><span class="op" id="6131813">(</span><span class="ident" id="6131814">d</span><span class="op" id="6131815">.</span><span class="ident" id="6131816">outbuf</span><span class="op" id="6131822">[</span><span class="num" id="6131823">0</span><span class="op" id="6131824">:</span><span class="op" id="6131825">]</span><span class="op" id="6131826">,</span>&nbsp;<span class="ident" id="6131828">d</span><span class="op" id="6131829">.</span><span class="ident" id="6131830">buf</span><span class="op" id="6131833">[</span><span class="num" id="6131834">0</span><span class="op" id="6131835">:</span><span class="ident" id="6131836">nr</span><span class="op" id="6131838">]</span><span class="op" id="6131839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6131843">d</span><span class="op" id="6131844">.</span><span class="ident" id="6131845">out</span>&nbsp;<span class="op" id="6131849">=</span>&nbsp;<span class="ident" id="6131851">d</span><span class="op" id="6131852">.</span><span class="ident" id="6131853">outbuf</span><span class="op" id="6131859">[</span><span class="num" id="6131860">0</span><span class="op" id="6131861">:</span><span class="ident" id="6131862">nw</span><span class="op" id="6131864">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6131868">n</span>&nbsp;<span class="op" id="6131870">=</span>&nbsp;<span class="builtinfunc" id="6131872">copy</span><span class="op" id="6131876">(</span><span class="ident" id="6131877">p</span><span class="op" id="6131878">,</span>&nbsp;<span class="ident" id="6131880">d</span><span class="op" id="6131881">.</span><span class="ident" id="6131882">out</span><span class="op" id="6131885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6131889">d</span><span class="op" id="6131890">.</span><span class="ident" id="6131891">out</span>&nbsp;<span class="op" id="6131895">=</span>&nbsp;<span class="ident" id="6131897">d</span><span class="op" id="6131898">.</span><span class="ident" id="6131899">out</span><span class="op" id="6131902">[</span><span class="ident" id="6131903">n</span><span class="op" id="6131904">:</span><span class="op" id="6131905">]</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6131908">}</span>&nbsp;<span class="keyword" id="6131910">else</span>&nbsp;<span class="op" id="6131915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6131919">n</span><span class="op" id="6131920">,</span>&nbsp;<span class="ident" id="6131922">d</span><span class="op" id="6131923">.</span><span class="ident" id="6131924">end</span><span class="op" id="6131927">,</span>&nbsp;<span class="ident" id="6131929">d</span><span class="op" id="6131930">.</span><span class="ident" id="6131931">err</span>&nbsp;<span class="op" id="6131935">=</span>&nbsp;<span class="ident" id="6131937">d</span><span class="op" id="6131938">.</span><span class="ident" id="6131939">enc</span><span class="op" id="6131942">.</span><span class="ident" id="6131943">decode</span><span class="op" id="6131949">(</span><span class="ident" id="6131950">p</span><span class="op" id="6131951">,</span>&nbsp;<span class="ident" id="6131953">d</span><span class="op" id="6131954">.</span><span class="ident" id="6131955">buf</span><span class="op" id="6131958">[</span><span class="num" id="6131959">0</span><span class="op" id="6131960">:</span><span class="ident" id="6131961">nr</span><span class="op" id="6131963">]</span><span class="op" id="6131964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6131967">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6131970">d</span><span class="op" id="6131971">.</span><span class="ident" id="6131972">nbuf</span>&nbsp;<span class="op" id="6131977">-=</span>&nbsp;<span class="ident" id="6131980">nr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6131984">for</span>&nbsp;<span class="ident" id="6131988">i</span>&nbsp;<span class="op" id="6131990">:=</span>&nbsp;<span class="num" id="6131993">0</span><span class="op" id="6131994">;</span>&nbsp;<span class="ident" id="6131996">i</span>&nbsp;<span class="op" id="6131998">&lt;</span>&nbsp;<span class="ident" id="6132000">d</span><span class="op" id="6132001">.</span><span class="ident" id="6132002">nbuf</span><span class="op" id="6132006">;</span>&nbsp;<span class="ident" id="6132008">i</span><span class="op" id="6132009">++</span>&nbsp;<span class="op" id="6132012">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6132016">d</span><span class="op" id="6132017">.</span><span class="ident" id="6132018">buf</span><span class="op" id="6132021">[</span><span class="ident" id="6132022">i</span><span class="op" id="6132023">]</span>&nbsp;<span class="op" id="6132025">=</span>&nbsp;<span class="ident" id="6132027">d</span><span class="op" id="6132028">.</span><span class="ident" id="6132029">buf</span><span class="op" id="6132032">[</span><span class="ident" id="6132033">i</span><span class="op" id="6132034">+</span><span class="ident" id="6132035">nr</span><span class="op" id="6132037">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6132040">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6132044">if</span>&nbsp;<span class="ident" id="6132047">d</span><span class="op" id="6132048">.</span><span class="ident" id="6132049">err</span>&nbsp;<span class="op" id="6132053">==</span>&nbsp;<span class="ident" id="6132056">nil</span>&nbsp;<span class="op" id="6132060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6132064">d</span><span class="op" id="6132065">.</span><span class="ident" id="6132066">err</span>&nbsp;<span class="op" id="6132070">=</span>&nbsp;<span class="ident" id="6132072">err</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6132077">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6132080">return</span>&nbsp;<span class="ident" id="6132087">n</span><span class="op" id="6132088">,</span>&nbsp;<span class="ident" id="6132090">d</span><span class="op" id="6132091">.</span><span class="ident" id="6132092">err</span><br>
<span class="lineno"></span><span class="op" id="6132096">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6132099">type</span>&nbsp;<span class="ident" id="6132104">newlineFilteringReader</span>&nbsp;<span class="keyword" id="6132127">struct</span>&nbsp;<span class="op" id="6132134">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6132137">wrapped</span>&nbsp;<span class="ident" id="6132145">io</span><span class="op" id="6132147">.</span><span class="ident" id="6132148">Reader</span><br>
<span class="lineno"></span><span class="op" id="6132155">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6132158">func</span>&nbsp;<span class="op" id="6132163">(</span><span class="ident" id="6132164">r</span>&nbsp;<span class="op" id="6132166">*</span><span class="ident" id="6132167">newlineFilteringReader</span><span class="op" id="6132189">)</span>&nbsp;<span class="ident" id="6132191">Read</span><span class="op" id="6132195">(</span><span class="ident" id="6132196">p</span>&nbsp;<span class="op" id="6132198">[</span><span class="op" id="6132199">]</span><span class="builtintype" id="6132200">byte</span><span class="op" id="6132204">)</span>&nbsp;<span class="op" id="6132206">(</span><span class="builtintype" id="6132207">int</span><span class="op" id="6132210">,</span>&nbsp;<span class="builtintype" id="6132212">error</span><span class="op" id="6132217">)</span>&nbsp;<span class="op" id="6132219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6132222">n</span><span class="op" id="6132223">,</span>&nbsp;<span class="ident" id="6132225">err</span>&nbsp;<span class="op" id="6132229">:=</span>&nbsp;<span class="ident" id="6132232">r</span><span class="op" id="6132233">.</span><span class="ident" id="6132234">wrapped</span><span class="op" id="6132241">.</span><span class="ident" id="6132242">Read</span><span class="op" id="6132246">(</span><span class="ident" id="6132247">p</span><span class="op" id="6132248">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6132251">for</span>&nbsp;<span class="ident" id="6132255">n</span>&nbsp;<span class="op" id="6132257">&gt;</span>&nbsp;<span class="num" id="6132259">0</span>&nbsp;<span class="op" id="6132261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6132265">offset</span>&nbsp;<span class="op" id="6132272">:=</span>&nbsp;<span class="num" id="6132275">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6132279">for</span>&nbsp;<span class="ident" id="6132283">i</span><span class="op" id="6132284">,</span>&nbsp;<span class="ident" id="6132286">b</span>&nbsp;<span class="op" id="6132288">:=</span>&nbsp;<span class="keyword" id="6132291">range</span>&nbsp;<span class="ident" id="6132297">p</span><span class="op" id="6132298">[</span><span class="num" id="6132299">0</span><span class="op" id="6132300">:</span><span class="ident" id="6132301">n</span><span class="op" id="6132302">]</span>&nbsp;<span class="op" id="6132304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6132309">if</span>&nbsp;<span class="ident" id="6132312">b</span>&nbsp;<span class="op" id="6132314">!=</span>&nbsp;<span class="string" id="6132317">&#39;\r&#39;</span>&nbsp;<span class="op" id="6132322">&amp;&amp;</span>&nbsp;<span class="ident" id="6132325">b</span>&nbsp;<span class="op" id="6132327">!=</span>&nbsp;<span class="string" id="6132330">&#39;\n&#39;</span>&nbsp;<span class="op" id="6132335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6132341">if</span>&nbsp;<span class="ident" id="6132344">i</span>&nbsp;<span class="op" id="6132346">!=</span>&nbsp;<span class="ident" id="6132349">offset</span>&nbsp;<span class="op" id="6132356">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6132363">p</span><span class="op" id="6132364">[</span><span class="ident" id="6132365">offset</span><span class="op" id="6132371">]</span>&nbsp;<span class="op" id="6132373">=</span>&nbsp;<span class="ident" id="6132375">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6132381">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6132387">offset</span><span class="op" id="6132393">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6132399">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6132403">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6132407">if</span>&nbsp;<span class="ident" id="6132410">offset</span>&nbsp;<span class="op" id="6132417">&gt;</span>&nbsp;<span class="num" id="6132419">0</span>&nbsp;<span class="op" id="6132421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6132426">return</span>&nbsp;<span class="ident" id="6132433">offset</span><span class="op" id="6132439">,</span>&nbsp;<span class="ident" id="6132441">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6132447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6132451">//&nbsp;Previous&nbsp;buffer&nbsp;entirely&nbsp;whitespace,&nbsp;read&nbsp;again</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6132504">n</span><span class="op" id="6132505">,</span>&nbsp;<span class="ident" id="6132507">err</span>&nbsp;<span class="op" id="6132511">=</span>&nbsp;<span class="ident" id="6132513">r</span><span class="op" id="6132514">.</span><span class="ident" id="6132515">wrapped</span><span class="op" id="6132522">.</span><span class="ident" id="6132523">Read</span><span class="op" id="6132527">(</span><span class="ident" id="6132528">p</span><span class="op" id="6132529">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6132532">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6132535">return</span>&nbsp;<span class="ident" id="6132542">n</span><span class="op" id="6132543">,</span>&nbsp;<span class="ident" id="6132545">err</span><br>
<span class="lineno"></span><span class="op" id="6132549">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6132552">//&nbsp;NewDecoder&nbsp;constructs&nbsp;a&nbsp;new&nbsp;base32&nbsp;stream&nbsp;decoder.</span><br>
<span class="lineno">420</span><span class="keyword" id="6132606">func</span>&nbsp;<span class="ident" id="6132611">NewDecoder</span><span class="op" id="6132621">(</span><span class="ident" id="6132622">enc</span>&nbsp;<span class="op" id="6132626">*</span><span class="ident" id="6132627">Encoding</span><span class="op" id="6132635">,</span>&nbsp;<span class="ident" id="6132637">r</span>&nbsp;<span class="ident" id="6132639">io</span><span class="op" id="6132641">.</span><span class="ident" id="6132642">Reader</span><span class="op" id="6132648">)</span>&nbsp;<span class="ident" id="6132650">io</span><span class="op" id="6132652">.</span><span class="ident" id="6132653">Reader</span>&nbsp;<span class="op" id="6132660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6132663">return</span>&nbsp;<span class="op" id="6132670">&amp;</span><span class="ident" id="6132671">decoder</span><span class="op" id="6132678">{</span><span class="ident" id="6132679">enc</span><span class="op" id="6132682">:</span>&nbsp;<span class="ident" id="6132684">enc</span><span class="op" id="6132687">,</span>&nbsp;<span class="ident" id="6132689">r</span><span class="op" id="6132690">:</span>&nbsp;<span class="op" id="6132692">&amp;</span><span class="ident" id="6132693">newlineFilteringReader</span><span class="op" id="6132715">{</span><span class="ident" id="6132716">r</span><span class="op" id="6132717">}</span><span class="op" id="6132718">}</span><br>
<span class="lineno"></span><span class="op" id="6132720">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6132723">//&nbsp;DecodedLen&nbsp;returns&nbsp;the&nbsp;maximum&nbsp;length&nbsp;in&nbsp;bytes&nbsp;of&nbsp;the&nbsp;decoded&nbsp;data</span><br>
<span class="lineno">425</span><span class="comment" id="6132793">//&nbsp;corresponding&nbsp;to&nbsp;n&nbsp;bytes&nbsp;of&nbsp;base32-encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="6132845">func</span>&nbsp;<span class="op" id="6132850">(</span><span class="ident" id="6132851">enc</span>&nbsp;<span class="op" id="6132855">*</span><span class="ident" id="6132856">Encoding</span><span class="op" id="6132864">)</span>&nbsp;<span class="ident" id="6132866">DecodedLen</span><span class="op" id="6132876">(</span><span class="ident" id="6132877">n</span>&nbsp;<span class="builtintype" id="6132879">int</span><span class="op" id="6132882">)</span>&nbsp;<span class="builtintype" id="6132884">int</span>&nbsp;<span class="op" id="6132888">{</span>&nbsp;<span class="keyword" id="6132890">return</span>&nbsp;<span class="ident" id="6132897">n</span>&nbsp;<span class="op" id="6132899">/</span>&nbsp;<span class="num" id="6132901">8</span>&nbsp;<span class="op" id="6132903">*</span>&nbsp;<span class="num" id="6132905">5</span>&nbsp;<span class="op" id="6132907">}</span>
</div>
</body>
</html>
