<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/elliptic</h2>
<ul>
<li><a href="/gostd/crypto/elliptic/elliptic.go.html">elliptic.go</a></li>
<li><a href="/gostd/crypto/elliptic/elliptic_test.go.html">elliptic_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224.go.html">p224.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224_test.go.html" class="current">p224_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p256.go.html">p256.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7049251">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7049307">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7049361">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7049412">package</span>&nbsp;<span class="ident" id="7049420">elliptic</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7049430">import</span>&nbsp;<span class="op" id="7049437">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7049440">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7049452">&#34;testing&#34;</span><br>
<span class="lineno">10</span><span class="op" id="7049462">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7049465">var</span>&nbsp;<span class="ident" id="7049469">toFromBigTests</span>&nbsp;<span class="op" id="7049484">=</span>&nbsp;<span class="op" id="7049486">[</span><span class="op" id="7049487">]</span><span class="builtintype" id="7049488">string</span><span class="op" id="7049494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7049497">&#34;0&#34;</span><span class="op" id="7049500">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7049503">&#34;1&#34;</span><span class="op" id="7049506">,</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7049509">&#34;23&#34;</span><span class="op" id="7049513">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7049516">&#34;b70e0cb46bb4bf7f321390b94a03c1d356c01122343280d6105c1d21&#34;</span><span class="op" id="7049574">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7049577">&#34;706a46d476dcb76798e6046d89474788d164c18032d268fd10704fa6&#34;</span><span class="op" id="7049635">,</span><br>
<span class="lineno"></span><span class="op" id="7049637">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="7049640">func</span>&nbsp;<span class="ident" id="7049645">p224AlternativeToBig</span><span class="op" id="7049665">(</span><span class="ident" id="7049666">in</span>&nbsp;<span class="op" id="7049669">*</span><span class="ident" id="7049670">p224FieldElement</span><span class="op" id="7049686">)</span>&nbsp;<span class="op" id="7049688">*</span><span class="ident" id="7049689">big</span><span class="op" id="7049692">.</span><span class="ident" id="7049693">Int</span>&nbsp;<span class="op" id="7049697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7049700">ret</span>&nbsp;<span class="op" id="7049704">:=</span>&nbsp;<span class="builtinfunc" id="7049707">new</span><span class="op" id="7049710">(</span><span class="ident" id="7049711">big</span><span class="op" id="7049714">.</span><span class="ident" id="7049715">Int</span><span class="op" id="7049718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7049721">tmp</span>&nbsp;<span class="op" id="7049725">:=</span>&nbsp;<span class="builtinfunc" id="7049728">new</span><span class="op" id="7049731">(</span><span class="ident" id="7049732">big</span><span class="op" id="7049735">.</span><span class="ident" id="7049736">Int</span><span class="op" id="7049739">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7049743">for</span>&nbsp;<span class="ident" id="7049747">i</span>&nbsp;<span class="op" id="7049749">:=</span>&nbsp;<span class="builtintype" id="7049752">uint</span><span class="op" id="7049756">(</span><span class="num" id="7049757">0</span><span class="op" id="7049758">)</span><span class="op" id="7049759">;</span>&nbsp;<span class="ident" id="7049761">i</span>&nbsp;<span class="op" id="7049763">&lt;</span>&nbsp;<span class="num" id="7049765">8</span><span class="op" id="7049766">;</span>&nbsp;<span class="ident" id="7049768">i</span><span class="op" id="7049769">++</span>&nbsp;<span class="op" id="7049772">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7049776">tmp</span><span class="op" id="7049779">.</span><span class="ident" id="7049780">SetInt64</span><span class="op" id="7049788">(</span><span class="ident" id="7049789">int64</span><span class="op" id="7049794">(</span><span class="ident" id="7049795">in</span><span class="op" id="7049797">[</span><span class="ident" id="7049798">i</span><span class="op" id="7049799">]</span><span class="op" id="7049800">)</span><span class="op" id="7049801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7049805">tmp</span><span class="op" id="7049808">.</span><span class="ident" id="7049809">Lsh</span><span class="op" id="7049812">(</span><span class="ident" id="7049813">tmp</span><span class="op" id="7049816">,</span>&nbsp;<span class="num" id="7049818">28</span><span class="op" id="7049820">*</span><span class="ident" id="7049821">i</span><span class="op" id="7049822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7049826">ret</span><span class="op" id="7049829">.</span><span class="ident" id="7049830">Add</span><span class="op" id="7049833">(</span><span class="ident" id="7049834">ret</span><span class="op" id="7049837">,</span>&nbsp;<span class="ident" id="7049839">tmp</span><span class="op" id="7049842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7049845">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7049848">ret</span><span class="op" id="7049851">.</span><span class="ident" id="7049852">Mod</span><span class="op" id="7049855">(</span><span class="ident" id="7049856">ret</span><span class="op" id="7049859">,</span>&nbsp;<span class="ident" id="7049861">p224</span><span class="op" id="7049865">.</span><span class="ident" id="7049866">P</span><span class="op" id="7049867">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7049870">return</span>&nbsp;<span class="ident" id="7049877">ret</span><br>
<span class="lineno"></span><span class="op" id="7049881">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7049884">func</span>&nbsp;<span class="ident" id="7049889">TestToFromBig</span><span class="op" id="7049902">(</span><span class="ident" id="7049903">t</span>&nbsp;<span class="op" id="7049905">*</span><span class="ident" id="7049906">testing</span><span class="op" id="7049913">.</span><span class="ident" id="7049914">T</span><span class="op" id="7049915">)</span>&nbsp;<span class="op" id="7049917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7049920">for</span>&nbsp;<span class="ident" id="7049924">i</span><span class="op" id="7049925">,</span>&nbsp;<span class="ident" id="7049927">test</span>&nbsp;<span class="op" id="7049932">:=</span>&nbsp;<span class="keyword" id="7049935">range</span>&nbsp;<span class="ident" id="7049941">toFromBigTests</span>&nbsp;<span class="op" id="7049956">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7049960">n</span><span class="op" id="7049961">,</span>&nbsp;<span class="ident" id="7049963">_</span>&nbsp;<span class="op" id="7049965">:=</span>&nbsp;<span class="builtinfunc" id="7049968">new</span><span class="op" id="7049971">(</span><span class="ident" id="7049972">big</span><span class="op" id="7049975">.</span><span class="ident" id="7049976">Int</span><span class="op" id="7049979">)</span><span class="op" id="7049980">.</span><span class="ident" id="7049981">SetString</span><span class="op" id="7049990">(</span><span class="ident" id="7049991">test</span><span class="op" id="7049995">,</span>&nbsp;<span class="num" id="7049997">16</span><span class="op" id="7049999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7050003">var</span>&nbsp;<span class="ident" id="7050007">x</span>&nbsp;<span class="ident" id="7050009">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7050028">p224FromBig</span><span class="op" id="7050039">(</span><span class="op" id="7050040">&amp;</span><span class="ident" id="7050041">x</span><span class="op" id="7050042">,</span>&nbsp;<span class="ident" id="7050044">n</span><span class="op" id="7050045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7050049">m</span>&nbsp;<span class="op" id="7050051">:=</span>&nbsp;<span class="ident" id="7050054">p224ToBig</span><span class="op" id="7050063">(</span><span class="op" id="7050064">&amp;</span><span class="ident" id="7050065">x</span><span class="op" id="7050066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7050070">if</span>&nbsp;<span class="ident" id="7050073">n</span><span class="op" id="7050074">.</span><span class="ident" id="7050075">Cmp</span><span class="op" id="7050078">(</span><span class="ident" id="7050079">m</span><span class="op" id="7050080">)</span>&nbsp;<span class="op" id="7050082">!=</span>&nbsp;<span class="num" id="7050085">0</span>&nbsp;<span class="op" id="7050087">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7050092">t</span><span class="op" id="7050093">.</span><span class="ident" id="7050094">Errorf</span><span class="op" id="7050100">(</span><span class="string" id="7050101">&#34;#%d:&nbsp;%x&nbsp;!=&nbsp;%x&#34;</span><span class="op" id="7050116">,</span>&nbsp;<span class="ident" id="7050118">i</span><span class="op" id="7050119">,</span>&nbsp;<span class="ident" id="7050121">n</span><span class="op" id="7050122">,</span>&nbsp;<span class="ident" id="7050124">m</span><span class="op" id="7050125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7050129">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7050133">q</span>&nbsp;<span class="op" id="7050135">:=</span>&nbsp;<span class="ident" id="7050138">p224AlternativeToBig</span><span class="op" id="7050158">(</span><span class="op" id="7050159">&amp;</span><span class="ident" id="7050160">x</span><span class="op" id="7050161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7050165">if</span>&nbsp;<span class="ident" id="7050168">n</span><span class="op" id="7050169">.</span><span class="ident" id="7050170">Cmp</span><span class="op" id="7050173">(</span><span class="ident" id="7050174">q</span><span class="op" id="7050175">)</span>&nbsp;<span class="op" id="7050177">!=</span>&nbsp;<span class="num" id="7050180">0</span>&nbsp;<span class="op" id="7050182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7050187">t</span><span class="op" id="7050188">.</span><span class="ident" id="7050189">Errorf</span><span class="op" id="7050195">(</span><span class="string" id="7050196">&#34;#%d:&nbsp;%x&nbsp;!=&nbsp;%x&nbsp;(alternative)&#34;</span><span class="op" id="7050225">,</span>&nbsp;<span class="ident" id="7050227">i</span><span class="op" id="7050228">,</span>&nbsp;<span class="ident" id="7050230">n</span><span class="op" id="7050231">,</span>&nbsp;<span class="ident" id="7050233">m</span><span class="op" id="7050234">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7050238">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7050241">}</span><br>
<span class="lineno"></span><span class="op" id="7050243">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
