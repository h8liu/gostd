<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html" class="current">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4070712">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4070767">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4070821">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4070872">//&nbsp;Package&nbsp;x509&nbsp;parses&nbsp;X.509-encoded&nbsp;keys&nbsp;and&nbsp;certificates.</span><br>
<span class="lineno"></span><span class="keyword" id="4070932">package</span>&nbsp;<span class="ident" id="4070940">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4070946">import</span>&nbsp;<span class="op" id="4070953">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4070956">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4070965">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4070975">&#34;crypto/dsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4070989">&#34;crypto/ecdsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4071005">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4071024">&#34;crypto/rsa&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4071038">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4071053">_</span>&nbsp;<span class="string" id="4071055">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4071072">_</span>&nbsp;<span class="string" id="4071074">&#34;crypto/sha512&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4071091">&#34;crypto/x509/pkix&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4071111">&#34;encoding/asn1&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4071128">&#34;encoding/pem&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4071144">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4071154">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4071160">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4071172">&#34;net&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4071179">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4071190">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="4071197">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4071200">//&nbsp;pkixPublicKey&nbsp;reflects&nbsp;a&nbsp;PKIX&nbsp;public&nbsp;key&nbsp;structure.&nbsp;See&nbsp;SubjectPublicKeyInfo</span><br>
<span class="lineno">30</span><span class="comment" id="4071280">//&nbsp;in&nbsp;RFC&nbsp;3280.</span><br>
<span class="lineno"></span><span class="keyword" id="4071296">type</span>&nbsp;<span class="ident" id="4071301">pkixPublicKey</span>&nbsp;<span class="keyword" id="4071315">struct</span>&nbsp;<span class="op" id="4071322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4071325">Algo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4071335">pkix</span><span class="op" id="4071339">.</span><span class="ident" id="4071340">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4071361">BitString</span>&nbsp;<span class="ident" id="4071371">asn1</span><span class="op" id="4071375">.</span><span class="ident" id="4071376">BitString</span><br>
<span class="lineno"></span><span class="op" id="4071386">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="4071389">//&nbsp;ParsePKIXPublicKey&nbsp;parses&nbsp;a&nbsp;DER&nbsp;encoded&nbsp;public&nbsp;key.&nbsp;These&nbsp;values&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="4071461">//&nbsp;typically&nbsp;found&nbsp;in&nbsp;PEM&nbsp;blocks&nbsp;with&nbsp;&#34;BEGIN&nbsp;PUBLIC&nbsp;KEY&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="4071519">func</span>&nbsp;<span class="ident" id="4071524">ParsePKIXPublicKey</span><span class="op" id="4071542">(</span><span class="ident" id="4071543">derBytes</span>&nbsp;<span class="op" id="4071552">[</span><span class="op" id="4071553">]</span><span class="builtintype" id="4071554">byte</span><span class="op" id="4071558">)</span>&nbsp;<span class="op" id="4071560">(</span><span class="ident" id="4071561">pub</span>&nbsp;<span class="keyword" id="4071565">interface</span><span class="op" id="4071574">{</span><span class="op" id="4071575">}</span><span class="op" id="4071576">,</span>&nbsp;<span class="ident" id="4071578">err</span>&nbsp;<span class="builtintype" id="4071582">error</span><span class="op" id="4071587">)</span>&nbsp;<span class="op" id="4071589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4071592">var</span>&nbsp;<span class="ident" id="4071596">pki</span>&nbsp;<span class="ident" id="4071600">publicKeyInfo</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4071615">if</span>&nbsp;<span class="ident" id="4071618">_</span><span class="op" id="4071619">,</span>&nbsp;<span class="ident" id="4071621">err</span>&nbsp;<span class="op" id="4071625">=</span>&nbsp;<span class="ident" id="4071627">asn1</span><span class="op" id="4071631">.</span><span class="ident" id="4071632">Unmarshal</span><span class="op" id="4071641">(</span><span class="ident" id="4071642">derBytes</span><span class="op" id="4071650">,</span>&nbsp;<span class="op" id="4071652">&amp;</span><span class="ident" id="4071653">pki</span><span class="op" id="4071656">)</span><span class="op" id="4071657">;</span>&nbsp;<span class="ident" id="4071659">err</span>&nbsp;<span class="op" id="4071663">!=</span>&nbsp;<span class="ident" id="4071666">nil</span>&nbsp;<span class="op" id="4071670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4071674">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4071682">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4071685">algo</span>&nbsp;<span class="op" id="4071690">:=</span>&nbsp;<span class="ident" id="4071693">getPublicKeyAlgorithmFromOID</span><span class="op" id="4071721">(</span><span class="ident" id="4071722">pki</span><span class="op" id="4071725">.</span><span class="ident" id="4071726">Algorithm</span><span class="op" id="4071735">.</span><span class="ident" id="4071736">Algorithm</span><span class="op" id="4071745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4071748">if</span>&nbsp;<span class="ident" id="4071751">algo</span>&nbsp;<span class="op" id="4071756">==</span>&nbsp;<span class="ident" id="4071759">UnknownPublicKeyAlgorithm</span>&nbsp;<span class="op" id="4071785">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4071789">return</span>&nbsp;<span class="ident" id="4071796">nil</span><span class="op" id="4071799">,</span>&nbsp;<span class="ident" id="4071801">errors</span><span class="op" id="4071807">.</span><span class="ident" id="4071808">New</span><span class="op" id="4071811">(</span><span class="string" id="4071812">&#34;x509:&nbsp;unknown&nbsp;public&nbsp;key&nbsp;algorithm&#34;</span><span class="op" id="4071848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4071851">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4071854">return</span>&nbsp;<span class="ident" id="4071861">parsePublicKey</span><span class="op" id="4071875">(</span><span class="ident" id="4071876">algo</span><span class="op" id="4071880">,</span>&nbsp;<span class="op" id="4071882">&amp;</span><span class="ident" id="4071883">pki</span><span class="op" id="4071886">)</span><br>
<span class="lineno"></span><span class="op" id="4071888">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="keyword" id="4071891">func</span>&nbsp;<span class="ident" id="4071896">marshalPublicKey</span><span class="op" id="4071912">(</span><span class="ident" id="4071913">pub</span>&nbsp;<span class="keyword" id="4071917">interface</span><span class="op" id="4071926">{</span><span class="op" id="4071927">}</span><span class="op" id="4071928">)</span>&nbsp;<span class="op" id="4071930">(</span><span class="ident" id="4071931">publicKeyBytes</span>&nbsp;<span class="op" id="4071946">[</span><span class="op" id="4071947">]</span><span class="builtintype" id="4071948">byte</span><span class="op" id="4071952">,</span>&nbsp;<span class="ident" id="4071954">publicKeyAlgorithm</span>&nbsp;<span class="ident" id="4071973">pkix</span><span class="op" id="4071977">.</span><span class="ident" id="4071978">AlgorithmIdentifier</span><span class="op" id="4071997">,</span>&nbsp;<span class="ident" id="4071999">err</span>&nbsp;<span class="builtintype" id="4072003">error</span><span class="op" id="4072008">)</span>&nbsp;<span class="op" id="4072010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4072013">switch</span>&nbsp;<span class="ident" id="4072020">pub</span>&nbsp;<span class="op" id="4072024">:=</span>&nbsp;<span class="ident" id="4072027">pub</span><span class="op" id="4072030">.</span><span class="op" id="4072031">(</span><span class="keyword" id="4072032">type</span><span class="op" id="4072036">)</span>&nbsp;<span class="op" id="4072038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4072041">case</span>&nbsp;<span class="op" id="4072046">*</span><span class="ident" id="4072047">rsa</span><span class="op" id="4072050">.</span><span class="ident" id="4072051">PublicKey</span><span class="op" id="4072060">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4072064">publicKeyBytes</span><span class="op" id="4072078">,</span>&nbsp;<span class="ident" id="4072080">err</span>&nbsp;<span class="op" id="4072084">=</span>&nbsp;<span class="ident" id="4072086">asn1</span><span class="op" id="4072090">.</span><span class="ident" id="4072091">Marshal</span><span class="op" id="4072098">(</span><span class="ident" id="4072099">rsaPublicKey</span><span class="op" id="4072111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4072116">N</span><span class="op" id="4072117">:</span>&nbsp;<span class="ident" id="4072119">pub</span><span class="op" id="4072122">.</span><span class="ident" id="4072123">N</span><span class="op" id="4072124">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4072129">E</span><span class="op" id="4072130">:</span>&nbsp;<span class="ident" id="4072132">pub</span><span class="op" id="4072135">.</span><span class="ident" id="4072136">E</span><span class="op" id="4072137">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4072141">}</span><span class="op" id="4072142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4072146">publicKeyAlgorithm</span><span class="op" id="4072164">.</span><span class="ident" id="4072165">Algorithm</span>&nbsp;<span class="op" id="4072175">=</span>&nbsp;<span class="ident" id="4072177">oidPublicKeyRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4072195">//&nbsp;This&nbsp;is&nbsp;a&nbsp;NULL&nbsp;parameters&nbsp;value&nbsp;which&nbsp;is&nbsp;technically</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4072253">//&nbsp;superfluous,&nbsp;but&nbsp;most&nbsp;other&nbsp;code&nbsp;includes&nbsp;it&nbsp;and,&nbsp;by</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4072311">//&nbsp;doing&nbsp;this,&nbsp;we&nbsp;match&nbsp;their&nbsp;public&nbsp;key&nbsp;hashes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4072362">publicKeyAlgorithm</span><span class="op" id="4072380">.</span><span class="ident" id="4072381">Parameters</span>&nbsp;<span class="op" id="4072392">=</span>&nbsp;<span class="ident" id="4072394">asn1</span><span class="op" id="4072398">.</span><span class="ident" id="4072399">RawValue</span><span class="op" id="4072407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4072412">Tag</span><span class="op" id="4072415">:</span>&nbsp;<span class="num" id="4072417">5</span><span class="op" id="4072418">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4072422">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4072425">case</span>&nbsp;<span class="op" id="4072430">*</span><span class="ident" id="4072431">ecdsa</span><span class="op" id="4072436">.</span><span class="ident" id="4072437">PublicKey</span><span class="op" id="4072446">:</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4072450">publicKeyBytes</span>&nbsp;<span class="op" id="4072465">=</span>&nbsp;<span class="ident" id="4072467">elliptic</span><span class="op" id="4072475">.</span><span class="ident" id="4072476">Marshal</span><span class="op" id="4072483">(</span><span class="ident" id="4072484">pub</span><span class="op" id="4072487">.</span><span class="ident" id="4072488">Curve</span><span class="op" id="4072493">,</span>&nbsp;<span class="ident" id="4072495">pub</span><span class="op" id="4072498">.</span><span class="ident" id="4072499">X</span><span class="op" id="4072500">,</span>&nbsp;<span class="ident" id="4072502">pub</span><span class="op" id="4072505">.</span><span class="ident" id="4072506">Y</span><span class="op" id="4072507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4072511">oid</span><span class="op" id="4072514">,</span>&nbsp;<span class="ident" id="4072516">ok</span>&nbsp;<span class="op" id="4072519">:=</span>&nbsp;<span class="ident" id="4072522">oidFromNamedCurve</span><span class="op" id="4072539">(</span><span class="ident" id="4072540">pub</span><span class="op" id="4072543">.</span><span class="ident" id="4072544">Curve</span><span class="op" id="4072549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4072553">if</span>&nbsp;<span class="op" id="4072556">!</span><span class="ident" id="4072557">ok</span>&nbsp;<span class="op" id="4072560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4072565">return</span>&nbsp;<span class="ident" id="4072572">nil</span><span class="op" id="4072575">,</span>&nbsp;<span class="ident" id="4072577">pkix</span><span class="op" id="4072581">.</span><span class="ident" id="4072582">AlgorithmIdentifier</span><span class="op" id="4072601">{</span><span class="op" id="4072602">}</span><span class="op" id="4072603">,</span>&nbsp;<span class="ident" id="4072605">errors</span><span class="op" id="4072611">.</span><span class="ident" id="4072612">New</span><span class="op" id="4072615">(</span><span class="string" id="4072616">&#34;x509:&nbsp;unsupported&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4072650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4072654">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4072658">publicKeyAlgorithm</span><span class="op" id="4072676">.</span><span class="ident" id="4072677">Algorithm</span>&nbsp;<span class="op" id="4072687">=</span>&nbsp;<span class="ident" id="4072689">oidPublicKeyECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4072709">var</span>&nbsp;<span class="ident" id="4072713">paramBytes</span>&nbsp;<span class="op" id="4072724">[</span><span class="op" id="4072725">]</span><span class="builtintype" id="4072726">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4072733">paramBytes</span><span class="op" id="4072743">,</span>&nbsp;<span class="ident" id="4072745">err</span>&nbsp;<span class="op" id="4072749">=</span>&nbsp;<span class="ident" id="4072751">asn1</span><span class="op" id="4072755">.</span><span class="ident" id="4072756">Marshal</span><span class="op" id="4072763">(</span><span class="ident" id="4072764">oid</span><span class="op" id="4072767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4072771">if</span>&nbsp;<span class="ident" id="4072774">err</span>&nbsp;<span class="op" id="4072778">!=</span>&nbsp;<span class="ident" id="4072781">nil</span>&nbsp;<span class="op" id="4072785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4072790">return</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4072799">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4072803">publicKeyAlgorithm</span><span class="op" id="4072821">.</span><span class="ident" id="4072822">Parameters</span><span class="op" id="4072832">.</span><span class="ident" id="4072833">FullBytes</span>&nbsp;<span class="op" id="4072843">=</span>&nbsp;<span class="ident" id="4072845">paramBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4072857">default</span><span class="op" id="4072864">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4072868">return</span>&nbsp;<span class="ident" id="4072875">nil</span><span class="op" id="4072878">,</span>&nbsp;<span class="ident" id="4072880">pkix</span><span class="op" id="4072884">.</span><span class="ident" id="4072885">AlgorithmIdentifier</span><span class="op" id="4072904">{</span><span class="op" id="4072905">}</span><span class="op" id="4072906">,</span>&nbsp;<span class="ident" id="4072908">errors</span><span class="op" id="4072914">.</span><span class="ident" id="4072915">New</span><span class="op" id="4072918">(</span><span class="string" id="4072919">&#34;x509:&nbsp;only&nbsp;RSA&nbsp;and&nbsp;ECDSA&nbsp;public&nbsp;keys&nbsp;supported&#34;</span><span class="op" id="4072967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4072970">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4072974">return</span>&nbsp;<span class="ident" id="4072981">publicKeyBytes</span><span class="op" id="4072995">,</span>&nbsp;<span class="ident" id="4072997">publicKeyAlgorithm</span><span class="op" id="4073015">,</span>&nbsp;<span class="ident" id="4073017">nil</span><br>
<span class="lineno"></span><span class="op" id="4073021">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4073024">//&nbsp;MarshalPKIXPublicKey&nbsp;serialises&nbsp;a&nbsp;public&nbsp;key&nbsp;to&nbsp;DER-encoded&nbsp;PKIX&nbsp;format.</span><br>
<span class="lineno">85</span><span class="keyword" id="4073100">func</span>&nbsp;<span class="ident" id="4073105">MarshalPKIXPublicKey</span><span class="op" id="4073125">(</span><span class="ident" id="4073126">pub</span>&nbsp;<span class="keyword" id="4073130">interface</span><span class="op" id="4073139">{</span><span class="op" id="4073140">}</span><span class="op" id="4073141">)</span>&nbsp;<span class="op" id="4073143">(</span><span class="op" id="4073144">[</span><span class="op" id="4073145">]</span><span class="builtintype" id="4073146">byte</span><span class="op" id="4073150">,</span>&nbsp;<span class="builtintype" id="4073152">error</span><span class="op" id="4073157">)</span>&nbsp;<span class="op" id="4073159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4073162">var</span>&nbsp;<span class="ident" id="4073166">publicKeyBytes</span>&nbsp;<span class="op" id="4073181">[</span><span class="op" id="4073182">]</span><span class="builtintype" id="4073183">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4073189">var</span>&nbsp;<span class="ident" id="4073193">publicKeyAlgorithm</span>&nbsp;<span class="ident" id="4073212">pkix</span><span class="op" id="4073216">.</span><span class="ident" id="4073217">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4073238">var</span>&nbsp;<span class="ident" id="4073242">err</span>&nbsp;<span class="builtintype" id="4073246">error</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4073254">if</span>&nbsp;<span class="ident" id="4073257">publicKeyBytes</span><span class="op" id="4073271">,</span>&nbsp;<span class="ident" id="4073273">publicKeyAlgorithm</span><span class="op" id="4073291">,</span>&nbsp;<span class="ident" id="4073293">err</span>&nbsp;<span class="op" id="4073297">=</span>&nbsp;<span class="ident" id="4073299">marshalPublicKey</span><span class="op" id="4073315">(</span><span class="ident" id="4073316">pub</span><span class="op" id="4073319">)</span><span class="op" id="4073320">;</span>&nbsp;<span class="ident" id="4073322">err</span>&nbsp;<span class="op" id="4073326">!=</span>&nbsp;<span class="ident" id="4073329">nil</span>&nbsp;<span class="op" id="4073333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4073337">return</span>&nbsp;<span class="ident" id="4073344">nil</span><span class="op" id="4073347">,</span>&nbsp;<span class="ident" id="4073349">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4073354">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4073358">pkix</span>&nbsp;<span class="op" id="4073363">:=</span>&nbsp;<span class="ident" id="4073366">pkixPublicKey</span><span class="op" id="4073379">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4073383">Algo</span><span class="op" id="4073387">:</span>&nbsp;<span class="ident" id="4073389">publicKeyAlgorithm</span><span class="op" id="4073407">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4073411">BitString</span><span class="op" id="4073420">:</span>&nbsp;<span class="ident" id="4073422">asn1</span><span class="op" id="4073426">.</span><span class="ident" id="4073427">BitString</span><span class="op" id="4073436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4073441">Bytes</span><span class="op" id="4073446">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4073452">publicKeyBytes</span><span class="op" id="4073466">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4073471">BitLength</span><span class="op" id="4073480">:</span>&nbsp;<span class="num" id="4073482">8</span>&nbsp;<span class="op" id="4073484">*</span>&nbsp;<span class="builtinfunc" id="4073486">len</span><span class="op" id="4073489">(</span><span class="ident" id="4073490">publicKeyBytes</span><span class="op" id="4073504">)</span><span class="op" id="4073505">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4073509">}</span><span class="op" id="4073510">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4073513">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4073517">ret</span><span class="op" id="4073520">,</span>&nbsp;<span class="ident" id="4073522">_</span>&nbsp;<span class="op" id="4073524">:=</span>&nbsp;<span class="ident" id="4073527">asn1</span><span class="op" id="4073531">.</span><span class="ident" id="4073532">Marshal</span><span class="op" id="4073539">(</span><span class="ident" id="4073540">pkix</span><span class="op" id="4073544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4073547">return</span>&nbsp;<span class="ident" id="4073554">ret</span><span class="op" id="4073557">,</span>&nbsp;<span class="ident" id="4073559">nil</span><br>
<span class="lineno"></span><span class="op" id="4073563">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="4073566">//&nbsp;These&nbsp;structures&nbsp;reflect&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;X.509&nbsp;certificates.:</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4073639">type</span>&nbsp;<span class="ident" id="4073644">certificate</span>&nbsp;<span class="keyword" id="4073656">struct</span>&nbsp;<span class="op" id="4073663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4073666">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4073685">asn1</span><span class="op" id="4073689">.</span><span class="ident" id="4073690">RawContent</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4073702">TBSCertificate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4073721">tbsCertificate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4073737">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4073756">pkix</span><span class="op" id="4073760">.</span><span class="ident" id="4073761">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4073782">SignatureValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4073801">asn1</span><span class="op" id="4073805">.</span><span class="ident" id="4073806">BitString</span><br>
<span class="lineno"></span><span class="op" id="4073816">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="4073819">type</span>&nbsp;<span class="ident" id="4073824">tbsCertificate</span>&nbsp;<span class="keyword" id="4073839">struct</span>&nbsp;<span class="op" id="4073846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4073849">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4073868">asn1</span><span class="op" id="4073872">.</span><span class="ident" id="4073873">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4073885">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4073904">int</span>&nbsp;<span class="string" id="4073908">`asn1:&#34;optional,explicit,default:1,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4073952">SerialNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4073971">*</span><span class="ident" id="4073972">big</span><span class="op" id="4073975">.</span><span class="ident" id="4073976">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4073981">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4074000">pkix</span><span class="op" id="4074004">.</span><span class="ident" id="4074005">AlgorithmIdentifier</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4074026">Issuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4074045">asn1</span><span class="op" id="4074049">.</span><span class="ident" id="4074050">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4074060">Validity</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4074079">validity</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4074089">Subject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4074108">asn1</span><span class="op" id="4074112">.</span><span class="ident" id="4074113">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4074123">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4074142">publicKeyInfo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4074157">UniqueId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4074176">asn1</span><span class="op" id="4074180">.</span><span class="ident" id="4074181">BitString</span>&nbsp;&nbsp;&nbsp;<span class="string" id="4074193">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4074218">SubjectUniqueId</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4074237">asn1</span><span class="op" id="4074241">.</span><span class="ident" id="4074242">BitString</span>&nbsp;&nbsp;&nbsp;<span class="string" id="4074254">`asn1:&#34;optional,tag:2&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4074279">Extensions</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4074298">[</span><span class="op" id="4074299">]</span><span class="ident" id="4074300">pkix</span><span class="op" id="4074304">.</span><span class="ident" id="4074305">Extension</span>&nbsp;<span class="string" id="4074315">`asn1:&#34;optional,explicit,tag:3&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4074348">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4074351">type</span>&nbsp;<span class="ident" id="4074356">dsaAlgorithmParameters</span>&nbsp;<span class="keyword" id="4074379">struct</span>&nbsp;<span class="op" id="4074386">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4074389">P</span><span class="op" id="4074390">,</span>&nbsp;<span class="ident" id="4074392">Q</span><span class="op" id="4074393">,</span>&nbsp;<span class="ident" id="4074395">G</span>&nbsp;<span class="op" id="4074397">*</span><span class="ident" id="4074398">big</span><span class="op" id="4074401">.</span><span class="ident" id="4074402">Int</span><br>
<span class="lineno"></span><span class="op" id="4074406">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4074409">type</span>&nbsp;<span class="ident" id="4074414">dsaSignature</span>&nbsp;<span class="keyword" id="4074427">struct</span>&nbsp;<span class="op" id="4074434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4074437">R</span><span class="op" id="4074438">,</span>&nbsp;<span class="ident" id="4074440">S</span>&nbsp;<span class="op" id="4074442">*</span><span class="ident" id="4074443">big</span><span class="op" id="4074446">.</span><span class="ident" id="4074447">Int</span><br>
<span class="lineno">135</span><span class="op" id="4074451">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4074454">type</span>&nbsp;<span class="ident" id="4074459">ecdsaSignature</span>&nbsp;<span class="ident" id="4074474">dsaSignature</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4074488">type</span>&nbsp;<span class="ident" id="4074493">validity</span>&nbsp;<span class="keyword" id="4074502">struct</span>&nbsp;<span class="op" id="4074509">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4074512">NotBefore</span><span class="op" id="4074521">,</span>&nbsp;<span class="ident" id="4074523">NotAfter</span>&nbsp;<span class="ident" id="4074532">time</span><span class="op" id="4074536">.</span><span class="ident" id="4074537">Time</span><br>
<span class="lineno"></span><span class="op" id="4074542">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4074545">type</span>&nbsp;<span class="ident" id="4074550">publicKeyInfo</span>&nbsp;<span class="keyword" id="4074564">struct</span>&nbsp;<span class="op" id="4074571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4074574">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4074584">asn1</span><span class="op" id="4074588">.</span><span class="ident" id="4074589">RawContent</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4074601">Algorithm</span>&nbsp;<span class="ident" id="4074611">pkix</span><span class="op" id="4074615">.</span><span class="ident" id="4074616">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4074637">PublicKey</span>&nbsp;<span class="ident" id="4074647">asn1</span><span class="op" id="4074651">.</span><span class="ident" id="4074652">BitString</span><br>
<span class="lineno"></span><span class="op" id="4074662">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4074665">//&nbsp;RFC&nbsp;5280,&nbsp;&nbsp;4.2.1.1</span><br>
<span class="lineno">150</span><span class="keyword" id="4074687">type</span>&nbsp;<span class="ident" id="4074692">authKeyId</span>&nbsp;<span class="keyword" id="4074702">struct</span>&nbsp;<span class="op" id="4074709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4074712">Id</span>&nbsp;<span class="op" id="4074715">[</span><span class="op" id="4074716">]</span><span class="builtintype" id="4074717">byte</span>&nbsp;<span class="string" id="4074722">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4074746">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4074749">type</span>&nbsp;<span class="ident" id="4074754">SignatureAlgorithm</span>&nbsp;<span class="builtintype" id="4074773">int</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="keyword" id="4074778">const</span>&nbsp;<span class="op" id="4074784">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4074787">UnknownSignatureAlgorithm</span>&nbsp;<span class="ident" id="4074813">SignatureAlgorithm</span>&nbsp;<span class="op" id="4074832">=</span>&nbsp;<span class="ident" id="4074834">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4074840">MD2WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4074852">MD5WithRSA</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4074864">SHA1WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4074877">SHA256WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4074892">SHA384WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4074907">SHA512WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4074922">DSAWithSHA1</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4074935">DSAWithSHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4074950">ECDSAWithSHA1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4074965">ECDSAWithSHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4074982">ECDSAWithSHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4074999">ECDSAWithSHA512</span><br>
<span class="lineno">170</span><span class="op" id="4075015">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4075018">type</span>&nbsp;<span class="ident" id="4075023">PublicKeyAlgorithm</span>&nbsp;<span class="builtintype" id="4075042">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4075047">const</span>&nbsp;<span class="op" id="4075053">(</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4075056">UnknownPublicKeyAlgorithm</span>&nbsp;<span class="ident" id="4075082">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="4075101">=</span>&nbsp;<span class="ident" id="4075103">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4075109">RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4075114">DSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4075119">ECDSA</span><br>
<span class="lineno"></span><span class="op" id="4075125">)</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="comment" id="4075128">//&nbsp;OIDs&nbsp;for&nbsp;signature&nbsp;algorithms</span><br>
<span class="lineno"></span><span class="comment" id="4075161">//</span><br>
<span class="lineno"></span><span class="comment" id="4075164">//&nbsp;pkcs-1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4075198">//&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;rsadsi(113549)&nbsp;pkcs(1)&nbsp;1&nbsp;}</span><br>
<span class="lineno">185</span><span class="comment" id="4075261">//</span><br>
<span class="lineno"></span><span class="comment" id="4075264">//</span><br>
<span class="lineno"></span><span class="comment" id="4075267">//&nbsp;RFC&nbsp;3279&nbsp;2.2.1&nbsp;RSA&nbsp;Signature&nbsp;Algorithms</span><br>
<span class="lineno"></span><span class="comment" id="4075310">//</span><br>
<span class="lineno"></span><span class="comment" id="4075313">//&nbsp;md2WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;2&nbsp;}</span><br>
<span class="lineno">190</span><span class="comment" id="4075372">//</span><br>
<span class="lineno"></span><span class="comment" id="4075375">//&nbsp;md5WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;4&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4075434">//</span><br>
<span class="lineno"></span><span class="comment" id="4075437">//&nbsp;sha-1WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;5&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4075498">//</span><br>
<span class="lineno">195</span><span class="comment" id="4075501">//&nbsp;dsaWithSha1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4075540">//&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;x9-57(10040)&nbsp;x9cm(4)&nbsp;3&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4075601">//</span><br>
<span class="lineno"></span><span class="comment" id="4075604">//&nbsp;RFC&nbsp;3279&nbsp;2.2.3&nbsp;ECDSA&nbsp;Signature&nbsp;Algorithm</span><br>
<span class="lineno"></span><span class="comment" id="4075648">//</span><br>
<span class="lineno">200</span><span class="comment" id="4075651">//&nbsp;ecdsa-with-SHA1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4075694">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;ansi-x962(10045)</span><br>
<span class="lineno"></span><span class="comment" id="4075747">//&nbsp;&nbsp;&nbsp;&nbsp;signatures(4)&nbsp;ecdsa-with-SHA1(1)}</span><br>
<span class="lineno"></span><span class="comment" id="4075787">//</span><br>
<span class="lineno"></span><span class="comment" id="4075790">//</span><br>
<span class="lineno">205</span><span class="comment" id="4075793">//&nbsp;RFC&nbsp;4055&nbsp;5&nbsp;PKCS&nbsp;#1&nbsp;Version&nbsp;1.5</span><br>
<span class="lineno"></span><span class="comment" id="4075827">//</span><br>
<span class="lineno"></span><span class="comment" id="4075830">//&nbsp;sha256WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;11&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4075893">//</span><br>
<span class="lineno"></span><span class="comment" id="4075896">//&nbsp;sha384WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;12&nbsp;}</span><br>
<span class="lineno">210</span><span class="comment" id="4075959">//</span><br>
<span class="lineno"></span><span class="comment" id="4075962">//&nbsp;sha512WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;13&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4076025">//</span><br>
<span class="lineno"></span><span class="comment" id="4076028">//</span><br>
<span class="lineno"></span><span class="comment" id="4076031">//&nbsp;RFC&nbsp;5758&nbsp;3.1&nbsp;DSA&nbsp;Signature&nbsp;Algorithms</span><br>
<span class="lineno">215</span><span class="comment" id="4076072">//</span><br>
<span class="lineno"></span><span class="comment" id="4076075">//&nbsp;dsaWithSha256&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4076116">//&nbsp;&nbsp;&nbsp;&nbsp;joint-iso-ccitt(2)&nbsp;country(16)&nbsp;us(840)&nbsp;organization(1)&nbsp;gov(101)</span><br>
<span class="lineno"></span><span class="comment" id="4076186">//&nbsp;&nbsp;&nbsp;&nbsp;csor(3)&nbsp;algorithms(4)&nbsp;id-dsa-with-sha2(3)&nbsp;2}</span><br>
<span class="lineno"></span><span class="comment" id="4076237">//</span><br>
<span class="lineno">220</span><span class="comment" id="4076240">//&nbsp;RFC&nbsp;5758&nbsp;3.2&nbsp;ECDSA&nbsp;Signature&nbsp;Algorithm</span><br>
<span class="lineno"></span><span class="comment" id="4076282">//</span><br>
<span class="lineno"></span><span class="comment" id="4076285">//&nbsp;ecdsa-with-SHA256&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)</span><br>
<span class="lineno"></span><span class="comment" id="4076352">//&nbsp;&nbsp;&nbsp;&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;signatures(4)&nbsp;ecdsa-with-SHA2(3)&nbsp;2&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4076421">//</span><br>
<span class="lineno">225</span><span class="comment" id="4076424">//&nbsp;ecdsa-with-SHA384&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)</span><br>
<span class="lineno"></span><span class="comment" id="4076491">//&nbsp;&nbsp;&nbsp;&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;signatures(4)&nbsp;ecdsa-with-SHA2(3)&nbsp;3&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4076560">//</span><br>
<span class="lineno"></span><span class="comment" id="4076563">//&nbsp;ecdsa-with-SHA512&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)</span><br>
<span class="lineno"></span><span class="comment" id="4076630">//&nbsp;&nbsp;&nbsp;&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;signatures(4)&nbsp;ecdsa-with-SHA2(3)&nbsp;4&nbsp;}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="4076700">var</span>&nbsp;<span class="op" id="4076704">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4076707">oidSignatureMD2WithRSA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4076735">=</span>&nbsp;<span class="ident" id="4076737">asn1</span><span class="op" id="4076741">.</span><span class="ident" id="4076742">ObjectIdentifier</span><span class="op" id="4076758">{</span><span class="num" id="4076759">1</span><span class="op" id="4076760">,</span>&nbsp;<span class="num" id="4076762">2</span><span class="op" id="4076763">,</span>&nbsp;<span class="num" id="4076765">840</span><span class="op" id="4076768">,</span>&nbsp;<span class="num" id="4076770">113549</span><span class="op" id="4076776">,</span>&nbsp;<span class="num" id="4076778">1</span><span class="op" id="4076779">,</span>&nbsp;<span class="num" id="4076781">1</span><span class="op" id="4076782">,</span>&nbsp;<span class="num" id="4076784">2</span><span class="op" id="4076785">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4076788">oidSignatureMD5WithRSA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4076816">=</span>&nbsp;<span class="ident" id="4076818">asn1</span><span class="op" id="4076822">.</span><span class="ident" id="4076823">ObjectIdentifier</span><span class="op" id="4076839">{</span><span class="num" id="4076840">1</span><span class="op" id="4076841">,</span>&nbsp;<span class="num" id="4076843">2</span><span class="op" id="4076844">,</span>&nbsp;<span class="num" id="4076846">840</span><span class="op" id="4076849">,</span>&nbsp;<span class="num" id="4076851">113549</span><span class="op" id="4076857">,</span>&nbsp;<span class="num" id="4076859">1</span><span class="op" id="4076860">,</span>&nbsp;<span class="num" id="4076862">1</span><span class="op" id="4076863">,</span>&nbsp;<span class="num" id="4076865">4</span><span class="op" id="4076866">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4076869">oidSignatureSHA1WithRSA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4076897">=</span>&nbsp;<span class="ident" id="4076899">asn1</span><span class="op" id="4076903">.</span><span class="ident" id="4076904">ObjectIdentifier</span><span class="op" id="4076920">{</span><span class="num" id="4076921">1</span><span class="op" id="4076922">,</span>&nbsp;<span class="num" id="4076924">2</span><span class="op" id="4076925">,</span>&nbsp;<span class="num" id="4076927">840</span><span class="op" id="4076930">,</span>&nbsp;<span class="num" id="4076932">113549</span><span class="op" id="4076938">,</span>&nbsp;<span class="num" id="4076940">1</span><span class="op" id="4076941">,</span>&nbsp;<span class="num" id="4076943">1</span><span class="op" id="4076944">,</span>&nbsp;<span class="num" id="4076946">5</span><span class="op" id="4076947">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4076950">oidSignatureSHA256WithRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4076978">=</span>&nbsp;<span class="ident" id="4076980">asn1</span><span class="op" id="4076984">.</span><span class="ident" id="4076985">ObjectIdentifier</span><span class="op" id="4077001">{</span><span class="num" id="4077002">1</span><span class="op" id="4077003">,</span>&nbsp;<span class="num" id="4077005">2</span><span class="op" id="4077006">,</span>&nbsp;<span class="num" id="4077008">840</span><span class="op" id="4077011">,</span>&nbsp;<span class="num" id="4077013">113549</span><span class="op" id="4077019">,</span>&nbsp;<span class="num" id="4077021">1</span><span class="op" id="4077022">,</span>&nbsp;<span class="num" id="4077024">1</span><span class="op" id="4077025">,</span>&nbsp;<span class="num" id="4077027">11</span><span class="op" id="4077029">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4077032">oidSignatureSHA384WithRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4077060">=</span>&nbsp;<span class="ident" id="4077062">asn1</span><span class="op" id="4077066">.</span><span class="ident" id="4077067">ObjectIdentifier</span><span class="op" id="4077083">{</span><span class="num" id="4077084">1</span><span class="op" id="4077085">,</span>&nbsp;<span class="num" id="4077087">2</span><span class="op" id="4077088">,</span>&nbsp;<span class="num" id="4077090">840</span><span class="op" id="4077093">,</span>&nbsp;<span class="num" id="4077095">113549</span><span class="op" id="4077101">,</span>&nbsp;<span class="num" id="4077103">1</span><span class="op" id="4077104">,</span>&nbsp;<span class="num" id="4077106">1</span><span class="op" id="4077107">,</span>&nbsp;<span class="num" id="4077109">12</span><span class="op" id="4077111">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4077114">oidSignatureSHA512WithRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4077142">=</span>&nbsp;<span class="ident" id="4077144">asn1</span><span class="op" id="4077148">.</span><span class="ident" id="4077149">ObjectIdentifier</span><span class="op" id="4077165">{</span><span class="num" id="4077166">1</span><span class="op" id="4077167">,</span>&nbsp;<span class="num" id="4077169">2</span><span class="op" id="4077170">,</span>&nbsp;<span class="num" id="4077172">840</span><span class="op" id="4077175">,</span>&nbsp;<span class="num" id="4077177">113549</span><span class="op" id="4077183">,</span>&nbsp;<span class="num" id="4077185">1</span><span class="op" id="4077186">,</span>&nbsp;<span class="num" id="4077188">1</span><span class="op" id="4077189">,</span>&nbsp;<span class="num" id="4077191">13</span><span class="op" id="4077193">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4077196">oidSignatureDSAWithSHA1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4077224">=</span>&nbsp;<span class="ident" id="4077226">asn1</span><span class="op" id="4077230">.</span><span class="ident" id="4077231">ObjectIdentifier</span><span class="op" id="4077247">{</span><span class="num" id="4077248">1</span><span class="op" id="4077249">,</span>&nbsp;<span class="num" id="4077251">2</span><span class="op" id="4077252">,</span>&nbsp;<span class="num" id="4077254">840</span><span class="op" id="4077257">,</span>&nbsp;<span class="num" id="4077259">10040</span><span class="op" id="4077264">,</span>&nbsp;<span class="num" id="4077266">4</span><span class="op" id="4077267">,</span>&nbsp;<span class="num" id="4077269">3</span><span class="op" id="4077270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4077273">oidSignatureDSAWithSHA256</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4077301">=</span>&nbsp;<span class="ident" id="4077303">asn1</span><span class="op" id="4077307">.</span><span class="ident" id="4077308">ObjectIdentifier</span><span class="op" id="4077324">{</span><span class="num" id="4077325">2</span><span class="op" id="4077326">,</span>&nbsp;<span class="num" id="4077328">16</span><span class="op" id="4077330">,</span>&nbsp;<span class="num" id="4077332">840</span><span class="op" id="4077335">,</span>&nbsp;<span class="num" id="4077337">1</span><span class="op" id="4077338">,</span>&nbsp;<span class="num" id="4077340">101</span><span class="op" id="4077343">,</span>&nbsp;<span class="num" id="4077345">4</span><span class="op" id="4077346">,</span>&nbsp;<span class="num" id="4077348">3</span><span class="op" id="4077349">,</span>&nbsp;<span class="num" id="4077351">2</span><span class="op" id="4077352">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4077355">oidSignatureECDSAWithSHA1</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4077383">=</span>&nbsp;<span class="ident" id="4077385">asn1</span><span class="op" id="4077389">.</span><span class="ident" id="4077390">ObjectIdentifier</span><span class="op" id="4077406">{</span><span class="num" id="4077407">1</span><span class="op" id="4077408">,</span>&nbsp;<span class="num" id="4077410">2</span><span class="op" id="4077411">,</span>&nbsp;<span class="num" id="4077413">840</span><span class="op" id="4077416">,</span>&nbsp;<span class="num" id="4077418">10045</span><span class="op" id="4077423">,</span>&nbsp;<span class="num" id="4077425">4</span><span class="op" id="4077426">,</span>&nbsp;<span class="num" id="4077428">1</span><span class="op" id="4077429">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4077432">oidSignatureECDSAWithSHA256</span>&nbsp;<span class="op" id="4077460">=</span>&nbsp;<span class="ident" id="4077462">asn1</span><span class="op" id="4077466">.</span><span class="ident" id="4077467">ObjectIdentifier</span><span class="op" id="4077483">{</span><span class="num" id="4077484">1</span><span class="op" id="4077485">,</span>&nbsp;<span class="num" id="4077487">2</span><span class="op" id="4077488">,</span>&nbsp;<span class="num" id="4077490">840</span><span class="op" id="4077493">,</span>&nbsp;<span class="num" id="4077495">10045</span><span class="op" id="4077500">,</span>&nbsp;<span class="num" id="4077502">4</span><span class="op" id="4077503">,</span>&nbsp;<span class="num" id="4077505">3</span><span class="op" id="4077506">,</span>&nbsp;<span class="num" id="4077508">2</span><span class="op" id="4077509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4077512">oidSignatureECDSAWithSHA384</span>&nbsp;<span class="op" id="4077540">=</span>&nbsp;<span class="ident" id="4077542">asn1</span><span class="op" id="4077546">.</span><span class="ident" id="4077547">ObjectIdentifier</span><span class="op" id="4077563">{</span><span class="num" id="4077564">1</span><span class="op" id="4077565">,</span>&nbsp;<span class="num" id="4077567">2</span><span class="op" id="4077568">,</span>&nbsp;<span class="num" id="4077570">840</span><span class="op" id="4077573">,</span>&nbsp;<span class="num" id="4077575">10045</span><span class="op" id="4077580">,</span>&nbsp;<span class="num" id="4077582">4</span><span class="op" id="4077583">,</span>&nbsp;<span class="num" id="4077585">3</span><span class="op" id="4077586">,</span>&nbsp;<span class="num" id="4077588">3</span><span class="op" id="4077589">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4077592">oidSignatureECDSAWithSHA512</span>&nbsp;<span class="op" id="4077620">=</span>&nbsp;<span class="ident" id="4077622">asn1</span><span class="op" id="4077626">.</span><span class="ident" id="4077627">ObjectIdentifier</span><span class="op" id="4077643">{</span><span class="num" id="4077644">1</span><span class="op" id="4077645">,</span>&nbsp;<span class="num" id="4077647">2</span><span class="op" id="4077648">,</span>&nbsp;<span class="num" id="4077650">840</span><span class="op" id="4077653">,</span>&nbsp;<span class="num" id="4077655">10045</span><span class="op" id="4077660">,</span>&nbsp;<span class="num" id="4077662">4</span><span class="op" id="4077663">,</span>&nbsp;<span class="num" id="4077665">3</span><span class="op" id="4077666">,</span>&nbsp;<span class="num" id="4077668">4</span><span class="op" id="4077669">}</span><br>
<span class="lineno"></span><span class="op" id="4077671">)</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="keyword" id="4077674">var</span>&nbsp;<span class="ident" id="4077678">signatureAlgorithmDetails</span>&nbsp;<span class="op" id="4077704">=</span>&nbsp;<span class="op" id="4077706">[</span><span class="op" id="4077707">]</span><span class="keyword" id="4077708">struct</span>&nbsp;<span class="op" id="4077715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4077718">algo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4077729">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4077749">oid</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4077760">asn1</span><span class="op" id="4077764">.</span><span class="ident" id="4077765">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4077783">pubKeyAlgo</span>&nbsp;<span class="ident" id="4077794">PublicKeyAlgorithm</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4077814">hash</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4077825">crypto</span><span class="op" id="4077831">.</span><span class="ident" id="4077832">Hash</span><br>
<span class="lineno"></span><span class="op" id="4077837">}</span><span class="op" id="4077838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4077841">{</span><span class="ident" id="4077842">MD2WithRSA</span><span class="op" id="4077852">,</span>&nbsp;<span class="ident" id="4077854">oidSignatureMD2WithRSA</span><span class="op" id="4077876">,</span>&nbsp;<span class="ident" id="4077878">RSA</span><span class="op" id="4077881">,</span>&nbsp;<span class="ident" id="4077883">crypto</span><span class="op" id="4077889">.</span><span class="ident" id="4077890">Hash</span><span class="op" id="4077894">(</span><span class="num" id="4077895">0</span><span class="op" id="4077896">)</span>&nbsp;<span class="comment" id="4077898">/*&nbsp;no&nbsp;value&nbsp;for&nbsp;MD2&nbsp;*/</span><span class="op" id="4077920">}</span><span class="op" id="4077921">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4077924">{</span><span class="ident" id="4077925">MD5WithRSA</span><span class="op" id="4077935">,</span>&nbsp;<span class="ident" id="4077937">oidSignatureMD5WithRSA</span><span class="op" id="4077959">,</span>&nbsp;<span class="ident" id="4077961">RSA</span><span class="op" id="4077964">,</span>&nbsp;<span class="ident" id="4077966">crypto</span><span class="op" id="4077972">.</span><span class="ident" id="4077973">MD5</span><span class="op" id="4077976">}</span><span class="op" id="4077977">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4077980">{</span><span class="ident" id="4077981">SHA1WithRSA</span><span class="op" id="4077992">,</span>&nbsp;<span class="ident" id="4077994">oidSignatureSHA1WithRSA</span><span class="op" id="4078017">,</span>&nbsp;<span class="ident" id="4078019">RSA</span><span class="op" id="4078022">,</span>&nbsp;<span class="ident" id="4078024">crypto</span><span class="op" id="4078030">.</span><span class="ident" id="4078031">SHA1</span><span class="op" id="4078035">}</span><span class="op" id="4078036">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4078039">{</span><span class="ident" id="4078040">SHA256WithRSA</span><span class="op" id="4078053">,</span>&nbsp;<span class="ident" id="4078055">oidSignatureSHA256WithRSA</span><span class="op" id="4078080">,</span>&nbsp;<span class="ident" id="4078082">RSA</span><span class="op" id="4078085">,</span>&nbsp;<span class="ident" id="4078087">crypto</span><span class="op" id="4078093">.</span><span class="ident" id="4078094">SHA256</span><span class="op" id="4078100">}</span><span class="op" id="4078101">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4078104">{</span><span class="ident" id="4078105">SHA384WithRSA</span><span class="op" id="4078118">,</span>&nbsp;<span class="ident" id="4078120">oidSignatureSHA384WithRSA</span><span class="op" id="4078145">,</span>&nbsp;<span class="ident" id="4078147">RSA</span><span class="op" id="4078150">,</span>&nbsp;<span class="ident" id="4078152">crypto</span><span class="op" id="4078158">.</span><span class="ident" id="4078159">SHA384</span><span class="op" id="4078165">}</span><span class="op" id="4078166">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4078169">{</span><span class="ident" id="4078170">SHA512WithRSA</span><span class="op" id="4078183">,</span>&nbsp;<span class="ident" id="4078185">oidSignatureSHA512WithRSA</span><span class="op" id="4078210">,</span>&nbsp;<span class="ident" id="4078212">RSA</span><span class="op" id="4078215">,</span>&nbsp;<span class="ident" id="4078217">crypto</span><span class="op" id="4078223">.</span><span class="ident" id="4078224">SHA512</span><span class="op" id="4078230">}</span><span class="op" id="4078231">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4078234">{</span><span class="ident" id="4078235">DSAWithSHA1</span><span class="op" id="4078246">,</span>&nbsp;<span class="ident" id="4078248">oidSignatureDSAWithSHA1</span><span class="op" id="4078271">,</span>&nbsp;<span class="ident" id="4078273">DSA</span><span class="op" id="4078276">,</span>&nbsp;<span class="ident" id="4078278">crypto</span><span class="op" id="4078284">.</span><span class="ident" id="4078285">SHA1</span><span class="op" id="4078289">}</span><span class="op" id="4078290">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4078293">{</span><span class="ident" id="4078294">DSAWithSHA256</span><span class="op" id="4078307">,</span>&nbsp;<span class="ident" id="4078309">oidSignatureDSAWithSHA256</span><span class="op" id="4078334">,</span>&nbsp;<span class="ident" id="4078336">DSA</span><span class="op" id="4078339">,</span>&nbsp;<span class="ident" id="4078341">crypto</span><span class="op" id="4078347">.</span><span class="ident" id="4078348">SHA256</span><span class="op" id="4078354">}</span><span class="op" id="4078355">,</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4078358">{</span><span class="ident" id="4078359">ECDSAWithSHA1</span><span class="op" id="4078372">,</span>&nbsp;<span class="ident" id="4078374">oidSignatureECDSAWithSHA1</span><span class="op" id="4078399">,</span>&nbsp;<span class="ident" id="4078401">ECDSA</span><span class="op" id="4078406">,</span>&nbsp;<span class="ident" id="4078408">crypto</span><span class="op" id="4078414">.</span><span class="ident" id="4078415">SHA1</span><span class="op" id="4078419">}</span><span class="op" id="4078420">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4078423">{</span><span class="ident" id="4078424">ECDSAWithSHA256</span><span class="op" id="4078439">,</span>&nbsp;<span class="ident" id="4078441">oidSignatureECDSAWithSHA256</span><span class="op" id="4078468">,</span>&nbsp;<span class="ident" id="4078470">ECDSA</span><span class="op" id="4078475">,</span>&nbsp;<span class="ident" id="4078477">crypto</span><span class="op" id="4078483">.</span><span class="ident" id="4078484">SHA256</span><span class="op" id="4078490">}</span><span class="op" id="4078491">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4078494">{</span><span class="ident" id="4078495">ECDSAWithSHA384</span><span class="op" id="4078510">,</span>&nbsp;<span class="ident" id="4078512">oidSignatureECDSAWithSHA384</span><span class="op" id="4078539">,</span>&nbsp;<span class="ident" id="4078541">ECDSA</span><span class="op" id="4078546">,</span>&nbsp;<span class="ident" id="4078548">crypto</span><span class="op" id="4078554">.</span><span class="ident" id="4078555">SHA384</span><span class="op" id="4078561">}</span><span class="op" id="4078562">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4078565">{</span><span class="ident" id="4078566">ECDSAWithSHA512</span><span class="op" id="4078581">,</span>&nbsp;<span class="ident" id="4078583">oidSignatureECDSAWithSHA512</span><span class="op" id="4078610">,</span>&nbsp;<span class="ident" id="4078612">ECDSA</span><span class="op" id="4078617">,</span>&nbsp;<span class="ident" id="4078619">crypto</span><span class="op" id="4078625">.</span><span class="ident" id="4078626">SHA512</span><span class="op" id="4078632">}</span><span class="op" id="4078633">,</span><br>
<span class="lineno"></span><span class="op" id="4078635">}</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span><span class="keyword" id="4078638">func</span>&nbsp;<span class="ident" id="4078643">getSignatureAlgorithmFromOID</span><span class="op" id="4078671">(</span><span class="ident" id="4078672">oid</span>&nbsp;<span class="ident" id="4078676">asn1</span><span class="op" id="4078680">.</span><span class="ident" id="4078681">ObjectIdentifier</span><span class="op" id="4078697">)</span>&nbsp;<span class="ident" id="4078699">SignatureAlgorithm</span>&nbsp;<span class="op" id="4078718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4078721">for</span>&nbsp;<span class="ident" id="4078725">_</span><span class="op" id="4078726">,</span>&nbsp;<span class="ident" id="4078728">details</span>&nbsp;<span class="op" id="4078736">:=</span>&nbsp;<span class="keyword" id="4078739">range</span>&nbsp;<span class="ident" id="4078745">signatureAlgorithmDetails</span>&nbsp;<span class="op" id="4078771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4078775">if</span>&nbsp;<span class="ident" id="4078778">oid</span><span class="op" id="4078781">.</span><span class="ident" id="4078782">Equal</span><span class="op" id="4078787">(</span><span class="ident" id="4078788">details</span><span class="op" id="4078795">.</span><span class="ident" id="4078796">oid</span><span class="op" id="4078799">)</span>&nbsp;<span class="op" id="4078801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4078806">return</span>&nbsp;<span class="ident" id="4078813">details</span><span class="op" id="4078820">.</span><span class="ident" id="4078821">algo</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4078828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4078831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4078834">return</span>&nbsp;<span class="ident" id="4078841">UnknownSignatureAlgorithm</span><br>
<span class="lineno"></span><span class="op" id="4078867">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span><span class="comment" id="4078870">//&nbsp;RFC&nbsp;3279,&nbsp;2.3&nbsp;Public&nbsp;Key&nbsp;Algorithms</span><br>
<span class="lineno"></span><span class="comment" id="4078909">//</span><br>
<span class="lineno"></span><span class="comment" id="4078912">//&nbsp;pkcs-1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::==&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)</span><br>
<span class="lineno"></span><span class="comment" id="4078977">//&nbsp;&nbsp;&nbsp;&nbsp;rsadsi(113549)&nbsp;pkcs(1)&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4079010">//</span><br>
<span class="lineno">280</span><span class="comment" id="4079013">//&nbsp;rsaEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::==&nbsp;{&nbsp;pkcs1-1&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4079067">//</span><br>
<span class="lineno"></span><span class="comment" id="4079070">//&nbsp;id-dsa&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::==&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)</span><br>
<span class="lineno"></span><span class="comment" id="4079135">//&nbsp;&nbsp;&nbsp;&nbsp;x9-57(10040)&nbsp;x9cm(4)&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4079166">//</span><br>
<span class="lineno">285</span><span class="comment" id="4079169">//&nbsp;RFC&nbsp;5480,&nbsp;2.1.1&nbsp;Unrestricted&nbsp;Algorithm&nbsp;Identifier&nbsp;and&nbsp;Parameters</span><br>
<span class="lineno"></span><span class="comment" id="4079237">//</span><br>
<span class="lineno"></span><span class="comment" id="4079240">//&nbsp;id-ecPublicKey&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4079282">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;keyType(2)&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="keyword" id="4079354">var</span>&nbsp;<span class="op" id="4079358">(</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4079361">oidPublicKeyRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4079379">=</span>&nbsp;<span class="ident" id="4079381">asn1</span><span class="op" id="4079385">.</span><span class="ident" id="4079386">ObjectIdentifier</span><span class="op" id="4079402">{</span><span class="num" id="4079403">1</span><span class="op" id="4079404">,</span>&nbsp;<span class="num" id="4079406">2</span><span class="op" id="4079407">,</span>&nbsp;<span class="num" id="4079409">840</span><span class="op" id="4079412">,</span>&nbsp;<span class="num" id="4079414">113549</span><span class="op" id="4079420">,</span>&nbsp;<span class="num" id="4079422">1</span><span class="op" id="4079423">,</span>&nbsp;<span class="num" id="4079425">1</span><span class="op" id="4079426">,</span>&nbsp;<span class="num" id="4079428">1</span><span class="op" id="4079429">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4079432">oidPublicKeyDSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4079450">=</span>&nbsp;<span class="ident" id="4079452">asn1</span><span class="op" id="4079456">.</span><span class="ident" id="4079457">ObjectIdentifier</span><span class="op" id="4079473">{</span><span class="num" id="4079474">1</span><span class="op" id="4079475">,</span>&nbsp;<span class="num" id="4079477">2</span><span class="op" id="4079478">,</span>&nbsp;<span class="num" id="4079480">840</span><span class="op" id="4079483">,</span>&nbsp;<span class="num" id="4079485">10040</span><span class="op" id="4079490">,</span>&nbsp;<span class="num" id="4079492">4</span><span class="op" id="4079493">,</span>&nbsp;<span class="num" id="4079495">1</span><span class="op" id="4079496">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4079499">oidPublicKeyECDSA</span>&nbsp;<span class="op" id="4079517">=</span>&nbsp;<span class="ident" id="4079519">asn1</span><span class="op" id="4079523">.</span><span class="ident" id="4079524">ObjectIdentifier</span><span class="op" id="4079540">{</span><span class="num" id="4079541">1</span><span class="op" id="4079542">,</span>&nbsp;<span class="num" id="4079544">2</span><span class="op" id="4079545">,</span>&nbsp;<span class="num" id="4079547">840</span><span class="op" id="4079550">,</span>&nbsp;<span class="num" id="4079552">10045</span><span class="op" id="4079557">,</span>&nbsp;<span class="num" id="4079559">2</span><span class="op" id="4079560">,</span>&nbsp;<span class="num" id="4079562">1</span><span class="op" id="4079563">}</span><br>
<span class="lineno"></span><span class="op" id="4079565">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span><span class="keyword" id="4079568">func</span>&nbsp;<span class="ident" id="4079573">getPublicKeyAlgorithmFromOID</span><span class="op" id="4079601">(</span><span class="ident" id="4079602">oid</span>&nbsp;<span class="ident" id="4079606">asn1</span><span class="op" id="4079610">.</span><span class="ident" id="4079611">ObjectIdentifier</span><span class="op" id="4079627">)</span>&nbsp;<span class="ident" id="4079629">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="4079648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4079651">switch</span>&nbsp;<span class="op" id="4079658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4079661">case</span>&nbsp;<span class="ident" id="4079666">oid</span><span class="op" id="4079669">.</span><span class="ident" id="4079670">Equal</span><span class="op" id="4079675">(</span><span class="ident" id="4079676">oidPublicKeyRSA</span><span class="op" id="4079691">)</span><span class="op" id="4079692">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4079696">return</span>&nbsp;<span class="ident" id="4079703">RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4079708">case</span>&nbsp;<span class="ident" id="4079713">oid</span><span class="op" id="4079716">.</span><span class="ident" id="4079717">Equal</span><span class="op" id="4079722">(</span><span class="ident" id="4079723">oidPublicKeyDSA</span><span class="op" id="4079738">)</span><span class="op" id="4079739">:</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4079743">return</span>&nbsp;<span class="ident" id="4079750">DSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4079755">case</span>&nbsp;<span class="ident" id="4079760">oid</span><span class="op" id="4079763">.</span><span class="ident" id="4079764">Equal</span><span class="op" id="4079769">(</span><span class="ident" id="4079770">oidPublicKeyECDSA</span><span class="op" id="4079787">)</span><span class="op" id="4079788">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4079792">return</span>&nbsp;<span class="ident" id="4079799">ECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4079806">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4079809">return</span>&nbsp;<span class="ident" id="4079816">UnknownPublicKeyAlgorithm</span><br>
<span class="lineno">305</span><span class="op" id="4079842">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4079845">//&nbsp;RFC&nbsp;5480,&nbsp;2.1.1.1.&nbsp;Named&nbsp;Curve</span><br>
<span class="lineno"></span><span class="comment" id="4079879">//</span><br>
<span class="lineno"></span><span class="comment" id="4079882">//&nbsp;secp224r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno">310</span><span class="comment" id="4079919">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;identified-organization(3)&nbsp;certicom(132)&nbsp;curve(0)&nbsp;33&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4079986">//</span><br>
<span class="lineno"></span><span class="comment" id="4079989">//&nbsp;secp256r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4080026">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;curves(3)</span><br>
<span class="lineno"></span><span class="comment" id="4080089">//&nbsp;&nbsp;&nbsp;prime(1)&nbsp;7&nbsp;}</span><br>
<span class="lineno">315</span><span class="comment" id="4080107">//</span><br>
<span class="lineno"></span><span class="comment" id="4080110">//&nbsp;secp384r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4080147">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;identified-organization(3)&nbsp;certicom(132)&nbsp;curve(0)&nbsp;34&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4080214">//</span><br>
<span class="lineno"></span><span class="comment" id="4080217">//&nbsp;secp521r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno">320</span><span class="comment" id="4080254">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;identified-organization(3)&nbsp;certicom(132)&nbsp;curve(0)&nbsp;35&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4080321">//</span><br>
<span class="lineno"></span><span class="comment" id="4080324">//&nbsp;NB:&nbsp;secp256r1&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;prime256v1</span><br>
<span class="lineno"></span><span class="keyword" id="4080369">var</span>&nbsp;<span class="op" id="4080373">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4080376">oidNamedCurveP224</span>&nbsp;<span class="op" id="4080394">=</span>&nbsp;<span class="ident" id="4080396">asn1</span><span class="op" id="4080400">.</span><span class="ident" id="4080401">ObjectIdentifier</span><span class="op" id="4080417">{</span><span class="num" id="4080418">1</span><span class="op" id="4080419">,</span>&nbsp;<span class="num" id="4080421">3</span><span class="op" id="4080422">,</span>&nbsp;<span class="num" id="4080424">132</span><span class="op" id="4080427">,</span>&nbsp;<span class="num" id="4080429">0</span><span class="op" id="4080430">,</span>&nbsp;<span class="num" id="4080432">33</span><span class="op" id="4080434">}</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4080437">oidNamedCurveP256</span>&nbsp;<span class="op" id="4080455">=</span>&nbsp;<span class="ident" id="4080457">asn1</span><span class="op" id="4080461">.</span><span class="ident" id="4080462">ObjectIdentifier</span><span class="op" id="4080478">{</span><span class="num" id="4080479">1</span><span class="op" id="4080480">,</span>&nbsp;<span class="num" id="4080482">2</span><span class="op" id="4080483">,</span>&nbsp;<span class="num" id="4080485">840</span><span class="op" id="4080488">,</span>&nbsp;<span class="num" id="4080490">10045</span><span class="op" id="4080495">,</span>&nbsp;<span class="num" id="4080497">3</span><span class="op" id="4080498">,</span>&nbsp;<span class="num" id="4080500">1</span><span class="op" id="4080501">,</span>&nbsp;<span class="num" id="4080503">7</span><span class="op" id="4080504">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4080507">oidNamedCurveP384</span>&nbsp;<span class="op" id="4080525">=</span>&nbsp;<span class="ident" id="4080527">asn1</span><span class="op" id="4080531">.</span><span class="ident" id="4080532">ObjectIdentifier</span><span class="op" id="4080548">{</span><span class="num" id="4080549">1</span><span class="op" id="4080550">,</span>&nbsp;<span class="num" id="4080552">3</span><span class="op" id="4080553">,</span>&nbsp;<span class="num" id="4080555">132</span><span class="op" id="4080558">,</span>&nbsp;<span class="num" id="4080560">0</span><span class="op" id="4080561">,</span>&nbsp;<span class="num" id="4080563">34</span><span class="op" id="4080565">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4080568">oidNamedCurveP521</span>&nbsp;<span class="op" id="4080586">=</span>&nbsp;<span class="ident" id="4080588">asn1</span><span class="op" id="4080592">.</span><span class="ident" id="4080593">ObjectIdentifier</span><span class="op" id="4080609">{</span><span class="num" id="4080610">1</span><span class="op" id="4080611">,</span>&nbsp;<span class="num" id="4080613">3</span><span class="op" id="4080614">,</span>&nbsp;<span class="num" id="4080616">132</span><span class="op" id="4080619">,</span>&nbsp;<span class="num" id="4080621">0</span><span class="op" id="4080622">,</span>&nbsp;<span class="num" id="4080624">35</span><span class="op" id="4080626">}</span><br>
<span class="lineno"></span><span class="op" id="4080628">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="keyword" id="4080631">func</span>&nbsp;<span class="ident" id="4080636">namedCurveFromOID</span><span class="op" id="4080653">(</span><span class="ident" id="4080654">oid</span>&nbsp;<span class="ident" id="4080658">asn1</span><span class="op" id="4080662">.</span><span class="ident" id="4080663">ObjectIdentifier</span><span class="op" id="4080679">)</span>&nbsp;<span class="ident" id="4080681">elliptic</span><span class="op" id="4080689">.</span><span class="ident" id="4080690">Curve</span>&nbsp;<span class="op" id="4080696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4080699">switch</span>&nbsp;<span class="op" id="4080706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4080709">case</span>&nbsp;<span class="ident" id="4080714">oid</span><span class="op" id="4080717">.</span><span class="ident" id="4080718">Equal</span><span class="op" id="4080723">(</span><span class="ident" id="4080724">oidNamedCurveP224</span><span class="op" id="4080741">)</span><span class="op" id="4080742">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4080746">return</span>&nbsp;<span class="ident" id="4080753">elliptic</span><span class="op" id="4080761">.</span><span class="ident" id="4080762">P224</span><span class="op" id="4080766">(</span><span class="op" id="4080767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4080770">case</span>&nbsp;<span class="ident" id="4080775">oid</span><span class="op" id="4080778">.</span><span class="ident" id="4080779">Equal</span><span class="op" id="4080784">(</span><span class="ident" id="4080785">oidNamedCurveP256</span><span class="op" id="4080802">)</span><span class="op" id="4080803">:</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4080807">return</span>&nbsp;<span class="ident" id="4080814">elliptic</span><span class="op" id="4080822">.</span><span class="ident" id="4080823">P256</span><span class="op" id="4080827">(</span><span class="op" id="4080828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4080831">case</span>&nbsp;<span class="ident" id="4080836">oid</span><span class="op" id="4080839">.</span><span class="ident" id="4080840">Equal</span><span class="op" id="4080845">(</span><span class="ident" id="4080846">oidNamedCurveP384</span><span class="op" id="4080863">)</span><span class="op" id="4080864">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4080868">return</span>&nbsp;<span class="ident" id="4080875">elliptic</span><span class="op" id="4080883">.</span><span class="ident" id="4080884">P384</span><span class="op" id="4080888">(</span><span class="op" id="4080889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4080892">case</span>&nbsp;<span class="ident" id="4080897">oid</span><span class="op" id="4080900">.</span><span class="ident" id="4080901">Equal</span><span class="op" id="4080906">(</span><span class="ident" id="4080907">oidNamedCurveP521</span><span class="op" id="4080924">)</span><span class="op" id="4080925">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4080929">return</span>&nbsp;<span class="ident" id="4080936">elliptic</span><span class="op" id="4080944">.</span><span class="ident" id="4080945">P521</span><span class="op" id="4080949">(</span><span class="op" id="4080950">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4080953">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4080956">return</span>&nbsp;<span class="ident" id="4080963">nil</span><br>
<span class="lineno"></span><span class="op" id="4080967">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4080970">func</span>&nbsp;<span class="ident" id="4080975">oidFromNamedCurve</span><span class="op" id="4080992">(</span><span class="ident" id="4080993">curve</span>&nbsp;<span class="ident" id="4080999">elliptic</span><span class="op" id="4081007">.</span><span class="ident" id="4081008">Curve</span><span class="op" id="4081013">)</span>&nbsp;<span class="op" id="4081015">(</span><span class="ident" id="4081016">asn1</span><span class="op" id="4081020">.</span><span class="ident" id="4081021">ObjectIdentifier</span><span class="op" id="4081037">,</span>&nbsp;<span class="builtintype" id="4081039">bool</span><span class="op" id="4081043">)</span>&nbsp;<span class="op" id="4081045">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4081048">switch</span>&nbsp;<span class="ident" id="4081055">curve</span>&nbsp;<span class="op" id="4081061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4081064">case</span>&nbsp;<span class="ident" id="4081069">elliptic</span><span class="op" id="4081077">.</span><span class="ident" id="4081078">P224</span><span class="op" id="4081082">(</span><span class="op" id="4081083">)</span><span class="op" id="4081084">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4081088">return</span>&nbsp;<span class="ident" id="4081095">oidNamedCurveP224</span><span class="op" id="4081112">,</span>&nbsp;<span class="builtintype" id="4081114">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4081120">case</span>&nbsp;<span class="ident" id="4081125">elliptic</span><span class="op" id="4081133">.</span><span class="ident" id="4081134">P256</span><span class="op" id="4081138">(</span><span class="op" id="4081139">)</span><span class="op" id="4081140">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4081144">return</span>&nbsp;<span class="ident" id="4081151">oidNamedCurveP256</span><span class="op" id="4081168">,</span>&nbsp;<span class="builtintype" id="4081170">true</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4081176">case</span>&nbsp;<span class="ident" id="4081181">elliptic</span><span class="op" id="4081189">.</span><span class="ident" id="4081190">P384</span><span class="op" id="4081194">(</span><span class="op" id="4081195">)</span><span class="op" id="4081196">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4081200">return</span>&nbsp;<span class="ident" id="4081207">oidNamedCurveP384</span><span class="op" id="4081224">,</span>&nbsp;<span class="builtintype" id="4081226">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4081232">case</span>&nbsp;<span class="ident" id="4081237">elliptic</span><span class="op" id="4081245">.</span><span class="ident" id="4081246">P521</span><span class="op" id="4081250">(</span><span class="op" id="4081251">)</span><span class="op" id="4081252">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4081256">return</span>&nbsp;<span class="ident" id="4081263">oidNamedCurveP521</span><span class="op" id="4081280">,</span>&nbsp;<span class="builtintype" id="4081282">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4081288">}</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4081292">return</span>&nbsp;<span class="ident" id="4081299">nil</span><span class="op" id="4081302">,</span>&nbsp;<span class="builtintype" id="4081304">false</span><br>
<span class="lineno"></span><span class="op" id="4081310">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4081313">//&nbsp;KeyUsage&nbsp;represents&nbsp;the&nbsp;set&nbsp;of&nbsp;actions&nbsp;that&nbsp;are&nbsp;valid&nbsp;for&nbsp;a&nbsp;given&nbsp;key.&nbsp;It&#39;s</span><br>
<span class="lineno">360</span><span class="comment" id="4081392">//&nbsp;a&nbsp;bitmap&nbsp;of&nbsp;the&nbsp;KeyUsage*&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="4081432">type</span>&nbsp;<span class="ident" id="4081437">KeyUsage</span>&nbsp;<span class="builtintype" id="4081446">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4081451">const</span>&nbsp;<span class="op" id="4081457">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4081460">KeyUsageDigitalSignature</span>&nbsp;<span class="ident" id="4081485">KeyUsage</span>&nbsp;<span class="op" id="4081494">=</span>&nbsp;<span class="num" id="4081496">1</span>&nbsp;<span class="op" id="4081498">&lt;&lt;</span>&nbsp;<span class="ident" id="4081501">iota</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4081507">KeyUsageContentCommitment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4081534">KeyUsageKeyEncipherment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4081559">KeyUsageDataEncipherment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4081585">KeyUsageKeyAgreement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4081607">KeyUsageCertSign</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4081625">KeyUsageCRLSign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4081642">KeyUsageEncipherOnly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4081664">KeyUsageDecipherOnly</span><br>
<span class="lineno"></span><span class="op" id="4081685">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span><span class="comment" id="4081688">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.12&nbsp;&nbsp;Extended&nbsp;Key&nbsp;Usage</span><br>
<span class="lineno"></span><span class="comment" id="4081730">//</span><br>
<span class="lineno"></span><span class="comment" id="4081733">//&nbsp;anyExtendedKeyUsage&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-ce-extKeyUsage&nbsp;0&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4081802">//</span><br>
<span class="lineno"></span><span class="comment" id="4081805">//&nbsp;id-kp&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-pkix&nbsp;3&nbsp;}</span><br>
<span class="lineno">380</span><span class="comment" id="4081850">//</span><br>
<span class="lineno"></span><span class="comment" id="4081853">//&nbsp;id-kp-serverAuth&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4081919">//&nbsp;id-kp-clientAuth&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;2&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4081985">//&nbsp;id-kp-codeSigning&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;3&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4082051">//&nbsp;id-kp-emailProtection&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;4&nbsp;}</span><br>
<span class="lineno">385</span><span class="comment" id="4082117">//&nbsp;id-kp-timeStamping&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;8&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4082183">//&nbsp;id-kp-OCSPSigning&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;9&nbsp;}</span><br>
<span class="lineno"></span><span class="keyword" id="4082249">var</span>&nbsp;<span class="op" id="4082253">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4082256">oidExtKeyUsageAny</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4082297">=</span>&nbsp;<span class="ident" id="4082299">asn1</span><span class="op" id="4082303">.</span><span class="ident" id="4082304">ObjectIdentifier</span><span class="op" id="4082320">{</span><span class="num" id="4082321">2</span><span class="op" id="4082322">,</span>&nbsp;<span class="num" id="4082324">5</span><span class="op" id="4082325">,</span>&nbsp;<span class="num" id="4082327">29</span><span class="op" id="4082329">,</span>&nbsp;<span class="num" id="4082331">37</span><span class="op" id="4082333">,</span>&nbsp;<span class="num" id="4082335">0</span><span class="op" id="4082336">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4082339">oidExtKeyUsageServerAuth</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4082380">=</span>&nbsp;<span class="ident" id="4082382">asn1</span><span class="op" id="4082386">.</span><span class="ident" id="4082387">ObjectIdentifier</span><span class="op" id="4082403">{</span><span class="num" id="4082404">1</span><span class="op" id="4082405">,</span>&nbsp;<span class="num" id="4082407">3</span><span class="op" id="4082408">,</span>&nbsp;<span class="num" id="4082410">6</span><span class="op" id="4082411">,</span>&nbsp;<span class="num" id="4082413">1</span><span class="op" id="4082414">,</span>&nbsp;<span class="num" id="4082416">5</span><span class="op" id="4082417">,</span>&nbsp;<span class="num" id="4082419">5</span><span class="op" id="4082420">,</span>&nbsp;<span class="num" id="4082422">7</span><span class="op" id="4082423">,</span>&nbsp;<span class="num" id="4082425">3</span><span class="op" id="4082426">,</span>&nbsp;<span class="num" id="4082428">1</span><span class="op" id="4082429">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4082432">oidExtKeyUsageClientAuth</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4082473">=</span>&nbsp;<span class="ident" id="4082475">asn1</span><span class="op" id="4082479">.</span><span class="ident" id="4082480">ObjectIdentifier</span><span class="op" id="4082496">{</span><span class="num" id="4082497">1</span><span class="op" id="4082498">,</span>&nbsp;<span class="num" id="4082500">3</span><span class="op" id="4082501">,</span>&nbsp;<span class="num" id="4082503">6</span><span class="op" id="4082504">,</span>&nbsp;<span class="num" id="4082506">1</span><span class="op" id="4082507">,</span>&nbsp;<span class="num" id="4082509">5</span><span class="op" id="4082510">,</span>&nbsp;<span class="num" id="4082512">5</span><span class="op" id="4082513">,</span>&nbsp;<span class="num" id="4082515">7</span><span class="op" id="4082516">,</span>&nbsp;<span class="num" id="4082518">3</span><span class="op" id="4082519">,</span>&nbsp;<span class="num" id="4082521">2</span><span class="op" id="4082522">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4082525">oidExtKeyUsageCodeSigning</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4082566">=</span>&nbsp;<span class="ident" id="4082568">asn1</span><span class="op" id="4082572">.</span><span class="ident" id="4082573">ObjectIdentifier</span><span class="op" id="4082589">{</span><span class="num" id="4082590">1</span><span class="op" id="4082591">,</span>&nbsp;<span class="num" id="4082593">3</span><span class="op" id="4082594">,</span>&nbsp;<span class="num" id="4082596">6</span><span class="op" id="4082597">,</span>&nbsp;<span class="num" id="4082599">1</span><span class="op" id="4082600">,</span>&nbsp;<span class="num" id="4082602">5</span><span class="op" id="4082603">,</span>&nbsp;<span class="num" id="4082605">5</span><span class="op" id="4082606">,</span>&nbsp;<span class="num" id="4082608">7</span><span class="op" id="4082609">,</span>&nbsp;<span class="num" id="4082611">3</span><span class="op" id="4082612">,</span>&nbsp;<span class="num" id="4082614">3</span><span class="op" id="4082615">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4082618">oidExtKeyUsageEmailProtection</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4082659">=</span>&nbsp;<span class="ident" id="4082661">asn1</span><span class="op" id="4082665">.</span><span class="ident" id="4082666">ObjectIdentifier</span><span class="op" id="4082682">{</span><span class="num" id="4082683">1</span><span class="op" id="4082684">,</span>&nbsp;<span class="num" id="4082686">3</span><span class="op" id="4082687">,</span>&nbsp;<span class="num" id="4082689">6</span><span class="op" id="4082690">,</span>&nbsp;<span class="num" id="4082692">1</span><span class="op" id="4082693">,</span>&nbsp;<span class="num" id="4082695">5</span><span class="op" id="4082696">,</span>&nbsp;<span class="num" id="4082698">5</span><span class="op" id="4082699">,</span>&nbsp;<span class="num" id="4082701">7</span><span class="op" id="4082702">,</span>&nbsp;<span class="num" id="4082704">3</span><span class="op" id="4082705">,</span>&nbsp;<span class="num" id="4082707">4</span><span class="op" id="4082708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4082711">oidExtKeyUsageIPSECEndSystem</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4082752">=</span>&nbsp;<span class="ident" id="4082754">asn1</span><span class="op" id="4082758">.</span><span class="ident" id="4082759">ObjectIdentifier</span><span class="op" id="4082775">{</span><span class="num" id="4082776">1</span><span class="op" id="4082777">,</span>&nbsp;<span class="num" id="4082779">3</span><span class="op" id="4082780">,</span>&nbsp;<span class="num" id="4082782">6</span><span class="op" id="4082783">,</span>&nbsp;<span class="num" id="4082785">1</span><span class="op" id="4082786">,</span>&nbsp;<span class="num" id="4082788">5</span><span class="op" id="4082789">,</span>&nbsp;<span class="num" id="4082791">5</span><span class="op" id="4082792">,</span>&nbsp;<span class="num" id="4082794">7</span><span class="op" id="4082795">,</span>&nbsp;<span class="num" id="4082797">3</span><span class="op" id="4082798">,</span>&nbsp;<span class="num" id="4082800">5</span><span class="op" id="4082801">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4082804">oidExtKeyUsageIPSECTunnel</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4082845">=</span>&nbsp;<span class="ident" id="4082847">asn1</span><span class="op" id="4082851">.</span><span class="ident" id="4082852">ObjectIdentifier</span><span class="op" id="4082868">{</span><span class="num" id="4082869">1</span><span class="op" id="4082870">,</span>&nbsp;<span class="num" id="4082872">3</span><span class="op" id="4082873">,</span>&nbsp;<span class="num" id="4082875">6</span><span class="op" id="4082876">,</span>&nbsp;<span class="num" id="4082878">1</span><span class="op" id="4082879">,</span>&nbsp;<span class="num" id="4082881">5</span><span class="op" id="4082882">,</span>&nbsp;<span class="num" id="4082884">5</span><span class="op" id="4082885">,</span>&nbsp;<span class="num" id="4082887">7</span><span class="op" id="4082888">,</span>&nbsp;<span class="num" id="4082890">3</span><span class="op" id="4082891">,</span>&nbsp;<span class="num" id="4082893">6</span><span class="op" id="4082894">}</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4082897">oidExtKeyUsageIPSECUser</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4082938">=</span>&nbsp;<span class="ident" id="4082940">asn1</span><span class="op" id="4082944">.</span><span class="ident" id="4082945">ObjectIdentifier</span><span class="op" id="4082961">{</span><span class="num" id="4082962">1</span><span class="op" id="4082963">,</span>&nbsp;<span class="num" id="4082965">3</span><span class="op" id="4082966">,</span>&nbsp;<span class="num" id="4082968">6</span><span class="op" id="4082969">,</span>&nbsp;<span class="num" id="4082971">1</span><span class="op" id="4082972">,</span>&nbsp;<span class="num" id="4082974">5</span><span class="op" id="4082975">,</span>&nbsp;<span class="num" id="4082977">5</span><span class="op" id="4082978">,</span>&nbsp;<span class="num" id="4082980">7</span><span class="op" id="4082981">,</span>&nbsp;<span class="num" id="4082983">3</span><span class="op" id="4082984">,</span>&nbsp;<span class="num" id="4082986">7</span><span class="op" id="4082987">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4082990">oidExtKeyUsageTimeStamping</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4083031">=</span>&nbsp;<span class="ident" id="4083033">asn1</span><span class="op" id="4083037">.</span><span class="ident" id="4083038">ObjectIdentifier</span><span class="op" id="4083054">{</span><span class="num" id="4083055">1</span><span class="op" id="4083056">,</span>&nbsp;<span class="num" id="4083058">3</span><span class="op" id="4083059">,</span>&nbsp;<span class="num" id="4083061">6</span><span class="op" id="4083062">,</span>&nbsp;<span class="num" id="4083064">1</span><span class="op" id="4083065">,</span>&nbsp;<span class="num" id="4083067">5</span><span class="op" id="4083068">,</span>&nbsp;<span class="num" id="4083070">5</span><span class="op" id="4083071">,</span>&nbsp;<span class="num" id="4083073">7</span><span class="op" id="4083074">,</span>&nbsp;<span class="num" id="4083076">3</span><span class="op" id="4083077">,</span>&nbsp;<span class="num" id="4083079">8</span><span class="op" id="4083080">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4083083">oidExtKeyUsageOCSPSigning</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4083124">=</span>&nbsp;<span class="ident" id="4083126">asn1</span><span class="op" id="4083130">.</span><span class="ident" id="4083131">ObjectIdentifier</span><span class="op" id="4083147">{</span><span class="num" id="4083148">1</span><span class="op" id="4083149">,</span>&nbsp;<span class="num" id="4083151">3</span><span class="op" id="4083152">,</span>&nbsp;<span class="num" id="4083154">6</span><span class="op" id="4083155">,</span>&nbsp;<span class="num" id="4083157">1</span><span class="op" id="4083158">,</span>&nbsp;<span class="num" id="4083160">5</span><span class="op" id="4083161">,</span>&nbsp;<span class="num" id="4083163">5</span><span class="op" id="4083164">,</span>&nbsp;<span class="num" id="4083166">7</span><span class="op" id="4083167">,</span>&nbsp;<span class="num" id="4083169">3</span><span class="op" id="4083170">,</span>&nbsp;<span class="num" id="4083172">9</span><span class="op" id="4083173">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4083176">oidExtKeyUsageMicrosoftServerGatedCrypto</span>&nbsp;<span class="op" id="4083217">=</span>&nbsp;<span class="ident" id="4083219">asn1</span><span class="op" id="4083223">.</span><span class="ident" id="4083224">ObjectIdentifier</span><span class="op" id="4083240">{</span><span class="num" id="4083241">1</span><span class="op" id="4083242">,</span>&nbsp;<span class="num" id="4083244">3</span><span class="op" id="4083245">,</span>&nbsp;<span class="num" id="4083247">6</span><span class="op" id="4083248">,</span>&nbsp;<span class="num" id="4083250">1</span><span class="op" id="4083251">,</span>&nbsp;<span class="num" id="4083253">4</span><span class="op" id="4083254">,</span>&nbsp;<span class="num" id="4083256">1</span><span class="op" id="4083257">,</span>&nbsp;<span class="num" id="4083259">311</span><span class="op" id="4083262">,</span>&nbsp;<span class="num" id="4083264">10</span><span class="op" id="4083266">,</span>&nbsp;<span class="num" id="4083268">3</span><span class="op" id="4083269">,</span>&nbsp;<span class="num" id="4083271">3</span><span class="op" id="4083272">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4083275">oidExtKeyUsageNetscapeServerGatedCrypto</span>&nbsp;&nbsp;<span class="op" id="4083316">=</span>&nbsp;<span class="ident" id="4083318">asn1</span><span class="op" id="4083322">.</span><span class="ident" id="4083323">ObjectIdentifier</span><span class="op" id="4083339">{</span><span class="num" id="4083340">2</span><span class="op" id="4083341">,</span>&nbsp;<span class="num" id="4083343">16</span><span class="op" id="4083345">,</span>&nbsp;<span class="num" id="4083347">840</span><span class="op" id="4083350">,</span>&nbsp;<span class="num" id="4083352">1</span><span class="op" id="4083353">,</span>&nbsp;<span class="num" id="4083355">113730</span><span class="op" id="4083361">,</span>&nbsp;<span class="num" id="4083363">4</span><span class="op" id="4083364">,</span>&nbsp;<span class="num" id="4083366">1</span><span class="op" id="4083367">}</span><br>
<span class="lineno">400</span><span class="op" id="4083369">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4083372">//&nbsp;ExtKeyUsage&nbsp;represents&nbsp;an&nbsp;extended&nbsp;set&nbsp;of&nbsp;actions&nbsp;that&nbsp;are&nbsp;valid&nbsp;for&nbsp;a&nbsp;given&nbsp;key.</span><br>
<span class="lineno"></span><span class="comment" id="4083457">//&nbsp;Each&nbsp;of&nbsp;the&nbsp;ExtKeyUsage*&nbsp;constants&nbsp;define&nbsp;a&nbsp;unique&nbsp;action.</span><br>
<span class="lineno"></span><span class="keyword" id="4083519">type</span>&nbsp;<span class="ident" id="4083524">ExtKeyUsage</span>&nbsp;<span class="builtintype" id="4083536">int</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span><span class="keyword" id="4083541">const</span>&nbsp;<span class="op" id="4083547">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4083550">ExtKeyUsageAny</span>&nbsp;<span class="ident" id="4083565">ExtKeyUsage</span>&nbsp;<span class="op" id="4083577">=</span>&nbsp;<span class="ident" id="4083579">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4083585">ExtKeyUsageServerAuth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4083608">ExtKeyUsageClientAuth</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4083631">ExtKeyUsageCodeSigning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4083655">ExtKeyUsageEmailProtection</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4083683">ExtKeyUsageIPSECEndSystem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4083710">ExtKeyUsageIPSECTunnel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4083734">ExtKeyUsageIPSECUser</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4083756">ExtKeyUsageTimeStamping</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4083781">ExtKeyUsageOCSPSigning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4083805">ExtKeyUsageMicrosoftServerGatedCrypto</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4083844">ExtKeyUsageNetscapeServerGatedCrypto</span><br>
<span class="lineno"></span><span class="op" id="4083881">)</span><br>
<span class="lineno">420</span><br>
<span class="lineno"></span><span class="comment" id="4083884">//&nbsp;extKeyUsageOIDs&nbsp;contains&nbsp;the&nbsp;mapping&nbsp;between&nbsp;an&nbsp;ExtKeyUsage&nbsp;and&nbsp;its&nbsp;OID.</span><br>
<span class="lineno"></span><span class="keyword" id="4083960">var</span>&nbsp;<span class="ident" id="4083964">extKeyUsageOIDs</span>&nbsp;<span class="op" id="4083980">=</span>&nbsp;<span class="op" id="4083982">[</span><span class="op" id="4083983">]</span><span class="keyword" id="4083984">struct</span>&nbsp;<span class="op" id="4083991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4083994">extKeyUsage</span>&nbsp;<span class="ident" id="4084006">ExtKeyUsage</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4084019">oid</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4084031">asn1</span><span class="op" id="4084035">.</span><span class="ident" id="4084036">ObjectIdentifier</span><br>
<span class="lineno">425</span><span class="op" id="4084053">}</span><span class="op" id="4084054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4084057">{</span><span class="ident" id="4084058">ExtKeyUsageAny</span><span class="op" id="4084072">,</span>&nbsp;<span class="ident" id="4084074">oidExtKeyUsageAny</span><span class="op" id="4084091">}</span><span class="op" id="4084092">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4084095">{</span><span class="ident" id="4084096">ExtKeyUsageServerAuth</span><span class="op" id="4084117">,</span>&nbsp;<span class="ident" id="4084119">oidExtKeyUsageServerAuth</span><span class="op" id="4084143">}</span><span class="op" id="4084144">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4084147">{</span><span class="ident" id="4084148">ExtKeyUsageClientAuth</span><span class="op" id="4084169">,</span>&nbsp;<span class="ident" id="4084171">oidExtKeyUsageClientAuth</span><span class="op" id="4084195">}</span><span class="op" id="4084196">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4084199">{</span><span class="ident" id="4084200">ExtKeyUsageCodeSigning</span><span class="op" id="4084222">,</span>&nbsp;<span class="ident" id="4084224">oidExtKeyUsageCodeSigning</span><span class="op" id="4084249">}</span><span class="op" id="4084250">,</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4084253">{</span><span class="ident" id="4084254">ExtKeyUsageEmailProtection</span><span class="op" id="4084280">,</span>&nbsp;<span class="ident" id="4084282">oidExtKeyUsageEmailProtection</span><span class="op" id="4084311">}</span><span class="op" id="4084312">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4084315">{</span><span class="ident" id="4084316">ExtKeyUsageIPSECEndSystem</span><span class="op" id="4084341">,</span>&nbsp;<span class="ident" id="4084343">oidExtKeyUsageIPSECEndSystem</span><span class="op" id="4084371">}</span><span class="op" id="4084372">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4084375">{</span><span class="ident" id="4084376">ExtKeyUsageIPSECTunnel</span><span class="op" id="4084398">,</span>&nbsp;<span class="ident" id="4084400">oidExtKeyUsageIPSECTunnel</span><span class="op" id="4084425">}</span><span class="op" id="4084426">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4084429">{</span><span class="ident" id="4084430">ExtKeyUsageIPSECUser</span><span class="op" id="4084450">,</span>&nbsp;<span class="ident" id="4084452">oidExtKeyUsageIPSECUser</span><span class="op" id="4084475">}</span><span class="op" id="4084476">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4084479">{</span><span class="ident" id="4084480">ExtKeyUsageTimeStamping</span><span class="op" id="4084503">,</span>&nbsp;<span class="ident" id="4084505">oidExtKeyUsageTimeStamping</span><span class="op" id="4084531">}</span><span class="op" id="4084532">,</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4084535">{</span><span class="ident" id="4084536">ExtKeyUsageOCSPSigning</span><span class="op" id="4084558">,</span>&nbsp;<span class="ident" id="4084560">oidExtKeyUsageOCSPSigning</span><span class="op" id="4084585">}</span><span class="op" id="4084586">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4084589">{</span><span class="ident" id="4084590">ExtKeyUsageMicrosoftServerGatedCrypto</span><span class="op" id="4084627">,</span>&nbsp;<span class="ident" id="4084629">oidExtKeyUsageMicrosoftServerGatedCrypto</span><span class="op" id="4084669">}</span><span class="op" id="4084670">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4084673">{</span><span class="ident" id="4084674">ExtKeyUsageNetscapeServerGatedCrypto</span><span class="op" id="4084710">,</span>&nbsp;<span class="ident" id="4084712">oidExtKeyUsageNetscapeServerGatedCrypto</span><span class="op" id="4084751">}</span><span class="op" id="4084752">,</span><br>
<span class="lineno"></span><span class="op" id="4084754">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span><span class="keyword" id="4084757">func</span>&nbsp;<span class="ident" id="4084762">extKeyUsageFromOID</span><span class="op" id="4084780">(</span><span class="ident" id="4084781">oid</span>&nbsp;<span class="ident" id="4084785">asn1</span><span class="op" id="4084789">.</span><span class="ident" id="4084790">ObjectIdentifier</span><span class="op" id="4084806">)</span>&nbsp;<span class="op" id="4084808">(</span><span class="ident" id="4084809">eku</span>&nbsp;<span class="ident" id="4084813">ExtKeyUsage</span><span class="op" id="4084824">,</span>&nbsp;<span class="ident" id="4084826">ok</span>&nbsp;<span class="builtintype" id="4084829">bool</span><span class="op" id="4084833">)</span>&nbsp;<span class="op" id="4084835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4084838">for</span>&nbsp;<span class="ident" id="4084842">_</span><span class="op" id="4084843">,</span>&nbsp;<span class="ident" id="4084845">pair</span>&nbsp;<span class="op" id="4084850">:=</span>&nbsp;<span class="keyword" id="4084853">range</span>&nbsp;<span class="ident" id="4084859">extKeyUsageOIDs</span>&nbsp;<span class="op" id="4084875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4084879">if</span>&nbsp;<span class="ident" id="4084882">oid</span><span class="op" id="4084885">.</span><span class="ident" id="4084886">Equal</span><span class="op" id="4084891">(</span><span class="ident" id="4084892">pair</span><span class="op" id="4084896">.</span><span class="ident" id="4084897">oid</span><span class="op" id="4084900">)</span>&nbsp;<span class="op" id="4084902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4084907">return</span>&nbsp;<span class="ident" id="4084914">pair</span><span class="op" id="4084918">.</span><span class="ident" id="4084919">extKeyUsage</span><span class="op" id="4084930">,</span>&nbsp;<span class="builtintype" id="4084932">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4084939">}</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4084942">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4084945">return</span><br>
<span class="lineno"></span><span class="op" id="4084952">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4084955">func</span>&nbsp;<span class="ident" id="4084960">oidFromExtKeyUsage</span><span class="op" id="4084978">(</span><span class="ident" id="4084979">eku</span>&nbsp;<span class="ident" id="4084983">ExtKeyUsage</span><span class="op" id="4084994">)</span>&nbsp;<span class="op" id="4084996">(</span><span class="ident" id="4084997">oid</span>&nbsp;<span class="ident" id="4085001">asn1</span><span class="op" id="4085005">.</span><span class="ident" id="4085006">ObjectIdentifier</span><span class="op" id="4085022">,</span>&nbsp;<span class="ident" id="4085024">ok</span>&nbsp;<span class="builtintype" id="4085027">bool</span><span class="op" id="4085031">)</span>&nbsp;<span class="op" id="4085033">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4085036">for</span>&nbsp;<span class="ident" id="4085040">_</span><span class="op" id="4085041">,</span>&nbsp;<span class="ident" id="4085043">pair</span>&nbsp;<span class="op" id="4085048">:=</span>&nbsp;<span class="keyword" id="4085051">range</span>&nbsp;<span class="ident" id="4085057">extKeyUsageOIDs</span>&nbsp;<span class="op" id="4085073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4085077">if</span>&nbsp;<span class="ident" id="4085080">eku</span>&nbsp;<span class="op" id="4085084">==</span>&nbsp;<span class="ident" id="4085087">pair</span><span class="op" id="4085091">.</span><span class="ident" id="4085092">extKeyUsage</span>&nbsp;<span class="op" id="4085104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4085109">return</span>&nbsp;<span class="ident" id="4085116">pair</span><span class="op" id="4085120">.</span><span class="ident" id="4085121">oid</span><span class="op" id="4085124">,</span>&nbsp;<span class="builtintype" id="4085126">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4085133">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4085136">}</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4085139">return</span><br>
<span class="lineno"></span><span class="op" id="4085146">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4085149">//&nbsp;A&nbsp;Certificate&nbsp;represents&nbsp;an&nbsp;X.509&nbsp;certificate.</span><br>
<span class="lineno"></span><span class="keyword" id="4085199">type</span>&nbsp;<span class="ident" id="4085204">Certificate</span>&nbsp;<span class="keyword" id="4085216">struct</span>&nbsp;<span class="op" id="4085223">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4085226">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4085250">[</span><span class="op" id="4085251">]</span><span class="builtintype" id="4085252">byte</span>&nbsp;<span class="comment" id="4085257">//&nbsp;Complete&nbsp;ASN.1&nbsp;DER&nbsp;content&nbsp;(certificate,&nbsp;signature&nbsp;algorithm&nbsp;and&nbsp;signature).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4085338">RawTBSCertificate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4085362">[</span><span class="op" id="4085363">]</span><span class="builtintype" id="4085364">byte</span>&nbsp;<span class="comment" id="4085369">//&nbsp;Certificate&nbsp;part&nbsp;of&nbsp;raw&nbsp;ASN.1&nbsp;DER&nbsp;content.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4085416">RawSubjectPublicKeyInfo</span>&nbsp;<span class="op" id="4085440">[</span><span class="op" id="4085441">]</span><span class="builtintype" id="4085442">byte</span>&nbsp;<span class="comment" id="4085447">//&nbsp;DER&nbsp;encoded&nbsp;SubjectPublicKeyInfo.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4085485">RawSubject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4085509">[</span><span class="op" id="4085510">]</span><span class="builtintype" id="4085511">byte</span>&nbsp;<span class="comment" id="4085516">//&nbsp;DER&nbsp;encoded&nbsp;Subject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4085540">RawIssuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4085564">[</span><span class="op" id="4085565">]</span><span class="builtintype" id="4085566">byte</span>&nbsp;<span class="comment" id="4085571">//&nbsp;DER&nbsp;encoded&nbsp;Issuer</span><br>
<span class="lineno">465</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4085595">Signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4085614">[</span><span class="op" id="4085615">]</span><span class="builtintype" id="4085616">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4085622">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4085641">SignatureAlgorithm</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4085662">PublicKeyAlgorithm</span>&nbsp;<span class="ident" id="4085681">PublicKeyAlgorithm</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4085701">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4085720">interface</span><span class="op" id="4085729">{</span><span class="op" id="4085730">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4085734">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4085754">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4085759">SerialNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4085779">*</span><span class="ident" id="4085780">big</span><span class="op" id="4085783">.</span><span class="ident" id="4085784">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4085789">Issuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4085809">pkix</span><span class="op" id="4085813">.</span><span class="ident" id="4085814">Name</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4085820">Subject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4085840">pkix</span><span class="op" id="4085844">.</span><span class="ident" id="4085845">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4085851">NotBefore</span><span class="op" id="4085860">,</span>&nbsp;<span class="ident" id="4085862">NotAfter</span>&nbsp;<span class="ident" id="4085871">time</span><span class="op" id="4085875">.</span><span class="ident" id="4085876">Time</span>&nbsp;<span class="comment" id="4085881">//&nbsp;Validity&nbsp;bounds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4085902">KeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4085922">KeyUsage</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4085933">//&nbsp;Extensions&nbsp;contains&nbsp;raw&nbsp;X.509&nbsp;extensions.&nbsp;When&nbsp;parsing&nbsp;certificates,</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4086006">//&nbsp;this&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;extract&nbsp;non-critical&nbsp;extensions&nbsp;that&nbsp;are&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4086075">//&nbsp;parsed&nbsp;by&nbsp;this&nbsp;package.&nbsp;When&nbsp;marshaling&nbsp;certificates,&nbsp;the&nbsp;Extensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4086148">//&nbsp;field&nbsp;is&nbsp;ignored,&nbsp;see&nbsp;ExtraExtensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4086191">Extensions</span>&nbsp;<span class="op" id="4086202">[</span><span class="op" id="4086203">]</span><span class="ident" id="4086204">pkix</span><span class="op" id="4086208">.</span><span class="ident" id="4086209">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4086221">//&nbsp;ExtraExtensions&nbsp;contains&nbsp;extensions&nbsp;to&nbsp;be&nbsp;copied,&nbsp;raw,&nbsp;into&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4086289">//&nbsp;marshaled&nbsp;certificates.&nbsp;Values&nbsp;override&nbsp;any&nbsp;extensions&nbsp;that&nbsp;would</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4086359">//&nbsp;otherwise&nbsp;be&nbsp;produced&nbsp;based&nbsp;on&nbsp;the&nbsp;other&nbsp;fields.&nbsp;The&nbsp;ExtraExtensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4086432">//&nbsp;field&nbsp;is&nbsp;not&nbsp;populated&nbsp;when&nbsp;parsing&nbsp;certificates,&nbsp;see&nbsp;Extensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4086502">ExtraExtensions</span>&nbsp;<span class="op" id="4086518">[</span><span class="op" id="4086519">]</span><span class="ident" id="4086520">pkix</span><span class="op" id="4086524">.</span><span class="ident" id="4086525">Extension</span><br>
<span class="lineno">490</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4086537">ExtKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4086556">[</span><span class="op" id="4086557">]</span><span class="ident" id="4086558">ExtKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4086580">//&nbsp;Sequence&nbsp;of&nbsp;extended&nbsp;key&nbsp;usages.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4086617">UnknownExtKeyUsage</span>&nbsp;<span class="op" id="4086636">[</span><span class="op" id="4086637">]</span><span class="ident" id="4086638">asn1</span><span class="op" id="4086642">.</span><span class="ident" id="4086643">ObjectIdentifier</span>&nbsp;<span class="comment" id="4086660">//&nbsp;Encountered&nbsp;extended&nbsp;key&nbsp;usages&nbsp;unknown&nbsp;to&nbsp;this&nbsp;package.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4086722">BasicConstraintsValid</span>&nbsp;<span class="builtintype" id="4086744">bool</span>&nbsp;<span class="comment" id="4086749">//&nbsp;if&nbsp;true&nbsp;then&nbsp;the&nbsp;next&nbsp;two&nbsp;fields&nbsp;are&nbsp;valid.</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4086797">IsCA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4086819">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4086825">MaxPathLen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4086847">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4086852">//&nbsp;MaxPathLenZero&nbsp;indicates&nbsp;that&nbsp;BasicConstraintsValid==true&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4086918">//&nbsp;MaxPathLen==0&nbsp;should&nbsp;be&nbsp;interpreted&nbsp;as&nbsp;an&nbsp;actual&nbsp;maximum&nbsp;path&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4086991">//&nbsp;of&nbsp;zero.&nbsp;Otherwise,&nbsp;that&nbsp;combination&nbsp;is&nbsp;interpreted&nbsp;as&nbsp;MaxPathLen</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4087061">//&nbsp;not&nbsp;being&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4087080">MaxPathLenZero</span>&nbsp;<span class="builtintype" id="4087095">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4087102">SubjectKeyId</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4087117">[</span><span class="op" id="4087118">]</span><span class="builtintype" id="4087119">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4087125">AuthorityKeyId</span>&nbsp;<span class="op" id="4087140">[</span><span class="op" id="4087141">]</span><span class="builtintype" id="4087142">byte</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4087149">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.2.1&nbsp;(Authority&nbsp;Information&nbsp;Access)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4087202">OCSPServer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4087224">[</span><span class="op" id="4087225">]</span><span class="builtintype" id="4087226">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4087234">IssuingCertificateURL</span>&nbsp;<span class="op" id="4087256">[</span><span class="op" id="4087257">]</span><span class="builtintype" id="4087258">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4087267">//&nbsp;Subject&nbsp;Alternate&nbsp;Name&nbsp;values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4087301">DNSNames</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4087316">[</span><span class="op" id="4087317">]</span><span class="builtintype" id="4087318">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4087326">EmailAddresses</span>&nbsp;<span class="op" id="4087341">[</span><span class="op" id="4087342">]</span><span class="builtintype" id="4087343">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4087351">IPAddresses</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4087366">[</span><span class="op" id="4087367">]</span><span class="ident" id="4087368">net</span><span class="op" id="4087371">.</span><span class="ident" id="4087372">IP</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4087377">//&nbsp;Name&nbsp;constraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4087398">PermittedDNSDomainsCritical</span>&nbsp;<span class="builtintype" id="4087426">bool</span>&nbsp;<span class="comment" id="4087431">//&nbsp;if&nbsp;true&nbsp;then&nbsp;the&nbsp;name&nbsp;constraints&nbsp;are&nbsp;marked&nbsp;critical.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4087490">PermittedDNSDomains</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4087518">[</span><span class="op" id="4087519">]</span><span class="builtintype" id="4087520">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4087529">//&nbsp;CRL&nbsp;Distribution&nbsp;Points</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4087557">CRLDistributionPoints</span>&nbsp;<span class="op" id="4087579">[</span><span class="op" id="4087580">]</span><span class="builtintype" id="4087581">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4087590">PolicyIdentifiers</span>&nbsp;<span class="op" id="4087608">[</span><span class="op" id="4087609">]</span><span class="ident" id="4087610">asn1</span><span class="op" id="4087614">.</span><span class="ident" id="4087615">ObjectIdentifier</span><br>
<span class="lineno"></span><span class="op" id="4087632">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span><span class="comment" id="4087635">//&nbsp;ErrUnsupportedAlgorithm&nbsp;results&nbsp;from&nbsp;attempting&nbsp;to&nbsp;perform&nbsp;an&nbsp;operation&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4087715">//&nbsp;involves&nbsp;algorithms&nbsp;that&nbsp;are&nbsp;not&nbsp;currently&nbsp;implemented.</span><br>
<span class="lineno"></span><span class="keyword" id="4087774">var</span>&nbsp;<span class="ident" id="4087778">ErrUnsupportedAlgorithm</span>&nbsp;<span class="op" id="4087802">=</span>&nbsp;<span class="ident" id="4087804">errors</span><span class="op" id="4087810">.</span><span class="ident" id="4087811">New</span><span class="op" id="4087814">(</span><span class="string" id="4087815">&#34;x509:&nbsp;cannot&nbsp;verify&nbsp;signature:&nbsp;algorithm&nbsp;unimplemented&#34;</span><span class="op" id="4087871">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4087874">//&nbsp;ConstraintViolationError&nbsp;results&nbsp;when&nbsp;a&nbsp;requested&nbsp;usage&nbsp;is&nbsp;not&nbsp;permitted&nbsp;by</span><br>
<span class="lineno">530</span><span class="comment" id="4087953">//&nbsp;a&nbsp;certificate.&nbsp;For&nbsp;example:&nbsp;checking&nbsp;a&nbsp;signature&nbsp;when&nbsp;the&nbsp;public&nbsp;key&nbsp;isn&#39;t&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4088033">//&nbsp;certificate&nbsp;signing&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="4088061">type</span>&nbsp;<span class="ident" id="4088066">ConstraintViolationError</span>&nbsp;<span class="keyword" id="4088091">struct</span><span class="op" id="4088097">{</span><span class="op" id="4088098">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4088101">func</span>&nbsp;<span class="op" id="4088106">(</span><span class="ident" id="4088107">ConstraintViolationError</span><span class="op" id="4088131">)</span>&nbsp;<span class="ident" id="4088133">Error</span><span class="op" id="4088138">(</span><span class="op" id="4088139">)</span>&nbsp;<span class="builtintype" id="4088141">string</span>&nbsp;<span class="op" id="4088148">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4088151">return</span>&nbsp;<span class="string" id="4088158">&#34;x509:&nbsp;invalid&nbsp;signature:&nbsp;parent&nbsp;certificate&nbsp;cannot&nbsp;sign&nbsp;this&nbsp;kind&nbsp;of&nbsp;certificate&#34;</span><br>
<span class="lineno"></span><span class="op" id="4088241">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4088244">func</span>&nbsp;<span class="op" id="4088249">(</span><span class="ident" id="4088250">c</span>&nbsp;<span class="op" id="4088252">*</span><span class="ident" id="4088253">Certificate</span><span class="op" id="4088264">)</span>&nbsp;<span class="ident" id="4088266">Equal</span><span class="op" id="4088271">(</span><span class="ident" id="4088272">other</span>&nbsp;<span class="op" id="4088278">*</span><span class="ident" id="4088279">Certificate</span><span class="op" id="4088290">)</span>&nbsp;<span class="builtintype" id="4088292">bool</span>&nbsp;<span class="op" id="4088297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4088300">return</span>&nbsp;<span class="ident" id="4088307">bytes</span><span class="op" id="4088312">.</span><span class="ident" id="4088313">Equal</span><span class="op" id="4088318">(</span><span class="ident" id="4088319">c</span><span class="op" id="4088320">.</span><span class="ident" id="4088321">Raw</span><span class="op" id="4088324">,</span>&nbsp;<span class="ident" id="4088326">other</span><span class="op" id="4088331">.</span><span class="ident" id="4088332">Raw</span><span class="op" id="4088335">)</span><br>
<span class="lineno">540</span><span class="op" id="4088337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4088340">//&nbsp;Entrust&nbsp;have&nbsp;a&nbsp;broken&nbsp;root&nbsp;certificate&nbsp;(CN=Entrust.net&nbsp;Certification</span><br>
<span class="lineno"></span><span class="comment" id="4088412">//&nbsp;Authority&nbsp;(2048))&nbsp;which&nbsp;isn&#39;t&nbsp;marked&nbsp;as&nbsp;a&nbsp;CA&nbsp;certificate&nbsp;and&nbsp;is&nbsp;thus&nbsp;invalid</span><br>
<span class="lineno"></span><span class="comment" id="4088492">//&nbsp;according&nbsp;to&nbsp;PKIX.</span><br>
<span class="lineno">545</span><span class="comment" id="4088514">//&nbsp;We&nbsp;recognise&nbsp;this&nbsp;certificate&nbsp;by&nbsp;its&nbsp;SubjectPublicKeyInfo&nbsp;and&nbsp;exempt&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="4088589">//&nbsp;from&nbsp;the&nbsp;Basic&nbsp;Constraints&nbsp;requirement.</span><br>
<span class="lineno"></span><span class="comment" id="4088632">//&nbsp;See&nbsp;http://www.entrust.net/knowledge-base/technote.cfm?tn=7869</span><br>
<span class="lineno"></span><span class="comment" id="4088698">//</span><br>
<span class="lineno"></span><span class="comment" id="4088701">//&nbsp;TODO(agl):&nbsp;remove&nbsp;this&nbsp;hack&nbsp;once&nbsp;their&nbsp;reissued&nbsp;root&nbsp;is&nbsp;sufficiently</span><br>
<span class="lineno">550</span><span class="comment" id="4088773">//&nbsp;widespread.</span><br>
<span class="lineno"></span><span class="keyword" id="4088788">var</span>&nbsp;<span class="ident" id="4088792">entrustBrokenSPKI</span>&nbsp;<span class="op" id="4088810">=</span>&nbsp;<span class="op" id="4088812">[</span><span class="op" id="4088813">]</span><span class="builtintype" id="4088814">byte</span><span class="op" id="4088818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4088821">0x30</span><span class="op" id="4088825">,</span>&nbsp;<span class="num" id="4088827">0x82</span><span class="op" id="4088831">,</span>&nbsp;<span class="num" id="4088833">0x01</span><span class="op" id="4088837">,</span>&nbsp;<span class="num" id="4088839">0x22</span><span class="op" id="4088843">,</span>&nbsp;<span class="num" id="4088845">0x30</span><span class="op" id="4088849">,</span>&nbsp;<span class="num" id="4088851">0x0d</span><span class="op" id="4088855">,</span>&nbsp;<span class="num" id="4088857">0x06</span><span class="op" id="4088861">,</span>&nbsp;<span class="num" id="4088863">0x09</span><span class="op" id="4088867">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4088870">0x2a</span><span class="op" id="4088874">,</span>&nbsp;<span class="num" id="4088876">0x86</span><span class="op" id="4088880">,</span>&nbsp;<span class="num" id="4088882">0x48</span><span class="op" id="4088886">,</span>&nbsp;<span class="num" id="4088888">0x86</span><span class="op" id="4088892">,</span>&nbsp;<span class="num" id="4088894">0xf7</span><span class="op" id="4088898">,</span>&nbsp;<span class="num" id="4088900">0x0d</span><span class="op" id="4088904">,</span>&nbsp;<span class="num" id="4088906">0x01</span><span class="op" id="4088910">,</span>&nbsp;<span class="num" id="4088912">0x01</span><span class="op" id="4088916">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4088919">0x01</span><span class="op" id="4088923">,</span>&nbsp;<span class="num" id="4088925">0x05</span><span class="op" id="4088929">,</span>&nbsp;<span class="num" id="4088931">0x00</span><span class="op" id="4088935">,</span>&nbsp;<span class="num" id="4088937">0x03</span><span class="op" id="4088941">,</span>&nbsp;<span class="num" id="4088943">0x82</span><span class="op" id="4088947">,</span>&nbsp;<span class="num" id="4088949">0x01</span><span class="op" id="4088953">,</span>&nbsp;<span class="num" id="4088955">0x0f</span><span class="op" id="4088959">,</span>&nbsp;<span class="num" id="4088961">0x00</span><span class="op" id="4088965">,</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4088968">0x30</span><span class="op" id="4088972">,</span>&nbsp;<span class="num" id="4088974">0x82</span><span class="op" id="4088978">,</span>&nbsp;<span class="num" id="4088980">0x01</span><span class="op" id="4088984">,</span>&nbsp;<span class="num" id="4088986">0x0a</span><span class="op" id="4088990">,</span>&nbsp;<span class="num" id="4088992">0x02</span><span class="op" id="4088996">,</span>&nbsp;<span class="num" id="4088998">0x82</span><span class="op" id="4089002">,</span>&nbsp;<span class="num" id="4089004">0x01</span><span class="op" id="4089008">,</span>&nbsp;<span class="num" id="4089010">0x01</span><span class="op" id="4089014">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4089017">0x00</span><span class="op" id="4089021">,</span>&nbsp;<span class="num" id="4089023">0x97</span><span class="op" id="4089027">,</span>&nbsp;<span class="num" id="4089029">0xa3</span><span class="op" id="4089033">,</span>&nbsp;<span class="num" id="4089035">0x2d</span><span class="op" id="4089039">,</span>&nbsp;<span class="num" id="4089041">0x3c</span><span class="op" id="4089045">,</span>&nbsp;<span class="num" id="4089047">0x9e</span><span class="op" id="4089051">,</span>&nbsp;<span class="num" id="4089053">0xde</span><span class="op" id="4089057">,</span>&nbsp;<span class="num" id="4089059">0x05</span><span class="op" id="4089063">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4089066">0xda</span><span class="op" id="4089070">,</span>&nbsp;<span class="num" id="4089072">0x13</span><span class="op" id="4089076">,</span>&nbsp;<span class="num" id="4089078">0xc2</span><span class="op" id="4089082">,</span>&nbsp;<span class="num" id="4089084">0x11</span><span class="op" id="4089088">,</span>&nbsp;<span class="num" id="4089090">0x8d</span><span class="op" id="4089094">,</span>&nbsp;<span class="num" id="4089096">0x9d</span><span class="op" id="4089100">,</span>&nbsp;<span class="num" id="4089102">0x8e</span><span class="op" id="4089106">,</span>&nbsp;<span class="num" id="4089108">0xe3</span><span class="op" id="4089112">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4089115">0x7f</span><span class="op" id="4089119">,</span>&nbsp;<span class="num" id="4089121">0xc7</span><span class="op" id="4089125">,</span>&nbsp;<span class="num" id="4089127">0x4b</span><span class="op" id="4089131">,</span>&nbsp;<span class="num" id="4089133">0x7e</span><span class="op" id="4089137">,</span>&nbsp;<span class="num" id="4089139">0x5a</span><span class="op" id="4089143">,</span>&nbsp;<span class="num" id="4089145">0x9f</span><span class="op" id="4089149">,</span>&nbsp;<span class="num" id="4089151">0xb3</span><span class="op" id="4089155">,</span>&nbsp;<span class="num" id="4089157">0xff</span><span class="op" id="4089161">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4089164">0x62</span><span class="op" id="4089168">,</span>&nbsp;<span class="num" id="4089170">0xab</span><span class="op" id="4089174">,</span>&nbsp;<span class="num" id="4089176">0x73</span><span class="op" id="4089180">,</span>&nbsp;<span class="num" id="4089182">0xc8</span><span class="op" id="4089186">,</span>&nbsp;<span class="num" id="4089188">0x28</span><span class="op" id="4089192">,</span>&nbsp;<span class="num" id="4089194">0x6b</span><span class="op" id="4089198">,</span>&nbsp;<span class="num" id="4089200">0xba</span><span class="op" id="4089204">,</span>&nbsp;<span class="num" id="4089206">0x10</span><span class="op" id="4089210">,</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4089213">0x64</span><span class="op" id="4089217">,</span>&nbsp;<span class="num" id="4089219">0x82</span><span class="op" id="4089223">,</span>&nbsp;<span class="num" id="4089225">0x87</span><span class="op" id="4089229">,</span>&nbsp;<span class="num" id="4089231">0x13</span><span class="op" id="4089235">,</span>&nbsp;<span class="num" id="4089237">0xcd</span><span class="op" id="4089241">,</span>&nbsp;<span class="num" id="4089243">0x57</span><span class="op" id="4089247">,</span>&nbsp;<span class="num" id="4089249">0x18</span><span class="op" id="4089253">,</span>&nbsp;<span class="num" id="4089255">0xff</span><span class="op" id="4089259">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4089262">0x28</span><span class="op" id="4089266">,</span>&nbsp;<span class="num" id="4089268">0xce</span><span class="op" id="4089272">,</span>&nbsp;<span class="num" id="4089274">0xc0</span><span class="op" id="4089278">,</span>&nbsp;<span class="num" id="4089280">0xe6</span><span class="op" id="4089284">,</span>&nbsp;<span class="num" id="4089286">0x0e</span><span class="op" id="4089290">,</span>&nbsp;<span class="num" id="4089292">0x06</span><span class="op" id="4089296">,</span>&nbsp;<span class="num" id="4089298">0x91</span><span class="op" id="4089302">,</span>&nbsp;<span class="num" id="4089304">0x50</span><span class="op" id="4089308">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4089311">0x29</span><span class="op" id="4089315">,</span>&nbsp;<span class="num" id="4089317">0x83</span><span class="op" id="4089321">,</span>&nbsp;<span class="num" id="4089323">0xd1</span><span class="op" id="4089327">,</span>&nbsp;<span class="num" id="4089329">0xf2</span><span class="op" id="4089333">,</span>&nbsp;<span class="num" id="4089335">0xc3</span><span class="op" id="4089339">,</span>&nbsp;<span class="num" id="4089341">0x2a</span><span class="op" id="4089345">,</span>&nbsp;<span class="num" id="4089347">0xdb</span><span class="op" id="4089351">,</span>&nbsp;<span class="num" id="4089353">0xd8</span><span class="op" id="4089357">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4089360">0xdb</span><span class="op" id="4089364">,</span>&nbsp;<span class="num" id="4089366">0x4e</span><span class="op" id="4089370">,</span>&nbsp;<span class="num" id="4089372">0x04</span><span class="op" id="4089376">,</span>&nbsp;<span class="num" id="4089378">0xcc</span><span class="op" id="4089382">,</span>&nbsp;<span class="num" id="4089384">0x00</span><span class="op" id="4089388">,</span>&nbsp;<span class="num" id="4089390">0xeb</span><span class="op" id="4089394">,</span>&nbsp;<span class="num" id="4089396">0x8b</span><span class="op" id="4089400">,</span>&nbsp;<span class="num" id="4089402">0xb6</span><span class="op" id="4089406">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4089409">0x96</span><span class="op" id="4089413">,</span>&nbsp;<span class="num" id="4089415">0xdc</span><span class="op" id="4089419">,</span>&nbsp;<span class="num" id="4089421">0xbc</span><span class="op" id="4089425">,</span>&nbsp;<span class="num" id="4089427">0xaa</span><span class="op" id="4089431">,</span>&nbsp;<span class="num" id="4089433">0xfa</span><span class="op" id="4089437">,</span>&nbsp;<span class="num" id="4089439">0x52</span><span class="op" id="4089443">,</span>&nbsp;<span class="num" id="4089445">0x77</span><span class="op" id="4089449">,</span>&nbsp;<span class="num" id="4089451">0x04</span><span class="op" id="4089455">,</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4089458">0xc1</span><span class="op" id="4089462">,</span>&nbsp;<span class="num" id="4089464">0xdb</span><span class="op" id="4089468">,</span>&nbsp;<span class="num" id="4089470">0x19</span><span class="op" id="4089474">,</span>&nbsp;<span class="num" id="4089476">0xe4</span><span class="op" id="4089480">,</span>&nbsp;<span class="num" id="4089482">0xae</span><span class="op" id="4089486">,</span>&nbsp;<span class="num" id="4089488">0x9c</span><span class="op" id="4089492">,</span>&nbsp;<span class="num" id="4089494">0xfd</span><span class="op" id="4089498">,</span>&nbsp;<span class="num" id="4089500">0x3c</span><span class="op" id="4089504">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4089507">0x8b</span><span class="op" id="4089511">,</span>&nbsp;<span class="num" id="4089513">0x03</span><span class="op" id="4089517">,</span>&nbsp;<span class="num" id="4089519">0xef</span><span class="op" id="4089523">,</span>&nbsp;<span class="num" id="4089525">0x4d</span><span class="op" id="4089529">,</span>&nbsp;<span class="num" id="4089531">0xbc</span><span class="op" id="4089535">,</span>&nbsp;<span class="num" id="4089537">0x1a</span><span class="op" id="4089541">,</span>&nbsp;<span class="num" id="4089543">0x03</span><span class="op" id="4089547">,</span>&nbsp;<span class="num" id="4089549">0x65</span><span class="op" id="4089553">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4089556">0xf9</span><span class="op" id="4089560">,</span>&nbsp;<span class="num" id="4089562">0xc1</span><span class="op" id="4089566">,</span>&nbsp;<span class="num" id="4089568">0xb1</span><span class="op" id="4089572">,</span>&nbsp;<span class="num" id="4089574">0x3f</span><span class="op" id="4089578">,</span>&nbsp;<span class="num" id="4089580">0x72</span><span class="op" id="4089584">,</span>&nbsp;<span class="num" id="4089586">0x86</span><span class="op" id="4089590">,</span>&nbsp;<span class="num" id="4089592">0xf2</span><span class="op" id="4089596">,</span>&nbsp;<span class="num" id="4089598">0x38</span><span class="op" id="4089602">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4089605">0xaa</span><span class="op" id="4089609">,</span>&nbsp;<span class="num" id="4089611">0x19</span><span class="op" id="4089615">,</span>&nbsp;<span class="num" id="4089617">0xae</span><span class="op" id="4089621">,</span>&nbsp;<span class="num" id="4089623">0x10</span><span class="op" id="4089627">,</span>&nbsp;<span class="num" id="4089629">0x88</span><span class="op" id="4089633">,</span>&nbsp;<span class="num" id="4089635">0x78</span><span class="op" id="4089639">,</span>&nbsp;<span class="num" id="4089641">0x28</span><span class="op" id="4089645">,</span>&nbsp;<span class="num" id="4089647">0xda</span><span class="op" id="4089651">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4089654">0x75</span><span class="op" id="4089658">,</span>&nbsp;<span class="num" id="4089660">0xc3</span><span class="op" id="4089664">,</span>&nbsp;<span class="num" id="4089666">0x3d</span><span class="op" id="4089670">,</span>&nbsp;<span class="num" id="4089672">0x02</span><span class="op" id="4089676">,</span>&nbsp;<span class="num" id="4089678">0x82</span><span class="op" id="4089682">,</span>&nbsp;<span class="num" id="4089684">0x02</span><span class="op" id="4089688">,</span>&nbsp;<span class="num" id="4089690">0x9c</span><span class="op" id="4089694">,</span>&nbsp;<span class="num" id="4089696">0xb9</span><span class="op" id="4089700">,</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4089703">0xc1</span><span class="op" id="4089707">,</span>&nbsp;<span class="num" id="4089709">0x65</span><span class="op" id="4089713">,</span>&nbsp;<span class="num" id="4089715">0x77</span><span class="op" id="4089719">,</span>&nbsp;<span class="num" id="4089721">0x76</span><span class="op" id="4089725">,</span>&nbsp;<span class="num" id="4089727">0x24</span><span class="op" id="4089731">,</span>&nbsp;<span class="num" id="4089733">0x4c</span><span class="op" id="4089737">,</span>&nbsp;<span class="num" id="4089739">0x98</span><span class="op" id="4089743">,</span>&nbsp;<span class="num" id="4089745">0xf7</span><span class="op" id="4089749">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4089752">0x6d</span><span class="op" id="4089756">,</span>&nbsp;<span class="num" id="4089758">0x31</span><span class="op" id="4089762">,</span>&nbsp;<span class="num" id="4089764">0x38</span><span class="op" id="4089768">,</span>&nbsp;<span class="num" id="4089770">0xfb</span><span class="op" id="4089774">,</span>&nbsp;<span class="num" id="4089776">0xdb</span><span class="op" id="4089780">,</span>&nbsp;<span class="num" id="4089782">0xfe</span><span class="op" id="4089786">,</span>&nbsp;<span class="num" id="4089788">0xdb</span><span class="op" id="4089792">,</span>&nbsp;<span class="num" id="4089794">0x37</span><span class="op" id="4089798">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4089801">0x02</span><span class="op" id="4089805">,</span>&nbsp;<span class="num" id="4089807">0x76</span><span class="op" id="4089811">,</span>&nbsp;<span class="num" id="4089813">0xa1</span><span class="op" id="4089817">,</span>&nbsp;<span class="num" id="4089819">0x18</span><span class="op" id="4089823">,</span>&nbsp;<span class="num" id="4089825">0x97</span><span class="op" id="4089829">,</span>&nbsp;<span class="num" id="4089831">0xa6</span><span class="op" id="4089835">,</span>&nbsp;<span class="num" id="4089837">0xcc</span><span class="op" id="4089841">,</span>&nbsp;<span class="num" id="4089843">0xde</span><span class="op" id="4089847">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4089850">0x20</span><span class="op" id="4089854">,</span>&nbsp;<span class="num" id="4089856">0x09</span><span class="op" id="4089860">,</span>&nbsp;<span class="num" id="4089862">0x49</span><span class="op" id="4089866">,</span>&nbsp;<span class="num" id="4089868">0x36</span><span class="op" id="4089872">,</span>&nbsp;<span class="num" id="4089874">0x24</span><span class="op" id="4089878">,</span>&nbsp;<span class="num" id="4089880">0x69</span><span class="op" id="4089884">,</span>&nbsp;<span class="num" id="4089886">0x42</span><span class="op" id="4089890">,</span>&nbsp;<span class="num" id="4089892">0xf6</span><span class="op" id="4089896">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4089899">0xe4</span><span class="op" id="4089903">,</span>&nbsp;<span class="num" id="4089905">0x37</span><span class="op" id="4089909">,</span>&nbsp;<span class="num" id="4089911">0x62</span><span class="op" id="4089915">,</span>&nbsp;<span class="num" id="4089917">0xf1</span><span class="op" id="4089921">,</span>&nbsp;<span class="num" id="4089923">0x59</span><span class="op" id="4089927">,</span>&nbsp;<span class="num" id="4089929">0x6d</span><span class="op" id="4089933">,</span>&nbsp;<span class="num" id="4089935">0xa9</span><span class="op" id="4089939">,</span>&nbsp;<span class="num" id="4089941">0x3c</span><span class="op" id="4089945">,</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4089948">0xed</span><span class="op" id="4089952">,</span>&nbsp;<span class="num" id="4089954">0x34</span><span class="op" id="4089958">,</span>&nbsp;<span class="num" id="4089960">0x9c</span><span class="op" id="4089964">,</span>&nbsp;<span class="num" id="4089966">0xa3</span><span class="op" id="4089970">,</span>&nbsp;<span class="num" id="4089972">0x8e</span><span class="op" id="4089976">,</span>&nbsp;<span class="num" id="4089978">0xdb</span><span class="op" id="4089982">,</span>&nbsp;<span class="num" id="4089984">0xdc</span><span class="op" id="4089988">,</span>&nbsp;<span class="num" id="4089990">0x3a</span><span class="op" id="4089994">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4089997">0xd7</span><span class="op" id="4090001">,</span>&nbsp;<span class="num" id="4090003">0xf7</span><span class="op" id="4090007">,</span>&nbsp;<span class="num" id="4090009">0x0a</span><span class="op" id="4090013">,</span>&nbsp;<span class="num" id="4090015">0x6f</span><span class="op" id="4090019">,</span>&nbsp;<span class="num" id="4090021">0xef</span><span class="op" id="4090025">,</span>&nbsp;<span class="num" id="4090027">0x2e</span><span class="op" id="4090031">,</span>&nbsp;<span class="num" id="4090033">0xd8</span><span class="op" id="4090037">,</span>&nbsp;<span class="num" id="4090039">0xd5</span><span class="op" id="4090043">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4090046">0x93</span><span class="op" id="4090050">,</span>&nbsp;<span class="num" id="4090052">0x5a</span><span class="op" id="4090056">,</span>&nbsp;<span class="num" id="4090058">0x7a</span><span class="op" id="4090062">,</span>&nbsp;<span class="num" id="4090064">0xed</span><span class="op" id="4090068">,</span>&nbsp;<span class="num" id="4090070">0x08</span><span class="op" id="4090074">,</span>&nbsp;<span class="num" id="4090076">0x49</span><span class="op" id="4090080">,</span>&nbsp;<span class="num" id="4090082">0x68</span><span class="op" id="4090086">,</span>&nbsp;<span class="num" id="4090088">0xe2</span><span class="op" id="4090092">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4090095">0x41</span><span class="op" id="4090099">,</span>&nbsp;<span class="num" id="4090101">0xe3</span><span class="op" id="4090105">,</span>&nbsp;<span class="num" id="4090107">0x5a</span><span class="op" id="4090111">,</span>&nbsp;<span class="num" id="4090113">0x90</span><span class="op" id="4090117">,</span>&nbsp;<span class="num" id="4090119">0xc1</span><span class="op" id="4090123">,</span>&nbsp;<span class="num" id="4090125">0x86</span><span class="op" id="4090129">,</span>&nbsp;<span class="num" id="4090131">0x55</span><span class="op" id="4090135">,</span>&nbsp;<span class="num" id="4090137">0xfc</span><span class="op" id="4090141">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4090144">0x51</span><span class="op" id="4090148">,</span>&nbsp;<span class="num" id="4090150">0x43</span><span class="op" id="4090154">,</span>&nbsp;<span class="num" id="4090156">0x9d</span><span class="op" id="4090160">,</span>&nbsp;<span class="num" id="4090162">0xe0</span><span class="op" id="4090166">,</span>&nbsp;<span class="num" id="4090168">0xb2</span><span class="op" id="4090172">,</span>&nbsp;<span class="num" id="4090174">0xc4</span><span class="op" id="4090178">,</span>&nbsp;<span class="num" id="4090180">0x67</span><span class="op" id="4090184">,</span>&nbsp;<span class="num" id="4090186">0xb4</span><span class="op" id="4090190">,</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4090193">0xcb</span><span class="op" id="4090197">,</span>&nbsp;<span class="num" id="4090199">0x32</span><span class="op" id="4090203">,</span>&nbsp;<span class="num" id="4090205">0x31</span><span class="op" id="4090209">,</span>&nbsp;<span class="num" id="4090211">0x25</span><span class="op" id="4090215">,</span>&nbsp;<span class="num" id="4090217">0xf0</span><span class="op" id="4090221">,</span>&nbsp;<span class="num" id="4090223">0x54</span><span class="op" id="4090227">,</span>&nbsp;<span class="num" id="4090229">0x9f</span><span class="op" id="4090233">,</span>&nbsp;<span class="num" id="4090235">0x4b</span><span class="op" id="4090239">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4090242">0xd1</span><span class="op" id="4090246">,</span>&nbsp;<span class="num" id="4090248">0x6f</span><span class="op" id="4090252">,</span>&nbsp;<span class="num" id="4090254">0xdb</span><span class="op" id="4090258">,</span>&nbsp;<span class="num" id="4090260">0xd4</span><span class="op" id="4090264">,</span>&nbsp;<span class="num" id="4090266">0xdd</span><span class="op" id="4090270">,</span>&nbsp;<span class="num" id="4090272">0xfc</span><span class="op" id="4090276">,</span>&nbsp;<span class="num" id="4090278">0xaf</span><span class="op" id="4090282">,</span>&nbsp;<span class="num" id="4090284">0x5e</span><span class="op" id="4090288">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4090291">0x6c</span><span class="op" id="4090295">,</span>&nbsp;<span class="num" id="4090297">0x78</span><span class="op" id="4090301">,</span>&nbsp;<span class="num" id="4090303">0x90</span><span class="op" id="4090307">,</span>&nbsp;<span class="num" id="4090309">0x95</span><span class="op" id="4090313">,</span>&nbsp;<span class="num" id="4090315">0xde</span><span class="op" id="4090319">,</span>&nbsp;<span class="num" id="4090321">0xca</span><span class="op" id="4090325">,</span>&nbsp;<span class="num" id="4090327">0x3a</span><span class="op" id="4090331">,</span>&nbsp;<span class="num" id="4090333">0x48</span><span class="op" id="4090337">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4090340">0xb9</span><span class="op" id="4090344">,</span>&nbsp;<span class="num" id="4090346">0x79</span><span class="op" id="4090350">,</span>&nbsp;<span class="num" id="4090352">0x3c</span><span class="op" id="4090356">,</span>&nbsp;<span class="num" id="4090358">0x9b</span><span class="op" id="4090362">,</span>&nbsp;<span class="num" id="4090364">0x19</span><span class="op" id="4090368">,</span>&nbsp;<span class="num" id="4090370">0xd6</span><span class="op" id="4090374">,</span>&nbsp;<span class="num" id="4090376">0x75</span><span class="op" id="4090380">,</span>&nbsp;<span class="num" id="4090382">0x05</span><span class="op" id="4090386">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4090389">0xa0</span><span class="op" id="4090393">,</span>&nbsp;<span class="num" id="4090395">0xf9</span><span class="op" id="4090399">,</span>&nbsp;<span class="num" id="4090401">0x88</span><span class="op" id="4090405">,</span>&nbsp;<span class="num" id="4090407">0xd7</span><span class="op" id="4090411">,</span>&nbsp;<span class="num" id="4090413">0xc1</span><span class="op" id="4090417">,</span>&nbsp;<span class="num" id="4090419">0xe8</span><span class="op" id="4090423">,</span>&nbsp;<span class="num" id="4090425">0xa5</span><span class="op" id="4090429">,</span>&nbsp;<span class="num" id="4090431">0x09</span><span class="op" id="4090435">,</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4090438">0xe4</span><span class="op" id="4090442">,</span>&nbsp;<span class="num" id="4090444">0x1a</span><span class="op" id="4090448">,</span>&nbsp;<span class="num" id="4090450">0x15</span><span class="op" id="4090454">,</span>&nbsp;<span class="num" id="4090456">0xdc</span><span class="op" id="4090460">,</span>&nbsp;<span class="num" id="4090462">0x87</span><span class="op" id="4090466">,</span>&nbsp;<span class="num" id="4090468">0x23</span><span class="op" id="4090472">,</span>&nbsp;<span class="num" id="4090474">0xaa</span><span class="op" id="4090478">,</span>&nbsp;<span class="num" id="4090480">0xb2</span><span class="op" id="4090484">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4090487">0x75</span><span class="op" id="4090491">,</span>&nbsp;<span class="num" id="4090493">0x8c</span><span class="op" id="4090497">,</span>&nbsp;<span class="num" id="4090499">0x63</span><span class="op" id="4090503">,</span>&nbsp;<span class="num" id="4090505">0x25</span><span class="op" id="4090509">,</span>&nbsp;<span class="num" id="4090511">0x87</span><span class="op" id="4090515">,</span>&nbsp;<span class="num" id="4090517">0xd8</span><span class="op" id="4090521">,</span>&nbsp;<span class="num" id="4090523">0xf8</span><span class="op" id="4090527">,</span>&nbsp;<span class="num" id="4090529">0x3d</span><span class="op" id="4090533">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4090536">0xa6</span><span class="op" id="4090540">,</span>&nbsp;<span class="num" id="4090542">0xc2</span><span class="op" id="4090546">,</span>&nbsp;<span class="num" id="4090548">0xcc</span><span class="op" id="4090552">,</span>&nbsp;<span class="num" id="4090554">0x66</span><span class="op" id="4090558">,</span>&nbsp;<span class="num" id="4090560">0xff</span><span class="op" id="4090564">,</span>&nbsp;<span class="num" id="4090566">0xa5</span><span class="op" id="4090570">,</span>&nbsp;<span class="num" id="4090572">0x66</span><span class="op" id="4090576">,</span>&nbsp;<span class="num" id="4090578">0x68</span><span class="op" id="4090582">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4090585">0x55</span><span class="op" id="4090589">,</span>&nbsp;<span class="num" id="4090591">0x02</span><span class="op" id="4090595">,</span>&nbsp;<span class="num" id="4090597">0x03</span><span class="op" id="4090601">,</span>&nbsp;<span class="num" id="4090603">0x01</span><span class="op" id="4090607">,</span>&nbsp;<span class="num" id="4090609">0x00</span><span class="op" id="4090613">,</span>&nbsp;<span class="num" id="4090615">0x01</span><span class="op" id="4090619">,</span><br>
<span class="lineno"></span><span class="op" id="4090621">}</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span><span class="comment" id="4090624">//&nbsp;CheckSignatureFrom&nbsp;verifies&nbsp;that&nbsp;the&nbsp;signature&nbsp;on&nbsp;c&nbsp;is&nbsp;a&nbsp;valid&nbsp;signature</span><br>
<span class="lineno"></span><span class="comment" id="4090700">//&nbsp;from&nbsp;parent.</span><br>
<span class="lineno"></span><span class="keyword" id="4090716">func</span>&nbsp;<span class="op" id="4090721">(</span><span class="ident" id="4090722">c</span>&nbsp;<span class="op" id="4090724">*</span><span class="ident" id="4090725">Certificate</span><span class="op" id="4090736">)</span>&nbsp;<span class="ident" id="4090738">CheckSignatureFrom</span><span class="op" id="4090756">(</span><span class="ident" id="4090757">parent</span>&nbsp;<span class="op" id="4090764">*</span><span class="ident" id="4090765">Certificate</span><span class="op" id="4090776">)</span>&nbsp;<span class="op" id="4090778">(</span><span class="ident" id="4090779">err</span>&nbsp;<span class="builtintype" id="4090783">error</span><span class="op" id="4090788">)</span>&nbsp;<span class="op" id="4090790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4090793">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.9:</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4090816">//&nbsp;&#34;If&nbsp;the&nbsp;basic&nbsp;constraints&nbsp;extension&nbsp;is&nbsp;not&nbsp;present&nbsp;in&nbsp;a&nbsp;version&nbsp;3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4090886">//&nbsp;certificate,&nbsp;or&nbsp;the&nbsp;extension&nbsp;is&nbsp;present&nbsp;but&nbsp;the&nbsp;cA&nbsp;boolean&nbsp;is&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4090957">//&nbsp;asserted,&nbsp;then&nbsp;the&nbsp;certified&nbsp;public&nbsp;key&nbsp;MUST&nbsp;NOT&nbsp;be&nbsp;used&nbsp;to&nbsp;verify</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4091028">//&nbsp;certificate&nbsp;signatures.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4091057">//&nbsp;(except&nbsp;for&nbsp;Entrust,&nbsp;see&nbsp;comment&nbsp;above&nbsp;entrustBrokenSPKI)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4091119">if</span>&nbsp;<span class="op" id="4091122">(</span><span class="ident" id="4091123">parent</span><span class="op" id="4091129">.</span><span class="ident" id="4091130">Version</span>&nbsp;<span class="op" id="4091138">==</span>&nbsp;<span class="num" id="4091141">3</span>&nbsp;<span class="op" id="4091143">&amp;&amp;</span>&nbsp;<span class="op" id="4091146">!</span><span class="ident" id="4091147">parent</span><span class="op" id="4091153">.</span><span class="ident" id="4091154">BasicConstraintsValid</span>&nbsp;<span class="op" id="4091176">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4091181">parent</span><span class="op" id="4091187">.</span><span class="ident" id="4091188">BasicConstraintsValid</span>&nbsp;<span class="op" id="4091210">&amp;&amp;</span>&nbsp;<span class="op" id="4091213">!</span><span class="ident" id="4091214">parent</span><span class="op" id="4091220">.</span><span class="ident" id="4091221">IsCA</span><span class="op" id="4091225">)</span>&nbsp;<span class="op" id="4091227">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4091232">!</span><span class="ident" id="4091233">bytes</span><span class="op" id="4091238">.</span><span class="ident" id="4091239">Equal</span><span class="op" id="4091244">(</span><span class="ident" id="4091245">c</span><span class="op" id="4091246">.</span><span class="ident" id="4091247">RawSubjectPublicKeyInfo</span><span class="op" id="4091270">,</span>&nbsp;<span class="ident" id="4091272">entrustBrokenSPKI</span><span class="op" id="4091289">)</span>&nbsp;<span class="op" id="4091291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4091295">return</span>&nbsp;<span class="ident" id="4091302">ConstraintViolationError</span><span class="op" id="4091326">{</span><span class="op" id="4091327">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4091330">}</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4091334">if</span>&nbsp;<span class="ident" id="4091337">parent</span><span class="op" id="4091343">.</span><span class="ident" id="4091344">KeyUsage</span>&nbsp;<span class="op" id="4091353">!=</span>&nbsp;<span class="num" id="4091356">0</span>&nbsp;<span class="op" id="4091358">&amp;&amp;</span>&nbsp;<span class="ident" id="4091361">parent</span><span class="op" id="4091367">.</span><span class="ident" id="4091368">KeyUsage</span><span class="op" id="4091376">&amp;</span><span class="ident" id="4091377">KeyUsageCertSign</span>&nbsp;<span class="op" id="4091394">==</span>&nbsp;<span class="num" id="4091397">0</span>&nbsp;<span class="op" id="4091399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4091403">return</span>&nbsp;<span class="ident" id="4091410">ConstraintViolationError</span><span class="op" id="4091434">{</span><span class="op" id="4091435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4091438">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4091442">if</span>&nbsp;<span class="ident" id="4091445">parent</span><span class="op" id="4091451">.</span><span class="ident" id="4091452">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="4091471">==</span>&nbsp;<span class="ident" id="4091474">UnknownPublicKeyAlgorithm</span>&nbsp;<span class="op" id="4091500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4091504">return</span>&nbsp;<span class="ident" id="4091511">ErrUnsupportedAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4091536">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4091540">//&nbsp;TODO(agl):&nbsp;don&#39;t&nbsp;ignore&nbsp;the&nbsp;path&nbsp;length&nbsp;constraint.</span><br>
<span class="lineno">615</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4091597">return</span>&nbsp;<span class="ident" id="4091604">parent</span><span class="op" id="4091610">.</span><span class="ident" id="4091611">CheckSignature</span><span class="op" id="4091625">(</span><span class="ident" id="4091626">c</span><span class="op" id="4091627">.</span><span class="ident" id="4091628">SignatureAlgorithm</span><span class="op" id="4091646">,</span>&nbsp;<span class="ident" id="4091648">c</span><span class="op" id="4091649">.</span><span class="ident" id="4091650">RawTBSCertificate</span><span class="op" id="4091667">,</span>&nbsp;<span class="ident" id="4091669">c</span><span class="op" id="4091670">.</span><span class="ident" id="4091671">Signature</span><span class="op" id="4091680">)</span><br>
<span class="lineno"></span><span class="op" id="4091682">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4091685">//&nbsp;CheckSignature&nbsp;verifies&nbsp;that&nbsp;signature&nbsp;is&nbsp;a&nbsp;valid&nbsp;signature&nbsp;over&nbsp;signed&nbsp;from</span><br>
<span class="lineno">620</span><span class="comment" id="4091765">//&nbsp;c&#39;s&nbsp;public&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="4091784">func</span>&nbsp;<span class="op" id="4091789">(</span><span class="ident" id="4091790">c</span>&nbsp;<span class="op" id="4091792">*</span><span class="ident" id="4091793">Certificate</span><span class="op" id="4091804">)</span>&nbsp;<span class="ident" id="4091806">CheckSignature</span><span class="op" id="4091820">(</span><span class="ident" id="4091821">algo</span>&nbsp;<span class="ident" id="4091826">SignatureAlgorithm</span><span class="op" id="4091844">,</span>&nbsp;<span class="ident" id="4091846">signed</span><span class="op" id="4091852">,</span>&nbsp;<span class="ident" id="4091854">signature</span>&nbsp;<span class="op" id="4091864">[</span><span class="op" id="4091865">]</span><span class="builtintype" id="4091866">byte</span><span class="op" id="4091870">)</span>&nbsp;<span class="op" id="4091872">(</span><span class="ident" id="4091873">err</span>&nbsp;<span class="builtintype" id="4091877">error</span><span class="op" id="4091882">)</span>&nbsp;<span class="op" id="4091884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4091887">var</span>&nbsp;<span class="ident" id="4091891">hashType</span>&nbsp;<span class="ident" id="4091900">crypto</span><span class="op" id="4091906">.</span><span class="ident" id="4091907">Hash</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4091914">switch</span>&nbsp;<span class="ident" id="4091921">algo</span>&nbsp;<span class="op" id="4091926">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4091929">case</span>&nbsp;<span class="ident" id="4091934">SHA1WithRSA</span><span class="op" id="4091945">,</span>&nbsp;<span class="ident" id="4091947">DSAWithSHA1</span><span class="op" id="4091958">,</span>&nbsp;<span class="ident" id="4091960">ECDSAWithSHA1</span><span class="op" id="4091973">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4091977">hashType</span>&nbsp;<span class="op" id="4091986">=</span>&nbsp;<span class="ident" id="4091988">crypto</span><span class="op" id="4091994">.</span><span class="ident" id="4091995">SHA1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4092001">case</span>&nbsp;<span class="ident" id="4092006">SHA256WithRSA</span><span class="op" id="4092019">,</span>&nbsp;<span class="ident" id="4092021">DSAWithSHA256</span><span class="op" id="4092034">,</span>&nbsp;<span class="ident" id="4092036">ECDSAWithSHA256</span><span class="op" id="4092051">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4092055">hashType</span>&nbsp;<span class="op" id="4092064">=</span>&nbsp;<span class="ident" id="4092066">crypto</span><span class="op" id="4092072">.</span><span class="ident" id="4092073">SHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4092081">case</span>&nbsp;<span class="ident" id="4092086">SHA384WithRSA</span><span class="op" id="4092099">,</span>&nbsp;<span class="ident" id="4092101">ECDSAWithSHA384</span><span class="op" id="4092116">:</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4092120">hashType</span>&nbsp;<span class="op" id="4092129">=</span>&nbsp;<span class="ident" id="4092131">crypto</span><span class="op" id="4092137">.</span><span class="ident" id="4092138">SHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4092146">case</span>&nbsp;<span class="ident" id="4092151">SHA512WithRSA</span><span class="op" id="4092164">,</span>&nbsp;<span class="ident" id="4092166">ECDSAWithSHA512</span><span class="op" id="4092181">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4092185">hashType</span>&nbsp;<span class="op" id="4092194">=</span>&nbsp;<span class="ident" id="4092196">crypto</span><span class="op" id="4092202">.</span><span class="ident" id="4092203">SHA512</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4092211">default</span><span class="op" id="4092218">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4092222">return</span>&nbsp;<span class="ident" id="4092229">ErrUnsupportedAlgorithm</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4092254">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4092258">if</span>&nbsp;<span class="op" id="4092261">!</span><span class="ident" id="4092262">hashType</span><span class="op" id="4092270">.</span><span class="ident" id="4092271">Available</span><span class="op" id="4092280">(</span><span class="op" id="4092281">)</span>&nbsp;<span class="op" id="4092283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4092287">return</span>&nbsp;<span class="ident" id="4092294">ErrUnsupportedAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4092319">}</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4092322">h</span>&nbsp;<span class="op" id="4092324">:=</span>&nbsp;<span class="ident" id="4092327">hashType</span><span class="op" id="4092335">.</span><span class="ident" id="4092336">New</span><span class="op" id="4092339">(</span><span class="op" id="4092340">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4092344">h</span><span class="op" id="4092345">.</span><span class="ident" id="4092346">Write</span><span class="op" id="4092351">(</span><span class="ident" id="4092352">signed</span><span class="op" id="4092358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4092361">digest</span>&nbsp;<span class="op" id="4092368">:=</span>&nbsp;<span class="ident" id="4092371">h</span><span class="op" id="4092372">.</span><span class="ident" id="4092373">Sum</span><span class="op" id="4092376">(</span><span class="ident" id="4092377">nil</span><span class="op" id="4092380">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4092384">switch</span>&nbsp;<span class="ident" id="4092391">pub</span>&nbsp;<span class="op" id="4092395">:=</span>&nbsp;<span class="ident" id="4092398">c</span><span class="op" id="4092399">.</span><span class="ident" id="4092400">PublicKey</span><span class="op" id="4092409">.</span><span class="op" id="4092410">(</span><span class="keyword" id="4092411">type</span><span class="op" id="4092415">)</span>&nbsp;<span class="op" id="4092417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4092420">case</span>&nbsp;<span class="op" id="4092425">*</span><span class="ident" id="4092426">rsa</span><span class="op" id="4092429">.</span><span class="ident" id="4092430">PublicKey</span><span class="op" id="4092439">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4092443">return</span>&nbsp;<span class="ident" id="4092450">rsa</span><span class="op" id="4092453">.</span><span class="ident" id="4092454">VerifyPKCS1v15</span><span class="op" id="4092468">(</span><span class="ident" id="4092469">pub</span><span class="op" id="4092472">,</span>&nbsp;<span class="ident" id="4092474">hashType</span><span class="op" id="4092482">,</span>&nbsp;<span class="ident" id="4092484">digest</span><span class="op" id="4092490">,</span>&nbsp;<span class="ident" id="4092492">signature</span><span class="op" id="4092501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4092504">case</span>&nbsp;<span class="op" id="4092509">*</span><span class="ident" id="4092510">dsa</span><span class="op" id="4092513">.</span><span class="ident" id="4092514">PublicKey</span><span class="op" id="4092523">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4092527">dsaSig</span>&nbsp;<span class="op" id="4092534">:=</span>&nbsp;<span class="builtinfunc" id="4092537">new</span><span class="op" id="4092540">(</span><span class="ident" id="4092541">dsaSignature</span><span class="op" id="4092553">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4092557">if</span>&nbsp;<span class="ident" id="4092560">_</span><span class="op" id="4092561">,</span>&nbsp;<span class="ident" id="4092563">err</span>&nbsp;<span class="op" id="4092567">:=</span>&nbsp;<span class="ident" id="4092570">asn1</span><span class="op" id="4092574">.</span><span class="ident" id="4092575">Unmarshal</span><span class="op" id="4092584">(</span><span class="ident" id="4092585">signature</span><span class="op" id="4092594">,</span>&nbsp;<span class="ident" id="4092596">dsaSig</span><span class="op" id="4092602">)</span><span class="op" id="4092603">;</span>&nbsp;<span class="ident" id="4092605">err</span>&nbsp;<span class="op" id="4092609">!=</span>&nbsp;<span class="ident" id="4092612">nil</span>&nbsp;<span class="op" id="4092616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4092621">return</span>&nbsp;<span class="ident" id="4092628">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4092634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4092638">if</span>&nbsp;<span class="ident" id="4092641">dsaSig</span><span class="op" id="4092647">.</span><span class="ident" id="4092648">R</span><span class="op" id="4092649">.</span><span class="ident" id="4092650">Sign</span><span class="op" id="4092654">(</span><span class="op" id="4092655">)</span>&nbsp;<span class="op" id="4092657">&lt;=</span>&nbsp;<span class="num" id="4092660">0</span>&nbsp;<span class="op" id="4092662">||</span>&nbsp;<span class="ident" id="4092665">dsaSig</span><span class="op" id="4092671">.</span><span class="ident" id="4092672">S</span><span class="op" id="4092673">.</span><span class="ident" id="4092674">Sign</span><span class="op" id="4092678">(</span><span class="op" id="4092679">)</span>&nbsp;<span class="op" id="4092681">&lt;=</span>&nbsp;<span class="num" id="4092684">0</span>&nbsp;<span class="op" id="4092686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4092691">return</span>&nbsp;<span class="ident" id="4092698">errors</span><span class="op" id="4092704">.</span><span class="ident" id="4092705">New</span><span class="op" id="4092708">(</span><span class="string" id="4092709">&#34;x509:&nbsp;DSA&nbsp;signature&nbsp;contained&nbsp;zero&nbsp;or&nbsp;negative&nbsp;values&#34;</span><span class="op" id="4092764">)</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4092768">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4092772">if</span>&nbsp;<span class="op" id="4092775">!</span><span class="ident" id="4092776">dsa</span><span class="op" id="4092779">.</span><span class="ident" id="4092780">Verify</span><span class="op" id="4092786">(</span><span class="ident" id="4092787">pub</span><span class="op" id="4092790">,</span>&nbsp;<span class="ident" id="4092792">digest</span><span class="op" id="4092798">,</span>&nbsp;<span class="ident" id="4092800">dsaSig</span><span class="op" id="4092806">.</span><span class="ident" id="4092807">R</span><span class="op" id="4092808">,</span>&nbsp;<span class="ident" id="4092810">dsaSig</span><span class="op" id="4092816">.</span><span class="ident" id="4092817">S</span><span class="op" id="4092818">)</span>&nbsp;<span class="op" id="4092820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4092825">return</span>&nbsp;<span class="ident" id="4092832">errors</span><span class="op" id="4092838">.</span><span class="ident" id="4092839">New</span><span class="op" id="4092842">(</span><span class="string" id="4092843">&#34;x509:&nbsp;DSA&nbsp;verification&nbsp;failure&#34;</span><span class="op" id="4092875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4092879">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4092883">return</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4092891">case</span>&nbsp;<span class="op" id="4092896">*</span><span class="ident" id="4092897">ecdsa</span><span class="op" id="4092902">.</span><span class="ident" id="4092903">PublicKey</span><span class="op" id="4092912">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4092916">ecdsaSig</span>&nbsp;<span class="op" id="4092925">:=</span>&nbsp;<span class="builtinfunc" id="4092928">new</span><span class="op" id="4092931">(</span><span class="ident" id="4092932">ecdsaSignature</span><span class="op" id="4092946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4092950">if</span>&nbsp;<span class="ident" id="4092953">_</span><span class="op" id="4092954">,</span>&nbsp;<span class="ident" id="4092956">err</span>&nbsp;<span class="op" id="4092960">:=</span>&nbsp;<span class="ident" id="4092963">asn1</span><span class="op" id="4092967">.</span><span class="ident" id="4092968">Unmarshal</span><span class="op" id="4092977">(</span><span class="ident" id="4092978">signature</span><span class="op" id="4092987">,</span>&nbsp;<span class="ident" id="4092989">ecdsaSig</span><span class="op" id="4092997">)</span><span class="op" id="4092998">;</span>&nbsp;<span class="ident" id="4093000">err</span>&nbsp;<span class="op" id="4093004">!=</span>&nbsp;<span class="ident" id="4093007">nil</span>&nbsp;<span class="op" id="4093011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4093016">return</span>&nbsp;<span class="ident" id="4093023">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4093029">}</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4093033">if</span>&nbsp;<span class="ident" id="4093036">ecdsaSig</span><span class="op" id="4093044">.</span><span class="ident" id="4093045">R</span><span class="op" id="4093046">.</span><span class="ident" id="4093047">Sign</span><span class="op" id="4093051">(</span><span class="op" id="4093052">)</span>&nbsp;<span class="op" id="4093054">&lt;=</span>&nbsp;<span class="num" id="4093057">0</span>&nbsp;<span class="op" id="4093059">||</span>&nbsp;<span class="ident" id="4093062">ecdsaSig</span><span class="op" id="4093070">.</span><span class="ident" id="4093071">S</span><span class="op" id="4093072">.</span><span class="ident" id="4093073">Sign</span><span class="op" id="4093077">(</span><span class="op" id="4093078">)</span>&nbsp;<span class="op" id="4093080">&lt;=</span>&nbsp;<span class="num" id="4093083">0</span>&nbsp;<span class="op" id="4093085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4093090">return</span>&nbsp;<span class="ident" id="4093097">errors</span><span class="op" id="4093103">.</span><span class="ident" id="4093104">New</span><span class="op" id="4093107">(</span><span class="string" id="4093108">&#34;x509:&nbsp;ECDSA&nbsp;signature&nbsp;contained&nbsp;zero&nbsp;or&nbsp;negative&nbsp;values&#34;</span><span class="op" id="4093165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4093169">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4093173">if</span>&nbsp;<span class="op" id="4093176">!</span><span class="ident" id="4093177">ecdsa</span><span class="op" id="4093182">.</span><span class="ident" id="4093183">Verify</span><span class="op" id="4093189">(</span><span class="ident" id="4093190">pub</span><span class="op" id="4093193">,</span>&nbsp;<span class="ident" id="4093195">digest</span><span class="op" id="4093201">,</span>&nbsp;<span class="ident" id="4093203">ecdsaSig</span><span class="op" id="4093211">.</span><span class="ident" id="4093212">R</span><span class="op" id="4093213">,</span>&nbsp;<span class="ident" id="4093215">ecdsaSig</span><span class="op" id="4093223">.</span><span class="ident" id="4093224">S</span><span class="op" id="4093225">)</span>&nbsp;<span class="op" id="4093227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4093232">return</span>&nbsp;<span class="ident" id="4093239">errors</span><span class="op" id="4093245">.</span><span class="ident" id="4093246">New</span><span class="op" id="4093249">(</span><span class="string" id="4093250">&#34;x509:&nbsp;ECDSA&nbsp;verification&nbsp;failure&#34;</span><span class="op" id="4093284">)</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4093288">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4093292">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4093300">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4093303">return</span>&nbsp;<span class="ident" id="4093310">ErrUnsupportedAlgorithm</span><br>
<span class="lineno"></span><span class="op" id="4093334">}</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span><span class="comment" id="4093337">//&nbsp;CheckCRLSignature&nbsp;checks&nbsp;that&nbsp;the&nbsp;signature&nbsp;in&nbsp;crl&nbsp;is&nbsp;from&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="4093402">func</span>&nbsp;<span class="op" id="4093407">(</span><span class="ident" id="4093408">c</span>&nbsp;<span class="op" id="4093410">*</span><span class="ident" id="4093411">Certificate</span><span class="op" id="4093422">)</span>&nbsp;<span class="ident" id="4093424">CheckCRLSignature</span><span class="op" id="4093441">(</span><span class="ident" id="4093442">crl</span>&nbsp;<span class="op" id="4093446">*</span><span class="ident" id="4093447">pkix</span><span class="op" id="4093451">.</span><span class="ident" id="4093452">CertificateList</span><span class="op" id="4093467">)</span>&nbsp;<span class="op" id="4093469">(</span><span class="ident" id="4093470">err</span>&nbsp;<span class="builtintype" id="4093474">error</span><span class="op" id="4093479">)</span>&nbsp;<span class="op" id="4093481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4093484">algo</span>&nbsp;<span class="op" id="4093489">:=</span>&nbsp;<span class="ident" id="4093492">getSignatureAlgorithmFromOID</span><span class="op" id="4093520">(</span><span class="ident" id="4093521">crl</span><span class="op" id="4093524">.</span><span class="ident" id="4093525">SignatureAlgorithm</span><span class="op" id="4093543">.</span><span class="ident" id="4093544">Algorithm</span><span class="op" id="4093553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4093556">return</span>&nbsp;<span class="ident" id="4093563">c</span><span class="op" id="4093564">.</span><span class="ident" id="4093565">CheckSignature</span><span class="op" id="4093579">(</span><span class="ident" id="4093580">algo</span><span class="op" id="4093584">,</span>&nbsp;<span class="ident" id="4093586">crl</span><span class="op" id="4093589">.</span><span class="ident" id="4093590">TBSCertList</span><span class="op" id="4093601">.</span><span class="ident" id="4093602">Raw</span><span class="op" id="4093605">,</span>&nbsp;<span class="ident" id="4093607">crl</span><span class="op" id="4093610">.</span><span class="ident" id="4093611">SignatureValue</span><span class="op" id="4093625">.</span><span class="ident" id="4093626">RightAlign</span><span class="op" id="4093636">(</span><span class="op" id="4093637">)</span><span class="op" id="4093638">)</span><br>
<span class="lineno">680</span><span class="op" id="4093640">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4093643">type</span>&nbsp;<span class="ident" id="4093648">UnhandledCriticalExtension</span>&nbsp;<span class="keyword" id="4093675">struct</span><span class="op" id="4093681">{</span><span class="op" id="4093682">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4093685">func</span>&nbsp;<span class="op" id="4093690">(</span><span class="ident" id="4093691">h</span>&nbsp;<span class="ident" id="4093693">UnhandledCriticalExtension</span><span class="op" id="4093719">)</span>&nbsp;<span class="ident" id="4093721">Error</span><span class="op" id="4093726">(</span><span class="op" id="4093727">)</span>&nbsp;<span class="builtintype" id="4093729">string</span>&nbsp;<span class="op" id="4093736">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4093739">return</span>&nbsp;<span class="string" id="4093746">&#34;x509:&nbsp;unhandled&nbsp;critical&nbsp;extension&#34;</span><br>
<span class="lineno"></span><span class="op" id="4093783">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4093786">type</span>&nbsp;<span class="ident" id="4093791">basicConstraints</span>&nbsp;<span class="keyword" id="4093808">struct</span>&nbsp;<span class="op" id="4093815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4093818">IsCA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4093829">bool</span>&nbsp;<span class="string" id="4093834">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4093853">MaxPathLen</span>&nbsp;<span class="builtintype" id="4093864">int</span>&nbsp;&nbsp;<span class="string" id="4093869">`asn1:&#34;optional,default:-1&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4093898">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4093901">//&nbsp;RFC&nbsp;5280&nbsp;4.2.1.4</span><br>
<span class="lineno"></span><span class="keyword" id="4093921">type</span>&nbsp;<span class="ident" id="4093926">policyInformation</span>&nbsp;<span class="keyword" id="4093944">struct</span>&nbsp;<span class="op" id="4093951">{</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4093954">Policy</span>&nbsp;<span class="ident" id="4093961">asn1</span><span class="op" id="4093965">.</span><span class="ident" id="4093966">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4093984">//&nbsp;policyQualifiers&nbsp;omitted</span><br>
<span class="lineno"></span><span class="op" id="4094012">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4094015">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.10</span><br>
<span class="lineno">700</span><span class="keyword" id="4094037">type</span>&nbsp;<span class="ident" id="4094042">nameConstraints</span>&nbsp;<span class="keyword" id="4094058">struct</span>&nbsp;<span class="op" id="4094065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4094068">Permitted</span>&nbsp;<span class="op" id="4094078">[</span><span class="op" id="4094079">]</span><span class="ident" id="4094080">generalSubtree</span>&nbsp;<span class="string" id="4094095">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4094120">Excluded</span>&nbsp;&nbsp;<span class="op" id="4094130">[</span><span class="op" id="4094131">]</span><span class="ident" id="4094132">generalSubtree</span>&nbsp;<span class="string" id="4094147">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4094171">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">705</span><span class="keyword" id="4094174">type</span>&nbsp;<span class="ident" id="4094179">generalSubtree</span>&nbsp;<span class="keyword" id="4094194">struct</span>&nbsp;<span class="op" id="4094201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4094204">Name</span>&nbsp;<span class="builtintype" id="4094209">string</span>&nbsp;<span class="string" id="4094216">`asn1:&#34;tag:2,optional,ia5&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4094244">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4094247">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.2.1</span><br>
<span class="lineno">710</span><span class="keyword" id="4094268">type</span>&nbsp;<span class="ident" id="4094273">authorityInfoAccess</span>&nbsp;<span class="keyword" id="4094293">struct</span>&nbsp;<span class="op" id="4094300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4094303">Method</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4094312">asn1</span><span class="op" id="4094316">.</span><span class="ident" id="4094317">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4094335">Location</span>&nbsp;<span class="ident" id="4094344">asn1</span><span class="op" id="4094348">.</span><span class="ident" id="4094349">RawValue</span><br>
<span class="lineno"></span><span class="op" id="4094358">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">715</span><span class="comment" id="4094361">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.14</span><br>
<span class="lineno"></span><span class="keyword" id="4094383">type</span>&nbsp;<span class="ident" id="4094388">distributionPoint</span>&nbsp;<span class="keyword" id="4094406">struct</span>&nbsp;<span class="op" id="4094413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4094416">DistributionPoint</span>&nbsp;<span class="ident" id="4094434">distributionPointName</span>&nbsp;<span class="string" id="4094456">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4094481">Reason</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4094499">asn1</span><span class="op" id="4094503">.</span><span class="ident" id="4094504">BitString</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4094521">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4094546">CRLIssuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4094564">asn1</span><span class="op" id="4094568">.</span><span class="ident" id="4094569">RawValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4094586">`asn1:&#34;optional,tag:2&#34;`</span><br>
<span class="lineno">720</span><span class="op" id="4094610">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4094613">type</span>&nbsp;<span class="ident" id="4094618">distributionPointName</span>&nbsp;<span class="keyword" id="4094640">struct</span>&nbsp;<span class="op" id="4094647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4094650">FullName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4094663">asn1</span><span class="op" id="4094667">.</span><span class="ident" id="4094668">RawValue</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4094680">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4094705">RelativeName</span>&nbsp;<span class="ident" id="4094718">pkix</span><span class="op" id="4094722">.</span><span class="ident" id="4094723">RDNSequence</span>&nbsp;<span class="string" id="4094735">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno">725</span><span class="op" id="4094759">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4094762">func</span>&nbsp;<span class="ident" id="4094767">parsePublicKey</span><span class="op" id="4094781">(</span><span class="ident" id="4094782">algo</span>&nbsp;<span class="ident" id="4094787">PublicKeyAlgorithm</span><span class="op" id="4094805">,</span>&nbsp;<span class="ident" id="4094807">keyData</span>&nbsp;<span class="op" id="4094815">*</span><span class="ident" id="4094816">publicKeyInfo</span><span class="op" id="4094829">)</span>&nbsp;<span class="op" id="4094831">(</span><span class="keyword" id="4094832">interface</span><span class="op" id="4094841">{</span><span class="op" id="4094842">}</span><span class="op" id="4094843">,</span>&nbsp;<span class="builtintype" id="4094845">error</span><span class="op" id="4094850">)</span>&nbsp;<span class="op" id="4094852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4094855">asn1Data</span>&nbsp;<span class="op" id="4094864">:=</span>&nbsp;<span class="ident" id="4094867">keyData</span><span class="op" id="4094874">.</span><span class="ident" id="4094875">PublicKey</span><span class="op" id="4094884">.</span><span class="ident" id="4094885">RightAlign</span><span class="op" id="4094895">(</span><span class="op" id="4094896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4094899">switch</span>&nbsp;<span class="ident" id="4094906">algo</span>&nbsp;<span class="op" id="4094911">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4094914">case</span>&nbsp;<span class="ident" id="4094919">RSA</span><span class="op" id="4094922">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4094926">p</span>&nbsp;<span class="op" id="4094928">:=</span>&nbsp;<span class="builtinfunc" id="4094931">new</span><span class="op" id="4094934">(</span><span class="ident" id="4094935">rsaPublicKey</span><span class="op" id="4094947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4094951">_</span><span class="op" id="4094952">,</span>&nbsp;<span class="ident" id="4094954">err</span>&nbsp;<span class="op" id="4094958">:=</span>&nbsp;<span class="ident" id="4094961">asn1</span><span class="op" id="4094965">.</span><span class="ident" id="4094966">Unmarshal</span><span class="op" id="4094975">(</span><span class="ident" id="4094976">asn1Data</span><span class="op" id="4094984">,</span>&nbsp;<span class="ident" id="4094986">p</span><span class="op" id="4094987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4094991">if</span>&nbsp;<span class="ident" id="4094994">err</span>&nbsp;<span class="op" id="4094998">!=</span>&nbsp;<span class="ident" id="4095001">nil</span>&nbsp;<span class="op" id="4095005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4095010">return</span>&nbsp;<span class="ident" id="4095017">nil</span><span class="op" id="4095020">,</span>&nbsp;<span class="ident" id="4095022">err</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4095028">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4095033">if</span>&nbsp;<span class="ident" id="4095036">p</span><span class="op" id="4095037">.</span><span class="ident" id="4095038">N</span><span class="op" id="4095039">.</span><span class="ident" id="4095040">Sign</span><span class="op" id="4095044">(</span><span class="op" id="4095045">)</span>&nbsp;<span class="op" id="4095047">&lt;=</span>&nbsp;<span class="num" id="4095050">0</span>&nbsp;<span class="op" id="4095052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4095057">return</span>&nbsp;<span class="ident" id="4095064">nil</span><span class="op" id="4095067">,</span>&nbsp;<span class="ident" id="4095069">errors</span><span class="op" id="4095075">.</span><span class="ident" id="4095076">New</span><span class="op" id="4095079">(</span><span class="string" id="4095080">&#34;x509:&nbsp;RSA&nbsp;modulus&nbsp;is&nbsp;not&nbsp;a&nbsp;positive&nbsp;number&#34;</span><span class="op" id="4095124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4095128">}</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4095132">if</span>&nbsp;<span class="ident" id="4095135">p</span><span class="op" id="4095136">.</span><span class="ident" id="4095137">E</span>&nbsp;<span class="op" id="4095139">&lt;=</span>&nbsp;<span class="num" id="4095142">0</span>&nbsp;<span class="op" id="4095144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4095149">return</span>&nbsp;<span class="ident" id="4095156">nil</span><span class="op" id="4095159">,</span>&nbsp;<span class="ident" id="4095161">errors</span><span class="op" id="4095167">.</span><span class="ident" id="4095168">New</span><span class="op" id="4095171">(</span><span class="string" id="4095172">&#34;x509:&nbsp;RSA&nbsp;public&nbsp;exponent&nbsp;is&nbsp;not&nbsp;a&nbsp;positive&nbsp;number&#34;</span><span class="op" id="4095224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4095228">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4095233">pub</span>&nbsp;<span class="op" id="4095237">:=</span>&nbsp;<span class="op" id="4095240">&amp;</span><span class="ident" id="4095241">rsa</span><span class="op" id="4095244">.</span><span class="ident" id="4095245">PublicKey</span><span class="op" id="4095254">{</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4095259">E</span><span class="op" id="4095260">:</span>&nbsp;<span class="ident" id="4095262">p</span><span class="op" id="4095263">.</span><span class="ident" id="4095264">E</span><span class="op" id="4095265">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4095270">N</span><span class="op" id="4095271">:</span>&nbsp;<span class="ident" id="4095273">p</span><span class="op" id="4095274">.</span><span class="ident" id="4095275">N</span><span class="op" id="4095276">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4095280">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4095284">return</span>&nbsp;<span class="ident" id="4095291">pub</span><span class="op" id="4095294">,</span>&nbsp;<span class="ident" id="4095296">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4095301">case</span>&nbsp;<span class="ident" id="4095306">DSA</span><span class="op" id="4095309">:</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4095313">var</span>&nbsp;<span class="ident" id="4095317">p</span>&nbsp;<span class="op" id="4095319">*</span><span class="ident" id="4095320">big</span><span class="op" id="4095323">.</span><span class="ident" id="4095324">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4095330">_</span><span class="op" id="4095331">,</span>&nbsp;<span class="ident" id="4095333">err</span>&nbsp;<span class="op" id="4095337">:=</span>&nbsp;<span class="ident" id="4095340">asn1</span><span class="op" id="4095344">.</span><span class="ident" id="4095345">Unmarshal</span><span class="op" id="4095354">(</span><span class="ident" id="4095355">asn1Data</span><span class="op" id="4095363">,</span>&nbsp;<span class="op" id="4095365">&amp;</span><span class="ident" id="4095366">p</span><span class="op" id="4095367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4095371">if</span>&nbsp;<span class="ident" id="4095374">err</span>&nbsp;<span class="op" id="4095378">!=</span>&nbsp;<span class="ident" id="4095381">nil</span>&nbsp;<span class="op" id="4095385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4095390">return</span>&nbsp;<span class="ident" id="4095397">nil</span><span class="op" id="4095400">,</span>&nbsp;<span class="ident" id="4095402">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4095408">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4095412">paramsData</span>&nbsp;<span class="op" id="4095423">:=</span>&nbsp;<span class="ident" id="4095426">keyData</span><span class="op" id="4095433">.</span><span class="ident" id="4095434">Algorithm</span><span class="op" id="4095443">.</span><span class="ident" id="4095444">Parameters</span><span class="op" id="4095454">.</span><span class="ident" id="4095455">FullBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4095467">params</span>&nbsp;<span class="op" id="4095474">:=</span>&nbsp;<span class="builtinfunc" id="4095477">new</span><span class="op" id="4095480">(</span><span class="ident" id="4095481">dsaAlgorithmParameters</span><span class="op" id="4095503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4095507">_</span><span class="op" id="4095508">,</span>&nbsp;<span class="ident" id="4095510">err</span>&nbsp;<span class="op" id="4095514">=</span>&nbsp;<span class="ident" id="4095516">asn1</span><span class="op" id="4095520">.</span><span class="ident" id="4095521">Unmarshal</span><span class="op" id="4095530">(</span><span class="ident" id="4095531">paramsData</span><span class="op" id="4095541">,</span>&nbsp;<span class="ident" id="4095543">params</span><span class="op" id="4095549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4095553">if</span>&nbsp;<span class="ident" id="4095556">err</span>&nbsp;<span class="op" id="4095560">!=</span>&nbsp;<span class="ident" id="4095563">nil</span>&nbsp;<span class="op" id="4095567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4095572">return</span>&nbsp;<span class="ident" id="4095579">nil</span><span class="op" id="4095582">,</span>&nbsp;<span class="ident" id="4095584">err</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4095590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4095594">if</span>&nbsp;<span class="ident" id="4095597">p</span><span class="op" id="4095598">.</span><span class="ident" id="4095599">Sign</span><span class="op" id="4095603">(</span><span class="op" id="4095604">)</span>&nbsp;<span class="op" id="4095606">&lt;=</span>&nbsp;<span class="num" id="4095609">0</span>&nbsp;<span class="op" id="4095611">||</span>&nbsp;<span class="ident" id="4095614">params</span><span class="op" id="4095620">.</span><span class="ident" id="4095621">P</span><span class="op" id="4095622">.</span><span class="ident" id="4095623">Sign</span><span class="op" id="4095627">(</span><span class="op" id="4095628">)</span>&nbsp;<span class="op" id="4095630">&lt;=</span>&nbsp;<span class="num" id="4095633">0</span>&nbsp;<span class="op" id="4095635">||</span>&nbsp;<span class="ident" id="4095638">params</span><span class="op" id="4095644">.</span><span class="ident" id="4095645">Q</span><span class="op" id="4095646">.</span><span class="ident" id="4095647">Sign</span><span class="op" id="4095651">(</span><span class="op" id="4095652">)</span>&nbsp;<span class="op" id="4095654">&lt;=</span>&nbsp;<span class="num" id="4095657">0</span>&nbsp;<span class="op" id="4095659">||</span>&nbsp;<span class="ident" id="4095662">params</span><span class="op" id="4095668">.</span><span class="ident" id="4095669">G</span><span class="op" id="4095670">.</span><span class="ident" id="4095671">Sign</span><span class="op" id="4095675">(</span><span class="op" id="4095676">)</span>&nbsp;<span class="op" id="4095678">&lt;=</span>&nbsp;<span class="num" id="4095681">0</span>&nbsp;<span class="op" id="4095683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4095688">return</span>&nbsp;<span class="ident" id="4095695">nil</span><span class="op" id="4095698">,</span>&nbsp;<span class="ident" id="4095700">errors</span><span class="op" id="4095706">.</span><span class="ident" id="4095707">New</span><span class="op" id="4095710">(</span><span class="string" id="4095711">&#34;x509:&nbsp;zero&nbsp;or&nbsp;negative&nbsp;DSA&nbsp;parameter&#34;</span><span class="op" id="4095749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4095753">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4095757">pub</span>&nbsp;<span class="op" id="4095761">:=</span>&nbsp;<span class="op" id="4095764">&amp;</span><span class="ident" id="4095765">dsa</span><span class="op" id="4095768">.</span><span class="ident" id="4095769">PublicKey</span><span class="op" id="4095778">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4095783">Parameters</span><span class="op" id="4095793">:</span>&nbsp;<span class="ident" id="4095795">dsa</span><span class="op" id="4095798">.</span><span class="ident" id="4095799">Parameters</span><span class="op" id="4095809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4095815">P</span><span class="op" id="4095816">:</span>&nbsp;<span class="ident" id="4095818">params</span><span class="op" id="4095824">.</span><span class="ident" id="4095825">P</span><span class="op" id="4095826">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4095832">Q</span><span class="op" id="4095833">:</span>&nbsp;<span class="ident" id="4095835">params</span><span class="op" id="4095841">.</span><span class="ident" id="4095842">Q</span><span class="op" id="4095843">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4095849">G</span><span class="op" id="4095850">:</span>&nbsp;<span class="ident" id="4095852">params</span><span class="op" id="4095858">.</span><span class="ident" id="4095859">G</span><span class="op" id="4095860">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4095865">}</span><span class="op" id="4095866">,</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4095871">Y</span><span class="op" id="4095872">:</span>&nbsp;<span class="ident" id="4095874">p</span><span class="op" id="4095875">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4095879">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4095883">return</span>&nbsp;<span class="ident" id="4095890">pub</span><span class="op" id="4095893">,</span>&nbsp;<span class="ident" id="4095895">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4095900">case</span>&nbsp;<span class="ident" id="4095905">ECDSA</span><span class="op" id="4095910">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4095914">paramsData</span>&nbsp;<span class="op" id="4095925">:=</span>&nbsp;<span class="ident" id="4095928">keyData</span><span class="op" id="4095935">.</span><span class="ident" id="4095936">Algorithm</span><span class="op" id="4095945">.</span><span class="ident" id="4095946">Parameters</span><span class="op" id="4095956">.</span><span class="ident" id="4095957">FullBytes</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4095969">namedCurveOID</span>&nbsp;<span class="op" id="4095983">:=</span>&nbsp;<span class="builtinfunc" id="4095986">new</span><span class="op" id="4095989">(</span><span class="ident" id="4095990">asn1</span><span class="op" id="4095994">.</span><span class="ident" id="4095995">ObjectIdentifier</span><span class="op" id="4096011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4096015">_</span><span class="op" id="4096016">,</span>&nbsp;<span class="ident" id="4096018">err</span>&nbsp;<span class="op" id="4096022">:=</span>&nbsp;<span class="ident" id="4096025">asn1</span><span class="op" id="4096029">.</span><span class="ident" id="4096030">Unmarshal</span><span class="op" id="4096039">(</span><span class="ident" id="4096040">paramsData</span><span class="op" id="4096050">,</span>&nbsp;<span class="ident" id="4096052">namedCurveOID</span><span class="op" id="4096065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4096069">if</span>&nbsp;<span class="ident" id="4096072">err</span>&nbsp;<span class="op" id="4096076">!=</span>&nbsp;<span class="ident" id="4096079">nil</span>&nbsp;<span class="op" id="4096083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4096088">return</span>&nbsp;<span class="ident" id="4096095">nil</span><span class="op" id="4096098">,</span>&nbsp;<span class="ident" id="4096100">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4096106">}</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4096110">namedCurve</span>&nbsp;<span class="op" id="4096121">:=</span>&nbsp;<span class="ident" id="4096124">namedCurveFromOID</span><span class="op" id="4096141">(</span><span class="op" id="4096142">*</span><span class="ident" id="4096143">namedCurveOID</span><span class="op" id="4096156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4096160">if</span>&nbsp;<span class="ident" id="4096163">namedCurve</span>&nbsp;<span class="op" id="4096174">==</span>&nbsp;<span class="ident" id="4096177">nil</span>&nbsp;<span class="op" id="4096181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4096186">return</span>&nbsp;<span class="ident" id="4096193">nil</span><span class="op" id="4096196">,</span>&nbsp;<span class="ident" id="4096198">errors</span><span class="op" id="4096204">.</span><span class="ident" id="4096205">New</span><span class="op" id="4096208">(</span><span class="string" id="4096209">&#34;x509:&nbsp;unsupported&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4096243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4096247">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4096251">x</span><span class="op" id="4096252">,</span>&nbsp;<span class="ident" id="4096254">y</span>&nbsp;<span class="op" id="4096256">:=</span>&nbsp;<span class="ident" id="4096259">elliptic</span><span class="op" id="4096267">.</span><span class="ident" id="4096268">Unmarshal</span><span class="op" id="4096277">(</span><span class="ident" id="4096278">namedCurve</span><span class="op" id="4096288">,</span>&nbsp;<span class="ident" id="4096290">asn1Data</span><span class="op" id="4096298">)</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4096302">if</span>&nbsp;<span class="ident" id="4096305">x</span>&nbsp;<span class="op" id="4096307">==</span>&nbsp;<span class="ident" id="4096310">nil</span>&nbsp;<span class="op" id="4096314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4096319">return</span>&nbsp;<span class="ident" id="4096326">nil</span><span class="op" id="4096329">,</span>&nbsp;<span class="ident" id="4096331">errors</span><span class="op" id="4096337">.</span><span class="ident" id="4096338">New</span><span class="op" id="4096341">(</span><span class="string" id="4096342">&#34;x509:&nbsp;failed&nbsp;to&nbsp;unmarshal&nbsp;elliptic&nbsp;curve&nbsp;point&#34;</span><span class="op" id="4096390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4096394">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4096398">pub</span>&nbsp;<span class="op" id="4096402">:=</span>&nbsp;<span class="op" id="4096405">&amp;</span><span class="ident" id="4096406">ecdsa</span><span class="op" id="4096411">.</span><span class="ident" id="4096412">PublicKey</span><span class="op" id="4096421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4096426">Curve</span><span class="op" id="4096431">:</span>&nbsp;<span class="ident" id="4096433">namedCurve</span><span class="op" id="4096443">,</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4096448">X</span><span class="op" id="4096449">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4096455">x</span><span class="op" id="4096456">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4096461">Y</span><span class="op" id="4096462">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4096468">y</span><span class="op" id="4096469">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4096473">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4096477">return</span>&nbsp;<span class="ident" id="4096484">pub</span><span class="op" id="4096487">,</span>&nbsp;<span class="ident" id="4096489">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4096494">default</span><span class="op" id="4096501">:</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4096505">return</span>&nbsp;<span class="ident" id="4096512">nil</span><span class="op" id="4096515">,</span>&nbsp;<span class="ident" id="4096517">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4096522">}</span><br>
<span class="lineno"></span><span class="op" id="4096524">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4096527">func</span>&nbsp;<span class="ident" id="4096532">parseSANExtension</span><span class="op" id="4096549">(</span><span class="ident" id="4096550">value</span>&nbsp;<span class="op" id="4096556">[</span><span class="op" id="4096557">]</span><span class="builtintype" id="4096558">byte</span><span class="op" id="4096562">)</span>&nbsp;<span class="op" id="4096564">(</span><span class="ident" id="4096565">dnsNames</span><span class="op" id="4096573">,</span>&nbsp;<span class="ident" id="4096575">emailAddresses</span>&nbsp;<span class="op" id="4096590">[</span><span class="op" id="4096591">]</span><span class="builtintype" id="4096592">string</span><span class="op" id="4096598">,</span>&nbsp;<span class="ident" id="4096600">ipAddresses</span>&nbsp;<span class="op" id="4096612">[</span><span class="op" id="4096613">]</span><span class="ident" id="4096614">net</span><span class="op" id="4096617">.</span><span class="ident" id="4096618">IP</span><span class="op" id="4096620">,</span>&nbsp;<span class="ident" id="4096622">err</span>&nbsp;<span class="builtintype" id="4096626">error</span><span class="op" id="4096631">)</span>&nbsp;<span class="op" id="4096633">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4096636">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.6</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4096659">//&nbsp;SubjectAltName&nbsp;::=&nbsp;GeneralNames</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4096695">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4096699">//&nbsp;GeneralNames&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;GeneralName</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4096758">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4096762">//&nbsp;GeneralName&nbsp;::=&nbsp;CHOICE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4096791">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;otherName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OtherName,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4096851">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rfc822Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA5String,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4096911">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dNSName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA5String,</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4096971">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x400Address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[3]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORAddress,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4097031">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directoryName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Name,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4097086">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ediPartyName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[5]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EDIPartyName,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4097149">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uniformResourceIdentifier&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[6]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA5String,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4097209">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iPAddress&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[7]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OCTET&nbsp;STRING,</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4097272">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;registeredID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[8]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4097341">var</span>&nbsp;<span class="ident" id="4097345">seq</span>&nbsp;<span class="ident" id="4097349">asn1</span><span class="op" id="4097353">.</span><span class="ident" id="4097354">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4097364">if</span>&nbsp;<span class="ident" id="4097367">_</span><span class="op" id="4097368">,</span>&nbsp;<span class="ident" id="4097370">err</span>&nbsp;<span class="op" id="4097374">=</span>&nbsp;<span class="ident" id="4097376">asn1</span><span class="op" id="4097380">.</span><span class="ident" id="4097381">Unmarshal</span><span class="op" id="4097390">(</span><span class="ident" id="4097391">value</span><span class="op" id="4097396">,</span>&nbsp;<span class="op" id="4097398">&amp;</span><span class="ident" id="4097399">seq</span><span class="op" id="4097402">)</span><span class="op" id="4097403">;</span>&nbsp;<span class="ident" id="4097405">err</span>&nbsp;<span class="op" id="4097409">!=</span>&nbsp;<span class="ident" id="4097412">nil</span>&nbsp;<span class="op" id="4097416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4097420">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4097428">}</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4097431">if</span>&nbsp;<span class="op" id="4097434">!</span><span class="ident" id="4097435">seq</span><span class="op" id="4097438">.</span><span class="ident" id="4097439">IsCompound</span>&nbsp;<span class="op" id="4097450">||</span>&nbsp;<span class="ident" id="4097453">seq</span><span class="op" id="4097456">.</span><span class="ident" id="4097457">Tag</span>&nbsp;<span class="op" id="4097461">!=</span>&nbsp;<span class="num" id="4097464">16</span>&nbsp;<span class="op" id="4097467">||</span>&nbsp;<span class="ident" id="4097470">seq</span><span class="op" id="4097473">.</span><span class="ident" id="4097474">Class</span>&nbsp;<span class="op" id="4097480">!=</span>&nbsp;<span class="num" id="4097483">0</span>&nbsp;<span class="op" id="4097485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4097489">err</span>&nbsp;<span class="op" id="4097493">=</span>&nbsp;<span class="ident" id="4097495">asn1</span><span class="op" id="4097499">.</span><span class="ident" id="4097500">StructuralError</span><span class="op" id="4097515">{</span><span class="ident" id="4097516">Msg</span><span class="op" id="4097519">:</span>&nbsp;<span class="string" id="4097521">&#34;bad&nbsp;SAN&nbsp;sequence&#34;</span><span class="op" id="4097539">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4097543">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4097551">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4097555">rest</span>&nbsp;<span class="op" id="4097560">:=</span>&nbsp;<span class="ident" id="4097563">seq</span><span class="op" id="4097566">.</span><span class="ident" id="4097567">Bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4097574">for</span>&nbsp;<span class="builtinfunc" id="4097578">len</span><span class="op" id="4097581">(</span><span class="ident" id="4097582">rest</span><span class="op" id="4097586">)</span>&nbsp;<span class="op" id="4097588">&gt;</span>&nbsp;<span class="num" id="4097590">0</span>&nbsp;<span class="op" id="4097592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4097596">var</span>&nbsp;<span class="ident" id="4097600">v</span>&nbsp;<span class="ident" id="4097602">asn1</span><span class="op" id="4097606">.</span><span class="ident" id="4097607">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4097618">rest</span><span class="op" id="4097622">,</span>&nbsp;<span class="ident" id="4097624">err</span>&nbsp;<span class="op" id="4097628">=</span>&nbsp;<span class="ident" id="4097630">asn1</span><span class="op" id="4097634">.</span><span class="ident" id="4097635">Unmarshal</span><span class="op" id="4097644">(</span><span class="ident" id="4097645">rest</span><span class="op" id="4097649">,</span>&nbsp;<span class="op" id="4097651">&amp;</span><span class="ident" id="4097652">v</span><span class="op" id="4097653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4097657">if</span>&nbsp;<span class="ident" id="4097660">err</span>&nbsp;<span class="op" id="4097664">!=</span>&nbsp;<span class="ident" id="4097667">nil</span>&nbsp;<span class="op" id="4097671">{</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4097676">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4097685">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4097689">switch</span>&nbsp;<span class="ident" id="4097696">v</span><span class="op" id="4097697">.</span><span class="ident" id="4097698">Tag</span>&nbsp;<span class="op" id="4097702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4097706">case</span>&nbsp;<span class="num" id="4097711">1</span><span class="op" id="4097712">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4097717">emailAddresses</span>&nbsp;<span class="op" id="4097732">=</span>&nbsp;<span class="builtinfunc" id="4097734">append</span><span class="op" id="4097740">(</span><span class="ident" id="4097741">emailAddresses</span><span class="op" id="4097755">,</span>&nbsp;<span class="builtintype" id="4097757">string</span><span class="op" id="4097763">(</span><span class="ident" id="4097764">v</span><span class="op" id="4097765">.</span><span class="ident" id="4097766">Bytes</span><span class="op" id="4097771">)</span><span class="op" id="4097772">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4097776">case</span>&nbsp;<span class="num" id="4097781">2</span><span class="op" id="4097782">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4097787">dnsNames</span>&nbsp;<span class="op" id="4097796">=</span>&nbsp;<span class="builtinfunc" id="4097798">append</span><span class="op" id="4097804">(</span><span class="ident" id="4097805">dnsNames</span><span class="op" id="4097813">,</span>&nbsp;<span class="builtintype" id="4097815">string</span><span class="op" id="4097821">(</span><span class="ident" id="4097822">v</span><span class="op" id="4097823">.</span><span class="ident" id="4097824">Bytes</span><span class="op" id="4097829">)</span><span class="op" id="4097830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4097834">case</span>&nbsp;<span class="num" id="4097839">7</span><span class="op" id="4097840">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4097845">switch</span>&nbsp;<span class="builtinfunc" id="4097852">len</span><span class="op" id="4097855">(</span><span class="ident" id="4097856">v</span><span class="op" id="4097857">.</span><span class="ident" id="4097858">Bytes</span><span class="op" id="4097863">)</span>&nbsp;<span class="op" id="4097865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4097870">case</span>&nbsp;<span class="ident" id="4097875">net</span><span class="op" id="4097878">.</span><span class="ident" id="4097879">IPv4len</span><span class="op" id="4097886">,</span>&nbsp;<span class="ident" id="4097888">net</span><span class="op" id="4097891">.</span><span class="ident" id="4097892">IPv6len</span><span class="op" id="4097899">:</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4097905">ipAddresses</span>&nbsp;<span class="op" id="4097917">=</span>&nbsp;<span class="builtinfunc" id="4097919">append</span><span class="op" id="4097925">(</span><span class="ident" id="4097926">ipAddresses</span><span class="op" id="4097937">,</span>&nbsp;<span class="ident" id="4097939">v</span><span class="op" id="4097940">.</span><span class="ident" id="4097941">Bytes</span><span class="op" id="4097946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4097951">default</span><span class="op" id="4097958">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4097964">err</span>&nbsp;<span class="op" id="4097968">=</span>&nbsp;<span class="ident" id="4097970">errors</span><span class="op" id="4097976">.</span><span class="ident" id="4097977">New</span><span class="op" id="4097980">(</span><span class="string" id="4097981">&#34;x509:&nbsp;certificate&nbsp;contained&nbsp;IP&nbsp;address&nbsp;of&nbsp;length&nbsp;&#34;</span>&nbsp;<span class="op" id="4098033">+</span>&nbsp;<span class="ident" id="4098035">strconv</span><span class="op" id="4098042">.</span><span class="ident" id="4098043">Itoa</span><span class="op" id="4098047">(</span><span class="builtinfunc" id="4098048">len</span><span class="op" id="4098051">(</span><span class="ident" id="4098052">v</span><span class="op" id="4098053">.</span><span class="ident" id="4098054">Bytes</span><span class="op" id="4098059">)</span><span class="op" id="4098060">)</span><span class="op" id="4098061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4098067">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4098077">}</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4098081">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4098084">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4098088">return</span><br>
<span class="lineno"></span><span class="op" id="4098095">}</span><br>
<span class="lineno">850</span><br>
<span class="lineno"></span><span class="keyword" id="4098098">func</span>&nbsp;<span class="ident" id="4098103">parseCertificate</span><span class="op" id="4098119">(</span><span class="ident" id="4098120">in</span>&nbsp;<span class="op" id="4098123">*</span><span class="ident" id="4098124">certificate</span><span class="op" id="4098135">)</span>&nbsp;<span class="op" id="4098137">(</span><span class="op" id="4098138">*</span><span class="ident" id="4098139">Certificate</span><span class="op" id="4098150">,</span>&nbsp;<span class="builtintype" id="4098152">error</span><span class="op" id="4098157">)</span>&nbsp;<span class="op" id="4098159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4098162">out</span>&nbsp;<span class="op" id="4098166">:=</span>&nbsp;<span class="builtinfunc" id="4098169">new</span><span class="op" id="4098172">(</span><span class="ident" id="4098173">Certificate</span><span class="op" id="4098184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4098187">out</span><span class="op" id="4098190">.</span><span class="ident" id="4098191">Raw</span>&nbsp;<span class="op" id="4098195">=</span>&nbsp;<span class="ident" id="4098197">in</span><span class="op" id="4098199">.</span><span class="ident" id="4098200">Raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4098205">out</span><span class="op" id="4098208">.</span><span class="ident" id="4098209">RawTBSCertificate</span>&nbsp;<span class="op" id="4098227">=</span>&nbsp;<span class="ident" id="4098229">in</span><span class="op" id="4098231">.</span><span class="ident" id="4098232">TBSCertificate</span><span class="op" id="4098246">.</span><span class="ident" id="4098247">Raw</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4098252">out</span><span class="op" id="4098255">.</span><span class="ident" id="4098256">RawSubjectPublicKeyInfo</span>&nbsp;<span class="op" id="4098280">=</span>&nbsp;<span class="ident" id="4098282">in</span><span class="op" id="4098284">.</span><span class="ident" id="4098285">TBSCertificate</span><span class="op" id="4098299">.</span><span class="ident" id="4098300">PublicKey</span><span class="op" id="4098309">.</span><span class="ident" id="4098310">Raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4098315">out</span><span class="op" id="4098318">.</span><span class="ident" id="4098319">RawSubject</span>&nbsp;<span class="op" id="4098330">=</span>&nbsp;<span class="ident" id="4098332">in</span><span class="op" id="4098334">.</span><span class="ident" id="4098335">TBSCertificate</span><span class="op" id="4098349">.</span><span class="ident" id="4098350">Subject</span><span class="op" id="4098357">.</span><span class="ident" id="4098358">FullBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4098369">out</span><span class="op" id="4098372">.</span><span class="ident" id="4098373">RawIssuer</span>&nbsp;<span class="op" id="4098383">=</span>&nbsp;<span class="ident" id="4098385">in</span><span class="op" id="4098387">.</span><span class="ident" id="4098388">TBSCertificate</span><span class="op" id="4098402">.</span><span class="ident" id="4098403">Issuer</span><span class="op" id="4098409">.</span><span class="ident" id="4098410">FullBytes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4098422">out</span><span class="op" id="4098425">.</span><span class="ident" id="4098426">Signature</span>&nbsp;<span class="op" id="4098436">=</span>&nbsp;<span class="ident" id="4098438">in</span><span class="op" id="4098440">.</span><span class="ident" id="4098441">SignatureValue</span><span class="op" id="4098455">.</span><span class="ident" id="4098456">RightAlign</span><span class="op" id="4098466">(</span><span class="op" id="4098467">)</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4098470">out</span><span class="op" id="4098473">.</span><span class="ident" id="4098474">SignatureAlgorithm</span>&nbsp;<span class="op" id="4098493">=</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4098497">getSignatureAlgorithmFromOID</span><span class="op" id="4098525">(</span><span class="ident" id="4098526">in</span><span class="op" id="4098528">.</span><span class="ident" id="4098529">TBSCertificate</span><span class="op" id="4098543">.</span><span class="ident" id="4098544">SignatureAlgorithm</span><span class="op" id="4098562">.</span><span class="ident" id="4098563">Algorithm</span><span class="op" id="4098572">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4098576">out</span><span class="op" id="4098579">.</span><span class="ident" id="4098580">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="4098599">=</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4098603">getPublicKeyAlgorithmFromOID</span><span class="op" id="4098631">(</span><span class="ident" id="4098632">in</span><span class="op" id="4098634">.</span><span class="ident" id="4098635">TBSCertificate</span><span class="op" id="4098649">.</span><span class="ident" id="4098650">PublicKey</span><span class="op" id="4098659">.</span><span class="ident" id="4098660">Algorithm</span><span class="op" id="4098669">.</span><span class="ident" id="4098670">Algorithm</span><span class="op" id="4098679">)</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4098682">var</span>&nbsp;<span class="ident" id="4098686">err</span>&nbsp;<span class="builtintype" id="4098690">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4098697">out</span><span class="op" id="4098700">.</span><span class="ident" id="4098701">PublicKey</span><span class="op" id="4098710">,</span>&nbsp;<span class="ident" id="4098712">err</span>&nbsp;<span class="op" id="4098716">=</span>&nbsp;<span class="ident" id="4098718">parsePublicKey</span><span class="op" id="4098732">(</span><span class="ident" id="4098733">out</span><span class="op" id="4098736">.</span><span class="ident" id="4098737">PublicKeyAlgorithm</span><span class="op" id="4098755">,</span>&nbsp;<span class="op" id="4098757">&amp;</span><span class="ident" id="4098758">in</span><span class="op" id="4098760">.</span><span class="ident" id="4098761">TBSCertificate</span><span class="op" id="4098775">.</span><span class="ident" id="4098776">PublicKey</span><span class="op" id="4098785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4098788">if</span>&nbsp;<span class="ident" id="4098791">err</span>&nbsp;<span class="op" id="4098795">!=</span>&nbsp;<span class="ident" id="4098798">nil</span>&nbsp;<span class="op" id="4098802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4098806">return</span>&nbsp;<span class="ident" id="4098813">nil</span><span class="op" id="4098816">,</span>&nbsp;<span class="ident" id="4098818">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4098823">}</span><br>
<span class="lineno">870</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4098827">if</span>&nbsp;<span class="ident" id="4098830">in</span><span class="op" id="4098832">.</span><span class="ident" id="4098833">TBSCertificate</span><span class="op" id="4098847">.</span><span class="ident" id="4098848">SerialNumber</span><span class="op" id="4098860">.</span><span class="ident" id="4098861">Sign</span><span class="op" id="4098865">(</span><span class="op" id="4098866">)</span>&nbsp;<span class="op" id="4098868">&lt;</span>&nbsp;<span class="num" id="4098870">0</span>&nbsp;<span class="op" id="4098872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4098876">return</span>&nbsp;<span class="ident" id="4098883">nil</span><span class="op" id="4098886">,</span>&nbsp;<span class="ident" id="4098888">errors</span><span class="op" id="4098894">.</span><span class="ident" id="4098895">New</span><span class="op" id="4098898">(</span><span class="string" id="4098899">&#34;x509:&nbsp;negative&nbsp;serial&nbsp;number&#34;</span><span class="op" id="4098929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4098932">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4098936">out</span><span class="op" id="4098939">.</span><span class="ident" id="4098940">Version</span>&nbsp;<span class="op" id="4098948">=</span>&nbsp;<span class="ident" id="4098950">in</span><span class="op" id="4098952">.</span><span class="ident" id="4098953">TBSCertificate</span><span class="op" id="4098967">.</span><span class="ident" id="4098968">Version</span>&nbsp;<span class="op" id="4098976">+</span>&nbsp;<span class="num" id="4098978">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4098981">out</span><span class="op" id="4098984">.</span><span class="ident" id="4098985">SerialNumber</span>&nbsp;<span class="op" id="4098998">=</span>&nbsp;<span class="ident" id="4099000">in</span><span class="op" id="4099002">.</span><span class="ident" id="4099003">TBSCertificate</span><span class="op" id="4099017">.</span><span class="ident" id="4099018">SerialNumber</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4099033">var</span>&nbsp;<span class="ident" id="4099037">issuer</span><span class="op" id="4099043">,</span>&nbsp;<span class="ident" id="4099045">subject</span>&nbsp;<span class="ident" id="4099053">pkix</span><span class="op" id="4099057">.</span><span class="ident" id="4099058">RDNSequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4099071">if</span>&nbsp;<span class="ident" id="4099074">_</span><span class="op" id="4099075">,</span>&nbsp;<span class="ident" id="4099077">err</span>&nbsp;<span class="op" id="4099081">:=</span>&nbsp;<span class="ident" id="4099084">asn1</span><span class="op" id="4099088">.</span><span class="ident" id="4099089">Unmarshal</span><span class="op" id="4099098">(</span><span class="ident" id="4099099">in</span><span class="op" id="4099101">.</span><span class="ident" id="4099102">TBSCertificate</span><span class="op" id="4099116">.</span><span class="ident" id="4099117">Subject</span><span class="op" id="4099124">.</span><span class="ident" id="4099125">FullBytes</span><span class="op" id="4099134">,</span>&nbsp;<span class="op" id="4099136">&amp;</span><span class="ident" id="4099137">subject</span><span class="op" id="4099144">)</span><span class="op" id="4099145">;</span>&nbsp;<span class="ident" id="4099147">err</span>&nbsp;<span class="op" id="4099151">!=</span>&nbsp;<span class="ident" id="4099154">nil</span>&nbsp;<span class="op" id="4099158">{</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4099162">return</span>&nbsp;<span class="ident" id="4099169">nil</span><span class="op" id="4099172">,</span>&nbsp;<span class="ident" id="4099174">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4099179">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4099182">if</span>&nbsp;<span class="ident" id="4099185">_</span><span class="op" id="4099186">,</span>&nbsp;<span class="ident" id="4099188">err</span>&nbsp;<span class="op" id="4099192">:=</span>&nbsp;<span class="ident" id="4099195">asn1</span><span class="op" id="4099199">.</span><span class="ident" id="4099200">Unmarshal</span><span class="op" id="4099209">(</span><span class="ident" id="4099210">in</span><span class="op" id="4099212">.</span><span class="ident" id="4099213">TBSCertificate</span><span class="op" id="4099227">.</span><span class="ident" id="4099228">Issuer</span><span class="op" id="4099234">.</span><span class="ident" id="4099235">FullBytes</span><span class="op" id="4099244">,</span>&nbsp;<span class="op" id="4099246">&amp;</span><span class="ident" id="4099247">issuer</span><span class="op" id="4099253">)</span><span class="op" id="4099254">;</span>&nbsp;<span class="ident" id="4099256">err</span>&nbsp;<span class="op" id="4099260">!=</span>&nbsp;<span class="ident" id="4099263">nil</span>&nbsp;<span class="op" id="4099267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4099271">return</span>&nbsp;<span class="ident" id="4099278">nil</span><span class="op" id="4099281">,</span>&nbsp;<span class="ident" id="4099283">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4099288">}</span><br>
<span class="lineno">885</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4099292">out</span><span class="op" id="4099295">.</span><span class="ident" id="4099296">Issuer</span><span class="op" id="4099302">.</span><span class="ident" id="4099303">FillFromRDNSequence</span><span class="op" id="4099322">(</span><span class="op" id="4099323">&amp;</span><span class="ident" id="4099324">issuer</span><span class="op" id="4099330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4099333">out</span><span class="op" id="4099336">.</span><span class="ident" id="4099337">Subject</span><span class="op" id="4099344">.</span><span class="ident" id="4099345">FillFromRDNSequence</span><span class="op" id="4099364">(</span><span class="op" id="4099365">&amp;</span><span class="ident" id="4099366">subject</span><span class="op" id="4099373">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4099377">out</span><span class="op" id="4099380">.</span><span class="ident" id="4099381">NotBefore</span>&nbsp;<span class="op" id="4099391">=</span>&nbsp;<span class="ident" id="4099393">in</span><span class="op" id="4099395">.</span><span class="ident" id="4099396">TBSCertificate</span><span class="op" id="4099410">.</span><span class="ident" id="4099411">Validity</span><span class="op" id="4099419">.</span><span class="ident" id="4099420">NotBefore</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4099431">out</span><span class="op" id="4099434">.</span><span class="ident" id="4099435">NotAfter</span>&nbsp;<span class="op" id="4099444">=</span>&nbsp;<span class="ident" id="4099446">in</span><span class="op" id="4099448">.</span><span class="ident" id="4099449">TBSCertificate</span><span class="op" id="4099463">.</span><span class="ident" id="4099464">Validity</span><span class="op" id="4099472">.</span><span class="ident" id="4099473">NotAfter</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4099484">for</span>&nbsp;<span class="ident" id="4099488">_</span><span class="op" id="4099489">,</span>&nbsp;<span class="ident" id="4099491">e</span>&nbsp;<span class="op" id="4099493">:=</span>&nbsp;<span class="keyword" id="4099496">range</span>&nbsp;<span class="ident" id="4099502">in</span><span class="op" id="4099504">.</span><span class="ident" id="4099505">TBSCertificate</span><span class="op" id="4099519">.</span><span class="ident" id="4099520">Extensions</span>&nbsp;<span class="op" id="4099531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4099535">out</span><span class="op" id="4099538">.</span><span class="ident" id="4099539">Extensions</span>&nbsp;<span class="op" id="4099550">=</span>&nbsp;<span class="builtinfunc" id="4099552">append</span><span class="op" id="4099558">(</span><span class="ident" id="4099559">out</span><span class="op" id="4099562">.</span><span class="ident" id="4099563">Extensions</span><span class="op" id="4099573">,</span>&nbsp;<span class="ident" id="4099575">e</span><span class="op" id="4099576">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4099581">if</span>&nbsp;<span class="builtinfunc" id="4099584">len</span><span class="op" id="4099587">(</span><span class="ident" id="4099588">e</span><span class="op" id="4099589">.</span><span class="ident" id="4099590">Id</span><span class="op" id="4099592">)</span>&nbsp;<span class="op" id="4099594">==</span>&nbsp;<span class="num" id="4099597">4</span>&nbsp;<span class="op" id="4099599">&amp;&amp;</span>&nbsp;<span class="ident" id="4099602">e</span><span class="op" id="4099603">.</span><span class="ident" id="4099604">Id</span><span class="op" id="4099606">[</span><span class="num" id="4099607">0</span><span class="op" id="4099608">]</span>&nbsp;<span class="op" id="4099610">==</span>&nbsp;<span class="num" id="4099613">2</span>&nbsp;<span class="op" id="4099615">&amp;&amp;</span>&nbsp;<span class="ident" id="4099618">e</span><span class="op" id="4099619">.</span><span class="ident" id="4099620">Id</span><span class="op" id="4099622">[</span><span class="num" id="4099623">1</span><span class="op" id="4099624">]</span>&nbsp;<span class="op" id="4099626">==</span>&nbsp;<span class="num" id="4099629">5</span>&nbsp;<span class="op" id="4099631">&amp;&amp;</span>&nbsp;<span class="ident" id="4099634">e</span><span class="op" id="4099635">.</span><span class="ident" id="4099636">Id</span><span class="op" id="4099638">[</span><span class="num" id="4099639">2</span><span class="op" id="4099640">]</span>&nbsp;<span class="op" id="4099642">==</span>&nbsp;<span class="num" id="4099645">29</span>&nbsp;<span class="op" id="4099648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4099653">switch</span>&nbsp;<span class="ident" id="4099660">e</span><span class="op" id="4099661">.</span><span class="ident" id="4099662">Id</span><span class="op" id="4099664">[</span><span class="num" id="4099665">3</span><span class="op" id="4099666">]</span>&nbsp;<span class="op" id="4099668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4099673">case</span>&nbsp;<span class="num" id="4099678">15</span><span class="op" id="4099680">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4099686">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4099711">var</span>&nbsp;<span class="ident" id="4099715">usageBits</span>&nbsp;<span class="ident" id="4099725">asn1</span><span class="op" id="4099729">.</span><span class="ident" id="4099730">BitString</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4099744">_</span><span class="op" id="4099745">,</span>&nbsp;<span class="ident" id="4099747">err</span>&nbsp;<span class="op" id="4099751">:=</span>&nbsp;<span class="ident" id="4099754">asn1</span><span class="op" id="4099758">.</span><span class="ident" id="4099759">Unmarshal</span><span class="op" id="4099768">(</span><span class="ident" id="4099769">e</span><span class="op" id="4099770">.</span><span class="ident" id="4099771">Value</span><span class="op" id="4099776">,</span>&nbsp;<span class="op" id="4099778">&amp;</span><span class="ident" id="4099779">usageBits</span><span class="op" id="4099788">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4099795">if</span>&nbsp;<span class="ident" id="4099798">err</span>&nbsp;<span class="op" id="4099802">==</span>&nbsp;<span class="ident" id="4099805">nil</span>&nbsp;<span class="op" id="4099809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4099816">var</span>&nbsp;<span class="ident" id="4099820">usage</span>&nbsp;<span class="builtintype" id="4099826">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4099835">for</span>&nbsp;<span class="ident" id="4099839">i</span>&nbsp;<span class="op" id="4099841">:=</span>&nbsp;<span class="num" id="4099844">0</span><span class="op" id="4099845">;</span>&nbsp;<span class="ident" id="4099847">i</span>&nbsp;<span class="op" id="4099849">&lt;</span>&nbsp;<span class="num" id="4099851">9</span><span class="op" id="4099852">;</span>&nbsp;<span class="ident" id="4099854">i</span><span class="op" id="4099855">++</span>&nbsp;<span class="op" id="4099858">{</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4099866">if</span>&nbsp;<span class="ident" id="4099869">usageBits</span><span class="op" id="4099878">.</span><span class="ident" id="4099879">At</span><span class="op" id="4099881">(</span><span class="ident" id="4099882">i</span><span class="op" id="4099883">)</span>&nbsp;<span class="op" id="4099885">!=</span>&nbsp;<span class="num" id="4099888">0</span>&nbsp;<span class="op" id="4099890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4099899">usage</span>&nbsp;<span class="op" id="4099905">|=</span>&nbsp;<span class="num" id="4099908">1</span>&nbsp;<span class="op" id="4099910">&lt;&lt;</span>&nbsp;<span class="builtintype" id="4099913">uint</span><span class="op" id="4099917">(</span><span class="ident" id="4099918">i</span><span class="op" id="4099919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4099927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4099934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4099941">out</span><span class="op" id="4099944">.</span><span class="ident" id="4099945">KeyUsage</span>&nbsp;<span class="op" id="4099954">=</span>&nbsp;<span class="ident" id="4099956">KeyUsage</span><span class="op" id="4099964">(</span><span class="ident" id="4099965">usage</span><span class="op" id="4099970">)</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4099977">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4099990">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4099995">case</span>&nbsp;<span class="num" id="4100000">19</span><span class="op" id="4100002">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4100008">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4100033">var</span>&nbsp;<span class="ident" id="4100037">constraints</span>&nbsp;<span class="ident" id="4100049">basicConstraints</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4100070">_</span><span class="op" id="4100071">,</span>&nbsp;<span class="ident" id="4100073">err</span>&nbsp;<span class="op" id="4100077">:=</span>&nbsp;<span class="ident" id="4100080">asn1</span><span class="op" id="4100084">.</span><span class="ident" id="4100085">Unmarshal</span><span class="op" id="4100094">(</span><span class="ident" id="4100095">e</span><span class="op" id="4100096">.</span><span class="ident" id="4100097">Value</span><span class="op" id="4100102">,</span>&nbsp;<span class="op" id="4100104">&amp;</span><span class="ident" id="4100105">constraints</span><span class="op" id="4100116">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4100123">if</span>&nbsp;<span class="ident" id="4100126">err</span>&nbsp;<span class="op" id="4100130">==</span>&nbsp;<span class="ident" id="4100133">nil</span>&nbsp;<span class="op" id="4100137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4100144">out</span><span class="op" id="4100147">.</span><span class="ident" id="4100148">BasicConstraintsValid</span>&nbsp;<span class="op" id="4100170">=</span>&nbsp;<span class="builtintype" id="4100172">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4100182">out</span><span class="op" id="4100185">.</span><span class="ident" id="4100186">IsCA</span>&nbsp;<span class="op" id="4100191">=</span>&nbsp;<span class="ident" id="4100193">constraints</span><span class="op" id="4100204">.</span><span class="ident" id="4100205">IsCA</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4100215">out</span><span class="op" id="4100218">.</span><span class="ident" id="4100219">MaxPathLen</span>&nbsp;<span class="op" id="4100230">=</span>&nbsp;<span class="ident" id="4100232">constraints</span><span class="op" id="4100243">.</span><span class="ident" id="4100244">MaxPathLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4100260">out</span><span class="op" id="4100263">.</span><span class="ident" id="4100264">MaxPathLenZero</span>&nbsp;<span class="op" id="4100279">=</span>&nbsp;<span class="ident" id="4100281">out</span><span class="op" id="4100284">.</span><span class="ident" id="4100285">MaxPathLen</span>&nbsp;<span class="op" id="4100296">==</span>&nbsp;<span class="num" id="4100299">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4100306">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4100319">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4100324">case</span>&nbsp;<span class="num" id="4100329">17</span><span class="op" id="4100331">:</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4100337">out</span><span class="op" id="4100340">.</span><span class="ident" id="4100341">DNSNames</span><span class="op" id="4100349">,</span>&nbsp;<span class="ident" id="4100351">out</span><span class="op" id="4100354">.</span><span class="ident" id="4100355">EmailAddresses</span><span class="op" id="4100369">,</span>&nbsp;<span class="ident" id="4100371">out</span><span class="op" id="4100374">.</span><span class="ident" id="4100375">IPAddresses</span><span class="op" id="4100386">,</span>&nbsp;<span class="ident" id="4100388">err</span>&nbsp;<span class="op" id="4100392">=</span>&nbsp;<span class="ident" id="4100394">parseSANExtension</span><span class="op" id="4100411">(</span><span class="ident" id="4100412">e</span><span class="op" id="4100413">.</span><span class="ident" id="4100414">Value</span><span class="op" id="4100419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4100425">if</span>&nbsp;<span class="ident" id="4100428">err</span>&nbsp;<span class="op" id="4100432">!=</span>&nbsp;<span class="ident" id="4100435">nil</span>&nbsp;<span class="op" id="4100439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4100446">return</span>&nbsp;<span class="ident" id="4100453">nil</span><span class="op" id="4100456">,</span>&nbsp;<span class="ident" id="4100458">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4100466">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4100473">if</span>&nbsp;<span class="builtinfunc" id="4100476">len</span><span class="op" id="4100479">(</span><span class="ident" id="4100480">out</span><span class="op" id="4100483">.</span><span class="ident" id="4100484">DNSNames</span><span class="op" id="4100492">)</span>&nbsp;<span class="op" id="4100494">&gt;</span>&nbsp;<span class="num" id="4100496">0</span>&nbsp;<span class="op" id="4100498">||</span>&nbsp;<span class="builtinfunc" id="4100501">len</span><span class="op" id="4100504">(</span><span class="ident" id="4100505">out</span><span class="op" id="4100508">.</span><span class="ident" id="4100509">EmailAddresses</span><span class="op" id="4100523">)</span>&nbsp;<span class="op" id="4100525">&gt;</span>&nbsp;<span class="num" id="4100527">0</span>&nbsp;<span class="op" id="4100529">||</span>&nbsp;<span class="builtinfunc" id="4100532">len</span><span class="op" id="4100535">(</span><span class="ident" id="4100536">out</span><span class="op" id="4100539">.</span><span class="ident" id="4100540">IPAddresses</span><span class="op" id="4100551">)</span>&nbsp;<span class="op" id="4100553">&gt;</span>&nbsp;<span class="num" id="4100555">0</span>&nbsp;<span class="op" id="4100557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4100564">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4100577">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4100583">//&nbsp;If&nbsp;we&nbsp;didn&#39;t&nbsp;parse&nbsp;any&nbsp;of&nbsp;the&nbsp;names&nbsp;then&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4100634">//&nbsp;fall&nbsp;through&nbsp;to&nbsp;the&nbsp;critical&nbsp;check&nbsp;below.</span><br>
<span class="lineno">935</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4100683">case</span>&nbsp;<span class="num" id="4100688">30</span><span class="op" id="4100690">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4100696">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.10</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4100723">//&nbsp;NameConstraints&nbsp;::=&nbsp;SEQUENCE&nbsp;{</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4100761">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;permittedSubtrees&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralSubtrees&nbsp;OPTIONAL,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4100831">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;excludedSubtrees&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralSubtrees&nbsp;OPTIONAL&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4100902">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4100909">//&nbsp;GeneralSubtrees&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;GeneralSubtree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4100977">//</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4100984">//&nbsp;GeneralSubtree&nbsp;::=&nbsp;SEQUENCE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4101021">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralName,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4101070">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minimum&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BaseDistance&nbsp;DEFAULT&nbsp;0,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4101130">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maximum&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BaseDistance&nbsp;OPTIONAL&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4101190">//</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4101197">//&nbsp;BaseDistance&nbsp;::=&nbsp;INTEGER&nbsp;(0..MAX)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4101239">var</span>&nbsp;<span class="ident" id="4101243">constraints</span>&nbsp;<span class="ident" id="4101255">nameConstraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4101275">_</span><span class="op" id="4101276">,</span>&nbsp;<span class="ident" id="4101278">err</span>&nbsp;<span class="op" id="4101282">:=</span>&nbsp;<span class="ident" id="4101285">asn1</span><span class="op" id="4101289">.</span><span class="ident" id="4101290">Unmarshal</span><span class="op" id="4101299">(</span><span class="ident" id="4101300">e</span><span class="op" id="4101301">.</span><span class="ident" id="4101302">Value</span><span class="op" id="4101307">,</span>&nbsp;<span class="op" id="4101309">&amp;</span><span class="ident" id="4101310">constraints</span><span class="op" id="4101321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4101327">if</span>&nbsp;<span class="ident" id="4101330">err</span>&nbsp;<span class="op" id="4101334">!=</span>&nbsp;<span class="ident" id="4101337">nil</span>&nbsp;<span class="op" id="4101341">{</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4101348">return</span>&nbsp;<span class="ident" id="4101355">nil</span><span class="op" id="4101358">,</span>&nbsp;<span class="ident" id="4101360">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4101368">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4101375">if</span>&nbsp;<span class="builtinfunc" id="4101378">len</span><span class="op" id="4101381">(</span><span class="ident" id="4101382">constraints</span><span class="op" id="4101393">.</span><span class="ident" id="4101394">Excluded</span><span class="op" id="4101402">)</span>&nbsp;<span class="op" id="4101404">&gt;</span>&nbsp;<span class="num" id="4101406">0</span>&nbsp;<span class="op" id="4101408">&amp;&amp;</span>&nbsp;<span class="ident" id="4101411">e</span><span class="op" id="4101412">.</span><span class="ident" id="4101413">Critical</span>&nbsp;<span class="op" id="4101422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4101429">return</span>&nbsp;<span class="ident" id="4101436">out</span><span class="op" id="4101439">,</span>&nbsp;<span class="ident" id="4101441">UnhandledCriticalExtension</span><span class="op" id="4101467">{</span><span class="op" id="4101468">}</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4101474">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4101481">for</span>&nbsp;<span class="ident" id="4101485">_</span><span class="op" id="4101486">,</span>&nbsp;<span class="ident" id="4101488">subtree</span>&nbsp;<span class="op" id="4101496">:=</span>&nbsp;<span class="keyword" id="4101499">range</span>&nbsp;<span class="ident" id="4101505">constraints</span><span class="op" id="4101516">.</span><span class="ident" id="4101517">Permitted</span>&nbsp;<span class="op" id="4101527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4101534">if</span>&nbsp;<span class="builtinfunc" id="4101537">len</span><span class="op" id="4101540">(</span><span class="ident" id="4101541">subtree</span><span class="op" id="4101548">.</span><span class="ident" id="4101549">Name</span><span class="op" id="4101553">)</span>&nbsp;<span class="op" id="4101555">==</span>&nbsp;<span class="num" id="4101558">0</span>&nbsp;<span class="op" id="4101560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4101568">if</span>&nbsp;<span class="ident" id="4101571">e</span><span class="op" id="4101572">.</span><span class="ident" id="4101573">Critical</span>&nbsp;<span class="op" id="4101582">{</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4101591">return</span>&nbsp;<span class="ident" id="4101598">out</span><span class="op" id="4101601">,</span>&nbsp;<span class="ident" id="4101603">UnhandledCriticalExtension</span><span class="op" id="4101629">{</span><span class="op" id="4101630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4101638">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4101646">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4101660">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4101667">out</span><span class="op" id="4101670">.</span><span class="ident" id="4101671">PermittedDNSDomains</span>&nbsp;<span class="op" id="4101691">=</span>&nbsp;<span class="builtinfunc" id="4101693">append</span><span class="op" id="4101699">(</span><span class="ident" id="4101700">out</span><span class="op" id="4101703">.</span><span class="ident" id="4101704">PermittedDNSDomains</span><span class="op" id="4101723">,</span>&nbsp;<span class="ident" id="4101725">subtree</span><span class="op" id="4101732">.</span><span class="ident" id="4101733">Name</span><span class="op" id="4101737">)</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4101743">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4101749">continue</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4101762">case</span>&nbsp;<span class="num" id="4101767">31</span><span class="op" id="4101769">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4101775">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.14</span><br>
<span class="lineno">975</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4101802">//&nbsp;CRLDistributionPoints&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;DistributionPoint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4101879">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4101886">//&nbsp;DistributionPoint&nbsp;::=&nbsp;SEQUENCE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4101926">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;distributionPoint&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DistributionPointName&nbsp;OPTIONAL,</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4102001">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reasons&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ReasonFlags&nbsp;OPTIONAL,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4102066">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cRLIssuer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralNames&nbsp;OPTIONAL&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4102133">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4102140">//&nbsp;DistributionPointName&nbsp;::=&nbsp;CHOICE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4102182">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fullName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralNames,</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4102239">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nameRelativeToCRLIssuer&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RelativeDistinguishedName&nbsp;}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4102311">var</span>&nbsp;<span class="ident" id="4102315">cdp</span>&nbsp;<span class="op" id="4102319">[</span><span class="op" id="4102320">]</span><span class="ident" id="4102321">distributionPoint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4102343">_</span><span class="op" id="4102344">,</span>&nbsp;<span class="ident" id="4102346">err</span>&nbsp;<span class="op" id="4102350">:=</span>&nbsp;<span class="ident" id="4102353">asn1</span><span class="op" id="4102357">.</span><span class="ident" id="4102358">Unmarshal</span><span class="op" id="4102367">(</span><span class="ident" id="4102368">e</span><span class="op" id="4102369">.</span><span class="ident" id="4102370">Value</span><span class="op" id="4102375">,</span>&nbsp;<span class="op" id="4102377">&amp;</span><span class="ident" id="4102378">cdp</span><span class="op" id="4102381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4102387">if</span>&nbsp;<span class="ident" id="4102390">err</span>&nbsp;<span class="op" id="4102394">!=</span>&nbsp;<span class="ident" id="4102397">nil</span>&nbsp;<span class="op" id="4102401">{</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4102408">return</span>&nbsp;<span class="ident" id="4102415">nil</span><span class="op" id="4102418">,</span>&nbsp;<span class="ident" id="4102420">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4102428">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4102435">for</span>&nbsp;<span class="ident" id="4102439">_</span><span class="op" id="4102440">,</span>&nbsp;<span class="ident" id="4102442">dp</span>&nbsp;<span class="op" id="4102445">:=</span>&nbsp;<span class="keyword" id="4102448">range</span>&nbsp;<span class="ident" id="4102454">cdp</span>&nbsp;<span class="op" id="4102458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4102465">var</span>&nbsp;<span class="ident" id="4102469">n</span>&nbsp;<span class="ident" id="4102471">asn1</span><span class="op" id="4102475">.</span><span class="ident" id="4102476">RawValue</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4102490">_</span><span class="op" id="4102491">,</span>&nbsp;<span class="ident" id="4102493">err</span>&nbsp;<span class="op" id="4102497">=</span>&nbsp;<span class="ident" id="4102499">asn1</span><span class="op" id="4102503">.</span><span class="ident" id="4102504">Unmarshal</span><span class="op" id="4102513">(</span><span class="ident" id="4102514">dp</span><span class="op" id="4102516">.</span><span class="ident" id="4102517">DistributionPoint</span><span class="op" id="4102534">.</span><span class="ident" id="4102535">FullName</span><span class="op" id="4102543">.</span><span class="ident" id="4102544">Bytes</span><span class="op" id="4102549">,</span>&nbsp;<span class="op" id="4102551">&amp;</span><span class="ident" id="4102552">n</span><span class="op" id="4102553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4102560">if</span>&nbsp;<span class="ident" id="4102563">err</span>&nbsp;<span class="op" id="4102567">!=</span>&nbsp;<span class="ident" id="4102570">nil</span>&nbsp;<span class="op" id="4102574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4102582">return</span>&nbsp;<span class="ident" id="4102589">nil</span><span class="op" id="4102592">,</span>&nbsp;<span class="ident" id="4102594">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4102603">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4102611">if</span>&nbsp;<span class="ident" id="4102614">n</span><span class="op" id="4102615">.</span><span class="ident" id="4102616">Tag</span>&nbsp;<span class="op" id="4102620">==</span>&nbsp;<span class="num" id="4102623">6</span>&nbsp;<span class="op" id="4102625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4102633">out</span><span class="op" id="4102636">.</span><span class="ident" id="4102637">CRLDistributionPoints</span>&nbsp;<span class="op" id="4102659">=</span>&nbsp;<span class="builtinfunc" id="4102661">append</span><span class="op" id="4102667">(</span><span class="ident" id="4102668">out</span><span class="op" id="4102671">.</span><span class="ident" id="4102672">CRLDistributionPoints</span><span class="op" id="4102693">,</span>&nbsp;<span class="builtintype" id="4102695">string</span><span class="op" id="4102701">(</span><span class="ident" id="4102702">n</span><span class="op" id="4102703">.</span><span class="ident" id="4102704">Bytes</span><span class="op" id="4102709">)</span><span class="op" id="4102710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4102717">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4102723">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4102729">continue</span><br>
<span class="lineno">1005</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4102742">case</span>&nbsp;<span class="num" id="4102747">35</span><span class="op" id="4102749">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4102755">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4102780">var</span>&nbsp;<span class="ident" id="4102784">a</span>&nbsp;<span class="ident" id="4102786">authKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4102800">_</span><span class="op" id="4102801">,</span>&nbsp;<span class="ident" id="4102803">err</span>&nbsp;<span class="op" id="4102807">=</span>&nbsp;<span class="ident" id="4102809">asn1</span><span class="op" id="4102813">.</span><span class="ident" id="4102814">Unmarshal</span><span class="op" id="4102823">(</span><span class="ident" id="4102824">e</span><span class="op" id="4102825">.</span><span class="ident" id="4102826">Value</span><span class="op" id="4102831">,</span>&nbsp;<span class="op" id="4102833">&amp;</span><span class="ident" id="4102834">a</span><span class="op" id="4102835">)</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4102841">if</span>&nbsp;<span class="ident" id="4102844">err</span>&nbsp;<span class="op" id="4102848">!=</span>&nbsp;<span class="ident" id="4102851">nil</span>&nbsp;<span class="op" id="4102855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4102862">return</span>&nbsp;<span class="ident" id="4102869">nil</span><span class="op" id="4102872">,</span>&nbsp;<span class="ident" id="4102874">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4102882">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4102888">out</span><span class="op" id="4102891">.</span><span class="ident" id="4102892">AuthorityKeyId</span>&nbsp;<span class="op" id="4102907">=</span>&nbsp;<span class="ident" id="4102909">a</span><span class="op" id="4102910">.</span><span class="ident" id="4102911">Id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4102918">continue</span><br>
<span class="lineno">1015</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4102931">case</span>&nbsp;<span class="num" id="4102936">37</span><span class="op" id="4102938">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4102944">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.12.&nbsp;&nbsp;Extended&nbsp;Key&nbsp;Usage</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4102992">//&nbsp;id-ce-extKeyUsage&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-ce&nbsp;37&nbsp;}</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4103052">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4103059">//&nbsp;ExtKeyUsageSyntax&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;KeyPurposeId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4103127">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4103134">//&nbsp;KeyPurposeId&nbsp;::=&nbsp;OBJECT&nbsp;IDENTIFIER</span><br>
<span class="lineno"></span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4103177">var</span>&nbsp;<span class="ident" id="4103181">keyUsage</span>&nbsp;<span class="op" id="4103190">[</span><span class="op" id="4103191">]</span><span class="ident" id="4103192">asn1</span><span class="op" id="4103196">.</span><span class="ident" id="4103197">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4103218">_</span><span class="op" id="4103219">,</span>&nbsp;<span class="ident" id="4103221">err</span>&nbsp;<span class="op" id="4103225">=</span>&nbsp;<span class="ident" id="4103227">asn1</span><span class="op" id="4103231">.</span><span class="ident" id="4103232">Unmarshal</span><span class="op" id="4103241">(</span><span class="ident" id="4103242">e</span><span class="op" id="4103243">.</span><span class="ident" id="4103244">Value</span><span class="op" id="4103249">,</span>&nbsp;<span class="op" id="4103251">&amp;</span><span class="ident" id="4103252">keyUsage</span><span class="op" id="4103260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4103266">if</span>&nbsp;<span class="ident" id="4103269">err</span>&nbsp;<span class="op" id="4103273">!=</span>&nbsp;<span class="ident" id="4103276">nil</span>&nbsp;<span class="op" id="4103280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4103287">return</span>&nbsp;<span class="ident" id="4103294">nil</span><span class="op" id="4103297">,</span>&nbsp;<span class="ident" id="4103299">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4103307">}</span><br>
<span class="lineno">1030</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4103314">for</span>&nbsp;<span class="ident" id="4103318">_</span><span class="op" id="4103319">,</span>&nbsp;<span class="ident" id="4103321">u</span>&nbsp;<span class="op" id="4103323">:=</span>&nbsp;<span class="keyword" id="4103326">range</span>&nbsp;<span class="ident" id="4103332">keyUsage</span>&nbsp;<span class="op" id="4103341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4103348">if</span>&nbsp;<span class="ident" id="4103351">extKeyUsage</span><span class="op" id="4103362">,</span>&nbsp;<span class="ident" id="4103364">ok</span>&nbsp;<span class="op" id="4103367">:=</span>&nbsp;<span class="ident" id="4103370">extKeyUsageFromOID</span><span class="op" id="4103388">(</span><span class="ident" id="4103389">u</span><span class="op" id="4103390">)</span><span class="op" id="4103391">;</span>&nbsp;<span class="ident" id="4103393">ok</span>&nbsp;<span class="op" id="4103396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4103404">out</span><span class="op" id="4103407">.</span><span class="ident" id="4103408">ExtKeyUsage</span>&nbsp;<span class="op" id="4103420">=</span>&nbsp;<span class="builtinfunc" id="4103422">append</span><span class="op" id="4103428">(</span><span class="ident" id="4103429">out</span><span class="op" id="4103432">.</span><span class="ident" id="4103433">ExtKeyUsage</span><span class="op" id="4103444">,</span>&nbsp;<span class="ident" id="4103446">extKeyUsage</span><span class="op" id="4103457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4103464">}</span>&nbsp;<span class="keyword" id="4103466">else</span>&nbsp;<span class="op" id="4103471">{</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4103479">out</span><span class="op" id="4103482">.</span><span class="ident" id="4103483">UnknownExtKeyUsage</span>&nbsp;<span class="op" id="4103502">=</span>&nbsp;<span class="builtinfunc" id="4103504">append</span><span class="op" id="4103510">(</span><span class="ident" id="4103511">out</span><span class="op" id="4103514">.</span><span class="ident" id="4103515">UnknownExtKeyUsage</span><span class="op" id="4103533">,</span>&nbsp;<span class="ident" id="4103535">u</span><span class="op" id="4103536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4103543">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4103549">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4103556">continue</span><br>
<span class="lineno">1040</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4103569">case</span>&nbsp;<span class="num" id="4103574">14</span><span class="op" id="4103576">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4103582">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4103607">var</span>&nbsp;<span class="ident" id="4103611">keyid</span>&nbsp;<span class="op" id="4103617">[</span><span class="op" id="4103618">]</span><span class="builtintype" id="4103619">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4103628">_</span><span class="op" id="4103629">,</span>&nbsp;<span class="ident" id="4103631">err</span>&nbsp;<span class="op" id="4103635">=</span>&nbsp;<span class="ident" id="4103637">asn1</span><span class="op" id="4103641">.</span><span class="ident" id="4103642">Unmarshal</span><span class="op" id="4103651">(</span><span class="ident" id="4103652">e</span><span class="op" id="4103653">.</span><span class="ident" id="4103654">Value</span><span class="op" id="4103659">,</span>&nbsp;<span class="op" id="4103661">&amp;</span><span class="ident" id="4103662">keyid</span><span class="op" id="4103667">)</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4103673">if</span>&nbsp;<span class="ident" id="4103676">err</span>&nbsp;<span class="op" id="4103680">!=</span>&nbsp;<span class="ident" id="4103683">nil</span>&nbsp;<span class="op" id="4103687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4103694">return</span>&nbsp;<span class="ident" id="4103701">nil</span><span class="op" id="4103704">,</span>&nbsp;<span class="ident" id="4103706">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4103714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4103720">out</span><span class="op" id="4103723">.</span><span class="ident" id="4103724">SubjectKeyId</span>&nbsp;<span class="op" id="4103737">=</span>&nbsp;<span class="ident" id="4103739">keyid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4103749">continue</span><br>
<span class="lineno">1050</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4103762">case</span>&nbsp;<span class="num" id="4103767">32</span><span class="op" id="4103769">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4103775">//&nbsp;RFC&nbsp;5280&nbsp;4.2.1.4:&nbsp;Certificate&nbsp;Policies</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4103821">var</span>&nbsp;<span class="ident" id="4103825">policies</span>&nbsp;<span class="op" id="4103834">[</span><span class="op" id="4103835">]</span><span class="ident" id="4103836">policyInformation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4103858">if</span>&nbsp;<span class="ident" id="4103861">_</span><span class="op" id="4103862">,</span>&nbsp;<span class="ident" id="4103864">err</span>&nbsp;<span class="op" id="4103868">=</span>&nbsp;<span class="ident" id="4103870">asn1</span><span class="op" id="4103874">.</span><span class="ident" id="4103875">Unmarshal</span><span class="op" id="4103884">(</span><span class="ident" id="4103885">e</span><span class="op" id="4103886">.</span><span class="ident" id="4103887">Value</span><span class="op" id="4103892">,</span>&nbsp;<span class="op" id="4103894">&amp;</span><span class="ident" id="4103895">policies</span><span class="op" id="4103903">)</span><span class="op" id="4103904">;</span>&nbsp;<span class="ident" id="4103906">err</span>&nbsp;<span class="op" id="4103910">!=</span>&nbsp;<span class="ident" id="4103913">nil</span>&nbsp;<span class="op" id="4103917">{</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4103924">return</span>&nbsp;<span class="ident" id="4103931">nil</span><span class="op" id="4103934">,</span>&nbsp;<span class="ident" id="4103936">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4103944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4103950">out</span><span class="op" id="4103953">.</span><span class="ident" id="4103954">PolicyIdentifiers</span>&nbsp;<span class="op" id="4103972">=</span>&nbsp;<span class="builtinfunc" id="4103974">make</span><span class="op" id="4103978">(</span><span class="op" id="4103979">[</span><span class="op" id="4103980">]</span><span class="ident" id="4103981">asn1</span><span class="op" id="4103985">.</span><span class="ident" id="4103986">ObjectIdentifier</span><span class="op" id="4104002">,</span>&nbsp;<span class="builtinfunc" id="4104004">len</span><span class="op" id="4104007">(</span><span class="ident" id="4104008">policies</span><span class="op" id="4104016">)</span><span class="op" id="4104017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4104023">for</span>&nbsp;<span class="ident" id="4104027">i</span><span class="op" id="4104028">,</span>&nbsp;<span class="ident" id="4104030">policy</span>&nbsp;<span class="op" id="4104037">:=</span>&nbsp;<span class="keyword" id="4104040">range</span>&nbsp;<span class="ident" id="4104046">policies</span>&nbsp;<span class="op" id="4104055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4104062">out</span><span class="op" id="4104065">.</span><span class="ident" id="4104066">PolicyIdentifiers</span><span class="op" id="4104083">[</span><span class="ident" id="4104084">i</span><span class="op" id="4104085">]</span>&nbsp;<span class="op" id="4104087">=</span>&nbsp;<span class="ident" id="4104089">policy</span><span class="op" id="4104095">.</span><span class="ident" id="4104096">Policy</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4104107">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4104112">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4104116">}</span>&nbsp;<span class="keyword" id="4104118">else</span>&nbsp;<span class="keyword" id="4104123">if</span>&nbsp;<span class="ident" id="4104126">e</span><span class="op" id="4104127">.</span><span class="ident" id="4104128">Id</span><span class="op" id="4104130">.</span><span class="ident" id="4104131">Equal</span><span class="op" id="4104136">(</span><span class="ident" id="4104137">oidExtensionAuthorityInfoAccess</span><span class="op" id="4104168">)</span>&nbsp;<span class="op" id="4104170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4104175">//&nbsp;RFC&nbsp;5280&nbsp;4.2.2.1:&nbsp;Authority&nbsp;Information&nbsp;Access</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4104228">var</span>&nbsp;<span class="ident" id="4104232">aia</span>&nbsp;<span class="op" id="4104236">[</span><span class="op" id="4104237">]</span><span class="ident" id="4104238">authorityInfoAccess</span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4104261">if</span>&nbsp;<span class="ident" id="4104264">_</span><span class="op" id="4104265">,</span>&nbsp;<span class="ident" id="4104267">err</span>&nbsp;<span class="op" id="4104271">=</span>&nbsp;<span class="ident" id="4104273">asn1</span><span class="op" id="4104277">.</span><span class="ident" id="4104278">Unmarshal</span><span class="op" id="4104287">(</span><span class="ident" id="4104288">e</span><span class="op" id="4104289">.</span><span class="ident" id="4104290">Value</span><span class="op" id="4104295">,</span>&nbsp;<span class="op" id="4104297">&amp;</span><span class="ident" id="4104298">aia</span><span class="op" id="4104301">)</span><span class="op" id="4104302">;</span>&nbsp;<span class="ident" id="4104304">err</span>&nbsp;<span class="op" id="4104308">!=</span>&nbsp;<span class="ident" id="4104311">nil</span>&nbsp;<span class="op" id="4104315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4104321">return</span>&nbsp;<span class="ident" id="4104328">nil</span><span class="op" id="4104331">,</span>&nbsp;<span class="ident" id="4104333">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4104340">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4104346">for</span>&nbsp;<span class="ident" id="4104350">_</span><span class="op" id="4104351">,</span>&nbsp;<span class="ident" id="4104353">v</span>&nbsp;<span class="op" id="4104355">:=</span>&nbsp;<span class="keyword" id="4104358">range</span>&nbsp;<span class="ident" id="4104364">aia</span>&nbsp;<span class="op" id="4104368">{</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4104374">//&nbsp;GeneralName:&nbsp;uniformResourceIdentifier&nbsp;[6]&nbsp;IA5String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4104434">if</span>&nbsp;<span class="ident" id="4104437">v</span><span class="op" id="4104438">.</span><span class="ident" id="4104439">Location</span><span class="op" id="4104447">.</span><span class="ident" id="4104448">Tag</span>&nbsp;<span class="op" id="4104452">!=</span>&nbsp;<span class="num" id="4104455">6</span>&nbsp;<span class="op" id="4104457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4104464">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4104477">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4104483">if</span>&nbsp;<span class="ident" id="4104486">v</span><span class="op" id="4104487">.</span><span class="ident" id="4104488">Method</span><span class="op" id="4104494">.</span><span class="ident" id="4104495">Equal</span><span class="op" id="4104500">(</span><span class="ident" id="4104501">oidAuthorityInfoAccessOcsp</span><span class="op" id="4104527">)</span>&nbsp;<span class="op" id="4104529">{</span><br>
<span class="lineno">1075</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4104536">out</span><span class="op" id="4104539">.</span><span class="ident" id="4104540">OCSPServer</span>&nbsp;<span class="op" id="4104551">=</span>&nbsp;<span class="builtinfunc" id="4104553">append</span><span class="op" id="4104559">(</span><span class="ident" id="4104560">out</span><span class="op" id="4104563">.</span><span class="ident" id="4104564">OCSPServer</span><span class="op" id="4104574">,</span>&nbsp;<span class="builtintype" id="4104576">string</span><span class="op" id="4104582">(</span><span class="ident" id="4104583">v</span><span class="op" id="4104584">.</span><span class="ident" id="4104585">Location</span><span class="op" id="4104593">.</span><span class="ident" id="4104594">Bytes</span><span class="op" id="4104599">)</span><span class="op" id="4104600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4104606">}</span>&nbsp;<span class="keyword" id="4104608">else</span>&nbsp;<span class="keyword" id="4104613">if</span>&nbsp;<span class="ident" id="4104616">v</span><span class="op" id="4104617">.</span><span class="ident" id="4104618">Method</span><span class="op" id="4104624">.</span><span class="ident" id="4104625">Equal</span><span class="op" id="4104630">(</span><span class="ident" id="4104631">oidAuthorityInfoAccessIssuers</span><span class="op" id="4104660">)</span>&nbsp;<span class="op" id="4104662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4104669">out</span><span class="op" id="4104672">.</span><span class="ident" id="4104673">IssuingCertificateURL</span>&nbsp;<span class="op" id="4104695">=</span>&nbsp;<span class="builtinfunc" id="4104697">append</span><span class="op" id="4104703">(</span><span class="ident" id="4104704">out</span><span class="op" id="4104707">.</span><span class="ident" id="4104708">IssuingCertificateURL</span><span class="op" id="4104729">,</span>&nbsp;<span class="builtintype" id="4104731">string</span><span class="op" id="4104737">(</span><span class="ident" id="4104738">v</span><span class="op" id="4104739">.</span><span class="ident" id="4104740">Location</span><span class="op" id="4104748">.</span><span class="ident" id="4104749">Bytes</span><span class="op" id="4104754">)</span><span class="op" id="4104755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4104761">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4104766">}</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4104770">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4104775">if</span>&nbsp;<span class="ident" id="4104778">e</span><span class="op" id="4104779">.</span><span class="ident" id="4104780">Critical</span>&nbsp;<span class="op" id="4104789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4104794">return</span>&nbsp;<span class="ident" id="4104801">out</span><span class="op" id="4104804">,</span>&nbsp;<span class="ident" id="4104806">UnhandledCriticalExtension</span><span class="op" id="4104832">{</span><span class="op" id="4104833">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4104837">}</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4104840">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4104844">return</span>&nbsp;<span class="ident" id="4104851">out</span><span class="op" id="4104854">,</span>&nbsp;<span class="ident" id="4104856">nil</span><br>
<span class="lineno"></span><span class="op" id="4104860">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1090</span><span class="comment" id="4104863">//&nbsp;ParseCertificate&nbsp;parses&nbsp;a&nbsp;single&nbsp;certificate&nbsp;from&nbsp;the&nbsp;given&nbsp;ASN.1&nbsp;DER&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4104942">func</span>&nbsp;<span class="ident" id="4104947">ParseCertificate</span><span class="op" id="4104963">(</span><span class="ident" id="4104964">asn1Data</span>&nbsp;<span class="op" id="4104973">[</span><span class="op" id="4104974">]</span><span class="builtintype" id="4104975">byte</span><span class="op" id="4104979">)</span>&nbsp;<span class="op" id="4104981">(</span><span class="op" id="4104982">*</span><span class="ident" id="4104983">Certificate</span><span class="op" id="4104994">,</span>&nbsp;<span class="builtintype" id="4104996">error</span><span class="op" id="4105001">)</span>&nbsp;<span class="op" id="4105003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4105006">var</span>&nbsp;<span class="ident" id="4105010">cert</span>&nbsp;<span class="ident" id="4105015">certificate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4105028">rest</span><span class="op" id="4105032">,</span>&nbsp;<span class="ident" id="4105034">err</span>&nbsp;<span class="op" id="4105038">:=</span>&nbsp;<span class="ident" id="4105041">asn1</span><span class="op" id="4105045">.</span><span class="ident" id="4105046">Unmarshal</span><span class="op" id="4105055">(</span><span class="ident" id="4105056">asn1Data</span><span class="op" id="4105064">,</span>&nbsp;<span class="op" id="4105066">&amp;</span><span class="ident" id="4105067">cert</span><span class="op" id="4105071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4105074">if</span>&nbsp;<span class="ident" id="4105077">err</span>&nbsp;<span class="op" id="4105081">!=</span>&nbsp;<span class="ident" id="4105084">nil</span>&nbsp;<span class="op" id="4105088">{</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4105092">return</span>&nbsp;<span class="ident" id="4105099">nil</span><span class="op" id="4105102">,</span>&nbsp;<span class="ident" id="4105104">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4105109">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4105112">if</span>&nbsp;<span class="builtinfunc" id="4105115">len</span><span class="op" id="4105118">(</span><span class="ident" id="4105119">rest</span><span class="op" id="4105123">)</span>&nbsp;<span class="op" id="4105125">&gt;</span>&nbsp;<span class="num" id="4105127">0</span>&nbsp;<span class="op" id="4105129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4105133">return</span>&nbsp;<span class="ident" id="4105140">nil</span><span class="op" id="4105143">,</span>&nbsp;<span class="ident" id="4105145">asn1</span><span class="op" id="4105149">.</span><span class="ident" id="4105150">SyntaxError</span><span class="op" id="4105161">{</span><span class="ident" id="4105162">Msg</span><span class="op" id="4105165">:</span>&nbsp;<span class="string" id="4105167">&#34;trailing&nbsp;data&#34;</span><span class="op" id="4105182">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4105185">}</span><br>
<span class="lineno">1100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4105189">return</span>&nbsp;<span class="ident" id="4105196">parseCertificate</span><span class="op" id="4105212">(</span><span class="op" id="4105213">&amp;</span><span class="ident" id="4105214">cert</span><span class="op" id="4105218">)</span><br>
<span class="lineno"></span><span class="op" id="4105220">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4105223">//&nbsp;ParseCertificates&nbsp;parses&nbsp;one&nbsp;or&nbsp;more&nbsp;certificates&nbsp;from&nbsp;the&nbsp;given&nbsp;ASN.1&nbsp;DER</span><br>
<span class="lineno">1105</span><span class="comment" id="4105301">//&nbsp;data.&nbsp;The&nbsp;certificates&nbsp;must&nbsp;be&nbsp;concatenated&nbsp;with&nbsp;no&nbsp;intermediate&nbsp;padding.</span><br>
<span class="lineno"></span><span class="keyword" id="4105378">func</span>&nbsp;<span class="ident" id="4105383">ParseCertificates</span><span class="op" id="4105400">(</span><span class="ident" id="4105401">asn1Data</span>&nbsp;<span class="op" id="4105410">[</span><span class="op" id="4105411">]</span><span class="builtintype" id="4105412">byte</span><span class="op" id="4105416">)</span>&nbsp;<span class="op" id="4105418">(</span><span class="op" id="4105419">[</span><span class="op" id="4105420">]</span><span class="op" id="4105421">*</span><span class="ident" id="4105422">Certificate</span><span class="op" id="4105433">,</span>&nbsp;<span class="builtintype" id="4105435">error</span><span class="op" id="4105440">)</span>&nbsp;<span class="op" id="4105442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4105445">var</span>&nbsp;<span class="ident" id="4105449">v</span>&nbsp;<span class="op" id="4105451">[</span><span class="op" id="4105452">]</span><span class="op" id="4105453">*</span><span class="ident" id="4105454">certificate</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4105468">for</span>&nbsp;<span class="builtinfunc" id="4105472">len</span><span class="op" id="4105475">(</span><span class="ident" id="4105476">asn1Data</span><span class="op" id="4105484">)</span>&nbsp;<span class="op" id="4105486">&gt;</span>&nbsp;<span class="num" id="4105488">0</span>&nbsp;<span class="op" id="4105490">{</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4105494">cert</span>&nbsp;<span class="op" id="4105499">:=</span>&nbsp;<span class="builtinfunc" id="4105502">new</span><span class="op" id="4105505">(</span><span class="ident" id="4105506">certificate</span><span class="op" id="4105517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4105521">var</span>&nbsp;<span class="ident" id="4105525">err</span>&nbsp;<span class="builtintype" id="4105529">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4105537">asn1Data</span><span class="op" id="4105545">,</span>&nbsp;<span class="ident" id="4105547">err</span>&nbsp;<span class="op" id="4105551">=</span>&nbsp;<span class="ident" id="4105553">asn1</span><span class="op" id="4105557">.</span><span class="ident" id="4105558">Unmarshal</span><span class="op" id="4105567">(</span><span class="ident" id="4105568">asn1Data</span><span class="op" id="4105576">,</span>&nbsp;<span class="ident" id="4105578">cert</span><span class="op" id="4105582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4105586">if</span>&nbsp;<span class="ident" id="4105589">err</span>&nbsp;<span class="op" id="4105593">!=</span>&nbsp;<span class="ident" id="4105596">nil</span>&nbsp;<span class="op" id="4105600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4105605">return</span>&nbsp;<span class="ident" id="4105612">nil</span><span class="op" id="4105615">,</span>&nbsp;<span class="ident" id="4105617">err</span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4105623">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4105627">v</span>&nbsp;<span class="op" id="4105629">=</span>&nbsp;<span class="builtinfunc" id="4105631">append</span><span class="op" id="4105637">(</span><span class="ident" id="4105638">v</span><span class="op" id="4105639">,</span>&nbsp;<span class="ident" id="4105641">cert</span><span class="op" id="4105645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4105648">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4105652">ret</span>&nbsp;<span class="op" id="4105656">:=</span>&nbsp;<span class="builtinfunc" id="4105659">make</span><span class="op" id="4105663">(</span><span class="op" id="4105664">[</span><span class="op" id="4105665">]</span><span class="op" id="4105666">*</span><span class="ident" id="4105667">Certificate</span><span class="op" id="4105678">,</span>&nbsp;<span class="builtinfunc" id="4105680">len</span><span class="op" id="4105683">(</span><span class="ident" id="4105684">v</span><span class="op" id="4105685">)</span><span class="op" id="4105686">)</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4105689">for</span>&nbsp;<span class="ident" id="4105693">i</span><span class="op" id="4105694">,</span>&nbsp;<span class="ident" id="4105696">ci</span>&nbsp;<span class="op" id="4105699">:=</span>&nbsp;<span class="keyword" id="4105702">range</span>&nbsp;<span class="ident" id="4105708">v</span>&nbsp;<span class="op" id="4105710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4105714">cert</span><span class="op" id="4105718">,</span>&nbsp;<span class="ident" id="4105720">err</span>&nbsp;<span class="op" id="4105724">:=</span>&nbsp;<span class="ident" id="4105727">parseCertificate</span><span class="op" id="4105743">(</span><span class="ident" id="4105744">ci</span><span class="op" id="4105746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4105750">if</span>&nbsp;<span class="ident" id="4105753">err</span>&nbsp;<span class="op" id="4105757">!=</span>&nbsp;<span class="ident" id="4105760">nil</span>&nbsp;<span class="op" id="4105764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4105769">return</span>&nbsp;<span class="ident" id="4105776">nil</span><span class="op" id="4105779">,</span>&nbsp;<span class="ident" id="4105781">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4105787">}</span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4105791">ret</span><span class="op" id="4105794">[</span><span class="ident" id="4105795">i</span><span class="op" id="4105796">]</span>&nbsp;<span class="op" id="4105798">=</span>&nbsp;<span class="ident" id="4105800">cert</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4105806">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4105810">return</span>&nbsp;<span class="ident" id="4105817">ret</span><span class="op" id="4105820">,</span>&nbsp;<span class="ident" id="4105822">nil</span><br>
<span class="lineno"></span><span class="op" id="4105826">}</span><br>
<span class="lineno">1130</span><br>
<span class="lineno"></span><span class="keyword" id="4105829">func</span>&nbsp;<span class="ident" id="4105834">reverseBitsInAByte</span><span class="op" id="4105852">(</span><span class="ident" id="4105853">in</span>&nbsp;<span class="builtintype" id="4105856">byte</span><span class="op" id="4105860">)</span>&nbsp;<span class="builtintype" id="4105862">byte</span>&nbsp;<span class="op" id="4105867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4105870">b1</span>&nbsp;<span class="op" id="4105873">:=</span>&nbsp;<span class="ident" id="4105876">in</span><span class="op" id="4105878">&gt;&gt;</span><span class="num" id="4105880">4</span>&nbsp;<span class="op" id="4105882">|</span>&nbsp;<span class="ident" id="4105884">in</span><span class="op" id="4105886">&lt;&lt;</span><span class="num" id="4105888">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4105891">b2</span>&nbsp;<span class="op" id="4105894">:=</span>&nbsp;<span class="ident" id="4105897">b1</span><span class="op" id="4105899">&gt;&gt;</span><span class="num" id="4105901">2</span><span class="op" id="4105902">&amp;</span><span class="num" id="4105903">0x33</span>&nbsp;<span class="op" id="4105908">|</span>&nbsp;<span class="ident" id="4105910">b1</span><span class="op" id="4105912">&lt;&lt;</span><span class="num" id="4105914">2</span><span class="op" id="4105915">&amp;</span><span class="num" id="4105916">0xcc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4105922">b3</span>&nbsp;<span class="op" id="4105925">:=</span>&nbsp;<span class="ident" id="4105928">b2</span><span class="op" id="4105930">&gt;&gt;</span><span class="num" id="4105932">1</span><span class="op" id="4105933">&amp;</span><span class="num" id="4105934">0x55</span>&nbsp;<span class="op" id="4105939">|</span>&nbsp;<span class="ident" id="4105941">b2</span><span class="op" id="4105943">&lt;&lt;</span><span class="num" id="4105945">1</span><span class="op" id="4105946">&amp;</span><span class="num" id="4105947">0xaa</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4105953">return</span>&nbsp;<span class="ident" id="4105960">b3</span><br>
<span class="lineno"></span><span class="op" id="4105963">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4105966">var</span>&nbsp;<span class="op" id="4105970">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4105973">oidExtensionSubjectKeyId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4106007">=</span>&nbsp;<span class="op" id="4106009">[</span><span class="op" id="4106010">]</span><span class="builtintype" id="4106011">int</span><span class="op" id="4106014">{</span><span class="num" id="4106015">2</span><span class="op" id="4106016">,</span>&nbsp;<span class="num" id="4106018">5</span><span class="op" id="4106019">,</span>&nbsp;<span class="num" id="4106021">29</span><span class="op" id="4106023">,</span>&nbsp;<span class="num" id="4106025">14</span><span class="op" id="4106027">}</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4106030">oidExtensionKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4106064">=</span>&nbsp;<span class="op" id="4106066">[</span><span class="op" id="4106067">]</span><span class="builtintype" id="4106068">int</span><span class="op" id="4106071">{</span><span class="num" id="4106072">2</span><span class="op" id="4106073">,</span>&nbsp;<span class="num" id="4106075">5</span><span class="op" id="4106076">,</span>&nbsp;<span class="num" id="4106078">29</span><span class="op" id="4106080">,</span>&nbsp;<span class="num" id="4106082">15</span><span class="op" id="4106084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4106087">oidExtensionExtendedKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4106121">=</span>&nbsp;<span class="op" id="4106123">[</span><span class="op" id="4106124">]</span><span class="builtintype" id="4106125">int</span><span class="op" id="4106128">{</span><span class="num" id="4106129">2</span><span class="op" id="4106130">,</span>&nbsp;<span class="num" id="4106132">5</span><span class="op" id="4106133">,</span>&nbsp;<span class="num" id="4106135">29</span><span class="op" id="4106137">,</span>&nbsp;<span class="num" id="4106139">37</span><span class="op" id="4106141">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4106144">oidExtensionAuthorityKeyId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4106178">=</span>&nbsp;<span class="op" id="4106180">[</span><span class="op" id="4106181">]</span><span class="builtintype" id="4106182">int</span><span class="op" id="4106185">{</span><span class="num" id="4106186">2</span><span class="op" id="4106187">,</span>&nbsp;<span class="num" id="4106189">5</span><span class="op" id="4106190">,</span>&nbsp;<span class="num" id="4106192">29</span><span class="op" id="4106194">,</span>&nbsp;<span class="num" id="4106196">35</span><span class="op" id="4106198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4106201">oidExtensionBasicConstraints</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4106235">=</span>&nbsp;<span class="op" id="4106237">[</span><span class="op" id="4106238">]</span><span class="builtintype" id="4106239">int</span><span class="op" id="4106242">{</span><span class="num" id="4106243">2</span><span class="op" id="4106244">,</span>&nbsp;<span class="num" id="4106246">5</span><span class="op" id="4106247">,</span>&nbsp;<span class="num" id="4106249">29</span><span class="op" id="4106251">,</span>&nbsp;<span class="num" id="4106253">19</span><span class="op" id="4106255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4106258">oidExtensionSubjectAltName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4106292">=</span>&nbsp;<span class="op" id="4106294">[</span><span class="op" id="4106295">]</span><span class="builtintype" id="4106296">int</span><span class="op" id="4106299">{</span><span class="num" id="4106300">2</span><span class="op" id="4106301">,</span>&nbsp;<span class="num" id="4106303">5</span><span class="op" id="4106304">,</span>&nbsp;<span class="num" id="4106306">29</span><span class="op" id="4106308">,</span>&nbsp;<span class="num" id="4106310">17</span><span class="op" id="4106312">}</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4106315">oidExtensionCertificatePolicies</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4106349">=</span>&nbsp;<span class="op" id="4106351">[</span><span class="op" id="4106352">]</span><span class="builtintype" id="4106353">int</span><span class="op" id="4106356">{</span><span class="num" id="4106357">2</span><span class="op" id="4106358">,</span>&nbsp;<span class="num" id="4106360">5</span><span class="op" id="4106361">,</span>&nbsp;<span class="num" id="4106363">29</span><span class="op" id="4106365">,</span>&nbsp;<span class="num" id="4106367">32</span><span class="op" id="4106369">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4106372">oidExtensionNameConstraints</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4106406">=</span>&nbsp;<span class="op" id="4106408">[</span><span class="op" id="4106409">]</span><span class="builtintype" id="4106410">int</span><span class="op" id="4106413">{</span><span class="num" id="4106414">2</span><span class="op" id="4106415">,</span>&nbsp;<span class="num" id="4106417">5</span><span class="op" id="4106418">,</span>&nbsp;<span class="num" id="4106420">29</span><span class="op" id="4106422">,</span>&nbsp;<span class="num" id="4106424">30</span><span class="op" id="4106426">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4106429">oidExtensionCRLDistributionPoints</span>&nbsp;<span class="op" id="4106463">=</span>&nbsp;<span class="op" id="4106465">[</span><span class="op" id="4106466">]</span><span class="builtintype" id="4106467">int</span><span class="op" id="4106470">{</span><span class="num" id="4106471">2</span><span class="op" id="4106472">,</span>&nbsp;<span class="num" id="4106474">5</span><span class="op" id="4106475">,</span>&nbsp;<span class="num" id="4106477">29</span><span class="op" id="4106479">,</span>&nbsp;<span class="num" id="4106481">31</span><span class="op" id="4106483">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4106486">oidExtensionAuthorityInfoAccess</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4106520">=</span>&nbsp;<span class="op" id="4106522">[</span><span class="op" id="4106523">]</span><span class="builtintype" id="4106524">int</span><span class="op" id="4106527">{</span><span class="num" id="4106528">1</span><span class="op" id="4106529">,</span>&nbsp;<span class="num" id="4106531">3</span><span class="op" id="4106532">,</span>&nbsp;<span class="num" id="4106534">6</span><span class="op" id="4106535">,</span>&nbsp;<span class="num" id="4106537">1</span><span class="op" id="4106538">,</span>&nbsp;<span class="num" id="4106540">5</span><span class="op" id="4106541">,</span>&nbsp;<span class="num" id="4106543">5</span><span class="op" id="4106544">,</span>&nbsp;<span class="num" id="4106546">7</span><span class="op" id="4106547">,</span>&nbsp;<span class="num" id="4106549">1</span><span class="op" id="4106550">,</span>&nbsp;<span class="num" id="4106552">1</span><span class="op" id="4106553">}</span><br>
<span class="lineno"></span><span class="op" id="4106555">)</span><br>
<span class="lineno">1150</span><br>
<span class="lineno"></span><span class="keyword" id="4106558">var</span>&nbsp;<span class="op" id="4106562">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4106565">oidAuthorityInfoAccessOcsp</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4106595">=</span>&nbsp;<span class="ident" id="4106597">asn1</span><span class="op" id="4106601">.</span><span class="ident" id="4106602">ObjectIdentifier</span><span class="op" id="4106618">{</span><span class="num" id="4106619">1</span><span class="op" id="4106620">,</span>&nbsp;<span class="num" id="4106622">3</span><span class="op" id="4106623">,</span>&nbsp;<span class="num" id="4106625">6</span><span class="op" id="4106626">,</span>&nbsp;<span class="num" id="4106628">1</span><span class="op" id="4106629">,</span>&nbsp;<span class="num" id="4106631">5</span><span class="op" id="4106632">,</span>&nbsp;<span class="num" id="4106634">5</span><span class="op" id="4106635">,</span>&nbsp;<span class="num" id="4106637">7</span><span class="op" id="4106638">,</span>&nbsp;<span class="num" id="4106640">48</span><span class="op" id="4106642">,</span>&nbsp;<span class="num" id="4106644">1</span><span class="op" id="4106645">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4106648">oidAuthorityInfoAccessIssuers</span>&nbsp;<span class="op" id="4106678">=</span>&nbsp;<span class="ident" id="4106680">asn1</span><span class="op" id="4106684">.</span><span class="ident" id="4106685">ObjectIdentifier</span><span class="op" id="4106701">{</span><span class="num" id="4106702">1</span><span class="op" id="4106703">,</span>&nbsp;<span class="num" id="4106705">3</span><span class="op" id="4106706">,</span>&nbsp;<span class="num" id="4106708">6</span><span class="op" id="4106709">,</span>&nbsp;<span class="num" id="4106711">1</span><span class="op" id="4106712">,</span>&nbsp;<span class="num" id="4106714">5</span><span class="op" id="4106715">,</span>&nbsp;<span class="num" id="4106717">5</span><span class="op" id="4106718">,</span>&nbsp;<span class="num" id="4106720">7</span><span class="op" id="4106721">,</span>&nbsp;<span class="num" id="4106723">48</span><span class="op" id="4106725">,</span>&nbsp;<span class="num" id="4106727">2</span><span class="op" id="4106728">}</span><br>
<span class="lineno"></span><span class="op" id="4106730">)</span><br>
<span class="lineno">1155</span><br>
<span class="lineno"></span><span class="comment" id="4106733">//&nbsp;oidNotInExtensions&nbsp;returns&nbsp;whether&nbsp;an&nbsp;extension&nbsp;with&nbsp;the&nbsp;given&nbsp;oid&nbsp;exists&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4106813">//&nbsp;extensions.</span><br>
<span class="lineno"></span><span class="keyword" id="4106828">func</span>&nbsp;<span class="ident" id="4106833">oidInExtensions</span><span class="op" id="4106848">(</span><span class="ident" id="4106849">oid</span>&nbsp;<span class="ident" id="4106853">asn1</span><span class="op" id="4106857">.</span><span class="ident" id="4106858">ObjectIdentifier</span><span class="op" id="4106874">,</span>&nbsp;<span class="ident" id="4106876">extensions</span>&nbsp;<span class="op" id="4106887">[</span><span class="op" id="4106888">]</span><span class="ident" id="4106889">pkix</span><span class="op" id="4106893">.</span><span class="ident" id="4106894">Extension</span><span class="op" id="4106903">)</span>&nbsp;<span class="builtintype" id="4106905">bool</span>&nbsp;<span class="op" id="4106910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4106913">for</span>&nbsp;<span class="ident" id="4106917">_</span><span class="op" id="4106918">,</span>&nbsp;<span class="ident" id="4106920">e</span>&nbsp;<span class="op" id="4106922">:=</span>&nbsp;<span class="keyword" id="4106925">range</span>&nbsp;<span class="ident" id="4106931">extensions</span>&nbsp;<span class="op" id="4106942">{</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4106946">if</span>&nbsp;<span class="ident" id="4106949">e</span><span class="op" id="4106950">.</span><span class="ident" id="4106951">Id</span><span class="op" id="4106953">.</span><span class="ident" id="4106954">Equal</span><span class="op" id="4106959">(</span><span class="ident" id="4106960">oid</span><span class="op" id="4106963">)</span>&nbsp;<span class="op" id="4106965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4106970">return</span>&nbsp;<span class="builtintype" id="4106977">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4106984">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4106987">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4106990">return</span>&nbsp;<span class="builtintype" id="4106997">false</span><br>
<span class="lineno">1165</span><span class="op" id="4107003">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4107006">//&nbsp;marshalSANs&nbsp;marshals&nbsp;a&nbsp;list&nbsp;of&nbsp;addresses&nbsp;into&nbsp;a&nbsp;the&nbsp;contents&nbsp;of&nbsp;an&nbsp;X.509</span><br>
<span class="lineno"></span><span class="comment" id="4107082">//&nbsp;SubjectAlternativeName&nbsp;extension.</span><br>
<span class="lineno"></span><span class="keyword" id="4107119">func</span>&nbsp;<span class="ident" id="4107124">marshalSANs</span><span class="op" id="4107135">(</span><span class="ident" id="4107136">dnsNames</span><span class="op" id="4107144">,</span>&nbsp;<span class="ident" id="4107146">emailAddresses</span>&nbsp;<span class="op" id="4107161">[</span><span class="op" id="4107162">]</span><span class="builtintype" id="4107163">string</span><span class="op" id="4107169">,</span>&nbsp;<span class="ident" id="4107171">ipAddresses</span>&nbsp;<span class="op" id="4107183">[</span><span class="op" id="4107184">]</span><span class="ident" id="4107185">net</span><span class="op" id="4107188">.</span><span class="ident" id="4107189">IP</span><span class="op" id="4107191">)</span>&nbsp;<span class="op" id="4107193">(</span><span class="ident" id="4107194">derBytes</span>&nbsp;<span class="op" id="4107203">[</span><span class="op" id="4107204">]</span><span class="builtintype" id="4107205">byte</span><span class="op" id="4107209">,</span>&nbsp;<span class="ident" id="4107211">err</span>&nbsp;<span class="builtintype" id="4107215">error</span><span class="op" id="4107220">)</span>&nbsp;<span class="op" id="4107222">{</span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4107225">var</span>&nbsp;<span class="ident" id="4107229">rawValues</span>&nbsp;<span class="op" id="4107239">[</span><span class="op" id="4107240">]</span><span class="ident" id="4107241">asn1</span><span class="op" id="4107245">.</span><span class="ident" id="4107246">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4107256">for</span>&nbsp;<span class="ident" id="4107260">_</span><span class="op" id="4107261">,</span>&nbsp;<span class="ident" id="4107263">name</span>&nbsp;<span class="op" id="4107268">:=</span>&nbsp;<span class="keyword" id="4107271">range</span>&nbsp;<span class="ident" id="4107277">dnsNames</span>&nbsp;<span class="op" id="4107286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4107290">rawValues</span>&nbsp;<span class="op" id="4107300">=</span>&nbsp;<span class="builtinfunc" id="4107302">append</span><span class="op" id="4107308">(</span><span class="ident" id="4107309">rawValues</span><span class="op" id="4107318">,</span>&nbsp;<span class="ident" id="4107320">asn1</span><span class="op" id="4107324">.</span><span class="ident" id="4107325">RawValue</span><span class="op" id="4107333">{</span><span class="ident" id="4107334">Tag</span><span class="op" id="4107337">:</span>&nbsp;<span class="num" id="4107339">2</span><span class="op" id="4107340">,</span>&nbsp;<span class="ident" id="4107342">Class</span><span class="op" id="4107347">:</span>&nbsp;<span class="num" id="4107349">2</span><span class="op" id="4107350">,</span>&nbsp;<span class="ident" id="4107352">Bytes</span><span class="op" id="4107357">:</span>&nbsp;<span class="op" id="4107359">[</span><span class="op" id="4107360">]</span><span class="builtintype" id="4107361">byte</span><span class="op" id="4107365">(</span><span class="ident" id="4107366">name</span><span class="op" id="4107370">)</span><span class="op" id="4107371">}</span><span class="op" id="4107372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4107375">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4107378">for</span>&nbsp;<span class="ident" id="4107382">_</span><span class="op" id="4107383">,</span>&nbsp;<span class="ident" id="4107385">email</span>&nbsp;<span class="op" id="4107391">:=</span>&nbsp;<span class="keyword" id="4107394">range</span>&nbsp;<span class="ident" id="4107400">emailAddresses</span>&nbsp;<span class="op" id="4107415">{</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4107419">rawValues</span>&nbsp;<span class="op" id="4107429">=</span>&nbsp;<span class="builtinfunc" id="4107431">append</span><span class="op" id="4107437">(</span><span class="ident" id="4107438">rawValues</span><span class="op" id="4107447">,</span>&nbsp;<span class="ident" id="4107449">asn1</span><span class="op" id="4107453">.</span><span class="ident" id="4107454">RawValue</span><span class="op" id="4107462">{</span><span class="ident" id="4107463">Tag</span><span class="op" id="4107466">:</span>&nbsp;<span class="num" id="4107468">1</span><span class="op" id="4107469">,</span>&nbsp;<span class="ident" id="4107471">Class</span><span class="op" id="4107476">:</span>&nbsp;<span class="num" id="4107478">2</span><span class="op" id="4107479">,</span>&nbsp;<span class="ident" id="4107481">Bytes</span><span class="op" id="4107486">:</span>&nbsp;<span class="op" id="4107488">[</span><span class="op" id="4107489">]</span><span class="builtintype" id="4107490">byte</span><span class="op" id="4107494">(</span><span class="ident" id="4107495">email</span><span class="op" id="4107500">)</span><span class="op" id="4107501">}</span><span class="op" id="4107502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4107505">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4107508">for</span>&nbsp;<span class="ident" id="4107512">_</span><span class="op" id="4107513">,</span>&nbsp;<span class="ident" id="4107515">rawIP</span>&nbsp;<span class="op" id="4107521">:=</span>&nbsp;<span class="keyword" id="4107524">range</span>&nbsp;<span class="ident" id="4107530">ipAddresses</span>&nbsp;<span class="op" id="4107542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4107546">//&nbsp;If&nbsp;possible,&nbsp;we&nbsp;always&nbsp;want&nbsp;to&nbsp;encode&nbsp;IPv4&nbsp;addresses&nbsp;in&nbsp;4&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4107616">ip</span>&nbsp;<span class="op" id="4107619">:=</span>&nbsp;<span class="ident" id="4107622">rawIP</span><span class="op" id="4107627">.</span><span class="ident" id="4107628">To4</span><span class="op" id="4107631">(</span><span class="op" id="4107632">)</span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4107636">if</span>&nbsp;<span class="ident" id="4107639">ip</span>&nbsp;<span class="op" id="4107642">==</span>&nbsp;<span class="ident" id="4107645">nil</span>&nbsp;<span class="op" id="4107649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4107654">ip</span>&nbsp;<span class="op" id="4107657">=</span>&nbsp;<span class="ident" id="4107659">rawIP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4107667">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4107671">rawValues</span>&nbsp;<span class="op" id="4107681">=</span>&nbsp;<span class="builtinfunc" id="4107683">append</span><span class="op" id="4107689">(</span><span class="ident" id="4107690">rawValues</span><span class="op" id="4107699">,</span>&nbsp;<span class="ident" id="4107701">asn1</span><span class="op" id="4107705">.</span><span class="ident" id="4107706">RawValue</span><span class="op" id="4107714">{</span><span class="ident" id="4107715">Tag</span><span class="op" id="4107718">:</span>&nbsp;<span class="num" id="4107720">7</span><span class="op" id="4107721">,</span>&nbsp;<span class="ident" id="4107723">Class</span><span class="op" id="4107728">:</span>&nbsp;<span class="num" id="4107730">2</span><span class="op" id="4107731">,</span>&nbsp;<span class="ident" id="4107733">Bytes</span><span class="op" id="4107738">:</span>&nbsp;<span class="ident" id="4107740">ip</span><span class="op" id="4107742">}</span><span class="op" id="4107743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4107746">}</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4107749">return</span>&nbsp;<span class="ident" id="4107756">asn1</span><span class="op" id="4107760">.</span><span class="ident" id="4107761">Marshal</span><span class="op" id="4107768">(</span><span class="ident" id="4107769">rawValues</span><span class="op" id="4107778">)</span><br>
<span class="lineno"></span><span class="op" id="4107780">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4107783">func</span>&nbsp;<span class="ident" id="4107788">buildExtensions</span><span class="op" id="4107803">(</span><span class="ident" id="4107804">template</span>&nbsp;<span class="op" id="4107813">*</span><span class="ident" id="4107814">Certificate</span><span class="op" id="4107825">)</span>&nbsp;<span class="op" id="4107827">(</span><span class="ident" id="4107828">ret</span>&nbsp;<span class="op" id="4107832">[</span><span class="op" id="4107833">]</span><span class="ident" id="4107834">pkix</span><span class="op" id="4107838">.</span><span class="ident" id="4107839">Extension</span><span class="op" id="4107848">,</span>&nbsp;<span class="ident" id="4107850">err</span>&nbsp;<span class="builtintype" id="4107854">error</span><span class="op" id="4107859">)</span>&nbsp;<span class="op" id="4107861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4107864">ret</span>&nbsp;<span class="op" id="4107868">=</span>&nbsp;<span class="builtinfunc" id="4107870">make</span><span class="op" id="4107874">(</span><span class="op" id="4107875">[</span><span class="op" id="4107876">]</span><span class="ident" id="4107877">pkix</span><span class="op" id="4107881">.</span><span class="ident" id="4107882">Extension</span><span class="op" id="4107891">,</span>&nbsp;<span class="num" id="4107893">10</span>&nbsp;<span class="comment" id="4107896">/*&nbsp;maximum&nbsp;number&nbsp;of&nbsp;elements.&nbsp;*/</span><span class="op" id="4107929">)</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4107932">n</span>&nbsp;<span class="op" id="4107934">:=</span>&nbsp;<span class="num" id="4107937">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4107941">if</span>&nbsp;<span class="ident" id="4107944">template</span><span class="op" id="4107952">.</span><span class="ident" id="4107953">KeyUsage</span>&nbsp;<span class="op" id="4107962">!=</span>&nbsp;<span class="num" id="4107965">0</span>&nbsp;<span class="op" id="4107967">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4107972">!</span><span class="ident" id="4107973">oidInExtensions</span><span class="op" id="4107988">(</span><span class="ident" id="4107989">oidExtensionKeyUsage</span><span class="op" id="4108009">,</span>&nbsp;<span class="ident" id="4108011">template</span><span class="op" id="4108019">.</span><span class="ident" id="4108020">ExtraExtensions</span><span class="op" id="4108035">)</span>&nbsp;<span class="op" id="4108037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4108041">ret</span><span class="op" id="4108044">[</span><span class="ident" id="4108045">n</span><span class="op" id="4108046">]</span><span class="op" id="4108047">.</span><span class="ident" id="4108048">Id</span>&nbsp;<span class="op" id="4108051">=</span>&nbsp;<span class="ident" id="4108053">oidExtensionKeyUsage</span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4108076">ret</span><span class="op" id="4108079">[</span><span class="ident" id="4108080">n</span><span class="op" id="4108081">]</span><span class="op" id="4108082">.</span><span class="ident" id="4108083">Critical</span>&nbsp;<span class="op" id="4108092">=</span>&nbsp;<span class="builtintype" id="4108094">true</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4108102">var</span>&nbsp;<span class="ident" id="4108106">a</span>&nbsp;<span class="op" id="4108108">[</span><span class="num" id="4108109">2</span><span class="op" id="4108110">]</span><span class="builtintype" id="4108111">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4108118">a</span><span class="op" id="4108119">[</span><span class="num" id="4108120">0</span><span class="op" id="4108121">]</span>&nbsp;<span class="op" id="4108123">=</span>&nbsp;<span class="ident" id="4108125">reverseBitsInAByte</span><span class="op" id="4108143">(</span><span class="builtintype" id="4108144">byte</span><span class="op" id="4108148">(</span><span class="ident" id="4108149">template</span><span class="op" id="4108157">.</span><span class="ident" id="4108158">KeyUsage</span><span class="op" id="4108166">)</span><span class="op" id="4108167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4108171">a</span><span class="op" id="4108172">[</span><span class="num" id="4108173">1</span><span class="op" id="4108174">]</span>&nbsp;<span class="op" id="4108176">=</span>&nbsp;<span class="ident" id="4108178">reverseBitsInAByte</span><span class="op" id="4108196">(</span><span class="builtintype" id="4108197">byte</span><span class="op" id="4108201">(</span><span class="ident" id="4108202">template</span><span class="op" id="4108210">.</span><span class="ident" id="4108211">KeyUsage</span>&nbsp;<span class="op" id="4108220">&gt;&gt;</span>&nbsp;<span class="num" id="4108223">8</span><span class="op" id="4108224">)</span><span class="op" id="4108225">)</span><br>
<span class="lineno">1200</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4108230">l</span>&nbsp;<span class="op" id="4108232">:=</span>&nbsp;<span class="num" id="4108235">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4108239">if</span>&nbsp;<span class="ident" id="4108242">a</span><span class="op" id="4108243">[</span><span class="num" id="4108244">1</span><span class="op" id="4108245">]</span>&nbsp;<span class="op" id="4108247">!=</span>&nbsp;<span class="num" id="4108250">0</span>&nbsp;<span class="op" id="4108252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4108257">l</span>&nbsp;<span class="op" id="4108259">=</span>&nbsp;<span class="num" id="4108261">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4108265">}</span><br>
<span class="lineno">1205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4108270">ret</span><span class="op" id="4108273">[</span><span class="ident" id="4108274">n</span><span class="op" id="4108275">]</span><span class="op" id="4108276">.</span><span class="ident" id="4108277">Value</span><span class="op" id="4108282">,</span>&nbsp;<span class="ident" id="4108284">err</span>&nbsp;<span class="op" id="4108288">=</span>&nbsp;<span class="ident" id="4108290">asn1</span><span class="op" id="4108294">.</span><span class="ident" id="4108295">Marshal</span><span class="op" id="4108302">(</span><span class="ident" id="4108303">asn1</span><span class="op" id="4108307">.</span><span class="ident" id="4108308">BitString</span><span class="op" id="4108317">{</span><span class="ident" id="4108318">Bytes</span><span class="op" id="4108323">:</span>&nbsp;<span class="ident" id="4108325">a</span><span class="op" id="4108326">[</span><span class="num" id="4108327">0</span><span class="op" id="4108328">:</span><span class="ident" id="4108329">l</span><span class="op" id="4108330">]</span><span class="op" id="4108331">,</span>&nbsp;<span class="ident" id="4108333">BitLength</span><span class="op" id="4108342">:</span>&nbsp;<span class="ident" id="4108344">l</span>&nbsp;<span class="op" id="4108346">*</span>&nbsp;<span class="num" id="4108348">8</span><span class="op" id="4108349">}</span><span class="op" id="4108350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4108354">if</span>&nbsp;<span class="ident" id="4108357">err</span>&nbsp;<span class="op" id="4108361">!=</span>&nbsp;<span class="ident" id="4108364">nil</span>&nbsp;<span class="op" id="4108368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4108373">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4108382">}</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4108386">n</span><span class="op" id="4108387">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4108391">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4108395">if</span>&nbsp;<span class="op" id="4108398">(</span><span class="builtinfunc" id="4108399">len</span><span class="op" id="4108402">(</span><span class="ident" id="4108403">template</span><span class="op" id="4108411">.</span><span class="ident" id="4108412">ExtKeyUsage</span><span class="op" id="4108423">)</span>&nbsp;<span class="op" id="4108425">&gt;</span>&nbsp;<span class="num" id="4108427">0</span>&nbsp;<span class="op" id="4108429">||</span>&nbsp;<span class="builtinfunc" id="4108432">len</span><span class="op" id="4108435">(</span><span class="ident" id="4108436">template</span><span class="op" id="4108444">.</span><span class="ident" id="4108445">UnknownExtKeyUsage</span><span class="op" id="4108463">)</span>&nbsp;<span class="op" id="4108465">&gt;</span>&nbsp;<span class="num" id="4108467">0</span><span class="op" id="4108468">)</span>&nbsp;<span class="op" id="4108470">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4108475">!</span><span class="ident" id="4108476">oidInExtensions</span><span class="op" id="4108491">(</span><span class="ident" id="4108492">oidExtensionExtendedKeyUsage</span><span class="op" id="4108520">,</span>&nbsp;<span class="ident" id="4108522">template</span><span class="op" id="4108530">.</span><span class="ident" id="4108531">ExtraExtensions</span><span class="op" id="4108546">)</span>&nbsp;<span class="op" id="4108548">{</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4108552">ret</span><span class="op" id="4108555">[</span><span class="ident" id="4108556">n</span><span class="op" id="4108557">]</span><span class="op" id="4108558">.</span><span class="ident" id="4108559">Id</span>&nbsp;<span class="op" id="4108562">=</span>&nbsp;<span class="ident" id="4108564">oidExtensionExtendedKeyUsage</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4108596">var</span>&nbsp;<span class="ident" id="4108600">oids</span>&nbsp;<span class="op" id="4108605">[</span><span class="op" id="4108606">]</span><span class="ident" id="4108607">asn1</span><span class="op" id="4108611">.</span><span class="ident" id="4108612">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4108631">for</span>&nbsp;<span class="ident" id="4108635">_</span><span class="op" id="4108636">,</span>&nbsp;<span class="ident" id="4108638">u</span>&nbsp;<span class="op" id="4108640">:=</span>&nbsp;<span class="keyword" id="4108643">range</span>&nbsp;<span class="ident" id="4108649">template</span><span class="op" id="4108657">.</span><span class="ident" id="4108658">ExtKeyUsage</span>&nbsp;<span class="op" id="4108670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4108675">if</span>&nbsp;<span class="ident" id="4108678">oid</span><span class="op" id="4108681">,</span>&nbsp;<span class="ident" id="4108683">ok</span>&nbsp;<span class="op" id="4108686">:=</span>&nbsp;<span class="ident" id="4108689">oidFromExtKeyUsage</span><span class="op" id="4108707">(</span><span class="ident" id="4108708">u</span><span class="op" id="4108709">)</span><span class="op" id="4108710">;</span>&nbsp;<span class="ident" id="4108712">ok</span>&nbsp;<span class="op" id="4108715">{</span><br>
<span class="lineno">1220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4108721">oids</span>&nbsp;<span class="op" id="4108726">=</span>&nbsp;<span class="builtinfunc" id="4108728">append</span><span class="op" id="4108734">(</span><span class="ident" id="4108735">oids</span><span class="op" id="4108739">,</span>&nbsp;<span class="ident" id="4108741">oid</span><span class="op" id="4108744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4108749">}</span>&nbsp;<span class="keyword" id="4108751">else</span>&nbsp;<span class="op" id="4108756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4108762">panic</span><span class="op" id="4108767">(</span><span class="string" id="4108768">&#34;internal&nbsp;error&#34;</span><span class="op" id="4108784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4108789">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4108793">}</span><br>
<span class="lineno">1225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4108798">oids</span>&nbsp;<span class="op" id="4108803">=</span>&nbsp;<span class="builtinfunc" id="4108805">append</span><span class="op" id="4108811">(</span><span class="ident" id="4108812">oids</span><span class="op" id="4108816">,</span>&nbsp;<span class="ident" id="4108818">template</span><span class="op" id="4108826">.</span><span class="ident" id="4108827">UnknownExtKeyUsage</span><span class="op" id="4108845">...</span><span class="op" id="4108848">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4108853">ret</span><span class="op" id="4108856">[</span><span class="ident" id="4108857">n</span><span class="op" id="4108858">]</span><span class="op" id="4108859">.</span><span class="ident" id="4108860">Value</span><span class="op" id="4108865">,</span>&nbsp;<span class="ident" id="4108867">err</span>&nbsp;<span class="op" id="4108871">=</span>&nbsp;<span class="ident" id="4108873">asn1</span><span class="op" id="4108877">.</span><span class="ident" id="4108878">Marshal</span><span class="op" id="4108885">(</span><span class="ident" id="4108886">oids</span><span class="op" id="4108890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4108894">if</span>&nbsp;<span class="ident" id="4108897">err</span>&nbsp;<span class="op" id="4108901">!=</span>&nbsp;<span class="ident" id="4108904">nil</span>&nbsp;<span class="op" id="4108908">{</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4108913">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4108922">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4108926">n</span><span class="op" id="4108927">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4108931">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4108935">if</span>&nbsp;<span class="ident" id="4108938">template</span><span class="op" id="4108946">.</span><span class="ident" id="4108947">BasicConstraintsValid</span>&nbsp;<span class="op" id="4108969">&amp;&amp;</span>&nbsp;<span class="op" id="4108972">!</span><span class="ident" id="4108973">oidInExtensions</span><span class="op" id="4108988">(</span><span class="ident" id="4108989">oidExtensionBasicConstraints</span><span class="op" id="4109017">,</span>&nbsp;<span class="ident" id="4109019">template</span><span class="op" id="4109027">.</span><span class="ident" id="4109028">ExtraExtensions</span><span class="op" id="4109043">)</span>&nbsp;<span class="op" id="4109045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4109049">//&nbsp;Leaving&nbsp;MaxPathLen&nbsp;as&nbsp;zero&nbsp;indicates&nbsp;that&nbsp;no&nbsp;maximum&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4109112">//&nbsp;length&nbsp;is&nbsp;desired,&nbsp;unless&nbsp;MaxPathLenZero&nbsp;is&nbsp;set.&nbsp;A&nbsp;value&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4109177">//&nbsp;-1&nbsp;causes&nbsp;encoding/asn1&nbsp;to&nbsp;omit&nbsp;the&nbsp;value&nbsp;as&nbsp;desired.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4109236">maxPathLen</span>&nbsp;<span class="op" id="4109247">:=</span>&nbsp;<span class="ident" id="4109250">template</span><span class="op" id="4109258">.</span><span class="ident" id="4109259">MaxPathLen</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4109272">if</span>&nbsp;<span class="ident" id="4109275">maxPathLen</span>&nbsp;<span class="op" id="4109286">==</span>&nbsp;<span class="num" id="4109289">0</span>&nbsp;<span class="op" id="4109291">&amp;&amp;</span>&nbsp;<span class="op" id="4109294">!</span><span class="ident" id="4109295">template</span><span class="op" id="4109303">.</span><span class="ident" id="4109304">MaxPathLenZero</span>&nbsp;<span class="op" id="4109319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4109324">maxPathLen</span>&nbsp;<span class="op" id="4109335">=</span>&nbsp;<span class="op" id="4109337">-</span><span class="num" id="4109338">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4109342">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4109346">ret</span><span class="op" id="4109349">[</span><span class="ident" id="4109350">n</span><span class="op" id="4109351">]</span><span class="op" id="4109352">.</span><span class="ident" id="4109353">Id</span>&nbsp;<span class="op" id="4109356">=</span>&nbsp;<span class="ident" id="4109358">oidExtensionBasicConstraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4109389">ret</span><span class="op" id="4109392">[</span><span class="ident" id="4109393">n</span><span class="op" id="4109394">]</span><span class="op" id="4109395">.</span><span class="ident" id="4109396">Value</span><span class="op" id="4109401">,</span>&nbsp;<span class="ident" id="4109403">err</span>&nbsp;<span class="op" id="4109407">=</span>&nbsp;<span class="ident" id="4109409">asn1</span><span class="op" id="4109413">.</span><span class="ident" id="4109414">Marshal</span><span class="op" id="4109421">(</span><span class="ident" id="4109422">basicConstraints</span><span class="op" id="4109438">{</span><span class="ident" id="4109439">template</span><span class="op" id="4109447">.</span><span class="ident" id="4109448">IsCA</span><span class="op" id="4109452">,</span>&nbsp;<span class="ident" id="4109454">maxPathLen</span><span class="op" id="4109464">}</span><span class="op" id="4109465">)</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4109469">ret</span><span class="op" id="4109472">[</span><span class="ident" id="4109473">n</span><span class="op" id="4109474">]</span><span class="op" id="4109475">.</span><span class="ident" id="4109476">Critical</span>&nbsp;<span class="op" id="4109485">=</span>&nbsp;<span class="builtintype" id="4109487">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4109494">if</span>&nbsp;<span class="ident" id="4109497">err</span>&nbsp;<span class="op" id="4109501">!=</span>&nbsp;<span class="ident" id="4109504">nil</span>&nbsp;<span class="op" id="4109508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4109513">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4109522">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4109526">n</span><span class="op" id="4109527">++</span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4109531">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4109535">if</span>&nbsp;<span class="builtinfunc" id="4109538">len</span><span class="op" id="4109541">(</span><span class="ident" id="4109542">template</span><span class="op" id="4109550">.</span><span class="ident" id="4109551">SubjectKeyId</span><span class="op" id="4109563">)</span>&nbsp;<span class="op" id="4109565">&gt;</span>&nbsp;<span class="num" id="4109567">0</span>&nbsp;<span class="op" id="4109569">&amp;&amp;</span>&nbsp;<span class="op" id="4109572">!</span><span class="ident" id="4109573">oidInExtensions</span><span class="op" id="4109588">(</span><span class="ident" id="4109589">oidExtensionSubjectKeyId</span><span class="op" id="4109613">,</span>&nbsp;<span class="ident" id="4109615">template</span><span class="op" id="4109623">.</span><span class="ident" id="4109624">ExtraExtensions</span><span class="op" id="4109639">)</span>&nbsp;<span class="op" id="4109641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4109645">ret</span><span class="op" id="4109648">[</span><span class="ident" id="4109649">n</span><span class="op" id="4109650">]</span><span class="op" id="4109651">.</span><span class="ident" id="4109652">Id</span>&nbsp;<span class="op" id="4109655">=</span>&nbsp;<span class="ident" id="4109657">oidExtensionSubjectKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4109684">ret</span><span class="op" id="4109687">[</span><span class="ident" id="4109688">n</span><span class="op" id="4109689">]</span><span class="op" id="4109690">.</span><span class="ident" id="4109691">Value</span><span class="op" id="4109696">,</span>&nbsp;<span class="ident" id="4109698">err</span>&nbsp;<span class="op" id="4109702">=</span>&nbsp;<span class="ident" id="4109704">asn1</span><span class="op" id="4109708">.</span><span class="ident" id="4109709">Marshal</span><span class="op" id="4109716">(</span><span class="ident" id="4109717">template</span><span class="op" id="4109725">.</span><span class="ident" id="4109726">SubjectKeyId</span><span class="op" id="4109738">)</span><br>
<span class="lineno">1255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4109742">if</span>&nbsp;<span class="ident" id="4109745">err</span>&nbsp;<span class="op" id="4109749">!=</span>&nbsp;<span class="ident" id="4109752">nil</span>&nbsp;<span class="op" id="4109756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4109761">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4109770">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4109774">n</span><span class="op" id="4109775">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4109779">}</span><br>
<span class="lineno">1260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4109783">if</span>&nbsp;<span class="builtinfunc" id="4109786">len</span><span class="op" id="4109789">(</span><span class="ident" id="4109790">template</span><span class="op" id="4109798">.</span><span class="ident" id="4109799">AuthorityKeyId</span><span class="op" id="4109813">)</span>&nbsp;<span class="op" id="4109815">&gt;</span>&nbsp;<span class="num" id="4109817">0</span>&nbsp;<span class="op" id="4109819">&amp;&amp;</span>&nbsp;<span class="op" id="4109822">!</span><span class="ident" id="4109823">oidInExtensions</span><span class="op" id="4109838">(</span><span class="ident" id="4109839">oidExtensionAuthorityKeyId</span><span class="op" id="4109865">,</span>&nbsp;<span class="ident" id="4109867">template</span><span class="op" id="4109875">.</span><span class="ident" id="4109876">ExtraExtensions</span><span class="op" id="4109891">)</span>&nbsp;<span class="op" id="4109893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4109897">ret</span><span class="op" id="4109900">[</span><span class="ident" id="4109901">n</span><span class="op" id="4109902">]</span><span class="op" id="4109903">.</span><span class="ident" id="4109904">Id</span>&nbsp;<span class="op" id="4109907">=</span>&nbsp;<span class="ident" id="4109909">oidExtensionAuthorityKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4109938">ret</span><span class="op" id="4109941">[</span><span class="ident" id="4109942">n</span><span class="op" id="4109943">]</span><span class="op" id="4109944">.</span><span class="ident" id="4109945">Value</span><span class="op" id="4109950">,</span>&nbsp;<span class="ident" id="4109952">err</span>&nbsp;<span class="op" id="4109956">=</span>&nbsp;<span class="ident" id="4109958">asn1</span><span class="op" id="4109962">.</span><span class="ident" id="4109963">Marshal</span><span class="op" id="4109970">(</span><span class="ident" id="4109971">authKeyId</span><span class="op" id="4109980">{</span><span class="ident" id="4109981">template</span><span class="op" id="4109989">.</span><span class="ident" id="4109990">AuthorityKeyId</span><span class="op" id="4110004">}</span><span class="op" id="4110005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4110009">if</span>&nbsp;<span class="ident" id="4110012">err</span>&nbsp;<span class="op" id="4110016">!=</span>&nbsp;<span class="ident" id="4110019">nil</span>&nbsp;<span class="op" id="4110023">{</span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4110028">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4110037">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4110041">n</span><span class="op" id="4110042">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4110046">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4110050">if</span>&nbsp;<span class="op" id="4110053">(</span><span class="builtinfunc" id="4110054">len</span><span class="op" id="4110057">(</span><span class="ident" id="4110058">template</span><span class="op" id="4110066">.</span><span class="ident" id="4110067">OCSPServer</span><span class="op" id="4110077">)</span>&nbsp;<span class="op" id="4110079">&gt;</span>&nbsp;<span class="num" id="4110081">0</span>&nbsp;<span class="op" id="4110083">||</span>&nbsp;<span class="builtinfunc" id="4110086">len</span><span class="op" id="4110089">(</span><span class="ident" id="4110090">template</span><span class="op" id="4110098">.</span><span class="ident" id="4110099">IssuingCertificateURL</span><span class="op" id="4110120">)</span>&nbsp;<span class="op" id="4110122">&gt;</span>&nbsp;<span class="num" id="4110124">0</span><span class="op" id="4110125">)</span>&nbsp;<span class="op" id="4110127">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4110132">!</span><span class="ident" id="4110133">oidInExtensions</span><span class="op" id="4110148">(</span><span class="ident" id="4110149">oidExtensionAuthorityInfoAccess</span><span class="op" id="4110180">,</span>&nbsp;<span class="ident" id="4110182">template</span><span class="op" id="4110190">.</span><span class="ident" id="4110191">ExtraExtensions</span><span class="op" id="4110206">)</span>&nbsp;<span class="op" id="4110208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4110212">ret</span><span class="op" id="4110215">[</span><span class="ident" id="4110216">n</span><span class="op" id="4110217">]</span><span class="op" id="4110218">.</span><span class="ident" id="4110219">Id</span>&nbsp;<span class="op" id="4110222">=</span>&nbsp;<span class="ident" id="4110224">oidExtensionAuthorityInfoAccess</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4110258">var</span>&nbsp;<span class="ident" id="4110262">aiaValues</span>&nbsp;<span class="op" id="4110272">[</span><span class="op" id="4110273">]</span><span class="ident" id="4110274">authorityInfoAccess</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4110296">for</span>&nbsp;<span class="ident" id="4110300">_</span><span class="op" id="4110301">,</span>&nbsp;<span class="ident" id="4110303">name</span>&nbsp;<span class="op" id="4110308">:=</span>&nbsp;<span class="keyword" id="4110311">range</span>&nbsp;<span class="ident" id="4110317">template</span><span class="op" id="4110325">.</span><span class="ident" id="4110326">OCSPServer</span>&nbsp;<span class="op" id="4110337">{</span><br>
<span class="lineno">1275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4110342">aiaValues</span>&nbsp;<span class="op" id="4110352">=</span>&nbsp;<span class="builtinfunc" id="4110354">append</span><span class="op" id="4110360">(</span><span class="ident" id="4110361">aiaValues</span><span class="op" id="4110370">,</span>&nbsp;<span class="ident" id="4110372">authorityInfoAccess</span><span class="op" id="4110391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4110397">Method</span><span class="op" id="4110403">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4110407">oidAuthorityInfoAccessOcsp</span><span class="op" id="4110433">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4110439">Location</span><span class="op" id="4110447">:</span>&nbsp;<span class="ident" id="4110449">asn1</span><span class="op" id="4110453">.</span><span class="ident" id="4110454">RawValue</span><span class="op" id="4110462">{</span><span class="ident" id="4110463">Tag</span><span class="op" id="4110466">:</span>&nbsp;<span class="num" id="4110468">6</span><span class="op" id="4110469">,</span>&nbsp;<span class="ident" id="4110471">Class</span><span class="op" id="4110476">:</span>&nbsp;<span class="num" id="4110478">2</span><span class="op" id="4110479">,</span>&nbsp;<span class="ident" id="4110481">Bytes</span><span class="op" id="4110486">:</span>&nbsp;<span class="op" id="4110488">[</span><span class="op" id="4110489">]</span><span class="builtintype" id="4110490">byte</span><span class="op" id="4110494">(</span><span class="ident" id="4110495">name</span><span class="op" id="4110499">)</span><span class="op" id="4110500">}</span><span class="op" id="4110501">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4110506">}</span><span class="op" id="4110507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4110511">}</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4110515">for</span>&nbsp;<span class="ident" id="4110519">_</span><span class="op" id="4110520">,</span>&nbsp;<span class="ident" id="4110522">name</span>&nbsp;<span class="op" id="4110527">:=</span>&nbsp;<span class="keyword" id="4110530">range</span>&nbsp;<span class="ident" id="4110536">template</span><span class="op" id="4110544">.</span><span class="ident" id="4110545">IssuingCertificateURL</span>&nbsp;<span class="op" id="4110567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4110572">aiaValues</span>&nbsp;<span class="op" id="4110582">=</span>&nbsp;<span class="builtinfunc" id="4110584">append</span><span class="op" id="4110590">(</span><span class="ident" id="4110591">aiaValues</span><span class="op" id="4110600">,</span>&nbsp;<span class="ident" id="4110602">authorityInfoAccess</span><span class="op" id="4110621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4110627">Method</span><span class="op" id="4110633">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4110637">oidAuthorityInfoAccessIssuers</span><span class="op" id="4110666">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4110672">Location</span><span class="op" id="4110680">:</span>&nbsp;<span class="ident" id="4110682">asn1</span><span class="op" id="4110686">.</span><span class="ident" id="4110687">RawValue</span><span class="op" id="4110695">{</span><span class="ident" id="4110696">Tag</span><span class="op" id="4110699">:</span>&nbsp;<span class="num" id="4110701">6</span><span class="op" id="4110702">,</span>&nbsp;<span class="ident" id="4110704">Class</span><span class="op" id="4110709">:</span>&nbsp;<span class="num" id="4110711">2</span><span class="op" id="4110712">,</span>&nbsp;<span class="ident" id="4110714">Bytes</span><span class="op" id="4110719">:</span>&nbsp;<span class="op" id="4110721">[</span><span class="op" id="4110722">]</span><span class="builtintype" id="4110723">byte</span><span class="op" id="4110727">(</span><span class="ident" id="4110728">name</span><span class="op" id="4110732">)</span><span class="op" id="4110733">}</span><span class="op" id="4110734">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4110739">}</span><span class="op" id="4110740">)</span><br>
<span class="lineno">1285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4110744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4110748">ret</span><span class="op" id="4110751">[</span><span class="ident" id="4110752">n</span><span class="op" id="4110753">]</span><span class="op" id="4110754">.</span><span class="ident" id="4110755">Value</span><span class="op" id="4110760">,</span>&nbsp;<span class="ident" id="4110762">err</span>&nbsp;<span class="op" id="4110766">=</span>&nbsp;<span class="ident" id="4110768">asn1</span><span class="op" id="4110772">.</span><span class="ident" id="4110773">Marshal</span><span class="op" id="4110780">(</span><span class="ident" id="4110781">aiaValues</span><span class="op" id="4110790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4110794">if</span>&nbsp;<span class="ident" id="4110797">err</span>&nbsp;<span class="op" id="4110801">!=</span>&nbsp;<span class="ident" id="4110804">nil</span>&nbsp;<span class="op" id="4110808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4110813">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4110822">}</span><br>
<span class="lineno">1290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4110826">n</span><span class="op" id="4110827">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4110831">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4110835">if</span>&nbsp;<span class="op" id="4110838">(</span><span class="builtinfunc" id="4110839">len</span><span class="op" id="4110842">(</span><span class="ident" id="4110843">template</span><span class="op" id="4110851">.</span><span class="ident" id="4110852">DNSNames</span><span class="op" id="4110860">)</span>&nbsp;<span class="op" id="4110862">&gt;</span>&nbsp;<span class="num" id="4110864">0</span>&nbsp;<span class="op" id="4110866">||</span>&nbsp;<span class="builtinfunc" id="4110869">len</span><span class="op" id="4110872">(</span><span class="ident" id="4110873">template</span><span class="op" id="4110881">.</span><span class="ident" id="4110882">EmailAddresses</span><span class="op" id="4110896">)</span>&nbsp;<span class="op" id="4110898">&gt;</span>&nbsp;<span class="num" id="4110900">0</span>&nbsp;<span class="op" id="4110902">||</span>&nbsp;<span class="builtinfunc" id="4110905">len</span><span class="op" id="4110908">(</span><span class="ident" id="4110909">template</span><span class="op" id="4110917">.</span><span class="ident" id="4110918">IPAddresses</span><span class="op" id="4110929">)</span>&nbsp;<span class="op" id="4110931">&gt;</span>&nbsp;<span class="num" id="4110933">0</span><span class="op" id="4110934">)</span>&nbsp;<span class="op" id="4110936">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4110941">!</span><span class="ident" id="4110942">oidInExtensions</span><span class="op" id="4110957">(</span><span class="ident" id="4110958">oidExtensionSubjectAltName</span><span class="op" id="4110984">,</span>&nbsp;<span class="ident" id="4110986">template</span><span class="op" id="4110994">.</span><span class="ident" id="4110995">ExtraExtensions</span><span class="op" id="4111010">)</span>&nbsp;<span class="op" id="4111012">{</span><br>
<span class="lineno">1295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4111016">ret</span><span class="op" id="4111019">[</span><span class="ident" id="4111020">n</span><span class="op" id="4111021">]</span><span class="op" id="4111022">.</span><span class="ident" id="4111023">Id</span>&nbsp;<span class="op" id="4111026">=</span>&nbsp;<span class="ident" id="4111028">oidExtensionSubjectAltName</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4111057">ret</span><span class="op" id="4111060">[</span><span class="ident" id="4111061">n</span><span class="op" id="4111062">]</span><span class="op" id="4111063">.</span><span class="ident" id="4111064">Value</span><span class="op" id="4111069">,</span>&nbsp;<span class="ident" id="4111071">err</span>&nbsp;<span class="op" id="4111075">=</span>&nbsp;<span class="ident" id="4111077">marshalSANs</span><span class="op" id="4111088">(</span><span class="ident" id="4111089">template</span><span class="op" id="4111097">.</span><span class="ident" id="4111098">DNSNames</span><span class="op" id="4111106">,</span>&nbsp;<span class="ident" id="4111108">template</span><span class="op" id="4111116">.</span><span class="ident" id="4111117">EmailAddresses</span><span class="op" id="4111131">,</span>&nbsp;<span class="ident" id="4111133">template</span><span class="op" id="4111141">.</span><span class="ident" id="4111142">IPAddresses</span><span class="op" id="4111153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4111157">if</span>&nbsp;<span class="ident" id="4111160">err</span>&nbsp;<span class="op" id="4111164">!=</span>&nbsp;<span class="ident" id="4111167">nil</span>&nbsp;<span class="op" id="4111171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4111176">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4111185">}</span><br>
<span class="lineno">1300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4111189">n</span><span class="op" id="4111190">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4111194">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4111198">if</span>&nbsp;<span class="builtinfunc" id="4111201">len</span><span class="op" id="4111204">(</span><span class="ident" id="4111205">template</span><span class="op" id="4111213">.</span><span class="ident" id="4111214">PolicyIdentifiers</span><span class="op" id="4111231">)</span>&nbsp;<span class="op" id="4111233">&gt;</span>&nbsp;<span class="num" id="4111235">0</span>&nbsp;<span class="op" id="4111237">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4111242">!</span><span class="ident" id="4111243">oidInExtensions</span><span class="op" id="4111258">(</span><span class="ident" id="4111259">oidExtensionCertificatePolicies</span><span class="op" id="4111290">,</span>&nbsp;<span class="ident" id="4111292">template</span><span class="op" id="4111300">.</span><span class="ident" id="4111301">ExtraExtensions</span><span class="op" id="4111316">)</span>&nbsp;<span class="op" id="4111318">{</span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4111322">ret</span><span class="op" id="4111325">[</span><span class="ident" id="4111326">n</span><span class="op" id="4111327">]</span><span class="op" id="4111328">.</span><span class="ident" id="4111329">Id</span>&nbsp;<span class="op" id="4111332">=</span>&nbsp;<span class="ident" id="4111334">oidExtensionCertificatePolicies</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4111368">policies</span>&nbsp;<span class="op" id="4111377">:=</span>&nbsp;<span class="builtinfunc" id="4111380">make</span><span class="op" id="4111384">(</span><span class="op" id="4111385">[</span><span class="op" id="4111386">]</span><span class="ident" id="4111387">policyInformation</span><span class="op" id="4111404">,</span>&nbsp;<span class="builtinfunc" id="4111406">len</span><span class="op" id="4111409">(</span><span class="ident" id="4111410">template</span><span class="op" id="4111418">.</span><span class="ident" id="4111419">PolicyIdentifiers</span><span class="op" id="4111436">)</span><span class="op" id="4111437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4111441">for</span>&nbsp;<span class="ident" id="4111445">i</span><span class="op" id="4111446">,</span>&nbsp;<span class="ident" id="4111448">policy</span>&nbsp;<span class="op" id="4111455">:=</span>&nbsp;<span class="keyword" id="4111458">range</span>&nbsp;<span class="ident" id="4111464">template</span><span class="op" id="4111472">.</span><span class="ident" id="4111473">PolicyIdentifiers</span>&nbsp;<span class="op" id="4111491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4111496">policies</span><span class="op" id="4111504">[</span><span class="ident" id="4111505">i</span><span class="op" id="4111506">]</span><span class="op" id="4111507">.</span><span class="ident" id="4111508">Policy</span>&nbsp;<span class="op" id="4111515">=</span>&nbsp;<span class="ident" id="4111517">policy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4111526">}</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4111530">ret</span><span class="op" id="4111533">[</span><span class="ident" id="4111534">n</span><span class="op" id="4111535">]</span><span class="op" id="4111536">.</span><span class="ident" id="4111537">Value</span><span class="op" id="4111542">,</span>&nbsp;<span class="ident" id="4111544">err</span>&nbsp;<span class="op" id="4111548">=</span>&nbsp;<span class="ident" id="4111550">asn1</span><span class="op" id="4111554">.</span><span class="ident" id="4111555">Marshal</span><span class="op" id="4111562">(</span><span class="ident" id="4111563">policies</span><span class="op" id="4111571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4111575">if</span>&nbsp;<span class="ident" id="4111578">err</span>&nbsp;<span class="op" id="4111582">!=</span>&nbsp;<span class="ident" id="4111585">nil</span>&nbsp;<span class="op" id="4111589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4111594">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4111603">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4111607">n</span><span class="op" id="4111608">++</span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4111612">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4111616">if</span>&nbsp;<span class="builtinfunc" id="4111619">len</span><span class="op" id="4111622">(</span><span class="ident" id="4111623">template</span><span class="op" id="4111631">.</span><span class="ident" id="4111632">PermittedDNSDomains</span><span class="op" id="4111651">)</span>&nbsp;<span class="op" id="4111653">&gt;</span>&nbsp;<span class="num" id="4111655">0</span>&nbsp;<span class="op" id="4111657">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4111662">!</span><span class="ident" id="4111663">oidInExtensions</span><span class="op" id="4111678">(</span><span class="ident" id="4111679">oidExtensionNameConstraints</span><span class="op" id="4111706">,</span>&nbsp;<span class="ident" id="4111708">template</span><span class="op" id="4111716">.</span><span class="ident" id="4111717">ExtraExtensions</span><span class="op" id="4111732">)</span>&nbsp;<span class="op" id="4111734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4111738">ret</span><span class="op" id="4111741">[</span><span class="ident" id="4111742">n</span><span class="op" id="4111743">]</span><span class="op" id="4111744">.</span><span class="ident" id="4111745">Id</span>&nbsp;<span class="op" id="4111748">=</span>&nbsp;<span class="ident" id="4111750">oidExtensionNameConstraints</span><br>
<span class="lineno">1320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4111780">ret</span><span class="op" id="4111783">[</span><span class="ident" id="4111784">n</span><span class="op" id="4111785">]</span><span class="op" id="4111786">.</span><span class="ident" id="4111787">Critical</span>&nbsp;<span class="op" id="4111796">=</span>&nbsp;<span class="ident" id="4111798">template</span><span class="op" id="4111806">.</span><span class="ident" id="4111807">PermittedDNSDomainsCritical</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4111838">var</span>&nbsp;<span class="ident" id="4111842">out</span>&nbsp;<span class="ident" id="4111846">nameConstraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4111864">out</span><span class="op" id="4111867">.</span><span class="ident" id="4111868">Permitted</span>&nbsp;<span class="op" id="4111878">=</span>&nbsp;<span class="builtinfunc" id="4111880">make</span><span class="op" id="4111884">(</span><span class="op" id="4111885">[</span><span class="op" id="4111886">]</span><span class="ident" id="4111887">generalSubtree</span><span class="op" id="4111901">,</span>&nbsp;<span class="builtinfunc" id="4111903">len</span><span class="op" id="4111906">(</span><span class="ident" id="4111907">template</span><span class="op" id="4111915">.</span><span class="ident" id="4111916">PermittedDNSDomains</span><span class="op" id="4111935">)</span><span class="op" id="4111936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4111940">for</span>&nbsp;<span class="ident" id="4111944">i</span><span class="op" id="4111945">,</span>&nbsp;<span class="ident" id="4111947">permitted</span>&nbsp;<span class="op" id="4111957">:=</span>&nbsp;<span class="keyword" id="4111960">range</span>&nbsp;<span class="ident" id="4111966">template</span><span class="op" id="4111974">.</span><span class="ident" id="4111975">PermittedDNSDomains</span>&nbsp;<span class="op" id="4111995">{</span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4112000">out</span><span class="op" id="4112003">.</span><span class="ident" id="4112004">Permitted</span><span class="op" id="4112013">[</span><span class="ident" id="4112014">i</span><span class="op" id="4112015">]</span>&nbsp;<span class="op" id="4112017">=</span>&nbsp;<span class="ident" id="4112019">generalSubtree</span><span class="op" id="4112033">{</span><span class="ident" id="4112034">Name</span><span class="op" id="4112038">:</span>&nbsp;<span class="ident" id="4112040">permitted</span><span class="op" id="4112049">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4112053">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4112057">ret</span><span class="op" id="4112060">[</span><span class="ident" id="4112061">n</span><span class="op" id="4112062">]</span><span class="op" id="4112063">.</span><span class="ident" id="4112064">Value</span><span class="op" id="4112069">,</span>&nbsp;<span class="ident" id="4112071">err</span>&nbsp;<span class="op" id="4112075">=</span>&nbsp;<span class="ident" id="4112077">asn1</span><span class="op" id="4112081">.</span><span class="ident" id="4112082">Marshal</span><span class="op" id="4112089">(</span><span class="ident" id="4112090">out</span><span class="op" id="4112093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4112097">if</span>&nbsp;<span class="ident" id="4112100">err</span>&nbsp;<span class="op" id="4112104">!=</span>&nbsp;<span class="ident" id="4112107">nil</span>&nbsp;<span class="op" id="4112111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4112116">return</span><br>
<span class="lineno">1330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4112125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4112129">n</span><span class="op" id="4112130">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4112134">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4112138">if</span>&nbsp;<span class="builtinfunc" id="4112141">len</span><span class="op" id="4112144">(</span><span class="ident" id="4112145">template</span><span class="op" id="4112153">.</span><span class="ident" id="4112154">CRLDistributionPoints</span><span class="op" id="4112175">)</span>&nbsp;<span class="op" id="4112177">&gt;</span>&nbsp;<span class="num" id="4112179">0</span>&nbsp;<span class="op" id="4112181">&amp;&amp;</span><br>
<span class="lineno">1335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4112186">!</span><span class="ident" id="4112187">oidInExtensions</span><span class="op" id="4112202">(</span><span class="ident" id="4112203">oidExtensionCRLDistributionPoints</span><span class="op" id="4112236">,</span>&nbsp;<span class="ident" id="4112238">template</span><span class="op" id="4112246">.</span><span class="ident" id="4112247">ExtraExtensions</span><span class="op" id="4112262">)</span>&nbsp;<span class="op" id="4112264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4112268">ret</span><span class="op" id="4112271">[</span><span class="ident" id="4112272">n</span><span class="op" id="4112273">]</span><span class="op" id="4112274">.</span><span class="ident" id="4112275">Id</span>&nbsp;<span class="op" id="4112278">=</span>&nbsp;<span class="ident" id="4112280">oidExtensionCRLDistributionPoints</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4112317">var</span>&nbsp;<span class="ident" id="4112321">crlDp</span>&nbsp;<span class="op" id="4112327">[</span><span class="op" id="4112328">]</span><span class="ident" id="4112329">distributionPoint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4112349">for</span>&nbsp;<span class="ident" id="4112353">_</span><span class="op" id="4112354">,</span>&nbsp;<span class="ident" id="4112356">name</span>&nbsp;<span class="op" id="4112361">:=</span>&nbsp;<span class="keyword" id="4112364">range</span>&nbsp;<span class="ident" id="4112370">template</span><span class="op" id="4112378">.</span><span class="ident" id="4112379">CRLDistributionPoints</span>&nbsp;<span class="op" id="4112401">{</span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4112406">rawFullName</span><span class="op" id="4112417">,</span>&nbsp;<span class="ident" id="4112419">_</span>&nbsp;<span class="op" id="4112421">:=</span>&nbsp;<span class="ident" id="4112424">asn1</span><span class="op" id="4112428">.</span><span class="ident" id="4112429">Marshal</span><span class="op" id="4112436">(</span><span class="ident" id="4112437">asn1</span><span class="op" id="4112441">.</span><span class="ident" id="4112442">RawValue</span><span class="op" id="4112450">{</span><span class="ident" id="4112451">Tag</span><span class="op" id="4112454">:</span>&nbsp;<span class="num" id="4112456">6</span><span class="op" id="4112457">,</span>&nbsp;<span class="ident" id="4112459">Class</span><span class="op" id="4112464">:</span>&nbsp;<span class="num" id="4112466">2</span><span class="op" id="4112467">,</span>&nbsp;<span class="ident" id="4112469">Bytes</span><span class="op" id="4112474">:</span>&nbsp;<span class="op" id="4112476">[</span><span class="op" id="4112477">]</span><span class="builtintype" id="4112478">byte</span><span class="op" id="4112482">(</span><span class="ident" id="4112483">name</span><span class="op" id="4112487">)</span><span class="op" id="4112488">}</span><span class="op" id="4112489">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4112495">dp</span>&nbsp;<span class="op" id="4112498">:=</span>&nbsp;<span class="ident" id="4112501">distributionPoint</span><span class="op" id="4112518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4112524">DistributionPoint</span><span class="op" id="4112541">:</span>&nbsp;<span class="ident" id="4112543">distributionPointName</span><span class="op" id="4112564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4112571">FullName</span><span class="op" id="4112579">:</span>&nbsp;<span class="ident" id="4112581">asn1</span><span class="op" id="4112585">.</span><span class="ident" id="4112586">RawValue</span><span class="op" id="4112594">{</span><span class="ident" id="4112595">Tag</span><span class="op" id="4112598">:</span>&nbsp;<span class="num" id="4112600">0</span><span class="op" id="4112601">,</span>&nbsp;<span class="ident" id="4112603">Class</span><span class="op" id="4112608">:</span>&nbsp;<span class="num" id="4112610">2</span><span class="op" id="4112611">,</span>&nbsp;<span class="ident" id="4112613">IsCompound</span><span class="op" id="4112623">:</span>&nbsp;<span class="builtintype" id="4112625">true</span><span class="op" id="4112629">,</span>&nbsp;<span class="ident" id="4112631">Bytes</span><span class="op" id="4112636">:</span>&nbsp;<span class="ident" id="4112638">rawFullName</span><span class="op" id="4112649">}</span><span class="op" id="4112650">,</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4112656">}</span><span class="op" id="4112657">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4112662">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4112667">crlDp</span>&nbsp;<span class="op" id="4112673">=</span>&nbsp;<span class="builtinfunc" id="4112675">append</span><span class="op" id="4112681">(</span><span class="ident" id="4112682">crlDp</span><span class="op" id="4112687">,</span>&nbsp;<span class="ident" id="4112689">dp</span><span class="op" id="4112691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4112695">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4112700">ret</span><span class="op" id="4112703">[</span><span class="ident" id="4112704">n</span><span class="op" id="4112705">]</span><span class="op" id="4112706">.</span><span class="ident" id="4112707">Value</span><span class="op" id="4112712">,</span>&nbsp;<span class="ident" id="4112714">err</span>&nbsp;<span class="op" id="4112718">=</span>&nbsp;<span class="ident" id="4112720">asn1</span><span class="op" id="4112724">.</span><span class="ident" id="4112725">Marshal</span><span class="op" id="4112732">(</span><span class="ident" id="4112733">crlDp</span><span class="op" id="4112738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4112742">if</span>&nbsp;<span class="ident" id="4112745">err</span>&nbsp;<span class="op" id="4112749">!=</span>&nbsp;<span class="ident" id="4112752">nil</span>&nbsp;<span class="op" id="4112756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4112761">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4112770">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4112774">n</span><span class="op" id="4112775">++</span><br>
<span class="lineno">1355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4112779">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4112783">//&nbsp;Adding&nbsp;another&nbsp;extension&nbsp;here?&nbsp;Remember&nbsp;to&nbsp;update&nbsp;the&nbsp;maximum&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4112856">//&nbsp;of&nbsp;elements&nbsp;in&nbsp;the&nbsp;make()&nbsp;at&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;function.</span><br>
<span class="lineno"></span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4112915">return</span>&nbsp;<span class="builtinfunc" id="4112922">append</span><span class="op" id="4112928">(</span><span class="ident" id="4112929">ret</span><span class="op" id="4112932">[</span><span class="op" id="4112933">:</span><span class="ident" id="4112934">n</span><span class="op" id="4112935">]</span><span class="op" id="4112936">,</span>&nbsp;<span class="ident" id="4112938">template</span><span class="op" id="4112946">.</span><span class="ident" id="4112947">ExtraExtensions</span><span class="op" id="4112962">...</span><span class="op" id="4112965">)</span><span class="op" id="4112966">,</span>&nbsp;<span class="ident" id="4112968">nil</span><br>
<span class="lineno"></span><span class="op" id="4112972">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4112975">func</span>&nbsp;<span class="ident" id="4112980">subjectBytes</span><span class="op" id="4112992">(</span><span class="ident" id="4112993">cert</span>&nbsp;<span class="op" id="4112998">*</span><span class="ident" id="4112999">Certificate</span><span class="op" id="4113010">)</span>&nbsp;<span class="op" id="4113012">(</span><span class="op" id="4113013">[</span><span class="op" id="4113014">]</span><span class="builtintype" id="4113015">byte</span><span class="op" id="4113019">,</span>&nbsp;<span class="builtintype" id="4113021">error</span><span class="op" id="4113026">)</span>&nbsp;<span class="op" id="4113028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4113031">if</span>&nbsp;<span class="builtinfunc" id="4113034">len</span><span class="op" id="4113037">(</span><span class="ident" id="4113038">cert</span><span class="op" id="4113042">.</span><span class="ident" id="4113043">RawSubject</span><span class="op" id="4113053">)</span>&nbsp;<span class="op" id="4113055">&gt;</span>&nbsp;<span class="num" id="4113057">0</span>&nbsp;<span class="op" id="4113059">{</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4113063">return</span>&nbsp;<span class="ident" id="4113070">cert</span><span class="op" id="4113074">.</span><span class="ident" id="4113075">RawSubject</span><span class="op" id="4113085">,</span>&nbsp;<span class="ident" id="4113087">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4113092">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4113096">return</span>&nbsp;<span class="ident" id="4113103">asn1</span><span class="op" id="4113107">.</span><span class="ident" id="4113108">Marshal</span><span class="op" id="4113115">(</span><span class="ident" id="4113116">cert</span><span class="op" id="4113120">.</span><span class="ident" id="4113121">Subject</span><span class="op" id="4113128">.</span><span class="ident" id="4113129">ToRDNSequence</span><span class="op" id="4113142">(</span><span class="op" id="4113143">)</span><span class="op" id="4113144">)</span><br>
<span class="lineno"></span><span class="op" id="4113146">}</span><br>
<span class="lineno">1370</span><br>
<span class="lineno"></span><span class="comment" id="4113149">//&nbsp;signingParamsForPrivateKey&nbsp;returns&nbsp;the&nbsp;parameters&nbsp;to&nbsp;use&nbsp;for&nbsp;signing&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="4113226">//&nbsp;priv.&nbsp;If&nbsp;requestedSigAlgo&nbsp;is&nbsp;not&nbsp;zero&nbsp;then&nbsp;it&nbsp;overrides&nbsp;the&nbsp;default</span><br>
<span class="lineno"></span><span class="comment" id="4113297">//&nbsp;signature&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="4113321">func</span>&nbsp;<span class="ident" id="4113326">signingParamsForPrivateKey</span><span class="op" id="4113352">(</span><span class="ident" id="4113353">priv</span>&nbsp;<span class="keyword" id="4113358">interface</span><span class="op" id="4113367">{</span><span class="op" id="4113368">}</span><span class="op" id="4113369">,</span>&nbsp;<span class="ident" id="4113371">requestedSigAlgo</span>&nbsp;<span class="ident" id="4113388">SignatureAlgorithm</span><span class="op" id="4113406">)</span>&nbsp;<span class="op" id="4113408">(</span><span class="ident" id="4113409">hashFunc</span>&nbsp;<span class="ident" id="4113418">crypto</span><span class="op" id="4113424">.</span><span class="ident" id="4113425">Hash</span><span class="op" id="4113429">,</span>&nbsp;<span class="ident" id="4113431">sigAlgo</span>&nbsp;<span class="ident" id="4113439">pkix</span><span class="op" id="4113443">.</span><span class="ident" id="4113444">AlgorithmIdentifier</span><span class="op" id="4113463">,</span>&nbsp;<span class="ident" id="4113465">err</span>&nbsp;<span class="builtintype" id="4113469">error</span><span class="op" id="4113474">)</span>&nbsp;<span class="op" id="4113476">{</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4113479">var</span>&nbsp;<span class="ident" id="4113483">pubType</span>&nbsp;<span class="ident" id="4113491">PublicKeyAlgorithm</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4113512">switch</span>&nbsp;<span class="ident" id="4113519">priv</span>&nbsp;<span class="op" id="4113524">:=</span>&nbsp;<span class="ident" id="4113527">priv</span><span class="op" id="4113531">.</span><span class="op" id="4113532">(</span><span class="keyword" id="4113533">type</span><span class="op" id="4113537">)</span>&nbsp;<span class="op" id="4113539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4113542">case</span>&nbsp;<span class="op" id="4113547">*</span><span class="ident" id="4113548">rsa</span><span class="op" id="4113551">.</span><span class="ident" id="4113552">PrivateKey</span><span class="op" id="4113562">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4113566">pubType</span>&nbsp;<span class="op" id="4113574">=</span>&nbsp;<span class="ident" id="4113576">RSA</span><br>
<span class="lineno">1380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4113582">sigAlgo</span><span class="op" id="4113589">.</span><span class="ident" id="4113590">Algorithm</span>&nbsp;<span class="op" id="4113600">=</span>&nbsp;<span class="ident" id="4113602">oidSignatureSHA256WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4113630">hashFunc</span>&nbsp;<span class="op" id="4113639">=</span>&nbsp;<span class="ident" id="4113641">crypto</span><span class="op" id="4113647">.</span><span class="ident" id="4113648">SHA256</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4113657">case</span>&nbsp;<span class="op" id="4113662">*</span><span class="ident" id="4113663">ecdsa</span><span class="op" id="4113668">.</span><span class="ident" id="4113669">PrivateKey</span><span class="op" id="4113679">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4113683">pubType</span>&nbsp;<span class="op" id="4113691">=</span>&nbsp;<span class="ident" id="4113693">ECDSA</span><br>
<span class="lineno">1385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4113702">switch</span>&nbsp;<span class="ident" id="4113709">priv</span><span class="op" id="4113713">.</span><span class="ident" id="4113714">Curve</span>&nbsp;<span class="op" id="4113720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4113724">case</span>&nbsp;<span class="ident" id="4113729">elliptic</span><span class="op" id="4113737">.</span><span class="ident" id="4113738">P224</span><span class="op" id="4113742">(</span><span class="op" id="4113743">)</span><span class="op" id="4113744">,</span>&nbsp;<span class="ident" id="4113746">elliptic</span><span class="op" id="4113754">.</span><span class="ident" id="4113755">P256</span><span class="op" id="4113759">(</span><span class="op" id="4113760">)</span><span class="op" id="4113761">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4113766">hashFunc</span>&nbsp;<span class="op" id="4113775">=</span>&nbsp;<span class="ident" id="4113777">crypto</span><span class="op" id="4113783">.</span><span class="ident" id="4113784">SHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4113794">sigAlgo</span><span class="op" id="4113801">.</span><span class="ident" id="4113802">Algorithm</span>&nbsp;<span class="op" id="4113812">=</span>&nbsp;<span class="ident" id="4113814">oidSignatureECDSAWithSHA256</span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4113844">case</span>&nbsp;<span class="ident" id="4113849">elliptic</span><span class="op" id="4113857">.</span><span class="ident" id="4113858">P384</span><span class="op" id="4113862">(</span><span class="op" id="4113863">)</span><span class="op" id="4113864">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4113869">hashFunc</span>&nbsp;<span class="op" id="4113878">=</span>&nbsp;<span class="ident" id="4113880">crypto</span><span class="op" id="4113886">.</span><span class="ident" id="4113887">SHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4113897">sigAlgo</span><span class="op" id="4113904">.</span><span class="ident" id="4113905">Algorithm</span>&nbsp;<span class="op" id="4113915">=</span>&nbsp;<span class="ident" id="4113917">oidSignatureECDSAWithSHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4113947">case</span>&nbsp;<span class="ident" id="4113952">elliptic</span><span class="op" id="4113960">.</span><span class="ident" id="4113961">P521</span><span class="op" id="4113965">(</span><span class="op" id="4113966">)</span><span class="op" id="4113967">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4113972">hashFunc</span>&nbsp;<span class="op" id="4113981">=</span>&nbsp;<span class="ident" id="4113983">crypto</span><span class="op" id="4113989">.</span><span class="ident" id="4113990">SHA512</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4114000">sigAlgo</span><span class="op" id="4114007">.</span><span class="ident" id="4114008">Algorithm</span>&nbsp;<span class="op" id="4114018">=</span>&nbsp;<span class="ident" id="4114020">oidSignatureECDSAWithSHA512</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4114050">default</span><span class="op" id="4114057">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4114062">err</span>&nbsp;<span class="op" id="4114066">=</span>&nbsp;<span class="ident" id="4114068">errors</span><span class="op" id="4114074">.</span><span class="ident" id="4114075">New</span><span class="op" id="4114078">(</span><span class="string" id="4114079">&#34;x509:&nbsp;unknown&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4114109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4114113">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4114117">default</span><span class="op" id="4114124">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4114128">err</span>&nbsp;<span class="op" id="4114132">=</span>&nbsp;<span class="ident" id="4114134">errors</span><span class="op" id="4114140">.</span><span class="ident" id="4114141">New</span><span class="op" id="4114144">(</span><span class="string" id="4114145">&#34;x509:&nbsp;only&nbsp;RSA&nbsp;and&nbsp;ECDSA&nbsp;private&nbsp;keys&nbsp;supported&#34;</span><span class="op" id="4114194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4114197">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4114201">if</span>&nbsp;<span class="ident" id="4114204">err</span>&nbsp;<span class="op" id="4114208">!=</span>&nbsp;<span class="ident" id="4114211">nil</span>&nbsp;<span class="op" id="4114215">{</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4114219">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4114227">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4114231">if</span>&nbsp;<span class="ident" id="4114234">requestedSigAlgo</span>&nbsp;<span class="op" id="4114251">==</span>&nbsp;<span class="num" id="4114254">0</span>&nbsp;<span class="op" id="4114256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4114260">return</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4114268">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4114272">found</span>&nbsp;<span class="op" id="4114278">:=</span>&nbsp;<span class="builtintype" id="4114281">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4114288">for</span>&nbsp;<span class="ident" id="4114292">_</span><span class="op" id="4114293">,</span>&nbsp;<span class="ident" id="4114295">details</span>&nbsp;<span class="op" id="4114303">:=</span>&nbsp;<span class="keyword" id="4114306">range</span>&nbsp;<span class="ident" id="4114312">signatureAlgorithmDetails</span>&nbsp;<span class="op" id="4114338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4114342">if</span>&nbsp;<span class="ident" id="4114345">details</span><span class="op" id="4114352">.</span><span class="ident" id="4114353">algo</span>&nbsp;<span class="op" id="4114358">==</span>&nbsp;<span class="ident" id="4114361">requestedSigAlgo</span>&nbsp;<span class="op" id="4114378">{</span><br>
<span class="lineno">1415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4114383">if</span>&nbsp;<span class="ident" id="4114386">details</span><span class="op" id="4114393">.</span><span class="ident" id="4114394">pubKeyAlgo</span>&nbsp;<span class="op" id="4114405">!=</span>&nbsp;<span class="ident" id="4114408">pubType</span>&nbsp;<span class="op" id="4114416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4114422">err</span>&nbsp;<span class="op" id="4114426">=</span>&nbsp;<span class="ident" id="4114428">errors</span><span class="op" id="4114434">.</span><span class="ident" id="4114435">New</span><span class="op" id="4114438">(</span><span class="string" id="4114439">&#34;x509:&nbsp;requested&nbsp;SignatureAlgorithm&nbsp;does&nbsp;not&nbsp;match&nbsp;private&nbsp;key&nbsp;type&#34;</span><span class="op" id="4114507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4114513">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4114523">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4114528">sigAlgo</span><span class="op" id="4114535">.</span><span class="ident" id="4114536">Algorithm</span><span class="op" id="4114545">,</span>&nbsp;<span class="ident" id="4114547">hashFunc</span>&nbsp;<span class="op" id="4114556">=</span>&nbsp;<span class="ident" id="4114558">details</span><span class="op" id="4114565">.</span><span class="ident" id="4114566">oid</span><span class="op" id="4114569">,</span>&nbsp;<span class="ident" id="4114571">details</span><span class="op" id="4114578">.</span><span class="ident" id="4114579">hash</span><br>
<span class="lineno">1420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4114587">if</span>&nbsp;<span class="ident" id="4114590">hashFunc</span>&nbsp;<span class="op" id="4114599">==</span>&nbsp;<span class="num" id="4114602">0</span>&nbsp;<span class="op" id="4114604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4114610">err</span>&nbsp;<span class="op" id="4114614">=</span>&nbsp;<span class="ident" id="4114616">errors</span><span class="op" id="4114622">.</span><span class="ident" id="4114623">New</span><span class="op" id="4114626">(</span><span class="string" id="4114627">&#34;x509:&nbsp;cannot&nbsp;sign&nbsp;with&nbsp;hash&nbsp;function&nbsp;requested&#34;</span><span class="op" id="4114675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4114681">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4114691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4114696">found</span>&nbsp;<span class="op" id="4114702">=</span>&nbsp;<span class="builtintype" id="4114704">true</span><br>
<span class="lineno">1425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4114712">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4114720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4114723">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4114727">if</span>&nbsp;<span class="op" id="4114730">!</span><span class="ident" id="4114731">found</span>&nbsp;<span class="op" id="4114737">{</span><br>
<span class="lineno">1430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4114741">err</span>&nbsp;<span class="op" id="4114745">=</span>&nbsp;<span class="ident" id="4114747">errors</span><span class="op" id="4114753">.</span><span class="ident" id="4114754">New</span><span class="op" id="4114757">(</span><span class="string" id="4114758">&#34;x509:&nbsp;unknown&nbsp;SignatureAlgorithm&#34;</span><span class="op" id="4114792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4114795">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4114799">return</span><br>
<span class="lineno"></span><span class="op" id="4114806">}</span><br>
<span class="lineno">1435</span><br>
<span class="lineno"></span><span class="comment" id="4114809">//&nbsp;CreateCertificate&nbsp;creates&nbsp;a&nbsp;new&nbsp;certificate&nbsp;based&nbsp;on&nbsp;a&nbsp;template.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="4114881">//&nbsp;following&nbsp;members&nbsp;of&nbsp;template&nbsp;are&nbsp;used:&nbsp;SerialNumber,&nbsp;Subject,&nbsp;NotBefore,</span><br>
<span class="lineno"></span><span class="comment" id="4114958">//&nbsp;NotAfter,&nbsp;KeyUsage,&nbsp;ExtKeyUsage,&nbsp;UnknownExtKeyUsage,&nbsp;BasicConstraintsValid,</span><br>
<span class="lineno"></span><span class="comment" id="4115037">//&nbsp;IsCA,&nbsp;MaxPathLen,&nbsp;SubjectKeyId,&nbsp;DNSNames,&nbsp;PermittedDNSDomainsCritical,</span><br>
<span class="lineno">1440</span><span class="comment" id="4115111">//&nbsp;PermittedDNSDomains,&nbsp;SignatureAlgorithm.</span><br>
<span class="lineno"></span><span class="comment" id="4115155">//</span><br>
<span class="lineno"></span><span class="comment" id="4115158">//&nbsp;The&nbsp;certificate&nbsp;is&nbsp;signed&nbsp;by&nbsp;parent.&nbsp;If&nbsp;parent&nbsp;is&nbsp;equal&nbsp;to&nbsp;template&nbsp;then&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4115238">//&nbsp;certificate&nbsp;is&nbsp;self-signed.&nbsp;The&nbsp;parameter&nbsp;pub&nbsp;is&nbsp;the&nbsp;public&nbsp;key&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4115312">//&nbsp;signee&nbsp;and&nbsp;priv&nbsp;is&nbsp;the&nbsp;private&nbsp;key&nbsp;of&nbsp;the&nbsp;signer.</span><br>
<span class="lineno">1445</span><span class="comment" id="4115365">//</span><br>
<span class="lineno"></span><span class="comment" id="4115368">//&nbsp;The&nbsp;returned&nbsp;slice&nbsp;is&nbsp;the&nbsp;certificate&nbsp;in&nbsp;DER&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="comment" id="4115426">//</span><br>
<span class="lineno"></span><span class="comment" id="4115429">//&nbsp;The&nbsp;only&nbsp;supported&nbsp;key&nbsp;types&nbsp;are&nbsp;RSA&nbsp;and&nbsp;ECDSA&nbsp;(*rsa.PublicKey&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="4115498">//&nbsp;*ecdsa.PublicKey&nbsp;for&nbsp;pub,&nbsp;*rsa.PrivateKey&nbsp;or&nbsp;*ecdsa.PrivateKey&nbsp;for&nbsp;priv).</span><br>
<span class="lineno">1450</span><span class="keyword" id="4115575">func</span>&nbsp;<span class="ident" id="4115580">CreateCertificate</span><span class="op" id="4115597">(</span><span class="ident" id="4115598">rand</span>&nbsp;<span class="ident" id="4115603">io</span><span class="op" id="4115605">.</span><span class="ident" id="4115606">Reader</span><span class="op" id="4115612">,</span>&nbsp;<span class="ident" id="4115614">template</span><span class="op" id="4115622">,</span>&nbsp;<span class="ident" id="4115624">parent</span>&nbsp;<span class="op" id="4115631">*</span><span class="ident" id="4115632">Certificate</span><span class="op" id="4115643">,</span>&nbsp;<span class="ident" id="4115645">pub</span>&nbsp;<span class="keyword" id="4115649">interface</span><span class="op" id="4115658">{</span><span class="op" id="4115659">}</span><span class="op" id="4115660">,</span>&nbsp;<span class="ident" id="4115662">priv</span>&nbsp;<span class="keyword" id="4115667">interface</span><span class="op" id="4115676">{</span><span class="op" id="4115677">}</span><span class="op" id="4115678">)</span>&nbsp;<span class="op" id="4115680">(</span><span class="ident" id="4115681">cert</span>&nbsp;<span class="op" id="4115686">[</span><span class="op" id="4115687">]</span><span class="builtintype" id="4115688">byte</span><span class="op" id="4115692">,</span>&nbsp;<span class="ident" id="4115694">err</span>&nbsp;<span class="builtintype" id="4115698">error</span><span class="op" id="4115703">)</span>&nbsp;<span class="op" id="4115705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4115708">hashFunc</span><span class="op" id="4115716">,</span>&nbsp;<span class="ident" id="4115718">signatureAlgorithm</span><span class="op" id="4115736">,</span>&nbsp;<span class="ident" id="4115738">err</span>&nbsp;<span class="op" id="4115742">:=</span>&nbsp;<span class="ident" id="4115745">signingParamsForPrivateKey</span><span class="op" id="4115771">(</span><span class="ident" id="4115772">priv</span><span class="op" id="4115776">,</span>&nbsp;<span class="ident" id="4115778">template</span><span class="op" id="4115786">.</span><span class="ident" id="4115787">SignatureAlgorithm</span><span class="op" id="4115805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4115808">if</span>&nbsp;<span class="ident" id="4115811">err</span>&nbsp;<span class="op" id="4115815">!=</span>&nbsp;<span class="ident" id="4115818">nil</span>&nbsp;<span class="op" id="4115822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4115826">return</span>&nbsp;<span class="ident" id="4115833">nil</span><span class="op" id="4115836">,</span>&nbsp;<span class="ident" id="4115838">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4115843">}</span><br>
<span class="lineno">1455</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4115847">publicKeyBytes</span><span class="op" id="4115861">,</span>&nbsp;<span class="ident" id="4115863">publicKeyAlgorithm</span><span class="op" id="4115881">,</span>&nbsp;<span class="ident" id="4115883">err</span>&nbsp;<span class="op" id="4115887">:=</span>&nbsp;<span class="ident" id="4115890">marshalPublicKey</span><span class="op" id="4115906">(</span><span class="ident" id="4115907">pub</span><span class="op" id="4115910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4115913">if</span>&nbsp;<span class="ident" id="4115916">err</span>&nbsp;<span class="op" id="4115920">!=</span>&nbsp;<span class="ident" id="4115923">nil</span>&nbsp;<span class="op" id="4115927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4115931">return</span>&nbsp;<span class="ident" id="4115938">nil</span><span class="op" id="4115941">,</span>&nbsp;<span class="ident" id="4115943">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4115948">}</span><br>
<span class="lineno">1460</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4115952">if</span>&nbsp;<span class="ident" id="4115955">err</span>&nbsp;<span class="op" id="4115959">!=</span>&nbsp;<span class="ident" id="4115962">nil</span>&nbsp;<span class="op" id="4115966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4115970">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4115978">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4115982">if</span>&nbsp;<span class="builtinfunc" id="4115985">len</span><span class="op" id="4115988">(</span><span class="ident" id="4115989">parent</span><span class="op" id="4115995">.</span><span class="ident" id="4115996">SubjectKeyId</span><span class="op" id="4116008">)</span>&nbsp;<span class="op" id="4116010">&gt;</span>&nbsp;<span class="num" id="4116012">0</span>&nbsp;<span class="op" id="4116014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4116018">template</span><span class="op" id="4116026">.</span><span class="ident" id="4116027">AuthorityKeyId</span>&nbsp;<span class="op" id="4116042">=</span>&nbsp;<span class="ident" id="4116044">parent</span><span class="op" id="4116050">.</span><span class="ident" id="4116051">SubjectKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4116065">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4116069">extensions</span><span class="op" id="4116079">,</span>&nbsp;<span class="ident" id="4116081">err</span>&nbsp;<span class="op" id="4116085">:=</span>&nbsp;<span class="ident" id="4116088">buildExtensions</span><span class="op" id="4116103">(</span><span class="ident" id="4116104">template</span><span class="op" id="4116112">)</span><br>
<span class="lineno">1470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4116115">if</span>&nbsp;<span class="ident" id="4116118">err</span>&nbsp;<span class="op" id="4116122">!=</span>&nbsp;<span class="ident" id="4116125">nil</span>&nbsp;<span class="op" id="4116129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4116133">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4116141">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4116145">asn1Issuer</span><span class="op" id="4116155">,</span>&nbsp;<span class="ident" id="4116157">err</span>&nbsp;<span class="op" id="4116161">:=</span>&nbsp;<span class="ident" id="4116164">subjectBytes</span><span class="op" id="4116176">(</span><span class="ident" id="4116177">parent</span><span class="op" id="4116183">)</span><br>
<span class="lineno">1475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4116186">if</span>&nbsp;<span class="ident" id="4116189">err</span>&nbsp;<span class="op" id="4116193">!=</span>&nbsp;<span class="ident" id="4116196">nil</span>&nbsp;<span class="op" id="4116200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4116204">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4116212">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4116216">asn1Subject</span><span class="op" id="4116227">,</span>&nbsp;<span class="ident" id="4116229">err</span>&nbsp;<span class="op" id="4116233">:=</span>&nbsp;<span class="ident" id="4116236">subjectBytes</span><span class="op" id="4116248">(</span><span class="ident" id="4116249">template</span><span class="op" id="4116257">)</span><br>
<span class="lineno">1480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4116260">if</span>&nbsp;<span class="ident" id="4116263">err</span>&nbsp;<span class="op" id="4116267">!=</span>&nbsp;<span class="ident" id="4116270">nil</span>&nbsp;<span class="op" id="4116274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4116278">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4116286">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4116290">encodedPublicKey</span>&nbsp;<span class="op" id="4116307">:=</span>&nbsp;<span class="ident" id="4116310">asn1</span><span class="op" id="4116314">.</span><span class="ident" id="4116315">BitString</span><span class="op" id="4116324">{</span><span class="ident" id="4116325">BitLength</span><span class="op" id="4116334">:</span>&nbsp;<span class="builtinfunc" id="4116336">len</span><span class="op" id="4116339">(</span><span class="ident" id="4116340">publicKeyBytes</span><span class="op" id="4116354">)</span>&nbsp;<span class="op" id="4116356">*</span>&nbsp;<span class="num" id="4116358">8</span><span class="op" id="4116359">,</span>&nbsp;<span class="ident" id="4116361">Bytes</span><span class="op" id="4116366">:</span>&nbsp;<span class="ident" id="4116368">publicKeyBytes</span><span class="op" id="4116382">}</span><br>
<span class="lineno">1485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4116385">c</span>&nbsp;<span class="op" id="4116387">:=</span>&nbsp;<span class="ident" id="4116390">tbsCertificate</span><span class="op" id="4116404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4116408">Version</span><span class="op" id="4116415">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4116428">2</span><span class="op" id="4116429">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4116433">SerialNumber</span><span class="op" id="4116445">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4116453">template</span><span class="op" id="4116461">.</span><span class="ident" id="4116462">SerialNumber</span><span class="op" id="4116474">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4116478">SignatureAlgorithm</span><span class="op" id="4116496">:</span>&nbsp;<span class="ident" id="4116498">signatureAlgorithm</span><span class="op" id="4116516">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4116520">Issuer</span><span class="op" id="4116526">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4116540">asn1</span><span class="op" id="4116544">.</span><span class="ident" id="4116545">RawValue</span><span class="op" id="4116553">{</span><span class="ident" id="4116554">FullBytes</span><span class="op" id="4116563">:</span>&nbsp;<span class="ident" id="4116565">asn1Issuer</span><span class="op" id="4116575">}</span><span class="op" id="4116576">,</span><br>
<span class="lineno">1490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4116580">Validity</span><span class="op" id="4116588">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4116600">validity</span><span class="op" id="4116608">{</span><span class="ident" id="4116609">template</span><span class="op" id="4116617">.</span><span class="ident" id="4116618">NotBefore</span><span class="op" id="4116627">.</span><span class="ident" id="4116628">UTC</span><span class="op" id="4116631">(</span><span class="op" id="4116632">)</span><span class="op" id="4116633">,</span>&nbsp;<span class="ident" id="4116635">template</span><span class="op" id="4116643">.</span><span class="ident" id="4116644">NotAfter</span><span class="op" id="4116652">.</span><span class="ident" id="4116653">UTC</span><span class="op" id="4116656">(</span><span class="op" id="4116657">)</span><span class="op" id="4116658">}</span><span class="op" id="4116659">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4116663">Subject</span><span class="op" id="4116670">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4116683">asn1</span><span class="op" id="4116687">.</span><span class="ident" id="4116688">RawValue</span><span class="op" id="4116696">{</span><span class="ident" id="4116697">FullBytes</span><span class="op" id="4116706">:</span>&nbsp;<span class="ident" id="4116708">asn1Subject</span><span class="op" id="4116719">}</span><span class="op" id="4116720">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4116724">PublicKey</span><span class="op" id="4116733">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4116744">publicKeyInfo</span><span class="op" id="4116757">{</span><span class="ident" id="4116758">nil</span><span class="op" id="4116761">,</span>&nbsp;<span class="ident" id="4116763">publicKeyAlgorithm</span><span class="op" id="4116781">,</span>&nbsp;<span class="ident" id="4116783">encodedPublicKey</span><span class="op" id="4116799">}</span><span class="op" id="4116800">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4116804">Extensions</span><span class="op" id="4116814">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4116824">extensions</span><span class="op" id="4116834">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4116837">}</span><br>
<span class="lineno">1495</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4116841">tbsCertContents</span><span class="op" id="4116856">,</span>&nbsp;<span class="ident" id="4116858">err</span>&nbsp;<span class="op" id="4116862">:=</span>&nbsp;<span class="ident" id="4116865">asn1</span><span class="op" id="4116869">.</span><span class="ident" id="4116870">Marshal</span><span class="op" id="4116877">(</span><span class="ident" id="4116878">c</span><span class="op" id="4116879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4116882">if</span>&nbsp;<span class="ident" id="4116885">err</span>&nbsp;<span class="op" id="4116889">!=</span>&nbsp;<span class="ident" id="4116892">nil</span>&nbsp;<span class="op" id="4116896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4116900">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4116908">}</span><br>
<span class="lineno">1500</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4116912">c</span><span class="op" id="4116913">.</span><span class="ident" id="4116914">Raw</span>&nbsp;<span class="op" id="4116918">=</span>&nbsp;<span class="ident" id="4116920">tbsCertContents</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4116938">h</span>&nbsp;<span class="op" id="4116940">:=</span>&nbsp;<span class="ident" id="4116943">hashFunc</span><span class="op" id="4116951">.</span><span class="ident" id="4116952">New</span><span class="op" id="4116955">(</span><span class="op" id="4116956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4116959">h</span><span class="op" id="4116960">.</span><span class="ident" id="4116961">Write</span><span class="op" id="4116966">(</span><span class="ident" id="4116967">tbsCertContents</span><span class="op" id="4116982">)</span><br>
<span class="lineno">1505</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4116985">digest</span>&nbsp;<span class="op" id="4116992">:=</span>&nbsp;<span class="ident" id="4116995">h</span><span class="op" id="4116996">.</span><span class="ident" id="4116997">Sum</span><span class="op" id="4117000">(</span><span class="ident" id="4117001">nil</span><span class="op" id="4117004">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4117008">var</span>&nbsp;<span class="ident" id="4117012">signature</span>&nbsp;<span class="op" id="4117022">[</span><span class="op" id="4117023">]</span><span class="builtintype" id="4117024">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4117031">switch</span>&nbsp;<span class="ident" id="4117038">priv</span>&nbsp;<span class="op" id="4117043">:=</span>&nbsp;<span class="ident" id="4117046">priv</span><span class="op" id="4117050">.</span><span class="op" id="4117051">(</span><span class="keyword" id="4117052">type</span><span class="op" id="4117056">)</span>&nbsp;<span class="op" id="4117058">{</span><br>
<span class="lineno">1510</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4117061">case</span>&nbsp;<span class="op" id="4117066">*</span><span class="ident" id="4117067">rsa</span><span class="op" id="4117070">.</span><span class="ident" id="4117071">PrivateKey</span><span class="op" id="4117081">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4117085">signature</span><span class="op" id="4117094">,</span>&nbsp;<span class="ident" id="4117096">err</span>&nbsp;<span class="op" id="4117100">=</span>&nbsp;<span class="ident" id="4117102">rsa</span><span class="op" id="4117105">.</span><span class="ident" id="4117106">SignPKCS1v15</span><span class="op" id="4117118">(</span><span class="ident" id="4117119">rand</span><span class="op" id="4117123">,</span>&nbsp;<span class="ident" id="4117125">priv</span><span class="op" id="4117129">,</span>&nbsp;<span class="ident" id="4117131">hashFunc</span><span class="op" id="4117139">,</span>&nbsp;<span class="ident" id="4117141">digest</span><span class="op" id="4117147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4117150">case</span>&nbsp;<span class="op" id="4117155">*</span><span class="ident" id="4117156">ecdsa</span><span class="op" id="4117161">.</span><span class="ident" id="4117162">PrivateKey</span><span class="op" id="4117172">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4117176">var</span>&nbsp;<span class="ident" id="4117180">r</span><span class="op" id="4117181">,</span>&nbsp;<span class="ident" id="4117183">s</span>&nbsp;<span class="op" id="4117185">*</span><span class="ident" id="4117186">big</span><span class="op" id="4117189">.</span><span class="ident" id="4117190">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4117196">if</span>&nbsp;<span class="ident" id="4117199">r</span><span class="op" id="4117200">,</span>&nbsp;<span class="ident" id="4117202">s</span><span class="op" id="4117203">,</span>&nbsp;<span class="ident" id="4117205">err</span>&nbsp;<span class="op" id="4117209">=</span>&nbsp;<span class="ident" id="4117211">ecdsa</span><span class="op" id="4117216">.</span><span class="ident" id="4117217">Sign</span><span class="op" id="4117221">(</span><span class="ident" id="4117222">rand</span><span class="op" id="4117226">,</span>&nbsp;<span class="ident" id="4117228">priv</span><span class="op" id="4117232">,</span>&nbsp;<span class="ident" id="4117234">digest</span><span class="op" id="4117240">)</span><span class="op" id="4117241">;</span>&nbsp;<span class="ident" id="4117243">err</span>&nbsp;<span class="op" id="4117247">==</span>&nbsp;<span class="ident" id="4117250">nil</span>&nbsp;<span class="op" id="4117254">{</span><br>
<span class="lineno">1515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4117259">signature</span><span class="op" id="4117268">,</span>&nbsp;<span class="ident" id="4117270">err</span>&nbsp;<span class="op" id="4117274">=</span>&nbsp;<span class="ident" id="4117276">asn1</span><span class="op" id="4117280">.</span><span class="ident" id="4117281">Marshal</span><span class="op" id="4117288">(</span><span class="ident" id="4117289">ecdsaSignature</span><span class="op" id="4117303">{</span><span class="ident" id="4117304">r</span><span class="op" id="4117305">,</span>&nbsp;<span class="ident" id="4117307">s</span><span class="op" id="4117308">}</span><span class="op" id="4117309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4117313">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4117316">default</span><span class="op" id="4117323">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4117327">panic</span><span class="op" id="4117332">(</span><span class="string" id="4117333">&#34;internal&nbsp;error&#34;</span><span class="op" id="4117349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4117352">}</span><br>
<span class="lineno">1520</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4117356">if</span>&nbsp;<span class="ident" id="4117359">err</span>&nbsp;<span class="op" id="4117363">!=</span>&nbsp;<span class="ident" id="4117366">nil</span>&nbsp;<span class="op" id="4117370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4117374">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4117382">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1525</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4117386">cert</span><span class="op" id="4117390">,</span>&nbsp;<span class="ident" id="4117392">err</span>&nbsp;<span class="op" id="4117396">=</span>&nbsp;<span class="ident" id="4117398">asn1</span><span class="op" id="4117402">.</span><span class="ident" id="4117403">Marshal</span><span class="op" id="4117410">(</span><span class="ident" id="4117411">certificate</span><span class="op" id="4117422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4117426">nil</span><span class="op" id="4117429">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4117433">c</span><span class="op" id="4117434">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4117438">signatureAlgorithm</span><span class="op" id="4117456">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4117460">asn1</span><span class="op" id="4117464">.</span><span class="ident" id="4117465">BitString</span><span class="op" id="4117474">{</span><span class="ident" id="4117475">Bytes</span><span class="op" id="4117480">:</span>&nbsp;<span class="ident" id="4117482">signature</span><span class="op" id="4117491">,</span>&nbsp;<span class="ident" id="4117493">BitLength</span><span class="op" id="4117502">:</span>&nbsp;<span class="builtinfunc" id="4117504">len</span><span class="op" id="4117507">(</span><span class="ident" id="4117508">signature</span><span class="op" id="4117517">)</span>&nbsp;<span class="op" id="4117519">*</span>&nbsp;<span class="num" id="4117521">8</span><span class="op" id="4117522">}</span><span class="op" id="4117523">,</span><br>
<span class="lineno">1530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4117526">}</span><span class="op" id="4117527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4117530">return</span><br>
<span class="lineno"></span><span class="op" id="4117537">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4117540">//&nbsp;pemCRLPrefix&nbsp;is&nbsp;the&nbsp;magic&nbsp;string&nbsp;that&nbsp;indicates&nbsp;that&nbsp;we&nbsp;have&nbsp;a&nbsp;PEM&nbsp;encoded</span><br>
<span class="lineno">1535</span><span class="comment" id="4117618">//&nbsp;CRL.</span><br>
<span class="lineno"></span><span class="keyword" id="4117626">var</span>&nbsp;<span class="ident" id="4117630">pemCRLPrefix</span>&nbsp;<span class="op" id="4117643">=</span>&nbsp;<span class="op" id="4117645">[</span><span class="op" id="4117646">]</span><span class="builtintype" id="4117647">byte</span><span class="op" id="4117651">(</span><span class="string" id="4117652">&#34;-----BEGIN&nbsp;X509&nbsp;CRL&#34;</span><span class="op" id="4117673">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4117676">//&nbsp;pemType&nbsp;is&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;PEM&nbsp;encoded&nbsp;CRL.</span><br>
<span class="lineno"></span><span class="keyword" id="4117721">var</span>&nbsp;<span class="ident" id="4117725">pemType</span>&nbsp;<span class="op" id="4117733">=</span>&nbsp;<span class="string" id="4117735">&#34;X509&nbsp;CRL&#34;</span><br>
<span class="lineno">1540</span><br>
<span class="lineno"></span><span class="comment" id="4117747">//&nbsp;ParseCRL&nbsp;parses&nbsp;a&nbsp;CRL&nbsp;from&nbsp;the&nbsp;given&nbsp;bytes.&nbsp;It&#39;s&nbsp;often&nbsp;the&nbsp;case&nbsp;that&nbsp;PEM</span><br>
<span class="lineno"></span><span class="comment" id="4117823">//&nbsp;encoded&nbsp;CRLs&nbsp;will&nbsp;appear&nbsp;where&nbsp;they&nbsp;should&nbsp;be&nbsp;DER&nbsp;encoded,&nbsp;so&nbsp;this&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="4117902">//&nbsp;will&nbsp;transparently&nbsp;handle&nbsp;PEM&nbsp;encoding&nbsp;as&nbsp;long&nbsp;as&nbsp;there&nbsp;isn&#39;t&nbsp;any&nbsp;leading</span><br>
<span class="lineno"></span><span class="comment" id="4117979">//&nbsp;garbage.</span><br>
<span class="lineno">1545</span><span class="keyword" id="4117991">func</span>&nbsp;<span class="ident" id="4117996">ParseCRL</span><span class="op" id="4118004">(</span><span class="ident" id="4118005">crlBytes</span>&nbsp;<span class="op" id="4118014">[</span><span class="op" id="4118015">]</span><span class="builtintype" id="4118016">byte</span><span class="op" id="4118020">)</span>&nbsp;<span class="op" id="4118022">(</span><span class="ident" id="4118023">certList</span>&nbsp;<span class="op" id="4118032">*</span><span class="ident" id="4118033">pkix</span><span class="op" id="4118037">.</span><span class="ident" id="4118038">CertificateList</span><span class="op" id="4118053">,</span>&nbsp;<span class="ident" id="4118055">err</span>&nbsp;<span class="builtintype" id="4118059">error</span><span class="op" id="4118064">)</span>&nbsp;<span class="op" id="4118066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4118069">if</span>&nbsp;<span class="ident" id="4118072">bytes</span><span class="op" id="4118077">.</span><span class="ident" id="4118078">HasPrefix</span><span class="op" id="4118087">(</span><span class="ident" id="4118088">crlBytes</span><span class="op" id="4118096">,</span>&nbsp;<span class="ident" id="4118098">pemCRLPrefix</span><span class="op" id="4118110">)</span>&nbsp;<span class="op" id="4118112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4118116">block</span><span class="op" id="4118121">,</span>&nbsp;<span class="ident" id="4118123">_</span>&nbsp;<span class="op" id="4118125">:=</span>&nbsp;<span class="ident" id="4118128">pem</span><span class="op" id="4118131">.</span><span class="ident" id="4118132">Decode</span><span class="op" id="4118138">(</span><span class="ident" id="4118139">crlBytes</span><span class="op" id="4118147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4118151">if</span>&nbsp;<span class="ident" id="4118154">block</span>&nbsp;<span class="op" id="4118160">!=</span>&nbsp;<span class="ident" id="4118163">nil</span>&nbsp;<span class="op" id="4118167">&amp;&amp;</span>&nbsp;<span class="ident" id="4118170">block</span><span class="op" id="4118175">.</span><span class="ident" id="4118176">Type</span>&nbsp;<span class="op" id="4118181">==</span>&nbsp;<span class="ident" id="4118184">pemType</span>&nbsp;<span class="op" id="4118192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4118197">crlBytes</span>&nbsp;<span class="op" id="4118206">=</span>&nbsp;<span class="ident" id="4118208">block</span><span class="op" id="4118213">.</span><span class="ident" id="4118214">Bytes</span><br>
<span class="lineno">1550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4118222">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4118225">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4118228">return</span>&nbsp;<span class="ident" id="4118235">ParseDERCRL</span><span class="op" id="4118246">(</span><span class="ident" id="4118247">crlBytes</span><span class="op" id="4118255">)</span><br>
<span class="lineno"></span><span class="op" id="4118257">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1555</span><span class="comment" id="4118260">//&nbsp;ParseDERCRL&nbsp;parses&nbsp;a&nbsp;DER&nbsp;encoded&nbsp;CRL&nbsp;from&nbsp;the&nbsp;given&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4118322">func</span>&nbsp;<span class="ident" id="4118327">ParseDERCRL</span><span class="op" id="4118338">(</span><span class="ident" id="4118339">derBytes</span>&nbsp;<span class="op" id="4118348">[</span><span class="op" id="4118349">]</span><span class="builtintype" id="4118350">byte</span><span class="op" id="4118354">)</span>&nbsp;<span class="op" id="4118356">(</span><span class="ident" id="4118357">certList</span>&nbsp;<span class="op" id="4118366">*</span><span class="ident" id="4118367">pkix</span><span class="op" id="4118371">.</span><span class="ident" id="4118372">CertificateList</span><span class="op" id="4118387">,</span>&nbsp;<span class="ident" id="4118389">err</span>&nbsp;<span class="builtintype" id="4118393">error</span><span class="op" id="4118398">)</span>&nbsp;<span class="op" id="4118400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4118403">certList</span>&nbsp;<span class="op" id="4118412">=</span>&nbsp;<span class="builtinfunc" id="4118414">new</span><span class="op" id="4118417">(</span><span class="ident" id="4118418">pkix</span><span class="op" id="4118422">.</span><span class="ident" id="4118423">CertificateList</span><span class="op" id="4118438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4118441">_</span><span class="op" id="4118442">,</span>&nbsp;<span class="ident" id="4118444">err</span>&nbsp;<span class="op" id="4118448">=</span>&nbsp;<span class="ident" id="4118450">asn1</span><span class="op" id="4118454">.</span><span class="ident" id="4118455">Unmarshal</span><span class="op" id="4118464">(</span><span class="ident" id="4118465">derBytes</span><span class="op" id="4118473">,</span>&nbsp;<span class="ident" id="4118475">certList</span><span class="op" id="4118483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4118486">if</span>&nbsp;<span class="ident" id="4118489">err</span>&nbsp;<span class="op" id="4118493">!=</span>&nbsp;<span class="ident" id="4118496">nil</span>&nbsp;<span class="op" id="4118500">{</span><br>
<span class="lineno">1560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4118504">certList</span>&nbsp;<span class="op" id="4118513">=</span>&nbsp;<span class="ident" id="4118515">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4118520">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4118523">return</span><br>
<span class="lineno"></span><span class="op" id="4118530">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1565</span><span class="comment" id="4118533">//&nbsp;CreateCRL&nbsp;returns&nbsp;a&nbsp;DER&nbsp;encoded&nbsp;CRL,&nbsp;signed&nbsp;by&nbsp;this&nbsp;Certificate,&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4118606">//&nbsp;contains&nbsp;the&nbsp;given&nbsp;list&nbsp;of&nbsp;revoked&nbsp;certificates.</span><br>
<span class="lineno"></span><span class="comment" id="4118658">//</span><br>
<span class="lineno"></span><span class="comment" id="4118661">//&nbsp;The&nbsp;only&nbsp;supported&nbsp;key&nbsp;type&nbsp;is&nbsp;RSA&nbsp;(*rsa.PrivateKey&nbsp;for&nbsp;priv).</span><br>
<span class="lineno"></span><span class="keyword" id="4118727">func</span>&nbsp;<span class="op" id="4118732">(</span><span class="ident" id="4118733">c</span>&nbsp;<span class="op" id="4118735">*</span><span class="ident" id="4118736">Certificate</span><span class="op" id="4118747">)</span>&nbsp;<span class="ident" id="4118749">CreateCRL</span><span class="op" id="4118758">(</span><span class="ident" id="4118759">rand</span>&nbsp;<span class="ident" id="4118764">io</span><span class="op" id="4118766">.</span><span class="ident" id="4118767">Reader</span><span class="op" id="4118773">,</span>&nbsp;<span class="ident" id="4118775">priv</span>&nbsp;<span class="keyword" id="4118780">interface</span><span class="op" id="4118789">{</span><span class="op" id="4118790">}</span><span class="op" id="4118791">,</span>&nbsp;<span class="ident" id="4118793">revokedCerts</span>&nbsp;<span class="op" id="4118806">[</span><span class="op" id="4118807">]</span><span class="ident" id="4118808">pkix</span><span class="op" id="4118812">.</span><span class="ident" id="4118813">RevokedCertificate</span><span class="op" id="4118831">,</span>&nbsp;<span class="ident" id="4118833">now</span><span class="op" id="4118836">,</span>&nbsp;<span class="ident" id="4118838">expiry</span>&nbsp;<span class="ident" id="4118845">time</span><span class="op" id="4118849">.</span><span class="ident" id="4118850">Time</span><span class="op" id="4118854">)</span>&nbsp;<span class="op" id="4118856">(</span><span class="ident" id="4118857">crlBytes</span>&nbsp;<span class="op" id="4118866">[</span><span class="op" id="4118867">]</span><span class="builtintype" id="4118868">byte</span><span class="op" id="4118872">,</span>&nbsp;<span class="ident" id="4118874">err</span>&nbsp;<span class="builtintype" id="4118878">error</span><span class="op" id="4118883">)</span>&nbsp;<span class="op" id="4118885">{</span><br>
<span class="lineno">1570</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4118888">rsaPriv</span><span class="op" id="4118895">,</span>&nbsp;<span class="ident" id="4118897">ok</span>&nbsp;<span class="op" id="4118900">:=</span>&nbsp;<span class="ident" id="4118903">priv</span><span class="op" id="4118907">.</span><span class="op" id="4118908">(</span><span class="op" id="4118909">*</span><span class="ident" id="4118910">rsa</span><span class="op" id="4118913">.</span><span class="ident" id="4118914">PrivateKey</span><span class="op" id="4118924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4118927">if</span>&nbsp;<span class="op" id="4118930">!</span><span class="ident" id="4118931">ok</span>&nbsp;<span class="op" id="4118934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4118938">return</span>&nbsp;<span class="ident" id="4118945">nil</span><span class="op" id="4118948">,</span>&nbsp;<span class="ident" id="4118950">errors</span><span class="op" id="4118956">.</span><span class="ident" id="4118957">New</span><span class="op" id="4118960">(</span><span class="string" id="4118961">&#34;x509:&nbsp;non-RSA&nbsp;private&nbsp;keys&nbsp;not&nbsp;supported&#34;</span><span class="op" id="4119003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4119006">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4119009">tbsCertList</span>&nbsp;<span class="op" id="4119021">:=</span>&nbsp;<span class="ident" id="4119024">pkix</span><span class="op" id="4119028">.</span><span class="ident" id="4119029">TBSCertificateList</span><span class="op" id="4119047">{</span><br>
<span class="lineno">1575</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4119051">Version</span><span class="op" id="4119058">:</span>&nbsp;<span class="num" id="4119060">2</span><span class="op" id="4119061">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4119065">Signature</span><span class="op" id="4119074">:</span>&nbsp;<span class="ident" id="4119076">pkix</span><span class="op" id="4119080">.</span><span class="ident" id="4119081">AlgorithmIdentifier</span><span class="op" id="4119100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4119105">Algorithm</span><span class="op" id="4119114">:</span>&nbsp;<span class="ident" id="4119116">oidSignatureSHA1WithRSA</span><span class="op" id="4119139">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4119143">}</span><span class="op" id="4119144">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4119148">Issuer</span><span class="op" id="4119154">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4119169">c</span><span class="op" id="4119170">.</span><span class="ident" id="4119171">Subject</span><span class="op" id="4119178">.</span><span class="ident" id="4119179">ToRDNSequence</span><span class="op" id="4119192">(</span><span class="op" id="4119193">)</span><span class="op" id="4119194">,</span><br>
<span class="lineno">1580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4119198">ThisUpdate</span><span class="op" id="4119208">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4119219">now</span><span class="op" id="4119222">.</span><span class="ident" id="4119223">UTC</span><span class="op" id="4119226">(</span><span class="op" id="4119227">)</span><span class="op" id="4119228">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4119232">NextUpdate</span><span class="op" id="4119242">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4119253">expiry</span><span class="op" id="4119259">.</span><span class="ident" id="4119260">UTC</span><span class="op" id="4119263">(</span><span class="op" id="4119264">)</span><span class="op" id="4119265">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4119269">RevokedCertificates</span><span class="op" id="4119288">:</span>&nbsp;<span class="ident" id="4119290">revokedCerts</span><span class="op" id="4119302">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4119305">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1585</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4119309">tbsCertListContents</span><span class="op" id="4119328">,</span>&nbsp;<span class="ident" id="4119330">err</span>&nbsp;<span class="op" id="4119334">:=</span>&nbsp;<span class="ident" id="4119337">asn1</span><span class="op" id="4119341">.</span><span class="ident" id="4119342">Marshal</span><span class="op" id="4119349">(</span><span class="ident" id="4119350">tbsCertList</span><span class="op" id="4119361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4119364">if</span>&nbsp;<span class="ident" id="4119367">err</span>&nbsp;<span class="op" id="4119371">!=</span>&nbsp;<span class="ident" id="4119374">nil</span>&nbsp;<span class="op" id="4119378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4119382">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4119390">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1590</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4119394">h</span>&nbsp;<span class="op" id="4119396">:=</span>&nbsp;<span class="ident" id="4119399">sha1</span><span class="op" id="4119403">.</span><span class="ident" id="4119404">New</span><span class="op" id="4119407">(</span><span class="op" id="4119408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4119411">h</span><span class="op" id="4119412">.</span><span class="ident" id="4119413">Write</span><span class="op" id="4119418">(</span><span class="ident" id="4119419">tbsCertListContents</span><span class="op" id="4119438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4119441">digest</span>&nbsp;<span class="op" id="4119448">:=</span>&nbsp;<span class="ident" id="4119451">h</span><span class="op" id="4119452">.</span><span class="ident" id="4119453">Sum</span><span class="op" id="4119456">(</span><span class="ident" id="4119457">nil</span><span class="op" id="4119460">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4119464">signature</span><span class="op" id="4119473">,</span>&nbsp;<span class="ident" id="4119475">err</span>&nbsp;<span class="op" id="4119479">:=</span>&nbsp;<span class="ident" id="4119482">rsa</span><span class="op" id="4119485">.</span><span class="ident" id="4119486">SignPKCS1v15</span><span class="op" id="4119498">(</span><span class="ident" id="4119499">rand</span><span class="op" id="4119503">,</span>&nbsp;<span class="ident" id="4119505">rsaPriv</span><span class="op" id="4119512">,</span>&nbsp;<span class="ident" id="4119514">crypto</span><span class="op" id="4119520">.</span><span class="ident" id="4119521">SHA1</span><span class="op" id="4119525">,</span>&nbsp;<span class="ident" id="4119527">digest</span><span class="op" id="4119533">)</span><br>
<span class="lineno">1595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4119536">if</span>&nbsp;<span class="ident" id="4119539">err</span>&nbsp;<span class="op" id="4119543">!=</span>&nbsp;<span class="ident" id="4119546">nil</span>&nbsp;<span class="op" id="4119550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4119554">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4119562">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4119566">return</span>&nbsp;<span class="ident" id="4119573">asn1</span><span class="op" id="4119577">.</span><span class="ident" id="4119578">Marshal</span><span class="op" id="4119585">(</span><span class="ident" id="4119586">pkix</span><span class="op" id="4119590">.</span><span class="ident" id="4119591">CertificateList</span><span class="op" id="4119606">{</span><br>
<span class="lineno">1600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4119610">TBSCertList</span><span class="op" id="4119621">:</span>&nbsp;<span class="ident" id="4119623">tbsCertList</span><span class="op" id="4119634">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4119638">SignatureAlgorithm</span><span class="op" id="4119656">:</span>&nbsp;<span class="ident" id="4119658">pkix</span><span class="op" id="4119662">.</span><span class="ident" id="4119663">AlgorithmIdentifier</span><span class="op" id="4119682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4119687">Algorithm</span><span class="op" id="4119696">:</span>&nbsp;<span class="ident" id="4119698">oidSignatureSHA1WithRSA</span><span class="op" id="4119721">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4119725">}</span><span class="op" id="4119726">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4119730">SignatureValue</span><span class="op" id="4119744">:</span>&nbsp;<span class="ident" id="4119746">asn1</span><span class="op" id="4119750">.</span><span class="ident" id="4119751">BitString</span><span class="op" id="4119760">{</span><span class="ident" id="4119761">Bytes</span><span class="op" id="4119766">:</span>&nbsp;<span class="ident" id="4119768">signature</span><span class="op" id="4119777">,</span>&nbsp;<span class="ident" id="4119779">BitLength</span><span class="op" id="4119788">:</span>&nbsp;<span class="builtinfunc" id="4119790">len</span><span class="op" id="4119793">(</span><span class="ident" id="4119794">signature</span><span class="op" id="4119803">)</span>&nbsp;<span class="op" id="4119805">*</span>&nbsp;<span class="num" id="4119807">8</span><span class="op" id="4119808">}</span><span class="op" id="4119809">,</span><br>
<span class="lineno">1605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4119812">}</span><span class="op" id="4119813">)</span><br>
<span class="lineno"></span><span class="op" id="4119815">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4119818">//&nbsp;CertificateRequest&nbsp;represents&nbsp;a&nbsp;PKCS&nbsp;#10,&nbsp;certificate&nbsp;signature&nbsp;request.</span><br>
<span class="lineno"></span><span class="keyword" id="4119894">type</span>&nbsp;<span class="ident" id="4119899">CertificateRequest</span>&nbsp;<span class="keyword" id="4119918">struct</span>&nbsp;<span class="op" id="4119925">{</span><br>
<span class="lineno">1610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4119928">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4119953">[</span><span class="op" id="4119954">]</span><span class="builtintype" id="4119955">byte</span>&nbsp;<span class="comment" id="4119960">//&nbsp;Complete&nbsp;ASN.1&nbsp;DER&nbsp;content&nbsp;(CSR,&nbsp;signature&nbsp;algorithm&nbsp;and&nbsp;signature).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4120033">RawTBSCertificateRequest</span>&nbsp;<span class="op" id="4120058">[</span><span class="op" id="4120059">]</span><span class="builtintype" id="4120060">byte</span>&nbsp;<span class="comment" id="4120065">//&nbsp;Certificate&nbsp;request&nbsp;info&nbsp;part&nbsp;of&nbsp;raw&nbsp;ASN.1&nbsp;DER&nbsp;content.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4120125">RawSubjectPublicKeyInfo</span>&nbsp;&nbsp;<span class="op" id="4120150">[</span><span class="op" id="4120151">]</span><span class="builtintype" id="4120152">byte</span>&nbsp;<span class="comment" id="4120157">//&nbsp;DER&nbsp;encoded&nbsp;SubjectPublicKeyInfo.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4120195">RawSubject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4120220">[</span><span class="op" id="4120221">]</span><span class="builtintype" id="4120222">byte</span>&nbsp;<span class="comment" id="4120227">//&nbsp;DER&nbsp;encoded&nbsp;Subject.</span><br>
<span class="lineno"></span><br>
<span class="lineno">1615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4120253">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4120272">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4120277">Signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4120296">[</span><span class="op" id="4120297">]</span><span class="builtintype" id="4120298">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4120304">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4120323">SignatureAlgorithm</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4120344">PublicKeyAlgorithm</span>&nbsp;<span class="ident" id="4120363">PublicKeyAlgorithm</span><br>
<span class="lineno">1620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4120383">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4120402">interface</span><span class="op" id="4120411">{</span><span class="op" id="4120412">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4120416">Subject</span>&nbsp;<span class="ident" id="4120424">pkix</span><span class="op" id="4120428">.</span><span class="ident" id="4120429">Name</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4120436">//&nbsp;Attributes&nbsp;is&nbsp;a&nbsp;collection&nbsp;of&nbsp;attributes&nbsp;providing</span><br>
<span class="lineno">1625</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4120491">//&nbsp;additional&nbsp;information&nbsp;about&nbsp;the&nbsp;subject&nbsp;of&nbsp;the&nbsp;certificate.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4120556">//&nbsp;See&nbsp;RFC&nbsp;2986&nbsp;section&nbsp;4.1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4120586">Attributes</span>&nbsp;<span class="op" id="4120597">[</span><span class="op" id="4120598">]</span><span class="ident" id="4120599">pkix</span><span class="op" id="4120603">.</span><span class="ident" id="4120604">AttributeTypeAndValueSET</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4120631">//&nbsp;Extensions&nbsp;contains&nbsp;raw&nbsp;X.509&nbsp;extensions.&nbsp;When&nbsp;parsing&nbsp;CSRs,&nbsp;this</span><br>
<span class="lineno">1630</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4120701">//&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;extract&nbsp;extensions&nbsp;that&nbsp;are&nbsp;not&nbsp;parsed&nbsp;by&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4120767">//&nbsp;package.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4120780">Extensions</span>&nbsp;<span class="op" id="4120791">[</span><span class="op" id="4120792">]</span><span class="ident" id="4120793">pkix</span><span class="op" id="4120797">.</span><span class="ident" id="4120798">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4120810">//&nbsp;ExtraExtensions&nbsp;contains&nbsp;extensions&nbsp;to&nbsp;be&nbsp;copied,&nbsp;raw,&nbsp;into&nbsp;any</span><br>
<span class="lineno">1635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4120878">//&nbsp;marshaled&nbsp;CSR.&nbsp;Values&nbsp;override&nbsp;any&nbsp;extensions&nbsp;that&nbsp;would&nbsp;otherwise</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4120949">//&nbsp;be&nbsp;produced&nbsp;based&nbsp;on&nbsp;the&nbsp;other&nbsp;fields&nbsp;but&nbsp;are&nbsp;overridden&nbsp;by&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4121017">//&nbsp;extensions&nbsp;specified&nbsp;in&nbsp;Attributes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4121057">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4121061">//&nbsp;The&nbsp;ExtraExtensions&nbsp;field&nbsp;is&nbsp;not&nbsp;populated&nbsp;when&nbsp;parsing&nbsp;CSRs,&nbsp;see</span><br>
<span class="lineno">1640</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4121131">//&nbsp;Extensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4121147">ExtraExtensions</span>&nbsp;<span class="op" id="4121163">[</span><span class="op" id="4121164">]</span><span class="ident" id="4121165">pkix</span><span class="op" id="4121169">.</span><span class="ident" id="4121170">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4121182">//&nbsp;Subject&nbsp;Alternate&nbsp;Name&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4121217">DNSNames</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4121232">[</span><span class="op" id="4121233">]</span><span class="builtintype" id="4121234">string</span><br>
<span class="lineno">1645</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4121242">EmailAddresses</span>&nbsp;<span class="op" id="4121257">[</span><span class="op" id="4121258">]</span><span class="builtintype" id="4121259">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4121267">IPAddresses</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4121282">[</span><span class="op" id="4121283">]</span><span class="ident" id="4121284">net</span><span class="op" id="4121287">.</span><span class="ident" id="4121288">IP</span><br>
<span class="lineno"></span><span class="op" id="4121291">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4121294">//&nbsp;These&nbsp;structures&nbsp;reflect&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;X.509&nbsp;certificate</span><br>
<span class="lineno">1650</span><span class="comment" id="4121363">//&nbsp;signature&nbsp;requests&nbsp;(see&nbsp;RFC&nbsp;2986):</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4121402">type</span>&nbsp;<span class="ident" id="4121407">tbsCertificateRequest</span>&nbsp;<span class="keyword" id="4121429">struct</span>&nbsp;<span class="op" id="4121436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4121439">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4121450">asn1</span><span class="op" id="4121454">.</span><span class="ident" id="4121455">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4121467">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4121478">int</span><br>
<span class="lineno">1655</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4121483">Subject</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4121494">asn1</span><span class="op" id="4121498">.</span><span class="ident" id="4121499">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4121509">PublicKey</span>&nbsp;&nbsp;<span class="ident" id="4121520">publicKeyInfo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4121535">Attributes</span>&nbsp;<span class="op" id="4121546">[</span><span class="op" id="4121547">]</span><span class="ident" id="4121548">pkix</span><span class="op" id="4121552">.</span><span class="ident" id="4121553">AttributeTypeAndValueSET</span>&nbsp;<span class="string" id="4121578">`asn1:&#34;tag:0&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4121593">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1660</span><span class="keyword" id="4121596">type</span>&nbsp;<span class="ident" id="4121601">certificateRequest</span>&nbsp;<span class="keyword" id="4121620">struct</span>&nbsp;<span class="op" id="4121627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4121630">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4121649">asn1</span><span class="op" id="4121653">.</span><span class="ident" id="4121654">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4121666">TBSCSR</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4121685">tbsCertificateRequest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4121708">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4121727">pkix</span><span class="op" id="4121731">.</span><span class="ident" id="4121732">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4121753">SignatureValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4121772">asn1</span><span class="op" id="4121776">.</span><span class="ident" id="4121777">BitString</span><br>
<span class="lineno">1665</span><span class="op" id="4121787">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4121790">//&nbsp;oidExtensionRequest&nbsp;is&nbsp;a&nbsp;PKCS#9&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;that&nbsp;indicates&nbsp;requested</span><br>
<span class="lineno"></span><span class="comment" id="4121868">//&nbsp;extensions&nbsp;in&nbsp;a&nbsp;CSR.</span><br>
<span class="lineno"></span><span class="keyword" id="4121892">var</span>&nbsp;<span class="ident" id="4121896">oidExtensionRequest</span>&nbsp;<span class="op" id="4121916">=</span>&nbsp;<span class="ident" id="4121918">asn1</span><span class="op" id="4121922">.</span><span class="ident" id="4121923">ObjectIdentifier</span><span class="op" id="4121939">{</span><span class="num" id="4121940">1</span><span class="op" id="4121941">,</span>&nbsp;<span class="num" id="4121943">2</span><span class="op" id="4121944">,</span>&nbsp;<span class="num" id="4121946">840</span><span class="op" id="4121949">,</span>&nbsp;<span class="num" id="4121951">113549</span><span class="op" id="4121957">,</span>&nbsp;<span class="num" id="4121959">1</span><span class="op" id="4121960">,</span>&nbsp;<span class="num" id="4121962">9</span><span class="op" id="4121963">,</span>&nbsp;<span class="num" id="4121965">14</span><span class="op" id="4121967">}</span><br>
<span class="lineno">1670</span><br>
<span class="lineno"></span><span class="comment" id="4121970">//&nbsp;CreateCertificateRequest&nbsp;creates&nbsp;a&nbsp;new&nbsp;certificate&nbsp;based&nbsp;on&nbsp;a&nbsp;template.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="4122049">//&nbsp;following&nbsp;members&nbsp;of&nbsp;template&nbsp;are&nbsp;used:&nbsp;Subject,&nbsp;Attributes,</span><br>
<span class="lineno"></span><span class="comment" id="4122113">//&nbsp;SignatureAlgorithm,&nbsp;Extensions,&nbsp;DNSNames,&nbsp;EmailAddresses,&nbsp;and&nbsp;IPAddresses.</span><br>
<span class="lineno"></span><span class="comment" id="4122191">//&nbsp;The&nbsp;private&nbsp;key&nbsp;is&nbsp;the&nbsp;private&nbsp;key&nbsp;of&nbsp;the&nbsp;signer.</span><br>
<span class="lineno">1675</span><span class="comment" id="4122244">//</span><br>
<span class="lineno"></span><span class="comment" id="4122247">//&nbsp;The&nbsp;returned&nbsp;slice&nbsp;is&nbsp;the&nbsp;certificate&nbsp;request&nbsp;in&nbsp;DER&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="comment" id="4122313">//</span><br>
<span class="lineno"></span><span class="comment" id="4122316">//&nbsp;The&nbsp;only&nbsp;supported&nbsp;key&nbsp;types&nbsp;are&nbsp;RSA&nbsp;(*rsa.PrivateKey)&nbsp;and&nbsp;ECDSA</span><br>
<span class="lineno"></span><span class="comment" id="4122384">//&nbsp;(*ecdsa.PrivateKey).</span><br>
<span class="lineno">1680</span><span class="keyword" id="4122408">func</span>&nbsp;<span class="ident" id="4122413">CreateCertificateRequest</span><span class="op" id="4122437">(</span><span class="ident" id="4122438">rand</span>&nbsp;<span class="ident" id="4122443">io</span><span class="op" id="4122445">.</span><span class="ident" id="4122446">Reader</span><span class="op" id="4122452">,</span>&nbsp;<span class="ident" id="4122454">template</span>&nbsp;<span class="op" id="4122463">*</span><span class="ident" id="4122464">CertificateRequest</span><span class="op" id="4122482">,</span>&nbsp;<span class="ident" id="4122484">priv</span>&nbsp;<span class="keyword" id="4122489">interface</span><span class="op" id="4122498">{</span><span class="op" id="4122499">}</span><span class="op" id="4122500">)</span>&nbsp;<span class="op" id="4122502">(</span><span class="ident" id="4122503">csr</span>&nbsp;<span class="op" id="4122507">[</span><span class="op" id="4122508">]</span><span class="builtintype" id="4122509">byte</span><span class="op" id="4122513">,</span>&nbsp;<span class="ident" id="4122515">err</span>&nbsp;<span class="builtintype" id="4122519">error</span><span class="op" id="4122524">)</span>&nbsp;<span class="op" id="4122526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4122529">hashFunc</span><span class="op" id="4122537">,</span>&nbsp;<span class="ident" id="4122539">sigAlgo</span><span class="op" id="4122546">,</span>&nbsp;<span class="ident" id="4122548">err</span>&nbsp;<span class="op" id="4122552">:=</span>&nbsp;<span class="ident" id="4122555">signingParamsForPrivateKey</span><span class="op" id="4122581">(</span><span class="ident" id="4122582">priv</span><span class="op" id="4122586">,</span>&nbsp;<span class="ident" id="4122588">template</span><span class="op" id="4122596">.</span><span class="ident" id="4122597">SignatureAlgorithm</span><span class="op" id="4122615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4122618">if</span>&nbsp;<span class="ident" id="4122621">err</span>&nbsp;<span class="op" id="4122625">!=</span>&nbsp;<span class="ident" id="4122628">nil</span>&nbsp;<span class="op" id="4122632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4122636">return</span>&nbsp;<span class="ident" id="4122643">nil</span><span class="op" id="4122646">,</span>&nbsp;<span class="ident" id="4122648">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4122653">}</span><br>
<span class="lineno">1685</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4122657">var</span>&nbsp;<span class="ident" id="4122661">publicKeyBytes</span>&nbsp;<span class="op" id="4122676">[</span><span class="op" id="4122677">]</span><span class="builtintype" id="4122678">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4122684">var</span>&nbsp;<span class="ident" id="4122688">publicKeyAlgorithm</span>&nbsp;<span class="ident" id="4122707">pkix</span><span class="op" id="4122711">.</span><span class="ident" id="4122712">AlgorithmIdentifier</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4122734">switch</span>&nbsp;<span class="ident" id="4122741">priv</span>&nbsp;<span class="op" id="4122746">:=</span>&nbsp;<span class="ident" id="4122749">priv</span><span class="op" id="4122753">.</span><span class="op" id="4122754">(</span><span class="keyword" id="4122755">type</span><span class="op" id="4122759">)</span>&nbsp;<span class="op" id="4122761">{</span><br>
<span class="lineno">1690</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4122764">case</span>&nbsp;<span class="op" id="4122769">*</span><span class="ident" id="4122770">rsa</span><span class="op" id="4122773">.</span><span class="ident" id="4122774">PrivateKey</span><span class="op" id="4122784">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4122788">publicKeyBytes</span><span class="op" id="4122802">,</span>&nbsp;<span class="ident" id="4122804">publicKeyAlgorithm</span><span class="op" id="4122822">,</span>&nbsp;<span class="ident" id="4122824">err</span>&nbsp;<span class="op" id="4122828">=</span>&nbsp;<span class="ident" id="4122830">marshalPublicKey</span><span class="op" id="4122846">(</span><span class="op" id="4122847">&amp;</span><span class="ident" id="4122848">priv</span><span class="op" id="4122852">.</span><span class="ident" id="4122853">PublicKey</span><span class="op" id="4122862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4122865">case</span>&nbsp;<span class="op" id="4122870">*</span><span class="ident" id="4122871">ecdsa</span><span class="op" id="4122876">.</span><span class="ident" id="4122877">PrivateKey</span><span class="op" id="4122887">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4122891">publicKeyBytes</span><span class="op" id="4122905">,</span>&nbsp;<span class="ident" id="4122907">publicKeyAlgorithm</span><span class="op" id="4122925">,</span>&nbsp;<span class="ident" id="4122927">err</span>&nbsp;<span class="op" id="4122931">=</span>&nbsp;<span class="ident" id="4122933">marshalPublicKey</span><span class="op" id="4122949">(</span><span class="op" id="4122950">&amp;</span><span class="ident" id="4122951">priv</span><span class="op" id="4122955">.</span><span class="ident" id="4122956">PublicKey</span><span class="op" id="4122965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4122968">default</span><span class="op" id="4122975">:</span><br>
<span class="lineno">1695</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4122979">panic</span><span class="op" id="4122984">(</span><span class="string" id="4122985">&#34;internal&nbsp;error&#34;</span><span class="op" id="4123001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4123004">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4123008">if</span>&nbsp;<span class="ident" id="4123011">err</span>&nbsp;<span class="op" id="4123015">!=</span>&nbsp;<span class="ident" id="4123018">nil</span>&nbsp;<span class="op" id="4123022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4123026">return</span>&nbsp;<span class="ident" id="4123033">nil</span><span class="op" id="4123036">,</span>&nbsp;<span class="ident" id="4123038">err</span><br>
<span class="lineno">1700</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4123043">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4123047">var</span>&nbsp;<span class="ident" id="4123051">extensions</span>&nbsp;<span class="op" id="4123062">[</span><span class="op" id="4123063">]</span><span class="ident" id="4123064">pkix</span><span class="op" id="4123068">.</span><span class="ident" id="4123069">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4123081">if</span>&nbsp;<span class="op" id="4123084">(</span><span class="builtinfunc" id="4123085">len</span><span class="op" id="4123088">(</span><span class="ident" id="4123089">template</span><span class="op" id="4123097">.</span><span class="ident" id="4123098">DNSNames</span><span class="op" id="4123106">)</span>&nbsp;<span class="op" id="4123108">&gt;</span>&nbsp;<span class="num" id="4123110">0</span>&nbsp;<span class="op" id="4123112">||</span>&nbsp;<span class="builtinfunc" id="4123115">len</span><span class="op" id="4123118">(</span><span class="ident" id="4123119">template</span><span class="op" id="4123127">.</span><span class="ident" id="4123128">EmailAddresses</span><span class="op" id="4123142">)</span>&nbsp;<span class="op" id="4123144">&gt;</span>&nbsp;<span class="num" id="4123146">0</span>&nbsp;<span class="op" id="4123148">||</span>&nbsp;<span class="builtinfunc" id="4123151">len</span><span class="op" id="4123154">(</span><span class="ident" id="4123155">template</span><span class="op" id="4123163">.</span><span class="ident" id="4123164">IPAddresses</span><span class="op" id="4123175">)</span>&nbsp;<span class="op" id="4123177">&gt;</span>&nbsp;<span class="num" id="4123179">0</span><span class="op" id="4123180">)</span>&nbsp;<span class="op" id="4123182">&amp;&amp;</span><br>
<span class="lineno">1705</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4123187">!</span><span class="ident" id="4123188">oidInExtensions</span><span class="op" id="4123203">(</span><span class="ident" id="4123204">oidExtensionSubjectAltName</span><span class="op" id="4123230">,</span>&nbsp;<span class="ident" id="4123232">template</span><span class="op" id="4123240">.</span><span class="ident" id="4123241">ExtraExtensions</span><span class="op" id="4123256">)</span>&nbsp;<span class="op" id="4123258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4123262">sanBytes</span><span class="op" id="4123270">,</span>&nbsp;<span class="ident" id="4123272">err</span>&nbsp;<span class="op" id="4123276">:=</span>&nbsp;<span class="ident" id="4123279">marshalSANs</span><span class="op" id="4123290">(</span><span class="ident" id="4123291">template</span><span class="op" id="4123299">.</span><span class="ident" id="4123300">DNSNames</span><span class="op" id="4123308">,</span>&nbsp;<span class="ident" id="4123310">template</span><span class="op" id="4123318">.</span><span class="ident" id="4123319">EmailAddresses</span><span class="op" id="4123333">,</span>&nbsp;<span class="ident" id="4123335">template</span><span class="op" id="4123343">.</span><span class="ident" id="4123344">IPAddresses</span><span class="op" id="4123355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4123359">if</span>&nbsp;<span class="ident" id="4123362">err</span>&nbsp;<span class="op" id="4123366">!=</span>&nbsp;<span class="ident" id="4123369">nil</span>&nbsp;<span class="op" id="4123373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4123378">return</span>&nbsp;<span class="ident" id="4123385">nil</span><span class="op" id="4123388">,</span>&nbsp;<span class="ident" id="4123390">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4123396">}</span><br>
<span class="lineno">1710</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4123401">extensions</span>&nbsp;<span class="op" id="4123412">=</span>&nbsp;<span class="builtinfunc" id="4123414">append</span><span class="op" id="4123420">(</span><span class="ident" id="4123421">extensions</span><span class="op" id="4123431">,</span>&nbsp;<span class="ident" id="4123433">pkix</span><span class="op" id="4123437">.</span><span class="ident" id="4123438">Extension</span><span class="op" id="4123447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4123452">Id</span><span class="op" id="4123454">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4123459">oidExtensionSubjectAltName</span><span class="op" id="4123485">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4123490">Value</span><span class="op" id="4123495">:</span>&nbsp;<span class="ident" id="4123497">sanBytes</span><span class="op" id="4123505">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4123509">}</span><span class="op" id="4123510">)</span><br>
<span class="lineno">1715</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4123513">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4123517">extensions</span>&nbsp;<span class="op" id="4123528">=</span>&nbsp;<span class="builtinfunc" id="4123530">append</span><span class="op" id="4123536">(</span><span class="ident" id="4123537">extensions</span><span class="op" id="4123547">,</span>&nbsp;<span class="ident" id="4123549">template</span><span class="op" id="4123557">.</span><span class="ident" id="4123558">ExtraExtensions</span><span class="op" id="4123573">...</span><span class="op" id="4123576">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4123580">var</span>&nbsp;<span class="ident" id="4123584">attributes</span>&nbsp;<span class="op" id="4123595">[</span><span class="op" id="4123596">]</span><span class="ident" id="4123597">pkix</span><span class="op" id="4123601">.</span><span class="ident" id="4123602">AttributeTypeAndValueSET</span><br>
<span class="lineno">1720</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4123628">attributes</span>&nbsp;<span class="op" id="4123639">=</span>&nbsp;<span class="builtinfunc" id="4123641">append</span><span class="op" id="4123647">(</span><span class="ident" id="4123648">attributes</span><span class="op" id="4123658">,</span>&nbsp;<span class="ident" id="4123660">template</span><span class="op" id="4123668">.</span><span class="ident" id="4123669">Attributes</span><span class="op" id="4123679">...</span><span class="op" id="4123682">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4123686">if</span>&nbsp;<span class="builtinfunc" id="4123689">len</span><span class="op" id="4123692">(</span><span class="ident" id="4123693">extensions</span><span class="op" id="4123703">)</span>&nbsp;<span class="op" id="4123705">&gt;</span>&nbsp;<span class="num" id="4123707">0</span>&nbsp;<span class="op" id="4123709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4123713">//&nbsp;specifiedExtensions&nbsp;contains&nbsp;all&nbsp;the&nbsp;extensions&nbsp;that&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4123774">//&nbsp;found&nbsp;specified&nbsp;via&nbsp;template.Attributes.</span><br>
<span class="lineno">1725</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4123820">specifiedExtensions</span>&nbsp;<span class="op" id="4123840">:=</span>&nbsp;<span class="builtinfunc" id="4123843">make</span><span class="op" id="4123847">(</span><span class="keyword" id="4123848">map</span><span class="op" id="4123851">[</span><span class="builtintype" id="4123852">string</span><span class="op" id="4123858">]</span><span class="builtintype" id="4123859">bool</span><span class="op" id="4123863">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4123868">for</span>&nbsp;<span class="ident" id="4123872">_</span><span class="op" id="4123873">,</span>&nbsp;<span class="ident" id="4123875">atvSet</span>&nbsp;<span class="op" id="4123882">:=</span>&nbsp;<span class="keyword" id="4123885">range</span>&nbsp;<span class="ident" id="4123891">template</span><span class="op" id="4123899">.</span><span class="ident" id="4123900">Attributes</span>&nbsp;<span class="op" id="4123911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4123916">if</span>&nbsp;<span class="op" id="4123919">!</span><span class="ident" id="4123920">atvSet</span><span class="op" id="4123926">.</span><span class="ident" id="4123927">Type</span><span class="op" id="4123931">.</span><span class="ident" id="4123932">Equal</span><span class="op" id="4123937">(</span><span class="ident" id="4123938">oidExtensionRequest</span><span class="op" id="4123957">)</span>&nbsp;<span class="op" id="4123959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4123965">continue</span><br>
<span class="lineno">1730</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4123977">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4123983">for</span>&nbsp;<span class="ident" id="4123987">_</span><span class="op" id="4123988">,</span>&nbsp;<span class="ident" id="4123990">atvs</span>&nbsp;<span class="op" id="4123995">:=</span>&nbsp;<span class="keyword" id="4123998">range</span>&nbsp;<span class="ident" id="4124004">atvSet</span><span class="op" id="4124010">.</span><span class="ident" id="4124011">Value</span>&nbsp;<span class="op" id="4124017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4124023">for</span>&nbsp;<span class="ident" id="4124027">_</span><span class="op" id="4124028">,</span>&nbsp;<span class="ident" id="4124030">atv</span>&nbsp;<span class="op" id="4124034">:=</span>&nbsp;<span class="keyword" id="4124037">range</span>&nbsp;<span class="ident" id="4124043">atvs</span>&nbsp;<span class="op" id="4124048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4124055">specifiedExtensions</span><span class="op" id="4124074">[</span><span class="ident" id="4124075">atv</span><span class="op" id="4124078">.</span><span class="ident" id="4124079">Type</span><span class="op" id="4124083">.</span><span class="ident" id="4124084">String</span><span class="op" id="4124090">(</span><span class="op" id="4124091">)</span><span class="op" id="4124092">]</span>&nbsp;<span class="op" id="4124094">=</span>&nbsp;<span class="builtintype" id="4124096">true</span><br>
<span class="lineno">1735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4124105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4124110">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4124114">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4124119">atvs</span>&nbsp;<span class="op" id="4124124">:=</span>&nbsp;<span class="builtinfunc" id="4124127">make</span><span class="op" id="4124131">(</span><span class="op" id="4124132">[</span><span class="op" id="4124133">]</span><span class="ident" id="4124134">pkix</span><span class="op" id="4124138">.</span><span class="ident" id="4124139">AttributeTypeAndValue</span><span class="op" id="4124160">,</span>&nbsp;<span class="num" id="4124162">0</span><span class="op" id="4124163">,</span>&nbsp;<span class="builtinfunc" id="4124165">len</span><span class="op" id="4124168">(</span><span class="ident" id="4124169">extensions</span><span class="op" id="4124179">)</span><span class="op" id="4124180">)</span><br>
<span class="lineno">1740</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4124184">for</span>&nbsp;<span class="ident" id="4124188">_</span><span class="op" id="4124189">,</span>&nbsp;<span class="ident" id="4124191">e</span>&nbsp;<span class="op" id="4124193">:=</span>&nbsp;<span class="keyword" id="4124196">range</span>&nbsp;<span class="ident" id="4124202">extensions</span>&nbsp;<span class="op" id="4124213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4124218">if</span>&nbsp;<span class="ident" id="4124221">specifiedExtensions</span><span class="op" id="4124240">[</span><span class="ident" id="4124241">e</span><span class="op" id="4124242">.</span><span class="ident" id="4124243">Id</span><span class="op" id="4124245">.</span><span class="ident" id="4124246">String</span><span class="op" id="4124252">(</span><span class="op" id="4124253">)</span><span class="op" id="4124254">]</span>&nbsp;<span class="op" id="4124256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4124262">//&nbsp;Attributes&nbsp;already&nbsp;contained&nbsp;a&nbsp;value&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4124310">//&nbsp;this&nbsp;extension&nbsp;and&nbsp;it&nbsp;takes&nbsp;priority.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4124355">continue</span><br>
<span class="lineno">1745</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4124367">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4124373">atvs</span>&nbsp;<span class="op" id="4124378">=</span>&nbsp;<span class="builtinfunc" id="4124380">append</span><span class="op" id="4124386">(</span><span class="ident" id="4124387">atvs</span><span class="op" id="4124391">,</span>&nbsp;<span class="ident" id="4124393">pkix</span><span class="op" id="4124397">.</span><span class="ident" id="4124398">AttributeTypeAndValue</span><span class="op" id="4124419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4124425">//&nbsp;There&nbsp;is&nbsp;no&nbsp;place&nbsp;for&nbsp;the&nbsp;critical&nbsp;flag&nbsp;in&nbsp;a&nbsp;CSR.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4124482">Type</span><span class="op" id="4124486">:</span>&nbsp;&nbsp;<span class="ident" id="4124489">e</span><span class="op" id="4124490">.</span><span class="ident" id="4124491">Id</span><span class="op" id="4124493">,</span><br>
<span class="lineno">1750</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4124499">Value</span><span class="op" id="4124504">:</span>&nbsp;<span class="ident" id="4124506">e</span><span class="op" id="4124507">.</span><span class="ident" id="4124508">Value</span><span class="op" id="4124513">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4124518">}</span><span class="op" id="4124519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4124523">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4124528">//&nbsp;Append&nbsp;the&nbsp;extensions&nbsp;to&nbsp;an&nbsp;existing&nbsp;attribute&nbsp;if&nbsp;possible.</span><br>
<span class="lineno">1755</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4124593">appended</span>&nbsp;<span class="op" id="4124602">:=</span>&nbsp;<span class="builtintype" id="4124605">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4124613">for</span>&nbsp;<span class="ident" id="4124617">_</span><span class="op" id="4124618">,</span>&nbsp;<span class="ident" id="4124620">atvSet</span>&nbsp;<span class="op" id="4124627">:=</span>&nbsp;<span class="keyword" id="4124630">range</span>&nbsp;<span class="ident" id="4124636">attributes</span>&nbsp;<span class="op" id="4124647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4124652">if</span>&nbsp;<span class="op" id="4124655">!</span><span class="ident" id="4124656">atvSet</span><span class="op" id="4124662">.</span><span class="ident" id="4124663">Type</span><span class="op" id="4124667">.</span><span class="ident" id="4124668">Equal</span><span class="op" id="4124673">(</span><span class="ident" id="4124674">oidExtensionRequest</span><span class="op" id="4124693">)</span>&nbsp;<span class="op" id="4124695">||</span>&nbsp;<span class="builtinfunc" id="4124698">len</span><span class="op" id="4124701">(</span><span class="ident" id="4124702">atvSet</span><span class="op" id="4124708">.</span><span class="ident" id="4124709">Value</span><span class="op" id="4124714">)</span>&nbsp;<span class="op" id="4124716">==</span>&nbsp;<span class="num" id="4124719">0</span>&nbsp;<span class="op" id="4124721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4124727">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4124739">}</span><br>
<span class="lineno">1760</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4124745">atvSet</span><span class="op" id="4124751">.</span><span class="ident" id="4124752">Value</span><span class="op" id="4124757">[</span><span class="num" id="4124758">0</span><span class="op" id="4124759">]</span>&nbsp;<span class="op" id="4124761">=</span>&nbsp;<span class="builtinfunc" id="4124763">append</span><span class="op" id="4124769">(</span><span class="ident" id="4124770">atvSet</span><span class="op" id="4124776">.</span><span class="ident" id="4124777">Value</span><span class="op" id="4124782">[</span><span class="num" id="4124783">0</span><span class="op" id="4124784">]</span><span class="op" id="4124785">,</span>&nbsp;<span class="ident" id="4124787">atvs</span><span class="op" id="4124791">...</span><span class="op" id="4124794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4124799">appended</span>&nbsp;<span class="op" id="4124808">=</span>&nbsp;<span class="builtintype" id="4124810">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4124818">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4124826">}</span><br>
<span class="lineno">1765</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4124831">//&nbsp;Otherwise,&nbsp;add&nbsp;a&nbsp;new&nbsp;attribute&nbsp;for&nbsp;the&nbsp;extensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4124887">if</span>&nbsp;<span class="op" id="4124890">!</span><span class="ident" id="4124891">appended</span>&nbsp;<span class="op" id="4124900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4124905">attributes</span>&nbsp;<span class="op" id="4124916">=</span>&nbsp;<span class="builtinfunc" id="4124918">append</span><span class="op" id="4124924">(</span><span class="ident" id="4124925">attributes</span><span class="op" id="4124935">,</span>&nbsp;<span class="ident" id="4124937">pkix</span><span class="op" id="4124941">.</span><span class="ident" id="4124942">AttributeTypeAndValueSET</span><span class="op" id="4124966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4124972">Type</span><span class="op" id="4124976">:</span>&nbsp;<span class="ident" id="4124978">oidExtensionRequest</span><span class="op" id="4124997">,</span><br>
<span class="lineno">1770</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4125003">Value</span><span class="op" id="4125008">:</span>&nbsp;<span class="op" id="4125010">[</span><span class="op" id="4125011">]</span><span class="op" id="4125012">[</span><span class="op" id="4125013">]</span><span class="ident" id="4125014">pkix</span><span class="op" id="4125018">.</span><span class="ident" id="4125019">AttributeTypeAndValue</span><span class="op" id="4125040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4125047">atvs</span><span class="op" id="4125051">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4125057">}</span><span class="op" id="4125058">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4125063">}</span><span class="op" id="4125064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4125068">}</span><br>
<span class="lineno">1775</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4125071">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4125075">asn1Subject</span>&nbsp;<span class="op" id="4125087">:=</span>&nbsp;<span class="ident" id="4125090">template</span><span class="op" id="4125098">.</span><span class="ident" id="4125099">RawSubject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4125111">if</span>&nbsp;<span class="builtinfunc" id="4125114">len</span><span class="op" id="4125117">(</span><span class="ident" id="4125118">asn1Subject</span><span class="op" id="4125129">)</span>&nbsp;<span class="op" id="4125131">==</span>&nbsp;<span class="num" id="4125134">0</span>&nbsp;<span class="op" id="4125136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4125140">asn1Subject</span><span class="op" id="4125151">,</span>&nbsp;<span class="ident" id="4125153">err</span>&nbsp;<span class="op" id="4125157">=</span>&nbsp;<span class="ident" id="4125159">asn1</span><span class="op" id="4125163">.</span><span class="ident" id="4125164">Marshal</span><span class="op" id="4125171">(</span><span class="ident" id="4125172">template</span><span class="op" id="4125180">.</span><span class="ident" id="4125181">Subject</span><span class="op" id="4125188">.</span><span class="ident" id="4125189">ToRDNSequence</span><span class="op" id="4125202">(</span><span class="op" id="4125203">)</span><span class="op" id="4125204">)</span><br>
<span class="lineno">1780</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4125208">if</span>&nbsp;<span class="ident" id="4125211">err</span>&nbsp;<span class="op" id="4125215">!=</span>&nbsp;<span class="ident" id="4125218">nil</span>&nbsp;<span class="op" id="4125222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4125227">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4125236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4125239">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1785</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4125243">tbsCSR</span>&nbsp;<span class="op" id="4125250">:=</span>&nbsp;<span class="ident" id="4125253">tbsCertificateRequest</span><span class="op" id="4125274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4125278">Version</span><span class="op" id="4125285">:</span>&nbsp;<span class="num" id="4125287">0</span><span class="op" id="4125288">,</span>&nbsp;<span class="comment" id="4125290">//&nbsp;PKCS&nbsp;#10,&nbsp;RFC&nbsp;2986</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4125314">Subject</span><span class="op" id="4125321">:</span>&nbsp;<span class="ident" id="4125323">asn1</span><span class="op" id="4125327">.</span><span class="ident" id="4125328">RawValue</span><span class="op" id="4125336">{</span><span class="ident" id="4125337">FullBytes</span><span class="op" id="4125346">:</span>&nbsp;<span class="ident" id="4125348">asn1Subject</span><span class="op" id="4125359">}</span><span class="op" id="4125360">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4125364">PublicKey</span><span class="op" id="4125373">:</span>&nbsp;<span class="ident" id="4125375">publicKeyInfo</span><span class="op" id="4125388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4125393">Algorithm</span><span class="op" id="4125402">:</span>&nbsp;<span class="ident" id="4125404">publicKeyAlgorithm</span><span class="op" id="4125422">,</span><br>
<span class="lineno">1790</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4125427">PublicKey</span><span class="op" id="4125436">:</span>&nbsp;<span class="ident" id="4125438">asn1</span><span class="op" id="4125442">.</span><span class="ident" id="4125443">BitString</span><span class="op" id="4125452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4125458">Bytes</span><span class="op" id="4125463">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4125469">publicKeyBytes</span><span class="op" id="4125483">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4125489">BitLength</span><span class="op" id="4125498">:</span>&nbsp;<span class="builtinfunc" id="4125500">len</span><span class="op" id="4125503">(</span><span class="ident" id="4125504">publicKeyBytes</span><span class="op" id="4125518">)</span>&nbsp;<span class="op" id="4125520">*</span>&nbsp;<span class="num" id="4125522">8</span><span class="op" id="4125523">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4125528">}</span><span class="op" id="4125529">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4125533">}</span><span class="op" id="4125534">,</span><br>
<span class="lineno">1795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4125538">Attributes</span><span class="op" id="4125548">:</span>&nbsp;<span class="ident" id="4125550">attributes</span><span class="op" id="4125560">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4125563">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4125567">tbsCSRContents</span><span class="op" id="4125581">,</span>&nbsp;<span class="ident" id="4125583">err</span>&nbsp;<span class="op" id="4125587">:=</span>&nbsp;<span class="ident" id="4125590">asn1</span><span class="op" id="4125594">.</span><span class="ident" id="4125595">Marshal</span><span class="op" id="4125602">(</span><span class="ident" id="4125603">tbsCSR</span><span class="op" id="4125609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4125612">if</span>&nbsp;<span class="ident" id="4125615">err</span>&nbsp;<span class="op" id="4125619">!=</span>&nbsp;<span class="ident" id="4125622">nil</span>&nbsp;<span class="op" id="4125626">{</span><br>
<span class="lineno">1800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4125630">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4125638">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4125641">tbsCSR</span><span class="op" id="4125647">.</span><span class="ident" id="4125648">Raw</span>&nbsp;<span class="op" id="4125652">=</span>&nbsp;<span class="ident" id="4125654">tbsCSRContents</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4125671">h</span>&nbsp;<span class="op" id="4125673">:=</span>&nbsp;<span class="ident" id="4125676">hashFunc</span><span class="op" id="4125684">.</span><span class="ident" id="4125685">New</span><span class="op" id="4125688">(</span><span class="op" id="4125689">)</span><br>
<span class="lineno">1805</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4125692">h</span><span class="op" id="4125693">.</span><span class="ident" id="4125694">Write</span><span class="op" id="4125699">(</span><span class="ident" id="4125700">tbsCSRContents</span><span class="op" id="4125714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4125717">digest</span>&nbsp;<span class="op" id="4125724">:=</span>&nbsp;<span class="ident" id="4125727">h</span><span class="op" id="4125728">.</span><span class="ident" id="4125729">Sum</span><span class="op" id="4125732">(</span><span class="ident" id="4125733">nil</span><span class="op" id="4125736">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4125740">var</span>&nbsp;<span class="ident" id="4125744">signature</span>&nbsp;<span class="op" id="4125754">[</span><span class="op" id="4125755">]</span><span class="builtintype" id="4125756">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4125762">switch</span>&nbsp;<span class="ident" id="4125769">priv</span>&nbsp;<span class="op" id="4125774">:=</span>&nbsp;<span class="ident" id="4125777">priv</span><span class="op" id="4125781">.</span><span class="op" id="4125782">(</span><span class="keyword" id="4125783">type</span><span class="op" id="4125787">)</span>&nbsp;<span class="op" id="4125789">{</span><br>
<span class="lineno">1810</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4125792">case</span>&nbsp;<span class="op" id="4125797">*</span><span class="ident" id="4125798">rsa</span><span class="op" id="4125801">.</span><span class="ident" id="4125802">PrivateKey</span><span class="op" id="4125812">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4125816">signature</span><span class="op" id="4125825">,</span>&nbsp;<span class="ident" id="4125827">err</span>&nbsp;<span class="op" id="4125831">=</span>&nbsp;<span class="ident" id="4125833">rsa</span><span class="op" id="4125836">.</span><span class="ident" id="4125837">SignPKCS1v15</span><span class="op" id="4125849">(</span><span class="ident" id="4125850">rand</span><span class="op" id="4125854">,</span>&nbsp;<span class="ident" id="4125856">priv</span><span class="op" id="4125860">,</span>&nbsp;<span class="ident" id="4125862">hashFunc</span><span class="op" id="4125870">,</span>&nbsp;<span class="ident" id="4125872">digest</span><span class="op" id="4125878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4125881">case</span>&nbsp;<span class="op" id="4125886">*</span><span class="ident" id="4125887">ecdsa</span><span class="op" id="4125892">.</span><span class="ident" id="4125893">PrivateKey</span><span class="op" id="4125903">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4125907">var</span>&nbsp;<span class="ident" id="4125911">r</span><span class="op" id="4125912">,</span>&nbsp;<span class="ident" id="4125914">s</span>&nbsp;<span class="op" id="4125916">*</span><span class="ident" id="4125917">big</span><span class="op" id="4125920">.</span><span class="ident" id="4125921">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4125927">if</span>&nbsp;<span class="ident" id="4125930">r</span><span class="op" id="4125931">,</span>&nbsp;<span class="ident" id="4125933">s</span><span class="op" id="4125934">,</span>&nbsp;<span class="ident" id="4125936">err</span>&nbsp;<span class="op" id="4125940">=</span>&nbsp;<span class="ident" id="4125942">ecdsa</span><span class="op" id="4125947">.</span><span class="ident" id="4125948">Sign</span><span class="op" id="4125952">(</span><span class="ident" id="4125953">rand</span><span class="op" id="4125957">,</span>&nbsp;<span class="ident" id="4125959">priv</span><span class="op" id="4125963">,</span>&nbsp;<span class="ident" id="4125965">digest</span><span class="op" id="4125971">)</span><span class="op" id="4125972">;</span>&nbsp;<span class="ident" id="4125974">err</span>&nbsp;<span class="op" id="4125978">==</span>&nbsp;<span class="ident" id="4125981">nil</span>&nbsp;<span class="op" id="4125985">{</span><br>
<span class="lineno">1815</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4125990">signature</span><span class="op" id="4125999">,</span>&nbsp;<span class="ident" id="4126001">err</span>&nbsp;<span class="op" id="4126005">=</span>&nbsp;<span class="ident" id="4126007">asn1</span><span class="op" id="4126011">.</span><span class="ident" id="4126012">Marshal</span><span class="op" id="4126019">(</span><span class="ident" id="4126020">ecdsaSignature</span><span class="op" id="4126034">{</span><span class="ident" id="4126035">r</span><span class="op" id="4126036">,</span>&nbsp;<span class="ident" id="4126038">s</span><span class="op" id="4126039">}</span><span class="op" id="4126040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4126044">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4126047">default</span><span class="op" id="4126054">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4126058">panic</span><span class="op" id="4126063">(</span><span class="string" id="4126064">&#34;internal&nbsp;error&#34;</span><span class="op" id="4126080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4126083">}</span><br>
<span class="lineno">1820</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4126087">if</span>&nbsp;<span class="ident" id="4126090">err</span>&nbsp;<span class="op" id="4126094">!=</span>&nbsp;<span class="ident" id="4126097">nil</span>&nbsp;<span class="op" id="4126101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4126105">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4126113">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1825</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4126117">return</span>&nbsp;<span class="ident" id="4126124">asn1</span><span class="op" id="4126128">.</span><span class="ident" id="4126129">Marshal</span><span class="op" id="4126136">(</span><span class="ident" id="4126137">certificateRequest</span><span class="op" id="4126155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4126159">TBSCSR</span><span class="op" id="4126165">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4126179">tbsCSR</span><span class="op" id="4126185">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4126189">SignatureAlgorithm</span><span class="op" id="4126207">:</span>&nbsp;<span class="ident" id="4126209">sigAlgo</span><span class="op" id="4126216">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4126220">SignatureValue</span><span class="op" id="4126234">:</span>&nbsp;<span class="ident" id="4126236">asn1</span><span class="op" id="4126240">.</span><span class="ident" id="4126241">BitString</span><span class="op" id="4126250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4126255">Bytes</span><span class="op" id="4126260">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4126266">signature</span><span class="op" id="4126275">,</span><br>
<span class="lineno">1830</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4126280">BitLength</span><span class="op" id="4126289">:</span>&nbsp;<span class="builtinfunc" id="4126291">len</span><span class="op" id="4126294">(</span><span class="ident" id="4126295">signature</span><span class="op" id="4126304">)</span>&nbsp;<span class="op" id="4126306">*</span>&nbsp;<span class="num" id="4126308">8</span><span class="op" id="4126309">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4126313">}</span><span class="op" id="4126314">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4126317">}</span><span class="op" id="4126318">)</span><br>
<span class="lineno"></span><span class="op" id="4126320">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1835</span><span class="comment" id="4126323">//&nbsp;ParseCertificateRequest&nbsp;parses&nbsp;a&nbsp;single&nbsp;certificate&nbsp;request&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4126395">//&nbsp;given&nbsp;ASN.1&nbsp;DER&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4126420">func</span>&nbsp;<span class="ident" id="4126425">ParseCertificateRequest</span><span class="op" id="4126448">(</span><span class="ident" id="4126449">asn1Data</span>&nbsp;<span class="op" id="4126458">[</span><span class="op" id="4126459">]</span><span class="builtintype" id="4126460">byte</span><span class="op" id="4126464">)</span>&nbsp;<span class="op" id="4126466">(</span><span class="op" id="4126467">*</span><span class="ident" id="4126468">CertificateRequest</span><span class="op" id="4126486">,</span>&nbsp;<span class="builtintype" id="4126488">error</span><span class="op" id="4126493">)</span>&nbsp;<span class="op" id="4126495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4126498">var</span>&nbsp;<span class="ident" id="4126502">csr</span>&nbsp;<span class="ident" id="4126506">certificateRequest</span><br>
<span class="lineno"></span><br>
<span class="lineno">1840</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4126527">rest</span><span class="op" id="4126531">,</span>&nbsp;<span class="ident" id="4126533">err</span>&nbsp;<span class="op" id="4126537">:=</span>&nbsp;<span class="ident" id="4126540">asn1</span><span class="op" id="4126544">.</span><span class="ident" id="4126545">Unmarshal</span><span class="op" id="4126554">(</span><span class="ident" id="4126555">asn1Data</span><span class="op" id="4126563">,</span>&nbsp;<span class="op" id="4126565">&amp;</span><span class="ident" id="4126566">csr</span><span class="op" id="4126569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4126572">if</span>&nbsp;<span class="ident" id="4126575">err</span>&nbsp;<span class="op" id="4126579">!=</span>&nbsp;<span class="ident" id="4126582">nil</span>&nbsp;<span class="op" id="4126586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4126590">return</span>&nbsp;<span class="ident" id="4126597">nil</span><span class="op" id="4126600">,</span>&nbsp;<span class="ident" id="4126602">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4126607">}</span>&nbsp;<span class="keyword" id="4126609">else</span>&nbsp;<span class="keyword" id="4126614">if</span>&nbsp;<span class="builtinfunc" id="4126617">len</span><span class="op" id="4126620">(</span><span class="ident" id="4126621">rest</span><span class="op" id="4126625">)</span>&nbsp;<span class="op" id="4126627">!=</span>&nbsp;<span class="num" id="4126630">0</span>&nbsp;<span class="op" id="4126632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4126636">return</span>&nbsp;<span class="ident" id="4126643">nil</span><span class="op" id="4126646">,</span>&nbsp;<span class="ident" id="4126648">asn1</span><span class="op" id="4126652">.</span><span class="ident" id="4126653">SyntaxError</span><span class="op" id="4126664">{</span><span class="ident" id="4126665">Msg</span><span class="op" id="4126668">:</span>&nbsp;<span class="string" id="4126670">&#34;trailing&nbsp;data&#34;</span><span class="op" id="4126685">}</span><br>
<span class="lineno">1845</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4126688">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4126692">return</span>&nbsp;<span class="ident" id="4126699">parseCertificateRequest</span><span class="op" id="4126722">(</span><span class="op" id="4126723">&amp;</span><span class="ident" id="4126724">csr</span><span class="op" id="4126727">)</span><br>
<span class="lineno"></span><span class="op" id="4126729">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1850</span><span class="keyword" id="4126732">func</span>&nbsp;<span class="ident" id="4126737">parseCertificateRequest</span><span class="op" id="4126760">(</span><span class="ident" id="4126761">in</span>&nbsp;<span class="op" id="4126764">*</span><span class="ident" id="4126765">certificateRequest</span><span class="op" id="4126783">)</span>&nbsp;<span class="op" id="4126785">(</span><span class="op" id="4126786">*</span><span class="ident" id="4126787">CertificateRequest</span><span class="op" id="4126805">,</span>&nbsp;<span class="builtintype" id="4126807">error</span><span class="op" id="4126812">)</span>&nbsp;<span class="op" id="4126814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4126817">out</span>&nbsp;<span class="op" id="4126821">:=</span>&nbsp;<span class="op" id="4126824">&amp;</span><span class="ident" id="4126825">CertificateRequest</span><span class="op" id="4126843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4126847">Raw</span><span class="op" id="4126850">:</span>&nbsp;<span class="ident" id="4126852">in</span><span class="op" id="4126854">.</span><span class="ident" id="4126855">Raw</span><span class="op" id="4126858">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4126862">RawTBSCertificateRequest</span><span class="op" id="4126886">:</span>&nbsp;<span class="ident" id="4126888">in</span><span class="op" id="4126890">.</span><span class="ident" id="4126891">TBSCSR</span><span class="op" id="4126897">.</span><span class="ident" id="4126898">Raw</span><span class="op" id="4126901">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4126905">RawSubjectPublicKeyInfo</span><span class="op" id="4126928">:</span>&nbsp;&nbsp;<span class="ident" id="4126931">in</span><span class="op" id="4126933">.</span><span class="ident" id="4126934">TBSCSR</span><span class="op" id="4126940">.</span><span class="ident" id="4126941">PublicKey</span><span class="op" id="4126950">.</span><span class="ident" id="4126951">Raw</span><span class="op" id="4126954">,</span><br>
<span class="lineno">1855</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4126958">RawSubject</span><span class="op" id="4126968">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4126984">in</span><span class="op" id="4126986">.</span><span class="ident" id="4126987">TBSCSR</span><span class="op" id="4126993">.</span><span class="ident" id="4126994">Subject</span><span class="op" id="4127001">.</span><span class="ident" id="4127002">FullBytes</span><span class="op" id="4127011">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4127016">Signature</span><span class="op" id="4127025">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4127036">in</span><span class="op" id="4127038">.</span><span class="ident" id="4127039">SignatureValue</span><span class="op" id="4127053">.</span><span class="ident" id="4127054">RightAlign</span><span class="op" id="4127064">(</span><span class="op" id="4127065">)</span><span class="op" id="4127066">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4127070">SignatureAlgorithm</span><span class="op" id="4127088">:</span>&nbsp;<span class="ident" id="4127090">getSignatureAlgorithmFromOID</span><span class="op" id="4127118">(</span><span class="ident" id="4127119">in</span><span class="op" id="4127121">.</span><span class="ident" id="4127122">SignatureAlgorithm</span><span class="op" id="4127140">.</span><span class="ident" id="4127141">Algorithm</span><span class="op" id="4127150">)</span><span class="op" id="4127151">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">1860</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4127156">PublicKeyAlgorithm</span><span class="op" id="4127174">:</span>&nbsp;<span class="ident" id="4127176">getPublicKeyAlgorithmFromOID</span><span class="op" id="4127204">(</span><span class="ident" id="4127205">in</span><span class="op" id="4127207">.</span><span class="ident" id="4127208">TBSCSR</span><span class="op" id="4127214">.</span><span class="ident" id="4127215">PublicKey</span><span class="op" id="4127224">.</span><span class="ident" id="4127225">Algorithm</span><span class="op" id="4127234">.</span><span class="ident" id="4127235">Algorithm</span><span class="op" id="4127244">)</span><span class="op" id="4127245">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4127250">Version</span><span class="op" id="4127257">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4127262">in</span><span class="op" id="4127264">.</span><span class="ident" id="4127265">TBSCSR</span><span class="op" id="4127271">.</span><span class="ident" id="4127272">Version</span><span class="op" id="4127279">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4127283">Attributes</span><span class="op" id="4127293">:</span>&nbsp;<span class="ident" id="4127295">in</span><span class="op" id="4127297">.</span><span class="ident" id="4127298">TBSCSR</span><span class="op" id="4127304">.</span><span class="ident" id="4127305">Attributes</span><span class="op" id="4127315">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4127318">}</span><br>
<span class="lineno">1865</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4127322">var</span>&nbsp;<span class="ident" id="4127326">err</span>&nbsp;<span class="builtintype" id="4127330">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4127337">out</span><span class="op" id="4127340">.</span><span class="ident" id="4127341">PublicKey</span><span class="op" id="4127350">,</span>&nbsp;<span class="ident" id="4127352">err</span>&nbsp;<span class="op" id="4127356">=</span>&nbsp;<span class="ident" id="4127358">parsePublicKey</span><span class="op" id="4127372">(</span><span class="ident" id="4127373">out</span><span class="op" id="4127376">.</span><span class="ident" id="4127377">PublicKeyAlgorithm</span><span class="op" id="4127395">,</span>&nbsp;<span class="op" id="4127397">&amp;</span><span class="ident" id="4127398">in</span><span class="op" id="4127400">.</span><span class="ident" id="4127401">TBSCSR</span><span class="op" id="4127407">.</span><span class="ident" id="4127408">PublicKey</span><span class="op" id="4127417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4127420">if</span>&nbsp;<span class="ident" id="4127423">err</span>&nbsp;<span class="op" id="4127427">!=</span>&nbsp;<span class="ident" id="4127430">nil</span>&nbsp;<span class="op" id="4127434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4127438">return</span>&nbsp;<span class="ident" id="4127445">nil</span><span class="op" id="4127448">,</span>&nbsp;<span class="ident" id="4127450">err</span><br>
<span class="lineno">1870</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4127455">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4127459">var</span>&nbsp;<span class="ident" id="4127463">subject</span>&nbsp;<span class="ident" id="4127471">pkix</span><span class="op" id="4127475">.</span><span class="ident" id="4127476">RDNSequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4127489">if</span>&nbsp;<span class="ident" id="4127492">_</span><span class="op" id="4127493">,</span>&nbsp;<span class="ident" id="4127495">err</span>&nbsp;<span class="op" id="4127499">:=</span>&nbsp;<span class="ident" id="4127502">asn1</span><span class="op" id="4127506">.</span><span class="ident" id="4127507">Unmarshal</span><span class="op" id="4127516">(</span><span class="ident" id="4127517">in</span><span class="op" id="4127519">.</span><span class="ident" id="4127520">TBSCSR</span><span class="op" id="4127526">.</span><span class="ident" id="4127527">Subject</span><span class="op" id="4127534">.</span><span class="ident" id="4127535">FullBytes</span><span class="op" id="4127544">,</span>&nbsp;<span class="op" id="4127546">&amp;</span><span class="ident" id="4127547">subject</span><span class="op" id="4127554">)</span><span class="op" id="4127555">;</span>&nbsp;<span class="ident" id="4127557">err</span>&nbsp;<span class="op" id="4127561">!=</span>&nbsp;<span class="ident" id="4127564">nil</span>&nbsp;<span class="op" id="4127568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4127572">return</span>&nbsp;<span class="ident" id="4127579">nil</span><span class="op" id="4127582">,</span>&nbsp;<span class="ident" id="4127584">err</span><br>
<span class="lineno">1875</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4127589">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4127593">out</span><span class="op" id="4127596">.</span><span class="ident" id="4127597">Subject</span><span class="op" id="4127604">.</span><span class="ident" id="4127605">FillFromRDNSequence</span><span class="op" id="4127624">(</span><span class="op" id="4127625">&amp;</span><span class="ident" id="4127626">subject</span><span class="op" id="4127633">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4127637">var</span>&nbsp;<span class="ident" id="4127641">extensions</span>&nbsp;<span class="op" id="4127652">[</span><span class="op" id="4127653">]</span><span class="ident" id="4127654">pkix</span><span class="op" id="4127658">.</span><span class="ident" id="4127659">AttributeTypeAndValue</span><br>
<span class="lineno">1880</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4127683">for</span>&nbsp;<span class="ident" id="4127687">_</span><span class="op" id="4127688">,</span>&nbsp;<span class="ident" id="4127690">atvSet</span>&nbsp;<span class="op" id="4127697">:=</span>&nbsp;<span class="keyword" id="4127700">range</span>&nbsp;<span class="ident" id="4127706">in</span><span class="op" id="4127708">.</span><span class="ident" id="4127709">TBSCSR</span><span class="op" id="4127715">.</span><span class="ident" id="4127716">Attributes</span>&nbsp;<span class="op" id="4127727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4127731">if</span>&nbsp;<span class="op" id="4127734">!</span><span class="ident" id="4127735">atvSet</span><span class="op" id="4127741">.</span><span class="ident" id="4127742">Type</span><span class="op" id="4127746">.</span><span class="ident" id="4127747">Equal</span><span class="op" id="4127752">(</span><span class="ident" id="4127753">oidExtensionRequest</span><span class="op" id="4127772">)</span>&nbsp;<span class="op" id="4127774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4127779">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4127790">}</span><br>
<span class="lineno">1885</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4127795">for</span>&nbsp;<span class="ident" id="4127799">_</span><span class="op" id="4127800">,</span>&nbsp;<span class="ident" id="4127802">atvs</span>&nbsp;<span class="op" id="4127807">:=</span>&nbsp;<span class="keyword" id="4127810">range</span>&nbsp;<span class="ident" id="4127816">atvSet</span><span class="op" id="4127822">.</span><span class="ident" id="4127823">Value</span>&nbsp;<span class="op" id="4127829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4127834">extensions</span>&nbsp;<span class="op" id="4127845">=</span>&nbsp;<span class="builtinfunc" id="4127847">append</span><span class="op" id="4127853">(</span><span class="ident" id="4127854">extensions</span><span class="op" id="4127864">,</span>&nbsp;<span class="ident" id="4127866">atvs</span><span class="op" id="4127870">...</span><span class="op" id="4127873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4127877">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4127880">}</span><br>
<span class="lineno">1890</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4127884">out</span><span class="op" id="4127887">.</span><span class="ident" id="4127888">Extensions</span>&nbsp;<span class="op" id="4127899">=</span>&nbsp;<span class="builtinfunc" id="4127901">make</span><span class="op" id="4127905">(</span><span class="op" id="4127906">[</span><span class="op" id="4127907">]</span><span class="ident" id="4127908">pkix</span><span class="op" id="4127912">.</span><span class="ident" id="4127913">Extension</span><span class="op" id="4127922">,</span>&nbsp;<span class="num" id="4127924">0</span><span class="op" id="4127925">,</span>&nbsp;<span class="builtinfunc" id="4127927">len</span><span class="op" id="4127930">(</span><span class="ident" id="4127931">extensions</span><span class="op" id="4127941">)</span><span class="op" id="4127942">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4127946">for</span>&nbsp;<span class="ident" id="4127950">_</span><span class="op" id="4127951">,</span>&nbsp;<span class="ident" id="4127953">e</span>&nbsp;<span class="op" id="4127955">:=</span>&nbsp;<span class="keyword" id="4127958">range</span>&nbsp;<span class="ident" id="4127964">extensions</span>&nbsp;<span class="op" id="4127975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4127979">value</span><span class="op" id="4127984">,</span>&nbsp;<span class="ident" id="4127986">ok</span>&nbsp;<span class="op" id="4127989">:=</span>&nbsp;<span class="ident" id="4127992">e</span><span class="op" id="4127993">.</span><span class="ident" id="4127994">Value</span><span class="op" id="4127999">.</span><span class="op" id="4128000">(</span><span class="op" id="4128001">[</span><span class="op" id="4128002">]</span><span class="builtintype" id="4128003">byte</span><span class="op" id="4128007">)</span><br>
<span class="lineno">1895</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4128011">if</span>&nbsp;<span class="op" id="4128014">!</span><span class="ident" id="4128015">ok</span>&nbsp;<span class="op" id="4128018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4128023">return</span>&nbsp;<span class="ident" id="4128030">nil</span><span class="op" id="4128033">,</span>&nbsp;<span class="ident" id="4128035">errors</span><span class="op" id="4128041">.</span><span class="ident" id="4128042">New</span><span class="op" id="4128045">(</span><span class="string" id="4128046">&#34;x509:&nbsp;extension&nbsp;attribute&nbsp;contained&nbsp;non-OCTET&nbsp;STRING&nbsp;data&#34;</span><span class="op" id="4128105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4128109">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4128114">out</span><span class="op" id="4128117">.</span><span class="ident" id="4128118">Extensions</span>&nbsp;<span class="op" id="4128129">=</span>&nbsp;<span class="builtinfunc" id="4128131">append</span><span class="op" id="4128137">(</span><span class="ident" id="4128138">out</span><span class="op" id="4128141">.</span><span class="ident" id="4128142">Extensions</span><span class="op" id="4128152">,</span>&nbsp;<span class="ident" id="4128154">pkix</span><span class="op" id="4128158">.</span><span class="ident" id="4128159">Extension</span><span class="op" id="4128168">{</span><br>
<span class="lineno">1900</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4128173">Id</span><span class="op" id="4128175">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4128180">e</span><span class="op" id="4128181">.</span><span class="ident" id="4128182">Type</span><span class="op" id="4128186">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4128191">Value</span><span class="op" id="4128196">:</span>&nbsp;<span class="ident" id="4128198">value</span><span class="op" id="4128203">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4128207">}</span><span class="op" id="4128208">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4128213">if</span>&nbsp;<span class="builtinfunc" id="4128216">len</span><span class="op" id="4128219">(</span><span class="ident" id="4128220">e</span><span class="op" id="4128221">.</span><span class="ident" id="4128222">Type</span><span class="op" id="4128226">)</span>&nbsp;<span class="op" id="4128228">==</span>&nbsp;<span class="num" id="4128231">4</span>&nbsp;<span class="op" id="4128233">&amp;&amp;</span>&nbsp;<span class="ident" id="4128236">e</span><span class="op" id="4128237">.</span><span class="ident" id="4128238">Type</span><span class="op" id="4128242">[</span><span class="num" id="4128243">0</span><span class="op" id="4128244">]</span>&nbsp;<span class="op" id="4128246">==</span>&nbsp;<span class="num" id="4128249">2</span>&nbsp;<span class="op" id="4128251">&amp;&amp;</span>&nbsp;<span class="ident" id="4128254">e</span><span class="op" id="4128255">.</span><span class="ident" id="4128256">Type</span><span class="op" id="4128260">[</span><span class="num" id="4128261">1</span><span class="op" id="4128262">]</span>&nbsp;<span class="op" id="4128264">==</span>&nbsp;<span class="num" id="4128267">5</span>&nbsp;<span class="op" id="4128269">&amp;&amp;</span>&nbsp;<span class="ident" id="4128272">e</span><span class="op" id="4128273">.</span><span class="ident" id="4128274">Type</span><span class="op" id="4128278">[</span><span class="num" id="4128279">2</span><span class="op" id="4128280">]</span>&nbsp;<span class="op" id="4128282">==</span>&nbsp;<span class="num" id="4128285">29</span>&nbsp;<span class="op" id="4128288">{</span><br>
<span class="lineno">1905</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4128293">switch</span>&nbsp;<span class="ident" id="4128300">e</span><span class="op" id="4128301">.</span><span class="ident" id="4128302">Type</span><span class="op" id="4128306">[</span><span class="num" id="4128307">3</span><span class="op" id="4128308">]</span>&nbsp;<span class="op" id="4128310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4128315">case</span>&nbsp;<span class="num" id="4128320">17</span><span class="op" id="4128322">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4128328">out</span><span class="op" id="4128331">.</span><span class="ident" id="4128332">DNSNames</span><span class="op" id="4128340">,</span>&nbsp;<span class="ident" id="4128342">out</span><span class="op" id="4128345">.</span><span class="ident" id="4128346">EmailAddresses</span><span class="op" id="4128360">,</span>&nbsp;<span class="ident" id="4128362">out</span><span class="op" id="4128365">.</span><span class="ident" id="4128366">IPAddresses</span><span class="op" id="4128377">,</span>&nbsp;<span class="ident" id="4128379">err</span>&nbsp;<span class="op" id="4128383">=</span>&nbsp;<span class="ident" id="4128385">parseSANExtension</span><span class="op" id="4128402">(</span><span class="ident" id="4128403">value</span><span class="op" id="4128408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4128414">if</span>&nbsp;<span class="ident" id="4128417">err</span>&nbsp;<span class="op" id="4128421">!=</span>&nbsp;<span class="ident" id="4128424">nil</span>&nbsp;<span class="op" id="4128428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4128435">return</span>&nbsp;<span class="ident" id="4128442">nil</span><span class="op" id="4128445">,</span>&nbsp;<span class="ident" id="4128447">err</span><br>
<span class="lineno">1910</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4128455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4128460">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4128464">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4128467">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1915</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4128471">return</span>&nbsp;<span class="ident" id="4128478">out</span><span class="op" id="4128481">,</span>&nbsp;<span class="ident" id="4128483">nil</span><br>
<span class="lineno"></span><span class="op" id="4128487">}</span>
</div>
</body>
</html>
