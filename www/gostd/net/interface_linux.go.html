<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html" class="current">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3161350">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3161406">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3161460">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3161511">package</span>&nbsp;<span class="ident" id="3161519">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3161524">import</span>&nbsp;<span class="op" id="3161531">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3161534">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3161540">&#34;syscall&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3161551">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="3161560">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3161563">//&nbsp;If&nbsp;the&nbsp;ifindex&nbsp;is&nbsp;zero,&nbsp;interfaceTable&nbsp;returns&nbsp;mappings&nbsp;of&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="3161629">//&nbsp;network&nbsp;interfaces.&nbsp;&nbsp;Otherwise&nbsp;it&nbsp;returns&nbsp;a&nbsp;mapping&nbsp;of&nbsp;a&nbsp;specific</span><br>
<span class="lineno">15</span><span class="comment" id="3161698">//&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="3161712">func</span>&nbsp;<span class="ident" id="3161717">interfaceTable</span><span class="op" id="3161731">(</span><span class="ident" id="3161732">ifindex</span>&nbsp;<span class="builtintype" id="3161740">int</span><span class="op" id="3161743">)</span>&nbsp;<span class="op" id="3161745">(</span><span class="op" id="3161746">[</span><span class="op" id="3161747">]</span><span class="ident" id="3161748">Interface</span><span class="op" id="3161757">,</span>&nbsp;<span class="builtintype" id="3161759">error</span><span class="op" id="3161764">)</span>&nbsp;<span class="op" id="3161766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3161769">tab</span><span class="op" id="3161772">,</span>&nbsp;<span class="ident" id="3161774">err</span>&nbsp;<span class="op" id="3161778">:=</span>&nbsp;<span class="ident" id="3161781">syscall</span><span class="op" id="3161788">.</span><span class="ident" id="3161789">NetlinkRIB</span><span class="op" id="3161799">(</span><span class="ident" id="3161800">syscall</span><span class="op" id="3161807">.</span><span class="ident" id="3161808">RTM_GETLINK</span><span class="op" id="3161819">,</span>&nbsp;<span class="ident" id="3161821">syscall</span><span class="op" id="3161828">.</span><span class="ident" id="3161829">AF_UNSPEC</span><span class="op" id="3161838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3161841">if</span>&nbsp;<span class="ident" id="3161844">err</span>&nbsp;<span class="op" id="3161848">!=</span>&nbsp;<span class="ident" id="3161851">nil</span>&nbsp;<span class="op" id="3161855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3161859">return</span>&nbsp;<span class="ident" id="3161866">nil</span><span class="op" id="3161869">,</span>&nbsp;<span class="ident" id="3161871">os</span><span class="op" id="3161873">.</span><span class="ident" id="3161874">NewSyscallError</span><span class="op" id="3161889">(</span><span class="string" id="3161890">&#34;netlink&nbsp;rib&#34;</span><span class="op" id="3161903">,</span>&nbsp;<span class="ident" id="3161905">err</span><span class="op" id="3161908">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3161911">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3161914">msgs</span><span class="op" id="3161918">,</span>&nbsp;<span class="ident" id="3161920">err</span>&nbsp;<span class="op" id="3161924">:=</span>&nbsp;<span class="ident" id="3161927">syscall</span><span class="op" id="3161934">.</span><span class="ident" id="3161935">ParseNetlinkMessage</span><span class="op" id="3161954">(</span><span class="ident" id="3161955">tab</span><span class="op" id="3161958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3161961">if</span>&nbsp;<span class="ident" id="3161964">err</span>&nbsp;<span class="op" id="3161968">!=</span>&nbsp;<span class="ident" id="3161971">nil</span>&nbsp;<span class="op" id="3161975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3161979">return</span>&nbsp;<span class="ident" id="3161986">nil</span><span class="op" id="3161989">,</span>&nbsp;<span class="ident" id="3161991">os</span><span class="op" id="3161993">.</span><span class="ident" id="3161994">NewSyscallError</span><span class="op" id="3162009">(</span><span class="string" id="3162010">&#34;netlink&nbsp;message&#34;</span><span class="op" id="3162027">,</span>&nbsp;<span class="ident" id="3162029">err</span><span class="op" id="3162032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3162035">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3162038">var</span>&nbsp;<span class="ident" id="3162042">ift</span>&nbsp;<span class="op" id="3162046">[</span><span class="op" id="3162047">]</span><span class="ident" id="3162048">Interface</span><br>
<span class="lineno"></span><span class="ident" id="3162058">loop</span><span class="op" id="3162062">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3162065">for</span>&nbsp;<span class="ident" id="3162069">_</span><span class="op" id="3162070">,</span>&nbsp;<span class="ident" id="3162072">m</span>&nbsp;<span class="op" id="3162074">:=</span>&nbsp;<span class="keyword" id="3162077">range</span>&nbsp;<span class="ident" id="3162083">msgs</span>&nbsp;<span class="op" id="3162088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3162092">switch</span>&nbsp;<span class="ident" id="3162099">m</span><span class="op" id="3162100">.</span><span class="ident" id="3162101">Header</span><span class="op" id="3162107">.</span><span class="ident" id="3162108">Type</span>&nbsp;<span class="op" id="3162113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3162117">case</span>&nbsp;<span class="ident" id="3162122">syscall</span><span class="op" id="3162129">.</span><span class="ident" id="3162130">NLMSG_DONE</span><span class="op" id="3162140">:</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3162145">break</span>&nbsp;<span class="ident" id="3162151">loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3162158">case</span>&nbsp;<span class="ident" id="3162163">syscall</span><span class="op" id="3162170">.</span><span class="ident" id="3162171">RTM_NEWLINK</span><span class="op" id="3162182">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3162187">ifim</span>&nbsp;<span class="op" id="3162192">:=</span>&nbsp;<span class="op" id="3162195">(</span><span class="op" id="3162196">*</span><span class="ident" id="3162197">syscall</span><span class="op" id="3162204">.</span><span class="ident" id="3162205">IfInfomsg</span><span class="op" id="3162214">)</span><span class="op" id="3162215">(</span><span class="ident" id="3162216">unsafe</span><span class="op" id="3162222">.</span><span class="ident" id="3162223">Pointer</span><span class="op" id="3162230">(</span><span class="op" id="3162231">&amp;</span><span class="ident" id="3162232">m</span><span class="op" id="3162233">.</span><span class="ident" id="3162234">Data</span><span class="op" id="3162238">[</span><span class="num" id="3162239">0</span><span class="op" id="3162240">]</span><span class="op" id="3162241">)</span><span class="op" id="3162242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3162247">if</span>&nbsp;<span class="ident" id="3162250">ifindex</span>&nbsp;<span class="op" id="3162258">==</span>&nbsp;<span class="num" id="3162261">0</span>&nbsp;<span class="op" id="3162263">||</span>&nbsp;<span class="ident" id="3162266">ifindex</span>&nbsp;<span class="op" id="3162274">==</span>&nbsp;<span class="builtintype" id="3162277">int</span><span class="op" id="3162280">(</span><span class="ident" id="3162281">ifim</span><span class="op" id="3162285">.</span><span class="ident" id="3162286">Index</span><span class="op" id="3162291">)</span>&nbsp;<span class="op" id="3162293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3162299">attrs</span><span class="op" id="3162304">,</span>&nbsp;<span class="ident" id="3162306">err</span>&nbsp;<span class="op" id="3162310">:=</span>&nbsp;<span class="ident" id="3162313">syscall</span><span class="op" id="3162320">.</span><span class="ident" id="3162321">ParseNetlinkRouteAttr</span><span class="op" id="3162342">(</span><span class="op" id="3162343">&amp;</span><span class="ident" id="3162344">m</span><span class="op" id="3162345">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3162351">if</span>&nbsp;<span class="ident" id="3162354">err</span>&nbsp;<span class="op" id="3162358">!=</span>&nbsp;<span class="ident" id="3162361">nil</span>&nbsp;<span class="op" id="3162365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3162372">return</span>&nbsp;<span class="ident" id="3162379">nil</span><span class="op" id="3162382">,</span>&nbsp;<span class="ident" id="3162384">os</span><span class="op" id="3162386">.</span><span class="ident" id="3162387">NewSyscallError</span><span class="op" id="3162402">(</span><span class="string" id="3162403">&#34;netlink&nbsp;routeattr&#34;</span><span class="op" id="3162422">,</span>&nbsp;<span class="ident" id="3162424">err</span><span class="op" id="3162427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3162433">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3162439">ift</span>&nbsp;<span class="op" id="3162443">=</span>&nbsp;<span class="builtinfunc" id="3162445">append</span><span class="op" id="3162451">(</span><span class="ident" id="3162452">ift</span><span class="op" id="3162455">,</span>&nbsp;<span class="op" id="3162457">*</span><span class="ident" id="3162458">newLink</span><span class="op" id="3162465">(</span><span class="ident" id="3162466">ifim</span><span class="op" id="3162470">,</span>&nbsp;<span class="ident" id="3162472">attrs</span><span class="op" id="3162477">)</span><span class="op" id="3162478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3162484">if</span>&nbsp;<span class="ident" id="3162487">ifindex</span>&nbsp;<span class="op" id="3162495">==</span>&nbsp;<span class="builtintype" id="3162498">int</span><span class="op" id="3162501">(</span><span class="ident" id="3162502">ifim</span><span class="op" id="3162506">.</span><span class="ident" id="3162507">Index</span><span class="op" id="3162512">)</span>&nbsp;<span class="op" id="3162514">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3162521">break</span>&nbsp;<span class="ident" id="3162527">loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3162536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3162541">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3162545">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3162548">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3162551">return</span>&nbsp;<span class="ident" id="3162558">ift</span><span class="op" id="3162561">,</span>&nbsp;<span class="ident" id="3162563">nil</span><br>
<span class="lineno"></span><span class="op" id="3162567">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3162570">const</span>&nbsp;<span class="op" id="3162576">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3162579">//&nbsp;See&nbsp;linux/if_arp.h.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3162603">//&nbsp;Note&nbsp;that&nbsp;Linux&nbsp;doesn&#39;t&nbsp;support&nbsp;IPv4&nbsp;over&nbsp;IPv6&nbsp;tunneling.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3162665">sysARPHardwareIPv4IPv4</span>&nbsp;<span class="op" id="3162688">=</span>&nbsp;<span class="num" id="3162690">768</span>&nbsp;<span class="comment" id="3162694">//&nbsp;IPv4&nbsp;over&nbsp;IPv4&nbsp;tunneling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3162723">sysARPHardwareIPv6IPv6</span>&nbsp;<span class="op" id="3162746">=</span>&nbsp;<span class="num" id="3162748">769</span>&nbsp;<span class="comment" id="3162752">//&nbsp;IPv6&nbsp;over&nbsp;IPv6&nbsp;tunneling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3162781">sysARPHardwareIPv6IPv4</span>&nbsp;<span class="op" id="3162804">=</span>&nbsp;<span class="num" id="3162806">776</span>&nbsp;<span class="comment" id="3162810">//&nbsp;IPv6&nbsp;over&nbsp;IPv4&nbsp;tunneling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3162839">sysARPHardwareGREIPv4</span>&nbsp;&nbsp;<span class="op" id="3162862">=</span>&nbsp;<span class="num" id="3162864">778</span>&nbsp;<span class="comment" id="3162868">//&nbsp;any&nbsp;over&nbsp;GRE&nbsp;over&nbsp;IPv4&nbsp;tunneling</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3162905">sysARPHardwareGREIPv6</span>&nbsp;&nbsp;<span class="op" id="3162928">=</span>&nbsp;<span class="num" id="3162930">823</span>&nbsp;<span class="comment" id="3162934">//&nbsp;any&nbsp;over&nbsp;GRE&nbsp;over&nbsp;IPv6&nbsp;tunneling</span><br>
<span class="lineno"></span><span class="op" id="3162970">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3162973">func</span>&nbsp;<span class="ident" id="3162978">newLink</span><span class="op" id="3162985">(</span><span class="ident" id="3162986">ifim</span>&nbsp;<span class="op" id="3162991">*</span><span class="ident" id="3162992">syscall</span><span class="op" id="3162999">.</span><span class="ident" id="3163000">IfInfomsg</span><span class="op" id="3163009">,</span>&nbsp;<span class="ident" id="3163011">attrs</span>&nbsp;<span class="op" id="3163017">[</span><span class="op" id="3163018">]</span><span class="ident" id="3163019">syscall</span><span class="op" id="3163026">.</span><span class="ident" id="3163027">NetlinkRouteAttr</span><span class="op" id="3163043">)</span>&nbsp;<span class="op" id="3163045">*</span><span class="ident" id="3163046">Interface</span>&nbsp;<span class="op" id="3163056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3163059">ifi</span>&nbsp;<span class="op" id="3163063">:=</span>&nbsp;<span class="op" id="3163066">&amp;</span><span class="ident" id="3163067">Interface</span><span class="op" id="3163076">{</span><span class="ident" id="3163077">Index</span><span class="op" id="3163082">:</span>&nbsp;<span class="builtintype" id="3163084">int</span><span class="op" id="3163087">(</span><span class="ident" id="3163088">ifim</span><span class="op" id="3163092">.</span><span class="ident" id="3163093">Index</span><span class="op" id="3163098">)</span><span class="op" id="3163099">,</span>&nbsp;<span class="ident" id="3163101">Flags</span><span class="op" id="3163106">:</span>&nbsp;<span class="ident" id="3163108">linkFlags</span><span class="op" id="3163117">(</span><span class="ident" id="3163118">ifim</span><span class="op" id="3163122">.</span><span class="ident" id="3163123">Flags</span><span class="op" id="3163128">)</span><span class="op" id="3163129">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3163132">for</span>&nbsp;<span class="ident" id="3163136">_</span><span class="op" id="3163137">,</span>&nbsp;<span class="ident" id="3163139">a</span>&nbsp;<span class="op" id="3163141">:=</span>&nbsp;<span class="keyword" id="3163144">range</span>&nbsp;<span class="ident" id="3163150">attrs</span>&nbsp;<span class="op" id="3163156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3163160">switch</span>&nbsp;<span class="ident" id="3163167">a</span><span class="op" id="3163168">.</span><span class="ident" id="3163169">Attr</span><span class="op" id="3163173">.</span><span class="ident" id="3163174">Type</span>&nbsp;<span class="op" id="3163179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3163183">case</span>&nbsp;<span class="ident" id="3163188">syscall</span><span class="op" id="3163195">.</span><span class="ident" id="3163196">IFLA_ADDRESS</span><span class="op" id="3163208">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3163213">//&nbsp;We&nbsp;never&nbsp;return&nbsp;any&nbsp;/32&nbsp;or&nbsp;/128&nbsp;IP&nbsp;address</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3163262">//&nbsp;prefix&nbsp;on&nbsp;any&nbsp;IP&nbsp;tunnel&nbsp;interface&nbsp;as&nbsp;the</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3163309">//&nbsp;hardware&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3163333">switch</span>&nbsp;<span class="builtinfunc" id="3163340">len</span><span class="op" id="3163343">(</span><span class="ident" id="3163344">a</span><span class="op" id="3163345">.</span><span class="ident" id="3163346">Value</span><span class="op" id="3163351">)</span>&nbsp;<span class="op" id="3163353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3163358">case</span>&nbsp;<span class="ident" id="3163363">IPv4len</span><span class="op" id="3163370">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3163376">switch</span>&nbsp;<span class="ident" id="3163383">ifim</span><span class="op" id="3163387">.</span><span class="ident" id="3163388">Type</span>&nbsp;<span class="op" id="3163393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3163399">case</span>&nbsp;<span class="ident" id="3163404">sysARPHardwareIPv4IPv4</span><span class="op" id="3163426">,</span>&nbsp;<span class="ident" id="3163428">sysARPHardwareGREIPv4</span><span class="op" id="3163449">,</span>&nbsp;<span class="ident" id="3163451">sysARPHardwareIPv6IPv4</span><span class="op" id="3163473">:</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3163480">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3163493">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3163498">case</span>&nbsp;<span class="ident" id="3163503">IPv6len</span><span class="op" id="3163510">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3163516">switch</span>&nbsp;<span class="ident" id="3163523">ifim</span><span class="op" id="3163527">.</span><span class="ident" id="3163528">Type</span>&nbsp;<span class="op" id="3163533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3163539">case</span>&nbsp;<span class="ident" id="3163544">sysARPHardwareIPv6IPv6</span><span class="op" id="3163566">,</span>&nbsp;<span class="ident" id="3163568">sysARPHardwareGREIPv6</span><span class="op" id="3163589">:</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3163596">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3163609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3163614">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3163619">var</span>&nbsp;<span class="ident" id="3163623">nonzero</span>&nbsp;<span class="builtintype" id="3163631">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3163639">for</span>&nbsp;<span class="ident" id="3163643">_</span><span class="op" id="3163644">,</span>&nbsp;<span class="ident" id="3163646">b</span>&nbsp;<span class="op" id="3163648">:=</span>&nbsp;<span class="keyword" id="3163651">range</span>&nbsp;<span class="ident" id="3163657">a</span><span class="op" id="3163658">.</span><span class="ident" id="3163659">Value</span>&nbsp;<span class="op" id="3163665">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3163671">if</span>&nbsp;<span class="ident" id="3163674">b</span>&nbsp;<span class="op" id="3163676">!=</span>&nbsp;<span class="num" id="3163679">0</span>&nbsp;<span class="op" id="3163681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3163688">nonzero</span>&nbsp;<span class="op" id="3163696">=</span>&nbsp;<span class="builtintype" id="3163698">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3163708">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3163718">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3163723">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3163728">if</span>&nbsp;<span class="ident" id="3163731">nonzero</span>&nbsp;<span class="op" id="3163739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3163745">ifi</span><span class="op" id="3163748">.</span><span class="ident" id="3163749">HardwareAddr</span>&nbsp;<span class="op" id="3163762">=</span>&nbsp;<span class="ident" id="3163764">a</span><span class="op" id="3163765">.</span><span class="ident" id="3163766">Value</span><span class="op" id="3163771">[</span><span class="op" id="3163772">:</span><span class="op" id="3163773">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3163778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3163782">case</span>&nbsp;<span class="ident" id="3163787">syscall</span><span class="op" id="3163794">.</span><span class="ident" id="3163795">IFLA_IFNAME</span><span class="op" id="3163806">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3163811">ifi</span><span class="op" id="3163814">.</span><span class="ident" id="3163815">Name</span>&nbsp;<span class="op" id="3163820">=</span>&nbsp;<span class="builtintype" id="3163822">string</span><span class="op" id="3163828">(</span><span class="ident" id="3163829">a</span><span class="op" id="3163830">.</span><span class="ident" id="3163831">Value</span><span class="op" id="3163836">[</span><span class="op" id="3163837">:</span><span class="builtinfunc" id="3163838">len</span><span class="op" id="3163841">(</span><span class="ident" id="3163842">a</span><span class="op" id="3163843">.</span><span class="ident" id="3163844">Value</span><span class="op" id="3163849">)</span><span class="op" id="3163850">-</span><span class="num" id="3163851">1</span><span class="op" id="3163852">]</span><span class="op" id="3163853">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3163857">case</span>&nbsp;<span class="ident" id="3163862">syscall</span><span class="op" id="3163869">.</span><span class="ident" id="3163870">IFLA_MTU</span><span class="op" id="3163878">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3163883">ifi</span><span class="op" id="3163886">.</span><span class="ident" id="3163887">MTU</span>&nbsp;<span class="op" id="3163891">=</span>&nbsp;<span class="builtintype" id="3163893">int</span><span class="op" id="3163896">(</span><span class="op" id="3163897">*</span><span class="op" id="3163898">(</span><span class="op" id="3163899">*</span><span class="builtintype" id="3163900">uint32</span><span class="op" id="3163906">)</span><span class="op" id="3163907">(</span><span class="ident" id="3163908">unsafe</span><span class="op" id="3163914">.</span><span class="ident" id="3163915">Pointer</span><span class="op" id="3163922">(</span><span class="op" id="3163923">&amp;</span><span class="ident" id="3163924">a</span><span class="op" id="3163925">.</span><span class="ident" id="3163926">Value</span><span class="op" id="3163931">[</span><span class="op" id="3163932">:</span><span class="num" id="3163933">4</span><span class="op" id="3163934">]</span><span class="op" id="3163935">[</span><span class="num" id="3163936">0</span><span class="op" id="3163937">]</span><span class="op" id="3163938">)</span><span class="op" id="3163939">)</span><span class="op" id="3163940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3163944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3163947">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3163950">return</span>&nbsp;<span class="ident" id="3163957">ifi</span><br>
<span class="lineno">95</span><span class="op" id="3163961">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3163964">func</span>&nbsp;<span class="ident" id="3163969">linkFlags</span><span class="op" id="3163978">(</span><span class="ident" id="3163979">rawFlags</span>&nbsp;<span class="builtintype" id="3163988">uint32</span><span class="op" id="3163994">)</span>&nbsp;<span class="ident" id="3163996">Flags</span>&nbsp;<span class="op" id="3164002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3164005">var</span>&nbsp;<span class="ident" id="3164009">f</span>&nbsp;<span class="ident" id="3164011">Flags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3164018">if</span>&nbsp;<span class="ident" id="3164021">rawFlags</span><span class="op" id="3164029">&amp;</span><span class="ident" id="3164030">syscall</span><span class="op" id="3164037">.</span><span class="ident" id="3164038">IFF_UP</span>&nbsp;<span class="op" id="3164045">!=</span>&nbsp;<span class="num" id="3164048">0</span>&nbsp;<span class="op" id="3164050">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3164054">f</span>&nbsp;<span class="op" id="3164056">|=</span>&nbsp;<span class="ident" id="3164059">FlagUp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3164067">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3164070">if</span>&nbsp;<span class="ident" id="3164073">rawFlags</span><span class="op" id="3164081">&amp;</span><span class="ident" id="3164082">syscall</span><span class="op" id="3164089">.</span><span class="ident" id="3164090">IFF_BROADCAST</span>&nbsp;<span class="op" id="3164104">!=</span>&nbsp;<span class="num" id="3164107">0</span>&nbsp;<span class="op" id="3164109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3164113">f</span>&nbsp;<span class="op" id="3164115">|=</span>&nbsp;<span class="ident" id="3164118">FlagBroadcast</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3164133">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3164136">if</span>&nbsp;<span class="ident" id="3164139">rawFlags</span><span class="op" id="3164147">&amp;</span><span class="ident" id="3164148">syscall</span><span class="op" id="3164155">.</span><span class="ident" id="3164156">IFF_LOOPBACK</span>&nbsp;<span class="op" id="3164169">!=</span>&nbsp;<span class="num" id="3164172">0</span>&nbsp;<span class="op" id="3164174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3164178">f</span>&nbsp;<span class="op" id="3164180">|=</span>&nbsp;<span class="ident" id="3164183">FlagLoopback</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3164197">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3164200">if</span>&nbsp;<span class="ident" id="3164203">rawFlags</span><span class="op" id="3164211">&amp;</span><span class="ident" id="3164212">syscall</span><span class="op" id="3164219">.</span><span class="ident" id="3164220">IFF_POINTOPOINT</span>&nbsp;<span class="op" id="3164236">!=</span>&nbsp;<span class="num" id="3164239">0</span>&nbsp;<span class="op" id="3164241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3164245">f</span>&nbsp;<span class="op" id="3164247">|=</span>&nbsp;<span class="ident" id="3164250">FlagPointToPoint</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3164268">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3164271">if</span>&nbsp;<span class="ident" id="3164274">rawFlags</span><span class="op" id="3164282">&amp;</span><span class="ident" id="3164283">syscall</span><span class="op" id="3164290">.</span><span class="ident" id="3164291">IFF_MULTICAST</span>&nbsp;<span class="op" id="3164305">!=</span>&nbsp;<span class="num" id="3164308">0</span>&nbsp;<span class="op" id="3164310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3164314">f</span>&nbsp;<span class="op" id="3164316">|=</span>&nbsp;<span class="ident" id="3164319">FlagMulticast</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3164334">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3164337">return</span>&nbsp;<span class="ident" id="3164344">f</span><br>
<span class="lineno">115</span><span class="op" id="3164346">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3164349">//&nbsp;If&nbsp;the&nbsp;ifi&nbsp;is&nbsp;nil,&nbsp;interfaceAddrTable&nbsp;returns&nbsp;addresses&nbsp;for&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="3164416">//&nbsp;network&nbsp;interfaces.&nbsp;&nbsp;Otherwise&nbsp;it&nbsp;returns&nbsp;addresses&nbsp;for&nbsp;a&nbsp;specific</span><br>
<span class="lineno"></span><span class="comment" id="3164486">//&nbsp;interface.</span><br>
<span class="lineno">120</span><span class="keyword" id="3164500">func</span>&nbsp;<span class="ident" id="3164505">interfaceAddrTable</span><span class="op" id="3164523">(</span><span class="ident" id="3164524">ifi</span>&nbsp;<span class="op" id="3164528">*</span><span class="ident" id="3164529">Interface</span><span class="op" id="3164538">)</span>&nbsp;<span class="op" id="3164540">(</span><span class="op" id="3164541">[</span><span class="op" id="3164542">]</span><span class="ident" id="3164543">Addr</span><span class="op" id="3164547">,</span>&nbsp;<span class="builtintype" id="3164549">error</span><span class="op" id="3164554">)</span>&nbsp;<span class="op" id="3164556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3164559">tab</span><span class="op" id="3164562">,</span>&nbsp;<span class="ident" id="3164564">err</span>&nbsp;<span class="op" id="3164568">:=</span>&nbsp;<span class="ident" id="3164571">syscall</span><span class="op" id="3164578">.</span><span class="ident" id="3164579">NetlinkRIB</span><span class="op" id="3164589">(</span><span class="ident" id="3164590">syscall</span><span class="op" id="3164597">.</span><span class="ident" id="3164598">RTM_GETADDR</span><span class="op" id="3164609">,</span>&nbsp;<span class="ident" id="3164611">syscall</span><span class="op" id="3164618">.</span><span class="ident" id="3164619">AF_UNSPEC</span><span class="op" id="3164628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3164631">if</span>&nbsp;<span class="ident" id="3164634">err</span>&nbsp;<span class="op" id="3164638">!=</span>&nbsp;<span class="ident" id="3164641">nil</span>&nbsp;<span class="op" id="3164645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3164649">return</span>&nbsp;<span class="ident" id="3164656">nil</span><span class="op" id="3164659">,</span>&nbsp;<span class="ident" id="3164661">os</span><span class="op" id="3164663">.</span><span class="ident" id="3164664">NewSyscallError</span><span class="op" id="3164679">(</span><span class="string" id="3164680">&#34;netlink&nbsp;rib&#34;</span><span class="op" id="3164693">,</span>&nbsp;<span class="ident" id="3164695">err</span><span class="op" id="3164698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3164701">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3164704">msgs</span><span class="op" id="3164708">,</span>&nbsp;<span class="ident" id="3164710">err</span>&nbsp;<span class="op" id="3164714">:=</span>&nbsp;<span class="ident" id="3164717">syscall</span><span class="op" id="3164724">.</span><span class="ident" id="3164725">ParseNetlinkMessage</span><span class="op" id="3164744">(</span><span class="ident" id="3164745">tab</span><span class="op" id="3164748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3164751">if</span>&nbsp;<span class="ident" id="3164754">err</span>&nbsp;<span class="op" id="3164758">!=</span>&nbsp;<span class="ident" id="3164761">nil</span>&nbsp;<span class="op" id="3164765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3164769">return</span>&nbsp;<span class="ident" id="3164776">nil</span><span class="op" id="3164779">,</span>&nbsp;<span class="ident" id="3164781">os</span><span class="op" id="3164783">.</span><span class="ident" id="3164784">NewSyscallError</span><span class="op" id="3164799">(</span><span class="string" id="3164800">&#34;netlink&nbsp;message&#34;</span><span class="op" id="3164817">,</span>&nbsp;<span class="ident" id="3164819">err</span><span class="op" id="3164822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3164825">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3164828">var</span>&nbsp;<span class="ident" id="3164832">ift</span>&nbsp;<span class="op" id="3164836">[</span><span class="op" id="3164837">]</span><span class="ident" id="3164838">Interface</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3164849">if</span>&nbsp;<span class="ident" id="3164852">ifi</span>&nbsp;<span class="op" id="3164856">==</span>&nbsp;<span class="ident" id="3164859">nil</span>&nbsp;<span class="op" id="3164863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3164867">var</span>&nbsp;<span class="ident" id="3164871">err</span>&nbsp;<span class="builtintype" id="3164875">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3164883">ift</span><span class="op" id="3164886">,</span>&nbsp;<span class="ident" id="3164888">err</span>&nbsp;<span class="op" id="3164892">=</span>&nbsp;<span class="ident" id="3164894">interfaceTable</span><span class="op" id="3164908">(</span><span class="num" id="3164909">0</span><span class="op" id="3164910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3164914">if</span>&nbsp;<span class="ident" id="3164917">err</span>&nbsp;<span class="op" id="3164921">!=</span>&nbsp;<span class="ident" id="3164924">nil</span>&nbsp;<span class="op" id="3164928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3164933">return</span>&nbsp;<span class="ident" id="3164940">nil</span><span class="op" id="3164943">,</span>&nbsp;<span class="ident" id="3164945">err</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3164951">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3164954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3164957">ifat</span><span class="op" id="3164961">,</span>&nbsp;<span class="ident" id="3164963">err</span>&nbsp;<span class="op" id="3164967">:=</span>&nbsp;<span class="ident" id="3164970">addrTable</span><span class="op" id="3164979">(</span><span class="ident" id="3164980">ift</span><span class="op" id="3164983">,</span>&nbsp;<span class="ident" id="3164985">ifi</span><span class="op" id="3164988">,</span>&nbsp;<span class="ident" id="3164990">msgs</span><span class="op" id="3164994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3164997">if</span>&nbsp;<span class="ident" id="3165000">err</span>&nbsp;<span class="op" id="3165004">!=</span>&nbsp;<span class="ident" id="3165007">nil</span>&nbsp;<span class="op" id="3165011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3165015">return</span>&nbsp;<span class="ident" id="3165022">nil</span><span class="op" id="3165025">,</span>&nbsp;<span class="ident" id="3165027">err</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3165032">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3165035">return</span>&nbsp;<span class="ident" id="3165042">ifat</span><span class="op" id="3165046">,</span>&nbsp;<span class="ident" id="3165048">nil</span><br>
<span class="lineno"></span><span class="op" id="3165052">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3165055">func</span>&nbsp;<span class="ident" id="3165060">addrTable</span><span class="op" id="3165069">(</span><span class="ident" id="3165070">ift</span>&nbsp;<span class="op" id="3165074">[</span><span class="op" id="3165075">]</span><span class="ident" id="3165076">Interface</span><span class="op" id="3165085">,</span>&nbsp;<span class="ident" id="3165087">ifi</span>&nbsp;<span class="op" id="3165091">*</span><span class="ident" id="3165092">Interface</span><span class="op" id="3165101">,</span>&nbsp;<span class="ident" id="3165103">msgs</span>&nbsp;<span class="op" id="3165108">[</span><span class="op" id="3165109">]</span><span class="ident" id="3165110">syscall</span><span class="op" id="3165117">.</span><span class="ident" id="3165118">NetlinkMessage</span><span class="op" id="3165132">)</span>&nbsp;<span class="op" id="3165134">(</span><span class="op" id="3165135">[</span><span class="op" id="3165136">]</span><span class="ident" id="3165137">Addr</span><span class="op" id="3165141">,</span>&nbsp;<span class="builtintype" id="3165143">error</span><span class="op" id="3165148">)</span>&nbsp;<span class="op" id="3165150">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3165153">var</span>&nbsp;<span class="ident" id="3165157">ifat</span>&nbsp;<span class="op" id="3165162">[</span><span class="op" id="3165163">]</span><span class="ident" id="3165164">Addr</span><br>
<span class="lineno"></span><span class="ident" id="3165169">loop</span><span class="op" id="3165173">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3165176">for</span>&nbsp;<span class="ident" id="3165180">_</span><span class="op" id="3165181">,</span>&nbsp;<span class="ident" id="3165183">m</span>&nbsp;<span class="op" id="3165185">:=</span>&nbsp;<span class="keyword" id="3165188">range</span>&nbsp;<span class="ident" id="3165194">msgs</span>&nbsp;<span class="op" id="3165199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3165203">switch</span>&nbsp;<span class="ident" id="3165210">m</span><span class="op" id="3165211">.</span><span class="ident" id="3165212">Header</span><span class="op" id="3165218">.</span><span class="ident" id="3165219">Type</span>&nbsp;<span class="op" id="3165224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3165228">case</span>&nbsp;<span class="ident" id="3165233">syscall</span><span class="op" id="3165240">.</span><span class="ident" id="3165241">NLMSG_DONE</span><span class="op" id="3165251">:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3165256">break</span>&nbsp;<span class="ident" id="3165262">loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3165269">case</span>&nbsp;<span class="ident" id="3165274">syscall</span><span class="op" id="3165281">.</span><span class="ident" id="3165282">RTM_NEWADDR</span><span class="op" id="3165293">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3165298">ifam</span>&nbsp;<span class="op" id="3165303">:=</span>&nbsp;<span class="op" id="3165306">(</span><span class="op" id="3165307">*</span><span class="ident" id="3165308">syscall</span><span class="op" id="3165315">.</span><span class="ident" id="3165316">IfAddrmsg</span><span class="op" id="3165325">)</span><span class="op" id="3165326">(</span><span class="ident" id="3165327">unsafe</span><span class="op" id="3165333">.</span><span class="ident" id="3165334">Pointer</span><span class="op" id="3165341">(</span><span class="op" id="3165342">&amp;</span><span class="ident" id="3165343">m</span><span class="op" id="3165344">.</span><span class="ident" id="3165345">Data</span><span class="op" id="3165349">[</span><span class="num" id="3165350">0</span><span class="op" id="3165351">]</span><span class="op" id="3165352">)</span><span class="op" id="3165353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3165358">if</span>&nbsp;<span class="builtinfunc" id="3165361">len</span><span class="op" id="3165364">(</span><span class="ident" id="3165365">ift</span><span class="op" id="3165368">)</span>&nbsp;<span class="op" id="3165370">!=</span>&nbsp;<span class="num" id="3165373">0</span>&nbsp;<span class="op" id="3165375">||</span>&nbsp;<span class="ident" id="3165378">ifi</span><span class="op" id="3165381">.</span><span class="ident" id="3165382">Index</span>&nbsp;<span class="op" id="3165388">==</span>&nbsp;<span class="builtintype" id="3165391">int</span><span class="op" id="3165394">(</span><span class="ident" id="3165395">ifam</span><span class="op" id="3165399">.</span><span class="ident" id="3165400">Index</span><span class="op" id="3165405">)</span>&nbsp;<span class="op" id="3165407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3165413">if</span>&nbsp;<span class="builtinfunc" id="3165416">len</span><span class="op" id="3165419">(</span><span class="ident" id="3165420">ift</span><span class="op" id="3165423">)</span>&nbsp;<span class="op" id="3165425">!=</span>&nbsp;<span class="num" id="3165428">0</span>&nbsp;<span class="op" id="3165430">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3165437">var</span>&nbsp;<span class="ident" id="3165441">err</span>&nbsp;<span class="builtintype" id="3165445">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3165456">ifi</span><span class="op" id="3165459">,</span>&nbsp;<span class="ident" id="3165461">err</span>&nbsp;<span class="op" id="3165465">=</span>&nbsp;<span class="ident" id="3165467">interfaceByIndex</span><span class="op" id="3165483">(</span><span class="ident" id="3165484">ift</span><span class="op" id="3165487">,</span>&nbsp;<span class="builtintype" id="3165489">int</span><span class="op" id="3165492">(</span><span class="ident" id="3165493">ifam</span><span class="op" id="3165497">.</span><span class="ident" id="3165498">Index</span><span class="op" id="3165503">)</span><span class="op" id="3165504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3165511">if</span>&nbsp;<span class="ident" id="3165514">err</span>&nbsp;<span class="op" id="3165518">!=</span>&nbsp;<span class="ident" id="3165521">nil</span>&nbsp;<span class="op" id="3165525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3165533">return</span>&nbsp;<span class="ident" id="3165540">nil</span><span class="op" id="3165543">,</span>&nbsp;<span class="ident" id="3165545">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3165554">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3165560">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3165566">attrs</span><span class="op" id="3165571">,</span>&nbsp;<span class="ident" id="3165573">err</span>&nbsp;<span class="op" id="3165577">:=</span>&nbsp;<span class="ident" id="3165580">syscall</span><span class="op" id="3165587">.</span><span class="ident" id="3165588">ParseNetlinkRouteAttr</span><span class="op" id="3165609">(</span><span class="op" id="3165610">&amp;</span><span class="ident" id="3165611">m</span><span class="op" id="3165612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3165618">if</span>&nbsp;<span class="ident" id="3165621">err</span>&nbsp;<span class="op" id="3165625">!=</span>&nbsp;<span class="ident" id="3165628">nil</span>&nbsp;<span class="op" id="3165632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3165639">return</span>&nbsp;<span class="ident" id="3165646">nil</span><span class="op" id="3165649">,</span>&nbsp;<span class="ident" id="3165651">os</span><span class="op" id="3165653">.</span><span class="ident" id="3165654">NewSyscallError</span><span class="op" id="3165669">(</span><span class="string" id="3165670">&#34;netlink&nbsp;routeattr&#34;</span><span class="op" id="3165689">,</span>&nbsp;<span class="ident" id="3165691">err</span><span class="op" id="3165694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3165700">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3165706">ifa</span>&nbsp;<span class="op" id="3165710">:=</span>&nbsp;<span class="ident" id="3165713">newAddr</span><span class="op" id="3165720">(</span><span class="ident" id="3165721">ifi</span><span class="op" id="3165724">,</span>&nbsp;<span class="ident" id="3165726">ifam</span><span class="op" id="3165730">,</span>&nbsp;<span class="ident" id="3165732">attrs</span><span class="op" id="3165737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3165743">if</span>&nbsp;<span class="ident" id="3165746">ifa</span>&nbsp;<span class="op" id="3165750">!=</span>&nbsp;<span class="ident" id="3165753">nil</span>&nbsp;<span class="op" id="3165757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3165764">ifat</span>&nbsp;<span class="op" id="3165769">=</span>&nbsp;<span class="builtinfunc" id="3165771">append</span><span class="op" id="3165777">(</span><span class="ident" id="3165778">ifat</span><span class="op" id="3165782">,</span>&nbsp;<span class="ident" id="3165784">ifa</span><span class="op" id="3165787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3165793">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3165798">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3165802">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3165805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3165808">return</span>&nbsp;<span class="ident" id="3165815">ifat</span><span class="op" id="3165819">,</span>&nbsp;<span class="ident" id="3165821">nil</span><br>
<span class="lineno"></span><span class="op" id="3165825">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="keyword" id="3165828">func</span>&nbsp;<span class="ident" id="3165833">newAddr</span><span class="op" id="3165840">(</span><span class="ident" id="3165841">ifi</span>&nbsp;<span class="op" id="3165845">*</span><span class="ident" id="3165846">Interface</span><span class="op" id="3165855">,</span>&nbsp;<span class="ident" id="3165857">ifam</span>&nbsp;<span class="op" id="3165862">*</span><span class="ident" id="3165863">syscall</span><span class="op" id="3165870">.</span><span class="ident" id="3165871">IfAddrmsg</span><span class="op" id="3165880">,</span>&nbsp;<span class="ident" id="3165882">attrs</span>&nbsp;<span class="op" id="3165888">[</span><span class="op" id="3165889">]</span><span class="ident" id="3165890">syscall</span><span class="op" id="3165897">.</span><span class="ident" id="3165898">NetlinkRouteAttr</span><span class="op" id="3165914">)</span>&nbsp;<span class="ident" id="3165916">Addr</span>&nbsp;<span class="op" id="3165921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3165924">var</span>&nbsp;<span class="ident" id="3165928">ipPointToPoint</span>&nbsp;<span class="builtintype" id="3165943">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3165949">//&nbsp;Seems&nbsp;like&nbsp;we&nbsp;need&nbsp;to&nbsp;make&nbsp;sure&nbsp;whether&nbsp;the&nbsp;IP&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3166010">//&nbsp;stack&nbsp;consists&nbsp;of&nbsp;IP&nbsp;point-to-point&nbsp;numbered&nbsp;or&nbsp;unnumbered</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3166073">//&nbsp;addressing&nbsp;over&nbsp;point-to-point&nbsp;link&nbsp;encapsulation.</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3166128">if</span>&nbsp;<span class="ident" id="3166131">ifi</span><span class="op" id="3166134">.</span><span class="ident" id="3166135">Flags</span><span class="op" id="3166140">&amp;</span><span class="ident" id="3166141">FlagPointToPoint</span>&nbsp;<span class="op" id="3166158">!=</span>&nbsp;<span class="num" id="3166161">0</span>&nbsp;<span class="op" id="3166163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3166167">for</span>&nbsp;<span class="ident" id="3166171">_</span><span class="op" id="3166172">,</span>&nbsp;<span class="ident" id="3166174">a</span>&nbsp;<span class="op" id="3166176">:=</span>&nbsp;<span class="keyword" id="3166179">range</span>&nbsp;<span class="ident" id="3166185">attrs</span>&nbsp;<span class="op" id="3166191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3166196">if</span>&nbsp;<span class="ident" id="3166199">a</span><span class="op" id="3166200">.</span><span class="ident" id="3166201">Attr</span><span class="op" id="3166205">.</span><span class="ident" id="3166206">Type</span>&nbsp;<span class="op" id="3166211">==</span>&nbsp;<span class="ident" id="3166214">syscall</span><span class="op" id="3166221">.</span><span class="ident" id="3166222">IFA_LOCAL</span>&nbsp;<span class="op" id="3166232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3166238">ipPointToPoint</span>&nbsp;<span class="op" id="3166253">=</span>&nbsp;<span class="builtintype" id="3166255">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3166264">break</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3166273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3166277">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3166280">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3166283">for</span>&nbsp;<span class="ident" id="3166287">_</span><span class="op" id="3166288">,</span>&nbsp;<span class="ident" id="3166290">a</span>&nbsp;<span class="op" id="3166292">:=</span>&nbsp;<span class="keyword" id="3166295">range</span>&nbsp;<span class="ident" id="3166301">attrs</span>&nbsp;<span class="op" id="3166307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3166311">if</span>&nbsp;<span class="ident" id="3166314">ipPointToPoint</span>&nbsp;<span class="op" id="3166329">&amp;&amp;</span>&nbsp;<span class="ident" id="3166332">a</span><span class="op" id="3166333">.</span><span class="ident" id="3166334">Attr</span><span class="op" id="3166338">.</span><span class="ident" id="3166339">Type</span>&nbsp;<span class="op" id="3166344">==</span>&nbsp;<span class="ident" id="3166347">syscall</span><span class="op" id="3166354">.</span><span class="ident" id="3166355">IFA_ADDRESS</span>&nbsp;<span class="op" id="3166367">||</span>&nbsp;<span class="op" id="3166370">!</span><span class="ident" id="3166371">ipPointToPoint</span>&nbsp;<span class="op" id="3166386">&amp;&amp;</span>&nbsp;<span class="ident" id="3166389">a</span><span class="op" id="3166390">.</span><span class="ident" id="3166391">Attr</span><span class="op" id="3166395">.</span><span class="ident" id="3166396">Type</span>&nbsp;<span class="op" id="3166401">==</span>&nbsp;<span class="ident" id="3166404">syscall</span><span class="op" id="3166411">.</span><span class="ident" id="3166412">IFA_LOCAL</span>&nbsp;<span class="op" id="3166422">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3166427">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3166438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3166442">switch</span>&nbsp;<span class="ident" id="3166449">ifam</span><span class="op" id="3166453">.</span><span class="ident" id="3166454">Family</span>&nbsp;<span class="op" id="3166461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3166465">case</span>&nbsp;<span class="ident" id="3166470">syscall</span><span class="op" id="3166477">.</span><span class="ident" id="3166478">AF_INET</span><span class="op" id="3166485">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3166490">return</span>&nbsp;<span class="op" id="3166497">&amp;</span><span class="ident" id="3166498">IPNet</span><span class="op" id="3166503">{</span><span class="ident" id="3166504">IP</span><span class="op" id="3166506">:</span>&nbsp;<span class="ident" id="3166508">IPv4</span><span class="op" id="3166512">(</span><span class="ident" id="3166513">a</span><span class="op" id="3166514">.</span><span class="ident" id="3166515">Value</span><span class="op" id="3166520">[</span><span class="num" id="3166521">0</span><span class="op" id="3166522">]</span><span class="op" id="3166523">,</span>&nbsp;<span class="ident" id="3166525">a</span><span class="op" id="3166526">.</span><span class="ident" id="3166527">Value</span><span class="op" id="3166532">[</span><span class="num" id="3166533">1</span><span class="op" id="3166534">]</span><span class="op" id="3166535">,</span>&nbsp;<span class="ident" id="3166537">a</span><span class="op" id="3166538">.</span><span class="ident" id="3166539">Value</span><span class="op" id="3166544">[</span><span class="num" id="3166545">2</span><span class="op" id="3166546">]</span><span class="op" id="3166547">,</span>&nbsp;<span class="ident" id="3166549">a</span><span class="op" id="3166550">.</span><span class="ident" id="3166551">Value</span><span class="op" id="3166556">[</span><span class="num" id="3166557">3</span><span class="op" id="3166558">]</span><span class="op" id="3166559">)</span><span class="op" id="3166560">,</span>&nbsp;<span class="ident" id="3166562">Mask</span><span class="op" id="3166566">:</span>&nbsp;<span class="ident" id="3166568">CIDRMask</span><span class="op" id="3166576">(</span><span class="builtintype" id="3166577">int</span><span class="op" id="3166580">(</span><span class="ident" id="3166581">ifam</span><span class="op" id="3166585">.</span><span class="ident" id="3166586">Prefixlen</span><span class="op" id="3166595">)</span><span class="op" id="3166596">,</span>&nbsp;<span class="num" id="3166598">8</span><span class="op" id="3166599">*</span><span class="ident" id="3166600">IPv4len</span><span class="op" id="3166607">)</span><span class="op" id="3166608">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3166612">case</span>&nbsp;<span class="ident" id="3166617">syscall</span><span class="op" id="3166624">.</span><span class="ident" id="3166625">AF_INET6</span><span class="op" id="3166633">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3166638">ifa</span>&nbsp;<span class="op" id="3166642">:=</span>&nbsp;<span class="op" id="3166645">&amp;</span><span class="ident" id="3166646">IPNet</span><span class="op" id="3166651">{</span><span class="ident" id="3166652">IP</span><span class="op" id="3166654">:</span>&nbsp;<span class="builtinfunc" id="3166656">make</span><span class="op" id="3166660">(</span><span class="ident" id="3166661">IP</span><span class="op" id="3166663">,</span>&nbsp;<span class="ident" id="3166665">IPv6len</span><span class="op" id="3166672">)</span><span class="op" id="3166673">,</span>&nbsp;<span class="ident" id="3166675">Mask</span><span class="op" id="3166679">:</span>&nbsp;<span class="ident" id="3166681">CIDRMask</span><span class="op" id="3166689">(</span><span class="builtintype" id="3166690">int</span><span class="op" id="3166693">(</span><span class="ident" id="3166694">ifam</span><span class="op" id="3166698">.</span><span class="ident" id="3166699">Prefixlen</span><span class="op" id="3166708">)</span><span class="op" id="3166709">,</span>&nbsp;<span class="num" id="3166711">8</span><span class="op" id="3166712">*</span><span class="ident" id="3166713">IPv6len</span><span class="op" id="3166720">)</span><span class="op" id="3166721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3166726">copy</span><span class="op" id="3166730">(</span><span class="ident" id="3166731">ifa</span><span class="op" id="3166734">.</span><span class="ident" id="3166735">IP</span><span class="op" id="3166737">,</span>&nbsp;<span class="ident" id="3166739">a</span><span class="op" id="3166740">.</span><span class="ident" id="3166741">Value</span><span class="op" id="3166746">[</span><span class="op" id="3166747">:</span><span class="op" id="3166748">]</span><span class="op" id="3166749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3166754">return</span>&nbsp;<span class="ident" id="3166761">ifa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3166767">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3166770">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3166773">return</span>&nbsp;<span class="ident" id="3166780">nil</span><br>
<span class="lineno"></span><span class="op" id="3166784">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3166787">//&nbsp;interfaceMulticastAddrTable&nbsp;returns&nbsp;addresses&nbsp;for&nbsp;a&nbsp;specific</span><br>
<span class="lineno">205</span><span class="comment" id="3166851">//&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="3166865">func</span>&nbsp;<span class="ident" id="3166870">interfaceMulticastAddrTable</span><span class="op" id="3166897">(</span><span class="ident" id="3166898">ifi</span>&nbsp;<span class="op" id="3166902">*</span><span class="ident" id="3166903">Interface</span><span class="op" id="3166912">)</span>&nbsp;<span class="op" id="3166914">(</span><span class="op" id="3166915">[</span><span class="op" id="3166916">]</span><span class="ident" id="3166917">Addr</span><span class="op" id="3166921">,</span>&nbsp;<span class="builtintype" id="3166923">error</span><span class="op" id="3166928">)</span>&nbsp;<span class="op" id="3166930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3166933">ifmat4</span>&nbsp;<span class="op" id="3166940">:=</span>&nbsp;<span class="ident" id="3166943">parseProcNetIGMP</span><span class="op" id="3166959">(</span><span class="string" id="3166960">&#34;/proc/net/igmp&#34;</span><span class="op" id="3166976">,</span>&nbsp;<span class="ident" id="3166978">ifi</span><span class="op" id="3166981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3166984">ifmat6</span>&nbsp;<span class="op" id="3166991">:=</span>&nbsp;<span class="ident" id="3166994">parseProcNetIGMP6</span><span class="op" id="3167011">(</span><span class="string" id="3167012">&#34;/proc/net/igmp6&#34;</span><span class="op" id="3167029">,</span>&nbsp;<span class="ident" id="3167031">ifi</span><span class="op" id="3167034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3167037">return</span>&nbsp;<span class="builtinfunc" id="3167044">append</span><span class="op" id="3167050">(</span><span class="ident" id="3167051">ifmat4</span><span class="op" id="3167057">,</span>&nbsp;<span class="ident" id="3167059">ifmat6</span><span class="op" id="3167065">...</span><span class="op" id="3167068">)</span><span class="op" id="3167069">,</span>&nbsp;<span class="ident" id="3167071">nil</span><br>
<span class="lineno">210</span><span class="op" id="3167075">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3167078">func</span>&nbsp;<span class="ident" id="3167083">parseProcNetIGMP</span><span class="op" id="3167099">(</span><span class="ident" id="3167100">path</span>&nbsp;<span class="builtintype" id="3167105">string</span><span class="op" id="3167111">,</span>&nbsp;<span class="ident" id="3167113">ifi</span>&nbsp;<span class="op" id="3167117">*</span><span class="ident" id="3167118">Interface</span><span class="op" id="3167127">)</span>&nbsp;<span class="op" id="3167129">[</span><span class="op" id="3167130">]</span><span class="ident" id="3167131">Addr</span>&nbsp;<span class="op" id="3167136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3167139">fd</span><span class="op" id="3167141">,</span>&nbsp;<span class="ident" id="3167143">err</span>&nbsp;<span class="op" id="3167147">:=</span>&nbsp;<span class="ident" id="3167150">open</span><span class="op" id="3167154">(</span><span class="ident" id="3167155">path</span><span class="op" id="3167159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3167162">if</span>&nbsp;<span class="ident" id="3167165">err</span>&nbsp;<span class="op" id="3167169">!=</span>&nbsp;<span class="ident" id="3167172">nil</span>&nbsp;<span class="op" id="3167176">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3167180">return</span>&nbsp;<span class="ident" id="3167187">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3167192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3167195">defer</span>&nbsp;<span class="ident" id="3167201">fd</span><span class="op" id="3167203">.</span><span class="builtinfunc" id="3167204">close</span><span class="op" id="3167209">(</span><span class="op" id="3167210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3167213">var</span>&nbsp;<span class="op" id="3167217">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3167221">ifmat</span>&nbsp;<span class="op" id="3167227">[</span><span class="op" id="3167228">]</span><span class="ident" id="3167229">Addr</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3167236">name</span>&nbsp;&nbsp;<span class="builtintype" id="3167242">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3167250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3167253">fd</span><span class="op" id="3167255">.</span><span class="ident" id="3167256">readLine</span><span class="op" id="3167264">(</span><span class="op" id="3167265">)</span>&nbsp;<span class="comment" id="3167267">//&nbsp;skip&nbsp;first&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3167287">b</span>&nbsp;<span class="op" id="3167289">:=</span>&nbsp;<span class="builtinfunc" id="3167292">make</span><span class="op" id="3167296">(</span><span class="op" id="3167297">[</span><span class="op" id="3167298">]</span><span class="builtintype" id="3167299">byte</span><span class="op" id="3167303">,</span>&nbsp;<span class="ident" id="3167305">IPv4len</span><span class="op" id="3167312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3167315">for</span>&nbsp;<span class="ident" id="3167319">l</span><span class="op" id="3167320">,</span>&nbsp;<span class="ident" id="3167322">ok</span>&nbsp;<span class="op" id="3167325">:=</span>&nbsp;<span class="ident" id="3167328">fd</span><span class="op" id="3167330">.</span><span class="ident" id="3167331">readLine</span><span class="op" id="3167339">(</span><span class="op" id="3167340">)</span><span class="op" id="3167341">;</span>&nbsp;<span class="ident" id="3167343">ok</span><span class="op" id="3167345">;</span>&nbsp;<span class="ident" id="3167347">l</span><span class="op" id="3167348">,</span>&nbsp;<span class="ident" id="3167350">ok</span>&nbsp;<span class="op" id="3167353">=</span>&nbsp;<span class="ident" id="3167355">fd</span><span class="op" id="3167357">.</span><span class="ident" id="3167358">readLine</span><span class="op" id="3167366">(</span><span class="op" id="3167367">)</span>&nbsp;<span class="op" id="3167369">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3167373">f</span>&nbsp;<span class="op" id="3167375">:=</span>&nbsp;<span class="ident" id="3167378">splitAtBytes</span><span class="op" id="3167390">(</span><span class="ident" id="3167391">l</span><span class="op" id="3167392">,</span>&nbsp;<span class="string" id="3167394">&#34;&nbsp;:\r\t\n&#34;</span><span class="op" id="3167404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3167408">if</span>&nbsp;<span class="builtinfunc" id="3167411">len</span><span class="op" id="3167414">(</span><span class="ident" id="3167415">f</span><span class="op" id="3167416">)</span>&nbsp;<span class="op" id="3167418">&lt;</span>&nbsp;<span class="num" id="3167420">4</span>&nbsp;<span class="op" id="3167422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3167427">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3167438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3167442">switch</span>&nbsp;<span class="op" id="3167449">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3167453">case</span>&nbsp;<span class="ident" id="3167458">l</span><span class="op" id="3167459">[</span><span class="num" id="3167460">0</span><span class="op" id="3167461">]</span>&nbsp;<span class="op" id="3167463">!=</span>&nbsp;<span class="string" id="3167466">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3167470">&amp;&amp;</span>&nbsp;<span class="ident" id="3167473">l</span><span class="op" id="3167474">[</span><span class="num" id="3167475">0</span><span class="op" id="3167476">]</span>&nbsp;<span class="op" id="3167478">!=</span>&nbsp;<span class="string" id="3167481">&#39;\t&#39;</span><span class="op" id="3167485">:</span>&nbsp;<span class="comment" id="3167487">//&nbsp;new&nbsp;interface&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3167512">name</span>&nbsp;<span class="op" id="3167517">=</span>&nbsp;<span class="ident" id="3167519">f</span><span class="op" id="3167520">[</span><span class="num" id="3167521">1</span><span class="op" id="3167522">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3167526">case</span>&nbsp;<span class="builtinfunc" id="3167531">len</span><span class="op" id="3167534">(</span><span class="ident" id="3167535">f</span><span class="op" id="3167536">[</span><span class="num" id="3167537">0</span><span class="op" id="3167538">]</span><span class="op" id="3167539">)</span>&nbsp;<span class="op" id="3167541">==</span>&nbsp;<span class="num" id="3167544">8</span><span class="op" id="3167545">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3167550">if</span>&nbsp;<span class="ident" id="3167553">ifi</span>&nbsp;<span class="op" id="3167557">==</span>&nbsp;<span class="ident" id="3167560">nil</span>&nbsp;<span class="op" id="3167564">||</span>&nbsp;<span class="ident" id="3167567">name</span>&nbsp;<span class="op" id="3167572">==</span>&nbsp;<span class="ident" id="3167575">ifi</span><span class="op" id="3167578">.</span><span class="ident" id="3167579">Name</span>&nbsp;<span class="op" id="3167584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3167590">//&nbsp;The&nbsp;Linux&nbsp;kernel&nbsp;puts&nbsp;the&nbsp;IP</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3167626">//&nbsp;address&nbsp;in&nbsp;/proc/net/igmp&nbsp;in&nbsp;native</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3167669">//&nbsp;endianness.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3167688">for</span>&nbsp;<span class="ident" id="3167692">i</span>&nbsp;<span class="op" id="3167694">:=</span>&nbsp;<span class="num" id="3167697">0</span><span class="op" id="3167698">;</span>&nbsp;<span class="ident" id="3167700">i</span><span class="op" id="3167701">+</span><span class="num" id="3167702">1</span>&nbsp;<span class="op" id="3167704">&lt;</span>&nbsp;<span class="builtinfunc" id="3167706">len</span><span class="op" id="3167709">(</span><span class="ident" id="3167710">f</span><span class="op" id="3167711">[</span><span class="num" id="3167712">0</span><span class="op" id="3167713">]</span><span class="op" id="3167714">)</span><span class="op" id="3167715">;</span>&nbsp;<span class="ident" id="3167717">i</span>&nbsp;<span class="op" id="3167719">+=</span>&nbsp;<span class="num" id="3167722">2</span>&nbsp;<span class="op" id="3167724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3167731">b</span><span class="op" id="3167732">[</span><span class="ident" id="3167733">i</span><span class="op" id="3167734">/</span><span class="num" id="3167735">2</span><span class="op" id="3167736">]</span><span class="op" id="3167737">,</span>&nbsp;<span class="ident" id="3167739">_</span>&nbsp;<span class="op" id="3167741">=</span>&nbsp;<span class="ident" id="3167743">xtoi2</span><span class="op" id="3167748">(</span><span class="ident" id="3167749">f</span><span class="op" id="3167750">[</span><span class="num" id="3167751">0</span><span class="op" id="3167752">]</span><span class="op" id="3167753">[</span><span class="ident" id="3167754">i</span><span class="op" id="3167755">:</span><span class="ident" id="3167756">i</span><span class="op" id="3167757">+</span><span class="num" id="3167758">2</span><span class="op" id="3167759">]</span><span class="op" id="3167760">,</span>&nbsp;<span class="num" id="3167762">0</span><span class="op" id="3167763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3167769">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3167775">i</span>&nbsp;<span class="op" id="3167777">:=</span>&nbsp;<span class="op" id="3167780">*</span><span class="op" id="3167781">(</span><span class="op" id="3167782">*</span><span class="builtintype" id="3167783">uint32</span><span class="op" id="3167789">)</span><span class="op" id="3167790">(</span><span class="ident" id="3167791">unsafe</span><span class="op" id="3167797">.</span><span class="ident" id="3167798">Pointer</span><span class="op" id="3167805">(</span><span class="op" id="3167806">&amp;</span><span class="ident" id="3167807">b</span><span class="op" id="3167808">[</span><span class="op" id="3167809">:</span><span class="num" id="3167810">4</span><span class="op" id="3167811">]</span><span class="op" id="3167812">[</span><span class="num" id="3167813">0</span><span class="op" id="3167814">]</span><span class="op" id="3167815">)</span><span class="op" id="3167816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3167822">ifma</span>&nbsp;<span class="op" id="3167827">:=</span>&nbsp;<span class="ident" id="3167830">IPAddr</span><span class="op" id="3167836">{</span><span class="ident" id="3167837">IP</span><span class="op" id="3167839">:</span>&nbsp;<span class="ident" id="3167841">IPv4</span><span class="op" id="3167845">(</span><span class="builtintype" id="3167846">byte</span><span class="op" id="3167850">(</span><span class="ident" id="3167851">i</span><span class="op" id="3167852">&gt;&gt;</span><span class="num" id="3167854">24</span><span class="op" id="3167856">)</span><span class="op" id="3167857">,</span>&nbsp;<span class="builtintype" id="3167859">byte</span><span class="op" id="3167863">(</span><span class="ident" id="3167864">i</span><span class="op" id="3167865">&gt;&gt;</span><span class="num" id="3167867">16</span><span class="op" id="3167869">)</span><span class="op" id="3167870">,</span>&nbsp;<span class="builtintype" id="3167872">byte</span><span class="op" id="3167876">(</span><span class="ident" id="3167877">i</span><span class="op" id="3167878">&gt;&gt;</span><span class="num" id="3167880">8</span><span class="op" id="3167881">)</span><span class="op" id="3167882">,</span>&nbsp;<span class="builtintype" id="3167884">byte</span><span class="op" id="3167888">(</span><span class="ident" id="3167889">i</span><span class="op" id="3167890">)</span><span class="op" id="3167891">)</span><span class="op" id="3167892">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3167898">ifmat</span>&nbsp;<span class="op" id="3167904">=</span>&nbsp;<span class="builtinfunc" id="3167906">append</span><span class="op" id="3167912">(</span><span class="ident" id="3167913">ifmat</span><span class="op" id="3167918">,</span>&nbsp;<span class="ident" id="3167920">ifma</span><span class="op" id="3167924">.</span><span class="ident" id="3167925">toAddr</span><span class="op" id="3167931">(</span><span class="op" id="3167932">)</span><span class="op" id="3167933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3167938">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3167942">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3167945">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3167948">return</span>&nbsp;<span class="ident" id="3167955">ifmat</span><br>
<span class="lineno"></span><span class="op" id="3167961">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3167964">func</span>&nbsp;<span class="ident" id="3167969">parseProcNetIGMP6</span><span class="op" id="3167986">(</span><span class="ident" id="3167987">path</span>&nbsp;<span class="builtintype" id="3167992">string</span><span class="op" id="3167998">,</span>&nbsp;<span class="ident" id="3168000">ifi</span>&nbsp;<span class="op" id="3168004">*</span><span class="ident" id="3168005">Interface</span><span class="op" id="3168014">)</span>&nbsp;<span class="op" id="3168016">[</span><span class="op" id="3168017">]</span><span class="ident" id="3168018">Addr</span>&nbsp;<span class="op" id="3168023">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3168026">fd</span><span class="op" id="3168028">,</span>&nbsp;<span class="ident" id="3168030">err</span>&nbsp;<span class="op" id="3168034">:=</span>&nbsp;<span class="ident" id="3168037">open</span><span class="op" id="3168041">(</span><span class="ident" id="3168042">path</span><span class="op" id="3168046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3168049">if</span>&nbsp;<span class="ident" id="3168052">err</span>&nbsp;<span class="op" id="3168056">!=</span>&nbsp;<span class="ident" id="3168059">nil</span>&nbsp;<span class="op" id="3168063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3168067">return</span>&nbsp;<span class="ident" id="3168074">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3168079">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3168082">defer</span>&nbsp;<span class="ident" id="3168088">fd</span><span class="op" id="3168090">.</span><span class="builtinfunc" id="3168091">close</span><span class="op" id="3168096">(</span><span class="op" id="3168097">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3168100">var</span>&nbsp;<span class="ident" id="3168104">ifmat</span>&nbsp;<span class="op" id="3168110">[</span><span class="op" id="3168111">]</span><span class="ident" id="3168112">Addr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3168118">b</span>&nbsp;<span class="op" id="3168120">:=</span>&nbsp;<span class="builtinfunc" id="3168123">make</span><span class="op" id="3168127">(</span><span class="op" id="3168128">[</span><span class="op" id="3168129">]</span><span class="builtintype" id="3168130">byte</span><span class="op" id="3168134">,</span>&nbsp;<span class="ident" id="3168136">IPv6len</span><span class="op" id="3168143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3168146">for</span>&nbsp;<span class="ident" id="3168150">l</span><span class="op" id="3168151">,</span>&nbsp;<span class="ident" id="3168153">ok</span>&nbsp;<span class="op" id="3168156">:=</span>&nbsp;<span class="ident" id="3168159">fd</span><span class="op" id="3168161">.</span><span class="ident" id="3168162">readLine</span><span class="op" id="3168170">(</span><span class="op" id="3168171">)</span><span class="op" id="3168172">;</span>&nbsp;<span class="ident" id="3168174">ok</span><span class="op" id="3168176">;</span>&nbsp;<span class="ident" id="3168178">l</span><span class="op" id="3168179">,</span>&nbsp;<span class="ident" id="3168181">ok</span>&nbsp;<span class="op" id="3168184">=</span>&nbsp;<span class="ident" id="3168186">fd</span><span class="op" id="3168188">.</span><span class="ident" id="3168189">readLine</span><span class="op" id="3168197">(</span><span class="op" id="3168198">)</span>&nbsp;<span class="op" id="3168200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3168204">f</span>&nbsp;<span class="op" id="3168206">:=</span>&nbsp;<span class="ident" id="3168209">splitAtBytes</span><span class="op" id="3168221">(</span><span class="ident" id="3168222">l</span><span class="op" id="3168223">,</span>&nbsp;<span class="string" id="3168225">&#34;&nbsp;\r\t\n&#34;</span><span class="op" id="3168234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3168238">if</span>&nbsp;<span class="builtinfunc" id="3168241">len</span><span class="op" id="3168244">(</span><span class="ident" id="3168245">f</span><span class="op" id="3168246">)</span>&nbsp;<span class="op" id="3168248">&lt;</span>&nbsp;<span class="num" id="3168250">6</span>&nbsp;<span class="op" id="3168252">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3168257">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3168268">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3168272">if</span>&nbsp;<span class="ident" id="3168275">ifi</span>&nbsp;<span class="op" id="3168279">==</span>&nbsp;<span class="ident" id="3168282">nil</span>&nbsp;<span class="op" id="3168286">||</span>&nbsp;<span class="ident" id="3168289">f</span><span class="op" id="3168290">[</span><span class="num" id="3168291">1</span><span class="op" id="3168292">]</span>&nbsp;<span class="op" id="3168294">==</span>&nbsp;<span class="ident" id="3168297">ifi</span><span class="op" id="3168300">.</span><span class="ident" id="3168301">Name</span>&nbsp;<span class="op" id="3168306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3168311">for</span>&nbsp;<span class="ident" id="3168315">i</span>&nbsp;<span class="op" id="3168317">:=</span>&nbsp;<span class="num" id="3168320">0</span><span class="op" id="3168321">;</span>&nbsp;<span class="ident" id="3168323">i</span><span class="op" id="3168324">+</span><span class="num" id="3168325">1</span>&nbsp;<span class="op" id="3168327">&lt;</span>&nbsp;<span class="builtinfunc" id="3168329">len</span><span class="op" id="3168332">(</span><span class="ident" id="3168333">f</span><span class="op" id="3168334">[</span><span class="num" id="3168335">2</span><span class="op" id="3168336">]</span><span class="op" id="3168337">)</span><span class="op" id="3168338">;</span>&nbsp;<span class="ident" id="3168340">i</span>&nbsp;<span class="op" id="3168342">+=</span>&nbsp;<span class="num" id="3168345">2</span>&nbsp;<span class="op" id="3168347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3168353">b</span><span class="op" id="3168354">[</span><span class="ident" id="3168355">i</span><span class="op" id="3168356">/</span><span class="num" id="3168357">2</span><span class="op" id="3168358">]</span><span class="op" id="3168359">,</span>&nbsp;<span class="ident" id="3168361">_</span>&nbsp;<span class="op" id="3168363">=</span>&nbsp;<span class="ident" id="3168365">xtoi2</span><span class="op" id="3168370">(</span><span class="ident" id="3168371">f</span><span class="op" id="3168372">[</span><span class="num" id="3168373">2</span><span class="op" id="3168374">]</span><span class="op" id="3168375">[</span><span class="ident" id="3168376">i</span><span class="op" id="3168377">:</span><span class="ident" id="3168378">i</span><span class="op" id="3168379">+</span><span class="num" id="3168380">2</span><span class="op" id="3168381">]</span><span class="op" id="3168382">,</span>&nbsp;<span class="num" id="3168384">0</span><span class="op" id="3168385">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3168390">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3168395">ifma</span>&nbsp;<span class="op" id="3168400">:=</span>&nbsp;<span class="ident" id="3168403">IPAddr</span><span class="op" id="3168409">{</span><span class="ident" id="3168410">IP</span><span class="op" id="3168412">:</span>&nbsp;<span class="ident" id="3168414">IP</span><span class="op" id="3168416">{</span><span class="ident" id="3168417">b</span><span class="op" id="3168418">[</span><span class="num" id="3168419">0</span><span class="op" id="3168420">]</span><span class="op" id="3168421">,</span>&nbsp;<span class="ident" id="3168423">b</span><span class="op" id="3168424">[</span><span class="num" id="3168425">1</span><span class="op" id="3168426">]</span><span class="op" id="3168427">,</span>&nbsp;<span class="ident" id="3168429">b</span><span class="op" id="3168430">[</span><span class="num" id="3168431">2</span><span class="op" id="3168432">]</span><span class="op" id="3168433">,</span>&nbsp;<span class="ident" id="3168435">b</span><span class="op" id="3168436">[</span><span class="num" id="3168437">3</span><span class="op" id="3168438">]</span><span class="op" id="3168439">,</span>&nbsp;<span class="ident" id="3168441">b</span><span class="op" id="3168442">[</span><span class="num" id="3168443">4</span><span class="op" id="3168444">]</span><span class="op" id="3168445">,</span>&nbsp;<span class="ident" id="3168447">b</span><span class="op" id="3168448">[</span><span class="num" id="3168449">5</span><span class="op" id="3168450">]</span><span class="op" id="3168451">,</span>&nbsp;<span class="ident" id="3168453">b</span><span class="op" id="3168454">[</span><span class="num" id="3168455">6</span><span class="op" id="3168456">]</span><span class="op" id="3168457">,</span>&nbsp;<span class="ident" id="3168459">b</span><span class="op" id="3168460">[</span><span class="num" id="3168461">7</span><span class="op" id="3168462">]</span><span class="op" id="3168463">,</span>&nbsp;<span class="ident" id="3168465">b</span><span class="op" id="3168466">[</span><span class="num" id="3168467">8</span><span class="op" id="3168468">]</span><span class="op" id="3168469">,</span>&nbsp;<span class="ident" id="3168471">b</span><span class="op" id="3168472">[</span><span class="num" id="3168473">9</span><span class="op" id="3168474">]</span><span class="op" id="3168475">,</span>&nbsp;<span class="ident" id="3168477">b</span><span class="op" id="3168478">[</span><span class="num" id="3168479">10</span><span class="op" id="3168481">]</span><span class="op" id="3168482">,</span>&nbsp;<span class="ident" id="3168484">b</span><span class="op" id="3168485">[</span><span class="num" id="3168486">11</span><span class="op" id="3168488">]</span><span class="op" id="3168489">,</span>&nbsp;<span class="ident" id="3168491">b</span><span class="op" id="3168492">[</span><span class="num" id="3168493">12</span><span class="op" id="3168495">]</span><span class="op" id="3168496">,</span>&nbsp;<span class="ident" id="3168498">b</span><span class="op" id="3168499">[</span><span class="num" id="3168500">13</span><span class="op" id="3168502">]</span><span class="op" id="3168503">,</span>&nbsp;<span class="ident" id="3168505">b</span><span class="op" id="3168506">[</span><span class="num" id="3168507">14</span><span class="op" id="3168509">]</span><span class="op" id="3168510">,</span>&nbsp;<span class="ident" id="3168512">b</span><span class="op" id="3168513">[</span><span class="num" id="3168514">15</span><span class="op" id="3168516">]</span><span class="op" id="3168517">}</span><span class="op" id="3168518">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3168523">ifmat</span>&nbsp;<span class="op" id="3168529">=</span>&nbsp;<span class="builtinfunc" id="3168531">append</span><span class="op" id="3168537">(</span><span class="ident" id="3168538">ifmat</span><span class="op" id="3168543">,</span>&nbsp;<span class="ident" id="3168545">ifma</span><span class="op" id="3168549">.</span><span class="ident" id="3168550">toAddr</span><span class="op" id="3168556">(</span><span class="op" id="3168557">)</span><span class="op" id="3168558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3168562">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3168565">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3168568">return</span>&nbsp;<span class="ident" id="3168575">ifmat</span><br>
<span class="lineno"></span><span class="op" id="3168581">}</span>
</div>
</body>
</html>
