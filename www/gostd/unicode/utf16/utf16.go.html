<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>unicode/utf16</h2>
<ul>
<li><a href="/gostd/unicode/utf16/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/unicode/utf16/utf16.go.html" class="current">utf16.go</a></li>
<li><a href="/gostd/unicode/utf16/utf16_test.go.html">utf16_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3448842">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3448898">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3448952">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3449003">//&nbsp;Package&nbsp;utf16&nbsp;implements&nbsp;encoding&nbsp;and&nbsp;decoding&nbsp;of&nbsp;UTF-16&nbsp;sequences.</span><br>
<span class="lineno"></span><span class="keyword" id="3449074">package</span>&nbsp;<span class="ident" id="3449082">utf16</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3449089">//&nbsp;The&nbsp;conditions&nbsp;replacementChar==unicode.ReplacementChar&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3449152">//&nbsp;maxRune==unicode.MaxRune&nbsp;are&nbsp;verified&nbsp;in&nbsp;the&nbsp;tests.</span><br>
<span class="lineno">10</span><span class="comment" id="3449207">//&nbsp;Defining&nbsp;them&nbsp;locally&nbsp;avoids&nbsp;this&nbsp;package&nbsp;depending&nbsp;on&nbsp;package&nbsp;unicode.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3449283">const</span>&nbsp;<span class="op" id="3449289">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3449292">replacementChar</span>&nbsp;<span class="op" id="3449308">=</span>&nbsp;<span class="string" id="3449310">&#39;\uFFFD&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3449323">//&nbsp;Unicode&nbsp;replacement&nbsp;character</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3449357">maxRune</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3449373">=</span>&nbsp;<span class="string" id="3449375">&#39;\U0010FFFF&#39;</span>&nbsp;<span class="comment" id="3449388">//&nbsp;Maximum&nbsp;valid&nbsp;Unicode&nbsp;code&nbsp;point.</span><br>
<span class="lineno">15</span><span class="op" id="3449425">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3449428">const</span>&nbsp;<span class="op" id="3449434">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3449437">//&nbsp;0xd800-0xdc00&nbsp;encodes&nbsp;the&nbsp;high&nbsp;10&nbsp;bits&nbsp;of&nbsp;a&nbsp;pair.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3449491">//&nbsp;0xdc00-0xe000&nbsp;encodes&nbsp;the&nbsp;low&nbsp;10&nbsp;bits&nbsp;of&nbsp;a&nbsp;pair.</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3449544">//&nbsp;the&nbsp;value&nbsp;is&nbsp;those&nbsp;20&nbsp;bits&nbsp;plus&nbsp;0x10000.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3449589">surr1</span>&nbsp;<span class="op" id="3449595">=</span>&nbsp;<span class="num" id="3449597">0xd800</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3449605">surr2</span>&nbsp;<span class="op" id="3449611">=</span>&nbsp;<span class="num" id="3449613">0xdc00</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3449621">surr3</span>&nbsp;<span class="op" id="3449627">=</span>&nbsp;<span class="num" id="3449629">0xe000</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3449638">surrSelf</span>&nbsp;<span class="op" id="3449647">=</span>&nbsp;<span class="num" id="3449649">0x10000</span><br>
<span class="lineno"></span><span class="op" id="3449657">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3449660">//&nbsp;IsSurrogate&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;specified&nbsp;Unicode&nbsp;code&nbsp;point</span><br>
<span class="lineno"></span><span class="comment" id="3449724">//&nbsp;can&nbsp;appear&nbsp;in&nbsp;a&nbsp;surrogate&nbsp;pair.</span><br>
<span class="lineno">30</span><span class="keyword" id="3449759">func</span>&nbsp;<span class="ident" id="3449764">IsSurrogate</span><span class="op" id="3449775">(</span><span class="ident" id="3449776">r</span>&nbsp;<span class="builtintype" id="3449778">rune</span><span class="op" id="3449782">)</span>&nbsp;<span class="builtintype" id="3449784">bool</span>&nbsp;<span class="op" id="3449789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3449792">return</span>&nbsp;<span class="ident" id="3449799">surr1</span>&nbsp;<span class="op" id="3449805">&lt;=</span>&nbsp;<span class="ident" id="3449808">r</span>&nbsp;<span class="op" id="3449810">&amp;&amp;</span>&nbsp;<span class="ident" id="3449813">r</span>&nbsp;<span class="op" id="3449815">&lt;</span>&nbsp;<span class="ident" id="3449817">surr3</span><br>
<span class="lineno"></span><span class="op" id="3449823">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3449826">//&nbsp;DecodeRune&nbsp;returns&nbsp;the&nbsp;UTF-16&nbsp;decoding&nbsp;of&nbsp;a&nbsp;surrogate&nbsp;pair.</span><br>
<span class="lineno">35</span><span class="comment" id="3449889">//&nbsp;If&nbsp;the&nbsp;pair&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;UTF-16&nbsp;surrogate&nbsp;pair,&nbsp;DecodeRune&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="3449961">//&nbsp;the&nbsp;Unicode&nbsp;replacement&nbsp;code&nbsp;point&nbsp;U+FFFD.</span><br>
<span class="lineno"></span><span class="keyword" id="3450007">func</span>&nbsp;<span class="ident" id="3450012">DecodeRune</span><span class="op" id="3450022">(</span><span class="ident" id="3450023">r1</span><span class="op" id="3450025">,</span>&nbsp;<span class="ident" id="3450027">r2</span>&nbsp;<span class="builtintype" id="3450030">rune</span><span class="op" id="3450034">)</span>&nbsp;<span class="builtintype" id="3450036">rune</span>&nbsp;<span class="op" id="3450041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3450044">if</span>&nbsp;<span class="ident" id="3450047">surr1</span>&nbsp;<span class="op" id="3450053">&lt;=</span>&nbsp;<span class="ident" id="3450056">r1</span>&nbsp;<span class="op" id="3450059">&amp;&amp;</span>&nbsp;<span class="ident" id="3450062">r1</span>&nbsp;<span class="op" id="3450065">&lt;</span>&nbsp;<span class="ident" id="3450067">surr2</span>&nbsp;<span class="op" id="3450073">&amp;&amp;</span>&nbsp;<span class="ident" id="3450076">surr2</span>&nbsp;<span class="op" id="3450082">&lt;=</span>&nbsp;<span class="ident" id="3450085">r2</span>&nbsp;<span class="op" id="3450088">&amp;&amp;</span>&nbsp;<span class="ident" id="3450091">r2</span>&nbsp;<span class="op" id="3450094">&lt;</span>&nbsp;<span class="ident" id="3450096">surr3</span>&nbsp;<span class="op" id="3450102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3450106">return</span>&nbsp;<span class="op" id="3450113">(</span><span class="ident" id="3450114">r1</span><span class="op" id="3450116">-</span><span class="ident" id="3450117">surr1</span><span class="op" id="3450122">)</span><span class="op" id="3450123">&lt;&lt;</span><span class="num" id="3450125">10</span>&nbsp;<span class="op" id="3450128">|</span>&nbsp;<span class="op" id="3450130">(</span><span class="ident" id="3450131">r2</span>&nbsp;<span class="op" id="3450134">-</span>&nbsp;<span class="ident" id="3450136">surr2</span><span class="op" id="3450141">)</span>&nbsp;<span class="op" id="3450143">+</span>&nbsp;<span class="num" id="3450145">0x10000</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3450154">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3450157">return</span>&nbsp;<span class="ident" id="3450164">replacementChar</span><br>
<span class="lineno"></span><span class="op" id="3450180">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3450183">//&nbsp;EncodeRune&nbsp;returns&nbsp;the&nbsp;UTF-16&nbsp;surrogate&nbsp;pair&nbsp;r1,&nbsp;r2&nbsp;for&nbsp;the&nbsp;given&nbsp;rune.</span><br>
<span class="lineno">45</span><span class="comment" id="3450258">//&nbsp;If&nbsp;the&nbsp;rune&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;Unicode&nbsp;code&nbsp;point&nbsp;or&nbsp;does&nbsp;not&nbsp;need&nbsp;encoding,</span><br>
<span class="lineno"></span><span class="comment" id="3450334">//&nbsp;EncodeRune&nbsp;returns&nbsp;U+FFFD,&nbsp;U+FFFD.</span><br>
<span class="lineno"></span><span class="keyword" id="3450372">func</span>&nbsp;<span class="ident" id="3450377">EncodeRune</span><span class="op" id="3450387">(</span><span class="ident" id="3450388">r</span>&nbsp;<span class="builtintype" id="3450390">rune</span><span class="op" id="3450394">)</span>&nbsp;<span class="op" id="3450396">(</span><span class="ident" id="3450397">r1</span><span class="op" id="3450399">,</span>&nbsp;<span class="ident" id="3450401">r2</span>&nbsp;<span class="builtintype" id="3450404">rune</span><span class="op" id="3450408">)</span>&nbsp;<span class="op" id="3450410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3450413">if</span>&nbsp;<span class="ident" id="3450416">r</span>&nbsp;<span class="op" id="3450418">&lt;</span>&nbsp;<span class="ident" id="3450420">surrSelf</span>&nbsp;<span class="op" id="3450429">||</span>&nbsp;<span class="ident" id="3450432">r</span>&nbsp;<span class="op" id="3450434">&gt;</span>&nbsp;<span class="ident" id="3450436">maxRune</span>&nbsp;<span class="op" id="3450444">||</span>&nbsp;<span class="ident" id="3450447">IsSurrogate</span><span class="op" id="3450458">(</span><span class="ident" id="3450459">r</span><span class="op" id="3450460">)</span>&nbsp;<span class="op" id="3450462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3450466">return</span>&nbsp;<span class="ident" id="3450473">replacementChar</span><span class="op" id="3450488">,</span>&nbsp;<span class="ident" id="3450490">replacementChar</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3450507">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3450510">r</span>&nbsp;<span class="op" id="3450512">-=</span>&nbsp;<span class="ident" id="3450515">surrSelf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3450525">return</span>&nbsp;<span class="ident" id="3450532">surr1</span>&nbsp;<span class="op" id="3450538">+</span>&nbsp;<span class="op" id="3450540">(</span><span class="ident" id="3450541">r</span><span class="op" id="3450542">&gt;&gt;</span><span class="num" id="3450544">10</span><span class="op" id="3450546">)</span><span class="op" id="3450547">&amp;</span><span class="num" id="3450548">0x3ff</span><span class="op" id="3450553">,</span>&nbsp;<span class="ident" id="3450555">surr2</span>&nbsp;<span class="op" id="3450561">+</span>&nbsp;<span class="ident" id="3450563">r</span><span class="op" id="3450564">&amp;</span><span class="num" id="3450565">0x3ff</span><br>
<span class="lineno"></span><span class="op" id="3450571">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="comment" id="3450574">//&nbsp;Encode&nbsp;returns&nbsp;the&nbsp;UTF-16&nbsp;encoding&nbsp;of&nbsp;the&nbsp;Unicode&nbsp;code&nbsp;point&nbsp;sequence&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="3450650">func</span>&nbsp;<span class="ident" id="3450655">Encode</span><span class="op" id="3450661">(</span><span class="ident" id="3450662">s</span>&nbsp;<span class="op" id="3450664">[</span><span class="op" id="3450665">]</span><span class="builtintype" id="3450666">rune</span><span class="op" id="3450670">)</span>&nbsp;<span class="op" id="3450672">[</span><span class="op" id="3450673">]</span><span class="builtintype" id="3450674">uint16</span>&nbsp;<span class="op" id="3450681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3450684">n</span>&nbsp;<span class="op" id="3450686">:=</span>&nbsp;<span class="builtinfunc" id="3450689">len</span><span class="op" id="3450692">(</span><span class="ident" id="3450693">s</span><span class="op" id="3450694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3450697">for</span>&nbsp;<span class="ident" id="3450701">_</span><span class="op" id="3450702">,</span>&nbsp;<span class="ident" id="3450704">v</span>&nbsp;<span class="op" id="3450706">:=</span>&nbsp;<span class="keyword" id="3450709">range</span>&nbsp;<span class="ident" id="3450715">s</span>&nbsp;<span class="op" id="3450717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3450721">if</span>&nbsp;<span class="ident" id="3450724">v</span>&nbsp;<span class="op" id="3450726">&gt;=</span>&nbsp;<span class="ident" id="3450729">surrSelf</span>&nbsp;<span class="op" id="3450738">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3450743">n</span><span class="op" id="3450744">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3450749">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3450752">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3450756">a</span>&nbsp;<span class="op" id="3450758">:=</span>&nbsp;<span class="builtinfunc" id="3450761">make</span><span class="op" id="3450765">(</span><span class="op" id="3450766">[</span><span class="op" id="3450767">]</span><span class="builtintype" id="3450768">uint16</span><span class="op" id="3450774">,</span>&nbsp;<span class="ident" id="3450776">n</span><span class="op" id="3450777">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3450780">n</span>&nbsp;<span class="op" id="3450782">=</span>&nbsp;<span class="num" id="3450784">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3450787">for</span>&nbsp;<span class="ident" id="3450791">_</span><span class="op" id="3450792">,</span>&nbsp;<span class="ident" id="3450794">v</span>&nbsp;<span class="op" id="3450796">:=</span>&nbsp;<span class="keyword" id="3450799">range</span>&nbsp;<span class="ident" id="3450805">s</span>&nbsp;<span class="op" id="3450807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3450811">switch</span>&nbsp;<span class="op" id="3450818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3450822">case</span>&nbsp;<span class="ident" id="3450827">v</span>&nbsp;<span class="op" id="3450829">&lt;</span>&nbsp;<span class="num" id="3450831">0</span><span class="op" id="3450832">,</span>&nbsp;<span class="ident" id="3450834">surr1</span>&nbsp;<span class="op" id="3450840">&lt;=</span>&nbsp;<span class="ident" id="3450843">v</span>&nbsp;<span class="op" id="3450845">&amp;&amp;</span>&nbsp;<span class="ident" id="3450848">v</span>&nbsp;<span class="op" id="3450850">&lt;</span>&nbsp;<span class="ident" id="3450852">surr3</span><span class="op" id="3450857">,</span>&nbsp;<span class="ident" id="3450859">v</span>&nbsp;<span class="op" id="3450861">&gt;</span>&nbsp;<span class="ident" id="3450863">maxRune</span><span class="op" id="3450870">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3450875">v</span>&nbsp;<span class="op" id="3450877">=</span>&nbsp;<span class="ident" id="3450879">replacementChar</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3450898">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3450912">case</span>&nbsp;<span class="ident" id="3450917">v</span>&nbsp;<span class="op" id="3450919">&lt;</span>&nbsp;<span class="ident" id="3450921">surrSelf</span><span class="op" id="3450929">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3450934">a</span><span class="op" id="3450935">[</span><span class="ident" id="3450936">n</span><span class="op" id="3450937">]</span>&nbsp;<span class="op" id="3450939">=</span>&nbsp;<span class="builtintype" id="3450941">uint16</span><span class="op" id="3450947">(</span><span class="ident" id="3450948">v</span><span class="op" id="3450949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3450954">n</span><span class="op" id="3450955">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3450960">default</span><span class="op" id="3450967">:</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3450972">r1</span><span class="op" id="3450974">,</span>&nbsp;<span class="ident" id="3450976">r2</span>&nbsp;<span class="op" id="3450979">:=</span>&nbsp;<span class="ident" id="3450982">EncodeRune</span><span class="op" id="3450992">(</span><span class="ident" id="3450993">v</span><span class="op" id="3450994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3450999">a</span><span class="op" id="3451000">[</span><span class="ident" id="3451001">n</span><span class="op" id="3451002">]</span>&nbsp;<span class="op" id="3451004">=</span>&nbsp;<span class="builtintype" id="3451006">uint16</span><span class="op" id="3451012">(</span><span class="ident" id="3451013">r1</span><span class="op" id="3451015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3451020">a</span><span class="op" id="3451021">[</span><span class="ident" id="3451022">n</span><span class="op" id="3451023">+</span><span class="num" id="3451024">1</span><span class="op" id="3451025">]</span>&nbsp;<span class="op" id="3451027">=</span>&nbsp;<span class="builtintype" id="3451029">uint16</span><span class="op" id="3451035">(</span><span class="ident" id="3451036">r2</span><span class="op" id="3451038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3451043">n</span>&nbsp;<span class="op" id="3451045">+=</span>&nbsp;<span class="num" id="3451048">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3451052">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3451055">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3451058">return</span>&nbsp;<span class="ident" id="3451065">a</span><span class="op" id="3451066">[</span><span class="num" id="3451067">0</span><span class="op" id="3451068">:</span><span class="ident" id="3451069">n</span><span class="op" id="3451070">]</span><br>
<span class="lineno"></span><span class="op" id="3451072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3451075">//&nbsp;Decode&nbsp;returns&nbsp;the&nbsp;Unicode&nbsp;code&nbsp;point&nbsp;sequence&nbsp;represented</span><br>
<span class="lineno">85</span><span class="comment" id="3451137">//&nbsp;by&nbsp;the&nbsp;UTF-16&nbsp;encoding&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="3451166">func</span>&nbsp;<span class="ident" id="3451171">Decode</span><span class="op" id="3451177">(</span><span class="ident" id="3451178">s</span>&nbsp;<span class="op" id="3451180">[</span><span class="op" id="3451181">]</span><span class="builtintype" id="3451182">uint16</span><span class="op" id="3451188">)</span>&nbsp;<span class="op" id="3451190">[</span><span class="op" id="3451191">]</span><span class="builtintype" id="3451192">rune</span>&nbsp;<span class="op" id="3451197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3451200">a</span>&nbsp;<span class="op" id="3451202">:=</span>&nbsp;<span class="builtinfunc" id="3451205">make</span><span class="op" id="3451209">(</span><span class="op" id="3451210">[</span><span class="op" id="3451211">]</span><span class="builtintype" id="3451212">rune</span><span class="op" id="3451216">,</span>&nbsp;<span class="builtinfunc" id="3451218">len</span><span class="op" id="3451221">(</span><span class="ident" id="3451222">s</span><span class="op" id="3451223">)</span><span class="op" id="3451224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3451227">n</span>&nbsp;<span class="op" id="3451229">:=</span>&nbsp;<span class="num" id="3451232">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3451235">for</span>&nbsp;<span class="ident" id="3451239">i</span>&nbsp;<span class="op" id="3451241">:=</span>&nbsp;<span class="num" id="3451244">0</span><span class="op" id="3451245">;</span>&nbsp;<span class="ident" id="3451247">i</span>&nbsp;<span class="op" id="3451249">&lt;</span>&nbsp;<span class="builtinfunc" id="3451251">len</span><span class="op" id="3451254">(</span><span class="ident" id="3451255">s</span><span class="op" id="3451256">)</span><span class="op" id="3451257">;</span>&nbsp;<span class="ident" id="3451259">i</span><span class="op" id="3451260">++</span>&nbsp;<span class="op" id="3451263">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3451267">switch</span>&nbsp;<span class="ident" id="3451274">r</span>&nbsp;<span class="op" id="3451276">:=</span>&nbsp;<span class="ident" id="3451279">s</span><span class="op" id="3451280">[</span><span class="ident" id="3451281">i</span><span class="op" id="3451282">]</span><span class="op" id="3451283">;</span>&nbsp;<span class="op" id="3451285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3451289">case</span>&nbsp;<span class="ident" id="3451294">surr1</span>&nbsp;<span class="op" id="3451300">&lt;=</span>&nbsp;<span class="ident" id="3451303">r</span>&nbsp;<span class="op" id="3451305">&amp;&amp;</span>&nbsp;<span class="ident" id="3451308">r</span>&nbsp;<span class="op" id="3451310">&lt;</span>&nbsp;<span class="ident" id="3451312">surr2</span>&nbsp;<span class="op" id="3451318">&amp;&amp;</span>&nbsp;<span class="ident" id="3451321">i</span><span class="op" id="3451322">+</span><span class="num" id="3451323">1</span>&nbsp;<span class="op" id="3451325">&lt;</span>&nbsp;<span class="builtinfunc" id="3451327">len</span><span class="op" id="3451330">(</span><span class="ident" id="3451331">s</span><span class="op" id="3451332">)</span>&nbsp;<span class="op" id="3451334">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3451340">surr2</span>&nbsp;<span class="op" id="3451346">&lt;=</span>&nbsp;<span class="ident" id="3451349">s</span><span class="op" id="3451350">[</span><span class="ident" id="3451351">i</span><span class="op" id="3451352">+</span><span class="num" id="3451353">1</span><span class="op" id="3451354">]</span>&nbsp;<span class="op" id="3451356">&amp;&amp;</span>&nbsp;<span class="ident" id="3451359">s</span><span class="op" id="3451360">[</span><span class="ident" id="3451361">i</span><span class="op" id="3451362">+</span><span class="num" id="3451363">1</span><span class="op" id="3451364">]</span>&nbsp;<span class="op" id="3451366">&lt;</span>&nbsp;<span class="ident" id="3451368">surr3</span><span class="op" id="3451373">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3451378">//&nbsp;valid&nbsp;surrogate&nbsp;sequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3451409">a</span><span class="op" id="3451410">[</span><span class="ident" id="3451411">n</span><span class="op" id="3451412">]</span>&nbsp;<span class="op" id="3451414">=</span>&nbsp;<span class="ident" id="3451416">DecodeRune</span><span class="op" id="3451426">(</span><span class="builtintype" id="3451427">rune</span><span class="op" id="3451431">(</span><span class="ident" id="3451432">r</span><span class="op" id="3451433">)</span><span class="op" id="3451434">,</span>&nbsp;<span class="builtintype" id="3451436">rune</span><span class="op" id="3451440">(</span><span class="ident" id="3451441">s</span><span class="op" id="3451442">[</span><span class="ident" id="3451443">i</span><span class="op" id="3451444">+</span><span class="num" id="3451445">1</span><span class="op" id="3451446">]</span><span class="op" id="3451447">)</span><span class="op" id="3451448">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3451453">i</span><span class="op" id="3451454">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3451460">n</span><span class="op" id="3451461">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3451466">case</span>&nbsp;<span class="ident" id="3451471">surr1</span>&nbsp;<span class="op" id="3451477">&lt;=</span>&nbsp;<span class="ident" id="3451480">r</span>&nbsp;<span class="op" id="3451482">&amp;&amp;</span>&nbsp;<span class="ident" id="3451485">r</span>&nbsp;<span class="op" id="3451487">&lt;</span>&nbsp;<span class="ident" id="3451489">surr3</span><span class="op" id="3451494">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3451499">//&nbsp;invalid&nbsp;surrogate&nbsp;sequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3451532">a</span><span class="op" id="3451533">[</span><span class="ident" id="3451534">n</span><span class="op" id="3451535">]</span>&nbsp;<span class="op" id="3451537">=</span>&nbsp;<span class="ident" id="3451539">replacementChar</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3451558">n</span><span class="op" id="3451559">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3451564">default</span><span class="op" id="3451571">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3451576">//&nbsp;normal&nbsp;rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3451594">a</span><span class="op" id="3451595">[</span><span class="ident" id="3451596">n</span><span class="op" id="3451597">]</span>&nbsp;<span class="op" id="3451599">=</span>&nbsp;<span class="builtintype" id="3451601">rune</span><span class="op" id="3451605">(</span><span class="ident" id="3451606">r</span><span class="op" id="3451607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3451612">n</span><span class="op" id="3451613">++</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3451618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3451621">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3451624">return</span>&nbsp;<span class="ident" id="3451631">a</span><span class="op" id="3451632">[</span><span class="num" id="3451633">0</span><span class="op" id="3451634">:</span><span class="ident" id="3451635">n</span><span class="op" id="3451636">]</span><br>
<span class="lineno"></span><span class="op" id="3451638">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
