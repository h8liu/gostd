<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>debug/plan9obj</h2>
<ul>
<li><a href="/gostd/debug/plan9obj/file.go.html">file.go</a></li>
<li><a href="/gostd/debug/plan9obj/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/debug/plan9obj/plan9obj.go.html">plan9obj.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6496572">//&nbsp;Copyright&nbsp;2014&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6496628">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6496682">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6496733">//&nbsp;Package&nbsp;plan9obj&nbsp;implements&nbsp;access&nbsp;to&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;object&nbsp;files.</span><br>
<span class="lineno"></span><span class="keyword" id="6496801">package</span>&nbsp;<span class="ident" id="6496809">plan9obj</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6496819">import</span>&nbsp;<span class="op" id="6496826">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6496829">&#34;encoding/binary&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6496848">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6496858">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6496865">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6496871">&#34;os&#34;</span><br>
<span class="lineno"></span><span class="op" id="6496876">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="6496879">//&nbsp;A&nbsp;FileHeader&nbsp;represents&nbsp;a&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;file&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="6496934">type</span>&nbsp;<span class="ident" id="6496939">FileHeader</span>&nbsp;<span class="keyword" id="6496950">struct</span>&nbsp;<span class="op" id="6496957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6496960">Magic</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6496972">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6496980">Bss</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6496992">uint32</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6497000">Entry</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6497012">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6497020">PtrSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6497032">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6497037">LoadAddress</span>&nbsp;<span class="ident" id="6497049">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6497057">HdrSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6497069">uint64</span><br>
<span class="lineno"></span><span class="op" id="6497076">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="6497079">//&nbsp;A&nbsp;File&nbsp;represents&nbsp;an&nbsp;open&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="6497127">type</span>&nbsp;<span class="ident" id="6497132">File</span>&nbsp;<span class="keyword" id="6497137">struct</span>&nbsp;<span class="op" id="6497144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6497147">FileHeader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6497159">Sections</span>&nbsp;<span class="op" id="6497168">[</span><span class="op" id="6497169">]</span><span class="op" id="6497170">*</span><span class="ident" id="6497171">Section</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6497180">closer</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6497189">io</span><span class="op" id="6497191">.</span><span class="ident" id="6497192">Closer</span><br>
<span class="lineno"></span><span class="op" id="6497199">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6497202">//&nbsp;A&nbsp;SectionHeader&nbsp;represents&nbsp;a&nbsp;single&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;section&nbsp;header.</span><br>
<span class="lineno"></span><span class="comment" id="6497270">//&nbsp;This&nbsp;structure&nbsp;doesn&#39;t&nbsp;exist&nbsp;on-disk,&nbsp;but&nbsp;eases&nbsp;navigation</span><br>
<span class="lineno">35</span><span class="comment" id="6497332">//&nbsp;through&nbsp;the&nbsp;object&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="6497360">type</span>&nbsp;<span class="ident" id="6497365">SectionHeader</span>&nbsp;<span class="keyword" id="6497379">struct</span>&nbsp;<span class="op" id="6497386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6497389">Name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6497396">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6497404">Size</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6497411">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6497419">Offset</span>&nbsp;<span class="builtintype" id="6497426">uint32</span><br>
<span class="lineno">40</span><span class="op" id="6497433">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6497436">//&nbsp;A&nbsp;Section&nbsp;represents&nbsp;a&nbsp;single&nbsp;section&nbsp;in&nbsp;a&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="6497501">type</span>&nbsp;<span class="ident" id="6497506">Section</span>&nbsp;<span class="keyword" id="6497514">struct</span>&nbsp;<span class="op" id="6497521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6497524">SectionHeader</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6497540">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6497578">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6497618">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6497653">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6497701">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6497751">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6497775">io</span><span class="op" id="6497777">.</span><span class="ident" id="6497778">ReaderAt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6497788">sr</span>&nbsp;<span class="op" id="6497791">*</span><span class="ident" id="6497792">io</span><span class="op" id="6497794">.</span><span class="ident" id="6497795">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="6497809">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="6497812">//&nbsp;Data&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="6497880">func</span>&nbsp;<span class="op" id="6497885">(</span><span class="ident" id="6497886">s</span>&nbsp;<span class="op" id="6497888">*</span><span class="ident" id="6497889">Section</span><span class="op" id="6497896">)</span>&nbsp;<span class="ident" id="6497898">Data</span><span class="op" id="6497902">(</span><span class="op" id="6497903">)</span>&nbsp;<span class="op" id="6497905">(</span><span class="op" id="6497906">[</span><span class="op" id="6497907">]</span><span class="builtintype" id="6497908">byte</span><span class="op" id="6497912">,</span>&nbsp;<span class="builtintype" id="6497914">error</span><span class="op" id="6497919">)</span>&nbsp;<span class="op" id="6497921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6497924">dat</span>&nbsp;<span class="op" id="6497928">:=</span>&nbsp;<span class="builtinfunc" id="6497931">make</span><span class="op" id="6497935">(</span><span class="op" id="6497936">[</span><span class="op" id="6497937">]</span><span class="builtintype" id="6497938">byte</span><span class="op" id="6497942">,</span>&nbsp;<span class="ident" id="6497944">s</span><span class="op" id="6497945">.</span><span class="ident" id="6497946">sr</span><span class="op" id="6497948">.</span><span class="ident" id="6497949">Size</span><span class="op" id="6497953">(</span><span class="op" id="6497954">)</span><span class="op" id="6497955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6497958">n</span><span class="op" id="6497959">,</span>&nbsp;<span class="ident" id="6497961">err</span>&nbsp;<span class="op" id="6497965">:=</span>&nbsp;<span class="ident" id="6497968">s</span><span class="op" id="6497969">.</span><span class="ident" id="6497970">sr</span><span class="op" id="6497972">.</span><span class="ident" id="6497973">ReadAt</span><span class="op" id="6497979">(</span><span class="ident" id="6497980">dat</span><span class="op" id="6497983">,</span>&nbsp;<span class="num" id="6497985">0</span><span class="op" id="6497986">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6497989">if</span>&nbsp;<span class="ident" id="6497992">n</span>&nbsp;<span class="op" id="6497994">==</span>&nbsp;<span class="builtinfunc" id="6497997">len</span><span class="op" id="6498000">(</span><span class="ident" id="6498001">dat</span><span class="op" id="6498004">)</span>&nbsp;<span class="op" id="6498006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6498010">err</span>&nbsp;<span class="op" id="6498014">=</span>&nbsp;<span class="ident" id="6498016">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6498021">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6498024">return</span>&nbsp;<span class="ident" id="6498031">dat</span><span class="op" id="6498034">[</span><span class="num" id="6498035">0</span><span class="op" id="6498036">:</span><span class="ident" id="6498037">n</span><span class="op" id="6498038">]</span><span class="op" id="6498039">,</span>&nbsp;<span class="ident" id="6498041">err</span><br>
<span class="lineno"></span><span class="op" id="6498045">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="comment" id="6498048">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="6498115">func</span>&nbsp;<span class="op" id="6498120">(</span><span class="ident" id="6498121">s</span>&nbsp;<span class="op" id="6498123">*</span><span class="ident" id="6498124">Section</span><span class="op" id="6498131">)</span>&nbsp;<span class="ident" id="6498133">Open</span><span class="op" id="6498137">(</span><span class="op" id="6498138">)</span>&nbsp;<span class="ident" id="6498140">io</span><span class="op" id="6498142">.</span><span class="ident" id="6498143">ReadSeeker</span>&nbsp;<span class="op" id="6498154">{</span>&nbsp;<span class="keyword" id="6498156">return</span>&nbsp;<span class="ident" id="6498163">io</span><span class="op" id="6498165">.</span><span class="ident" id="6498166">NewSectionReader</span><span class="op" id="6498182">(</span><span class="ident" id="6498183">s</span><span class="op" id="6498184">.</span><span class="ident" id="6498185">sr</span><span class="op" id="6498187">,</span>&nbsp;<span class="num" id="6498189">0</span><span class="op" id="6498190">,</span>&nbsp;<span class="num" id="6498192">1</span><span class="op" id="6498193">&lt;&lt;</span><span class="num" id="6498195">63</span><span class="op" id="6498197">-</span><span class="num" id="6498198">1</span><span class="op" id="6498199">)</span>&nbsp;<span class="op" id="6498201">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6498204">//&nbsp;A&nbsp;Symbol&nbsp;represents&nbsp;an&nbsp;entry&nbsp;in&nbsp;a&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;symbol&nbsp;table&nbsp;section.</span><br>
<span class="lineno">70</span><span class="keyword" id="6498276">type</span>&nbsp;<span class="ident" id="6498281">Sym</span>&nbsp;<span class="keyword" id="6498285">struct</span>&nbsp;<span class="op" id="6498292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6498295">Value</span>&nbsp;<span class="ident" id="6498301">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6498309">Type</span>&nbsp;&nbsp;<span class="builtintype" id="6498315">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6498321">Name</span>&nbsp;&nbsp;<span class="builtintype" id="6498327">string</span><br>
<span class="lineno"></span><span class="op" id="6498334">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="6498337">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;reader<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="6498368">//&nbsp;formatError&nbsp;is&nbsp;returned&nbsp;by&nbsp;some&nbsp;operations&nbsp;if&nbsp;the&nbsp;data&nbsp;does</span><br>
<span class="lineno"></span><span class="comment" id="6498431">//&nbsp;not&nbsp;have&nbsp;the&nbsp;correct&nbsp;format&nbsp;for&nbsp;an&nbsp;object&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="6498482">type</span>&nbsp;<span class="ident" id="6498487">formatError</span>&nbsp;<span class="keyword" id="6498499">struct</span>&nbsp;<span class="op" id="6498506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6498509">off</span>&nbsp;<span class="builtintype" id="6498513">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6498518">msg</span>&nbsp;<span class="builtintype" id="6498522">string</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6498530">val</span>&nbsp;<span class="keyword" id="6498534">interface</span><span class="op" id="6498543">{</span><span class="op" id="6498544">}</span><br>
<span class="lineno"></span><span class="op" id="6498546">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6498549">func</span>&nbsp;<span class="op" id="6498554">(</span><span class="ident" id="6498555">e</span>&nbsp;<span class="op" id="6498557">*</span><span class="ident" id="6498558">formatError</span><span class="op" id="6498569">)</span>&nbsp;<span class="ident" id="6498571">Error</span><span class="op" id="6498576">(</span><span class="op" id="6498577">)</span>&nbsp;<span class="builtintype" id="6498579">string</span>&nbsp;<span class="op" id="6498586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6498589">msg</span>&nbsp;<span class="op" id="6498593">:=</span>&nbsp;<span class="ident" id="6498596">e</span><span class="op" id="6498597">.</span><span class="ident" id="6498598">msg</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6498603">if</span>&nbsp;<span class="ident" id="6498606">e</span><span class="op" id="6498607">.</span><span class="ident" id="6498608">val</span>&nbsp;<span class="op" id="6498612">!=</span>&nbsp;<span class="ident" id="6498615">nil</span>&nbsp;<span class="op" id="6498619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6498623">msg</span>&nbsp;<span class="op" id="6498627">+=</span>&nbsp;<span class="ident" id="6498630">fmt</span><span class="op" id="6498633">.</span><span class="ident" id="6498634">Sprintf</span><span class="op" id="6498641">(</span><span class="string" id="6498642">&#34;&nbsp;&#39;%v&#39;&#34;</span><span class="op" id="6498649">,</span>&nbsp;<span class="ident" id="6498651">e</span><span class="op" id="6498652">.</span><span class="ident" id="6498653">val</span><span class="op" id="6498656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6498659">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6498662">msg</span>&nbsp;<span class="op" id="6498666">+=</span>&nbsp;<span class="ident" id="6498669">fmt</span><span class="op" id="6498672">.</span><span class="ident" id="6498673">Sprintf</span><span class="op" id="6498680">(</span><span class="string" id="6498681">&#34;&nbsp;in&nbsp;record&nbsp;at&nbsp;byte&nbsp;%#x&#34;</span><span class="op" id="6498705">,</span>&nbsp;<span class="ident" id="6498707">e</span><span class="op" id="6498708">.</span><span class="ident" id="6498709">off</span><span class="op" id="6498712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6498715">return</span>&nbsp;<span class="ident" id="6498722">msg</span><br>
<span class="lineno">95</span><span class="op" id="6498726">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6498729">//&nbsp;Open&nbsp;opens&nbsp;the&nbsp;named&nbsp;file&nbsp;using&nbsp;os.Open&nbsp;and&nbsp;prepares&nbsp;it&nbsp;for&nbsp;use&nbsp;as&nbsp;a&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="6498822">func</span>&nbsp;<span class="ident" id="6498827">Open</span><span class="op" id="6498831">(</span><span class="ident" id="6498832">name</span>&nbsp;<span class="builtintype" id="6498837">string</span><span class="op" id="6498843">)</span>&nbsp;<span class="op" id="6498845">(</span><span class="op" id="6498846">*</span><span class="ident" id="6498847">File</span><span class="op" id="6498851">,</span>&nbsp;<span class="builtintype" id="6498853">error</span><span class="op" id="6498858">)</span>&nbsp;<span class="op" id="6498860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6498863">f</span><span class="op" id="6498864">,</span>&nbsp;<span class="ident" id="6498866">err</span>&nbsp;<span class="op" id="6498870">:=</span>&nbsp;<span class="ident" id="6498873">os</span><span class="op" id="6498875">.</span><span class="ident" id="6498876">Open</span><span class="op" id="6498880">(</span><span class="ident" id="6498881">name</span><span class="op" id="6498885">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6498888">if</span>&nbsp;<span class="ident" id="6498891">err</span>&nbsp;<span class="op" id="6498895">!=</span>&nbsp;<span class="ident" id="6498898">nil</span>&nbsp;<span class="op" id="6498902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6498906">return</span>&nbsp;<span class="ident" id="6498913">nil</span><span class="op" id="6498916">,</span>&nbsp;<span class="ident" id="6498918">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6498923">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6498926">ff</span><span class="op" id="6498928">,</span>&nbsp;<span class="ident" id="6498930">err</span>&nbsp;<span class="op" id="6498934">:=</span>&nbsp;<span class="ident" id="6498937">NewFile</span><span class="op" id="6498944">(</span><span class="ident" id="6498945">f</span><span class="op" id="6498946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6498949">if</span>&nbsp;<span class="ident" id="6498952">err</span>&nbsp;<span class="op" id="6498956">!=</span>&nbsp;<span class="ident" id="6498959">nil</span>&nbsp;<span class="op" id="6498963">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6498967">f</span><span class="op" id="6498968">.</span><span class="ident" id="6498969">Close</span><span class="op" id="6498974">(</span><span class="op" id="6498975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6498979">return</span>&nbsp;<span class="ident" id="6498986">nil</span><span class="op" id="6498989">,</span>&nbsp;<span class="ident" id="6498991">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6498996">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6498999">ff</span><span class="op" id="6499001">.</span><span class="ident" id="6499002">closer</span>&nbsp;<span class="op" id="6499009">=</span>&nbsp;<span class="ident" id="6499011">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6499014">return</span>&nbsp;<span class="ident" id="6499021">ff</span><span class="op" id="6499023">,</span>&nbsp;<span class="ident" id="6499025">nil</span><br>
<span class="lineno">110</span><span class="op" id="6499029">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6499032">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;File.</span><br>
<span class="lineno"></span><span class="comment" id="6499058">//&nbsp;If&nbsp;the&nbsp;File&nbsp;was&nbsp;created&nbsp;using&nbsp;NewFile&nbsp;directly&nbsp;instead&nbsp;of&nbsp;Open,</span><br>
<span class="lineno"></span><span class="comment" id="6499125">//&nbsp;Close&nbsp;has&nbsp;no&nbsp;effect.</span><br>
<span class="lineno">115</span><span class="keyword" id="6499149">func</span>&nbsp;<span class="op" id="6499154">(</span><span class="ident" id="6499155">f</span>&nbsp;<span class="op" id="6499157">*</span><span class="ident" id="6499158">File</span><span class="op" id="6499162">)</span>&nbsp;<span class="ident" id="6499164">Close</span><span class="op" id="6499169">(</span><span class="op" id="6499170">)</span>&nbsp;<span class="builtintype" id="6499172">error</span>&nbsp;<span class="op" id="6499178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6499181">var</span>&nbsp;<span class="ident" id="6499185">err</span>&nbsp;<span class="builtintype" id="6499189">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6499196">if</span>&nbsp;<span class="ident" id="6499199">f</span><span class="op" id="6499200">.</span><span class="ident" id="6499201">closer</span>&nbsp;<span class="op" id="6499208">!=</span>&nbsp;<span class="ident" id="6499211">nil</span>&nbsp;<span class="op" id="6499215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6499219">err</span>&nbsp;<span class="op" id="6499223">=</span>&nbsp;<span class="ident" id="6499225">f</span><span class="op" id="6499226">.</span><span class="ident" id="6499227">closer</span><span class="op" id="6499233">.</span><span class="ident" id="6499234">Close</span><span class="op" id="6499239">(</span><span class="op" id="6499240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6499244">f</span><span class="op" id="6499245">.</span><span class="ident" id="6499246">closer</span>&nbsp;<span class="op" id="6499253">=</span>&nbsp;<span class="ident" id="6499255">nil</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6499260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6499263">return</span>&nbsp;<span class="ident" id="6499270">err</span><br>
<span class="lineno"></span><span class="op" id="6499274">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6499277">func</span>&nbsp;<span class="ident" id="6499282">parseMagic</span><span class="op" id="6499292">(</span><span class="ident" id="6499293">magic</span>&nbsp;<span class="op" id="6499299">[</span><span class="op" id="6499300">]</span><span class="builtintype" id="6499301">byte</span><span class="op" id="6499305">)</span>&nbsp;<span class="op" id="6499307">(</span><span class="builtintype" id="6499308">uint32</span><span class="op" id="6499314">,</span>&nbsp;<span class="builtintype" id="6499316">error</span><span class="op" id="6499321">)</span>&nbsp;<span class="op" id="6499323">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6499326">m</span>&nbsp;<span class="op" id="6499328">:=</span>&nbsp;<span class="ident" id="6499331">binary</span><span class="op" id="6499337">.</span><span class="ident" id="6499338">BigEndian</span><span class="op" id="6499347">.</span><span class="ident" id="6499348">Uint32</span><span class="op" id="6499354">(</span><span class="ident" id="6499355">magic</span><span class="op" id="6499360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6499363">switch</span>&nbsp;<span class="ident" id="6499370">m</span>&nbsp;<span class="op" id="6499372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6499375">case</span>&nbsp;<span class="ident" id="6499380">Magic386</span><span class="op" id="6499388">,</span>&nbsp;<span class="ident" id="6499390">MagicAMD64</span><span class="op" id="6499400">,</span>&nbsp;<span class="ident" id="6499402">MagicARM</span><span class="op" id="6499410">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6499414">return</span>&nbsp;<span class="ident" id="6499421">m</span><span class="op" id="6499422">,</span>&nbsp;<span class="ident" id="6499424">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6499429">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6499432">return</span>&nbsp;<span class="num" id="6499439">0</span><span class="op" id="6499440">,</span>&nbsp;<span class="op" id="6499442">&amp;</span><span class="ident" id="6499443">formatError</span><span class="op" id="6499454">{</span><span class="num" id="6499455">0</span><span class="op" id="6499456">,</span>&nbsp;<span class="string" id="6499458">&#34;bad&nbsp;magic&nbsp;number&#34;</span><span class="op" id="6499476">,</span>&nbsp;<span class="ident" id="6499478">magic</span><span class="op" id="6499483">}</span><br>
<span class="lineno"></span><span class="op" id="6499485">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6499488">//&nbsp;NewFile&nbsp;creates&nbsp;a&nbsp;new&nbsp;File&nbsp;for&nbsp;accessing&nbsp;a&nbsp;Plan&nbsp;9&nbsp;binary&nbsp;in&nbsp;an&nbsp;underlying&nbsp;reader.</span><br>
<span class="lineno"></span><span class="comment" id="6499573">//&nbsp;The&nbsp;Plan&nbsp;9&nbsp;binary&nbsp;is&nbsp;expected&nbsp;to&nbsp;start&nbsp;at&nbsp;position&nbsp;0&nbsp;in&nbsp;the&nbsp;ReaderAt.</span><br>
<span class="lineno">135</span><span class="keyword" id="6499646">func</span>&nbsp;<span class="ident" id="6499651">NewFile</span><span class="op" id="6499658">(</span><span class="ident" id="6499659">r</span>&nbsp;<span class="ident" id="6499661">io</span><span class="op" id="6499663">.</span><span class="ident" id="6499664">ReaderAt</span><span class="op" id="6499672">)</span>&nbsp;<span class="op" id="6499674">(</span><span class="op" id="6499675">*</span><span class="ident" id="6499676">File</span><span class="op" id="6499680">,</span>&nbsp;<span class="builtintype" id="6499682">error</span><span class="op" id="6499687">)</span>&nbsp;<span class="op" id="6499689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6499692">sr</span>&nbsp;<span class="op" id="6499695">:=</span>&nbsp;<span class="ident" id="6499698">io</span><span class="op" id="6499700">.</span><span class="ident" id="6499701">NewSectionReader</span><span class="op" id="6499717">(</span><span class="ident" id="6499718">r</span><span class="op" id="6499719">,</span>&nbsp;<span class="num" id="6499721">0</span><span class="op" id="6499722">,</span>&nbsp;<span class="num" id="6499724">1</span><span class="op" id="6499725">&lt;&lt;</span><span class="num" id="6499727">63</span><span class="op" id="6499729">-</span><span class="num" id="6499730">1</span><span class="op" id="6499731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6499734">//&nbsp;Read&nbsp;and&nbsp;decode&nbsp;Plan&nbsp;9&nbsp;magic</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6499767">var</span>&nbsp;<span class="ident" id="6499771">magic</span>&nbsp;<span class="op" id="6499777">[</span><span class="num" id="6499778">4</span><span class="op" id="6499779">]</span><span class="builtintype" id="6499780">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6499786">if</span>&nbsp;<span class="ident" id="6499789">_</span><span class="op" id="6499790">,</span>&nbsp;<span class="ident" id="6499792">err</span>&nbsp;<span class="op" id="6499796">:=</span>&nbsp;<span class="ident" id="6499799">r</span><span class="op" id="6499800">.</span><span class="ident" id="6499801">ReadAt</span><span class="op" id="6499807">(</span><span class="ident" id="6499808">magic</span><span class="op" id="6499813">[</span><span class="op" id="6499814">:</span><span class="op" id="6499815">]</span><span class="op" id="6499816">,</span>&nbsp;<span class="num" id="6499818">0</span><span class="op" id="6499819">)</span><span class="op" id="6499820">;</span>&nbsp;<span class="ident" id="6499822">err</span>&nbsp;<span class="op" id="6499826">!=</span>&nbsp;<span class="ident" id="6499829">nil</span>&nbsp;<span class="op" id="6499833">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6499837">return</span>&nbsp;<span class="ident" id="6499844">nil</span><span class="op" id="6499847">,</span>&nbsp;<span class="ident" id="6499849">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6499854">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6499857">_</span><span class="op" id="6499858">,</span>&nbsp;<span class="ident" id="6499860">err</span>&nbsp;<span class="op" id="6499864">:=</span>&nbsp;<span class="ident" id="6499867">parseMagic</span><span class="op" id="6499877">(</span><span class="ident" id="6499878">magic</span><span class="op" id="6499883">[</span><span class="op" id="6499884">:</span><span class="op" id="6499885">]</span><span class="op" id="6499886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6499889">if</span>&nbsp;<span class="ident" id="6499892">err</span>&nbsp;<span class="op" id="6499896">!=</span>&nbsp;<span class="ident" id="6499899">nil</span>&nbsp;<span class="op" id="6499903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6499907">return</span>&nbsp;<span class="ident" id="6499914">nil</span><span class="op" id="6499917">,</span>&nbsp;<span class="ident" id="6499919">err</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6499924">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6499928">ph</span>&nbsp;<span class="op" id="6499931">:=</span>&nbsp;<span class="builtinfunc" id="6499934">new</span><span class="op" id="6499937">(</span><span class="ident" id="6499938">prog</span><span class="op" id="6499942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6499945">if</span>&nbsp;<span class="ident" id="6499948">err</span>&nbsp;<span class="op" id="6499952">:=</span>&nbsp;<span class="ident" id="6499955">binary</span><span class="op" id="6499961">.</span><span class="ident" id="6499962">Read</span><span class="op" id="6499966">(</span><span class="ident" id="6499967">sr</span><span class="op" id="6499969">,</span>&nbsp;<span class="ident" id="6499971">binary</span><span class="op" id="6499977">.</span><span class="ident" id="6499978">BigEndian</span><span class="op" id="6499987">,</span>&nbsp;<span class="ident" id="6499989">ph</span><span class="op" id="6499991">)</span><span class="op" id="6499992">;</span>&nbsp;<span class="ident" id="6499994">err</span>&nbsp;<span class="op" id="6499998">!=</span>&nbsp;<span class="ident" id="6500001">nil</span>&nbsp;<span class="op" id="6500005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6500009">return</span>&nbsp;<span class="ident" id="6500016">nil</span><span class="op" id="6500019">,</span>&nbsp;<span class="ident" id="6500021">err</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6500026">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500030">f</span>&nbsp;<span class="op" id="6500032">:=</span>&nbsp;<span class="op" id="6500035">&amp;</span><span class="ident" id="6500036">File</span><span class="op" id="6500040">{</span><span class="ident" id="6500041">FileHeader</span><span class="op" id="6500051">:</span>&nbsp;<span class="ident" id="6500053">FileHeader</span><span class="op" id="6500063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500067">Magic</span><span class="op" id="6500072">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6500080">ph</span><span class="op" id="6500082">.</span><span class="ident" id="6500083">Magic</span><span class="op" id="6500088">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500092">Bss</span><span class="op" id="6500095">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6500105">ph</span><span class="op" id="6500107">.</span><span class="ident" id="6500108">Bss</span><span class="op" id="6500111">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500115">Entry</span><span class="op" id="6500120">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6500128">uint64</span><span class="op" id="6500134">(</span><span class="ident" id="6500135">ph</span><span class="op" id="6500137">.</span><span class="ident" id="6500138">Entry</span><span class="op" id="6500143">)</span><span class="op" id="6500144">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500148">PtrSize</span><span class="op" id="6500155">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6500161">4</span><span class="op" id="6500162">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500166">LoadAddress</span><span class="op" id="6500177">:</span>&nbsp;<span class="num" id="6500179">0x1000</span><span class="op" id="6500185">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500189">HdrSize</span><span class="op" id="6500196">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6500202">4</span>&nbsp;<span class="op" id="6500204">*</span>&nbsp;<span class="num" id="6500206">8</span><span class="op" id="6500207">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6500210">}</span><span class="op" id="6500211">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6500215">if</span>&nbsp;<span class="ident" id="6500218">ph</span><span class="op" id="6500220">.</span><span class="ident" id="6500221">Magic</span><span class="op" id="6500226">&amp;</span><span class="ident" id="6500227">Magic64</span>&nbsp;<span class="op" id="6500235">!=</span>&nbsp;<span class="num" id="6500238">0</span>&nbsp;<span class="op" id="6500240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6500244">if</span>&nbsp;<span class="ident" id="6500247">err</span>&nbsp;<span class="op" id="6500251">:=</span>&nbsp;<span class="ident" id="6500254">binary</span><span class="op" id="6500260">.</span><span class="ident" id="6500261">Read</span><span class="op" id="6500265">(</span><span class="ident" id="6500266">sr</span><span class="op" id="6500268">,</span>&nbsp;<span class="ident" id="6500270">binary</span><span class="op" id="6500276">.</span><span class="ident" id="6500277">BigEndian</span><span class="op" id="6500286">,</span>&nbsp;<span class="op" id="6500288">&amp;</span><span class="ident" id="6500289">f</span><span class="op" id="6500290">.</span><span class="ident" id="6500291">Entry</span><span class="op" id="6500296">)</span><span class="op" id="6500297">;</span>&nbsp;<span class="ident" id="6500299">err</span>&nbsp;<span class="op" id="6500303">!=</span>&nbsp;<span class="ident" id="6500306">nil</span>&nbsp;<span class="op" id="6500310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6500315">return</span>&nbsp;<span class="ident" id="6500322">nil</span><span class="op" id="6500325">,</span>&nbsp;<span class="ident" id="6500327">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6500333">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500337">f</span><span class="op" id="6500338">.</span><span class="ident" id="6500339">PtrSize</span>&nbsp;<span class="op" id="6500347">=</span>&nbsp;<span class="num" id="6500349">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500353">f</span><span class="op" id="6500354">.</span><span class="ident" id="6500355">LoadAddress</span>&nbsp;<span class="op" id="6500367">=</span>&nbsp;<span class="num" id="6500369">0x200000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500380">f</span><span class="op" id="6500381">.</span><span class="ident" id="6500382">HdrSize</span>&nbsp;<span class="op" id="6500390">+=</span>&nbsp;<span class="num" id="6500393">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6500396">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6500400">var</span>&nbsp;<span class="ident" id="6500404">sects</span>&nbsp;<span class="op" id="6500410">=</span>&nbsp;<span class="op" id="6500412">[</span><span class="op" id="6500413">]</span><span class="keyword" id="6500414">struct</span>&nbsp;<span class="op" id="6500421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500425">name</span>&nbsp;<span class="builtintype" id="6500430">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500439">size</span>&nbsp;<span class="builtintype" id="6500444">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6500452">}</span><span class="op" id="6500453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6500457">{</span><span class="string" id="6500458">&#34;text&#34;</span><span class="op" id="6500464">,</span>&nbsp;<span class="ident" id="6500466">ph</span><span class="op" id="6500468">.</span><span class="ident" id="6500469">Text</span><span class="op" id="6500473">}</span><span class="op" id="6500474">,</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6500478">{</span><span class="string" id="6500479">&#34;data&#34;</span><span class="op" id="6500485">,</span>&nbsp;<span class="ident" id="6500487">ph</span><span class="op" id="6500489">.</span><span class="ident" id="6500490">Data</span><span class="op" id="6500494">}</span><span class="op" id="6500495">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6500499">{</span><span class="string" id="6500500">&#34;syms&#34;</span><span class="op" id="6500506">,</span>&nbsp;<span class="ident" id="6500508">ph</span><span class="op" id="6500510">.</span><span class="ident" id="6500511">Syms</span><span class="op" id="6500515">}</span><span class="op" id="6500516">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6500520">{</span><span class="string" id="6500521">&#34;spsz&#34;</span><span class="op" id="6500527">,</span>&nbsp;<span class="ident" id="6500529">ph</span><span class="op" id="6500531">.</span><span class="ident" id="6500532">Spsz</span><span class="op" id="6500536">}</span><span class="op" id="6500537">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6500541">{</span><span class="string" id="6500542">&#34;pcsz&#34;</span><span class="op" id="6500548">,</span>&nbsp;<span class="ident" id="6500550">ph</span><span class="op" id="6500552">.</span><span class="ident" id="6500553">Pcsz</span><span class="op" id="6500557">}</span><span class="op" id="6500558">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6500561">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500565">f</span><span class="op" id="6500566">.</span><span class="ident" id="6500567">Sections</span>&nbsp;<span class="op" id="6500576">=</span>&nbsp;<span class="builtinfunc" id="6500578">make</span><span class="op" id="6500582">(</span><span class="op" id="6500583">[</span><span class="op" id="6500584">]</span><span class="op" id="6500585">*</span><span class="ident" id="6500586">Section</span><span class="op" id="6500593">,</span>&nbsp;<span class="num" id="6500595">5</span><span class="op" id="6500596">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500600">off</span>&nbsp;<span class="op" id="6500604">:=</span>&nbsp;<span class="builtintype" id="6500607">uint32</span><span class="op" id="6500613">(</span><span class="ident" id="6500614">f</span><span class="op" id="6500615">.</span><span class="ident" id="6500616">HdrSize</span><span class="op" id="6500623">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6500627">for</span>&nbsp;<span class="ident" id="6500631">i</span><span class="op" id="6500632">,</span>&nbsp;<span class="ident" id="6500634">sect</span>&nbsp;<span class="op" id="6500639">:=</span>&nbsp;<span class="keyword" id="6500642">range</span>&nbsp;<span class="ident" id="6500648">sects</span>&nbsp;<span class="op" id="6500654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500658">s</span>&nbsp;<span class="op" id="6500660">:=</span>&nbsp;<span class="builtinfunc" id="6500663">new</span><span class="op" id="6500666">(</span><span class="ident" id="6500667">Section</span><span class="op" id="6500674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500678">s</span><span class="op" id="6500679">.</span><span class="ident" id="6500680">SectionHeader</span>&nbsp;<span class="op" id="6500694">=</span>&nbsp;<span class="ident" id="6500696">SectionHeader</span><span class="op" id="6500709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500714">Name</span><span class="op" id="6500718">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6500722">sect</span><span class="op" id="6500726">.</span><span class="ident" id="6500727">name</span><span class="op" id="6500731">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500736">Size</span><span class="op" id="6500740">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6500744">sect</span><span class="op" id="6500748">.</span><span class="ident" id="6500749">size</span><span class="op" id="6500753">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500758">Offset</span><span class="op" id="6500764">:</span>&nbsp;<span class="ident" id="6500766">off</span><span class="op" id="6500769">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6500773">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500777">off</span>&nbsp;<span class="op" id="6500781">+=</span>&nbsp;<span class="ident" id="6500784">sect</span><span class="op" id="6500788">.</span><span class="ident" id="6500789">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500796">s</span><span class="op" id="6500797">.</span><span class="ident" id="6500798">sr</span>&nbsp;<span class="op" id="6500801">=</span>&nbsp;<span class="ident" id="6500803">io</span><span class="op" id="6500805">.</span><span class="ident" id="6500806">NewSectionReader</span><span class="op" id="6500822">(</span><span class="ident" id="6500823">r</span><span class="op" id="6500824">,</span>&nbsp;<span class="ident" id="6500826">int64</span><span class="op" id="6500831">(</span><span class="ident" id="6500832">s</span><span class="op" id="6500833">.</span><span class="ident" id="6500834">Offset</span><span class="op" id="6500840">)</span><span class="op" id="6500841">,</span>&nbsp;<span class="ident" id="6500843">int64</span><span class="op" id="6500848">(</span><span class="ident" id="6500849">s</span><span class="op" id="6500850">.</span><span class="ident" id="6500851">Size</span><span class="op" id="6500855">)</span><span class="op" id="6500856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500860">s</span><span class="op" id="6500861">.</span><span class="ident" id="6500862">ReaderAt</span>&nbsp;<span class="op" id="6500871">=</span>&nbsp;<span class="ident" id="6500873">s</span><span class="op" id="6500874">.</span><span class="ident" id="6500875">sr</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500880">f</span><span class="op" id="6500881">.</span><span class="ident" id="6500882">Sections</span><span class="op" id="6500890">[</span><span class="ident" id="6500891">i</span><span class="op" id="6500892">]</span>&nbsp;<span class="op" id="6500894">=</span>&nbsp;<span class="ident" id="6500896">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6500899">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6500903">return</span>&nbsp;<span class="ident" id="6500910">f</span><span class="op" id="6500911">,</span>&nbsp;<span class="ident" id="6500913">nil</span><br>
<span class="lineno"></span><span class="op" id="6500917">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span><span class="keyword" id="6500920">func</span>&nbsp;<span class="ident" id="6500925">walksymtab</span><span class="op" id="6500935">(</span><span class="ident" id="6500936">data</span>&nbsp;<span class="op" id="6500941">[</span><span class="op" id="6500942">]</span><span class="builtintype" id="6500943">byte</span><span class="op" id="6500947">,</span>&nbsp;<span class="ident" id="6500949">ptrsz</span>&nbsp;<span class="builtintype" id="6500955">int</span><span class="op" id="6500958">,</span>&nbsp;<span class="ident" id="6500960">fn</span>&nbsp;<span class="keyword" id="6500963">func</span><span class="op" id="6500967">(</span><span class="ident" id="6500968">sym</span><span class="op" id="6500971">)</span>&nbsp;<span class="builtintype" id="6500973">error</span><span class="op" id="6500978">)</span>&nbsp;<span class="builtintype" id="6500980">error</span>&nbsp;<span class="op" id="6500986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6500989">var</span>&nbsp;<span class="ident" id="6500993">order</span>&nbsp;<span class="ident" id="6500999">binary</span><span class="op" id="6501005">.</span><span class="ident" id="6501006">ByteOrder</span>&nbsp;<span class="op" id="6501016">=</span>&nbsp;<span class="ident" id="6501018">binary</span><span class="op" id="6501024">.</span><span class="ident" id="6501025">BigEndian</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501036">var</span>&nbsp;<span class="ident" id="6501040">s</span>&nbsp;<span class="ident" id="6501042">sym</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501047">p</span>&nbsp;<span class="op" id="6501049">:=</span>&nbsp;<span class="ident" id="6501052">data</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501058">for</span>&nbsp;<span class="builtinfunc" id="6501062">len</span><span class="op" id="6501065">(</span><span class="ident" id="6501066">p</span><span class="op" id="6501067">)</span>&nbsp;<span class="op" id="6501069">&gt;=</span>&nbsp;<span class="num" id="6501072">4</span>&nbsp;<span class="op" id="6501074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6501078">//&nbsp;Symbol&nbsp;type,&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501103">if</span>&nbsp;<span class="builtinfunc" id="6501106">len</span><span class="op" id="6501109">(</span><span class="ident" id="6501110">p</span><span class="op" id="6501111">)</span>&nbsp;<span class="op" id="6501113">&lt;</span>&nbsp;<span class="ident" id="6501115">ptrsz</span>&nbsp;<span class="op" id="6501121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501126">return</span>&nbsp;<span class="op" id="6501133">&amp;</span><span class="ident" id="6501134">formatError</span><span class="op" id="6501145">{</span><span class="builtinfunc" id="6501146">len</span><span class="op" id="6501149">(</span><span class="ident" id="6501150">data</span><span class="op" id="6501154">)</span><span class="op" id="6501155">,</span>&nbsp;<span class="string" id="6501157">&#34;unexpected&nbsp;EOF&#34;</span><span class="op" id="6501173">,</span>&nbsp;<span class="ident" id="6501175">nil</span><span class="op" id="6501178">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6501182">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6501186">//&nbsp;fixed-width&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501209">if</span>&nbsp;<span class="ident" id="6501212">ptrsz</span>&nbsp;<span class="op" id="6501218">==</span>&nbsp;<span class="num" id="6501221">8</span>&nbsp;<span class="op" id="6501223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501228">s</span><span class="op" id="6501229">.</span><span class="ident" id="6501230">value</span>&nbsp;<span class="op" id="6501236">=</span>&nbsp;<span class="ident" id="6501238">order</span><span class="op" id="6501243">.</span><span class="ident" id="6501244">Uint64</span><span class="op" id="6501250">(</span><span class="ident" id="6501251">p</span><span class="op" id="6501252">[</span><span class="num" id="6501253">0</span><span class="op" id="6501254">:</span><span class="num" id="6501255">8</span><span class="op" id="6501256">]</span><span class="op" id="6501257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501262">p</span>&nbsp;<span class="op" id="6501264">=</span>&nbsp;<span class="ident" id="6501266">p</span><span class="op" id="6501267">[</span><span class="num" id="6501268">8</span><span class="op" id="6501269">:</span><span class="op" id="6501270">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6501274">}</span>&nbsp;<span class="keyword" id="6501276">else</span>&nbsp;<span class="op" id="6501281">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501286">s</span><span class="op" id="6501287">.</span><span class="ident" id="6501288">value</span>&nbsp;<span class="op" id="6501294">=</span>&nbsp;<span class="ident" id="6501296">uint64</span><span class="op" id="6501302">(</span><span class="ident" id="6501303">order</span><span class="op" id="6501308">.</span><span class="ident" id="6501309">Uint32</span><span class="op" id="6501315">(</span><span class="ident" id="6501316">p</span><span class="op" id="6501317">[</span><span class="num" id="6501318">0</span><span class="op" id="6501319">:</span><span class="num" id="6501320">4</span><span class="op" id="6501321">]</span><span class="op" id="6501322">)</span><span class="op" id="6501323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501328">p</span>&nbsp;<span class="op" id="6501330">=</span>&nbsp;<span class="ident" id="6501332">p</span><span class="op" id="6501333">[</span><span class="num" id="6501334">4</span><span class="op" id="6501335">:</span><span class="op" id="6501336">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6501340">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501345">var</span>&nbsp;<span class="ident" id="6501349">typ</span>&nbsp;<span class="builtintype" id="6501353">byte</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501360">typ</span>&nbsp;<span class="op" id="6501364">=</span>&nbsp;<span class="ident" id="6501366">p</span><span class="op" id="6501367">[</span><span class="num" id="6501368">0</span><span class="op" id="6501369">]</span>&nbsp;<span class="op" id="6501371">&amp;</span>&nbsp;<span class="num" id="6501373">0x7F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501380">s</span><span class="op" id="6501381">.</span><span class="ident" id="6501382">typ</span>&nbsp;<span class="op" id="6501386">=</span>&nbsp;<span class="ident" id="6501388">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501394">p</span>&nbsp;<span class="op" id="6501396">=</span>&nbsp;<span class="ident" id="6501398">p</span><span class="op" id="6501399">[</span><span class="num" id="6501400">1</span><span class="op" id="6501401">:</span><span class="op" id="6501402">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6501407">//&nbsp;Name.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501418">var</span>&nbsp;<span class="ident" id="6501422">i</span>&nbsp;<span class="builtintype" id="6501424">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501430">var</span>&nbsp;<span class="ident" id="6501434">nnul</span>&nbsp;<span class="builtintype" id="6501439">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501445">for</span>&nbsp;<span class="ident" id="6501449">i</span>&nbsp;<span class="op" id="6501451">=</span>&nbsp;<span class="num" id="6501453">0</span><span class="op" id="6501454">;</span>&nbsp;<span class="ident" id="6501456">i</span>&nbsp;<span class="op" id="6501458">&lt;</span>&nbsp;<span class="builtinfunc" id="6501460">len</span><span class="op" id="6501463">(</span><span class="ident" id="6501464">p</span><span class="op" id="6501465">)</span><span class="op" id="6501466">;</span>&nbsp;<span class="ident" id="6501468">i</span><span class="op" id="6501469">++</span>&nbsp;<span class="op" id="6501472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501477">if</span>&nbsp;<span class="ident" id="6501480">p</span><span class="op" id="6501481">[</span><span class="ident" id="6501482">i</span><span class="op" id="6501483">]</span>&nbsp;<span class="op" id="6501485">==</span>&nbsp;<span class="num" id="6501488">0</span>&nbsp;<span class="op" id="6501490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501496">nnul</span>&nbsp;<span class="op" id="6501501">=</span>&nbsp;<span class="num" id="6501503">1</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501509">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6501518">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6501522">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501526">switch</span>&nbsp;<span class="ident" id="6501533">typ</span>&nbsp;<span class="op" id="6501537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501541">case</span>&nbsp;<span class="string" id="6501546">&#39;z&#39;</span><span class="op" id="6501549">,</span>&nbsp;<span class="string" id="6501551">&#39;Z&#39;</span><span class="op" id="6501554">:</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501559">p</span>&nbsp;<span class="op" id="6501561">=</span>&nbsp;<span class="ident" id="6501563">p</span><span class="op" id="6501564">[</span><span class="ident" id="6501565">i</span><span class="op" id="6501566">+</span><span class="ident" id="6501567">nnul</span><span class="op" id="6501571">:</span><span class="op" id="6501572">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501577">for</span>&nbsp;<span class="ident" id="6501581">i</span>&nbsp;<span class="op" id="6501583">=</span>&nbsp;<span class="num" id="6501585">0</span><span class="op" id="6501586">;</span>&nbsp;<span class="ident" id="6501588">i</span><span class="op" id="6501589">+</span><span class="num" id="6501590">2</span>&nbsp;<span class="op" id="6501592">&lt;=</span>&nbsp;<span class="builtinfunc" id="6501595">len</span><span class="op" id="6501598">(</span><span class="ident" id="6501599">p</span><span class="op" id="6501600">)</span><span class="op" id="6501601">;</span>&nbsp;<span class="ident" id="6501603">i</span>&nbsp;<span class="op" id="6501605">+=</span>&nbsp;<span class="num" id="6501608">2</span>&nbsp;<span class="op" id="6501610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501616">if</span>&nbsp;<span class="ident" id="6501619">p</span><span class="op" id="6501620">[</span><span class="ident" id="6501621">i</span><span class="op" id="6501622">]</span>&nbsp;<span class="op" id="6501624">==</span>&nbsp;<span class="num" id="6501627">0</span>&nbsp;<span class="op" id="6501629">&amp;&amp;</span>&nbsp;<span class="ident" id="6501632">p</span><span class="op" id="6501633">[</span><span class="ident" id="6501634">i</span><span class="op" id="6501635">+</span><span class="num" id="6501636">1</span><span class="op" id="6501637">]</span>&nbsp;<span class="op" id="6501639">==</span>&nbsp;<span class="num" id="6501642">0</span>&nbsp;<span class="op" id="6501644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501651">nnul</span>&nbsp;<span class="op" id="6501656">=</span>&nbsp;<span class="num" id="6501658">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501665">break</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6501675">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6501680">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6501684">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501688">if</span>&nbsp;<span class="builtinfunc" id="6501691">len</span><span class="op" id="6501694">(</span><span class="ident" id="6501695">p</span><span class="op" id="6501696">)</span>&nbsp;<span class="op" id="6501698">&lt;</span>&nbsp;<span class="ident" id="6501700">i</span><span class="op" id="6501701">+</span><span class="ident" id="6501702">nnul</span>&nbsp;<span class="op" id="6501707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501712">return</span>&nbsp;<span class="op" id="6501719">&amp;</span><span class="ident" id="6501720">formatError</span><span class="op" id="6501731">{</span><span class="builtinfunc" id="6501732">len</span><span class="op" id="6501735">(</span><span class="ident" id="6501736">data</span><span class="op" id="6501740">)</span><span class="op" id="6501741">,</span>&nbsp;<span class="string" id="6501743">&#34;unexpected&nbsp;EOF&#34;</span><span class="op" id="6501759">,</span>&nbsp;<span class="ident" id="6501761">nil</span><span class="op" id="6501764">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6501768">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501772">s</span><span class="op" id="6501773">.</span><span class="ident" id="6501774">name</span>&nbsp;<span class="op" id="6501779">=</span>&nbsp;<span class="ident" id="6501781">p</span><span class="op" id="6501782">[</span><span class="num" id="6501783">0</span><span class="op" id="6501784">:</span><span class="ident" id="6501785">i</span><span class="op" id="6501786">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501790">i</span>&nbsp;<span class="op" id="6501792">+=</span>&nbsp;<span class="ident" id="6501795">nnul</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501802">p</span>&nbsp;<span class="op" id="6501804">=</span>&nbsp;<span class="ident" id="6501806">p</span><span class="op" id="6501807">[</span><span class="ident" id="6501808">i</span><span class="op" id="6501809">:</span><span class="op" id="6501810">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501815">fn</span><span class="op" id="6501817">(</span><span class="ident" id="6501818">s</span><span class="op" id="6501819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6501822">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501825">return</span>&nbsp;<span class="ident" id="6501832">nil</span><br>
<span class="lineno"></span><span class="op" id="6501836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="comment" id="6501839">//&nbsp;NewTable&nbsp;decodes&nbsp;the&nbsp;Go&nbsp;symbol&nbsp;table&nbsp;in&nbsp;data,</span><br>
<span class="lineno"></span><span class="comment" id="6501888">//&nbsp;returning&nbsp;an&nbsp;in-memory&nbsp;representation.</span><br>
<span class="lineno"></span><span class="keyword" id="6501930">func</span>&nbsp;<span class="ident" id="6501935">newTable</span><span class="op" id="6501943">(</span><span class="ident" id="6501944">symtab</span>&nbsp;<span class="op" id="6501951">[</span><span class="op" id="6501952">]</span><span class="builtintype" id="6501953">byte</span><span class="op" id="6501957">,</span>&nbsp;<span class="ident" id="6501959">ptrsz</span>&nbsp;<span class="builtintype" id="6501965">int</span><span class="op" id="6501968">)</span>&nbsp;<span class="op" id="6501970">(</span><span class="op" id="6501971">[</span><span class="op" id="6501972">]</span><span class="ident" id="6501973">Sym</span><span class="op" id="6501976">,</span>&nbsp;<span class="builtintype" id="6501978">error</span><span class="op" id="6501983">)</span>&nbsp;<span class="op" id="6501985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501988">var</span>&nbsp;<span class="ident" id="6501992">n</span>&nbsp;<span class="builtintype" id="6501994">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501999">err</span>&nbsp;<span class="op" id="6502003">:=</span>&nbsp;<span class="ident" id="6502006">walksymtab</span><span class="op" id="6502016">(</span><span class="ident" id="6502017">symtab</span><span class="op" id="6502023">,</span>&nbsp;<span class="ident" id="6502025">ptrsz</span><span class="op" id="6502030">,</span>&nbsp;<span class="keyword" id="6502032">func</span><span class="op" id="6502036">(</span><span class="ident" id="6502037">s</span>&nbsp;<span class="ident" id="6502039">sym</span><span class="op" id="6502042">)</span>&nbsp;<span class="builtintype" id="6502044">error</span>&nbsp;<span class="op" id="6502050">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502054">n</span><span class="op" id="6502055">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502060">return</span>&nbsp;<span class="ident" id="6502067">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6502072">}</span><span class="op" id="6502073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502076">if</span>&nbsp;<span class="ident" id="6502079">err</span>&nbsp;<span class="op" id="6502083">!=</span>&nbsp;<span class="ident" id="6502086">nil</span>&nbsp;<span class="op" id="6502090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502094">return</span>&nbsp;<span class="ident" id="6502101">nil</span><span class="op" id="6502104">,</span>&nbsp;<span class="ident" id="6502106">err</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6502111">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502115">fname</span>&nbsp;<span class="op" id="6502121">:=</span>&nbsp;<span class="builtinfunc" id="6502124">make</span><span class="op" id="6502128">(</span><span class="keyword" id="6502129">map</span><span class="op" id="6502132">[</span><span class="builtintype" id="6502133">uint16</span><span class="op" id="6502139">]</span><span class="builtintype" id="6502140">string</span><span class="op" id="6502146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502149">syms</span>&nbsp;<span class="op" id="6502154">:=</span>&nbsp;<span class="builtinfunc" id="6502157">make</span><span class="op" id="6502161">(</span><span class="op" id="6502162">[</span><span class="op" id="6502163">]</span><span class="ident" id="6502164">Sym</span><span class="op" id="6502167">,</span>&nbsp;<span class="num" id="6502169">0</span><span class="op" id="6502170">,</span>&nbsp;<span class="ident" id="6502172">n</span><span class="op" id="6502173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502176">err</span>&nbsp;<span class="op" id="6502180">=</span>&nbsp;<span class="ident" id="6502182">walksymtab</span><span class="op" id="6502192">(</span><span class="ident" id="6502193">symtab</span><span class="op" id="6502199">,</span>&nbsp;<span class="ident" id="6502201">ptrsz</span><span class="op" id="6502206">,</span>&nbsp;<span class="keyword" id="6502208">func</span><span class="op" id="6502212">(</span><span class="ident" id="6502213">s</span>&nbsp;<span class="ident" id="6502215">sym</span><span class="op" id="6502218">)</span>&nbsp;<span class="builtintype" id="6502220">error</span>&nbsp;<span class="op" id="6502226">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502230">n</span>&nbsp;<span class="op" id="6502232">:=</span>&nbsp;<span class="builtinfunc" id="6502235">len</span><span class="op" id="6502238">(</span><span class="ident" id="6502239">syms</span><span class="op" id="6502243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502247">syms</span>&nbsp;<span class="op" id="6502252">=</span>&nbsp;<span class="ident" id="6502254">syms</span><span class="op" id="6502258">[</span><span class="num" id="6502259">0</span>&nbsp;<span class="op" id="6502261">:</span>&nbsp;<span class="ident" id="6502263">n</span><span class="op" id="6502264">+</span><span class="num" id="6502265">1</span><span class="op" id="6502266">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502270">ts</span>&nbsp;<span class="op" id="6502273">:=</span>&nbsp;<span class="op" id="6502276">&amp;</span><span class="ident" id="6502277">syms</span><span class="op" id="6502281">[</span><span class="ident" id="6502282">n</span><span class="op" id="6502283">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502287">ts</span><span class="op" id="6502289">.</span><span class="ident" id="6502290">Type</span>&nbsp;<span class="op" id="6502295">=</span>&nbsp;<span class="builtintype" id="6502297">rune</span><span class="op" id="6502301">(</span><span class="ident" id="6502302">s</span><span class="op" id="6502303">.</span><span class="ident" id="6502304">typ</span><span class="op" id="6502307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502311">ts</span><span class="op" id="6502313">.</span><span class="ident" id="6502314">Value</span>&nbsp;<span class="op" id="6502320">=</span>&nbsp;<span class="ident" id="6502322">s</span><span class="op" id="6502323">.</span><span class="ident" id="6502324">value</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502332">switch</span>&nbsp;<span class="ident" id="6502339">s</span><span class="op" id="6502340">.</span><span class="ident" id="6502341">typ</span>&nbsp;<span class="op" id="6502345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502349">default</span><span class="op" id="6502356">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502361">ts</span><span class="op" id="6502363">.</span><span class="ident" id="6502364">Name</span>&nbsp;<span class="op" id="6502369">=</span>&nbsp;<span class="builtintype" id="6502371">string</span><span class="op" id="6502377">(</span><span class="ident" id="6502378">s</span><span class="op" id="6502379">.</span><span class="ident" id="6502380">name</span><span class="op" id="6502384">[</span><span class="op" id="6502385">:</span><span class="op" id="6502386">]</span><span class="op" id="6502387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502391">case</span>&nbsp;<span class="string" id="6502396">&#39;z&#39;</span><span class="op" id="6502399">,</span>&nbsp;<span class="string" id="6502401">&#39;Z&#39;</span><span class="op" id="6502404">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502409">for</span>&nbsp;<span class="ident" id="6502413">i</span>&nbsp;<span class="op" id="6502415">:=</span>&nbsp;<span class="num" id="6502418">0</span><span class="op" id="6502419">;</span>&nbsp;<span class="ident" id="6502421">i</span>&nbsp;<span class="op" id="6502423">&lt;</span>&nbsp;<span class="builtinfunc" id="6502425">len</span><span class="op" id="6502428">(</span><span class="ident" id="6502429">s</span><span class="op" id="6502430">.</span><span class="ident" id="6502431">name</span><span class="op" id="6502435">)</span><span class="op" id="6502436">;</span>&nbsp;<span class="ident" id="6502438">i</span>&nbsp;<span class="op" id="6502440">+=</span>&nbsp;<span class="num" id="6502443">2</span>&nbsp;<span class="op" id="6502445">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502451">eltIdx</span>&nbsp;<span class="op" id="6502458">:=</span>&nbsp;<span class="ident" id="6502461">binary</span><span class="op" id="6502467">.</span><span class="ident" id="6502468">BigEndian</span><span class="op" id="6502477">.</span><span class="ident" id="6502478">Uint16</span><span class="op" id="6502484">(</span><span class="ident" id="6502485">s</span><span class="op" id="6502486">.</span><span class="ident" id="6502487">name</span><span class="op" id="6502491">[</span><span class="ident" id="6502492">i</span>&nbsp;<span class="op" id="6502494">:</span>&nbsp;<span class="ident" id="6502496">i</span><span class="op" id="6502497">+</span><span class="num" id="6502498">2</span><span class="op" id="6502499">]</span><span class="op" id="6502500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502506">elt</span><span class="op" id="6502509">,</span>&nbsp;<span class="ident" id="6502511">ok</span>&nbsp;<span class="op" id="6502514">:=</span>&nbsp;<span class="ident" id="6502517">fname</span><span class="op" id="6502522">[</span><span class="ident" id="6502523">eltIdx</span><span class="op" id="6502529">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502535">if</span>&nbsp;<span class="op" id="6502538">!</span><span class="ident" id="6502539">ok</span>&nbsp;<span class="op" id="6502542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502549">return</span>&nbsp;<span class="op" id="6502556">&amp;</span><span class="ident" id="6502557">formatError</span><span class="op" id="6502568">{</span><span class="op" id="6502569">-</span><span class="num" id="6502570">1</span><span class="op" id="6502571">,</span>&nbsp;<span class="string" id="6502573">&#34;bad&nbsp;filename&nbsp;code&#34;</span><span class="op" id="6502592">,</span>&nbsp;<span class="ident" id="6502594">eltIdx</span><span class="op" id="6502600">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6502606">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502612">if</span>&nbsp;<span class="ident" id="6502615">n</span>&nbsp;<span class="op" id="6502617">:=</span>&nbsp;<span class="builtinfunc" id="6502620">len</span><span class="op" id="6502623">(</span><span class="ident" id="6502624">ts</span><span class="op" id="6502626">.</span><span class="ident" id="6502627">Name</span><span class="op" id="6502631">)</span><span class="op" id="6502632">;</span>&nbsp;<span class="ident" id="6502634">n</span>&nbsp;<span class="op" id="6502636">&gt;</span>&nbsp;<span class="num" id="6502638">0</span>&nbsp;<span class="op" id="6502640">&amp;&amp;</span>&nbsp;<span class="ident" id="6502643">ts</span><span class="op" id="6502645">.</span><span class="ident" id="6502646">Name</span><span class="op" id="6502650">[</span><span class="ident" id="6502651">n</span><span class="op" id="6502652">-</span><span class="num" id="6502653">1</span><span class="op" id="6502654">]</span>&nbsp;<span class="op" id="6502656">!=</span>&nbsp;<span class="string" id="6502659">&#39;/&#39;</span>&nbsp;<span class="op" id="6502663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502670">ts</span><span class="op" id="6502672">.</span><span class="ident" id="6502673">Name</span>&nbsp;<span class="op" id="6502678">+=</span>&nbsp;<span class="string" id="6502681">&#34;/&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6502689">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502695">ts</span><span class="op" id="6502697">.</span><span class="ident" id="6502698">Name</span>&nbsp;<span class="op" id="6502703">+=</span>&nbsp;<span class="ident" id="6502706">elt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6502713">}</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6502717">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502721">switch</span>&nbsp;<span class="ident" id="6502728">s</span><span class="op" id="6502729">.</span><span class="ident" id="6502730">typ</span>&nbsp;<span class="op" id="6502734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502738">case</span>&nbsp;<span class="string" id="6502743">&#39;f&#39;</span><span class="op" id="6502746">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502751">fname</span><span class="op" id="6502756">[</span><span class="builtintype" id="6502757">uint16</span><span class="op" id="6502763">(</span><span class="ident" id="6502764">s</span><span class="op" id="6502765">.</span><span class="ident" id="6502766">value</span><span class="op" id="6502771">)</span><span class="op" id="6502772">]</span>&nbsp;<span class="op" id="6502774">=</span>&nbsp;<span class="ident" id="6502776">ts</span><span class="op" id="6502778">.</span><span class="ident" id="6502779">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6502786">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502790">return</span>&nbsp;<span class="ident" id="6502797">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6502802">}</span><span class="op" id="6502803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502806">if</span>&nbsp;<span class="ident" id="6502809">err</span>&nbsp;<span class="op" id="6502813">!=</span>&nbsp;<span class="ident" id="6502816">nil</span>&nbsp;<span class="op" id="6502820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502824">return</span>&nbsp;<span class="ident" id="6502831">nil</span><span class="op" id="6502834">,</span>&nbsp;<span class="ident" id="6502836">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6502841">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502845">return</span>&nbsp;<span class="ident" id="6502852">syms</span><span class="op" id="6502856">,</span>&nbsp;<span class="ident" id="6502858">nil</span><br>
<span class="lineno"></span><span class="op" id="6502862">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6502865">//&nbsp;Symbols&nbsp;returns&nbsp;the&nbsp;symbol&nbsp;table&nbsp;for&nbsp;f.</span><br>
<span class="lineno">305</span><span class="keyword" id="6502908">func</span>&nbsp;<span class="op" id="6502913">(</span><span class="ident" id="6502914">f</span>&nbsp;<span class="op" id="6502916">*</span><span class="ident" id="6502917">File</span><span class="op" id="6502921">)</span>&nbsp;<span class="ident" id="6502923">Symbols</span><span class="op" id="6502930">(</span><span class="op" id="6502931">)</span>&nbsp;<span class="op" id="6502933">(</span><span class="op" id="6502934">[</span><span class="op" id="6502935">]</span><span class="ident" id="6502936">Sym</span><span class="op" id="6502939">,</span>&nbsp;<span class="builtintype" id="6502941">error</span><span class="op" id="6502946">)</span>&nbsp;<span class="op" id="6502948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502951">symtabSection</span>&nbsp;<span class="op" id="6502965">:=</span>&nbsp;<span class="ident" id="6502968">f</span><span class="op" id="6502969">.</span><span class="ident" id="6502970">Section</span><span class="op" id="6502977">(</span><span class="string" id="6502978">&#34;syms&#34;</span><span class="op" id="6502984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502987">if</span>&nbsp;<span class="ident" id="6502990">symtabSection</span>&nbsp;<span class="op" id="6503004">==</span>&nbsp;<span class="ident" id="6503007">nil</span>&nbsp;<span class="op" id="6503011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6503015">return</span>&nbsp;<span class="ident" id="6503022">nil</span><span class="op" id="6503025">,</span>&nbsp;<span class="ident" id="6503027">errors</span><span class="op" id="6503033">.</span><span class="ident" id="6503034">New</span><span class="op" id="6503037">(</span><span class="string" id="6503038">&#34;no&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="6503057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6503060">}</span><br>
<span class="lineno">310</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6503064">symtab</span><span class="op" id="6503070">,</span>&nbsp;<span class="ident" id="6503072">err</span>&nbsp;<span class="op" id="6503076">:=</span>&nbsp;<span class="ident" id="6503079">symtabSection</span><span class="op" id="6503092">.</span><span class="ident" id="6503093">Data</span><span class="op" id="6503097">(</span><span class="op" id="6503098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6503101">if</span>&nbsp;<span class="ident" id="6503104">err</span>&nbsp;<span class="op" id="6503108">!=</span>&nbsp;<span class="ident" id="6503111">nil</span>&nbsp;<span class="op" id="6503115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6503119">return</span>&nbsp;<span class="ident" id="6503126">nil</span><span class="op" id="6503129">,</span>&nbsp;<span class="ident" id="6503131">errors</span><span class="op" id="6503137">.</span><span class="ident" id="6503138">New</span><span class="op" id="6503141">(</span><span class="string" id="6503142">&#34;cannot&nbsp;load&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="6503170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6503173">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6503177">return</span>&nbsp;<span class="ident" id="6503184">newTable</span><span class="op" id="6503192">(</span><span class="ident" id="6503193">symtab</span><span class="op" id="6503199">,</span>&nbsp;<span class="ident" id="6503201">f</span><span class="op" id="6503202">.</span><span class="ident" id="6503203">PtrSize</span><span class="op" id="6503210">)</span><br>
<span class="lineno"></span><span class="op" id="6503212">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6503215">//&nbsp;Section&nbsp;returns&nbsp;a&nbsp;section&nbsp;with&nbsp;the&nbsp;given&nbsp;name,&nbsp;or&nbsp;nil&nbsp;if&nbsp;no&nbsp;such</span><br>
<span class="lineno">320</span><span class="comment" id="6503283">//&nbsp;section&nbsp;exists.</span><br>
<span class="lineno"></span><span class="keyword" id="6503302">func</span>&nbsp;<span class="op" id="6503307">(</span><span class="ident" id="6503308">f</span>&nbsp;<span class="op" id="6503310">*</span><span class="ident" id="6503311">File</span><span class="op" id="6503315">)</span>&nbsp;<span class="ident" id="6503317">Section</span><span class="op" id="6503324">(</span><span class="ident" id="6503325">name</span>&nbsp;<span class="builtintype" id="6503330">string</span><span class="op" id="6503336">)</span>&nbsp;<span class="op" id="6503338">*</span><span class="ident" id="6503339">Section</span>&nbsp;<span class="op" id="6503347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6503350">for</span>&nbsp;<span class="ident" id="6503354">_</span><span class="op" id="6503355">,</span>&nbsp;<span class="ident" id="6503357">s</span>&nbsp;<span class="op" id="6503359">:=</span>&nbsp;<span class="keyword" id="6503362">range</span>&nbsp;<span class="ident" id="6503368">f</span><span class="op" id="6503369">.</span><span class="ident" id="6503370">Sections</span>&nbsp;<span class="op" id="6503379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6503383">if</span>&nbsp;<span class="ident" id="6503386">s</span><span class="op" id="6503387">.</span><span class="ident" id="6503388">Name</span>&nbsp;<span class="op" id="6503393">==</span>&nbsp;<span class="ident" id="6503396">name</span>&nbsp;<span class="op" id="6503401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6503406">return</span>&nbsp;<span class="ident" id="6503413">s</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6503417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6503420">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6503423">return</span>&nbsp;<span class="ident" id="6503430">nil</span><br>
<span class="lineno"></span><span class="op" id="6503434">}</span>
</div>
</body>
</html>
