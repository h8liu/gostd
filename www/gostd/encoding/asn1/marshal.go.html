<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/asn1</h2>
<ul>
<li><a href="/gostd/encoding/asn1/asn1.go.html">asn1.go</a></li>
<li><a href="/gostd/encoding/asn1/asn1_test.go.html">asn1_test.go</a></li>
<li><a href="/gostd/encoding/asn1/common.go.html">common.go</a></li>
<li><a href="/gostd/encoding/asn1/marshal.go.html">marshal.go</a></li>
<li><a href="/gostd/encoding/asn1/marshal_test.go.html">marshal_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4870745">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4870800">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4870854">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4870905">package</span>&nbsp;<span class="ident" id="4870913">asn1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4870919">import</span>&nbsp;<span class="op" id="4870926">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4870929">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4870938">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4870948">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4870955">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4870961">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4870973">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4870984">&#34;time&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4870992">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="4871007">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4871010">//&nbsp;A&nbsp;forkableWriter&nbsp;is&nbsp;an&nbsp;in-memory&nbsp;buffer&nbsp;that&nbsp;can&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="4871065">//&nbsp;&#39;forked&#39;&nbsp;to&nbsp;create&nbsp;new&nbsp;forkableWriters&nbsp;that&nbsp;bracket&nbsp;the</span><br>
<span class="lineno">20</span><span class="comment" id="4871124">//&nbsp;original.&nbsp;&nbsp;After</span><br>
<span class="lineno"></span><span class="comment" id="4871144">//&nbsp;&nbsp;&nbsp;&nbsp;pre,&nbsp;post&nbsp;:=&nbsp;w.fork();</span><br>
<span class="lineno"></span><span class="comment" id="4871173">//&nbsp;the&nbsp;overall&nbsp;sequence&nbsp;of&nbsp;bytes&nbsp;represented&nbsp;is&nbsp;logically&nbsp;w+pre+post.</span><br>
<span class="lineno"></span><span class="keyword" id="4871243">type</span>&nbsp;<span class="ident" id="4871248">forkableWriter</span>&nbsp;<span class="keyword" id="4871263">struct</span>&nbsp;<span class="op" id="4871270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4871273">*</span><span class="ident" id="4871274">bytes</span><span class="op" id="4871279">.</span><span class="ident" id="4871280">Buffer</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4871288">pre</span><span class="op" id="4871291">,</span>&nbsp;<span class="ident" id="4871293">post</span>&nbsp;<span class="op" id="4871298">*</span><span class="ident" id="4871299">forkableWriter</span><br>
<span class="lineno"></span><span class="op" id="4871314">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4871317">func</span>&nbsp;<span class="ident" id="4871322">newForkableWriter</span><span class="op" id="4871339">(</span><span class="op" id="4871340">)</span>&nbsp;<span class="op" id="4871342">*</span><span class="ident" id="4871343">forkableWriter</span>&nbsp;<span class="op" id="4871358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4871361">return</span>&nbsp;<span class="op" id="4871368">&amp;</span><span class="ident" id="4871369">forkableWriter</span><span class="op" id="4871383">{</span><span class="builtinfunc" id="4871384">new</span><span class="op" id="4871387">(</span><span class="ident" id="4871388">bytes</span><span class="op" id="4871393">.</span><span class="ident" id="4871394">Buffer</span><span class="op" id="4871400">)</span><span class="op" id="4871401">,</span>&nbsp;<span class="ident" id="4871403">nil</span><span class="op" id="4871406">,</span>&nbsp;<span class="ident" id="4871408">nil</span><span class="op" id="4871411">}</span><br>
<span class="lineno">30</span><span class="op" id="4871413">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4871416">func</span>&nbsp;<span class="op" id="4871421">(</span><span class="ident" id="4871422">f</span>&nbsp;<span class="op" id="4871424">*</span><span class="ident" id="4871425">forkableWriter</span><span class="op" id="4871439">)</span>&nbsp;<span class="ident" id="4871441">fork</span><span class="op" id="4871445">(</span><span class="op" id="4871446">)</span>&nbsp;<span class="op" id="4871448">(</span><span class="ident" id="4871449">pre</span><span class="op" id="4871452">,</span>&nbsp;<span class="ident" id="4871454">post</span>&nbsp;<span class="op" id="4871459">*</span><span class="ident" id="4871460">forkableWriter</span><span class="op" id="4871474">)</span>&nbsp;<span class="op" id="4871476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4871479">if</span>&nbsp;<span class="ident" id="4871482">f</span><span class="op" id="4871483">.</span><span class="ident" id="4871484">pre</span>&nbsp;<span class="op" id="4871488">!=</span>&nbsp;<span class="ident" id="4871491">nil</span>&nbsp;<span class="op" id="4871495">||</span>&nbsp;<span class="ident" id="4871498">f</span><span class="op" id="4871499">.</span><span class="ident" id="4871500">post</span>&nbsp;<span class="op" id="4871505">!=</span>&nbsp;<span class="ident" id="4871508">nil</span>&nbsp;<span class="op" id="4871512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4871516">panic</span><span class="op" id="4871521">(</span><span class="string" id="4871522">&#34;have&nbsp;already&nbsp;forked&#34;</span><span class="op" id="4871543">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4871546">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4871549">f</span><span class="op" id="4871550">.</span><span class="ident" id="4871551">pre</span>&nbsp;<span class="op" id="4871555">=</span>&nbsp;<span class="ident" id="4871557">newForkableWriter</span><span class="op" id="4871574">(</span><span class="op" id="4871575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4871578">f</span><span class="op" id="4871579">.</span><span class="ident" id="4871580">post</span>&nbsp;<span class="op" id="4871585">=</span>&nbsp;<span class="ident" id="4871587">newForkableWriter</span><span class="op" id="4871604">(</span><span class="op" id="4871605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4871608">return</span>&nbsp;<span class="ident" id="4871615">f</span><span class="op" id="4871616">.</span><span class="ident" id="4871617">pre</span><span class="op" id="4871620">,</span>&nbsp;<span class="ident" id="4871622">f</span><span class="op" id="4871623">.</span><span class="ident" id="4871624">post</span><br>
<span class="lineno"></span><span class="op" id="4871629">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="4871632">func</span>&nbsp;<span class="op" id="4871637">(</span><span class="ident" id="4871638">f</span>&nbsp;<span class="op" id="4871640">*</span><span class="ident" id="4871641">forkableWriter</span><span class="op" id="4871655">)</span>&nbsp;<span class="ident" id="4871657">Len</span><span class="op" id="4871660">(</span><span class="op" id="4871661">)</span>&nbsp;<span class="op" id="4871663">(</span><span class="ident" id="4871664">l</span>&nbsp;<span class="builtintype" id="4871666">int</span><span class="op" id="4871669">)</span>&nbsp;<span class="op" id="4871671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4871674">l</span>&nbsp;<span class="op" id="4871676">+=</span>&nbsp;<span class="ident" id="4871679">f</span><span class="op" id="4871680">.</span><span class="ident" id="4871681">Buffer</span><span class="op" id="4871687">.</span><span class="ident" id="4871688">Len</span><span class="op" id="4871691">(</span><span class="op" id="4871692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4871695">if</span>&nbsp;<span class="ident" id="4871698">f</span><span class="op" id="4871699">.</span><span class="ident" id="4871700">pre</span>&nbsp;<span class="op" id="4871704">!=</span>&nbsp;<span class="ident" id="4871707">nil</span>&nbsp;<span class="op" id="4871711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4871715">l</span>&nbsp;<span class="op" id="4871717">+=</span>&nbsp;<span class="ident" id="4871720">f</span><span class="op" id="4871721">.</span><span class="ident" id="4871722">pre</span><span class="op" id="4871725">.</span><span class="ident" id="4871726">Len</span><span class="op" id="4871729">(</span><span class="op" id="4871730">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4871733">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4871736">if</span>&nbsp;<span class="ident" id="4871739">f</span><span class="op" id="4871740">.</span><span class="ident" id="4871741">post</span>&nbsp;<span class="op" id="4871746">!=</span>&nbsp;<span class="ident" id="4871749">nil</span>&nbsp;<span class="op" id="4871753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4871757">l</span>&nbsp;<span class="op" id="4871759">+=</span>&nbsp;<span class="ident" id="4871762">f</span><span class="op" id="4871763">.</span><span class="ident" id="4871764">post</span><span class="op" id="4871768">.</span><span class="ident" id="4871769">Len</span><span class="op" id="4871772">(</span><span class="op" id="4871773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4871776">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4871779">return</span><br>
<span class="lineno">50</span><span class="op" id="4871786">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4871789">func</span>&nbsp;<span class="op" id="4871794">(</span><span class="ident" id="4871795">f</span>&nbsp;<span class="op" id="4871797">*</span><span class="ident" id="4871798">forkableWriter</span><span class="op" id="4871812">)</span>&nbsp;<span class="ident" id="4871814">writeTo</span><span class="op" id="4871821">(</span><span class="ident" id="4871822">out</span>&nbsp;<span class="ident" id="4871826">io</span><span class="op" id="4871828">.</span><span class="ident" id="4871829">Writer</span><span class="op" id="4871835">)</span>&nbsp;<span class="op" id="4871837">(</span><span class="ident" id="4871838">n</span>&nbsp;<span class="builtintype" id="4871840">int</span><span class="op" id="4871843">,</span>&nbsp;<span class="ident" id="4871845">err</span>&nbsp;<span class="builtintype" id="4871849">error</span><span class="op" id="4871854">)</span>&nbsp;<span class="op" id="4871856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4871859">n</span><span class="op" id="4871860">,</span>&nbsp;<span class="ident" id="4871862">err</span>&nbsp;<span class="op" id="4871866">=</span>&nbsp;<span class="ident" id="4871868">out</span><span class="op" id="4871871">.</span><span class="ident" id="4871872">Write</span><span class="op" id="4871877">(</span><span class="ident" id="4871878">f</span><span class="op" id="4871879">.</span><span class="ident" id="4871880">Bytes</span><span class="op" id="4871885">(</span><span class="op" id="4871886">)</span><span class="op" id="4871887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4871890">if</span>&nbsp;<span class="ident" id="4871893">err</span>&nbsp;<span class="op" id="4871897">!=</span>&nbsp;<span class="ident" id="4871900">nil</span>&nbsp;<span class="op" id="4871904">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4871908">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4871916">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4871920">var</span>&nbsp;<span class="ident" id="4871924">nn</span>&nbsp;<span class="builtintype" id="4871927">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4871933">if</span>&nbsp;<span class="ident" id="4871936">f</span><span class="op" id="4871937">.</span><span class="ident" id="4871938">pre</span>&nbsp;<span class="op" id="4871942">!=</span>&nbsp;<span class="ident" id="4871945">nil</span>&nbsp;<span class="op" id="4871949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4871953">nn</span><span class="op" id="4871955">,</span>&nbsp;<span class="ident" id="4871957">err</span>&nbsp;<span class="op" id="4871961">=</span>&nbsp;<span class="ident" id="4871963">f</span><span class="op" id="4871964">.</span><span class="ident" id="4871965">pre</span><span class="op" id="4871968">.</span><span class="ident" id="4871969">writeTo</span><span class="op" id="4871976">(</span><span class="ident" id="4871977">out</span><span class="op" id="4871980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4871984">n</span>&nbsp;<span class="op" id="4871986">+=</span>&nbsp;<span class="ident" id="4871989">nn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4871994">if</span>&nbsp;<span class="ident" id="4871997">err</span>&nbsp;<span class="op" id="4872001">!=</span>&nbsp;<span class="ident" id="4872004">nil</span>&nbsp;<span class="op" id="4872008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4872013">return</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4872022">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4872025">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4872029">if</span>&nbsp;<span class="ident" id="4872032">f</span><span class="op" id="4872033">.</span><span class="ident" id="4872034">post</span>&nbsp;<span class="op" id="4872039">!=</span>&nbsp;<span class="ident" id="4872042">nil</span>&nbsp;<span class="op" id="4872046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4872050">nn</span><span class="op" id="4872052">,</span>&nbsp;<span class="ident" id="4872054">err</span>&nbsp;<span class="op" id="4872058">=</span>&nbsp;<span class="ident" id="4872060">f</span><span class="op" id="4872061">.</span><span class="ident" id="4872062">post</span><span class="op" id="4872066">.</span><span class="ident" id="4872067">writeTo</span><span class="op" id="4872074">(</span><span class="ident" id="4872075">out</span><span class="op" id="4872078">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4872082">n</span>&nbsp;<span class="op" id="4872084">+=</span>&nbsp;<span class="ident" id="4872087">nn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4872091">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4872094">return</span><br>
<span class="lineno"></span><span class="op" id="4872101">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="4872104">func</span>&nbsp;<span class="ident" id="4872109">marshalBase128Int</span><span class="op" id="4872126">(</span><span class="ident" id="4872127">out</span>&nbsp;<span class="op" id="4872131">*</span><span class="ident" id="4872132">forkableWriter</span><span class="op" id="4872146">,</span>&nbsp;<span class="ident" id="4872148">n</span>&nbsp;<span class="ident" id="4872150">int64</span><span class="op" id="4872155">)</span>&nbsp;<span class="op" id="4872157">(</span><span class="ident" id="4872158">err</span>&nbsp;<span class="builtintype" id="4872162">error</span><span class="op" id="4872167">)</span>&nbsp;<span class="op" id="4872169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4872172">if</span>&nbsp;<span class="ident" id="4872175">n</span>&nbsp;<span class="op" id="4872177">==</span>&nbsp;<span class="num" id="4872180">0</span>&nbsp;<span class="op" id="4872182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4872186">err</span>&nbsp;<span class="op" id="4872190">=</span>&nbsp;<span class="ident" id="4872192">out</span><span class="op" id="4872195">.</span><span class="ident" id="4872196">WriteByte</span><span class="op" id="4872205">(</span><span class="num" id="4872206">0</span><span class="op" id="4872207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4872211">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4872219">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4872223">l</span>&nbsp;<span class="op" id="4872225">:=</span>&nbsp;<span class="num" id="4872228">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4872231">for</span>&nbsp;<span class="ident" id="4872235">i</span>&nbsp;<span class="op" id="4872237">:=</span>&nbsp;<span class="ident" id="4872240">n</span><span class="op" id="4872241">;</span>&nbsp;<span class="ident" id="4872243">i</span>&nbsp;<span class="op" id="4872245">&gt;</span>&nbsp;<span class="num" id="4872247">0</span><span class="op" id="4872248">;</span>&nbsp;<span class="ident" id="4872250">i</span>&nbsp;<span class="op" id="4872252">&gt;&gt;=</span>&nbsp;<span class="num" id="4872256">7</span>&nbsp;<span class="op" id="4872258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4872262">l</span><span class="op" id="4872263">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4872267">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4872271">for</span>&nbsp;<span class="ident" id="4872275">i</span>&nbsp;<span class="op" id="4872277">:=</span>&nbsp;<span class="ident" id="4872280">l</span>&nbsp;<span class="op" id="4872282">-</span>&nbsp;<span class="num" id="4872284">1</span><span class="op" id="4872285">;</span>&nbsp;<span class="ident" id="4872287">i</span>&nbsp;<span class="op" id="4872289">&gt;=</span>&nbsp;<span class="num" id="4872292">0</span><span class="op" id="4872293">;</span>&nbsp;<span class="ident" id="4872295">i</span><span class="op" id="4872296">--</span>&nbsp;<span class="op" id="4872299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4872303">o</span>&nbsp;<span class="op" id="4872305">:=</span>&nbsp;<span class="builtintype" id="4872308">byte</span><span class="op" id="4872312">(</span><span class="ident" id="4872313">n</span>&nbsp;<span class="op" id="4872315">&gt;&gt;</span>&nbsp;<span class="builtintype" id="4872318">uint</span><span class="op" id="4872322">(</span><span class="ident" id="4872323">i</span><span class="op" id="4872324">*</span><span class="num" id="4872325">7</span><span class="op" id="4872326">)</span><span class="op" id="4872327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4872331">o</span>&nbsp;<span class="op" id="4872333">&amp;=</span>&nbsp;<span class="num" id="4872336">0x7f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4872343">if</span>&nbsp;<span class="ident" id="4872346">i</span>&nbsp;<span class="op" id="4872348">!=</span>&nbsp;<span class="num" id="4872351">0</span>&nbsp;<span class="op" id="4872353">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4872358">o</span>&nbsp;<span class="op" id="4872360">|=</span>&nbsp;<span class="num" id="4872363">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4872370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4872374">err</span>&nbsp;<span class="op" id="4872378">=</span>&nbsp;<span class="ident" id="4872380">out</span><span class="op" id="4872383">.</span><span class="ident" id="4872384">WriteByte</span><span class="op" id="4872393">(</span><span class="ident" id="4872394">o</span><span class="op" id="4872395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4872399">if</span>&nbsp;<span class="ident" id="4872402">err</span>&nbsp;<span class="op" id="4872406">!=</span>&nbsp;<span class="ident" id="4872409">nil</span>&nbsp;<span class="op" id="4872413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4872418">return</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4872427">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4872430">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4872434">return</span>&nbsp;<span class="ident" id="4872441">nil</span><br>
<span class="lineno"></span><span class="op" id="4872445">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="keyword" id="4872448">func</span>&nbsp;<span class="ident" id="4872453">marshalInt64</span><span class="op" id="4872465">(</span><span class="ident" id="4872466">out</span>&nbsp;<span class="op" id="4872470">*</span><span class="ident" id="4872471">forkableWriter</span><span class="op" id="4872485">,</span>&nbsp;<span class="ident" id="4872487">i</span>&nbsp;<span class="ident" id="4872489">int64</span><span class="op" id="4872494">)</span>&nbsp;<span class="op" id="4872496">(</span><span class="ident" id="4872497">err</span>&nbsp;<span class="builtintype" id="4872501">error</span><span class="op" id="4872506">)</span>&nbsp;<span class="op" id="4872508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4872511">n</span>&nbsp;<span class="op" id="4872513">:=</span>&nbsp;<span class="ident" id="4872516">int64Length</span><span class="op" id="4872527">(</span><span class="ident" id="4872528">i</span><span class="op" id="4872529">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4872533">for</span>&nbsp;<span class="op" id="4872537">;</span>&nbsp;<span class="ident" id="4872539">n</span>&nbsp;<span class="op" id="4872541">&gt;</span>&nbsp;<span class="num" id="4872543">0</span><span class="op" id="4872544">;</span>&nbsp;<span class="ident" id="4872546">n</span><span class="op" id="4872547">--</span>&nbsp;<span class="op" id="4872550">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4872554">err</span>&nbsp;<span class="op" id="4872558">=</span>&nbsp;<span class="ident" id="4872560">out</span><span class="op" id="4872563">.</span><span class="ident" id="4872564">WriteByte</span><span class="op" id="4872573">(</span><span class="builtintype" id="4872574">byte</span><span class="op" id="4872578">(</span><span class="ident" id="4872579">i</span>&nbsp;<span class="op" id="4872581">&gt;&gt;</span>&nbsp;<span class="builtintype" id="4872584">uint</span><span class="op" id="4872588">(</span><span class="op" id="4872589">(</span><span class="ident" id="4872590">n</span><span class="op" id="4872591">-</span><span class="num" id="4872592">1</span><span class="op" id="4872593">)</span><span class="op" id="4872594">*</span><span class="num" id="4872595">8</span><span class="op" id="4872596">)</span><span class="op" id="4872597">)</span><span class="op" id="4872598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4872602">if</span>&nbsp;<span class="ident" id="4872605">err</span>&nbsp;<span class="op" id="4872609">!=</span>&nbsp;<span class="ident" id="4872612">nil</span>&nbsp;<span class="op" id="4872616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4872621">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4872630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4872633">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4872637">return</span>&nbsp;<span class="ident" id="4872644">nil</span><br>
<span class="lineno"></span><span class="op" id="4872648">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4872651">func</span>&nbsp;<span class="ident" id="4872656">int64Length</span><span class="op" id="4872667">(</span><span class="ident" id="4872668">i</span>&nbsp;<span class="ident" id="4872670">int64</span><span class="op" id="4872675">)</span>&nbsp;<span class="op" id="4872677">(</span><span class="ident" id="4872678">numBytes</span>&nbsp;<span class="builtintype" id="4872687">int</span><span class="op" id="4872690">)</span>&nbsp;<span class="op" id="4872692">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4872695">numBytes</span>&nbsp;<span class="op" id="4872704">=</span>&nbsp;<span class="num" id="4872706">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4872710">for</span>&nbsp;<span class="ident" id="4872714">i</span>&nbsp;<span class="op" id="4872716">&gt;</span>&nbsp;<span class="num" id="4872718">127</span>&nbsp;<span class="op" id="4872722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4872726">numBytes</span><span class="op" id="4872734">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4872739">i</span>&nbsp;<span class="op" id="4872741">&gt;&gt;=</span>&nbsp;<span class="num" id="4872745">8</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4872748">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4872752">for</span>&nbsp;<span class="ident" id="4872756">i</span>&nbsp;<span class="op" id="4872758">&lt;</span>&nbsp;<span class="op" id="4872760">-</span><span class="num" id="4872761">128</span>&nbsp;<span class="op" id="4872765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4872769">numBytes</span><span class="op" id="4872777">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4872782">i</span>&nbsp;<span class="op" id="4872784">&gt;&gt;=</span>&nbsp;<span class="num" id="4872788">8</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4872791">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4872795">return</span><br>
<span class="lineno"></span><span class="op" id="4872802">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="keyword" id="4872805">func</span>&nbsp;<span class="ident" id="4872810">marshalBigInt</span><span class="op" id="4872823">(</span><span class="ident" id="4872824">out</span>&nbsp;<span class="op" id="4872828">*</span><span class="ident" id="4872829">forkableWriter</span><span class="op" id="4872843">,</span>&nbsp;<span class="ident" id="4872845">n</span>&nbsp;<span class="op" id="4872847">*</span><span class="ident" id="4872848">big</span><span class="op" id="4872851">.</span><span class="ident" id="4872852">Int</span><span class="op" id="4872855">)</span>&nbsp;<span class="op" id="4872857">(</span><span class="ident" id="4872858">err</span>&nbsp;<span class="builtintype" id="4872862">error</span><span class="op" id="4872867">)</span>&nbsp;<span class="op" id="4872869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4872872">if</span>&nbsp;<span class="ident" id="4872875">n</span><span class="op" id="4872876">.</span><span class="ident" id="4872877">Sign</span><span class="op" id="4872881">(</span><span class="op" id="4872882">)</span>&nbsp;<span class="op" id="4872884">&lt;</span>&nbsp;<span class="num" id="4872886">0</span>&nbsp;<span class="op" id="4872888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4872892">//&nbsp;A&nbsp;negative&nbsp;number&nbsp;has&nbsp;to&nbsp;be&nbsp;converted&nbsp;to&nbsp;two&#39;s-complement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4872955">//&nbsp;form.&nbsp;So&nbsp;we&#39;ll&nbsp;subtract&nbsp;1&nbsp;and&nbsp;invert.&nbsp;If&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4873005">//&nbsp;most-significant-bit&nbsp;isn&#39;t&nbsp;set&nbsp;then&nbsp;we&#39;ll&nbsp;need&nbsp;to&nbsp;pad&nbsp;the</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4873068">//&nbsp;beginning&nbsp;with&nbsp;0xff&nbsp;in&nbsp;order&nbsp;to&nbsp;keep&nbsp;the&nbsp;number&nbsp;negative.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4873131">nMinus1</span>&nbsp;<span class="op" id="4873139">:=</span>&nbsp;<span class="builtinfunc" id="4873142">new</span><span class="op" id="4873145">(</span><span class="ident" id="4873146">big</span><span class="op" id="4873149">.</span><span class="ident" id="4873150">Int</span><span class="op" id="4873153">)</span><span class="op" id="4873154">.</span><span class="ident" id="4873155">Neg</span><span class="op" id="4873158">(</span><span class="ident" id="4873159">n</span><span class="op" id="4873160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4873164">nMinus1</span><span class="op" id="4873171">.</span><span class="ident" id="4873172">Sub</span><span class="op" id="4873175">(</span><span class="ident" id="4873176">nMinus1</span><span class="op" id="4873183">,</span>&nbsp;<span class="ident" id="4873185">bigOne</span><span class="op" id="4873191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4873195">bytes</span>&nbsp;<span class="op" id="4873201">:=</span>&nbsp;<span class="ident" id="4873204">nMinus1</span><span class="op" id="4873211">.</span><span class="ident" id="4873212">Bytes</span><span class="op" id="4873217">(</span><span class="op" id="4873218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4873222">for</span>&nbsp;<span class="ident" id="4873226">i</span>&nbsp;<span class="op" id="4873228">:=</span>&nbsp;<span class="keyword" id="4873231">range</span>&nbsp;<span class="ident" id="4873237">bytes</span>&nbsp;<span class="op" id="4873243">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4873248">bytes</span><span class="op" id="4873253">[</span><span class="ident" id="4873254">i</span><span class="op" id="4873255">]</span>&nbsp;<span class="op" id="4873257">^=</span>&nbsp;<span class="num" id="4873260">0xff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4873267">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4873271">if</span>&nbsp;<span class="builtinfunc" id="4873274">len</span><span class="op" id="4873277">(</span><span class="ident" id="4873278">bytes</span><span class="op" id="4873283">)</span>&nbsp;<span class="op" id="4873285">==</span>&nbsp;<span class="num" id="4873288">0</span>&nbsp;<span class="op" id="4873290">||</span>&nbsp;<span class="ident" id="4873293">bytes</span><span class="op" id="4873298">[</span><span class="num" id="4873299">0</span><span class="op" id="4873300">]</span><span class="op" id="4873301">&amp;</span><span class="num" id="4873302">0x80</span>&nbsp;<span class="op" id="4873307">==</span>&nbsp;<span class="num" id="4873310">0</span>&nbsp;<span class="op" id="4873312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4873317">err</span>&nbsp;<span class="op" id="4873321">=</span>&nbsp;<span class="ident" id="4873323">out</span><span class="op" id="4873326">.</span><span class="ident" id="4873327">WriteByte</span><span class="op" id="4873336">(</span><span class="num" id="4873337">0xff</span><span class="op" id="4873341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4873346">if</span>&nbsp;<span class="ident" id="4873349">err</span>&nbsp;<span class="op" id="4873353">!=</span>&nbsp;<span class="ident" id="4873356">nil</span>&nbsp;<span class="op" id="4873360">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4873366">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4873376">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4873380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4873384">_</span><span class="op" id="4873385">,</span>&nbsp;<span class="ident" id="4873387">err</span>&nbsp;<span class="op" id="4873391">=</span>&nbsp;<span class="ident" id="4873393">out</span><span class="op" id="4873396">.</span><span class="ident" id="4873397">Write</span><span class="op" id="4873402">(</span><span class="ident" id="4873403">bytes</span><span class="op" id="4873408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4873411">}</span>&nbsp;<span class="keyword" id="4873413">else</span>&nbsp;<span class="keyword" id="4873418">if</span>&nbsp;<span class="ident" id="4873421">n</span><span class="op" id="4873422">.</span><span class="ident" id="4873423">Sign</span><span class="op" id="4873427">(</span><span class="op" id="4873428">)</span>&nbsp;<span class="op" id="4873430">==</span>&nbsp;<span class="num" id="4873433">0</span>&nbsp;<span class="op" id="4873435">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4873439">//&nbsp;Zero&nbsp;is&nbsp;written&nbsp;as&nbsp;a&nbsp;single&nbsp;0&nbsp;zero&nbsp;rather&nbsp;than&nbsp;no&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4873501">err</span>&nbsp;<span class="op" id="4873505">=</span>&nbsp;<span class="ident" id="4873507">out</span><span class="op" id="4873510">.</span><span class="ident" id="4873511">WriteByte</span><span class="op" id="4873520">(</span><span class="num" id="4873521">0x00</span><span class="op" id="4873525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4873528">}</span>&nbsp;<span class="keyword" id="4873530">else</span>&nbsp;<span class="op" id="4873535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4873539">bytes</span>&nbsp;<span class="op" id="4873545">:=</span>&nbsp;<span class="ident" id="4873548">n</span><span class="op" id="4873549">.</span><span class="ident" id="4873550">Bytes</span><span class="op" id="4873555">(</span><span class="op" id="4873556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4873560">if</span>&nbsp;<span class="builtinfunc" id="4873563">len</span><span class="op" id="4873566">(</span><span class="ident" id="4873567">bytes</span><span class="op" id="4873572">)</span>&nbsp;<span class="op" id="4873574">&gt;</span>&nbsp;<span class="num" id="4873576">0</span>&nbsp;<span class="op" id="4873578">&amp;&amp;</span>&nbsp;<span class="ident" id="4873581">bytes</span><span class="op" id="4873586">[</span><span class="num" id="4873587">0</span><span class="op" id="4873588">]</span><span class="op" id="4873589">&amp;</span><span class="num" id="4873590">0x80</span>&nbsp;<span class="op" id="4873595">!=</span>&nbsp;<span class="num" id="4873598">0</span>&nbsp;<span class="op" id="4873600">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4873605">//&nbsp;We&#39;ll&nbsp;have&nbsp;to&nbsp;pad&nbsp;this&nbsp;with&nbsp;0x00&nbsp;in&nbsp;order&nbsp;to&nbsp;stop&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4873664">//&nbsp;looking&nbsp;like&nbsp;a&nbsp;negative&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4873702">err</span>&nbsp;<span class="op" id="4873706">=</span>&nbsp;<span class="ident" id="4873708">out</span><span class="op" id="4873711">.</span><span class="ident" id="4873712">WriteByte</span><span class="op" id="4873721">(</span><span class="num" id="4873722">0</span><span class="op" id="4873723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4873728">if</span>&nbsp;<span class="ident" id="4873731">err</span>&nbsp;<span class="op" id="4873735">!=</span>&nbsp;<span class="ident" id="4873738">nil</span>&nbsp;<span class="op" id="4873742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4873748">return</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4873758">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4873762">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4873766">_</span><span class="op" id="4873767">,</span>&nbsp;<span class="ident" id="4873769">err</span>&nbsp;<span class="op" id="4873773">=</span>&nbsp;<span class="ident" id="4873775">out</span><span class="op" id="4873778">.</span><span class="ident" id="4873779">Write</span><span class="op" id="4873784">(</span><span class="ident" id="4873785">bytes</span><span class="op" id="4873790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4873793">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4873796">return</span><br>
<span class="lineno">165</span><span class="op" id="4873803">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4873806">func</span>&nbsp;<span class="ident" id="4873811">marshalLength</span><span class="op" id="4873824">(</span><span class="ident" id="4873825">out</span>&nbsp;<span class="op" id="4873829">*</span><span class="ident" id="4873830">forkableWriter</span><span class="op" id="4873844">,</span>&nbsp;<span class="ident" id="4873846">i</span>&nbsp;<span class="builtintype" id="4873848">int</span><span class="op" id="4873851">)</span>&nbsp;<span class="op" id="4873853">(</span><span class="ident" id="4873854">err</span>&nbsp;<span class="builtintype" id="4873858">error</span><span class="op" id="4873863">)</span>&nbsp;<span class="op" id="4873865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4873868">n</span>&nbsp;<span class="op" id="4873870">:=</span>&nbsp;<span class="ident" id="4873873">lengthLength</span><span class="op" id="4873885">(</span><span class="ident" id="4873886">i</span><span class="op" id="4873887">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4873891">for</span>&nbsp;<span class="op" id="4873895">;</span>&nbsp;<span class="ident" id="4873897">n</span>&nbsp;<span class="op" id="4873899">&gt;</span>&nbsp;<span class="num" id="4873901">0</span><span class="op" id="4873902">;</span>&nbsp;<span class="ident" id="4873904">n</span><span class="op" id="4873905">--</span>&nbsp;<span class="op" id="4873908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4873912">err</span>&nbsp;<span class="op" id="4873916">=</span>&nbsp;<span class="ident" id="4873918">out</span><span class="op" id="4873921">.</span><span class="ident" id="4873922">WriteByte</span><span class="op" id="4873931">(</span><span class="builtintype" id="4873932">byte</span><span class="op" id="4873936">(</span><span class="ident" id="4873937">i</span>&nbsp;<span class="op" id="4873939">&gt;&gt;</span>&nbsp;<span class="builtintype" id="4873942">uint</span><span class="op" id="4873946">(</span><span class="op" id="4873947">(</span><span class="ident" id="4873948">n</span><span class="op" id="4873949">-</span><span class="num" id="4873950">1</span><span class="op" id="4873951">)</span><span class="op" id="4873952">*</span><span class="num" id="4873953">8</span><span class="op" id="4873954">)</span><span class="op" id="4873955">)</span><span class="op" id="4873956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4873960">if</span>&nbsp;<span class="ident" id="4873963">err</span>&nbsp;<span class="op" id="4873967">!=</span>&nbsp;<span class="ident" id="4873970">nil</span>&nbsp;<span class="op" id="4873974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4873979">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4873988">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4873991">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4873995">return</span>&nbsp;<span class="ident" id="4874002">nil</span><br>
<span class="lineno"></span><span class="op" id="4874006">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="keyword" id="4874009">func</span>&nbsp;<span class="ident" id="4874014">lengthLength</span><span class="op" id="4874026">(</span><span class="ident" id="4874027">i</span>&nbsp;<span class="builtintype" id="4874029">int</span><span class="op" id="4874032">)</span>&nbsp;<span class="op" id="4874034">(</span><span class="ident" id="4874035">numBytes</span>&nbsp;<span class="builtintype" id="4874044">int</span><span class="op" id="4874047">)</span>&nbsp;<span class="op" id="4874049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4874052">numBytes</span>&nbsp;<span class="op" id="4874061">=</span>&nbsp;<span class="num" id="4874063">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4874066">for</span>&nbsp;<span class="ident" id="4874070">i</span>&nbsp;<span class="op" id="4874072">&gt;</span>&nbsp;<span class="num" id="4874074">255</span>&nbsp;<span class="op" id="4874078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4874082">numBytes</span><span class="op" id="4874090">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4874095">i</span>&nbsp;<span class="op" id="4874097">&gt;&gt;=</span>&nbsp;<span class="num" id="4874101">8</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4874104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4874107">return</span><br>
<span class="lineno"></span><span class="op" id="4874114">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4874117">func</span>&nbsp;<span class="ident" id="4874122">marshalTagAndLength</span><span class="op" id="4874141">(</span><span class="ident" id="4874142">out</span>&nbsp;<span class="op" id="4874146">*</span><span class="ident" id="4874147">forkableWriter</span><span class="op" id="4874161">,</span>&nbsp;<span class="ident" id="4874163">t</span>&nbsp;<span class="ident" id="4874165">tagAndLength</span><span class="op" id="4874177">)</span>&nbsp;<span class="op" id="4874179">(</span><span class="ident" id="4874180">err</span>&nbsp;<span class="builtintype" id="4874184">error</span><span class="op" id="4874189">)</span>&nbsp;<span class="op" id="4874191">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4874194">b</span>&nbsp;<span class="op" id="4874196">:=</span>&nbsp;<span class="builtintype" id="4874199">uint8</span><span class="op" id="4874204">(</span><span class="ident" id="4874205">t</span><span class="op" id="4874206">.</span><span class="ident" id="4874207">class</span><span class="op" id="4874212">)</span>&nbsp;<span class="op" id="4874214">&lt;&lt;</span>&nbsp;<span class="num" id="4874217">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4874220">if</span>&nbsp;<span class="ident" id="4874223">t</span><span class="op" id="4874224">.</span><span class="ident" id="4874225">isCompound</span>&nbsp;<span class="op" id="4874236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4874240">b</span>&nbsp;<span class="op" id="4874242">|=</span>&nbsp;<span class="num" id="4874245">0x20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4874251">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4874254">if</span>&nbsp;<span class="ident" id="4874257">t</span><span class="op" id="4874258">.</span><span class="ident" id="4874259">tag</span>&nbsp;<span class="op" id="4874263">&gt;=</span>&nbsp;<span class="num" id="4874266">31</span>&nbsp;<span class="op" id="4874269">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4874273">b</span>&nbsp;<span class="op" id="4874275">|=</span>&nbsp;<span class="num" id="4874278">0x1f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4874285">err</span>&nbsp;<span class="op" id="4874289">=</span>&nbsp;<span class="ident" id="4874291">out</span><span class="op" id="4874294">.</span><span class="ident" id="4874295">WriteByte</span><span class="op" id="4874304">(</span><span class="ident" id="4874305">b</span><span class="op" id="4874306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4874310">if</span>&nbsp;<span class="ident" id="4874313">err</span>&nbsp;<span class="op" id="4874317">!=</span>&nbsp;<span class="ident" id="4874320">nil</span>&nbsp;<span class="op" id="4874324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4874329">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4874338">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4874342">err</span>&nbsp;<span class="op" id="4874346">=</span>&nbsp;<span class="ident" id="4874348">marshalBase128Int</span><span class="op" id="4874365">(</span><span class="ident" id="4874366">out</span><span class="op" id="4874369">,</span>&nbsp;<span class="ident" id="4874371">int64</span><span class="op" id="4874376">(</span><span class="ident" id="4874377">t</span><span class="op" id="4874378">.</span><span class="ident" id="4874379">tag</span><span class="op" id="4874382">)</span><span class="op" id="4874383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4874387">if</span>&nbsp;<span class="ident" id="4874390">err</span>&nbsp;<span class="op" id="4874394">!=</span>&nbsp;<span class="ident" id="4874397">nil</span>&nbsp;<span class="op" id="4874401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4874406">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4874415">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4874418">}</span>&nbsp;<span class="keyword" id="4874420">else</span>&nbsp;<span class="op" id="4874425">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4874429">b</span>&nbsp;<span class="op" id="4874431">|=</span>&nbsp;<span class="builtintype" id="4874434">uint8</span><span class="op" id="4874439">(</span><span class="ident" id="4874440">t</span><span class="op" id="4874441">.</span><span class="ident" id="4874442">tag</span><span class="op" id="4874445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4874449">err</span>&nbsp;<span class="op" id="4874453">=</span>&nbsp;<span class="ident" id="4874455">out</span><span class="op" id="4874458">.</span><span class="ident" id="4874459">WriteByte</span><span class="op" id="4874468">(</span><span class="ident" id="4874469">b</span><span class="op" id="4874470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4874474">if</span>&nbsp;<span class="ident" id="4874477">err</span>&nbsp;<span class="op" id="4874481">!=</span>&nbsp;<span class="ident" id="4874484">nil</span>&nbsp;<span class="op" id="4874488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4874493">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4874502">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4874505">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4874509">if</span>&nbsp;<span class="ident" id="4874512">t</span><span class="op" id="4874513">.</span><span class="ident" id="4874514">length</span>&nbsp;<span class="op" id="4874521">&gt;=</span>&nbsp;<span class="num" id="4874524">128</span>&nbsp;<span class="op" id="4874528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4874532">l</span>&nbsp;<span class="op" id="4874534">:=</span>&nbsp;<span class="ident" id="4874537">lengthLength</span><span class="op" id="4874549">(</span><span class="ident" id="4874550">t</span><span class="op" id="4874551">.</span><span class="ident" id="4874552">length</span><span class="op" id="4874558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4874562">err</span>&nbsp;<span class="op" id="4874566">=</span>&nbsp;<span class="ident" id="4874568">out</span><span class="op" id="4874571">.</span><span class="ident" id="4874572">WriteByte</span><span class="op" id="4874581">(</span><span class="num" id="4874582">0x80</span>&nbsp;<span class="op" id="4874587">|</span>&nbsp;<span class="builtintype" id="4874589">byte</span><span class="op" id="4874593">(</span><span class="ident" id="4874594">l</span><span class="op" id="4874595">)</span><span class="op" id="4874596">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4874600">if</span>&nbsp;<span class="ident" id="4874603">err</span>&nbsp;<span class="op" id="4874607">!=</span>&nbsp;<span class="ident" id="4874610">nil</span>&nbsp;<span class="op" id="4874614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4874619">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4874628">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4874632">err</span>&nbsp;<span class="op" id="4874636">=</span>&nbsp;<span class="ident" id="4874638">marshalLength</span><span class="op" id="4874651">(</span><span class="ident" id="4874652">out</span><span class="op" id="4874655">,</span>&nbsp;<span class="ident" id="4874657">t</span><span class="op" id="4874658">.</span><span class="ident" id="4874659">length</span><span class="op" id="4874665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4874669">if</span>&nbsp;<span class="ident" id="4874672">err</span>&nbsp;<span class="op" id="4874676">!=</span>&nbsp;<span class="ident" id="4874679">nil</span>&nbsp;<span class="op" id="4874683">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4874688">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4874697">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4874700">}</span>&nbsp;<span class="keyword" id="4874702">else</span>&nbsp;<span class="op" id="4874707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4874711">err</span>&nbsp;<span class="op" id="4874715">=</span>&nbsp;<span class="ident" id="4874717">out</span><span class="op" id="4874720">.</span><span class="ident" id="4874721">WriteByte</span><span class="op" id="4874730">(</span><span class="builtintype" id="4874731">byte</span><span class="op" id="4874735">(</span><span class="ident" id="4874736">t</span><span class="op" id="4874737">.</span><span class="ident" id="4874738">length</span><span class="op" id="4874744">)</span><span class="op" id="4874745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4874749">if</span>&nbsp;<span class="ident" id="4874752">err</span>&nbsp;<span class="op" id="4874756">!=</span>&nbsp;<span class="ident" id="4874759">nil</span>&nbsp;<span class="op" id="4874763">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4874768">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4874777">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4874780">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4874784">return</span>&nbsp;<span class="ident" id="4874791">nil</span><br>
<span class="lineno">230</span><span class="op" id="4874795">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4874798">func</span>&nbsp;<span class="ident" id="4874803">marshalBitString</span><span class="op" id="4874819">(</span><span class="ident" id="4874820">out</span>&nbsp;<span class="op" id="4874824">*</span><span class="ident" id="4874825">forkableWriter</span><span class="op" id="4874839">,</span>&nbsp;<span class="ident" id="4874841">b</span>&nbsp;<span class="ident" id="4874843">BitString</span><span class="op" id="4874852">)</span>&nbsp;<span class="op" id="4874854">(</span><span class="ident" id="4874855">err</span>&nbsp;<span class="builtintype" id="4874859">error</span><span class="op" id="4874864">)</span>&nbsp;<span class="op" id="4874866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4874869">paddingBits</span>&nbsp;<span class="op" id="4874881">:=</span>&nbsp;<span class="builtintype" id="4874884">byte</span><span class="op" id="4874888">(</span><span class="op" id="4874889">(</span><span class="num" id="4874890">8</span>&nbsp;<span class="op" id="4874892">-</span>&nbsp;<span class="ident" id="4874894">b</span><span class="op" id="4874895">.</span><span class="ident" id="4874896">BitLength</span><span class="op" id="4874905">%</span><span class="num" id="4874906">8</span><span class="op" id="4874907">)</span>&nbsp;<span class="op" id="4874909">%</span>&nbsp;<span class="num" id="4874911">8</span><span class="op" id="4874912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4874915">err</span>&nbsp;<span class="op" id="4874919">=</span>&nbsp;<span class="ident" id="4874921">out</span><span class="op" id="4874924">.</span><span class="ident" id="4874925">WriteByte</span><span class="op" id="4874934">(</span><span class="ident" id="4874935">paddingBits</span><span class="op" id="4874946">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4874949">if</span>&nbsp;<span class="ident" id="4874952">err</span>&nbsp;<span class="op" id="4874956">!=</span>&nbsp;<span class="ident" id="4874959">nil</span>&nbsp;<span class="op" id="4874963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4874967">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4874975">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4874978">_</span><span class="op" id="4874979">,</span>&nbsp;<span class="ident" id="4874981">err</span>&nbsp;<span class="op" id="4874985">=</span>&nbsp;<span class="ident" id="4874987">out</span><span class="op" id="4874990">.</span><span class="ident" id="4874991">Write</span><span class="op" id="4874996">(</span><span class="ident" id="4874997">b</span><span class="op" id="4874998">.</span><span class="ident" id="4874999">Bytes</span><span class="op" id="4875004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4875007">return</span><br>
<span class="lineno">240</span><span class="op" id="4875014">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4875017">func</span>&nbsp;<span class="ident" id="4875022">marshalObjectIdentifier</span><span class="op" id="4875045">(</span><span class="ident" id="4875046">out</span>&nbsp;<span class="op" id="4875050">*</span><span class="ident" id="4875051">forkableWriter</span><span class="op" id="4875065">,</span>&nbsp;<span class="ident" id="4875067">oid</span>&nbsp;<span class="op" id="4875071">[</span><span class="op" id="4875072">]</span><span class="builtintype" id="4875073">int</span><span class="op" id="4875076">)</span>&nbsp;<span class="op" id="4875078">(</span><span class="ident" id="4875079">err</span>&nbsp;<span class="builtintype" id="4875083">error</span><span class="op" id="4875088">)</span>&nbsp;<span class="op" id="4875090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4875093">if</span>&nbsp;<span class="builtinfunc" id="4875096">len</span><span class="op" id="4875099">(</span><span class="ident" id="4875100">oid</span><span class="op" id="4875103">)</span>&nbsp;<span class="op" id="4875105">&lt;</span>&nbsp;<span class="num" id="4875107">2</span>&nbsp;<span class="op" id="4875109">||</span>&nbsp;<span class="ident" id="4875112">oid</span><span class="op" id="4875115">[</span><span class="num" id="4875116">0</span><span class="op" id="4875117">]</span>&nbsp;<span class="op" id="4875119">&gt;</span>&nbsp;<span class="num" id="4875121">2</span>&nbsp;<span class="op" id="4875123">||</span>&nbsp;<span class="op" id="4875126">(</span><span class="ident" id="4875127">oid</span><span class="op" id="4875130">[</span><span class="num" id="4875131">0</span><span class="op" id="4875132">]</span>&nbsp;<span class="op" id="4875134">&lt;</span>&nbsp;<span class="num" id="4875136">2</span>&nbsp;<span class="op" id="4875138">&amp;&amp;</span>&nbsp;<span class="ident" id="4875141">oid</span><span class="op" id="4875144">[</span><span class="num" id="4875145">1</span><span class="op" id="4875146">]</span>&nbsp;<span class="op" id="4875148">&gt;=</span>&nbsp;<span class="num" id="4875151">40</span><span class="op" id="4875153">)</span>&nbsp;<span class="op" id="4875155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4875159">return</span>&nbsp;<span class="ident" id="4875166">StructuralError</span><span class="op" id="4875181">{</span><span class="string" id="4875182">&#34;invalid&nbsp;object&nbsp;identifier&#34;</span><span class="op" id="4875209">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4875212">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4875216">err</span>&nbsp;<span class="op" id="4875220">=</span>&nbsp;<span class="ident" id="4875222">marshalBase128Int</span><span class="op" id="4875239">(</span><span class="ident" id="4875240">out</span><span class="op" id="4875243">,</span>&nbsp;<span class="ident" id="4875245">int64</span><span class="op" id="4875250">(</span><span class="ident" id="4875251">oid</span><span class="op" id="4875254">[</span><span class="num" id="4875255">0</span><span class="op" id="4875256">]</span><span class="op" id="4875257">*</span><span class="num" id="4875258">40</span><span class="op" id="4875260">+</span><span class="ident" id="4875261">oid</span><span class="op" id="4875264">[</span><span class="num" id="4875265">1</span><span class="op" id="4875266">]</span><span class="op" id="4875267">)</span><span class="op" id="4875268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4875271">if</span>&nbsp;<span class="ident" id="4875274">err</span>&nbsp;<span class="op" id="4875278">!=</span>&nbsp;<span class="ident" id="4875281">nil</span>&nbsp;<span class="op" id="4875285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4875289">return</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4875297">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4875300">for</span>&nbsp;<span class="ident" id="4875304">i</span>&nbsp;<span class="op" id="4875306">:=</span>&nbsp;<span class="num" id="4875309">2</span><span class="op" id="4875310">;</span>&nbsp;<span class="ident" id="4875312">i</span>&nbsp;<span class="op" id="4875314">&lt;</span>&nbsp;<span class="builtinfunc" id="4875316">len</span><span class="op" id="4875319">(</span><span class="ident" id="4875320">oid</span><span class="op" id="4875323">)</span><span class="op" id="4875324">;</span>&nbsp;<span class="ident" id="4875326">i</span><span class="op" id="4875327">++</span>&nbsp;<span class="op" id="4875330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4875334">err</span>&nbsp;<span class="op" id="4875338">=</span>&nbsp;<span class="ident" id="4875340">marshalBase128Int</span><span class="op" id="4875357">(</span><span class="ident" id="4875358">out</span><span class="op" id="4875361">,</span>&nbsp;<span class="ident" id="4875363">int64</span><span class="op" id="4875368">(</span><span class="ident" id="4875369">oid</span><span class="op" id="4875372">[</span><span class="ident" id="4875373">i</span><span class="op" id="4875374">]</span><span class="op" id="4875375">)</span><span class="op" id="4875376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4875380">if</span>&nbsp;<span class="ident" id="4875383">err</span>&nbsp;<span class="op" id="4875387">!=</span>&nbsp;<span class="ident" id="4875390">nil</span>&nbsp;<span class="op" id="4875394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4875399">return</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4875408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4875411">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4875415">return</span><br>
<span class="lineno"></span><span class="op" id="4875422">}</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="keyword" id="4875425">func</span>&nbsp;<span class="ident" id="4875430">marshalPrintableString</span><span class="op" id="4875452">(</span><span class="ident" id="4875453">out</span>&nbsp;<span class="op" id="4875457">*</span><span class="ident" id="4875458">forkableWriter</span><span class="op" id="4875472">,</span>&nbsp;<span class="ident" id="4875474">s</span>&nbsp;<span class="builtintype" id="4875476">string</span><span class="op" id="4875482">)</span>&nbsp;<span class="op" id="4875484">(</span><span class="ident" id="4875485">err</span>&nbsp;<span class="builtintype" id="4875489">error</span><span class="op" id="4875494">)</span>&nbsp;<span class="op" id="4875496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4875499">b</span>&nbsp;<span class="op" id="4875501">:=</span>&nbsp;<span class="op" id="4875504">[</span><span class="op" id="4875505">]</span><span class="builtintype" id="4875506">byte</span><span class="op" id="4875510">(</span><span class="ident" id="4875511">s</span><span class="op" id="4875512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4875515">for</span>&nbsp;<span class="ident" id="4875519">_</span><span class="op" id="4875520">,</span>&nbsp;<span class="ident" id="4875522">c</span>&nbsp;<span class="op" id="4875524">:=</span>&nbsp;<span class="keyword" id="4875527">range</span>&nbsp;<span class="ident" id="4875533">b</span>&nbsp;<span class="op" id="4875535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4875539">if</span>&nbsp;<span class="op" id="4875542">!</span><span class="ident" id="4875543">isPrintable</span><span class="op" id="4875554">(</span><span class="ident" id="4875555">c</span><span class="op" id="4875556">)</span>&nbsp;<span class="op" id="4875558">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4875563">return</span>&nbsp;<span class="ident" id="4875570">StructuralError</span><span class="op" id="4875585">{</span><span class="string" id="4875586">&#34;PrintableString&nbsp;contains&nbsp;invalid&nbsp;character&#34;</span><span class="op" id="4875630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4875634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4875637">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4875641">_</span><span class="op" id="4875642">,</span>&nbsp;<span class="ident" id="4875644">err</span>&nbsp;<span class="op" id="4875648">=</span>&nbsp;<span class="ident" id="4875650">out</span><span class="op" id="4875653">.</span><span class="ident" id="4875654">Write</span><span class="op" id="4875659">(</span><span class="ident" id="4875660">b</span><span class="op" id="4875661">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4875664">return</span><br>
<span class="lineno"></span><span class="op" id="4875671">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4875674">func</span>&nbsp;<span class="ident" id="4875679">marshalIA5String</span><span class="op" id="4875695">(</span><span class="ident" id="4875696">out</span>&nbsp;<span class="op" id="4875700">*</span><span class="ident" id="4875701">forkableWriter</span><span class="op" id="4875715">,</span>&nbsp;<span class="ident" id="4875717">s</span>&nbsp;<span class="builtintype" id="4875719">string</span><span class="op" id="4875725">)</span>&nbsp;<span class="op" id="4875727">(</span><span class="ident" id="4875728">err</span>&nbsp;<span class="builtintype" id="4875732">error</span><span class="op" id="4875737">)</span>&nbsp;<span class="op" id="4875739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4875742">b</span>&nbsp;<span class="op" id="4875744">:=</span>&nbsp;<span class="op" id="4875747">[</span><span class="op" id="4875748">]</span><span class="builtintype" id="4875749">byte</span><span class="op" id="4875753">(</span><span class="ident" id="4875754">s</span><span class="op" id="4875755">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4875758">for</span>&nbsp;<span class="ident" id="4875762">_</span><span class="op" id="4875763">,</span>&nbsp;<span class="ident" id="4875765">c</span>&nbsp;<span class="op" id="4875767">:=</span>&nbsp;<span class="keyword" id="4875770">range</span>&nbsp;<span class="ident" id="4875776">b</span>&nbsp;<span class="op" id="4875778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4875782">if</span>&nbsp;<span class="ident" id="4875785">c</span>&nbsp;<span class="op" id="4875787">&gt;</span>&nbsp;<span class="num" id="4875789">127</span>&nbsp;<span class="op" id="4875793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4875798">return</span>&nbsp;<span class="ident" id="4875805">StructuralError</span><span class="op" id="4875820">{</span><span class="string" id="4875821">&#34;IA5String&nbsp;contains&nbsp;invalid&nbsp;character&#34;</span><span class="op" id="4875859">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4875863">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4875866">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4875870">_</span><span class="op" id="4875871">,</span>&nbsp;<span class="ident" id="4875873">err</span>&nbsp;<span class="op" id="4875877">=</span>&nbsp;<span class="ident" id="4875879">out</span><span class="op" id="4875882">.</span><span class="ident" id="4875883">Write</span><span class="op" id="4875888">(</span><span class="ident" id="4875889">b</span><span class="op" id="4875890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4875893">return</span><br>
<span class="lineno"></span><span class="op" id="4875900">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="keyword" id="4875903">func</span>&nbsp;<span class="ident" id="4875908">marshalUTF8String</span><span class="op" id="4875925">(</span><span class="ident" id="4875926">out</span>&nbsp;<span class="op" id="4875930">*</span><span class="ident" id="4875931">forkableWriter</span><span class="op" id="4875945">,</span>&nbsp;<span class="ident" id="4875947">s</span>&nbsp;<span class="builtintype" id="4875949">string</span><span class="op" id="4875955">)</span>&nbsp;<span class="op" id="4875957">(</span><span class="ident" id="4875958">err</span>&nbsp;<span class="builtintype" id="4875962">error</span><span class="op" id="4875967">)</span>&nbsp;<span class="op" id="4875969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4875972">_</span><span class="op" id="4875973">,</span>&nbsp;<span class="ident" id="4875975">err</span>&nbsp;<span class="op" id="4875979">=</span>&nbsp;<span class="ident" id="4875981">out</span><span class="op" id="4875984">.</span><span class="ident" id="4875985">Write</span><span class="op" id="4875990">(</span><span class="op" id="4875991">[</span><span class="op" id="4875992">]</span><span class="builtintype" id="4875993">byte</span><span class="op" id="4875997">(</span><span class="ident" id="4875998">s</span><span class="op" id="4875999">)</span><span class="op" id="4876000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4876003">return</span><br>
<span class="lineno"></span><span class="op" id="4876010">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">290</span><span class="keyword" id="4876013">func</span>&nbsp;<span class="ident" id="4876018">marshalTwoDigits</span><span class="op" id="4876034">(</span><span class="ident" id="4876035">out</span>&nbsp;<span class="op" id="4876039">*</span><span class="ident" id="4876040">forkableWriter</span><span class="op" id="4876054">,</span>&nbsp;<span class="ident" id="4876056">v</span>&nbsp;<span class="builtintype" id="4876058">int</span><span class="op" id="4876061">)</span>&nbsp;<span class="op" id="4876063">(</span><span class="ident" id="4876064">err</span>&nbsp;<span class="builtintype" id="4876068">error</span><span class="op" id="4876073">)</span>&nbsp;<span class="op" id="4876075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4876078">err</span>&nbsp;<span class="op" id="4876082">=</span>&nbsp;<span class="ident" id="4876084">out</span><span class="op" id="4876087">.</span><span class="ident" id="4876088">WriteByte</span><span class="op" id="4876097">(</span><span class="builtintype" id="4876098">byte</span><span class="op" id="4876102">(</span><span class="string" id="4876103">&#39;0&#39;</span>&nbsp;<span class="op" id="4876107">+</span>&nbsp;<span class="op" id="4876109">(</span><span class="ident" id="4876110">v</span><span class="op" id="4876111">/</span><span class="num" id="4876112">10</span><span class="op" id="4876114">)</span><span class="op" id="4876115">%</span><span class="num" id="4876116">10</span><span class="op" id="4876118">)</span><span class="op" id="4876119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4876122">if</span>&nbsp;<span class="ident" id="4876125">err</span>&nbsp;<span class="op" id="4876129">!=</span>&nbsp;<span class="ident" id="4876132">nil</span>&nbsp;<span class="op" id="4876136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4876140">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4876148">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4876151">return</span>&nbsp;<span class="ident" id="4876158">out</span><span class="op" id="4876161">.</span><span class="ident" id="4876162">WriteByte</span><span class="op" id="4876171">(</span><span class="builtintype" id="4876172">byte</span><span class="op" id="4876176">(</span><span class="string" id="4876177">&#39;0&#39;</span>&nbsp;<span class="op" id="4876181">+</span>&nbsp;<span class="ident" id="4876183">v</span><span class="op" id="4876184">%</span><span class="num" id="4876185">10</span><span class="op" id="4876187">)</span><span class="op" id="4876188">)</span><br>
<span class="lineno"></span><span class="op" id="4876190">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4876193">func</span>&nbsp;<span class="ident" id="4876198">marshalFourDigits</span><span class="op" id="4876215">(</span><span class="ident" id="4876216">out</span>&nbsp;<span class="op" id="4876220">*</span><span class="ident" id="4876221">forkableWriter</span><span class="op" id="4876235">,</span>&nbsp;<span class="ident" id="4876237">v</span>&nbsp;<span class="builtintype" id="4876239">int</span><span class="op" id="4876242">)</span>&nbsp;<span class="op" id="4876244">(</span><span class="ident" id="4876245">err</span>&nbsp;<span class="builtintype" id="4876249">error</span><span class="op" id="4876254">)</span>&nbsp;<span class="op" id="4876256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4876259">var</span>&nbsp;<span class="ident" id="4876263">bytes</span>&nbsp;<span class="op" id="4876269">[</span><span class="num" id="4876270">4</span><span class="op" id="4876271">]</span><span class="builtintype" id="4876272">byte</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4876278">for</span>&nbsp;<span class="ident" id="4876282">i</span>&nbsp;<span class="op" id="4876284">:=</span>&nbsp;<span class="keyword" id="4876287">range</span>&nbsp;<span class="ident" id="4876293">bytes</span>&nbsp;<span class="op" id="4876299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4876303">bytes</span><span class="op" id="4876308">[</span><span class="num" id="4876309">3</span><span class="op" id="4876310">-</span><span class="ident" id="4876311">i</span><span class="op" id="4876312">]</span>&nbsp;<span class="op" id="4876314">=</span>&nbsp;<span class="string" id="4876316">&#39;0&#39;</span>&nbsp;<span class="op" id="4876320">+</span>&nbsp;<span class="builtintype" id="4876322">byte</span><span class="op" id="4876326">(</span><span class="ident" id="4876327">v</span><span class="op" id="4876328">%</span><span class="num" id="4876329">10</span><span class="op" id="4876331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4876335">v</span>&nbsp;<span class="op" id="4876337">/=</span>&nbsp;<span class="num" id="4876340">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4876344">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4876347">_</span><span class="op" id="4876348">,</span>&nbsp;<span class="ident" id="4876350">err</span>&nbsp;<span class="op" id="4876354">=</span>&nbsp;<span class="ident" id="4876356">out</span><span class="op" id="4876359">.</span><span class="ident" id="4876360">Write</span><span class="op" id="4876365">(</span><span class="ident" id="4876366">bytes</span><span class="op" id="4876371">[</span><span class="op" id="4876372">:</span><span class="op" id="4876373">]</span><span class="op" id="4876374">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4876377">return</span><br>
<span class="lineno"></span><span class="op" id="4876384">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4876387">func</span>&nbsp;<span class="ident" id="4876392">outsideUTCRange</span><span class="op" id="4876407">(</span><span class="ident" id="4876408">t</span>&nbsp;<span class="ident" id="4876410">time</span><span class="op" id="4876414">.</span><span class="ident" id="4876415">Time</span><span class="op" id="4876419">)</span>&nbsp;<span class="builtintype" id="4876421">bool</span>&nbsp;<span class="op" id="4876426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4876429">year</span>&nbsp;<span class="op" id="4876434">:=</span>&nbsp;<span class="ident" id="4876437">t</span><span class="op" id="4876438">.</span><span class="ident" id="4876439">Year</span><span class="op" id="4876443">(</span><span class="op" id="4876444">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4876447">return</span>&nbsp;<span class="ident" id="4876454">year</span>&nbsp;<span class="op" id="4876459">&lt;</span>&nbsp;<span class="num" id="4876461">1950</span>&nbsp;<span class="op" id="4876466">||</span>&nbsp;<span class="ident" id="4876469">year</span>&nbsp;<span class="op" id="4876474">&gt;=</span>&nbsp;<span class="num" id="4876477">2050</span><br>
<span class="lineno"></span><span class="op" id="4876482">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4876485">func</span>&nbsp;<span class="ident" id="4876490">marshalUTCTime</span><span class="op" id="4876504">(</span><span class="ident" id="4876505">out</span>&nbsp;<span class="op" id="4876509">*</span><span class="ident" id="4876510">forkableWriter</span><span class="op" id="4876524">,</span>&nbsp;<span class="ident" id="4876526">t</span>&nbsp;<span class="ident" id="4876528">time</span><span class="op" id="4876532">.</span><span class="ident" id="4876533">Time</span><span class="op" id="4876537">)</span>&nbsp;<span class="op" id="4876539">(</span><span class="ident" id="4876540">err</span>&nbsp;<span class="builtintype" id="4876544">error</span><span class="op" id="4876549">)</span>&nbsp;<span class="op" id="4876551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4876554">year</span>&nbsp;<span class="op" id="4876559">:=</span>&nbsp;<span class="ident" id="4876562">t</span><span class="op" id="4876563">.</span><span class="ident" id="4876564">Year</span><span class="op" id="4876568">(</span><span class="op" id="4876569">)</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4876573">switch</span>&nbsp;<span class="op" id="4876580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4876583">case</span>&nbsp;<span class="num" id="4876588">1950</span>&nbsp;<span class="op" id="4876593">&lt;=</span>&nbsp;<span class="ident" id="4876596">year</span>&nbsp;<span class="op" id="4876601">&amp;&amp;</span>&nbsp;<span class="ident" id="4876604">year</span>&nbsp;<span class="op" id="4876609">&lt;</span>&nbsp;<span class="num" id="4876611">2000</span><span class="op" id="4876615">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4876619">err</span>&nbsp;<span class="op" id="4876623">=</span>&nbsp;<span class="ident" id="4876625">marshalTwoDigits</span><span class="op" id="4876641">(</span><span class="ident" id="4876642">out</span><span class="op" id="4876645">,</span>&nbsp;<span class="builtintype" id="4876647">int</span><span class="op" id="4876650">(</span><span class="ident" id="4876651">year</span><span class="op" id="4876655">-</span><span class="num" id="4876656">1900</span><span class="op" id="4876660">)</span><span class="op" id="4876661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4876664">case</span>&nbsp;<span class="num" id="4876669">2000</span>&nbsp;<span class="op" id="4876674">&lt;=</span>&nbsp;<span class="ident" id="4876677">year</span>&nbsp;<span class="op" id="4876682">&amp;&amp;</span>&nbsp;<span class="ident" id="4876685">year</span>&nbsp;<span class="op" id="4876690">&lt;</span>&nbsp;<span class="num" id="4876692">2050</span><span class="op" id="4876696">:</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4876700">err</span>&nbsp;<span class="op" id="4876704">=</span>&nbsp;<span class="ident" id="4876706">marshalTwoDigits</span><span class="op" id="4876722">(</span><span class="ident" id="4876723">out</span><span class="op" id="4876726">,</span>&nbsp;<span class="builtintype" id="4876728">int</span><span class="op" id="4876731">(</span><span class="ident" id="4876732">year</span><span class="op" id="4876736">-</span><span class="num" id="4876737">2000</span><span class="op" id="4876741">)</span><span class="op" id="4876742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4876745">default</span><span class="op" id="4876752">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4876756">return</span>&nbsp;<span class="ident" id="4876763">StructuralError</span><span class="op" id="4876778">{</span><span class="string" id="4876779">&#34;cannot&nbsp;represent&nbsp;time&nbsp;as&nbsp;UTCTime&#34;</span><span class="op" id="4876813">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4876816">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4876819">if</span>&nbsp;<span class="ident" id="4876822">err</span>&nbsp;<span class="op" id="4876826">!=</span>&nbsp;<span class="ident" id="4876829">nil</span>&nbsp;<span class="op" id="4876833">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4876837">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4876845">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4876849">return</span>&nbsp;<span class="ident" id="4876856">marshalTimeCommon</span><span class="op" id="4876873">(</span><span class="ident" id="4876874">out</span><span class="op" id="4876877">,</span>&nbsp;<span class="ident" id="4876879">t</span><span class="op" id="4876880">)</span><br>
<span class="lineno"></span><span class="op" id="4876882">}</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span><span class="keyword" id="4876885">func</span>&nbsp;<span class="ident" id="4876890">marshalGeneralizedTime</span><span class="op" id="4876912">(</span><span class="ident" id="4876913">out</span>&nbsp;<span class="op" id="4876917">*</span><span class="ident" id="4876918">forkableWriter</span><span class="op" id="4876932">,</span>&nbsp;<span class="ident" id="4876934">t</span>&nbsp;<span class="ident" id="4876936">time</span><span class="op" id="4876940">.</span><span class="ident" id="4876941">Time</span><span class="op" id="4876945">)</span>&nbsp;<span class="op" id="4876947">(</span><span class="ident" id="4876948">err</span>&nbsp;<span class="builtintype" id="4876952">error</span><span class="op" id="4876957">)</span>&nbsp;<span class="op" id="4876959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4876962">year</span>&nbsp;<span class="op" id="4876967">:=</span>&nbsp;<span class="ident" id="4876970">t</span><span class="op" id="4876971">.</span><span class="ident" id="4876972">Year</span><span class="op" id="4876976">(</span><span class="op" id="4876977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4876980">if</span>&nbsp;<span class="ident" id="4876983">year</span>&nbsp;<span class="op" id="4876988">&lt;</span>&nbsp;<span class="num" id="4876990">0</span>&nbsp;<span class="op" id="4876992">||</span>&nbsp;<span class="ident" id="4876995">year</span>&nbsp;<span class="op" id="4877000">&gt;</span>&nbsp;<span class="num" id="4877002">9999</span>&nbsp;<span class="op" id="4877007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4877011">return</span>&nbsp;<span class="ident" id="4877018">StructuralError</span><span class="op" id="4877033">{</span><span class="string" id="4877034">&#34;cannot&nbsp;represent&nbsp;time&nbsp;as&nbsp;GeneralizedTime&#34;</span><span class="op" id="4877076">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4877079">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4877082">if</span>&nbsp;<span class="ident" id="4877085">err</span>&nbsp;<span class="op" id="4877089">=</span>&nbsp;<span class="ident" id="4877091">marshalFourDigits</span><span class="op" id="4877108">(</span><span class="ident" id="4877109">out</span><span class="op" id="4877112">,</span>&nbsp;<span class="ident" id="4877114">year</span><span class="op" id="4877118">)</span><span class="op" id="4877119">;</span>&nbsp;<span class="ident" id="4877121">err</span>&nbsp;<span class="op" id="4877125">!=</span>&nbsp;<span class="ident" id="4877128">nil</span>&nbsp;<span class="op" id="4877132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4877136">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4877144">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4877148">return</span>&nbsp;<span class="ident" id="4877155">marshalTimeCommon</span><span class="op" id="4877172">(</span><span class="ident" id="4877173">out</span><span class="op" id="4877176">,</span>&nbsp;<span class="ident" id="4877178">t</span><span class="op" id="4877179">)</span><br>
<span class="lineno"></span><span class="op" id="4877181">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4877184">func</span>&nbsp;<span class="ident" id="4877189">marshalTimeCommon</span><span class="op" id="4877206">(</span><span class="ident" id="4877207">out</span>&nbsp;<span class="op" id="4877211">*</span><span class="ident" id="4877212">forkableWriter</span><span class="op" id="4877226">,</span>&nbsp;<span class="ident" id="4877228">t</span>&nbsp;<span class="ident" id="4877230">time</span><span class="op" id="4877234">.</span><span class="ident" id="4877235">Time</span><span class="op" id="4877239">)</span>&nbsp;<span class="op" id="4877241">(</span><span class="ident" id="4877242">err</span>&nbsp;<span class="builtintype" id="4877246">error</span><span class="op" id="4877251">)</span>&nbsp;<span class="op" id="4877253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4877256">_</span><span class="op" id="4877257">,</span>&nbsp;<span class="ident" id="4877259">month</span><span class="op" id="4877264">,</span>&nbsp;<span class="ident" id="4877266">day</span>&nbsp;<span class="op" id="4877270">:=</span>&nbsp;<span class="ident" id="4877273">t</span><span class="op" id="4877274">.</span><span class="ident" id="4877275">Date</span><span class="op" id="4877279">(</span><span class="op" id="4877280">)</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4877284">err</span>&nbsp;<span class="op" id="4877288">=</span>&nbsp;<span class="ident" id="4877290">marshalTwoDigits</span><span class="op" id="4877306">(</span><span class="ident" id="4877307">out</span><span class="op" id="4877310">,</span>&nbsp;<span class="builtintype" id="4877312">int</span><span class="op" id="4877315">(</span><span class="ident" id="4877316">month</span><span class="op" id="4877321">)</span><span class="op" id="4877322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4877325">if</span>&nbsp;<span class="ident" id="4877328">err</span>&nbsp;<span class="op" id="4877332">!=</span>&nbsp;<span class="ident" id="4877335">nil</span>&nbsp;<span class="op" id="4877339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4877343">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4877351">}</span><br>
<span class="lineno">350</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4877355">err</span>&nbsp;<span class="op" id="4877359">=</span>&nbsp;<span class="ident" id="4877361">marshalTwoDigits</span><span class="op" id="4877377">(</span><span class="ident" id="4877378">out</span><span class="op" id="4877381">,</span>&nbsp;<span class="ident" id="4877383">day</span><span class="op" id="4877386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4877389">if</span>&nbsp;<span class="ident" id="4877392">err</span>&nbsp;<span class="op" id="4877396">!=</span>&nbsp;<span class="ident" id="4877399">nil</span>&nbsp;<span class="op" id="4877403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4877407">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4877415">}</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4877419">hour</span><span class="op" id="4877423">,</span>&nbsp;<span class="ident" id="4877425">min</span><span class="op" id="4877428">,</span>&nbsp;<span class="ident" id="4877430">sec</span>&nbsp;<span class="op" id="4877434">:=</span>&nbsp;<span class="ident" id="4877437">t</span><span class="op" id="4877438">.</span><span class="ident" id="4877439">Clock</span><span class="op" id="4877444">(</span><span class="op" id="4877445">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4877449">err</span>&nbsp;<span class="op" id="4877453">=</span>&nbsp;<span class="ident" id="4877455">marshalTwoDigits</span><span class="op" id="4877471">(</span><span class="ident" id="4877472">out</span><span class="op" id="4877475">,</span>&nbsp;<span class="ident" id="4877477">hour</span><span class="op" id="4877481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4877484">if</span>&nbsp;<span class="ident" id="4877487">err</span>&nbsp;<span class="op" id="4877491">!=</span>&nbsp;<span class="ident" id="4877494">nil</span>&nbsp;<span class="op" id="4877498">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4877502">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4877510">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4877514">err</span>&nbsp;<span class="op" id="4877518">=</span>&nbsp;<span class="ident" id="4877520">marshalTwoDigits</span><span class="op" id="4877536">(</span><span class="ident" id="4877537">out</span><span class="op" id="4877540">,</span>&nbsp;<span class="ident" id="4877542">min</span><span class="op" id="4877545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4877548">if</span>&nbsp;<span class="ident" id="4877551">err</span>&nbsp;<span class="op" id="4877555">!=</span>&nbsp;<span class="ident" id="4877558">nil</span>&nbsp;<span class="op" id="4877562">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4877566">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4877574">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4877578">err</span>&nbsp;<span class="op" id="4877582">=</span>&nbsp;<span class="ident" id="4877584">marshalTwoDigits</span><span class="op" id="4877600">(</span><span class="ident" id="4877601">out</span><span class="op" id="4877604">,</span>&nbsp;<span class="ident" id="4877606">sec</span><span class="op" id="4877609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4877612">if</span>&nbsp;<span class="ident" id="4877615">err</span>&nbsp;<span class="op" id="4877619">!=</span>&nbsp;<span class="ident" id="4877622">nil</span>&nbsp;<span class="op" id="4877626">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4877630">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4877638">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4877642">_</span><span class="op" id="4877643">,</span>&nbsp;<span class="ident" id="4877645">offset</span>&nbsp;<span class="op" id="4877652">:=</span>&nbsp;<span class="ident" id="4877655">t</span><span class="op" id="4877656">.</span><span class="ident" id="4877657">Zone</span><span class="op" id="4877661">(</span><span class="op" id="4877662">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4877666">switch</span>&nbsp;<span class="op" id="4877673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4877676">case</span>&nbsp;<span class="ident" id="4877681">offset</span><span class="op" id="4877687">/</span><span class="num" id="4877688">60</span>&nbsp;<span class="op" id="4877691">==</span>&nbsp;<span class="num" id="4877694">0</span><span class="op" id="4877695">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4877699">err</span>&nbsp;<span class="op" id="4877703">=</span>&nbsp;<span class="ident" id="4877705">out</span><span class="op" id="4877708">.</span><span class="ident" id="4877709">WriteByte</span><span class="op" id="4877718">(</span><span class="string" id="4877719">&#39;Z&#39;</span><span class="op" id="4877722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4877726">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4877734">case</span>&nbsp;<span class="ident" id="4877739">offset</span>&nbsp;<span class="op" id="4877746">&gt;</span>&nbsp;<span class="num" id="4877748">0</span><span class="op" id="4877749">:</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4877753">err</span>&nbsp;<span class="op" id="4877757">=</span>&nbsp;<span class="ident" id="4877759">out</span><span class="op" id="4877762">.</span><span class="ident" id="4877763">WriteByte</span><span class="op" id="4877772">(</span><span class="string" id="4877773">&#39;+&#39;</span><span class="op" id="4877776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4877779">case</span>&nbsp;<span class="ident" id="4877784">offset</span>&nbsp;<span class="op" id="4877791">&lt;</span>&nbsp;<span class="num" id="4877793">0</span><span class="op" id="4877794">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4877798">err</span>&nbsp;<span class="op" id="4877802">=</span>&nbsp;<span class="ident" id="4877804">out</span><span class="op" id="4877807">.</span><span class="ident" id="4877808">WriteByte</span><span class="op" id="4877817">(</span><span class="string" id="4877818">&#39;-&#39;</span><span class="op" id="4877821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4877824">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4877828">if</span>&nbsp;<span class="ident" id="4877831">err</span>&nbsp;<span class="op" id="4877835">!=</span>&nbsp;<span class="ident" id="4877838">nil</span>&nbsp;<span class="op" id="4877842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4877846">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4877854">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4877858">offsetMinutes</span>&nbsp;<span class="op" id="4877872">:=</span>&nbsp;<span class="ident" id="4877875">offset</span>&nbsp;<span class="op" id="4877882">/</span>&nbsp;<span class="num" id="4877884">60</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4877888">if</span>&nbsp;<span class="ident" id="4877891">offsetMinutes</span>&nbsp;<span class="op" id="4877905">&lt;</span>&nbsp;<span class="num" id="4877907">0</span>&nbsp;<span class="op" id="4877909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4877913">offsetMinutes</span>&nbsp;<span class="op" id="4877927">=</span>&nbsp;<span class="op" id="4877929">-</span><span class="ident" id="4877930">offsetMinutes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4877945">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4877949">err</span>&nbsp;<span class="op" id="4877953">=</span>&nbsp;<span class="ident" id="4877955">marshalTwoDigits</span><span class="op" id="4877971">(</span><span class="ident" id="4877972">out</span><span class="op" id="4877975">,</span>&nbsp;<span class="ident" id="4877977">offsetMinutes</span><span class="op" id="4877990">/</span><span class="num" id="4877991">60</span><span class="op" id="4877993">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4877996">if</span>&nbsp;<span class="ident" id="4877999">err</span>&nbsp;<span class="op" id="4878003">!=</span>&nbsp;<span class="ident" id="4878006">nil</span>&nbsp;<span class="op" id="4878010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4878014">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4878022">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4878026">err</span>&nbsp;<span class="op" id="4878030">=</span>&nbsp;<span class="ident" id="4878032">marshalTwoDigits</span><span class="op" id="4878048">(</span><span class="ident" id="4878049">out</span><span class="op" id="4878052">,</span>&nbsp;<span class="ident" id="4878054">offsetMinutes</span><span class="op" id="4878067">%</span><span class="num" id="4878068">60</span><span class="op" id="4878070">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4878073">return</span><br>
<span class="lineno"></span><span class="op" id="4878080">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4878083">func</span>&nbsp;<span class="ident" id="4878088">stripTagAndLength</span><span class="op" id="4878105">(</span><span class="ident" id="4878106">in</span>&nbsp;<span class="op" id="4878109">[</span><span class="op" id="4878110">]</span><span class="builtintype" id="4878111">byte</span><span class="op" id="4878115">)</span>&nbsp;<span class="op" id="4878117">[</span><span class="op" id="4878118">]</span><span class="builtintype" id="4878119">byte</span>&nbsp;<span class="op" id="4878124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4878127">_</span><span class="op" id="4878128">,</span>&nbsp;<span class="ident" id="4878130">offset</span><span class="op" id="4878136">,</span>&nbsp;<span class="ident" id="4878138">err</span>&nbsp;<span class="op" id="4878142">:=</span>&nbsp;<span class="ident" id="4878145">parseTagAndLength</span><span class="op" id="4878162">(</span><span class="ident" id="4878163">in</span><span class="op" id="4878165">,</span>&nbsp;<span class="num" id="4878167">0</span><span class="op" id="4878168">)</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4878171">if</span>&nbsp;<span class="ident" id="4878174">err</span>&nbsp;<span class="op" id="4878178">!=</span>&nbsp;<span class="ident" id="4878181">nil</span>&nbsp;<span class="op" id="4878185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4878189">return</span>&nbsp;<span class="ident" id="4878196">in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4878200">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4878203">return</span>&nbsp;<span class="ident" id="4878210">in</span><span class="op" id="4878212">[</span><span class="ident" id="4878213">offset</span><span class="op" id="4878219">:</span><span class="op" id="4878220">]</span><br>
<span class="lineno"></span><span class="op" id="4878222">}</span><br>
<span class="lineno">410</span><br>
<span class="lineno"></span><span class="keyword" id="4878225">func</span>&nbsp;<span class="ident" id="4878230">marshalBody</span><span class="op" id="4878241">(</span><span class="ident" id="4878242">out</span>&nbsp;<span class="op" id="4878246">*</span><span class="ident" id="4878247">forkableWriter</span><span class="op" id="4878261">,</span>&nbsp;<span class="ident" id="4878263">value</span>&nbsp;<span class="ident" id="4878269">reflect</span><span class="op" id="4878276">.</span><span class="ident" id="4878277">Value</span><span class="op" id="4878282">,</span>&nbsp;<span class="ident" id="4878284">params</span>&nbsp;<span class="ident" id="4878291">fieldParameters</span><span class="op" id="4878306">)</span>&nbsp;<span class="op" id="4878308">(</span><span class="ident" id="4878309">err</span>&nbsp;<span class="builtintype" id="4878313">error</span><span class="op" id="4878318">)</span>&nbsp;<span class="op" id="4878320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4878323">switch</span>&nbsp;<span class="ident" id="4878330">value</span><span class="op" id="4878335">.</span><span class="ident" id="4878336">Type</span><span class="op" id="4878340">(</span><span class="op" id="4878341">)</span>&nbsp;<span class="op" id="4878343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4878346">case</span>&nbsp;<span class="ident" id="4878351">timeType</span><span class="op" id="4878359">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4878363">t</span>&nbsp;<span class="op" id="4878365">:=</span>&nbsp;<span class="ident" id="4878368">value</span><span class="op" id="4878373">.</span><span class="ident" id="4878374">Interface</span><span class="op" id="4878383">(</span><span class="op" id="4878384">)</span><span class="op" id="4878385">.</span><span class="op" id="4878386">(</span><span class="ident" id="4878387">time</span><span class="op" id="4878391">.</span><span class="ident" id="4878392">Time</span><span class="op" id="4878396">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4878400">if</span>&nbsp;<span class="ident" id="4878403">outsideUTCRange</span><span class="op" id="4878418">(</span><span class="ident" id="4878419">t</span><span class="op" id="4878420">)</span>&nbsp;<span class="op" id="4878422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4878427">return</span>&nbsp;<span class="ident" id="4878434">marshalGeneralizedTime</span><span class="op" id="4878456">(</span><span class="ident" id="4878457">out</span><span class="op" id="4878460">,</span>&nbsp;<span class="ident" id="4878462">t</span><span class="op" id="4878463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4878467">}</span>&nbsp;<span class="keyword" id="4878469">else</span>&nbsp;<span class="op" id="4878474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4878479">return</span>&nbsp;<span class="ident" id="4878486">marshalUTCTime</span><span class="op" id="4878500">(</span><span class="ident" id="4878501">out</span><span class="op" id="4878504">,</span>&nbsp;<span class="ident" id="4878506">t</span><span class="op" id="4878507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4878511">}</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4878514">case</span>&nbsp;<span class="ident" id="4878519">bitStringType</span><span class="op" id="4878532">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4878536">return</span>&nbsp;<span class="ident" id="4878543">marshalBitString</span><span class="op" id="4878559">(</span><span class="ident" id="4878560">out</span><span class="op" id="4878563">,</span>&nbsp;<span class="ident" id="4878565">value</span><span class="op" id="4878570">.</span><span class="ident" id="4878571">Interface</span><span class="op" id="4878580">(</span><span class="op" id="4878581">)</span><span class="op" id="4878582">.</span><span class="op" id="4878583">(</span><span class="ident" id="4878584">BitString</span><span class="op" id="4878593">)</span><span class="op" id="4878594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4878597">case</span>&nbsp;<span class="ident" id="4878602">objectIdentifierType</span><span class="op" id="4878622">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4878626">return</span>&nbsp;<span class="ident" id="4878633">marshalObjectIdentifier</span><span class="op" id="4878656">(</span><span class="ident" id="4878657">out</span><span class="op" id="4878660">,</span>&nbsp;<span class="ident" id="4878662">value</span><span class="op" id="4878667">.</span><span class="ident" id="4878668">Interface</span><span class="op" id="4878677">(</span><span class="op" id="4878678">)</span><span class="op" id="4878679">.</span><span class="op" id="4878680">(</span><span class="ident" id="4878681">ObjectIdentifier</span><span class="op" id="4878697">)</span><span class="op" id="4878698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4878701">case</span>&nbsp;<span class="ident" id="4878706">bigIntType</span><span class="op" id="4878716">:</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4878720">return</span>&nbsp;<span class="ident" id="4878727">marshalBigInt</span><span class="op" id="4878740">(</span><span class="ident" id="4878741">out</span><span class="op" id="4878744">,</span>&nbsp;<span class="ident" id="4878746">value</span><span class="op" id="4878751">.</span><span class="ident" id="4878752">Interface</span><span class="op" id="4878761">(</span><span class="op" id="4878762">)</span><span class="op" id="4878763">.</span><span class="op" id="4878764">(</span><span class="op" id="4878765">*</span><span class="ident" id="4878766">big</span><span class="op" id="4878769">.</span><span class="ident" id="4878770">Int</span><span class="op" id="4878773">)</span><span class="op" id="4878774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4878777">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4878781">switch</span>&nbsp;<span class="ident" id="4878788">v</span>&nbsp;<span class="op" id="4878790">:=</span>&nbsp;<span class="ident" id="4878793">value</span><span class="op" id="4878798">;</span>&nbsp;<span class="ident" id="4878800">v</span><span class="op" id="4878801">.</span><span class="ident" id="4878802">Kind</span><span class="op" id="4878806">(</span><span class="op" id="4878807">)</span>&nbsp;<span class="op" id="4878809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4878812">case</span>&nbsp;<span class="ident" id="4878817">reflect</span><span class="op" id="4878824">.</span><span class="ident" id="4878825">Bool</span><span class="op" id="4878829">:</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4878833">if</span>&nbsp;<span class="ident" id="4878836">v</span><span class="op" id="4878837">.</span><span class="ident" id="4878838">Bool</span><span class="op" id="4878842">(</span><span class="op" id="4878843">)</span>&nbsp;<span class="op" id="4878845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4878850">return</span>&nbsp;<span class="ident" id="4878857">out</span><span class="op" id="4878860">.</span><span class="ident" id="4878861">WriteByte</span><span class="op" id="4878870">(</span><span class="num" id="4878871">255</span><span class="op" id="4878874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4878878">}</span>&nbsp;<span class="keyword" id="4878880">else</span>&nbsp;<span class="op" id="4878885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4878890">return</span>&nbsp;<span class="ident" id="4878897">out</span><span class="op" id="4878900">.</span><span class="ident" id="4878901">WriteByte</span><span class="op" id="4878910">(</span><span class="num" id="4878911">0</span><span class="op" id="4878912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4878916">}</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4878919">case</span>&nbsp;<span class="ident" id="4878924">reflect</span><span class="op" id="4878931">.</span><span class="ident" id="4878932">Int</span><span class="op" id="4878935">,</span>&nbsp;<span class="ident" id="4878937">reflect</span><span class="op" id="4878944">.</span><span class="ident" id="4878945">Int8</span><span class="op" id="4878949">,</span>&nbsp;<span class="ident" id="4878951">reflect</span><span class="op" id="4878958">.</span><span class="ident" id="4878959">Int16</span><span class="op" id="4878964">,</span>&nbsp;<span class="ident" id="4878966">reflect</span><span class="op" id="4878973">.</span><span class="ident" id="4878974">Int32</span><span class="op" id="4878979">,</span>&nbsp;<span class="ident" id="4878981">reflect</span><span class="op" id="4878988">.</span><span class="ident" id="4878989">Int64</span><span class="op" id="4878994">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4878998">return</span>&nbsp;<span class="ident" id="4879005">marshalInt64</span><span class="op" id="4879017">(</span><span class="ident" id="4879018">out</span><span class="op" id="4879021">,</span>&nbsp;<span class="ident" id="4879023">int64</span><span class="op" id="4879028">(</span><span class="ident" id="4879029">v</span><span class="op" id="4879030">.</span><span class="ident" id="4879031">Int</span><span class="op" id="4879034">(</span><span class="op" id="4879035">)</span><span class="op" id="4879036">)</span><span class="op" id="4879037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4879040">case</span>&nbsp;<span class="ident" id="4879045">reflect</span><span class="op" id="4879052">.</span><span class="ident" id="4879053">Struct</span><span class="op" id="4879059">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4879063">t</span>&nbsp;<span class="op" id="4879065">:=</span>&nbsp;<span class="ident" id="4879068">v</span><span class="op" id="4879069">.</span><span class="ident" id="4879070">Type</span><span class="op" id="4879074">(</span><span class="op" id="4879075">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4879080">startingField</span>&nbsp;<span class="op" id="4879094">:=</span>&nbsp;<span class="num" id="4879097">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4879102">//&nbsp;If&nbsp;the&nbsp;first&nbsp;element&nbsp;of&nbsp;the&nbsp;structure&nbsp;is&nbsp;a&nbsp;non-empty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4879160">//&nbsp;RawContents,&nbsp;then&nbsp;we&nbsp;don&#39;t&nbsp;bother&nbsp;serializing&nbsp;the&nbsp;rest.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4879221">if</span>&nbsp;<span class="ident" id="4879224">t</span><span class="op" id="4879225">.</span><span class="ident" id="4879226">NumField</span><span class="op" id="4879234">(</span><span class="op" id="4879235">)</span>&nbsp;<span class="op" id="4879237">&gt;</span>&nbsp;<span class="num" id="4879239">0</span>&nbsp;<span class="op" id="4879241">&amp;&amp;</span>&nbsp;<span class="ident" id="4879244">t</span><span class="op" id="4879245">.</span><span class="ident" id="4879246">Field</span><span class="op" id="4879251">(</span><span class="num" id="4879252">0</span><span class="op" id="4879253">)</span><span class="op" id="4879254">.</span><span class="ident" id="4879255">Type</span>&nbsp;<span class="op" id="4879260">==</span>&nbsp;<span class="ident" id="4879263">rawContentsType</span>&nbsp;<span class="op" id="4879279">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4879284">s</span>&nbsp;<span class="op" id="4879286">:=</span>&nbsp;<span class="ident" id="4879289">v</span><span class="op" id="4879290">.</span><span class="ident" id="4879291">Field</span><span class="op" id="4879296">(</span><span class="num" id="4879297">0</span><span class="op" id="4879298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4879303">if</span>&nbsp;<span class="ident" id="4879306">s</span><span class="op" id="4879307">.</span><span class="ident" id="4879308">Len</span><span class="op" id="4879311">(</span><span class="op" id="4879312">)</span>&nbsp;<span class="op" id="4879314">&gt;</span>&nbsp;<span class="num" id="4879316">0</span>&nbsp;<span class="op" id="4879318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4879324">bytes</span>&nbsp;<span class="op" id="4879330">:=</span>&nbsp;<span class="builtinfunc" id="4879333">make</span><span class="op" id="4879337">(</span><span class="op" id="4879338">[</span><span class="op" id="4879339">]</span><span class="builtintype" id="4879340">byte</span><span class="op" id="4879344">,</span>&nbsp;<span class="ident" id="4879346">s</span><span class="op" id="4879347">.</span><span class="ident" id="4879348">Len</span><span class="op" id="4879351">(</span><span class="op" id="4879352">)</span><span class="op" id="4879353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4879359">for</span>&nbsp;<span class="ident" id="4879363">i</span>&nbsp;<span class="op" id="4879365">:=</span>&nbsp;<span class="num" id="4879368">0</span><span class="op" id="4879369">;</span>&nbsp;<span class="ident" id="4879371">i</span>&nbsp;<span class="op" id="4879373">&lt;</span>&nbsp;<span class="ident" id="4879375">s</span><span class="op" id="4879376">.</span><span class="ident" id="4879377">Len</span><span class="op" id="4879380">(</span><span class="op" id="4879381">)</span><span class="op" id="4879382">;</span>&nbsp;<span class="ident" id="4879384">i</span><span class="op" id="4879385">++</span>&nbsp;<span class="op" id="4879388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4879395">bytes</span><span class="op" id="4879400">[</span><span class="ident" id="4879401">i</span><span class="op" id="4879402">]</span>&nbsp;<span class="op" id="4879404">=</span>&nbsp;<span class="builtintype" id="4879406">uint8</span><span class="op" id="4879411">(</span><span class="ident" id="4879412">s</span><span class="op" id="4879413">.</span><span class="ident" id="4879414">Index</span><span class="op" id="4879419">(</span><span class="ident" id="4879420">i</span><span class="op" id="4879421">)</span><span class="op" id="4879422">.</span><span class="ident" id="4879423">Uint</span><span class="op" id="4879427">(</span><span class="op" id="4879428">)</span><span class="op" id="4879429">)</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4879435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4879441">/*&nbsp;The&nbsp;RawContents&nbsp;will&nbsp;contain&nbsp;the&nbsp;tag&nbsp;and<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;*&nbsp;length&nbsp;fields&nbsp;but&nbsp;we&#39;ll&nbsp;also&nbsp;be&nbsp;writing<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;*&nbsp;those&nbsp;ourselves,&nbsp;so&nbsp;we&nbsp;strip&nbsp;them&nbsp;out&nbsp;of<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;*&nbsp;bytes&nbsp;*/</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4879600">_</span><span class="op" id="4879601">,</span>&nbsp;<span class="ident" id="4879603">err</span>&nbsp;<span class="op" id="4879607">=</span>&nbsp;<span class="ident" id="4879609">out</span><span class="op" id="4879612">.</span><span class="ident" id="4879613">Write</span><span class="op" id="4879618">(</span><span class="ident" id="4879619">stripTagAndLength</span><span class="op" id="4879636">(</span><span class="ident" id="4879637">bytes</span><span class="op" id="4879642">)</span><span class="op" id="4879643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4879649">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4879659">}</span>&nbsp;<span class="keyword" id="4879661">else</span>&nbsp;<span class="op" id="4879666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4879672">startingField</span>&nbsp;<span class="op" id="4879686">=</span>&nbsp;<span class="num" id="4879688">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4879693">}</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4879697">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4879702">for</span>&nbsp;<span class="ident" id="4879706">i</span>&nbsp;<span class="op" id="4879708">:=</span>&nbsp;<span class="ident" id="4879711">startingField</span><span class="op" id="4879724">;</span>&nbsp;<span class="ident" id="4879726">i</span>&nbsp;<span class="op" id="4879728">&lt;</span>&nbsp;<span class="ident" id="4879730">t</span><span class="op" id="4879731">.</span><span class="ident" id="4879732">NumField</span><span class="op" id="4879740">(</span><span class="op" id="4879741">)</span><span class="op" id="4879742">;</span>&nbsp;<span class="ident" id="4879744">i</span><span class="op" id="4879745">++</span>&nbsp;<span class="op" id="4879748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4879753">var</span>&nbsp;<span class="ident" id="4879757">pre</span>&nbsp;<span class="op" id="4879761">*</span><span class="ident" id="4879762">forkableWriter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4879780">pre</span><span class="op" id="4879783">,</span>&nbsp;<span class="ident" id="4879785">out</span>&nbsp;<span class="op" id="4879789">=</span>&nbsp;<span class="ident" id="4879791">out</span><span class="op" id="4879794">.</span><span class="ident" id="4879795">fork</span><span class="op" id="4879799">(</span><span class="op" id="4879800">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4879805">err</span>&nbsp;<span class="op" id="4879809">=</span>&nbsp;<span class="ident" id="4879811">marshalField</span><span class="op" id="4879823">(</span><span class="ident" id="4879824">pre</span><span class="op" id="4879827">,</span>&nbsp;<span class="ident" id="4879829">v</span><span class="op" id="4879830">.</span><span class="ident" id="4879831">Field</span><span class="op" id="4879836">(</span><span class="ident" id="4879837">i</span><span class="op" id="4879838">)</span><span class="op" id="4879839">,</span>&nbsp;<span class="ident" id="4879841">parseFieldParameters</span><span class="op" id="4879861">(</span><span class="ident" id="4879862">t</span><span class="op" id="4879863">.</span><span class="ident" id="4879864">Field</span><span class="op" id="4879869">(</span><span class="ident" id="4879870">i</span><span class="op" id="4879871">)</span><span class="op" id="4879872">.</span><span class="ident" id="4879873">Tag</span><span class="op" id="4879876">.</span><span class="ident" id="4879877">Get</span><span class="op" id="4879880">(</span><span class="string" id="4879881">&#34;asn1&#34;</span><span class="op" id="4879887">)</span><span class="op" id="4879888">)</span><span class="op" id="4879889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4879894">if</span>&nbsp;<span class="ident" id="4879897">err</span>&nbsp;<span class="op" id="4879901">!=</span>&nbsp;<span class="ident" id="4879904">nil</span>&nbsp;<span class="op" id="4879908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4879914">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4879924">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4879928">}</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4879932">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4879940">case</span>&nbsp;<span class="ident" id="4879945">reflect</span><span class="op" id="4879952">.</span><span class="ident" id="4879953">Slice</span><span class="op" id="4879958">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4879962">sliceType</span>&nbsp;<span class="op" id="4879972">:=</span>&nbsp;<span class="ident" id="4879975">v</span><span class="op" id="4879976">.</span><span class="ident" id="4879977">Type</span><span class="op" id="4879981">(</span><span class="op" id="4879982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4879986">if</span>&nbsp;<span class="ident" id="4879989">sliceType</span><span class="op" id="4879998">.</span><span class="ident" id="4879999">Elem</span><span class="op" id="4880003">(</span><span class="op" id="4880004">)</span><span class="op" id="4880005">.</span><span class="ident" id="4880006">Kind</span><span class="op" id="4880010">(</span><span class="op" id="4880011">)</span>&nbsp;<span class="op" id="4880013">==</span>&nbsp;<span class="ident" id="4880016">reflect</span><span class="op" id="4880023">.</span><span class="ident" id="4880024">Uint8</span>&nbsp;<span class="op" id="4880030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4880035">bytes</span>&nbsp;<span class="op" id="4880041">:=</span>&nbsp;<span class="builtinfunc" id="4880044">make</span><span class="op" id="4880048">(</span><span class="op" id="4880049">[</span><span class="op" id="4880050">]</span><span class="builtintype" id="4880051">byte</span><span class="op" id="4880055">,</span>&nbsp;<span class="ident" id="4880057">v</span><span class="op" id="4880058">.</span><span class="ident" id="4880059">Len</span><span class="op" id="4880062">(</span><span class="op" id="4880063">)</span><span class="op" id="4880064">)</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4880069">for</span>&nbsp;<span class="ident" id="4880073">i</span>&nbsp;<span class="op" id="4880075">:=</span>&nbsp;<span class="num" id="4880078">0</span><span class="op" id="4880079">;</span>&nbsp;<span class="ident" id="4880081">i</span>&nbsp;<span class="op" id="4880083">&lt;</span>&nbsp;<span class="ident" id="4880085">v</span><span class="op" id="4880086">.</span><span class="ident" id="4880087">Len</span><span class="op" id="4880090">(</span><span class="op" id="4880091">)</span><span class="op" id="4880092">;</span>&nbsp;<span class="ident" id="4880094">i</span><span class="op" id="4880095">++</span>&nbsp;<span class="op" id="4880098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4880104">bytes</span><span class="op" id="4880109">[</span><span class="ident" id="4880110">i</span><span class="op" id="4880111">]</span>&nbsp;<span class="op" id="4880113">=</span>&nbsp;<span class="builtintype" id="4880115">uint8</span><span class="op" id="4880120">(</span><span class="ident" id="4880121">v</span><span class="op" id="4880122">.</span><span class="ident" id="4880123">Index</span><span class="op" id="4880128">(</span><span class="ident" id="4880129">i</span><span class="op" id="4880130">)</span><span class="op" id="4880131">.</span><span class="ident" id="4880132">Uint</span><span class="op" id="4880136">(</span><span class="op" id="4880137">)</span><span class="op" id="4880138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4880143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4880148">_</span><span class="op" id="4880149">,</span>&nbsp;<span class="ident" id="4880151">err</span>&nbsp;<span class="op" id="4880155">=</span>&nbsp;<span class="ident" id="4880157">out</span><span class="op" id="4880160">.</span><span class="ident" id="4880161">Write</span><span class="op" id="4880166">(</span><span class="ident" id="4880167">bytes</span><span class="op" id="4880172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4880177">return</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4880186">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4880191">var</span>&nbsp;<span class="ident" id="4880195">fp</span>&nbsp;<span class="ident" id="4880198">fieldParameters</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4880216">for</span>&nbsp;<span class="ident" id="4880220">i</span>&nbsp;<span class="op" id="4880222">:=</span>&nbsp;<span class="num" id="4880225">0</span><span class="op" id="4880226">;</span>&nbsp;<span class="ident" id="4880228">i</span>&nbsp;<span class="op" id="4880230">&lt;</span>&nbsp;<span class="ident" id="4880232">v</span><span class="op" id="4880233">.</span><span class="ident" id="4880234">Len</span><span class="op" id="4880237">(</span><span class="op" id="4880238">)</span><span class="op" id="4880239">;</span>&nbsp;<span class="ident" id="4880241">i</span><span class="op" id="4880242">++</span>&nbsp;<span class="op" id="4880245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4880250">var</span>&nbsp;<span class="ident" id="4880254">pre</span>&nbsp;<span class="op" id="4880258">*</span><span class="ident" id="4880259">forkableWriter</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4880277">pre</span><span class="op" id="4880280">,</span>&nbsp;<span class="ident" id="4880282">out</span>&nbsp;<span class="op" id="4880286">=</span>&nbsp;<span class="ident" id="4880288">out</span><span class="op" id="4880291">.</span><span class="ident" id="4880292">fork</span><span class="op" id="4880296">(</span><span class="op" id="4880297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4880302">err</span>&nbsp;<span class="op" id="4880306">=</span>&nbsp;<span class="ident" id="4880308">marshalField</span><span class="op" id="4880320">(</span><span class="ident" id="4880321">pre</span><span class="op" id="4880324">,</span>&nbsp;<span class="ident" id="4880326">v</span><span class="op" id="4880327">.</span><span class="ident" id="4880328">Index</span><span class="op" id="4880333">(</span><span class="ident" id="4880334">i</span><span class="op" id="4880335">)</span><span class="op" id="4880336">,</span>&nbsp;<span class="ident" id="4880338">fp</span><span class="op" id="4880340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4880345">if</span>&nbsp;<span class="ident" id="4880348">err</span>&nbsp;<span class="op" id="4880352">!=</span>&nbsp;<span class="ident" id="4880355">nil</span>&nbsp;<span class="op" id="4880359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4880365">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4880375">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4880379">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4880383">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4880391">case</span>&nbsp;<span class="ident" id="4880396">reflect</span><span class="op" id="4880403">.</span><span class="ident" id="4880404">String</span><span class="op" id="4880410">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4880414">switch</span>&nbsp;<span class="ident" id="4880421">params</span><span class="op" id="4880427">.</span><span class="ident" id="4880428">stringType</span>&nbsp;<span class="op" id="4880439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4880443">case</span>&nbsp;<span class="ident" id="4880448">tagIA5String</span><span class="op" id="4880460">:</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4880465">return</span>&nbsp;<span class="ident" id="4880472">marshalIA5String</span><span class="op" id="4880488">(</span><span class="ident" id="4880489">out</span><span class="op" id="4880492">,</span>&nbsp;<span class="ident" id="4880494">v</span><span class="op" id="4880495">.</span><span class="ident" id="4880496">String</span><span class="op" id="4880502">(</span><span class="op" id="4880503">)</span><span class="op" id="4880504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4880508">case</span>&nbsp;<span class="ident" id="4880513">tagPrintableString</span><span class="op" id="4880531">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4880536">return</span>&nbsp;<span class="ident" id="4880543">marshalPrintableString</span><span class="op" id="4880565">(</span><span class="ident" id="4880566">out</span><span class="op" id="4880569">,</span>&nbsp;<span class="ident" id="4880571">v</span><span class="op" id="4880572">.</span><span class="ident" id="4880573">String</span><span class="op" id="4880579">(</span><span class="op" id="4880580">)</span><span class="op" id="4880581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4880585">default</span><span class="op" id="4880592">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4880597">return</span>&nbsp;<span class="ident" id="4880604">marshalUTF8String</span><span class="op" id="4880621">(</span><span class="ident" id="4880622">out</span><span class="op" id="4880625">,</span>&nbsp;<span class="ident" id="4880627">v</span><span class="op" id="4880628">.</span><span class="ident" id="4880629">String</span><span class="op" id="4880635">(</span><span class="op" id="4880636">)</span><span class="op" id="4880637">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4880641">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4880644">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4880648">return</span>&nbsp;<span class="ident" id="4880655">StructuralError</span><span class="op" id="4880670">{</span><span class="string" id="4880671">&#34;unknown&nbsp;Go&nbsp;type&#34;</span><span class="op" id="4880688">}</span><br>
<span class="lineno"></span><span class="op" id="4880690">}</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span><span class="keyword" id="4880693">func</span>&nbsp;<span class="ident" id="4880698">marshalField</span><span class="op" id="4880710">(</span><span class="ident" id="4880711">out</span>&nbsp;<span class="op" id="4880715">*</span><span class="ident" id="4880716">forkableWriter</span><span class="op" id="4880730">,</span>&nbsp;<span class="ident" id="4880732">v</span>&nbsp;<span class="ident" id="4880734">reflect</span><span class="op" id="4880741">.</span><span class="ident" id="4880742">Value</span><span class="op" id="4880747">,</span>&nbsp;<span class="ident" id="4880749">params</span>&nbsp;<span class="ident" id="4880756">fieldParameters</span><span class="op" id="4880771">)</span>&nbsp;<span class="op" id="4880773">(</span><span class="ident" id="4880774">err</span>&nbsp;<span class="builtintype" id="4880778">error</span><span class="op" id="4880783">)</span>&nbsp;<span class="op" id="4880785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4880788">//&nbsp;If&nbsp;the&nbsp;field&nbsp;is&nbsp;an&nbsp;interface{}&nbsp;then&nbsp;recurse&nbsp;into&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4880845">if</span>&nbsp;<span class="ident" id="4880848">v</span><span class="op" id="4880849">.</span><span class="ident" id="4880850">Kind</span><span class="op" id="4880854">(</span><span class="op" id="4880855">)</span>&nbsp;<span class="op" id="4880857">==</span>&nbsp;<span class="ident" id="4880860">reflect</span><span class="op" id="4880867">.</span><span class="ident" id="4880868">Interface</span>&nbsp;<span class="op" id="4880878">&amp;&amp;</span>&nbsp;<span class="ident" id="4880881">v</span><span class="op" id="4880882">.</span><span class="ident" id="4880883">Type</span><span class="op" id="4880887">(</span><span class="op" id="4880888">)</span><span class="op" id="4880889">.</span><span class="ident" id="4880890">NumMethod</span><span class="op" id="4880899">(</span><span class="op" id="4880900">)</span>&nbsp;<span class="op" id="4880902">==</span>&nbsp;<span class="num" id="4880905">0</span>&nbsp;<span class="op" id="4880907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4880911">return</span>&nbsp;<span class="ident" id="4880918">marshalField</span><span class="op" id="4880930">(</span><span class="ident" id="4880931">out</span><span class="op" id="4880934">,</span>&nbsp;<span class="ident" id="4880936">v</span><span class="op" id="4880937">.</span><span class="ident" id="4880938">Elem</span><span class="op" id="4880942">(</span><span class="op" id="4880943">)</span><span class="op" id="4880944">,</span>&nbsp;<span class="ident" id="4880946">params</span><span class="op" id="4880952">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4880955">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4880959">if</span>&nbsp;<span class="ident" id="4880962">v</span><span class="op" id="4880963">.</span><span class="ident" id="4880964">Kind</span><span class="op" id="4880968">(</span><span class="op" id="4880969">)</span>&nbsp;<span class="op" id="4880971">==</span>&nbsp;<span class="ident" id="4880974">reflect</span><span class="op" id="4880981">.</span><span class="ident" id="4880982">Slice</span>&nbsp;<span class="op" id="4880988">&amp;&amp;</span>&nbsp;<span class="ident" id="4880991">v</span><span class="op" id="4880992">.</span><span class="ident" id="4880993">Len</span><span class="op" id="4880996">(</span><span class="op" id="4880997">)</span>&nbsp;<span class="op" id="4880999">==</span>&nbsp;<span class="num" id="4881002">0</span>&nbsp;<span class="op" id="4881004">&amp;&amp;</span>&nbsp;<span class="ident" id="4881007">params</span><span class="op" id="4881013">.</span><span class="ident" id="4881014">omitEmpty</span>&nbsp;<span class="op" id="4881024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4881028">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4881036">}</span><br>
<span class="lineno">515</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4881040">if</span>&nbsp;<span class="ident" id="4881043">params</span><span class="op" id="4881049">.</span><span class="ident" id="4881050">optional</span>&nbsp;<span class="op" id="4881059">&amp;&amp;</span>&nbsp;<span class="ident" id="4881062">params</span><span class="op" id="4881068">.</span><span class="ident" id="4881069">defaultValue</span>&nbsp;<span class="op" id="4881082">!=</span>&nbsp;<span class="ident" id="4881085">nil</span>&nbsp;<span class="op" id="4881089">&amp;&amp;</span>&nbsp;<span class="ident" id="4881092">canHaveDefaultValue</span><span class="op" id="4881111">(</span><span class="ident" id="4881112">v</span><span class="op" id="4881113">.</span><span class="ident" id="4881114">Kind</span><span class="op" id="4881118">(</span><span class="op" id="4881119">)</span><span class="op" id="4881120">)</span>&nbsp;<span class="op" id="4881122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4881126">defaultValue</span>&nbsp;<span class="op" id="4881139">:=</span>&nbsp;<span class="ident" id="4881142">reflect</span><span class="op" id="4881149">.</span><span class="ident" id="4881150">New</span><span class="op" id="4881153">(</span><span class="ident" id="4881154">v</span><span class="op" id="4881155">.</span><span class="ident" id="4881156">Type</span><span class="op" id="4881160">(</span><span class="op" id="4881161">)</span><span class="op" id="4881162">)</span><span class="op" id="4881163">.</span><span class="ident" id="4881164">Elem</span><span class="op" id="4881168">(</span><span class="op" id="4881169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4881173">defaultValue</span><span class="op" id="4881185">.</span><span class="ident" id="4881186">SetInt</span><span class="op" id="4881192">(</span><span class="op" id="4881193">*</span><span class="ident" id="4881194">params</span><span class="op" id="4881200">.</span><span class="ident" id="4881201">defaultValue</span><span class="op" id="4881213">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4881218">if</span>&nbsp;<span class="ident" id="4881221">reflect</span><span class="op" id="4881228">.</span><span class="ident" id="4881229">DeepEqual</span><span class="op" id="4881238">(</span><span class="ident" id="4881239">v</span><span class="op" id="4881240">.</span><span class="ident" id="4881241">Interface</span><span class="op" id="4881250">(</span><span class="op" id="4881251">)</span><span class="op" id="4881252">,</span>&nbsp;<span class="ident" id="4881254">defaultValue</span><span class="op" id="4881266">.</span><span class="ident" id="4881267">Interface</span><span class="op" id="4881276">(</span><span class="op" id="4881277">)</span><span class="op" id="4881278">)</span>&nbsp;<span class="op" id="4881280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4881285">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4881294">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4881297">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4881301">//&nbsp;If&nbsp;no&nbsp;default&nbsp;value&nbsp;is&nbsp;given&nbsp;then&nbsp;the&nbsp;zero&nbsp;value&nbsp;for&nbsp;the&nbsp;type&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4881370">//&nbsp;assumed&nbsp;to&nbsp;be&nbsp;the&nbsp;default&nbsp;value.&nbsp;This&nbsp;isn&#39;t&nbsp;obviously&nbsp;the&nbsp;correct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4881440">//&nbsp;behaviour,&nbsp;but&nbsp;it&#39;s&nbsp;what&nbsp;Go&nbsp;has&nbsp;traditionally&nbsp;done.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4881496">if</span>&nbsp;<span class="ident" id="4881499">params</span><span class="op" id="4881505">.</span><span class="ident" id="4881506">optional</span>&nbsp;<span class="op" id="4881515">&amp;&amp;</span>&nbsp;<span class="ident" id="4881518">params</span><span class="op" id="4881524">.</span><span class="ident" id="4881525">defaultValue</span>&nbsp;<span class="op" id="4881538">==</span>&nbsp;<span class="ident" id="4881541">nil</span>&nbsp;<span class="op" id="4881545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4881549">if</span>&nbsp;<span class="ident" id="4881552">reflect</span><span class="op" id="4881559">.</span><span class="ident" id="4881560">DeepEqual</span><span class="op" id="4881569">(</span><span class="ident" id="4881570">v</span><span class="op" id="4881571">.</span><span class="ident" id="4881572">Interface</span><span class="op" id="4881581">(</span><span class="op" id="4881582">)</span><span class="op" id="4881583">,</span>&nbsp;<span class="ident" id="4881585">reflect</span><span class="op" id="4881592">.</span><span class="ident" id="4881593">Zero</span><span class="op" id="4881597">(</span><span class="ident" id="4881598">v</span><span class="op" id="4881599">.</span><span class="ident" id="4881600">Type</span><span class="op" id="4881604">(</span><span class="op" id="4881605">)</span><span class="op" id="4881606">)</span><span class="op" id="4881607">.</span><span class="ident" id="4881608">Interface</span><span class="op" id="4881617">(</span><span class="op" id="4881618">)</span><span class="op" id="4881619">)</span>&nbsp;<span class="op" id="4881621">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4881626">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4881635">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4881638">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4881642">if</span>&nbsp;<span class="ident" id="4881645">v</span><span class="op" id="4881646">.</span><span class="ident" id="4881647">Type</span><span class="op" id="4881651">(</span><span class="op" id="4881652">)</span>&nbsp;<span class="op" id="4881654">==</span>&nbsp;<span class="ident" id="4881657">rawValueType</span>&nbsp;<span class="op" id="4881670">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4881674">rv</span>&nbsp;<span class="op" id="4881677">:=</span>&nbsp;<span class="ident" id="4881680">v</span><span class="op" id="4881681">.</span><span class="ident" id="4881682">Interface</span><span class="op" id="4881691">(</span><span class="op" id="4881692">)</span><span class="op" id="4881693">.</span><span class="op" id="4881694">(</span><span class="ident" id="4881695">RawValue</span><span class="op" id="4881703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4881707">if</span>&nbsp;<span class="builtinfunc" id="4881710">len</span><span class="op" id="4881713">(</span><span class="ident" id="4881714">rv</span><span class="op" id="4881716">.</span><span class="ident" id="4881717">FullBytes</span><span class="op" id="4881726">)</span>&nbsp;<span class="op" id="4881728">!=</span>&nbsp;<span class="num" id="4881731">0</span>&nbsp;<span class="op" id="4881733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4881738">_</span><span class="op" id="4881739">,</span>&nbsp;<span class="ident" id="4881741">err</span>&nbsp;<span class="op" id="4881745">=</span>&nbsp;<span class="ident" id="4881747">out</span><span class="op" id="4881750">.</span><span class="ident" id="4881751">Write</span><span class="op" id="4881756">(</span><span class="ident" id="4881757">rv</span><span class="op" id="4881759">.</span><span class="ident" id="4881760">FullBytes</span><span class="op" id="4881769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4881773">}</span>&nbsp;<span class="keyword" id="4881775">else</span>&nbsp;<span class="op" id="4881780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4881785">err</span>&nbsp;<span class="op" id="4881789">=</span>&nbsp;<span class="ident" id="4881791">marshalTagAndLength</span><span class="op" id="4881810">(</span><span class="ident" id="4881811">out</span><span class="op" id="4881814">,</span>&nbsp;<span class="ident" id="4881816">tagAndLength</span><span class="op" id="4881828">{</span><span class="ident" id="4881829">rv</span><span class="op" id="4881831">.</span><span class="ident" id="4881832">Class</span><span class="op" id="4881837">,</span>&nbsp;<span class="ident" id="4881839">rv</span><span class="op" id="4881841">.</span><span class="ident" id="4881842">Tag</span><span class="op" id="4881845">,</span>&nbsp;<span class="builtinfunc" id="4881847">len</span><span class="op" id="4881850">(</span><span class="ident" id="4881851">rv</span><span class="op" id="4881853">.</span><span class="ident" id="4881854">Bytes</span><span class="op" id="4881859">)</span><span class="op" id="4881860">,</span>&nbsp;<span class="ident" id="4881862">rv</span><span class="op" id="4881864">.</span><span class="ident" id="4881865">IsCompound</span><span class="op" id="4881875">}</span><span class="op" id="4881876">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4881881">if</span>&nbsp;<span class="ident" id="4881884">err</span>&nbsp;<span class="op" id="4881888">!=</span>&nbsp;<span class="ident" id="4881891">nil</span>&nbsp;<span class="op" id="4881895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4881901">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4881911">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4881916">_</span><span class="op" id="4881917">,</span>&nbsp;<span class="ident" id="4881919">err</span>&nbsp;<span class="op" id="4881923">=</span>&nbsp;<span class="ident" id="4881925">out</span><span class="op" id="4881928">.</span><span class="ident" id="4881929">Write</span><span class="op" id="4881934">(</span><span class="ident" id="4881935">rv</span><span class="op" id="4881937">.</span><span class="ident" id="4881938">Bytes</span><span class="op" id="4881943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4881947">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4881951">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4881959">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4881963">tag</span><span class="op" id="4881966">,</span>&nbsp;<span class="ident" id="4881968">isCompound</span><span class="op" id="4881978">,</span>&nbsp;<span class="ident" id="4881980">ok</span>&nbsp;<span class="op" id="4881983">:=</span>&nbsp;<span class="ident" id="4881986">getUniversalType</span><span class="op" id="4882002">(</span><span class="ident" id="4882003">v</span><span class="op" id="4882004">.</span><span class="ident" id="4882005">Type</span><span class="op" id="4882009">(</span><span class="op" id="4882010">)</span><span class="op" id="4882011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4882014">if</span>&nbsp;<span class="op" id="4882017">!</span><span class="ident" id="4882018">ok</span>&nbsp;<span class="op" id="4882021">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4882025">err</span>&nbsp;<span class="op" id="4882029">=</span>&nbsp;<span class="ident" id="4882031">StructuralError</span><span class="op" id="4882046">{</span><span class="ident" id="4882047">fmt</span><span class="op" id="4882050">.</span><span class="ident" id="4882051">Sprintf</span><span class="op" id="4882058">(</span><span class="string" id="4882059">&#34;unknown&nbsp;Go&nbsp;type:&nbsp;%v&#34;</span><span class="op" id="4882080">,</span>&nbsp;<span class="ident" id="4882082">v</span><span class="op" id="4882083">.</span><span class="ident" id="4882084">Type</span><span class="op" id="4882088">(</span><span class="op" id="4882089">)</span><span class="op" id="4882090">)</span><span class="op" id="4882091">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4882095">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4882103">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4882106">class</span>&nbsp;<span class="op" id="4882112">:=</span>&nbsp;<span class="ident" id="4882115">classUniversal</span><br>
<span class="lineno"></span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4882132">if</span>&nbsp;<span class="ident" id="4882135">params</span><span class="op" id="4882141">.</span><span class="ident" id="4882142">stringType</span>&nbsp;<span class="op" id="4882153">!=</span>&nbsp;<span class="num" id="4882156">0</span>&nbsp;<span class="op" id="4882158">&amp;&amp;</span>&nbsp;<span class="ident" id="4882161">tag</span>&nbsp;<span class="op" id="4882165">!=</span>&nbsp;<span class="ident" id="4882168">tagPrintableString</span>&nbsp;<span class="op" id="4882187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4882191">return</span>&nbsp;<span class="ident" id="4882198">StructuralError</span><span class="op" id="4882213">{</span><span class="string" id="4882214">&#34;explicit&nbsp;string&nbsp;type&nbsp;given&nbsp;to&nbsp;non-string&nbsp;member&#34;</span><span class="op" id="4882263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4882266">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4882270">switch</span>&nbsp;<span class="ident" id="4882277">tag</span>&nbsp;<span class="op" id="4882281">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4882284">case</span>&nbsp;<span class="ident" id="4882289">tagPrintableString</span><span class="op" id="4882307">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4882311">if</span>&nbsp;<span class="ident" id="4882314">params</span><span class="op" id="4882320">.</span><span class="ident" id="4882321">stringType</span>&nbsp;<span class="op" id="4882332">==</span>&nbsp;<span class="num" id="4882335">0</span>&nbsp;<span class="op" id="4882337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4882342">//&nbsp;This&nbsp;is&nbsp;a&nbsp;string&nbsp;without&nbsp;an&nbsp;explicit&nbsp;string&nbsp;type.&nbsp;We&#39;ll&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4882408">//&nbsp;a&nbsp;PrintableString&nbsp;if&nbsp;the&nbsp;character&nbsp;set&nbsp;in&nbsp;the&nbsp;string&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4882470">//&nbsp;sufficiently&nbsp;limited,&nbsp;otherwise&nbsp;we&#39;ll&nbsp;use&nbsp;a&nbsp;UTF8String.</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4882532">for</span>&nbsp;<span class="ident" id="4882536">_</span><span class="op" id="4882537">,</span>&nbsp;<span class="ident" id="4882539">r</span>&nbsp;<span class="op" id="4882541">:=</span>&nbsp;<span class="keyword" id="4882544">range</span>&nbsp;<span class="ident" id="4882550">v</span><span class="op" id="4882551">.</span><span class="ident" id="4882552">String</span><span class="op" id="4882558">(</span><span class="op" id="4882559">)</span>&nbsp;<span class="op" id="4882561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4882567">if</span>&nbsp;<span class="ident" id="4882570">r</span>&nbsp;<span class="op" id="4882572">&gt;=</span>&nbsp;<span class="ident" id="4882575">utf8</span><span class="op" id="4882579">.</span><span class="ident" id="4882580">RuneSelf</span>&nbsp;<span class="op" id="4882589">||</span>&nbsp;<span class="op" id="4882592">!</span><span class="ident" id="4882593">isPrintable</span><span class="op" id="4882604">(</span><span class="builtintype" id="4882605">byte</span><span class="op" id="4882609">(</span><span class="ident" id="4882610">r</span><span class="op" id="4882611">)</span><span class="op" id="4882612">)</span>&nbsp;<span class="op" id="4882614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4882621">if</span>&nbsp;<span class="op" id="4882624">!</span><span class="ident" id="4882625">utf8</span><span class="op" id="4882629">.</span><span class="ident" id="4882630">ValidString</span><span class="op" id="4882641">(</span><span class="ident" id="4882642">v</span><span class="op" id="4882643">.</span><span class="ident" id="4882644">String</span><span class="op" id="4882650">(</span><span class="op" id="4882651">)</span><span class="op" id="4882652">)</span>&nbsp;<span class="op" id="4882654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4882662">return</span>&nbsp;<span class="ident" id="4882669">errors</span><span class="op" id="4882675">.</span><span class="ident" id="4882676">New</span><span class="op" id="4882679">(</span><span class="string" id="4882680">&#34;asn1:&nbsp;string&nbsp;not&nbsp;valid&nbsp;UTF-8&#34;</span><span class="op" id="4882710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4882717">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4882724">tag</span>&nbsp;<span class="op" id="4882728">=</span>&nbsp;<span class="ident" id="4882730">tagUTF8String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4882749">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4882759">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4882764">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4882768">}</span>&nbsp;<span class="keyword" id="4882770">else</span>&nbsp;<span class="op" id="4882775">{</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4882780">tag</span>&nbsp;<span class="op" id="4882784">=</span>&nbsp;<span class="ident" id="4882786">params</span><span class="op" id="4882792">.</span><span class="ident" id="4882793">stringType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4882806">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4882809">case</span>&nbsp;<span class="ident" id="4882814">tagUTCTime</span><span class="op" id="4882824">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4882828">if</span>&nbsp;<span class="ident" id="4882831">outsideUTCRange</span><span class="op" id="4882846">(</span><span class="ident" id="4882847">v</span><span class="op" id="4882848">.</span><span class="ident" id="4882849">Interface</span><span class="op" id="4882858">(</span><span class="op" id="4882859">)</span><span class="op" id="4882860">.</span><span class="op" id="4882861">(</span><span class="ident" id="4882862">time</span><span class="op" id="4882866">.</span><span class="ident" id="4882867">Time</span><span class="op" id="4882871">)</span><span class="op" id="4882872">)</span>&nbsp;<span class="op" id="4882874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4882879">tag</span>&nbsp;<span class="op" id="4882883">=</span>&nbsp;<span class="ident" id="4882885">tagGeneralizedTime</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4882906">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4882909">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4882913">if</span>&nbsp;<span class="ident" id="4882916">params</span><span class="op" id="4882922">.</span><span class="ident" id="4882923">set</span>&nbsp;<span class="op" id="4882927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4882931">if</span>&nbsp;<span class="ident" id="4882934">tag</span>&nbsp;<span class="op" id="4882938">!=</span>&nbsp;<span class="ident" id="4882941">tagSequence</span>&nbsp;<span class="op" id="4882953">{</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4882958">return</span>&nbsp;<span class="ident" id="4882965">StructuralError</span><span class="op" id="4882980">{</span><span class="string" id="4882981">&#34;non&nbsp;sequence&nbsp;tagged&nbsp;as&nbsp;set&#34;</span><span class="op" id="4883009">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4883013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4883017">tag</span>&nbsp;<span class="op" id="4883021">=</span>&nbsp;<span class="ident" id="4883023">tagSet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4883031">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4883035">tags</span><span class="op" id="4883039">,</span>&nbsp;<span class="ident" id="4883041">body</span>&nbsp;<span class="op" id="4883046">:=</span>&nbsp;<span class="ident" id="4883049">out</span><span class="op" id="4883052">.</span><span class="ident" id="4883053">fork</span><span class="op" id="4883057">(</span><span class="op" id="4883058">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4883062">err</span>&nbsp;<span class="op" id="4883066">=</span>&nbsp;<span class="ident" id="4883068">marshalBody</span><span class="op" id="4883079">(</span><span class="ident" id="4883080">body</span><span class="op" id="4883084">,</span>&nbsp;<span class="ident" id="4883086">v</span><span class="op" id="4883087">,</span>&nbsp;<span class="ident" id="4883089">params</span><span class="op" id="4883095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4883098">if</span>&nbsp;<span class="ident" id="4883101">err</span>&nbsp;<span class="op" id="4883105">!=</span>&nbsp;<span class="ident" id="4883108">nil</span>&nbsp;<span class="op" id="4883112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4883116">return</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4883124">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4883128">bodyLen</span>&nbsp;<span class="op" id="4883136">:=</span>&nbsp;<span class="ident" id="4883139">body</span><span class="op" id="4883143">.</span><span class="ident" id="4883144">Len</span><span class="op" id="4883147">(</span><span class="op" id="4883148">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4883152">var</span>&nbsp;<span class="ident" id="4883156">explicitTag</span>&nbsp;<span class="op" id="4883168">*</span><span class="ident" id="4883169">forkableWriter</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4883185">if</span>&nbsp;<span class="ident" id="4883188">params</span><span class="op" id="4883194">.</span><span class="ident" id="4883195">explicit</span>&nbsp;<span class="op" id="4883204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4883208">explicitTag</span><span class="op" id="4883219">,</span>&nbsp;<span class="ident" id="4883221">tags</span>&nbsp;<span class="op" id="4883226">=</span>&nbsp;<span class="ident" id="4883228">tags</span><span class="op" id="4883232">.</span><span class="ident" id="4883233">fork</span><span class="op" id="4883237">(</span><span class="op" id="4883238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4883241">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4883245">if</span>&nbsp;<span class="op" id="4883248">!</span><span class="ident" id="4883249">params</span><span class="op" id="4883255">.</span><span class="ident" id="4883256">explicit</span>&nbsp;<span class="op" id="4883265">&amp;&amp;</span>&nbsp;<span class="ident" id="4883268">params</span><span class="op" id="4883274">.</span><span class="ident" id="4883275">tag</span>&nbsp;<span class="op" id="4883279">!=</span>&nbsp;<span class="ident" id="4883282">nil</span>&nbsp;<span class="op" id="4883286">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4883290">//&nbsp;implicit&nbsp;tag.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4883309">tag</span>&nbsp;<span class="op" id="4883313">=</span>&nbsp;<span class="op" id="4883315">*</span><span class="ident" id="4883316">params</span><span class="op" id="4883322">.</span><span class="ident" id="4883323">tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4883329">class</span>&nbsp;<span class="op" id="4883335">=</span>&nbsp;<span class="ident" id="4883337">classContextSpecific</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4883359">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4883363">err</span>&nbsp;<span class="op" id="4883367">=</span>&nbsp;<span class="ident" id="4883369">marshalTagAndLength</span><span class="op" id="4883388">(</span><span class="ident" id="4883389">tags</span><span class="op" id="4883393">,</span>&nbsp;<span class="ident" id="4883395">tagAndLength</span><span class="op" id="4883407">{</span><span class="ident" id="4883408">class</span><span class="op" id="4883413">,</span>&nbsp;<span class="ident" id="4883415">tag</span><span class="op" id="4883418">,</span>&nbsp;<span class="ident" id="4883420">bodyLen</span><span class="op" id="4883427">,</span>&nbsp;<span class="ident" id="4883429">isCompound</span><span class="op" id="4883439">}</span><span class="op" id="4883440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4883443">if</span>&nbsp;<span class="ident" id="4883446">err</span>&nbsp;<span class="op" id="4883450">!=</span>&nbsp;<span class="ident" id="4883453">nil</span>&nbsp;<span class="op" id="4883457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4883461">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4883469">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4883473">if</span>&nbsp;<span class="ident" id="4883476">params</span><span class="op" id="4883482">.</span><span class="ident" id="4883483">explicit</span>&nbsp;<span class="op" id="4883492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4883496">err</span>&nbsp;<span class="op" id="4883500">=</span>&nbsp;<span class="ident" id="4883502">marshalTagAndLength</span><span class="op" id="4883521">(</span><span class="ident" id="4883522">explicitTag</span><span class="op" id="4883533">,</span>&nbsp;<span class="ident" id="4883535">tagAndLength</span><span class="op" id="4883547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4883552">class</span><span class="op" id="4883557">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4883564">classContextSpecific</span><span class="op" id="4883584">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4883589">tag</span><span class="op" id="4883592">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4883601">*</span><span class="ident" id="4883602">params</span><span class="op" id="4883608">.</span><span class="ident" id="4883609">tag</span><span class="op" id="4883612">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4883617">length</span><span class="op" id="4883623">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4883629">bodyLen</span>&nbsp;<span class="op" id="4883637">+</span>&nbsp;<span class="ident" id="4883639">tags</span><span class="op" id="4883643">.</span><span class="ident" id="4883644">Len</span><span class="op" id="4883647">(</span><span class="op" id="4883648">)</span><span class="op" id="4883649">,</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4883654">isCompound</span><span class="op" id="4883664">:</span>&nbsp;<span class="builtintype" id="4883666">true</span><span class="op" id="4883670">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4883674">}</span><span class="op" id="4883675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4883678">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4883682">return</span>&nbsp;<span class="ident" id="4883689">nil</span><br>
<span class="lineno">625</span><span class="op" id="4883693">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4883696">//&nbsp;Marshal&nbsp;returns&nbsp;the&nbsp;ASN.1&nbsp;encoding&nbsp;of&nbsp;val.</span><br>
<span class="lineno"></span><span class="comment" id="4883742">//</span><br>
<span class="lineno"></span><span class="comment" id="4883745">//&nbsp;In&nbsp;addition&nbsp;to&nbsp;the&nbsp;struct&nbsp;tags&nbsp;recognised&nbsp;by&nbsp;Unmarshal,&nbsp;the&nbsp;following&nbsp;can&nbsp;be</span><br>
<span class="lineno">630</span><span class="comment" id="4883825">//&nbsp;used:</span><br>
<span class="lineno"></span><span class="comment" id="4883834">//</span><br>
<span class="lineno"></span><span class="comment" id="4883837">//&nbsp;&nbsp;&nbsp;&nbspia5:&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspcauses&nbsp;strings&nbsp;to&nbsp;be&nbsp;marshaled&nbsp;as&nbsp;ASN.1,&nbsp;IA5&nbsp;strings</span><br>
<span class="lineno"></span><span class="comment" id="4883899">//&nbsp;&nbsp;&nbsp;&nbspomitempty:&nbsp;&nbsp;&nbsp;&nbspcauses&nbsp;empty&nbsp;slices&nbsp;to&nbsp;be&nbsp;skipped</span><br>
<span class="lineno"></span><span class="comment" id="4883947">//&nbsp;&nbsp;&nbsp;&nbspprintable:&nbsp;&nbsp;&nbsp;&nbspcauses&nbsp;strings&nbsp;to&nbsp;be&nbsp;marshaled&nbsp;as&nbsp;ASN.1,&nbsp;PrintableString&nbsp;strings.</span><br>
<span class="lineno">635</span><span class="comment" id="4884027">//&nbsp;&nbsp;&nbsp;&nbsputf8:&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspcauses&nbsp;strings&nbsp;to&nbsp;be&nbsp;marshaled&nbsp;as&nbsp;ASN.1,&nbsp;UTF8&nbsp;strings</span><br>
<span class="lineno"></span><span class="keyword" id="4884091">func</span>&nbsp;<span class="ident" id="4884096">Marshal</span><span class="op" id="4884103">(</span><span class="ident" id="4884104">val</span>&nbsp;<span class="keyword" id="4884108">interface</span><span class="op" id="4884117">{</span><span class="op" id="4884118">}</span><span class="op" id="4884119">)</span>&nbsp;<span class="op" id="4884121">(</span><span class="op" id="4884122">[</span><span class="op" id="4884123">]</span><span class="builtintype" id="4884124">byte</span><span class="op" id="4884128">,</span>&nbsp;<span class="builtintype" id="4884130">error</span><span class="op" id="4884135">)</span>&nbsp;<span class="op" id="4884137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4884140">var</span>&nbsp;<span class="ident" id="4884144">out</span>&nbsp;<span class="ident" id="4884148">bytes</span><span class="op" id="4884153">.</span><span class="ident" id="4884154">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4884162">v</span>&nbsp;<span class="op" id="4884164">:=</span>&nbsp;<span class="ident" id="4884167">reflect</span><span class="op" id="4884174">.</span><span class="ident" id="4884175">ValueOf</span><span class="op" id="4884182">(</span><span class="ident" id="4884183">val</span><span class="op" id="4884186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4884189">f</span>&nbsp;<span class="op" id="4884191">:=</span>&nbsp;<span class="ident" id="4884194">newForkableWriter</span><span class="op" id="4884211">(</span><span class="op" id="4884212">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4884215">err</span>&nbsp;<span class="op" id="4884219">:=</span>&nbsp;<span class="ident" id="4884222">marshalField</span><span class="op" id="4884234">(</span><span class="ident" id="4884235">f</span><span class="op" id="4884236">,</span>&nbsp;<span class="ident" id="4884238">v</span><span class="op" id="4884239">,</span>&nbsp;<span class="ident" id="4884241">fieldParameters</span><span class="op" id="4884256">{</span><span class="op" id="4884257">}</span><span class="op" id="4884258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4884261">if</span>&nbsp;<span class="ident" id="4884264">err</span>&nbsp;<span class="op" id="4884268">!=</span>&nbsp;<span class="ident" id="4884271">nil</span>&nbsp;<span class="op" id="4884275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4884279">return</span>&nbsp;<span class="ident" id="4884286">nil</span><span class="op" id="4884289">,</span>&nbsp;<span class="ident" id="4884291">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4884296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4884299">_</span><span class="op" id="4884300">,</span>&nbsp;<span class="ident" id="4884302">err</span>&nbsp;<span class="op" id="4884306">=</span>&nbsp;<span class="ident" id="4884308">f</span><span class="op" id="4884309">.</span><span class="ident" id="4884310">writeTo</span><span class="op" id="4884317">(</span><span class="op" id="4884318">&amp;</span><span class="ident" id="4884319">out</span><span class="op" id="4884322">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4884325">return</span>&nbsp;<span class="ident" id="4884332">out</span><span class="op" id="4884335">.</span><span class="ident" id="4884336">Bytes</span><span class="op" id="4884341">(</span><span class="op" id="4884342">)</span><span class="op" id="4884343">,</span>&nbsp;<span class="ident" id="4884345">nil</span><br>
<span class="lineno"></span><span class="op" id="4884349">}</span>
</div>
</body>
</html>
