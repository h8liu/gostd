<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4197302">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4197357">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4197411">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4197462">//&nbsp;Package&nbsp;elliptic&nbsp;implements&nbsp;several&nbsp;standard&nbsp;elliptic&nbsp;curves&nbsp;over&nbsp;prime</span><br>
<span class="lineno"></span><span class="comment" id="4197537">//&nbsp;fields.</span><br>
<span class="lineno"></span><span class="keyword" id="4197548">package</span>&nbsp;<span class="ident" id="4197556">elliptic</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4197566">//&nbsp;This&nbsp;package&nbsp;operates,&nbsp;internally,&nbsp;on&nbsp;Jacobian&nbsp;coordinates.&nbsp;For&nbsp;a&nbsp;given</span><br>
<span class="lineno">10</span><span class="comment" id="4197641">//&nbsp;(x,&nbsp;y)&nbsp;position&nbsp;on&nbsp;the&nbsp;curve,&nbsp;the&nbsp;Jacobian&nbsp;coordinates&nbsp;are&nbsp;(x1,&nbsp;y1,&nbsp;z1)</span><br>
<span class="lineno"></span><span class="comment" id="4197716">//&nbsp;where&nbsp;x&nbsp;=&nbsp;x1/z1²&nbsp;and&nbsp;y&nbsp;=&nbsp;y1/z1³.&nbsp;The&nbsp;greatest&nbsp;speedups&nbsp;come&nbsp;when&nbsp;the&nbsp;whole</span><br>
<span class="lineno"></span><span class="comment" id="4197796">//&nbsp;calculation&nbsp;can&nbsp;be&nbsp;performed&nbsp;within&nbsp;the&nbsp;transform&nbsp;(as&nbsp;in&nbsp;ScalarMult&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4197871">//&nbsp;ScalarBaseMult).&nbsp;But&nbsp;even&nbsp;for&nbsp;Add&nbsp;and&nbsp;Double,&nbsp;it&#39;s&nbsp;faster&nbsp;to&nbsp;apply&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4197945">//&nbsp;reverse&nbsp;the&nbsp;transform&nbsp;than&nbsp;to&nbsp;operate&nbsp;in&nbsp;affine&nbsp;coordinates.</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="4198010">import</span>&nbsp;<span class="op" id="4198017">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4198020">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4198026">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4198038">&#34;sync&#34;</span><br>
<span class="lineno">20</span><span class="op" id="4198045">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4198048">//&nbsp;A&nbsp;Curve&nbsp;represents&nbsp;a&nbsp;short-form&nbsp;Weierstrass&nbsp;curve&nbsp;with&nbsp;a=-3.</span><br>
<span class="lineno"></span><span class="comment" id="4198112">//&nbsp;See&nbsp;http://www.hyperelliptic.org/EFD/g1p/auto-shortw.html</span><br>
<span class="lineno"></span><span class="keyword" id="4198173">type</span>&nbsp;<span class="ident" id="4198178">Curve</span>&nbsp;<span class="keyword" id="4198184">interface</span>&nbsp;<span class="op" id="4198194">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4198197">//&nbsp;Params&nbsp;returns&nbsp;the&nbsp;parameters&nbsp;for&nbsp;the&nbsp;curve.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4198246">Params</span><span class="op" id="4198252">(</span><span class="op" id="4198253">)</span>&nbsp;<span class="op" id="4198255">*</span><span class="ident" id="4198256"><a href="/crypto/elliptic/elliptic.go.html#4198953">CurveParams</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4198269">//&nbsp;IsOnCurve&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;given&nbsp;(x,y)&nbsp;lies&nbsp;on&nbsp;the&nbsp;curve.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4198334">IsOnCurve</span><span class="op" id="4198343">(</span><span class="ident" id="4198344">x</span><span class="op" id="4198345">,</span>&nbsp;<span class="ident" id="4198347">y</span>&nbsp;<span class="op" id="4198349">*</span><span class="ident" id="4198350"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4198353">.</span><span class="ident" id="4198354">Int</span><span class="op" id="4198357">)</span>&nbsp;<span class="builtintype" id="4198359">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4198365">//&nbsp;Add&nbsp;returns&nbsp;the&nbsp;sum&nbsp;of&nbsp;(x1,y1)&nbsp;and&nbsp;(x2,y2)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4198412">Add</span><span class="op" id="4198415">(</span><span class="ident" id="4198416">x1</span><span class="op" id="4198418">,</span>&nbsp;<span class="ident" id="4198420">y1</span><span class="op" id="4198422">,</span>&nbsp;<span class="ident" id="4198424">x2</span><span class="op" id="4198426">,</span>&nbsp;<span class="ident" id="4198428">y2</span>&nbsp;<span class="op" id="4198431">*</span><span class="ident" id="4198432"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4198435">.</span><span class="ident" id="4198436">Int</span><span class="op" id="4198439">)</span>&nbsp;<span class="op" id="4198441">(</span><span class="ident" id="4198442">x</span><span class="op" id="4198443">,</span>&nbsp;<span class="ident" id="4198445">y</span>&nbsp;<span class="op" id="4198447">*</span><span class="ident" id="4198448"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4198451">.</span><span class="ident" id="4198452">Int</span><span class="op" id="4198455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4198458">//&nbsp;Double&nbsp;returns&nbsp;2*(x,y)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4198485">Double</span><span class="op" id="4198491">(</span><span class="ident" id="4198492">x1</span><span class="op" id="4198494">,</span>&nbsp;<span class="ident" id="4198496">y1</span>&nbsp;<span class="op" id="4198499">*</span><span class="ident" id="4198500"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4198503">.</span><span class="ident" id="4198504">Int</span><span class="op" id="4198507">)</span>&nbsp;<span class="op" id="4198509">(</span><span class="ident" id="4198510">x</span><span class="op" id="4198511">,</span>&nbsp;<span class="ident" id="4198513">y</span>&nbsp;<span class="op" id="4198515">*</span><span class="ident" id="4198516"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4198519">.</span><span class="ident" id="4198520">Int</span><span class="op" id="4198523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4198526">//&nbsp;ScalarMult&nbsp;returns&nbsp;k*(Bx,By)&nbsp;where&nbsp;k&nbsp;is&nbsp;a&nbsp;number&nbsp;in&nbsp;big-endian&nbsp;form.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4198599">ScalarMult</span><span class="op" id="4198609">(</span><span class="ident" id="4198610">x1</span><span class="op" id="4198612">,</span>&nbsp;<span class="ident" id="4198614">y1</span>&nbsp;<span class="op" id="4198617">*</span><span class="ident" id="4198618"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4198621">.</span><span class="ident" id="4198622">Int</span><span class="op" id="4198625">,</span>&nbsp;<span class="ident" id="4198627">k</span>&nbsp;<span class="op" id="4198629">[</span><span class="op" id="4198630">]</span><span class="builtintype" id="4198631">byte</span><span class="op" id="4198635">)</span>&nbsp;<span class="op" id="4198637">(</span><span class="ident" id="4198638">x</span><span class="op" id="4198639">,</span>&nbsp;<span class="ident" id="4198641">y</span>&nbsp;<span class="op" id="4198643">*</span><span class="ident" id="4198644"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4198647">.</span><span class="ident" id="4198648">Int</span><span class="op" id="4198651">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4198654">//&nbsp;ScalarBaseMult&nbsp;returns&nbsp;k*G,&nbsp;where&nbsp;G&nbsp;is&nbsp;the&nbsp;base&nbsp;point&nbsp;of&nbsp;the&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4198725">//&nbsp;and&nbsp;k&nbsp;is&nbsp;an&nbsp;integer&nbsp;in&nbsp;big-endian&nbsp;form.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4198769">ScalarBaseMult</span><span class="op" id="4198783">(</span><span class="ident" id="4198784">k</span>&nbsp;<span class="op" id="4198786">[</span><span class="op" id="4198787">]</span><span class="builtintype" id="4198788">byte</span><span class="op" id="4198792">)</span>&nbsp;<span class="op" id="4198794">(</span><span class="ident" id="4198795">x</span><span class="op" id="4198796">,</span>&nbsp;<span class="ident" id="4198798">y</span>&nbsp;<span class="op" id="4198800">*</span><span class="ident" id="4198801"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4198804">.</span><span class="ident" id="4198805">Int</span><span class="op" id="4198808">)</span><br>
<span class="lineno"></span><span class="op" id="4198810">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="4198813">//&nbsp;CurveParams&nbsp;contains&nbsp;the&nbsp;parameters&nbsp;of&nbsp;an&nbsp;elliptic&nbsp;curve&nbsp;and&nbsp;also&nbsp;provides</span><br>
<span class="lineno"></span><span class="comment" id="4198891">//&nbsp;a&nbsp;generic,&nbsp;non-constant&nbsp;time&nbsp;implementation&nbsp;of&nbsp;Curve.</span><br>
<span class="lineno"></span><span class="keyword" id="4198948">type</span>&nbsp;<span class="ident" id="4198953">CurveParams</span>&nbsp;<span class="keyword" id="4198965">struct</span>&nbsp;<span class="op" id="4198972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4198975">P</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4198983">*</span><span class="ident" id="4198984"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4198987">.</span><span class="ident" id="4198988">Int</span>&nbsp;<span class="comment" id="4198992">//&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;underlying&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4199030">N</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4199038">*</span><span class="ident" id="4199039"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4199042">.</span><span class="ident" id="4199043">Int</span>&nbsp;<span class="comment" id="4199047">//&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;base&nbsp;point</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4199079">B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4199087">*</span><span class="ident" id="4199088"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4199091">.</span><span class="ident" id="4199092">Int</span>&nbsp;<span class="comment" id="4199096">//&nbsp;the&nbsp;constant&nbsp;of&nbsp;the&nbsp;curve&nbsp;equation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4199135">Gx</span><span class="op" id="4199137">,</span>&nbsp;<span class="ident" id="4199139">Gy</span>&nbsp;&nbsp;<span class="op" id="4199143">*</span><span class="ident" id="4199144"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4199147">.</span><span class="ident" id="4199148">Int</span>&nbsp;<span class="comment" id="4199152">//&nbsp;(x,y)&nbsp;of&nbsp;the&nbsp;base&nbsp;point</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4199180">BitSize</span>&nbsp;<span class="builtintype" id="4199188">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4199197">//&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;underlying&nbsp;field</span><br>
<span class="lineno"></span><span class="op" id="4199233">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="keyword" id="4199236">func</span>&nbsp;<span class="op" id="4199241">(</span><span class="ident" id="4199242">curve</span>&nbsp;<span class="op" id="4199248">*</span><span class="ident" id="4199249"><a href="/crypto/elliptic/elliptic.go.html#4198953">CurveParams</a></span><span class="op" id="4199260">)</span>&nbsp;<span class="ident" id="4199262">Params</span><span class="op" id="4199268">(</span><span class="op" id="4199269">)</span>&nbsp;<span class="op" id="4199271">*</span><span class="ident" id="4199272"><a href="/crypto/elliptic/elliptic.go.html#4198953">CurveParams</a></span>&nbsp;<span class="op" id="4199284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4199287">return</span>&nbsp;<span class="ident" id="4199294"><a href="/crypto/elliptic/elliptic.go.html#4199242">curve</a></span><br>
<span class="lineno"></span><span class="op" id="4199300">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4199303">func</span>&nbsp;<span class="op" id="4199308">(</span><span class="ident" id="4199309">curve</span>&nbsp;<span class="op" id="4199315">*</span><span class="ident" id="4199316"><a href="/crypto/elliptic/elliptic.go.html#4198953">CurveParams</a></span><span class="op" id="4199327">)</span>&nbsp;<span class="ident" id="4199329">IsOnCurve</span><span class="op" id="4199338">(</span><span class="ident" id="4199339">x</span><span class="op" id="4199340">,</span>&nbsp;<span class="ident" id="4199342">y</span>&nbsp;<span class="op" id="4199344">*</span><span class="ident" id="4199345"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4199348">.</span><span class="ident" id="4199349">Int</span><span class="op" id="4199352">)</span>&nbsp;<span class="builtintype" id="4199354">bool</span>&nbsp;<span class="op" id="4199359">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4199362">//&nbsp;y²&nbsp;=&nbsp;x³&nbsp;-&nbsp;3x&nbsp;+&nbsp;b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4199385">y2</span>&nbsp;<span class="op" id="4199388">:=</span>&nbsp;<span class="builtinfunc" id="4199391">new</span><span class="op" id="4199394">(</span><span class="ident" id="4199395"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4199398">.</span><span class="ident" id="4199399">Int</span><span class="op" id="4199402">)</span><span class="op" id="4199403">.</span><span class="ident" id="4199404">Mul</span><span class="op" id="4199407">(</span><span class="ident" id="4199408"><a href="/crypto/elliptic/elliptic.go.html#4199342">y</a></span><span class="op" id="4199409">,</span>&nbsp;<span class="ident" id="4199411"><a href="/crypto/elliptic/elliptic.go.html#4199342">y</a></span><span class="op" id="4199412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4199415"><a href="/crypto/elliptic/elliptic.go.html#4199385">y2</a></span><span class="op" id="4199417">.</span><span class="ident" id="4199418">Mod</span><span class="op" id="4199421">(</span><span class="ident" id="4199422"><a href="/crypto/elliptic/elliptic.go.html#4199385">y2</a></span><span class="op" id="4199424">,</span>&nbsp;<span class="ident" id="4199426"><a href="/crypto/elliptic/elliptic.go.html#4199309">curve</a></span><span class="op" id="4199431">.</span><span class="ident" id="4199432">P</span><span class="op" id="4199433">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4199437">x3</span>&nbsp;<span class="op" id="4199440">:=</span>&nbsp;<span class="builtinfunc" id="4199443">new</span><span class="op" id="4199446">(</span><span class="ident" id="4199447"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4199450">.</span><span class="ident" id="4199451">Int</span><span class="op" id="4199454">)</span><span class="op" id="4199455">.</span><span class="ident" id="4199456">Mul</span><span class="op" id="4199459">(</span><span class="ident" id="4199460"><a href="/crypto/elliptic/elliptic.go.html#4199339">x</a></span><span class="op" id="4199461">,</span>&nbsp;<span class="ident" id="4199463"><a href="/crypto/elliptic/elliptic.go.html#4199339">x</a></span><span class="op" id="4199464">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4199467"><a href="/crypto/elliptic/elliptic.go.html#4199437">x3</a></span><span class="op" id="4199469">.</span><span class="ident" id="4199470">Mul</span><span class="op" id="4199473">(</span><span class="ident" id="4199474"><a href="/crypto/elliptic/elliptic.go.html#4199437">x3</a></span><span class="op" id="4199476">,</span>&nbsp;<span class="ident" id="4199478"><a href="/crypto/elliptic/elliptic.go.html#4199339">x</a></span><span class="op" id="4199479">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4199483">threeX</span>&nbsp;<span class="op" id="4199490">:=</span>&nbsp;<span class="builtinfunc" id="4199493">new</span><span class="op" id="4199496">(</span><span class="ident" id="4199497"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4199500">.</span><span class="ident" id="4199501">Int</span><span class="op" id="4199504">)</span><span class="op" id="4199505">.</span><span class="ident" id="4199506">Lsh</span><span class="op" id="4199509">(</span><span class="ident" id="4199510"><a href="/crypto/elliptic/elliptic.go.html#4199339">x</a></span><span class="op" id="4199511">,</span>&nbsp;<span class="num" id="4199513">1</span><span class="op" id="4199514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4199517"><a href="/crypto/elliptic/elliptic.go.html#4199483">threeX</a></span><span class="op" id="4199523">.</span><span class="ident" id="4199524">Add</span><span class="op" id="4199527">(</span><span class="ident" id="4199528"><a href="/crypto/elliptic/elliptic.go.html#4199483">threeX</a></span><span class="op" id="4199534">,</span>&nbsp;<span class="ident" id="4199536"><a href="/crypto/elliptic/elliptic.go.html#4199339">x</a></span><span class="op" id="4199537">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4199541"><a href="/crypto/elliptic/elliptic.go.html#4199437">x3</a></span><span class="op" id="4199543">.</span><span class="ident" id="4199544">Sub</span><span class="op" id="4199547">(</span><span class="ident" id="4199548"><a href="/crypto/elliptic/elliptic.go.html#4199437">x3</a></span><span class="op" id="4199550">,</span>&nbsp;<span class="ident" id="4199552"><a href="/crypto/elliptic/elliptic.go.html#4199483">threeX</a></span><span class="op" id="4199558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4199561"><a href="/crypto/elliptic/elliptic.go.html#4199437">x3</a></span><span class="op" id="4199563">.</span><span class="ident" id="4199564">Add</span><span class="op" id="4199567">(</span><span class="ident" id="4199568"><a href="/crypto/elliptic/elliptic.go.html#4199437">x3</a></span><span class="op" id="4199570">,</span>&nbsp;<span class="ident" id="4199572"><a href="/crypto/elliptic/elliptic.go.html#4199309">curve</a></span><span class="op" id="4199577">.</span><span class="ident" id="4199578">B</span><span class="op" id="4199579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4199582"><a href="/crypto/elliptic/elliptic.go.html#4199437">x3</a></span><span class="op" id="4199584">.</span><span class="ident" id="4199585">Mod</span><span class="op" id="4199588">(</span><span class="ident" id="4199589"><a href="/crypto/elliptic/elliptic.go.html#4199437">x3</a></span><span class="op" id="4199591">,</span>&nbsp;<span class="ident" id="4199593"><a href="/crypto/elliptic/elliptic.go.html#4199309">curve</a></span><span class="op" id="4199598">.</span><span class="ident" id="4199599">P</span><span class="op" id="4199600">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4199604">return</span>&nbsp;<span class="ident" id="4199611"><a href="/crypto/elliptic/elliptic.go.html#4199437">x3</a></span><span class="op" id="4199613">.</span><span class="ident" id="4199614">Cmp</span><span class="op" id="4199617">(</span><span class="ident" id="4199618"><a href="/crypto/elliptic/elliptic.go.html#4199385">y2</a></span><span class="op" id="4199620">)</span>&nbsp;<span class="op" id="4199622">==</span>&nbsp;<span class="num" id="4199625">0</span><br>
<span class="lineno">70</span><span class="op" id="4199627">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4199630">//&nbsp;zForAffine&nbsp;returns&nbsp;a&nbsp;Jacobian&nbsp;Z&nbsp;value&nbsp;for&nbsp;the&nbsp;affine&nbsp;point&nbsp;(x,&nbsp;y).&nbsp;If&nbsp;x&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4199709">//&nbsp;y&nbsp;are&nbsp;zero,&nbsp;it&nbsp;assumes&nbsp;that&nbsp;they&nbsp;represent&nbsp;the&nbsp;point&nbsp;at&nbsp;infinity&nbsp;because&nbsp;(0,</span><br>
<span class="lineno"></span><span class="comment" id="4199789">//&nbsp;0)&nbsp;is&nbsp;not&nbsp;on&nbsp;the&nbsp;any&nbsp;of&nbsp;the&nbsp;curves&nbsp;handled&nbsp;here.</span><br>
<span class="lineno">75</span><span class="keyword" id="4199841">func</span>&nbsp;<span class="ident" id="4199846">zForAffine</span><span class="op" id="4199856">(</span><span class="ident" id="4199857">x</span><span class="op" id="4199858">,</span>&nbsp;<span class="ident" id="4199860">y</span>&nbsp;<span class="op" id="4199862">*</span><span class="ident" id="4199863"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4199866">.</span><span class="ident" id="4199867">Int</span><span class="op" id="4199870">)</span>&nbsp;<span class="op" id="4199872">*</span><span class="ident" id="4199873"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4199876">.</span><span class="ident" id="4199877">Int</span>&nbsp;<span class="op" id="4199881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4199884">z</span>&nbsp;<span class="op" id="4199886">:=</span>&nbsp;<span class="builtinfunc" id="4199889">new</span><span class="op" id="4199892">(</span><span class="ident" id="4199893"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4199896">.</span><span class="ident" id="4199897">Int</span><span class="op" id="4199900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4199903">if</span>&nbsp;<span class="ident" id="4199906"><a href="/crypto/elliptic/elliptic.go.html#4199857">x</a></span><span class="op" id="4199907">.</span><span class="ident" id="4199908">Sign</span><span class="op" id="4199912">(</span><span class="op" id="4199913">)</span>&nbsp;<span class="op" id="4199915">!=</span>&nbsp;<span class="num" id="4199918">0</span>&nbsp;<span class="op" id="4199920">||</span>&nbsp;<span class="ident" id="4199923"><a href="/crypto/elliptic/elliptic.go.html#4199860">y</a></span><span class="op" id="4199924">.</span><span class="ident" id="4199925">Sign</span><span class="op" id="4199929">(</span><span class="op" id="4199930">)</span>&nbsp;<span class="op" id="4199932">!=</span>&nbsp;<span class="num" id="4199935">0</span>&nbsp;<span class="op" id="4199937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4199941"><a href="/crypto/elliptic/elliptic.go.html#4199884">z</a></span><span class="op" id="4199942">.</span><span class="ident" id="4199943">SetInt64</span><span class="op" id="4199951">(</span><span class="num" id="4199952">1</span><span class="op" id="4199953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4199956">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4199959">return</span>&nbsp;<span class="ident" id="4199966"><a href="/crypto/elliptic/elliptic.go.html#4199884">z</a></span><br>
<span class="lineno"></span><span class="op" id="4199968">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4199971">//&nbsp;affineFromJacobian&nbsp;reverses&nbsp;the&nbsp;Jacobian&nbsp;transform.&nbsp;See&nbsp;the&nbsp;comment&nbsp;at&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4200049">//&nbsp;top&nbsp;of&nbsp;the&nbsp;file.&nbsp;If&nbsp;the&nbsp;point&nbsp;is&nbsp;∞&nbsp;it&nbsp;returns&nbsp;0,&nbsp;0.</span><br>
<span class="lineno">85</span><span class="keyword" id="4200106">func</span>&nbsp;<span class="op" id="4200111">(</span><span class="ident" id="4200112">curve</span>&nbsp;<span class="op" id="4200118">*</span><span class="ident" id="4200119"><a href="/crypto/elliptic/elliptic.go.html#4198953">CurveParams</a></span><span class="op" id="4200130">)</span>&nbsp;<span class="ident" id="4200132">affineFromJacobian</span><span class="op" id="4200150">(</span><span class="ident" id="4200151">x</span><span class="op" id="4200152">,</span>&nbsp;<span class="ident" id="4200154">y</span><span class="op" id="4200155">,</span>&nbsp;<span class="ident" id="4200157">z</span>&nbsp;<span class="op" id="4200159">*</span><span class="ident" id="4200160"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4200163">.</span><span class="ident" id="4200164">Int</span><span class="op" id="4200167">)</span>&nbsp;<span class="op" id="4200169">(</span><span class="ident" id="4200170">xOut</span><span class="op" id="4200174">,</span>&nbsp;<span class="ident" id="4200176">yOut</span>&nbsp;<span class="op" id="4200181">*</span><span class="ident" id="4200182"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4200185">.</span><span class="ident" id="4200186">Int</span><span class="op" id="4200189">)</span>&nbsp;<span class="op" id="4200191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4200194">if</span>&nbsp;<span class="ident" id="4200197"><a href="/crypto/elliptic/elliptic.go.html#4200157">z</a></span><span class="op" id="4200198">.</span><span class="ident" id="4200199">Sign</span><span class="op" id="4200203">(</span><span class="op" id="4200204">)</span>&nbsp;<span class="op" id="4200206">==</span>&nbsp;<span class="num" id="4200209">0</span>&nbsp;<span class="op" id="4200211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4200215">return</span>&nbsp;<span class="builtinfunc" id="4200222">new</span><span class="op" id="4200225">(</span><span class="ident" id="4200226"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4200229">.</span><span class="ident" id="4200230">Int</span><span class="op" id="4200233">)</span><span class="op" id="4200234">,</span>&nbsp;<span class="builtinfunc" id="4200236">new</span><span class="op" id="4200239">(</span><span class="ident" id="4200240"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4200243">.</span><span class="ident" id="4200244">Int</span><span class="op" id="4200247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4200250">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4200254">zinv</span>&nbsp;<span class="op" id="4200259">:=</span>&nbsp;<span class="builtinfunc" id="4200262">new</span><span class="op" id="4200265">(</span><span class="ident" id="4200266"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4200269">.</span><span class="ident" id="4200270">Int</span><span class="op" id="4200273">)</span><span class="op" id="4200274">.</span><span class="ident" id="4200275">ModInverse</span><span class="op" id="4200285">(</span><span class="ident" id="4200286"><a href="/crypto/elliptic/elliptic.go.html#4200157">z</a></span><span class="op" id="4200287">,</span>&nbsp;<span class="ident" id="4200289"><a href="/crypto/elliptic/elliptic.go.html#4200112">curve</a></span><span class="op" id="4200294">.</span><span class="ident" id="4200295">P</span><span class="op" id="4200296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4200299">zinvsq</span>&nbsp;<span class="op" id="4200306">:=</span>&nbsp;<span class="builtinfunc" id="4200309">new</span><span class="op" id="4200312">(</span><span class="ident" id="4200313"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4200316">.</span><span class="ident" id="4200317">Int</span><span class="op" id="4200320">)</span><span class="op" id="4200321">.</span><span class="ident" id="4200322">Mul</span><span class="op" id="4200325">(</span><span class="ident" id="4200326"><a href="/crypto/elliptic/elliptic.go.html#4200254">zinv</a></span><span class="op" id="4200330">,</span>&nbsp;<span class="ident" id="4200332"><a href="/crypto/elliptic/elliptic.go.html#4200254">zinv</a></span><span class="op" id="4200336">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4200340"><a href="/crypto/elliptic/elliptic.go.html#4200170">xOut</a></span>&nbsp;<span class="op" id="4200345">=</span>&nbsp;<span class="builtinfunc" id="4200347">new</span><span class="op" id="4200350">(</span><span class="ident" id="4200351"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4200354">.</span><span class="ident" id="4200355">Int</span><span class="op" id="4200358">)</span><span class="op" id="4200359">.</span><span class="ident" id="4200360">Mul</span><span class="op" id="4200363">(</span><span class="ident" id="4200364"><a href="/crypto/elliptic/elliptic.go.html#4200151">x</a></span><span class="op" id="4200365">,</span>&nbsp;<span class="ident" id="4200367"><a href="/crypto/elliptic/elliptic.go.html#4200299">zinvsq</a></span><span class="op" id="4200373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4200376"><a href="/crypto/elliptic/elliptic.go.html#4200170">xOut</a></span><span class="op" id="4200380">.</span><span class="ident" id="4200381">Mod</span><span class="op" id="4200384">(</span><span class="ident" id="4200385"><a href="/crypto/elliptic/elliptic.go.html#4200170">xOut</a></span><span class="op" id="4200389">,</span>&nbsp;<span class="ident" id="4200391"><a href="/crypto/elliptic/elliptic.go.html#4200112">curve</a></span><span class="op" id="4200396">.</span><span class="ident" id="4200397">P</span><span class="op" id="4200398">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4200401"><a href="/crypto/elliptic/elliptic.go.html#4200299">zinvsq</a></span><span class="op" id="4200407">.</span><span class="ident" id="4200408">Mul</span><span class="op" id="4200411">(</span><span class="ident" id="4200412"><a href="/crypto/elliptic/elliptic.go.html#4200299">zinvsq</a></span><span class="op" id="4200418">,</span>&nbsp;<span class="ident" id="4200420"><a href="/crypto/elliptic/elliptic.go.html#4200254">zinv</a></span><span class="op" id="4200424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4200427"><a href="/crypto/elliptic/elliptic.go.html#4200176">yOut</a></span>&nbsp;<span class="op" id="4200432">=</span>&nbsp;<span class="builtinfunc" id="4200434">new</span><span class="op" id="4200437">(</span><span class="ident" id="4200438"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4200441">.</span><span class="ident" id="4200442">Int</span><span class="op" id="4200445">)</span><span class="op" id="4200446">.</span><span class="ident" id="4200447">Mul</span><span class="op" id="4200450">(</span><span class="ident" id="4200451"><a href="/crypto/elliptic/elliptic.go.html#4200154">y</a></span><span class="op" id="4200452">,</span>&nbsp;<span class="ident" id="4200454"><a href="/crypto/elliptic/elliptic.go.html#4200299">zinvsq</a></span><span class="op" id="4200460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4200463"><a href="/crypto/elliptic/elliptic.go.html#4200176">yOut</a></span><span class="op" id="4200467">.</span><span class="ident" id="4200468">Mod</span><span class="op" id="4200471">(</span><span class="ident" id="4200472"><a href="/crypto/elliptic/elliptic.go.html#4200176">yOut</a></span><span class="op" id="4200476">,</span>&nbsp;<span class="ident" id="4200478"><a href="/crypto/elliptic/elliptic.go.html#4200112">curve</a></span><span class="op" id="4200483">.</span><span class="ident" id="4200484">P</span><span class="op" id="4200485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4200488">return</span><br>
<span class="lineno"></span><span class="op" id="4200495">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="keyword" id="4200498">func</span>&nbsp;<span class="op" id="4200503">(</span><span class="ident" id="4200504">curve</span>&nbsp;<span class="op" id="4200510">*</span><span class="ident" id="4200511"><a href="/crypto/elliptic/elliptic.go.html#4198953">CurveParams</a></span><span class="op" id="4200522">)</span>&nbsp;<span class="ident" id="4200524">Add</span><span class="op" id="4200527">(</span><span class="ident" id="4200528">x1</span><span class="op" id="4200530">,</span>&nbsp;<span class="ident" id="4200532">y1</span><span class="op" id="4200534">,</span>&nbsp;<span class="ident" id="4200536">x2</span><span class="op" id="4200538">,</span>&nbsp;<span class="ident" id="4200540">y2</span>&nbsp;<span class="op" id="4200543">*</span><span class="ident" id="4200544"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4200547">.</span><span class="ident" id="4200548">Int</span><span class="op" id="4200551">)</span>&nbsp;<span class="op" id="4200553">(</span><span class="op" id="4200554">*</span><span class="ident" id="4200555"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4200558">.</span><span class="ident" id="4200559">Int</span><span class="op" id="4200562">,</span>&nbsp;<span class="op" id="4200564">*</span><span class="ident" id="4200565"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4200568">.</span><span class="ident" id="4200569">Int</span><span class="op" id="4200572">)</span>&nbsp;<span class="op" id="4200574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4200577">z1</span>&nbsp;<span class="op" id="4200580">:=</span>&nbsp;<span class="ident" id="4200583"><a href="/crypto/elliptic/elliptic.go.html#4199846">zForAffine</a></span><span class="op" id="4200593">(</span><span class="ident" id="4200594"><a href="/crypto/elliptic/elliptic.go.html#4200528">x1</a></span><span class="op" id="4200596">,</span>&nbsp;<span class="ident" id="4200598"><a href="/crypto/elliptic/elliptic.go.html#4200532">y1</a></span><span class="op" id="4200600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4200603">z2</span>&nbsp;<span class="op" id="4200606">:=</span>&nbsp;<span class="ident" id="4200609"><a href="/crypto/elliptic/elliptic.go.html#4199846">zForAffine</a></span><span class="op" id="4200619">(</span><span class="ident" id="4200620"><a href="/crypto/elliptic/elliptic.go.html#4200536">x2</a></span><span class="op" id="4200622">,</span>&nbsp;<span class="ident" id="4200624"><a href="/crypto/elliptic/elliptic.go.html#4200540">y2</a></span><span class="op" id="4200626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4200629">return</span>&nbsp;<span class="ident" id="4200636"><a href="/crypto/elliptic/elliptic.go.html#4200504">curve</a></span><span class="op" id="4200641">.</span><span class="ident" id="4200642">affineFromJacobian</span><span class="op" id="4200660">(</span><span class="ident" id="4200661"><a href="/crypto/elliptic/elliptic.go.html#4200504">curve</a></span><span class="op" id="4200666">.</span><span class="ident" id="4200667">addJacobian</span><span class="op" id="4200678">(</span><span class="ident" id="4200679"><a href="/crypto/elliptic/elliptic.go.html#4200528">x1</a></span><span class="op" id="4200681">,</span>&nbsp;<span class="ident" id="4200683"><a href="/crypto/elliptic/elliptic.go.html#4200532">y1</a></span><span class="op" id="4200685">,</span>&nbsp;<span class="ident" id="4200687"><a href="/crypto/elliptic/elliptic.go.html#4200577">z1</a></span><span class="op" id="4200689">,</span>&nbsp;<span class="ident" id="4200691"><a href="/crypto/elliptic/elliptic.go.html#4200536">x2</a></span><span class="op" id="4200693">,</span>&nbsp;<span class="ident" id="4200695"><a href="/crypto/elliptic/elliptic.go.html#4200540">y2</a></span><span class="op" id="4200697">,</span>&nbsp;<span class="ident" id="4200699"><a href="/crypto/elliptic/elliptic.go.html#4200603">z2</a></span><span class="op" id="4200701">)</span><span class="op" id="4200702">)</span><br>
<span class="lineno">105</span><span class="op" id="4200704">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4200707">//&nbsp;addJacobian&nbsp;takes&nbsp;two&nbsp;points&nbsp;in&nbsp;Jacobian&nbsp;coordinates,&nbsp;(x1,&nbsp;y1,&nbsp;z1)&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4200781">//&nbsp;(x2,&nbsp;y2,&nbsp;z2)&nbsp;and&nbsp;returns&nbsp;their&nbsp;sum,&nbsp;also&nbsp;in&nbsp;Jacobian&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="4200843">func</span>&nbsp;<span class="op" id="4200848">(</span><span class="ident" id="4200849">curve</span>&nbsp;<span class="op" id="4200855">*</span><span class="ident" id="4200856"><a href="/crypto/elliptic/elliptic.go.html#4198953">CurveParams</a></span><span class="op" id="4200867">)</span>&nbsp;<span class="ident" id="4200869">addJacobian</span><span class="op" id="4200880">(</span><span class="ident" id="4200881">x1</span><span class="op" id="4200883">,</span>&nbsp;<span class="ident" id="4200885">y1</span><span class="op" id="4200887">,</span>&nbsp;<span class="ident" id="4200889">z1</span><span class="op" id="4200891">,</span>&nbsp;<span class="ident" id="4200893">x2</span><span class="op" id="4200895">,</span>&nbsp;<span class="ident" id="4200897">y2</span><span class="op" id="4200899">,</span>&nbsp;<span class="ident" id="4200901">z2</span>&nbsp;<span class="op" id="4200904">*</span><span class="ident" id="4200905"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4200908">.</span><span class="ident" id="4200909">Int</span><span class="op" id="4200912">)</span>&nbsp;<span class="op" id="4200914">(</span><span class="op" id="4200915">*</span><span class="ident" id="4200916"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4200919">.</span><span class="ident" id="4200920">Int</span><span class="op" id="4200923">,</span>&nbsp;<span class="op" id="4200925">*</span><span class="ident" id="4200926"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4200929">.</span><span class="ident" id="4200930">Int</span><span class="op" id="4200933">,</span>&nbsp;<span class="op" id="4200935">*</span><span class="ident" id="4200936"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4200939">.</span><span class="ident" id="4200940">Int</span><span class="op" id="4200943">)</span>&nbsp;<span class="op" id="4200945">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4200948">//&nbsp;See&nbsp;http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-3.html#addition-add-2007-bl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201038">x3</span><span class="op" id="4201040">,</span>&nbsp;<span class="ident" id="4201042">y3</span><span class="op" id="4201044">,</span>&nbsp;<span class="ident" id="4201046">z3</span>&nbsp;<span class="op" id="4201049">:=</span>&nbsp;<span class="builtinfunc" id="4201052">new</span><span class="op" id="4201055">(</span><span class="ident" id="4201056"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4201059">.</span><span class="ident" id="4201060">Int</span><span class="op" id="4201063">)</span><span class="op" id="4201064">,</span>&nbsp;<span class="builtinfunc" id="4201066">new</span><span class="op" id="4201069">(</span><span class="ident" id="4201070"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4201073">.</span><span class="ident" id="4201074">Int</span><span class="op" id="4201077">)</span><span class="op" id="4201078">,</span>&nbsp;<span class="builtinfunc" id="4201080">new</span><span class="op" id="4201083">(</span><span class="ident" id="4201084"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4201087">.</span><span class="ident" id="4201088">Int</span><span class="op" id="4201091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4201094">if</span>&nbsp;<span class="ident" id="4201097"><a href="/crypto/elliptic/elliptic.go.html#4200889">z1</a></span><span class="op" id="4201099">.</span><span class="ident" id="4201100">Sign</span><span class="op" id="4201104">(</span><span class="op" id="4201105">)</span>&nbsp;<span class="op" id="4201107">==</span>&nbsp;<span class="num" id="4201110">0</span>&nbsp;<span class="op" id="4201112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201116"><a href="/crypto/elliptic/elliptic.go.html#4201038">x3</a></span><span class="op" id="4201118">.</span><span class="ident" id="4201119">Set</span><span class="op" id="4201122">(</span><span class="ident" id="4201123"><a href="/crypto/elliptic/elliptic.go.html#4200893">x2</a></span><span class="op" id="4201125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201129"><a href="/crypto/elliptic/elliptic.go.html#4201042">y3</a></span><span class="op" id="4201131">.</span><span class="ident" id="4201132">Set</span><span class="op" id="4201135">(</span><span class="ident" id="4201136"><a href="/crypto/elliptic/elliptic.go.html#4200897">y2</a></span><span class="op" id="4201138">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201142"><a href="/crypto/elliptic/elliptic.go.html#4201046">z3</a></span><span class="op" id="4201144">.</span><span class="ident" id="4201145">Set</span><span class="op" id="4201148">(</span><span class="ident" id="4201149"><a href="/crypto/elliptic/elliptic.go.html#4200901">z2</a></span><span class="op" id="4201151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4201155">return</span>&nbsp;<span class="ident" id="4201162"><a href="/crypto/elliptic/elliptic.go.html#4201038">x3</a></span><span class="op" id="4201164">,</span>&nbsp;<span class="ident" id="4201166"><a href="/crypto/elliptic/elliptic.go.html#4201042">y3</a></span><span class="op" id="4201168">,</span>&nbsp;<span class="ident" id="4201170"><a href="/crypto/elliptic/elliptic.go.html#4201046">z3</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4201174">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4201177">if</span>&nbsp;<span class="ident" id="4201180"><a href="/crypto/elliptic/elliptic.go.html#4200901">z2</a></span><span class="op" id="4201182">.</span><span class="ident" id="4201183">Sign</span><span class="op" id="4201187">(</span><span class="op" id="4201188">)</span>&nbsp;<span class="op" id="4201190">==</span>&nbsp;<span class="num" id="4201193">0</span>&nbsp;<span class="op" id="4201195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201199"><a href="/crypto/elliptic/elliptic.go.html#4201038">x3</a></span><span class="op" id="4201201">.</span><span class="ident" id="4201202">Set</span><span class="op" id="4201205">(</span><span class="ident" id="4201206"><a href="/crypto/elliptic/elliptic.go.html#4200881">x1</a></span><span class="op" id="4201208">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201212"><a href="/crypto/elliptic/elliptic.go.html#4201042">y3</a></span><span class="op" id="4201214">.</span><span class="ident" id="4201215">Set</span><span class="op" id="4201218">(</span><span class="ident" id="4201219"><a href="/crypto/elliptic/elliptic.go.html#4200885">y1</a></span><span class="op" id="4201221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201225"><a href="/crypto/elliptic/elliptic.go.html#4201046">z3</a></span><span class="op" id="4201227">.</span><span class="ident" id="4201228">Set</span><span class="op" id="4201231">(</span><span class="ident" id="4201232"><a href="/crypto/elliptic/elliptic.go.html#4200889">z1</a></span><span class="op" id="4201234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4201238">return</span>&nbsp;<span class="ident" id="4201245"><a href="/crypto/elliptic/elliptic.go.html#4201038">x3</a></span><span class="op" id="4201247">,</span>&nbsp;<span class="ident" id="4201249"><a href="/crypto/elliptic/elliptic.go.html#4201042">y3</a></span><span class="op" id="4201251">,</span>&nbsp;<span class="ident" id="4201253"><a href="/crypto/elliptic/elliptic.go.html#4201046">z3</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4201257">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201261">z1z1</span>&nbsp;<span class="op" id="4201266">:=</span>&nbsp;<span class="builtinfunc" id="4201269">new</span><span class="op" id="4201272">(</span><span class="ident" id="4201273"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4201276">.</span><span class="ident" id="4201277">Int</span><span class="op" id="4201280">)</span><span class="op" id="4201281">.</span><span class="ident" id="4201282">Mul</span><span class="op" id="4201285">(</span><span class="ident" id="4201286"><a href="/crypto/elliptic/elliptic.go.html#4200889">z1</a></span><span class="op" id="4201288">,</span>&nbsp;<span class="ident" id="4201290"><a href="/crypto/elliptic/elliptic.go.html#4200889">z1</a></span><span class="op" id="4201292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201295"><a href="/crypto/elliptic/elliptic.go.html#4201261">z1z1</a></span><span class="op" id="4201299">.</span><span class="ident" id="4201300">Mod</span><span class="op" id="4201303">(</span><span class="ident" id="4201304"><a href="/crypto/elliptic/elliptic.go.html#4201261">z1z1</a></span><span class="op" id="4201308">,</span>&nbsp;<span class="ident" id="4201310"><a href="/crypto/elliptic/elliptic.go.html#4200849">curve</a></span><span class="op" id="4201315">.</span><span class="ident" id="4201316">P</span><span class="op" id="4201317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201320">z2z2</span>&nbsp;<span class="op" id="4201325">:=</span>&nbsp;<span class="builtinfunc" id="4201328">new</span><span class="op" id="4201331">(</span><span class="ident" id="4201332"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4201335">.</span><span class="ident" id="4201336">Int</span><span class="op" id="4201339">)</span><span class="op" id="4201340">.</span><span class="ident" id="4201341">Mul</span><span class="op" id="4201344">(</span><span class="ident" id="4201345"><a href="/crypto/elliptic/elliptic.go.html#4200901">z2</a></span><span class="op" id="4201347">,</span>&nbsp;<span class="ident" id="4201349"><a href="/crypto/elliptic/elliptic.go.html#4200901">z2</a></span><span class="op" id="4201351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201354"><a href="/crypto/elliptic/elliptic.go.html#4201320">z2z2</a></span><span class="op" id="4201358">.</span><span class="ident" id="4201359">Mod</span><span class="op" id="4201362">(</span><span class="ident" id="4201363"><a href="/crypto/elliptic/elliptic.go.html#4201320">z2z2</a></span><span class="op" id="4201367">,</span>&nbsp;<span class="ident" id="4201369"><a href="/crypto/elliptic/elliptic.go.html#4200849">curve</a></span><span class="op" id="4201374">.</span><span class="ident" id="4201375">P</span><span class="op" id="4201376">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201380">u1</span>&nbsp;<span class="op" id="4201383">:=</span>&nbsp;<span class="builtinfunc" id="4201386">new</span><span class="op" id="4201389">(</span><span class="ident" id="4201390"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4201393">.</span><span class="ident" id="4201394">Int</span><span class="op" id="4201397">)</span><span class="op" id="4201398">.</span><span class="ident" id="4201399">Mul</span><span class="op" id="4201402">(</span><span class="ident" id="4201403"><a href="/crypto/elliptic/elliptic.go.html#4200881">x1</a></span><span class="op" id="4201405">,</span>&nbsp;<span class="ident" id="4201407"><a href="/crypto/elliptic/elliptic.go.html#4201320">z2z2</a></span><span class="op" id="4201411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201414"><a href="/crypto/elliptic/elliptic.go.html#4201380">u1</a></span><span class="op" id="4201416">.</span><span class="ident" id="4201417">Mod</span><span class="op" id="4201420">(</span><span class="ident" id="4201421"><a href="/crypto/elliptic/elliptic.go.html#4201380">u1</a></span><span class="op" id="4201423">,</span>&nbsp;<span class="ident" id="4201425"><a href="/crypto/elliptic/elliptic.go.html#4200849">curve</a></span><span class="op" id="4201430">.</span><span class="ident" id="4201431">P</span><span class="op" id="4201432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201435">u2</span>&nbsp;<span class="op" id="4201438">:=</span>&nbsp;<span class="builtinfunc" id="4201441">new</span><span class="op" id="4201444">(</span><span class="ident" id="4201445"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4201448">.</span><span class="ident" id="4201449">Int</span><span class="op" id="4201452">)</span><span class="op" id="4201453">.</span><span class="ident" id="4201454">Mul</span><span class="op" id="4201457">(</span><span class="ident" id="4201458"><a href="/crypto/elliptic/elliptic.go.html#4200893">x2</a></span><span class="op" id="4201460">,</span>&nbsp;<span class="ident" id="4201462"><a href="/crypto/elliptic/elliptic.go.html#4201261">z1z1</a></span><span class="op" id="4201466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201469"><a href="/crypto/elliptic/elliptic.go.html#4201435">u2</a></span><span class="op" id="4201471">.</span><span class="ident" id="4201472">Mod</span><span class="op" id="4201475">(</span><span class="ident" id="4201476"><a href="/crypto/elliptic/elliptic.go.html#4201435">u2</a></span><span class="op" id="4201478">,</span>&nbsp;<span class="ident" id="4201480"><a href="/crypto/elliptic/elliptic.go.html#4200849">curve</a></span><span class="op" id="4201485">.</span><span class="ident" id="4201486">P</span><span class="op" id="4201487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201490">h</span>&nbsp;<span class="op" id="4201492">:=</span>&nbsp;<span class="builtinfunc" id="4201495">new</span><span class="op" id="4201498">(</span><span class="ident" id="4201499"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4201502">.</span><span class="ident" id="4201503">Int</span><span class="op" id="4201506">)</span><span class="op" id="4201507">.</span><span class="ident" id="4201508">Sub</span><span class="op" id="4201511">(</span><span class="ident" id="4201512"><a href="/crypto/elliptic/elliptic.go.html#4201435">u2</a></span><span class="op" id="4201514">,</span>&nbsp;<span class="ident" id="4201516"><a href="/crypto/elliptic/elliptic.go.html#4201380">u1</a></span><span class="op" id="4201518">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201521">xEqual</span>&nbsp;<span class="op" id="4201528">:=</span>&nbsp;<span class="ident" id="4201531"><a href="/crypto/elliptic/elliptic.go.html#4201490">h</a></span><span class="op" id="4201532">.</span><span class="ident" id="4201533">Sign</span><span class="op" id="4201537">(</span><span class="op" id="4201538">)</span>&nbsp;<span class="op" id="4201540">==</span>&nbsp;<span class="num" id="4201543">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4201546">if</span>&nbsp;<span class="ident" id="4201549"><a href="/crypto/elliptic/elliptic.go.html#4201490">h</a></span><span class="op" id="4201550">.</span><span class="ident" id="4201551">Sign</span><span class="op" id="4201555">(</span><span class="op" id="4201556">)</span>&nbsp;<span class="op" id="4201558">==</span>&nbsp;<span class="op" id="4201561">-</span><span class="num" id="4201562">1</span>&nbsp;<span class="op" id="4201564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201568"><a href="/crypto/elliptic/elliptic.go.html#4201490">h</a></span><span class="op" id="4201569">.</span><span class="ident" id="4201570">Add</span><span class="op" id="4201573">(</span><span class="ident" id="4201574"><a href="/crypto/elliptic/elliptic.go.html#4201490">h</a></span><span class="op" id="4201575">,</span>&nbsp;<span class="ident" id="4201577"><a href="/crypto/elliptic/elliptic.go.html#4200849">curve</a></span><span class="op" id="4201582">.</span><span class="ident" id="4201583">P</span><span class="op" id="4201584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4201587">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201590">i</span>&nbsp;<span class="op" id="4201592">:=</span>&nbsp;<span class="builtinfunc" id="4201595">new</span><span class="op" id="4201598">(</span><span class="ident" id="4201599"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4201602">.</span><span class="ident" id="4201603">Int</span><span class="op" id="4201606">)</span><span class="op" id="4201607">.</span><span class="ident" id="4201608">Lsh</span><span class="op" id="4201611">(</span><span class="ident" id="4201612"><a href="/crypto/elliptic/elliptic.go.html#4201490">h</a></span><span class="op" id="4201613">,</span>&nbsp;<span class="num" id="4201615">1</span><span class="op" id="4201616">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201619"><a href="/crypto/elliptic/elliptic.go.html#4201590">i</a></span><span class="op" id="4201620">.</span><span class="ident" id="4201621">Mul</span><span class="op" id="4201624">(</span><span class="ident" id="4201625"><a href="/crypto/elliptic/elliptic.go.html#4201590">i</a></span><span class="op" id="4201626">,</span>&nbsp;<span class="ident" id="4201628"><a href="/crypto/elliptic/elliptic.go.html#4201590">i</a></span><span class="op" id="4201629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201632">j</span>&nbsp;<span class="op" id="4201634">:=</span>&nbsp;<span class="builtinfunc" id="4201637">new</span><span class="op" id="4201640">(</span><span class="ident" id="4201641"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4201644">.</span><span class="ident" id="4201645">Int</span><span class="op" id="4201648">)</span><span class="op" id="4201649">.</span><span class="ident" id="4201650">Mul</span><span class="op" id="4201653">(</span><span class="ident" id="4201654"><a href="/crypto/elliptic/elliptic.go.html#4201490">h</a></span><span class="op" id="4201655">,</span>&nbsp;<span class="ident" id="4201657"><a href="/crypto/elliptic/elliptic.go.html#4201590">i</a></span><span class="op" id="4201658">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201662">s1</span>&nbsp;<span class="op" id="4201665">:=</span>&nbsp;<span class="builtinfunc" id="4201668">new</span><span class="op" id="4201671">(</span><span class="ident" id="4201672"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4201675">.</span><span class="ident" id="4201676">Int</span><span class="op" id="4201679">)</span><span class="op" id="4201680">.</span><span class="ident" id="4201681">Mul</span><span class="op" id="4201684">(</span><span class="ident" id="4201685"><a href="/crypto/elliptic/elliptic.go.html#4200885">y1</a></span><span class="op" id="4201687">,</span>&nbsp;<span class="ident" id="4201689"><a href="/crypto/elliptic/elliptic.go.html#4200901">z2</a></span><span class="op" id="4201691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201694"><a href="/crypto/elliptic/elliptic.go.html#4201662">s1</a></span><span class="op" id="4201696">.</span><span class="ident" id="4201697">Mul</span><span class="op" id="4201700">(</span><span class="ident" id="4201701"><a href="/crypto/elliptic/elliptic.go.html#4201662">s1</a></span><span class="op" id="4201703">,</span>&nbsp;<span class="ident" id="4201705"><a href="/crypto/elliptic/elliptic.go.html#4201320">z2z2</a></span><span class="op" id="4201709">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201712"><a href="/crypto/elliptic/elliptic.go.html#4201662">s1</a></span><span class="op" id="4201714">.</span><span class="ident" id="4201715">Mod</span><span class="op" id="4201718">(</span><span class="ident" id="4201719"><a href="/crypto/elliptic/elliptic.go.html#4201662">s1</a></span><span class="op" id="4201721">,</span>&nbsp;<span class="ident" id="4201723"><a href="/crypto/elliptic/elliptic.go.html#4200849">curve</a></span><span class="op" id="4201728">.</span><span class="ident" id="4201729">P</span><span class="op" id="4201730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201733">s2</span>&nbsp;<span class="op" id="4201736">:=</span>&nbsp;<span class="builtinfunc" id="4201739">new</span><span class="op" id="4201742">(</span><span class="ident" id="4201743"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4201746">.</span><span class="ident" id="4201747">Int</span><span class="op" id="4201750">)</span><span class="op" id="4201751">.</span><span class="ident" id="4201752">Mul</span><span class="op" id="4201755">(</span><span class="ident" id="4201756"><a href="/crypto/elliptic/elliptic.go.html#4200897">y2</a></span><span class="op" id="4201758">,</span>&nbsp;<span class="ident" id="4201760"><a href="/crypto/elliptic/elliptic.go.html#4200889">z1</a></span><span class="op" id="4201762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201765"><a href="/crypto/elliptic/elliptic.go.html#4201733">s2</a></span><span class="op" id="4201767">.</span><span class="ident" id="4201768">Mul</span><span class="op" id="4201771">(</span><span class="ident" id="4201772"><a href="/crypto/elliptic/elliptic.go.html#4201733">s2</a></span><span class="op" id="4201774">,</span>&nbsp;<span class="ident" id="4201776"><a href="/crypto/elliptic/elliptic.go.html#4201261">z1z1</a></span><span class="op" id="4201780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201783"><a href="/crypto/elliptic/elliptic.go.html#4201733">s2</a></span><span class="op" id="4201785">.</span><span class="ident" id="4201786">Mod</span><span class="op" id="4201789">(</span><span class="ident" id="4201790"><a href="/crypto/elliptic/elliptic.go.html#4201733">s2</a></span><span class="op" id="4201792">,</span>&nbsp;<span class="ident" id="4201794"><a href="/crypto/elliptic/elliptic.go.html#4200849">curve</a></span><span class="op" id="4201799">.</span><span class="ident" id="4201800">P</span><span class="op" id="4201801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201804">r</span>&nbsp;<span class="op" id="4201806">:=</span>&nbsp;<span class="builtinfunc" id="4201809">new</span><span class="op" id="4201812">(</span><span class="ident" id="4201813"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4201816">.</span><span class="ident" id="4201817">Int</span><span class="op" id="4201820">)</span><span class="op" id="4201821">.</span><span class="ident" id="4201822">Sub</span><span class="op" id="4201825">(</span><span class="ident" id="4201826"><a href="/crypto/elliptic/elliptic.go.html#4201733">s2</a></span><span class="op" id="4201828">,</span>&nbsp;<span class="ident" id="4201830"><a href="/crypto/elliptic/elliptic.go.html#4201662">s1</a></span><span class="op" id="4201832">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4201835">if</span>&nbsp;<span class="ident" id="4201838"><a href="/crypto/elliptic/elliptic.go.html#4201804">r</a></span><span class="op" id="4201839">.</span><span class="ident" id="4201840">Sign</span><span class="op" id="4201844">(</span><span class="op" id="4201845">)</span>&nbsp;<span class="op" id="4201847">==</span>&nbsp;<span class="op" id="4201850">-</span><span class="num" id="4201851">1</span>&nbsp;<span class="op" id="4201853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201857"><a href="/crypto/elliptic/elliptic.go.html#4201804">r</a></span><span class="op" id="4201858">.</span><span class="ident" id="4201859">Add</span><span class="op" id="4201862">(</span><span class="ident" id="4201863"><a href="/crypto/elliptic/elliptic.go.html#4201804">r</a></span><span class="op" id="4201864">,</span>&nbsp;<span class="ident" id="4201866"><a href="/crypto/elliptic/elliptic.go.html#4200849">curve</a></span><span class="op" id="4201871">.</span><span class="ident" id="4201872">P</span><span class="op" id="4201873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4201876">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201879">yEqual</span>&nbsp;<span class="op" id="4201886">:=</span>&nbsp;<span class="ident" id="4201889"><a href="/crypto/elliptic/elliptic.go.html#4201804">r</a></span><span class="op" id="4201890">.</span><span class="ident" id="4201891">Sign</span><span class="op" id="4201895">(</span><span class="op" id="4201896">)</span>&nbsp;<span class="op" id="4201898">==</span>&nbsp;<span class="num" id="4201901">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4201904">if</span>&nbsp;<span class="ident" id="4201907"><a href="/crypto/elliptic/elliptic.go.html#4201521">xEqual</a></span>&nbsp;<span class="op" id="4201914">&amp;&amp;</span>&nbsp;<span class="ident" id="4201917"><a href="/crypto/elliptic/elliptic.go.html#4201879">yEqual</a></span>&nbsp;<span class="op" id="4201924">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4201928">return</span>&nbsp;<span class="ident" id="4201935"><a href="/crypto/elliptic/elliptic.go.html#4200849">curve</a></span><span class="op" id="4201940">.</span><span class="ident" id="4201941">doubleJacobian</span><span class="op" id="4201955">(</span><span class="ident" id="4201956"><a href="/crypto/elliptic/elliptic.go.html#4200881">x1</a></span><span class="op" id="4201958">,</span>&nbsp;<span class="ident" id="4201960"><a href="/crypto/elliptic/elliptic.go.html#4200885">y1</a></span><span class="op" id="4201962">,</span>&nbsp;<span class="ident" id="4201964"><a href="/crypto/elliptic/elliptic.go.html#4200889">z1</a></span><span class="op" id="4201966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4201969">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201972"><a href="/crypto/elliptic/elliptic.go.html#4201804">r</a></span><span class="op" id="4201973">.</span><span class="ident" id="4201974">Lsh</span><span class="op" id="4201977">(</span><span class="ident" id="4201978"><a href="/crypto/elliptic/elliptic.go.html#4201804">r</a></span><span class="op" id="4201979">,</span>&nbsp;<span class="num" id="4201981">1</span><span class="op" id="4201982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4201985">v</span>&nbsp;<span class="op" id="4201987">:=</span>&nbsp;<span class="builtinfunc" id="4201990">new</span><span class="op" id="4201993">(</span><span class="ident" id="4201994"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4201997">.</span><span class="ident" id="4201998">Int</span><span class="op" id="4202001">)</span><span class="op" id="4202002">.</span><span class="ident" id="4202003">Mul</span><span class="op" id="4202006">(</span><span class="ident" id="4202007"><a href="/crypto/elliptic/elliptic.go.html#4201380">u1</a></span><span class="op" id="4202009">,</span>&nbsp;<span class="ident" id="4202011"><a href="/crypto/elliptic/elliptic.go.html#4201590">i</a></span><span class="op" id="4202012">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4202016"><a href="/crypto/elliptic/elliptic.go.html#4201038">x3</a></span><span class="op" id="4202018">.</span><span class="ident" id="4202019">Set</span><span class="op" id="4202022">(</span><span class="ident" id="4202023"><a href="/crypto/elliptic/elliptic.go.html#4201804">r</a></span><span class="op" id="4202024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4202027"><a href="/crypto/elliptic/elliptic.go.html#4201038">x3</a></span><span class="op" id="4202029">.</span><span class="ident" id="4202030">Mul</span><span class="op" id="4202033">(</span><span class="ident" id="4202034"><a href="/crypto/elliptic/elliptic.go.html#4201038">x3</a></span><span class="op" id="4202036">,</span>&nbsp;<span class="ident" id="4202038"><a href="/crypto/elliptic/elliptic.go.html#4201038">x3</a></span><span class="op" id="4202040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4202043"><a href="/crypto/elliptic/elliptic.go.html#4201038">x3</a></span><span class="op" id="4202045">.</span><span class="ident" id="4202046">Sub</span><span class="op" id="4202049">(</span><span class="ident" id="4202050"><a href="/crypto/elliptic/elliptic.go.html#4201038">x3</a></span><span class="op" id="4202052">,</span>&nbsp;<span class="ident" id="4202054"><a href="/crypto/elliptic/elliptic.go.html#4201632">j</a></span><span class="op" id="4202055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4202058"><a href="/crypto/elliptic/elliptic.go.html#4201038">x3</a></span><span class="op" id="4202060">.</span><span class="ident" id="4202061">Sub</span><span class="op" id="4202064">(</span><span class="ident" id="4202065"><a href="/crypto/elliptic/elliptic.go.html#4201038">x3</a></span><span class="op" id="4202067">,</span>&nbsp;<span class="ident" id="4202069"><a href="/crypto/elliptic/elliptic.go.html#4201985">v</a></span><span class="op" id="4202070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4202073"><a href="/crypto/elliptic/elliptic.go.html#4201038">x3</a></span><span class="op" id="4202075">.</span><span class="ident" id="4202076">Sub</span><span class="op" id="4202079">(</span><span class="ident" id="4202080"><a href="/crypto/elliptic/elliptic.go.html#4201038">x3</a></span><span class="op" id="4202082">,</span>&nbsp;<span class="ident" id="4202084"><a href="/crypto/elliptic/elliptic.go.html#4201985">v</a></span><span class="op" id="4202085">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4202088"><a href="/crypto/elliptic/elliptic.go.html#4201038">x3</a></span><span class="op" id="4202090">.</span><span class="ident" id="4202091">Mod</span><span class="op" id="4202094">(</span><span class="ident" id="4202095"><a href="/crypto/elliptic/elliptic.go.html#4201038">x3</a></span><span class="op" id="4202097">,</span>&nbsp;<span class="ident" id="4202099"><a href="/crypto/elliptic/elliptic.go.html#4200849">curve</a></span><span class="op" id="4202104">.</span><span class="ident" id="4202105">P</span><span class="op" id="4202106">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4202110"><a href="/crypto/elliptic/elliptic.go.html#4201042">y3</a></span><span class="op" id="4202112">.</span><span class="ident" id="4202113">Set</span><span class="op" id="4202116">(</span><span class="ident" id="4202117"><a href="/crypto/elliptic/elliptic.go.html#4201804">r</a></span><span class="op" id="4202118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4202121"><a href="/crypto/elliptic/elliptic.go.html#4201985">v</a></span><span class="op" id="4202122">.</span><span class="ident" id="4202123">Sub</span><span class="op" id="4202126">(</span><span class="ident" id="4202127"><a href="/crypto/elliptic/elliptic.go.html#4201985">v</a></span><span class="op" id="4202128">,</span>&nbsp;<span class="ident" id="4202130"><a href="/crypto/elliptic/elliptic.go.html#4201038">x3</a></span><span class="op" id="4202132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4202135"><a href="/crypto/elliptic/elliptic.go.html#4201042">y3</a></span><span class="op" id="4202137">.</span><span class="ident" id="4202138">Mul</span><span class="op" id="4202141">(</span><span class="ident" id="4202142"><a href="/crypto/elliptic/elliptic.go.html#4201042">y3</a></span><span class="op" id="4202144">,</span>&nbsp;<span class="ident" id="4202146"><a href="/crypto/elliptic/elliptic.go.html#4201985">v</a></span><span class="op" id="4202147">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4202150"><a href="/crypto/elliptic/elliptic.go.html#4201662">s1</a></span><span class="op" id="4202152">.</span><span class="ident" id="4202153">Mul</span><span class="op" id="4202156">(</span><span class="ident" id="4202157"><a href="/crypto/elliptic/elliptic.go.html#4201662">s1</a></span><span class="op" id="4202159">,</span>&nbsp;<span class="ident" id="4202161"><a href="/crypto/elliptic/elliptic.go.html#4201632">j</a></span><span class="op" id="4202162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4202165"><a href="/crypto/elliptic/elliptic.go.html#4201662">s1</a></span><span class="op" id="4202167">.</span><span class="ident" id="4202168">Lsh</span><span class="op" id="4202171">(</span><span class="ident" id="4202172"><a href="/crypto/elliptic/elliptic.go.html#4201662">s1</a></span><span class="op" id="4202174">,</span>&nbsp;<span class="num" id="4202176">1</span><span class="op" id="4202177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4202180"><a href="/crypto/elliptic/elliptic.go.html#4201042">y3</a></span><span class="op" id="4202182">.</span><span class="ident" id="4202183">Sub</span><span class="op" id="4202186">(</span><span class="ident" id="4202187"><a href="/crypto/elliptic/elliptic.go.html#4201042">y3</a></span><span class="op" id="4202189">,</span>&nbsp;<span class="ident" id="4202191"><a href="/crypto/elliptic/elliptic.go.html#4201662">s1</a></span><span class="op" id="4202193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4202196"><a href="/crypto/elliptic/elliptic.go.html#4201042">y3</a></span><span class="op" id="4202198">.</span><span class="ident" id="4202199">Mod</span><span class="op" id="4202202">(</span><span class="ident" id="4202203"><a href="/crypto/elliptic/elliptic.go.html#4201042">y3</a></span><span class="op" id="4202205">,</span>&nbsp;<span class="ident" id="4202207"><a href="/crypto/elliptic/elliptic.go.html#4200849">curve</a></span><span class="op" id="4202212">.</span><span class="ident" id="4202213">P</span><span class="op" id="4202214">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4202218"><a href="/crypto/elliptic/elliptic.go.html#4201046">z3</a></span><span class="op" id="4202220">.</span><span class="ident" id="4202221">Add</span><span class="op" id="4202224">(</span><span class="ident" id="4202225"><a href="/crypto/elliptic/elliptic.go.html#4200889">z1</a></span><span class="op" id="4202227">,</span>&nbsp;<span class="ident" id="4202229"><a href="/crypto/elliptic/elliptic.go.html#4200901">z2</a></span><span class="op" id="4202231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4202234"><a href="/crypto/elliptic/elliptic.go.html#4201046">z3</a></span><span class="op" id="4202236">.</span><span class="ident" id="4202237">Mul</span><span class="op" id="4202240">(</span><span class="ident" id="4202241"><a href="/crypto/elliptic/elliptic.go.html#4201046">z3</a></span><span class="op" id="4202243">,</span>&nbsp;<span class="ident" id="4202245"><a href="/crypto/elliptic/elliptic.go.html#4201046">z3</a></span><span class="op" id="4202247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4202250"><a href="/crypto/elliptic/elliptic.go.html#4201046">z3</a></span><span class="op" id="4202252">.</span><span class="ident" id="4202253">Sub</span><span class="op" id="4202256">(</span><span class="ident" id="4202257"><a href="/crypto/elliptic/elliptic.go.html#4201046">z3</a></span><span class="op" id="4202259">,</span>&nbsp;<span class="ident" id="4202261"><a href="/crypto/elliptic/elliptic.go.html#4201261">z1z1</a></span><span class="op" id="4202265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4202268"><a href="/crypto/elliptic/elliptic.go.html#4201046">z3</a></span><span class="op" id="4202270">.</span><span class="ident" id="4202271">Sub</span><span class="op" id="4202274">(</span><span class="ident" id="4202275"><a href="/crypto/elliptic/elliptic.go.html#4201046">z3</a></span><span class="op" id="4202277">,</span>&nbsp;<span class="ident" id="4202279"><a href="/crypto/elliptic/elliptic.go.html#4201320">z2z2</a></span><span class="op" id="4202283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4202286"><a href="/crypto/elliptic/elliptic.go.html#4201046">z3</a></span><span class="op" id="4202288">.</span><span class="ident" id="4202289">Mul</span><span class="op" id="4202292">(</span><span class="ident" id="4202293"><a href="/crypto/elliptic/elliptic.go.html#4201046">z3</a></span><span class="op" id="4202295">,</span>&nbsp;<span class="ident" id="4202297"><a href="/crypto/elliptic/elliptic.go.html#4201490">h</a></span><span class="op" id="4202298">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4202301"><a href="/crypto/elliptic/elliptic.go.html#4201046">z3</a></span><span class="op" id="4202303">.</span><span class="ident" id="4202304">Mod</span><span class="op" id="4202307">(</span><span class="ident" id="4202308"><a href="/crypto/elliptic/elliptic.go.html#4201046">z3</a></span><span class="op" id="4202310">,</span>&nbsp;<span class="ident" id="4202312"><a href="/crypto/elliptic/elliptic.go.html#4200849">curve</a></span><span class="op" id="4202317">.</span><span class="ident" id="4202318">P</span><span class="op" id="4202319">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4202323">return</span>&nbsp;<span class="ident" id="4202330"><a href="/crypto/elliptic/elliptic.go.html#4201038">x3</a></span><span class="op" id="4202332">,</span>&nbsp;<span class="ident" id="4202334"><a href="/crypto/elliptic/elliptic.go.html#4201042">y3</a></span><span class="op" id="4202336">,</span>&nbsp;<span class="ident" id="4202338"><a href="/crypto/elliptic/elliptic.go.html#4201046">z3</a></span><br>
<span class="lineno"></span><span class="op" id="4202341">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="4202344">func</span>&nbsp;<span class="op" id="4202349">(</span><span class="ident" id="4202350">curve</span>&nbsp;<span class="op" id="4202356">*</span><span class="ident" id="4202357"><a href="/crypto/elliptic/elliptic.go.html#4198953">CurveParams</a></span><span class="op" id="4202368">)</span>&nbsp;<span class="ident" id="4202370">Double</span><span class="op" id="4202376">(</span><span class="ident" id="4202377">x1</span><span class="op" id="4202379">,</span>&nbsp;<span class="ident" id="4202381">y1</span>&nbsp;<span class="op" id="4202384">*</span><span class="ident" id="4202385"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4202388">.</span><span class="ident" id="4202389">Int</span><span class="op" id="4202392">)</span>&nbsp;<span class="op" id="4202394">(</span><span class="op" id="4202395">*</span><span class="ident" id="4202396"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4202399">.</span><span class="ident" id="4202400">Int</span><span class="op" id="4202403">,</span>&nbsp;<span class="op" id="4202405">*</span><span class="ident" id="4202406"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4202409">.</span><span class="ident" id="4202410">Int</span><span class="op" id="4202413">)</span>&nbsp;<span class="op" id="4202415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4202418">z1</span>&nbsp;<span class="op" id="4202421">:=</span>&nbsp;<span class="ident" id="4202424"><a href="/crypto/elliptic/elliptic.go.html#4199846">zForAffine</a></span><span class="op" id="4202434">(</span><span class="ident" id="4202435"><a href="/crypto/elliptic/elliptic.go.html#4202377">x1</a></span><span class="op" id="4202437">,</span>&nbsp;<span class="ident" id="4202439"><a href="/crypto/elliptic/elliptic.go.html#4202381">y1</a></span><span class="op" id="4202441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4202444">return</span>&nbsp;<span class="ident" id="4202451"><a href="/crypto/elliptic/elliptic.go.html#4202350">curve</a></span><span class="op" id="4202456">.</span><span class="ident" id="4202457">affineFromJacobian</span><span class="op" id="4202475">(</span><span class="ident" id="4202476"><a href="/crypto/elliptic/elliptic.go.html#4202350">curve</a></span><span class="op" id="4202481">.</span><span class="ident" id="4202482">doubleJacobian</span><span class="op" id="4202496">(</span><span class="ident" id="4202497"><a href="/crypto/elliptic/elliptic.go.html#4202377">x1</a></span><span class="op" id="4202499">,</span>&nbsp;<span class="ident" id="4202501"><a href="/crypto/elliptic/elliptic.go.html#4202381">y1</a></span><span class="op" id="4202503">,</span>&nbsp;<span class="ident" id="4202505"><a href="/crypto/elliptic/elliptic.go.html#4202418">z1</a></span><span class="op" id="4202507">)</span><span class="op" id="4202508">)</span><br>
<span class="lineno"></span><span class="op" id="4202510">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="comment" id="4202513">//&nbsp;doubleJacobian&nbsp;takes&nbsp;a&nbsp;point&nbsp;in&nbsp;Jacobian&nbsp;coordinates,&nbsp;(x,&nbsp;y,&nbsp;z),&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4202585">//&nbsp;returns&nbsp;its&nbsp;double,&nbsp;also&nbsp;in&nbsp;Jacobian&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="4202631">func</span>&nbsp;<span class="op" id="4202636">(</span><span class="ident" id="4202637">curve</span>&nbsp;<span class="op" id="4202643">*</span><span class="ident" id="4202644"><a href="/crypto/elliptic/elliptic.go.html#4198953">CurveParams</a></span><span class="op" id="4202655">)</span>&nbsp;<span class="ident" id="4202657">doubleJacobian</span><span class="op" id="4202671">(</span><span class="ident" id="4202672">x</span><span class="op" id="4202673">,</span>&nbsp;<span class="ident" id="4202675">y</span><span class="op" id="4202676">,</span>&nbsp;<span class="ident" id="4202678">z</span>&nbsp;<span class="op" id="4202680">*</span><span class="ident" id="4202681"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4202684">.</span><span class="ident" id="4202685">Int</span><span class="op" id="4202688">)</span>&nbsp;<span class="op" id="4202690">(</span><span class="op" id="4202691">*</span><span class="ident" id="4202692"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4202695">.</span><span class="ident" id="4202696">Int</span><span class="op" id="4202699">,</span>&nbsp;<span class="op" id="4202701">*</span><span class="ident" id="4202702"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4202705">.</span><span class="ident" id="4202706">Int</span><span class="op" id="4202709">,</span>&nbsp;<span class="op" id="4202711">*</span><span class="ident" id="4202712"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4202715">.</span><span class="ident" id="4202716">Int</span><span class="op" id="4202719">)</span>&nbsp;<span class="op" id="4202721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4202724">//&nbsp;See&nbsp;http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-3.html#doubling-dbl-2001-b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4202813">delta</span>&nbsp;<span class="op" id="4202819">:=</span>&nbsp;<span class="builtinfunc" id="4202822">new</span><span class="op" id="4202825">(</span><span class="ident" id="4202826"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4202829">.</span><span class="ident" id="4202830">Int</span><span class="op" id="4202833">)</span><span class="op" id="4202834">.</span><span class="ident" id="4202835">Mul</span><span class="op" id="4202838">(</span><span class="ident" id="4202839"><a href="/crypto/elliptic/elliptic.go.html#4202678">z</a></span><span class="op" id="4202840">,</span>&nbsp;<span class="ident" id="4202842"><a href="/crypto/elliptic/elliptic.go.html#4202678">z</a></span><span class="op" id="4202843">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4202846"><a href="/crypto/elliptic/elliptic.go.html#4202813">delta</a></span><span class="op" id="4202851">.</span><span class="ident" id="4202852">Mod</span><span class="op" id="4202855">(</span><span class="ident" id="4202856"><a href="/crypto/elliptic/elliptic.go.html#4202813">delta</a></span><span class="op" id="4202861">,</span>&nbsp;<span class="ident" id="4202863"><a href="/crypto/elliptic/elliptic.go.html#4202637">curve</a></span><span class="op" id="4202868">.</span><span class="ident" id="4202869">P</span><span class="op" id="4202870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4202873">gamma</span>&nbsp;<span class="op" id="4202879">:=</span>&nbsp;<span class="builtinfunc" id="4202882">new</span><span class="op" id="4202885">(</span><span class="ident" id="4202886"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4202889">.</span><span class="ident" id="4202890">Int</span><span class="op" id="4202893">)</span><span class="op" id="4202894">.</span><span class="ident" id="4202895">Mul</span><span class="op" id="4202898">(</span><span class="ident" id="4202899"><a href="/crypto/elliptic/elliptic.go.html#4202675">y</a></span><span class="op" id="4202900">,</span>&nbsp;<span class="ident" id="4202902"><a href="/crypto/elliptic/elliptic.go.html#4202675">y</a></span><span class="op" id="4202903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4202906"><a href="/crypto/elliptic/elliptic.go.html#4202873">gamma</a></span><span class="op" id="4202911">.</span><span class="ident" id="4202912">Mod</span><span class="op" id="4202915">(</span><span class="ident" id="4202916"><a href="/crypto/elliptic/elliptic.go.html#4202873">gamma</a></span><span class="op" id="4202921">,</span>&nbsp;<span class="ident" id="4202923"><a href="/crypto/elliptic/elliptic.go.html#4202637">curve</a></span><span class="op" id="4202928">.</span><span class="ident" id="4202929">P</span><span class="op" id="4202930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4202933">alpha</span>&nbsp;<span class="op" id="4202939">:=</span>&nbsp;<span class="builtinfunc" id="4202942">new</span><span class="op" id="4202945">(</span><span class="ident" id="4202946"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4202949">.</span><span class="ident" id="4202950">Int</span><span class="op" id="4202953">)</span><span class="op" id="4202954">.</span><span class="ident" id="4202955">Sub</span><span class="op" id="4202958">(</span><span class="ident" id="4202959"><a href="/crypto/elliptic/elliptic.go.html#4202672">x</a></span><span class="op" id="4202960">,</span>&nbsp;<span class="ident" id="4202962"><a href="/crypto/elliptic/elliptic.go.html#4202813">delta</a></span><span class="op" id="4202967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4202970">if</span>&nbsp;<span class="ident" id="4202973"><a href="/crypto/elliptic/elliptic.go.html#4202933">alpha</a></span><span class="op" id="4202978">.</span><span class="ident" id="4202979">Sign</span><span class="op" id="4202983">(</span><span class="op" id="4202984">)</span>&nbsp;<span class="op" id="4202986">==</span>&nbsp;<span class="op" id="4202989">-</span><span class="num" id="4202990">1</span>&nbsp;<span class="op" id="4202992">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4202996"><a href="/crypto/elliptic/elliptic.go.html#4202933">alpha</a></span><span class="op" id="4203001">.</span><span class="ident" id="4203002">Add</span><span class="op" id="4203005">(</span><span class="ident" id="4203006"><a href="/crypto/elliptic/elliptic.go.html#4202933">alpha</a></span><span class="op" id="4203011">,</span>&nbsp;<span class="ident" id="4203013"><a href="/crypto/elliptic/elliptic.go.html#4202637">curve</a></span><span class="op" id="4203018">.</span><span class="ident" id="4203019">P</span><span class="op" id="4203020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4203023">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203026">alpha2</span>&nbsp;<span class="op" id="4203033">:=</span>&nbsp;<span class="builtinfunc" id="4203036">new</span><span class="op" id="4203039">(</span><span class="ident" id="4203040"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4203043">.</span><span class="ident" id="4203044">Int</span><span class="op" id="4203047">)</span><span class="op" id="4203048">.</span><span class="ident" id="4203049">Add</span><span class="op" id="4203052">(</span><span class="ident" id="4203053"><a href="/crypto/elliptic/elliptic.go.html#4202672">x</a></span><span class="op" id="4203054">,</span>&nbsp;<span class="ident" id="4203056"><a href="/crypto/elliptic/elliptic.go.html#4202813">delta</a></span><span class="op" id="4203061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203064"><a href="/crypto/elliptic/elliptic.go.html#4202933">alpha</a></span><span class="op" id="4203069">.</span><span class="ident" id="4203070">Mul</span><span class="op" id="4203073">(</span><span class="ident" id="4203074"><a href="/crypto/elliptic/elliptic.go.html#4202933">alpha</a></span><span class="op" id="4203079">,</span>&nbsp;<span class="ident" id="4203081"><a href="/crypto/elliptic/elliptic.go.html#4203026">alpha2</a></span><span class="op" id="4203087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203090"><a href="/crypto/elliptic/elliptic.go.html#4203026">alpha2</a></span><span class="op" id="4203096">.</span><span class="ident" id="4203097">Set</span><span class="op" id="4203100">(</span><span class="ident" id="4203101"><a href="/crypto/elliptic/elliptic.go.html#4202933">alpha</a></span><span class="op" id="4203106">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203109"><a href="/crypto/elliptic/elliptic.go.html#4202933">alpha</a></span><span class="op" id="4203114">.</span><span class="ident" id="4203115">Lsh</span><span class="op" id="4203118">(</span><span class="ident" id="4203119"><a href="/crypto/elliptic/elliptic.go.html#4202933">alpha</a></span><span class="op" id="4203124">,</span>&nbsp;<span class="num" id="4203126">1</span><span class="op" id="4203127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203130"><a href="/crypto/elliptic/elliptic.go.html#4202933">alpha</a></span><span class="op" id="4203135">.</span><span class="ident" id="4203136">Add</span><span class="op" id="4203139">(</span><span class="ident" id="4203140"><a href="/crypto/elliptic/elliptic.go.html#4202933">alpha</a></span><span class="op" id="4203145">,</span>&nbsp;<span class="ident" id="4203147"><a href="/crypto/elliptic/elliptic.go.html#4203026">alpha2</a></span><span class="op" id="4203153">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203157">beta</span>&nbsp;<span class="op" id="4203162">:=</span>&nbsp;<span class="ident" id="4203165"><a href="/crypto/elliptic/elliptic.go.html#4203026">alpha2</a></span><span class="op" id="4203171">.</span><span class="ident" id="4203172">Mul</span><span class="op" id="4203175">(</span><span class="ident" id="4203176"><a href="/crypto/elliptic/elliptic.go.html#4202672">x</a></span><span class="op" id="4203177">,</span>&nbsp;<span class="ident" id="4203179"><a href="/crypto/elliptic/elliptic.go.html#4202873">gamma</a></span><span class="op" id="4203184">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203188">x3</span>&nbsp;<span class="op" id="4203191">:=</span>&nbsp;<span class="builtinfunc" id="4203194">new</span><span class="op" id="4203197">(</span><span class="ident" id="4203198"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4203201">.</span><span class="ident" id="4203202">Int</span><span class="op" id="4203205">)</span><span class="op" id="4203206">.</span><span class="ident" id="4203207">Mul</span><span class="op" id="4203210">(</span><span class="ident" id="4203211"><a href="/crypto/elliptic/elliptic.go.html#4202933">alpha</a></span><span class="op" id="4203216">,</span>&nbsp;<span class="ident" id="4203218"><a href="/crypto/elliptic/elliptic.go.html#4202933">alpha</a></span><span class="op" id="4203223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203226">beta8</span>&nbsp;<span class="op" id="4203232">:=</span>&nbsp;<span class="builtinfunc" id="4203235">new</span><span class="op" id="4203238">(</span><span class="ident" id="4203239"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4203242">.</span><span class="ident" id="4203243">Int</span><span class="op" id="4203246">)</span><span class="op" id="4203247">.</span><span class="ident" id="4203248">Lsh</span><span class="op" id="4203251">(</span><span class="ident" id="4203252"><a href="/crypto/elliptic/elliptic.go.html#4203157">beta</a></span><span class="op" id="4203256">,</span>&nbsp;<span class="num" id="4203258">3</span><span class="op" id="4203259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203262"><a href="/crypto/elliptic/elliptic.go.html#4203188">x3</a></span><span class="op" id="4203264">.</span><span class="ident" id="4203265">Sub</span><span class="op" id="4203268">(</span><span class="ident" id="4203269"><a href="/crypto/elliptic/elliptic.go.html#4203188">x3</a></span><span class="op" id="4203271">,</span>&nbsp;<span class="ident" id="4203273"><a href="/crypto/elliptic/elliptic.go.html#4203226">beta8</a></span><span class="op" id="4203278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4203281">for</span>&nbsp;<span class="ident" id="4203285"><a href="/crypto/elliptic/elliptic.go.html#4203188">x3</a></span><span class="op" id="4203287">.</span><span class="ident" id="4203288">Sign</span><span class="op" id="4203292">(</span><span class="op" id="4203293">)</span>&nbsp;<span class="op" id="4203295">==</span>&nbsp;<span class="op" id="4203298">-</span><span class="num" id="4203299">1</span>&nbsp;<span class="op" id="4203301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203305"><a href="/crypto/elliptic/elliptic.go.html#4203188">x3</a></span><span class="op" id="4203307">.</span><span class="ident" id="4203308">Add</span><span class="op" id="4203311">(</span><span class="ident" id="4203312"><a href="/crypto/elliptic/elliptic.go.html#4203188">x3</a></span><span class="op" id="4203314">,</span>&nbsp;<span class="ident" id="4203316"><a href="/crypto/elliptic/elliptic.go.html#4202637">curve</a></span><span class="op" id="4203321">.</span><span class="ident" id="4203322">P</span><span class="op" id="4203323">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4203326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203329"><a href="/crypto/elliptic/elliptic.go.html#4203188">x3</a></span><span class="op" id="4203331">.</span><span class="ident" id="4203332">Mod</span><span class="op" id="4203335">(</span><span class="ident" id="4203336"><a href="/crypto/elliptic/elliptic.go.html#4203188">x3</a></span><span class="op" id="4203338">,</span>&nbsp;<span class="ident" id="4203340"><a href="/crypto/elliptic/elliptic.go.html#4202637">curve</a></span><span class="op" id="4203345">.</span><span class="ident" id="4203346">P</span><span class="op" id="4203347">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203351">z3</span>&nbsp;<span class="op" id="4203354">:=</span>&nbsp;<span class="builtinfunc" id="4203357">new</span><span class="op" id="4203360">(</span><span class="ident" id="4203361"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4203364">.</span><span class="ident" id="4203365">Int</span><span class="op" id="4203368">)</span><span class="op" id="4203369">.</span><span class="ident" id="4203370">Add</span><span class="op" id="4203373">(</span><span class="ident" id="4203374"><a href="/crypto/elliptic/elliptic.go.html#4202675">y</a></span><span class="op" id="4203375">,</span>&nbsp;<span class="ident" id="4203377"><a href="/crypto/elliptic/elliptic.go.html#4202678">z</a></span><span class="op" id="4203378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203381"><a href="/crypto/elliptic/elliptic.go.html#4203351">z3</a></span><span class="op" id="4203383">.</span><span class="ident" id="4203384">Mul</span><span class="op" id="4203387">(</span><span class="ident" id="4203388"><a href="/crypto/elliptic/elliptic.go.html#4203351">z3</a></span><span class="op" id="4203390">,</span>&nbsp;<span class="ident" id="4203392"><a href="/crypto/elliptic/elliptic.go.html#4203351">z3</a></span><span class="op" id="4203394">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203397"><a href="/crypto/elliptic/elliptic.go.html#4203351">z3</a></span><span class="op" id="4203399">.</span><span class="ident" id="4203400">Sub</span><span class="op" id="4203403">(</span><span class="ident" id="4203404"><a href="/crypto/elliptic/elliptic.go.html#4203351">z3</a></span><span class="op" id="4203406">,</span>&nbsp;<span class="ident" id="4203408"><a href="/crypto/elliptic/elliptic.go.html#4202873">gamma</a></span><span class="op" id="4203413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4203416">if</span>&nbsp;<span class="ident" id="4203419"><a href="/crypto/elliptic/elliptic.go.html#4203351">z3</a></span><span class="op" id="4203421">.</span><span class="ident" id="4203422">Sign</span><span class="op" id="4203426">(</span><span class="op" id="4203427">)</span>&nbsp;<span class="op" id="4203429">==</span>&nbsp;<span class="op" id="4203432">-</span><span class="num" id="4203433">1</span>&nbsp;<span class="op" id="4203435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203439"><a href="/crypto/elliptic/elliptic.go.html#4203351">z3</a></span><span class="op" id="4203441">.</span><span class="ident" id="4203442">Add</span><span class="op" id="4203445">(</span><span class="ident" id="4203446"><a href="/crypto/elliptic/elliptic.go.html#4203351">z3</a></span><span class="op" id="4203448">,</span>&nbsp;<span class="ident" id="4203450"><a href="/crypto/elliptic/elliptic.go.html#4202637">curve</a></span><span class="op" id="4203455">.</span><span class="ident" id="4203456">P</span><span class="op" id="4203457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4203460">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203463"><a href="/crypto/elliptic/elliptic.go.html#4203351">z3</a></span><span class="op" id="4203465">.</span><span class="ident" id="4203466">Sub</span><span class="op" id="4203469">(</span><span class="ident" id="4203470"><a href="/crypto/elliptic/elliptic.go.html#4203351">z3</a></span><span class="op" id="4203472">,</span>&nbsp;<span class="ident" id="4203474"><a href="/crypto/elliptic/elliptic.go.html#4202813">delta</a></span><span class="op" id="4203479">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4203482">if</span>&nbsp;<span class="ident" id="4203485"><a href="/crypto/elliptic/elliptic.go.html#4203351">z3</a></span><span class="op" id="4203487">.</span><span class="ident" id="4203488">Sign</span><span class="op" id="4203492">(</span><span class="op" id="4203493">)</span>&nbsp;<span class="op" id="4203495">==</span>&nbsp;<span class="op" id="4203498">-</span><span class="num" id="4203499">1</span>&nbsp;<span class="op" id="4203501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203505"><a href="/crypto/elliptic/elliptic.go.html#4203351">z3</a></span><span class="op" id="4203507">.</span><span class="ident" id="4203508">Add</span><span class="op" id="4203511">(</span><span class="ident" id="4203512"><a href="/crypto/elliptic/elliptic.go.html#4203351">z3</a></span><span class="op" id="4203514">,</span>&nbsp;<span class="ident" id="4203516"><a href="/crypto/elliptic/elliptic.go.html#4202637">curve</a></span><span class="op" id="4203521">.</span><span class="ident" id="4203522">P</span><span class="op" id="4203523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4203526">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203529"><a href="/crypto/elliptic/elliptic.go.html#4203351">z3</a></span><span class="op" id="4203531">.</span><span class="ident" id="4203532">Mod</span><span class="op" id="4203535">(</span><span class="ident" id="4203536"><a href="/crypto/elliptic/elliptic.go.html#4203351">z3</a></span><span class="op" id="4203538">,</span>&nbsp;<span class="ident" id="4203540"><a href="/crypto/elliptic/elliptic.go.html#4202637">curve</a></span><span class="op" id="4203545">.</span><span class="ident" id="4203546">P</span><span class="op" id="4203547">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203551"><a href="/crypto/elliptic/elliptic.go.html#4203157">beta</a></span><span class="op" id="4203555">.</span><span class="ident" id="4203556">Lsh</span><span class="op" id="4203559">(</span><span class="ident" id="4203560"><a href="/crypto/elliptic/elliptic.go.html#4203157">beta</a></span><span class="op" id="4203564">,</span>&nbsp;<span class="num" id="4203566">2</span><span class="op" id="4203567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203570"><a href="/crypto/elliptic/elliptic.go.html#4203157">beta</a></span><span class="op" id="4203574">.</span><span class="ident" id="4203575">Sub</span><span class="op" id="4203578">(</span><span class="ident" id="4203579"><a href="/crypto/elliptic/elliptic.go.html#4203157">beta</a></span><span class="op" id="4203583">,</span>&nbsp;<span class="ident" id="4203585"><a href="/crypto/elliptic/elliptic.go.html#4203188">x3</a></span><span class="op" id="4203587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4203590">if</span>&nbsp;<span class="ident" id="4203593"><a href="/crypto/elliptic/elliptic.go.html#4203157">beta</a></span><span class="op" id="4203597">.</span><span class="ident" id="4203598">Sign</span><span class="op" id="4203602">(</span><span class="op" id="4203603">)</span>&nbsp;<span class="op" id="4203605">==</span>&nbsp;<span class="op" id="4203608">-</span><span class="num" id="4203609">1</span>&nbsp;<span class="op" id="4203611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203615"><a href="/crypto/elliptic/elliptic.go.html#4203157">beta</a></span><span class="op" id="4203619">.</span><span class="ident" id="4203620">Add</span><span class="op" id="4203623">(</span><span class="ident" id="4203624"><a href="/crypto/elliptic/elliptic.go.html#4203157">beta</a></span><span class="op" id="4203628">,</span>&nbsp;<span class="ident" id="4203630"><a href="/crypto/elliptic/elliptic.go.html#4202637">curve</a></span><span class="op" id="4203635">.</span><span class="ident" id="4203636">P</span><span class="op" id="4203637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4203640">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203643">y3</span>&nbsp;<span class="op" id="4203646">:=</span>&nbsp;<span class="ident" id="4203649"><a href="/crypto/elliptic/elliptic.go.html#4202933">alpha</a></span><span class="op" id="4203654">.</span><span class="ident" id="4203655">Mul</span><span class="op" id="4203658">(</span><span class="ident" id="4203659"><a href="/crypto/elliptic/elliptic.go.html#4202933">alpha</a></span><span class="op" id="4203664">,</span>&nbsp;<span class="ident" id="4203666"><a href="/crypto/elliptic/elliptic.go.html#4203157">beta</a></span><span class="op" id="4203670">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203674"><a href="/crypto/elliptic/elliptic.go.html#4202873">gamma</a></span><span class="op" id="4203679">.</span><span class="ident" id="4203680">Mul</span><span class="op" id="4203683">(</span><span class="ident" id="4203684"><a href="/crypto/elliptic/elliptic.go.html#4202873">gamma</a></span><span class="op" id="4203689">,</span>&nbsp;<span class="ident" id="4203691"><a href="/crypto/elliptic/elliptic.go.html#4202873">gamma</a></span><span class="op" id="4203696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203699"><a href="/crypto/elliptic/elliptic.go.html#4202873">gamma</a></span><span class="op" id="4203704">.</span><span class="ident" id="4203705">Lsh</span><span class="op" id="4203708">(</span><span class="ident" id="4203709"><a href="/crypto/elliptic/elliptic.go.html#4202873">gamma</a></span><span class="op" id="4203714">,</span>&nbsp;<span class="num" id="4203716">3</span><span class="op" id="4203717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203720"><a href="/crypto/elliptic/elliptic.go.html#4202873">gamma</a></span><span class="op" id="4203725">.</span><span class="ident" id="4203726">Mod</span><span class="op" id="4203729">(</span><span class="ident" id="4203730"><a href="/crypto/elliptic/elliptic.go.html#4202873">gamma</a></span><span class="op" id="4203735">,</span>&nbsp;<span class="ident" id="4203737"><a href="/crypto/elliptic/elliptic.go.html#4202637">curve</a></span><span class="op" id="4203742">.</span><span class="ident" id="4203743">P</span><span class="op" id="4203744">)</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203748"><a href="/crypto/elliptic/elliptic.go.html#4203643">y3</a></span><span class="op" id="4203750">.</span><span class="ident" id="4203751">Sub</span><span class="op" id="4203754">(</span><span class="ident" id="4203755"><a href="/crypto/elliptic/elliptic.go.html#4203643">y3</a></span><span class="op" id="4203757">,</span>&nbsp;<span class="ident" id="4203759"><a href="/crypto/elliptic/elliptic.go.html#4202873">gamma</a></span><span class="op" id="4203764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4203767">if</span>&nbsp;<span class="ident" id="4203770"><a href="/crypto/elliptic/elliptic.go.html#4203643">y3</a></span><span class="op" id="4203772">.</span><span class="ident" id="4203773">Sign</span><span class="op" id="4203777">(</span><span class="op" id="4203778">)</span>&nbsp;<span class="op" id="4203780">==</span>&nbsp;<span class="op" id="4203783">-</span><span class="num" id="4203784">1</span>&nbsp;<span class="op" id="4203786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203790"><a href="/crypto/elliptic/elliptic.go.html#4203643">y3</a></span><span class="op" id="4203792">.</span><span class="ident" id="4203793">Add</span><span class="op" id="4203796">(</span><span class="ident" id="4203797"><a href="/crypto/elliptic/elliptic.go.html#4203643">y3</a></span><span class="op" id="4203799">,</span>&nbsp;<span class="ident" id="4203801"><a href="/crypto/elliptic/elliptic.go.html#4202637">curve</a></span><span class="op" id="4203806">.</span><span class="ident" id="4203807">P</span><span class="op" id="4203808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4203811">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203814"><a href="/crypto/elliptic/elliptic.go.html#4203643">y3</a></span><span class="op" id="4203816">.</span><span class="ident" id="4203817">Mod</span><span class="op" id="4203820">(</span><span class="ident" id="4203821"><a href="/crypto/elliptic/elliptic.go.html#4203643">y3</a></span><span class="op" id="4203823">,</span>&nbsp;<span class="ident" id="4203825"><a href="/crypto/elliptic/elliptic.go.html#4202637">curve</a></span><span class="op" id="4203830">.</span><span class="ident" id="4203831">P</span><span class="op" id="4203832">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4203836">return</span>&nbsp;<span class="ident" id="4203843"><a href="/crypto/elliptic/elliptic.go.html#4203188">x3</a></span><span class="op" id="4203845">,</span>&nbsp;<span class="ident" id="4203847"><a href="/crypto/elliptic/elliptic.go.html#4203643">y3</a></span><span class="op" id="4203849">,</span>&nbsp;<span class="ident" id="4203851"><a href="/crypto/elliptic/elliptic.go.html#4203351">z3</a></span><br>
<span class="lineno"></span><span class="op" id="4203854">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="keyword" id="4203857">func</span>&nbsp;<span class="op" id="4203862">(</span><span class="ident" id="4203863">curve</span>&nbsp;<span class="op" id="4203869">*</span><span class="ident" id="4203870"><a href="/crypto/elliptic/elliptic.go.html#4198953">CurveParams</a></span><span class="op" id="4203881">)</span>&nbsp;<span class="ident" id="4203883">ScalarMult</span><span class="op" id="4203893">(</span><span class="ident" id="4203894">Bx</span><span class="op" id="4203896">,</span>&nbsp;<span class="ident" id="4203898">By</span>&nbsp;<span class="op" id="4203901">*</span><span class="ident" id="4203902"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4203905">.</span><span class="ident" id="4203906">Int</span><span class="op" id="4203909">,</span>&nbsp;<span class="ident" id="4203911">k</span>&nbsp;<span class="op" id="4203913">[</span><span class="op" id="4203914">]</span><span class="builtintype" id="4203915">byte</span><span class="op" id="4203919">)</span>&nbsp;<span class="op" id="4203921">(</span><span class="op" id="4203922">*</span><span class="ident" id="4203923"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4203926">.</span><span class="ident" id="4203927">Int</span><span class="op" id="4203930">,</span>&nbsp;<span class="op" id="4203932">*</span><span class="ident" id="4203933"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4203936">.</span><span class="ident" id="4203937">Int</span><span class="op" id="4203940">)</span>&nbsp;<span class="op" id="4203942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203945">Bz</span>&nbsp;<span class="op" id="4203948">:=</span>&nbsp;<span class="builtinfunc" id="4203951">new</span><span class="op" id="4203954">(</span><span class="ident" id="4203955"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4203958">.</span><span class="ident" id="4203959">Int</span><span class="op" id="4203962">)</span><span class="op" id="4203963">.</span><span class="ident" id="4203964">SetInt64</span><span class="op" id="4203972">(</span><span class="num" id="4203973">1</span><span class="op" id="4203974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4203977">x</span><span class="op" id="4203978">,</span>&nbsp;<span class="ident" id="4203980">y</span><span class="op" id="4203981">,</span>&nbsp;<span class="ident" id="4203983">z</span>&nbsp;<span class="op" id="4203985">:=</span>&nbsp;<span class="builtinfunc" id="4203988">new</span><span class="op" id="4203991">(</span><span class="ident" id="4203992"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4203995">.</span><span class="ident" id="4203996">Int</span><span class="op" id="4203999">)</span><span class="op" id="4204000">,</span>&nbsp;<span class="builtinfunc" id="4204002">new</span><span class="op" id="4204005">(</span><span class="ident" id="4204006"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4204009">.</span><span class="ident" id="4204010">Int</span><span class="op" id="4204013">)</span><span class="op" id="4204014">,</span>&nbsp;<span class="builtinfunc" id="4204016">new</span><span class="op" id="4204019">(</span><span class="ident" id="4204020"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4204023">.</span><span class="ident" id="4204024">Int</span><span class="op" id="4204027">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4204031">for</span>&nbsp;<span class="ident" id="4204035">_</span><span class="op" id="4204036">,</span>&nbsp;<span class="builtintype" id="4204038">byte</span>&nbsp;<span class="op" id="4204043">:=</span>&nbsp;<span class="keyword" id="4204046">range</span>&nbsp;<span class="ident" id="4204052"><a href="/crypto/elliptic/elliptic.go.html#4203911">k</a></span>&nbsp;<span class="op" id="4204054">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4204058">for</span>&nbsp;<span class="ident" id="4204062">bitNum</span>&nbsp;<span class="op" id="4204069">:=</span>&nbsp;<span class="num" id="4204072">0</span><span class="op" id="4204073">;</span>&nbsp;<span class="ident" id="4204075"><a href="/crypto/elliptic/elliptic.go.html#4204062">bitNum</a></span>&nbsp;<span class="op" id="4204082">&lt;</span>&nbsp;<span class="num" id="4204084">8</span><span class="op" id="4204085">;</span>&nbsp;<span class="ident" id="4204087"><a href="/crypto/elliptic/elliptic.go.html#4204062">bitNum</a></span><span class="op" id="4204093">++</span>&nbsp;<span class="op" id="4204096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4204101"><a href="/crypto/elliptic/elliptic.go.html#4203977">x</a></span><span class="op" id="4204102">,</span>&nbsp;<span class="ident" id="4204104"><a href="/crypto/elliptic/elliptic.go.html#4203980">y</a></span><span class="op" id="4204105">,</span>&nbsp;<span class="ident" id="4204107"><a href="/crypto/elliptic/elliptic.go.html#4203983">z</a></span>&nbsp;<span class="op" id="4204109">=</span>&nbsp;<span class="ident" id="4204111"><a href="/crypto/elliptic/elliptic.go.html#4203863">curve</a></span><span class="op" id="4204116">.</span><span class="ident" id="4204117">doubleJacobian</span><span class="op" id="4204131">(</span><span class="ident" id="4204132"><a href="/crypto/elliptic/elliptic.go.html#4203977">x</a></span><span class="op" id="4204133">,</span>&nbsp;<span class="ident" id="4204135"><a href="/crypto/elliptic/elliptic.go.html#4203980">y</a></span><span class="op" id="4204136">,</span>&nbsp;<span class="ident" id="4204138"><a href="/crypto/elliptic/elliptic.go.html#4203983">z</a></span><span class="op" id="4204139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4204144">if</span>&nbsp;<span class="builtintype" id="4204147"><a href="/crypto/elliptic/elliptic.go.html#4204038">byte</a></span><span class="op" id="4204151">&amp;</span><span class="num" id="4204152">0x80</span>&nbsp;<span class="op" id="4204157">==</span>&nbsp;<span class="num" id="4204160">0x80</span>&nbsp;<span class="op" id="4204165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4204171"><a href="/crypto/elliptic/elliptic.go.html#4203977">x</a></span><span class="op" id="4204172">,</span>&nbsp;<span class="ident" id="4204174"><a href="/crypto/elliptic/elliptic.go.html#4203980">y</a></span><span class="op" id="4204175">,</span>&nbsp;<span class="ident" id="4204177"><a href="/crypto/elliptic/elliptic.go.html#4203983">z</a></span>&nbsp;<span class="op" id="4204179">=</span>&nbsp;<span class="ident" id="4204181"><a href="/crypto/elliptic/elliptic.go.html#4203863">curve</a></span><span class="op" id="4204186">.</span><span class="ident" id="4204187">addJacobian</span><span class="op" id="4204198">(</span><span class="ident" id="4204199"><a href="/crypto/elliptic/elliptic.go.html#4203894">Bx</a></span><span class="op" id="4204201">,</span>&nbsp;<span class="ident" id="4204203"><a href="/crypto/elliptic/elliptic.go.html#4203898">By</a></span><span class="op" id="4204205">,</span>&nbsp;<span class="ident" id="4204207"><a href="/crypto/elliptic/elliptic.go.html#4203945">Bz</a></span><span class="op" id="4204209">,</span>&nbsp;<span class="ident" id="4204211"><a href="/crypto/elliptic/elliptic.go.html#4203977">x</a></span><span class="op" id="4204212">,</span>&nbsp;<span class="ident" id="4204214"><a href="/crypto/elliptic/elliptic.go.html#4203980">y</a></span><span class="op" id="4204215">,</span>&nbsp;<span class="ident" id="4204217"><a href="/crypto/elliptic/elliptic.go.html#4203983">z</a></span><span class="op" id="4204218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4204223">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="4204228"><a href="/crypto/elliptic/elliptic.go.html#4204038">byte</a></span>&nbsp;<span class="op" id="4204233">&lt;&lt;=</span>&nbsp;<span class="num" id="4204237">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4204241">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4204244">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4204248">return</span>&nbsp;<span class="ident" id="4204255"><a href="/crypto/elliptic/elliptic.go.html#4203863">curve</a></span><span class="op" id="4204260">.</span><span class="ident" id="4204261">affineFromJacobian</span><span class="op" id="4204279">(</span><span class="ident" id="4204280"><a href="/crypto/elliptic/elliptic.go.html#4203977">x</a></span><span class="op" id="4204281">,</span>&nbsp;<span class="ident" id="4204283"><a href="/crypto/elliptic/elliptic.go.html#4203980">y</a></span><span class="op" id="4204284">,</span>&nbsp;<span class="ident" id="4204286"><a href="/crypto/elliptic/elliptic.go.html#4203983">z</a></span><span class="op" id="4204287">)</span><br>
<span class="lineno">265</span><span class="op" id="4204289">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4204292">func</span>&nbsp;<span class="op" id="4204297">(</span><span class="ident" id="4204298">curve</span>&nbsp;<span class="op" id="4204304">*</span><span class="ident" id="4204305"><a href="/crypto/elliptic/elliptic.go.html#4198953">CurveParams</a></span><span class="op" id="4204316">)</span>&nbsp;<span class="ident" id="4204318">ScalarBaseMult</span><span class="op" id="4204332">(</span><span class="ident" id="4204333">k</span>&nbsp;<span class="op" id="4204335">[</span><span class="op" id="4204336">]</span><span class="builtintype" id="4204337">byte</span><span class="op" id="4204341">)</span>&nbsp;<span class="op" id="4204343">(</span><span class="op" id="4204344">*</span><span class="ident" id="4204345"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4204348">.</span><span class="ident" id="4204349">Int</span><span class="op" id="4204352">,</span>&nbsp;<span class="op" id="4204354">*</span><span class="ident" id="4204355"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4204358">.</span><span class="ident" id="4204359">Int</span><span class="op" id="4204362">)</span>&nbsp;<span class="op" id="4204364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4204367">return</span>&nbsp;<span class="ident" id="4204374"><a href="/crypto/elliptic/elliptic.go.html#4204298">curve</a></span><span class="op" id="4204379">.</span><span class="ident" id="4204380">ScalarMult</span><span class="op" id="4204390">(</span><span class="ident" id="4204391"><a href="/crypto/elliptic/elliptic.go.html#4204298">curve</a></span><span class="op" id="4204396">.</span><span class="ident" id="4204397">Gx</span><span class="op" id="4204399">,</span>&nbsp;<span class="ident" id="4204401"><a href="/crypto/elliptic/elliptic.go.html#4204298">curve</a></span><span class="op" id="4204406">.</span><span class="ident" id="4204407">Gy</span><span class="op" id="4204409">,</span>&nbsp;<span class="ident" id="4204411"><a href="/crypto/elliptic/elliptic.go.html#4204333">k</a></span><span class="op" id="4204412">)</span><br>
<span class="lineno"></span><span class="op" id="4204414">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="keyword" id="4204417">var</span>&nbsp;<span class="ident" id="4204421">mask</span>&nbsp;<span class="op" id="4204426">=</span>&nbsp;<span class="op" id="4204428">[</span><span class="op" id="4204429">]</span><span class="builtintype" id="4204430">byte</span><span class="op" id="4204434">{</span><span class="num" id="4204435">0xff</span><span class="op" id="4204439">,</span>&nbsp;<span class="num" id="4204441">0x1</span><span class="op" id="4204444">,</span>&nbsp;<span class="num" id="4204446">0x3</span><span class="op" id="4204449">,</span>&nbsp;<span class="num" id="4204451">0x7</span><span class="op" id="4204454">,</span>&nbsp;<span class="num" id="4204456">0xf</span><span class="op" id="4204459">,</span>&nbsp;<span class="num" id="4204461">0x1f</span><span class="op" id="4204465">,</span>&nbsp;<span class="num" id="4204467">0x3f</span><span class="op" id="4204471">,</span>&nbsp;<span class="num" id="4204473">0x7f</span><span class="op" id="4204477">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4204480">//&nbsp;GenerateKey&nbsp;returns&nbsp;a&nbsp;public/private&nbsp;key&nbsp;pair.&nbsp;The&nbsp;private&nbsp;key&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="4204549">//&nbsp;generated&nbsp;using&nbsp;the&nbsp;given&nbsp;reader,&nbsp;which&nbsp;must&nbsp;return&nbsp;random&nbsp;data.</span><br>
<span class="lineno">275</span><span class="keyword" id="4204617">func</span>&nbsp;<span class="ident" id="4204622">GenerateKey</span><span class="op" id="4204633">(</span><span class="ident" id="4204634">curve</span>&nbsp;<span class="ident" id="4204640"><a href="/crypto/elliptic/elliptic.go.html#4198178">Curve</a></span><span class="op" id="4204645">,</span>&nbsp;<span class="ident" id="4204647">rand</span>&nbsp;<span class="ident" id="4204652"><a href="/crypto/elliptic/elliptic.go.html#4198020">io</a></span><span class="op" id="4204654">.</span><span class="ident" id="4204655">Reader</span><span class="op" id="4204661">)</span>&nbsp;<span class="op" id="4204663">(</span><span class="ident" id="4204664">priv</span>&nbsp;<span class="op" id="4204669">[</span><span class="op" id="4204670">]</span><span class="builtintype" id="4204671">byte</span><span class="op" id="4204675">,</span>&nbsp;<span class="ident" id="4204677">x</span><span class="op" id="4204678">,</span>&nbsp;<span class="ident" id="4204680">y</span>&nbsp;<span class="op" id="4204682">*</span><span class="ident" id="4204683"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4204686">.</span><span class="ident" id="4204687">Int</span><span class="op" id="4204690">,</span>&nbsp;<span class="ident" id="4204692">err</span>&nbsp;<span class="builtintype" id="4204696">error</span><span class="op" id="4204701">)</span>&nbsp;<span class="op" id="4204703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4204706">bitSize</span>&nbsp;<span class="op" id="4204714">:=</span>&nbsp;<span class="ident" id="4204717"><a href="/crypto/elliptic/elliptic.go.html#4204634">curve</a></span><span class="op" id="4204722">.</span><span class="ident" id="4204723">Params</span><span class="op" id="4204729">(</span><span class="op" id="4204730">)</span><span class="op" id="4204731">.</span><span class="ident" id="4204732">BitSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4204741">byteLen</span>&nbsp;<span class="op" id="4204749">:=</span>&nbsp;<span class="op" id="4204752">(</span><span class="ident" id="4204753"><a href="/crypto/elliptic/elliptic.go.html#4204706">bitSize</a></span>&nbsp;<span class="op" id="4204761">+</span>&nbsp;<span class="num" id="4204763">7</span><span class="op" id="4204764">)</span>&nbsp;<span class="op" id="4204766">&gt;&gt;</span>&nbsp;<span class="num" id="4204769">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4204772"><a href="/crypto/elliptic/elliptic.go.html#4204664">priv</a></span>&nbsp;<span class="op" id="4204777">=</span>&nbsp;<span class="builtinfunc" id="4204779">make</span><span class="op" id="4204783">(</span><span class="op" id="4204784">[</span><span class="op" id="4204785">]</span><span class="builtintype" id="4204786">byte</span><span class="op" id="4204790">,</span>&nbsp;<span class="ident" id="4204792"><a href="/crypto/elliptic/elliptic.go.html#4204741">byteLen</a></span><span class="op" id="4204799">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4204803">for</span>&nbsp;<span class="ident" id="4204807"><a href="/crypto/elliptic/elliptic.go.html#4204677">x</a></span>&nbsp;<span class="op" id="4204809">==</span>&nbsp;<span class="ident" id="4204812">nil</span>&nbsp;<span class="op" id="4204816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4204820">_</span><span class="op" id="4204821">,</span>&nbsp;<span class="ident" id="4204823"><a href="/crypto/elliptic/elliptic.go.html#4204692">err</a></span>&nbsp;<span class="op" id="4204827">=</span>&nbsp;<span class="ident" id="4204829"><a href="/crypto/elliptic/elliptic.go.html#4198020">io</a></span><span class="op" id="4204831">.</span><span class="ident" id="4204832">ReadFull</span><span class="op" id="4204840">(</span><span class="ident" id="4204841"><a href="/crypto/elliptic/elliptic.go.html#4204647">rand</a></span><span class="op" id="4204845">,</span>&nbsp;<span class="ident" id="4204847"><a href="/crypto/elliptic/elliptic.go.html#4204664">priv</a></span><span class="op" id="4204851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4204855">if</span>&nbsp;<span class="ident" id="4204858"><a href="/crypto/elliptic/elliptic.go.html#4204692">err</a></span>&nbsp;<span class="op" id="4204862">!=</span>&nbsp;<span class="ident" id="4204865">nil</span>&nbsp;<span class="op" id="4204869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4204874">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4204883">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4204887">//&nbsp;We&nbsp;have&nbsp;to&nbsp;mask&nbsp;off&nbsp;any&nbsp;excess&nbsp;bits&nbsp;in&nbsp;the&nbsp;case&nbsp;that&nbsp;the&nbsp;size&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4204961">//&nbsp;underlying&nbsp;field&nbsp;is&nbsp;not&nbsp;a&nbsp;whole&nbsp;number&nbsp;of&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205015"><a href="/crypto/elliptic/elliptic.go.html#4204664">priv</a></span><span class="op" id="4205019">[</span><span class="num" id="4205020">0</span><span class="op" id="4205021">]</span>&nbsp;<span class="op" id="4205023">&amp;=</span>&nbsp;<span class="ident" id="4205026"><a href="/crypto/elliptic/elliptic.go.html#4204421">mask</a></span><span class="op" id="4205030">[</span><span class="ident" id="4205031"><a href="/crypto/elliptic/elliptic.go.html#4204706">bitSize</a></span><span class="op" id="4205038">%</span><span class="num" id="4205039">8</span><span class="op" id="4205040">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4205044">//&nbsp;This&nbsp;is&nbsp;because,&nbsp;in&nbsp;tests,&nbsp;rand&nbsp;will&nbsp;return&nbsp;all&nbsp;zeros&nbsp;and&nbsp;we&nbsp;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4205116">//&nbsp;want&nbsp;to&nbsp;get&nbsp;the&nbsp;point&nbsp;at&nbsp;infinity&nbsp;and&nbsp;loop&nbsp;forever.</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205173"><a href="/crypto/elliptic/elliptic.go.html#4204664">priv</a></span><span class="op" id="4205177">[</span><span class="num" id="4205178">1</span><span class="op" id="4205179">]</span>&nbsp;<span class="op" id="4205181">^=</span>&nbsp;<span class="num" id="4205184">0x42</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205191"><a href="/crypto/elliptic/elliptic.go.html#4204677">x</a></span><span class="op" id="4205192">,</span>&nbsp;<span class="ident" id="4205194"><a href="/crypto/elliptic/elliptic.go.html#4204680">y</a></span>&nbsp;<span class="op" id="4205196">=</span>&nbsp;<span class="ident" id="4205198"><a href="/crypto/elliptic/elliptic.go.html#4204634">curve</a></span><span class="op" id="4205203">.</span><span class="ident" id="4205204">ScalarBaseMult</span><span class="op" id="4205218">(</span><span class="ident" id="4205219"><a href="/crypto/elliptic/elliptic.go.html#4204664">priv</a></span><span class="op" id="4205223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4205226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4205229">return</span><br>
<span class="lineno"></span><span class="op" id="4205236">}</span><br>
<span class="lineno">295</span><br>
<span class="lineno"></span><span class="comment" id="4205239">//&nbsp;Marshal&nbsp;converts&nbsp;a&nbsp;point&nbsp;into&nbsp;the&nbsp;form&nbsp;specified&nbsp;in&nbsp;section&nbsp;4.3.6&nbsp;of&nbsp;ANSI&nbsp;X9.62.</span><br>
<span class="lineno"></span><span class="keyword" id="4205323">func</span>&nbsp;<span class="ident" id="4205328">Marshal</span><span class="op" id="4205335">(</span><span class="ident" id="4205336">curve</span>&nbsp;<span class="ident" id="4205342"><a href="/crypto/elliptic/elliptic.go.html#4198178">Curve</a></span><span class="op" id="4205347">,</span>&nbsp;<span class="ident" id="4205349">x</span><span class="op" id="4205350">,</span>&nbsp;<span class="ident" id="4205352">y</span>&nbsp;<span class="op" id="4205354">*</span><span class="ident" id="4205355"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4205358">.</span><span class="ident" id="4205359">Int</span><span class="op" id="4205362">)</span>&nbsp;<span class="op" id="4205364">[</span><span class="op" id="4205365">]</span><span class="builtintype" id="4205366">byte</span>&nbsp;<span class="op" id="4205371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205374">byteLen</span>&nbsp;<span class="op" id="4205382">:=</span>&nbsp;<span class="op" id="4205385">(</span><span class="ident" id="4205386"><a href="/crypto/elliptic/elliptic.go.html#4205336">curve</a></span><span class="op" id="4205391">.</span><span class="ident" id="4205392">Params</span><span class="op" id="4205398">(</span><span class="op" id="4205399">)</span><span class="op" id="4205400">.</span><span class="ident" id="4205401">BitSize</span>&nbsp;<span class="op" id="4205409">+</span>&nbsp;<span class="num" id="4205411">7</span><span class="op" id="4205412">)</span>&nbsp;<span class="op" id="4205414">&gt;&gt;</span>&nbsp;<span class="num" id="4205417">3</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205421">ret</span>&nbsp;<span class="op" id="4205425">:=</span>&nbsp;<span class="builtinfunc" id="4205428">make</span><span class="op" id="4205432">(</span><span class="op" id="4205433">[</span><span class="op" id="4205434">]</span><span class="builtintype" id="4205435">byte</span><span class="op" id="4205439">,</span>&nbsp;<span class="num" id="4205441">1</span><span class="op" id="4205442">+</span><span class="num" id="4205443">2</span><span class="op" id="4205444">*</span><span class="ident" id="4205445"><a href="/crypto/elliptic/elliptic.go.html#4205374">byteLen</a></span><span class="op" id="4205452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205455"><a href="/crypto/elliptic/elliptic.go.html#4205421">ret</a></span><span class="op" id="4205458">[</span><span class="num" id="4205459">0</span><span class="op" id="4205460">]</span>&nbsp;<span class="op" id="4205462">=</span>&nbsp;<span class="num" id="4205464">4</span>&nbsp;<span class="comment" id="4205466">//&nbsp;uncompressed&nbsp;point</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205490">xBytes</span>&nbsp;<span class="op" id="4205497">:=</span>&nbsp;<span class="ident" id="4205500"><a href="/crypto/elliptic/elliptic.go.html#4205349">x</a></span><span class="op" id="4205501">.</span><span class="ident" id="4205502">Bytes</span><span class="op" id="4205507">(</span><span class="op" id="4205508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4205511">copy</span><span class="op" id="4205515">(</span><span class="ident" id="4205516"><a href="/crypto/elliptic/elliptic.go.html#4205421">ret</a></span><span class="op" id="4205519">[</span><span class="num" id="4205520">1</span><span class="op" id="4205521">+</span><span class="ident" id="4205522"><a href="/crypto/elliptic/elliptic.go.html#4205374">byteLen</a></span><span class="op" id="4205529">-</span><span class="builtinfunc" id="4205530">len</span><span class="op" id="4205533">(</span><span class="ident" id="4205534"><a href="/crypto/elliptic/elliptic.go.html#4205490">xBytes</a></span><span class="op" id="4205540">)</span><span class="op" id="4205541">:</span><span class="op" id="4205542">]</span><span class="op" id="4205543">,</span>&nbsp;<span class="ident" id="4205545"><a href="/crypto/elliptic/elliptic.go.html#4205490">xBytes</a></span><span class="op" id="4205551">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205554">yBytes</span>&nbsp;<span class="op" id="4205561">:=</span>&nbsp;<span class="ident" id="4205564"><a href="/crypto/elliptic/elliptic.go.html#4205352">y</a></span><span class="op" id="4205565">.</span><span class="ident" id="4205566">Bytes</span><span class="op" id="4205571">(</span><span class="op" id="4205572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4205575">copy</span><span class="op" id="4205579">(</span><span class="ident" id="4205580"><a href="/crypto/elliptic/elliptic.go.html#4205421">ret</a></span><span class="op" id="4205583">[</span><span class="num" id="4205584">1</span><span class="op" id="4205585">+</span><span class="num" id="4205586">2</span><span class="op" id="4205587">*</span><span class="ident" id="4205588"><a href="/crypto/elliptic/elliptic.go.html#4205374">byteLen</a></span><span class="op" id="4205595">-</span><span class="builtinfunc" id="4205596">len</span><span class="op" id="4205599">(</span><span class="ident" id="4205600"><a href="/crypto/elliptic/elliptic.go.html#4205554">yBytes</a></span><span class="op" id="4205606">)</span><span class="op" id="4205607">:</span><span class="op" id="4205608">]</span><span class="op" id="4205609">,</span>&nbsp;<span class="ident" id="4205611"><a href="/crypto/elliptic/elliptic.go.html#4205554">yBytes</a></span><span class="op" id="4205617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4205620">return</span>&nbsp;<span class="ident" id="4205627"><a href="/crypto/elliptic/elliptic.go.html#4205421">ret</a></span><br>
<span class="lineno"></span><span class="op" id="4205631">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="4205634">//&nbsp;Unmarshal&nbsp;converts&nbsp;a&nbsp;point,&nbsp;serialized&nbsp;by&nbsp;Marshal,&nbsp;into&nbsp;an&nbsp;x,&nbsp;y&nbsp;pair.&nbsp;On&nbsp;error,&nbsp;x&nbsp;=&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="4205726">func</span>&nbsp;<span class="ident" id="4205731">Unmarshal</span><span class="op" id="4205740">(</span><span class="ident" id="4205741">curve</span>&nbsp;<span class="ident" id="4205747"><a href="/crypto/elliptic/elliptic.go.html#4198178">Curve</a></span><span class="op" id="4205752">,</span>&nbsp;<span class="ident" id="4205754">data</span>&nbsp;<span class="op" id="4205759">[</span><span class="op" id="4205760">]</span><span class="builtintype" id="4205761">byte</span><span class="op" id="4205765">)</span>&nbsp;<span class="op" id="4205767">(</span><span class="ident" id="4205768">x</span><span class="op" id="4205769">,</span>&nbsp;<span class="ident" id="4205771">y</span>&nbsp;<span class="op" id="4205773">*</span><span class="ident" id="4205774"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4205777">.</span><span class="ident" id="4205778">Int</span><span class="op" id="4205781">)</span>&nbsp;<span class="op" id="4205783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205786">byteLen</span>&nbsp;<span class="op" id="4205794">:=</span>&nbsp;<span class="op" id="4205797">(</span><span class="ident" id="4205798"><a href="/crypto/elliptic/elliptic.go.html#4205741">curve</a></span><span class="op" id="4205803">.</span><span class="ident" id="4205804">Params</span><span class="op" id="4205810">(</span><span class="op" id="4205811">)</span><span class="op" id="4205812">.</span><span class="ident" id="4205813">BitSize</span>&nbsp;<span class="op" id="4205821">+</span>&nbsp;<span class="num" id="4205823">7</span><span class="op" id="4205824">)</span>&nbsp;<span class="op" id="4205826">&gt;&gt;</span>&nbsp;<span class="num" id="4205829">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4205832">if</span>&nbsp;<span class="builtinfunc" id="4205835">len</span><span class="op" id="4205838">(</span><span class="ident" id="4205839"><a href="/crypto/elliptic/elliptic.go.html#4205754">data</a></span><span class="op" id="4205843">)</span>&nbsp;<span class="op" id="4205845">!=</span>&nbsp;<span class="num" id="4205848">1</span><span class="op" id="4205849">+</span><span class="num" id="4205850">2</span><span class="op" id="4205851">*</span><span class="ident" id="4205852"><a href="/crypto/elliptic/elliptic.go.html#4205786">byteLen</a></span>&nbsp;<span class="op" id="4205860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4205864">return</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4205872">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4205875">if</span>&nbsp;<span class="ident" id="4205878"><a href="/crypto/elliptic/elliptic.go.html#4205754">data</a></span><span class="op" id="4205882">[</span><span class="num" id="4205883">0</span><span class="op" id="4205884">]</span>&nbsp;<span class="op" id="4205886">!=</span>&nbsp;<span class="num" id="4205889">4</span>&nbsp;<span class="op" id="4205891">{</span>&nbsp;<span class="comment" id="4205893">//&nbsp;uncompressed&nbsp;form</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4205916">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4205924">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205927"><a href="/crypto/elliptic/elliptic.go.html#4205768">x</a></span>&nbsp;<span class="op" id="4205929">=</span>&nbsp;<span class="builtinfunc" id="4205931">new</span><span class="op" id="4205934">(</span><span class="ident" id="4205935"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4205938">.</span><span class="ident" id="4205939">Int</span><span class="op" id="4205942">)</span><span class="op" id="4205943">.</span><span class="ident" id="4205944">SetBytes</span><span class="op" id="4205952">(</span><span class="ident" id="4205953"><a href="/crypto/elliptic/elliptic.go.html#4205754">data</a></span><span class="op" id="4205957">[</span><span class="num" id="4205958">1</span>&nbsp;<span class="op" id="4205960">:</span>&nbsp;<span class="num" id="4205962">1</span><span class="op" id="4205963">+</span><span class="ident" id="4205964"><a href="/crypto/elliptic/elliptic.go.html#4205786">byteLen</a></span><span class="op" id="4205971">]</span><span class="op" id="4205972">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205975"><a href="/crypto/elliptic/elliptic.go.html#4205771">y</a></span>&nbsp;<span class="op" id="4205977">=</span>&nbsp;<span class="builtinfunc" id="4205979">new</span><span class="op" id="4205982">(</span><span class="ident" id="4205983"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4205986">.</span><span class="ident" id="4205987">Int</span><span class="op" id="4205990">)</span><span class="op" id="4205991">.</span><span class="ident" id="4205992">SetBytes</span><span class="op" id="4206000">(</span><span class="ident" id="4206001"><a href="/crypto/elliptic/elliptic.go.html#4205754">data</a></span><span class="op" id="4206005">[</span><span class="num" id="4206006">1</span><span class="op" id="4206007">+</span><span class="ident" id="4206008"><a href="/crypto/elliptic/elliptic.go.html#4205786">byteLen</a></span><span class="op" id="4206015">:</span><span class="op" id="4206016">]</span><span class="op" id="4206017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4206020">return</span><br>
<span class="lineno"></span><span class="op" id="4206027">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4206030">var</span>&nbsp;<span class="ident" id="4206034">initonce</span>&nbsp;<span class="ident" id="4206043"><a href="/crypto/elliptic/elliptic.go.html#4198038">sync</a></span><span class="op" id="4206047">.</span><span class="ident" id="4206048">Once</span><br>
<span class="lineno">325</span><span class="keyword" id="4206053">var</span>&nbsp;<span class="ident" id="4206057">p384</span>&nbsp;<span class="op" id="4206062">*</span><span class="ident" id="4206063"><a href="/crypto/elliptic/elliptic.go.html#4198953">CurveParams</a></span><br>
<span class="lineno"></span><span class="keyword" id="4206075">var</span>&nbsp;<span class="ident" id="4206079">p521</span>&nbsp;<span class="op" id="4206084">*</span><span class="ident" id="4206085"><a href="/crypto/elliptic/elliptic.go.html#4198953">CurveParams</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4206098">func</span>&nbsp;<span class="ident" id="4206103">initAll</span><span class="op" id="4206110">(</span><span class="op" id="4206111">)</span>&nbsp;<span class="op" id="4206113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206116"><a href="/crypto/elliptic/p224.go.html#4208920">initP224</a></span><span class="op" id="4206124">(</span><span class="op" id="4206125">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206128"><a href="/crypto/elliptic/p256.go.html#4229673">initP256</a></span><span class="op" id="4206136">(</span><span class="op" id="4206137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206140"><a href="/crypto/elliptic/elliptic.go.html#4206171">initP384</a></span><span class="op" id="4206148">(</span><span class="op" id="4206149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206152"><a href="/crypto/elliptic/elliptic.go.html#4207013">initP521</a></span><span class="op" id="4206160">(</span><span class="op" id="4206161">)</span><br>
<span class="lineno"></span><span class="op" id="4206163">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="keyword" id="4206166">func</span>&nbsp;<span class="ident" id="4206171">initP384</span><span class="op" id="4206179">(</span><span class="op" id="4206180">)</span>&nbsp;<span class="op" id="4206182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4206185">//&nbsp;See&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206219"><a href="/crypto/elliptic/elliptic.go.html#4206057">p384</a></span>&nbsp;<span class="op" id="4206224">=</span>&nbsp;<span class="builtinfunc" id="4206226">new</span><span class="op" id="4206229">(</span><span class="ident" id="4206230"><a href="/crypto/elliptic/elliptic.go.html#4198953">CurveParams</a></span><span class="op" id="4206241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206244"><a href="/crypto/elliptic/elliptic.go.html#4206057">p384</a></span><span class="op" id="4206248">.</span><span class="ident" id="4206249">P</span><span class="op" id="4206250">,</span>&nbsp;<span class="ident" id="4206252">_</span>&nbsp;<span class="op" id="4206254">=</span>&nbsp;<span class="builtinfunc" id="4206256">new</span><span class="op" id="4206259">(</span><span class="ident" id="4206260"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4206263">.</span><span class="ident" id="4206264">Int</span><span class="op" id="4206267">)</span><span class="op" id="4206268">.</span><span class="ident" id="4206269">SetString</span><span class="op" id="4206278">(</span><span class="string" id="4206279">&#34;39402006196394479212279040100143613805079739270465446667948293404245721771496870329047266088258938001861606973112319&#34;</span><span class="op" id="4206397">,</span>&nbsp;<span class="num" id="4206399">10</span><span class="op" id="4206401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206404"><a href="/crypto/elliptic/elliptic.go.html#4206057">p384</a></span><span class="op" id="4206408">.</span><span class="ident" id="4206409">N</span><span class="op" id="4206410">,</span>&nbsp;<span class="ident" id="4206412">_</span>&nbsp;<span class="op" id="4206414">=</span>&nbsp;<span class="builtinfunc" id="4206416">new</span><span class="op" id="4206419">(</span><span class="ident" id="4206420"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4206423">.</span><span class="ident" id="4206424">Int</span><span class="op" id="4206427">)</span><span class="op" id="4206428">.</span><span class="ident" id="4206429">SetString</span><span class="op" id="4206438">(</span><span class="string" id="4206439">&#34;39402006196394479212279040100143613805079739270465446667946905279627659399113263569398956308152294913554433653942643&#34;</span><span class="op" id="4206557">,</span>&nbsp;<span class="num" id="4206559">10</span><span class="op" id="4206561">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206564"><a href="/crypto/elliptic/elliptic.go.html#4206057">p384</a></span><span class="op" id="4206568">.</span><span class="ident" id="4206569">B</span><span class="op" id="4206570">,</span>&nbsp;<span class="ident" id="4206572">_</span>&nbsp;<span class="op" id="4206574">=</span>&nbsp;<span class="builtinfunc" id="4206576">new</span><span class="op" id="4206579">(</span><span class="ident" id="4206580"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4206583">.</span><span class="ident" id="4206584">Int</span><span class="op" id="4206587">)</span><span class="op" id="4206588">.</span><span class="ident" id="4206589">SetString</span><span class="op" id="4206598">(</span><span class="string" id="4206599">&#34;b3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef&#34;</span><span class="op" id="4206697">,</span>&nbsp;<span class="num" id="4206699">16</span><span class="op" id="4206701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206704"><a href="/crypto/elliptic/elliptic.go.html#4206057">p384</a></span><span class="op" id="4206708">.</span><span class="ident" id="4206709">Gx</span><span class="op" id="4206711">,</span>&nbsp;<span class="ident" id="4206713">_</span>&nbsp;<span class="op" id="4206715">=</span>&nbsp;<span class="builtinfunc" id="4206717">new</span><span class="op" id="4206720">(</span><span class="ident" id="4206721"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4206724">.</span><span class="ident" id="4206725">Int</span><span class="op" id="4206728">)</span><span class="op" id="4206729">.</span><span class="ident" id="4206730">SetString</span><span class="op" id="4206739">(</span><span class="string" id="4206740">&#34;aa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7&#34;</span><span class="op" id="4206838">,</span>&nbsp;<span class="num" id="4206840">16</span><span class="op" id="4206842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206845"><a href="/crypto/elliptic/elliptic.go.html#4206057">p384</a></span><span class="op" id="4206849">.</span><span class="ident" id="4206850">Gy</span><span class="op" id="4206852">,</span>&nbsp;<span class="ident" id="4206854">_</span>&nbsp;<span class="op" id="4206856">=</span>&nbsp;<span class="builtinfunc" id="4206858">new</span><span class="op" id="4206861">(</span><span class="ident" id="4206862"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4206865">.</span><span class="ident" id="4206866">Int</span><span class="op" id="4206869">)</span><span class="op" id="4206870">.</span><span class="ident" id="4206871">SetString</span><span class="op" id="4206880">(</span><span class="string" id="4206881">&#34;3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f&#34;</span><span class="op" id="4206979">,</span>&nbsp;<span class="num" id="4206981">16</span><span class="op" id="4206983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206986"><a href="/crypto/elliptic/elliptic.go.html#4206057">p384</a></span><span class="op" id="4206990">.</span><span class="ident" id="4206991">BitSize</span>&nbsp;<span class="op" id="4206999">=</span>&nbsp;<span class="num" id="4207001">384</span><br>
<span class="lineno"></span><span class="op" id="4207005">}</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span><span class="keyword" id="4207008">func</span>&nbsp;<span class="ident" id="4207013">initP521</span><span class="op" id="4207021">(</span><span class="op" id="4207022">)</span>&nbsp;<span class="op" id="4207024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4207027">//&nbsp;See&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4207061"><a href="/crypto/elliptic/elliptic.go.html#4206079">p521</a></span>&nbsp;<span class="op" id="4207066">=</span>&nbsp;<span class="builtinfunc" id="4207068">new</span><span class="op" id="4207071">(</span><span class="ident" id="4207072"><a href="/crypto/elliptic/elliptic.go.html#4198953">CurveParams</a></span><span class="op" id="4207083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4207086"><a href="/crypto/elliptic/elliptic.go.html#4206079">p521</a></span><span class="op" id="4207090">.</span><span class="ident" id="4207091">P</span><span class="op" id="4207092">,</span>&nbsp;<span class="ident" id="4207094">_</span>&nbsp;<span class="op" id="4207096">=</span>&nbsp;<span class="builtinfunc" id="4207098">new</span><span class="op" id="4207101">(</span><span class="ident" id="4207102"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4207105">.</span><span class="ident" id="4207106">Int</span><span class="op" id="4207109">)</span><span class="op" id="4207110">.</span><span class="ident" id="4207111">SetString</span><span class="op" id="4207120">(</span><span class="string" id="4207121">&#34;6864797660130609714981900799081393217269435300143305409394463459185543183397656052122559640661454554977296311391480858037121987999716643812574028291115057151&#34;</span><span class="op" id="4207280">,</span>&nbsp;<span class="num" id="4207282">10</span><span class="op" id="4207284">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4207287"><a href="/crypto/elliptic/elliptic.go.html#4206079">p521</a></span><span class="op" id="4207291">.</span><span class="ident" id="4207292">N</span><span class="op" id="4207293">,</span>&nbsp;<span class="ident" id="4207295">_</span>&nbsp;<span class="op" id="4207297">=</span>&nbsp;<span class="builtinfunc" id="4207299">new</span><span class="op" id="4207302">(</span><span class="ident" id="4207303"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4207306">.</span><span class="ident" id="4207307">Int</span><span class="op" id="4207310">)</span><span class="op" id="4207311">.</span><span class="ident" id="4207312">SetString</span><span class="op" id="4207321">(</span><span class="string" id="4207322">&#34;6864797660130609714981900799081393217269435300143305409394463459185543183397655394245057746333217197532963996371363321113864768612440380340372808892707005449&#34;</span><span class="op" id="4207481">,</span>&nbsp;<span class="num" id="4207483">10</span><span class="op" id="4207485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4207488"><a href="/crypto/elliptic/elliptic.go.html#4206079">p521</a></span><span class="op" id="4207492">.</span><span class="ident" id="4207493">B</span><span class="op" id="4207494">,</span>&nbsp;<span class="ident" id="4207496">_</span>&nbsp;<span class="op" id="4207498">=</span>&nbsp;<span class="builtinfunc" id="4207500">new</span><span class="op" id="4207503">(</span><span class="ident" id="4207504"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4207507">.</span><span class="ident" id="4207508">Int</span><span class="op" id="4207511">)</span><span class="op" id="4207512">.</span><span class="ident" id="4207513">SetString</span><span class="op" id="4207522">(</span><span class="string" id="4207523">&#34;051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00&#34;</span><span class="op" id="4207656">,</span>&nbsp;<span class="num" id="4207658">16</span><span class="op" id="4207660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4207663"><a href="/crypto/elliptic/elliptic.go.html#4206079">p521</a></span><span class="op" id="4207667">.</span><span class="ident" id="4207668">Gx</span><span class="op" id="4207670">,</span>&nbsp;<span class="ident" id="4207672">_</span>&nbsp;<span class="op" id="4207674">=</span>&nbsp;<span class="builtinfunc" id="4207676">new</span><span class="op" id="4207679">(</span><span class="ident" id="4207680"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4207683">.</span><span class="ident" id="4207684">Int</span><span class="op" id="4207687">)</span><span class="op" id="4207688">.</span><span class="ident" id="4207689">SetString</span><span class="op" id="4207698">(</span><span class="string" id="4207699">&#34;c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66&#34;</span><span class="op" id="4207831">,</span>&nbsp;<span class="num" id="4207833">16</span><span class="op" id="4207835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4207838"><a href="/crypto/elliptic/elliptic.go.html#4206079">p521</a></span><span class="op" id="4207842">.</span><span class="ident" id="4207843">Gy</span><span class="op" id="4207845">,</span>&nbsp;<span class="ident" id="4207847">_</span>&nbsp;<span class="op" id="4207849">=</span>&nbsp;<span class="builtinfunc" id="4207851">new</span><span class="op" id="4207854">(</span><span class="ident" id="4207855"><a href="/crypto/elliptic/elliptic.go.html#4198026">big</a></span><span class="op" id="4207858">.</span><span class="ident" id="4207859">Int</span><span class="op" id="4207862">)</span><span class="op" id="4207863">.</span><span class="ident" id="4207864">SetString</span><span class="op" id="4207873">(</span><span class="string" id="4207874">&#34;11839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650&#34;</span><span class="op" id="4208007">,</span>&nbsp;<span class="num" id="4208009">16</span><span class="op" id="4208011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4208014"><a href="/crypto/elliptic/elliptic.go.html#4206079">p521</a></span><span class="op" id="4208018">.</span><span class="ident" id="4208019">BitSize</span>&nbsp;<span class="op" id="4208027">=</span>&nbsp;<span class="num" id="4208029">521</span><br>
<span class="lineno">355</span><span class="op" id="4208033">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4208036">//&nbsp;P256&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-256&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.3)</span><br>
<span class="lineno"></span><span class="keyword" id="4208115">func</span>&nbsp;<span class="ident" id="4208120">P256</span><span class="op" id="4208124">(</span><span class="op" id="4208125">)</span>&nbsp;<span class="ident" id="4208127"><a href="/crypto/elliptic/elliptic.go.html#4198178">Curve</a></span>&nbsp;<span class="op" id="4208133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4208136"><a href="/crypto/elliptic/elliptic.go.html#4206034">initonce</a></span><span class="op" id="4208144">.</span><span class="ident" id="4208145">Do</span><span class="op" id="4208147">(</span><span class="ident" id="4208148"><a href="/crypto/elliptic/elliptic.go.html#4206103">initAll</a></span><span class="op" id="4208155">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4208158">return</span>&nbsp;<span class="ident" id="4208165"><a href="/crypto/elliptic/p256.go.html#4229540">p256</a></span><br>
<span class="lineno"></span><span class="op" id="4208170">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4208173">//&nbsp;P384&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-384&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.4)</span><br>
<span class="lineno"></span><span class="keyword" id="4208252">func</span>&nbsp;<span class="ident" id="4208257">P384</span><span class="op" id="4208261">(</span><span class="op" id="4208262">)</span>&nbsp;<span class="ident" id="4208264"><a href="/crypto/elliptic/elliptic.go.html#4198178">Curve</a></span>&nbsp;<span class="op" id="4208270">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4208273"><a href="/crypto/elliptic/elliptic.go.html#4206034">initonce</a></span><span class="op" id="4208281">.</span><span class="ident" id="4208282">Do</span><span class="op" id="4208284">(</span><span class="ident" id="4208285"><a href="/crypto/elliptic/elliptic.go.html#4206103">initAll</a></span><span class="op" id="4208292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4208295">return</span>&nbsp;<span class="ident" id="4208302"><a href="/crypto/elliptic/elliptic.go.html#4206057">p384</a></span><br>
<span class="lineno"></span><span class="op" id="4208307">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4208310">//&nbsp;P521&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-521&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.5)</span><br>
<span class="lineno">370</span><span class="keyword" id="4208389">func</span>&nbsp;<span class="ident" id="4208394">P521</span><span class="op" id="4208398">(</span><span class="op" id="4208399">)</span>&nbsp;<span class="ident" id="4208401"><a href="/crypto/elliptic/elliptic.go.html#4198178">Curve</a></span>&nbsp;<span class="op" id="4208407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4208410"><a href="/crypto/elliptic/elliptic.go.html#4206034">initonce</a></span><span class="op" id="4208418">.</span><span class="ident" id="4208419">Do</span><span class="op" id="4208421">(</span><span class="ident" id="4208422"><a href="/crypto/elliptic/elliptic.go.html#4206103">initAll</a></span><span class="op" id="4208429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4208432">return</span>&nbsp;<span class="ident" id="4208439"><a href="/crypto/elliptic/elliptic.go.html#4206079">p521</a></span><br>
<span class="lineno"></span><span class="op" id="4208444">}</span>
</div>
</body>
</html>
