<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>testing/iotest</h2>
<ul>
<li><a href="/gostd/testing/iotest/logger.go.html">logger.go</a></li>
<li><a href="/gostd/testing/iotest/reader.go.html" class="current">reader.go</a></li>
<li><a href="/gostd/testing/iotest/writer.go.html">writer.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5962028">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5962083">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5962137">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5962188">//&nbsp;Package&nbsp;iotest&nbsp;implements&nbsp;Readers&nbsp;and&nbsp;Writers&nbsp;useful&nbsp;mainly&nbsp;for&nbsp;testing.</span><br>
<span class="lineno"></span><span class="keyword" id="5962264">package</span>&nbsp;<span class="ident" id="5962272">iotest</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5962280">import</span>&nbsp;<span class="op" id="5962287">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5962290">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5962300">&#34;io&#34;</span><br>
<span class="lineno"></span><span class="op" id="5962305">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5962308">//&nbsp;OneByteReader&nbsp;returns&nbsp;a&nbsp;Reader&nbsp;that&nbsp;implements</span><br>
<span class="lineno"></span><span class="comment" id="5962358">//&nbsp;each&nbsp;non-empty&nbsp;Read&nbsp;by&nbsp;reading&nbsp;one&nbsp;byte&nbsp;from&nbsp;r.</span><br>
<span class="lineno">15</span><span class="keyword" id="5962409">func</span>&nbsp;<span class="ident" id="5962414">OneByteReader</span><span class="op" id="5962427">(</span><span class="ident" id="5962428">r</span>&nbsp;<span class="ident" id="5962430">io</span><span class="op" id="5962432">.</span><span class="ident" id="5962433">Reader</span><span class="op" id="5962439">)</span>&nbsp;<span class="ident" id="5962441">io</span><span class="op" id="5962443">.</span><span class="ident" id="5962444">Reader</span>&nbsp;<span class="op" id="5962451">{</span>&nbsp;<span class="keyword" id="5962453">return</span>&nbsp;<span class="op" id="5962460">&amp;</span><span class="ident" id="5962461">oneByteReader</span><span class="op" id="5962474">{</span><span class="ident" id="5962475">r</span><span class="op" id="5962476">}</span>&nbsp;<span class="op" id="5962478">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5962481">type</span>&nbsp;<span class="ident" id="5962486">oneByteReader</span>&nbsp;<span class="keyword" id="5962500">struct</span>&nbsp;<span class="op" id="5962507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5962510">r</span>&nbsp;<span class="ident" id="5962512">io</span><span class="op" id="5962514">.</span><span class="ident" id="5962515">Reader</span><br>
<span class="lineno"></span><span class="op" id="5962522">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="5962525">func</span>&nbsp;<span class="op" id="5962530">(</span><span class="ident" id="5962531">r</span>&nbsp;<span class="op" id="5962533">*</span><span class="ident" id="5962534">oneByteReader</span><span class="op" id="5962547">)</span>&nbsp;<span class="ident" id="5962549">Read</span><span class="op" id="5962553">(</span><span class="ident" id="5962554">p</span>&nbsp;<span class="op" id="5962556">[</span><span class="op" id="5962557">]</span><span class="builtintype" id="5962558">byte</span><span class="op" id="5962562">)</span>&nbsp;<span class="op" id="5962564">(</span><span class="builtintype" id="5962565">int</span><span class="op" id="5962568">,</span>&nbsp;<span class="builtintype" id="5962570">error</span><span class="op" id="5962575">)</span>&nbsp;<span class="op" id="5962577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5962580">if</span>&nbsp;<span class="builtinfunc" id="5962583">len</span><span class="op" id="5962586">(</span><span class="ident" id="5962587">p</span><span class="op" id="5962588">)</span>&nbsp;<span class="op" id="5962590">==</span>&nbsp;<span class="num" id="5962593">0</span>&nbsp;<span class="op" id="5962595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5962599">return</span>&nbsp;<span class="num" id="5962606">0</span><span class="op" id="5962607">,</span>&nbsp;<span class="builtintype" id="5962609">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5962614">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5962617">return</span>&nbsp;<span class="ident" id="5962624">r</span><span class="op" id="5962625">.</span><span class="ident" id="5962626">r</span><span class="op" id="5962627">.</span><span class="ident" id="5962628">Read</span><span class="op" id="5962632">(</span><span class="ident" id="5962633">p</span><span class="op" id="5962634">[</span><span class="num" id="5962635">0</span><span class="op" id="5962636">:</span><span class="num" id="5962637">1</span><span class="op" id="5962638">]</span><span class="op" id="5962639">)</span><br>
<span class="lineno"></span><span class="op" id="5962641">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5962644">//&nbsp;HalfReader&nbsp;returns&nbsp;a&nbsp;Reader&nbsp;that&nbsp;implements&nbsp;Read</span><br>
<span class="lineno"></span><span class="comment" id="5962696">//&nbsp;by&nbsp;reading&nbsp;half&nbsp;as&nbsp;many&nbsp;requested&nbsp;bytes&nbsp;from&nbsp;r.</span><br>
<span class="lineno">30</span><span class="keyword" id="5962747">func</span>&nbsp;<span class="ident" id="5962752">HalfReader</span><span class="op" id="5962762">(</span><span class="ident" id="5962763">r</span>&nbsp;<span class="ident" id="5962765">io</span><span class="op" id="5962767">.</span><span class="ident" id="5962768">Reader</span><span class="op" id="5962774">)</span>&nbsp;<span class="ident" id="5962776">io</span><span class="op" id="5962778">.</span><span class="ident" id="5962779">Reader</span>&nbsp;<span class="op" id="5962786">{</span>&nbsp;<span class="keyword" id="5962788">return</span>&nbsp;<span class="op" id="5962795">&amp;</span><span class="ident" id="5962796">halfReader</span><span class="op" id="5962806">{</span><span class="ident" id="5962807">r</span><span class="op" id="5962808">}</span>&nbsp;<span class="op" id="5962810">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5962813">type</span>&nbsp;<span class="ident" id="5962818">halfReader</span>&nbsp;<span class="keyword" id="5962829">struct</span>&nbsp;<span class="op" id="5962836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5962839">r</span>&nbsp;<span class="ident" id="5962841">io</span><span class="op" id="5962843">.</span><span class="ident" id="5962844">Reader</span><br>
<span class="lineno"></span><span class="op" id="5962851">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="5962854">func</span>&nbsp;<span class="op" id="5962859">(</span><span class="ident" id="5962860">r</span>&nbsp;<span class="op" id="5962862">*</span><span class="ident" id="5962863">halfReader</span><span class="op" id="5962873">)</span>&nbsp;<span class="ident" id="5962875">Read</span><span class="op" id="5962879">(</span><span class="ident" id="5962880">p</span>&nbsp;<span class="op" id="5962882">[</span><span class="op" id="5962883">]</span><span class="builtintype" id="5962884">byte</span><span class="op" id="5962888">)</span>&nbsp;<span class="op" id="5962890">(</span><span class="builtintype" id="5962891">int</span><span class="op" id="5962894">,</span>&nbsp;<span class="builtintype" id="5962896">error</span><span class="op" id="5962901">)</span>&nbsp;<span class="op" id="5962903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5962906">return</span>&nbsp;<span class="ident" id="5962913">r</span><span class="op" id="5962914">.</span><span class="ident" id="5962915">r</span><span class="op" id="5962916">.</span><span class="ident" id="5962917">Read</span><span class="op" id="5962921">(</span><span class="ident" id="5962922">p</span><span class="op" id="5962923">[</span><span class="num" id="5962924">0</span>&nbsp;<span class="op" id="5962926">:</span>&nbsp;<span class="op" id="5962928">(</span><span class="builtinfunc" id="5962929">len</span><span class="op" id="5962932">(</span><span class="ident" id="5962933">p</span><span class="op" id="5962934">)</span><span class="op" id="5962935">+</span><span class="num" id="5962936">1</span><span class="op" id="5962937">)</span><span class="op" id="5962938">/</span><span class="num" id="5962939">2</span><span class="op" id="5962940">]</span><span class="op" id="5962941">)</span><br>
<span class="lineno"></span><span class="op" id="5962943">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="5962946">//&nbsp;DataErrReader&nbsp;changes&nbsp;the&nbsp;way&nbsp;errors&nbsp;are&nbsp;handled&nbsp;by&nbsp;a&nbsp;Reader.&nbsp;Normally,&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="5963023">//&nbsp;Reader&nbsp;returns&nbsp;an&nbsp;error&nbsp;(typically&nbsp;EOF)&nbsp;from&nbsp;the&nbsp;first&nbsp;Read&nbsp;call&nbsp;after&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5963101">//&nbsp;last&nbsp;piece&nbsp;of&nbsp;data&nbsp;is&nbsp;read.&nbsp;DataErrReader&nbsp;wraps&nbsp;a&nbsp;Reader&nbsp;and&nbsp;changes&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="5963177">//&nbsp;behavior&nbsp;so&nbsp;the&nbsp;final&nbsp;error&nbsp;is&nbsp;returned&nbsp;along&nbsp;with&nbsp;the&nbsp;final&nbsp;data,&nbsp;instead</span><br>
<span class="lineno"></span><span class="comment" id="5963255">//&nbsp;of&nbsp;in&nbsp;the&nbsp;first&nbsp;call&nbsp;after&nbsp;the&nbsp;final&nbsp;data.</span><br>
<span class="lineno">45</span><span class="keyword" id="5963301">func</span>&nbsp;<span class="ident" id="5963306">DataErrReader</span><span class="op" id="5963319">(</span><span class="ident" id="5963320">r</span>&nbsp;<span class="ident" id="5963322">io</span><span class="op" id="5963324">.</span><span class="ident" id="5963325">Reader</span><span class="op" id="5963331">)</span>&nbsp;<span class="ident" id="5963333">io</span><span class="op" id="5963335">.</span><span class="ident" id="5963336">Reader</span>&nbsp;<span class="op" id="5963343">{</span>&nbsp;<span class="keyword" id="5963345">return</span>&nbsp;<span class="op" id="5963352">&amp;</span><span class="ident" id="5963353">dataErrReader</span><span class="op" id="5963366">{</span><span class="ident" id="5963367">r</span><span class="op" id="5963368">,</span>&nbsp;<span class="builtintype" id="5963370">nil</span><span class="op" id="5963373">,</span>&nbsp;<span class="builtinfunc" id="5963375">make</span><span class="op" id="5963379">(</span><span class="op" id="5963380">[</span><span class="op" id="5963381">]</span><span class="builtintype" id="5963382">byte</span><span class="op" id="5963386">,</span>&nbsp;<span class="num" id="5963388">1024</span><span class="op" id="5963392">)</span><span class="op" id="5963393">}</span>&nbsp;<span class="op" id="5963395">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5963398">type</span>&nbsp;<span class="ident" id="5963403">dataErrReader</span>&nbsp;<span class="keyword" id="5963417">struct</span>&nbsp;<span class="op" id="5963424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5963427">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5963434">io</span><span class="op" id="5963436">.</span><span class="ident" id="5963437">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5963445">unread</span>&nbsp;<span class="op" id="5963452">[</span><span class="op" id="5963453">]</span><span class="builtintype" id="5963454">byte</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5963460">data</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5963467">[</span><span class="op" id="5963468">]</span><span class="builtintype" id="5963469">byte</span><br>
<span class="lineno"></span><span class="op" id="5963474">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5963477">func</span>&nbsp;<span class="op" id="5963482">(</span><span class="ident" id="5963483">r</span>&nbsp;<span class="op" id="5963485">*</span><span class="ident" id="5963486">dataErrReader</span><span class="op" id="5963499">)</span>&nbsp;<span class="ident" id="5963501">Read</span><span class="op" id="5963505">(</span><span class="ident" id="5963506">p</span>&nbsp;<span class="op" id="5963508">[</span><span class="op" id="5963509">]</span><span class="builtintype" id="5963510">byte</span><span class="op" id="5963514">)</span>&nbsp;<span class="op" id="5963516">(</span><span class="ident" id="5963517">n</span>&nbsp;<span class="builtintype" id="5963519">int</span><span class="op" id="5963522">,</span>&nbsp;<span class="ident" id="5963524">err</span>&nbsp;<span class="builtintype" id="5963528">error</span><span class="op" id="5963533">)</span>&nbsp;<span class="op" id="5963535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5963538">//&nbsp;loop&nbsp;because&nbsp;first&nbsp;call&nbsp;needs&nbsp;two&nbsp;reads:</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5963583">//&nbsp;one&nbsp;to&nbsp;get&nbsp;data&nbsp;and&nbsp;a&nbsp;second&nbsp;to&nbsp;look&nbsp;for&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5963638">for</span>&nbsp;<span class="op" id="5963642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5963646">if</span>&nbsp;<span class="builtinfunc" id="5963649">len</span><span class="op" id="5963652">(</span><span class="ident" id="5963653">r</span><span class="op" id="5963654">.</span><span class="ident" id="5963655">unread</span><span class="op" id="5963661">)</span>&nbsp;<span class="op" id="5963663">==</span>&nbsp;<span class="num" id="5963666">0</span>&nbsp;<span class="op" id="5963668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5963673">n1</span><span class="op" id="5963675">,</span>&nbsp;<span class="ident" id="5963677">err1</span>&nbsp;<span class="op" id="5963682">:=</span>&nbsp;<span class="ident" id="5963685">r</span><span class="op" id="5963686">.</span><span class="ident" id="5963687">r</span><span class="op" id="5963688">.</span><span class="ident" id="5963689">Read</span><span class="op" id="5963693">(</span><span class="ident" id="5963694">r</span><span class="op" id="5963695">.</span><span class="ident" id="5963696">data</span><span class="op" id="5963700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5963705">r</span><span class="op" id="5963706">.</span><span class="ident" id="5963707">unread</span>&nbsp;<span class="op" id="5963714">=</span>&nbsp;<span class="ident" id="5963716">r</span><span class="op" id="5963717">.</span><span class="ident" id="5963718">data</span><span class="op" id="5963722">[</span><span class="num" id="5963723">0</span><span class="op" id="5963724">:</span><span class="ident" id="5963725">n1</span><span class="op" id="5963727">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5963732">err</span>&nbsp;<span class="op" id="5963736">=</span>&nbsp;<span class="ident" id="5963738">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5963745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5963749">if</span>&nbsp;<span class="ident" id="5963752">n</span>&nbsp;<span class="op" id="5963754">&gt;</span>&nbsp;<span class="num" id="5963756">0</span>&nbsp;<span class="op" id="5963758">||</span>&nbsp;<span class="ident" id="5963761">err</span>&nbsp;<span class="op" id="5963765">!=</span>&nbsp;<span class="builtintype" id="5963768">nil</span>&nbsp;<span class="op" id="5963772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5963777">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5963785">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5963789">n</span>&nbsp;<span class="op" id="5963791">=</span>&nbsp;<span class="builtinfunc" id="5963793">copy</span><span class="op" id="5963797">(</span><span class="ident" id="5963798">p</span><span class="op" id="5963799">,</span>&nbsp;<span class="ident" id="5963801">r</span><span class="op" id="5963802">.</span><span class="ident" id="5963803">unread</span><span class="op" id="5963809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5963813">r</span><span class="op" id="5963814">.</span><span class="ident" id="5963815">unread</span>&nbsp;<span class="op" id="5963822">=</span>&nbsp;<span class="ident" id="5963824">r</span><span class="op" id="5963825">.</span><span class="ident" id="5963826">unread</span><span class="op" id="5963832">[</span><span class="ident" id="5963833">n</span><span class="op" id="5963834">:</span><span class="op" id="5963835">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5963838">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5963841">return</span><br>
<span class="lineno"></span><span class="op" id="5963848">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="5963851">var</span>&nbsp;<span class="ident" id="5963855">ErrTimeout</span>&nbsp;<span class="op" id="5963866">=</span>&nbsp;<span class="ident" id="5963868">errors</span><span class="op" id="5963874">.</span><span class="ident" id="5963875">New</span><span class="op" id="5963878">(</span><span class="string" id="5963879">&#34;timeout&#34;</span><span class="op" id="5963888">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5963891">//&nbsp;TimeoutReader&nbsp;returns&nbsp;ErrTimeout&nbsp;on&nbsp;the&nbsp;second&nbsp;read</span><br>
<span class="lineno"></span><span class="comment" id="5963946">//&nbsp;with&nbsp;no&nbsp;data.&nbsp;&nbsp;Subsequent&nbsp;calls&nbsp;to&nbsp;read&nbsp;succeed.</span><br>
<span class="lineno">75</span><span class="keyword" id="5963998">func</span>&nbsp;<span class="ident" id="5964003">TimeoutReader</span><span class="op" id="5964016">(</span><span class="ident" id="5964017">r</span>&nbsp;<span class="ident" id="5964019">io</span><span class="op" id="5964021">.</span><span class="ident" id="5964022">Reader</span><span class="op" id="5964028">)</span>&nbsp;<span class="ident" id="5964030">io</span><span class="op" id="5964032">.</span><span class="ident" id="5964033">Reader</span>&nbsp;<span class="op" id="5964040">{</span>&nbsp;<span class="keyword" id="5964042">return</span>&nbsp;<span class="op" id="5964049">&amp;</span><span class="ident" id="5964050">timeoutReader</span><span class="op" id="5964063">{</span><span class="ident" id="5964064">r</span><span class="op" id="5964065">,</span>&nbsp;<span class="num" id="5964067">0</span><span class="op" id="5964068">}</span>&nbsp;<span class="op" id="5964070">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5964073">type</span>&nbsp;<span class="ident" id="5964078">timeoutReader</span>&nbsp;<span class="keyword" id="5964092">struct</span>&nbsp;<span class="op" id="5964099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5964102">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5964108">io</span><span class="op" id="5964110">.</span><span class="ident" id="5964111">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5964119">count</span>&nbsp;<span class="builtintype" id="5964125">int</span><br>
<span class="lineno">80</span><span class="op" id="5964129">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5964132">func</span>&nbsp;<span class="op" id="5964137">(</span><span class="ident" id="5964138">r</span>&nbsp;<span class="op" id="5964140">*</span><span class="ident" id="5964141">timeoutReader</span><span class="op" id="5964154">)</span>&nbsp;<span class="ident" id="5964156">Read</span><span class="op" id="5964160">(</span><span class="ident" id="5964161">p</span>&nbsp;<span class="op" id="5964163">[</span><span class="op" id="5964164">]</span><span class="builtintype" id="5964165">byte</span><span class="op" id="5964169">)</span>&nbsp;<span class="op" id="5964171">(</span><span class="builtintype" id="5964172">int</span><span class="op" id="5964175">,</span>&nbsp;<span class="builtintype" id="5964177">error</span><span class="op" id="5964182">)</span>&nbsp;<span class="op" id="5964184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5964187">r</span><span class="op" id="5964188">.</span><span class="ident" id="5964189">count</span><span class="op" id="5964194">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5964198">if</span>&nbsp;<span class="ident" id="5964201">r</span><span class="op" id="5964202">.</span><span class="ident" id="5964203">count</span>&nbsp;<span class="op" id="5964209">==</span>&nbsp;<span class="num" id="5964212">2</span>&nbsp;<span class="op" id="5964214">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5964218">return</span>&nbsp;<span class="num" id="5964225">0</span><span class="op" id="5964226">,</span>&nbsp;<span class="ident" id="5964228">ErrTimeout</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5964240">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5964243">return</span>&nbsp;<span class="ident" id="5964250">r</span><span class="op" id="5964251">.</span><span class="ident" id="5964252">r</span><span class="op" id="5964253">.</span><span class="ident" id="5964254">Read</span><span class="op" id="5964258">(</span><span class="ident" id="5964259">p</span><span class="op" id="5964260">)</span><br>
<span class="lineno"></span><span class="op" id="5964262">}</span>
</div>
</body>
</html>
