<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html" class="current">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3227775">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3227830">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3227884">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3227935">//&nbsp;DNS&nbsp;packet&nbsp;assembly.&nbsp;&nbsp;See&nbsp;RFC&nbsp;1035.</span><br>
<span class="lineno"></span><span class="comment" id="3227974">//</span><br>
<span class="lineno"></span><span class="comment" id="3227977">//&nbsp;This&nbsp;is&nbsp;intended&nbsp;to&nbsp;support&nbsp;name&nbsp;resolution&nbsp;during&nbsp;Dial.</span><br>
<span class="lineno"></span><span class="comment" id="3228037">//&nbsp;It&nbsp;doesn&#39;t&nbsp;have&nbsp;to&nbsp;be&nbsp;blazing&nbsp;fast.</span><br>
<span class="lineno"></span><span class="comment" id="3228076">//</span><br>
<span class="lineno">10</span><span class="comment" id="3228079">//&nbsp;Each&nbsp;message&nbsp;structure&nbsp;has&nbsp;a&nbsp;Walk&nbsp;method&nbsp;that&nbsp;is&nbsp;used&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="3228139">//&nbsp;a&nbsp;generic&nbsp;pack/unpack&nbsp;routine.&nbsp;Thus,&nbsp;if&nbsp;in&nbsp;the&nbsp;future&nbsp;we&nbsp;need</span><br>
<span class="lineno"></span><span class="comment" id="3228204">//&nbsp;to&nbsp;define&nbsp;new&nbsp;message&nbsp;structs,&nbsp;no&nbsp;new&nbsp;pack/unpack/printing&nbsp;code</span><br>
<span class="lineno"></span><span class="comment" id="3228271">//&nbsp;needs&nbsp;to&nbsp;be&nbsp;written.</span><br>
<span class="lineno"></span><span class="comment" id="3228295">//</span><br>
<span class="lineno">15</span><span class="comment" id="3228298">//&nbsp;The&nbsp;first&nbsp;half&nbsp;of&nbsp;this&nbsp;file&nbsp;defines&nbsp;the&nbsp;DNS&nbsp;message&nbsp;formats.</span><br>
<span class="lineno"></span><span class="comment" id="3228362">//&nbsp;The&nbsp;second&nbsp;half&nbsp;implements&nbsp;the&nbsp;conversion&nbsp;to&nbsp;and&nbsp;from&nbsp;wire&nbsp;format.</span><br>
<span class="lineno"></span><span class="comment" id="3228432">//&nbsp;A&nbsp;few&nbsp;of&nbsp;the&nbsp;structure&nbsp;elements&nbsp;have&nbsp;string&nbsp;tags&nbsp;to&nbsp;aid&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3228495">//&nbsp;generic&nbsp;pack/unpack&nbsp;routines.</span><br>
<span class="lineno"></span><span class="comment" id="3228528">//</span><br>
<span class="lineno">20</span><span class="comment" id="3228531">//&nbsp;TODO(rsc):&nbsp;&nbsp;There&nbsp;are&nbsp;enough&nbsp;names&nbsp;defined&nbsp;in&nbsp;this&nbsp;file&nbsp;that&nbsp;they&#39;re&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="3228607">//&nbsp;prefixed&nbsp;with&nbsp;dns.&nbsp;&nbsp;Perhaps&nbsp;put&nbsp;this&nbsp;in&nbsp;its&nbsp;own&nbsp;package&nbsp;later.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3228674">package</span>&nbsp;<span class="ident" id="3228682">net</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="3228687">//&nbsp;Packet&nbsp;formats</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3228706">//&nbsp;Wire&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="3228725">const</span>&nbsp;<span class="op" id="3228731">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3228734">//&nbsp;valid&nbsp;dnsRR_Header.Rrtype&nbsp;and&nbsp;dnsQuestion.qtype</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3228786">dnsTypeA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3228799">=</span>&nbsp;<span class="num" id="3228801">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3228804">dnsTypeNS</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3228817">=</span>&nbsp;<span class="num" id="3228819">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3228822">dnsTypeMD</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3228835">=</span>&nbsp;<span class="num" id="3228837">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3228840">dnsTypeMF</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3228853">=</span>&nbsp;<span class="num" id="3228855">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3228858">dnsTypeCNAME</span>&nbsp;<span class="op" id="3228871">=</span>&nbsp;<span class="num" id="3228873">5</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3228876">dnsTypeSOA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3228889">=</span>&nbsp;<span class="num" id="3228891">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3228894">dnsTypeMB</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3228907">=</span>&nbsp;<span class="num" id="3228909">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3228912">dnsTypeMG</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3228925">=</span>&nbsp;<span class="num" id="3228927">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3228930">dnsTypeMR</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3228943">=</span>&nbsp;<span class="num" id="3228945">9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3228948">dnsTypeNULL</span>&nbsp;&nbsp;<span class="op" id="3228961">=</span>&nbsp;<span class="num" id="3228963">10</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3228967">dnsTypeWKS</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3228980">=</span>&nbsp;<span class="num" id="3228982">11</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3228986">dnsTypePTR</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3228999">=</span>&nbsp;<span class="num" id="3229001">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3229005">dnsTypeHINFO</span>&nbsp;<span class="op" id="3229018">=</span>&nbsp;<span class="num" id="3229020">13</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3229024">dnsTypeMINFO</span>&nbsp;<span class="op" id="3229037">=</span>&nbsp;<span class="num" id="3229039">14</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3229043">dnsTypeMX</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3229056">=</span>&nbsp;<span class="num" id="3229058">15</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3229062">dnsTypeTXT</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3229075">=</span>&nbsp;<span class="num" id="3229077">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3229081">dnsTypeAAAA</span>&nbsp;&nbsp;<span class="op" id="3229094">=</span>&nbsp;<span class="num" id="3229096">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3229100">dnsTypeSRV</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3229113">=</span>&nbsp;<span class="num" id="3229115">33</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3229120">//&nbsp;valid&nbsp;dnsQuestion.qtype&nbsp;only</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3229153">dnsTypeAXFR</span>&nbsp;&nbsp;<span class="op" id="3229166">=</span>&nbsp;<span class="num" id="3229168">252</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3229173">dnsTypeMAILB</span>&nbsp;<span class="op" id="3229186">=</span>&nbsp;<span class="num" id="3229188">253</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3229193">dnsTypeMAILA</span>&nbsp;<span class="op" id="3229206">=</span>&nbsp;<span class="num" id="3229208">254</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3229213">dnsTypeALL</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3229226">=</span>&nbsp;<span class="num" id="3229228">255</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3229234">//&nbsp;valid&nbsp;dnsQuestion.qclass</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3229263">dnsClassINET</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3229278">=</span>&nbsp;<span class="num" id="3229280">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3229283">dnsClassCSNET</span>&nbsp;&nbsp;<span class="op" id="3229298">=</span>&nbsp;<span class="num" id="3229300">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3229303">dnsClassCHAOS</span>&nbsp;&nbsp;<span class="op" id="3229318">=</span>&nbsp;<span class="num" id="3229320">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3229323">dnsClassHESIOD</span>&nbsp;<span class="op" id="3229338">=</span>&nbsp;<span class="num" id="3229340">4</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3229343">dnsClassANY</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3229358">=</span>&nbsp;<span class="num" id="3229360">255</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3229366">//&nbsp;dnsMsg.rcode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3229383">dnsRcodeSuccess</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3229406">=</span>&nbsp;<span class="num" id="3229408">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3229411">dnsRcodeFormatError</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3229434">=</span>&nbsp;<span class="num" id="3229436">1</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3229439">dnsRcodeServerFailure</span>&nbsp;&nbsp;<span class="op" id="3229462">=</span>&nbsp;<span class="num" id="3229464">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3229467">dnsRcodeNameError</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3229490">=</span>&nbsp;<span class="num" id="3229492">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3229495">dnsRcodeNotImplemented</span>&nbsp;<span class="op" id="3229518">=</span>&nbsp;<span class="num" id="3229520">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3229523">dnsRcodeRefused</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3229546">=</span>&nbsp;<span class="num" id="3229548">5</span><br>
<span class="lineno"></span><span class="op" id="3229550">)</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="comment" id="3229553">//&nbsp;A&nbsp;dnsStruct&nbsp;describes&nbsp;how&nbsp;to&nbsp;iterate&nbsp;over&nbsp;its&nbsp;fields&nbsp;to&nbsp;emulate</span><br>
<span class="lineno"></span><span class="comment" id="3229620">//&nbsp;reflective&nbsp;marshalling.</span><br>
<span class="lineno"></span><span class="keyword" id="3229647">type</span>&nbsp;<span class="ident" id="3229652">dnsStruct</span>&nbsp;<span class="keyword" id="3229662">interface</span>&nbsp;<span class="op" id="3229672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3229675">//&nbsp;Walk&nbsp;iterates&nbsp;over&nbsp;fields&nbsp;of&nbsp;a&nbsp;structure&nbsp;and&nbsp;calls&nbsp;f</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3229732">//&nbsp;with&nbsp;a&nbsp;reference&nbsp;to&nbsp;that&nbsp;field,&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3229790">//&nbsp;and&nbsp;a&nbsp;tag&nbsp;(&#34;&#34;,&nbsp;&#34;domain&#34;,&nbsp;&#34;ipv4&#34;,&nbsp;&#34;ipv6&#34;)&nbsp;specifying</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3229846">//&nbsp;particular&nbsp;encodings.&nbsp;Possible&nbsp;concrete&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3229896">//&nbsp;for&nbsp;v&nbsp;are&nbsp;*uint16,&nbsp;*uint32,&nbsp;*string,&nbsp;or&nbsp;[]byte,&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3229952">//&nbsp;*int,&nbsp;*bool&nbsp;in&nbsp;the&nbsp;case&nbsp;of&nbsp;dnsMsgHdr.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3229994">//&nbsp;Whenever&nbsp;f&nbsp;returns&nbsp;false,&nbsp;Walk&nbsp;must&nbsp;stop&nbsp;and&nbsp;return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3230050">//&nbsp;false,&nbsp;and&nbsp;otherwise&nbsp;return&nbsp;true.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3230088">Walk</span><span class="op" id="3230092">(</span><span class="ident" id="3230093">f</span>&nbsp;<span class="keyword" id="3230095">func</span><span class="op" id="3230099">(</span><span class="ident" id="3230100">v</span>&nbsp;<span class="keyword" id="3230102">interface</span><span class="op" id="3230111">{</span><span class="op" id="3230112">}</span><span class="op" id="3230113">,</span>&nbsp;<span class="ident" id="3230115">name</span><span class="op" id="3230119">,</span>&nbsp;<span class="ident" id="3230121">tag</span>&nbsp;<span class="builtintype" id="3230125">string</span><span class="op" id="3230131">)</span>&nbsp;<span class="op" id="3230133">(</span><span class="ident" id="3230134">ok</span>&nbsp;<span class="builtintype" id="3230137">bool</span><span class="op" id="3230141">)</span><span class="op" id="3230142">)</span>&nbsp;<span class="op" id="3230144">(</span><span class="ident" id="3230145">ok</span>&nbsp;<span class="builtintype" id="3230148">bool</span><span class="op" id="3230152">)</span><br>
<span class="lineno"></span><span class="op" id="3230154">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="3230157">//&nbsp;The&nbsp;wire&nbsp;format&nbsp;for&nbsp;the&nbsp;DNS&nbsp;packet&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="3230203">type</span>&nbsp;<span class="ident" id="3230208">dnsHeader</span>&nbsp;<span class="keyword" id="3230218">struct</span>&nbsp;<span class="op" id="3230225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3230228">Id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3230263">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3230271">Bits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3230306">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3230314">Qdcount</span><span class="op" id="3230321">,</span>&nbsp;<span class="ident" id="3230323">Ancount</span><span class="op" id="3230330">,</span>&nbsp;<span class="ident" id="3230332">Nscount</span><span class="op" id="3230339">,</span>&nbsp;<span class="ident" id="3230341">Arcount</span>&nbsp;<span class="builtintype" id="3230349">uint16</span><br>
<span class="lineno">90</span><span class="op" id="3230356">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3230359">func</span>&nbsp;<span class="op" id="3230364">(</span><span class="ident" id="3230365">h</span>&nbsp;<span class="op" id="3230367">*</span><span class="ident" id="3230368"><a href="/gostd/net/dnsmsg.go.html#3230208">dnsHeader</a></span><span class="op" id="3230377">)</span>&nbsp;<span class="ident" id="3230379">Walk</span><span class="op" id="3230383">(</span><span class="ident" id="3230384">f</span>&nbsp;<span class="keyword" id="3230386">func</span><span class="op" id="3230390">(</span><span class="ident" id="3230391">v</span>&nbsp;<span class="keyword" id="3230393">interface</span><span class="op" id="3230402">{</span><span class="op" id="3230403">}</span><span class="op" id="3230404">,</span>&nbsp;<span class="ident" id="3230406">name</span><span class="op" id="3230410">,</span>&nbsp;<span class="ident" id="3230412">tag</span>&nbsp;<span class="builtintype" id="3230416">string</span><span class="op" id="3230422">)</span>&nbsp;<span class="builtintype" id="3230424">bool</span><span class="op" id="3230428">)</span>&nbsp;<span class="builtintype" id="3230430">bool</span>&nbsp;<span class="op" id="3230435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3230438">return</span>&nbsp;<span class="ident" id="3230445"><a href="/gostd/net/dnsmsg.go.html#3230384">f</a></span><span class="op" id="3230446">(</span><span class="op" id="3230447">&amp;</span><span class="ident" id="3230448"><a href="/gostd/net/dnsmsg.go.html#3230365">h</a></span><span class="op" id="3230449">.</span><span class="ident" id="3230450"><a href="/gostd/net/dnsmsg.go.html#3230228">Id</a></span><span class="op" id="3230452">,</span>&nbsp;<span class="string" id="3230454">&#34;Id&#34;</span><span class="op" id="3230458">,</span>&nbsp;<span class="string" id="3230460">&#34;&#34;</span><span class="op" id="3230462">)</span>&nbsp;<span class="op" id="3230464">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3230469"><a href="/gostd/net/dnsmsg.go.html#3230384">f</a></span><span class="op" id="3230470">(</span><span class="op" id="3230471">&amp;</span><span class="ident" id="3230472"><a href="/gostd/net/dnsmsg.go.html#3230365">h</a></span><span class="op" id="3230473">.</span><span class="ident" id="3230474"><a href="/gostd/net/dnsmsg.go.html#3230271">Bits</a></span><span class="op" id="3230478">,</span>&nbsp;<span class="string" id="3230480">&#34;Bits&#34;</span><span class="op" id="3230486">,</span>&nbsp;<span class="string" id="3230488">&#34;&#34;</span><span class="op" id="3230490">)</span>&nbsp;<span class="op" id="3230492">&amp;&amp;</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3230497"><a href="/gostd/net/dnsmsg.go.html#3230384">f</a></span><span class="op" id="3230498">(</span><span class="op" id="3230499">&amp;</span><span class="ident" id="3230500"><a href="/gostd/net/dnsmsg.go.html#3230365">h</a></span><span class="op" id="3230501">.</span><span class="ident" id="3230502"><a href="/gostd/net/dnsmsg.go.html#3230314">Qdcount</a></span><span class="op" id="3230509">,</span>&nbsp;<span class="string" id="3230511">&#34;Qdcount&#34;</span><span class="op" id="3230520">,</span>&nbsp;<span class="string" id="3230522">&#34;&#34;</span><span class="op" id="3230524">)</span>&nbsp;<span class="op" id="3230526">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3230531"><a href="/gostd/net/dnsmsg.go.html#3230384">f</a></span><span class="op" id="3230532">(</span><span class="op" id="3230533">&amp;</span><span class="ident" id="3230534"><a href="/gostd/net/dnsmsg.go.html#3230365">h</a></span><span class="op" id="3230535">.</span><span class="ident" id="3230536"><a href="/gostd/net/dnsmsg.go.html#3230323">Ancount</a></span><span class="op" id="3230543">,</span>&nbsp;<span class="string" id="3230545">&#34;Ancount&#34;</span><span class="op" id="3230554">,</span>&nbsp;<span class="string" id="3230556">&#34;&#34;</span><span class="op" id="3230558">)</span>&nbsp;<span class="op" id="3230560">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3230565"><a href="/gostd/net/dnsmsg.go.html#3230384">f</a></span><span class="op" id="3230566">(</span><span class="op" id="3230567">&amp;</span><span class="ident" id="3230568"><a href="/gostd/net/dnsmsg.go.html#3230365">h</a></span><span class="op" id="3230569">.</span><span class="ident" id="3230570"><a href="/gostd/net/dnsmsg.go.html#3230332">Nscount</a></span><span class="op" id="3230577">,</span>&nbsp;<span class="string" id="3230579">&#34;Nscount&#34;</span><span class="op" id="3230588">,</span>&nbsp;<span class="string" id="3230590">&#34;&#34;</span><span class="op" id="3230592">)</span>&nbsp;<span class="op" id="3230594">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3230599"><a href="/gostd/net/dnsmsg.go.html#3230384">f</a></span><span class="op" id="3230600">(</span><span class="op" id="3230601">&amp;</span><span class="ident" id="3230602"><a href="/gostd/net/dnsmsg.go.html#3230365">h</a></span><span class="op" id="3230603">.</span><span class="ident" id="3230604"><a href="/gostd/net/dnsmsg.go.html#3230341">Arcount</a></span><span class="op" id="3230611">,</span>&nbsp;<span class="string" id="3230613">&#34;Arcount&#34;</span><span class="op" id="3230622">,</span>&nbsp;<span class="string" id="3230624">&#34;&#34;</span><span class="op" id="3230626">)</span><br>
<span class="lineno"></span><span class="op" id="3230628">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="keyword" id="3230631">const</span>&nbsp;<span class="op" id="3230637">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3230640">//&nbsp;dnsHeader.Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3230659">_QR</span>&nbsp;<span class="op" id="3230663">=</span>&nbsp;<span class="num" id="3230665">1</span>&nbsp;<span class="op" id="3230667">&lt;&lt;</span>&nbsp;<span class="num" id="3230670">15</span>&nbsp;<span class="comment" id="3230673">//&nbsp;query/response&nbsp;(response=1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3230705">_AA</span>&nbsp;<span class="op" id="3230709">=</span>&nbsp;<span class="num" id="3230711">1</span>&nbsp;<span class="op" id="3230713">&lt;&lt;</span>&nbsp;<span class="num" id="3230716">10</span>&nbsp;<span class="comment" id="3230719">//&nbsp;authoritative</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3230737">_TC</span>&nbsp;<span class="op" id="3230741">=</span>&nbsp;<span class="num" id="3230743">1</span>&nbsp;<span class="op" id="3230745">&lt;&lt;</span>&nbsp;<span class="num" id="3230748">9</span>&nbsp;&nbsp;<span class="comment" id="3230751">//&nbsp;truncated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3230765">_RD</span>&nbsp;<span class="op" id="3230769">=</span>&nbsp;<span class="num" id="3230771">1</span>&nbsp;<span class="op" id="3230773">&lt;&lt;</span>&nbsp;<span class="num" id="3230776">8</span>&nbsp;&nbsp;<span class="comment" id="3230779">//&nbsp;recursion&nbsp;desired</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3230801">_RA</span>&nbsp;<span class="op" id="3230805">=</span>&nbsp;<span class="num" id="3230807">1</span>&nbsp;<span class="op" id="3230809">&lt;&lt;</span>&nbsp;<span class="num" id="3230812">7</span>&nbsp;&nbsp;<span class="comment" id="3230815">//&nbsp;recursion&nbsp;available</span><br>
<span class="lineno"></span><span class="op" id="3230838">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="comment" id="3230841">//&nbsp;DNS&nbsp;queries.</span><br>
<span class="lineno"></span><span class="keyword" id="3230857">type</span>&nbsp;<span class="ident" id="3230862">dnsQuestion</span>&nbsp;<span class="keyword" id="3230874">struct</span>&nbsp;<span class="op" id="3230881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3230884">Name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3230891">string</span>&nbsp;<span class="string" id="3230898">`net:&#34;domain-name&#34;`</span>&nbsp;<span class="comment" id="3230918">//&nbsp;`net:&#34;domain-name&#34;`&nbsp;specifies&nbsp;encoding;&nbsp;see&nbsp;packers&nbsp;below</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3230980">Qtype</span>&nbsp;&nbsp;<span class="builtintype" id="3230987">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3230995">Qclass</span>&nbsp;<span class="builtintype" id="3231002">uint16</span><br>
<span class="lineno">115</span><span class="op" id="3231009">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3231012">func</span>&nbsp;<span class="op" id="3231017">(</span><span class="ident" id="3231018">q</span>&nbsp;<span class="op" id="3231020">*</span><span class="ident" id="3231021"><a href="/gostd/net/dnsmsg.go.html#3230862">dnsQuestion</a></span><span class="op" id="3231032">)</span>&nbsp;<span class="ident" id="3231034">Walk</span><span class="op" id="3231038">(</span><span class="ident" id="3231039">f</span>&nbsp;<span class="keyword" id="3231041">func</span><span class="op" id="3231045">(</span><span class="ident" id="3231046">v</span>&nbsp;<span class="keyword" id="3231048">interface</span><span class="op" id="3231057">{</span><span class="op" id="3231058">}</span><span class="op" id="3231059">,</span>&nbsp;<span class="ident" id="3231061">name</span><span class="op" id="3231065">,</span>&nbsp;<span class="ident" id="3231067">tag</span>&nbsp;<span class="builtintype" id="3231071">string</span><span class="op" id="3231077">)</span>&nbsp;<span class="builtintype" id="3231079">bool</span><span class="op" id="3231083">)</span>&nbsp;<span class="builtintype" id="3231085">bool</span>&nbsp;<span class="op" id="3231090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3231093">return</span>&nbsp;<span class="ident" id="3231100"><a href="/gostd/net/dnsmsg.go.html#3231039">f</a></span><span class="op" id="3231101">(</span><span class="op" id="3231102">&amp;</span><span class="ident" id="3231103"><a href="/gostd/net/dnsmsg.go.html#3231018">q</a></span><span class="op" id="3231104">.</span><span class="ident" id="3231105"><a href="/gostd/net/dnsmsg.go.html#3230884">Name</a></span><span class="op" id="3231109">,</span>&nbsp;<span class="string" id="3231111">&#34;Name&#34;</span><span class="op" id="3231117">,</span>&nbsp;<span class="string" id="3231119">&#34;domain&#34;</span><span class="op" id="3231127">)</span>&nbsp;<span class="op" id="3231129">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3231134"><a href="/gostd/net/dnsmsg.go.html#3231039">f</a></span><span class="op" id="3231135">(</span><span class="op" id="3231136">&amp;</span><span class="ident" id="3231137"><a href="/gostd/net/dnsmsg.go.html#3231018">q</a></span><span class="op" id="3231138">.</span><span class="ident" id="3231139"><a href="/gostd/net/dnsmsg.go.html#3230980">Qtype</a></span><span class="op" id="3231144">,</span>&nbsp;<span class="string" id="3231146">&#34;Qtype&#34;</span><span class="op" id="3231153">,</span>&nbsp;<span class="string" id="3231155">&#34;&#34;</span><span class="op" id="3231157">)</span>&nbsp;<span class="op" id="3231159">&amp;&amp;</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3231164"><a href="/gostd/net/dnsmsg.go.html#3231039">f</a></span><span class="op" id="3231165">(</span><span class="op" id="3231166">&amp;</span><span class="ident" id="3231167"><a href="/gostd/net/dnsmsg.go.html#3231018">q</a></span><span class="op" id="3231168">.</span><span class="ident" id="3231169"><a href="/gostd/net/dnsmsg.go.html#3230995">Qclass</a></span><span class="op" id="3231175">,</span>&nbsp;<span class="string" id="3231177">&#34;Qclass&#34;</span><span class="op" id="3231185">,</span>&nbsp;<span class="string" id="3231187">&#34;&#34;</span><span class="op" id="3231189">)</span><br>
<span class="lineno"></span><span class="op" id="3231191">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3231194">//&nbsp;DNS&nbsp;responses&nbsp;(resource&nbsp;records).</span><br>
<span class="lineno"></span><span class="comment" id="3231231">//&nbsp;There&nbsp;are&nbsp;many&nbsp;types&nbsp;of&nbsp;messages,</span><br>
<span class="lineno">125</span><span class="comment" id="3231268">//&nbsp;but&nbsp;they&nbsp;all&nbsp;share&nbsp;the&nbsp;same&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="3231307">type</span>&nbsp;<span class="ident" id="3231312">dnsRR_Header</span>&nbsp;<span class="keyword" id="3231325">struct</span>&nbsp;<span class="op" id="3231332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3231335">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3231344">string</span>&nbsp;<span class="string" id="3231351">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3231372">Rrtype</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3231381">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3231389">Class</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3231398">uint16</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3231406">Ttl</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3231415">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3231423">Rdlength</span>&nbsp;<span class="builtintype" id="3231432">uint16</span>&nbsp;<span class="comment" id="3231439">//&nbsp;length&nbsp;of&nbsp;data&nbsp;after&nbsp;header</span><br>
<span class="lineno"></span><span class="op" id="3231470">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3231473">func</span>&nbsp;<span class="op" id="3231478">(</span><span class="ident" id="3231479">h</span>&nbsp;<span class="op" id="3231481">*</span><span class="ident" id="3231482"><a href="/gostd/net/dnsmsg.go.html#3231312">dnsRR_Header</a></span><span class="op" id="3231494">)</span>&nbsp;<span class="ident" id="3231496">Header</span><span class="op" id="3231502">(</span><span class="op" id="3231503">)</span>&nbsp;<span class="op" id="3231505">*</span><span class="ident" id="3231506"><a href="/gostd/net/dnsmsg.go.html#3231312">dnsRR_Header</a></span>&nbsp;<span class="op" id="3231519">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3231522">return</span>&nbsp;<span class="ident" id="3231529"><a href="/gostd/net/dnsmsg.go.html#3231479">h</a></span><br>
<span class="lineno"></span><span class="op" id="3231531">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3231534">func</span>&nbsp;<span class="op" id="3231539">(</span><span class="ident" id="3231540">h</span>&nbsp;<span class="op" id="3231542">*</span><span class="ident" id="3231543"><a href="/gostd/net/dnsmsg.go.html#3231312">dnsRR_Header</a></span><span class="op" id="3231555">)</span>&nbsp;<span class="ident" id="3231557">Walk</span><span class="op" id="3231561">(</span><span class="ident" id="3231562">f</span>&nbsp;<span class="keyword" id="3231564">func</span><span class="op" id="3231568">(</span><span class="ident" id="3231569">v</span>&nbsp;<span class="keyword" id="3231571">interface</span><span class="op" id="3231580">{</span><span class="op" id="3231581">}</span><span class="op" id="3231582">,</span>&nbsp;<span class="ident" id="3231584">name</span><span class="op" id="3231588">,</span>&nbsp;<span class="ident" id="3231590">tag</span>&nbsp;<span class="builtintype" id="3231594">string</span><span class="op" id="3231600">)</span>&nbsp;<span class="builtintype" id="3231602">bool</span><span class="op" id="3231606">)</span>&nbsp;<span class="builtintype" id="3231608">bool</span>&nbsp;<span class="op" id="3231613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3231616">return</span>&nbsp;<span class="ident" id="3231623"><a href="/gostd/net/dnsmsg.go.html#3231562">f</a></span><span class="op" id="3231624">(</span><span class="op" id="3231625">&amp;</span><span class="ident" id="3231626"><a href="/gostd/net/dnsmsg.go.html#3231540">h</a></span><span class="op" id="3231627">.</span><span class="ident" id="3231628"><a href="/gostd/net/dnsmsg.go.html#3231335">Name</a></span><span class="op" id="3231632">,</span>&nbsp;<span class="string" id="3231634">&#34;Name&#34;</span><span class="op" id="3231640">,</span>&nbsp;<span class="string" id="3231642">&#34;domain&#34;</span><span class="op" id="3231650">)</span>&nbsp;<span class="op" id="3231652">&amp;&amp;</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3231657"><a href="/gostd/net/dnsmsg.go.html#3231562">f</a></span><span class="op" id="3231658">(</span><span class="op" id="3231659">&amp;</span><span class="ident" id="3231660"><a href="/gostd/net/dnsmsg.go.html#3231540">h</a></span><span class="op" id="3231661">.</span><span class="ident" id="3231662"><a href="/gostd/net/dnsmsg.go.html#3231372">Rrtype</a></span><span class="op" id="3231668">,</span>&nbsp;<span class="string" id="3231670">&#34;Rrtype&#34;</span><span class="op" id="3231678">,</span>&nbsp;<span class="string" id="3231680">&#34;&#34;</span><span class="op" id="3231682">)</span>&nbsp;<span class="op" id="3231684">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3231689"><a href="/gostd/net/dnsmsg.go.html#3231562">f</a></span><span class="op" id="3231690">(</span><span class="op" id="3231691">&amp;</span><span class="ident" id="3231692"><a href="/gostd/net/dnsmsg.go.html#3231540">h</a></span><span class="op" id="3231693">.</span><span class="ident" id="3231694"><a href="/gostd/net/dnsmsg.go.html#3231389">Class</a></span><span class="op" id="3231699">,</span>&nbsp;<span class="string" id="3231701">&#34;Class&#34;</span><span class="op" id="3231708">,</span>&nbsp;<span class="string" id="3231710">&#34;&#34;</span><span class="op" id="3231712">)</span>&nbsp;<span class="op" id="3231714">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3231719"><a href="/gostd/net/dnsmsg.go.html#3231562">f</a></span><span class="op" id="3231720">(</span><span class="op" id="3231721">&amp;</span><span class="ident" id="3231722"><a href="/gostd/net/dnsmsg.go.html#3231540">h</a></span><span class="op" id="3231723">.</span><span class="ident" id="3231724"><a href="/gostd/net/dnsmsg.go.html#3231406">Ttl</a></span><span class="op" id="3231727">,</span>&nbsp;<span class="string" id="3231729">&#34;Ttl&#34;</span><span class="op" id="3231734">,</span>&nbsp;<span class="string" id="3231736">&#34;&#34;</span><span class="op" id="3231738">)</span>&nbsp;<span class="op" id="3231740">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3231745"><a href="/gostd/net/dnsmsg.go.html#3231562">f</a></span><span class="op" id="3231746">(</span><span class="op" id="3231747">&amp;</span><span class="ident" id="3231748"><a href="/gostd/net/dnsmsg.go.html#3231540">h</a></span><span class="op" id="3231749">.</span><span class="ident" id="3231750"><a href="/gostd/net/dnsmsg.go.html#3231423">Rdlength</a></span><span class="op" id="3231758">,</span>&nbsp;<span class="string" id="3231760">&#34;Rdlength&#34;</span><span class="op" id="3231770">,</span>&nbsp;<span class="string" id="3231772">&#34;&#34;</span><span class="op" id="3231774">)</span><br>
<span class="lineno"></span><span class="op" id="3231776">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="keyword" id="3231779">type</span>&nbsp;<span class="ident" id="3231784">dnsRR</span>&nbsp;<span class="keyword" id="3231790">interface</span>&nbsp;<span class="op" id="3231800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3231803"><a href="/gostd/net/dnsmsg.go.html#3229652">dnsStruct</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3231814">Header</span><span class="op" id="3231820">(</span><span class="op" id="3231821">)</span>&nbsp;<span class="op" id="3231823">*</span><span class="ident" id="3231824"><a href="/gostd/net/dnsmsg.go.html#3231312">dnsRR_Header</a></span><br>
<span class="lineno"></span><span class="op" id="3231837">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="comment" id="3231840">//&nbsp;Specific&nbsp;DNS&nbsp;RR&nbsp;formats&nbsp;for&nbsp;each&nbsp;query&nbsp;type.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3231889">type</span>&nbsp;<span class="ident" id="3231894">dnsRR_CNAME</span>&nbsp;<span class="keyword" id="3231906">struct</span>&nbsp;<span class="op" id="3231913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3231916">Hdr</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3231922"><a href="/gostd/net/dnsmsg.go.html#3231312">dnsRR_Header</a></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3231936">Cname</span>&nbsp;<span class="builtintype" id="3231942">string</span>&nbsp;<span class="string" id="3231949">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3231969">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3231972">func</span>&nbsp;<span class="op" id="3231977">(</span><span class="ident" id="3231978">rr</span>&nbsp;<span class="op" id="3231981">*</span><span class="ident" id="3231982"><a href="/gostd/net/dnsmsg.go.html#3231894">dnsRR_CNAME</a></span><span class="op" id="3231993">)</span>&nbsp;<span class="ident" id="3231995">Header</span><span class="op" id="3232001">(</span><span class="op" id="3232002">)</span>&nbsp;<span class="op" id="3232004">*</span><span class="ident" id="3232005"><a href="/gostd/net/dnsmsg.go.html#3231312">dnsRR_Header</a></span>&nbsp;<span class="op" id="3232018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3232021">return</span>&nbsp;<span class="op" id="3232028">&amp;</span><span class="ident" id="3232029"><a href="/gostd/net/dnsmsg.go.html#3231978">rr</a></span><span class="op" id="3232031">.</span><span class="ident" id="3232032"><a href="/gostd/net/dnsmsg.go.html#3231916">Hdr</a></span><br>
<span class="lineno">160</span><span class="op" id="3232036">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3232039">func</span>&nbsp;<span class="op" id="3232044">(</span><span class="ident" id="3232045">rr</span>&nbsp;<span class="op" id="3232048">*</span><span class="ident" id="3232049"><a href="/gostd/net/dnsmsg.go.html#3231894">dnsRR_CNAME</a></span><span class="op" id="3232060">)</span>&nbsp;<span class="ident" id="3232062">Walk</span><span class="op" id="3232066">(</span><span class="ident" id="3232067">f</span>&nbsp;<span class="keyword" id="3232069">func</span><span class="op" id="3232073">(</span><span class="ident" id="3232074">v</span>&nbsp;<span class="keyword" id="3232076">interface</span><span class="op" id="3232085">{</span><span class="op" id="3232086">}</span><span class="op" id="3232087">,</span>&nbsp;<span class="ident" id="3232089">name</span><span class="op" id="3232093">,</span>&nbsp;<span class="ident" id="3232095">tag</span>&nbsp;<span class="builtintype" id="3232099">string</span><span class="op" id="3232105">)</span>&nbsp;<span class="builtintype" id="3232107">bool</span><span class="op" id="3232111">)</span>&nbsp;<span class="builtintype" id="3232113">bool</span>&nbsp;<span class="op" id="3232118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3232121">return</span>&nbsp;<span class="ident" id="3232128"><a href="/gostd/net/dnsmsg.go.html#3232045">rr</a></span><span class="op" id="3232130">.</span><span class="ident" id="3232131"><a href="/gostd/net/dnsmsg.go.html#3231916">Hdr</a></span><span class="op" id="3232134">.</span><span class="ident" id="3232135"><a href="/gostd/net/dnsmsg.go.html#3231557">Walk</a></span><span class="op" id="3232139">(</span><span class="ident" id="3232140"><a href="/gostd/net/dnsmsg.go.html#3232067">f</a></span><span class="op" id="3232141">)</span>&nbsp;<span class="op" id="3232143">&amp;&amp;</span>&nbsp;<span class="ident" id="3232146"><a href="/gostd/net/dnsmsg.go.html#3232067">f</a></span><span class="op" id="3232147">(</span><span class="op" id="3232148">&amp;</span><span class="ident" id="3232149"><a href="/gostd/net/dnsmsg.go.html#3232045">rr</a></span><span class="op" id="3232151">.</span><span class="ident" id="3232152"><a href="/gostd/net/dnsmsg.go.html#3231936">Cname</a></span><span class="op" id="3232157">,</span>&nbsp;<span class="string" id="3232159">&#34;Cname&#34;</span><span class="op" id="3232166">,</span>&nbsp;<span class="string" id="3232168">&#34;domain&#34;</span><span class="op" id="3232176">)</span><br>
<span class="lineno"></span><span class="op" id="3232178">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="keyword" id="3232181">type</span>&nbsp;<span class="ident" id="3232186">dnsRR_HINFO</span>&nbsp;<span class="keyword" id="3232198">struct</span>&nbsp;<span class="op" id="3232205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3232208">Hdr</span>&nbsp;<span class="ident" id="3232212"><a href="/gostd/net/dnsmsg.go.html#3231312">dnsRR_Header</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3232226">Cpu</span>&nbsp;<span class="builtintype" id="3232230">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3232238">Os</span>&nbsp;&nbsp;<span class="builtintype" id="3232242">string</span><br>
<span class="lineno">170</span><span class="op" id="3232249">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3232252">func</span>&nbsp;<span class="op" id="3232257">(</span><span class="ident" id="3232258">rr</span>&nbsp;<span class="op" id="3232261">*</span><span class="ident" id="3232262"><a href="/gostd/net/dnsmsg.go.html#3232186">dnsRR_HINFO</a></span><span class="op" id="3232273">)</span>&nbsp;<span class="ident" id="3232275">Header</span><span class="op" id="3232281">(</span><span class="op" id="3232282">)</span>&nbsp;<span class="op" id="3232284">*</span><span class="ident" id="3232285"><a href="/gostd/net/dnsmsg.go.html#3231312">dnsRR_Header</a></span>&nbsp;<span class="op" id="3232298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3232301">return</span>&nbsp;<span class="op" id="3232308">&amp;</span><span class="ident" id="3232309"><a href="/gostd/net/dnsmsg.go.html#3232258">rr</a></span><span class="op" id="3232311">.</span><span class="ident" id="3232312"><a href="/gostd/net/dnsmsg.go.html#3232208">Hdr</a></span><br>
<span class="lineno"></span><span class="op" id="3232316">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="3232319">func</span>&nbsp;<span class="op" id="3232324">(</span><span class="ident" id="3232325">rr</span>&nbsp;<span class="op" id="3232328">*</span><span class="ident" id="3232329"><a href="/gostd/net/dnsmsg.go.html#3232186">dnsRR_HINFO</a></span><span class="op" id="3232340">)</span>&nbsp;<span class="ident" id="3232342">Walk</span><span class="op" id="3232346">(</span><span class="ident" id="3232347">f</span>&nbsp;<span class="keyword" id="3232349">func</span><span class="op" id="3232353">(</span><span class="ident" id="3232354">v</span>&nbsp;<span class="keyword" id="3232356">interface</span><span class="op" id="3232365">{</span><span class="op" id="3232366">}</span><span class="op" id="3232367">,</span>&nbsp;<span class="ident" id="3232369">name</span><span class="op" id="3232373">,</span>&nbsp;<span class="ident" id="3232375">tag</span>&nbsp;<span class="builtintype" id="3232379">string</span><span class="op" id="3232385">)</span>&nbsp;<span class="builtintype" id="3232387">bool</span><span class="op" id="3232391">)</span>&nbsp;<span class="builtintype" id="3232393">bool</span>&nbsp;<span class="op" id="3232398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3232401">return</span>&nbsp;<span class="ident" id="3232408"><a href="/gostd/net/dnsmsg.go.html#3232325">rr</a></span><span class="op" id="3232410">.</span><span class="ident" id="3232411"><a href="/gostd/net/dnsmsg.go.html#3232208">Hdr</a></span><span class="op" id="3232414">.</span><span class="ident" id="3232415"><a href="/gostd/net/dnsmsg.go.html#3231557">Walk</a></span><span class="op" id="3232419">(</span><span class="ident" id="3232420"><a href="/gostd/net/dnsmsg.go.html#3232347">f</a></span><span class="op" id="3232421">)</span>&nbsp;<span class="op" id="3232423">&amp;&amp;</span>&nbsp;<span class="ident" id="3232426"><a href="/gostd/net/dnsmsg.go.html#3232347">f</a></span><span class="op" id="3232427">(</span><span class="op" id="3232428">&amp;</span><span class="ident" id="3232429"><a href="/gostd/net/dnsmsg.go.html#3232325">rr</a></span><span class="op" id="3232431">.</span><span class="ident" id="3232432"><a href="/gostd/net/dnsmsg.go.html#3232226">Cpu</a></span><span class="op" id="3232435">,</span>&nbsp;<span class="string" id="3232437">&#34;Cpu&#34;</span><span class="op" id="3232442">,</span>&nbsp;<span class="string" id="3232444">&#34;&#34;</span><span class="op" id="3232446">)</span>&nbsp;<span class="op" id="3232448">&amp;&amp;</span>&nbsp;<span class="ident" id="3232451"><a href="/gostd/net/dnsmsg.go.html#3232347">f</a></span><span class="op" id="3232452">(</span><span class="op" id="3232453">&amp;</span><span class="ident" id="3232454"><a href="/gostd/net/dnsmsg.go.html#3232325">rr</a></span><span class="op" id="3232456">.</span><span class="ident" id="3232457"><a href="/gostd/net/dnsmsg.go.html#3232238">Os</a></span><span class="op" id="3232459">,</span>&nbsp;<span class="string" id="3232461">&#34;Os&#34;</span><span class="op" id="3232465">,</span>&nbsp;<span class="string" id="3232467">&#34;&#34;</span><span class="op" id="3232469">)</span><br>
<span class="lineno"></span><span class="op" id="3232471">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="keyword" id="3232474">type</span>&nbsp;<span class="ident" id="3232479">dnsRR_MB</span>&nbsp;<span class="keyword" id="3232488">struct</span>&nbsp;<span class="op" id="3232495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3232498">Hdr</span>&nbsp;<span class="ident" id="3232502"><a href="/gostd/net/dnsmsg.go.html#3231312">dnsRR_Header</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3232516">Mb</span>&nbsp;&nbsp;<span class="builtintype" id="3232520">string</span>&nbsp;<span class="string" id="3232527">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3232547">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="3232550">func</span>&nbsp;<span class="op" id="3232555">(</span><span class="ident" id="3232556">rr</span>&nbsp;<span class="op" id="3232559">*</span><span class="ident" id="3232560"><a href="/gostd/net/dnsmsg.go.html#3232479">dnsRR_MB</a></span><span class="op" id="3232568">)</span>&nbsp;<span class="ident" id="3232570">Header</span><span class="op" id="3232576">(</span><span class="op" id="3232577">)</span>&nbsp;<span class="op" id="3232579">*</span><span class="ident" id="3232580"><a href="/gostd/net/dnsmsg.go.html#3231312">dnsRR_Header</a></span>&nbsp;<span class="op" id="3232593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3232596">return</span>&nbsp;<span class="op" id="3232603">&amp;</span><span class="ident" id="3232604"><a href="/gostd/net/dnsmsg.go.html#3232556">rr</a></span><span class="op" id="3232606">.</span><span class="ident" id="3232607"><a href="/gostd/net/dnsmsg.go.html#3232498">Hdr</a></span><br>
<span class="lineno"></span><span class="op" id="3232611">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3232614">func</span>&nbsp;<span class="op" id="3232619">(</span><span class="ident" id="3232620">rr</span>&nbsp;<span class="op" id="3232623">*</span><span class="ident" id="3232624"><a href="/gostd/net/dnsmsg.go.html#3232479">dnsRR_MB</a></span><span class="op" id="3232632">)</span>&nbsp;<span class="ident" id="3232634">Walk</span><span class="op" id="3232638">(</span><span class="ident" id="3232639">f</span>&nbsp;<span class="keyword" id="3232641">func</span><span class="op" id="3232645">(</span><span class="ident" id="3232646">v</span>&nbsp;<span class="keyword" id="3232648">interface</span><span class="op" id="3232657">{</span><span class="op" id="3232658">}</span><span class="op" id="3232659">,</span>&nbsp;<span class="ident" id="3232661">name</span><span class="op" id="3232665">,</span>&nbsp;<span class="ident" id="3232667">tag</span>&nbsp;<span class="builtintype" id="3232671">string</span><span class="op" id="3232677">)</span>&nbsp;<span class="builtintype" id="3232679">bool</span><span class="op" id="3232683">)</span>&nbsp;<span class="builtintype" id="3232685">bool</span>&nbsp;<span class="op" id="3232690">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3232693">return</span>&nbsp;<span class="ident" id="3232700"><a href="/gostd/net/dnsmsg.go.html#3232620">rr</a></span><span class="op" id="3232702">.</span><span class="ident" id="3232703"><a href="/gostd/net/dnsmsg.go.html#3232498">Hdr</a></span><span class="op" id="3232706">.</span><span class="ident" id="3232707"><a href="/gostd/net/dnsmsg.go.html#3231557">Walk</a></span><span class="op" id="3232711">(</span><span class="ident" id="3232712"><a href="/gostd/net/dnsmsg.go.html#3232639">f</a></span><span class="op" id="3232713">)</span>&nbsp;<span class="op" id="3232715">&amp;&amp;</span>&nbsp;<span class="ident" id="3232718"><a href="/gostd/net/dnsmsg.go.html#3232639">f</a></span><span class="op" id="3232719">(</span><span class="op" id="3232720">&amp;</span><span class="ident" id="3232721"><a href="/gostd/net/dnsmsg.go.html#3232620">rr</a></span><span class="op" id="3232723">.</span><span class="ident" id="3232724"><a href="/gostd/net/dnsmsg.go.html#3232516">Mb</a></span><span class="op" id="3232726">,</span>&nbsp;<span class="string" id="3232728">&#34;Mb&#34;</span><span class="op" id="3232732">,</span>&nbsp;<span class="string" id="3232734">&#34;domain&#34;</span><span class="op" id="3232742">)</span><br>
<span class="lineno"></span><span class="op" id="3232744">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3232747">type</span>&nbsp;<span class="ident" id="3232752">dnsRR_MG</span>&nbsp;<span class="keyword" id="3232761">struct</span>&nbsp;<span class="op" id="3232768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3232771">Hdr</span>&nbsp;<span class="ident" id="3232775"><a href="/gostd/net/dnsmsg.go.html#3231312">dnsRR_Header</a></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3232789">Mg</span>&nbsp;&nbsp;<span class="builtintype" id="3232793">string</span>&nbsp;<span class="string" id="3232800">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3232820">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3232823">func</span>&nbsp;<span class="op" id="3232828">(</span><span class="ident" id="3232829">rr</span>&nbsp;<span class="op" id="3232832">*</span><span class="ident" id="3232833"><a href="/gostd/net/dnsmsg.go.html#3232752">dnsRR_MG</a></span><span class="op" id="3232841">)</span>&nbsp;<span class="ident" id="3232843">Header</span><span class="op" id="3232849">(</span><span class="op" id="3232850">)</span>&nbsp;<span class="op" id="3232852">*</span><span class="ident" id="3232853"><a href="/gostd/net/dnsmsg.go.html#3231312">dnsRR_Header</a></span>&nbsp;<span class="op" id="3232866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3232869">return</span>&nbsp;<span class="op" id="3232876">&amp;</span><span class="ident" id="3232877"><a href="/gostd/net/dnsmsg.go.html#3232829">rr</a></span><span class="op" id="3232879">.</span><span class="ident" id="3232880"><a href="/gostd/net/dnsmsg.go.html#3232771">Hdr</a></span><br>
<span class="lineno">200</span><span class="op" id="3232884">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3232887">func</span>&nbsp;<span class="op" id="3232892">(</span><span class="ident" id="3232893">rr</span>&nbsp;<span class="op" id="3232896">*</span><span class="ident" id="3232897"><a href="/gostd/net/dnsmsg.go.html#3232752">dnsRR_MG</a></span><span class="op" id="3232905">)</span>&nbsp;<span class="ident" id="3232907">Walk</span><span class="op" id="3232911">(</span><span class="ident" id="3232912">f</span>&nbsp;<span class="keyword" id="3232914">func</span><span class="op" id="3232918">(</span><span class="ident" id="3232919">v</span>&nbsp;<span class="keyword" id="3232921">interface</span><span class="op" id="3232930">{</span><span class="op" id="3232931">}</span><span class="op" id="3232932">,</span>&nbsp;<span class="ident" id="3232934">name</span><span class="op" id="3232938">,</span>&nbsp;<span class="ident" id="3232940">tag</span>&nbsp;<span class="builtintype" id="3232944">string</span><span class="op" id="3232950">)</span>&nbsp;<span class="builtintype" id="3232952">bool</span><span class="op" id="3232956">)</span>&nbsp;<span class="builtintype" id="3232958">bool</span>&nbsp;<span class="op" id="3232963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3232966">return</span>&nbsp;<span class="ident" id="3232973"><a href="/gostd/net/dnsmsg.go.html#3232893">rr</a></span><span class="op" id="3232975">.</span><span class="ident" id="3232976"><a href="/gostd/net/dnsmsg.go.html#3232771">Hdr</a></span><span class="op" id="3232979">.</span><span class="ident" id="3232980"><a href="/gostd/net/dnsmsg.go.html#3231557">Walk</a></span><span class="op" id="3232984">(</span><span class="ident" id="3232985"><a href="/gostd/net/dnsmsg.go.html#3232912">f</a></span><span class="op" id="3232986">)</span>&nbsp;<span class="op" id="3232988">&amp;&amp;</span>&nbsp;<span class="ident" id="3232991"><a href="/gostd/net/dnsmsg.go.html#3232912">f</a></span><span class="op" id="3232992">(</span><span class="op" id="3232993">&amp;</span><span class="ident" id="3232994"><a href="/gostd/net/dnsmsg.go.html#3232893">rr</a></span><span class="op" id="3232996">.</span><span class="ident" id="3232997"><a href="/gostd/net/dnsmsg.go.html#3232789">Mg</a></span><span class="op" id="3232999">,</span>&nbsp;<span class="string" id="3233001">&#34;Mg&#34;</span><span class="op" id="3233005">,</span>&nbsp;<span class="string" id="3233007">&#34;domain&#34;</span><span class="op" id="3233015">)</span><br>
<span class="lineno"></span><span class="op" id="3233017">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="keyword" id="3233020">type</span>&nbsp;<span class="ident" id="3233025">dnsRR_MINFO</span>&nbsp;<span class="keyword" id="3233037">struct</span>&nbsp;<span class="op" id="3233044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3233047">Hdr</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3233053"><a href="/gostd/net/dnsmsg.go.html#3231312">dnsRR_Header</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3233067">Rmail</span>&nbsp;<span class="builtintype" id="3233073">string</span>&nbsp;<span class="string" id="3233080">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3233101">Email</span>&nbsp;<span class="builtintype" id="3233107">string</span>&nbsp;<span class="string" id="3233114">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno">210</span><span class="op" id="3233134">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3233137">func</span>&nbsp;<span class="op" id="3233142">(</span><span class="ident" id="3233143">rr</span>&nbsp;<span class="op" id="3233146">*</span><span class="ident" id="3233147"><a href="/gostd/net/dnsmsg.go.html#3233025">dnsRR_MINFO</a></span><span class="op" id="3233158">)</span>&nbsp;<span class="ident" id="3233160">Header</span><span class="op" id="3233166">(</span><span class="op" id="3233167">)</span>&nbsp;<span class="op" id="3233169">*</span><span class="ident" id="3233170"><a href="/gostd/net/dnsmsg.go.html#3231312">dnsRR_Header</a></span>&nbsp;<span class="op" id="3233183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3233186">return</span>&nbsp;<span class="op" id="3233193">&amp;</span><span class="ident" id="3233194"><a href="/gostd/net/dnsmsg.go.html#3233143">rr</a></span><span class="op" id="3233196">.</span><span class="ident" id="3233197"><a href="/gostd/net/dnsmsg.go.html#3233047">Hdr</a></span><br>
<span class="lineno"></span><span class="op" id="3233201">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="keyword" id="3233204">func</span>&nbsp;<span class="op" id="3233209">(</span><span class="ident" id="3233210">rr</span>&nbsp;<span class="op" id="3233213">*</span><span class="ident" id="3233214"><a href="/gostd/net/dnsmsg.go.html#3233025">dnsRR_MINFO</a></span><span class="op" id="3233225">)</span>&nbsp;<span class="ident" id="3233227">Walk</span><span class="op" id="3233231">(</span><span class="ident" id="3233232">f</span>&nbsp;<span class="keyword" id="3233234">func</span><span class="op" id="3233238">(</span><span class="ident" id="3233239">v</span>&nbsp;<span class="keyword" id="3233241">interface</span><span class="op" id="3233250">{</span><span class="op" id="3233251">}</span><span class="op" id="3233252">,</span>&nbsp;<span class="ident" id="3233254">name</span><span class="op" id="3233258">,</span>&nbsp;<span class="ident" id="3233260">tag</span>&nbsp;<span class="builtintype" id="3233264">string</span><span class="op" id="3233270">)</span>&nbsp;<span class="builtintype" id="3233272">bool</span><span class="op" id="3233276">)</span>&nbsp;<span class="builtintype" id="3233278">bool</span>&nbsp;<span class="op" id="3233283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3233286">return</span>&nbsp;<span class="ident" id="3233293"><a href="/gostd/net/dnsmsg.go.html#3233210">rr</a></span><span class="op" id="3233295">.</span><span class="ident" id="3233296"><a href="/gostd/net/dnsmsg.go.html#3233047">Hdr</a></span><span class="op" id="3233299">.</span><span class="ident" id="3233300"><a href="/gostd/net/dnsmsg.go.html#3231557">Walk</a></span><span class="op" id="3233304">(</span><span class="ident" id="3233305"><a href="/gostd/net/dnsmsg.go.html#3233232">f</a></span><span class="op" id="3233306">)</span>&nbsp;<span class="op" id="3233308">&amp;&amp;</span>&nbsp;<span class="ident" id="3233311"><a href="/gostd/net/dnsmsg.go.html#3233232">f</a></span><span class="op" id="3233312">(</span><span class="op" id="3233313">&amp;</span><span class="ident" id="3233314"><a href="/gostd/net/dnsmsg.go.html#3233210">rr</a></span><span class="op" id="3233316">.</span><span class="ident" id="3233317"><a href="/gostd/net/dnsmsg.go.html#3233067">Rmail</a></span><span class="op" id="3233322">,</span>&nbsp;<span class="string" id="3233324">&#34;Rmail&#34;</span><span class="op" id="3233331">,</span>&nbsp;<span class="string" id="3233333">&#34;domain&#34;</span><span class="op" id="3233341">)</span>&nbsp;<span class="op" id="3233343">&amp;&amp;</span>&nbsp;<span class="ident" id="3233346"><a href="/gostd/net/dnsmsg.go.html#3233232">f</a></span><span class="op" id="3233347">(</span><span class="op" id="3233348">&amp;</span><span class="ident" id="3233349"><a href="/gostd/net/dnsmsg.go.html#3233210">rr</a></span><span class="op" id="3233351">.</span><span class="ident" id="3233352"><a href="/gostd/net/dnsmsg.go.html#3233101">Email</a></span><span class="op" id="3233357">,</span>&nbsp;<span class="string" id="3233359">&#34;Email&#34;</span><span class="op" id="3233366">,</span>&nbsp;<span class="string" id="3233368">&#34;domain&#34;</span><span class="op" id="3233376">)</span><br>
<span class="lineno"></span><span class="op" id="3233378">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="keyword" id="3233381">type</span>&nbsp;<span class="ident" id="3233386">dnsRR_MR</span>&nbsp;<span class="keyword" id="3233395">struct</span>&nbsp;<span class="op" id="3233402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3233405">Hdr</span>&nbsp;<span class="ident" id="3233409"><a href="/gostd/net/dnsmsg.go.html#3231312">dnsRR_Header</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3233423">Mr</span>&nbsp;&nbsp;<span class="builtintype" id="3233427">string</span>&nbsp;<span class="string" id="3233434">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3233454">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span><span class="keyword" id="3233457">func</span>&nbsp;<span class="op" id="3233462">(</span><span class="ident" id="3233463">rr</span>&nbsp;<span class="op" id="3233466">*</span><span class="ident" id="3233467"><a href="/gostd/net/dnsmsg.go.html#3233386">dnsRR_MR</a></span><span class="op" id="3233475">)</span>&nbsp;<span class="ident" id="3233477">Header</span><span class="op" id="3233483">(</span><span class="op" id="3233484">)</span>&nbsp;<span class="op" id="3233486">*</span><span class="ident" id="3233487"><a href="/gostd/net/dnsmsg.go.html#3231312">dnsRR_Header</a></span>&nbsp;<span class="op" id="3233500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3233503">return</span>&nbsp;<span class="op" id="3233510">&amp;</span><span class="ident" id="3233511"><a href="/gostd/net/dnsmsg.go.html#3233463">rr</a></span><span class="op" id="3233513">.</span><span class="ident" id="3233514"><a href="/gostd/net/dnsmsg.go.html#3233405">Hdr</a></span><br>
<span class="lineno"></span><span class="op" id="3233518">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3233521">func</span>&nbsp;<span class="op" id="3233526">(</span><span class="ident" id="3233527">rr</span>&nbsp;<span class="op" id="3233530">*</span><span class="ident" id="3233531"><a href="/gostd/net/dnsmsg.go.html#3233386">dnsRR_MR</a></span><span class="op" id="3233539">)</span>&nbsp;<span class="ident" id="3233541">Walk</span><span class="op" id="3233545">(</span><span class="ident" id="3233546">f</span>&nbsp;<span class="keyword" id="3233548">func</span><span class="op" id="3233552">(</span><span class="ident" id="3233553">v</span>&nbsp;<span class="keyword" id="3233555">interface</span><span class="op" id="3233564">{</span><span class="op" id="3233565">}</span><span class="op" id="3233566">,</span>&nbsp;<span class="ident" id="3233568">name</span><span class="op" id="3233572">,</span>&nbsp;<span class="ident" id="3233574">tag</span>&nbsp;<span class="builtintype" id="3233578">string</span><span class="op" id="3233584">)</span>&nbsp;<span class="builtintype" id="3233586">bool</span><span class="op" id="3233590">)</span>&nbsp;<span class="builtintype" id="3233592">bool</span>&nbsp;<span class="op" id="3233597">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3233600">return</span>&nbsp;<span class="ident" id="3233607"><a href="/gostd/net/dnsmsg.go.html#3233527">rr</a></span><span class="op" id="3233609">.</span><span class="ident" id="3233610"><a href="/gostd/net/dnsmsg.go.html#3233405">Hdr</a></span><span class="op" id="3233613">.</span><span class="ident" id="3233614"><a href="/gostd/net/dnsmsg.go.html#3231557">Walk</a></span><span class="op" id="3233618">(</span><span class="ident" id="3233619"><a href="/gostd/net/dnsmsg.go.html#3233546">f</a></span><span class="op" id="3233620">)</span>&nbsp;<span class="op" id="3233622">&amp;&amp;</span>&nbsp;<span class="ident" id="3233625"><a href="/gostd/net/dnsmsg.go.html#3233546">f</a></span><span class="op" id="3233626">(</span><span class="op" id="3233627">&amp;</span><span class="ident" id="3233628"><a href="/gostd/net/dnsmsg.go.html#3233527">rr</a></span><span class="op" id="3233630">.</span><span class="ident" id="3233631"><a href="/gostd/net/dnsmsg.go.html#3233423">Mr</a></span><span class="op" id="3233633">,</span>&nbsp;<span class="string" id="3233635">&#34;Mr&#34;</span><span class="op" id="3233639">,</span>&nbsp;<span class="string" id="3233641">&#34;domain&#34;</span><span class="op" id="3233649">)</span><br>
<span class="lineno"></span><span class="op" id="3233651">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3233654">type</span>&nbsp;<span class="ident" id="3233659">dnsRR_MX</span>&nbsp;<span class="keyword" id="3233668">struct</span>&nbsp;<span class="op" id="3233675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3233678">Hdr</span>&nbsp;&nbsp;<span class="ident" id="3233683"><a href="/gostd/net/dnsmsg.go.html#3231312">dnsRR_Header</a></span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3233697">Pref</span>&nbsp;<span class="builtintype" id="3233702">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3233710">Mx</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3233715">string</span>&nbsp;<span class="string" id="3233722">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3233742">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3233745">func</span>&nbsp;<span class="op" id="3233750">(</span><span class="ident" id="3233751">rr</span>&nbsp;<span class="op" id="3233754">*</span><span class="ident" id="3233755"><a href="/gostd/net/dnsmsg.go.html#3233659">dnsRR_MX</a></span><span class="op" id="3233763">)</span>&nbsp;<span class="ident" id="3233765">Header</span><span class="op" id="3233771">(</span><span class="op" id="3233772">)</span>&nbsp;<span class="op" id="3233774">*</span><span class="ident" id="3233775"><a href="/gostd/net/dnsmsg.go.html#3231312">dnsRR_Header</a></span>&nbsp;<span class="op" id="3233788">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3233791">return</span>&nbsp;<span class="op" id="3233798">&amp;</span><span class="ident" id="3233799"><a href="/gostd/net/dnsmsg.go.html#3233751">rr</a></span><span class="op" id="3233801">.</span><span class="ident" id="3233802"><a href="/gostd/net/dnsmsg.go.html#3233678">Hdr</a></span><br>
<span class="lineno"></span><span class="op" id="3233806">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3233809">func</span>&nbsp;<span class="op" id="3233814">(</span><span class="ident" id="3233815">rr</span>&nbsp;<span class="op" id="3233818">*</span><span class="ident" id="3233819"><a href="/gostd/net/dnsmsg.go.html#3233659">dnsRR_MX</a></span><span class="op" id="3233827">)</span>&nbsp;<span class="ident" id="3233829">Walk</span><span class="op" id="3233833">(</span><span class="ident" id="3233834">f</span>&nbsp;<span class="keyword" id="3233836">func</span><span class="op" id="3233840">(</span><span class="ident" id="3233841">v</span>&nbsp;<span class="keyword" id="3233843">interface</span><span class="op" id="3233852">{</span><span class="op" id="3233853">}</span><span class="op" id="3233854">,</span>&nbsp;<span class="ident" id="3233856">name</span><span class="op" id="3233860">,</span>&nbsp;<span class="ident" id="3233862">tag</span>&nbsp;<span class="builtintype" id="3233866">string</span><span class="op" id="3233872">)</span>&nbsp;<span class="builtintype" id="3233874">bool</span><span class="op" id="3233878">)</span>&nbsp;<span class="builtintype" id="3233880">bool</span>&nbsp;<span class="op" id="3233885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3233888">return</span>&nbsp;<span class="ident" id="3233895"><a href="/gostd/net/dnsmsg.go.html#3233815">rr</a></span><span class="op" id="3233897">.</span><span class="ident" id="3233898"><a href="/gostd/net/dnsmsg.go.html#3233678">Hdr</a></span><span class="op" id="3233901">.</span><span class="ident" id="3233902"><a href="/gostd/net/dnsmsg.go.html#3231557">Walk</a></span><span class="op" id="3233906">(</span><span class="ident" id="3233907"><a href="/gostd/net/dnsmsg.go.html#3233834">f</a></span><span class="op" id="3233908">)</span>&nbsp;<span class="op" id="3233910">&amp;&amp;</span>&nbsp;<span class="ident" id="3233913"><a href="/gostd/net/dnsmsg.go.html#3233834">f</a></span><span class="op" id="3233914">(</span><span class="op" id="3233915">&amp;</span><span class="ident" id="3233916"><a href="/gostd/net/dnsmsg.go.html#3233815">rr</a></span><span class="op" id="3233918">.</span><span class="ident" id="3233919"><a href="/gostd/net/dnsmsg.go.html#3233697">Pref</a></span><span class="op" id="3233923">,</span>&nbsp;<span class="string" id="3233925">&#34;Pref&#34;</span><span class="op" id="3233931">,</span>&nbsp;<span class="string" id="3233933">&#34;&#34;</span><span class="op" id="3233935">)</span>&nbsp;<span class="op" id="3233937">&amp;&amp;</span>&nbsp;<span class="ident" id="3233940"><a href="/gostd/net/dnsmsg.go.html#3233834">f</a></span><span class="op" id="3233941">(</span><span class="op" id="3233942">&amp;</span><span class="ident" id="3233943"><a href="/gostd/net/dnsmsg.go.html#3233815">rr</a></span><span class="op" id="3233945">.</span><span class="ident" id="3233946"><a href="/gostd/net/dnsmsg.go.html#3233710">Mx</a></span><span class="op" id="3233948">,</span>&nbsp;<span class="string" id="3233950">&#34;Mx&#34;</span><span class="op" id="3233954">,</span>&nbsp;<span class="string" id="3233956">&#34;domain&#34;</span><span class="op" id="3233964">)</span><br>
<span class="lineno">245</span><span class="op" id="3233966">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3233969">type</span>&nbsp;<span class="ident" id="3233974">dnsRR_NS</span>&nbsp;<span class="keyword" id="3233983">struct</span>&nbsp;<span class="op" id="3233990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3233993">Hdr</span>&nbsp;<span class="ident" id="3233997"><a href="/gostd/net/dnsmsg.go.html#3231312">dnsRR_Header</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3234011">Ns</span>&nbsp;&nbsp;<span class="builtintype" id="3234015">string</span>&nbsp;<span class="string" id="3234022">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno">250</span><span class="op" id="3234042">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3234045">func</span>&nbsp;<span class="op" id="3234050">(</span><span class="ident" id="3234051">rr</span>&nbsp;<span class="op" id="3234054">*</span><span class="ident" id="3234055"><a href="/gostd/net/dnsmsg.go.html#3233974">dnsRR_NS</a></span><span class="op" id="3234063">)</span>&nbsp;<span class="ident" id="3234065">Header</span><span class="op" id="3234071">(</span><span class="op" id="3234072">)</span>&nbsp;<span class="op" id="3234074">*</span><span class="ident" id="3234075"><a href="/gostd/net/dnsmsg.go.html#3231312">dnsRR_Header</a></span>&nbsp;<span class="op" id="3234088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3234091">return</span>&nbsp;<span class="op" id="3234098">&amp;</span><span class="ident" id="3234099"><a href="/gostd/net/dnsmsg.go.html#3234051">rr</a></span><span class="op" id="3234101">.</span><span class="ident" id="3234102"><a href="/gostd/net/dnsmsg.go.html#3233993">Hdr</a></span><br>
<span class="lineno"></span><span class="op" id="3234106">}</span><br>
<span class="lineno">255</span><br>
<span class="lineno"></span><span class="keyword" id="3234109">func</span>&nbsp;<span class="op" id="3234114">(</span><span class="ident" id="3234115">rr</span>&nbsp;<span class="op" id="3234118">*</span><span class="ident" id="3234119"><a href="/gostd/net/dnsmsg.go.html#3233974">dnsRR_NS</a></span><span class="op" id="3234127">)</span>&nbsp;<span class="ident" id="3234129">Walk</span><span class="op" id="3234133">(</span><span class="ident" id="3234134">f</span>&nbsp;<span class="keyword" id="3234136">func</span><span class="op" id="3234140">(</span><span class="ident" id="3234141">v</span>&nbsp;<span class="keyword" id="3234143">interface</span><span class="op" id="3234152">{</span><span class="op" id="3234153">}</span><span class="op" id="3234154">,</span>&nbsp;<span class="ident" id="3234156">name</span><span class="op" id="3234160">,</span>&nbsp;<span class="ident" id="3234162">tag</span>&nbsp;<span class="builtintype" id="3234166">string</span><span class="op" id="3234172">)</span>&nbsp;<span class="builtintype" id="3234174">bool</span><span class="op" id="3234178">)</span>&nbsp;<span class="builtintype" id="3234180">bool</span>&nbsp;<span class="op" id="3234185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3234188">return</span>&nbsp;<span class="ident" id="3234195"><a href="/gostd/net/dnsmsg.go.html#3234115">rr</a></span><span class="op" id="3234197">.</span><span class="ident" id="3234198"><a href="/gostd/net/dnsmsg.go.html#3233993">Hdr</a></span><span class="op" id="3234201">.</span><span class="ident" id="3234202"><a href="/gostd/net/dnsmsg.go.html#3231557">Walk</a></span><span class="op" id="3234206">(</span><span class="ident" id="3234207"><a href="/gostd/net/dnsmsg.go.html#3234134">f</a></span><span class="op" id="3234208">)</span>&nbsp;<span class="op" id="3234210">&amp;&amp;</span>&nbsp;<span class="ident" id="3234213"><a href="/gostd/net/dnsmsg.go.html#3234134">f</a></span><span class="op" id="3234214">(</span><span class="op" id="3234215">&amp;</span><span class="ident" id="3234216"><a href="/gostd/net/dnsmsg.go.html#3234115">rr</a></span><span class="op" id="3234218">.</span><span class="ident" id="3234219"><a href="/gostd/net/dnsmsg.go.html#3234011">Ns</a></span><span class="op" id="3234221">,</span>&nbsp;<span class="string" id="3234223">&#34;Ns&#34;</span><span class="op" id="3234227">,</span>&nbsp;<span class="string" id="3234229">&#34;domain&#34;</span><span class="op" id="3234237">)</span><br>
<span class="lineno"></span><span class="op" id="3234239">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="keyword" id="3234242">type</span>&nbsp;<span class="ident" id="3234247">dnsRR_PTR</span>&nbsp;<span class="keyword" id="3234257">struct</span>&nbsp;<span class="op" id="3234264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3234267">Hdr</span>&nbsp;<span class="ident" id="3234271"><a href="/gostd/net/dnsmsg.go.html#3231312">dnsRR_Header</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3234285">Ptr</span>&nbsp;<span class="builtintype" id="3234289">string</span>&nbsp;<span class="string" id="3234296">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3234316">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="keyword" id="3234319">func</span>&nbsp;<span class="op" id="3234324">(</span><span class="ident" id="3234325">rr</span>&nbsp;<span class="op" id="3234328">*</span><span class="ident" id="3234329"><a href="/gostd/net/dnsmsg.go.html#3234247">dnsRR_PTR</a></span><span class="op" id="3234338">)</span>&nbsp;<span class="ident" id="3234340">Header</span><span class="op" id="3234346">(</span><span class="op" id="3234347">)</span>&nbsp;<span class="op" id="3234349">*</span><span class="ident" id="3234350"><a href="/gostd/net/dnsmsg.go.html#3231312">dnsRR_Header</a></span>&nbsp;<span class="op" id="3234363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3234366">return</span>&nbsp;<span class="op" id="3234373">&amp;</span><span class="ident" id="3234374"><a href="/gostd/net/dnsmsg.go.html#3234325">rr</a></span><span class="op" id="3234376">.</span><span class="ident" id="3234377"><a href="/gostd/net/dnsmsg.go.html#3234267">Hdr</a></span><br>
<span class="lineno"></span><span class="op" id="3234381">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3234384">func</span>&nbsp;<span class="op" id="3234389">(</span><span class="ident" id="3234390">rr</span>&nbsp;<span class="op" id="3234393">*</span><span class="ident" id="3234394"><a href="/gostd/net/dnsmsg.go.html#3234247">dnsRR_PTR</a></span><span class="op" id="3234403">)</span>&nbsp;<span class="ident" id="3234405">Walk</span><span class="op" id="3234409">(</span><span class="ident" id="3234410">f</span>&nbsp;<span class="keyword" id="3234412">func</span><span class="op" id="3234416">(</span><span class="ident" id="3234417">v</span>&nbsp;<span class="keyword" id="3234419">interface</span><span class="op" id="3234428">{</span><span class="op" id="3234429">}</span><span class="op" id="3234430">,</span>&nbsp;<span class="ident" id="3234432">name</span><span class="op" id="3234436">,</span>&nbsp;<span class="ident" id="3234438">tag</span>&nbsp;<span class="builtintype" id="3234442">string</span><span class="op" id="3234448">)</span>&nbsp;<span class="builtintype" id="3234450">bool</span><span class="op" id="3234454">)</span>&nbsp;<span class="builtintype" id="3234456">bool</span>&nbsp;<span class="op" id="3234461">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3234464">return</span>&nbsp;<span class="ident" id="3234471"><a href="/gostd/net/dnsmsg.go.html#3234390">rr</a></span><span class="op" id="3234473">.</span><span class="ident" id="3234474"><a href="/gostd/net/dnsmsg.go.html#3234267">Hdr</a></span><span class="op" id="3234477">.</span><span class="ident" id="3234478"><a href="/gostd/net/dnsmsg.go.html#3231557">Walk</a></span><span class="op" id="3234482">(</span><span class="ident" id="3234483"><a href="/gostd/net/dnsmsg.go.html#3234410">f</a></span><span class="op" id="3234484">)</span>&nbsp;<span class="op" id="3234486">&amp;&amp;</span>&nbsp;<span class="ident" id="3234489"><a href="/gostd/net/dnsmsg.go.html#3234410">f</a></span><span class="op" id="3234490">(</span><span class="op" id="3234491">&amp;</span><span class="ident" id="3234492"><a href="/gostd/net/dnsmsg.go.html#3234390">rr</a></span><span class="op" id="3234494">.</span><span class="ident" id="3234495"><a href="/gostd/net/dnsmsg.go.html#3234285">Ptr</a></span><span class="op" id="3234498">,</span>&nbsp;<span class="string" id="3234500">&#34;Ptr&#34;</span><span class="op" id="3234505">,</span>&nbsp;<span class="string" id="3234507">&#34;domain&#34;</span><span class="op" id="3234515">)</span><br>
<span class="lineno"></span><span class="op" id="3234517">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3234520">type</span>&nbsp;<span class="ident" id="3234525">dnsRR_SOA</span>&nbsp;<span class="keyword" id="3234535">struct</span>&nbsp;<span class="op" id="3234542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3234545">Hdr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3234553"><a href="/gostd/net/dnsmsg.go.html#3231312">dnsRR_Header</a></span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3234567">Ns</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3234575">string</span>&nbsp;<span class="string" id="3234582">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3234603">Mbox</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3234611">string</span>&nbsp;<span class="string" id="3234618">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3234639">Serial</span>&nbsp;&nbsp;<span class="builtintype" id="3234647">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3234655">Refresh</span>&nbsp;<span class="builtintype" id="3234663">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3234671">Retry</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3234679">uint32</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3234687">Expire</span>&nbsp;&nbsp;<span class="builtintype" id="3234695">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3234703">Minttl</span>&nbsp;&nbsp;<span class="builtintype" id="3234711">uint32</span><br>
<span class="lineno"></span><span class="op" id="3234718">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3234721">func</span>&nbsp;<span class="op" id="3234726">(</span><span class="ident" id="3234727">rr</span>&nbsp;<span class="op" id="3234730">*</span><span class="ident" id="3234731"><a href="/gostd/net/dnsmsg.go.html#3234525">dnsRR_SOA</a></span><span class="op" id="3234740">)</span>&nbsp;<span class="ident" id="3234742">Header</span><span class="op" id="3234748">(</span><span class="op" id="3234749">)</span>&nbsp;<span class="op" id="3234751">*</span><span class="ident" id="3234752"><a href="/gostd/net/dnsmsg.go.html#3231312">dnsRR_Header</a></span>&nbsp;<span class="op" id="3234765">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3234768">return</span>&nbsp;<span class="op" id="3234775">&amp;</span><span class="ident" id="3234776"><a href="/gostd/net/dnsmsg.go.html#3234727">rr</a></span><span class="op" id="3234778">.</span><span class="ident" id="3234779"><a href="/gostd/net/dnsmsg.go.html#3234545">Hdr</a></span><br>
<span class="lineno"></span><span class="op" id="3234783">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3234786">func</span>&nbsp;<span class="op" id="3234791">(</span><span class="ident" id="3234792">rr</span>&nbsp;<span class="op" id="3234795">*</span><span class="ident" id="3234796"><a href="/gostd/net/dnsmsg.go.html#3234525">dnsRR_SOA</a></span><span class="op" id="3234805">)</span>&nbsp;<span class="ident" id="3234807">Walk</span><span class="op" id="3234811">(</span><span class="ident" id="3234812">f</span>&nbsp;<span class="keyword" id="3234814">func</span><span class="op" id="3234818">(</span><span class="ident" id="3234819">v</span>&nbsp;<span class="keyword" id="3234821">interface</span><span class="op" id="3234830">{</span><span class="op" id="3234831">}</span><span class="op" id="3234832">,</span>&nbsp;<span class="ident" id="3234834">name</span><span class="op" id="3234838">,</span>&nbsp;<span class="ident" id="3234840">tag</span>&nbsp;<span class="builtintype" id="3234844">string</span><span class="op" id="3234850">)</span>&nbsp;<span class="builtintype" id="3234852">bool</span><span class="op" id="3234856">)</span>&nbsp;<span class="builtintype" id="3234858">bool</span>&nbsp;<span class="op" id="3234863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3234866">return</span>&nbsp;<span class="ident" id="3234873"><a href="/gostd/net/dnsmsg.go.html#3234792">rr</a></span><span class="op" id="3234875">.</span><span class="ident" id="3234876"><a href="/gostd/net/dnsmsg.go.html#3234545">Hdr</a></span><span class="op" id="3234879">.</span><span class="ident" id="3234880"><a href="/gostd/net/dnsmsg.go.html#3231557">Walk</a></span><span class="op" id="3234884">(</span><span class="ident" id="3234885"><a href="/gostd/net/dnsmsg.go.html#3234812">f</a></span><span class="op" id="3234886">)</span>&nbsp;<span class="op" id="3234888">&amp;&amp;</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3234893"><a href="/gostd/net/dnsmsg.go.html#3234812">f</a></span><span class="op" id="3234894">(</span><span class="op" id="3234895">&amp;</span><span class="ident" id="3234896"><a href="/gostd/net/dnsmsg.go.html#3234792">rr</a></span><span class="op" id="3234898">.</span><span class="ident" id="3234899"><a href="/gostd/net/dnsmsg.go.html#3234567">Ns</a></span><span class="op" id="3234901">,</span>&nbsp;<span class="string" id="3234903">&#34;Ns&#34;</span><span class="op" id="3234907">,</span>&nbsp;<span class="string" id="3234909">&#34;domain&#34;</span><span class="op" id="3234917">)</span>&nbsp;<span class="op" id="3234919">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3234924"><a href="/gostd/net/dnsmsg.go.html#3234812">f</a></span><span class="op" id="3234925">(</span><span class="op" id="3234926">&amp;</span><span class="ident" id="3234927"><a href="/gostd/net/dnsmsg.go.html#3234792">rr</a></span><span class="op" id="3234929">.</span><span class="ident" id="3234930"><a href="/gostd/net/dnsmsg.go.html#3234603">Mbox</a></span><span class="op" id="3234934">,</span>&nbsp;<span class="string" id="3234936">&#34;Mbox&#34;</span><span class="op" id="3234942">,</span>&nbsp;<span class="string" id="3234944">&#34;domain&#34;</span><span class="op" id="3234952">)</span>&nbsp;<span class="op" id="3234954">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3234959"><a href="/gostd/net/dnsmsg.go.html#3234812">f</a></span><span class="op" id="3234960">(</span><span class="op" id="3234961">&amp;</span><span class="ident" id="3234962"><a href="/gostd/net/dnsmsg.go.html#3234792">rr</a></span><span class="op" id="3234964">.</span><span class="ident" id="3234965"><a href="/gostd/net/dnsmsg.go.html#3234639">Serial</a></span><span class="op" id="3234971">,</span>&nbsp;<span class="string" id="3234973">&#34;Serial&#34;</span><span class="op" id="3234981">,</span>&nbsp;<span class="string" id="3234983">&#34;&#34;</span><span class="op" id="3234985">)</span>&nbsp;<span class="op" id="3234987">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3234992"><a href="/gostd/net/dnsmsg.go.html#3234812">f</a></span><span class="op" id="3234993">(</span><span class="op" id="3234994">&amp;</span><span class="ident" id="3234995"><a href="/gostd/net/dnsmsg.go.html#3234792">rr</a></span><span class="op" id="3234997">.</span><span class="ident" id="3234998"><a href="/gostd/net/dnsmsg.go.html#3234655">Refresh</a></span><span class="op" id="3235005">,</span>&nbsp;<span class="string" id="3235007">&#34;Refresh&#34;</span><span class="op" id="3235016">,</span>&nbsp;<span class="string" id="3235018">&#34;&#34;</span><span class="op" id="3235020">)</span>&nbsp;<span class="op" id="3235022">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3235027"><a href="/gostd/net/dnsmsg.go.html#3234812">f</a></span><span class="op" id="3235028">(</span><span class="op" id="3235029">&amp;</span><span class="ident" id="3235030"><a href="/gostd/net/dnsmsg.go.html#3234792">rr</a></span><span class="op" id="3235032">.</span><span class="ident" id="3235033"><a href="/gostd/net/dnsmsg.go.html#3234671">Retry</a></span><span class="op" id="3235038">,</span>&nbsp;<span class="string" id="3235040">&#34;Retry&#34;</span><span class="op" id="3235047">,</span>&nbsp;<span class="string" id="3235049">&#34;&#34;</span><span class="op" id="3235051">)</span>&nbsp;<span class="op" id="3235053">&amp;&amp;</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3235058"><a href="/gostd/net/dnsmsg.go.html#3234812">f</a></span><span class="op" id="3235059">(</span><span class="op" id="3235060">&amp;</span><span class="ident" id="3235061"><a href="/gostd/net/dnsmsg.go.html#3234792">rr</a></span><span class="op" id="3235063">.</span><span class="ident" id="3235064"><a href="/gostd/net/dnsmsg.go.html#3234687">Expire</a></span><span class="op" id="3235070">,</span>&nbsp;<span class="string" id="3235072">&#34;Expire&#34;</span><span class="op" id="3235080">,</span>&nbsp;<span class="string" id="3235082">&#34;&#34;</span><span class="op" id="3235084">)</span>&nbsp;<span class="op" id="3235086">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3235091"><a href="/gostd/net/dnsmsg.go.html#3234812">f</a></span><span class="op" id="3235092">(</span><span class="op" id="3235093">&amp;</span><span class="ident" id="3235094"><a href="/gostd/net/dnsmsg.go.html#3234792">rr</a></span><span class="op" id="3235096">.</span><span class="ident" id="3235097"><a href="/gostd/net/dnsmsg.go.html#3234703">Minttl</a></span><span class="op" id="3235103">,</span>&nbsp;<span class="string" id="3235105">&#34;Minttl&#34;</span><span class="op" id="3235113">,</span>&nbsp;<span class="string" id="3235115">&#34;&#34;</span><span class="op" id="3235117">)</span><br>
<span class="lineno"></span><span class="op" id="3235119">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3235122">type</span>&nbsp;<span class="ident" id="3235127">dnsRR_TXT</span>&nbsp;<span class="keyword" id="3235137">struct</span>&nbsp;<span class="op" id="3235144">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3235147">Hdr</span>&nbsp;<span class="ident" id="3235151"><a href="/gostd/net/dnsmsg.go.html#3231312">dnsRR_Header</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3235165">Txt</span>&nbsp;<span class="builtintype" id="3235169">string</span>&nbsp;<span class="comment" id="3235176">//&nbsp;not&nbsp;domain&nbsp;name</span><br>
<span class="lineno"></span><span class="op" id="3235195">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3235198">func</span>&nbsp;<span class="op" id="3235203">(</span><span class="ident" id="3235204">rr</span>&nbsp;<span class="op" id="3235207">*</span><span class="ident" id="3235208"><a href="/gostd/net/dnsmsg.go.html#3235127">dnsRR_TXT</a></span><span class="op" id="3235217">)</span>&nbsp;<span class="ident" id="3235219">Header</span><span class="op" id="3235225">(</span><span class="op" id="3235226">)</span>&nbsp;<span class="op" id="3235228">*</span><span class="ident" id="3235229"><a href="/gostd/net/dnsmsg.go.html#3231312">dnsRR_Header</a></span>&nbsp;<span class="op" id="3235242">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3235245">return</span>&nbsp;<span class="op" id="3235252">&amp;</span><span class="ident" id="3235253"><a href="/gostd/net/dnsmsg.go.html#3235204">rr</a></span><span class="op" id="3235255">.</span><span class="ident" id="3235256"><a href="/gostd/net/dnsmsg.go.html#3235147">Hdr</a></span><br>
<span class="lineno"></span><span class="op" id="3235260">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3235263">func</span>&nbsp;<span class="op" id="3235268">(</span><span class="ident" id="3235269">rr</span>&nbsp;<span class="op" id="3235272">*</span><span class="ident" id="3235273"><a href="/gostd/net/dnsmsg.go.html#3235127">dnsRR_TXT</a></span><span class="op" id="3235282">)</span>&nbsp;<span class="ident" id="3235284">Walk</span><span class="op" id="3235288">(</span><span class="ident" id="3235289">f</span>&nbsp;<span class="keyword" id="3235291">func</span><span class="op" id="3235295">(</span><span class="ident" id="3235296">v</span>&nbsp;<span class="keyword" id="3235298">interface</span><span class="op" id="3235307">{</span><span class="op" id="3235308">}</span><span class="op" id="3235309">,</span>&nbsp;<span class="ident" id="3235311">name</span><span class="op" id="3235315">,</span>&nbsp;<span class="ident" id="3235317">tag</span>&nbsp;<span class="builtintype" id="3235321">string</span><span class="op" id="3235327">)</span>&nbsp;<span class="builtintype" id="3235329">bool</span><span class="op" id="3235333">)</span>&nbsp;<span class="builtintype" id="3235335">bool</span>&nbsp;<span class="op" id="3235340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3235343">return</span>&nbsp;<span class="ident" id="3235350"><a href="/gostd/net/dnsmsg.go.html#3235269">rr</a></span><span class="op" id="3235352">.</span><span class="ident" id="3235353"><a href="/gostd/net/dnsmsg.go.html#3235147">Hdr</a></span><span class="op" id="3235356">.</span><span class="ident" id="3235357"><a href="/gostd/net/dnsmsg.go.html#3231557">Walk</a></span><span class="op" id="3235361">(</span><span class="ident" id="3235362"><a href="/gostd/net/dnsmsg.go.html#3235289">f</a></span><span class="op" id="3235363">)</span>&nbsp;<span class="op" id="3235365">&amp;&amp;</span>&nbsp;<span class="ident" id="3235368"><a href="/gostd/net/dnsmsg.go.html#3235289">f</a></span><span class="op" id="3235369">(</span><span class="op" id="3235370">&amp;</span><span class="ident" id="3235371"><a href="/gostd/net/dnsmsg.go.html#3235269">rr</a></span><span class="op" id="3235373">.</span><span class="ident" id="3235374"><a href="/gostd/net/dnsmsg.go.html#3235165">Txt</a></span><span class="op" id="3235377">,</span>&nbsp;<span class="string" id="3235379">&#34;Txt&#34;</span><span class="op" id="3235384">,</span>&nbsp;<span class="string" id="3235386">&#34;&#34;</span><span class="op" id="3235388">)</span><br>
<span class="lineno">310</span><span class="op" id="3235390">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3235393">type</span>&nbsp;<span class="ident" id="3235398">dnsRR_SRV</span>&nbsp;<span class="keyword" id="3235408">struct</span>&nbsp;<span class="op" id="3235415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3235418">Hdr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3235427"><a href="/gostd/net/dnsmsg.go.html#3231312">dnsRR_Header</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3235441">Priority</span>&nbsp;<span class="builtintype" id="3235450">uint16</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3235458">Weight</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3235467">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3235475">Port</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3235484">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3235492">Target</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3235501">string</span>&nbsp;<span class="string" id="3235508">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3235528">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span><span class="keyword" id="3235531">func</span>&nbsp;<span class="op" id="3235536">(</span><span class="ident" id="3235537">rr</span>&nbsp;<span class="op" id="3235540">*</span><span class="ident" id="3235541"><a href="/gostd/net/dnsmsg.go.html#3235398">dnsRR_SRV</a></span><span class="op" id="3235550">)</span>&nbsp;<span class="ident" id="3235552">Header</span><span class="op" id="3235558">(</span><span class="op" id="3235559">)</span>&nbsp;<span class="op" id="3235561">*</span><span class="ident" id="3235562"><a href="/gostd/net/dnsmsg.go.html#3231312">dnsRR_Header</a></span>&nbsp;<span class="op" id="3235575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3235578">return</span>&nbsp;<span class="op" id="3235585">&amp;</span><span class="ident" id="3235586"><a href="/gostd/net/dnsmsg.go.html#3235537">rr</a></span><span class="op" id="3235588">.</span><span class="ident" id="3235589"><a href="/gostd/net/dnsmsg.go.html#3235418">Hdr</a></span><br>
<span class="lineno"></span><span class="op" id="3235593">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3235596">func</span>&nbsp;<span class="op" id="3235601">(</span><span class="ident" id="3235602">rr</span>&nbsp;<span class="op" id="3235605">*</span><span class="ident" id="3235606"><a href="/gostd/net/dnsmsg.go.html#3235398">dnsRR_SRV</a></span><span class="op" id="3235615">)</span>&nbsp;<span class="ident" id="3235617">Walk</span><span class="op" id="3235621">(</span><span class="ident" id="3235622">f</span>&nbsp;<span class="keyword" id="3235624">func</span><span class="op" id="3235628">(</span><span class="ident" id="3235629">v</span>&nbsp;<span class="keyword" id="3235631">interface</span><span class="op" id="3235640">{</span><span class="op" id="3235641">}</span><span class="op" id="3235642">,</span>&nbsp;<span class="ident" id="3235644">name</span><span class="op" id="3235648">,</span>&nbsp;<span class="ident" id="3235650">tag</span>&nbsp;<span class="builtintype" id="3235654">string</span><span class="op" id="3235660">)</span>&nbsp;<span class="builtintype" id="3235662">bool</span><span class="op" id="3235666">)</span>&nbsp;<span class="builtintype" id="3235668">bool</span>&nbsp;<span class="op" id="3235673">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3235676">return</span>&nbsp;<span class="ident" id="3235683"><a href="/gostd/net/dnsmsg.go.html#3235602">rr</a></span><span class="op" id="3235685">.</span><span class="ident" id="3235686"><a href="/gostd/net/dnsmsg.go.html#3235418">Hdr</a></span><span class="op" id="3235689">.</span><span class="ident" id="3235690"><a href="/gostd/net/dnsmsg.go.html#3231557">Walk</a></span><span class="op" id="3235694">(</span><span class="ident" id="3235695"><a href="/gostd/net/dnsmsg.go.html#3235622">f</a></span><span class="op" id="3235696">)</span>&nbsp;<span class="op" id="3235698">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3235703"><a href="/gostd/net/dnsmsg.go.html#3235622">f</a></span><span class="op" id="3235704">(</span><span class="op" id="3235705">&amp;</span><span class="ident" id="3235706"><a href="/gostd/net/dnsmsg.go.html#3235602">rr</a></span><span class="op" id="3235708">.</span><span class="ident" id="3235709"><a href="/gostd/net/dnsmsg.go.html#3235441">Priority</a></span><span class="op" id="3235717">,</span>&nbsp;<span class="string" id="3235719">&#34;Priority&#34;</span><span class="op" id="3235729">,</span>&nbsp;<span class="string" id="3235731">&#34;&#34;</span><span class="op" id="3235733">)</span>&nbsp;<span class="op" id="3235735">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3235740"><a href="/gostd/net/dnsmsg.go.html#3235622">f</a></span><span class="op" id="3235741">(</span><span class="op" id="3235742">&amp;</span><span class="ident" id="3235743"><a href="/gostd/net/dnsmsg.go.html#3235602">rr</a></span><span class="op" id="3235745">.</span><span class="ident" id="3235746"><a href="/gostd/net/dnsmsg.go.html#3235458">Weight</a></span><span class="op" id="3235752">,</span>&nbsp;<span class="string" id="3235754">&#34;Weight&#34;</span><span class="op" id="3235762">,</span>&nbsp;<span class="string" id="3235764">&#34;&#34;</span><span class="op" id="3235766">)</span>&nbsp;<span class="op" id="3235768">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3235773"><a href="/gostd/net/dnsmsg.go.html#3235622">f</a></span><span class="op" id="3235774">(</span><span class="op" id="3235775">&amp;</span><span class="ident" id="3235776"><a href="/gostd/net/dnsmsg.go.html#3235602">rr</a></span><span class="op" id="3235778">.</span><span class="ident" id="3235779"><a href="/gostd/net/dnsmsg.go.html#3235475">Port</a></span><span class="op" id="3235783">,</span>&nbsp;<span class="string" id="3235785">&#34;Port&#34;</span><span class="op" id="3235791">,</span>&nbsp;<span class="string" id="3235793">&#34;&#34;</span><span class="op" id="3235795">)</span>&nbsp;<span class="op" id="3235797">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3235802"><a href="/gostd/net/dnsmsg.go.html#3235622">f</a></span><span class="op" id="3235803">(</span><span class="op" id="3235804">&amp;</span><span class="ident" id="3235805"><a href="/gostd/net/dnsmsg.go.html#3235602">rr</a></span><span class="op" id="3235807">.</span><span class="ident" id="3235808"><a href="/gostd/net/dnsmsg.go.html#3235492">Target</a></span><span class="op" id="3235814">,</span>&nbsp;<span class="string" id="3235816">&#34;Target&#34;</span><span class="op" id="3235824">,</span>&nbsp;<span class="string" id="3235826">&#34;domain&#34;</span><span class="op" id="3235834">)</span><br>
<span class="lineno">330</span><span class="op" id="3235836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3235839">type</span>&nbsp;<span class="ident" id="3235844">dnsRR_A</span>&nbsp;<span class="keyword" id="3235852">struct</span>&nbsp;<span class="op" id="3235859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3235862">Hdr</span>&nbsp;<span class="ident" id="3235866"><a href="/gostd/net/dnsmsg.go.html#3231312">dnsRR_Header</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3235880">A</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3235884">uint32</span>&nbsp;<span class="string" id="3235891">`net:&#34;ipv4&#34;`</span><br>
<span class="lineno">335</span><span class="op" id="3235904">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3235907">func</span>&nbsp;<span class="op" id="3235912">(</span><span class="ident" id="3235913">rr</span>&nbsp;<span class="op" id="3235916">*</span><span class="ident" id="3235917"><a href="/gostd/net/dnsmsg.go.html#3235844">dnsRR_A</a></span><span class="op" id="3235924">)</span>&nbsp;<span class="ident" id="3235926">Header</span><span class="op" id="3235932">(</span><span class="op" id="3235933">)</span>&nbsp;<span class="op" id="3235935">*</span><span class="ident" id="3235936"><a href="/gostd/net/dnsmsg.go.html#3231312">dnsRR_Header</a></span>&nbsp;<span class="op" id="3235949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3235952">return</span>&nbsp;<span class="op" id="3235959">&amp;</span><span class="ident" id="3235960"><a href="/gostd/net/dnsmsg.go.html#3235913">rr</a></span><span class="op" id="3235962">.</span><span class="ident" id="3235963"><a href="/gostd/net/dnsmsg.go.html#3235862">Hdr</a></span><br>
<span class="lineno"></span><span class="op" id="3235967">}</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span><span class="keyword" id="3235970">func</span>&nbsp;<span class="op" id="3235975">(</span><span class="ident" id="3235976">rr</span>&nbsp;<span class="op" id="3235979">*</span><span class="ident" id="3235980"><a href="/gostd/net/dnsmsg.go.html#3235844">dnsRR_A</a></span><span class="op" id="3235987">)</span>&nbsp;<span class="ident" id="3235989">Walk</span><span class="op" id="3235993">(</span><span class="ident" id="3235994">f</span>&nbsp;<span class="keyword" id="3235996">func</span><span class="op" id="3236000">(</span><span class="ident" id="3236001">v</span>&nbsp;<span class="keyword" id="3236003">interface</span><span class="op" id="3236012">{</span><span class="op" id="3236013">}</span><span class="op" id="3236014">,</span>&nbsp;<span class="ident" id="3236016">name</span><span class="op" id="3236020">,</span>&nbsp;<span class="ident" id="3236022">tag</span>&nbsp;<span class="builtintype" id="3236026">string</span><span class="op" id="3236032">)</span>&nbsp;<span class="builtintype" id="3236034">bool</span><span class="op" id="3236038">)</span>&nbsp;<span class="builtintype" id="3236040">bool</span>&nbsp;<span class="op" id="3236045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3236048">return</span>&nbsp;<span class="ident" id="3236055"><a href="/gostd/net/dnsmsg.go.html#3235976">rr</a></span><span class="op" id="3236057">.</span><span class="ident" id="3236058"><a href="/gostd/net/dnsmsg.go.html#3235862">Hdr</a></span><span class="op" id="3236061">.</span><span class="ident" id="3236062"><a href="/gostd/net/dnsmsg.go.html#3231557">Walk</a></span><span class="op" id="3236066">(</span><span class="ident" id="3236067"><a href="/gostd/net/dnsmsg.go.html#3235994">f</a></span><span class="op" id="3236068">)</span>&nbsp;<span class="op" id="3236070">&amp;&amp;</span>&nbsp;<span class="ident" id="3236073"><a href="/gostd/net/dnsmsg.go.html#3235994">f</a></span><span class="op" id="3236074">(</span><span class="op" id="3236075">&amp;</span><span class="ident" id="3236076"><a href="/gostd/net/dnsmsg.go.html#3235976">rr</a></span><span class="op" id="3236078">.</span><span class="ident" id="3236079"><a href="/gostd/net/dnsmsg.go.html#3235880">A</a></span><span class="op" id="3236080">,</span>&nbsp;<span class="string" id="3236082">&#34;A&#34;</span><span class="op" id="3236085">,</span>&nbsp;<span class="string" id="3236087">&#34;ipv4&#34;</span><span class="op" id="3236093">)</span><br>
<span class="lineno"></span><span class="op" id="3236095">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">345</span><span class="keyword" id="3236098">type</span>&nbsp;<span class="ident" id="3236103">dnsRR_AAAA</span>&nbsp;<span class="keyword" id="3236114">struct</span>&nbsp;<span class="op" id="3236121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3236124">Hdr</span>&nbsp;&nbsp;<span class="ident" id="3236129"><a href="/gostd/net/dnsmsg.go.html#3231312">dnsRR_Header</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3236143">AAAA</span>&nbsp;<span class="op" id="3236148">[</span><span class="num" id="3236149">16</span><span class="op" id="3236151">]</span><span class="builtintype" id="3236152">byte</span>&nbsp;<span class="string" id="3236157">`net:&#34;ipv6&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3236170">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="keyword" id="3236173">func</span>&nbsp;<span class="op" id="3236178">(</span><span class="ident" id="3236179">rr</span>&nbsp;<span class="op" id="3236182">*</span><span class="ident" id="3236183"><a href="/gostd/net/dnsmsg.go.html#3236103">dnsRR_AAAA</a></span><span class="op" id="3236193">)</span>&nbsp;<span class="ident" id="3236195">Header</span><span class="op" id="3236201">(</span><span class="op" id="3236202">)</span>&nbsp;<span class="op" id="3236204">*</span><span class="ident" id="3236205"><a href="/gostd/net/dnsmsg.go.html#3231312">dnsRR_Header</a></span>&nbsp;<span class="op" id="3236218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3236221">return</span>&nbsp;<span class="op" id="3236228">&amp;</span><span class="ident" id="3236229"><a href="/gostd/net/dnsmsg.go.html#3236179">rr</a></span><span class="op" id="3236231">.</span><span class="ident" id="3236232"><a href="/gostd/net/dnsmsg.go.html#3236124">Hdr</a></span><br>
<span class="lineno"></span><span class="op" id="3236236">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3236239">func</span>&nbsp;<span class="op" id="3236244">(</span><span class="ident" id="3236245">rr</span>&nbsp;<span class="op" id="3236248">*</span><span class="ident" id="3236249"><a href="/gostd/net/dnsmsg.go.html#3236103">dnsRR_AAAA</a></span><span class="op" id="3236259">)</span>&nbsp;<span class="ident" id="3236261">Walk</span><span class="op" id="3236265">(</span><span class="ident" id="3236266">f</span>&nbsp;<span class="keyword" id="3236268">func</span><span class="op" id="3236272">(</span><span class="ident" id="3236273">v</span>&nbsp;<span class="keyword" id="3236275">interface</span><span class="op" id="3236284">{</span><span class="op" id="3236285">}</span><span class="op" id="3236286">,</span>&nbsp;<span class="ident" id="3236288">name</span><span class="op" id="3236292">,</span>&nbsp;<span class="ident" id="3236294">tag</span>&nbsp;<span class="builtintype" id="3236298">string</span><span class="op" id="3236304">)</span>&nbsp;<span class="builtintype" id="3236306">bool</span><span class="op" id="3236310">)</span>&nbsp;<span class="builtintype" id="3236312">bool</span>&nbsp;<span class="op" id="3236317">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3236320">return</span>&nbsp;<span class="ident" id="3236327"><a href="/gostd/net/dnsmsg.go.html#3236245">rr</a></span><span class="op" id="3236329">.</span><span class="ident" id="3236330"><a href="/gostd/net/dnsmsg.go.html#3236124">Hdr</a></span><span class="op" id="3236333">.</span><span class="ident" id="3236334"><a href="/gostd/net/dnsmsg.go.html#3231557">Walk</a></span><span class="op" id="3236338">(</span><span class="ident" id="3236339"><a href="/gostd/net/dnsmsg.go.html#3236266">f</a></span><span class="op" id="3236340">)</span>&nbsp;<span class="op" id="3236342">&amp;&amp;</span>&nbsp;<span class="ident" id="3236345"><a href="/gostd/net/dnsmsg.go.html#3236266">f</a></span><span class="op" id="3236346">(</span><span class="ident" id="3236347"><a href="/gostd/net/dnsmsg.go.html#3236245">rr</a></span><span class="op" id="3236349">.</span><span class="ident" id="3236350"><a href="/gostd/net/dnsmsg.go.html#3236143">AAAA</a></span><span class="op" id="3236354">[</span><span class="op" id="3236355">:</span><span class="op" id="3236356">]</span><span class="op" id="3236357">,</span>&nbsp;<span class="string" id="3236359">&#34;AAAA&#34;</span><span class="op" id="3236365">,</span>&nbsp;<span class="string" id="3236367">&#34;ipv6&#34;</span><span class="op" id="3236373">)</span><br>
<span class="lineno"></span><span class="op" id="3236375">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3236378">//&nbsp;Packing&nbsp;and&nbsp;unpacking.</span><br>
<span class="lineno"></span><span class="comment" id="3236404">//</span><br>
<span class="lineno">360</span><span class="comment" id="3236407">//&nbsp;All&nbsp;the&nbsp;packers&nbsp;and&nbsp;unpackers&nbsp;take&nbsp;a&nbsp;(msg&nbsp;[]byte,&nbsp;off&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="3236469">//&nbsp;and&nbsp;return&nbsp;(off1&nbsp;int,&nbsp;ok&nbsp;bool).&nbsp;&nbsp;If&nbsp;they&nbsp;return&nbsp;ok==false,&nbsp;they</span><br>
<span class="lineno"></span><span class="comment" id="3236536">//&nbsp;also&nbsp;return&nbsp;off1==len(msg),&nbsp;so&nbsp;that&nbsp;the&nbsp;next&nbsp;unpacker&nbsp;will</span><br>
<span class="lineno"></span><span class="comment" id="3236598">//&nbsp;also&nbsp;fail.&nbsp;&nbsp;This&nbsp;lets&nbsp;us&nbsp;avoid&nbsp;checks&nbsp;of&nbsp;ok&nbsp;until&nbsp;the&nbsp;end&nbsp;of&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3236664">//&nbsp;packing&nbsp;sequence.</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span><span class="comment" id="3236686">//&nbsp;Map&nbsp;of&nbsp;constructors&nbsp;for&nbsp;each&nbsp;RR&nbsp;wire&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="3236732">var</span>&nbsp;<span class="ident" id="3236736">rr_mk</span>&nbsp;<span class="op" id="3236742">=</span>&nbsp;<span class="keyword" id="3236744">map</span><span class="op" id="3236747">[</span><span class="builtintype" id="3236748">int</span><span class="op" id="3236751">]</span><span class="keyword" id="3236752">func</span><span class="op" id="3236756">(</span><span class="op" id="3236757">)</span>&nbsp;<span class="ident" id="3236759"><a href="/gostd/net/dnsmsg.go.html#3231784">dnsRR</a></span><span class="op" id="3236764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3236767"><a href="/gostd/net/dnsmsg.go.html#3228858">dnsTypeCNAME</a></span><span class="op" id="3236779">:</span>&nbsp;<span class="keyword" id="3236781">func</span><span class="op" id="3236785">(</span><span class="op" id="3236786">)</span>&nbsp;<span class="ident" id="3236788"><a href="/gostd/net/dnsmsg.go.html#3231784">dnsRR</a></span>&nbsp;<span class="op" id="3236794">{</span>&nbsp;<span class="keyword" id="3236796">return</span>&nbsp;<span class="builtinfunc" id="3236803">new</span><span class="op" id="3236806">(</span><span class="ident" id="3236807"><a href="/gostd/net/dnsmsg.go.html#3231894">dnsRR_CNAME</a></span><span class="op" id="3236818">)</span>&nbsp;<span class="op" id="3236820">}</span><span class="op" id="3236821">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3236824"><a href="/gostd/net/dnsmsg.go.html#3229005">dnsTypeHINFO</a></span><span class="op" id="3236836">:</span>&nbsp;<span class="keyword" id="3236838">func</span><span class="op" id="3236842">(</span><span class="op" id="3236843">)</span>&nbsp;<span class="ident" id="3236845"><a href="/gostd/net/dnsmsg.go.html#3231784">dnsRR</a></span>&nbsp;<span class="op" id="3236851">{</span>&nbsp;<span class="keyword" id="3236853">return</span>&nbsp;<span class="builtinfunc" id="3236860">new</span><span class="op" id="3236863">(</span><span class="ident" id="3236864"><a href="/gostd/net/dnsmsg.go.html#3232186">dnsRR_HINFO</a></span><span class="op" id="3236875">)</span>&nbsp;<span class="op" id="3236877">}</span><span class="op" id="3236878">,</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3236881"><a href="/gostd/net/dnsmsg.go.html#3228894">dnsTypeMB</a></span><span class="op" id="3236890">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3236895">func</span><span class="op" id="3236899">(</span><span class="op" id="3236900">)</span>&nbsp;<span class="ident" id="3236902"><a href="/gostd/net/dnsmsg.go.html#3231784">dnsRR</a></span>&nbsp;<span class="op" id="3236908">{</span>&nbsp;<span class="keyword" id="3236910">return</span>&nbsp;<span class="builtinfunc" id="3236917">new</span><span class="op" id="3236920">(</span><span class="ident" id="3236921"><a href="/gostd/net/dnsmsg.go.html#3232479">dnsRR_MB</a></span><span class="op" id="3236929">)</span>&nbsp;<span class="op" id="3236931">}</span><span class="op" id="3236932">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3236935"><a href="/gostd/net/dnsmsg.go.html#3228912">dnsTypeMG</a></span><span class="op" id="3236944">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3236949">func</span><span class="op" id="3236953">(</span><span class="op" id="3236954">)</span>&nbsp;<span class="ident" id="3236956"><a href="/gostd/net/dnsmsg.go.html#3231784">dnsRR</a></span>&nbsp;<span class="op" id="3236962">{</span>&nbsp;<span class="keyword" id="3236964">return</span>&nbsp;<span class="builtinfunc" id="3236971">new</span><span class="op" id="3236974">(</span><span class="ident" id="3236975"><a href="/gostd/net/dnsmsg.go.html#3232752">dnsRR_MG</a></span><span class="op" id="3236983">)</span>&nbsp;<span class="op" id="3236985">}</span><span class="op" id="3236986">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3236989"><a href="/gostd/net/dnsmsg.go.html#3229024">dnsTypeMINFO</a></span><span class="op" id="3237001">:</span>&nbsp;<span class="keyword" id="3237003">func</span><span class="op" id="3237007">(</span><span class="op" id="3237008">)</span>&nbsp;<span class="ident" id="3237010"><a href="/gostd/net/dnsmsg.go.html#3231784">dnsRR</a></span>&nbsp;<span class="op" id="3237016">{</span>&nbsp;<span class="keyword" id="3237018">return</span>&nbsp;<span class="builtinfunc" id="3237025">new</span><span class="op" id="3237028">(</span><span class="ident" id="3237029"><a href="/gostd/net/dnsmsg.go.html#3233025">dnsRR_MINFO</a></span><span class="op" id="3237040">)</span>&nbsp;<span class="op" id="3237042">}</span><span class="op" id="3237043">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3237046"><a href="/gostd/net/dnsmsg.go.html#3228930">dnsTypeMR</a></span><span class="op" id="3237055">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3237060">func</span><span class="op" id="3237064">(</span><span class="op" id="3237065">)</span>&nbsp;<span class="ident" id="3237067"><a href="/gostd/net/dnsmsg.go.html#3231784">dnsRR</a></span>&nbsp;<span class="op" id="3237073">{</span>&nbsp;<span class="keyword" id="3237075">return</span>&nbsp;<span class="builtinfunc" id="3237082">new</span><span class="op" id="3237085">(</span><span class="ident" id="3237086"><a href="/gostd/net/dnsmsg.go.html#3233386">dnsRR_MR</a></span><span class="op" id="3237094">)</span>&nbsp;<span class="op" id="3237096">}</span><span class="op" id="3237097">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3237100"><a href="/gostd/net/dnsmsg.go.html#3229043">dnsTypeMX</a></span><span class="op" id="3237109">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3237114">func</span><span class="op" id="3237118">(</span><span class="op" id="3237119">)</span>&nbsp;<span class="ident" id="3237121"><a href="/gostd/net/dnsmsg.go.html#3231784">dnsRR</a></span>&nbsp;<span class="op" id="3237127">{</span>&nbsp;<span class="keyword" id="3237129">return</span>&nbsp;<span class="builtinfunc" id="3237136">new</span><span class="op" id="3237139">(</span><span class="ident" id="3237140"><a href="/gostd/net/dnsmsg.go.html#3233659">dnsRR_MX</a></span><span class="op" id="3237148">)</span>&nbsp;<span class="op" id="3237150">}</span><span class="op" id="3237151">,</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3237154"><a href="/gostd/net/dnsmsg.go.html#3228804">dnsTypeNS</a></span><span class="op" id="3237163">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3237168">func</span><span class="op" id="3237172">(</span><span class="op" id="3237173">)</span>&nbsp;<span class="ident" id="3237175"><a href="/gostd/net/dnsmsg.go.html#3231784">dnsRR</a></span>&nbsp;<span class="op" id="3237181">{</span>&nbsp;<span class="keyword" id="3237183">return</span>&nbsp;<span class="builtinfunc" id="3237190">new</span><span class="op" id="3237193">(</span><span class="ident" id="3237194"><a href="/gostd/net/dnsmsg.go.html#3233974">dnsRR_NS</a></span><span class="op" id="3237202">)</span>&nbsp;<span class="op" id="3237204">}</span><span class="op" id="3237205">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3237208"><a href="/gostd/net/dnsmsg.go.html#3228986">dnsTypePTR</a></span><span class="op" id="3237218">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="3237222">func</span><span class="op" id="3237226">(</span><span class="op" id="3237227">)</span>&nbsp;<span class="ident" id="3237229"><a href="/gostd/net/dnsmsg.go.html#3231784">dnsRR</a></span>&nbsp;<span class="op" id="3237235">{</span>&nbsp;<span class="keyword" id="3237237">return</span>&nbsp;<span class="builtinfunc" id="3237244">new</span><span class="op" id="3237247">(</span><span class="ident" id="3237248"><a href="/gostd/net/dnsmsg.go.html#3234247">dnsRR_PTR</a></span><span class="op" id="3237257">)</span>&nbsp;<span class="op" id="3237259">}</span><span class="op" id="3237260">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3237263"><a href="/gostd/net/dnsmsg.go.html#3228876">dnsTypeSOA</a></span><span class="op" id="3237273">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="3237277">func</span><span class="op" id="3237281">(</span><span class="op" id="3237282">)</span>&nbsp;<span class="ident" id="3237284"><a href="/gostd/net/dnsmsg.go.html#3231784">dnsRR</a></span>&nbsp;<span class="op" id="3237290">{</span>&nbsp;<span class="keyword" id="3237292">return</span>&nbsp;<span class="builtinfunc" id="3237299">new</span><span class="op" id="3237302">(</span><span class="ident" id="3237303"><a href="/gostd/net/dnsmsg.go.html#3234525">dnsRR_SOA</a></span><span class="op" id="3237312">)</span>&nbsp;<span class="op" id="3237314">}</span><span class="op" id="3237315">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3237318"><a href="/gostd/net/dnsmsg.go.html#3229062">dnsTypeTXT</a></span><span class="op" id="3237328">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="3237332">func</span><span class="op" id="3237336">(</span><span class="op" id="3237337">)</span>&nbsp;<span class="ident" id="3237339"><a href="/gostd/net/dnsmsg.go.html#3231784">dnsRR</a></span>&nbsp;<span class="op" id="3237345">{</span>&nbsp;<span class="keyword" id="3237347">return</span>&nbsp;<span class="builtinfunc" id="3237354">new</span><span class="op" id="3237357">(</span><span class="ident" id="3237358"><a href="/gostd/net/dnsmsg.go.html#3235127">dnsRR_TXT</a></span><span class="op" id="3237367">)</span>&nbsp;<span class="op" id="3237369">}</span><span class="op" id="3237370">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3237373"><a href="/gostd/net/dnsmsg.go.html#3229100">dnsTypeSRV</a></span><span class="op" id="3237383">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="3237387">func</span><span class="op" id="3237391">(</span><span class="op" id="3237392">)</span>&nbsp;<span class="ident" id="3237394"><a href="/gostd/net/dnsmsg.go.html#3231784">dnsRR</a></span>&nbsp;<span class="op" id="3237400">{</span>&nbsp;<span class="keyword" id="3237402">return</span>&nbsp;<span class="builtinfunc" id="3237409">new</span><span class="op" id="3237412">(</span><span class="ident" id="3237413"><a href="/gostd/net/dnsmsg.go.html#3235398">dnsRR_SRV</a></span><span class="op" id="3237422">)</span>&nbsp;<span class="op" id="3237424">}</span><span class="op" id="3237425">,</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3237428"><a href="/gostd/net/dnsmsg.go.html#3228786">dnsTypeA</a></span><span class="op" id="3237436">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3237442">func</span><span class="op" id="3237446">(</span><span class="op" id="3237447">)</span>&nbsp;<span class="ident" id="3237449"><a href="/gostd/net/dnsmsg.go.html#3231784">dnsRR</a></span>&nbsp;<span class="op" id="3237455">{</span>&nbsp;<span class="keyword" id="3237457">return</span>&nbsp;<span class="builtinfunc" id="3237464">new</span><span class="op" id="3237467">(</span><span class="ident" id="3237468"><a href="/gostd/net/dnsmsg.go.html#3235844">dnsRR_A</a></span><span class="op" id="3237475">)</span>&nbsp;<span class="op" id="3237477">}</span><span class="op" id="3237478">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3237481"><a href="/gostd/net/dnsmsg.go.html#3229081">dnsTypeAAAA</a></span><span class="op" id="3237492">:</span>&nbsp;&nbsp;<span class="keyword" id="3237495">func</span><span class="op" id="3237499">(</span><span class="op" id="3237500">)</span>&nbsp;<span class="ident" id="3237502"><a href="/gostd/net/dnsmsg.go.html#3231784">dnsRR</a></span>&nbsp;<span class="op" id="3237508">{</span>&nbsp;<span class="keyword" id="3237510">return</span>&nbsp;<span class="builtinfunc" id="3237517">new</span><span class="op" id="3237520">(</span><span class="ident" id="3237521"><a href="/gostd/net/dnsmsg.go.html#3236103">dnsRR_AAAA</a></span><span class="op" id="3237531">)</span>&nbsp;<span class="op" id="3237533">}</span><span class="op" id="3237534">,</span><br>
<span class="lineno"></span><span class="op" id="3237536">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3237539">//&nbsp;Pack&nbsp;a&nbsp;domain&nbsp;name&nbsp;s&nbsp;into&nbsp;msg[off:].</span><br>
<span class="lineno">385</span><span class="comment" id="3237579">//&nbsp;Domain&nbsp;names&nbsp;are&nbsp;a&nbsp;sequence&nbsp;of&nbsp;counted&nbsp;strings</span><br>
<span class="lineno"></span><span class="comment" id="3237629">//&nbsp;split&nbsp;at&nbsp;the&nbsp;dots.&nbsp;&nbsp;They&nbsp;end&nbsp;with&nbsp;a&nbsp;zero-length&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="3237688">func</span>&nbsp;<span class="ident" id="3237693">packDomainName</span><span class="op" id="3237707">(</span><span class="ident" id="3237708">s</span>&nbsp;<span class="builtintype" id="3237710">string</span><span class="op" id="3237716">,</span>&nbsp;<span class="ident" id="3237718">msg</span>&nbsp;<span class="op" id="3237722">[</span><span class="op" id="3237723">]</span><span class="builtintype" id="3237724">byte</span><span class="op" id="3237728">,</span>&nbsp;<span class="ident" id="3237730">off</span>&nbsp;<span class="builtintype" id="3237734">int</span><span class="op" id="3237737">)</span>&nbsp;<span class="op" id="3237739">(</span><span class="ident" id="3237740">off1</span>&nbsp;<span class="builtintype" id="3237745">int</span><span class="op" id="3237748">,</span>&nbsp;<span class="ident" id="3237750">ok</span>&nbsp;<span class="builtintype" id="3237753">bool</span><span class="op" id="3237757">)</span>&nbsp;<span class="op" id="3237759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3237762">//&nbsp;Add&nbsp;trailing&nbsp;dot&nbsp;to&nbsp;canonicalize&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3237805">if</span>&nbsp;<span class="ident" id="3237808">n</span>&nbsp;<span class="op" id="3237810">:=</span>&nbsp;<span class="builtinfunc" id="3237813">len</span><span class="op" id="3237816">(</span><span class="ident" id="3237817"><a href="/gostd/net/dnsmsg.go.html#3237708">s</a></span><span class="op" id="3237818">)</span><span class="op" id="3237819">;</span>&nbsp;<span class="ident" id="3237821"><a href="/gostd/net/dnsmsg.go.html#3237808">n</a></span>&nbsp;<span class="op" id="3237823">==</span>&nbsp;<span class="num" id="3237826">0</span>&nbsp;<span class="op" id="3237828">||</span>&nbsp;<span class="ident" id="3237831"><a href="/gostd/net/dnsmsg.go.html#3237708">s</a></span><span class="op" id="3237832">[</span><span class="ident" id="3237833"><a href="/gostd/net/dnsmsg.go.html#3237808">n</a></span><span class="op" id="3237834">-</span><span class="num" id="3237835">1</span><span class="op" id="3237836">]</span>&nbsp;<span class="op" id="3237838">!=</span>&nbsp;<span class="string" id="3237841">&#39;.&#39;</span>&nbsp;<span class="op" id="3237845">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3237849"><a href="/gostd/net/dnsmsg.go.html#3237708">s</a></span>&nbsp;<span class="op" id="3237851">+=</span>&nbsp;<span class="string" id="3237854">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3237859">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3237863">//&nbsp;Each&nbsp;dot&nbsp;ends&nbsp;a&nbsp;segment&nbsp;of&nbsp;the&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3237904">//&nbsp;We&nbsp;trade&nbsp;each&nbsp;dot&nbsp;byte&nbsp;for&nbsp;a&nbsp;length&nbsp;byte.</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3237950">//&nbsp;There&nbsp;is&nbsp;also&nbsp;a&nbsp;trailing&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3237985">//&nbsp;Check&nbsp;that&nbsp;we&nbsp;have&nbsp;all&nbsp;the&nbsp;space&nbsp;we&nbsp;need.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3238031">tot</span>&nbsp;<span class="op" id="3238035">:=</span>&nbsp;<span class="builtinfunc" id="3238038">len</span><span class="op" id="3238041">(</span><span class="ident" id="3238042"><a href="/gostd/net/dnsmsg.go.html#3237708">s</a></span><span class="op" id="3238043">)</span>&nbsp;<span class="op" id="3238045">+</span>&nbsp;<span class="num" id="3238047">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3238050">if</span>&nbsp;<span class="ident" id="3238053"><a href="/gostd/net/dnsmsg.go.html#3237730">off</a></span><span class="op" id="3238056">+</span><span class="ident" id="3238057"><a href="/gostd/net/dnsmsg.go.html#3238031">tot</a></span>&nbsp;<span class="op" id="3238061">&gt;</span>&nbsp;<span class="builtinfunc" id="3238063">len</span><span class="op" id="3238066">(</span><span class="ident" id="3238067"><a href="/gostd/net/dnsmsg.go.html#3237718">msg</a></span><span class="op" id="3238070">)</span>&nbsp;<span class="op" id="3238072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3238076">return</span>&nbsp;<span class="builtinfunc" id="3238083">len</span><span class="op" id="3238086">(</span><span class="ident" id="3238087"><a href="/gostd/net/dnsmsg.go.html#3237718">msg</a></span><span class="op" id="3238090">)</span><span class="op" id="3238091">,</span>&nbsp;<span class="builtintype" id="3238093">false</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3238100">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3238104">//&nbsp;Emit&nbsp;sequence&nbsp;of&nbsp;counted&nbsp;strings,&nbsp;chopping&nbsp;at&nbsp;dots.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3238160">begin</span>&nbsp;<span class="op" id="3238166">:=</span>&nbsp;<span class="num" id="3238169">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3238172">for</span>&nbsp;<span class="ident" id="3238176">i</span>&nbsp;<span class="op" id="3238178">:=</span>&nbsp;<span class="num" id="3238181">0</span><span class="op" id="3238182">;</span>&nbsp;<span class="ident" id="3238184"><a href="/gostd/net/dnsmsg.go.html#3238176">i</a></span>&nbsp;<span class="op" id="3238186">&lt;</span>&nbsp;<span class="builtinfunc" id="3238188">len</span><span class="op" id="3238191">(</span><span class="ident" id="3238192"><a href="/gostd/net/dnsmsg.go.html#3237708">s</a></span><span class="op" id="3238193">)</span><span class="op" id="3238194">;</span>&nbsp;<span class="ident" id="3238196"><a href="/gostd/net/dnsmsg.go.html#3238176">i</a></span><span class="op" id="3238197">++</span>&nbsp;<span class="op" id="3238200">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3238204">if</span>&nbsp;<span class="ident" id="3238207"><a href="/gostd/net/dnsmsg.go.html#3237708">s</a></span><span class="op" id="3238208">[</span><span class="ident" id="3238209"><a href="/gostd/net/dnsmsg.go.html#3238176">i</a></span><span class="op" id="3238210">]</span>&nbsp;<span class="op" id="3238212">==</span>&nbsp;<span class="string" id="3238215">&#39;.&#39;</span>&nbsp;<span class="op" id="3238219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3238224">if</span>&nbsp;<span class="ident" id="3238227"><a href="/gostd/net/dnsmsg.go.html#3238176">i</a></span><span class="op" id="3238228">-</span><span class="ident" id="3238229"><a href="/gostd/net/dnsmsg.go.html#3238160">begin</a></span>&nbsp;<span class="op" id="3238235">&gt;=</span>&nbsp;<span class="num" id="3238238">1</span><span class="op" id="3238239">&lt;&lt;</span><span class="num" id="3238241">6</span>&nbsp;<span class="op" id="3238243">{</span>&nbsp;<span class="comment" id="3238245">//&nbsp;top&nbsp;two&nbsp;bits&nbsp;of&nbsp;length&nbsp;must&nbsp;be&nbsp;clear</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3238289">return</span>&nbsp;<span class="builtinfunc" id="3238296">len</span><span class="op" id="3238299">(</span><span class="ident" id="3238300"><a href="/gostd/net/dnsmsg.go.html#3237718">msg</a></span><span class="op" id="3238303">)</span><span class="op" id="3238304">,</span>&nbsp;<span class="builtintype" id="3238306">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3238315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3238320"><a href="/gostd/net/dnsmsg.go.html#3237718">msg</a></span><span class="op" id="3238323">[</span><span class="ident" id="3238324"><a href="/gostd/net/dnsmsg.go.html#3237730">off</a></span><span class="op" id="3238327">]</span>&nbsp;<span class="op" id="3238329">=</span>&nbsp;<span class="builtintype" id="3238331">byte</span><span class="op" id="3238335">(</span><span class="ident" id="3238336"><a href="/gostd/net/dnsmsg.go.html#3238176">i</a></span>&nbsp;<span class="op" id="3238338">-</span>&nbsp;<span class="ident" id="3238340"><a href="/gostd/net/dnsmsg.go.html#3238160">begin</a></span><span class="op" id="3238345">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3238350"><a href="/gostd/net/dnsmsg.go.html#3237730">off</a></span><span class="op" id="3238353">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3238359">for</span>&nbsp;<span class="ident" id="3238363">j</span>&nbsp;<span class="op" id="3238365">:=</span>&nbsp;<span class="ident" id="3238368"><a href="/gostd/net/dnsmsg.go.html#3238160">begin</a></span><span class="op" id="3238373">;</span>&nbsp;<span class="ident" id="3238375"><a href="/gostd/net/dnsmsg.go.html#3238363">j</a></span>&nbsp;<span class="op" id="3238377">&lt;</span>&nbsp;<span class="ident" id="3238379"><a href="/gostd/net/dnsmsg.go.html#3238176">i</a></span><span class="op" id="3238380">;</span>&nbsp;<span class="ident" id="3238382"><a href="/gostd/net/dnsmsg.go.html#3238363">j</a></span><span class="op" id="3238383">++</span>&nbsp;<span class="op" id="3238386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3238392"><a href="/gostd/net/dnsmsg.go.html#3237718">msg</a></span><span class="op" id="3238395">[</span><span class="ident" id="3238396"><a href="/gostd/net/dnsmsg.go.html#3237730">off</a></span><span class="op" id="3238399">]</span>&nbsp;<span class="op" id="3238401">=</span>&nbsp;<span class="ident" id="3238403"><a href="/gostd/net/dnsmsg.go.html#3237708">s</a></span><span class="op" id="3238404">[</span><span class="ident" id="3238405"><a href="/gostd/net/dnsmsg.go.html#3238363">j</a></span><span class="op" id="3238406">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3238412"><a href="/gostd/net/dnsmsg.go.html#3237730">off</a></span><span class="op" id="3238415">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3238421">}</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3238426"><a href="/gostd/net/dnsmsg.go.html#3238160">begin</a></span>&nbsp;<span class="op" id="3238432">=</span>&nbsp;<span class="ident" id="3238434"><a href="/gostd/net/dnsmsg.go.html#3238176">i</a></span>&nbsp;<span class="op" id="3238436">+</span>&nbsp;<span class="num" id="3238438">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3238442">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3238445">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3238448"><a href="/gostd/net/dnsmsg.go.html#3237718">msg</a></span><span class="op" id="3238451">[</span><span class="ident" id="3238452"><a href="/gostd/net/dnsmsg.go.html#3237730">off</a></span><span class="op" id="3238455">]</span>&nbsp;<span class="op" id="3238457">=</span>&nbsp;<span class="num" id="3238459">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3238462"><a href="/gostd/net/dnsmsg.go.html#3237730">off</a></span><span class="op" id="3238465">++</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3238469">return</span>&nbsp;<span class="ident" id="3238476"><a href="/gostd/net/dnsmsg.go.html#3237730">off</a></span><span class="op" id="3238479">,</span>&nbsp;<span class="builtintype" id="3238481">true</span><br>
<span class="lineno"></span><span class="op" id="3238486">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3238489">//&nbsp;Unpack&nbsp;a&nbsp;domain&nbsp;name.</span><br>
<span class="lineno"></span><span class="comment" id="3238514">//&nbsp;In&nbsp;addition&nbsp;to&nbsp;the&nbsp;simple&nbsp;sequences&nbsp;of&nbsp;counted&nbsp;strings&nbsp;above,</span><br>
<span class="lineno">425</span><span class="comment" id="3238579">//&nbsp;domain&nbsp;names&nbsp;are&nbsp;allowed&nbsp;to&nbsp;refer&nbsp;to&nbsp;strings&nbsp;elsewhere&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3238644">//&nbsp;packet,&nbsp;to&nbsp;avoid&nbsp;repeating&nbsp;common&nbsp;suffixes&nbsp;when&nbsp;returning</span><br>
<span class="lineno"></span><span class="comment" id="3238705">//&nbsp;many&nbsp;entries&nbsp;in&nbsp;a&nbsp;single&nbsp;domain.&nbsp;&nbsp;The&nbsp;pointers&nbsp;are&nbsp;marked</span><br>
<span class="lineno"></span><span class="comment" id="3238766">//&nbsp;by&nbsp;a&nbsp;length&nbsp;byte&nbsp;with&nbsp;the&nbsp;top&nbsp;two&nbsp;bits&nbsp;set.&nbsp;&nbsp;Ignoring&nbsp;those</span><br>
<span class="lineno"></span><span class="comment" id="3238829">//&nbsp;two&nbsp;bits,&nbsp;that&nbsp;byte&nbsp;and&nbsp;the&nbsp;next&nbsp;give&nbsp;a&nbsp;14&nbsp;bit&nbsp;offset&nbsp;from&nbsp;msg[0]</span><br>
<span class="lineno">430</span><span class="comment" id="3238898">//&nbsp;where&nbsp;we&nbsp;should&nbsp;pick&nbsp;up&nbsp;the&nbsp;trail.</span><br>
<span class="lineno"></span><span class="comment" id="3238936">//&nbsp;Note&nbsp;that&nbsp;if&nbsp;we&nbsp;jump&nbsp;elsewhere&nbsp;in&nbsp;the&nbsp;packet,</span><br>
<span class="lineno"></span><span class="comment" id="3238985">//&nbsp;we&nbsp;return&nbsp;off1&nbsp;==&nbsp;the&nbsp;offset&nbsp;after&nbsp;the&nbsp;first&nbsp;pointer&nbsp;we&nbsp;found,</span><br>
<span class="lineno"></span><span class="comment" id="3239051">//&nbsp;which&nbsp;is&nbsp;where&nbsp;the&nbsp;next&nbsp;record&nbsp;will&nbsp;start.</span><br>
<span class="lineno"></span><span class="comment" id="3239097">//&nbsp;In&nbsp;theory,&nbsp;the&nbsp;pointers&nbsp;are&nbsp;only&nbsp;allowed&nbsp;to&nbsp;jump&nbsp;backward.</span><br>
<span class="lineno">435</span><span class="comment" id="3239159">//&nbsp;We&nbsp;let&nbsp;them&nbsp;jump&nbsp;anywhere&nbsp;and&nbsp;stop&nbsp;jumping&nbsp;after&nbsp;a&nbsp;while.</span><br>
<span class="lineno"></span><span class="keyword" id="3239220">func</span>&nbsp;<span class="ident" id="3239225">unpackDomainName</span><span class="op" id="3239241">(</span><span class="ident" id="3239242">msg</span>&nbsp;<span class="op" id="3239246">[</span><span class="op" id="3239247">]</span><span class="builtintype" id="3239248">byte</span><span class="op" id="3239252">,</span>&nbsp;<span class="ident" id="3239254">off</span>&nbsp;<span class="builtintype" id="3239258">int</span><span class="op" id="3239261">)</span>&nbsp;<span class="op" id="3239263">(</span><span class="ident" id="3239264">s</span>&nbsp;<span class="builtintype" id="3239266">string</span><span class="op" id="3239272">,</span>&nbsp;<span class="ident" id="3239274">off1</span>&nbsp;<span class="builtintype" id="3239279">int</span><span class="op" id="3239282">,</span>&nbsp;<span class="ident" id="3239284">ok</span>&nbsp;<span class="builtintype" id="3239287">bool</span><span class="op" id="3239291">)</span>&nbsp;<span class="op" id="3239293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3239296"><a href="/gostd/net/dnsmsg.go.html#3239264">s</a></span>&nbsp;<span class="op" id="3239298">=</span>&nbsp;<span class="string" id="3239300">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3239304">ptr</span>&nbsp;<span class="op" id="3239308">:=</span>&nbsp;<span class="num" id="3239311">0</span>&nbsp;<span class="comment" id="3239313">//&nbsp;number&nbsp;of&nbsp;pointers&nbsp;followed</span><br>
<span class="lineno"></span><span class="ident" id="3239344">Loop</span><span class="op" id="3239348">:</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3239351">for</span>&nbsp;<span class="op" id="3239355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3239359">if</span>&nbsp;<span class="ident" id="3239362"><a href="/gostd/net/dnsmsg.go.html#3239254">off</a></span>&nbsp;<span class="op" id="3239366">&gt;=</span>&nbsp;<span class="builtinfunc" id="3239369">len</span><span class="op" id="3239372">(</span><span class="ident" id="3239373"><a href="/gostd/net/dnsmsg.go.html#3239242">msg</a></span><span class="op" id="3239376">)</span>&nbsp;<span class="op" id="3239378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3239383">return</span>&nbsp;<span class="string" id="3239390">&#34;&#34;</span><span class="op" id="3239392">,</span>&nbsp;<span class="builtinfunc" id="3239394">len</span><span class="op" id="3239397">(</span><span class="ident" id="3239398"><a href="/gostd/net/dnsmsg.go.html#3239242">msg</a></span><span class="op" id="3239401">)</span><span class="op" id="3239402">,</span>&nbsp;<span class="builtintype" id="3239404">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3239412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3239416">c</span>&nbsp;<span class="op" id="3239418">:=</span>&nbsp;<span class="builtintype" id="3239421">int</span><span class="op" id="3239424">(</span><span class="ident" id="3239425"><a href="/gostd/net/dnsmsg.go.html#3239242">msg</a></span><span class="op" id="3239428">[</span><span class="ident" id="3239429"><a href="/gostd/net/dnsmsg.go.html#3239254">off</a></span><span class="op" id="3239432">]</span><span class="op" id="3239433">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3239437"><a href="/gostd/net/dnsmsg.go.html#3239254">off</a></span><span class="op" id="3239440">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3239445">switch</span>&nbsp;<span class="ident" id="3239452"><a href="/gostd/net/dnsmsg.go.html#3239416">c</a></span>&nbsp;<span class="op" id="3239454">&amp;</span>&nbsp;<span class="num" id="3239456">0xC0</span>&nbsp;<span class="op" id="3239461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3239465">case</span>&nbsp;<span class="num" id="3239470">0x00</span><span class="op" id="3239474">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3239479">if</span>&nbsp;<span class="ident" id="3239482"><a href="/gostd/net/dnsmsg.go.html#3239416">c</a></span>&nbsp;<span class="op" id="3239484">==</span>&nbsp;<span class="num" id="3239487">0x00</span>&nbsp;<span class="op" id="3239492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3239498">//&nbsp;end&nbsp;of&nbsp;name</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3239517">break</span>&nbsp;<span class="ident" id="3239523"><a href="/gostd/net/dnsmsg.go.html#3239344">Loop</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3239531">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3239536">//&nbsp;literal&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3239557">if</span>&nbsp;<span class="ident" id="3239560"><a href="/gostd/net/dnsmsg.go.html#3239254">off</a></span><span class="op" id="3239563">+</span><span class="ident" id="3239564"><a href="/gostd/net/dnsmsg.go.html#3239416">c</a></span>&nbsp;<span class="op" id="3239566">&gt;</span>&nbsp;<span class="builtinfunc" id="3239568">len</span><span class="op" id="3239571">(</span><span class="ident" id="3239572"><a href="/gostd/net/dnsmsg.go.html#3239242">msg</a></span><span class="op" id="3239575">)</span>&nbsp;<span class="op" id="3239577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3239583">return</span>&nbsp;<span class="string" id="3239590">&#34;&#34;</span><span class="op" id="3239592">,</span>&nbsp;<span class="builtinfunc" id="3239594">len</span><span class="op" id="3239597">(</span><span class="ident" id="3239598"><a href="/gostd/net/dnsmsg.go.html#3239242">msg</a></span><span class="op" id="3239601">)</span><span class="op" id="3239602">,</span>&nbsp;<span class="builtintype" id="3239604">false</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3239613">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3239618"><a href="/gostd/net/dnsmsg.go.html#3239264">s</a></span>&nbsp;<span class="op" id="3239620">+=</span>&nbsp;<span class="builtintype" id="3239623">string</span><span class="op" id="3239629">(</span><span class="ident" id="3239630"><a href="/gostd/net/dnsmsg.go.html#3239242">msg</a></span><span class="op" id="3239633">[</span><span class="ident" id="3239634"><a href="/gostd/net/dnsmsg.go.html#3239254">off</a></span><span class="op" id="3239637">:</span><span class="ident" id="3239638"><a href="/gostd/net/dnsmsg.go.html#3239254">off</a></span><span class="op" id="3239641">+</span><span class="ident" id="3239642"><a href="/gostd/net/dnsmsg.go.html#3239416">c</a></span><span class="op" id="3239643">]</span><span class="op" id="3239644">)</span>&nbsp;<span class="op" id="3239646">+</span>&nbsp;<span class="string" id="3239648">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3239655"><a href="/gostd/net/dnsmsg.go.html#3239254">off</a></span>&nbsp;<span class="op" id="3239659">+=</span>&nbsp;<span class="ident" id="3239662"><a href="/gostd/net/dnsmsg.go.html#3239416">c</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3239666">case</span>&nbsp;<span class="num" id="3239671">0xC0</span><span class="op" id="3239675">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3239680">//&nbsp;pointer&nbsp;to&nbsp;somewhere&nbsp;else&nbsp;in&nbsp;msg.</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3239720">//&nbsp;remember&nbsp;location&nbsp;after&nbsp;first&nbsp;ptr,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3239761">//&nbsp;since&nbsp;that&#39;s&nbsp;how&nbsp;many&nbsp;bytes&nbsp;we&nbsp;consumed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3239808">//&nbsp;also,&nbsp;don&#39;t&nbsp;follow&nbsp;too&nbsp;many&nbsp;pointers&nbsp;--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3239854">//&nbsp;maybe&nbsp;there&#39;s&nbsp;a&nbsp;loop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3239882">if</span>&nbsp;<span class="ident" id="3239885"><a href="/gostd/net/dnsmsg.go.html#3239254">off</a></span>&nbsp;<span class="op" id="3239889">&gt;=</span>&nbsp;<span class="builtinfunc" id="3239892">len</span><span class="op" id="3239895">(</span><span class="ident" id="3239896"><a href="/gostd/net/dnsmsg.go.html#3239242">msg</a></span><span class="op" id="3239899">)</span>&nbsp;<span class="op" id="3239901">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3239907">return</span>&nbsp;<span class="string" id="3239914">&#34;&#34;</span><span class="op" id="3239916">,</span>&nbsp;<span class="builtinfunc" id="3239918">len</span><span class="op" id="3239921">(</span><span class="ident" id="3239922"><a href="/gostd/net/dnsmsg.go.html#3239242">msg</a></span><span class="op" id="3239925">)</span><span class="op" id="3239926">,</span>&nbsp;<span class="builtintype" id="3239928">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3239937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3239942">c1</span>&nbsp;<span class="op" id="3239945">:=</span>&nbsp;<span class="ident" id="3239948"><a href="/gostd/net/dnsmsg.go.html#3239242">msg</a></span><span class="op" id="3239951">[</span><span class="ident" id="3239952"><a href="/gostd/net/dnsmsg.go.html#3239254">off</a></span><span class="op" id="3239955">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3239960"><a href="/gostd/net/dnsmsg.go.html#3239254">off</a></span><span class="op" id="3239963">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3239969">if</span>&nbsp;<span class="ident" id="3239972"><a href="/gostd/net/dnsmsg.go.html#3239304">ptr</a></span>&nbsp;<span class="op" id="3239976">==</span>&nbsp;<span class="num" id="3239979">0</span>&nbsp;<span class="op" id="3239981">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3239987"><a href="/gostd/net/dnsmsg.go.html#3239274">off1</a></span>&nbsp;<span class="op" id="3239992">=</span>&nbsp;<span class="ident" id="3239994"><a href="/gostd/net/dnsmsg.go.html#3239254">off</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3240001">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3240006">if</span>&nbsp;<span class="ident" id="3240009"><a href="/gostd/net/dnsmsg.go.html#3239304">ptr</a></span><span class="op" id="3240012">++</span><span class="op" id="3240014">;</span>&nbsp;<span class="ident" id="3240016"><a href="/gostd/net/dnsmsg.go.html#3239304">ptr</a></span>&nbsp;<span class="op" id="3240020">&gt;</span>&nbsp;<span class="num" id="3240022">10</span>&nbsp;<span class="op" id="3240025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3240031">return</span>&nbsp;<span class="string" id="3240038">&#34;&#34;</span><span class="op" id="3240040">,</span>&nbsp;<span class="builtinfunc" id="3240042">len</span><span class="op" id="3240045">(</span><span class="ident" id="3240046"><a href="/gostd/net/dnsmsg.go.html#3239242">msg</a></span><span class="op" id="3240049">)</span><span class="op" id="3240050">,</span>&nbsp;<span class="builtintype" id="3240052">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3240061">}</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3240066"><a href="/gostd/net/dnsmsg.go.html#3239254">off</a></span>&nbsp;<span class="op" id="3240070">=</span>&nbsp;<span class="op" id="3240072">(</span><span class="ident" id="3240073"><a href="/gostd/net/dnsmsg.go.html#3239416">c</a></span><span class="op" id="3240074">^</span><span class="num" id="3240075">0xC0</span><span class="op" id="3240079">)</span><span class="op" id="3240080">&lt;&lt;</span><span class="num" id="3240082">8</span>&nbsp;<span class="op" id="3240084">|</span>&nbsp;<span class="builtintype" id="3240086">int</span><span class="op" id="3240089">(</span><span class="ident" id="3240090"><a href="/gostd/net/dnsmsg.go.html#3239942">c1</a></span><span class="op" id="3240092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3240096">default</span><span class="op" id="3240103">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3240108">//&nbsp;0x80&nbsp;and&nbsp;0x40&nbsp;are&nbsp;reserved</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3240141">return</span>&nbsp;<span class="string" id="3240148">&#34;&#34;</span><span class="op" id="3240150">,</span>&nbsp;<span class="builtinfunc" id="3240152">len</span><span class="op" id="3240155">(</span><span class="ident" id="3240156"><a href="/gostd/net/dnsmsg.go.html#3239242">msg</a></span><span class="op" id="3240159">)</span><span class="op" id="3240160">,</span>&nbsp;<span class="builtintype" id="3240162">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3240170">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3240173">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3240176">if</span>&nbsp;<span class="ident" id="3240179"><a href="/gostd/net/dnsmsg.go.html#3239304">ptr</a></span>&nbsp;<span class="op" id="3240183">==</span>&nbsp;<span class="num" id="3240186">0</span>&nbsp;<span class="op" id="3240188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3240192"><a href="/gostd/net/dnsmsg.go.html#3239274">off1</a></span>&nbsp;<span class="op" id="3240197">=</span>&nbsp;<span class="ident" id="3240199"><a href="/gostd/net/dnsmsg.go.html#3239254">off</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3240204">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3240207">return</span>&nbsp;<span class="ident" id="3240214"><a href="/gostd/net/dnsmsg.go.html#3239264">s</a></span><span class="op" id="3240215">,</span>&nbsp;<span class="ident" id="3240217"><a href="/gostd/net/dnsmsg.go.html#3239274">off1</a></span><span class="op" id="3240221">,</span>&nbsp;<span class="builtintype" id="3240223">true</span><br>
<span class="lineno">485</span><span class="op" id="3240228">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3240231">//&nbsp;packStruct&nbsp;packs&nbsp;a&nbsp;structure&nbsp;into&nbsp;msg&nbsp;at&nbsp;specified&nbsp;offset&nbsp;off,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3240301">//&nbsp;returns&nbsp;off1&nbsp;such&nbsp;that&nbsp;msg[off:off1]&nbsp;is&nbsp;the&nbsp;encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="3240362">func</span>&nbsp;<span class="ident" id="3240367">packStruct</span><span class="op" id="3240377">(</span><span class="ident" id="3240378">any</span>&nbsp;<span class="ident" id="3240382"><a href="/gostd/net/dnsmsg.go.html#3229652">dnsStruct</a></span><span class="op" id="3240391">,</span>&nbsp;<span class="ident" id="3240393">msg</span>&nbsp;<span class="op" id="3240397">[</span><span class="op" id="3240398">]</span><span class="builtintype" id="3240399">byte</span><span class="op" id="3240403">,</span>&nbsp;<span class="ident" id="3240405">off</span>&nbsp;<span class="builtintype" id="3240409">int</span><span class="op" id="3240412">)</span>&nbsp;<span class="op" id="3240414">(</span><span class="ident" id="3240415">off1</span>&nbsp;<span class="builtintype" id="3240420">int</span><span class="op" id="3240423">,</span>&nbsp;<span class="ident" id="3240425">ok</span>&nbsp;<span class="builtintype" id="3240428">bool</span><span class="op" id="3240432">)</span>&nbsp;<span class="op" id="3240434">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3240437"><a href="/gostd/net/dnsmsg.go.html#3240425">ok</a></span>&nbsp;<span class="op" id="3240440">=</span>&nbsp;<span class="ident" id="3240442"><a href="/gostd/net/dnsmsg.go.html#3240378">any</a></span><span class="op" id="3240445">.</span><span class="ident" id="3240446"><a href="/gostd/net/dnsmsg.go.html#3230088">Walk</a></span><span class="op" id="3240450">(</span><span class="keyword" id="3240451">func</span><span class="op" id="3240455">(</span><span class="ident" id="3240456">field</span>&nbsp;<span class="keyword" id="3240462">interface</span><span class="op" id="3240471">{</span><span class="op" id="3240472">}</span><span class="op" id="3240473">,</span>&nbsp;<span class="ident" id="3240475">name</span><span class="op" id="3240479">,</span>&nbsp;<span class="ident" id="3240481">tag</span>&nbsp;<span class="builtintype" id="3240485">string</span><span class="op" id="3240491">)</span>&nbsp;<span class="builtintype" id="3240493">bool</span>&nbsp;<span class="op" id="3240498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3240502">switch</span>&nbsp;<span class="ident" id="3240509">fv</span>&nbsp;<span class="op" id="3240512">:=</span>&nbsp;<span class="ident" id="3240515"><a href="/gostd/net/dnsmsg.go.html#3240456">field</a></span><span class="op" id="3240520">.</span><span class="op" id="3240521">(</span><span class="keyword" id="3240522">type</span><span class="op" id="3240526">)</span>&nbsp;<span class="op" id="3240528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3240532">default</span><span class="op" id="3240539">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3240544">println</span><span class="op" id="3240551">(</span><span class="string" id="3240552">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;packing&nbsp;type&#34;</span><span class="op" id="3240584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3240589">return</span>&nbsp;<span class="builtintype" id="3240596">false</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3240604">case</span>&nbsp;<span class="op" id="3240609">*</span><span class="builtintype" id="3240610">uint16</span><span class="op" id="3240616">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3240621">i</span>&nbsp;<span class="op" id="3240623">:=</span>&nbsp;<span class="op" id="3240626">*</span><span class="ident" id="3240627"><a href="/gostd/net/dnsmsg.go.html#3240509">fv</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3240633">if</span>&nbsp;<span class="ident" id="3240636"><a href="/gostd/net/dnsmsg.go.html#3240405">off</a></span><span class="op" id="3240639">+</span><span class="num" id="3240640">2</span>&nbsp;<span class="op" id="3240642">&gt;</span>&nbsp;<span class="builtinfunc" id="3240644">len</span><span class="op" id="3240647">(</span><span class="ident" id="3240648"><a href="/gostd/net/dnsmsg.go.html#3240393">msg</a></span><span class="op" id="3240651">)</span>&nbsp;<span class="op" id="3240653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3240659">return</span>&nbsp;<span class="builtintype" id="3240666">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3240675">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3240680"><a href="/gostd/net/dnsmsg.go.html#3240393">msg</a></span><span class="op" id="3240683">[</span><span class="ident" id="3240684"><a href="/gostd/net/dnsmsg.go.html#3240405">off</a></span><span class="op" id="3240687">]</span>&nbsp;<span class="op" id="3240689">=</span>&nbsp;<span class="builtintype" id="3240691">byte</span><span class="op" id="3240695">(</span><span class="ident" id="3240696"><a href="/gostd/net/dnsmsg.go.html#3240621">i</a></span>&nbsp;<span class="op" id="3240698">&gt;&gt;</span>&nbsp;<span class="num" id="3240701">8</span><span class="op" id="3240702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3240707"><a href="/gostd/net/dnsmsg.go.html#3240393">msg</a></span><span class="op" id="3240710">[</span><span class="ident" id="3240711"><a href="/gostd/net/dnsmsg.go.html#3240405">off</a></span><span class="op" id="3240714">+</span><span class="num" id="3240715">1</span><span class="op" id="3240716">]</span>&nbsp;<span class="op" id="3240718">=</span>&nbsp;<span class="builtintype" id="3240720">byte</span><span class="op" id="3240724">(</span><span class="ident" id="3240725"><a href="/gostd/net/dnsmsg.go.html#3240621">i</a></span><span class="op" id="3240726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3240731"><a href="/gostd/net/dnsmsg.go.html#3240405">off</a></span>&nbsp;<span class="op" id="3240735">+=</span>&nbsp;<span class="num" id="3240738">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3240742">case</span>&nbsp;<span class="op" id="3240747">*</span><span class="builtintype" id="3240748">uint32</span><span class="op" id="3240754">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3240759">i</span>&nbsp;<span class="op" id="3240761">:=</span>&nbsp;<span class="op" id="3240764">*</span><span class="ident" id="3240765"><a href="/gostd/net/dnsmsg.go.html#3240509">fv</a></span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3240771"><a href="/gostd/net/dnsmsg.go.html#3240393">msg</a></span><span class="op" id="3240774">[</span><span class="ident" id="3240775"><a href="/gostd/net/dnsmsg.go.html#3240405">off</a></span><span class="op" id="3240778">]</span>&nbsp;<span class="op" id="3240780">=</span>&nbsp;<span class="builtintype" id="3240782">byte</span><span class="op" id="3240786">(</span><span class="ident" id="3240787"><a href="/gostd/net/dnsmsg.go.html#3240759">i</a></span>&nbsp;<span class="op" id="3240789">&gt;&gt;</span>&nbsp;<span class="num" id="3240792">24</span><span class="op" id="3240794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3240799"><a href="/gostd/net/dnsmsg.go.html#3240393">msg</a></span><span class="op" id="3240802">[</span><span class="ident" id="3240803"><a href="/gostd/net/dnsmsg.go.html#3240405">off</a></span><span class="op" id="3240806">+</span><span class="num" id="3240807">1</span><span class="op" id="3240808">]</span>&nbsp;<span class="op" id="3240810">=</span>&nbsp;<span class="builtintype" id="3240812">byte</span><span class="op" id="3240816">(</span><span class="ident" id="3240817"><a href="/gostd/net/dnsmsg.go.html#3240759">i</a></span>&nbsp;<span class="op" id="3240819">&gt;&gt;</span>&nbsp;<span class="num" id="3240822">16</span><span class="op" id="3240824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3240829"><a href="/gostd/net/dnsmsg.go.html#3240393">msg</a></span><span class="op" id="3240832">[</span><span class="ident" id="3240833"><a href="/gostd/net/dnsmsg.go.html#3240405">off</a></span><span class="op" id="3240836">+</span><span class="num" id="3240837">2</span><span class="op" id="3240838">]</span>&nbsp;<span class="op" id="3240840">=</span>&nbsp;<span class="builtintype" id="3240842">byte</span><span class="op" id="3240846">(</span><span class="ident" id="3240847"><a href="/gostd/net/dnsmsg.go.html#3240759">i</a></span>&nbsp;<span class="op" id="3240849">&gt;&gt;</span>&nbsp;<span class="num" id="3240852">8</span><span class="op" id="3240853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3240858"><a href="/gostd/net/dnsmsg.go.html#3240393">msg</a></span><span class="op" id="3240861">[</span><span class="ident" id="3240862"><a href="/gostd/net/dnsmsg.go.html#3240405">off</a></span><span class="op" id="3240865">+</span><span class="num" id="3240866">3</span><span class="op" id="3240867">]</span>&nbsp;<span class="op" id="3240869">=</span>&nbsp;<span class="builtintype" id="3240871">byte</span><span class="op" id="3240875">(</span><span class="ident" id="3240876"><a href="/gostd/net/dnsmsg.go.html#3240759">i</a></span><span class="op" id="3240877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3240882"><a href="/gostd/net/dnsmsg.go.html#3240405">off</a></span>&nbsp;<span class="op" id="3240886">+=</span>&nbsp;<span class="num" id="3240889">4</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3240893">case</span>&nbsp;<span class="op" id="3240898">[</span><span class="op" id="3240899">]</span><span class="builtintype" id="3240900">byte</span><span class="op" id="3240904">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3240909">n</span>&nbsp;<span class="op" id="3240911">:=</span>&nbsp;<span class="builtinfunc" id="3240914">len</span><span class="op" id="3240917">(</span><span class="ident" id="3240918"><a href="/gostd/net/dnsmsg.go.html#3240509">fv</a></span><span class="op" id="3240920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3240925">if</span>&nbsp;<span class="ident" id="3240928"><a href="/gostd/net/dnsmsg.go.html#3240405">off</a></span><span class="op" id="3240931">+</span><span class="ident" id="3240932"><a href="/gostd/net/dnsmsg.go.html#3240909">n</a></span>&nbsp;<span class="op" id="3240934">&gt;</span>&nbsp;<span class="builtinfunc" id="3240936">len</span><span class="op" id="3240939">(</span><span class="ident" id="3240940"><a href="/gostd/net/dnsmsg.go.html#3240393">msg</a></span><span class="op" id="3240943">)</span>&nbsp;<span class="op" id="3240945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3240951">return</span>&nbsp;<span class="builtintype" id="3240958">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3240967">}</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3240972">copy</span><span class="op" id="3240976">(</span><span class="ident" id="3240977"><a href="/gostd/net/dnsmsg.go.html#3240393">msg</a></span><span class="op" id="3240980">[</span><span class="ident" id="3240981"><a href="/gostd/net/dnsmsg.go.html#3240405">off</a></span><span class="op" id="3240984">:</span><span class="ident" id="3240985"><a href="/gostd/net/dnsmsg.go.html#3240405">off</a></span><span class="op" id="3240988">+</span><span class="ident" id="3240989"><a href="/gostd/net/dnsmsg.go.html#3240909">n</a></span><span class="op" id="3240990">]</span><span class="op" id="3240991">,</span>&nbsp;<span class="ident" id="3240993"><a href="/gostd/net/dnsmsg.go.html#3240509">fv</a></span><span class="op" id="3240995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3241000"><a href="/gostd/net/dnsmsg.go.html#3240405">off</a></span>&nbsp;<span class="op" id="3241004">+=</span>&nbsp;<span class="ident" id="3241007"><a href="/gostd/net/dnsmsg.go.html#3240909">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3241011">case</span>&nbsp;<span class="op" id="3241016">*</span><span class="builtintype" id="3241017">string</span><span class="op" id="3241023">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3241028">s</span>&nbsp;<span class="op" id="3241030">:=</span>&nbsp;<span class="op" id="3241033">*</span><span class="ident" id="3241034"><a href="/gostd/net/dnsmsg.go.html#3240509">fv</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3241040">switch</span>&nbsp;<span class="ident" id="3241047"><a href="/gostd/net/dnsmsg.go.html#3240481">tag</a></span>&nbsp;<span class="op" id="3241051">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3241056">default</span><span class="op" id="3241063">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3241069">println</span><span class="op" id="3241076">(</span><span class="string" id="3241077">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;string&nbsp;tag&#34;</span><span class="op" id="3241107">,</span>&nbsp;<span class="ident" id="3241109"><a href="/gostd/net/dnsmsg.go.html#3240481">tag</a></span><span class="op" id="3241112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3241118">return</span>&nbsp;<span class="builtintype" id="3241125">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3241134">case</span>&nbsp;<span class="string" id="3241139">&#34;domain&#34;</span><span class="op" id="3241147">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3241153"><a href="/gostd/net/dnsmsg.go.html#3240405">off</a></span><span class="op" id="3241156">,</span>&nbsp;<span class="ident" id="3241158"><a href="/gostd/net/dnsmsg.go.html#3240425">ok</a></span>&nbsp;<span class="op" id="3241161">=</span>&nbsp;<span class="ident" id="3241163"><a href="/gostd/net/dnsmsg.go.html#3237693">packDomainName</a></span><span class="op" id="3241177">(</span><span class="ident" id="3241178"><a href="/gostd/net/dnsmsg.go.html#3241028">s</a></span><span class="op" id="3241179">,</span>&nbsp;<span class="ident" id="3241181"><a href="/gostd/net/dnsmsg.go.html#3240393">msg</a></span><span class="op" id="3241184">,</span>&nbsp;<span class="ident" id="3241186"><a href="/gostd/net/dnsmsg.go.html#3240405">off</a></span><span class="op" id="3241189">)</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3241195">if</span>&nbsp;<span class="op" id="3241198">!</span><span class="ident" id="3241199"><a href="/gostd/net/dnsmsg.go.html#3240425">ok</a></span>&nbsp;<span class="op" id="3241202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3241209">return</span>&nbsp;<span class="builtintype" id="3241216">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3241226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3241231">case</span>&nbsp;<span class="string" id="3241236">&#34;&#34;</span><span class="op" id="3241238">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3241244">//&nbsp;Counted&nbsp;string:&nbsp;1&nbsp;byte&nbsp;length.</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3241282">if</span>&nbsp;<span class="builtinfunc" id="3241285">len</span><span class="op" id="3241288">(</span><span class="ident" id="3241289"><a href="/gostd/net/dnsmsg.go.html#3241028">s</a></span><span class="op" id="3241290">)</span>&nbsp;<span class="op" id="3241292">&gt;</span>&nbsp;<span class="num" id="3241294">255</span>&nbsp;<span class="op" id="3241298">||</span>&nbsp;<span class="ident" id="3241301"><a href="/gostd/net/dnsmsg.go.html#3240405">off</a></span><span class="op" id="3241304">+</span><span class="num" id="3241305">1</span><span class="op" id="3241306">+</span><span class="builtinfunc" id="3241307">len</span><span class="op" id="3241310">(</span><span class="ident" id="3241311"><a href="/gostd/net/dnsmsg.go.html#3241028">s</a></span><span class="op" id="3241312">)</span>&nbsp;<span class="op" id="3241314">&gt;</span>&nbsp;<span class="builtinfunc" id="3241316">len</span><span class="op" id="3241319">(</span><span class="ident" id="3241320"><a href="/gostd/net/dnsmsg.go.html#3240393">msg</a></span><span class="op" id="3241323">)</span>&nbsp;<span class="op" id="3241325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3241332">return</span>&nbsp;<span class="builtintype" id="3241339">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3241349">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3241355"><a href="/gostd/net/dnsmsg.go.html#3240393">msg</a></span><span class="op" id="3241358">[</span><span class="ident" id="3241359"><a href="/gostd/net/dnsmsg.go.html#3240405">off</a></span><span class="op" id="3241362">]</span>&nbsp;<span class="op" id="3241364">=</span>&nbsp;<span class="builtintype" id="3241366">byte</span><span class="op" id="3241370">(</span><span class="builtinfunc" id="3241371">len</span><span class="op" id="3241374">(</span><span class="ident" id="3241375"><a href="/gostd/net/dnsmsg.go.html#3241028">s</a></span><span class="op" id="3241376">)</span><span class="op" id="3241377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3241383"><a href="/gostd/net/dnsmsg.go.html#3240405">off</a></span><span class="op" id="3241386">++</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3241393"><a href="/gostd/net/dnsmsg.go.html#3240405">off</a></span>&nbsp;<span class="op" id="3241397">+=</span>&nbsp;<span class="builtinfunc" id="3241400">copy</span><span class="op" id="3241404">(</span><span class="ident" id="3241405"><a href="/gostd/net/dnsmsg.go.html#3240393">msg</a></span><span class="op" id="3241408">[</span><span class="ident" id="3241409"><a href="/gostd/net/dnsmsg.go.html#3240405">off</a></span><span class="op" id="3241412">:</span><span class="op" id="3241413">]</span><span class="op" id="3241414">,</span>&nbsp;<span class="ident" id="3241416"><a href="/gostd/net/dnsmsg.go.html#3241028">s</a></span><span class="op" id="3241417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3241422">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3241426">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3241430">return</span>&nbsp;<span class="builtintype" id="3241437">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3241443">}</span><span class="op" id="3241444">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3241447">if</span>&nbsp;<span class="op" id="3241450">!</span><span class="ident" id="3241451"><a href="/gostd/net/dnsmsg.go.html#3240425">ok</a></span>&nbsp;<span class="op" id="3241454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3241458">return</span>&nbsp;<span class="builtinfunc" id="3241465">len</span><span class="op" id="3241468">(</span><span class="ident" id="3241469"><a href="/gostd/net/dnsmsg.go.html#3240393">msg</a></span><span class="op" id="3241472">)</span><span class="op" id="3241473">,</span>&nbsp;<span class="builtintype" id="3241475">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3241482">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3241485">return</span>&nbsp;<span class="ident" id="3241492"><a href="/gostd/net/dnsmsg.go.html#3240405">off</a></span><span class="op" id="3241495">,</span>&nbsp;<span class="builtintype" id="3241497">true</span><br>
<span class="lineno"></span><span class="op" id="3241502">}</span><br>
<span class="lineno">545</span><br>
<span class="lineno"></span><span class="comment" id="3241505">//&nbsp;unpackStruct&nbsp;decodes&nbsp;msg[off:]into&nbsp;the&nbsp;given&nbsp;structure,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3241570">//&nbsp;returns&nbsp;off1&nbsp;such&nbsp;that&nbsp;msg[off:off1]&nbsp;is&nbsp;the&nbsp;encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="3241631">func</span>&nbsp;<span class="ident" id="3241636">unpackStruct</span><span class="op" id="3241648">(</span><span class="ident" id="3241649">any</span>&nbsp;<span class="ident" id="3241653"><a href="/gostd/net/dnsmsg.go.html#3229652">dnsStruct</a></span><span class="op" id="3241662">,</span>&nbsp;<span class="ident" id="3241664">msg</span>&nbsp;<span class="op" id="3241668">[</span><span class="op" id="3241669">]</span><span class="builtintype" id="3241670">byte</span><span class="op" id="3241674">,</span>&nbsp;<span class="ident" id="3241676">off</span>&nbsp;<span class="builtintype" id="3241680">int</span><span class="op" id="3241683">)</span>&nbsp;<span class="op" id="3241685">(</span><span class="ident" id="3241686">off1</span>&nbsp;<span class="builtintype" id="3241691">int</span><span class="op" id="3241694">,</span>&nbsp;<span class="ident" id="3241696">ok</span>&nbsp;<span class="builtintype" id="3241699">bool</span><span class="op" id="3241703">)</span>&nbsp;<span class="op" id="3241705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3241708"><a href="/gostd/net/dnsmsg.go.html#3241696">ok</a></span>&nbsp;<span class="op" id="3241711">=</span>&nbsp;<span class="ident" id="3241713"><a href="/gostd/net/dnsmsg.go.html#3241649">any</a></span><span class="op" id="3241716">.</span><span class="ident" id="3241717"><a href="/gostd/net/dnsmsg.go.html#3230088">Walk</a></span><span class="op" id="3241721">(</span><span class="keyword" id="3241722">func</span><span class="op" id="3241726">(</span><span class="ident" id="3241727">field</span>&nbsp;<span class="keyword" id="3241733">interface</span><span class="op" id="3241742">{</span><span class="op" id="3241743">}</span><span class="op" id="3241744">,</span>&nbsp;<span class="ident" id="3241746">name</span><span class="op" id="3241750">,</span>&nbsp;<span class="ident" id="3241752">tag</span>&nbsp;<span class="builtintype" id="3241756">string</span><span class="op" id="3241762">)</span>&nbsp;<span class="builtintype" id="3241764">bool</span>&nbsp;<span class="op" id="3241769">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3241773">switch</span>&nbsp;<span class="ident" id="3241780">fv</span>&nbsp;<span class="op" id="3241783">:=</span>&nbsp;<span class="ident" id="3241786"><a href="/gostd/net/dnsmsg.go.html#3241727">field</a></span><span class="op" id="3241791">.</span><span class="op" id="3241792">(</span><span class="keyword" id="3241793">type</span><span class="op" id="3241797">)</span>&nbsp;<span class="op" id="3241799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3241803">default</span><span class="op" id="3241810">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3241815">println</span><span class="op" id="3241822">(</span><span class="string" id="3241823">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;packing&nbsp;type&#34;</span><span class="op" id="3241855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3241860">return</span>&nbsp;<span class="builtintype" id="3241867">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3241875">case</span>&nbsp;<span class="op" id="3241880">*</span><span class="builtintype" id="3241881">uint16</span><span class="op" id="3241887">:</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3241892">if</span>&nbsp;<span class="ident" id="3241895"><a href="/gostd/net/dnsmsg.go.html#3241676">off</a></span><span class="op" id="3241898">+</span><span class="num" id="3241899">2</span>&nbsp;<span class="op" id="3241901">&gt;</span>&nbsp;<span class="builtinfunc" id="3241903">len</span><span class="op" id="3241906">(</span><span class="ident" id="3241907"><a href="/gostd/net/dnsmsg.go.html#3241664">msg</a></span><span class="op" id="3241910">)</span>&nbsp;<span class="op" id="3241912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3241918">return</span>&nbsp;<span class="builtintype" id="3241925">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3241934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3241939">*</span><span class="ident" id="3241940"><a href="/gostd/net/dnsmsg.go.html#3241780">fv</a></span>&nbsp;<span class="op" id="3241943">=</span>&nbsp;<span class="builtintype" id="3241945">uint16</span><span class="op" id="3241951">(</span><span class="ident" id="3241952"><a href="/gostd/net/dnsmsg.go.html#3241664">msg</a></span><span class="op" id="3241955">[</span><span class="ident" id="3241956"><a href="/gostd/net/dnsmsg.go.html#3241676">off</a></span><span class="op" id="3241959">]</span><span class="op" id="3241960">)</span><span class="op" id="3241961">&lt;&lt;</span><span class="num" id="3241963">8</span>&nbsp;<span class="op" id="3241965">|</span>&nbsp;<span class="builtintype" id="3241967">uint16</span><span class="op" id="3241973">(</span><span class="ident" id="3241974"><a href="/gostd/net/dnsmsg.go.html#3241664">msg</a></span><span class="op" id="3241977">[</span><span class="ident" id="3241978"><a href="/gostd/net/dnsmsg.go.html#3241676">off</a></span><span class="op" id="3241981">+</span><span class="num" id="3241982">1</span><span class="op" id="3241983">]</span><span class="op" id="3241984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3241989"><a href="/gostd/net/dnsmsg.go.html#3241676">off</a></span>&nbsp;<span class="op" id="3241993">+=</span>&nbsp;<span class="num" id="3241996">2</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3242000">case</span>&nbsp;<span class="op" id="3242005">*</span><span class="builtintype" id="3242006">uint32</span><span class="op" id="3242012">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3242017">if</span>&nbsp;<span class="ident" id="3242020"><a href="/gostd/net/dnsmsg.go.html#3241676">off</a></span><span class="op" id="3242023">+</span><span class="num" id="3242024">4</span>&nbsp;<span class="op" id="3242026">&gt;</span>&nbsp;<span class="builtinfunc" id="3242028">len</span><span class="op" id="3242031">(</span><span class="ident" id="3242032"><a href="/gostd/net/dnsmsg.go.html#3241664">msg</a></span><span class="op" id="3242035">)</span>&nbsp;<span class="op" id="3242037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3242043">return</span>&nbsp;<span class="builtintype" id="3242050">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3242059">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3242064">*</span><span class="ident" id="3242065"><a href="/gostd/net/dnsmsg.go.html#3241780">fv</a></span>&nbsp;<span class="op" id="3242068">=</span>&nbsp;<span class="builtintype" id="3242070">uint32</span><span class="op" id="3242076">(</span><span class="ident" id="3242077"><a href="/gostd/net/dnsmsg.go.html#3241664">msg</a></span><span class="op" id="3242080">[</span><span class="ident" id="3242081"><a href="/gostd/net/dnsmsg.go.html#3241676">off</a></span><span class="op" id="3242084">]</span><span class="op" id="3242085">)</span><span class="op" id="3242086">&lt;&lt;</span><span class="num" id="3242088">24</span>&nbsp;<span class="op" id="3242091">|</span>&nbsp;<span class="builtintype" id="3242093">uint32</span><span class="op" id="3242099">(</span><span class="ident" id="3242100"><a href="/gostd/net/dnsmsg.go.html#3241664">msg</a></span><span class="op" id="3242103">[</span><span class="ident" id="3242104"><a href="/gostd/net/dnsmsg.go.html#3241676">off</a></span><span class="op" id="3242107">+</span><span class="num" id="3242108">1</span><span class="op" id="3242109">]</span><span class="op" id="3242110">)</span><span class="op" id="3242111">&lt;&lt;</span><span class="num" id="3242113">16</span>&nbsp;<span class="op" id="3242116">|</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3242122">uint32</span><span class="op" id="3242128">(</span><span class="ident" id="3242129"><a href="/gostd/net/dnsmsg.go.html#3241664">msg</a></span><span class="op" id="3242132">[</span><span class="ident" id="3242133"><a href="/gostd/net/dnsmsg.go.html#3241676">off</a></span><span class="op" id="3242136">+</span><span class="num" id="3242137">2</span><span class="op" id="3242138">]</span><span class="op" id="3242139">)</span><span class="op" id="3242140">&lt;&lt;</span><span class="num" id="3242142">8</span>&nbsp;<span class="op" id="3242144">|</span>&nbsp;<span class="builtintype" id="3242146">uint32</span><span class="op" id="3242152">(</span><span class="ident" id="3242153"><a href="/gostd/net/dnsmsg.go.html#3241664">msg</a></span><span class="op" id="3242156">[</span><span class="ident" id="3242157"><a href="/gostd/net/dnsmsg.go.html#3241676">off</a></span><span class="op" id="3242160">+</span><span class="num" id="3242161">3</span><span class="op" id="3242162">]</span><span class="op" id="3242163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3242168"><a href="/gostd/net/dnsmsg.go.html#3241676">off</a></span>&nbsp;<span class="op" id="3242172">+=</span>&nbsp;<span class="num" id="3242175">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3242179">case</span>&nbsp;<span class="op" id="3242184">[</span><span class="op" id="3242185">]</span><span class="builtintype" id="3242186">byte</span><span class="op" id="3242190">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3242195">n</span>&nbsp;<span class="op" id="3242197">:=</span>&nbsp;<span class="builtinfunc" id="3242200">len</span><span class="op" id="3242203">(</span><span class="ident" id="3242204"><a href="/gostd/net/dnsmsg.go.html#3241780">fv</a></span><span class="op" id="3242206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3242211">if</span>&nbsp;<span class="ident" id="3242214"><a href="/gostd/net/dnsmsg.go.html#3241676">off</a></span><span class="op" id="3242217">+</span><span class="ident" id="3242218"><a href="/gostd/net/dnsmsg.go.html#3242195">n</a></span>&nbsp;<span class="op" id="3242220">&gt;</span>&nbsp;<span class="builtinfunc" id="3242222">len</span><span class="op" id="3242225">(</span><span class="ident" id="3242226"><a href="/gostd/net/dnsmsg.go.html#3241664">msg</a></span><span class="op" id="3242229">)</span>&nbsp;<span class="op" id="3242231">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3242237">return</span>&nbsp;<span class="builtintype" id="3242244">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3242253">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3242258">copy</span><span class="op" id="3242262">(</span><span class="ident" id="3242263"><a href="/gostd/net/dnsmsg.go.html#3241780">fv</a></span><span class="op" id="3242265">,</span>&nbsp;<span class="ident" id="3242267"><a href="/gostd/net/dnsmsg.go.html#3241664">msg</a></span><span class="op" id="3242270">[</span><span class="ident" id="3242271"><a href="/gostd/net/dnsmsg.go.html#3241676">off</a></span><span class="op" id="3242274">:</span><span class="ident" id="3242275"><a href="/gostd/net/dnsmsg.go.html#3241676">off</a></span><span class="op" id="3242278">+</span><span class="ident" id="3242279"><a href="/gostd/net/dnsmsg.go.html#3242195">n</a></span><span class="op" id="3242280">]</span><span class="op" id="3242281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3242286"><a href="/gostd/net/dnsmsg.go.html#3241676">off</a></span>&nbsp;<span class="op" id="3242290">+=</span>&nbsp;<span class="ident" id="3242293"><a href="/gostd/net/dnsmsg.go.html#3242195">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3242297">case</span>&nbsp;<span class="op" id="3242302">*</span><span class="builtintype" id="3242303">string</span><span class="op" id="3242309">:</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3242314">var</span>&nbsp;<span class="ident" id="3242318">s</span>&nbsp;<span class="builtintype" id="3242320">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3242330">switch</span>&nbsp;<span class="ident" id="3242337"><a href="/gostd/net/dnsmsg.go.html#3241752">tag</a></span>&nbsp;<span class="op" id="3242341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3242346">default</span><span class="op" id="3242353">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3242359">println</span><span class="op" id="3242366">(</span><span class="string" id="3242367">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;string&nbsp;tag&#34;</span><span class="op" id="3242397">,</span>&nbsp;<span class="ident" id="3242399"><a href="/gostd/net/dnsmsg.go.html#3241752">tag</a></span><span class="op" id="3242402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3242408">return</span>&nbsp;<span class="builtintype" id="3242415">false</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3242424">case</span>&nbsp;<span class="string" id="3242429">&#34;domain&#34;</span><span class="op" id="3242437">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3242443"><a href="/gostd/net/dnsmsg.go.html#3242318">s</a></span><span class="op" id="3242444">,</span>&nbsp;<span class="ident" id="3242446"><a href="/gostd/net/dnsmsg.go.html#3241676">off</a></span><span class="op" id="3242449">,</span>&nbsp;<span class="ident" id="3242451"><a href="/gostd/net/dnsmsg.go.html#3241696">ok</a></span>&nbsp;<span class="op" id="3242454">=</span>&nbsp;<span class="ident" id="3242456"><a href="/gostd/net/dnsmsg.go.html#3239225">unpackDomainName</a></span><span class="op" id="3242472">(</span><span class="ident" id="3242473"><a href="/gostd/net/dnsmsg.go.html#3241664">msg</a></span><span class="op" id="3242476">,</span>&nbsp;<span class="ident" id="3242478"><a href="/gostd/net/dnsmsg.go.html#3241676">off</a></span><span class="op" id="3242481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3242487">if</span>&nbsp;<span class="op" id="3242490">!</span><span class="ident" id="3242491"><a href="/gostd/net/dnsmsg.go.html#3241696">ok</a></span>&nbsp;<span class="op" id="3242494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3242501">return</span>&nbsp;<span class="builtintype" id="3242508">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3242518">}</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3242523">case</span>&nbsp;<span class="string" id="3242528">&#34;&#34;</span><span class="op" id="3242530">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3242536">if</span>&nbsp;<span class="ident" id="3242539"><a href="/gostd/net/dnsmsg.go.html#3241676">off</a></span>&nbsp;<span class="op" id="3242543">&gt;=</span>&nbsp;<span class="builtinfunc" id="3242546">len</span><span class="op" id="3242549">(</span><span class="ident" id="3242550"><a href="/gostd/net/dnsmsg.go.html#3241664">msg</a></span><span class="op" id="3242553">)</span>&nbsp;<span class="op" id="3242555">||</span>&nbsp;<span class="ident" id="3242558"><a href="/gostd/net/dnsmsg.go.html#3241676">off</a></span><span class="op" id="3242561">+</span><span class="num" id="3242562">1</span><span class="op" id="3242563">+</span><span class="builtintype" id="3242564">int</span><span class="op" id="3242567">(</span><span class="ident" id="3242568"><a href="/gostd/net/dnsmsg.go.html#3241664">msg</a></span><span class="op" id="3242571">[</span><span class="ident" id="3242572"><a href="/gostd/net/dnsmsg.go.html#3241676">off</a></span><span class="op" id="3242575">]</span><span class="op" id="3242576">)</span>&nbsp;<span class="op" id="3242578">&gt;</span>&nbsp;<span class="builtinfunc" id="3242580">len</span><span class="op" id="3242583">(</span><span class="ident" id="3242584"><a href="/gostd/net/dnsmsg.go.html#3241664">msg</a></span><span class="op" id="3242587">)</span>&nbsp;<span class="op" id="3242589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3242596">return</span>&nbsp;<span class="builtintype" id="3242603">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3242613">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3242619">n</span>&nbsp;<span class="op" id="3242621">:=</span>&nbsp;<span class="builtintype" id="3242624">int</span><span class="op" id="3242627">(</span><span class="ident" id="3242628"><a href="/gostd/net/dnsmsg.go.html#3241664">msg</a></span><span class="op" id="3242631">[</span><span class="ident" id="3242632"><a href="/gostd/net/dnsmsg.go.html#3241676">off</a></span><span class="op" id="3242635">]</span><span class="op" id="3242636">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3242642"><a href="/gostd/net/dnsmsg.go.html#3241676">off</a></span><span class="op" id="3242645">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3242652">b</span>&nbsp;<span class="op" id="3242654">:=</span>&nbsp;<span class="builtinfunc" id="3242657">make</span><span class="op" id="3242661">(</span><span class="op" id="3242662">[</span><span class="op" id="3242663">]</span><span class="builtintype" id="3242664">byte</span><span class="op" id="3242668">,</span>&nbsp;<span class="ident" id="3242670"><a href="/gostd/net/dnsmsg.go.html#3242619">n</a></span><span class="op" id="3242671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3242677">for</span>&nbsp;<span class="ident" id="3242681">i</span>&nbsp;<span class="op" id="3242683">:=</span>&nbsp;<span class="num" id="3242686">0</span><span class="op" id="3242687">;</span>&nbsp;<span class="ident" id="3242689"><a href="/gostd/net/dnsmsg.go.html#3242681">i</a></span>&nbsp;<span class="op" id="3242691">&lt;</span>&nbsp;<span class="ident" id="3242693"><a href="/gostd/net/dnsmsg.go.html#3242619">n</a></span><span class="op" id="3242694">;</span>&nbsp;<span class="ident" id="3242696"><a href="/gostd/net/dnsmsg.go.html#3242681">i</a></span><span class="op" id="3242697">++</span>&nbsp;<span class="op" id="3242700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3242707"><a href="/gostd/net/dnsmsg.go.html#3242652">b</a></span><span class="op" id="3242708">[</span><span class="ident" id="3242709"><a href="/gostd/net/dnsmsg.go.html#3242681">i</a></span><span class="op" id="3242710">]</span>&nbsp;<span class="op" id="3242712">=</span>&nbsp;<span class="ident" id="3242714"><a href="/gostd/net/dnsmsg.go.html#3241664">msg</a></span><span class="op" id="3242717">[</span><span class="ident" id="3242718"><a href="/gostd/net/dnsmsg.go.html#3241676">off</a></span><span class="op" id="3242721">+</span><span class="ident" id="3242722"><a href="/gostd/net/dnsmsg.go.html#3242681">i</a></span><span class="op" id="3242723">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3242729">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3242735"><a href="/gostd/net/dnsmsg.go.html#3241676">off</a></span>&nbsp;<span class="op" id="3242739">+=</span>&nbsp;<span class="ident" id="3242742"><a href="/gostd/net/dnsmsg.go.html#3242619">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3242748"><a href="/gostd/net/dnsmsg.go.html#3242318">s</a></span>&nbsp;<span class="op" id="3242750">=</span>&nbsp;<span class="builtintype" id="3242752">string</span><span class="op" id="3242758">(</span><span class="ident" id="3242759"><a href="/gostd/net/dnsmsg.go.html#3242652">b</a></span><span class="op" id="3242760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3242765">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3242770">*</span><span class="ident" id="3242771"><a href="/gostd/net/dnsmsg.go.html#3241780">fv</a></span>&nbsp;<span class="op" id="3242774">=</span>&nbsp;<span class="ident" id="3242776"><a href="/gostd/net/dnsmsg.go.html#3242318">s</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3242780">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3242784">return</span>&nbsp;<span class="builtintype" id="3242791">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3242797">}</span><span class="op" id="3242798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3242801">if</span>&nbsp;<span class="op" id="3242804">!</span><span class="ident" id="3242805"><a href="/gostd/net/dnsmsg.go.html#3241696">ok</a></span>&nbsp;<span class="op" id="3242808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3242812">return</span>&nbsp;<span class="builtinfunc" id="3242819">len</span><span class="op" id="3242822">(</span><span class="ident" id="3242823"><a href="/gostd/net/dnsmsg.go.html#3241664">msg</a></span><span class="op" id="3242826">)</span><span class="op" id="3242827">,</span>&nbsp;<span class="builtintype" id="3242829">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3242836">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3242839">return</span>&nbsp;<span class="ident" id="3242846"><a href="/gostd/net/dnsmsg.go.html#3241676">off</a></span><span class="op" id="3242849">,</span>&nbsp;<span class="builtintype" id="3242851">true</span><br>
<span class="lineno"></span><span class="op" id="3242856">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3242859">//&nbsp;Generic&nbsp;struct&nbsp;printer.&nbsp;Prints&nbsp;fields&nbsp;with&nbsp;tag&nbsp;&#34;ipv4&#34;&nbsp;or&nbsp;&#34;ipv6&#34;</span><br>
<span class="lineno"></span><span class="comment" id="3242926">//&nbsp;as&nbsp;IP&nbsp;addresses.</span><br>
<span class="lineno">610</span><span class="keyword" id="3242946">func</span>&nbsp;<span class="ident" id="3242951">printStruct</span><span class="op" id="3242962">(</span><span class="ident" id="3242963">any</span>&nbsp;<span class="ident" id="3242967"><a href="/gostd/net/dnsmsg.go.html#3229652">dnsStruct</a></span><span class="op" id="3242976">)</span>&nbsp;<span class="builtintype" id="3242978">string</span>&nbsp;<span class="op" id="3242985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3242988">s</span>&nbsp;<span class="op" id="3242990">:=</span>&nbsp;<span class="string" id="3242993">&#34;{&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3242998">i</span>&nbsp;<span class="op" id="3243000">:=</span>&nbsp;<span class="num" id="3243003">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3243006"><a href="/gostd/net/dnsmsg.go.html#3242963">any</a></span><span class="op" id="3243009">.</span><span class="ident" id="3243010"><a href="/gostd/net/dnsmsg.go.html#3230088">Walk</a></span><span class="op" id="3243014">(</span><span class="keyword" id="3243015">func</span><span class="op" id="3243019">(</span><span class="ident" id="3243020">val</span>&nbsp;<span class="keyword" id="3243024">interface</span><span class="op" id="3243033">{</span><span class="op" id="3243034">}</span><span class="op" id="3243035">,</span>&nbsp;<span class="ident" id="3243037">name</span><span class="op" id="3243041">,</span>&nbsp;<span class="ident" id="3243043">tag</span>&nbsp;<span class="builtintype" id="3243047">string</span><span class="op" id="3243053">)</span>&nbsp;<span class="builtintype" id="3243055">bool</span>&nbsp;<span class="op" id="3243060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3243064"><a href="/gostd/net/dnsmsg.go.html#3242998">i</a></span><span class="op" id="3243065">++</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3243070">if</span>&nbsp;<span class="ident" id="3243073"><a href="/gostd/net/dnsmsg.go.html#3242998">i</a></span>&nbsp;<span class="op" id="3243075">&gt;</span>&nbsp;<span class="num" id="3243077">1</span>&nbsp;<span class="op" id="3243079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3243084"><a href="/gostd/net/dnsmsg.go.html#3242988">s</a></span>&nbsp;<span class="op" id="3243086">+=</span>&nbsp;<span class="string" id="3243089">&#34;,&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3243096">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3243100"><a href="/gostd/net/dnsmsg.go.html#3242988">s</a></span>&nbsp;<span class="op" id="3243102">+=</span>&nbsp;<span class="ident" id="3243105"><a href="/gostd/net/dnsmsg.go.html#3243037">name</a></span>&nbsp;<span class="op" id="3243110">+</span>&nbsp;<span class="string" id="3243112">&#34;=&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3243118">switch</span>&nbsp;<span class="ident" id="3243125"><a href="/gostd/net/dnsmsg.go.html#3243043">tag</a></span>&nbsp;<span class="op" id="3243129">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3243133">case</span>&nbsp;<span class="string" id="3243138">&#34;ipv4&#34;</span><span class="op" id="3243144">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3243149">i</span>&nbsp;<span class="op" id="3243151">:=</span>&nbsp;<span class="op" id="3243154">*</span><span class="ident" id="3243155"><a href="/gostd/net/dnsmsg.go.html#3243020">val</a></span><span class="op" id="3243158">.</span><span class="op" id="3243159">(</span><span class="op" id="3243160">*</span><span class="builtintype" id="3243161">uint32</span><span class="op" id="3243167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3243172"><a href="/gostd/net/dnsmsg.go.html#3242988">s</a></span>&nbsp;<span class="op" id="3243174">+=</span>&nbsp;<span class="ident" id="3243177"><a href="/gostd/net/ip.go.html#3286541">IPv4</a></span><span class="op" id="3243181">(</span><span class="builtintype" id="3243182">byte</span><span class="op" id="3243186">(</span><span class="ident" id="3243187"><a href="/gostd/net/dnsmsg.go.html#3243149">i</a></span><span class="op" id="3243188">&gt;&gt;</span><span class="num" id="3243190">24</span><span class="op" id="3243192">)</span><span class="op" id="3243193">,</span>&nbsp;<span class="builtintype" id="3243195">byte</span><span class="op" id="3243199">(</span><span class="ident" id="3243200"><a href="/gostd/net/dnsmsg.go.html#3243149">i</a></span><span class="op" id="3243201">&gt;&gt;</span><span class="num" id="3243203">16</span><span class="op" id="3243205">)</span><span class="op" id="3243206">,</span>&nbsp;<span class="builtintype" id="3243208">byte</span><span class="op" id="3243212">(</span><span class="ident" id="3243213"><a href="/gostd/net/dnsmsg.go.html#3243149">i</a></span><span class="op" id="3243214">&gt;&gt;</span><span class="num" id="3243216">8</span><span class="op" id="3243217">)</span><span class="op" id="3243218">,</span>&nbsp;<span class="builtintype" id="3243220">byte</span><span class="op" id="3243224">(</span><span class="ident" id="3243225"><a href="/gostd/net/dnsmsg.go.html#3243149">i</a></span><span class="op" id="3243226">)</span><span class="op" id="3243227">)</span><span class="op" id="3243228">.</span><span class="ident" id="3243229"><a href="/gostd/net/ip.go.html#3291839">String</a></span><span class="op" id="3243235">(</span><span class="op" id="3243236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3243240">case</span>&nbsp;<span class="string" id="3243245">&#34;ipv6&#34;</span><span class="op" id="3243251">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3243256">i</span>&nbsp;<span class="op" id="3243258">:=</span>&nbsp;<span class="ident" id="3243261"><a href="/gostd/net/dnsmsg.go.html#3243020">val</a></span><span class="op" id="3243264">.</span><span class="op" id="3243265">(</span><span class="op" id="3243266">[</span><span class="op" id="3243267">]</span><span class="builtintype" id="3243268">byte</span><span class="op" id="3243272">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3243277"><a href="/gostd/net/dnsmsg.go.html#3242988">s</a></span>&nbsp;<span class="op" id="3243279">+=</span>&nbsp;<span class="ident" id="3243282"><a href="/gostd/net/ip.go.html#3286271">IP</a></span><span class="op" id="3243284">(</span><span class="ident" id="3243285"><a href="/gostd/net/dnsmsg.go.html#3243256">i</a></span><span class="op" id="3243286">)</span><span class="op" id="3243287">.</span><span class="ident" id="3243288"><a href="/gostd/net/ip.go.html#3291839">String</a></span><span class="op" id="3243294">(</span><span class="op" id="3243295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3243299">default</span><span class="op" id="3243306">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3243311">var</span>&nbsp;<span class="ident" id="3243315">i</span>&nbsp;<span class="builtintype" id="3243317">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3243326">switch</span>&nbsp;<span class="ident" id="3243333">v</span>&nbsp;<span class="op" id="3243335">:=</span>&nbsp;<span class="ident" id="3243338"><a href="/gostd/net/dnsmsg.go.html#3243020">val</a></span><span class="op" id="3243341">.</span><span class="op" id="3243342">(</span><span class="keyword" id="3243343">type</span><span class="op" id="3243347">)</span>&nbsp;<span class="op" id="3243349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3243354">default</span><span class="op" id="3243361">:</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3243367">//&nbsp;can&#39;t&nbsp;really&nbsp;happen.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3243395"><a href="/gostd/net/dnsmsg.go.html#3242988">s</a></span>&nbsp;<span class="op" id="3243397">+=</span>&nbsp;<span class="string" id="3243400">&#34;&lt;unknown&nbsp;type&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3243421">return</span>&nbsp;<span class="builtintype" id="3243428">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3243436">case</span>&nbsp;<span class="op" id="3243441">*</span><span class="builtintype" id="3243442">string</span><span class="op" id="3243448">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3243454"><a href="/gostd/net/dnsmsg.go.html#3242988">s</a></span>&nbsp;<span class="op" id="3243456">+=</span>&nbsp;<span class="op" id="3243459">*</span><span class="ident" id="3243460"><a href="/gostd/net/dnsmsg.go.html#3243333">v</a></span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3243466">return</span>&nbsp;<span class="builtintype" id="3243473">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3243481">case</span>&nbsp;<span class="op" id="3243486">[</span><span class="op" id="3243487">]</span><span class="builtintype" id="3243488">byte</span><span class="op" id="3243492">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3243498"><a href="/gostd/net/dnsmsg.go.html#3242988">s</a></span>&nbsp;<span class="op" id="3243500">+=</span>&nbsp;<span class="builtintype" id="3243503">string</span><span class="op" id="3243509">(</span><span class="ident" id="3243510"><a href="/gostd/net/dnsmsg.go.html#3243333">v</a></span><span class="op" id="3243511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3243517">return</span>&nbsp;<span class="builtintype" id="3243524">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3243532">case</span>&nbsp;<span class="op" id="3243537">*</span><span class="builtintype" id="3243538">bool</span><span class="op" id="3243542">:</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3243548">if</span>&nbsp;<span class="op" id="3243551">*</span><span class="ident" id="3243552"><a href="/gostd/net/dnsmsg.go.html#3243333">v</a></span>&nbsp;<span class="op" id="3243554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3243561"><a href="/gostd/net/dnsmsg.go.html#3242988">s</a></span>&nbsp;<span class="op" id="3243563">+=</span>&nbsp;<span class="string" id="3243566">&#34;true&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3243577">}</span>&nbsp;<span class="keyword" id="3243579">else</span>&nbsp;<span class="op" id="3243584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3243591"><a href="/gostd/net/dnsmsg.go.html#3242988">s</a></span>&nbsp;<span class="op" id="3243593">+=</span>&nbsp;<span class="string" id="3243596">&#34;false&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3243608">}</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3243614">return</span>&nbsp;<span class="builtintype" id="3243621">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3243629">case</span>&nbsp;<span class="op" id="3243634">*</span><span class="builtintype" id="3243635">int</span><span class="op" id="3243638">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3243644"><a href="/gostd/net/dnsmsg.go.html#3243315">i</a></span>&nbsp;<span class="op" id="3243646">=</span>&nbsp;<span class="builtintype" id="3243648">int64</span><span class="op" id="3243653">(</span><span class="op" id="3243654">*</span><span class="ident" id="3243655"><a href="/gostd/net/dnsmsg.go.html#3243333">v</a></span><span class="op" id="3243656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3243661">case</span>&nbsp;<span class="op" id="3243666">*</span><span class="builtintype" id="3243667">uint</span><span class="op" id="3243671">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3243677"><a href="/gostd/net/dnsmsg.go.html#3243315">i</a></span>&nbsp;<span class="op" id="3243679">=</span>&nbsp;<span class="builtintype" id="3243681">int64</span><span class="op" id="3243686">(</span><span class="op" id="3243687">*</span><span class="ident" id="3243688"><a href="/gostd/net/dnsmsg.go.html#3243333">v</a></span><span class="op" id="3243689">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3243694">case</span>&nbsp;<span class="op" id="3243699">*</span><span class="builtintype" id="3243700">uint8</span><span class="op" id="3243705">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3243711"><a href="/gostd/net/dnsmsg.go.html#3243315">i</a></span>&nbsp;<span class="op" id="3243713">=</span>&nbsp;<span class="builtintype" id="3243715">int64</span><span class="op" id="3243720">(</span><span class="op" id="3243721">*</span><span class="ident" id="3243722"><a href="/gostd/net/dnsmsg.go.html#3243333">v</a></span><span class="op" id="3243723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3243728">case</span>&nbsp;<span class="op" id="3243733">*</span><span class="builtintype" id="3243734">uint16</span><span class="op" id="3243740">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3243746"><a href="/gostd/net/dnsmsg.go.html#3243315">i</a></span>&nbsp;<span class="op" id="3243748">=</span>&nbsp;<span class="builtintype" id="3243750">int64</span><span class="op" id="3243755">(</span><span class="op" id="3243756">*</span><span class="ident" id="3243757"><a href="/gostd/net/dnsmsg.go.html#3243333">v</a></span><span class="op" id="3243758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3243763">case</span>&nbsp;<span class="op" id="3243768">*</span><span class="builtintype" id="3243769">uint32</span><span class="op" id="3243775">:</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3243781"><a href="/gostd/net/dnsmsg.go.html#3243315">i</a></span>&nbsp;<span class="op" id="3243783">=</span>&nbsp;<span class="builtintype" id="3243785">int64</span><span class="op" id="3243790">(</span><span class="op" id="3243791">*</span><span class="ident" id="3243792"><a href="/gostd/net/dnsmsg.go.html#3243333">v</a></span><span class="op" id="3243793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3243798">case</span>&nbsp;<span class="op" id="3243803">*</span><span class="builtintype" id="3243804">uint64</span><span class="op" id="3243810">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3243816"><a href="/gostd/net/dnsmsg.go.html#3243315">i</a></span>&nbsp;<span class="op" id="3243818">=</span>&nbsp;<span class="builtintype" id="3243820">int64</span><span class="op" id="3243825">(</span><span class="op" id="3243826">*</span><span class="ident" id="3243827"><a href="/gostd/net/dnsmsg.go.html#3243333">v</a></span><span class="op" id="3243828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3243833">case</span>&nbsp;<span class="op" id="3243838">*</span><span class="builtintype" id="3243839">uintptr</span><span class="op" id="3243846">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3243852"><a href="/gostd/net/dnsmsg.go.html#3243315">i</a></span>&nbsp;<span class="op" id="3243854">=</span>&nbsp;<span class="builtintype" id="3243856">int64</span><span class="op" id="3243861">(</span><span class="op" id="3243862">*</span><span class="ident" id="3243863"><a href="/gostd/net/dnsmsg.go.html#3243333">v</a></span><span class="op" id="3243864">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3243869">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3243874"><a href="/gostd/net/dnsmsg.go.html#3242988">s</a></span>&nbsp;<span class="op" id="3243876">+=</span>&nbsp;<span class="ident" id="3243879"><a href="/gostd/net/parse.go.html#3348151">itoa</a></span><span class="op" id="3243883">(</span><span class="builtintype" id="3243884">int</span><span class="op" id="3243887">(</span><span class="ident" id="3243888"><a href="/gostd/net/dnsmsg.go.html#3243315">i</a></span><span class="op" id="3243889">)</span><span class="op" id="3243890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3243894">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3243898">return</span>&nbsp;<span class="builtintype" id="3243905">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3243911">}</span><span class="op" id="3243912">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3243915"><a href="/gostd/net/dnsmsg.go.html#3242988">s</a></span>&nbsp;<span class="op" id="3243917">+=</span>&nbsp;<span class="string" id="3243920">&#34;}&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3243925">return</span>&nbsp;<span class="ident" id="3243932"><a href="/gostd/net/dnsmsg.go.html#3242988">s</a></span><br>
<span class="lineno"></span><span class="op" id="3243934">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3243937">//&nbsp;Resource&nbsp;record&nbsp;packer.</span><br>
<span class="lineno">670</span><span class="keyword" id="3243964">func</span>&nbsp;<span class="ident" id="3243969">packRR</span><span class="op" id="3243975">(</span><span class="ident" id="3243976">rr</span>&nbsp;<span class="ident" id="3243979"><a href="/gostd/net/dnsmsg.go.html#3231784">dnsRR</a></span><span class="op" id="3243984">,</span>&nbsp;<span class="ident" id="3243986">msg</span>&nbsp;<span class="op" id="3243990">[</span><span class="op" id="3243991">]</span><span class="builtintype" id="3243992">byte</span><span class="op" id="3243996">,</span>&nbsp;<span class="ident" id="3243998">off</span>&nbsp;<span class="builtintype" id="3244002">int</span><span class="op" id="3244005">)</span>&nbsp;<span class="op" id="3244007">(</span><span class="ident" id="3244008">off2</span>&nbsp;<span class="builtintype" id="3244013">int</span><span class="op" id="3244016">,</span>&nbsp;<span class="ident" id="3244018">ok</span>&nbsp;<span class="builtintype" id="3244021">bool</span><span class="op" id="3244025">)</span>&nbsp;<span class="op" id="3244027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3244030">var</span>&nbsp;<span class="ident" id="3244034">off1</span>&nbsp;<span class="builtintype" id="3244039">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3244044">//&nbsp;pack&nbsp;twice,&nbsp;once&nbsp;to&nbsp;find&nbsp;end&nbsp;of&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3244087">//&nbsp;and&nbsp;again&nbsp;to&nbsp;find&nbsp;end&nbsp;of&nbsp;packet.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3244124">//&nbsp;a&nbsp;bit&nbsp;inefficient&nbsp;but&nbsp;this&nbsp;doesn&#39;t&nbsp;need&nbsp;to&nbsp;be&nbsp;fast.</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3244180">//&nbsp;off1&nbsp;is&nbsp;end&nbsp;of&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3244206">//&nbsp;off2&nbsp;is&nbsp;end&nbsp;of&nbsp;rr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3244228"><a href="/gostd/net/dnsmsg.go.html#3244034">off1</a></span><span class="op" id="3244232">,</span>&nbsp;<span class="ident" id="3244234"><a href="/gostd/net/dnsmsg.go.html#3244018">ok</a></span>&nbsp;<span class="op" id="3244237">=</span>&nbsp;<span class="ident" id="3244239"><a href="/gostd/net/dnsmsg.go.html#3240367">packStruct</a></span><span class="op" id="3244249">(</span><span class="ident" id="3244250"><a href="/gostd/net/dnsmsg.go.html#3243976">rr</a></span><span class="op" id="3244252">.</span><span class="ident" id="3244253"><a href="/gostd/net/dnsmsg.go.html#3231814">Header</a></span><span class="op" id="3244259">(</span><span class="op" id="3244260">)</span><span class="op" id="3244261">,</span>&nbsp;<span class="ident" id="3244263"><a href="/gostd/net/dnsmsg.go.html#3243986">msg</a></span><span class="op" id="3244266">,</span>&nbsp;<span class="ident" id="3244268"><a href="/gostd/net/dnsmsg.go.html#3243998">off</a></span><span class="op" id="3244271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3244274"><a href="/gostd/net/dnsmsg.go.html#3244008">off2</a></span><span class="op" id="3244278">,</span>&nbsp;<span class="ident" id="3244280"><a href="/gostd/net/dnsmsg.go.html#3244018">ok</a></span>&nbsp;<span class="op" id="3244283">=</span>&nbsp;<span class="ident" id="3244285"><a href="/gostd/net/dnsmsg.go.html#3240367">packStruct</a></span><span class="op" id="3244295">(</span><span class="ident" id="3244296"><a href="/gostd/net/dnsmsg.go.html#3243976">rr</a></span><span class="op" id="3244298">,</span>&nbsp;<span class="ident" id="3244300"><a href="/gostd/net/dnsmsg.go.html#3243986">msg</a></span><span class="op" id="3244303">,</span>&nbsp;<span class="ident" id="3244305"><a href="/gostd/net/dnsmsg.go.html#3243998">off</a></span><span class="op" id="3244308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3244311">if</span>&nbsp;<span class="op" id="3244314">!</span><span class="ident" id="3244315"><a href="/gostd/net/dnsmsg.go.html#3244018">ok</a></span>&nbsp;<span class="op" id="3244318">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3244322">return</span>&nbsp;<span class="builtinfunc" id="3244329">len</span><span class="op" id="3244332">(</span><span class="ident" id="3244333"><a href="/gostd/net/dnsmsg.go.html#3243986">msg</a></span><span class="op" id="3244336">)</span><span class="op" id="3244337">,</span>&nbsp;<span class="builtintype" id="3244339">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3244346">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3244349">//&nbsp;pack&nbsp;a&nbsp;third&nbsp;time;&nbsp;redo&nbsp;header&nbsp;with&nbsp;correct&nbsp;data&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3244409"><a href="/gostd/net/dnsmsg.go.html#3243976">rr</a></span><span class="op" id="3244411">.</span><span class="ident" id="3244412"><a href="/gostd/net/dnsmsg.go.html#3231814">Header</a></span><span class="op" id="3244418">(</span><span class="op" id="3244419">)</span><span class="op" id="3244420">.</span><span class="ident" id="3244421"><a href="/gostd/net/dnsmsg.go.html#3231423">Rdlength</a></span>&nbsp;<span class="op" id="3244430">=</span>&nbsp;<span class="builtintype" id="3244432">uint16</span><span class="op" id="3244438">(</span><span class="ident" id="3244439"><a href="/gostd/net/dnsmsg.go.html#3244008">off2</a></span>&nbsp;<span class="op" id="3244444">-</span>&nbsp;<span class="ident" id="3244446"><a href="/gostd/net/dnsmsg.go.html#3244034">off1</a></span><span class="op" id="3244450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3244453"><a href="/gostd/net/dnsmsg.go.html#3240367">packStruct</a></span><span class="op" id="3244463">(</span><span class="ident" id="3244464"><a href="/gostd/net/dnsmsg.go.html#3243976">rr</a></span><span class="op" id="3244466">.</span><span class="ident" id="3244467"><a href="/gostd/net/dnsmsg.go.html#3231814">Header</a></span><span class="op" id="3244473">(</span><span class="op" id="3244474">)</span><span class="op" id="3244475">,</span>&nbsp;<span class="ident" id="3244477"><a href="/gostd/net/dnsmsg.go.html#3243986">msg</a></span><span class="op" id="3244480">,</span>&nbsp;<span class="ident" id="3244482"><a href="/gostd/net/dnsmsg.go.html#3243998">off</a></span><span class="op" id="3244485">)</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3244488">return</span>&nbsp;<span class="ident" id="3244495"><a href="/gostd/net/dnsmsg.go.html#3244008">off2</a></span><span class="op" id="3244499">,</span>&nbsp;<span class="builtintype" id="3244501">true</span><br>
<span class="lineno"></span><span class="op" id="3244506">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3244509">//&nbsp;Resource&nbsp;record&nbsp;unpacker.</span><br>
<span class="lineno"></span><span class="keyword" id="3244538">func</span>&nbsp;<span class="ident" id="3244543">unpackRR</span><span class="op" id="3244551">(</span><span class="ident" id="3244552">msg</span>&nbsp;<span class="op" id="3244556">[</span><span class="op" id="3244557">]</span><span class="builtintype" id="3244558">byte</span><span class="op" id="3244562">,</span>&nbsp;<span class="ident" id="3244564">off</span>&nbsp;<span class="builtintype" id="3244568">int</span><span class="op" id="3244571">)</span>&nbsp;<span class="op" id="3244573">(</span><span class="ident" id="3244574">rr</span>&nbsp;<span class="ident" id="3244577"><a href="/gostd/net/dnsmsg.go.html#3231784">dnsRR</a></span><span class="op" id="3244582">,</span>&nbsp;<span class="ident" id="3244584">off1</span>&nbsp;<span class="builtintype" id="3244589">int</span><span class="op" id="3244592">,</span>&nbsp;<span class="ident" id="3244594">ok</span>&nbsp;<span class="builtintype" id="3244597">bool</span><span class="op" id="3244601">)</span>&nbsp;<span class="op" id="3244603">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3244606">//&nbsp;unpack&nbsp;just&nbsp;the&nbsp;header,&nbsp;to&nbsp;find&nbsp;the&nbsp;rr&nbsp;type&nbsp;and&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3244665">var</span>&nbsp;<span class="ident" id="3244669">h</span>&nbsp;<span class="ident" id="3244671"><a href="/gostd/net/dnsmsg.go.html#3231312">dnsRR_Header</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3244685">off0</span>&nbsp;<span class="op" id="3244690">:=</span>&nbsp;<span class="ident" id="3244693"><a href="/gostd/net/dnsmsg.go.html#3244564">off</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3244698">if</span>&nbsp;<span class="ident" id="3244701"><a href="/gostd/net/dnsmsg.go.html#3244564">off</a></span><span class="op" id="3244704">,</span>&nbsp;<span class="ident" id="3244706"><a href="/gostd/net/dnsmsg.go.html#3244594">ok</a></span>&nbsp;<span class="op" id="3244709">=</span>&nbsp;<span class="ident" id="3244711"><a href="/gostd/net/dnsmsg.go.html#3241636">unpackStruct</a></span><span class="op" id="3244723">(</span><span class="op" id="3244724">&amp;</span><span class="ident" id="3244725"><a href="/gostd/net/dnsmsg.go.html#3244669">h</a></span><span class="op" id="3244726">,</span>&nbsp;<span class="ident" id="3244728"><a href="/gostd/net/dnsmsg.go.html#3244552">msg</a></span><span class="op" id="3244731">,</span>&nbsp;<span class="ident" id="3244733"><a href="/gostd/net/dnsmsg.go.html#3244564">off</a></span><span class="op" id="3244736">)</span><span class="op" id="3244737">;</span>&nbsp;<span class="op" id="3244739">!</span><span class="ident" id="3244740"><a href="/gostd/net/dnsmsg.go.html#3244594">ok</a></span>&nbsp;<span class="op" id="3244743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3244747">return</span>&nbsp;<span class="builtintype" id="3244754">nil</span><span class="op" id="3244757">,</span>&nbsp;<span class="builtinfunc" id="3244759">len</span><span class="op" id="3244762">(</span><span class="ident" id="3244763"><a href="/gostd/net/dnsmsg.go.html#3244552">msg</a></span><span class="op" id="3244766">)</span><span class="op" id="3244767">,</span>&nbsp;<span class="builtintype" id="3244769">false</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3244776">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3244779">end</span>&nbsp;<span class="op" id="3244783">:=</span>&nbsp;<span class="ident" id="3244786"><a href="/gostd/net/dnsmsg.go.html#3244564">off</a></span>&nbsp;<span class="op" id="3244790">+</span>&nbsp;<span class="builtintype" id="3244792">int</span><span class="op" id="3244795">(</span><span class="ident" id="3244796"><a href="/gostd/net/dnsmsg.go.html#3244669">h</a></span><span class="op" id="3244797">.</span><span class="ident" id="3244798"><a href="/gostd/net/dnsmsg.go.html#3231423">Rdlength</a></span><span class="op" id="3244806">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3244810">//&nbsp;make&nbsp;an&nbsp;rr&nbsp;of&nbsp;that&nbsp;type&nbsp;and&nbsp;re-unpack.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3244853">//&nbsp;again&nbsp;inefficient&nbsp;but&nbsp;doesn&#39;t&nbsp;need&nbsp;to&nbsp;be&nbsp;fast.</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3244904">mk</span><span class="op" id="3244906">,</span>&nbsp;<span class="ident" id="3244908">known</span>&nbsp;<span class="op" id="3244914">:=</span>&nbsp;<span class="ident" id="3244917"><a href="/gostd/net/dnsmsg.go.html#3236736">rr_mk</a></span><span class="op" id="3244922">[</span><span class="builtintype" id="3244923">int</span><span class="op" id="3244926">(</span><span class="ident" id="3244927"><a href="/gostd/net/dnsmsg.go.html#3244669">h</a></span><span class="op" id="3244928">.</span><span class="ident" id="3244929"><a href="/gostd/net/dnsmsg.go.html#3231372">Rrtype</a></span><span class="op" id="3244935">)</span><span class="op" id="3244936">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3244939">if</span>&nbsp;<span class="op" id="3244942">!</span><span class="ident" id="3244943"><a href="/gostd/net/dnsmsg.go.html#3244908">known</a></span>&nbsp;<span class="op" id="3244949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3244953">return</span>&nbsp;<span class="op" id="3244960">&amp;</span><span class="ident" id="3244961"><a href="/gostd/net/dnsmsg.go.html#3244669">h</a></span><span class="op" id="3244962">,</span>&nbsp;<span class="ident" id="3244964"><a href="/gostd/net/dnsmsg.go.html#3244779">end</a></span><span class="op" id="3244967">,</span>&nbsp;<span class="builtintype" id="3244969">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3244975">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3244978"><a href="/gostd/net/dnsmsg.go.html#3244574">rr</a></span>&nbsp;<span class="op" id="3244981">=</span>&nbsp;<span class="ident" id="3244983"><a href="/gostd/net/dnsmsg.go.html#3244904">mk</a></span><span class="op" id="3244985">(</span><span class="op" id="3244986">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3244989"><a href="/gostd/net/dnsmsg.go.html#3244564">off</a></span><span class="op" id="3244992">,</span>&nbsp;<span class="ident" id="3244994"><a href="/gostd/net/dnsmsg.go.html#3244594">ok</a></span>&nbsp;<span class="op" id="3244997">=</span>&nbsp;<span class="ident" id="3244999"><a href="/gostd/net/dnsmsg.go.html#3241636">unpackStruct</a></span><span class="op" id="3245011">(</span><span class="ident" id="3245012"><a href="/gostd/net/dnsmsg.go.html#3244574">rr</a></span><span class="op" id="3245014">,</span>&nbsp;<span class="ident" id="3245016"><a href="/gostd/net/dnsmsg.go.html#3244552">msg</a></span><span class="op" id="3245019">,</span>&nbsp;<span class="ident" id="3245021"><a href="/gostd/net/dnsmsg.go.html#3244685">off0</a></span><span class="op" id="3245025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3245028">if</span>&nbsp;<span class="ident" id="3245031"><a href="/gostd/net/dnsmsg.go.html#3244564">off</a></span>&nbsp;<span class="op" id="3245035">!=</span>&nbsp;<span class="ident" id="3245038"><a href="/gostd/net/dnsmsg.go.html#3244779">end</a></span>&nbsp;<span class="op" id="3245042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3245046">return</span>&nbsp;<span class="op" id="3245053">&amp;</span><span class="ident" id="3245054"><a href="/gostd/net/dnsmsg.go.html#3244669">h</a></span><span class="op" id="3245055">,</span>&nbsp;<span class="ident" id="3245057"><a href="/gostd/net/dnsmsg.go.html#3244779">end</a></span><span class="op" id="3245060">,</span>&nbsp;<span class="builtintype" id="3245062">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3245068">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3245071">return</span>&nbsp;<span class="ident" id="3245078"><a href="/gostd/net/dnsmsg.go.html#3244574">rr</a></span><span class="op" id="3245080">,</span>&nbsp;<span class="ident" id="3245082"><a href="/gostd/net/dnsmsg.go.html#3244564">off</a></span><span class="op" id="3245085">,</span>&nbsp;<span class="ident" id="3245087"><a href="/gostd/net/dnsmsg.go.html#3244594">ok</a></span><br>
<span class="lineno">710</span><span class="op" id="3245090">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3245093">//&nbsp;Usable&nbsp;representation&nbsp;of&nbsp;a&nbsp;DNS&nbsp;packet.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3245136">//&nbsp;A&nbsp;manually-unpacked&nbsp;version&nbsp;of&nbsp;(id,&nbsp;bits).</span><br>
<span class="lineno">715</span><span class="comment" id="3245182">//&nbsp;This&nbsp;is&nbsp;in&nbsp;its&nbsp;own&nbsp;struct&nbsp;for&nbsp;easy&nbsp;printing.</span><br>
<span class="lineno"></span><span class="keyword" id="3245230">type</span>&nbsp;<span class="ident" id="3245235">dnsMsgHdr</span>&nbsp;<span class="keyword" id="3245245">struct</span>&nbsp;<span class="op" id="3245252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3245255">id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3245275">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3245283">response</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3245303">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3245309">opcode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3245329">int</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3245334">authoritative</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3245354">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3245360">truncated</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3245380">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3245386">recursion_desired</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3245406">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3245412">recursion_available</span>&nbsp;<span class="builtintype" id="3245432">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3245438">rcode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3245458">int</span><br>
<span class="lineno">725</span><span class="op" id="3245462">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3245465">func</span>&nbsp;<span class="op" id="3245470">(</span><span class="ident" id="3245471">h</span>&nbsp;<span class="op" id="3245473">*</span><span class="ident" id="3245474"><a href="/gostd/net/dnsmsg.go.html#3245235">dnsMsgHdr</a></span><span class="op" id="3245483">)</span>&nbsp;<span class="ident" id="3245485">Walk</span><span class="op" id="3245489">(</span><span class="ident" id="3245490">f</span>&nbsp;<span class="keyword" id="3245492">func</span><span class="op" id="3245496">(</span><span class="ident" id="3245497">v</span>&nbsp;<span class="keyword" id="3245499">interface</span><span class="op" id="3245508">{</span><span class="op" id="3245509">}</span><span class="op" id="3245510">,</span>&nbsp;<span class="ident" id="3245512">name</span><span class="op" id="3245516">,</span>&nbsp;<span class="ident" id="3245518">tag</span>&nbsp;<span class="builtintype" id="3245522">string</span><span class="op" id="3245528">)</span>&nbsp;<span class="builtintype" id="3245530">bool</span><span class="op" id="3245534">)</span>&nbsp;<span class="builtintype" id="3245536">bool</span>&nbsp;<span class="op" id="3245541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3245544">return</span>&nbsp;<span class="ident" id="3245551"><a href="/gostd/net/dnsmsg.go.html#3245490">f</a></span><span class="op" id="3245552">(</span><span class="op" id="3245553">&amp;</span><span class="ident" id="3245554"><a href="/gostd/net/dnsmsg.go.html#3245471">h</a></span><span class="op" id="3245555">.</span><span class="ident" id="3245556"><a href="/gostd/net/dnsmsg.go.html#3245255">id</a></span><span class="op" id="3245558">,</span>&nbsp;<span class="string" id="3245560">&#34;id&#34;</span><span class="op" id="3245564">,</span>&nbsp;<span class="string" id="3245566">&#34;&#34;</span><span class="op" id="3245568">)</span>&nbsp;<span class="op" id="3245570">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3245575"><a href="/gostd/net/dnsmsg.go.html#3245490">f</a></span><span class="op" id="3245576">(</span><span class="op" id="3245577">&amp;</span><span class="ident" id="3245578"><a href="/gostd/net/dnsmsg.go.html#3245471">h</a></span><span class="op" id="3245579">.</span><span class="ident" id="3245580"><a href="/gostd/net/dnsmsg.go.html#3245283">response</a></span><span class="op" id="3245588">,</span>&nbsp;<span class="string" id="3245590">&#34;response&#34;</span><span class="op" id="3245600">,</span>&nbsp;<span class="string" id="3245602">&#34;&#34;</span><span class="op" id="3245604">)</span>&nbsp;<span class="op" id="3245606">&amp;&amp;</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3245611"><a href="/gostd/net/dnsmsg.go.html#3245490">f</a></span><span class="op" id="3245612">(</span><span class="op" id="3245613">&amp;</span><span class="ident" id="3245614"><a href="/gostd/net/dnsmsg.go.html#3245471">h</a></span><span class="op" id="3245615">.</span><span class="ident" id="3245616"><a href="/gostd/net/dnsmsg.go.html#3245309">opcode</a></span><span class="op" id="3245622">,</span>&nbsp;<span class="string" id="3245624">&#34;opcode&#34;</span><span class="op" id="3245632">,</span>&nbsp;<span class="string" id="3245634">&#34;&#34;</span><span class="op" id="3245636">)</span>&nbsp;<span class="op" id="3245638">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3245643"><a href="/gostd/net/dnsmsg.go.html#3245490">f</a></span><span class="op" id="3245644">(</span><span class="op" id="3245645">&amp;</span><span class="ident" id="3245646"><a href="/gostd/net/dnsmsg.go.html#3245471">h</a></span><span class="op" id="3245647">.</span><span class="ident" id="3245648"><a href="/gostd/net/dnsmsg.go.html#3245334">authoritative</a></span><span class="op" id="3245661">,</span>&nbsp;<span class="string" id="3245663">&#34;authoritative&#34;</span><span class="op" id="3245678">,</span>&nbsp;<span class="string" id="3245680">&#34;&#34;</span><span class="op" id="3245682">)</span>&nbsp;<span class="op" id="3245684">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3245689"><a href="/gostd/net/dnsmsg.go.html#3245490">f</a></span><span class="op" id="3245690">(</span><span class="op" id="3245691">&amp;</span><span class="ident" id="3245692"><a href="/gostd/net/dnsmsg.go.html#3245471">h</a></span><span class="op" id="3245693">.</span><span class="ident" id="3245694"><a href="/gostd/net/dnsmsg.go.html#3245360">truncated</a></span><span class="op" id="3245703">,</span>&nbsp;<span class="string" id="3245705">&#34;truncated&#34;</span><span class="op" id="3245716">,</span>&nbsp;<span class="string" id="3245718">&#34;&#34;</span><span class="op" id="3245720">)</span>&nbsp;<span class="op" id="3245722">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3245727"><a href="/gostd/net/dnsmsg.go.html#3245490">f</a></span><span class="op" id="3245728">(</span><span class="op" id="3245729">&amp;</span><span class="ident" id="3245730"><a href="/gostd/net/dnsmsg.go.html#3245471">h</a></span><span class="op" id="3245731">.</span><span class="ident" id="3245732"><a href="/gostd/net/dnsmsg.go.html#3245386">recursion_desired</a></span><span class="op" id="3245749">,</span>&nbsp;<span class="string" id="3245751">&#34;recursion_desired&#34;</span><span class="op" id="3245770">,</span>&nbsp;<span class="string" id="3245772">&#34;&#34;</span><span class="op" id="3245774">)</span>&nbsp;<span class="op" id="3245776">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3245781"><a href="/gostd/net/dnsmsg.go.html#3245490">f</a></span><span class="op" id="3245782">(</span><span class="op" id="3245783">&amp;</span><span class="ident" id="3245784"><a href="/gostd/net/dnsmsg.go.html#3245471">h</a></span><span class="op" id="3245785">.</span><span class="ident" id="3245786"><a href="/gostd/net/dnsmsg.go.html#3245412">recursion_available</a></span><span class="op" id="3245805">,</span>&nbsp;<span class="string" id="3245807">&#34;recursion_available&#34;</span><span class="op" id="3245828">,</span>&nbsp;<span class="string" id="3245830">&#34;&#34;</span><span class="op" id="3245832">)</span>&nbsp;<span class="op" id="3245834">&amp;&amp;</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3245839"><a href="/gostd/net/dnsmsg.go.html#3245490">f</a></span><span class="op" id="3245840">(</span><span class="op" id="3245841">&amp;</span><span class="ident" id="3245842"><a href="/gostd/net/dnsmsg.go.html#3245471">h</a></span><span class="op" id="3245843">.</span><span class="ident" id="3245844"><a href="/gostd/net/dnsmsg.go.html#3245438">rcode</a></span><span class="op" id="3245849">,</span>&nbsp;<span class="string" id="3245851">&#34;rcode&#34;</span><span class="op" id="3245858">,</span>&nbsp;<span class="string" id="3245860">&#34;&#34;</span><span class="op" id="3245862">)</span><br>
<span class="lineno"></span><span class="op" id="3245864">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3245867">type</span>&nbsp;<span class="ident" id="3245872">dnsMsg</span>&nbsp;<span class="keyword" id="3245879">struct</span>&nbsp;<span class="op" id="3245886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3245889"><a href="/gostd/net/dnsmsg.go.html#3245235">dnsMsgHdr</a></span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3245900">question</span>&nbsp;<span class="op" id="3245909">[</span><span class="op" id="3245910">]</span><span class="ident" id="3245911"><a href="/gostd/net/dnsmsg.go.html#3230862">dnsQuestion</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3245924">answer</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3245933">[</span><span class="op" id="3245934">]</span><span class="ident" id="3245935"><a href="/gostd/net/dnsmsg.go.html#3231784">dnsRR</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3245942">ns</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3245951">[</span><span class="op" id="3245952">]</span><span class="ident" id="3245953"><a href="/gostd/net/dnsmsg.go.html#3231784">dnsRR</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3245960">extra</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3245969">[</span><span class="op" id="3245970">]</span><span class="ident" id="3245971"><a href="/gostd/net/dnsmsg.go.html#3231784">dnsRR</a></span><br>
<span class="lineno"></span><span class="op" id="3245977">}</span><br>
<span class="lineno">745</span><br>
<span class="lineno"></span><span class="keyword" id="3245980">func</span>&nbsp;<span class="op" id="3245985">(</span><span class="ident" id="3245986">dns</span>&nbsp;<span class="op" id="3245990">*</span><span class="ident" id="3245991"><a href="/gostd/net/dnsmsg.go.html#3245872">dnsMsg</a></span><span class="op" id="3245997">)</span>&nbsp;<span class="ident" id="3245999">Pack</span><span class="op" id="3246003">(</span><span class="op" id="3246004">)</span>&nbsp;<span class="op" id="3246006">(</span><span class="ident" id="3246007">msg</span>&nbsp;<span class="op" id="3246011">[</span><span class="op" id="3246012">]</span><span class="builtintype" id="3246013">byte</span><span class="op" id="3246017">,</span>&nbsp;<span class="ident" id="3246019">ok</span>&nbsp;<span class="builtintype" id="3246022">bool</span><span class="op" id="3246026">)</span>&nbsp;<span class="op" id="3246028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3246031">var</span>&nbsp;<span class="ident" id="3246035">dh</span>&nbsp;<span class="ident" id="3246038"><a href="/gostd/net/dnsmsg.go.html#3230208">dnsHeader</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3246050">//&nbsp;Convert&nbsp;convenient&nbsp;dnsMsg&nbsp;into&nbsp;wire-like&nbsp;dnsHeader.</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3246106"><a href="/gostd/net/dnsmsg.go.html#3246035">dh</a></span><span class="op" id="3246108">.</span><span class="ident" id="3246109"><a href="/gostd/net/dnsmsg.go.html#3230228">Id</a></span>&nbsp;<span class="op" id="3246112">=</span>&nbsp;<span class="ident" id="3246114"><a href="/gostd/net/dnsmsg.go.html#3245986">dns</a></span><span class="op" id="3246117">.</span><span class="ident" id="3246118"><a href="/gostd/net/dnsmsg.go.html#3245255">id</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3246122"><a href="/gostd/net/dnsmsg.go.html#3246035">dh</a></span><span class="op" id="3246124">.</span><span class="ident" id="3246125"><a href="/gostd/net/dnsmsg.go.html#3230271">Bits</a></span>&nbsp;<span class="op" id="3246130">=</span>&nbsp;<span class="builtintype" id="3246132">uint16</span><span class="op" id="3246138">(</span><span class="ident" id="3246139"><a href="/gostd/net/dnsmsg.go.html#3245986">dns</a></span><span class="op" id="3246142">.</span><span class="ident" id="3246143"><a href="/gostd/net/dnsmsg.go.html#3245309">opcode</a></span><span class="op" id="3246149">)</span><span class="op" id="3246150">&lt;&lt;</span><span class="num" id="3246152">11</span>&nbsp;<span class="op" id="3246155">|</span>&nbsp;<span class="builtintype" id="3246157">uint16</span><span class="op" id="3246163">(</span><span class="ident" id="3246164"><a href="/gostd/net/dnsmsg.go.html#3245986">dns</a></span><span class="op" id="3246167">.</span><span class="ident" id="3246168"><a href="/gostd/net/dnsmsg.go.html#3245438">rcode</a></span><span class="op" id="3246173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3246176">if</span>&nbsp;<span class="ident" id="3246179"><a href="/gostd/net/dnsmsg.go.html#3245986">dns</a></span><span class="op" id="3246182">.</span><span class="ident" id="3246183"><a href="/gostd/net/dnsmsg.go.html#3245412">recursion_available</a></span>&nbsp;<span class="op" id="3246203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3246207"><a href="/gostd/net/dnsmsg.go.html#3246035">dh</a></span><span class="op" id="3246209">.</span><span class="ident" id="3246210"><a href="/gostd/net/dnsmsg.go.html#3230271">Bits</a></span>&nbsp;<span class="op" id="3246215">|=</span>&nbsp;<span class="ident" id="3246218"><a href="/gostd/net/dnsmsg.go.html#3230801">_RA</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3246223">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3246226">if</span>&nbsp;<span class="ident" id="3246229"><a href="/gostd/net/dnsmsg.go.html#3245986">dns</a></span><span class="op" id="3246232">.</span><span class="ident" id="3246233"><a href="/gostd/net/dnsmsg.go.html#3245386">recursion_desired</a></span>&nbsp;<span class="op" id="3246251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3246255"><a href="/gostd/net/dnsmsg.go.html#3246035">dh</a></span><span class="op" id="3246257">.</span><span class="ident" id="3246258"><a href="/gostd/net/dnsmsg.go.html#3230271">Bits</a></span>&nbsp;<span class="op" id="3246263">|=</span>&nbsp;<span class="ident" id="3246266"><a href="/gostd/net/dnsmsg.go.html#3230765">_RD</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3246271">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3246274">if</span>&nbsp;<span class="ident" id="3246277"><a href="/gostd/net/dnsmsg.go.html#3245986">dns</a></span><span class="op" id="3246280">.</span><span class="ident" id="3246281"><a href="/gostd/net/dnsmsg.go.html#3245360">truncated</a></span>&nbsp;<span class="op" id="3246291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3246295"><a href="/gostd/net/dnsmsg.go.html#3246035">dh</a></span><span class="op" id="3246297">.</span><span class="ident" id="3246298"><a href="/gostd/net/dnsmsg.go.html#3230271">Bits</a></span>&nbsp;<span class="op" id="3246303">|=</span>&nbsp;<span class="ident" id="3246306"><a href="/gostd/net/dnsmsg.go.html#3230737">_TC</a></span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3246311">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3246314">if</span>&nbsp;<span class="ident" id="3246317"><a href="/gostd/net/dnsmsg.go.html#3245986">dns</a></span><span class="op" id="3246320">.</span><span class="ident" id="3246321"><a href="/gostd/net/dnsmsg.go.html#3245334">authoritative</a></span>&nbsp;<span class="op" id="3246335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3246339"><a href="/gostd/net/dnsmsg.go.html#3246035">dh</a></span><span class="op" id="3246341">.</span><span class="ident" id="3246342"><a href="/gostd/net/dnsmsg.go.html#3230271">Bits</a></span>&nbsp;<span class="op" id="3246347">|=</span>&nbsp;<span class="ident" id="3246350"><a href="/gostd/net/dnsmsg.go.html#3230705">_AA</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3246355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3246358">if</span>&nbsp;<span class="ident" id="3246361"><a href="/gostd/net/dnsmsg.go.html#3245986">dns</a></span><span class="op" id="3246364">.</span><span class="ident" id="3246365"><a href="/gostd/net/dnsmsg.go.html#3245283">response</a></span>&nbsp;<span class="op" id="3246374">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3246378"><a href="/gostd/net/dnsmsg.go.html#3246035">dh</a></span><span class="op" id="3246380">.</span><span class="ident" id="3246381"><a href="/gostd/net/dnsmsg.go.html#3230271">Bits</a></span>&nbsp;<span class="op" id="3246386">|=</span>&nbsp;<span class="ident" id="3246389"><a href="/gostd/net/dnsmsg.go.html#3230659">_QR</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3246394">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3246398">//&nbsp;Prepare&nbsp;variable&nbsp;sized&nbsp;arrays.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3246433">question</span>&nbsp;<span class="op" id="3246442">:=</span>&nbsp;<span class="ident" id="3246445"><a href="/gostd/net/dnsmsg.go.html#3245986">dns</a></span><span class="op" id="3246448">.</span><span class="ident" id="3246449"><a href="/gostd/net/dnsmsg.go.html#3245900">question</a></span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3246459">answer</span>&nbsp;<span class="op" id="3246466">:=</span>&nbsp;<span class="ident" id="3246469"><a href="/gostd/net/dnsmsg.go.html#3245986">dns</a></span><span class="op" id="3246472">.</span><span class="ident" id="3246473"><a href="/gostd/net/dnsmsg.go.html#3245924">answer</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3246481">ns</span>&nbsp;<span class="op" id="3246484">:=</span>&nbsp;<span class="ident" id="3246487"><a href="/gostd/net/dnsmsg.go.html#3245986">dns</a></span><span class="op" id="3246490">.</span><span class="ident" id="3246491"><a href="/gostd/net/dnsmsg.go.html#3245942">ns</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3246495">extra</span>&nbsp;<span class="op" id="3246501">:=</span>&nbsp;<span class="ident" id="3246504"><a href="/gostd/net/dnsmsg.go.html#3245986">dns</a></span><span class="op" id="3246507">.</span><span class="ident" id="3246508"><a href="/gostd/net/dnsmsg.go.html#3245960">extra</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3246516"><a href="/gostd/net/dnsmsg.go.html#3246035">dh</a></span><span class="op" id="3246518">.</span><span class="ident" id="3246519"><a href="/gostd/net/dnsmsg.go.html#3230314">Qdcount</a></span>&nbsp;<span class="op" id="3246527">=</span>&nbsp;<span class="builtintype" id="3246529">uint16</span><span class="op" id="3246535">(</span><span class="builtinfunc" id="3246536">len</span><span class="op" id="3246539">(</span><span class="ident" id="3246540"><a href="/gostd/net/dnsmsg.go.html#3246433">question</a></span><span class="op" id="3246548">)</span><span class="op" id="3246549">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3246552"><a href="/gostd/net/dnsmsg.go.html#3246035">dh</a></span><span class="op" id="3246554">.</span><span class="ident" id="3246555"><a href="/gostd/net/dnsmsg.go.html#3230323">Ancount</a></span>&nbsp;<span class="op" id="3246563">=</span>&nbsp;<span class="builtintype" id="3246565">uint16</span><span class="op" id="3246571">(</span><span class="builtinfunc" id="3246572">len</span><span class="op" id="3246575">(</span><span class="ident" id="3246576"><a href="/gostd/net/dnsmsg.go.html#3246459">answer</a></span><span class="op" id="3246582">)</span><span class="op" id="3246583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3246586"><a href="/gostd/net/dnsmsg.go.html#3246035">dh</a></span><span class="op" id="3246588">.</span><span class="ident" id="3246589"><a href="/gostd/net/dnsmsg.go.html#3230332">Nscount</a></span>&nbsp;<span class="op" id="3246597">=</span>&nbsp;<span class="builtintype" id="3246599">uint16</span><span class="op" id="3246605">(</span><span class="builtinfunc" id="3246606">len</span><span class="op" id="3246609">(</span><span class="ident" id="3246610"><a href="/gostd/net/dnsmsg.go.html#3246481">ns</a></span><span class="op" id="3246612">)</span><span class="op" id="3246613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3246616"><a href="/gostd/net/dnsmsg.go.html#3246035">dh</a></span><span class="op" id="3246618">.</span><span class="ident" id="3246619"><a href="/gostd/net/dnsmsg.go.html#3230341">Arcount</a></span>&nbsp;<span class="op" id="3246627">=</span>&nbsp;<span class="builtintype" id="3246629">uint16</span><span class="op" id="3246635">(</span><span class="builtinfunc" id="3246636">len</span><span class="op" id="3246639">(</span><span class="ident" id="3246640"><a href="/gostd/net/dnsmsg.go.html#3246495">extra</a></span><span class="op" id="3246645">)</span><span class="op" id="3246646">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3246650">//&nbsp;Could&nbsp;work&nbsp;harder&nbsp;to&nbsp;calculate&nbsp;message&nbsp;size,</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3246699">//&nbsp;but&nbsp;this&nbsp;is&nbsp;far&nbsp;more&nbsp;than&nbsp;we&nbsp;need&nbsp;and&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3246745">//&nbsp;big&nbsp;enough&nbsp;to&nbsp;hurt&nbsp;the&nbsp;allocator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3246783"><a href="/gostd/net/dnsmsg.go.html#3246007">msg</a></span>&nbsp;<span class="op" id="3246787">=</span>&nbsp;<span class="builtinfunc" id="3246789">make</span><span class="op" id="3246793">(</span><span class="op" id="3246794">[</span><span class="op" id="3246795">]</span><span class="builtintype" id="3246796">byte</span><span class="op" id="3246800">,</span>&nbsp;<span class="num" id="3246802">2000</span><span class="op" id="3246806">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3246810">//&nbsp;Pack&nbsp;it&nbsp;in:&nbsp;header&nbsp;and&nbsp;then&nbsp;the&nbsp;pieces.</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3246854">off</span>&nbsp;<span class="op" id="3246858">:=</span>&nbsp;<span class="num" id="3246861">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3246864"><a href="/gostd/net/dnsmsg.go.html#3246854">off</a></span><span class="op" id="3246867">,</span>&nbsp;<span class="ident" id="3246869"><a href="/gostd/net/dnsmsg.go.html#3246019">ok</a></span>&nbsp;<span class="op" id="3246872">=</span>&nbsp;<span class="ident" id="3246874"><a href="/gostd/net/dnsmsg.go.html#3240367">packStruct</a></span><span class="op" id="3246884">(</span><span class="op" id="3246885">&amp;</span><span class="ident" id="3246886"><a href="/gostd/net/dnsmsg.go.html#3246035">dh</a></span><span class="op" id="3246888">,</span>&nbsp;<span class="ident" id="3246890"><a href="/gostd/net/dnsmsg.go.html#3246007">msg</a></span><span class="op" id="3246893">,</span>&nbsp;<span class="ident" id="3246895"><a href="/gostd/net/dnsmsg.go.html#3246854">off</a></span><span class="op" id="3246898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3246901">for</span>&nbsp;<span class="ident" id="3246905">i</span>&nbsp;<span class="op" id="3246907">:=</span>&nbsp;<span class="num" id="3246910">0</span><span class="op" id="3246911">;</span>&nbsp;<span class="ident" id="3246913"><a href="/gostd/net/dnsmsg.go.html#3246905">i</a></span>&nbsp;<span class="op" id="3246915">&lt;</span>&nbsp;<span class="builtinfunc" id="3246917">len</span><span class="op" id="3246920">(</span><span class="ident" id="3246921"><a href="/gostd/net/dnsmsg.go.html#3246433">question</a></span><span class="op" id="3246929">)</span><span class="op" id="3246930">;</span>&nbsp;<span class="ident" id="3246932"><a href="/gostd/net/dnsmsg.go.html#3246905">i</a></span><span class="op" id="3246933">++</span>&nbsp;<span class="op" id="3246936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3246940"><a href="/gostd/net/dnsmsg.go.html#3246854">off</a></span><span class="op" id="3246943">,</span>&nbsp;<span class="ident" id="3246945"><a href="/gostd/net/dnsmsg.go.html#3246019">ok</a></span>&nbsp;<span class="op" id="3246948">=</span>&nbsp;<span class="ident" id="3246950"><a href="/gostd/net/dnsmsg.go.html#3240367">packStruct</a></span><span class="op" id="3246960">(</span><span class="op" id="3246961">&amp;</span><span class="ident" id="3246962"><a href="/gostd/net/dnsmsg.go.html#3246433">question</a></span><span class="op" id="3246970">[</span><span class="ident" id="3246971"><a href="/gostd/net/dnsmsg.go.html#3246905">i</a></span><span class="op" id="3246972">]</span><span class="op" id="3246973">,</span>&nbsp;<span class="ident" id="3246975"><a href="/gostd/net/dnsmsg.go.html#3246007">msg</a></span><span class="op" id="3246978">,</span>&nbsp;<span class="ident" id="3246980"><a href="/gostd/net/dnsmsg.go.html#3246854">off</a></span><span class="op" id="3246983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3246986">}</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3246989">for</span>&nbsp;<span class="ident" id="3246993">i</span>&nbsp;<span class="op" id="3246995">:=</span>&nbsp;<span class="num" id="3246998">0</span><span class="op" id="3246999">;</span>&nbsp;<span class="ident" id="3247001"><a href="/gostd/net/dnsmsg.go.html#3246993">i</a></span>&nbsp;<span class="op" id="3247003">&lt;</span>&nbsp;<span class="builtinfunc" id="3247005">len</span><span class="op" id="3247008">(</span><span class="ident" id="3247009"><a href="/gostd/net/dnsmsg.go.html#3246459">answer</a></span><span class="op" id="3247015">)</span><span class="op" id="3247016">;</span>&nbsp;<span class="ident" id="3247018"><a href="/gostd/net/dnsmsg.go.html#3246993">i</a></span><span class="op" id="3247019">++</span>&nbsp;<span class="op" id="3247022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3247026"><a href="/gostd/net/dnsmsg.go.html#3246854">off</a></span><span class="op" id="3247029">,</span>&nbsp;<span class="ident" id="3247031"><a href="/gostd/net/dnsmsg.go.html#3246019">ok</a></span>&nbsp;<span class="op" id="3247034">=</span>&nbsp;<span class="ident" id="3247036"><a href="/gostd/net/dnsmsg.go.html#3243969">packRR</a></span><span class="op" id="3247042">(</span><span class="ident" id="3247043"><a href="/gostd/net/dnsmsg.go.html#3246459">answer</a></span><span class="op" id="3247049">[</span><span class="ident" id="3247050"><a href="/gostd/net/dnsmsg.go.html#3246993">i</a></span><span class="op" id="3247051">]</span><span class="op" id="3247052">,</span>&nbsp;<span class="ident" id="3247054"><a href="/gostd/net/dnsmsg.go.html#3246007">msg</a></span><span class="op" id="3247057">,</span>&nbsp;<span class="ident" id="3247059"><a href="/gostd/net/dnsmsg.go.html#3246854">off</a></span><span class="op" id="3247062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3247065">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3247068">for</span>&nbsp;<span class="ident" id="3247072">i</span>&nbsp;<span class="op" id="3247074">:=</span>&nbsp;<span class="num" id="3247077">0</span><span class="op" id="3247078">;</span>&nbsp;<span class="ident" id="3247080"><a href="/gostd/net/dnsmsg.go.html#3247072">i</a></span>&nbsp;<span class="op" id="3247082">&lt;</span>&nbsp;<span class="builtinfunc" id="3247084">len</span><span class="op" id="3247087">(</span><span class="ident" id="3247088"><a href="/gostd/net/dnsmsg.go.html#3246481">ns</a></span><span class="op" id="3247090">)</span><span class="op" id="3247091">;</span>&nbsp;<span class="ident" id="3247093"><a href="/gostd/net/dnsmsg.go.html#3247072">i</a></span><span class="op" id="3247094">++</span>&nbsp;<span class="op" id="3247097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3247101"><a href="/gostd/net/dnsmsg.go.html#3246854">off</a></span><span class="op" id="3247104">,</span>&nbsp;<span class="ident" id="3247106"><a href="/gostd/net/dnsmsg.go.html#3246019">ok</a></span>&nbsp;<span class="op" id="3247109">=</span>&nbsp;<span class="ident" id="3247111"><a href="/gostd/net/dnsmsg.go.html#3243969">packRR</a></span><span class="op" id="3247117">(</span><span class="ident" id="3247118"><a href="/gostd/net/dnsmsg.go.html#3246481">ns</a></span><span class="op" id="3247120">[</span><span class="ident" id="3247121"><a href="/gostd/net/dnsmsg.go.html#3247072">i</a></span><span class="op" id="3247122">]</span><span class="op" id="3247123">,</span>&nbsp;<span class="ident" id="3247125"><a href="/gostd/net/dnsmsg.go.html#3246007">msg</a></span><span class="op" id="3247128">,</span>&nbsp;<span class="ident" id="3247130"><a href="/gostd/net/dnsmsg.go.html#3246854">off</a></span><span class="op" id="3247133">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3247136">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3247139">for</span>&nbsp;<span class="ident" id="3247143">i</span>&nbsp;<span class="op" id="3247145">:=</span>&nbsp;<span class="num" id="3247148">0</span><span class="op" id="3247149">;</span>&nbsp;<span class="ident" id="3247151"><a href="/gostd/net/dnsmsg.go.html#3247143">i</a></span>&nbsp;<span class="op" id="3247153">&lt;</span>&nbsp;<span class="builtinfunc" id="3247155">len</span><span class="op" id="3247158">(</span><span class="ident" id="3247159"><a href="/gostd/net/dnsmsg.go.html#3246495">extra</a></span><span class="op" id="3247164">)</span><span class="op" id="3247165">;</span>&nbsp;<span class="ident" id="3247167"><a href="/gostd/net/dnsmsg.go.html#3247143">i</a></span><span class="op" id="3247168">++</span>&nbsp;<span class="op" id="3247171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3247175"><a href="/gostd/net/dnsmsg.go.html#3246854">off</a></span><span class="op" id="3247178">,</span>&nbsp;<span class="ident" id="3247180"><a href="/gostd/net/dnsmsg.go.html#3246019">ok</a></span>&nbsp;<span class="op" id="3247183">=</span>&nbsp;<span class="ident" id="3247185"><a href="/gostd/net/dnsmsg.go.html#3243969">packRR</a></span><span class="op" id="3247191">(</span><span class="ident" id="3247192"><a href="/gostd/net/dnsmsg.go.html#3246495">extra</a></span><span class="op" id="3247197">[</span><span class="ident" id="3247198"><a href="/gostd/net/dnsmsg.go.html#3247143">i</a></span><span class="op" id="3247199">]</span><span class="op" id="3247200">,</span>&nbsp;<span class="ident" id="3247202"><a href="/gostd/net/dnsmsg.go.html#3246007">msg</a></span><span class="op" id="3247205">,</span>&nbsp;<span class="ident" id="3247207"><a href="/gostd/net/dnsmsg.go.html#3246854">off</a></span><span class="op" id="3247210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3247213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3247216">if</span>&nbsp;<span class="op" id="3247219">!</span><span class="ident" id="3247220"><a href="/gostd/net/dnsmsg.go.html#3246019">ok</a></span>&nbsp;<span class="op" id="3247223">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3247227">return</span>&nbsp;<span class="builtintype" id="3247234">nil</span><span class="op" id="3247237">,</span>&nbsp;<span class="builtintype" id="3247239">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3247246">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3247249">return</span>&nbsp;<span class="ident" id="3247256"><a href="/gostd/net/dnsmsg.go.html#3246007">msg</a></span><span class="op" id="3247259">[</span><span class="num" id="3247260">0</span><span class="op" id="3247261">:</span><span class="ident" id="3247262"><a href="/gostd/net/dnsmsg.go.html#3246854">off</a></span><span class="op" id="3247265">]</span><span class="op" id="3247266">,</span>&nbsp;<span class="builtintype" id="3247268">true</span><br>
<span class="lineno"></span><span class="op" id="3247273">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">805</span><span class="keyword" id="3247276">func</span>&nbsp;<span class="op" id="3247281">(</span><span class="ident" id="3247282">dns</span>&nbsp;<span class="op" id="3247286">*</span><span class="ident" id="3247287"><a href="/gostd/net/dnsmsg.go.html#3245872">dnsMsg</a></span><span class="op" id="3247293">)</span>&nbsp;<span class="ident" id="3247295">Unpack</span><span class="op" id="3247301">(</span><span class="ident" id="3247302">msg</span>&nbsp;<span class="op" id="3247306">[</span><span class="op" id="3247307">]</span><span class="builtintype" id="3247308">byte</span><span class="op" id="3247312">)</span>&nbsp;<span class="builtintype" id="3247314">bool</span>&nbsp;<span class="op" id="3247319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3247322">//&nbsp;Header.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3247334">var</span>&nbsp;<span class="ident" id="3247338">dh</span>&nbsp;<span class="ident" id="3247341"><a href="/gostd/net/dnsmsg.go.html#3230208">dnsHeader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3247352">off</span>&nbsp;<span class="op" id="3247356">:=</span>&nbsp;<span class="num" id="3247359">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3247362">var</span>&nbsp;<span class="ident" id="3247366">ok</span>&nbsp;<span class="builtintype" id="3247369">bool</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3247375">if</span>&nbsp;<span class="ident" id="3247378"><a href="/gostd/net/dnsmsg.go.html#3247352">off</a></span><span class="op" id="3247381">,</span>&nbsp;<span class="ident" id="3247383"><a href="/gostd/net/dnsmsg.go.html#3247366">ok</a></span>&nbsp;<span class="op" id="3247386">=</span>&nbsp;<span class="ident" id="3247388"><a href="/gostd/net/dnsmsg.go.html#3241636">unpackStruct</a></span><span class="op" id="3247400">(</span><span class="op" id="3247401">&amp;</span><span class="ident" id="3247402"><a href="/gostd/net/dnsmsg.go.html#3247338">dh</a></span><span class="op" id="3247404">,</span>&nbsp;<span class="ident" id="3247406"><a href="/gostd/net/dnsmsg.go.html#3247302">msg</a></span><span class="op" id="3247409">,</span>&nbsp;<span class="ident" id="3247411"><a href="/gostd/net/dnsmsg.go.html#3247352">off</a></span><span class="op" id="3247414">)</span><span class="op" id="3247415">;</span>&nbsp;<span class="op" id="3247417">!</span><span class="ident" id="3247418"><a href="/gostd/net/dnsmsg.go.html#3247366">ok</a></span>&nbsp;<span class="op" id="3247421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3247425">return</span>&nbsp;<span class="builtintype" id="3247432">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3247439">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3247442"><a href="/gostd/net/dnsmsg.go.html#3247282">dns</a></span><span class="op" id="3247445">.</span><span class="ident" id="3247446"><a href="/gostd/net/dnsmsg.go.html#3245255">id</a></span>&nbsp;<span class="op" id="3247449">=</span>&nbsp;<span class="ident" id="3247451"><a href="/gostd/net/dnsmsg.go.html#3247338">dh</a></span><span class="op" id="3247453">.</span><span class="ident" id="3247454"><a href="/gostd/net/dnsmsg.go.html#3230228">Id</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3247458"><a href="/gostd/net/dnsmsg.go.html#3247282">dns</a></span><span class="op" id="3247461">.</span><span class="ident" id="3247462"><a href="/gostd/net/dnsmsg.go.html#3245283">response</a></span>&nbsp;<span class="op" id="3247471">=</span>&nbsp;<span class="op" id="3247473">(</span><span class="ident" id="3247474"><a href="/gostd/net/dnsmsg.go.html#3247338">dh</a></span><span class="op" id="3247476">.</span><span class="ident" id="3247477"><a href="/gostd/net/dnsmsg.go.html#3230271">Bits</a></span>&nbsp;<span class="op" id="3247482">&amp;</span>&nbsp;<span class="ident" id="3247484"><a href="/gostd/net/dnsmsg.go.html#3230659">_QR</a></span><span class="op" id="3247487">)</span>&nbsp;<span class="op" id="3247489">!=</span>&nbsp;<span class="num" id="3247492">0</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3247495"><a href="/gostd/net/dnsmsg.go.html#3247282">dns</a></span><span class="op" id="3247498">.</span><span class="ident" id="3247499"><a href="/gostd/net/dnsmsg.go.html#3245309">opcode</a></span>&nbsp;<span class="op" id="3247506">=</span>&nbsp;<span class="builtintype" id="3247508">int</span><span class="op" id="3247511">(</span><span class="ident" id="3247512"><a href="/gostd/net/dnsmsg.go.html#3247338">dh</a></span><span class="op" id="3247514">.</span><span class="ident" id="3247515"><a href="/gostd/net/dnsmsg.go.html#3230271">Bits</a></span><span class="op" id="3247519">&gt;&gt;</span><span class="num" id="3247521">11</span><span class="op" id="3247523">)</span>&nbsp;<span class="op" id="3247525">&amp;</span>&nbsp;<span class="num" id="3247527">0xF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3247532"><a href="/gostd/net/dnsmsg.go.html#3247282">dns</a></span><span class="op" id="3247535">.</span><span class="ident" id="3247536"><a href="/gostd/net/dnsmsg.go.html#3245334">authoritative</a></span>&nbsp;<span class="op" id="3247550">=</span>&nbsp;<span class="op" id="3247552">(</span><span class="ident" id="3247553"><a href="/gostd/net/dnsmsg.go.html#3247338">dh</a></span><span class="op" id="3247555">.</span><span class="ident" id="3247556"><a href="/gostd/net/dnsmsg.go.html#3230271">Bits</a></span>&nbsp;<span class="op" id="3247561">&amp;</span>&nbsp;<span class="ident" id="3247563"><a href="/gostd/net/dnsmsg.go.html#3230705">_AA</a></span><span class="op" id="3247566">)</span>&nbsp;<span class="op" id="3247568">!=</span>&nbsp;<span class="num" id="3247571">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3247574"><a href="/gostd/net/dnsmsg.go.html#3247282">dns</a></span><span class="op" id="3247577">.</span><span class="ident" id="3247578"><a href="/gostd/net/dnsmsg.go.html#3245360">truncated</a></span>&nbsp;<span class="op" id="3247588">=</span>&nbsp;<span class="op" id="3247590">(</span><span class="ident" id="3247591"><a href="/gostd/net/dnsmsg.go.html#3247338">dh</a></span><span class="op" id="3247593">.</span><span class="ident" id="3247594"><a href="/gostd/net/dnsmsg.go.html#3230271">Bits</a></span>&nbsp;<span class="op" id="3247599">&amp;</span>&nbsp;<span class="ident" id="3247601"><a href="/gostd/net/dnsmsg.go.html#3230737">_TC</a></span><span class="op" id="3247604">)</span>&nbsp;<span class="op" id="3247606">!=</span>&nbsp;<span class="num" id="3247609">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3247612"><a href="/gostd/net/dnsmsg.go.html#3247282">dns</a></span><span class="op" id="3247615">.</span><span class="ident" id="3247616"><a href="/gostd/net/dnsmsg.go.html#3245386">recursion_desired</a></span>&nbsp;<span class="op" id="3247634">=</span>&nbsp;<span class="op" id="3247636">(</span><span class="ident" id="3247637"><a href="/gostd/net/dnsmsg.go.html#3247338">dh</a></span><span class="op" id="3247639">.</span><span class="ident" id="3247640"><a href="/gostd/net/dnsmsg.go.html#3230271">Bits</a></span>&nbsp;<span class="op" id="3247645">&amp;</span>&nbsp;<span class="ident" id="3247647"><a href="/gostd/net/dnsmsg.go.html#3230765">_RD</a></span><span class="op" id="3247650">)</span>&nbsp;<span class="op" id="3247652">!=</span>&nbsp;<span class="num" id="3247655">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3247658"><a href="/gostd/net/dnsmsg.go.html#3247282">dns</a></span><span class="op" id="3247661">.</span><span class="ident" id="3247662"><a href="/gostd/net/dnsmsg.go.html#3245412">recursion_available</a></span>&nbsp;<span class="op" id="3247682">=</span>&nbsp;<span class="op" id="3247684">(</span><span class="ident" id="3247685"><a href="/gostd/net/dnsmsg.go.html#3247338">dh</a></span><span class="op" id="3247687">.</span><span class="ident" id="3247688"><a href="/gostd/net/dnsmsg.go.html#3230271">Bits</a></span>&nbsp;<span class="op" id="3247693">&amp;</span>&nbsp;<span class="ident" id="3247695"><a href="/gostd/net/dnsmsg.go.html#3230801">_RA</a></span><span class="op" id="3247698">)</span>&nbsp;<span class="op" id="3247700">!=</span>&nbsp;<span class="num" id="3247703">0</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3247706"><a href="/gostd/net/dnsmsg.go.html#3247282">dns</a></span><span class="op" id="3247709">.</span><span class="ident" id="3247710"><a href="/gostd/net/dnsmsg.go.html#3245438">rcode</a></span>&nbsp;<span class="op" id="3247716">=</span>&nbsp;<span class="builtintype" id="3247718">int</span><span class="op" id="3247721">(</span><span class="ident" id="3247722"><a href="/gostd/net/dnsmsg.go.html#3247338">dh</a></span><span class="op" id="3247724">.</span><span class="ident" id="3247725"><a href="/gostd/net/dnsmsg.go.html#3230271">Bits</a></span>&nbsp;<span class="op" id="3247730">&amp;</span>&nbsp;<span class="num" id="3247732">0xF</span><span class="op" id="3247735">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3247739">//&nbsp;Arrays.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3247751"><a href="/gostd/net/dnsmsg.go.html#3247282">dns</a></span><span class="op" id="3247754">.</span><span class="ident" id="3247755"><a href="/gostd/net/dnsmsg.go.html#3245900">question</a></span>&nbsp;<span class="op" id="3247764">=</span>&nbsp;<span class="builtinfunc" id="3247766">make</span><span class="op" id="3247770">(</span><span class="op" id="3247771">[</span><span class="op" id="3247772">]</span><span class="ident" id="3247773"><a href="/gostd/net/dnsmsg.go.html#3230862">dnsQuestion</a></span><span class="op" id="3247784">,</span>&nbsp;<span class="ident" id="3247786"><a href="/gostd/net/dnsmsg.go.html#3247338">dh</a></span><span class="op" id="3247788">.</span><span class="ident" id="3247789"><a href="/gostd/net/dnsmsg.go.html#3230314">Qdcount</a></span><span class="op" id="3247796">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3247799"><a href="/gostd/net/dnsmsg.go.html#3247282">dns</a></span><span class="op" id="3247802">.</span><span class="ident" id="3247803"><a href="/gostd/net/dnsmsg.go.html#3245924">answer</a></span>&nbsp;<span class="op" id="3247810">=</span>&nbsp;<span class="builtinfunc" id="3247812">make</span><span class="op" id="3247816">(</span><span class="op" id="3247817">[</span><span class="op" id="3247818">]</span><span class="ident" id="3247819"><a href="/gostd/net/dnsmsg.go.html#3231784">dnsRR</a></span><span class="op" id="3247824">,</span>&nbsp;<span class="num" id="3247826">0</span><span class="op" id="3247827">,</span>&nbsp;<span class="ident" id="3247829"><a href="/gostd/net/dnsmsg.go.html#3247338">dh</a></span><span class="op" id="3247831">.</span><span class="ident" id="3247832"><a href="/gostd/net/dnsmsg.go.html#3230323">Ancount</a></span><span class="op" id="3247839">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3247842"><a href="/gostd/net/dnsmsg.go.html#3247282">dns</a></span><span class="op" id="3247845">.</span><span class="ident" id="3247846"><a href="/gostd/net/dnsmsg.go.html#3245942">ns</a></span>&nbsp;<span class="op" id="3247849">=</span>&nbsp;<span class="builtinfunc" id="3247851">make</span><span class="op" id="3247855">(</span><span class="op" id="3247856">[</span><span class="op" id="3247857">]</span><span class="ident" id="3247858"><a href="/gostd/net/dnsmsg.go.html#3231784">dnsRR</a></span><span class="op" id="3247863">,</span>&nbsp;<span class="num" id="3247865">0</span><span class="op" id="3247866">,</span>&nbsp;<span class="ident" id="3247868"><a href="/gostd/net/dnsmsg.go.html#3247338">dh</a></span><span class="op" id="3247870">.</span><span class="ident" id="3247871"><a href="/gostd/net/dnsmsg.go.html#3230332">Nscount</a></span><span class="op" id="3247878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3247881"><a href="/gostd/net/dnsmsg.go.html#3247282">dns</a></span><span class="op" id="3247884">.</span><span class="ident" id="3247885"><a href="/gostd/net/dnsmsg.go.html#3245960">extra</a></span>&nbsp;<span class="op" id="3247891">=</span>&nbsp;<span class="builtinfunc" id="3247893">make</span><span class="op" id="3247897">(</span><span class="op" id="3247898">[</span><span class="op" id="3247899">]</span><span class="ident" id="3247900"><a href="/gostd/net/dnsmsg.go.html#3231784">dnsRR</a></span><span class="op" id="3247905">,</span>&nbsp;<span class="num" id="3247907">0</span><span class="op" id="3247908">,</span>&nbsp;<span class="ident" id="3247910"><a href="/gostd/net/dnsmsg.go.html#3247338">dh</a></span><span class="op" id="3247912">.</span><span class="ident" id="3247913"><a href="/gostd/net/dnsmsg.go.html#3230341">Arcount</a></span><span class="op" id="3247920">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3247924">var</span>&nbsp;<span class="ident" id="3247928">rec</span>&nbsp;<span class="ident" id="3247932"><a href="/gostd/net/dnsmsg.go.html#3231784">dnsRR</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3247940">for</span>&nbsp;<span class="ident" id="3247944">i</span>&nbsp;<span class="op" id="3247946">:=</span>&nbsp;<span class="num" id="3247949">0</span><span class="op" id="3247950">;</span>&nbsp;<span class="ident" id="3247952"><a href="/gostd/net/dnsmsg.go.html#3247944">i</a></span>&nbsp;<span class="op" id="3247954">&lt;</span>&nbsp;<span class="builtinfunc" id="3247956">len</span><span class="op" id="3247959">(</span><span class="ident" id="3247960"><a href="/gostd/net/dnsmsg.go.html#3247282">dns</a></span><span class="op" id="3247963">.</span><span class="ident" id="3247964"><a href="/gostd/net/dnsmsg.go.html#3245900">question</a></span><span class="op" id="3247972">)</span><span class="op" id="3247973">;</span>&nbsp;<span class="ident" id="3247975"><a href="/gostd/net/dnsmsg.go.html#3247944">i</a></span><span class="op" id="3247976">++</span>&nbsp;<span class="op" id="3247979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3247983"><a href="/gostd/net/dnsmsg.go.html#3247352">off</a></span><span class="op" id="3247986">,</span>&nbsp;<span class="ident" id="3247988"><a href="/gostd/net/dnsmsg.go.html#3247366">ok</a></span>&nbsp;<span class="op" id="3247991">=</span>&nbsp;<span class="ident" id="3247993"><a href="/gostd/net/dnsmsg.go.html#3241636">unpackStruct</a></span><span class="op" id="3248005">(</span><span class="op" id="3248006">&amp;</span><span class="ident" id="3248007"><a href="/gostd/net/dnsmsg.go.html#3247282">dns</a></span><span class="op" id="3248010">.</span><span class="ident" id="3248011"><a href="/gostd/net/dnsmsg.go.html#3245900">question</a></span><span class="op" id="3248019">[</span><span class="ident" id="3248020"><a href="/gostd/net/dnsmsg.go.html#3247944">i</a></span><span class="op" id="3248021">]</span><span class="op" id="3248022">,</span>&nbsp;<span class="ident" id="3248024"><a href="/gostd/net/dnsmsg.go.html#3247302">msg</a></span><span class="op" id="3248027">,</span>&nbsp;<span class="ident" id="3248029"><a href="/gostd/net/dnsmsg.go.html#3247352">off</a></span><span class="op" id="3248032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3248035">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3248038">for</span>&nbsp;<span class="ident" id="3248042">i</span>&nbsp;<span class="op" id="3248044">:=</span>&nbsp;<span class="num" id="3248047">0</span><span class="op" id="3248048">;</span>&nbsp;<span class="ident" id="3248050"><a href="/gostd/net/dnsmsg.go.html#3248042">i</a></span>&nbsp;<span class="op" id="3248052">&lt;</span>&nbsp;<span class="builtintype" id="3248054">int</span><span class="op" id="3248057">(</span><span class="ident" id="3248058"><a href="/gostd/net/dnsmsg.go.html#3247338">dh</a></span><span class="op" id="3248060">.</span><span class="ident" id="3248061"><a href="/gostd/net/dnsmsg.go.html#3230323">Ancount</a></span><span class="op" id="3248068">)</span><span class="op" id="3248069">;</span>&nbsp;<span class="ident" id="3248071"><a href="/gostd/net/dnsmsg.go.html#3248042">i</a></span><span class="op" id="3248072">++</span>&nbsp;<span class="op" id="3248075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3248079"><a href="/gostd/net/dnsmsg.go.html#3247928">rec</a></span><span class="op" id="3248082">,</span>&nbsp;<span class="ident" id="3248084"><a href="/gostd/net/dnsmsg.go.html#3247352">off</a></span><span class="op" id="3248087">,</span>&nbsp;<span class="ident" id="3248089"><a href="/gostd/net/dnsmsg.go.html#3247366">ok</a></span>&nbsp;<span class="op" id="3248092">=</span>&nbsp;<span class="ident" id="3248094"><a href="/gostd/net/dnsmsg.go.html#3244543">unpackRR</a></span><span class="op" id="3248102">(</span><span class="ident" id="3248103"><a href="/gostd/net/dnsmsg.go.html#3247302">msg</a></span><span class="op" id="3248106">,</span>&nbsp;<span class="ident" id="3248108"><a href="/gostd/net/dnsmsg.go.html#3247352">off</a></span><span class="op" id="3248111">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3248115">if</span>&nbsp;<span class="op" id="3248118">!</span><span class="ident" id="3248119"><a href="/gostd/net/dnsmsg.go.html#3247366">ok</a></span>&nbsp;<span class="op" id="3248122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3248127">return</span>&nbsp;<span class="builtintype" id="3248134">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3248142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3248146"><a href="/gostd/net/dnsmsg.go.html#3247282">dns</a></span><span class="op" id="3248149">.</span><span class="ident" id="3248150"><a href="/gostd/net/dnsmsg.go.html#3245924">answer</a></span>&nbsp;<span class="op" id="3248157">=</span>&nbsp;<span class="builtinfunc" id="3248159">append</span><span class="op" id="3248165">(</span><span class="ident" id="3248166"><a href="/gostd/net/dnsmsg.go.html#3247282">dns</a></span><span class="op" id="3248169">.</span><span class="ident" id="3248170"><a href="/gostd/net/dnsmsg.go.html#3245924">answer</a></span><span class="op" id="3248176">,</span>&nbsp;<span class="ident" id="3248178"><a href="/gostd/net/dnsmsg.go.html#3247928">rec</a></span><span class="op" id="3248181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3248184">}</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3248187">for</span>&nbsp;<span class="ident" id="3248191">i</span>&nbsp;<span class="op" id="3248193">:=</span>&nbsp;<span class="num" id="3248196">0</span><span class="op" id="3248197">;</span>&nbsp;<span class="ident" id="3248199"><a href="/gostd/net/dnsmsg.go.html#3248191">i</a></span>&nbsp;<span class="op" id="3248201">&lt;</span>&nbsp;<span class="builtintype" id="3248203">int</span><span class="op" id="3248206">(</span><span class="ident" id="3248207"><a href="/gostd/net/dnsmsg.go.html#3247338">dh</a></span><span class="op" id="3248209">.</span><span class="ident" id="3248210"><a href="/gostd/net/dnsmsg.go.html#3230332">Nscount</a></span><span class="op" id="3248217">)</span><span class="op" id="3248218">;</span>&nbsp;<span class="ident" id="3248220"><a href="/gostd/net/dnsmsg.go.html#3248191">i</a></span><span class="op" id="3248221">++</span>&nbsp;<span class="op" id="3248224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3248228"><a href="/gostd/net/dnsmsg.go.html#3247928">rec</a></span><span class="op" id="3248231">,</span>&nbsp;<span class="ident" id="3248233"><a href="/gostd/net/dnsmsg.go.html#3247352">off</a></span><span class="op" id="3248236">,</span>&nbsp;<span class="ident" id="3248238"><a href="/gostd/net/dnsmsg.go.html#3247366">ok</a></span>&nbsp;<span class="op" id="3248241">=</span>&nbsp;<span class="ident" id="3248243"><a href="/gostd/net/dnsmsg.go.html#3244543">unpackRR</a></span><span class="op" id="3248251">(</span><span class="ident" id="3248252"><a href="/gostd/net/dnsmsg.go.html#3247302">msg</a></span><span class="op" id="3248255">,</span>&nbsp;<span class="ident" id="3248257"><a href="/gostd/net/dnsmsg.go.html#3247352">off</a></span><span class="op" id="3248260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3248264">if</span>&nbsp;<span class="op" id="3248267">!</span><span class="ident" id="3248268"><a href="/gostd/net/dnsmsg.go.html#3247366">ok</a></span>&nbsp;<span class="op" id="3248271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3248276">return</span>&nbsp;<span class="builtintype" id="3248283">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3248291">}</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3248295"><a href="/gostd/net/dnsmsg.go.html#3247282">dns</a></span><span class="op" id="3248298">.</span><span class="ident" id="3248299"><a href="/gostd/net/dnsmsg.go.html#3245942">ns</a></span>&nbsp;<span class="op" id="3248302">=</span>&nbsp;<span class="builtinfunc" id="3248304">append</span><span class="op" id="3248310">(</span><span class="ident" id="3248311"><a href="/gostd/net/dnsmsg.go.html#3247282">dns</a></span><span class="op" id="3248314">.</span><span class="ident" id="3248315"><a href="/gostd/net/dnsmsg.go.html#3245942">ns</a></span><span class="op" id="3248317">,</span>&nbsp;<span class="ident" id="3248319"><a href="/gostd/net/dnsmsg.go.html#3247928">rec</a></span><span class="op" id="3248322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3248325">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3248328">for</span>&nbsp;<span class="ident" id="3248332">i</span>&nbsp;<span class="op" id="3248334">:=</span>&nbsp;<span class="num" id="3248337">0</span><span class="op" id="3248338">;</span>&nbsp;<span class="ident" id="3248340"><a href="/gostd/net/dnsmsg.go.html#3248332">i</a></span>&nbsp;<span class="op" id="3248342">&lt;</span>&nbsp;<span class="builtintype" id="3248344">int</span><span class="op" id="3248347">(</span><span class="ident" id="3248348"><a href="/gostd/net/dnsmsg.go.html#3247338">dh</a></span><span class="op" id="3248350">.</span><span class="ident" id="3248351"><a href="/gostd/net/dnsmsg.go.html#3230341">Arcount</a></span><span class="op" id="3248358">)</span><span class="op" id="3248359">;</span>&nbsp;<span class="ident" id="3248361"><a href="/gostd/net/dnsmsg.go.html#3248332">i</a></span><span class="op" id="3248362">++</span>&nbsp;<span class="op" id="3248365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3248369"><a href="/gostd/net/dnsmsg.go.html#3247928">rec</a></span><span class="op" id="3248372">,</span>&nbsp;<span class="ident" id="3248374"><a href="/gostd/net/dnsmsg.go.html#3247352">off</a></span><span class="op" id="3248377">,</span>&nbsp;<span class="ident" id="3248379"><a href="/gostd/net/dnsmsg.go.html#3247366">ok</a></span>&nbsp;<span class="op" id="3248382">=</span>&nbsp;<span class="ident" id="3248384"><a href="/gostd/net/dnsmsg.go.html#3244543">unpackRR</a></span><span class="op" id="3248392">(</span><span class="ident" id="3248393"><a href="/gostd/net/dnsmsg.go.html#3247302">msg</a></span><span class="op" id="3248396">,</span>&nbsp;<span class="ident" id="3248398"><a href="/gostd/net/dnsmsg.go.html#3247352">off</a></span><span class="op" id="3248401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3248405">if</span>&nbsp;<span class="op" id="3248408">!</span><span class="ident" id="3248409"><a href="/gostd/net/dnsmsg.go.html#3247366">ok</a></span>&nbsp;<span class="op" id="3248412">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3248417">return</span>&nbsp;<span class="builtintype" id="3248424">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3248432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3248436"><a href="/gostd/net/dnsmsg.go.html#3247282">dns</a></span><span class="op" id="3248439">.</span><span class="ident" id="3248440"><a href="/gostd/net/dnsmsg.go.html#3245960">extra</a></span>&nbsp;<span class="op" id="3248446">=</span>&nbsp;<span class="builtinfunc" id="3248448">append</span><span class="op" id="3248454">(</span><span class="ident" id="3248455"><a href="/gostd/net/dnsmsg.go.html#3247282">dns</a></span><span class="op" id="3248458">.</span><span class="ident" id="3248459"><a href="/gostd/net/dnsmsg.go.html#3245960">extra</a></span><span class="op" id="3248464">,</span>&nbsp;<span class="ident" id="3248466"><a href="/gostd/net/dnsmsg.go.html#3247928">rec</a></span><span class="op" id="3248469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3248472">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3248475">//&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;off&nbsp;!=&nbsp;len(msg)&nbsp;{</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3248500">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;println(&#34;extra&nbsp;bytes&nbsp;in&nbsp;dns&nbsp;packet&#34;,&nbsp;off,&nbsp;&#34;&lt;&#34;,&nbsp;len(msg));</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3248563">//&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3248569">return</span>&nbsp;<span class="builtintype" id="3248576">true</span><br>
<span class="lineno"></span><span class="op" id="3248581">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">860</span><span class="keyword" id="3248584">func</span>&nbsp;<span class="op" id="3248589">(</span><span class="ident" id="3248590">dns</span>&nbsp;<span class="op" id="3248594">*</span><span class="ident" id="3248595"><a href="/gostd/net/dnsmsg.go.html#3245872">dnsMsg</a></span><span class="op" id="3248601">)</span>&nbsp;<span class="ident" id="3248603">String</span><span class="op" id="3248609">(</span><span class="op" id="3248610">)</span>&nbsp;<span class="builtintype" id="3248612">string</span>&nbsp;<span class="op" id="3248619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3248622">s</span>&nbsp;<span class="op" id="3248624">:=</span>&nbsp;<span class="string" id="3248627">&#34;DNS:&nbsp;&#34;</span>&nbsp;<span class="op" id="3248635">+</span>&nbsp;<span class="ident" id="3248637"><a href="/gostd/net/dnsmsg.go.html#3242951">printStruct</a></span><span class="op" id="3248648">(</span><span class="op" id="3248649">&amp;</span><span class="ident" id="3248650"><a href="/gostd/net/dnsmsg.go.html#3248590">dns</a></span><span class="op" id="3248653">.</span><span class="ident" id="3248654"><a href="/gostd/net/dnsmsg.go.html#3245889">dnsMsgHdr</a></span><span class="op" id="3248663">)</span>&nbsp;<span class="op" id="3248665">+</span>&nbsp;<span class="string" id="3248667">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3248673">if</span>&nbsp;<span class="builtinfunc" id="3248676">len</span><span class="op" id="3248679">(</span><span class="ident" id="3248680"><a href="/gostd/net/dnsmsg.go.html#3248590">dns</a></span><span class="op" id="3248683">.</span><span class="ident" id="3248684"><a href="/gostd/net/dnsmsg.go.html#3245900">question</a></span><span class="op" id="3248692">)</span>&nbsp;<span class="op" id="3248694">&gt;</span>&nbsp;<span class="num" id="3248696">0</span>&nbsp;<span class="op" id="3248698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3248702"><a href="/gostd/net/dnsmsg.go.html#3248622">s</a></span>&nbsp;<span class="op" id="3248704">+=</span>&nbsp;<span class="string" id="3248707">&#34;--&nbsp;Questions\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3248726">for</span>&nbsp;<span class="ident" id="3248730">i</span>&nbsp;<span class="op" id="3248732">:=</span>&nbsp;<span class="num" id="3248735">0</span><span class="op" id="3248736">;</span>&nbsp;<span class="ident" id="3248738"><a href="/gostd/net/dnsmsg.go.html#3248730">i</a></span>&nbsp;<span class="op" id="3248740">&lt;</span>&nbsp;<span class="builtinfunc" id="3248742">len</span><span class="op" id="3248745">(</span><span class="ident" id="3248746"><a href="/gostd/net/dnsmsg.go.html#3248590">dns</a></span><span class="op" id="3248749">.</span><span class="ident" id="3248750"><a href="/gostd/net/dnsmsg.go.html#3245900">question</a></span><span class="op" id="3248758">)</span><span class="op" id="3248759">;</span>&nbsp;<span class="ident" id="3248761"><a href="/gostd/net/dnsmsg.go.html#3248730">i</a></span><span class="op" id="3248762">++</span>&nbsp;<span class="op" id="3248765">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3248770"><a href="/gostd/net/dnsmsg.go.html#3248622">s</a></span>&nbsp;<span class="op" id="3248772">+=</span>&nbsp;<span class="ident" id="3248775"><a href="/gostd/net/dnsmsg.go.html#3242951">printStruct</a></span><span class="op" id="3248786">(</span><span class="op" id="3248787">&amp;</span><span class="ident" id="3248788"><a href="/gostd/net/dnsmsg.go.html#3248590">dns</a></span><span class="op" id="3248791">.</span><span class="ident" id="3248792"><a href="/gostd/net/dnsmsg.go.html#3245900">question</a></span><span class="op" id="3248800">[</span><span class="ident" id="3248801"><a href="/gostd/net/dnsmsg.go.html#3248730">i</a></span><span class="op" id="3248802">]</span><span class="op" id="3248803">)</span>&nbsp;<span class="op" id="3248805">+</span>&nbsp;<span class="string" id="3248807">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3248814">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3248817">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3248820">if</span>&nbsp;<span class="builtinfunc" id="3248823">len</span><span class="op" id="3248826">(</span><span class="ident" id="3248827"><a href="/gostd/net/dnsmsg.go.html#3248590">dns</a></span><span class="op" id="3248830">.</span><span class="ident" id="3248831"><a href="/gostd/net/dnsmsg.go.html#3245924">answer</a></span><span class="op" id="3248837">)</span>&nbsp;<span class="op" id="3248839">&gt;</span>&nbsp;<span class="num" id="3248841">0</span>&nbsp;<span class="op" id="3248843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3248847"><a href="/gostd/net/dnsmsg.go.html#3248622">s</a></span>&nbsp;<span class="op" id="3248849">+=</span>&nbsp;<span class="string" id="3248852">&#34;--&nbsp;Answers\n&#34;</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3248869">for</span>&nbsp;<span class="ident" id="3248873">i</span>&nbsp;<span class="op" id="3248875">:=</span>&nbsp;<span class="num" id="3248878">0</span><span class="op" id="3248879">;</span>&nbsp;<span class="ident" id="3248881"><a href="/gostd/net/dnsmsg.go.html#3248873">i</a></span>&nbsp;<span class="op" id="3248883">&lt;</span>&nbsp;<span class="builtinfunc" id="3248885">len</span><span class="op" id="3248888">(</span><span class="ident" id="3248889"><a href="/gostd/net/dnsmsg.go.html#3248590">dns</a></span><span class="op" id="3248892">.</span><span class="ident" id="3248893"><a href="/gostd/net/dnsmsg.go.html#3245924">answer</a></span><span class="op" id="3248899">)</span><span class="op" id="3248900">;</span>&nbsp;<span class="ident" id="3248902"><a href="/gostd/net/dnsmsg.go.html#3248873">i</a></span><span class="op" id="3248903">++</span>&nbsp;<span class="op" id="3248906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3248911"><a href="/gostd/net/dnsmsg.go.html#3248622">s</a></span>&nbsp;<span class="op" id="3248913">+=</span>&nbsp;<span class="ident" id="3248916"><a href="/gostd/net/dnsmsg.go.html#3242951">printStruct</a></span><span class="op" id="3248927">(</span><span class="ident" id="3248928"><a href="/gostd/net/dnsmsg.go.html#3248590">dns</a></span><span class="op" id="3248931">.</span><span class="ident" id="3248932"><a href="/gostd/net/dnsmsg.go.html#3245924">answer</a></span><span class="op" id="3248938">[</span><span class="ident" id="3248939"><a href="/gostd/net/dnsmsg.go.html#3248873">i</a></span><span class="op" id="3248940">]</span><span class="op" id="3248941">)</span>&nbsp;<span class="op" id="3248943">+</span>&nbsp;<span class="string" id="3248945">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3248952">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3248955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3248958">if</span>&nbsp;<span class="builtinfunc" id="3248961">len</span><span class="op" id="3248964">(</span><span class="ident" id="3248965"><a href="/gostd/net/dnsmsg.go.html#3248590">dns</a></span><span class="op" id="3248968">.</span><span class="ident" id="3248969"><a href="/gostd/net/dnsmsg.go.html#3245942">ns</a></span><span class="op" id="3248971">)</span>&nbsp;<span class="op" id="3248973">&gt;</span>&nbsp;<span class="num" id="3248975">0</span>&nbsp;<span class="op" id="3248977">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3248981"><a href="/gostd/net/dnsmsg.go.html#3248622">s</a></span>&nbsp;<span class="op" id="3248983">+=</span>&nbsp;<span class="string" id="3248986">&#34;--&nbsp;Name&nbsp;servers\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3249008">for</span>&nbsp;<span class="ident" id="3249012">i</span>&nbsp;<span class="op" id="3249014">:=</span>&nbsp;<span class="num" id="3249017">0</span><span class="op" id="3249018">;</span>&nbsp;<span class="ident" id="3249020"><a href="/gostd/net/dnsmsg.go.html#3249012">i</a></span>&nbsp;<span class="op" id="3249022">&lt;</span>&nbsp;<span class="builtinfunc" id="3249024">len</span><span class="op" id="3249027">(</span><span class="ident" id="3249028"><a href="/gostd/net/dnsmsg.go.html#3248590">dns</a></span><span class="op" id="3249031">.</span><span class="ident" id="3249032"><a href="/gostd/net/dnsmsg.go.html#3245942">ns</a></span><span class="op" id="3249034">)</span><span class="op" id="3249035">;</span>&nbsp;<span class="ident" id="3249037"><a href="/gostd/net/dnsmsg.go.html#3249012">i</a></span><span class="op" id="3249038">++</span>&nbsp;<span class="op" id="3249041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3249046"><a href="/gostd/net/dnsmsg.go.html#3248622">s</a></span>&nbsp;<span class="op" id="3249048">+=</span>&nbsp;<span class="ident" id="3249051"><a href="/gostd/net/dnsmsg.go.html#3242951">printStruct</a></span><span class="op" id="3249062">(</span><span class="ident" id="3249063"><a href="/gostd/net/dnsmsg.go.html#3248590">dns</a></span><span class="op" id="3249066">.</span><span class="ident" id="3249067"><a href="/gostd/net/dnsmsg.go.html#3245942">ns</a></span><span class="op" id="3249069">[</span><span class="ident" id="3249070"><a href="/gostd/net/dnsmsg.go.html#3249012">i</a></span><span class="op" id="3249071">]</span><span class="op" id="3249072">)</span>&nbsp;<span class="op" id="3249074">+</span>&nbsp;<span class="string" id="3249076">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3249083">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3249086">}</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3249089">if</span>&nbsp;<span class="builtinfunc" id="3249092">len</span><span class="op" id="3249095">(</span><span class="ident" id="3249096"><a href="/gostd/net/dnsmsg.go.html#3248590">dns</a></span><span class="op" id="3249099">.</span><span class="ident" id="3249100"><a href="/gostd/net/dnsmsg.go.html#3245960">extra</a></span><span class="op" id="3249105">)</span>&nbsp;<span class="op" id="3249107">&gt;</span>&nbsp;<span class="num" id="3249109">0</span>&nbsp;<span class="op" id="3249111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3249115"><a href="/gostd/net/dnsmsg.go.html#3248622">s</a></span>&nbsp;<span class="op" id="3249117">+=</span>&nbsp;<span class="string" id="3249120">&#34;--&nbsp;Extra\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3249135">for</span>&nbsp;<span class="ident" id="3249139">i</span>&nbsp;<span class="op" id="3249141">:=</span>&nbsp;<span class="num" id="3249144">0</span><span class="op" id="3249145">;</span>&nbsp;<span class="ident" id="3249147"><a href="/gostd/net/dnsmsg.go.html#3249139">i</a></span>&nbsp;<span class="op" id="3249149">&lt;</span>&nbsp;<span class="builtinfunc" id="3249151">len</span><span class="op" id="3249154">(</span><span class="ident" id="3249155"><a href="/gostd/net/dnsmsg.go.html#3248590">dns</a></span><span class="op" id="3249158">.</span><span class="ident" id="3249159"><a href="/gostd/net/dnsmsg.go.html#3245960">extra</a></span><span class="op" id="3249164">)</span><span class="op" id="3249165">;</span>&nbsp;<span class="ident" id="3249167"><a href="/gostd/net/dnsmsg.go.html#3249139">i</a></span><span class="op" id="3249168">++</span>&nbsp;<span class="op" id="3249171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3249176"><a href="/gostd/net/dnsmsg.go.html#3248622">s</a></span>&nbsp;<span class="op" id="3249178">+=</span>&nbsp;<span class="ident" id="3249181"><a href="/gostd/net/dnsmsg.go.html#3242951">printStruct</a></span><span class="op" id="3249192">(</span><span class="ident" id="3249193"><a href="/gostd/net/dnsmsg.go.html#3248590">dns</a></span><span class="op" id="3249196">.</span><span class="ident" id="3249197"><a href="/gostd/net/dnsmsg.go.html#3245960">extra</a></span><span class="op" id="3249202">[</span><span class="ident" id="3249203"><a href="/gostd/net/dnsmsg.go.html#3249139">i</a></span><span class="op" id="3249204">]</span><span class="op" id="3249205">)</span>&nbsp;<span class="op" id="3249207">+</span>&nbsp;<span class="string" id="3249209">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3249216">}</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3249219">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3249222">return</span>&nbsp;<span class="ident" id="3249229"><a href="/gostd/net/dnsmsg.go.html#3248622">s</a></span><br>
<span class="lineno"></span><span class="op" id="3249231">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
