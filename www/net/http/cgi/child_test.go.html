<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7534093">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7534148">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7534202">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="7534253">//&nbsp;Tests&nbsp;for&nbsp;CGI&nbsp;(the&nbsp;child&nbsp;process&nbsp;perspective)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7534303">package</span>&nbsp;<span class="ident" id="7534311">cgi</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7534316">import</span>&nbsp;<span class="op" id="7534323">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7534326">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7534336">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7534339">func</span>&nbsp;<span class="ident" id="7534344">TestRequest</span><span class="op" id="7534355">(</span><span class="ident" id="7534356">t</span>&nbsp;<span class="op" id="7534358">*</span><span class="ident" id="7534359"><a href="/net/http/cgi/child_test.go.html#7534326">testing</a></span><span class="op" id="7534366">.</span><span class="ident" id="7534367">T</span><span class="op" id="7534368">)</span>&nbsp;<span class="op" id="7534370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7534373">env</span>&nbsp;<span class="op" id="7534377">:=</span>&nbsp;<span class="keyword" id="7534380">map</span><span class="op" id="7534383">[</span><span class="builtintype" id="7534384">string</span><span class="op" id="7534390">]</span><span class="builtintype" id="7534391">string</span><span class="op" id="7534397">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7534401">&#34;SERVER_PROTOCOL&#34;</span><span class="op" id="7534418">:</span>&nbsp;<span class="string" id="7534420">&#34;HTTP/1.1&#34;</span><span class="op" id="7534430">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7534434">&#34;REQUEST_METHOD&#34;</span><span class="op" id="7534450">:</span>&nbsp;&nbsp;<span class="string" id="7534453">&#34;GET&#34;</span><span class="op" id="7534458">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7534462">&#34;HTTP_HOST&#34;</span><span class="op" id="7534473">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7534481">&#34;example.com&#34;</span><span class="op" id="7534494">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7534498">&#34;HTTP_REFERER&#34;</span><span class="op" id="7534512">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7534517">&#34;elsewhere&#34;</span><span class="op" id="7534528">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7534532">&#34;HTTP_USER_AGENT&#34;</span><span class="op" id="7534549">:</span>&nbsp;<span class="string" id="7534551">&#34;goclient&#34;</span><span class="op" id="7534561">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7534565">&#34;HTTP_FOO_BAR&#34;</span><span class="op" id="7534579">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7534584">&#34;baz&#34;</span><span class="op" id="7534589">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7534593">&#34;REQUEST_URI&#34;</span><span class="op" id="7534606">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7534612">&#34;/path?a=b&#34;</span><span class="op" id="7534623">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7534627">&#34;CONTENT_LENGTH&#34;</span><span class="op" id="7534643">:</span>&nbsp;&nbsp;<span class="string" id="7534646">&#34;123&#34;</span><span class="op" id="7534651">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7534655">&#34;CONTENT_TYPE&#34;</span><span class="op" id="7534669">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7534674">&#34;text/xml&#34;</span><span class="op" id="7534684">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7534688">&#34;REMOTE_ADDR&#34;</span><span class="op" id="7534701">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7534707">&#34;5.6.7.8&#34;</span><span class="op" id="7534716">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7534719">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7534722">req</span><span class="op" id="7534725">,</span>&nbsp;<span class="ident" id="7534727">err</span>&nbsp;<span class="op" id="7534731">:=</span>&nbsp;<span class="ident" id="7534734"><a href="/net/http/cgi/child.go.html#5488266">RequestFromMap</a></span><span class="op" id="7534748">(</span><span class="ident" id="7534749"><a href="/net/http/cgi/child_test.go.html#7534373">env</a></span><span class="op" id="7534752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7534755">if</span>&nbsp;<span class="ident" id="7534758"><a href="/net/http/cgi/child_test.go.html#7534727">err</a></span>&nbsp;<span class="op" id="7534762">!=</span>&nbsp;<span class="ident" id="7534765">nil</span>&nbsp;<span class="op" id="7534769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7534773"><a href="/net/http/cgi/child_test.go.html#7534356">t</a></span><span class="op" id="7534774">.</span><span class="ident" id="7534775">Fatalf</span><span class="op" id="7534781">(</span><span class="string" id="7534782">&#34;RequestFromMap:&nbsp;%v&#34;</span><span class="op" id="7534802">,</span>&nbsp;<span class="ident" id="7534804"><a href="/net/http/cgi/child_test.go.html#7534727">err</a></span><span class="op" id="7534807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7534810">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7534813">if</span>&nbsp;<span class="ident" id="7534816">g</span><span class="op" id="7534817">,</span>&nbsp;<span class="ident" id="7534819">e</span>&nbsp;<span class="op" id="7534821">:=</span>&nbsp;<span class="ident" id="7534824"><a href="/net/http/cgi/child_test.go.html#7534722">req</a></span><span class="op" id="7534827">.</span><span class="ident" id="7534828">UserAgent</span><span class="op" id="7534837">(</span><span class="op" id="7534838">)</span><span class="op" id="7534839">,</span>&nbsp;<span class="string" id="7534841">&#34;goclient&#34;</span><span class="op" id="7534851">;</span>&nbsp;<span class="ident" id="7534853"><a href="/net/http/cgi/child_test.go.html#7534819">e</a></span>&nbsp;<span class="op" id="7534855">!=</span>&nbsp;<span class="ident" id="7534858"><a href="/net/http/cgi/child_test.go.html#7534816">g</a></span>&nbsp;<span class="op" id="7534860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7534864"><a href="/net/http/cgi/child_test.go.html#7534356">t</a></span><span class="op" id="7534865">.</span><span class="ident" id="7534866">Errorf</span><span class="op" id="7534872">(</span><span class="string" id="7534873">&#34;expected&nbsp;UserAgent&nbsp;%q;&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7534904">,</span>&nbsp;<span class="ident" id="7534906"><a href="/net/http/cgi/child_test.go.html#7534819">e</a></span><span class="op" id="7534907">,</span>&nbsp;<span class="ident" id="7534909"><a href="/net/http/cgi/child_test.go.html#7534816">g</a></span><span class="op" id="7534910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7534913">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7534916">if</span>&nbsp;<span class="ident" id="7534919">g</span><span class="op" id="7534920">,</span>&nbsp;<span class="ident" id="7534922">e</span>&nbsp;<span class="op" id="7534924">:=</span>&nbsp;<span class="ident" id="7534927"><a href="/net/http/cgi/child_test.go.html#7534722">req</a></span><span class="op" id="7534930">.</span><span class="ident" id="7534931">Method</span><span class="op" id="7534937">,</span>&nbsp;<span class="string" id="7534939">&#34;GET&#34;</span><span class="op" id="7534944">;</span>&nbsp;<span class="ident" id="7534946"><a href="/net/http/cgi/child_test.go.html#7534922">e</a></span>&nbsp;<span class="op" id="7534948">!=</span>&nbsp;<span class="ident" id="7534951"><a href="/net/http/cgi/child_test.go.html#7534919">g</a></span>&nbsp;<span class="op" id="7534953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7534957"><a href="/net/http/cgi/child_test.go.html#7534356">t</a></span><span class="op" id="7534958">.</span><span class="ident" id="7534959">Errorf</span><span class="op" id="7534965">(</span><span class="string" id="7534966">&#34;expected&nbsp;Method&nbsp;%q;&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7534994">,</span>&nbsp;<span class="ident" id="7534996"><a href="/net/http/cgi/child_test.go.html#7534922">e</a></span><span class="op" id="7534997">,</span>&nbsp;<span class="ident" id="7534999"><a href="/net/http/cgi/child_test.go.html#7534919">g</a></span><span class="op" id="7535000">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7535003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7535006">if</span>&nbsp;<span class="ident" id="7535009">g</span><span class="op" id="7535010">,</span>&nbsp;<span class="ident" id="7535012">e</span>&nbsp;<span class="op" id="7535014">:=</span>&nbsp;<span class="ident" id="7535017"><a href="/net/http/cgi/child_test.go.html#7534722">req</a></span><span class="op" id="7535020">.</span><span class="ident" id="7535021">Header</span><span class="op" id="7535027">.</span><span class="ident" id="7535028">Get</span><span class="op" id="7535031">(</span><span class="string" id="7535032">&#34;Content-Type&#34;</span><span class="op" id="7535046">)</span><span class="op" id="7535047">,</span>&nbsp;<span class="string" id="7535049">&#34;text/xml&#34;</span><span class="op" id="7535059">;</span>&nbsp;<span class="ident" id="7535061"><a href="/net/http/cgi/child_test.go.html#7535012">e</a></span>&nbsp;<span class="op" id="7535063">!=</span>&nbsp;<span class="ident" id="7535066"><a href="/net/http/cgi/child_test.go.html#7535009">g</a></span>&nbsp;<span class="op" id="7535068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7535072"><a href="/net/http/cgi/child_test.go.html#7534356">t</a></span><span class="op" id="7535073">.</span><span class="ident" id="7535074">Errorf</span><span class="op" id="7535080">(</span><span class="string" id="7535081">&#34;expected&nbsp;Content-Type&nbsp;%q;&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7535115">,</span>&nbsp;<span class="ident" id="7535117"><a href="/net/http/cgi/child_test.go.html#7535012">e</a></span><span class="op" id="7535118">,</span>&nbsp;<span class="ident" id="7535120"><a href="/net/http/cgi/child_test.go.html#7535009">g</a></span><span class="op" id="7535121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7535124">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7535127">if</span>&nbsp;<span class="ident" id="7535130">g</span><span class="op" id="7535131">,</span>&nbsp;<span class="ident" id="7535133">e</span>&nbsp;<span class="op" id="7535135">:=</span>&nbsp;<span class="ident" id="7535138"><a href="/net/http/cgi/child_test.go.html#7534722">req</a></span><span class="op" id="7535141">.</span><span class="ident" id="7535142">ContentLength</span><span class="op" id="7535155">,</span>&nbsp;<span class="ident" id="7535157">int64</span><span class="op" id="7535162">(</span><span class="num" id="7535163">123</span><span class="op" id="7535166">)</span><span class="op" id="7535167">;</span>&nbsp;<span class="ident" id="7535169"><a href="/net/http/cgi/child_test.go.html#7535133">e</a></span>&nbsp;<span class="op" id="7535171">!=</span>&nbsp;<span class="ident" id="7535174"><a href="/net/http/cgi/child_test.go.html#7535130">g</a></span>&nbsp;<span class="op" id="7535176">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7535180"><a href="/net/http/cgi/child_test.go.html#7534356">t</a></span><span class="op" id="7535181">.</span><span class="ident" id="7535182">Errorf</span><span class="op" id="7535188">(</span><span class="string" id="7535189">&#34;expected&nbsp;ContentLength&nbsp;%d;&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7535224">,</span>&nbsp;<span class="ident" id="7535226"><a href="/net/http/cgi/child_test.go.html#7535133">e</a></span><span class="op" id="7535227">,</span>&nbsp;<span class="ident" id="7535229"><a href="/net/http/cgi/child_test.go.html#7535130">g</a></span><span class="op" id="7535230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7535233">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7535236">if</span>&nbsp;<span class="ident" id="7535239">g</span><span class="op" id="7535240">,</span>&nbsp;<span class="ident" id="7535242">e</span>&nbsp;<span class="op" id="7535244">:=</span>&nbsp;<span class="ident" id="7535247"><a href="/net/http/cgi/child_test.go.html#7534722">req</a></span><span class="op" id="7535250">.</span><span class="ident" id="7535251">Referer</span><span class="op" id="7535258">(</span><span class="op" id="7535259">)</span><span class="op" id="7535260">,</span>&nbsp;<span class="string" id="7535262">&#34;elsewhere&#34;</span><span class="op" id="7535273">;</span>&nbsp;<span class="ident" id="7535275"><a href="/net/http/cgi/child_test.go.html#7535242">e</a></span>&nbsp;<span class="op" id="7535277">!=</span>&nbsp;<span class="ident" id="7535280"><a href="/net/http/cgi/child_test.go.html#7535239">g</a></span>&nbsp;<span class="op" id="7535282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7535286"><a href="/net/http/cgi/child_test.go.html#7534356">t</a></span><span class="op" id="7535287">.</span><span class="ident" id="7535288">Errorf</span><span class="op" id="7535294">(</span><span class="string" id="7535295">&#34;expected&nbsp;Referer&nbsp;%q;&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7535324">,</span>&nbsp;<span class="ident" id="7535326"><a href="/net/http/cgi/child_test.go.html#7535242">e</a></span><span class="op" id="7535327">,</span>&nbsp;<span class="ident" id="7535329"><a href="/net/http/cgi/child_test.go.html#7535239">g</a></span><span class="op" id="7535330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7535333">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7535336">if</span>&nbsp;<span class="ident" id="7535339"><a href="/net/http/cgi/child_test.go.html#7534722">req</a></span><span class="op" id="7535342">.</span><span class="ident" id="7535343">Header</span>&nbsp;<span class="op" id="7535350">==</span>&nbsp;<span class="ident" id="7535353">nil</span>&nbsp;<span class="op" id="7535357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7535361"><a href="/net/http/cgi/child_test.go.html#7534356">t</a></span><span class="op" id="7535362">.</span><span class="ident" id="7535363">Fatalf</span><span class="op" id="7535369">(</span><span class="string" id="7535370">&#34;unexpected&nbsp;nil&nbsp;Header&#34;</span><span class="op" id="7535393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7535396">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7535399">if</span>&nbsp;<span class="ident" id="7535402">g</span><span class="op" id="7535403">,</span>&nbsp;<span class="ident" id="7535405">e</span>&nbsp;<span class="op" id="7535407">:=</span>&nbsp;<span class="ident" id="7535410"><a href="/net/http/cgi/child_test.go.html#7534722">req</a></span><span class="op" id="7535413">.</span><span class="ident" id="7535414">Header</span><span class="op" id="7535420">.</span><span class="ident" id="7535421">Get</span><span class="op" id="7535424">(</span><span class="string" id="7535425">&#34;Foo-Bar&#34;</span><span class="op" id="7535434">)</span><span class="op" id="7535435">,</span>&nbsp;<span class="string" id="7535437">&#34;baz&#34;</span><span class="op" id="7535442">;</span>&nbsp;<span class="ident" id="7535444"><a href="/net/http/cgi/child_test.go.html#7535405">e</a></span>&nbsp;<span class="op" id="7535446">!=</span>&nbsp;<span class="ident" id="7535449"><a href="/net/http/cgi/child_test.go.html#7535402">g</a></span>&nbsp;<span class="op" id="7535451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7535455"><a href="/net/http/cgi/child_test.go.html#7534356">t</a></span><span class="op" id="7535456">.</span><span class="ident" id="7535457">Errorf</span><span class="op" id="7535463">(</span><span class="string" id="7535464">&#34;expected&nbsp;Foo-Bar&nbsp;%q;&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7535493">,</span>&nbsp;<span class="ident" id="7535495"><a href="/net/http/cgi/child_test.go.html#7535405">e</a></span><span class="op" id="7535496">,</span>&nbsp;<span class="ident" id="7535498"><a href="/net/http/cgi/child_test.go.html#7535402">g</a></span><span class="op" id="7535499">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7535502">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7535505">if</span>&nbsp;<span class="ident" id="7535508">g</span><span class="op" id="7535509">,</span>&nbsp;<span class="ident" id="7535511">e</span>&nbsp;<span class="op" id="7535513">:=</span>&nbsp;<span class="ident" id="7535516"><a href="/net/http/cgi/child_test.go.html#7534722">req</a></span><span class="op" id="7535519">.</span><span class="ident" id="7535520">URL</span><span class="op" id="7535523">.</span><span class="ident" id="7535524">String</span><span class="op" id="7535530">(</span><span class="op" id="7535531">)</span><span class="op" id="7535532">,</span>&nbsp;<span class="string" id="7535534">&#34;http://example.com/path?a=b&#34;</span><span class="op" id="7535563">;</span>&nbsp;<span class="ident" id="7535565"><a href="/net/http/cgi/child_test.go.html#7535511">e</a></span>&nbsp;<span class="op" id="7535567">!=</span>&nbsp;<span class="ident" id="7535570"><a href="/net/http/cgi/child_test.go.html#7535508">g</a></span>&nbsp;<span class="op" id="7535572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7535576"><a href="/net/http/cgi/child_test.go.html#7534356">t</a></span><span class="op" id="7535577">.</span><span class="ident" id="7535578">Errorf</span><span class="op" id="7535584">(</span><span class="string" id="7535585">&#34;expected&nbsp;URL&nbsp;%q;&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7535610">,</span>&nbsp;<span class="ident" id="7535612"><a href="/net/http/cgi/child_test.go.html#7535511">e</a></span><span class="op" id="7535613">,</span>&nbsp;<span class="ident" id="7535615"><a href="/net/http/cgi/child_test.go.html#7535508">g</a></span><span class="op" id="7535616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7535619">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7535622">if</span>&nbsp;<span class="ident" id="7535625">g</span><span class="op" id="7535626">,</span>&nbsp;<span class="ident" id="7535628">e</span>&nbsp;<span class="op" id="7535630">:=</span>&nbsp;<span class="ident" id="7535633"><a href="/net/http/cgi/child_test.go.html#7534722">req</a></span><span class="op" id="7535636">.</span><span class="ident" id="7535637">FormValue</span><span class="op" id="7535646">(</span><span class="string" id="7535647">&#34;a&#34;</span><span class="op" id="7535650">)</span><span class="op" id="7535651">,</span>&nbsp;<span class="string" id="7535653">&#34;b&#34;</span><span class="op" id="7535656">;</span>&nbsp;<span class="ident" id="7535658"><a href="/net/http/cgi/child_test.go.html#7535628">e</a></span>&nbsp;<span class="op" id="7535660">!=</span>&nbsp;<span class="ident" id="7535663"><a href="/net/http/cgi/child_test.go.html#7535625">g</a></span>&nbsp;<span class="op" id="7535665">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7535669"><a href="/net/http/cgi/child_test.go.html#7534356">t</a></span><span class="op" id="7535670">.</span><span class="ident" id="7535671">Errorf</span><span class="op" id="7535677">(</span><span class="string" id="7535678">&#34;expected&nbsp;FormValue(a)&nbsp;%q;&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7535712">,</span>&nbsp;<span class="ident" id="7535714"><a href="/net/http/cgi/child_test.go.html#7535628">e</a></span><span class="op" id="7535715">,</span>&nbsp;<span class="ident" id="7535717"><a href="/net/http/cgi/child_test.go.html#7535625">g</a></span><span class="op" id="7535718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7535721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7535724">if</span>&nbsp;<span class="ident" id="7535727"><a href="/net/http/cgi/child_test.go.html#7534722">req</a></span><span class="op" id="7535730">.</span><span class="ident" id="7535731">Trailer</span>&nbsp;<span class="op" id="7535739">==</span>&nbsp;<span class="ident" id="7535742">nil</span>&nbsp;<span class="op" id="7535746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7535750"><a href="/net/http/cgi/child_test.go.html#7534356">t</a></span><span class="op" id="7535751">.</span><span class="ident" id="7535752">Errorf</span><span class="op" id="7535758">(</span><span class="string" id="7535759">&#34;unexpected&nbsp;nil&nbsp;Trailer&#34;</span><span class="op" id="7535783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7535786">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7535789">if</span>&nbsp;<span class="ident" id="7535792"><a href="/net/http/cgi/child_test.go.html#7534722">req</a></span><span class="op" id="7535795">.</span><span class="ident" id="7535796">TLS</span>&nbsp;<span class="op" id="7535800">!=</span>&nbsp;<span class="ident" id="7535803">nil</span>&nbsp;<span class="op" id="7535807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7535811"><a href="/net/http/cgi/child_test.go.html#7534356">t</a></span><span class="op" id="7535812">.</span><span class="ident" id="7535813">Errorf</span><span class="op" id="7535819">(</span><span class="string" id="7535820">&#34;expected&nbsp;nil&nbsp;TLS&#34;</span><span class="op" id="7535838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7535841">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7535844">if</span>&nbsp;<span class="ident" id="7535847">e</span><span class="op" id="7535848">,</span>&nbsp;<span class="ident" id="7535850">g</span>&nbsp;<span class="op" id="7535852">:=</span>&nbsp;<span class="string" id="7535855">&#34;5.6.7.8:0&#34;</span><span class="op" id="7535866">,</span>&nbsp;<span class="ident" id="7535868"><a href="/net/http/cgi/child_test.go.html#7534722">req</a></span><span class="op" id="7535871">.</span><span class="ident" id="7535872">RemoteAddr</span><span class="op" id="7535882">;</span>&nbsp;<span class="ident" id="7535884"><a href="/net/http/cgi/child_test.go.html#7535847">e</a></span>&nbsp;<span class="op" id="7535886">!=</span>&nbsp;<span class="ident" id="7535889"><a href="/net/http/cgi/child_test.go.html#7535850">g</a></span>&nbsp;<span class="op" id="7535891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7535895"><a href="/net/http/cgi/child_test.go.html#7534356">t</a></span><span class="op" id="7535896">.</span><span class="ident" id="7535897">Errorf</span><span class="op" id="7535903">(</span><span class="string" id="7535904">&#34;RemoteAddr:&nbsp;got&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7535933">,</span>&nbsp;<span class="ident" id="7535935"><a href="/net/http/cgi/child_test.go.html#7535850">g</a></span><span class="op" id="7535936">,</span>&nbsp;<span class="ident" id="7535938"><a href="/net/http/cgi/child_test.go.html#7535847">e</a></span><span class="op" id="7535939">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7535942">}</span><br>
<span class="lineno"></span><span class="op" id="7535944">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7535947">func</span>&nbsp;<span class="ident" id="7535952">TestRequestWithTLS</span><span class="op" id="7535970">(</span><span class="ident" id="7535971">t</span>&nbsp;<span class="op" id="7535973">*</span><span class="ident" id="7535974"><a href="/net/http/cgi/child_test.go.html#7534326">testing</a></span><span class="op" id="7535981">.</span><span class="ident" id="7535982">T</span><span class="op" id="7535983">)</span>&nbsp;<span class="op" id="7535985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7535988">env</span>&nbsp;<span class="op" id="7535992">:=</span>&nbsp;<span class="keyword" id="7535995">map</span><span class="op" id="7535998">[</span><span class="builtintype" id="7535999">string</span><span class="op" id="7536005">]</span><span class="builtintype" id="7536006">string</span><span class="op" id="7536012">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7536016">&#34;SERVER_PROTOCOL&#34;</span><span class="op" id="7536033">:</span>&nbsp;<span class="string" id="7536035">&#34;HTTP/1.1&#34;</span><span class="op" id="7536045">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7536049">&#34;REQUEST_METHOD&#34;</span><span class="op" id="7536065">:</span>&nbsp;&nbsp;<span class="string" id="7536068">&#34;GET&#34;</span><span class="op" id="7536073">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7536077">&#34;HTTP_HOST&#34;</span><span class="op" id="7536088">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7536096">&#34;example.com&#34;</span><span class="op" id="7536109">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7536113">&#34;HTTP_REFERER&#34;</span><span class="op" id="7536127">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7536132">&#34;elsewhere&#34;</span><span class="op" id="7536143">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7536147">&#34;REQUEST_URI&#34;</span><span class="op" id="7536160">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7536166">&#34;/path?a=b&#34;</span><span class="op" id="7536177">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7536181">&#34;CONTENT_TYPE&#34;</span><span class="op" id="7536195">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7536200">&#34;text/xml&#34;</span><span class="op" id="7536210">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7536214">&#34;HTTPS&#34;</span><span class="op" id="7536221">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7536233">&#34;1&#34;</span><span class="op" id="7536236">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7536240">&#34;REMOTE_ADDR&#34;</span><span class="op" id="7536253">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7536259">&#34;5.6.7.8&#34;</span><span class="op" id="7536268">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7536271">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7536274">req</span><span class="op" id="7536277">,</span>&nbsp;<span class="ident" id="7536279">err</span>&nbsp;<span class="op" id="7536283">:=</span>&nbsp;<span class="ident" id="7536286"><a href="/net/http/cgi/child.go.html#5488266">RequestFromMap</a></span><span class="op" id="7536300">(</span><span class="ident" id="7536301"><a href="/net/http/cgi/child_test.go.html#7535988">env</a></span><span class="op" id="7536304">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7536307">if</span>&nbsp;<span class="ident" id="7536310"><a href="/net/http/cgi/child_test.go.html#7536279">err</a></span>&nbsp;<span class="op" id="7536314">!=</span>&nbsp;<span class="ident" id="7536317">nil</span>&nbsp;<span class="op" id="7536321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7536325"><a href="/net/http/cgi/child_test.go.html#7535971">t</a></span><span class="op" id="7536326">.</span><span class="ident" id="7536327">Fatalf</span><span class="op" id="7536333">(</span><span class="string" id="7536334">&#34;RequestFromMap:&nbsp;%v&#34;</span><span class="op" id="7536354">,</span>&nbsp;<span class="ident" id="7536356"><a href="/net/http/cgi/child_test.go.html#7536279">err</a></span><span class="op" id="7536359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7536362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7536365">if</span>&nbsp;<span class="ident" id="7536368">g</span><span class="op" id="7536369">,</span>&nbsp;<span class="ident" id="7536371">e</span>&nbsp;<span class="op" id="7536373">:=</span>&nbsp;<span class="ident" id="7536376"><a href="/net/http/cgi/child_test.go.html#7536274">req</a></span><span class="op" id="7536379">.</span><span class="ident" id="7536380">URL</span><span class="op" id="7536383">.</span><span class="ident" id="7536384">String</span><span class="op" id="7536390">(</span><span class="op" id="7536391">)</span><span class="op" id="7536392">,</span>&nbsp;<span class="string" id="7536394">&#34;https://example.com/path?a=b&#34;</span><span class="op" id="7536424">;</span>&nbsp;<span class="ident" id="7536426"><a href="/net/http/cgi/child_test.go.html#7536371">e</a></span>&nbsp;<span class="op" id="7536428">!=</span>&nbsp;<span class="ident" id="7536431"><a href="/net/http/cgi/child_test.go.html#7536368">g</a></span>&nbsp;<span class="op" id="7536433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7536437"><a href="/net/http/cgi/child_test.go.html#7535971">t</a></span><span class="op" id="7536438">.</span><span class="ident" id="7536439">Errorf</span><span class="op" id="7536445">(</span><span class="string" id="7536446">&#34;expected&nbsp;URL&nbsp;%q;&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7536471">,</span>&nbsp;<span class="ident" id="7536473"><a href="/net/http/cgi/child_test.go.html#7536371">e</a></span><span class="op" id="7536474">,</span>&nbsp;<span class="ident" id="7536476"><a href="/net/http/cgi/child_test.go.html#7536368">g</a></span><span class="op" id="7536477">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7536480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7536483">if</span>&nbsp;<span class="ident" id="7536486"><a href="/net/http/cgi/child_test.go.html#7536274">req</a></span><span class="op" id="7536489">.</span><span class="ident" id="7536490">TLS</span>&nbsp;<span class="op" id="7536494">==</span>&nbsp;<span class="ident" id="7536497">nil</span>&nbsp;<span class="op" id="7536501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7536505"><a href="/net/http/cgi/child_test.go.html#7535971">t</a></span><span class="op" id="7536506">.</span><span class="ident" id="7536507">Errorf</span><span class="op" id="7536513">(</span><span class="string" id="7536514">&#34;expected&nbsp;non-nil&nbsp;TLS&#34;</span><span class="op" id="7536536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7536539">}</span><br>
<span class="lineno"></span><span class="op" id="7536541">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="7536544">func</span>&nbsp;<span class="ident" id="7536549">TestRequestWithoutHost</span><span class="op" id="7536571">(</span><span class="ident" id="7536572">t</span>&nbsp;<span class="op" id="7536574">*</span><span class="ident" id="7536575"><a href="/net/http/cgi/child_test.go.html#7534326">testing</a></span><span class="op" id="7536582">.</span><span class="ident" id="7536583">T</span><span class="op" id="7536584">)</span>&nbsp;<span class="op" id="7536586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7536589">env</span>&nbsp;<span class="op" id="7536593">:=</span>&nbsp;<span class="keyword" id="7536596">map</span><span class="op" id="7536599">[</span><span class="builtintype" id="7536600">string</span><span class="op" id="7536606">]</span><span class="builtintype" id="7536607">string</span><span class="op" id="7536613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7536617">&#34;SERVER_PROTOCOL&#34;</span><span class="op" id="7536634">:</span>&nbsp;<span class="string" id="7536636">&#34;HTTP/1.1&#34;</span><span class="op" id="7536646">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7536650">&#34;HTTP_HOST&#34;</span><span class="op" id="7536661">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7536669">&#34;&#34;</span><span class="op" id="7536671">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7536675">&#34;REQUEST_METHOD&#34;</span><span class="op" id="7536691">:</span>&nbsp;&nbsp;<span class="string" id="7536694">&#34;GET&#34;</span><span class="op" id="7536699">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7536703">&#34;REQUEST_URI&#34;</span><span class="op" id="7536716">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7536722">&#34;/path?a=b&#34;</span><span class="op" id="7536733">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7536737">&#34;CONTENT_LENGTH&#34;</span><span class="op" id="7536753">:</span>&nbsp;&nbsp;<span class="string" id="7536756">&#34;123&#34;</span><span class="op" id="7536761">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7536764">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7536767">req</span><span class="op" id="7536770">,</span>&nbsp;<span class="ident" id="7536772">err</span>&nbsp;<span class="op" id="7536776">:=</span>&nbsp;<span class="ident" id="7536779"><a href="/net/http/cgi/child.go.html#5488266">RequestFromMap</a></span><span class="op" id="7536793">(</span><span class="ident" id="7536794"><a href="/net/http/cgi/child_test.go.html#7536589">env</a></span><span class="op" id="7536797">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7536800">if</span>&nbsp;<span class="ident" id="7536803"><a href="/net/http/cgi/child_test.go.html#7536772">err</a></span>&nbsp;<span class="op" id="7536807">!=</span>&nbsp;<span class="ident" id="7536810">nil</span>&nbsp;<span class="op" id="7536814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7536818"><a href="/net/http/cgi/child_test.go.html#7536572">t</a></span><span class="op" id="7536819">.</span><span class="ident" id="7536820">Fatalf</span><span class="op" id="7536826">(</span><span class="string" id="7536827">&#34;RequestFromMap:&nbsp;%v&#34;</span><span class="op" id="7536847">,</span>&nbsp;<span class="ident" id="7536849"><a href="/net/http/cgi/child_test.go.html#7536772">err</a></span><span class="op" id="7536852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7536855">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7536858">if</span>&nbsp;<span class="ident" id="7536861"><a href="/net/http/cgi/child_test.go.html#7536767">req</a></span><span class="op" id="7536864">.</span><span class="ident" id="7536865">URL</span>&nbsp;<span class="op" id="7536869">==</span>&nbsp;<span class="ident" id="7536872">nil</span>&nbsp;<span class="op" id="7536876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7536880"><a href="/net/http/cgi/child_test.go.html#7536572">t</a></span><span class="op" id="7536881">.</span><span class="ident" id="7536882">Fatalf</span><span class="op" id="7536888">(</span><span class="string" id="7536889">&#34;unexpected&nbsp;nil&nbsp;URL&#34;</span><span class="op" id="7536909">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7536912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7536915">if</span>&nbsp;<span class="ident" id="7536918">g</span><span class="op" id="7536919">,</span>&nbsp;<span class="ident" id="7536921">e</span>&nbsp;<span class="op" id="7536923">:=</span>&nbsp;<span class="ident" id="7536926"><a href="/net/http/cgi/child_test.go.html#7536767">req</a></span><span class="op" id="7536929">.</span><span class="ident" id="7536930">URL</span><span class="op" id="7536933">.</span><span class="ident" id="7536934">String</span><span class="op" id="7536940">(</span><span class="op" id="7536941">)</span><span class="op" id="7536942">,</span>&nbsp;<span class="string" id="7536944">&#34;/path?a=b&#34;</span><span class="op" id="7536955">;</span>&nbsp;<span class="ident" id="7536957"><a href="/net/http/cgi/child_test.go.html#7536921">e</a></span>&nbsp;<span class="op" id="7536959">!=</span>&nbsp;<span class="ident" id="7536962"><a href="/net/http/cgi/child_test.go.html#7536918">g</a></span>&nbsp;<span class="op" id="7536964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7536968"><a href="/net/http/cgi/child_test.go.html#7536572">t</a></span><span class="op" id="7536969">.</span><span class="ident" id="7536970">Errorf</span><span class="op" id="7536976">(</span><span class="string" id="7536977">&#34;URL&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7536996">,</span>&nbsp;<span class="ident" id="7536998"><a href="/net/http/cgi/child_test.go.html#7536918">g</a></span><span class="op" id="7536999">,</span>&nbsp;<span class="ident" id="7537001"><a href="/net/http/cgi/child_test.go.html#7536921">e</a></span><span class="op" id="7537002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7537005">}</span><br>
<span class="lineno"></span><span class="op" id="7537007">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="keyword" id="7537010">func</span>&nbsp;<span class="ident" id="7537015">TestRequestWithoutRequestURI</span><span class="op" id="7537043">(</span><span class="ident" id="7537044">t</span>&nbsp;<span class="op" id="7537046">*</span><span class="ident" id="7537047"><a href="/net/http/cgi/child_test.go.html#7534326">testing</a></span><span class="op" id="7537054">.</span><span class="ident" id="7537055">T</span><span class="op" id="7537056">)</span>&nbsp;<span class="op" id="7537058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7537061">env</span>&nbsp;<span class="op" id="7537065">:=</span>&nbsp;<span class="keyword" id="7537068">map</span><span class="op" id="7537071">[</span><span class="builtintype" id="7537072">string</span><span class="op" id="7537078">]</span><span class="builtintype" id="7537079">string</span><span class="op" id="7537085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7537089">&#34;SERVER_PROTOCOL&#34;</span><span class="op" id="7537106">:</span>&nbsp;<span class="string" id="7537108">&#34;HTTP/1.1&#34;</span><span class="op" id="7537118">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7537122">&#34;HTTP_HOST&#34;</span><span class="op" id="7537133">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7537141">&#34;example.com&#34;</span><span class="op" id="7537154">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7537158">&#34;REQUEST_METHOD&#34;</span><span class="op" id="7537174">:</span>&nbsp;&nbsp;<span class="string" id="7537177">&#34;GET&#34;</span><span class="op" id="7537182">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7537186">&#34;SCRIPT_NAME&#34;</span><span class="op" id="7537199">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7537205">&#34;/dir/scriptname&#34;</span><span class="op" id="7537222">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7537226">&#34;PATH_INFO&#34;</span><span class="op" id="7537237">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7537245">&#34;/p1/p2&#34;</span><span class="op" id="7537253">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7537257">&#34;QUERY_STRING&#34;</span><span class="op" id="7537271">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7537276">&#34;a=1&amp;b=2&#34;</span><span class="op" id="7537285">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7537289">&#34;CONTENT_LENGTH&#34;</span><span class="op" id="7537305">:</span>&nbsp;&nbsp;<span class="string" id="7537308">&#34;123&#34;</span><span class="op" id="7537313">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7537316">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7537319">req</span><span class="op" id="7537322">,</span>&nbsp;<span class="ident" id="7537324">err</span>&nbsp;<span class="op" id="7537328">:=</span>&nbsp;<span class="ident" id="7537331"><a href="/net/http/cgi/child.go.html#5488266">RequestFromMap</a></span><span class="op" id="7537345">(</span><span class="ident" id="7537346"><a href="/net/http/cgi/child_test.go.html#7537061">env</a></span><span class="op" id="7537349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7537352">if</span>&nbsp;<span class="ident" id="7537355"><a href="/net/http/cgi/child_test.go.html#7537324">err</a></span>&nbsp;<span class="op" id="7537359">!=</span>&nbsp;<span class="ident" id="7537362">nil</span>&nbsp;<span class="op" id="7537366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7537370"><a href="/net/http/cgi/child_test.go.html#7537044">t</a></span><span class="op" id="7537371">.</span><span class="ident" id="7537372">Fatalf</span><span class="op" id="7537378">(</span><span class="string" id="7537379">&#34;RequestFromMap:&nbsp;%v&#34;</span><span class="op" id="7537399">,</span>&nbsp;<span class="ident" id="7537401"><a href="/net/http/cgi/child_test.go.html#7537324">err</a></span><span class="op" id="7537404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7537407">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7537410">if</span>&nbsp;<span class="ident" id="7537413"><a href="/net/http/cgi/child_test.go.html#7537319">req</a></span><span class="op" id="7537416">.</span><span class="ident" id="7537417">URL</span>&nbsp;<span class="op" id="7537421">==</span>&nbsp;<span class="ident" id="7537424">nil</span>&nbsp;<span class="op" id="7537428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7537432"><a href="/net/http/cgi/child_test.go.html#7537044">t</a></span><span class="op" id="7537433">.</span><span class="ident" id="7537434">Fatalf</span><span class="op" id="7537440">(</span><span class="string" id="7537441">&#34;unexpected&nbsp;nil&nbsp;URL&#34;</span><span class="op" id="7537461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7537464">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7537467">if</span>&nbsp;<span class="ident" id="7537470">g</span><span class="op" id="7537471">,</span>&nbsp;<span class="ident" id="7537473">e</span>&nbsp;<span class="op" id="7537475">:=</span>&nbsp;<span class="ident" id="7537478"><a href="/net/http/cgi/child_test.go.html#7537319">req</a></span><span class="op" id="7537481">.</span><span class="ident" id="7537482">URL</span><span class="op" id="7537485">.</span><span class="ident" id="7537486">String</span><span class="op" id="7537492">(</span><span class="op" id="7537493">)</span><span class="op" id="7537494">,</span>&nbsp;<span class="string" id="7537496">&#34;http://example.com/dir/scriptname/p1/p2?a=1&amp;b=2&#34;</span><span class="op" id="7537545">;</span>&nbsp;<span class="ident" id="7537547"><a href="/net/http/cgi/child_test.go.html#7537473">e</a></span>&nbsp;<span class="op" id="7537549">!=</span>&nbsp;<span class="ident" id="7537552"><a href="/net/http/cgi/child_test.go.html#7537470">g</a></span>&nbsp;<span class="op" id="7537554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7537558"><a href="/net/http/cgi/child_test.go.html#7537044">t</a></span><span class="op" id="7537559">.</span><span class="ident" id="7537560">Errorf</span><span class="op" id="7537566">(</span><span class="string" id="7537567">&#34;URL&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7537586">,</span>&nbsp;<span class="ident" id="7537588"><a href="/net/http/cgi/child_test.go.html#7537470">g</a></span><span class="op" id="7537589">,</span>&nbsp;<span class="ident" id="7537591"><a href="/net/http/cgi/child_test.go.html#7537473">e</a></span><span class="op" id="7537592">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7537595">}</span><br>
<span class="lineno"></span><span class="op" id="7537597">}</span>
</div>
</body>
</html>
