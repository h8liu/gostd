<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/aes</h2>
<ul>
<li><a href="/gostd/crypto/aes/aes_test.go.html">aes_test.go</a></li>
<li><a href="/gostd/crypto/aes/block.go.html">block.go</a></li>
<li><a href="/gostd/crypto/aes/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/aes/cipher_asm.go.html" class="current">cipher_asm.go</a></li>
<li><a href="/gostd/crypto/aes/const.go.html">const.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4374121">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4374176">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4374230">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4374281">//&nbsp;+build&nbsp;amd64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4374298">package</span>&nbsp;<span class="ident" id="4374306">aes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4374311">//&nbsp;defined&nbsp;in&nbsp;asm_$GOARCH.s</span><br>
<span class="lineno">10</span><span class="keyword" id="4374339">func</span>&nbsp;<span class="ident" id="4374344">hasAsm</span><span class="op" id="4374350">(</span><span class="op" id="4374351">)</span>&nbsp;<span class="builtintype" id="4374353">bool</span><br>
<span class="lineno"></span><span class="keyword" id="4374358">func</span>&nbsp;<span class="ident" id="4374363">encryptBlockAsm</span><span class="op" id="4374378">(</span><span class="ident" id="4374379">nr</span>&nbsp;<span class="builtintype" id="4374382">int</span><span class="op" id="4374385">,</span>&nbsp;<span class="ident" id="4374387">xk</span>&nbsp;<span class="op" id="4374390">*</span><span class="builtintype" id="4374391">uint32</span><span class="op" id="4374397">,</span>&nbsp;<span class="ident" id="4374399">dst</span><span class="op" id="4374402">,</span>&nbsp;<span class="ident" id="4374404">src</span>&nbsp;<span class="op" id="4374408">*</span><span class="builtintype" id="4374409">byte</span><span class="op" id="4374413">)</span><br>
<span class="lineno"></span><span class="keyword" id="4374415">func</span>&nbsp;<span class="ident" id="4374420">decryptBlockAsm</span><span class="op" id="4374435">(</span><span class="ident" id="4374436">nr</span>&nbsp;<span class="builtintype" id="4374439">int</span><span class="op" id="4374442">,</span>&nbsp;<span class="ident" id="4374444">xk</span>&nbsp;<span class="op" id="4374447">*</span><span class="builtintype" id="4374448">uint32</span><span class="op" id="4374454">,</span>&nbsp;<span class="ident" id="4374456">dst</span><span class="op" id="4374459">,</span>&nbsp;<span class="ident" id="4374461">src</span>&nbsp;<span class="op" id="4374465">*</span><span class="builtintype" id="4374466">byte</span><span class="op" id="4374470">)</span><br>
<span class="lineno"></span><span class="keyword" id="4374472">func</span>&nbsp;<span class="ident" id="4374477">expandKeyAsm</span><span class="op" id="4374489">(</span><span class="ident" id="4374490">nr</span>&nbsp;<span class="builtintype" id="4374493">int</span><span class="op" id="4374496">,</span>&nbsp;<span class="ident" id="4374498">key</span>&nbsp;<span class="op" id="4374502">*</span><span class="builtintype" id="4374503">byte</span><span class="op" id="4374507">,</span>&nbsp;<span class="ident" id="4374509">enc</span>&nbsp;<span class="op" id="4374513">*</span><span class="builtintype" id="4374514">uint32</span><span class="op" id="4374520">,</span>&nbsp;<span class="ident" id="4374522">dec</span>&nbsp;<span class="op" id="4374526">*</span><span class="builtintype" id="4374527">uint32</span><span class="op" id="4374533">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="4374536">var</span>&nbsp;<span class="ident" id="4374540">useAsm</span>&nbsp;<span class="op" id="4374547">=</span>&nbsp;<span class="ident" id="4374549"><a href="/gostd/crypto/aes/cipher_asm.go.html#4374344">hasAsm</a></span><span class="op" id="4374555">(</span><span class="op" id="4374556">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4374559">func</span>&nbsp;<span class="ident" id="4374564">encryptBlock</span><span class="op" id="4374576">(</span><span class="ident" id="4374577">xk</span>&nbsp;<span class="op" id="4374580">[</span><span class="op" id="4374581">]</span><span class="builtintype" id="4374582">uint32</span><span class="op" id="4374588">,</span>&nbsp;<span class="ident" id="4374590">dst</span><span class="op" id="4374593">,</span>&nbsp;<span class="ident" id="4374595">src</span>&nbsp;<span class="op" id="4374599">[</span><span class="op" id="4374600">]</span><span class="builtintype" id="4374601">byte</span><span class="op" id="4374605">)</span>&nbsp;<span class="op" id="4374607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4374610">if</span>&nbsp;<span class="ident" id="4374613"><a href="/gostd/crypto/aes/cipher_asm.go.html#4374540">useAsm</a></span>&nbsp;<span class="op" id="4374620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4374624"><a href="/gostd/crypto/aes/cipher_asm.go.html#4374363">encryptBlockAsm</a></span><span class="op" id="4374639">(</span><span class="builtinfunc" id="4374640">len</span><span class="op" id="4374643">(</span><span class="ident" id="4374644"><a href="/gostd/crypto/aes/cipher_asm.go.html#4374577">xk</a></span><span class="op" id="4374646">)</span><span class="op" id="4374647">/</span><span class="num" id="4374648">4</span><span class="op" id="4374649">-</span><span class="num" id="4374650">1</span><span class="op" id="4374651">,</span>&nbsp;<span class="op" id="4374653">&amp;</span><span class="ident" id="4374654"><a href="/gostd/crypto/aes/cipher_asm.go.html#4374577">xk</a></span><span class="op" id="4374656">[</span><span class="num" id="4374657">0</span><span class="op" id="4374658">]</span><span class="op" id="4374659">,</span>&nbsp;<span class="op" id="4374661">&amp;</span><span class="ident" id="4374662"><a href="/gostd/crypto/aes/cipher_asm.go.html#4374590">dst</a></span><span class="op" id="4374665">[</span><span class="num" id="4374666">0</span><span class="op" id="4374667">]</span><span class="op" id="4374668">,</span>&nbsp;<span class="op" id="4374670">&amp;</span><span class="ident" id="4374671"><a href="/gostd/crypto/aes/cipher_asm.go.html#4374595">src</a></span><span class="op" id="4374674">[</span><span class="num" id="4374675">0</span><span class="op" id="4374676">]</span><span class="op" id="4374677">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4374680">}</span>&nbsp;<span class="keyword" id="4374682">else</span>&nbsp;<span class="op" id="4374687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4374691"><a href="/gostd/crypto/aes/block.go.html#4367154">encryptBlockGo</a></span><span class="op" id="4374705">(</span><span class="ident" id="4374706"><a href="/gostd/crypto/aes/cipher_asm.go.html#4374577">xk</a></span><span class="op" id="4374708">,</span>&nbsp;<span class="ident" id="4374710"><a href="/gostd/crypto/aes/cipher_asm.go.html#4374590">dst</a></span><span class="op" id="4374713">,</span>&nbsp;<span class="ident" id="4374715"><a href="/gostd/crypto/aes/cipher_asm.go.html#4374595">src</a></span><span class="op" id="4374718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4374721">}</span><br>
<span class="lineno"></span><span class="op" id="4374723">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="4374726">func</span>&nbsp;<span class="ident" id="4374731">decryptBlock</span><span class="op" id="4374743">(</span><span class="ident" id="4374744">xk</span>&nbsp;<span class="op" id="4374747">[</span><span class="op" id="4374748">]</span><span class="builtintype" id="4374749">uint32</span><span class="op" id="4374755">,</span>&nbsp;<span class="ident" id="4374757">dst</span><span class="op" id="4374760">,</span>&nbsp;<span class="ident" id="4374762">src</span>&nbsp;<span class="op" id="4374766">[</span><span class="op" id="4374767">]</span><span class="builtintype" id="4374768">byte</span><span class="op" id="4374772">)</span>&nbsp;<span class="op" id="4374774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4374777">if</span>&nbsp;<span class="ident" id="4374780"><a href="/gostd/crypto/aes/cipher_asm.go.html#4374540">useAsm</a></span>&nbsp;<span class="op" id="4374787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4374791"><a href="/gostd/crypto/aes/cipher_asm.go.html#4374420">decryptBlockAsm</a></span><span class="op" id="4374806">(</span><span class="builtinfunc" id="4374807">len</span><span class="op" id="4374810">(</span><span class="ident" id="4374811"><a href="/gostd/crypto/aes/cipher_asm.go.html#4374744">xk</a></span><span class="op" id="4374813">)</span><span class="op" id="4374814">/</span><span class="num" id="4374815">4</span><span class="op" id="4374816">-</span><span class="num" id="4374817">1</span><span class="op" id="4374818">,</span>&nbsp;<span class="op" id="4374820">&amp;</span><span class="ident" id="4374821"><a href="/gostd/crypto/aes/cipher_asm.go.html#4374744">xk</a></span><span class="op" id="4374823">[</span><span class="num" id="4374824">0</span><span class="op" id="4374825">]</span><span class="op" id="4374826">,</span>&nbsp;<span class="op" id="4374828">&amp;</span><span class="ident" id="4374829"><a href="/gostd/crypto/aes/cipher_asm.go.html#4374757">dst</a></span><span class="op" id="4374832">[</span><span class="num" id="4374833">0</span><span class="op" id="4374834">]</span><span class="op" id="4374835">,</span>&nbsp;<span class="op" id="4374837">&amp;</span><span class="ident" id="4374838"><a href="/gostd/crypto/aes/cipher_asm.go.html#4374762">src</a></span><span class="op" id="4374841">[</span><span class="num" id="4374842">0</span><span class="op" id="4374843">]</span><span class="op" id="4374844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4374847">}</span>&nbsp;<span class="keyword" id="4374849">else</span>&nbsp;<span class="op" id="4374854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4374858"><a href="/gostd/crypto/aes/block.go.html#4369313">decryptBlockGo</a></span><span class="op" id="4374872">(</span><span class="ident" id="4374873"><a href="/gostd/crypto/aes/cipher_asm.go.html#4374744">xk</a></span><span class="op" id="4374875">,</span>&nbsp;<span class="ident" id="4374877"><a href="/gostd/crypto/aes/cipher_asm.go.html#4374757">dst</a></span><span class="op" id="4374880">,</span>&nbsp;<span class="ident" id="4374882"><a href="/gostd/crypto/aes/cipher_asm.go.html#4374762">src</a></span><span class="op" id="4374885">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4374888">}</span><br>
<span class="lineno"></span><span class="op" id="4374890">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4374893">func</span>&nbsp;<span class="ident" id="4374898">expandKey</span><span class="op" id="4374907">(</span><span class="ident" id="4374908">key</span>&nbsp;<span class="op" id="4374912">[</span><span class="op" id="4374913">]</span><span class="builtintype" id="4374914">byte</span><span class="op" id="4374918">,</span>&nbsp;<span class="ident" id="4374920">enc</span><span class="op" id="4374923">,</span>&nbsp;<span class="ident" id="4374925">dec</span>&nbsp;<span class="op" id="4374929">[</span><span class="op" id="4374930">]</span><span class="builtintype" id="4374931">uint32</span><span class="op" id="4374937">)</span>&nbsp;<span class="op" id="4374939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4374942">if</span>&nbsp;<span class="ident" id="4374945"><a href="/gostd/crypto/aes/cipher_asm.go.html#4374540">useAsm</a></span>&nbsp;<span class="op" id="4374952">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4374956">rounds</span>&nbsp;<span class="op" id="4374963">:=</span>&nbsp;<span class="num" id="4374966">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4374971">switch</span>&nbsp;<span class="builtinfunc" id="4374978">len</span><span class="op" id="4374981">(</span><span class="ident" id="4374982"><a href="/gostd/crypto/aes/cipher_asm.go.html#4374908">key</a></span><span class="op" id="4374985">)</span>&nbsp;<span class="op" id="4374987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4374991">case</span>&nbsp;<span class="num" id="4374996">128</span>&nbsp;<span class="op" id="4375000">/</span>&nbsp;<span class="num" id="4375002">8</span><span class="op" id="4375003">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4375008"><a href="/gostd/crypto/aes/cipher_asm.go.html#4374956">rounds</a></span>&nbsp;<span class="op" id="4375015">=</span>&nbsp;<span class="num" id="4375017">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4375022">case</span>&nbsp;<span class="num" id="4375027">192</span>&nbsp;<span class="op" id="4375031">/</span>&nbsp;<span class="num" id="4375033">8</span><span class="op" id="4375034">:</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4375039"><a href="/gostd/crypto/aes/cipher_asm.go.html#4374956">rounds</a></span>&nbsp;<span class="op" id="4375046">=</span>&nbsp;<span class="num" id="4375048">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4375053">case</span>&nbsp;<span class="num" id="4375058">256</span>&nbsp;<span class="op" id="4375062">/</span>&nbsp;<span class="num" id="4375064">8</span><span class="op" id="4375065">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4375070"><a href="/gostd/crypto/aes/cipher_asm.go.html#4374956">rounds</a></span>&nbsp;<span class="op" id="4375077">=</span>&nbsp;<span class="num" id="4375079">14</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4375084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4375088"><a href="/gostd/crypto/aes/cipher_asm.go.html#4374477">expandKeyAsm</a></span><span class="op" id="4375100">(</span><span class="ident" id="4375101"><a href="/gostd/crypto/aes/cipher_asm.go.html#4374956">rounds</a></span><span class="op" id="4375107">,</span>&nbsp;<span class="op" id="4375109">&amp;</span><span class="ident" id="4375110"><a href="/gostd/crypto/aes/cipher_asm.go.html#4374908">key</a></span><span class="op" id="4375113">[</span><span class="num" id="4375114">0</span><span class="op" id="4375115">]</span><span class="op" id="4375116">,</span>&nbsp;<span class="op" id="4375118">&amp;</span><span class="ident" id="4375119"><a href="/gostd/crypto/aes/cipher_asm.go.html#4374920">enc</a></span><span class="op" id="4375122">[</span><span class="num" id="4375123">0</span><span class="op" id="4375124">]</span><span class="op" id="4375125">,</span>&nbsp;<span class="op" id="4375127">&amp;</span><span class="ident" id="4375128"><a href="/gostd/crypto/aes/cipher_asm.go.html#4374925">dec</a></span><span class="op" id="4375131">[</span><span class="num" id="4375132">0</span><span class="op" id="4375133">]</span><span class="op" id="4375134">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4375137">}</span>&nbsp;<span class="keyword" id="4375139">else</span>&nbsp;<span class="op" id="4375144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4375148"><a href="/gostd/crypto/aes/block.go.html#4371753">expandKeyGo</a></span><span class="op" id="4375159">(</span><span class="ident" id="4375160"><a href="/gostd/crypto/aes/cipher_asm.go.html#4374908">key</a></span><span class="op" id="4375163">,</span>&nbsp;<span class="ident" id="4375165"><a href="/gostd/crypto/aes/cipher_asm.go.html#4374920">enc</a></span><span class="op" id="4375168">,</span>&nbsp;<span class="ident" id="4375170"><a href="/gostd/crypto/aes/cipher_asm.go.html#4374925">dec</a></span><span class="op" id="4375173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4375176">}</span><br>
<span class="lineno"></span><span class="op" id="4375178">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
