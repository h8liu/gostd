<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>os</h2>
<ul>
<li><a href="/gostd/os/dir_unix.go.html">dir_unix.go</a></li>
<li><a href="/gostd/os/doc.go.html">doc.go</a></li>
<li><a href="/gostd/os/env.go.html">env.go</a></li>
<li><a href="/gostd/os/env_test.go.html">env_test.go</a></li>
<li><a href="/gostd/os/env_unix_test.go.html">env_unix_test.go</a></li>
<li><a href="/gostd/os/error.go.html">error.go</a></li>
<li><a href="/gostd/os/error_test.go.html">error_test.go</a></li>
<li><a href="/gostd/os/error_unix.go.html">error_unix.go</a></li>
<li><a href="/gostd/os/exec.go.html">exec.go</a></li>
<li><a href="/gostd/os/exec_posix.go.html">exec_posix.go</a></li>
<li><a href="/gostd/os/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/os/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/os/file.go.html">file.go</a></li>
<li><a href="/gostd/os/file_posix.go.html">file_posix.go</a></li>
<li><a href="/gostd/os/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/os/getwd.go.html">getwd.go</a></li>
<li><a href="/gostd/os/os_test.go.html">os_test.go</a></li>
<li><a href="/gostd/os/os_unix_test.go.html">os_unix_test.go</a></li>
<li><a href="/gostd/os/path.go.html">path.go</a></li>
<li><a href="/gostd/os/path_test.go.html">path_test.go</a></li>
<li><a href="/gostd/os/path_unix.go.html">path_unix.go</a></li>
<li><a href="/gostd/os/pipe_linux.go.html">pipe_linux.go</a></li>
<li><a href="/gostd/os/proc.go.html">proc.go</a></li>
<li><a href="/gostd/os/stat_linux.go.html">stat_linux.go</a></li>
<li><a href="/gostd/os/sys_linux.go.html">sys_linux.go</a></li>
<li><a href="/gostd/os/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/os/types.go.html">types.go</a></li>
<li><a href="/gostd/os/types_notwin.go.html">types_notwin.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2352774">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2352829">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2352883">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2352934">package</span>&nbsp;<span class="ident" id="2352942">os</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2352946">import</span>&nbsp;<span class="op" id="2352953">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2352956">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2352967">&#34;time&#34;</span><br>
<span class="lineno">10</span><span class="op" id="2352974">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2352977">func</span>&nbsp;<span class="ident" id="2352982">sameFile</span><span class="op" id="2352990">(</span><span class="ident" id="2352991">fs1</span><span class="op" id="2352994">,</span>&nbsp;<span class="ident" id="2352996">fs2</span>&nbsp;<span class="op" id="2353000">*</span><span class="ident" id="2353001">fileStat</span><span class="op" id="2353009">)</span>&nbsp;<span class="builtintype" id="2353011">bool</span>&nbsp;<span class="op" id="2353016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2353019">stat1</span>&nbsp;<span class="op" id="2353025">:=</span>&nbsp;<span class="ident" id="2353028">fs1</span><span class="op" id="2353031">.</span><span class="ident" id="2353032">sys</span><span class="op" id="2353035">.</span><span class="op" id="2353036">(</span><span class="op" id="2353037">*</span><span class="ident" id="2353038">syscall</span><span class="op" id="2353045">.</span><span class="ident" id="2353046">Stat_t</span><span class="op" id="2353052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2353055">stat2</span>&nbsp;<span class="op" id="2353061">:=</span>&nbsp;<span class="ident" id="2353064">fs2</span><span class="op" id="2353067">.</span><span class="ident" id="2353068">sys</span><span class="op" id="2353071">.</span><span class="op" id="2353072">(</span><span class="op" id="2353073">*</span><span class="ident" id="2353074">syscall</span><span class="op" id="2353081">.</span><span class="ident" id="2353082">Stat_t</span><span class="op" id="2353088">)</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2353091">return</span>&nbsp;<span class="ident" id="2353098">stat1</span><span class="op" id="2353103">.</span><span class="ident" id="2353104">Dev</span>&nbsp;<span class="op" id="2353108">==</span>&nbsp;<span class="ident" id="2353111">stat2</span><span class="op" id="2353116">.</span><span class="ident" id="2353117">Dev</span>&nbsp;<span class="op" id="2353121">&amp;&amp;</span>&nbsp;<span class="ident" id="2353124">stat1</span><span class="op" id="2353129">.</span><span class="ident" id="2353130">Ino</span>&nbsp;<span class="op" id="2353134">==</span>&nbsp;<span class="ident" id="2353137">stat2</span><span class="op" id="2353142">.</span><span class="ident" id="2353143">Ino</span><br>
<span class="lineno"></span><span class="op" id="2353147">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2353150">func</span>&nbsp;<span class="ident" id="2353155">fileInfoFromStat</span><span class="op" id="2353171">(</span><span class="ident" id="2353172">st</span>&nbsp;<span class="op" id="2353175">*</span><span class="ident" id="2353176">syscall</span><span class="op" id="2353183">.</span><span class="ident" id="2353184">Stat_t</span><span class="op" id="2353190">,</span>&nbsp;<span class="ident" id="2353192">name</span>&nbsp;<span class="builtintype" id="2353197">string</span><span class="op" id="2353203">)</span>&nbsp;<span class="ident" id="2353205">FileInfo</span>&nbsp;<span class="op" id="2353214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2353217">fs</span>&nbsp;<span class="op" id="2353220">:=</span>&nbsp;<span class="op" id="2353223">&amp;</span><span class="ident" id="2353224">fileStat</span><span class="op" id="2353232">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2353236">name</span><span class="op" id="2353240">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2353245">basename</span><span class="op" id="2353253">(</span><span class="ident" id="2353254">name</span><span class="op" id="2353258">)</span><span class="op" id="2353259">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2353263">size</span><span class="op" id="2353267">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2353272">int64</span><span class="op" id="2353277">(</span><span class="ident" id="2353278">st</span><span class="op" id="2353280">.</span><span class="ident" id="2353281">Size</span><span class="op" id="2353285">)</span><span class="op" id="2353286">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2353290">modTime</span><span class="op" id="2353297">:</span>&nbsp;<span class="ident" id="2353299">timespecToTime</span><span class="op" id="2353313">(</span><span class="ident" id="2353314">st</span><span class="op" id="2353316">.</span><span class="ident" id="2353317">Mtim</span><span class="op" id="2353321">)</span><span class="op" id="2353322">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2353326">sys</span><span class="op" id="2353329">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2353335">st</span><span class="op" id="2353337">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2353340">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2353343">fs</span><span class="op" id="2353345">.</span><span class="ident" id="2353346">mode</span>&nbsp;<span class="op" id="2353351">=</span>&nbsp;<span class="ident" id="2353353">FileMode</span><span class="op" id="2353361">(</span><span class="ident" id="2353362">st</span><span class="op" id="2353364">.</span><span class="ident" id="2353365">Mode</span>&nbsp;<span class="op" id="2353370">&amp;</span>&nbsp;<span class="num" id="2353372">0777</span><span class="op" id="2353376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2353379">switch</span>&nbsp;<span class="ident" id="2353386">st</span><span class="op" id="2353388">.</span><span class="ident" id="2353389">Mode</span>&nbsp;<span class="op" id="2353394">&amp;</span>&nbsp;<span class="ident" id="2353396">syscall</span><span class="op" id="2353403">.</span><span class="ident" id="2353404">S_IFMT</span>&nbsp;<span class="op" id="2353411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2353414">case</span>&nbsp;<span class="ident" id="2353419">syscall</span><span class="op" id="2353426">.</span><span class="ident" id="2353427">S_IFBLK</span><span class="op" id="2353434">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2353438">fs</span><span class="op" id="2353440">.</span><span class="ident" id="2353441">mode</span>&nbsp;<span class="op" id="2353446">|=</span>&nbsp;<span class="ident" id="2353449">ModeDevice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2353461">case</span>&nbsp;<span class="ident" id="2353466">syscall</span><span class="op" id="2353473">.</span><span class="ident" id="2353474">S_IFCHR</span><span class="op" id="2353481">:</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2353485">fs</span><span class="op" id="2353487">.</span><span class="ident" id="2353488">mode</span>&nbsp;<span class="op" id="2353493">|=</span>&nbsp;<span class="ident" id="2353496">ModeDevice</span>&nbsp;<span class="op" id="2353507">|</span>&nbsp;<span class="ident" id="2353509">ModeCharDevice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2353525">case</span>&nbsp;<span class="ident" id="2353530">syscall</span><span class="op" id="2353537">.</span><span class="ident" id="2353538">S_IFDIR</span><span class="op" id="2353545">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2353549">fs</span><span class="op" id="2353551">.</span><span class="ident" id="2353552">mode</span>&nbsp;<span class="op" id="2353557">|=</span>&nbsp;<span class="ident" id="2353560">ModeDir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2353569">case</span>&nbsp;<span class="ident" id="2353574">syscall</span><span class="op" id="2353581">.</span><span class="ident" id="2353582">S_IFIFO</span><span class="op" id="2353589">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2353593">fs</span><span class="op" id="2353595">.</span><span class="ident" id="2353596">mode</span>&nbsp;<span class="op" id="2353601">|=</span>&nbsp;<span class="ident" id="2353604">ModeNamedPipe</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2353619">case</span>&nbsp;<span class="ident" id="2353624">syscall</span><span class="op" id="2353631">.</span><span class="ident" id="2353632">S_IFLNK</span><span class="op" id="2353639">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2353643">fs</span><span class="op" id="2353645">.</span><span class="ident" id="2353646">mode</span>&nbsp;<span class="op" id="2353651">|=</span>&nbsp;<span class="ident" id="2353654">ModeSymlink</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2353667">case</span>&nbsp;<span class="ident" id="2353672">syscall</span><span class="op" id="2353679">.</span><span class="ident" id="2353680">S_IFREG</span><span class="op" id="2353687">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2353691">//&nbsp;nothing&nbsp;to&nbsp;do</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2353709">case</span>&nbsp;<span class="ident" id="2353714">syscall</span><span class="op" id="2353721">.</span><span class="ident" id="2353722">S_IFSOCK</span><span class="op" id="2353730">:</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2353734">fs</span><span class="op" id="2353736">.</span><span class="ident" id="2353737">mode</span>&nbsp;<span class="op" id="2353742">|=</span>&nbsp;<span class="ident" id="2353745">ModeSocket</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2353757">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2353760">if</span>&nbsp;<span class="ident" id="2353763">st</span><span class="op" id="2353765">.</span><span class="ident" id="2353766">Mode</span><span class="op" id="2353770">&amp;</span><span class="ident" id="2353771">syscall</span><span class="op" id="2353778">.</span><span class="ident" id="2353779">S_ISGID</span>&nbsp;<span class="op" id="2353787">!=</span>&nbsp;<span class="num" id="2353790">0</span>&nbsp;<span class="op" id="2353792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2353796">fs</span><span class="op" id="2353798">.</span><span class="ident" id="2353799">mode</span>&nbsp;<span class="op" id="2353804">|=</span>&nbsp;<span class="ident" id="2353807">ModeSetgid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2353819">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2353822">if</span>&nbsp;<span class="ident" id="2353825">st</span><span class="op" id="2353827">.</span><span class="ident" id="2353828">Mode</span><span class="op" id="2353832">&amp;</span><span class="ident" id="2353833">syscall</span><span class="op" id="2353840">.</span><span class="ident" id="2353841">S_ISUID</span>&nbsp;<span class="op" id="2353849">!=</span>&nbsp;<span class="num" id="2353852">0</span>&nbsp;<span class="op" id="2353854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2353858">fs</span><span class="op" id="2353860">.</span><span class="ident" id="2353861">mode</span>&nbsp;<span class="op" id="2353866">|=</span>&nbsp;<span class="ident" id="2353869">ModeSetuid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2353881">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2353884">if</span>&nbsp;<span class="ident" id="2353887">st</span><span class="op" id="2353889">.</span><span class="ident" id="2353890">Mode</span><span class="op" id="2353894">&amp;</span><span class="ident" id="2353895">syscall</span><span class="op" id="2353902">.</span><span class="ident" id="2353903">S_ISVTX</span>&nbsp;<span class="op" id="2353911">!=</span>&nbsp;<span class="num" id="2353914">0</span>&nbsp;<span class="op" id="2353916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2353920">fs</span><span class="op" id="2353922">.</span><span class="ident" id="2353923">mode</span>&nbsp;<span class="op" id="2353928">|=</span>&nbsp;<span class="ident" id="2353931">ModeSticky</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2353943">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2353946">return</span>&nbsp;<span class="ident" id="2353953">fs</span><br>
<span class="lineno"></span><span class="op" id="2353956">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2353959">func</span>&nbsp;<span class="ident" id="2353964">timespecToTime</span><span class="op" id="2353978">(</span><span class="ident" id="2353979">ts</span>&nbsp;<span class="ident" id="2353982">syscall</span><span class="op" id="2353989">.</span><span class="ident" id="2353990">Timespec</span><span class="op" id="2353998">)</span>&nbsp;<span class="ident" id="2354000">time</span><span class="op" id="2354004">.</span><span class="ident" id="2354005">Time</span>&nbsp;<span class="op" id="2354010">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2354013">return</span>&nbsp;<span class="ident" id="2354020">time</span><span class="op" id="2354024">.</span><span class="ident" id="2354025">Unix</span><span class="op" id="2354029">(</span><span class="ident" id="2354030">int64</span><span class="op" id="2354035">(</span><span class="ident" id="2354036">ts</span><span class="op" id="2354038">.</span><span class="ident" id="2354039">Sec</span><span class="op" id="2354042">)</span><span class="op" id="2354043">,</span>&nbsp;<span class="ident" id="2354045">int64</span><span class="op" id="2354050">(</span><span class="ident" id="2354051">ts</span><span class="op" id="2354053">.</span><span class="ident" id="2354054">Nsec</span><span class="op" id="2354058">)</span><span class="op" id="2354059">)</span><br>
<span class="lineno"></span><span class="op" id="2354061">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2354064">//&nbsp;For&nbsp;testing.</span><br>
<span class="lineno"></span><span class="keyword" id="2354080">func</span>&nbsp;<span class="ident" id="2354085">atime</span><span class="op" id="2354090">(</span><span class="ident" id="2354091">fi</span>&nbsp;<span class="ident" id="2354094">FileInfo</span><span class="op" id="2354102">)</span>&nbsp;<span class="ident" id="2354104">time</span><span class="op" id="2354108">.</span><span class="ident" id="2354109">Time</span>&nbsp;<span class="op" id="2354114">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2354117">return</span>&nbsp;<span class="ident" id="2354124">timespecToTime</span><span class="op" id="2354138">(</span><span class="ident" id="2354139">fi</span><span class="op" id="2354141">.</span><span class="ident" id="2354142">Sys</span><span class="op" id="2354145">(</span><span class="op" id="2354146">)</span><span class="op" id="2354147">.</span><span class="op" id="2354148">(</span><span class="op" id="2354149">*</span><span class="ident" id="2354150">syscall</span><span class="op" id="2354157">.</span><span class="ident" id="2354158">Stat_t</span><span class="op" id="2354164">)</span><span class="op" id="2354165">.</span><span class="ident" id="2354166">Atim</span><span class="op" id="2354170">)</span><br>
<span class="lineno"></span><span class="op" id="2354172">}</span>
</div>
</body>
</html>
