<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>time</h2>
<ul>
<li><a href="/gostd/time/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/time/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/time/format.go.html">format.go</a></li>
<li><a href="/gostd/time/format_test.go.html">format_test.go</a></li>
<li><a href="/gostd/time/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/time/sleep.go.html">sleep.go</a></li>
<li><a href="/gostd/time/sleep_test.go.html">sleep_test.go</a></li>
<li><a href="/gostd/time/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/time/tick.go.html">tick.go</a></li>
<li><a href="/gostd/time/tick_test.go.html">tick_test.go</a></li>
<li><a href="/gostd/time/time.go.html">time.go</a></li>
<li><a href="/gostd/time/time_test.go.html">time_test.go</a></li>
<li><a href="/gostd/time/zoneinfo.go.html" class="current">zoneinfo.go</a></li>
<li><a href="/gostd/time/zoneinfo_read.go.html">zoneinfo_read.go</a></li>
<li><a href="/gostd/time/zoneinfo_test.go.html">zoneinfo_test.go</a></li>
<li><a href="/gostd/time/zoneinfo_unix.go.html">zoneinfo_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2644354">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2644409">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2644463">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2644514">package</span>&nbsp;<span class="ident" id="2644522">time</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2644528">import</span>&nbsp;<span class="op" id="2644535">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2644538">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2644546">&#34;syscall&#34;</span><br>
<span class="lineno">10</span><span class="op" id="2644556">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2644559">//&nbsp;A&nbsp;Location&nbsp;maps&nbsp;time&nbsp;instants&nbsp;to&nbsp;the&nbsp;zone&nbsp;in&nbsp;use&nbsp;at&nbsp;that&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="2644625">//&nbsp;Typically,&nbsp;the&nbsp;Location&nbsp;represents&nbsp;the&nbsp;collection&nbsp;of&nbsp;time&nbsp;offsets</span><br>
<span class="lineno"></span><span class="comment" id="2644694">//&nbsp;in&nbsp;use&nbsp;in&nbsp;a&nbsp;geographical&nbsp;area,&nbsp;such&nbsp;as&nbsp;CEST&nbsp;and&nbsp;CET&nbsp;for&nbsp;central&nbsp;Europe.</span><br>
<span class="lineno">15</span><span class="keyword" id="2644769">type</span>&nbsp;<span class="ident" id="2644774">Location</span>&nbsp;<span class="keyword" id="2644783">struct</span>&nbsp;<span class="op" id="2644790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2644793">name</span>&nbsp;<span class="builtintype" id="2644798">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2644806">zone</span>&nbsp;<span class="op" id="2644811">[</span><span class="op" id="2644812">]</span><span class="ident" id="2644813">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2644819">tx</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2644824">[</span><span class="op" id="2644825">]</span><span class="ident" id="2644826">zoneTrans</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2644838">//&nbsp;Most&nbsp;lookups&nbsp;will&nbsp;be&nbsp;for&nbsp;the&nbsp;current&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2644885">//&nbsp;To&nbsp;avoid&nbsp;the&nbsp;binary&nbsp;search&nbsp;through&nbsp;tx,&nbsp;keep&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2644935">//&nbsp;static&nbsp;one-element&nbsp;cache&nbsp;that&nbsp;gives&nbsp;the&nbsp;correct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2644987">//&nbsp;zone&nbsp;for&nbsp;the&nbsp;time&nbsp;when&nbsp;the&nbsp;Location&nbsp;was&nbsp;created.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2645040">//&nbsp;if&nbsp;cacheStart&nbsp;&lt;=&nbsp;t&nbsp;&lt;=&nbsp;cacheEnd,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2645076">//&nbsp;lookup&nbsp;can&nbsp;return&nbsp;cacheZone.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2645109">//&nbsp;The&nbsp;units&nbsp;for&nbsp;cacheStart&nbsp;and&nbsp;cacheEnd&nbsp;are&nbsp;seconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2645163">//&nbsp;since&nbsp;January&nbsp;1,&nbsp;1970&nbsp;UTC,&nbsp;to&nbsp;match&nbsp;the&nbsp;argument</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2645216">//&nbsp;to&nbsp;lookup.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2645231">cacheStart</span>&nbsp;<span class="ident" id="2645242">int64</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2645249">cacheEnd</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2645260">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2645267">cacheZone</span>&nbsp;&nbsp;<span class="op" id="2645278">*</span><span class="ident" id="2645279">zone</span><br>
<span class="lineno"></span><span class="op" id="2645284">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2645287">//&nbsp;A&nbsp;zone&nbsp;represents&nbsp;a&nbsp;single&nbsp;time&nbsp;zone&nbsp;such&nbsp;as&nbsp;CEST&nbsp;or&nbsp;CET.</span><br>
<span class="lineno">35</span><span class="keyword" id="2645348">type</span>&nbsp;<span class="ident" id="2645353">zone</span>&nbsp;<span class="keyword" id="2645358">struct</span>&nbsp;<span class="op" id="2645365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2645368">name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2645375">string</span>&nbsp;<span class="comment" id="2645382">//&nbsp;abbreviated&nbsp;name,&nbsp;&#34;CET&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2645410">offset</span>&nbsp;<span class="builtintype" id="2645417">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2645424">//&nbsp;seconds&nbsp;east&nbsp;of&nbsp;UTC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2645448">isDST</span>&nbsp;&nbsp;<span class="builtintype" id="2645455">bool</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2645462">//&nbsp;is&nbsp;this&nbsp;zone&nbsp;Daylight&nbsp;Savings&nbsp;Time?</span><br>
<span class="lineno"></span><span class="op" id="2645501">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="2645504">//&nbsp;A&nbsp;zoneTrans&nbsp;represents&nbsp;a&nbsp;single&nbsp;time&nbsp;zone&nbsp;transition.</span><br>
<span class="lineno"></span><span class="keyword" id="2645561">type</span>&nbsp;<span class="ident" id="2645566">zoneTrans</span>&nbsp;<span class="keyword" id="2645576">struct</span>&nbsp;<span class="op" id="2645583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2645586">when</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2645599">int64</span>&nbsp;<span class="comment" id="2645605">//&nbsp;transition&nbsp;time,&nbsp;in&nbsp;seconds&nbsp;since&nbsp;1970&nbsp;GMT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2645652">index</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2645665">uint8</span>&nbsp;<span class="comment" id="2645671">//&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;zone&nbsp;that&nbsp;goes&nbsp;into&nbsp;effect&nbsp;at&nbsp;that&nbsp;time</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2645732">isstd</span><span class="op" id="2645737">,</span>&nbsp;<span class="ident" id="2645739">isutc</span>&nbsp;<span class="builtintype" id="2645745">bool</span>&nbsp;&nbsp;<span class="comment" id="2645751">//&nbsp;ignored&nbsp;-&nbsp;no&nbsp;idea&nbsp;what&nbsp;these&nbsp;mean</span><br>
<span class="lineno"></span><span class="op" id="2645788">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2645791">//&nbsp;alpha&nbsp;and&nbsp;omega&nbsp;are&nbsp;the&nbsp;beginning&nbsp;and&nbsp;end&nbsp;of&nbsp;time&nbsp;for&nbsp;zone</span><br>
<span class="lineno"></span><span class="comment" id="2645853">//&nbsp;transitions.</span><br>
<span class="lineno">50</span><span class="keyword" id="2645869">const</span>&nbsp;<span class="op" id="2645875">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2645878">alpha</span>&nbsp;<span class="op" id="2645884">=</span>&nbsp;<span class="op" id="2645886">-</span><span class="num" id="2645887">1</span>&nbsp;<span class="op" id="2645889">&lt;&lt;</span>&nbsp;<span class="num" id="2645892">63</span>&nbsp;&nbsp;<span class="comment" id="2645896">//&nbsp;math.MinInt64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2645914">omega</span>&nbsp;<span class="op" id="2645920">=</span>&nbsp;<span class="num" id="2645922">1</span><span class="op" id="2645923">&lt;&lt;</span><span class="num" id="2645925">63</span>&nbsp;<span class="op" id="2645928">-</span>&nbsp;<span class="num" id="2645930">1</span>&nbsp;<span class="comment" id="2645932">//&nbsp;math.MaxInt64</span><br>
<span class="lineno"></span><span class="op" id="2645949">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="comment" id="2645952">//&nbsp;UTC&nbsp;represents&nbsp;Universal&nbsp;Coordinated&nbsp;Time&nbsp;(UTC).</span><br>
<span class="lineno"></span><span class="keyword" id="2646004">var</span>&nbsp;<span class="ident" id="2646008">UTC</span>&nbsp;<span class="op" id="2646012">*</span><span class="ident" id="2646013">Location</span>&nbsp;<span class="op" id="2646022">=</span>&nbsp;<span class="op" id="2646024">&amp;</span><span class="ident" id="2646025">utcLoc</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2646033">//&nbsp;utcLoc&nbsp;is&nbsp;separate&nbsp;so&nbsp;that&nbsp;get&nbsp;can&nbsp;refer&nbsp;to&nbsp;&amp;utcLoc</span><br>
<span class="lineno"></span><span class="comment" id="2646088">//&nbsp;and&nbsp;ensure&nbsp;that&nbsp;it&nbsp;never&nbsp;returns&nbsp;a&nbsp;nil&nbsp;*Location,</span><br>
<span class="lineno">60</span><span class="comment" id="2646141">//&nbsp;even&nbsp;if&nbsp;a&nbsp;badly&nbsp;behaved&nbsp;client&nbsp;has&nbsp;changed&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="keyword" id="2646192">var</span>&nbsp;<span class="ident" id="2646196">utcLoc</span>&nbsp;<span class="op" id="2646203">=</span>&nbsp;<span class="ident" id="2646205">Location</span><span class="op" id="2646213">{</span><span class="ident" id="2646214">name</span><span class="op" id="2646218">:</span>&nbsp;<span class="string" id="2646220">&#34;UTC&#34;</span><span class="op" id="2646225">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2646228">//&nbsp;Local&nbsp;represents&nbsp;the&nbsp;system&#39;s&nbsp;local&nbsp;time&nbsp;zone.</span><br>
<span class="lineno"></span><span class="keyword" id="2646278">var</span>&nbsp;<span class="ident" id="2646282">Local</span>&nbsp;<span class="op" id="2646288">*</span><span class="ident" id="2646289">Location</span>&nbsp;<span class="op" id="2646298">=</span>&nbsp;<span class="op" id="2646300">&amp;</span><span class="ident" id="2646301">localLoc</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="comment" id="2646311">//&nbsp;localLoc&nbsp;is&nbsp;separate&nbsp;so&nbsp;that&nbsp;initLocal&nbsp;can&nbsp;initialize</span><br>
<span class="lineno"></span><span class="comment" id="2646368">//&nbsp;it&nbsp;even&nbsp;if&nbsp;a&nbsp;client&nbsp;has&nbsp;changed&nbsp;Local.</span><br>
<span class="lineno"></span><span class="keyword" id="2646410">var</span>&nbsp;<span class="ident" id="2646414">localLoc</span>&nbsp;<span class="ident" id="2646423">Location</span><br>
<span class="lineno"></span><span class="keyword" id="2646432">var</span>&nbsp;<span class="ident" id="2646436">localOnce</span>&nbsp;<span class="ident" id="2646446">sync</span><span class="op" id="2646450">.</span><span class="ident" id="2646451">Once</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="2646457">func</span>&nbsp;<span class="op" id="2646462">(</span><span class="ident" id="2646463">l</span>&nbsp;<span class="op" id="2646465">*</span><span class="ident" id="2646466">Location</span><span class="op" id="2646474">)</span>&nbsp;<span class="ident" id="2646476">get</span><span class="op" id="2646479">(</span><span class="op" id="2646480">)</span>&nbsp;<span class="op" id="2646482">*</span><span class="ident" id="2646483">Location</span>&nbsp;<span class="op" id="2646492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2646495">if</span>&nbsp;<span class="ident" id="2646498">l</span>&nbsp;<span class="op" id="2646500">==</span>&nbsp;<span class="ident" id="2646503">nil</span>&nbsp;<span class="op" id="2646507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2646511">return</span>&nbsp;<span class="op" id="2646518">&amp;</span><span class="ident" id="2646519">utcLoc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2646527">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2646530">if</span>&nbsp;<span class="ident" id="2646533">l</span>&nbsp;<span class="op" id="2646535">==</span>&nbsp;<span class="op" id="2646538">&amp;</span><span class="ident" id="2646539">localLoc</span>&nbsp;<span class="op" id="2646548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2646552">localOnce</span><span class="op" id="2646561">.</span><span class="ident" id="2646562">Do</span><span class="op" id="2646564">(</span><span class="ident" id="2646565">initLocal</span><span class="op" id="2646574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2646577">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2646580">return</span>&nbsp;<span class="ident" id="2646587">l</span><br>
<span class="lineno"></span><span class="op" id="2646589">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="2646592">//&nbsp;String&nbsp;returns&nbsp;a&nbsp;descriptive&nbsp;name&nbsp;for&nbsp;the&nbsp;time&nbsp;zone&nbsp;information,</span><br>
<span class="lineno"></span><span class="comment" id="2646660">//&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;argument&nbsp;to&nbsp;LoadLocation.</span><br>
<span class="lineno"></span><span class="keyword" id="2646710">func</span>&nbsp;<span class="op" id="2646715">(</span><span class="ident" id="2646716">l</span>&nbsp;<span class="op" id="2646718">*</span><span class="ident" id="2646719">Location</span><span class="op" id="2646727">)</span>&nbsp;<span class="ident" id="2646729">String</span><span class="op" id="2646735">(</span><span class="op" id="2646736">)</span>&nbsp;<span class="builtintype" id="2646738">string</span>&nbsp;<span class="op" id="2646745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2646748">return</span>&nbsp;<span class="ident" id="2646755">l</span><span class="op" id="2646756">.</span><span class="ident" id="2646757">get</span><span class="op" id="2646760">(</span><span class="op" id="2646761">)</span><span class="op" id="2646762">.</span><span class="ident" id="2646763">name</span><br>
<span class="lineno">85</span><span class="op" id="2646768">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2646771">//&nbsp;FixedZone&nbsp;returns&nbsp;a&nbsp;Location&nbsp;that&nbsp;always&nbsp;uses</span><br>
<span class="lineno"></span><span class="comment" id="2646820">//&nbsp;the&nbsp;given&nbsp;zone&nbsp;name&nbsp;and&nbsp;offset&nbsp;(seconds&nbsp;east&nbsp;of&nbsp;UTC).</span><br>
<span class="lineno"></span><span class="keyword" id="2646877">func</span>&nbsp;<span class="ident" id="2646882">FixedZone</span><span class="op" id="2646891">(</span><span class="ident" id="2646892">name</span>&nbsp;<span class="builtintype" id="2646897">string</span><span class="op" id="2646903">,</span>&nbsp;<span class="ident" id="2646905">offset</span>&nbsp;<span class="builtintype" id="2646912">int</span><span class="op" id="2646915">)</span>&nbsp;<span class="op" id="2646917">*</span><span class="ident" id="2646918">Location</span>&nbsp;<span class="op" id="2646927">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2646930">l</span>&nbsp;<span class="op" id="2646932">:=</span>&nbsp;<span class="op" id="2646935">&amp;</span><span class="ident" id="2646936">Location</span><span class="op" id="2646944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2646948">name</span><span class="op" id="2646952">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2646960">name</span><span class="op" id="2646964">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2646968">zone</span><span class="op" id="2646972">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2646980">[</span><span class="op" id="2646981">]</span><span class="ident" id="2646982">zone</span><span class="op" id="2646986">{</span><span class="op" id="2646987">{</span><span class="ident" id="2646988">name</span><span class="op" id="2646992">,</span>&nbsp;<span class="ident" id="2646994">offset</span><span class="op" id="2647000">,</span>&nbsp;<span class="builtintype" id="2647002">false</span><span class="op" id="2647007">}</span><span class="op" id="2647008">}</span><span class="op" id="2647009">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2647013">tx</span><span class="op" id="2647015">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2647025">[</span><span class="op" id="2647026">]</span><span class="ident" id="2647027">zoneTrans</span><span class="op" id="2647036">{</span><span class="op" id="2647037">{</span><span class="ident" id="2647038">alpha</span><span class="op" id="2647043">,</span>&nbsp;<span class="num" id="2647045">0</span><span class="op" id="2647046">,</span>&nbsp;<span class="builtintype" id="2647048">false</span><span class="op" id="2647053">,</span>&nbsp;<span class="builtintype" id="2647055">false</span><span class="op" id="2647060">}</span><span class="op" id="2647061">}</span><span class="op" id="2647062">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2647066">cacheStart</span><span class="op" id="2647076">:</span>&nbsp;<span class="ident" id="2647078">alpha</span><span class="op" id="2647083">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2647087">cacheEnd</span><span class="op" id="2647095">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2647099">omega</span><span class="op" id="2647104">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2647107">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2647110">l</span><span class="op" id="2647111">.</span><span class="ident" id="2647112">cacheZone</span>&nbsp;<span class="op" id="2647122">=</span>&nbsp;<span class="op" id="2647124">&amp;</span><span class="ident" id="2647125">l</span><span class="op" id="2647126">.</span><span class="ident" id="2647127">zone</span><span class="op" id="2647131">[</span><span class="num" id="2647132">0</span><span class="op" id="2647133">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2647136">return</span>&nbsp;<span class="ident" id="2647143">l</span><br>
<span class="lineno"></span><span class="op" id="2647145">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="2647148">//&nbsp;lookup&nbsp;returns&nbsp;information&nbsp;about&nbsp;the&nbsp;time&nbsp;zone&nbsp;in&nbsp;use&nbsp;at&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="2647211">//&nbsp;instant&nbsp;in&nbsp;time&nbsp;expressed&nbsp;as&nbsp;seconds&nbsp;since&nbsp;January&nbsp;1,&nbsp;1970&nbsp;00:00:00&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="comment" id="2647287">//</span><br>
<span class="lineno"></span><span class="comment" id="2647290">//&nbsp;The&nbsp;returned&nbsp;information&nbsp;gives&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;zone&nbsp;(such&nbsp;as&nbsp;&#34;CET&#34;),</span><br>
<span class="lineno">105</span><span class="comment" id="2647362">//&nbsp;the&nbsp;start&nbsp;and&nbsp;end&nbsp;times&nbsp;bracketing&nbsp;sec&nbsp;when&nbsp;that&nbsp;zone&nbsp;is&nbsp;in&nbsp;effect,</span><br>
<span class="lineno"></span><span class="comment" id="2647433">//&nbsp;the&nbsp;offset&nbsp;in&nbsp;seconds&nbsp;east&nbsp;of&nbsp;UTC&nbsp;(such&nbsp;as&nbsp;-5*60*60),&nbsp;and&nbsp;whether</span><br>
<span class="lineno"></span><span class="comment" id="2647502">//&nbsp;the&nbsp;daylight&nbsp;savings&nbsp;is&nbsp;being&nbsp;observed&nbsp;at&nbsp;that&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="2647558">func</span>&nbsp;<span class="op" id="2647563">(</span><span class="ident" id="2647564">l</span>&nbsp;<span class="op" id="2647566">*</span><span class="ident" id="2647567">Location</span><span class="op" id="2647575">)</span>&nbsp;<span class="ident" id="2647577">lookup</span><span class="op" id="2647583">(</span><span class="ident" id="2647584">sec</span>&nbsp;<span class="ident" id="2647588">int64</span><span class="op" id="2647593">)</span>&nbsp;<span class="op" id="2647595">(</span><span class="ident" id="2647596">name</span>&nbsp;<span class="builtintype" id="2647601">string</span><span class="op" id="2647607">,</span>&nbsp;<span class="ident" id="2647609">offset</span>&nbsp;<span class="builtintype" id="2647616">int</span><span class="op" id="2647619">,</span>&nbsp;<span class="ident" id="2647621">isDST</span>&nbsp;<span class="builtintype" id="2647627">bool</span><span class="op" id="2647631">,</span>&nbsp;<span class="ident" id="2647633">start</span><span class="op" id="2647638">,</span>&nbsp;<span class="ident" id="2647640">end</span>&nbsp;<span class="ident" id="2647644">int64</span><span class="op" id="2647649">)</span>&nbsp;<span class="op" id="2647651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2647654">l</span>&nbsp;<span class="op" id="2647656">=</span>&nbsp;<span class="ident" id="2647658">l</span><span class="op" id="2647659">.</span><span class="ident" id="2647660">get</span><span class="op" id="2647663">(</span><span class="op" id="2647664">)</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2647668">if</span>&nbsp;<span class="builtinfunc" id="2647671">len</span><span class="op" id="2647674">(</span><span class="ident" id="2647675">l</span><span class="op" id="2647676">.</span><span class="ident" id="2647677">zone</span><span class="op" id="2647681">)</span>&nbsp;<span class="op" id="2647683">==</span>&nbsp;<span class="num" id="2647686">0</span>&nbsp;<span class="op" id="2647688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2647692">name</span>&nbsp;<span class="op" id="2647697">=</span>&nbsp;<span class="string" id="2647699">&#34;UTC&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2647707">offset</span>&nbsp;<span class="op" id="2647714">=</span>&nbsp;<span class="num" id="2647716">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2647720">isDST</span>&nbsp;<span class="op" id="2647726">=</span>&nbsp;<span class="builtintype" id="2647728">false</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2647736">start</span>&nbsp;<span class="op" id="2647742">=</span>&nbsp;<span class="ident" id="2647744">alpha</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2647752">end</span>&nbsp;<span class="op" id="2647756">=</span>&nbsp;<span class="ident" id="2647758">omega</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2647766">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2647774">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2647778">if</span>&nbsp;<span class="ident" id="2647781">zone</span>&nbsp;<span class="op" id="2647786">:=</span>&nbsp;<span class="ident" id="2647789">l</span><span class="op" id="2647790">.</span><span class="ident" id="2647791">cacheZone</span><span class="op" id="2647800">;</span>&nbsp;<span class="ident" id="2647802">zone</span>&nbsp;<span class="op" id="2647807">!=</span>&nbsp;<span class="ident" id="2647810">nil</span>&nbsp;<span class="op" id="2647814">&amp;&amp;</span>&nbsp;<span class="ident" id="2647817">l</span><span class="op" id="2647818">.</span><span class="ident" id="2647819">cacheStart</span>&nbsp;<span class="op" id="2647830">&lt;=</span>&nbsp;<span class="ident" id="2647833">sec</span>&nbsp;<span class="op" id="2647837">&amp;&amp;</span>&nbsp;<span class="ident" id="2647840">sec</span>&nbsp;<span class="op" id="2647844">&lt;</span>&nbsp;<span class="ident" id="2647846">l</span><span class="op" id="2647847">.</span><span class="ident" id="2647848">cacheEnd</span>&nbsp;<span class="op" id="2647857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2647861">name</span>&nbsp;<span class="op" id="2647866">=</span>&nbsp;<span class="ident" id="2647868">zone</span><span class="op" id="2647872">.</span><span class="ident" id="2647873">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2647880">offset</span>&nbsp;<span class="op" id="2647887">=</span>&nbsp;<span class="ident" id="2647889">zone</span><span class="op" id="2647893">.</span><span class="ident" id="2647894">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2647903">isDST</span>&nbsp;<span class="op" id="2647909">=</span>&nbsp;<span class="ident" id="2647911">zone</span><span class="op" id="2647915">.</span><span class="ident" id="2647916">isDST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2647924">start</span>&nbsp;<span class="op" id="2647930">=</span>&nbsp;<span class="ident" id="2647932">l</span><span class="op" id="2647933">.</span><span class="ident" id="2647934">cacheStart</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2647947">end</span>&nbsp;<span class="op" id="2647951">=</span>&nbsp;<span class="ident" id="2647953">l</span><span class="op" id="2647954">.</span><span class="ident" id="2647955">cacheEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2647966">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2647974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2647978">if</span>&nbsp;<span class="builtinfunc" id="2647981">len</span><span class="op" id="2647984">(</span><span class="ident" id="2647985">l</span><span class="op" id="2647986">.</span><span class="ident" id="2647987">tx</span><span class="op" id="2647989">)</span>&nbsp;<span class="op" id="2647991">==</span>&nbsp;<span class="num" id="2647994">0</span>&nbsp;<span class="op" id="2647996">||</span>&nbsp;<span class="ident" id="2647999">sec</span>&nbsp;<span class="op" id="2648003">&lt;</span>&nbsp;<span class="ident" id="2648005">l</span><span class="op" id="2648006">.</span><span class="ident" id="2648007">tx</span><span class="op" id="2648009">[</span><span class="num" id="2648010">0</span><span class="op" id="2648011">]</span><span class="op" id="2648012">.</span><span class="ident" id="2648013">when</span>&nbsp;<span class="op" id="2648018">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2648022">zone</span>&nbsp;<span class="op" id="2648027">:=</span>&nbsp;<span class="op" id="2648030">&amp;</span><span class="ident" id="2648031">l</span><span class="op" id="2648032">.</span><span class="ident" id="2648033">zone</span><span class="op" id="2648037">[</span><span class="ident" id="2648038">l</span><span class="op" id="2648039">.</span><span class="ident" id="2648040">lookupFirstZone</span><span class="op" id="2648055">(</span><span class="op" id="2648056">)</span><span class="op" id="2648057">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2648061">name</span>&nbsp;<span class="op" id="2648066">=</span>&nbsp;<span class="ident" id="2648068">zone</span><span class="op" id="2648072">.</span><span class="ident" id="2648073">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2648080">offset</span>&nbsp;<span class="op" id="2648087">=</span>&nbsp;<span class="ident" id="2648089">zone</span><span class="op" id="2648093">.</span><span class="ident" id="2648094">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2648103">isDST</span>&nbsp;<span class="op" id="2648109">=</span>&nbsp;<span class="ident" id="2648111">zone</span><span class="op" id="2648115">.</span><span class="ident" id="2648116">isDST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2648124">start</span>&nbsp;<span class="op" id="2648130">=</span>&nbsp;<span class="ident" id="2648132">alpha</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2648140">if</span>&nbsp;<span class="builtinfunc" id="2648143">len</span><span class="op" id="2648146">(</span><span class="ident" id="2648147">l</span><span class="op" id="2648148">.</span><span class="ident" id="2648149">tx</span><span class="op" id="2648151">)</span>&nbsp;<span class="op" id="2648153">&gt;</span>&nbsp;<span class="num" id="2648155">0</span>&nbsp;<span class="op" id="2648157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2648162">end</span>&nbsp;<span class="op" id="2648166">=</span>&nbsp;<span class="ident" id="2648168">l</span><span class="op" id="2648169">.</span><span class="ident" id="2648170">tx</span><span class="op" id="2648172">[</span><span class="num" id="2648173">0</span><span class="op" id="2648174">]</span><span class="op" id="2648175">.</span><span class="ident" id="2648176">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2648183">}</span>&nbsp;<span class="keyword" id="2648185">else</span>&nbsp;<span class="op" id="2648190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2648195">end</span>&nbsp;<span class="op" id="2648199">=</span>&nbsp;<span class="ident" id="2648201">omega</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2648209">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2648213">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2648221">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2648225">//&nbsp;Binary&nbsp;search&nbsp;for&nbsp;entry&nbsp;with&nbsp;largest&nbsp;time&nbsp;&lt;=&nbsp;sec.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2648279">//&nbsp;Not&nbsp;using&nbsp;sort.Search&nbsp;to&nbsp;avoid&nbsp;dependencies.</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2648328">tx</span>&nbsp;<span class="op" id="2648331">:=</span>&nbsp;<span class="ident" id="2648334">l</span><span class="op" id="2648335">.</span><span class="ident" id="2648336">tx</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2648340">end</span>&nbsp;<span class="op" id="2648344">=</span>&nbsp;<span class="ident" id="2648346">omega</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2648353">lo</span>&nbsp;<span class="op" id="2648356">:=</span>&nbsp;<span class="num" id="2648359">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2648362">hi</span>&nbsp;<span class="op" id="2648365">:=</span>&nbsp;<span class="builtinfunc" id="2648368">len</span><span class="op" id="2648371">(</span><span class="ident" id="2648372">tx</span><span class="op" id="2648374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2648377">for</span>&nbsp;<span class="ident" id="2648381">hi</span><span class="op" id="2648383">-</span><span class="ident" id="2648384">lo</span>&nbsp;<span class="op" id="2648387">&gt;</span>&nbsp;<span class="num" id="2648389">1</span>&nbsp;<span class="op" id="2648391">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2648395">m</span>&nbsp;<span class="op" id="2648397">:=</span>&nbsp;<span class="ident" id="2648400">lo</span>&nbsp;<span class="op" id="2648403">+</span>&nbsp;<span class="op" id="2648405">(</span><span class="ident" id="2648406">hi</span><span class="op" id="2648408">-</span><span class="ident" id="2648409">lo</span><span class="op" id="2648411">)</span><span class="op" id="2648412">/</span><span class="num" id="2648413">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2648417">lim</span>&nbsp;<span class="op" id="2648421">:=</span>&nbsp;<span class="ident" id="2648424">tx</span><span class="op" id="2648426">[</span><span class="ident" id="2648427">m</span><span class="op" id="2648428">]</span><span class="op" id="2648429">.</span><span class="ident" id="2648430">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2648437">if</span>&nbsp;<span class="ident" id="2648440">sec</span>&nbsp;<span class="op" id="2648444">&lt;</span>&nbsp;<span class="ident" id="2648446">lim</span>&nbsp;<span class="op" id="2648450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2648455">end</span>&nbsp;<span class="op" id="2648459">=</span>&nbsp;<span class="ident" id="2648461">lim</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2648468">hi</span>&nbsp;<span class="op" id="2648471">=</span>&nbsp;<span class="ident" id="2648473">m</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2648477">}</span>&nbsp;<span class="keyword" id="2648479">else</span>&nbsp;<span class="op" id="2648484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2648489">lo</span>&nbsp;<span class="op" id="2648492">=</span>&nbsp;<span class="ident" id="2648494">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2648498">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2648501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2648504">zone</span>&nbsp;<span class="op" id="2648509">:=</span>&nbsp;<span class="op" id="2648512">&amp;</span><span class="ident" id="2648513">l</span><span class="op" id="2648514">.</span><span class="ident" id="2648515">zone</span><span class="op" id="2648519">[</span><span class="ident" id="2648520">tx</span><span class="op" id="2648522">[</span><span class="ident" id="2648523">lo</span><span class="op" id="2648525">]</span><span class="op" id="2648526">.</span><span class="ident" id="2648527">index</span><span class="op" id="2648532">]</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2648535">name</span>&nbsp;<span class="op" id="2648540">=</span>&nbsp;<span class="ident" id="2648542">zone</span><span class="op" id="2648546">.</span><span class="ident" id="2648547">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2648553">offset</span>&nbsp;<span class="op" id="2648560">=</span>&nbsp;<span class="ident" id="2648562">zone</span><span class="op" id="2648566">.</span><span class="ident" id="2648567">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2648575">isDST</span>&nbsp;<span class="op" id="2648581">=</span>&nbsp;<span class="ident" id="2648583">zone</span><span class="op" id="2648587">.</span><span class="ident" id="2648588">isDST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2648595">start</span>&nbsp;<span class="op" id="2648601">=</span>&nbsp;<span class="ident" id="2648603">tx</span><span class="op" id="2648605">[</span><span class="ident" id="2648606">lo</span><span class="op" id="2648608">]</span><span class="op" id="2648609">.</span><span class="ident" id="2648610">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2648616">//&nbsp;end&nbsp;=&nbsp;maintained&nbsp;during&nbsp;the&nbsp;search</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2648655">return</span><br>
<span class="lineno"></span><span class="op" id="2648662">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2648665">//&nbsp;lookupFirstZone&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;time&nbsp;zone&nbsp;to&nbsp;use&nbsp;for&nbsp;times</span><br>
<span class="lineno"></span><span class="comment" id="2648736">//&nbsp;before&nbsp;the&nbsp;first&nbsp;transition&nbsp;time,&nbsp;or&nbsp;when&nbsp;there&nbsp;are&nbsp;no&nbsp;transition</span><br>
<span class="lineno">170</span><span class="comment" id="2648805">//&nbsp;times.</span><br>
<span class="lineno"></span><span class="comment" id="2648815">//</span><br>
<span class="lineno"></span><span class="comment" id="2648818">//&nbsp;The&nbsp;reference&nbsp;implementation&nbsp;in&nbsp;localtime.c&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="2648870">//&nbsp;http://www.iana.org/time-zones/repository/releases/tzcode2013g.tar.gz</span><br>
<span class="lineno"></span><span class="comment" id="2648943">//&nbsp;implements&nbsp;the&nbsp;following&nbsp;algorithm&nbsp;for&nbsp;these&nbsp;cases:</span><br>
<span class="lineno">175</span><span class="comment" id="2648998">//&nbsp;1)&nbsp;If&nbsp;the&nbsp;first&nbsp;zone&nbsp;is&nbsp;unused&nbsp;by&nbsp;the&nbsp;transitions,&nbsp;use&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="2649060">//&nbsp;2)&nbsp;Otherwise,&nbsp;if&nbsp;there&nbsp;are&nbsp;transition&nbsp;times,&nbsp;and&nbsp;the&nbsp;first</span><br>
<span class="lineno"></span><span class="comment" id="2649122">//&nbsp;&nbsp;&nbsp;&nbsp;transition&nbsp;is&nbsp;to&nbsp;a&nbsp;zone&nbsp;in&nbsp;daylight&nbsp;time,&nbsp;find&nbsp;the&nbsp;first</span><br>
<span class="lineno"></span><span class="comment" id="2649185">//&nbsp;&nbsp;&nbsp;&nbsp;non-daylight-time&nbsp;zone&nbsp;before&nbsp;and&nbsp;closest&nbsp;to&nbsp;the&nbsp;first&nbsp;transition</span><br>
<span class="lineno"></span><span class="comment" id="2649257">//&nbsp;&nbsp;&nbsp;&nbsp;zone.</span><br>
<span class="lineno">180</span><span class="comment" id="2649269">//&nbsp;3)&nbsp;Otherwise,&nbsp;use&nbsp;the&nbsp;first&nbsp;zone&nbsp;that&nbsp;is&nbsp;not&nbsp;daylight&nbsp;time,&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="2649335">//&nbsp;&nbsp;&nbsp;&nbsp;there&nbsp;is&nbsp;one.</span><br>
<span class="lineno"></span><span class="comment" id="2649355">//&nbsp;4)&nbsp;Otherwise,&nbsp;use&nbsp;the&nbsp;first&nbsp;zone.</span><br>
<span class="lineno"></span><span class="keyword" id="2649392">func</span>&nbsp;<span class="op" id="2649397">(</span><span class="ident" id="2649398">l</span>&nbsp;<span class="op" id="2649400">*</span><span class="ident" id="2649401">Location</span><span class="op" id="2649409">)</span>&nbsp;<span class="ident" id="2649411">lookupFirstZone</span><span class="op" id="2649426">(</span><span class="op" id="2649427">)</span>&nbsp;<span class="builtintype" id="2649429">int</span>&nbsp;<span class="op" id="2649433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2649436">//&nbsp;Case&nbsp;1.</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2649448">if</span>&nbsp;<span class="op" id="2649451">!</span><span class="ident" id="2649452">l</span><span class="op" id="2649453">.</span><span class="ident" id="2649454">firstZoneUsed</span><span class="op" id="2649467">(</span><span class="op" id="2649468">)</span>&nbsp;<span class="op" id="2649470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2649474">return</span>&nbsp;<span class="num" id="2649481">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2649484">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2649488">//&nbsp;Case&nbsp;2.</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2649500">if</span>&nbsp;<span class="builtinfunc" id="2649503">len</span><span class="op" id="2649506">(</span><span class="ident" id="2649507">l</span><span class="op" id="2649508">.</span><span class="ident" id="2649509">tx</span><span class="op" id="2649511">)</span>&nbsp;<span class="op" id="2649513">&gt;</span>&nbsp;<span class="num" id="2649515">0</span>&nbsp;<span class="op" id="2649517">&amp;&amp;</span>&nbsp;<span class="ident" id="2649520">l</span><span class="op" id="2649521">.</span><span class="ident" id="2649522">zone</span><span class="op" id="2649526">[</span><span class="ident" id="2649527">l</span><span class="op" id="2649528">.</span><span class="ident" id="2649529">tx</span><span class="op" id="2649531">[</span><span class="num" id="2649532">0</span><span class="op" id="2649533">]</span><span class="op" id="2649534">.</span><span class="ident" id="2649535">index</span><span class="op" id="2649540">]</span><span class="op" id="2649541">.</span><span class="ident" id="2649542">isDST</span>&nbsp;<span class="op" id="2649548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2649552">for</span>&nbsp;<span class="ident" id="2649556">zi</span>&nbsp;<span class="op" id="2649559">:=</span>&nbsp;<span class="builtintype" id="2649562">int</span><span class="op" id="2649565">(</span><span class="ident" id="2649566">l</span><span class="op" id="2649567">.</span><span class="ident" id="2649568">tx</span><span class="op" id="2649570">[</span><span class="num" id="2649571">0</span><span class="op" id="2649572">]</span><span class="op" id="2649573">.</span><span class="ident" id="2649574">index</span><span class="op" id="2649579">)</span>&nbsp;<span class="op" id="2649581">-</span>&nbsp;<span class="num" id="2649583">1</span><span class="op" id="2649584">;</span>&nbsp;<span class="ident" id="2649586">zi</span>&nbsp;<span class="op" id="2649589">&gt;=</span>&nbsp;<span class="num" id="2649592">0</span><span class="op" id="2649593">;</span>&nbsp;<span class="ident" id="2649595">zi</span><span class="op" id="2649597">--</span>&nbsp;<span class="op" id="2649600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2649605">if</span>&nbsp;<span class="op" id="2649608">!</span><span class="ident" id="2649609">l</span><span class="op" id="2649610">.</span><span class="ident" id="2649611">zone</span><span class="op" id="2649615">[</span><span class="ident" id="2649616">zi</span><span class="op" id="2649618">]</span><span class="op" id="2649619">.</span><span class="ident" id="2649620">isDST</span>&nbsp;<span class="op" id="2649626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2649632">return</span>&nbsp;<span class="ident" id="2649639">zi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2649645">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2649649">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2649652">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2649656">//&nbsp;Case&nbsp;3.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2649668">for</span>&nbsp;<span class="ident" id="2649672">zi</span>&nbsp;<span class="op" id="2649675">:=</span>&nbsp;<span class="keyword" id="2649678">range</span>&nbsp;<span class="ident" id="2649684">l</span><span class="op" id="2649685">.</span><span class="ident" id="2649686">zone</span>&nbsp;<span class="op" id="2649691">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2649695">if</span>&nbsp;<span class="op" id="2649698">!</span><span class="ident" id="2649699">l</span><span class="op" id="2649700">.</span><span class="ident" id="2649701">zone</span><span class="op" id="2649705">[</span><span class="ident" id="2649706">zi</span><span class="op" id="2649708">]</span><span class="op" id="2649709">.</span><span class="ident" id="2649710">isDST</span>&nbsp;<span class="op" id="2649716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2649721">return</span>&nbsp;<span class="ident" id="2649728">zi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2649733">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2649736">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2649740">//&nbsp;Case&nbsp;4.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2649752">return</span>&nbsp;<span class="num" id="2649759">0</span><br>
<span class="lineno"></span><span class="op" id="2649761">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2649764">//&nbsp;firstZoneUsed&nbsp;returns&nbsp;whether&nbsp;the&nbsp;first&nbsp;zone&nbsp;is&nbsp;used&nbsp;by&nbsp;some</span><br>
<span class="lineno">210</span><span class="comment" id="2649828">//&nbsp;transition.</span><br>
<span class="lineno"></span><span class="keyword" id="2649843">func</span>&nbsp;<span class="op" id="2649848">(</span><span class="ident" id="2649849">l</span>&nbsp;<span class="op" id="2649851">*</span><span class="ident" id="2649852">Location</span><span class="op" id="2649860">)</span>&nbsp;<span class="ident" id="2649862">firstZoneUsed</span><span class="op" id="2649875">(</span><span class="op" id="2649876">)</span>&nbsp;<span class="builtintype" id="2649878">bool</span>&nbsp;<span class="op" id="2649883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2649886">for</span>&nbsp;<span class="ident" id="2649890">_</span><span class="op" id="2649891">,</span>&nbsp;<span class="ident" id="2649893">tx</span>&nbsp;<span class="op" id="2649896">:=</span>&nbsp;<span class="keyword" id="2649899">range</span>&nbsp;<span class="ident" id="2649905">l</span><span class="op" id="2649906">.</span><span class="ident" id="2649907">tx</span>&nbsp;<span class="op" id="2649910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2649914">if</span>&nbsp;<span class="ident" id="2649917">tx</span><span class="op" id="2649919">.</span><span class="ident" id="2649920">index</span>&nbsp;<span class="op" id="2649926">==</span>&nbsp;<span class="num" id="2649929">0</span>&nbsp;<span class="op" id="2649931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2649936">return</span>&nbsp;<span class="builtintype" id="2649943">true</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2649950">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2649953">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2649956">return</span>&nbsp;<span class="builtintype" id="2649963">false</span><br>
<span class="lineno"></span><span class="op" id="2649969">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="2649972">//&nbsp;lookupName&nbsp;returns&nbsp;information&nbsp;about&nbsp;the&nbsp;time&nbsp;zone&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="2650031">//&nbsp;the&nbsp;given&nbsp;name&nbsp;(such&nbsp;as&nbsp;&#34;EST&#34;)&nbsp;at&nbsp;the&nbsp;given&nbsp;pseudo-Unix&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="2650095">//&nbsp;(what&nbsp;the&nbsp;given&nbsp;time&nbsp;of&nbsp;day&nbsp;would&nbsp;be&nbsp;in&nbsp;UTC).</span><br>
<span class="lineno"></span><span class="keyword" id="2650144">func</span>&nbsp;<span class="op" id="2650149">(</span><span class="ident" id="2650150">l</span>&nbsp;<span class="op" id="2650152">*</span><span class="ident" id="2650153">Location</span><span class="op" id="2650161">)</span>&nbsp;<span class="ident" id="2650163">lookupName</span><span class="op" id="2650173">(</span><span class="ident" id="2650174">name</span>&nbsp;<span class="builtintype" id="2650179">string</span><span class="op" id="2650185">,</span>&nbsp;<span class="ident" id="2650187">unix</span>&nbsp;<span class="ident" id="2650192">int64</span><span class="op" id="2650197">)</span>&nbsp;<span class="op" id="2650199">(</span><span class="ident" id="2650200">offset</span>&nbsp;<span class="builtintype" id="2650207">int</span><span class="op" id="2650210">,</span>&nbsp;<span class="ident" id="2650212">isDST</span>&nbsp;<span class="builtintype" id="2650218">bool</span><span class="op" id="2650222">,</span>&nbsp;<span class="ident" id="2650224">ok</span>&nbsp;<span class="builtintype" id="2650227">bool</span><span class="op" id="2650231">)</span>&nbsp;<span class="op" id="2650233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2650236">l</span>&nbsp;<span class="op" id="2650238">=</span>&nbsp;<span class="ident" id="2650240">l</span><span class="op" id="2650241">.</span><span class="ident" id="2650242">get</span><span class="op" id="2650245">(</span><span class="op" id="2650246">)</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2650250">//&nbsp;First&nbsp;try&nbsp;for&nbsp;a&nbsp;zone&nbsp;with&nbsp;the&nbsp;right&nbsp;name&nbsp;that&nbsp;was&nbsp;actually</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2650313">//&nbsp;in&nbsp;effect&nbsp;at&nbsp;the&nbsp;given&nbsp;time.&nbsp;(In&nbsp;Sydney,&nbsp;Australia,&nbsp;both&nbsp;standard</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2650383">//&nbsp;and&nbsp;daylight-savings&nbsp;time&nbsp;are&nbsp;abbreviated&nbsp;&#34;EST&#34;.&nbsp;Using&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2650446">//&nbsp;offset&nbsp;helps&nbsp;us&nbsp;pick&nbsp;the&nbsp;right&nbsp;one&nbsp;for&nbsp;the&nbsp;given&nbsp;time.</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2650505">//&nbsp;It&#39;s&nbsp;not&nbsp;perfect:&nbsp;during&nbsp;the&nbsp;backward&nbsp;transition&nbsp;we&nbsp;might&nbsp;pick</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2650572">//&nbsp;either&nbsp;one.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2650589">for</span>&nbsp;<span class="ident" id="2650593">i</span>&nbsp;<span class="op" id="2650595">:=</span>&nbsp;<span class="keyword" id="2650598">range</span>&nbsp;<span class="ident" id="2650604">l</span><span class="op" id="2650605">.</span><span class="ident" id="2650606">zone</span>&nbsp;<span class="op" id="2650611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2650615">zone</span>&nbsp;<span class="op" id="2650620">:=</span>&nbsp;<span class="op" id="2650623">&amp;</span><span class="ident" id="2650624">l</span><span class="op" id="2650625">.</span><span class="ident" id="2650626">zone</span><span class="op" id="2650630">[</span><span class="ident" id="2650631">i</span><span class="op" id="2650632">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2650636">if</span>&nbsp;<span class="ident" id="2650639">zone</span><span class="op" id="2650643">.</span><span class="ident" id="2650644">name</span>&nbsp;<span class="op" id="2650649">==</span>&nbsp;<span class="ident" id="2650652">name</span>&nbsp;<span class="op" id="2650657">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2650662">nam</span><span class="op" id="2650665">,</span>&nbsp;<span class="ident" id="2650667">offset</span><span class="op" id="2650673">,</span>&nbsp;<span class="ident" id="2650675">isDST</span><span class="op" id="2650680">,</span>&nbsp;<span class="ident" id="2650682">_</span><span class="op" id="2650683">,</span>&nbsp;<span class="ident" id="2650685">_</span>&nbsp;<span class="op" id="2650687">:=</span>&nbsp;<span class="ident" id="2650690">l</span><span class="op" id="2650691">.</span><span class="ident" id="2650692">lookup</span><span class="op" id="2650698">(</span><span class="ident" id="2650699">unix</span>&nbsp;<span class="op" id="2650704">-</span>&nbsp;<span class="ident" id="2650706">int64</span><span class="op" id="2650711">(</span><span class="ident" id="2650712">zone</span><span class="op" id="2650716">.</span><span class="ident" id="2650717">offset</span><span class="op" id="2650723">)</span><span class="op" id="2650724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2650729">if</span>&nbsp;<span class="ident" id="2650732">nam</span>&nbsp;<span class="op" id="2650736">==</span>&nbsp;<span class="ident" id="2650739">zone</span><span class="op" id="2650743">.</span><span class="ident" id="2650744">name</span>&nbsp;<span class="op" id="2650749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2650755">return</span>&nbsp;<span class="ident" id="2650762">offset</span><span class="op" id="2650768">,</span>&nbsp;<span class="ident" id="2650770">isDST</span><span class="op" id="2650775">,</span>&nbsp;<span class="builtintype" id="2650777">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2650785">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2650789">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2650792">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2650796">//&nbsp;Otherwise&nbsp;fall&nbsp;back&nbsp;to&nbsp;an&nbsp;ordinary&nbsp;name&nbsp;match.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2650847">for</span>&nbsp;<span class="ident" id="2650851">i</span>&nbsp;<span class="op" id="2650853">:=</span>&nbsp;<span class="keyword" id="2650856">range</span>&nbsp;<span class="ident" id="2650862">l</span><span class="op" id="2650863">.</span><span class="ident" id="2650864">zone</span>&nbsp;<span class="op" id="2650869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2650873">zone</span>&nbsp;<span class="op" id="2650878">:=</span>&nbsp;<span class="op" id="2650881">&amp;</span><span class="ident" id="2650882">l</span><span class="op" id="2650883">.</span><span class="ident" id="2650884">zone</span><span class="op" id="2650888">[</span><span class="ident" id="2650889">i</span><span class="op" id="2650890">]</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2650894">if</span>&nbsp;<span class="ident" id="2650897">zone</span><span class="op" id="2650901">.</span><span class="ident" id="2650902">name</span>&nbsp;<span class="op" id="2650907">==</span>&nbsp;<span class="ident" id="2650910">name</span>&nbsp;<span class="op" id="2650915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2650920">return</span>&nbsp;<span class="ident" id="2650927">zone</span><span class="op" id="2650931">.</span><span class="ident" id="2650932">offset</span><span class="op" id="2650938">,</span>&nbsp;<span class="ident" id="2650940">zone</span><span class="op" id="2650944">.</span><span class="ident" id="2650945">isDST</span><span class="op" id="2650950">,</span>&nbsp;<span class="builtintype" id="2650952">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2650959">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2650962">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2650966">//&nbsp;Otherwise,&nbsp;give&nbsp;up.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2650990">return</span><br>
<span class="lineno"></span><span class="op" id="2650997">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2651000">//&nbsp;NOTE(rsc):&nbsp;Eventually&nbsp;we&nbsp;will&nbsp;need&nbsp;to&nbsp;accept&nbsp;the&nbsp;POSIX&nbsp;TZ&nbsp;environment</span><br>
<span class="lineno">255</span><span class="comment" id="2651073">//&nbsp;syntax&nbsp;too,&nbsp;but&nbsp;I&nbsp;don&#39;t&nbsp;feel&nbsp;like&nbsp;implementing&nbsp;it&nbsp;today.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2651134">var</span>&nbsp;<span class="ident" id="2651138">zoneinfo</span><span class="op" id="2651146">,</span>&nbsp;<span class="ident" id="2651148">_</span>&nbsp;<span class="op" id="2651150">=</span>&nbsp;<span class="ident" id="2651152">syscall</span><span class="op" id="2651159">.</span><span class="ident" id="2651160">Getenv</span><span class="op" id="2651166">(</span><span class="string" id="2651167">&#34;ZONEINFO&#34;</span><span class="op" id="2651177">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2651180">//&nbsp;LoadLocation&nbsp;returns&nbsp;the&nbsp;Location&nbsp;with&nbsp;the&nbsp;given&nbsp;name.</span><br>
<span class="lineno">260</span><span class="comment" id="2651238">//</span><br>
<span class="lineno"></span><span class="comment" id="2651241">//&nbsp;If&nbsp;the&nbsp;name&nbsp;is&nbsp;&#34;&#34;&nbsp;or&nbsp;&#34;UTC&#34;,&nbsp;LoadLocation&nbsp;returns&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="comment" id="2651298">//&nbsp;If&nbsp;the&nbsp;name&nbsp;is&nbsp;&#34;Local&#34;,&nbsp;LoadLocation&nbsp;returns&nbsp;Local.</span><br>
<span class="lineno"></span><span class="comment" id="2651353">//</span><br>
<span class="lineno"></span><span class="comment" id="2651356">//&nbsp;Otherwise,&nbsp;the&nbsp;name&nbsp;is&nbsp;taken&nbsp;to&nbsp;be&nbsp;a&nbsp;location&nbsp;name&nbsp;corresponding&nbsp;to&nbsp;a&nbsp;file</span><br>
<span class="lineno">265</span><span class="comment" id="2651434">//&nbsp;in&nbsp;the&nbsp;IANA&nbsp;Time&nbsp;Zone&nbsp;database,&nbsp;such&nbsp;as&nbsp;&#34;America/New_York&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="2651497">//</span><br>
<span class="lineno"></span><span class="comment" id="2651500">//&nbsp;The&nbsp;time&nbsp;zone&nbsp;database&nbsp;needed&nbsp;by&nbsp;LoadLocation&nbsp;may&nbsp;not&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="2651560">//&nbsp;present&nbsp;on&nbsp;all&nbsp;systems,&nbsp;especially&nbsp;non-Unix&nbsp;systems.</span><br>
<span class="lineno"></span><span class="comment" id="2651616">//&nbsp;LoadLocation&nbsp;looks&nbsp;in&nbsp;the&nbsp;directory&nbsp;or&nbsp;uncompressed&nbsp;zip&nbsp;file</span><br>
<span class="lineno">270</span><span class="comment" id="2651680">//&nbsp;named&nbsp;by&nbsp;the&nbsp;ZONEINFO&nbsp;environment&nbsp;variable,&nbsp;if&nbsp;any,&nbsp;then&nbsp;looks&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="2651749">//&nbsp;known&nbsp;installation&nbsp;locations&nbsp;on&nbsp;Unix&nbsp;systems,</span><br>
<span class="lineno"></span><span class="comment" id="2651798">//&nbsp;and&nbsp;finally&nbsp;looks&nbsp;in&nbsp;$GOROOT/lib/time/zoneinfo.zip.</span><br>
<span class="lineno"></span><span class="keyword" id="2651853">func</span>&nbsp;<span class="ident" id="2651858">LoadLocation</span><span class="op" id="2651870">(</span><span class="ident" id="2651871">name</span>&nbsp;<span class="builtintype" id="2651876">string</span><span class="op" id="2651882">)</span>&nbsp;<span class="op" id="2651884">(</span><span class="op" id="2651885">*</span><span class="ident" id="2651886">Location</span><span class="op" id="2651894">,</span>&nbsp;<span class="builtintype" id="2651896">error</span><span class="op" id="2651901">)</span>&nbsp;<span class="op" id="2651903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2651906">if</span>&nbsp;<span class="ident" id="2651909">name</span>&nbsp;<span class="op" id="2651914">==</span>&nbsp;<span class="string" id="2651917">&#34;&#34;</span>&nbsp;<span class="op" id="2651920">||</span>&nbsp;<span class="ident" id="2651923">name</span>&nbsp;<span class="op" id="2651928">==</span>&nbsp;<span class="string" id="2651931">&#34;UTC&#34;</span>&nbsp;<span class="op" id="2651937">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2651941">return</span>&nbsp;<span class="ident" id="2651948">UTC</span><span class="op" id="2651951">,</span>&nbsp;<span class="ident" id="2651953">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2651958">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2651961">if</span>&nbsp;<span class="ident" id="2651964">name</span>&nbsp;<span class="op" id="2651969">==</span>&nbsp;<span class="string" id="2651972">&#34;Local&#34;</span>&nbsp;<span class="op" id="2651980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2651984">return</span>&nbsp;<span class="ident" id="2651991">Local</span><span class="op" id="2651996">,</span>&nbsp;<span class="ident" id="2651998">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2652003">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2652006">if</span>&nbsp;<span class="ident" id="2652009">zoneinfo</span>&nbsp;<span class="op" id="2652018">!=</span>&nbsp;<span class="string" id="2652021">&#34;&#34;</span>&nbsp;<span class="op" id="2652024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2652028">if</span>&nbsp;<span class="ident" id="2652031">z</span><span class="op" id="2652032">,</span>&nbsp;<span class="ident" id="2652034">err</span>&nbsp;<span class="op" id="2652038">:=</span>&nbsp;<span class="ident" id="2652041">loadZoneFile</span><span class="op" id="2652053">(</span><span class="ident" id="2652054">zoneinfo</span><span class="op" id="2652062">,</span>&nbsp;<span class="ident" id="2652064">name</span><span class="op" id="2652068">)</span><span class="op" id="2652069">;</span>&nbsp;<span class="ident" id="2652071">err</span>&nbsp;<span class="op" id="2652075">==</span>&nbsp;<span class="ident" id="2652078">nil</span>&nbsp;<span class="op" id="2652082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2652087">z</span><span class="op" id="2652088">.</span><span class="ident" id="2652089">name</span>&nbsp;<span class="op" id="2652094">=</span>&nbsp;<span class="ident" id="2652096">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2652104">return</span>&nbsp;<span class="ident" id="2652111">z</span><span class="op" id="2652112">,</span>&nbsp;<span class="ident" id="2652114">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2652120">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2652123">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2652126">return</span>&nbsp;<span class="ident" id="2652133">loadLocation</span><span class="op" id="2652145">(</span><span class="ident" id="2652146">name</span><span class="op" id="2652150">)</span><br>
<span class="lineno"></span><span class="op" id="2652152">}</span>
</div>
</body>
</html>
