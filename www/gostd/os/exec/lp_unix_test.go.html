<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>os/exec</h2>
<ul>
<li><a href="/gostd/os/exec/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/os/exec/exec.go.html">exec.go</a></li>
<li><a href="/gostd/os/exec/exec_test.go.html">exec_test.go</a></li>
<li><a href="/gostd/os/exec/lp_test.go.html">lp_test.go</a></li>
<li><a href="/gostd/os/exec/lp_unix.go.html">lp_unix.go</a></li>
<li><a href="/gostd/os/exec/lp_unix_test.go.html" class="current">lp_unix_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8214596">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8214652">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8214706">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="8214757">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8214822">package</span>&nbsp;<span class="ident" id="8214830">exec</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8214836">import</span>&nbsp;<span class="op" id="8214843">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8214846">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8214859">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8214865">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8214875">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="8214878">func</span>&nbsp;<span class="ident" id="8214883">TestLookPathUnixEmptyPath</span><span class="op" id="8214908">(</span><span class="ident" id="8214909">t</span>&nbsp;<span class="op" id="8214911">*</span><span class="ident" id="8214912">testing</span><span class="op" id="8214919">.</span><span class="ident" id="8214920">T</span><span class="op" id="8214921">)</span>&nbsp;<span class="op" id="8214923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8214926">tmp</span><span class="op" id="8214929">,</span>&nbsp;<span class="ident" id="8214931">err</span>&nbsp;<span class="op" id="8214935">:=</span>&nbsp;<span class="ident" id="8214938">ioutil</span><span class="op" id="8214944">.</span><span class="ident" id="8214945">TempDir</span><span class="op" id="8214952">(</span><span class="string" id="8214953">&#34;&#34;</span><span class="op" id="8214955">,</span>&nbsp;<span class="string" id="8214957">&#34;TestLookPathUnixEmptyPath&#34;</span><span class="op" id="8214984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8214987">if</span>&nbsp;<span class="ident" id="8214990">err</span>&nbsp;<span class="op" id="8214994">!=</span>&nbsp;<span class="builtintype" id="8214997">nil</span>&nbsp;<span class="op" id="8215001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8215005">t</span><span class="op" id="8215006">.</span><span class="ident" id="8215007">Fatal</span><span class="op" id="8215012">(</span><span class="string" id="8215013">&#34;TempDir&nbsp;failed:&nbsp;&#34;</span><span class="op" id="8215031">,</span>&nbsp;<span class="ident" id="8215033">err</span><span class="op" id="8215036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8215039">}</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8215042">defer</span>&nbsp;<span class="ident" id="8215048">os</span><span class="op" id="8215050">.</span><span class="ident" id="8215051">RemoveAll</span><span class="op" id="8215060">(</span><span class="ident" id="8215061">tmp</span><span class="op" id="8215064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8215067">wd</span><span class="op" id="8215069">,</span>&nbsp;<span class="ident" id="8215071">err</span>&nbsp;<span class="op" id="8215075">:=</span>&nbsp;<span class="ident" id="8215078">os</span><span class="op" id="8215080">.</span><span class="ident" id="8215081">Getwd</span><span class="op" id="8215086">(</span><span class="op" id="8215087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8215090">if</span>&nbsp;<span class="ident" id="8215093">err</span>&nbsp;<span class="op" id="8215097">!=</span>&nbsp;<span class="builtintype" id="8215100">nil</span>&nbsp;<span class="op" id="8215104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8215108">t</span><span class="op" id="8215109">.</span><span class="ident" id="8215110">Fatal</span><span class="op" id="8215115">(</span><span class="string" id="8215116">&#34;Getwd&nbsp;failed:&nbsp;&#34;</span><span class="op" id="8215132">,</span>&nbsp;<span class="ident" id="8215134">err</span><span class="op" id="8215137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8215140">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8215143">err</span>&nbsp;<span class="op" id="8215147">=</span>&nbsp;<span class="ident" id="8215149">os</span><span class="op" id="8215151">.</span><span class="ident" id="8215152">Chdir</span><span class="op" id="8215157">(</span><span class="ident" id="8215158">tmp</span><span class="op" id="8215161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8215164">if</span>&nbsp;<span class="ident" id="8215167">err</span>&nbsp;<span class="op" id="8215171">!=</span>&nbsp;<span class="builtintype" id="8215174">nil</span>&nbsp;<span class="op" id="8215178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8215182">t</span><span class="op" id="8215183">.</span><span class="ident" id="8215184">Fatal</span><span class="op" id="8215189">(</span><span class="string" id="8215190">&#34;Chdir&nbsp;failed:&nbsp;&#34;</span><span class="op" id="8215206">,</span>&nbsp;<span class="ident" id="8215208">err</span><span class="op" id="8215211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8215214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8215217">defer</span>&nbsp;<span class="ident" id="8215223">os</span><span class="op" id="8215225">.</span><span class="ident" id="8215226">Chdir</span><span class="op" id="8215231">(</span><span class="ident" id="8215232">wd</span><span class="op" id="8215234">)</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8215238">f</span><span class="op" id="8215239">,</span>&nbsp;<span class="ident" id="8215241">err</span>&nbsp;<span class="op" id="8215245">:=</span>&nbsp;<span class="ident" id="8215248">os</span><span class="op" id="8215250">.</span><span class="ident" id="8215251">OpenFile</span><span class="op" id="8215259">(</span><span class="string" id="8215260">&#34;exec_me&#34;</span><span class="op" id="8215269">,</span>&nbsp;<span class="ident" id="8215271">os</span><span class="op" id="8215273">.</span><span class="ident" id="8215274">O_CREATE</span><span class="op" id="8215282">|</span><span class="ident" id="8215283">os</span><span class="op" id="8215285">.</span><span class="ident" id="8215286">O_EXCL</span><span class="op" id="8215292">,</span>&nbsp;<span class="num" id="8215294">0700</span><span class="op" id="8215298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8215301">if</span>&nbsp;<span class="ident" id="8215304">err</span>&nbsp;<span class="op" id="8215308">!=</span>&nbsp;<span class="builtintype" id="8215311">nil</span>&nbsp;<span class="op" id="8215315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8215319">t</span><span class="op" id="8215320">.</span><span class="ident" id="8215321">Fatal</span><span class="op" id="8215326">(</span><span class="string" id="8215327">&#34;OpenFile&nbsp;failed:&nbsp;&#34;</span><span class="op" id="8215346">,</span>&nbsp;<span class="ident" id="8215348">err</span><span class="op" id="8215351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8215354">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8215357">err</span>&nbsp;<span class="op" id="8215361">=</span>&nbsp;<span class="ident" id="8215363">f</span><span class="op" id="8215364">.</span><span class="ident" id="8215365">Close</span><span class="op" id="8215370">(</span><span class="op" id="8215371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8215374">if</span>&nbsp;<span class="ident" id="8215377">err</span>&nbsp;<span class="op" id="8215381">!=</span>&nbsp;<span class="builtintype" id="8215384">nil</span>&nbsp;<span class="op" id="8215388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8215392">t</span><span class="op" id="8215393">.</span><span class="ident" id="8215394">Fatal</span><span class="op" id="8215399">(</span><span class="string" id="8215400">&#34;Close&nbsp;failed:&nbsp;&#34;</span><span class="op" id="8215416">,</span>&nbsp;<span class="ident" id="8215418">err</span><span class="op" id="8215421">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8215424">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8215428">pathenv</span>&nbsp;<span class="op" id="8215436">:=</span>&nbsp;<span class="ident" id="8215439">os</span><span class="op" id="8215441">.</span><span class="ident" id="8215442">Getenv</span><span class="op" id="8215448">(</span><span class="string" id="8215449">&#34;PATH&#34;</span><span class="op" id="8215455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8215458">defer</span>&nbsp;<span class="ident" id="8215464">os</span><span class="op" id="8215466">.</span><span class="ident" id="8215467">Setenv</span><span class="op" id="8215473">(</span><span class="string" id="8215474">&#34;PATH&#34;</span><span class="op" id="8215480">,</span>&nbsp;<span class="ident" id="8215482">pathenv</span><span class="op" id="8215489">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8215493">err</span>&nbsp;<span class="op" id="8215497">=</span>&nbsp;<span class="ident" id="8215499">os</span><span class="op" id="8215501">.</span><span class="ident" id="8215502">Setenv</span><span class="op" id="8215508">(</span><span class="string" id="8215509">&#34;PATH&#34;</span><span class="op" id="8215515">,</span>&nbsp;<span class="string" id="8215517">&#34;&#34;</span><span class="op" id="8215519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8215522">if</span>&nbsp;<span class="ident" id="8215525">err</span>&nbsp;<span class="op" id="8215529">!=</span>&nbsp;<span class="builtintype" id="8215532">nil</span>&nbsp;<span class="op" id="8215536">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8215540">t</span><span class="op" id="8215541">.</span><span class="ident" id="8215542">Fatal</span><span class="op" id="8215547">(</span><span class="string" id="8215548">&#34;Setenv&nbsp;failed:&nbsp;&#34;</span><span class="op" id="8215565">,</span>&nbsp;<span class="ident" id="8215567">err</span><span class="op" id="8215570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8215573">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8215577">path</span><span class="op" id="8215581">,</span>&nbsp;<span class="ident" id="8215583">err</span>&nbsp;<span class="op" id="8215587">:=</span>&nbsp;<span class="ident" id="8215590">LookPath</span><span class="op" id="8215598">(</span><span class="string" id="8215599">&#34;exec_me&#34;</span><span class="op" id="8215608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8215611">if</span>&nbsp;<span class="ident" id="8215614">err</span>&nbsp;<span class="op" id="8215618">==</span>&nbsp;<span class="builtintype" id="8215621">nil</span>&nbsp;<span class="op" id="8215625">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8215629">t</span><span class="op" id="8215630">.</span><span class="ident" id="8215631">Fatal</span><span class="op" id="8215636">(</span><span class="string" id="8215637">&#34;LookPath&nbsp;found&nbsp;exec_me&nbsp;in&nbsp;empty&nbsp;$PATH&#34;</span><span class="op" id="8215676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8215679">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8215682">if</span>&nbsp;<span class="ident" id="8215685">path</span>&nbsp;<span class="op" id="8215690">!=</span>&nbsp;<span class="string" id="8215693">&#34;&#34;</span>&nbsp;<span class="op" id="8215696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8215700">t</span><span class="op" id="8215701">.</span><span class="ident" id="8215702">Fatalf</span><span class="op" id="8215708">(</span><span class="string" id="8215709">&#34;LookPath&nbsp;path&nbsp;==&nbsp;%q&nbsp;when&nbsp;err&nbsp;!=&nbsp;nil&#34;</span><span class="op" id="8215746">,</span>&nbsp;<span class="ident" id="8215748">path</span><span class="op" id="8215752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8215755">}</span><br>
<span class="lineno">55</span><span class="op" id="8215757">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
