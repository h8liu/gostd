<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>log</h2>
<ul>
<li><a href="/gostd/log/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/log/log.go.html">log.go</a></li>
<li><a href="/gostd/log/log_test.go.html">log_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6928737">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6928792">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6928846">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6928897">package</span>&nbsp;<span class="ident" id="6928905">log</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6928910">//&nbsp;These&nbsp;tests&nbsp;are&nbsp;too&nbsp;simple.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6928942">import</span>&nbsp;<span class="op" id="6928949">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6928952">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6928961">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6928967">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6928977">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6928987">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="6928990">const</span>&nbsp;<span class="op" id="6928996">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6928999">Rdate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6929013">=</span>&nbsp;<span class="string" id="6929015">`[0-9][0-9][0-9][0-9]/[0-9][0-9]/[0-9][0-9]`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6929061">Rtime</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6929075">=</span>&nbsp;<span class="string" id="6929077">`[0-9][0-9]:[0-9][0-9]:[0-9][0-9]`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6929113">Rmicroseconds</span>&nbsp;<span class="op" id="6929127">=</span>&nbsp;<span class="string" id="6929129">`\.[0-9][0-9][0-9][0-9][0-9][0-9]`</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6929165">Rline</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6929179">=</span>&nbsp;<span class="string" id="6929181">`(54|56):`</span>&nbsp;<span class="comment" id="6929192">//&nbsp;must&nbsp;update&nbsp;if&nbsp;the&nbsp;calls&nbsp;to&nbsp;l.Printf&nbsp;/&nbsp;l.Print&nbsp;below&nbsp;move</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6929254">Rlongfile</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6929268">=</span>&nbsp;<span class="string" id="6929270">`.*/[A-Za-z0-9_\-]+\.go:`</span>&nbsp;<span class="op" id="6929296">+</span>&nbsp;<span class="ident" id="6929298">Rline</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6929305">Rshortfile</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6929319">=</span>&nbsp;<span class="string" id="6929321">`[A-Za-z0-9_\-]+\.go:`</span>&nbsp;<span class="op" id="6929344">+</span>&nbsp;<span class="ident" id="6929346">Rline</span><br>
<span class="lineno"></span><span class="op" id="6929352">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="6929355">type</span>&nbsp;<span class="ident" id="6929360">tester</span>&nbsp;<span class="keyword" id="6929367">struct</span>&nbsp;<span class="op" id="6929374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6929377">flag</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6929385">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6929390">prefix</span>&nbsp;&nbsp;<span class="builtintype" id="6929398">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6929406">pattern</span>&nbsp;<span class="builtintype" id="6929414">string</span>&nbsp;<span class="comment" id="6929421">//&nbsp;regexp&nbsp;that&nbsp;log&nbsp;output&nbsp;must&nbsp;match;&nbsp;we&nbsp;add&nbsp;^&nbsp;and&nbsp;expected_text$&nbsp;always</span><br>
<span class="lineno"></span><span class="op" id="6929494">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="6929497">var</span>&nbsp;<span class="ident" id="6929501">tests</span>&nbsp;<span class="op" id="6929507">=</span>&nbsp;<span class="op" id="6929509">[</span><span class="op" id="6929510">]</span><span class="ident" id="6929511">tester</span><span class="op" id="6929517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6929520">//&nbsp;individual&nbsp;pieces:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6929543">{</span><span class="num" id="6929544">0</span><span class="op" id="6929545">,</span>&nbsp;<span class="string" id="6929547">&#34;&#34;</span><span class="op" id="6929549">,</span>&nbsp;<span class="string" id="6929551">&#34;&#34;</span><span class="op" id="6929553">}</span><span class="op" id="6929554">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6929557">{</span><span class="num" id="6929558">0</span><span class="op" id="6929559">,</span>&nbsp;<span class="string" id="6929561">&#34;XXX&#34;</span><span class="op" id="6929566">,</span>&nbsp;<span class="string" id="6929568">&#34;XXX&#34;</span><span class="op" id="6929573">}</span><span class="op" id="6929574">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6929577">{</span><span class="ident" id="6929578">Ldate</span><span class="op" id="6929583">,</span>&nbsp;<span class="string" id="6929585">&#34;&#34;</span><span class="op" id="6929587">,</span>&nbsp;<span class="ident" id="6929589">Rdate</span>&nbsp;<span class="op" id="6929595">+</span>&nbsp;<span class="string" id="6929597">&#34;&nbsp;&#34;</span><span class="op" id="6929600">}</span><span class="op" id="6929601">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6929604">{</span><span class="ident" id="6929605">Ltime</span><span class="op" id="6929610">,</span>&nbsp;<span class="string" id="6929612">&#34;&#34;</span><span class="op" id="6929614">,</span>&nbsp;<span class="ident" id="6929616">Rtime</span>&nbsp;<span class="op" id="6929622">+</span>&nbsp;<span class="string" id="6929624">&#34;&nbsp;&#34;</span><span class="op" id="6929627">}</span><span class="op" id="6929628">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6929631">{</span><span class="ident" id="6929632">Ltime</span>&nbsp;<span class="op" id="6929638">|</span>&nbsp;<span class="ident" id="6929640">Lmicroseconds</span><span class="op" id="6929653">,</span>&nbsp;<span class="string" id="6929655">&#34;&#34;</span><span class="op" id="6929657">,</span>&nbsp;<span class="ident" id="6929659">Rtime</span>&nbsp;<span class="op" id="6929665">+</span>&nbsp;<span class="ident" id="6929667">Rmicroseconds</span>&nbsp;<span class="op" id="6929681">+</span>&nbsp;<span class="string" id="6929683">&#34;&nbsp;&#34;</span><span class="op" id="6929686">}</span><span class="op" id="6929687">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6929690">{</span><span class="ident" id="6929691">Lmicroseconds</span><span class="op" id="6929704">,</span>&nbsp;<span class="string" id="6929706">&#34;&#34;</span><span class="op" id="6929708">,</span>&nbsp;<span class="ident" id="6929710">Rtime</span>&nbsp;<span class="op" id="6929716">+</span>&nbsp;<span class="ident" id="6929718">Rmicroseconds</span>&nbsp;<span class="op" id="6929732">+</span>&nbsp;<span class="string" id="6929734">&#34;&nbsp;&#34;</span><span class="op" id="6929737">}</span><span class="op" id="6929738">,</span>&nbsp;<span class="comment" id="6929740">//&nbsp;microsec&nbsp;implies&nbsp;time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6929766">{</span><span class="ident" id="6929767">Llongfile</span><span class="op" id="6929776">,</span>&nbsp;<span class="string" id="6929778">&#34;&#34;</span><span class="op" id="6929780">,</span>&nbsp;<span class="ident" id="6929782">Rlongfile</span>&nbsp;<span class="op" id="6929792">+</span>&nbsp;<span class="string" id="6929794">&#34;&nbsp;&#34;</span><span class="op" id="6929797">}</span><span class="op" id="6929798">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6929801">{</span><span class="ident" id="6929802">Lshortfile</span><span class="op" id="6929812">,</span>&nbsp;<span class="string" id="6929814">&#34;&#34;</span><span class="op" id="6929816">,</span>&nbsp;<span class="ident" id="6929818">Rshortfile</span>&nbsp;<span class="op" id="6929829">+</span>&nbsp;<span class="string" id="6929831">&#34;&nbsp;&#34;</span><span class="op" id="6929834">}</span><span class="op" id="6929835">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6929838">{</span><span class="ident" id="6929839">Llongfile</span>&nbsp;<span class="op" id="6929849">|</span>&nbsp;<span class="ident" id="6929851">Lshortfile</span><span class="op" id="6929861">,</span>&nbsp;<span class="string" id="6929863">&#34;&#34;</span><span class="op" id="6929865">,</span>&nbsp;<span class="ident" id="6929867">Rshortfile</span>&nbsp;<span class="op" id="6929878">+</span>&nbsp;<span class="string" id="6929880">&#34;&nbsp;&#34;</span><span class="op" id="6929883">}</span><span class="op" id="6929884">,</span>&nbsp;<span class="comment" id="6929886">//&nbsp;shortfile&nbsp;overrides&nbsp;longfile</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6929919">//&nbsp;everything&nbsp;at&nbsp;once:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6929943">{</span><span class="ident" id="6929944">Ldate</span>&nbsp;<span class="op" id="6929950">|</span>&nbsp;<span class="ident" id="6929952">Ltime</span>&nbsp;<span class="op" id="6929958">|</span>&nbsp;<span class="ident" id="6929960">Lmicroseconds</span>&nbsp;<span class="op" id="6929974">|</span>&nbsp;<span class="ident" id="6929976">Llongfile</span><span class="op" id="6929985">,</span>&nbsp;<span class="string" id="6929987">&#34;XXX&#34;</span><span class="op" id="6929992">,</span>&nbsp;<span class="string" id="6929994">&#34;XXX&#34;</span>&nbsp;<span class="op" id="6930000">+</span>&nbsp;<span class="ident" id="6930002">Rdate</span>&nbsp;<span class="op" id="6930008">+</span>&nbsp;<span class="string" id="6930010">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="6930014">+</span>&nbsp;<span class="ident" id="6930016">Rtime</span>&nbsp;<span class="op" id="6930022">+</span>&nbsp;<span class="ident" id="6930024">Rmicroseconds</span>&nbsp;<span class="op" id="6930038">+</span>&nbsp;<span class="string" id="6930040">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="6930044">+</span>&nbsp;<span class="ident" id="6930046">Rlongfile</span>&nbsp;<span class="op" id="6930056">+</span>&nbsp;<span class="string" id="6930058">&#34;&nbsp;&#34;</span><span class="op" id="6930061">}</span><span class="op" id="6930062">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6930065">{</span><span class="ident" id="6930066">Ldate</span>&nbsp;<span class="op" id="6930072">|</span>&nbsp;<span class="ident" id="6930074">Ltime</span>&nbsp;<span class="op" id="6930080">|</span>&nbsp;<span class="ident" id="6930082">Lmicroseconds</span>&nbsp;<span class="op" id="6930096">|</span>&nbsp;<span class="ident" id="6930098">Lshortfile</span><span class="op" id="6930108">,</span>&nbsp;<span class="string" id="6930110">&#34;XXX&#34;</span><span class="op" id="6930115">,</span>&nbsp;<span class="string" id="6930117">&#34;XXX&#34;</span>&nbsp;<span class="op" id="6930123">+</span>&nbsp;<span class="ident" id="6930125">Rdate</span>&nbsp;<span class="op" id="6930131">+</span>&nbsp;<span class="string" id="6930133">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="6930137">+</span>&nbsp;<span class="ident" id="6930139">Rtime</span>&nbsp;<span class="op" id="6930145">+</span>&nbsp;<span class="ident" id="6930147">Rmicroseconds</span>&nbsp;<span class="op" id="6930161">+</span>&nbsp;<span class="string" id="6930163">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="6930167">+</span>&nbsp;<span class="ident" id="6930169">Rshortfile</span>&nbsp;<span class="op" id="6930180">+</span>&nbsp;<span class="string" id="6930182">&#34;&nbsp;&#34;</span><span class="op" id="6930185">}</span><span class="op" id="6930186">,</span><br>
<span class="lineno">45</span><span class="op" id="6930188">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6930191">//&nbsp;Test&nbsp;using&nbsp;Println(&#34;hello&#34;,&nbsp;23,&nbsp;&#34;world&#34;)&nbsp;or&nbsp;using&nbsp;Printf(&#34;hello&nbsp;%d&nbsp;world&#34;,&nbsp;23)</span><br>
<span class="lineno"></span><span class="keyword" id="6930273">func</span>&nbsp;<span class="ident" id="6930278">testPrint</span><span class="op" id="6930287">(</span><span class="ident" id="6930288">t</span>&nbsp;<span class="op" id="6930290">*</span><span class="ident" id="6930291">testing</span><span class="op" id="6930298">.</span><span class="ident" id="6930299">T</span><span class="op" id="6930300">,</span>&nbsp;<span class="ident" id="6930302">flag</span>&nbsp;<span class="builtintype" id="6930307">int</span><span class="op" id="6930310">,</span>&nbsp;<span class="ident" id="6930312">prefix</span>&nbsp;<span class="builtintype" id="6930319">string</span><span class="op" id="6930325">,</span>&nbsp;<span class="ident" id="6930327">pattern</span>&nbsp;<span class="builtintype" id="6930335">string</span><span class="op" id="6930341">,</span>&nbsp;<span class="ident" id="6930343">useFormat</span>&nbsp;<span class="builtintype" id="6930353">bool</span><span class="op" id="6930357">)</span>&nbsp;<span class="op" id="6930359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6930362">buf</span>&nbsp;<span class="op" id="6930366">:=</span>&nbsp;<span class="builtinfunc" id="6930369">new</span><span class="op" id="6930372">(</span><span class="ident" id="6930373">bytes</span><span class="op" id="6930378">.</span><span class="ident" id="6930379">Buffer</span><span class="op" id="6930385">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6930388">SetOutput</span><span class="op" id="6930397">(</span><span class="ident" id="6930398">buf</span><span class="op" id="6930401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6930404">SetFlags</span><span class="op" id="6930412">(</span><span class="ident" id="6930413">flag</span><span class="op" id="6930417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6930420">SetPrefix</span><span class="op" id="6930429">(</span><span class="ident" id="6930430">prefix</span><span class="op" id="6930436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6930439">if</span>&nbsp;<span class="ident" id="6930442">useFormat</span>&nbsp;<span class="op" id="6930452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6930456">Printf</span><span class="op" id="6930462">(</span><span class="string" id="6930463">&#34;hello&nbsp;%d&nbsp;world&#34;</span><span class="op" id="6930479">,</span>&nbsp;<span class="num" id="6930481">23</span><span class="op" id="6930483">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6930486">}</span>&nbsp;<span class="keyword" id="6930488">else</span>&nbsp;<span class="op" id="6930493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6930497">Println</span><span class="op" id="6930504">(</span><span class="string" id="6930505">&#34;hello&#34;</span><span class="op" id="6930512">,</span>&nbsp;<span class="num" id="6930514">23</span><span class="op" id="6930516">,</span>&nbsp;<span class="string" id="6930518">&#34;world&#34;</span><span class="op" id="6930525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6930528">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6930531">line</span>&nbsp;<span class="op" id="6930536">:=</span>&nbsp;<span class="ident" id="6930539">buf</span><span class="op" id="6930542">.</span><span class="ident" id="6930543">String</span><span class="op" id="6930549">(</span><span class="op" id="6930550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6930553">line</span>&nbsp;<span class="op" id="6930558">=</span>&nbsp;<span class="ident" id="6930560">line</span><span class="op" id="6930564">[</span><span class="num" id="6930565">0</span>&nbsp;<span class="op" id="6930567">:</span>&nbsp;<span class="builtinfunc" id="6930569">len</span><span class="op" id="6930572">(</span><span class="ident" id="6930573">line</span><span class="op" id="6930577">)</span><span class="op" id="6930578">-</span><span class="num" id="6930579">1</span><span class="op" id="6930580">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6930583">pattern</span>&nbsp;<span class="op" id="6930591">=</span>&nbsp;<span class="string" id="6930593">&#34;^&#34;</span>&nbsp;<span class="op" id="6930597">+</span>&nbsp;<span class="ident" id="6930599">pattern</span>&nbsp;<span class="op" id="6930607">+</span>&nbsp;<span class="string" id="6930609">&#34;hello&nbsp;23&nbsp;world$&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6930628">matched</span><span class="op" id="6930635">,</span>&nbsp;<span class="ident" id="6930637">err4</span>&nbsp;<span class="op" id="6930642">:=</span>&nbsp;<span class="ident" id="6930645">regexp</span><span class="op" id="6930651">.</span><span class="ident" id="6930652">MatchString</span><span class="op" id="6930663">(</span><span class="ident" id="6930664">pattern</span><span class="op" id="6930671">,</span>&nbsp;<span class="ident" id="6930673">line</span><span class="op" id="6930677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6930680">if</span>&nbsp;<span class="ident" id="6930683">err4</span>&nbsp;<span class="op" id="6930688">!=</span>&nbsp;<span class="ident" id="6930691">nil</span>&nbsp;<span class="op" id="6930695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6930699">t</span><span class="op" id="6930700">.</span><span class="ident" id="6930701">Fatal</span><span class="op" id="6930706">(</span><span class="string" id="6930707">&#34;pattern&nbsp;did&nbsp;not&nbsp;compile:&#34;</span><span class="op" id="6930733">,</span>&nbsp;<span class="ident" id="6930735">err4</span><span class="op" id="6930739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6930742">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6930745">if</span>&nbsp;<span class="op" id="6930748">!</span><span class="ident" id="6930749">matched</span>&nbsp;<span class="op" id="6930757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6930761">t</span><span class="op" id="6930762">.</span><span class="ident" id="6930763">Errorf</span><span class="op" id="6930769">(</span><span class="string" id="6930770">&#34;log&nbsp;output&nbsp;should&nbsp;match&nbsp;%q&nbsp;is&nbsp;%q&#34;</span><span class="op" id="6930804">,</span>&nbsp;<span class="ident" id="6930806">pattern</span><span class="op" id="6930813">,</span>&nbsp;<span class="ident" id="6930815">line</span><span class="op" id="6930819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6930822">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6930825">SetOutput</span><span class="op" id="6930834">(</span><span class="ident" id="6930835">os</span><span class="op" id="6930837">.</span><span class="ident" id="6930838">Stderr</span><span class="op" id="6930844">)</span><br>
<span class="lineno"></span><span class="op" id="6930846">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="6930849">func</span>&nbsp;<span class="ident" id="6930854">TestAll</span><span class="op" id="6930861">(</span><span class="ident" id="6930862">t</span>&nbsp;<span class="op" id="6930864">*</span><span class="ident" id="6930865">testing</span><span class="op" id="6930872">.</span><span class="ident" id="6930873">T</span><span class="op" id="6930874">)</span>&nbsp;<span class="op" id="6930876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6930879">for</span>&nbsp;<span class="ident" id="6930883">_</span><span class="op" id="6930884">,</span>&nbsp;<span class="ident" id="6930886">testcase</span>&nbsp;<span class="op" id="6930895">:=</span>&nbsp;<span class="keyword" id="6930898">range</span>&nbsp;<span class="ident" id="6930904">tests</span>&nbsp;<span class="op" id="6930910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6930914">testPrint</span><span class="op" id="6930923">(</span><span class="ident" id="6930924">t</span><span class="op" id="6930925">,</span>&nbsp;<span class="ident" id="6930927">testcase</span><span class="op" id="6930935">.</span><span class="ident" id="6930936">flag</span><span class="op" id="6930940">,</span>&nbsp;<span class="ident" id="6930942">testcase</span><span class="op" id="6930950">.</span><span class="ident" id="6930951">prefix</span><span class="op" id="6930957">,</span>&nbsp;<span class="ident" id="6930959">testcase</span><span class="op" id="6930967">.</span><span class="ident" id="6930968">pattern</span><span class="op" id="6930975">,</span>&nbsp;<span class="builtintype" id="6930977">false</span><span class="op" id="6930982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6930986">testPrint</span><span class="op" id="6930995">(</span><span class="ident" id="6930996">t</span><span class="op" id="6930997">,</span>&nbsp;<span class="ident" id="6930999">testcase</span><span class="op" id="6931007">.</span><span class="ident" id="6931008">flag</span><span class="op" id="6931012">,</span>&nbsp;<span class="ident" id="6931014">testcase</span><span class="op" id="6931022">.</span><span class="ident" id="6931023">prefix</span><span class="op" id="6931029">,</span>&nbsp;<span class="ident" id="6931031">testcase</span><span class="op" id="6931039">.</span><span class="ident" id="6931040">pattern</span><span class="op" id="6931047">,</span>&nbsp;<span class="builtintype" id="6931049">true</span><span class="op" id="6931053">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6931056">}</span><br>
<span class="lineno"></span><span class="op" id="6931058">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6931061">func</span>&nbsp;<span class="ident" id="6931066">TestOutput</span><span class="op" id="6931076">(</span><span class="ident" id="6931077">t</span>&nbsp;<span class="op" id="6931079">*</span><span class="ident" id="6931080">testing</span><span class="op" id="6931087">.</span><span class="ident" id="6931088">T</span><span class="op" id="6931089">)</span>&nbsp;<span class="op" id="6931091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6931094">const</span>&nbsp;<span class="ident" id="6931100">testString</span>&nbsp;<span class="op" id="6931111">=</span>&nbsp;<span class="string" id="6931113">&#34;test&#34;</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6931121">var</span>&nbsp;<span class="ident" id="6931125">b</span>&nbsp;<span class="ident" id="6931127">bytes</span><span class="op" id="6931132">.</span><span class="ident" id="6931133">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6931141">l</span>&nbsp;<span class="op" id="6931143">:=</span>&nbsp;<span class="ident" id="6931146">New</span><span class="op" id="6931149">(</span><span class="op" id="6931150">&amp;</span><span class="ident" id="6931151">b</span><span class="op" id="6931152">,</span>&nbsp;<span class="string" id="6931154">&#34;&#34;</span><span class="op" id="6931156">,</span>&nbsp;<span class="num" id="6931158">0</span><span class="op" id="6931159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6931162">l</span><span class="op" id="6931163">.</span><span class="ident" id="6931164">Println</span><span class="op" id="6931171">(</span><span class="ident" id="6931172">testString</span><span class="op" id="6931182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6931185">if</span>&nbsp;<span class="ident" id="6931188">expect</span>&nbsp;<span class="op" id="6931195">:=</span>&nbsp;<span class="ident" id="6931198">testString</span>&nbsp;<span class="op" id="6931209">+</span>&nbsp;<span class="string" id="6931211">&#34;\n&#34;</span><span class="op" id="6931215">;</span>&nbsp;<span class="ident" id="6931217">b</span><span class="op" id="6931218">.</span><span class="ident" id="6931219">String</span><span class="op" id="6931225">(</span><span class="op" id="6931226">)</span>&nbsp;<span class="op" id="6931228">!=</span>&nbsp;<span class="ident" id="6931231">expect</span>&nbsp;<span class="op" id="6931238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6931242">t</span><span class="op" id="6931243">.</span><span class="ident" id="6931244">Errorf</span><span class="op" id="6931250">(</span><span class="string" id="6931251">&#34;log&nbsp;output&nbsp;should&nbsp;match&nbsp;%q&nbsp;is&nbsp;%q&#34;</span><span class="op" id="6931285">,</span>&nbsp;<span class="ident" id="6931287">expect</span><span class="op" id="6931293">,</span>&nbsp;<span class="ident" id="6931295">b</span><span class="op" id="6931296">.</span><span class="ident" id="6931297">String</span><span class="op" id="6931303">(</span><span class="op" id="6931304">)</span><span class="op" id="6931305">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6931308">}</span><br>
<span class="lineno"></span><span class="op" id="6931310">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6931313">func</span>&nbsp;<span class="ident" id="6931318">TestFlagAndPrefixSetting</span><span class="op" id="6931342">(</span><span class="ident" id="6931343">t</span>&nbsp;<span class="op" id="6931345">*</span><span class="ident" id="6931346">testing</span><span class="op" id="6931353">.</span><span class="ident" id="6931354">T</span><span class="op" id="6931355">)</span>&nbsp;<span class="op" id="6931357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6931360">var</span>&nbsp;<span class="ident" id="6931364">b</span>&nbsp;<span class="ident" id="6931366">bytes</span><span class="op" id="6931371">.</span><span class="ident" id="6931372">Buffer</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6931380">l</span>&nbsp;<span class="op" id="6931382">:=</span>&nbsp;<span class="ident" id="6931385">New</span><span class="op" id="6931388">(</span><span class="op" id="6931389">&amp;</span><span class="ident" id="6931390">b</span><span class="op" id="6931391">,</span>&nbsp;<span class="string" id="6931393">&#34;Test:&#34;</span><span class="op" id="6931400">,</span>&nbsp;<span class="ident" id="6931402">LstdFlags</span><span class="op" id="6931411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6931414">f</span>&nbsp;<span class="op" id="6931416">:=</span>&nbsp;<span class="ident" id="6931419">l</span><span class="op" id="6931420">.</span><span class="ident" id="6931421">Flags</span><span class="op" id="6931426">(</span><span class="op" id="6931427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6931430">if</span>&nbsp;<span class="ident" id="6931433">f</span>&nbsp;<span class="op" id="6931435">!=</span>&nbsp;<span class="ident" id="6931438">LstdFlags</span>&nbsp;<span class="op" id="6931448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6931452">t</span><span class="op" id="6931453">.</span><span class="ident" id="6931454">Errorf</span><span class="op" id="6931460">(</span><span class="string" id="6931461">&#34;Flags&nbsp;1:&nbsp;expected&nbsp;%x&nbsp;got&nbsp;%x&#34;</span><span class="op" id="6931490">,</span>&nbsp;<span class="ident" id="6931492">LstdFlags</span><span class="op" id="6931501">,</span>&nbsp;<span class="ident" id="6931503">f</span><span class="op" id="6931504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6931507">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6931510">l</span><span class="op" id="6931511">.</span><span class="ident" id="6931512">SetFlags</span><span class="op" id="6931520">(</span><span class="ident" id="6931521">f</span>&nbsp;<span class="op" id="6931523">|</span>&nbsp;<span class="ident" id="6931525">Lmicroseconds</span><span class="op" id="6931538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6931541">f</span>&nbsp;<span class="op" id="6931543">=</span>&nbsp;<span class="ident" id="6931545">l</span><span class="op" id="6931546">.</span><span class="ident" id="6931547">Flags</span><span class="op" id="6931552">(</span><span class="op" id="6931553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6931556">if</span>&nbsp;<span class="ident" id="6931559">f</span>&nbsp;<span class="op" id="6931561">!=</span>&nbsp;<span class="ident" id="6931564">LstdFlags</span><span class="op" id="6931573">|</span><span class="ident" id="6931574">Lmicroseconds</span>&nbsp;<span class="op" id="6931588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6931592">t</span><span class="op" id="6931593">.</span><span class="ident" id="6931594">Errorf</span><span class="op" id="6931600">(</span><span class="string" id="6931601">&#34;Flags&nbsp;2:&nbsp;expected&nbsp;%x&nbsp;got&nbsp;%x&#34;</span><span class="op" id="6931630">,</span>&nbsp;<span class="ident" id="6931632">LstdFlags</span><span class="op" id="6931641">|</span><span class="ident" id="6931642">Lmicroseconds</span><span class="op" id="6931655">,</span>&nbsp;<span class="ident" id="6931657">f</span><span class="op" id="6931658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6931661">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6931664">p</span>&nbsp;<span class="op" id="6931666">:=</span>&nbsp;<span class="ident" id="6931669">l</span><span class="op" id="6931670">.</span><span class="ident" id="6931671">Prefix</span><span class="op" id="6931677">(</span><span class="op" id="6931678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6931681">if</span>&nbsp;<span class="ident" id="6931684">p</span>&nbsp;<span class="op" id="6931686">!=</span>&nbsp;<span class="string" id="6931689">&#34;Test:&#34;</span>&nbsp;<span class="op" id="6931697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6931701">t</span><span class="op" id="6931702">.</span><span class="ident" id="6931703">Errorf</span><span class="op" id="6931709">(</span><span class="string" id="6931710">`Prefix:&nbsp;expected&nbsp;&#34;Test:&#34;&nbsp;got&nbsp;%q`</span><span class="op" id="6931743">,</span>&nbsp;<span class="ident" id="6931745">p</span><span class="op" id="6931746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6931749">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6931752">l</span><span class="op" id="6931753">.</span><span class="ident" id="6931754">SetPrefix</span><span class="op" id="6931763">(</span><span class="string" id="6931764">&#34;Reality:&#34;</span><span class="op" id="6931774">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6931777">p</span>&nbsp;<span class="op" id="6931779">=</span>&nbsp;<span class="ident" id="6931781">l</span><span class="op" id="6931782">.</span><span class="ident" id="6931783">Prefix</span><span class="op" id="6931789">(</span><span class="op" id="6931790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6931793">if</span>&nbsp;<span class="ident" id="6931796">p</span>&nbsp;<span class="op" id="6931798">!=</span>&nbsp;<span class="string" id="6931801">&#34;Reality:&#34;</span>&nbsp;<span class="op" id="6931812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6931816">t</span><span class="op" id="6931817">.</span><span class="ident" id="6931818">Errorf</span><span class="op" id="6931824">(</span><span class="string" id="6931825">`Prefix:&nbsp;expected&nbsp;&#34;Reality:&#34;&nbsp;got&nbsp;%q`</span><span class="op" id="6931861">,</span>&nbsp;<span class="ident" id="6931863">p</span><span class="op" id="6931864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6931867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6931870">//&nbsp;Verify&nbsp;a&nbsp;log&nbsp;message&nbsp;looks&nbsp;right,&nbsp;with&nbsp;our&nbsp;prefix&nbsp;and&nbsp;microseconds&nbsp;present.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6931950">l</span><span class="op" id="6931951">.</span><span class="ident" id="6931952">Print</span><span class="op" id="6931957">(</span><span class="string" id="6931958">&#34;hello&#34;</span><span class="op" id="6931965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6931968">pattern</span>&nbsp;<span class="op" id="6931976">:=</span>&nbsp;<span class="string" id="6931979">&#34;^Reality:&#34;</span>&nbsp;<span class="op" id="6931991">+</span>&nbsp;<span class="ident" id="6931993">Rdate</span>&nbsp;<span class="op" id="6931999">+</span>&nbsp;<span class="string" id="6932001">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="6932005">+</span>&nbsp;<span class="ident" id="6932007">Rtime</span>&nbsp;<span class="op" id="6932013">+</span>&nbsp;<span class="ident" id="6932015">Rmicroseconds</span>&nbsp;<span class="op" id="6932029">+</span>&nbsp;<span class="string" id="6932031">&#34;&nbsp;hello\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6932043">matched</span><span class="op" id="6932050">,</span>&nbsp;<span class="ident" id="6932052">err</span>&nbsp;<span class="op" id="6932056">:=</span>&nbsp;<span class="ident" id="6932059">regexp</span><span class="op" id="6932065">.</span><span class="ident" id="6932066">Match</span><span class="op" id="6932071">(</span><span class="ident" id="6932072">pattern</span><span class="op" id="6932079">,</span>&nbsp;<span class="ident" id="6932081">b</span><span class="op" id="6932082">.</span><span class="ident" id="6932083">Bytes</span><span class="op" id="6932088">(</span><span class="op" id="6932089">)</span><span class="op" id="6932090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6932093">if</span>&nbsp;<span class="ident" id="6932096">err</span>&nbsp;<span class="op" id="6932100">!=</span>&nbsp;<span class="ident" id="6932103">nil</span>&nbsp;<span class="op" id="6932107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6932111">t</span><span class="op" id="6932112">.</span><span class="ident" id="6932113">Fatalf</span><span class="op" id="6932119">(</span><span class="string" id="6932120">&#34;pattern&nbsp;%q&nbsp;did&nbsp;not&nbsp;compile:&nbsp;%s&#34;</span><span class="op" id="6932152">,</span>&nbsp;<span class="ident" id="6932154">pattern</span><span class="op" id="6932161">,</span>&nbsp;<span class="ident" id="6932163">err</span><span class="op" id="6932166">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6932169">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6932172">if</span>&nbsp;<span class="op" id="6932175">!</span><span class="ident" id="6932176">matched</span>&nbsp;<span class="op" id="6932184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6932188">t</span><span class="op" id="6932189">.</span><span class="ident" id="6932190">Error</span><span class="op" id="6932195">(</span><span class="string" id="6932196">&#34;message&nbsp;did&nbsp;not&nbsp;match&nbsp;pattern&#34;</span><span class="op" id="6932227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6932230">}</span><br>
<span class="lineno"></span><span class="op" id="6932232">}</span>
</div>
</body>
</html>
