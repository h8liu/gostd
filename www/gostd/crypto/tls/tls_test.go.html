<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html" class="current">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8172657">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8172712">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8172766">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8172817">package</span>&nbsp;<span class="ident" id="8172825">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8172830">import</span>&nbsp;<span class="op" id="8172837">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8172840">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8172849">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8172856">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8172862">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8172869">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8172880">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8172891">&#34;time&#34;</span><br>
<span class="lineno">15</span><span class="op" id="8172898">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8172901">var</span>&nbsp;<span class="ident" id="8172905">rsaCertPEM</span>&nbsp;<span class="op" id="8172916">=</span>&nbsp;<span class="string" id="8172918">`-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIIB0zCCAX2gAwIBAgIJAI/M7BYjwB+uMA0GCSqGSIb3DQEBBQUAMEUxCzAJBgNV<br>
<span class="lineno"></span>BAYTAkFVMRMwEQYDVQQIDApTb21lLVN0YXRlMSEwHwYDVQQKDBhJbnRlcm5ldCBX<br>
<span class="lineno">20</span>aWRnaXRzIFB0eSBMdGQwHhcNMTIwOTEyMjE1MjAyWhcNMTUwOTEyMjE1MjAyWjBF<br>
<span class="lineno"></span>MQswCQYDVQQGEwJBVTETMBEGA1UECAwKU29tZS1TdGF0ZTEhMB8GA1UECgwYSW50<br>
<span class="lineno"></span>ZXJuZXQgV2lkZ2l0cyBQdHkgTHRkMFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBANLJ<br>
<span class="lineno"></span>hPHhITqQbPklG3ibCVxwGMRfp/v4XqhfdQHdcVfHap6NQ5Wok/4xIA+ui35/MmNa<br>
<span class="lineno"></span>rtNuC+BdZ1tMuVCPFZcCAwEAAaNQME4wHQYDVR0OBBYEFJvKs8RfJaXTH08W+SGv<br>
<span class="lineno">25</span>zQyKn0H8MB8GA1UdIwQYMBaAFJvKs8RfJaXTH08W+SGvzQyKn0H8MAwGA1UdEwQF<br>
<span class="lineno"></span>MAMBAf8wDQYJKoZIhvcNAQEFBQADQQBJlffJHybjDGxRMqaRmDhX0+6v02TUKZsW<br>
<span class="lineno"></span>r5QuVbpQhH6u+0UgcW0jp9QwpxoPTLTWGXEWBBBurxFwiCBhkQ+V<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="8173614">var</span>&nbsp;<span class="ident" id="8173618">rsaKeyPEM</span>&nbsp;<span class="op" id="8173628">=</span>&nbsp;<span class="string" id="8173630">`-----BEGIN&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno"></span>MIIBOwIBAAJBANLJhPHhITqQbPklG3ibCVxwGMRfp/v4XqhfdQHdcVfHap6NQ5Wo<br>
<span class="lineno"></span>k/4xIA+ui35/MmNartNuC+BdZ1tMuVCPFZcCAwEAAQJAEJ2N+zsR0Xn8/Q6twa4G<br>
<span class="lineno"></span>6OB1M1WO+k+ztnX/1SvNeWu8D6GImtupLTYgjZcHufykj09jiHmjHx8u8ZZB/o1N<br>
<span class="lineno">35</span>MQIhAPW+eyZo7ay3lMz1V01WVjNKK9QSn1MJlb06h/LuYv9FAiEA25WPedKgVyCW<br>
<span class="lineno"></span>SmUwbPw8fnTcpqDWE3yTO3vKcebqMSsCIBF3UmVue8YU3jybC3NxuXq3wNm34R8T<br>
<span class="lineno"></span>xVLHwDXh/6NJAiEAl2oHGGLz64BuAfjKrqwz7qMYr9HCLIe/YsoWq/olzScCIQDi<br>
<span class="lineno"></span>D2lWusoe2/nEqfDVVWGWlyJ7yOmqaVm/iNUN9B2N2g==<br>
<span class="lineno"></span>-----END&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno">40</span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8174131">//&nbsp;keyPEM&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;rsaKeyPEM,&nbsp;but&nbsp;declares&nbsp;itself&nbsp;as&nbsp;just</span><br>
<span class="lineno"></span><span class="comment" id="8174195">//&nbsp;&#34;PRIVATE&nbsp;KEY&#34;,&nbsp;not&nbsp;&#34;RSA&nbsp;PRIVATE&nbsp;KEY&#34;.&nbsp;&nbsp;http://golang.org/issue/4477</span><br>
<span class="lineno"></span><span class="keyword" id="8174266">var</span>&nbsp;<span class="ident" id="8174270">keyPEM</span>&nbsp;<span class="op" id="8174277">=</span>&nbsp;<span class="string" id="8174279">`-----BEGIN&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno">45</span>MIIBOwIBAAJBANLJhPHhITqQbPklG3ibCVxwGMRfp/v4XqhfdQHdcVfHap6NQ5Wo<br>
<span class="lineno"></span>k/4xIA+ui35/MmNartNuC+BdZ1tMuVCPFZcCAwEAAQJAEJ2N+zsR0Xn8/Q6twa4G<br>
<span class="lineno"></span>6OB1M1WO+k+ztnX/1SvNeWu8D6GImtupLTYgjZcHufykj09jiHmjHx8u8ZZB/o1N<br>
<span class="lineno"></span>MQIhAPW+eyZo7ay3lMz1V01WVjNKK9QSn1MJlb06h/LuYv9FAiEA25WPedKgVyCW<br>
<span class="lineno"></span>SmUwbPw8fnTcpqDWE3yTO3vKcebqMSsCIBF3UmVue8YU3jybC3NxuXq3wNm34R8T<br>
<span class="lineno">50</span>xVLHwDXh/6NJAiEAl2oHGGLz64BuAfjKrqwz7qMYr9HCLIe/YsoWq/olzScCIQDi<br>
<span class="lineno"></span>D2lWusoe2/nEqfDVVWGWlyJ7yOmqaVm/iNUN9B2N2g==<br>
<span class="lineno"></span>-----END&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="8174772">var</span>&nbsp;<span class="ident" id="8174776">ecdsaCertPEM</span>&nbsp;<span class="op" id="8174789">=</span>&nbsp;<span class="string" id="8174791">`-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIIB/jCCAWICCQDscdUxw16XFDAJBgcqhkjOPQQBMEUxCzAJBgNVBAYTAkFVMRMw<br>
<span class="lineno"></span>EQYDVQQIEwpTb21lLVN0YXRlMSEwHwYDVQQKExhJbnRlcm5ldCBXaWRnaXRzIFB0<br>
<span class="lineno"></span>eSBMdGQwHhcNMTIxMTE0MTI0MDQ4WhcNMTUxMTE0MTI0MDQ4WjBFMQswCQYDVQQG<br>
<span class="lineno"></span>EwJBVTETMBEGA1UECBMKU29tZS1TdGF0ZTEhMB8GA1UEChMYSW50ZXJuZXQgV2lk<br>
<span class="lineno">60</span>Z2l0cyBQdHkgTHRkMIGbMBAGByqGSM49AgEGBSuBBAAjA4GGAAQBY9+my9OoeSUR<br>
<span class="lineno"></span>lDQdV/x8LsOuLilthhiS1Tz4aGDHIPwC1mlvnf7fg5lecYpMCrLLhauAc1UJXcgl<br>
<span class="lineno"></span>01xoLuzgtAEAgv2P/jgytzRSpUYvgLBt1UA0leLYBy6mQQbrNEuqT3INapKIcUv8<br>
<span class="lineno"></span>XxYP0xMEUksLPq6Ca+CRSqTtrd/23uTnapkwCQYHKoZIzj0EAQOBigAwgYYCQXJo<br>
<span class="lineno"></span>A7Sl2nLVf+4Iu/tAX/IF4MavARKC4PPHK3zfuGfPR3oCCcsAoz3kAzOeijvd0iXb<br>
<span class="lineno">65</span>H5jBImIxPL4WxQNiBTexAkF8D1EtpYuWdlVQ80/h/f4pBcGiXPqX5h2PQSQY7hP1<br>
<span class="lineno"></span>+jwM1FGS4fREIOvlBYr/SzzQRtwrvrzGYxDEDbsC0ZGRnA==<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="keyword" id="8175548">var</span>&nbsp;<span class="ident" id="8175552">ecdsaKeyPEM</span>&nbsp;<span class="op" id="8175564">=</span>&nbsp;<span class="string" id="8175566">`-----BEGIN&nbsp;EC&nbsp;PARAMETERS-----<br>
<span class="lineno"></span>BgUrgQQAIw==<br>
<span class="lineno"></span>-----END&nbsp;EC&nbsp;PARAMETERS-----<br>
<span class="lineno"></span>-----BEGIN&nbsp;EC&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno"></span>MIHcAgEBBEIBrsoKp0oqcv6/JovJJDoDVSGWdirrkgCWxrprGlzB9o0X8fV675X0<br>
<span class="lineno">75</span>NwuBenXFfeZvVcwluO7/Q9wkYoPd/t3jGImgBwYFK4EEACOhgYkDgYYABAFj36bL<br>
<span class="lineno"></span>06h5JRGUNB1X/Hwuw64uKW2GGJLVPPhoYMcg/ALWaW+d/t+DmV5xikwKssuFq4Bz<br>
<span class="lineno"></span>VQldyCXTXGgu7OC0AQCC/Y/+ODK3NFKlRi+AsG3VQDSV4tgHLqZBBus0S6pPcg1q<br>
<span class="lineno"></span>kohxS/xfFg/TEwRSSws+roJr4JFKpO2t3/be5OdqmQ==<br>
<span class="lineno"></span>-----END&nbsp;EC&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno">80</span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8176006">var</span>&nbsp;<span class="ident" id="8176010">keyPairTests</span>&nbsp;<span class="op" id="8176023">=</span>&nbsp;<span class="op" id="8176025">[</span><span class="op" id="8176026">]</span><span class="keyword" id="8176027">struct</span>&nbsp;<span class="op" id="8176034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8176037">algo</span>&nbsp;<span class="builtintype" id="8176042">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8176050">cert</span>&nbsp;<span class="builtintype" id="8176055">string</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8176063">key</span>&nbsp;&nbsp;<span class="builtintype" id="8176068">string</span><br>
<span class="lineno"></span><span class="op" id="8176075">}</span><span class="op" id="8176076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8176079">{</span><span class="string" id="8176080">&#34;ECDSA&#34;</span><span class="op" id="8176087">,</span>&nbsp;<span class="ident" id="8176089"><a href="/gostd/crypto/tls/tls_test.go.html#8174776">ecdsaCertPEM</a></span><span class="op" id="8176101">,</span>&nbsp;<span class="ident" id="8176103"><a href="/gostd/crypto/tls/tls_test.go.html#8175552">ecdsaKeyPEM</a></span><span class="op" id="8176114">}</span><span class="op" id="8176115">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8176118">{</span><span class="string" id="8176119">&#34;RSA&#34;</span><span class="op" id="8176124">,</span>&nbsp;<span class="ident" id="8176126"><a href="/gostd/crypto/tls/tls_test.go.html#8172905">rsaCertPEM</a></span><span class="op" id="8176136">,</span>&nbsp;<span class="ident" id="8176138"><a href="/gostd/crypto/tls/tls_test.go.html#8173618">rsaKeyPEM</a></span><span class="op" id="8176147">}</span><span class="op" id="8176148">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8176151">{</span><span class="string" id="8176152">&#34;RSA-untyped&#34;</span><span class="op" id="8176165">,</span>&nbsp;<span class="ident" id="8176167"><a href="/gostd/crypto/tls/tls_test.go.html#8172905">rsaCertPEM</a></span><span class="op" id="8176177">,</span>&nbsp;<span class="ident" id="8176179"><a href="/gostd/crypto/tls/tls_test.go.html#8174270">keyPEM</a></span><span class="op" id="8176185">}</span><span class="op" id="8176186">,</span>&nbsp;<span class="comment" id="8176188">//&nbsp;golang.org/issue/4477</span><br>
<span class="lineno">90</span><span class="op" id="8176213">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8176216">func</span>&nbsp;<span class="ident" id="8176221">TestX509KeyPair</span><span class="op" id="8176236">(</span><span class="ident" id="8176237">t</span>&nbsp;<span class="op" id="8176239">*</span><span class="ident" id="8176240"><a href="/gostd/crypto/tls/tls_test.go.html#8172880">testing</a></span><span class="op" id="8176247">.</span><span class="ident" id="8176248"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="8176249">)</span>&nbsp;<span class="op" id="8176251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8176254">var</span>&nbsp;<span class="ident" id="8176258">pem</span>&nbsp;<span class="op" id="8176262">[</span><span class="op" id="8176263">]</span><span class="builtintype" id="8176264">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8176270">for</span>&nbsp;<span class="ident" id="8176274">_</span><span class="op" id="8176275">,</span>&nbsp;<span class="ident" id="8176277">test</span>&nbsp;<span class="op" id="8176282">:=</span>&nbsp;<span class="keyword" id="8176285">range</span>&nbsp;<span class="ident" id="8176291"><a href="/gostd/crypto/tls/tls_test.go.html#8176010">keyPairTests</a></span>&nbsp;<span class="op" id="8176304">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8176308"><a href="/gostd/crypto/tls/tls_test.go.html#8176258">pem</a></span>&nbsp;<span class="op" id="8176312">=</span>&nbsp;<span class="op" id="8176314">[</span><span class="op" id="8176315">]</span><span class="builtintype" id="8176316">byte</span><span class="op" id="8176320">(</span><span class="ident" id="8176321"><a href="/gostd/crypto/tls/tls_test.go.html#8176277">test</a></span><span class="op" id="8176325">.</span><span class="ident" id="8176326"><a href="/gostd/crypto/tls/tls_test.go.html#8176050">cert</a></span>&nbsp;<span class="op" id="8176331">+</span>&nbsp;<span class="ident" id="8176333"><a href="/gostd/crypto/tls/tls_test.go.html#8176277">test</a></span><span class="op" id="8176337">.</span><span class="ident" id="8176338"><a href="/gostd/crypto/tls/tls_test.go.html#8176063">key</a></span><span class="op" id="8176341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8176345">if</span>&nbsp;<span class="ident" id="8176348">_</span><span class="op" id="8176349">,</span>&nbsp;<span class="ident" id="8176351">err</span>&nbsp;<span class="op" id="8176355">:=</span>&nbsp;<span class="ident" id="8176358"><a href="/gostd/crypto/tls/tls.go.html#4588297">X509KeyPair</a></span><span class="op" id="8176369">(</span><span class="ident" id="8176370"><a href="/gostd/crypto/tls/tls_test.go.html#8176258">pem</a></span><span class="op" id="8176373">,</span>&nbsp;<span class="ident" id="8176375"><a href="/gostd/crypto/tls/tls_test.go.html#8176258">pem</a></span><span class="op" id="8176378">)</span><span class="op" id="8176379">;</span>&nbsp;<span class="ident" id="8176381"><a href="/gostd/crypto/tls/tls_test.go.html#8176351">err</a></span>&nbsp;<span class="op" id="8176385">!=</span>&nbsp;<span class="builtintype" id="8176388">nil</span>&nbsp;<span class="op" id="8176392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8176397"><a href="/gostd/crypto/tls/tls_test.go.html#8176237">t</a></span><span class="op" id="8176398">.</span><span class="ident" id="8176399"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8176405">(</span><span class="string" id="8176406">&#34;Failed&nbsp;to&nbsp;load&nbsp;%s&nbsp;cert&nbsp;followed&nbsp;by&nbsp;%s&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="8176453">,</span>&nbsp;<span class="ident" id="8176455"><a href="/gostd/crypto/tls/tls_test.go.html#8176277">test</a></span><span class="op" id="8176459">.</span><span class="ident" id="8176460"><a href="/gostd/crypto/tls/tls_test.go.html#8176037">algo</a></span><span class="op" id="8176464">,</span>&nbsp;<span class="ident" id="8176466"><a href="/gostd/crypto/tls/tls_test.go.html#8176277">test</a></span><span class="op" id="8176470">.</span><span class="ident" id="8176471"><a href="/gostd/crypto/tls/tls_test.go.html#8176037">algo</a></span><span class="op" id="8176475">,</span>&nbsp;<span class="ident" id="8176477"><a href="/gostd/crypto/tls/tls_test.go.html#8176351">err</a></span><span class="op" id="8176480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8176484">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8176488"><a href="/gostd/crypto/tls/tls_test.go.html#8176258">pem</a></span>&nbsp;<span class="op" id="8176492">=</span>&nbsp;<span class="op" id="8176494">[</span><span class="op" id="8176495">]</span><span class="builtintype" id="8176496">byte</span><span class="op" id="8176500">(</span><span class="ident" id="8176501"><a href="/gostd/crypto/tls/tls_test.go.html#8176277">test</a></span><span class="op" id="8176505">.</span><span class="ident" id="8176506"><a href="/gostd/crypto/tls/tls_test.go.html#8176063">key</a></span>&nbsp;<span class="op" id="8176510">+</span>&nbsp;<span class="ident" id="8176512"><a href="/gostd/crypto/tls/tls_test.go.html#8176277">test</a></span><span class="op" id="8176516">.</span><span class="ident" id="8176517"><a href="/gostd/crypto/tls/tls_test.go.html#8176050">cert</a></span><span class="op" id="8176521">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8176525">if</span>&nbsp;<span class="ident" id="8176528">_</span><span class="op" id="8176529">,</span>&nbsp;<span class="ident" id="8176531">err</span>&nbsp;<span class="op" id="8176535">:=</span>&nbsp;<span class="ident" id="8176538"><a href="/gostd/crypto/tls/tls.go.html#4588297">X509KeyPair</a></span><span class="op" id="8176549">(</span><span class="ident" id="8176550"><a href="/gostd/crypto/tls/tls_test.go.html#8176258">pem</a></span><span class="op" id="8176553">,</span>&nbsp;<span class="ident" id="8176555"><a href="/gostd/crypto/tls/tls_test.go.html#8176258">pem</a></span><span class="op" id="8176558">)</span><span class="op" id="8176559">;</span>&nbsp;<span class="ident" id="8176561"><a href="/gostd/crypto/tls/tls_test.go.html#8176531">err</a></span>&nbsp;<span class="op" id="8176565">!=</span>&nbsp;<span class="builtintype" id="8176568">nil</span>&nbsp;<span class="op" id="8176572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8176577"><a href="/gostd/crypto/tls/tls_test.go.html#8176237">t</a></span><span class="op" id="8176578">.</span><span class="ident" id="8176579"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8176585">(</span><span class="string" id="8176586">&#34;Failed&nbsp;to&nbsp;load&nbsp;%s&nbsp;key&nbsp;followed&nbsp;by&nbsp;%s&nbsp;cert:&nbsp;%s&#34;</span><span class="op" id="8176633">,</span>&nbsp;<span class="ident" id="8176635"><a href="/gostd/crypto/tls/tls_test.go.html#8176277">test</a></span><span class="op" id="8176639">.</span><span class="ident" id="8176640"><a href="/gostd/crypto/tls/tls_test.go.html#8176037">algo</a></span><span class="op" id="8176644">,</span>&nbsp;<span class="ident" id="8176646"><a href="/gostd/crypto/tls/tls_test.go.html#8176277">test</a></span><span class="op" id="8176650">.</span><span class="ident" id="8176651"><a href="/gostd/crypto/tls/tls_test.go.html#8176037">algo</a></span><span class="op" id="8176655">,</span>&nbsp;<span class="ident" id="8176657"><a href="/gostd/crypto/tls/tls_test.go.html#8176531">err</a></span><span class="op" id="8176660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8176664">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8176667">}</span><br>
<span class="lineno"></span><span class="op" id="8176669">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="keyword" id="8176672">func</span>&nbsp;<span class="ident" id="8176677">TestX509MixedKeyPair</span><span class="op" id="8176697">(</span><span class="ident" id="8176698">t</span>&nbsp;<span class="op" id="8176700">*</span><span class="ident" id="8176701"><a href="/gostd/crypto/tls/tls_test.go.html#8172880">testing</a></span><span class="op" id="8176708">.</span><span class="ident" id="8176709"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="8176710">)</span>&nbsp;<span class="op" id="8176712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8176715">if</span>&nbsp;<span class="ident" id="8176718">_</span><span class="op" id="8176719">,</span>&nbsp;<span class="ident" id="8176721">err</span>&nbsp;<span class="op" id="8176725">:=</span>&nbsp;<span class="ident" id="8176728"><a href="/gostd/crypto/tls/tls.go.html#4588297">X509KeyPair</a></span><span class="op" id="8176739">(</span><span class="op" id="8176740">[</span><span class="op" id="8176741">]</span><span class="builtintype" id="8176742">byte</span><span class="op" id="8176746">(</span><span class="ident" id="8176747"><a href="/gostd/crypto/tls/tls_test.go.html#8172905">rsaCertPEM</a></span><span class="op" id="8176757">)</span><span class="op" id="8176758">,</span>&nbsp;<span class="op" id="8176760">[</span><span class="op" id="8176761">]</span><span class="builtintype" id="8176762">byte</span><span class="op" id="8176766">(</span><span class="ident" id="8176767"><a href="/gostd/crypto/tls/tls_test.go.html#8175552">ecdsaKeyPEM</a></span><span class="op" id="8176778">)</span><span class="op" id="8176779">)</span><span class="op" id="8176780">;</span>&nbsp;<span class="ident" id="8176782"><a href="/gostd/crypto/tls/tls_test.go.html#8176721">err</a></span>&nbsp;<span class="op" id="8176786">==</span>&nbsp;<span class="builtintype" id="8176789">nil</span>&nbsp;<span class="op" id="8176793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8176797"><a href="/gostd/crypto/tls/tls_test.go.html#8176698">t</a></span><span class="op" id="8176798">.</span><span class="ident" id="8176799"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="8176804">(</span><span class="string" id="8176805">&#34;Load&nbsp;of&nbsp;RSA&nbsp;certificate&nbsp;succeeded&nbsp;with&nbsp;ECDSA&nbsp;private&nbsp;key&#34;</span><span class="op" id="8176863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8176866">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8176869">if</span>&nbsp;<span class="ident" id="8176872">_</span><span class="op" id="8176873">,</span>&nbsp;<span class="ident" id="8176875">err</span>&nbsp;<span class="op" id="8176879">:=</span>&nbsp;<span class="ident" id="8176882"><a href="/gostd/crypto/tls/tls.go.html#4588297">X509KeyPair</a></span><span class="op" id="8176893">(</span><span class="op" id="8176894">[</span><span class="op" id="8176895">]</span><span class="builtintype" id="8176896">byte</span><span class="op" id="8176900">(</span><span class="ident" id="8176901"><a href="/gostd/crypto/tls/tls_test.go.html#8174776">ecdsaCertPEM</a></span><span class="op" id="8176913">)</span><span class="op" id="8176914">,</span>&nbsp;<span class="op" id="8176916">[</span><span class="op" id="8176917">]</span><span class="builtintype" id="8176918">byte</span><span class="op" id="8176922">(</span><span class="ident" id="8176923"><a href="/gostd/crypto/tls/tls_test.go.html#8173618">rsaKeyPEM</a></span><span class="op" id="8176932">)</span><span class="op" id="8176933">)</span><span class="op" id="8176934">;</span>&nbsp;<span class="ident" id="8176936"><a href="/gostd/crypto/tls/tls_test.go.html#8176875">err</a></span>&nbsp;<span class="op" id="8176940">==</span>&nbsp;<span class="builtintype" id="8176943">nil</span>&nbsp;<span class="op" id="8176947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8176951"><a href="/gostd/crypto/tls/tls_test.go.html#8176698">t</a></span><span class="op" id="8176952">.</span><span class="ident" id="8176953"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="8176958">(</span><span class="string" id="8176959">&#34;Load&nbsp;of&nbsp;ECDSA&nbsp;certificate&nbsp;succeeded&nbsp;with&nbsp;RSA&nbsp;private&nbsp;key&#34;</span><span class="op" id="8177017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8177020">}</span><br>
<span class="lineno"></span><span class="op" id="8177022">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="8177025">func</span>&nbsp;<span class="ident" id="8177030">newLocalListener</span><span class="op" id="8177046">(</span><span class="ident" id="8177047">t</span>&nbsp;<span class="op" id="8177049">*</span><span class="ident" id="8177050"><a href="/gostd/crypto/tls/tls_test.go.html#8172880">testing</a></span><span class="op" id="8177057">.</span><span class="ident" id="8177058"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="8177059">)</span>&nbsp;<span class="ident" id="8177061"><a href="/gostd/crypto/tls/tls_test.go.html#8172862">net</a></span><span class="op" id="8177064">.</span><span class="ident" id="8177065"><a href="/gostd/net/net.go.html#3340703">Listener</a></span>&nbsp;<span class="op" id="8177074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8177077">ln</span><span class="op" id="8177079">,</span>&nbsp;<span class="ident" id="8177081">err</span>&nbsp;<span class="op" id="8177085">:=</span>&nbsp;<span class="ident" id="8177088"><a href="/gostd/crypto/tls/tls_test.go.html#8172862">net</a></span><span class="op" id="8177091">.</span><span class="ident" id="8177092"><a href="/gostd/net/dial.go.html#3207117">Listen</a></span><span class="op" id="8177098">(</span><span class="string" id="8177099">&#34;tcp&#34;</span><span class="op" id="8177104">,</span>&nbsp;<span class="string" id="8177106">&#34;127.0.0.1:0&#34;</span><span class="op" id="8177119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8177122">if</span>&nbsp;<span class="ident" id="8177125"><a href="/gostd/crypto/tls/tls_test.go.html#8177081">err</a></span>&nbsp;<span class="op" id="8177129">!=</span>&nbsp;<span class="builtintype" id="8177132">nil</span>&nbsp;<span class="op" id="8177136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8177140"><a href="/gostd/crypto/tls/tls_test.go.html#8177077">ln</a></span><span class="op" id="8177142">,</span>&nbsp;<span class="ident" id="8177144"><a href="/gostd/crypto/tls/tls_test.go.html#8177081">err</a></span>&nbsp;<span class="op" id="8177148">=</span>&nbsp;<span class="ident" id="8177150"><a href="/gostd/crypto/tls/tls_test.go.html#8172862">net</a></span><span class="op" id="8177153">.</span><span class="ident" id="8177154"><a href="/gostd/net/dial.go.html#3207117">Listen</a></span><span class="op" id="8177160">(</span><span class="string" id="8177161">&#34;tcp6&#34;</span><span class="op" id="8177167">,</span>&nbsp;<span class="string" id="8177169">&#34;[::1]:0&#34;</span><span class="op" id="8177178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8177181">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8177184">if</span>&nbsp;<span class="ident" id="8177187"><a href="/gostd/crypto/tls/tls_test.go.html#8177081">err</a></span>&nbsp;<span class="op" id="8177191">!=</span>&nbsp;<span class="builtintype" id="8177194">nil</span>&nbsp;<span class="op" id="8177198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8177202"><a href="/gostd/crypto/tls/tls_test.go.html#8177047">t</a></span><span class="op" id="8177203">.</span><span class="ident" id="8177204"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="8177209">(</span><span class="ident" id="8177210"><a href="/gostd/crypto/tls/tls_test.go.html#8177081">err</a></span><span class="op" id="8177213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8177216">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8177219">return</span>&nbsp;<span class="ident" id="8177226"><a href="/gostd/crypto/tls/tls_test.go.html#8177077">ln</a></span><br>
<span class="lineno"></span><span class="op" id="8177229">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="keyword" id="8177232">func</span>&nbsp;<span class="ident" id="8177237">TestDialTimeout</span><span class="op" id="8177252">(</span><span class="ident" id="8177253">t</span>&nbsp;<span class="op" id="8177255">*</span><span class="ident" id="8177256"><a href="/gostd/crypto/tls/tls_test.go.html#8172880">testing</a></span><span class="op" id="8177263">.</span><span class="ident" id="8177264"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="8177265">)</span>&nbsp;<span class="op" id="8177267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8177270">if</span>&nbsp;<span class="ident" id="8177273"><a href="/gostd/crypto/tls/tls_test.go.html#8172880">testing</a></span><span class="op" id="8177280">.</span><span class="ident" id="8177281"><a href="/gostd/testing/testing.go.html#5475359">Short</a></span><span class="op" id="8177286">(</span><span class="op" id="8177287">)</span>&nbsp;<span class="op" id="8177289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8177293"><a href="/gostd/crypto/tls/tls_test.go.html#8177253">t</a></span><span class="op" id="8177294">.</span><span class="ident" id="8177295"><a href="/gostd/testing/testing.go.html#5480575">Skip</a></span><span class="op" id="8177299">(</span><span class="string" id="8177300">&#34;skipping&nbsp;in&nbsp;short&nbsp;mode&#34;</span><span class="op" id="8177324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8177327">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8177330">listener</span>&nbsp;<span class="op" id="8177339">:=</span>&nbsp;<span class="ident" id="8177342"><a href="/gostd/crypto/tls/tls_test.go.html#8177030">newLocalListener</a></span><span class="op" id="8177358">(</span><span class="ident" id="8177359"><a href="/gostd/crypto/tls/tls_test.go.html#8177253">t</a></span><span class="op" id="8177360">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8177364">addr</span>&nbsp;<span class="op" id="8177369">:=</span>&nbsp;<span class="ident" id="8177372"><a href="/gostd/crypto/tls/tls_test.go.html#8177330">listener</a></span><span class="op" id="8177380">.</span><span class="ident" id="8177381"><a href="/gostd/net/net.go.html#3340993">Addr</a></span><span class="op" id="8177385">(</span><span class="op" id="8177386">)</span><span class="op" id="8177387">.</span><span class="ident" id="8177388"><a href="/gostd/net/net.go.html#3334238">String</a></span><span class="op" id="8177394">(</span><span class="op" id="8177395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8177398">defer</span>&nbsp;<span class="ident" id="8177404"><a href="/gostd/crypto/tls/tls_test.go.html#8177330">listener</a></span><span class="op" id="8177412">.</span><span class="ident" id="8177413"><a href="/gostd/net/net.go.html#3340928">Close</a></span><span class="op" id="8177418">(</span><span class="op" id="8177419">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8177423">complete</span>&nbsp;<span class="op" id="8177432">:=</span>&nbsp;<span class="builtinfunc" id="8177435">make</span><span class="op" id="8177439">(</span><span class="keyword" id="8177440">chan</span>&nbsp;<span class="builtintype" id="8177445">bool</span><span class="op" id="8177449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8177452">defer</span>&nbsp;<span class="builtinfunc" id="8177458">close</span><span class="op" id="8177463">(</span><span class="ident" id="8177464"><a href="/gostd/crypto/tls/tls_test.go.html#8177423">complete</a></span><span class="op" id="8177472">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8177476">go</span>&nbsp;<span class="keyword" id="8177479">func</span><span class="op" id="8177483">(</span><span class="op" id="8177484">)</span>&nbsp;<span class="op" id="8177486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8177490">conn</span><span class="op" id="8177494">,</span>&nbsp;<span class="ident" id="8177496">err</span>&nbsp;<span class="op" id="8177500">:=</span>&nbsp;<span class="ident" id="8177503"><a href="/gostd/crypto/tls/tls_test.go.html#8177330">listener</a></span><span class="op" id="8177511">.</span><span class="ident" id="8177512"><a href="/gostd/net/net.go.html#3340795">Accept</a></span><span class="op" id="8177518">(</span><span class="op" id="8177519">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8177523">if</span>&nbsp;<span class="ident" id="8177526"><a href="/gostd/crypto/tls/tls_test.go.html#8177496">err</a></span>&nbsp;<span class="op" id="8177530">!=</span>&nbsp;<span class="builtintype" id="8177533">nil</span>&nbsp;<span class="op" id="8177537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8177542"><a href="/gostd/crypto/tls/tls_test.go.html#8177253">t</a></span><span class="op" id="8177543">.</span><span class="ident" id="8177544"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="8177549">(</span><span class="ident" id="8177550"><a href="/gostd/crypto/tls/tls_test.go.html#8177496">err</a></span><span class="op" id="8177553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8177558">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8177567">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8177571">&lt;-</span><span class="ident" id="8177573"><a href="/gostd/crypto/tls/tls_test.go.html#8177423">complete</a></span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8177584"><a href="/gostd/crypto/tls/tls_test.go.html#8177490">conn</a></span><span class="op" id="8177588">.</span><span class="ident" id="8177589"><a href="/gostd/net/net.go.html#3334987">Close</a></span><span class="op" id="8177594">(</span><span class="op" id="8177595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8177598">}</span><span class="op" id="8177599">(</span><span class="op" id="8177600">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8177604">dialer</span>&nbsp;<span class="op" id="8177611">:=</span>&nbsp;<span class="op" id="8177614">&amp;</span><span class="ident" id="8177615"><a href="/gostd/crypto/tls/tls_test.go.html#8172862">net</a></span><span class="op" id="8177618">.</span><span class="ident" id="8177619"><a href="/gostd/net/dial.go.html#3199756">Dialer</a></span><span class="op" id="8177625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8177629"><a href="/gostd/net/dial.go.html#3200103">Timeout</a></span><span class="op" id="8177636">:</span>&nbsp;<span class="num" id="8177638">10</span>&nbsp;<span class="op" id="8177641">*</span>&nbsp;<span class="ident" id="8177643"><a href="/gostd/crypto/tls/tls_test.go.html#8172891">time</a></span><span class="op" id="8177647">.</span><span class="ident" id="8177648"><a href="/gostd/time/time.go.html#2734819">Millisecond</a></span><span class="op" id="8177659">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8177662">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8177666">var</span>&nbsp;<span class="ident" id="8177670">err</span>&nbsp;<span class="builtintype" id="8177674">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8177681">if</span>&nbsp;<span class="ident" id="8177684">_</span><span class="op" id="8177685">,</span>&nbsp;<span class="ident" id="8177687"><a href="/gostd/crypto/tls/tls_test.go.html#8177670">err</a></span>&nbsp;<span class="op" id="8177691">=</span>&nbsp;<span class="ident" id="8177693"><a href="/gostd/crypto/tls/tls.go.html#4586021">DialWithDialer</a></span><span class="op" id="8177707">(</span><span class="ident" id="8177708"><a href="/gostd/crypto/tls/tls_test.go.html#8177604">dialer</a></span><span class="op" id="8177714">,</span>&nbsp;<span class="string" id="8177716">&#34;tcp&#34;</span><span class="op" id="8177721">,</span>&nbsp;<span class="ident" id="8177723"><a href="/gostd/crypto/tls/tls_test.go.html#8177364">addr</a></span><span class="op" id="8177727">,</span>&nbsp;<span class="builtintype" id="8177729">nil</span><span class="op" id="8177732">)</span><span class="op" id="8177733">;</span>&nbsp;<span class="ident" id="8177735"><a href="/gostd/crypto/tls/tls_test.go.html#8177670">err</a></span>&nbsp;<span class="op" id="8177739">==</span>&nbsp;<span class="builtintype" id="8177742">nil</span>&nbsp;<span class="op" id="8177746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8177750"><a href="/gostd/crypto/tls/tls_test.go.html#8177253">t</a></span><span class="op" id="8177751">.</span><span class="ident" id="8177752"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="8177757">(</span><span class="string" id="8177758">&#34;DialWithTimeout&nbsp;completed&nbsp;successfully&#34;</span><span class="op" id="8177798">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8177801">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8177805">if</span>&nbsp;<span class="op" id="8177808">!</span><span class="ident" id="8177809"><a href="/gostd/crypto/tls/tls_test.go.html#8172869">strings</a></span><span class="op" id="8177816">.</span><span class="ident" id="8177817"><a href="/gostd/strings/strings.go.html#2968416">Contains</a></span><span class="op" id="8177825">(</span><span class="ident" id="8177826"><a href="/gostd/crypto/tls/tls_test.go.html#8177670">err</a></span><span class="op" id="8177829">.</span><span class="ident" id="8177830">Error</span><span class="op" id="8177835">(</span><span class="op" id="8177836">)</span><span class="op" id="8177837">,</span>&nbsp;<span class="string" id="8177839">&#34;timed&nbsp;out&#34;</span><span class="op" id="8177850">)</span>&nbsp;<span class="op" id="8177852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8177856"><a href="/gostd/crypto/tls/tls_test.go.html#8177253">t</a></span><span class="op" id="8177857">.</span><span class="ident" id="8177858"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8177864">(</span><span class="string" id="8177865">&#34;resulting&nbsp;error&nbsp;not&nbsp;a&nbsp;timeout:&nbsp;%s&#34;</span><span class="op" id="8177900">,</span>&nbsp;<span class="ident" id="8177902"><a href="/gostd/crypto/tls/tls_test.go.html#8177670">err</a></span><span class="op" id="8177905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8177908">}</span><br>
<span class="lineno">160</span><span class="op" id="8177910">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8177913">//&nbsp;tests&nbsp;that&nbsp;Conn.Read&nbsp;returns&nbsp;(non-zero,&nbsp;io.EOF)&nbsp;instead&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="8177975">//&nbsp;(non-zero,&nbsp;nil)&nbsp;when&nbsp;a&nbsp;Close&nbsp;(alertCloseNotify)&nbsp;is&nbsp;sitting&nbsp;right</span><br>
<span class="lineno"></span><span class="comment" id="8178043">//&nbsp;behind&nbsp;the&nbsp;application&nbsp;data&nbsp;in&nbsp;the&nbsp;buffer.</span><br>
<span class="lineno">165</span><span class="keyword" id="8178089">func</span>&nbsp;<span class="ident" id="8178094">TestConnReadNonzeroAndEOF</span><span class="op" id="8178119">(</span><span class="ident" id="8178120">t</span>&nbsp;<span class="op" id="8178122">*</span><span class="ident" id="8178123"><a href="/gostd/crypto/tls/tls_test.go.html#8172880">testing</a></span><span class="op" id="8178130">.</span><span class="ident" id="8178131"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="8178132">)</span>&nbsp;<span class="op" id="8178134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8178137">//&nbsp;This&nbsp;test&nbsp;is&nbsp;racy:&nbsp;it&nbsp;assumes&nbsp;that&nbsp;after&nbsp;a&nbsp;write&nbsp;to&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8178195">//&nbsp;localhost&nbsp;TCP&nbsp;connection,&nbsp;the&nbsp;peer&nbsp;TCP&nbsp;connection&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8178253">//&nbsp;immediately&nbsp;read&nbsp;it.&nbsp;&nbsp;Because&nbsp;it&#39;s&nbsp;racy,&nbsp;we&nbsp;skip&nbsp;this&nbsp;test</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8178316">//&nbsp;in&nbsp;short&nbsp;mode,&nbsp;and&nbsp;then&nbsp;retry&nbsp;it&nbsp;several&nbsp;times&nbsp;with&nbsp;an</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8178375">//&nbsp;increasing&nbsp;sleep&nbsp;in&nbsp;between&nbsp;our&nbsp;final&nbsp;write&nbsp;(via&nbsp;srv.Close</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8178438">//&nbsp;below)&nbsp;and&nbsp;the&nbsp;following&nbsp;read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8178473">if</span>&nbsp;<span class="ident" id="8178476"><a href="/gostd/crypto/tls/tls_test.go.html#8172880">testing</a></span><span class="op" id="8178483">.</span><span class="ident" id="8178484"><a href="/gostd/testing/testing.go.html#5475359">Short</a></span><span class="op" id="8178489">(</span><span class="op" id="8178490">)</span>&nbsp;<span class="op" id="8178492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8178496"><a href="/gostd/crypto/tls/tls_test.go.html#8178120">t</a></span><span class="op" id="8178497">.</span><span class="ident" id="8178498"><a href="/gostd/testing/testing.go.html#5480575">Skip</a></span><span class="op" id="8178502">(</span><span class="string" id="8178503">&#34;skipping&nbsp;in&nbsp;short&nbsp;mode&#34;</span><span class="op" id="8178527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8178530">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8178533">var</span>&nbsp;<span class="ident" id="8178537">err</span>&nbsp;<span class="builtintype" id="8178541">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8178548">for</span>&nbsp;<span class="ident" id="8178552">delay</span>&nbsp;<span class="op" id="8178558">:=</span>&nbsp;<span class="ident" id="8178561"><a href="/gostd/crypto/tls/tls_test.go.html#8172891">time</a></span><span class="op" id="8178565">.</span><span class="ident" id="8178566"><a href="/gostd/time/time.go.html#2734819">Millisecond</a></span><span class="op" id="8178577">;</span>&nbsp;<span class="ident" id="8178579"><a href="/gostd/crypto/tls/tls_test.go.html#8178552">delay</a></span>&nbsp;<span class="op" id="8178585">&lt;=</span>&nbsp;<span class="num" id="8178588">64</span><span class="op" id="8178590">*</span><span class="ident" id="8178591"><a href="/gostd/crypto/tls/tls_test.go.html#8172891">time</a></span><span class="op" id="8178595">.</span><span class="ident" id="8178596"><a href="/gostd/time/time.go.html#2734819">Millisecond</a></span><span class="op" id="8178607">;</span>&nbsp;<span class="ident" id="8178609"><a href="/gostd/crypto/tls/tls_test.go.html#8178552">delay</a></span>&nbsp;<span class="op" id="8178615">*=</span>&nbsp;<span class="num" id="8178618">2</span>&nbsp;<span class="op" id="8178620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8178624">if</span>&nbsp;<span class="ident" id="8178627"><a href="/gostd/crypto/tls/tls_test.go.html#8178537">err</a></span>&nbsp;<span class="op" id="8178631">=</span>&nbsp;<span class="ident" id="8178633"><a href="/gostd/crypto/tls/tls_test.go.html#8178722">testConnReadNonzeroAndEOF</a></span><span class="op" id="8178658">(</span><span class="ident" id="8178659"><a href="/gostd/crypto/tls/tls_test.go.html#8178120">t</a></span><span class="op" id="8178660">,</span>&nbsp;<span class="ident" id="8178662"><a href="/gostd/crypto/tls/tls_test.go.html#8178552">delay</a></span><span class="op" id="8178667">)</span><span class="op" id="8178668">;</span>&nbsp;<span class="ident" id="8178670"><a href="/gostd/crypto/tls/tls_test.go.html#8178537">err</a></span>&nbsp;<span class="op" id="8178674">==</span>&nbsp;<span class="builtintype" id="8178677">nil</span>&nbsp;<span class="op" id="8178681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8178686">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8178695">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8178698">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8178701"><a href="/gostd/crypto/tls/tls_test.go.html#8178120">t</a></span><span class="op" id="8178702">.</span><span class="ident" id="8178703"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="8178708">(</span><span class="ident" id="8178709"><a href="/gostd/crypto/tls/tls_test.go.html#8178537">err</a></span><span class="op" id="8178712">)</span><br>
<span class="lineno"></span><span class="op" id="8178714">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8178717">func</span>&nbsp;<span class="ident" id="8178722">testConnReadNonzeroAndEOF</span><span class="op" id="8178747">(</span><span class="ident" id="8178748">t</span>&nbsp;<span class="op" id="8178750">*</span><span class="ident" id="8178751"><a href="/gostd/crypto/tls/tls_test.go.html#8172880">testing</a></span><span class="op" id="8178758">.</span><span class="ident" id="8178759"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="8178760">,</span>&nbsp;<span class="ident" id="8178762">delay</span>&nbsp;<span class="ident" id="8178768"><a href="/gostd/crypto/tls/tls_test.go.html#8172891">time</a></span><span class="op" id="8178772">.</span><span class="ident" id="8178773"><a href="/gostd/time/time.go.html#2734212">Duration</a></span><span class="op" id="8178781">)</span>&nbsp;<span class="builtintype" id="8178783">error</span>&nbsp;<span class="op" id="8178789">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8178792">ln</span>&nbsp;<span class="op" id="8178795">:=</span>&nbsp;<span class="ident" id="8178798"><a href="/gostd/crypto/tls/tls_test.go.html#8177030">newLocalListener</a></span><span class="op" id="8178814">(</span><span class="ident" id="8178815"><a href="/gostd/crypto/tls/tls_test.go.html#8178748">t</a></span><span class="op" id="8178816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8178819">defer</span>&nbsp;<span class="ident" id="8178825"><a href="/gostd/crypto/tls/tls_test.go.html#8178792">ln</a></span><span class="op" id="8178827">.</span><span class="ident" id="8178828"><a href="/gostd/net/net.go.html#3340928">Close</a></span><span class="op" id="8178833">(</span><span class="op" id="8178834">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8178838">srvCh</span>&nbsp;<span class="op" id="8178844">:=</span>&nbsp;<span class="builtinfunc" id="8178847">make</span><span class="op" id="8178851">(</span><span class="keyword" id="8178852">chan</span>&nbsp;<span class="op" id="8178857">*</span><span class="ident" id="8178858"><a href="/gostd/crypto/tls/conn.go.html#4461903">Conn</a></span><span class="op" id="8178862">,</span>&nbsp;<span class="num" id="8178864">1</span><span class="op" id="8178865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8178868">var</span>&nbsp;<span class="ident" id="8178872">serr</span>&nbsp;<span class="builtintype" id="8178877">error</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8178884">go</span>&nbsp;<span class="keyword" id="8178887">func</span><span class="op" id="8178891">(</span><span class="op" id="8178892">)</span>&nbsp;<span class="op" id="8178894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8178898">sconn</span><span class="op" id="8178903">,</span>&nbsp;<span class="ident" id="8178905">err</span>&nbsp;<span class="op" id="8178909">:=</span>&nbsp;<span class="ident" id="8178912"><a href="/gostd/crypto/tls/tls_test.go.html#8178792">ln</a></span><span class="op" id="8178914">.</span><span class="ident" id="8178915"><a href="/gostd/net/net.go.html#3340795">Accept</a></span><span class="op" id="8178921">(</span><span class="op" id="8178922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8178926">if</span>&nbsp;<span class="ident" id="8178929"><a href="/gostd/crypto/tls/tls_test.go.html#8178905">err</a></span>&nbsp;<span class="op" id="8178933">!=</span>&nbsp;<span class="builtintype" id="8178936">nil</span>&nbsp;<span class="op" id="8178940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8178945"><a href="/gostd/crypto/tls/tls_test.go.html#8178872">serr</a></span>&nbsp;<span class="op" id="8178950">=</span>&nbsp;<span class="ident" id="8178952"><a href="/gostd/crypto/tls/tls_test.go.html#8178905">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8178959"><a href="/gostd/crypto/tls/tls_test.go.html#8178838">srvCh</a></span>&nbsp;<span class="op" id="8178965">&lt;-</span>&nbsp;<span class="builtintype" id="8178968">nil</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8178975">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8178984">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8178988">serverConfig</span>&nbsp;<span class="op" id="8179001">:=</span>&nbsp;<span class="op" id="8179004">*</span><span class="ident" id="8179005"><a href="/gostd/crypto/tls/handshake_server_test.go.html#8132921">testConfig</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8179018">srv</span>&nbsp;<span class="op" id="8179022">:=</span>&nbsp;<span class="ident" id="8179025"><a href="/gostd/crypto/tls/tls.go.html#4583744">Server</a></span><span class="op" id="8179031">(</span><span class="ident" id="8179032"><a href="/gostd/crypto/tls/tls_test.go.html#8178898">sconn</a></span><span class="op" id="8179037">,</span>&nbsp;<span class="op" id="8179039">&amp;</span><span class="ident" id="8179040"><a href="/gostd/crypto/tls/tls_test.go.html#8178988">serverConfig</a></span><span class="op" id="8179052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8179056">if</span>&nbsp;<span class="ident" id="8179059">err</span>&nbsp;<span class="op" id="8179063">:=</span>&nbsp;<span class="ident" id="8179066"><a href="/gostd/crypto/tls/tls_test.go.html#8179018">srv</a></span><span class="op" id="8179069">.</span><span class="ident" id="8179070"><a href="/gostd/crypto/tls/conn.go.html#4488474">Handshake</a></span><span class="op" id="8179079">(</span><span class="op" id="8179080">)</span><span class="op" id="8179081">;</span>&nbsp;<span class="ident" id="8179083"><a href="/gostd/crypto/tls/tls_test.go.html#8179059">err</a></span>&nbsp;<span class="op" id="8179087">!=</span>&nbsp;<span class="builtintype" id="8179090">nil</span>&nbsp;<span class="op" id="8179094">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8179099"><a href="/gostd/crypto/tls/tls_test.go.html#8178872">serr</a></span>&nbsp;<span class="op" id="8179104">=</span>&nbsp;<span class="ident" id="8179106"><a href="/gostd/crypto/tls/tls_test.go.html#8172849">fmt</a></span><span class="op" id="8179109">.</span><span class="ident" id="8179110"><a href="/gostd/fmt/print.go.html#2143886">Errorf</a></span><span class="op" id="8179116">(</span><span class="string" id="8179117">&#34;handshake:&nbsp;%v&#34;</span><span class="op" id="8179132">,</span>&nbsp;<span class="ident" id="8179134"><a href="/gostd/crypto/tls/tls_test.go.html#8179059">err</a></span><span class="op" id="8179137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8179142"><a href="/gostd/crypto/tls/tls_test.go.html#8178838">srvCh</a></span>&nbsp;<span class="op" id="8179148">&lt;-</span>&nbsp;<span class="builtintype" id="8179151">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8179158">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8179167">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8179171"><a href="/gostd/crypto/tls/tls_test.go.html#8178838">srvCh</a></span>&nbsp;<span class="op" id="8179177">&lt;-</span>&nbsp;<span class="ident" id="8179180"><a href="/gostd/crypto/tls/tls_test.go.html#8179018">srv</a></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8179185">}</span><span class="op" id="8179186">(</span><span class="op" id="8179187">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8179191">clientConfig</span>&nbsp;<span class="op" id="8179204">:=</span>&nbsp;<span class="op" id="8179207">*</span><span class="ident" id="8179208"><a href="/gostd/crypto/tls/handshake_server_test.go.html#8132921">testConfig</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8179220">conn</span><span class="op" id="8179224">,</span>&nbsp;<span class="ident" id="8179226">err</span>&nbsp;<span class="op" id="8179230">:=</span>&nbsp;<span class="ident" id="8179233"><a href="/gostd/crypto/tls/tls.go.html#4587673">Dial</a></span><span class="op" id="8179237">(</span><span class="string" id="8179238">&#34;tcp&#34;</span><span class="op" id="8179243">,</span>&nbsp;<span class="ident" id="8179245"><a href="/gostd/crypto/tls/tls_test.go.html#8178792">ln</a></span><span class="op" id="8179247">.</span><span class="ident" id="8179248"><a href="/gostd/net/net.go.html#3340993">Addr</a></span><span class="op" id="8179252">(</span><span class="op" id="8179253">)</span><span class="op" id="8179254">.</span><span class="ident" id="8179255"><a href="/gostd/net/net.go.html#3334238">String</a></span><span class="op" id="8179261">(</span><span class="op" id="8179262">)</span><span class="op" id="8179263">,</span>&nbsp;<span class="op" id="8179265">&amp;</span><span class="ident" id="8179266"><a href="/gostd/crypto/tls/tls_test.go.html#8179191">clientConfig</a></span><span class="op" id="8179278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8179281">if</span>&nbsp;<span class="ident" id="8179284"><a href="/gostd/crypto/tls/tls_test.go.html#8179226">err</a></span>&nbsp;<span class="op" id="8179288">!=</span>&nbsp;<span class="builtintype" id="8179291">nil</span>&nbsp;<span class="op" id="8179295">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8179299"><a href="/gostd/crypto/tls/tls_test.go.html#8178748">t</a></span><span class="op" id="8179300">.</span><span class="ident" id="8179301"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="8179306">(</span><span class="ident" id="8179307"><a href="/gostd/crypto/tls/tls_test.go.html#8179226">err</a></span><span class="op" id="8179310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8179313">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8179316">defer</span>&nbsp;<span class="ident" id="8179322"><a href="/gostd/crypto/tls/tls_test.go.html#8179220">conn</a></span><span class="op" id="8179326">.</span><span class="ident" id="8179327"><a href="/gostd/crypto/tls/conn.go.html#4488006">Close</a></span><span class="op" id="8179332">(</span><span class="op" id="8179333">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8179337">srv</span>&nbsp;<span class="op" id="8179341">:=</span>&nbsp;<span class="op" id="8179344">&lt;-</span><span class="ident" id="8179346"><a href="/gostd/crypto/tls/tls_test.go.html#8178838">srvCh</a></span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8179353">if</span>&nbsp;<span class="ident" id="8179356"><a href="/gostd/crypto/tls/tls_test.go.html#8179337">srv</a></span>&nbsp;<span class="op" id="8179360">==</span>&nbsp;<span class="builtintype" id="8179363">nil</span>&nbsp;<span class="op" id="8179367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8179371">return</span>&nbsp;<span class="ident" id="8179378"><a href="/gostd/crypto/tls/tls_test.go.html#8178872">serr</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8179384">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8179388">buf</span>&nbsp;<span class="op" id="8179392">:=</span>&nbsp;<span class="builtinfunc" id="8179395">make</span><span class="op" id="8179399">(</span><span class="op" id="8179400">[</span><span class="op" id="8179401">]</span><span class="builtintype" id="8179402">byte</span><span class="op" id="8179406">,</span>&nbsp;<span class="num" id="8179408">6</span><span class="op" id="8179409">)</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8179413"><a href="/gostd/crypto/tls/tls_test.go.html#8179337">srv</a></span><span class="op" id="8179416">.</span><span class="ident" id="8179417"><a href="/gostd/crypto/tls/conn.go.html#4484996">Write</a></span><span class="op" id="8179422">(</span><span class="op" id="8179423">[</span><span class="op" id="8179424">]</span><span class="builtintype" id="8179425">byte</span><span class="op" id="8179429">(</span><span class="string" id="8179430">&#34;foobar&#34;</span><span class="op" id="8179438">)</span><span class="op" id="8179439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8179442">n</span><span class="op" id="8179443">,</span>&nbsp;<span class="ident" id="8179445"><a href="/gostd/crypto/tls/tls_test.go.html#8179226">err</a></span>&nbsp;<span class="op" id="8179449">:=</span>&nbsp;<span class="ident" id="8179452"><a href="/gostd/crypto/tls/tls_test.go.html#8179220">conn</a></span><span class="op" id="8179456">.</span><span class="ident" id="8179457"><a href="/gostd/crypto/tls/conn.go.html#4486175">Read</a></span><span class="op" id="8179461">(</span><span class="ident" id="8179462"><a href="/gostd/crypto/tls/tls_test.go.html#8179388">buf</a></span><span class="op" id="8179465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8179468">if</span>&nbsp;<span class="ident" id="8179471"><a href="/gostd/crypto/tls/tls_test.go.html#8179442">n</a></span>&nbsp;<span class="op" id="8179473">!=</span>&nbsp;<span class="num" id="8179476">6</span>&nbsp;<span class="op" id="8179478">||</span>&nbsp;<span class="ident" id="8179481"><a href="/gostd/crypto/tls/tls_test.go.html#8179226">err</a></span>&nbsp;<span class="op" id="8179485">!=</span>&nbsp;<span class="builtintype" id="8179488">nil</span>&nbsp;<span class="op" id="8179492">||</span>&nbsp;<span class="builtintype" id="8179495">string</span><span class="op" id="8179501">(</span><span class="ident" id="8179502"><a href="/gostd/crypto/tls/tls_test.go.html#8179388">buf</a></span><span class="op" id="8179505">)</span>&nbsp;<span class="op" id="8179507">!=</span>&nbsp;<span class="string" id="8179510">&#34;foobar&#34;</span>&nbsp;<span class="op" id="8179519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8179523">return</span>&nbsp;<span class="ident" id="8179530"><a href="/gostd/crypto/tls/tls_test.go.html#8172849">fmt</a></span><span class="op" id="8179533">.</span><span class="ident" id="8179534"><a href="/gostd/fmt/print.go.html#2143886">Errorf</a></span><span class="op" id="8179540">(</span><span class="string" id="8179541">&#34;Read&nbsp;=&nbsp;%d,&nbsp;%v,&nbsp;data&nbsp;%q;&nbsp;want&nbsp;6,&nbsp;nil,&nbsp;foobar&#34;</span><span class="op" id="8179586">,</span>&nbsp;<span class="ident" id="8179588"><a href="/gostd/crypto/tls/tls_test.go.html#8179442">n</a></span><span class="op" id="8179589">,</span>&nbsp;<span class="ident" id="8179591"><a href="/gostd/crypto/tls/tls_test.go.html#8179226">err</a></span><span class="op" id="8179594">,</span>&nbsp;<span class="ident" id="8179596"><a href="/gostd/crypto/tls/tls_test.go.html#8179388">buf</a></span><span class="op" id="8179599">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8179602">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8179606"><a href="/gostd/crypto/tls/tls_test.go.html#8179337">srv</a></span><span class="op" id="8179609">.</span><span class="ident" id="8179610"><a href="/gostd/crypto/tls/conn.go.html#4484996">Write</a></span><span class="op" id="8179615">(</span><span class="op" id="8179616">[</span><span class="op" id="8179617">]</span><span class="builtintype" id="8179618">byte</span><span class="op" id="8179622">(</span><span class="string" id="8179623">&#34;abcdef&#34;</span><span class="op" id="8179631">)</span><span class="op" id="8179632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8179635"><a href="/gostd/crypto/tls/tls_test.go.html#8179337">srv</a></span><span class="op" id="8179638">.</span><span class="ident" id="8179639"><a href="/gostd/crypto/tls/conn.go.html#4488006">Close</a></span><span class="op" id="8179644">(</span><span class="op" id="8179645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8179648"><a href="/gostd/crypto/tls/tls_test.go.html#8172891">time</a></span><span class="op" id="8179652">.</span><span class="ident" id="8179653"><a href="/gostd/time/sleep.go.html#2713940">Sleep</a></span><span class="op" id="8179658">(</span><span class="ident" id="8179659"><a href="/gostd/crypto/tls/tls_test.go.html#8178762">delay</a></span><span class="op" id="8179664">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8179667"><a href="/gostd/crypto/tls/tls_test.go.html#8179442">n</a></span><span class="op" id="8179668">,</span>&nbsp;<span class="ident" id="8179670"><a href="/gostd/crypto/tls/tls_test.go.html#8179226">err</a></span>&nbsp;<span class="op" id="8179674">=</span>&nbsp;<span class="ident" id="8179676"><a href="/gostd/crypto/tls/tls_test.go.html#8179220">conn</a></span><span class="op" id="8179680">.</span><span class="ident" id="8179681"><a href="/gostd/crypto/tls/conn.go.html#4486175">Read</a></span><span class="op" id="8179685">(</span><span class="ident" id="8179686"><a href="/gostd/crypto/tls/tls_test.go.html#8179388">buf</a></span><span class="op" id="8179689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8179692">if</span>&nbsp;<span class="ident" id="8179695"><a href="/gostd/crypto/tls/tls_test.go.html#8179442">n</a></span>&nbsp;<span class="op" id="8179697">!=</span>&nbsp;<span class="num" id="8179700">6</span>&nbsp;<span class="op" id="8179702">||</span>&nbsp;<span class="builtintype" id="8179705">string</span><span class="op" id="8179711">(</span><span class="ident" id="8179712"><a href="/gostd/crypto/tls/tls_test.go.html#8179388">buf</a></span><span class="op" id="8179715">)</span>&nbsp;<span class="op" id="8179717">!=</span>&nbsp;<span class="string" id="8179720">&#34;abcdef&#34;</span>&nbsp;<span class="op" id="8179729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8179733">return</span>&nbsp;<span class="ident" id="8179740"><a href="/gostd/crypto/tls/tls_test.go.html#8172849">fmt</a></span><span class="op" id="8179743">.</span><span class="ident" id="8179744"><a href="/gostd/fmt/print.go.html#2143886">Errorf</a></span><span class="op" id="8179750">(</span><span class="string" id="8179751">&#34;Read&nbsp;=&nbsp;%d,&nbsp;buf=&nbsp;%q;&nbsp;want&nbsp;6,&nbsp;abcdef&#34;</span><span class="op" id="8179787">,</span>&nbsp;<span class="ident" id="8179789"><a href="/gostd/crypto/tls/tls_test.go.html#8179442">n</a></span><span class="op" id="8179790">,</span>&nbsp;<span class="ident" id="8179792"><a href="/gostd/crypto/tls/tls_test.go.html#8179388">buf</a></span><span class="op" id="8179795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8179798">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8179801">if</span>&nbsp;<span class="ident" id="8179804"><a href="/gostd/crypto/tls/tls_test.go.html#8179226">err</a></span>&nbsp;<span class="op" id="8179808">!=</span>&nbsp;<span class="ident" id="8179811"><a href="/gostd/crypto/tls/tls_test.go.html#8172856">io</a></span><span class="op" id="8179813">.</span><span class="ident" id="8179814"><a href="/gostd/io/io.go.html#1419950">EOF</a></span>&nbsp;<span class="op" id="8179818">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8179822">return</span>&nbsp;<span class="ident" id="8179829"><a href="/gostd/crypto/tls/tls_test.go.html#8172849">fmt</a></span><span class="op" id="8179832">.</span><span class="ident" id="8179833"><a href="/gostd/fmt/print.go.html#2143886">Errorf</a></span><span class="op" id="8179839">(</span><span class="string" id="8179840">&#34;Second&nbsp;Read&nbsp;error&nbsp;=&nbsp;%v;&nbsp;want&nbsp;io.EOF&#34;</span><span class="op" id="8179877">,</span>&nbsp;<span class="ident" id="8179879"><a href="/gostd/crypto/tls/tls_test.go.html#8179226">err</a></span><span class="op" id="8179882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8179885">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8179888">return</span>&nbsp;<span class="builtintype" id="8179895">nil</span><br>
<span class="lineno"></span><span class="op" id="8179899">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span><span class="keyword" id="8179902">func</span>&nbsp;<span class="ident" id="8179907">TestTLSUniqueMatches</span><span class="op" id="8179927">(</span><span class="ident" id="8179928">t</span>&nbsp;<span class="op" id="8179930">*</span><span class="ident" id="8179931"><a href="/gostd/crypto/tls/tls_test.go.html#8172880">testing</a></span><span class="op" id="8179938">.</span><span class="ident" id="8179939"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="8179940">)</span>&nbsp;<span class="op" id="8179942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8179945">ln</span>&nbsp;<span class="op" id="8179948">:=</span>&nbsp;<span class="ident" id="8179951"><a href="/gostd/crypto/tls/tls_test.go.html#8177030">newLocalListener</a></span><span class="op" id="8179967">(</span><span class="ident" id="8179968"><a href="/gostd/crypto/tls/tls_test.go.html#8179928">t</a></span><span class="op" id="8179969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8179972">defer</span>&nbsp;<span class="ident" id="8179978"><a href="/gostd/crypto/tls/tls_test.go.html#8179945">ln</a></span><span class="op" id="8179980">.</span><span class="ident" id="8179981"><a href="/gostd/net/net.go.html#3340928">Close</a></span><span class="op" id="8179986">(</span><span class="op" id="8179987">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8179991">serverTLSUniques</span>&nbsp;<span class="op" id="8180008">:=</span>&nbsp;<span class="builtinfunc" id="8180011">make</span><span class="op" id="8180015">(</span><span class="keyword" id="8180016">chan</span>&nbsp;<span class="op" id="8180021">[</span><span class="op" id="8180022">]</span><span class="builtintype" id="8180023">byte</span><span class="op" id="8180027">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8180030">go</span>&nbsp;<span class="keyword" id="8180033">func</span><span class="op" id="8180037">(</span><span class="op" id="8180038">)</span>&nbsp;<span class="op" id="8180040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8180044">for</span>&nbsp;<span class="ident" id="8180048">i</span>&nbsp;<span class="op" id="8180050">:=</span>&nbsp;<span class="num" id="8180053">0</span><span class="op" id="8180054">;</span>&nbsp;<span class="ident" id="8180056"><a href="/gostd/crypto/tls/tls_test.go.html#8180048">i</a></span>&nbsp;<span class="op" id="8180058">&lt;</span>&nbsp;<span class="num" id="8180060">2</span><span class="op" id="8180061">;</span>&nbsp;<span class="ident" id="8180063"><a href="/gostd/crypto/tls/tls_test.go.html#8180048">i</a></span><span class="op" id="8180064">++</span>&nbsp;<span class="op" id="8180067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8180072">sconn</span><span class="op" id="8180077">,</span>&nbsp;<span class="ident" id="8180079">err</span>&nbsp;<span class="op" id="8180083">:=</span>&nbsp;<span class="ident" id="8180086"><a href="/gostd/crypto/tls/tls_test.go.html#8179945">ln</a></span><span class="op" id="8180088">.</span><span class="ident" id="8180089"><a href="/gostd/net/net.go.html#3340795">Accept</a></span><span class="op" id="8180095">(</span><span class="op" id="8180096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8180101">if</span>&nbsp;<span class="ident" id="8180104"><a href="/gostd/crypto/tls/tls_test.go.html#8180079">err</a></span>&nbsp;<span class="op" id="8180108">!=</span>&nbsp;<span class="builtintype" id="8180111">nil</span>&nbsp;<span class="op" id="8180115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8180121"><a href="/gostd/crypto/tls/tls_test.go.html#8179928">t</a></span><span class="op" id="8180122">.</span><span class="ident" id="8180123"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="8180128">(</span><span class="ident" id="8180129"><a href="/gostd/crypto/tls/tls_test.go.html#8180079">err</a></span><span class="op" id="8180132">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8180137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8180142">serverConfig</span>&nbsp;<span class="op" id="8180155">:=</span>&nbsp;<span class="op" id="8180158">*</span><span class="ident" id="8180159"><a href="/gostd/crypto/tls/handshake_server_test.go.html#8132921">testConfig</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8180173">srv</span>&nbsp;<span class="op" id="8180177">:=</span>&nbsp;<span class="ident" id="8180180"><a href="/gostd/crypto/tls/tls.go.html#4583744">Server</a></span><span class="op" id="8180186">(</span><span class="ident" id="8180187"><a href="/gostd/crypto/tls/tls_test.go.html#8180072">sconn</a></span><span class="op" id="8180192">,</span>&nbsp;<span class="op" id="8180194">&amp;</span><span class="ident" id="8180195"><a href="/gostd/crypto/tls/tls_test.go.html#8180142">serverConfig</a></span><span class="op" id="8180207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8180212">if</span>&nbsp;<span class="ident" id="8180215">err</span>&nbsp;<span class="op" id="8180219">:=</span>&nbsp;<span class="ident" id="8180222"><a href="/gostd/crypto/tls/tls_test.go.html#8180173">srv</a></span><span class="op" id="8180225">.</span><span class="ident" id="8180226"><a href="/gostd/crypto/tls/conn.go.html#4488474">Handshake</a></span><span class="op" id="8180235">(</span><span class="op" id="8180236">)</span><span class="op" id="8180237">;</span>&nbsp;<span class="ident" id="8180239"><a href="/gostd/crypto/tls/tls_test.go.html#8180215">err</a></span>&nbsp;<span class="op" id="8180243">!=</span>&nbsp;<span class="builtintype" id="8180246">nil</span>&nbsp;<span class="op" id="8180250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8180256"><a href="/gostd/crypto/tls/tls_test.go.html#8179928">t</a></span><span class="op" id="8180257">.</span><span class="ident" id="8180258"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="8180263">(</span><span class="ident" id="8180264"><a href="/gostd/crypto/tls/tls_test.go.html#8180215">err</a></span><span class="op" id="8180267">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8180272">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8180277"><a href="/gostd/crypto/tls/tls_test.go.html#8179991">serverTLSUniques</a></span>&nbsp;<span class="op" id="8180294">&lt;-</span>&nbsp;<span class="ident" id="8180297"><a href="/gostd/crypto/tls/tls_test.go.html#8180173">srv</a></span><span class="op" id="8180300">.</span><span class="ident" id="8180301"><a href="/gostd/crypto/tls/conn.go.html#4488867">ConnectionState</a></span><span class="op" id="8180316">(</span><span class="op" id="8180317">)</span><span class="op" id="8180318">.</span><span class="ident" id="8180319"><a href="/gostd/crypto/tls/common.go.html#4447787">TLSUnique</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8180331">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8180334">}</span><span class="op" id="8180335">(</span><span class="op" id="8180336">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8180340">clientConfig</span>&nbsp;<span class="op" id="8180353">:=</span>&nbsp;<span class="op" id="8180356">*</span><span class="ident" id="8180357"><a href="/gostd/crypto/tls/handshake_server_test.go.html#8132921">testConfig</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8180369"><a href="/gostd/crypto/tls/tls_test.go.html#8180340">clientConfig</a></span><span class="op" id="8180381">.</span><span class="ident" id="8180382"><a href="/gostd/crypto/tls/common.go.html#4454124">ClientSessionCache</a></span>&nbsp;<span class="op" id="8180401">=</span>&nbsp;<span class="ident" id="8180403"><a href="/gostd/crypto/tls/common.go.html#4459426">NewLRUClientSessionCache</a></span><span class="op" id="8180427">(</span><span class="num" id="8180428">1</span><span class="op" id="8180429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8180432">conn</span><span class="op" id="8180436">,</span>&nbsp;<span class="ident" id="8180438">err</span>&nbsp;<span class="op" id="8180442">:=</span>&nbsp;<span class="ident" id="8180445"><a href="/gostd/crypto/tls/tls.go.html#4587673">Dial</a></span><span class="op" id="8180449">(</span><span class="string" id="8180450">&#34;tcp&#34;</span><span class="op" id="8180455">,</span>&nbsp;<span class="ident" id="8180457"><a href="/gostd/crypto/tls/tls_test.go.html#8179945">ln</a></span><span class="op" id="8180459">.</span><span class="ident" id="8180460"><a href="/gostd/net/net.go.html#3340993">Addr</a></span><span class="op" id="8180464">(</span><span class="op" id="8180465">)</span><span class="op" id="8180466">.</span><span class="ident" id="8180467"><a href="/gostd/net/net.go.html#3334238">String</a></span><span class="op" id="8180473">(</span><span class="op" id="8180474">)</span><span class="op" id="8180475">,</span>&nbsp;<span class="op" id="8180477">&amp;</span><span class="ident" id="8180478"><a href="/gostd/crypto/tls/tls_test.go.html#8180340">clientConfig</a></span><span class="op" id="8180490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8180493">if</span>&nbsp;<span class="ident" id="8180496"><a href="/gostd/crypto/tls/tls_test.go.html#8180438">err</a></span>&nbsp;<span class="op" id="8180500">!=</span>&nbsp;<span class="builtintype" id="8180503">nil</span>&nbsp;<span class="op" id="8180507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8180511"><a href="/gostd/crypto/tls/tls_test.go.html#8179928">t</a></span><span class="op" id="8180512">.</span><span class="ident" id="8180513"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="8180518">(</span><span class="ident" id="8180519"><a href="/gostd/crypto/tls/tls_test.go.html#8180438">err</a></span><span class="op" id="8180522">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8180525">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8180528">if</span>&nbsp;<span class="op" id="8180531">!</span><span class="ident" id="8180532"><a href="/gostd/crypto/tls/tls_test.go.html#8172840">bytes</a></span><span class="op" id="8180537">.</span><span class="ident" id="8180538"><a href="/gostd/bytes/bytes_decl.go.html#1414806">Equal</a></span><span class="op" id="8180543">(</span><span class="ident" id="8180544"><a href="/gostd/crypto/tls/tls_test.go.html#8180432">conn</a></span><span class="op" id="8180548">.</span><span class="ident" id="8180549"><a href="/gostd/crypto/tls/conn.go.html#4488867">ConnectionState</a></span><span class="op" id="8180564">(</span><span class="op" id="8180565">)</span><span class="op" id="8180566">.</span><span class="ident" id="8180567"><a href="/gostd/crypto/tls/common.go.html#4447787">TLSUnique</a></span><span class="op" id="8180576">,</span>&nbsp;<span class="op" id="8180578">&lt;-</span><span class="ident" id="8180580"><a href="/gostd/crypto/tls/tls_test.go.html#8179991">serverTLSUniques</a></span><span class="op" id="8180596">)</span>&nbsp;<span class="op" id="8180598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8180602"><a href="/gostd/crypto/tls/tls_test.go.html#8179928">t</a></span><span class="op" id="8180603">.</span><span class="ident" id="8180604"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="8180609">(</span><span class="string" id="8180610">&#34;client&nbsp;and&nbsp;server&nbsp;channel&nbsp;bindings&nbsp;differ&#34;</span><span class="op" id="8180653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8180656">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8180659"><a href="/gostd/crypto/tls/tls_test.go.html#8180432">conn</a></span><span class="op" id="8180663">.</span><span class="ident" id="8180664"><a href="/gostd/crypto/tls/conn.go.html#4488006">Close</a></span><span class="op" id="8180669">(</span><span class="op" id="8180670">)</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8180674"><a href="/gostd/crypto/tls/tls_test.go.html#8180432">conn</a></span><span class="op" id="8180678">,</span>&nbsp;<span class="ident" id="8180680"><a href="/gostd/crypto/tls/tls_test.go.html#8180438">err</a></span>&nbsp;<span class="op" id="8180684">=</span>&nbsp;<span class="ident" id="8180686"><a href="/gostd/crypto/tls/tls.go.html#4587673">Dial</a></span><span class="op" id="8180690">(</span><span class="string" id="8180691">&#34;tcp&#34;</span><span class="op" id="8180696">,</span>&nbsp;<span class="ident" id="8180698"><a href="/gostd/crypto/tls/tls_test.go.html#8179945">ln</a></span><span class="op" id="8180700">.</span><span class="ident" id="8180701"><a href="/gostd/net/net.go.html#3340993">Addr</a></span><span class="op" id="8180705">(</span><span class="op" id="8180706">)</span><span class="op" id="8180707">.</span><span class="ident" id="8180708"><a href="/gostd/net/net.go.html#3334238">String</a></span><span class="op" id="8180714">(</span><span class="op" id="8180715">)</span><span class="op" id="8180716">,</span>&nbsp;<span class="op" id="8180718">&amp;</span><span class="ident" id="8180719"><a href="/gostd/crypto/tls/tls_test.go.html#8180340">clientConfig</a></span><span class="op" id="8180731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8180734">if</span>&nbsp;<span class="ident" id="8180737"><a href="/gostd/crypto/tls/tls_test.go.html#8180438">err</a></span>&nbsp;<span class="op" id="8180741">!=</span>&nbsp;<span class="builtintype" id="8180744">nil</span>&nbsp;<span class="op" id="8180748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8180752"><a href="/gostd/crypto/tls/tls_test.go.html#8179928">t</a></span><span class="op" id="8180753">.</span><span class="ident" id="8180754"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="8180759">(</span><span class="ident" id="8180760"><a href="/gostd/crypto/tls/tls_test.go.html#8180438">err</a></span><span class="op" id="8180763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8180766">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8180769">defer</span>&nbsp;<span class="ident" id="8180775"><a href="/gostd/crypto/tls/tls_test.go.html#8180432">conn</a></span><span class="op" id="8180779">.</span><span class="ident" id="8180780"><a href="/gostd/crypto/tls/conn.go.html#4488006">Close</a></span><span class="op" id="8180785">(</span><span class="op" id="8180786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8180789">if</span>&nbsp;<span class="op" id="8180792">!</span><span class="ident" id="8180793"><a href="/gostd/crypto/tls/tls_test.go.html#8180432">conn</a></span><span class="op" id="8180797">.</span><span class="ident" id="8180798"><a href="/gostd/crypto/tls/conn.go.html#4488867">ConnectionState</a></span><span class="op" id="8180813">(</span><span class="op" id="8180814">)</span><span class="op" id="8180815">.</span><span class="ident" id="8180816"><a href="/gostd/crypto/tls/common.go.html#4446707">DidResume</a></span>&nbsp;<span class="op" id="8180826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8180830"><a href="/gostd/crypto/tls/tls_test.go.html#8179928">t</a></span><span class="op" id="8180831">.</span><span class="ident" id="8180832"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="8180837">(</span><span class="string" id="8180838">&#34;second&nbsp;session&nbsp;did&nbsp;not&nbsp;use&nbsp;resumption&#34;</span><span class="op" id="8180877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8180880">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8180883">if</span>&nbsp;<span class="op" id="8180886">!</span><span class="ident" id="8180887"><a href="/gostd/crypto/tls/tls_test.go.html#8172840">bytes</a></span><span class="op" id="8180892">.</span><span class="ident" id="8180893"><a href="/gostd/bytes/bytes_decl.go.html#1414806">Equal</a></span><span class="op" id="8180898">(</span><span class="ident" id="8180899"><a href="/gostd/crypto/tls/tls_test.go.html#8180432">conn</a></span><span class="op" id="8180903">.</span><span class="ident" id="8180904"><a href="/gostd/crypto/tls/conn.go.html#4488867">ConnectionState</a></span><span class="op" id="8180919">(</span><span class="op" id="8180920">)</span><span class="op" id="8180921">.</span><span class="ident" id="8180922"><a href="/gostd/crypto/tls/common.go.html#4447787">TLSUnique</a></span><span class="op" id="8180931">,</span>&nbsp;<span class="op" id="8180933">&lt;-</span><span class="ident" id="8180935"><a href="/gostd/crypto/tls/tls_test.go.html#8179991">serverTLSUniques</a></span><span class="op" id="8180951">)</span>&nbsp;<span class="op" id="8180953">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8180957"><a href="/gostd/crypto/tls/tls_test.go.html#8179928">t</a></span><span class="op" id="8180958">.</span><span class="ident" id="8180959"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="8180964">(</span><span class="string" id="8180965">&#34;client&nbsp;and&nbsp;server&nbsp;channel&nbsp;bindings&nbsp;differ&nbsp;when&nbsp;session&nbsp;resumption&nbsp;is&nbsp;used&#34;</span><span class="op" id="8181040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8181043">}</span><br>
<span class="lineno"></span><span class="op" id="8181045">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
