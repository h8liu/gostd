<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>debug/pe</h2>
<ul>
<li><a href="/gostd/debug/pe/file.go.html" class="current">file.go</a></li>
<li><a href="/gostd/debug/pe/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/debug/pe/pe.go.html">pe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1953393">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1953449">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1953503">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1953554">//&nbsp;Package&nbsp;pe&nbsp;implements&nbsp;access&nbsp;to&nbsp;PE&nbsp;(Microsoft&nbsp;Windows&nbsp;Portable&nbsp;Executable)&nbsp;files.</span><br>
<span class="lineno"></span><span class="keyword" id="1953639">package</span>&nbsp;<span class="ident" id="1953647">pe</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1953651">import</span>&nbsp;<span class="op" id="1953658">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="1953661">&#34;debug/dwarf&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="1953676">&#34;encoding/binary&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="1953695">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="1953705">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="1953712">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="1953718">&#34;os&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="1953724">&#34;strconv&#34;</span><br>
<span class="lineno"></span><span class="op" id="1953734">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1953737">//&nbsp;A&nbsp;File&nbsp;represents&nbsp;an&nbsp;open&nbsp;PE&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="1953775">type</span>&nbsp;<span class="ident" id="1953780">File</span>&nbsp;<span class="keyword" id="1953785">struct</span>&nbsp;<span class="op" id="1953792">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1953795">FileHeader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1953807">OptionalHeader</span>&nbsp;<span class="keyword" id="1953822">interface</span><span class="op" id="1953831">{</span><span class="op" id="1953832">}</span>&nbsp;<span class="comment" id="1953834">//&nbsp;of&nbsp;type&nbsp;*OptionalHeader32&nbsp;or&nbsp;*OptionalHeader64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1953885">Sections</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1953900">[</span><span class="op" id="1953901">]</span><span class="op" id="1953902">*</span><span class="ident" id="1953903">Section</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1953912">Symbols</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1953927">[</span><span class="op" id="1953928">]</span><span class="op" id="1953929">*</span><span class="ident" id="1953930">Symbol</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1953939">closer</span>&nbsp;<span class="ident" id="1953946">io</span><span class="op" id="1953948">.</span><span class="ident" id="1953949">Closer</span><br>
<span class="lineno"></span><span class="op" id="1953956">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1953959">type</span>&nbsp;<span class="ident" id="1953964">SectionHeader</span>&nbsp;<span class="keyword" id="1953978">struct</span>&nbsp;<span class="op" id="1953985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1953988">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1954009">string</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1954017">VirtualSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1954038">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1954046">VirtualAddress</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1954067">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1954075">Size</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1954096">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1954104">Offset</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1954125">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1954133">PointerToRelocations</span>&nbsp;<span class="builtintype" id="1954154">uint32</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1954162">PointerToLineNumbers</span>&nbsp;<span class="builtintype" id="1954183">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1954191">NumberOfRelocations</span>&nbsp;&nbsp;<span class="builtintype" id="1954212">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1954220">NumberOfLineNumbers</span>&nbsp;&nbsp;<span class="builtintype" id="1954241">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1954249">Characteristics</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1954270">uint32</span><br>
<span class="lineno"></span><span class="op" id="1954277">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="1954280">type</span>&nbsp;<span class="ident" id="1954285">Section</span>&nbsp;<span class="keyword" id="1954293">struct</span>&nbsp;<span class="op" id="1954300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1954303">SectionHeader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1954319">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1954357">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1954397">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1954432">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1954480">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1954530">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1954554">io</span><span class="op" id="1954556">.</span><span class="ident" id="1954557">ReaderAt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1954567">sr</span>&nbsp;<span class="op" id="1954570">*</span><span class="ident" id="1954571">io</span><span class="op" id="1954573">.</span><span class="ident" id="1954574">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="1954588">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1954591">type</span>&nbsp;<span class="ident" id="1954596">Symbol</span>&nbsp;<span class="keyword" id="1954603">struct</span>&nbsp;<span class="op" id="1954610">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1954613">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1954627">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1954635">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1954649">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1954657">SectionNumber</span>&nbsp;<span class="builtintype" id="1954671">int16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1954678">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1954692">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1954700">StorageClass</span>&nbsp;&nbsp;<span class="builtintype" id="1954714">uint8</span><br>
<span class="lineno">60</span><span class="op" id="1954720">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1954723">type</span>&nbsp;<span class="ident" id="1954728">ImportDirectory</span>&nbsp;<span class="keyword" id="1954744">struct</span>&nbsp;<span class="op" id="1954751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1954754">OriginalFirstThunk</span>&nbsp;<span class="builtintype" id="1954773">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1954781">TimeDateStamp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1954800">uint32</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1954808">ForwarderChain</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1954827">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1954835">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1954854">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1954862">FirstThunk</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1954881">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1954890">dll</span>&nbsp;<span class="builtintype" id="1954894">string</span><br>
<span class="lineno">70</span><span class="op" id="1954901">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1954904">//&nbsp;Data&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;PE&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="1954962">func</span>&nbsp;<span class="op" id="1954967">(</span><span class="ident" id="1954968">s</span>&nbsp;<span class="op" id="1954970">*</span><span class="ident" id="1954971">Section</span><span class="op" id="1954978">)</span>&nbsp;<span class="ident" id="1954980">Data</span><span class="op" id="1954984">(</span><span class="op" id="1954985">)</span>&nbsp;<span class="op" id="1954987">(</span><span class="op" id="1954988">[</span><span class="op" id="1954989">]</span><span class="builtintype" id="1954990">byte</span><span class="op" id="1954994">,</span>&nbsp;<span class="builtintype" id="1954996">error</span><span class="op" id="1955001">)</span>&nbsp;<span class="op" id="1955003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1955006">dat</span>&nbsp;<span class="op" id="1955010">:=</span>&nbsp;<span class="builtinfunc" id="1955013">make</span><span class="op" id="1955017">(</span><span class="op" id="1955018">[</span><span class="op" id="1955019">]</span><span class="builtintype" id="1955020">byte</span><span class="op" id="1955024">,</span>&nbsp;<span class="ident" id="1955026">s</span><span class="op" id="1955027">.</span><span class="ident" id="1955028">sr</span><span class="op" id="1955030">.</span><span class="ident" id="1955031">Size</span><span class="op" id="1955035">(</span><span class="op" id="1955036">)</span><span class="op" id="1955037">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1955040">n</span><span class="op" id="1955041">,</span>&nbsp;<span class="ident" id="1955043">err</span>&nbsp;<span class="op" id="1955047">:=</span>&nbsp;<span class="ident" id="1955050">s</span><span class="op" id="1955051">.</span><span class="ident" id="1955052">sr</span><span class="op" id="1955054">.</span><span class="ident" id="1955055">ReadAt</span><span class="op" id="1955061">(</span><span class="ident" id="1955062">dat</span><span class="op" id="1955065">,</span>&nbsp;<span class="num" id="1955067">0</span><span class="op" id="1955068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1955071">if</span>&nbsp;<span class="ident" id="1955074">n</span>&nbsp;<span class="op" id="1955076">==</span>&nbsp;<span class="builtinfunc" id="1955079">len</span><span class="op" id="1955082">(</span><span class="ident" id="1955083">dat</span><span class="op" id="1955086">)</span>&nbsp;<span class="op" id="1955088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1955092">err</span>&nbsp;<span class="op" id="1955096">=</span>&nbsp;<span class="ident" id="1955098">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1955103">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1955106">return</span>&nbsp;<span class="ident" id="1955113">dat</span><span class="op" id="1955116">[</span><span class="num" id="1955117">0</span><span class="op" id="1955118">:</span><span class="ident" id="1955119">n</span><span class="op" id="1955120">]</span><span class="op" id="1955121">,</span>&nbsp;<span class="ident" id="1955123">err</span><br>
<span class="lineno">80</span><span class="op" id="1955127">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1955130">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;PE&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="1955187">func</span>&nbsp;<span class="op" id="1955192">(</span><span class="ident" id="1955193">s</span>&nbsp;<span class="op" id="1955195">*</span><span class="ident" id="1955196">Section</span><span class="op" id="1955203">)</span>&nbsp;<span class="ident" id="1955205">Open</span><span class="op" id="1955209">(</span><span class="op" id="1955210">)</span>&nbsp;<span class="ident" id="1955212">io</span><span class="op" id="1955214">.</span><span class="ident" id="1955215">ReadSeeker</span>&nbsp;<span class="op" id="1955226">{</span>&nbsp;<span class="keyword" id="1955228">return</span>&nbsp;<span class="ident" id="1955235">io</span><span class="op" id="1955237">.</span><span class="ident" id="1955238">NewSectionReader</span><span class="op" id="1955254">(</span><span class="ident" id="1955255">s</span><span class="op" id="1955256">.</span><span class="ident" id="1955257">sr</span><span class="op" id="1955259">,</span>&nbsp;<span class="num" id="1955261">0</span><span class="op" id="1955262">,</span>&nbsp;<span class="num" id="1955264">1</span><span class="op" id="1955265">&lt;&lt;</span><span class="num" id="1955267">63</span><span class="op" id="1955269">-</span><span class="num" id="1955270">1</span><span class="op" id="1955271">)</span>&nbsp;<span class="op" id="1955273">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="keyword" id="1955276">type</span>&nbsp;<span class="ident" id="1955281">FormatError</span>&nbsp;<span class="keyword" id="1955293">struct</span>&nbsp;<span class="op" id="1955300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1955303">off</span>&nbsp;<span class="ident" id="1955307">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1955314">msg</span>&nbsp;<span class="builtintype" id="1955318">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1955326">val</span>&nbsp;<span class="keyword" id="1955330">interface</span><span class="op" id="1955339">{</span><span class="op" id="1955340">}</span><br>
<span class="lineno"></span><span class="op" id="1955342">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="1955345">func</span>&nbsp;<span class="op" id="1955350">(</span><span class="ident" id="1955351">e</span>&nbsp;<span class="op" id="1955353">*</span><span class="ident" id="1955354">FormatError</span><span class="op" id="1955365">)</span>&nbsp;<span class="ident" id="1955367">Error</span><span class="op" id="1955372">(</span><span class="op" id="1955373">)</span>&nbsp;<span class="builtintype" id="1955375">string</span>&nbsp;<span class="op" id="1955382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1955385">msg</span>&nbsp;<span class="op" id="1955389">:=</span>&nbsp;<span class="ident" id="1955392">e</span><span class="op" id="1955393">.</span><span class="ident" id="1955394">msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1955399">if</span>&nbsp;<span class="ident" id="1955402">e</span><span class="op" id="1955403">.</span><span class="ident" id="1955404">val</span>&nbsp;<span class="op" id="1955408">!=</span>&nbsp;<span class="ident" id="1955411">nil</span>&nbsp;<span class="op" id="1955415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1955419">msg</span>&nbsp;<span class="op" id="1955423">+=</span>&nbsp;<span class="ident" id="1955426">fmt</span><span class="op" id="1955429">.</span><span class="ident" id="1955430">Sprintf</span><span class="op" id="1955437">(</span><span class="string" id="1955438">&#34;&nbsp;&#39;%v&#39;&#34;</span><span class="op" id="1955445">,</span>&nbsp;<span class="ident" id="1955447">e</span><span class="op" id="1955448">.</span><span class="ident" id="1955449">val</span><span class="op" id="1955452">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1955455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1955458">msg</span>&nbsp;<span class="op" id="1955462">+=</span>&nbsp;<span class="ident" id="1955465">fmt</span><span class="op" id="1955468">.</span><span class="ident" id="1955469">Sprintf</span><span class="op" id="1955476">(</span><span class="string" id="1955477">&#34;&nbsp;in&nbsp;record&nbsp;at&nbsp;byte&nbsp;%#x&#34;</span><span class="op" id="1955501">,</span>&nbsp;<span class="ident" id="1955503">e</span><span class="op" id="1955504">.</span><span class="ident" id="1955505">off</span><span class="op" id="1955508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1955511">return</span>&nbsp;<span class="ident" id="1955518">msg</span><br>
<span class="lineno"></span><span class="op" id="1955522">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="comment" id="1955525">//&nbsp;Open&nbsp;opens&nbsp;the&nbsp;named&nbsp;file&nbsp;using&nbsp;os.Open&nbsp;and&nbsp;prepares&nbsp;it&nbsp;for&nbsp;use&nbsp;as&nbsp;a&nbsp;PE&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="1955608">func</span>&nbsp;<span class="ident" id="1955613">Open</span><span class="op" id="1955617">(</span><span class="ident" id="1955618">name</span>&nbsp;<span class="builtintype" id="1955623">string</span><span class="op" id="1955629">)</span>&nbsp;<span class="op" id="1955631">(</span><span class="op" id="1955632">*</span><span class="ident" id="1955633">File</span><span class="op" id="1955637">,</span>&nbsp;<span class="builtintype" id="1955639">error</span><span class="op" id="1955644">)</span>&nbsp;<span class="op" id="1955646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1955649">f</span><span class="op" id="1955650">,</span>&nbsp;<span class="ident" id="1955652">err</span>&nbsp;<span class="op" id="1955656">:=</span>&nbsp;<span class="ident" id="1955659">os</span><span class="op" id="1955661">.</span><span class="ident" id="1955662">Open</span><span class="op" id="1955666">(</span><span class="ident" id="1955667">name</span><span class="op" id="1955671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1955674">if</span>&nbsp;<span class="ident" id="1955677">err</span>&nbsp;<span class="op" id="1955681">!=</span>&nbsp;<span class="ident" id="1955684">nil</span>&nbsp;<span class="op" id="1955688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1955692">return</span>&nbsp;<span class="ident" id="1955699">nil</span><span class="op" id="1955702">,</span>&nbsp;<span class="ident" id="1955704">err</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1955709">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1955712">ff</span><span class="op" id="1955714">,</span>&nbsp;<span class="ident" id="1955716">err</span>&nbsp;<span class="op" id="1955720">:=</span>&nbsp;<span class="ident" id="1955723">NewFile</span><span class="op" id="1955730">(</span><span class="ident" id="1955731">f</span><span class="op" id="1955732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1955735">if</span>&nbsp;<span class="ident" id="1955738">err</span>&nbsp;<span class="op" id="1955742">!=</span>&nbsp;<span class="ident" id="1955745">nil</span>&nbsp;<span class="op" id="1955749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1955753">f</span><span class="op" id="1955754">.</span><span class="ident" id="1955755">Close</span><span class="op" id="1955760">(</span><span class="op" id="1955761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1955765">return</span>&nbsp;<span class="ident" id="1955772">nil</span><span class="op" id="1955775">,</span>&nbsp;<span class="ident" id="1955777">err</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1955782">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1955785">ff</span><span class="op" id="1955787">.</span><span class="ident" id="1955788">closer</span>&nbsp;<span class="op" id="1955795">=</span>&nbsp;<span class="ident" id="1955797">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1955800">return</span>&nbsp;<span class="ident" id="1955807">ff</span><span class="op" id="1955809">,</span>&nbsp;<span class="ident" id="1955811">nil</span><br>
<span class="lineno"></span><span class="op" id="1955815">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="comment" id="1955818">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;File.</span><br>
<span class="lineno"></span><span class="comment" id="1955844">//&nbsp;If&nbsp;the&nbsp;File&nbsp;was&nbsp;created&nbsp;using&nbsp;NewFile&nbsp;directly&nbsp;instead&nbsp;of&nbsp;Open,</span><br>
<span class="lineno"></span><span class="comment" id="1955911">//&nbsp;Close&nbsp;has&nbsp;no&nbsp;effect.</span><br>
<span class="lineno"></span><span class="keyword" id="1955935">func</span>&nbsp;<span class="op" id="1955940">(</span><span class="ident" id="1955941">f</span>&nbsp;<span class="op" id="1955943">*</span><span class="ident" id="1955944">File</span><span class="op" id="1955948">)</span>&nbsp;<span class="ident" id="1955950">Close</span><span class="op" id="1955955">(</span><span class="op" id="1955956">)</span>&nbsp;<span class="builtintype" id="1955958">error</span>&nbsp;<span class="op" id="1955964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1955967">var</span>&nbsp;<span class="ident" id="1955971">err</span>&nbsp;<span class="builtintype" id="1955975">error</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1955982">if</span>&nbsp;<span class="ident" id="1955985">f</span><span class="op" id="1955986">.</span><span class="ident" id="1955987">closer</span>&nbsp;<span class="op" id="1955994">!=</span>&nbsp;<span class="ident" id="1955997">nil</span>&nbsp;<span class="op" id="1956001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1956005">err</span>&nbsp;<span class="op" id="1956009">=</span>&nbsp;<span class="ident" id="1956011">f</span><span class="op" id="1956012">.</span><span class="ident" id="1956013">closer</span><span class="op" id="1956019">.</span><span class="ident" id="1956020">Close</span><span class="op" id="1956025">(</span><span class="op" id="1956026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1956030">f</span><span class="op" id="1956031">.</span><span class="ident" id="1956032">closer</span>&nbsp;<span class="op" id="1956039">=</span>&nbsp;<span class="ident" id="1956041">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1956046">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1956049">return</span>&nbsp;<span class="ident" id="1956056">err</span><br>
<span class="lineno">125</span><span class="op" id="1956060">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1956063">var</span>&nbsp;<span class="op" id="1956067">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1956070">sizeofOptionalHeader32</span>&nbsp;<span class="op" id="1956093">=</span>&nbsp;<span class="builtintype" id="1956095">uint16</span><span class="op" id="1956101">(</span><span class="ident" id="1956102">binary</span><span class="op" id="1956108">.</span><span class="ident" id="1956109">Size</span><span class="op" id="1956113">(</span><span class="ident" id="1956114">OptionalHeader32</span><span class="op" id="1956130">{</span><span class="op" id="1956131">}</span><span class="op" id="1956132">)</span><span class="op" id="1956133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1956136">sizeofOptionalHeader64</span>&nbsp;<span class="op" id="1956159">=</span>&nbsp;<span class="builtintype" id="1956161">uint16</span><span class="op" id="1956167">(</span><span class="ident" id="1956168">binary</span><span class="op" id="1956174">.</span><span class="ident" id="1956175">Size</span><span class="op" id="1956179">(</span><span class="ident" id="1956180">OptionalHeader64</span><span class="op" id="1956196">{</span><span class="op" id="1956197">}</span><span class="op" id="1956198">)</span><span class="op" id="1956199">)</span><br>
<span class="lineno">130</span><span class="op" id="1956201">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1956204">//&nbsp;NewFile&nbsp;creates&nbsp;a&nbsp;new&nbsp;File&nbsp;for&nbsp;accessing&nbsp;a&nbsp;PE&nbsp;binary&nbsp;in&nbsp;an&nbsp;underlying&nbsp;reader.</span><br>
<span class="lineno"></span><span class="keyword" id="1956285">func</span>&nbsp;<span class="ident" id="1956290">NewFile</span><span class="op" id="1956297">(</span><span class="ident" id="1956298">r</span>&nbsp;<span class="ident" id="1956300">io</span><span class="op" id="1956302">.</span><span class="ident" id="1956303">ReaderAt</span><span class="op" id="1956311">)</span>&nbsp;<span class="op" id="1956313">(</span><span class="op" id="1956314">*</span><span class="ident" id="1956315">File</span><span class="op" id="1956319">,</span>&nbsp;<span class="builtintype" id="1956321">error</span><span class="op" id="1956326">)</span>&nbsp;<span class="op" id="1956328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1956331">f</span>&nbsp;<span class="op" id="1956333">:=</span>&nbsp;<span class="builtinfunc" id="1956336">new</span><span class="op" id="1956339">(</span><span class="ident" id="1956340">File</span><span class="op" id="1956344">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1956347">sr</span>&nbsp;<span class="op" id="1956350">:=</span>&nbsp;<span class="ident" id="1956353">io</span><span class="op" id="1956355">.</span><span class="ident" id="1956356">NewSectionReader</span><span class="op" id="1956372">(</span><span class="ident" id="1956373">r</span><span class="op" id="1956374">,</span>&nbsp;<span class="num" id="1956376">0</span><span class="op" id="1956377">,</span>&nbsp;<span class="num" id="1956379">1</span><span class="op" id="1956380">&lt;&lt;</span><span class="num" id="1956382">63</span><span class="op" id="1956384">-</span><span class="num" id="1956385">1</span><span class="op" id="1956386">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1956390">var</span>&nbsp;<span class="ident" id="1956394">dosheader</span>&nbsp;<span class="op" id="1956404">[</span><span class="num" id="1956405">96</span><span class="op" id="1956407">]</span><span class="builtintype" id="1956408">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1956414">if</span>&nbsp;<span class="ident" id="1956417">_</span><span class="op" id="1956418">,</span>&nbsp;<span class="ident" id="1956420">err</span>&nbsp;<span class="op" id="1956424">:=</span>&nbsp;<span class="ident" id="1956427">r</span><span class="op" id="1956428">.</span><span class="ident" id="1956429">ReadAt</span><span class="op" id="1956435">(</span><span class="ident" id="1956436">dosheader</span><span class="op" id="1956445">[</span><span class="num" id="1956446">0</span><span class="op" id="1956447">:</span><span class="op" id="1956448">]</span><span class="op" id="1956449">,</span>&nbsp;<span class="num" id="1956451">0</span><span class="op" id="1956452">)</span><span class="op" id="1956453">;</span>&nbsp;<span class="ident" id="1956455">err</span>&nbsp;<span class="op" id="1956459">!=</span>&nbsp;<span class="ident" id="1956462">nil</span>&nbsp;<span class="op" id="1956466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1956470">return</span>&nbsp;<span class="ident" id="1956477">nil</span><span class="op" id="1956480">,</span>&nbsp;<span class="ident" id="1956482">err</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1956487">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1956490">var</span>&nbsp;<span class="ident" id="1956494">base</span>&nbsp;<span class="ident" id="1956499">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1956506">if</span>&nbsp;<span class="ident" id="1956509">dosheader</span><span class="op" id="1956518">[</span><span class="num" id="1956519">0</span><span class="op" id="1956520">]</span>&nbsp;<span class="op" id="1956522">==</span>&nbsp;<span class="string" id="1956525">&#39;M&#39;</span>&nbsp;<span class="op" id="1956529">&amp;&amp;</span>&nbsp;<span class="ident" id="1956532">dosheader</span><span class="op" id="1956541">[</span><span class="num" id="1956542">1</span><span class="op" id="1956543">]</span>&nbsp;<span class="op" id="1956545">==</span>&nbsp;<span class="string" id="1956548">&#39;Z&#39;</span>&nbsp;<span class="op" id="1956552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1956556">signoff</span>&nbsp;<span class="op" id="1956564">:=</span>&nbsp;<span class="ident" id="1956567">int64</span><span class="op" id="1956572">(</span><span class="ident" id="1956573">binary</span><span class="op" id="1956579">.</span><span class="ident" id="1956580">LittleEndian</span><span class="op" id="1956592">.</span><span class="ident" id="1956593">Uint32</span><span class="op" id="1956599">(</span><span class="ident" id="1956600">dosheader</span><span class="op" id="1956609">[</span><span class="num" id="1956610">0x3c</span><span class="op" id="1956614">:</span><span class="op" id="1956615">]</span><span class="op" id="1956616">)</span><span class="op" id="1956617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1956621">var</span>&nbsp;<span class="ident" id="1956625">sign</span>&nbsp;<span class="op" id="1956630">[</span><span class="num" id="1956631">4</span><span class="op" id="1956632">]</span><span class="builtintype" id="1956633">byte</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1956640">r</span><span class="op" id="1956641">.</span><span class="ident" id="1956642">ReadAt</span><span class="op" id="1956648">(</span><span class="ident" id="1956649">sign</span><span class="op" id="1956653">[</span><span class="op" id="1956654">:</span><span class="op" id="1956655">]</span><span class="op" id="1956656">,</span>&nbsp;<span class="ident" id="1956658">signoff</span><span class="op" id="1956665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1956669">if</span>&nbsp;<span class="op" id="1956672">!</span><span class="op" id="1956673">(</span><span class="ident" id="1956674">sign</span><span class="op" id="1956678">[</span><span class="num" id="1956679">0</span><span class="op" id="1956680">]</span>&nbsp;<span class="op" id="1956682">==</span>&nbsp;<span class="string" id="1956685">&#39;P&#39;</span>&nbsp;<span class="op" id="1956689">&amp;&amp;</span>&nbsp;<span class="ident" id="1956692">sign</span><span class="op" id="1956696">[</span><span class="num" id="1956697">1</span><span class="op" id="1956698">]</span>&nbsp;<span class="op" id="1956700">==</span>&nbsp;<span class="string" id="1956703">&#39;E&#39;</span>&nbsp;<span class="op" id="1956707">&amp;&amp;</span>&nbsp;<span class="ident" id="1956710">sign</span><span class="op" id="1956714">[</span><span class="num" id="1956715">2</span><span class="op" id="1956716">]</span>&nbsp;<span class="op" id="1956718">==</span>&nbsp;<span class="num" id="1956721">0</span>&nbsp;<span class="op" id="1956723">&amp;&amp;</span>&nbsp;<span class="ident" id="1956726">sign</span><span class="op" id="1956730">[</span><span class="num" id="1956731">3</span><span class="op" id="1956732">]</span>&nbsp;<span class="op" id="1956734">==</span>&nbsp;<span class="num" id="1956737">0</span><span class="op" id="1956738">)</span>&nbsp;<span class="op" id="1956740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1956745">return</span>&nbsp;<span class="ident" id="1956752">nil</span><span class="op" id="1956755">,</span>&nbsp;<span class="ident" id="1956757">errors</span><span class="op" id="1956763">.</span><span class="ident" id="1956764">New</span><span class="op" id="1956767">(</span><span class="string" id="1956768">&#34;Invalid&nbsp;PE&nbsp;File&nbsp;Format.&#34;</span><span class="op" id="1956793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1956797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1956801">base</span>&nbsp;<span class="op" id="1956806">=</span>&nbsp;<span class="ident" id="1956808">signoff</span>&nbsp;<span class="op" id="1956816">+</span>&nbsp;<span class="num" id="1956818">4</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1956821">}</span>&nbsp;<span class="keyword" id="1956823">else</span>&nbsp;<span class="op" id="1956828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1956832">base</span>&nbsp;<span class="op" id="1956837">=</span>&nbsp;<span class="ident" id="1956839">int64</span><span class="op" id="1956844">(</span><span class="num" id="1956845">0</span><span class="op" id="1956846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1956849">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1956852">sr</span><span class="op" id="1956854">.</span><span class="ident" id="1956855">Seek</span><span class="op" id="1956859">(</span><span class="ident" id="1956860">base</span><span class="op" id="1956864">,</span>&nbsp;<span class="ident" id="1956866">os</span><span class="op" id="1956868">.</span><span class="ident" id="1956869">SEEK_SET</span><span class="op" id="1956877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1956880">if</span>&nbsp;<span class="ident" id="1956883">err</span>&nbsp;<span class="op" id="1956887">:=</span>&nbsp;<span class="ident" id="1956890">binary</span><span class="op" id="1956896">.</span><span class="ident" id="1956897">Read</span><span class="op" id="1956901">(</span><span class="ident" id="1956902">sr</span><span class="op" id="1956904">,</span>&nbsp;<span class="ident" id="1956906">binary</span><span class="op" id="1956912">.</span><span class="ident" id="1956913">LittleEndian</span><span class="op" id="1956925">,</span>&nbsp;<span class="op" id="1956927">&amp;</span><span class="ident" id="1956928">f</span><span class="op" id="1956929">.</span><span class="ident" id="1956930">FileHeader</span><span class="op" id="1956940">)</span><span class="op" id="1956941">;</span>&nbsp;<span class="ident" id="1956943">err</span>&nbsp;<span class="op" id="1956947">!=</span>&nbsp;<span class="ident" id="1956950">nil</span>&nbsp;<span class="op" id="1956954">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1956958">return</span>&nbsp;<span class="ident" id="1956965">nil</span><span class="op" id="1956968">,</span>&nbsp;<span class="ident" id="1956970">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1956975">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1956978">if</span>&nbsp;<span class="ident" id="1956981">f</span><span class="op" id="1956982">.</span><span class="ident" id="1956983">FileHeader</span><span class="op" id="1956993">.</span><span class="ident" id="1956994">Machine</span>&nbsp;<span class="op" id="1957002">!=</span>&nbsp;<span class="ident" id="1957005">IMAGE_FILE_MACHINE_UNKNOWN</span>&nbsp;<span class="op" id="1957032">&amp;&amp;</span>&nbsp;<span class="ident" id="1957035">f</span><span class="op" id="1957036">.</span><span class="ident" id="1957037">FileHeader</span><span class="op" id="1957047">.</span><span class="ident" id="1957048">Machine</span>&nbsp;<span class="op" id="1957056">!=</span>&nbsp;<span class="ident" id="1957059">IMAGE_FILE_MACHINE_AMD64</span>&nbsp;<span class="op" id="1957084">&amp;&amp;</span>&nbsp;<span class="ident" id="1957087">f</span><span class="op" id="1957088">.</span><span class="ident" id="1957089">FileHeader</span><span class="op" id="1957099">.</span><span class="ident" id="1957100">Machine</span>&nbsp;<span class="op" id="1957108">!=</span>&nbsp;<span class="ident" id="1957111">IMAGE_FILE_MACHINE_I386</span>&nbsp;<span class="op" id="1957135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1957139">return</span>&nbsp;<span class="ident" id="1957146">nil</span><span class="op" id="1957149">,</span>&nbsp;<span class="ident" id="1957151">errors</span><span class="op" id="1957157">.</span><span class="ident" id="1957158">New</span><span class="op" id="1957161">(</span><span class="string" id="1957162">&#34;Invalid&nbsp;PE&nbsp;File&nbsp;Format.&#34;</span><span class="op" id="1957187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1957190">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1957194">var</span>&nbsp;<span class="ident" id="1957198">ss</span>&nbsp;<span class="op" id="1957201">[</span><span class="op" id="1957202">]</span><span class="builtintype" id="1957203">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1957209">if</span>&nbsp;<span class="ident" id="1957212">f</span><span class="op" id="1957213">.</span><span class="ident" id="1957214">FileHeader</span><span class="op" id="1957224">.</span><span class="ident" id="1957225">NumberOfSymbols</span>&nbsp;<span class="op" id="1957241">&gt;</span>&nbsp;<span class="num" id="1957243">0</span>&nbsp;<span class="op" id="1957245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1957249">//&nbsp;Get&nbsp;COFF&nbsp;string&nbsp;table,&nbsp;which&nbsp;is&nbsp;located&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;COFF&nbsp;symbol&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1957331">sr</span><span class="op" id="1957333">.</span><span class="ident" id="1957334">Seek</span><span class="op" id="1957338">(</span><span class="ident" id="1957339">int64</span><span class="op" id="1957344">(</span><span class="ident" id="1957345">f</span><span class="op" id="1957346">.</span><span class="ident" id="1957347">FileHeader</span><span class="op" id="1957357">.</span><span class="ident" id="1957358">PointerToSymbolTable</span><span class="op" id="1957378">+</span><span class="ident" id="1957379">COFFSymbolSize</span><span class="op" id="1957393">*</span><span class="ident" id="1957394">f</span><span class="op" id="1957395">.</span><span class="ident" id="1957396">FileHeader</span><span class="op" id="1957406">.</span><span class="ident" id="1957407">NumberOfSymbols</span><span class="op" id="1957422">)</span><span class="op" id="1957423">,</span>&nbsp;<span class="ident" id="1957425">os</span><span class="op" id="1957427">.</span><span class="ident" id="1957428">SEEK_SET</span><span class="op" id="1957436">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1957440">var</span>&nbsp;<span class="ident" id="1957444">l</span>&nbsp;<span class="builtintype" id="1957446">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1957455">if</span>&nbsp;<span class="ident" id="1957458">err</span>&nbsp;<span class="op" id="1957462">:=</span>&nbsp;<span class="ident" id="1957465">binary</span><span class="op" id="1957471">.</span><span class="ident" id="1957472">Read</span><span class="op" id="1957476">(</span><span class="ident" id="1957477">sr</span><span class="op" id="1957479">,</span>&nbsp;<span class="ident" id="1957481">binary</span><span class="op" id="1957487">.</span><span class="ident" id="1957488">LittleEndian</span><span class="op" id="1957500">,</span>&nbsp;<span class="op" id="1957502">&amp;</span><span class="ident" id="1957503">l</span><span class="op" id="1957504">)</span><span class="op" id="1957505">;</span>&nbsp;<span class="ident" id="1957507">err</span>&nbsp;<span class="op" id="1957511">!=</span>&nbsp;<span class="ident" id="1957514">nil</span>&nbsp;<span class="op" id="1957518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1957523">return</span>&nbsp;<span class="ident" id="1957530">nil</span><span class="op" id="1957533">,</span>&nbsp;<span class="ident" id="1957535">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1957541">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1957545">ss</span>&nbsp;<span class="op" id="1957548">=</span>&nbsp;<span class="builtinfunc" id="1957550">make</span><span class="op" id="1957554">(</span><span class="op" id="1957555">[</span><span class="op" id="1957556">]</span><span class="builtintype" id="1957557">byte</span><span class="op" id="1957561">,</span>&nbsp;<span class="ident" id="1957563">l</span><span class="op" id="1957564">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1957568">if</span>&nbsp;<span class="ident" id="1957571">_</span><span class="op" id="1957572">,</span>&nbsp;<span class="ident" id="1957574">err</span>&nbsp;<span class="op" id="1957578">:=</span>&nbsp;<span class="ident" id="1957581">r</span><span class="op" id="1957582">.</span><span class="ident" id="1957583">ReadAt</span><span class="op" id="1957589">(</span><span class="ident" id="1957590">ss</span><span class="op" id="1957592">,</span>&nbsp;<span class="ident" id="1957594">int64</span><span class="op" id="1957599">(</span><span class="ident" id="1957600">f</span><span class="op" id="1957601">.</span><span class="ident" id="1957602">FileHeader</span><span class="op" id="1957612">.</span><span class="ident" id="1957613">PointerToSymbolTable</span><span class="op" id="1957633">+</span><span class="ident" id="1957634">COFFSymbolSize</span><span class="op" id="1957648">*</span><span class="ident" id="1957649">f</span><span class="op" id="1957650">.</span><span class="ident" id="1957651">FileHeader</span><span class="op" id="1957661">.</span><span class="ident" id="1957662">NumberOfSymbols</span><span class="op" id="1957677">)</span><span class="op" id="1957678">)</span><span class="op" id="1957679">;</span>&nbsp;<span class="ident" id="1957681">err</span>&nbsp;<span class="op" id="1957685">!=</span>&nbsp;<span class="ident" id="1957688">nil</span>&nbsp;<span class="op" id="1957692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1957697">return</span>&nbsp;<span class="ident" id="1957704">nil</span><span class="op" id="1957707">,</span>&nbsp;<span class="ident" id="1957709">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1957715">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1957720">//&nbsp;Process&nbsp;COFF&nbsp;symbol&nbsp;table.</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1957752">sr</span><span class="op" id="1957754">.</span><span class="ident" id="1957755">Seek</span><span class="op" id="1957759">(</span><span class="ident" id="1957760">int64</span><span class="op" id="1957765">(</span><span class="ident" id="1957766">f</span><span class="op" id="1957767">.</span><span class="ident" id="1957768">FileHeader</span><span class="op" id="1957778">.</span><span class="ident" id="1957779">PointerToSymbolTable</span><span class="op" id="1957799">)</span><span class="op" id="1957800">,</span>&nbsp;<span class="ident" id="1957802">os</span><span class="op" id="1957804">.</span><span class="ident" id="1957805">SEEK_SET</span><span class="op" id="1957813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1957817">aux</span>&nbsp;<span class="op" id="1957821">:=</span>&nbsp;<span class="builtintype" id="1957824">uint8</span><span class="op" id="1957829">(</span><span class="num" id="1957830">0</span><span class="op" id="1957831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1957835">for</span>&nbsp;<span class="ident" id="1957839">i</span>&nbsp;<span class="op" id="1957841">:=</span>&nbsp;<span class="num" id="1957844">0</span><span class="op" id="1957845">;</span>&nbsp;<span class="ident" id="1957847">i</span>&nbsp;<span class="op" id="1957849">&lt;</span>&nbsp;<span class="builtintype" id="1957851">int</span><span class="op" id="1957854">(</span><span class="ident" id="1957855">f</span><span class="op" id="1957856">.</span><span class="ident" id="1957857">FileHeader</span><span class="op" id="1957867">.</span><span class="ident" id="1957868">NumberOfSymbols</span><span class="op" id="1957883">)</span><span class="op" id="1957884">;</span>&nbsp;<span class="ident" id="1957886">i</span><span class="op" id="1957887">++</span>&nbsp;<span class="op" id="1957890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1957895">cs</span>&nbsp;<span class="op" id="1957898">:=</span>&nbsp;<span class="builtinfunc" id="1957901">new</span><span class="op" id="1957904">(</span><span class="ident" id="1957905">COFFSymbol</span><span class="op" id="1957915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1957920">if</span>&nbsp;<span class="ident" id="1957923">err</span>&nbsp;<span class="op" id="1957927">:=</span>&nbsp;<span class="ident" id="1957930">binary</span><span class="op" id="1957936">.</span><span class="ident" id="1957937">Read</span><span class="op" id="1957941">(</span><span class="ident" id="1957942">sr</span><span class="op" id="1957944">,</span>&nbsp;<span class="ident" id="1957946">binary</span><span class="op" id="1957952">.</span><span class="ident" id="1957953">LittleEndian</span><span class="op" id="1957965">,</span>&nbsp;<span class="ident" id="1957967">cs</span><span class="op" id="1957969">)</span><span class="op" id="1957970">;</span>&nbsp;<span class="ident" id="1957972">err</span>&nbsp;<span class="op" id="1957976">!=</span>&nbsp;<span class="ident" id="1957979">nil</span>&nbsp;<span class="op" id="1957983">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1957989">return</span>&nbsp;<span class="ident" id="1957996">nil</span><span class="op" id="1957999">,</span>&nbsp;<span class="ident" id="1958001">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1958008">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1958013">if</span>&nbsp;<span class="ident" id="1958016">aux</span>&nbsp;<span class="op" id="1958020">&gt;</span>&nbsp;<span class="num" id="1958022">0</span>&nbsp;<span class="op" id="1958024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1958030">aux</span><span class="op" id="1958033">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1958040">continue</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1958052">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1958057">var</span>&nbsp;<span class="ident" id="1958061">name</span>&nbsp;<span class="builtintype" id="1958066">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1958076">if</span>&nbsp;<span class="ident" id="1958079">cs</span><span class="op" id="1958081">.</span><span class="ident" id="1958082">Name</span><span class="op" id="1958086">[</span><span class="num" id="1958087">0</span><span class="op" id="1958088">]</span>&nbsp;<span class="op" id="1958090">==</span>&nbsp;<span class="num" id="1958093">0</span>&nbsp;<span class="op" id="1958095">&amp;&amp;</span>&nbsp;<span class="ident" id="1958098">cs</span><span class="op" id="1958100">.</span><span class="ident" id="1958101">Name</span><span class="op" id="1958105">[</span><span class="num" id="1958106">1</span><span class="op" id="1958107">]</span>&nbsp;<span class="op" id="1958109">==</span>&nbsp;<span class="num" id="1958112">0</span>&nbsp;<span class="op" id="1958114">&amp;&amp;</span>&nbsp;<span class="ident" id="1958117">cs</span><span class="op" id="1958119">.</span><span class="ident" id="1958120">Name</span><span class="op" id="1958124">[</span><span class="num" id="1958125">2</span><span class="op" id="1958126">]</span>&nbsp;<span class="op" id="1958128">==</span>&nbsp;<span class="num" id="1958131">0</span>&nbsp;<span class="op" id="1958133">&amp;&amp;</span>&nbsp;<span class="ident" id="1958136">cs</span><span class="op" id="1958138">.</span><span class="ident" id="1958139">Name</span><span class="op" id="1958143">[</span><span class="num" id="1958144">3</span><span class="op" id="1958145">]</span>&nbsp;<span class="op" id="1958147">==</span>&nbsp;<span class="num" id="1958150">0</span>&nbsp;<span class="op" id="1958152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1958158">si</span>&nbsp;<span class="op" id="1958161">:=</span>&nbsp;<span class="builtintype" id="1958164">int</span><span class="op" id="1958167">(</span><span class="ident" id="1958168">binary</span><span class="op" id="1958174">.</span><span class="ident" id="1958175">LittleEndian</span><span class="op" id="1958187">.</span><span class="ident" id="1958188">Uint32</span><span class="op" id="1958194">(</span><span class="ident" id="1958195">cs</span><span class="op" id="1958197">.</span><span class="ident" id="1958198">Name</span><span class="op" id="1958202">[</span><span class="num" id="1958203">4</span><span class="op" id="1958204">:</span><span class="op" id="1958205">]</span><span class="op" id="1958206">)</span><span class="op" id="1958207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1958213">name</span><span class="op" id="1958217">,</span>&nbsp;<span class="ident" id="1958219">_</span>&nbsp;<span class="op" id="1958221">=</span>&nbsp;<span class="ident" id="1958223">getString</span><span class="op" id="1958232">(</span><span class="ident" id="1958233">ss</span><span class="op" id="1958235">,</span>&nbsp;<span class="ident" id="1958237">si</span><span class="op" id="1958239">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1958244">}</span>&nbsp;<span class="keyword" id="1958246">else</span>&nbsp;<span class="op" id="1958251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1958257">name</span>&nbsp;<span class="op" id="1958262">=</span>&nbsp;<span class="ident" id="1958264">cstring</span><span class="op" id="1958271">(</span><span class="ident" id="1958272">cs</span><span class="op" id="1958274">.</span><span class="ident" id="1958275">Name</span><span class="op" id="1958279">[</span><span class="op" id="1958280">:</span><span class="op" id="1958281">]</span><span class="op" id="1958282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1958287">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1958292">aux</span>&nbsp;<span class="op" id="1958296">=</span>&nbsp;<span class="ident" id="1958298">cs</span><span class="op" id="1958300">.</span><span class="ident" id="1958301">NumberOfAuxSymbols</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1958323">s</span>&nbsp;<span class="op" id="1958325">:=</span>&nbsp;<span class="op" id="1958328">&amp;</span><span class="ident" id="1958329">Symbol</span><span class="op" id="1958335">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1958341">Name</span><span class="op" id="1958345">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1958356">name</span><span class="op" id="1958360">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1958366">Value</span><span class="op" id="1958371">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1958381">cs</span><span class="op" id="1958383">.</span><span class="ident" id="1958384">Value</span><span class="op" id="1958389">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1958395">SectionNumber</span><span class="op" id="1958408">:</span>&nbsp;<span class="ident" id="1958410">cs</span><span class="op" id="1958412">.</span><span class="ident" id="1958413">SectionNumber</span><span class="op" id="1958426">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1958432">Type</span><span class="op" id="1958436">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1958447">cs</span><span class="op" id="1958449">.</span><span class="ident" id="1958450">Type</span><span class="op" id="1958454">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1958460">StorageClass</span><span class="op" id="1958472">:</span>&nbsp;&nbsp;<span class="ident" id="1958475">cs</span><span class="op" id="1958477">.</span><span class="ident" id="1958478">StorageClass</span><span class="op" id="1958490">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1958495">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1958500">f</span><span class="op" id="1958501">.</span><span class="ident" id="1958502">Symbols</span>&nbsp;<span class="op" id="1958510">=</span>&nbsp;<span class="builtinfunc" id="1958512">append</span><span class="op" id="1958518">(</span><span class="ident" id="1958519">f</span><span class="op" id="1958520">.</span><span class="ident" id="1958521">Symbols</span><span class="op" id="1958528">,</span>&nbsp;<span class="ident" id="1958530">s</span><span class="op" id="1958531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1958535">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1958538">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1958542">//&nbsp;Read&nbsp;optional&nbsp;header.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1958568">sr</span><span class="op" id="1958570">.</span><span class="ident" id="1958571">Seek</span><span class="op" id="1958575">(</span><span class="ident" id="1958576">base</span><span class="op" id="1958580">,</span>&nbsp;<span class="ident" id="1958582">os</span><span class="op" id="1958584">.</span><span class="ident" id="1958585">SEEK_SET</span><span class="op" id="1958593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1958596">if</span>&nbsp;<span class="ident" id="1958599">err</span>&nbsp;<span class="op" id="1958603">:=</span>&nbsp;<span class="ident" id="1958606">binary</span><span class="op" id="1958612">.</span><span class="ident" id="1958613">Read</span><span class="op" id="1958617">(</span><span class="ident" id="1958618">sr</span><span class="op" id="1958620">,</span>&nbsp;<span class="ident" id="1958622">binary</span><span class="op" id="1958628">.</span><span class="ident" id="1958629">LittleEndian</span><span class="op" id="1958641">,</span>&nbsp;<span class="op" id="1958643">&amp;</span><span class="ident" id="1958644">f</span><span class="op" id="1958645">.</span><span class="ident" id="1958646">FileHeader</span><span class="op" id="1958656">)</span><span class="op" id="1958657">;</span>&nbsp;<span class="ident" id="1958659">err</span>&nbsp;<span class="op" id="1958663">!=</span>&nbsp;<span class="ident" id="1958666">nil</span>&nbsp;<span class="op" id="1958670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1958674">return</span>&nbsp;<span class="ident" id="1958681">nil</span><span class="op" id="1958684">,</span>&nbsp;<span class="ident" id="1958686">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1958691">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1958694">var</span>&nbsp;<span class="ident" id="1958698">oh32</span>&nbsp;<span class="ident" id="1958703">OptionalHeader32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1958721">var</span>&nbsp;<span class="ident" id="1958725">oh64</span>&nbsp;<span class="ident" id="1958730">OptionalHeader64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1958748">switch</span>&nbsp;<span class="ident" id="1958755">f</span><span class="op" id="1958756">.</span><span class="ident" id="1958757">FileHeader</span><span class="op" id="1958767">.</span><span class="ident" id="1958768">SizeOfOptionalHeader</span>&nbsp;<span class="op" id="1958789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1958792">case</span>&nbsp;<span class="ident" id="1958797">sizeofOptionalHeader32</span><span class="op" id="1958819">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1958823">if</span>&nbsp;<span class="ident" id="1958826">err</span>&nbsp;<span class="op" id="1958830">:=</span>&nbsp;<span class="ident" id="1958833">binary</span><span class="op" id="1958839">.</span><span class="ident" id="1958840">Read</span><span class="op" id="1958844">(</span><span class="ident" id="1958845">sr</span><span class="op" id="1958847">,</span>&nbsp;<span class="ident" id="1958849">binary</span><span class="op" id="1958855">.</span><span class="ident" id="1958856">LittleEndian</span><span class="op" id="1958868">,</span>&nbsp;<span class="op" id="1958870">&amp;</span><span class="ident" id="1958871">oh32</span><span class="op" id="1958875">)</span><span class="op" id="1958876">;</span>&nbsp;<span class="ident" id="1958878">err</span>&nbsp;<span class="op" id="1958882">!=</span>&nbsp;<span class="ident" id="1958885">nil</span>&nbsp;<span class="op" id="1958889">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1958894">return</span>&nbsp;<span class="ident" id="1958901">nil</span><span class="op" id="1958904">,</span>&nbsp;<span class="ident" id="1958906">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1958912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1958916">if</span>&nbsp;<span class="ident" id="1958919">oh32</span><span class="op" id="1958923">.</span><span class="ident" id="1958924">Magic</span>&nbsp;<span class="op" id="1958930">!=</span>&nbsp;<span class="num" id="1958933">0x10b</span>&nbsp;<span class="op" id="1958939">{</span>&nbsp;<span class="comment" id="1958941">//&nbsp;PE32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1958952">return</span>&nbsp;<span class="ident" id="1958959">nil</span><span class="op" id="1958962">,</span>&nbsp;<span class="ident" id="1958964">fmt</span><span class="op" id="1958967">.</span><span class="ident" id="1958968">Errorf</span><span class="op" id="1958974">(</span><span class="string" id="1958975">&#34;pe32&nbsp;optional&nbsp;header&nbsp;has&nbsp;unexpected&nbsp;Magic&nbsp;of&nbsp;0x%x&#34;</span><span class="op" id="1959026">,</span>&nbsp;<span class="ident" id="1959028">oh32</span><span class="op" id="1959032">.</span><span class="ident" id="1959033">Magic</span><span class="op" id="1959038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1959042">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1959046">f</span><span class="op" id="1959047">.</span><span class="ident" id="1959048">OptionalHeader</span>&nbsp;<span class="op" id="1959063">=</span>&nbsp;<span class="op" id="1959065">&amp;</span><span class="ident" id="1959066">oh32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1959072">case</span>&nbsp;<span class="ident" id="1959077">sizeofOptionalHeader64</span><span class="op" id="1959099">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1959103">if</span>&nbsp;<span class="ident" id="1959106">err</span>&nbsp;<span class="op" id="1959110">:=</span>&nbsp;<span class="ident" id="1959113">binary</span><span class="op" id="1959119">.</span><span class="ident" id="1959120">Read</span><span class="op" id="1959124">(</span><span class="ident" id="1959125">sr</span><span class="op" id="1959127">,</span>&nbsp;<span class="ident" id="1959129">binary</span><span class="op" id="1959135">.</span><span class="ident" id="1959136">LittleEndian</span><span class="op" id="1959148">,</span>&nbsp;<span class="op" id="1959150">&amp;</span><span class="ident" id="1959151">oh64</span><span class="op" id="1959155">)</span><span class="op" id="1959156">;</span>&nbsp;<span class="ident" id="1959158">err</span>&nbsp;<span class="op" id="1959162">!=</span>&nbsp;<span class="ident" id="1959165">nil</span>&nbsp;<span class="op" id="1959169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1959174">return</span>&nbsp;<span class="ident" id="1959181">nil</span><span class="op" id="1959184">,</span>&nbsp;<span class="ident" id="1959186">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1959192">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1959196">if</span>&nbsp;<span class="ident" id="1959199">oh64</span><span class="op" id="1959203">.</span><span class="ident" id="1959204">Magic</span>&nbsp;<span class="op" id="1959210">!=</span>&nbsp;<span class="num" id="1959213">0x20b</span>&nbsp;<span class="op" id="1959219">{</span>&nbsp;<span class="comment" id="1959221">//&nbsp;PE32+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1959233">return</span>&nbsp;<span class="ident" id="1959240">nil</span><span class="op" id="1959243">,</span>&nbsp;<span class="ident" id="1959245">fmt</span><span class="op" id="1959248">.</span><span class="ident" id="1959249">Errorf</span><span class="op" id="1959255">(</span><span class="string" id="1959256">&#34;pe32+&nbsp;optional&nbsp;header&nbsp;has&nbsp;unexpected&nbsp;Magic&nbsp;of&nbsp;0x%x&#34;</span><span class="op" id="1959308">,</span>&nbsp;<span class="ident" id="1959310">oh64</span><span class="op" id="1959314">.</span><span class="ident" id="1959315">Magic</span><span class="op" id="1959320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1959324">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1959328">f</span><span class="op" id="1959329">.</span><span class="ident" id="1959330">OptionalHeader</span>&nbsp;<span class="op" id="1959345">=</span>&nbsp;<span class="op" id="1959347">&amp;</span><span class="ident" id="1959348">oh64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1959354">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1959358">//&nbsp;Process&nbsp;sections.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1959380">f</span><span class="op" id="1959381">.</span><span class="ident" id="1959382">Sections</span>&nbsp;<span class="op" id="1959391">=</span>&nbsp;<span class="builtinfunc" id="1959393">make</span><span class="op" id="1959397">(</span><span class="op" id="1959398">[</span><span class="op" id="1959399">]</span><span class="op" id="1959400">*</span><span class="ident" id="1959401">Section</span><span class="op" id="1959408">,</span>&nbsp;<span class="ident" id="1959410">f</span><span class="op" id="1959411">.</span><span class="ident" id="1959412">FileHeader</span><span class="op" id="1959422">.</span><span class="ident" id="1959423">NumberOfSections</span><span class="op" id="1959439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1959442">for</span>&nbsp;<span class="ident" id="1959446">i</span>&nbsp;<span class="op" id="1959448">:=</span>&nbsp;<span class="num" id="1959451">0</span><span class="op" id="1959452">;</span>&nbsp;<span class="ident" id="1959454">i</span>&nbsp;<span class="op" id="1959456">&lt;</span>&nbsp;<span class="builtintype" id="1959458">int</span><span class="op" id="1959461">(</span><span class="ident" id="1959462">f</span><span class="op" id="1959463">.</span><span class="ident" id="1959464">FileHeader</span><span class="op" id="1959474">.</span><span class="ident" id="1959475">NumberOfSections</span><span class="op" id="1959491">)</span><span class="op" id="1959492">;</span>&nbsp;<span class="ident" id="1959494">i</span><span class="op" id="1959495">++</span>&nbsp;<span class="op" id="1959498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1959502">sh</span>&nbsp;<span class="op" id="1959505">:=</span>&nbsp;<span class="builtinfunc" id="1959508">new</span><span class="op" id="1959511">(</span><span class="ident" id="1959512">SectionHeader32</span><span class="op" id="1959527">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1959531">if</span>&nbsp;<span class="ident" id="1959534">err</span>&nbsp;<span class="op" id="1959538">:=</span>&nbsp;<span class="ident" id="1959541">binary</span><span class="op" id="1959547">.</span><span class="ident" id="1959548">Read</span><span class="op" id="1959552">(</span><span class="ident" id="1959553">sr</span><span class="op" id="1959555">,</span>&nbsp;<span class="ident" id="1959557">binary</span><span class="op" id="1959563">.</span><span class="ident" id="1959564">LittleEndian</span><span class="op" id="1959576">,</span>&nbsp;<span class="ident" id="1959578">sh</span><span class="op" id="1959580">)</span><span class="op" id="1959581">;</span>&nbsp;<span class="ident" id="1959583">err</span>&nbsp;<span class="op" id="1959587">!=</span>&nbsp;<span class="ident" id="1959590">nil</span>&nbsp;<span class="op" id="1959594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1959599">return</span>&nbsp;<span class="ident" id="1959606">nil</span><span class="op" id="1959609">,</span>&nbsp;<span class="ident" id="1959611">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1959617">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1959621">var</span>&nbsp;<span class="ident" id="1959625">name</span>&nbsp;<span class="builtintype" id="1959630">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1959639">if</span>&nbsp;<span class="ident" id="1959642">sh</span><span class="op" id="1959644">.</span><span class="ident" id="1959645">Name</span><span class="op" id="1959649">[</span><span class="num" id="1959650">0</span><span class="op" id="1959651">]</span>&nbsp;<span class="op" id="1959653">==</span>&nbsp;<span class="string" id="1959656">&#39;\x2F&#39;</span>&nbsp;<span class="op" id="1959663">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1959668">si</span><span class="op" id="1959670">,</span>&nbsp;<span class="ident" id="1959672">_</span>&nbsp;<span class="op" id="1959674">:=</span>&nbsp;<span class="ident" id="1959677">strconv</span><span class="op" id="1959684">.</span><span class="ident" id="1959685">Atoi</span><span class="op" id="1959689">(</span><span class="ident" id="1959690">cstring</span><span class="op" id="1959697">(</span><span class="ident" id="1959698">sh</span><span class="op" id="1959700">.</span><span class="ident" id="1959701">Name</span><span class="op" id="1959705">[</span><span class="num" id="1959706">1</span><span class="op" id="1959707">:</span><span class="op" id="1959708">]</span><span class="op" id="1959709">)</span><span class="op" id="1959710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1959715">name</span><span class="op" id="1959719">,</span>&nbsp;<span class="ident" id="1959721">_</span>&nbsp;<span class="op" id="1959723">=</span>&nbsp;<span class="ident" id="1959725">getString</span><span class="op" id="1959734">(</span><span class="ident" id="1959735">ss</span><span class="op" id="1959737">,</span>&nbsp;<span class="ident" id="1959739">si</span><span class="op" id="1959741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1959745">}</span>&nbsp;<span class="keyword" id="1959747">else</span>&nbsp;<span class="op" id="1959752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1959757">name</span>&nbsp;<span class="op" id="1959762">=</span>&nbsp;<span class="ident" id="1959764">cstring</span><span class="op" id="1959771">(</span><span class="ident" id="1959772">sh</span><span class="op" id="1959774">.</span><span class="ident" id="1959775">Name</span><span class="op" id="1959779">[</span><span class="num" id="1959780">0</span><span class="op" id="1959781">:</span><span class="op" id="1959782">]</span><span class="op" id="1959783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1959787">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1959791">s</span>&nbsp;<span class="op" id="1959793">:=</span>&nbsp;<span class="builtinfunc" id="1959796">new</span><span class="op" id="1959799">(</span><span class="ident" id="1959800">Section</span><span class="op" id="1959807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1959811">s</span><span class="op" id="1959812">.</span><span class="ident" id="1959813">SectionHeader</span>&nbsp;<span class="op" id="1959827">=</span>&nbsp;<span class="ident" id="1959829">SectionHeader</span><span class="op" id="1959842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1959847">Name</span><span class="op" id="1959851">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1959869">name</span><span class="op" id="1959873">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1959878">VirtualSize</span><span class="op" id="1959889">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1959900">sh</span><span class="op" id="1959902">.</span><span class="ident" id="1959903">VirtualSize</span><span class="op" id="1959914">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1959919">VirtualAddress</span><span class="op" id="1959933">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1959941">sh</span><span class="op" id="1959943">.</span><span class="ident" id="1959944">VirtualAddress</span><span class="op" id="1959958">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1959963">Size</span><span class="op" id="1959967">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1959985">sh</span><span class="op" id="1959987">.</span><span class="ident" id="1959988">SizeOfRawData</span><span class="op" id="1960001">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1960006">Offset</span><span class="op" id="1960012">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1960028">sh</span><span class="op" id="1960030">.</span><span class="ident" id="1960031">PointerToRawData</span><span class="op" id="1960047">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1960052">PointerToRelocations</span><span class="op" id="1960072">:</span>&nbsp;<span class="ident" id="1960074">sh</span><span class="op" id="1960076">.</span><span class="ident" id="1960077">PointerToRelocations</span><span class="op" id="1960097">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1960102">PointerToLineNumbers</span><span class="op" id="1960122">:</span>&nbsp;<span class="ident" id="1960124">sh</span><span class="op" id="1960126">.</span><span class="ident" id="1960127">PointerToLineNumbers</span><span class="op" id="1960147">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1960152">NumberOfRelocations</span><span class="op" id="1960171">:</span>&nbsp;&nbsp;<span class="ident" id="1960174">sh</span><span class="op" id="1960176">.</span><span class="ident" id="1960177">NumberOfRelocations</span><span class="op" id="1960196">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1960201">NumberOfLineNumbers</span><span class="op" id="1960220">:</span>&nbsp;&nbsp;<span class="ident" id="1960223">sh</span><span class="op" id="1960225">.</span><span class="ident" id="1960226">NumberOfLineNumbers</span><span class="op" id="1960245">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1960250">Characteristics</span><span class="op" id="1960265">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1960272">sh</span><span class="op" id="1960274">.</span><span class="ident" id="1960275">Characteristics</span><span class="op" id="1960290">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1960294">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1960298">s</span><span class="op" id="1960299">.</span><span class="ident" id="1960300">sr</span>&nbsp;<span class="op" id="1960303">=</span>&nbsp;<span class="ident" id="1960305">io</span><span class="op" id="1960307">.</span><span class="ident" id="1960308">NewSectionReader</span><span class="op" id="1960324">(</span><span class="ident" id="1960325">r</span><span class="op" id="1960326">,</span>&nbsp;<span class="ident" id="1960328">int64</span><span class="op" id="1960333">(</span><span class="ident" id="1960334">s</span><span class="op" id="1960335">.</span><span class="ident" id="1960336">SectionHeader</span><span class="op" id="1960349">.</span><span class="ident" id="1960350">Offset</span><span class="op" id="1960356">)</span><span class="op" id="1960357">,</span>&nbsp;<span class="ident" id="1960359">int64</span><span class="op" id="1960364">(</span><span class="ident" id="1960365">s</span><span class="op" id="1960366">.</span><span class="ident" id="1960367">SectionHeader</span><span class="op" id="1960380">.</span><span class="ident" id="1960381">Size</span><span class="op" id="1960385">)</span><span class="op" id="1960386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1960390">s</span><span class="op" id="1960391">.</span><span class="ident" id="1960392">ReaderAt</span>&nbsp;<span class="op" id="1960401">=</span>&nbsp;<span class="ident" id="1960403">s</span><span class="op" id="1960404">.</span><span class="ident" id="1960405">sr</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1960410">f</span><span class="op" id="1960411">.</span><span class="ident" id="1960412">Sections</span><span class="op" id="1960420">[</span><span class="ident" id="1960421">i</span><span class="op" id="1960422">]</span>&nbsp;<span class="op" id="1960424">=</span>&nbsp;<span class="ident" id="1960426">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1960429">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1960432">return</span>&nbsp;<span class="ident" id="1960439">f</span><span class="op" id="1960440">,</span>&nbsp;<span class="ident" id="1960442">nil</span><br>
<span class="lineno"></span><span class="op" id="1960446">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="keyword" id="1960449">func</span>&nbsp;<span class="ident" id="1960454">cstring</span><span class="op" id="1960461">(</span><span class="ident" id="1960462">b</span>&nbsp;<span class="op" id="1960464">[</span><span class="op" id="1960465">]</span><span class="builtintype" id="1960466">byte</span><span class="op" id="1960470">)</span>&nbsp;<span class="builtintype" id="1960472">string</span>&nbsp;<span class="op" id="1960479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1960482">var</span>&nbsp;<span class="ident" id="1960486">i</span>&nbsp;<span class="builtintype" id="1960488">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1960493">for</span>&nbsp;<span class="ident" id="1960497">i</span>&nbsp;<span class="op" id="1960499">=</span>&nbsp;<span class="num" id="1960501">0</span><span class="op" id="1960502">;</span>&nbsp;<span class="ident" id="1960504">i</span>&nbsp;<span class="op" id="1960506">&lt;</span>&nbsp;<span class="builtinfunc" id="1960508">len</span><span class="op" id="1960511">(</span><span class="ident" id="1960512">b</span><span class="op" id="1960513">)</span>&nbsp;<span class="op" id="1960515">&amp;&amp;</span>&nbsp;<span class="ident" id="1960518">b</span><span class="op" id="1960519">[</span><span class="ident" id="1960520">i</span><span class="op" id="1960521">]</span>&nbsp;<span class="op" id="1960523">!=</span>&nbsp;<span class="num" id="1960526">0</span><span class="op" id="1960527">;</span>&nbsp;<span class="ident" id="1960529">i</span><span class="op" id="1960530">++</span>&nbsp;<span class="op" id="1960533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1960536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1960539">return</span>&nbsp;<span class="builtintype" id="1960546">string</span><span class="op" id="1960552">(</span><span class="ident" id="1960553">b</span><span class="op" id="1960554">[</span><span class="num" id="1960555">0</span><span class="op" id="1960556">:</span><span class="ident" id="1960557">i</span><span class="op" id="1960558">]</span><span class="op" id="1960559">)</span><br>
<span class="lineno">270</span><span class="op" id="1960561">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1960564">//&nbsp;getString&nbsp;extracts&nbsp;a&nbsp;string&nbsp;from&nbsp;symbol&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="1960621">func</span>&nbsp;<span class="ident" id="1960626">getString</span><span class="op" id="1960635">(</span><span class="ident" id="1960636">section</span>&nbsp;<span class="op" id="1960644">[</span><span class="op" id="1960645">]</span><span class="builtintype" id="1960646">byte</span><span class="op" id="1960650">,</span>&nbsp;<span class="ident" id="1960652">start</span>&nbsp;<span class="builtintype" id="1960658">int</span><span class="op" id="1960661">)</span>&nbsp;<span class="op" id="1960663">(</span><span class="builtintype" id="1960664">string</span><span class="op" id="1960670">,</span>&nbsp;<span class="builtintype" id="1960672">bool</span><span class="op" id="1960676">)</span>&nbsp;<span class="op" id="1960678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1960681">if</span>&nbsp;<span class="ident" id="1960684">start</span>&nbsp;<span class="op" id="1960690">&lt;</span>&nbsp;<span class="num" id="1960692">0</span>&nbsp;<span class="op" id="1960694">||</span>&nbsp;<span class="ident" id="1960697">start</span>&nbsp;<span class="op" id="1960703">&gt;=</span>&nbsp;<span class="builtinfunc" id="1960706">len</span><span class="op" id="1960709">(</span><span class="ident" id="1960710">section</span><span class="op" id="1960717">)</span>&nbsp;<span class="op" id="1960719">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1960723">return</span>&nbsp;<span class="string" id="1960730">&#34;&#34;</span><span class="op" id="1960732">,</span>&nbsp;<span class="builtintype" id="1960734">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1960741">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1960745">for</span>&nbsp;<span class="ident" id="1960749">end</span>&nbsp;<span class="op" id="1960753">:=</span>&nbsp;<span class="ident" id="1960756">start</span><span class="op" id="1960761">;</span>&nbsp;<span class="ident" id="1960763">end</span>&nbsp;<span class="op" id="1960767">&lt;</span>&nbsp;<span class="builtinfunc" id="1960769">len</span><span class="op" id="1960772">(</span><span class="ident" id="1960773">section</span><span class="op" id="1960780">)</span><span class="op" id="1960781">;</span>&nbsp;<span class="ident" id="1960783">end</span><span class="op" id="1960786">++</span>&nbsp;<span class="op" id="1960789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1960793">if</span>&nbsp;<span class="ident" id="1960796">section</span><span class="op" id="1960803">[</span><span class="ident" id="1960804">end</span><span class="op" id="1960807">]</span>&nbsp;<span class="op" id="1960809">==</span>&nbsp;<span class="num" id="1960812">0</span>&nbsp;<span class="op" id="1960814">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1960819">return</span>&nbsp;<span class="builtintype" id="1960826">string</span><span class="op" id="1960832">(</span><span class="ident" id="1960833">section</span><span class="op" id="1960840">[</span><span class="ident" id="1960841">start</span><span class="op" id="1960846">:</span><span class="ident" id="1960847">end</span><span class="op" id="1960850">]</span><span class="op" id="1960851">)</span><span class="op" id="1960852">,</span>&nbsp;<span class="builtintype" id="1960854">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1960861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1960864">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1960867">return</span>&nbsp;<span class="string" id="1960874">&#34;&#34;</span><span class="op" id="1960876">,</span>&nbsp;<span class="builtintype" id="1960878">false</span><br>
<span class="lineno"></span><span class="op" id="1960884">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span><span class="comment" id="1960887">//&nbsp;Section&nbsp;returns&nbsp;the&nbsp;first&nbsp;section&nbsp;with&nbsp;the&nbsp;given&nbsp;name,&nbsp;or&nbsp;nil&nbsp;if&nbsp;no&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="1960963">//&nbsp;section&nbsp;exists.</span><br>
<span class="lineno"></span><span class="keyword" id="1960982">func</span>&nbsp;<span class="op" id="1960987">(</span><span class="ident" id="1960988">f</span>&nbsp;<span class="op" id="1960990">*</span><span class="ident" id="1960991">File</span><span class="op" id="1960995">)</span>&nbsp;<span class="ident" id="1960997">Section</span><span class="op" id="1961004">(</span><span class="ident" id="1961005">name</span>&nbsp;<span class="builtintype" id="1961010">string</span><span class="op" id="1961016">)</span>&nbsp;<span class="op" id="1961018">*</span><span class="ident" id="1961019">Section</span>&nbsp;<span class="op" id="1961027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1961030">for</span>&nbsp;<span class="ident" id="1961034">_</span><span class="op" id="1961035">,</span>&nbsp;<span class="ident" id="1961037">s</span>&nbsp;<span class="op" id="1961039">:=</span>&nbsp;<span class="keyword" id="1961042">range</span>&nbsp;<span class="ident" id="1961048">f</span><span class="op" id="1961049">.</span><span class="ident" id="1961050">Sections</span>&nbsp;<span class="op" id="1961059">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1961063">if</span>&nbsp;<span class="ident" id="1961066">s</span><span class="op" id="1961067">.</span><span class="ident" id="1961068">Name</span>&nbsp;<span class="op" id="1961073">==</span>&nbsp;<span class="ident" id="1961076">name</span>&nbsp;<span class="op" id="1961081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1961086">return</span>&nbsp;<span class="ident" id="1961093">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1961097">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1961100">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1961103">return</span>&nbsp;<span class="ident" id="1961110">nil</span><br>
<span class="lineno">295</span><span class="op" id="1961114">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1961117">func</span>&nbsp;<span class="op" id="1961122">(</span><span class="ident" id="1961123">f</span>&nbsp;<span class="op" id="1961125">*</span><span class="ident" id="1961126">File</span><span class="op" id="1961130">)</span>&nbsp;<span class="ident" id="1961132">DWARF</span><span class="op" id="1961137">(</span><span class="op" id="1961138">)</span>&nbsp;<span class="op" id="1961140">(</span><span class="op" id="1961141">*</span><span class="ident" id="1961142">dwarf</span><span class="op" id="1961147">.</span><span class="ident" id="1961148">Data</span><span class="op" id="1961152">,</span>&nbsp;<span class="builtintype" id="1961154">error</span><span class="op" id="1961159">)</span>&nbsp;<span class="op" id="1961161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1961164">//&nbsp;There&nbsp;are&nbsp;many&nbsp;other&nbsp;DWARF&nbsp;sections,&nbsp;but&nbsp;these</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1961215">//&nbsp;are&nbsp;the&nbsp;required&nbsp;ones,&nbsp;and&nbsp;the&nbsp;debug/dwarf&nbsp;package</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1961270">//&nbsp;does&nbsp;not&nbsp;use&nbsp;the&nbsp;others,&nbsp;so&nbsp;don&#39;t&nbsp;bother&nbsp;loading&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1961329">var</span>&nbsp;<span class="ident" id="1961333">names</span>&nbsp;<span class="op" id="1961339">=</span>&nbsp;<span class="op" id="1961341">[</span><span class="op" id="1961342">...</span><span class="op" id="1961345">]</span><span class="builtintype" id="1961346">string</span><span class="op" id="1961352">{</span><span class="string" id="1961353">&#34;abbrev&#34;</span><span class="op" id="1961361">,</span>&nbsp;<span class="string" id="1961363">&#34;info&#34;</span><span class="op" id="1961369">,</span>&nbsp;<span class="string" id="1961371">&#34;str&#34;</span><span class="op" id="1961376">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1961379">var</span>&nbsp;<span class="ident" id="1961383">dat</span>&nbsp;<span class="op" id="1961387">[</span><span class="builtinfunc" id="1961388">len</span><span class="op" id="1961391">(</span><span class="ident" id="1961392">names</span><span class="op" id="1961397">)</span><span class="op" id="1961398">]</span><span class="op" id="1961399">[</span><span class="op" id="1961400">]</span><span class="builtintype" id="1961401">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1961407">for</span>&nbsp;<span class="ident" id="1961411">i</span><span class="op" id="1961412">,</span>&nbsp;<span class="ident" id="1961414">name</span>&nbsp;<span class="op" id="1961419">:=</span>&nbsp;<span class="keyword" id="1961422">range</span>&nbsp;<span class="ident" id="1961428">names</span>&nbsp;<span class="op" id="1961434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1961438">name</span>&nbsp;<span class="op" id="1961443">=</span>&nbsp;<span class="string" id="1961445">&#34;.debug_&#34;</span>&nbsp;<span class="op" id="1961455">+</span>&nbsp;<span class="ident" id="1961457">name</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1961464">s</span>&nbsp;<span class="op" id="1961466">:=</span>&nbsp;<span class="ident" id="1961469">f</span><span class="op" id="1961470">.</span><span class="ident" id="1961471">Section</span><span class="op" id="1961478">(</span><span class="ident" id="1961479">name</span><span class="op" id="1961483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1961487">if</span>&nbsp;<span class="ident" id="1961490">s</span>&nbsp;<span class="op" id="1961492">==</span>&nbsp;<span class="ident" id="1961495">nil</span>&nbsp;<span class="op" id="1961499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1961504">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1961515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1961519">b</span><span class="op" id="1961520">,</span>&nbsp;<span class="ident" id="1961522">err</span>&nbsp;<span class="op" id="1961526">:=</span>&nbsp;<span class="ident" id="1961529">s</span><span class="op" id="1961530">.</span><span class="ident" id="1961531">Data</span><span class="op" id="1961535">(</span><span class="op" id="1961536">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1961540">if</span>&nbsp;<span class="ident" id="1961543">err</span>&nbsp;<span class="op" id="1961547">!=</span>&nbsp;<span class="ident" id="1961550">nil</span>&nbsp;<span class="op" id="1961554">&amp;&amp;</span>&nbsp;<span class="builtintype" id="1961557">uint32</span><span class="op" id="1961563">(</span><span class="builtinfunc" id="1961564">len</span><span class="op" id="1961567">(</span><span class="ident" id="1961568">b</span><span class="op" id="1961569">)</span><span class="op" id="1961570">)</span>&nbsp;<span class="op" id="1961572">&lt;</span>&nbsp;<span class="ident" id="1961574">s</span><span class="op" id="1961575">.</span><span class="ident" id="1961576">Size</span>&nbsp;<span class="op" id="1961581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1961586">return</span>&nbsp;<span class="ident" id="1961593">nil</span><span class="op" id="1961596">,</span>&nbsp;<span class="ident" id="1961598">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1961604">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1961608">dat</span><span class="op" id="1961611">[</span><span class="ident" id="1961612">i</span><span class="op" id="1961613">]</span>&nbsp;<span class="op" id="1961615">=</span>&nbsp;<span class="ident" id="1961617">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1961620">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1961624">abbrev</span><span class="op" id="1961630">,</span>&nbsp;<span class="ident" id="1961632">info</span><span class="op" id="1961636">,</span>&nbsp;<span class="ident" id="1961638">str</span>&nbsp;<span class="op" id="1961642">:=</span>&nbsp;<span class="ident" id="1961645">dat</span><span class="op" id="1961648">[</span><span class="num" id="1961649">0</span><span class="op" id="1961650">]</span><span class="op" id="1961651">,</span>&nbsp;<span class="ident" id="1961653">dat</span><span class="op" id="1961656">[</span><span class="num" id="1961657">1</span><span class="op" id="1961658">]</span><span class="op" id="1961659">,</span>&nbsp;<span class="ident" id="1961661">dat</span><span class="op" id="1961664">[</span><span class="num" id="1961665">2</span><span class="op" id="1961666">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1961669">return</span>&nbsp;<span class="ident" id="1961676">dwarf</span><span class="op" id="1961681">.</span><span class="ident" id="1961682">New</span><span class="op" id="1961685">(</span><span class="ident" id="1961686">abbrev</span><span class="op" id="1961692">,</span>&nbsp;<span class="ident" id="1961694">nil</span><span class="op" id="1961697">,</span>&nbsp;<span class="ident" id="1961699">nil</span><span class="op" id="1961702">,</span>&nbsp;<span class="ident" id="1961704">info</span><span class="op" id="1961708">,</span>&nbsp;<span class="ident" id="1961710">nil</span><span class="op" id="1961713">,</span>&nbsp;<span class="ident" id="1961715">nil</span><span class="op" id="1961718">,</span>&nbsp;<span class="ident" id="1961720">nil</span><span class="op" id="1961723">,</span>&nbsp;<span class="ident" id="1961725">str</span><span class="op" id="1961728">)</span><br>
<span class="lineno"></span><span class="op" id="1961730">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span><span class="comment" id="1961733">//&nbsp;ImportedSymbols&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;symbols</span><br>
<span class="lineno"></span><span class="comment" id="1961785">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="1961840">//&nbsp;satisfied&nbsp;by&nbsp;other&nbsp;libraries&nbsp;at&nbsp;dynamic&nbsp;load&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="1961894">//&nbsp;It&nbsp;does&nbsp;not&nbsp;return&nbsp;weak&nbsp;symbols.</span><br>
<span class="lineno"></span><span class="keyword" id="1961930">func</span>&nbsp;<span class="op" id="1961935">(</span><span class="ident" id="1961936">f</span>&nbsp;<span class="op" id="1961938">*</span><span class="ident" id="1961939">File</span><span class="op" id="1961943">)</span>&nbsp;<span class="ident" id="1961945">ImportedSymbols</span><span class="op" id="1961960">(</span><span class="op" id="1961961">)</span>&nbsp;<span class="op" id="1961963">(</span><span class="op" id="1961964">[</span><span class="op" id="1961965">]</span><span class="builtintype" id="1961966">string</span><span class="op" id="1961972">,</span>&nbsp;<span class="builtintype" id="1961974">error</span><span class="op" id="1961979">)</span>&nbsp;<span class="op" id="1961981">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1961984">pe64</span>&nbsp;<span class="op" id="1961989">:=</span>&nbsp;<span class="ident" id="1961992">f</span><span class="op" id="1961993">.</span><span class="ident" id="1961994">Machine</span>&nbsp;<span class="op" id="1962002">==</span>&nbsp;<span class="ident" id="1962005">IMAGE_FILE_MACHINE_AMD64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1962031">ds</span>&nbsp;<span class="op" id="1962034">:=</span>&nbsp;<span class="ident" id="1962037">f</span><span class="op" id="1962038">.</span><span class="ident" id="1962039">Section</span><span class="op" id="1962046">(</span><span class="string" id="1962047">&#34;.idata&#34;</span><span class="op" id="1962055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1962058">if</span>&nbsp;<span class="ident" id="1962061">ds</span>&nbsp;<span class="op" id="1962064">==</span>&nbsp;<span class="ident" id="1962067">nil</span>&nbsp;<span class="op" id="1962071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1962075">//&nbsp;not&nbsp;dynamic,&nbsp;so&nbsp;no&nbsp;libraries</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1962109">return</span>&nbsp;<span class="ident" id="1962116">nil</span><span class="op" id="1962119">,</span>&nbsp;<span class="ident" id="1962121">nil</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1962126">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1962129">d</span><span class="op" id="1962130">,</span>&nbsp;<span class="ident" id="1962132">err</span>&nbsp;<span class="op" id="1962136">:=</span>&nbsp;<span class="ident" id="1962139">ds</span><span class="op" id="1962141">.</span><span class="ident" id="1962142">Data</span><span class="op" id="1962146">(</span><span class="op" id="1962147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1962150">if</span>&nbsp;<span class="ident" id="1962153">err</span>&nbsp;<span class="op" id="1962157">!=</span>&nbsp;<span class="ident" id="1962160">nil</span>&nbsp;<span class="op" id="1962164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1962168">return</span>&nbsp;<span class="ident" id="1962175">nil</span><span class="op" id="1962178">,</span>&nbsp;<span class="ident" id="1962180">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1962185">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1962188">var</span>&nbsp;<span class="ident" id="1962192">ida</span>&nbsp;<span class="op" id="1962196">[</span><span class="op" id="1962197">]</span><span class="ident" id="1962198">ImportDirectory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1962215">for</span>&nbsp;<span class="builtinfunc" id="1962219">len</span><span class="op" id="1962222">(</span><span class="ident" id="1962223">d</span><span class="op" id="1962224">)</span>&nbsp;<span class="op" id="1962226">&gt;</span>&nbsp;<span class="num" id="1962228">0</span>&nbsp;<span class="op" id="1962230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1962234">var</span>&nbsp;<span class="ident" id="1962238">dt</span>&nbsp;<span class="ident" id="1962241">ImportDirectory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1962259">dt</span><span class="op" id="1962261">.</span><span class="ident" id="1962262">OriginalFirstThunk</span>&nbsp;<span class="op" id="1962281">=</span>&nbsp;<span class="ident" id="1962283">binary</span><span class="op" id="1962289">.</span><span class="ident" id="1962290">LittleEndian</span><span class="op" id="1962302">.</span><span class="ident" id="1962303">Uint32</span><span class="op" id="1962309">(</span><span class="ident" id="1962310">d</span><span class="op" id="1962311">[</span><span class="num" id="1962312">0</span><span class="op" id="1962313">:</span><span class="num" id="1962314">4</span><span class="op" id="1962315">]</span><span class="op" id="1962316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1962320">dt</span><span class="op" id="1962322">.</span><span class="ident" id="1962323">Name</span>&nbsp;<span class="op" id="1962328">=</span>&nbsp;<span class="ident" id="1962330">binary</span><span class="op" id="1962336">.</span><span class="ident" id="1962337">LittleEndian</span><span class="op" id="1962349">.</span><span class="ident" id="1962350">Uint32</span><span class="op" id="1962356">(</span><span class="ident" id="1962357">d</span><span class="op" id="1962358">[</span><span class="num" id="1962359">12</span><span class="op" id="1962361">:</span><span class="num" id="1962362">16</span><span class="op" id="1962364">]</span><span class="op" id="1962365">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1962369">dt</span><span class="op" id="1962371">.</span><span class="ident" id="1962372">FirstThunk</span>&nbsp;<span class="op" id="1962383">=</span>&nbsp;<span class="ident" id="1962385">binary</span><span class="op" id="1962391">.</span><span class="ident" id="1962392">LittleEndian</span><span class="op" id="1962404">.</span><span class="ident" id="1962405">Uint32</span><span class="op" id="1962411">(</span><span class="ident" id="1962412">d</span><span class="op" id="1962413">[</span><span class="num" id="1962414">16</span><span class="op" id="1962416">:</span><span class="num" id="1962417">20</span><span class="op" id="1962419">]</span><span class="op" id="1962420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1962424">d</span>&nbsp;<span class="op" id="1962426">=</span>&nbsp;<span class="ident" id="1962428">d</span><span class="op" id="1962429">[</span><span class="num" id="1962430">20</span><span class="op" id="1962432">:</span><span class="op" id="1962433">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1962437">if</span>&nbsp;<span class="ident" id="1962440">dt</span><span class="op" id="1962442">.</span><span class="ident" id="1962443">OriginalFirstThunk</span>&nbsp;<span class="op" id="1962462">==</span>&nbsp;<span class="num" id="1962465">0</span>&nbsp;<span class="op" id="1962467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1962472">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1962480">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1962484">ida</span>&nbsp;<span class="op" id="1962488">=</span>&nbsp;<span class="builtinfunc" id="1962490">append</span><span class="op" id="1962496">(</span><span class="ident" id="1962497">ida</span><span class="op" id="1962500">,</span>&nbsp;<span class="ident" id="1962502">dt</span><span class="op" id="1962504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1962507">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1962510">names</span><span class="op" id="1962515">,</span>&nbsp;<span class="ident" id="1962517">_</span>&nbsp;<span class="op" id="1962519">:=</span>&nbsp;<span class="ident" id="1962522">ds</span><span class="op" id="1962524">.</span><span class="ident" id="1962525">Data</span><span class="op" id="1962529">(</span><span class="op" id="1962530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1962533">var</span>&nbsp;<span class="ident" id="1962537">all</span>&nbsp;<span class="op" id="1962541">[</span><span class="op" id="1962542">]</span><span class="builtintype" id="1962543">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1962551">for</span>&nbsp;<span class="ident" id="1962555">_</span><span class="op" id="1962556">,</span>&nbsp;<span class="ident" id="1962558">dt</span>&nbsp;<span class="op" id="1962561">:=</span>&nbsp;<span class="keyword" id="1962564">range</span>&nbsp;<span class="ident" id="1962570">ida</span>&nbsp;<span class="op" id="1962574">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1962578">dt</span><span class="op" id="1962580">.</span><span class="ident" id="1962581">dll</span><span class="op" id="1962584">,</span>&nbsp;<span class="ident" id="1962586">_</span>&nbsp;<span class="op" id="1962588">=</span>&nbsp;<span class="ident" id="1962590">getString</span><span class="op" id="1962599">(</span><span class="ident" id="1962600">names</span><span class="op" id="1962605">,</span>&nbsp;<span class="builtintype" id="1962607">int</span><span class="op" id="1962610">(</span><span class="ident" id="1962611">dt</span><span class="op" id="1962613">.</span><span class="ident" id="1962614">Name</span><span class="op" id="1962618">-</span><span class="ident" id="1962619">ds</span><span class="op" id="1962621">.</span><span class="ident" id="1962622">VirtualAddress</span><span class="op" id="1962636">)</span><span class="op" id="1962637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1962641">d</span><span class="op" id="1962642">,</span>&nbsp;<span class="ident" id="1962644">_</span>&nbsp;<span class="op" id="1962646">=</span>&nbsp;<span class="ident" id="1962648">ds</span><span class="op" id="1962650">.</span><span class="ident" id="1962651">Data</span><span class="op" id="1962655">(</span><span class="op" id="1962656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1962660">//&nbsp;seek&nbsp;to&nbsp;OriginalFirstThunk</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1962692">d</span>&nbsp;<span class="op" id="1962694">=</span>&nbsp;<span class="ident" id="1962696">d</span><span class="op" id="1962697">[</span><span class="ident" id="1962698">dt</span><span class="op" id="1962700">.</span><span class="ident" id="1962701">OriginalFirstThunk</span><span class="op" id="1962719">-</span><span class="ident" id="1962720">ds</span><span class="op" id="1962722">.</span><span class="ident" id="1962723">VirtualAddress</span><span class="op" id="1962737">:</span><span class="op" id="1962738">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1962742">for</span>&nbsp;<span class="builtinfunc" id="1962746">len</span><span class="op" id="1962749">(</span><span class="ident" id="1962750">d</span><span class="op" id="1962751">)</span>&nbsp;<span class="op" id="1962753">&gt;</span>&nbsp;<span class="num" id="1962755">0</span>&nbsp;<span class="op" id="1962757">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1962762">if</span>&nbsp;<span class="ident" id="1962765">pe64</span>&nbsp;<span class="op" id="1962770">{</span>&nbsp;<span class="comment" id="1962772">//&nbsp;64bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1962785">va</span>&nbsp;<span class="op" id="1962788">:=</span>&nbsp;<span class="ident" id="1962791">binary</span><span class="op" id="1962797">.</span><span class="ident" id="1962798">LittleEndian</span><span class="op" id="1962810">.</span><span class="ident" id="1962811">Uint64</span><span class="op" id="1962817">(</span><span class="ident" id="1962818">d</span><span class="op" id="1962819">[</span><span class="num" id="1962820">0</span><span class="op" id="1962821">:</span><span class="num" id="1962822">8</span><span class="op" id="1962823">]</span><span class="op" id="1962824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1962830">d</span>&nbsp;<span class="op" id="1962832">=</span>&nbsp;<span class="ident" id="1962834">d</span><span class="op" id="1962835">[</span><span class="num" id="1962836">8</span><span class="op" id="1962837">:</span><span class="op" id="1962838">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1962844">if</span>&nbsp;<span class="ident" id="1962847">va</span>&nbsp;<span class="op" id="1962850">==</span>&nbsp;<span class="num" id="1962853">0</span>&nbsp;<span class="op" id="1962855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1962862">break</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1962872">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1962878">if</span>&nbsp;<span class="ident" id="1962881">va</span><span class="op" id="1962883">&amp;</span><span class="num" id="1962884">0x8000000000000000</span>&nbsp;<span class="op" id="1962903">&gt;</span>&nbsp;<span class="num" id="1962905">0</span>&nbsp;<span class="op" id="1962907">{</span>&nbsp;<span class="comment" id="1962909">//&nbsp;is&nbsp;Ordinal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1962928">//&nbsp;TODO&nbsp;add&nbsp;dynimport&nbsp;ordinal&nbsp;support.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1962971">}</span>&nbsp;<span class="keyword" id="1962973">else</span>&nbsp;<span class="op" id="1962978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1962985">fn</span><span class="op" id="1962987">,</span>&nbsp;<span class="ident" id="1962989">_</span>&nbsp;<span class="op" id="1962991">:=</span>&nbsp;<span class="ident" id="1962994">getString</span><span class="op" id="1963003">(</span><span class="ident" id="1963004">names</span><span class="op" id="1963009">,</span>&nbsp;<span class="builtintype" id="1963011">int</span><span class="op" id="1963014">(</span><span class="builtintype" id="1963015">uint32</span><span class="op" id="1963021">(</span><span class="ident" id="1963022">va</span><span class="op" id="1963024">)</span><span class="op" id="1963025">-</span><span class="ident" id="1963026">ds</span><span class="op" id="1963028">.</span><span class="ident" id="1963029">VirtualAddress</span><span class="op" id="1963043">+</span><span class="num" id="1963044">2</span><span class="op" id="1963045">)</span><span class="op" id="1963046">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1963053">all</span>&nbsp;<span class="op" id="1963057">=</span>&nbsp;<span class="builtinfunc" id="1963059">append</span><span class="op" id="1963065">(</span><span class="ident" id="1963066">all</span><span class="op" id="1963069">,</span>&nbsp;<span class="ident" id="1963071">fn</span><span class="op" id="1963073">+</span><span class="string" id="1963074">&#34;:&#34;</span><span class="op" id="1963077">+</span><span class="ident" id="1963078">dt</span><span class="op" id="1963080">.</span><span class="ident" id="1963081">dll</span><span class="op" id="1963084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1963090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1963095">}</span>&nbsp;<span class="keyword" id="1963097">else</span>&nbsp;<span class="op" id="1963102">{</span>&nbsp;<span class="comment" id="1963104">//&nbsp;32bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1963117">va</span>&nbsp;<span class="op" id="1963120">:=</span>&nbsp;<span class="ident" id="1963123">binary</span><span class="op" id="1963129">.</span><span class="ident" id="1963130">LittleEndian</span><span class="op" id="1963142">.</span><span class="ident" id="1963143">Uint32</span><span class="op" id="1963149">(</span><span class="ident" id="1963150">d</span><span class="op" id="1963151">[</span><span class="num" id="1963152">0</span><span class="op" id="1963153">:</span><span class="num" id="1963154">4</span><span class="op" id="1963155">]</span><span class="op" id="1963156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1963162">d</span>&nbsp;<span class="op" id="1963164">=</span>&nbsp;<span class="ident" id="1963166">d</span><span class="op" id="1963167">[</span><span class="num" id="1963168">4</span><span class="op" id="1963169">:</span><span class="op" id="1963170">]</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1963176">if</span>&nbsp;<span class="ident" id="1963179">va</span>&nbsp;<span class="op" id="1963182">==</span>&nbsp;<span class="num" id="1963185">0</span>&nbsp;<span class="op" id="1963187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1963194">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1963204">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1963210">if</span>&nbsp;<span class="ident" id="1963213">va</span><span class="op" id="1963215">&amp;</span><span class="num" id="1963216">0x80000000</span>&nbsp;<span class="op" id="1963227">&gt;</span>&nbsp;<span class="num" id="1963229">0</span>&nbsp;<span class="op" id="1963231">{</span>&nbsp;<span class="comment" id="1963233">//&nbsp;is&nbsp;Ordinal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1963252">//&nbsp;TODO&nbsp;add&nbsp;dynimport&nbsp;ordinal&nbsp;support.</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1963296">//ord&nbsp;:=&nbsp;va&amp;0x0000FFFF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1963323">}</span>&nbsp;<span class="keyword" id="1963325">else</span>&nbsp;<span class="op" id="1963330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1963337">fn</span><span class="op" id="1963339">,</span>&nbsp;<span class="ident" id="1963341">_</span>&nbsp;<span class="op" id="1963343">:=</span>&nbsp;<span class="ident" id="1963346">getString</span><span class="op" id="1963355">(</span><span class="ident" id="1963356">names</span><span class="op" id="1963361">,</span>&nbsp;<span class="builtintype" id="1963363">int</span><span class="op" id="1963366">(</span><span class="ident" id="1963367">va</span><span class="op" id="1963369">-</span><span class="ident" id="1963370">ds</span><span class="op" id="1963372">.</span><span class="ident" id="1963373">VirtualAddress</span><span class="op" id="1963387">+</span><span class="num" id="1963388">2</span><span class="op" id="1963389">)</span><span class="op" id="1963390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1963397">all</span>&nbsp;<span class="op" id="1963401">=</span>&nbsp;<span class="builtinfunc" id="1963403">append</span><span class="op" id="1963409">(</span><span class="ident" id="1963410">all</span><span class="op" id="1963413">,</span>&nbsp;<span class="ident" id="1963415">fn</span><span class="op" id="1963417">+</span><span class="string" id="1963418">&#34;:&#34;</span><span class="op" id="1963421">+</span><span class="ident" id="1963422">dt</span><span class="op" id="1963424">.</span><span class="ident" id="1963425">dll</span><span class="op" id="1963428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1963434">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1963439">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1963443">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1963446">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1963450">return</span>&nbsp;<span class="ident" id="1963457">all</span><span class="op" id="1963460">,</span>&nbsp;<span class="ident" id="1963462">nil</span><br>
<span class="lineno">385</span><span class="op" id="1963466">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1963469">//&nbsp;ImportedLibraries&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;libraries</span><br>
<span class="lineno"></span><span class="comment" id="1963525">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="1963580">//&nbsp;linked&nbsp;with&nbsp;the&nbsp;binary&nbsp;at&nbsp;dynamic&nbsp;link&nbsp;time.</span><br>
<span class="lineno">390</span><span class="keyword" id="1963628">func</span>&nbsp;<span class="op" id="1963633">(</span><span class="ident" id="1963634">f</span>&nbsp;<span class="op" id="1963636">*</span><span class="ident" id="1963637">File</span><span class="op" id="1963641">)</span>&nbsp;<span class="ident" id="1963643">ImportedLibraries</span><span class="op" id="1963660">(</span><span class="op" id="1963661">)</span>&nbsp;<span class="op" id="1963663">(</span><span class="op" id="1963664">[</span><span class="op" id="1963665">]</span><span class="builtintype" id="1963666">string</span><span class="op" id="1963672">,</span>&nbsp;<span class="builtintype" id="1963674">error</span><span class="op" id="1963679">)</span>&nbsp;<span class="op" id="1963681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1963684">//&nbsp;TODO</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1963693">//&nbsp;cgo&nbsp;-dynimport&nbsp;don&#39;t&nbsp;use&nbsp;this&nbsp;for&nbsp;windows&nbsp;PE,&nbsp;so&nbsp;just&nbsp;return.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1963759">return</span>&nbsp;<span class="ident" id="1963766">nil</span><span class="op" id="1963769">,</span>&nbsp;<span class="ident" id="1963771">nil</span><br>
<span class="lineno"></span><span class="op" id="1963775">}</span>
</div>
</body>
</html>
