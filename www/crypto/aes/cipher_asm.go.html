<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4029585">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4029640">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4029694">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4029745">//&nbsp;+build&nbsp;amd64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4029762">package</span>&nbsp;<span class="ident" id="4029770">aes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4029775">//&nbsp;defined&nbsp;in&nbsp;asm_$GOARCH.s</span><br>
<span class="lineno">10</span><span class="keyword" id="4029803">func</span>&nbsp;<span class="ident" id="4029808">hasAsm</span><span class="op" id="4029814">(</span><span class="op" id="4029815">)</span>&nbsp;<span class="builtintype" id="4029817">bool</span><br>
<span class="lineno"></span><span class="keyword" id="4029822">func</span>&nbsp;<span class="ident" id="4029827">encryptBlockAsm</span><span class="op" id="4029842">(</span><span class="ident" id="4029843">nr</span>&nbsp;<span class="builtintype" id="4029846">int</span><span class="op" id="4029849">,</span>&nbsp;<span class="ident" id="4029851">xk</span>&nbsp;<span class="op" id="4029854">*</span><span class="builtintype" id="4029855">uint32</span><span class="op" id="4029861">,</span>&nbsp;<span class="ident" id="4029863">dst</span><span class="op" id="4029866">,</span>&nbsp;<span class="ident" id="4029868">src</span>&nbsp;<span class="op" id="4029872">*</span><span class="builtintype" id="4029873">byte</span><span class="op" id="4029877">)</span><br>
<span class="lineno"></span><span class="keyword" id="4029879">func</span>&nbsp;<span class="ident" id="4029884">decryptBlockAsm</span><span class="op" id="4029899">(</span><span class="ident" id="4029900">nr</span>&nbsp;<span class="builtintype" id="4029903">int</span><span class="op" id="4029906">,</span>&nbsp;<span class="ident" id="4029908">xk</span>&nbsp;<span class="op" id="4029911">*</span><span class="builtintype" id="4029912">uint32</span><span class="op" id="4029918">,</span>&nbsp;<span class="ident" id="4029920">dst</span><span class="op" id="4029923">,</span>&nbsp;<span class="ident" id="4029925">src</span>&nbsp;<span class="op" id="4029929">*</span><span class="builtintype" id="4029930">byte</span><span class="op" id="4029934">)</span><br>
<span class="lineno"></span><span class="keyword" id="4029936">func</span>&nbsp;<span class="ident" id="4029941">expandKeyAsm</span><span class="op" id="4029953">(</span><span class="ident" id="4029954">nr</span>&nbsp;<span class="builtintype" id="4029957">int</span><span class="op" id="4029960">,</span>&nbsp;<span class="ident" id="4029962">key</span>&nbsp;<span class="op" id="4029966">*</span><span class="builtintype" id="4029967">byte</span><span class="op" id="4029971">,</span>&nbsp;<span class="ident" id="4029973">enc</span>&nbsp;<span class="op" id="4029977">*</span><span class="builtintype" id="4029978">uint32</span><span class="op" id="4029984">,</span>&nbsp;<span class="ident" id="4029986">dec</span>&nbsp;<span class="op" id="4029990">*</span><span class="builtintype" id="4029991">uint32</span><span class="op" id="4029997">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="4030000">var</span>&nbsp;<span class="ident" id="4030004">useAsm</span>&nbsp;<span class="op" id="4030011">=</span>&nbsp;<span class="ident" id="4030013"><a href="/crypto/aes/cipher_asm.go.html#4029808">hasAsm</a></span><span class="op" id="4030019">(</span><span class="op" id="4030020">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4030023">func</span>&nbsp;<span class="ident" id="4030028">encryptBlock</span><span class="op" id="4030040">(</span><span class="ident" id="4030041">xk</span>&nbsp;<span class="op" id="4030044">[</span><span class="op" id="4030045">]</span><span class="builtintype" id="4030046">uint32</span><span class="op" id="4030052">,</span>&nbsp;<span class="ident" id="4030054">dst</span><span class="op" id="4030057">,</span>&nbsp;<span class="ident" id="4030059">src</span>&nbsp;<span class="op" id="4030063">[</span><span class="op" id="4030064">]</span><span class="builtintype" id="4030065">byte</span><span class="op" id="4030069">)</span>&nbsp;<span class="op" id="4030071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4030074">if</span>&nbsp;<span class="ident" id="4030077"><a href="/crypto/aes/cipher_asm.go.html#4030004">useAsm</a></span>&nbsp;<span class="op" id="4030084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4030088"><a href="/crypto/aes/cipher_asm.go.html#4029827">encryptBlockAsm</a></span><span class="op" id="4030103">(</span><span class="builtinfunc" id="4030104">len</span><span class="op" id="4030107">(</span><span class="ident" id="4030108"><a href="/crypto/aes/cipher_asm.go.html#4030041">xk</a></span><span class="op" id="4030110">)</span><span class="op" id="4030111">/</span><span class="num" id="4030112">4</span><span class="op" id="4030113">-</span><span class="num" id="4030114">1</span><span class="op" id="4030115">,</span>&nbsp;<span class="op" id="4030117">&amp;</span><span class="ident" id="4030118"><a href="/crypto/aes/cipher_asm.go.html#4030041">xk</a></span><span class="op" id="4030120">[</span><span class="num" id="4030121">0</span><span class="op" id="4030122">]</span><span class="op" id="4030123">,</span>&nbsp;<span class="op" id="4030125">&amp;</span><span class="ident" id="4030126"><a href="/crypto/aes/cipher_asm.go.html#4030054">dst</a></span><span class="op" id="4030129">[</span><span class="num" id="4030130">0</span><span class="op" id="4030131">]</span><span class="op" id="4030132">,</span>&nbsp;<span class="op" id="4030134">&amp;</span><span class="ident" id="4030135"><a href="/crypto/aes/cipher_asm.go.html#4030059">src</a></span><span class="op" id="4030138">[</span><span class="num" id="4030139">0</span><span class="op" id="4030140">]</span><span class="op" id="4030141">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4030144">}</span>&nbsp;<span class="keyword" id="4030146">else</span>&nbsp;<span class="op" id="4030151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4030155"><a href="/crypto/aes/block.go.html#4022618">encryptBlockGo</a></span><span class="op" id="4030169">(</span><span class="ident" id="4030170"><a href="/crypto/aes/cipher_asm.go.html#4030041">xk</a></span><span class="op" id="4030172">,</span>&nbsp;<span class="ident" id="4030174"><a href="/crypto/aes/cipher_asm.go.html#4030054">dst</a></span><span class="op" id="4030177">,</span>&nbsp;<span class="ident" id="4030179"><a href="/crypto/aes/cipher_asm.go.html#4030059">src</a></span><span class="op" id="4030182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4030185">}</span><br>
<span class="lineno"></span><span class="op" id="4030187">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="4030190">func</span>&nbsp;<span class="ident" id="4030195">decryptBlock</span><span class="op" id="4030207">(</span><span class="ident" id="4030208">xk</span>&nbsp;<span class="op" id="4030211">[</span><span class="op" id="4030212">]</span><span class="builtintype" id="4030213">uint32</span><span class="op" id="4030219">,</span>&nbsp;<span class="ident" id="4030221">dst</span><span class="op" id="4030224">,</span>&nbsp;<span class="ident" id="4030226">src</span>&nbsp;<span class="op" id="4030230">[</span><span class="op" id="4030231">]</span><span class="builtintype" id="4030232">byte</span><span class="op" id="4030236">)</span>&nbsp;<span class="op" id="4030238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4030241">if</span>&nbsp;<span class="ident" id="4030244"><a href="/crypto/aes/cipher_asm.go.html#4030004">useAsm</a></span>&nbsp;<span class="op" id="4030251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4030255"><a href="/crypto/aes/cipher_asm.go.html#4029884">decryptBlockAsm</a></span><span class="op" id="4030270">(</span><span class="builtinfunc" id="4030271">len</span><span class="op" id="4030274">(</span><span class="ident" id="4030275"><a href="/crypto/aes/cipher_asm.go.html#4030208">xk</a></span><span class="op" id="4030277">)</span><span class="op" id="4030278">/</span><span class="num" id="4030279">4</span><span class="op" id="4030280">-</span><span class="num" id="4030281">1</span><span class="op" id="4030282">,</span>&nbsp;<span class="op" id="4030284">&amp;</span><span class="ident" id="4030285"><a href="/crypto/aes/cipher_asm.go.html#4030208">xk</a></span><span class="op" id="4030287">[</span><span class="num" id="4030288">0</span><span class="op" id="4030289">]</span><span class="op" id="4030290">,</span>&nbsp;<span class="op" id="4030292">&amp;</span><span class="ident" id="4030293"><a href="/crypto/aes/cipher_asm.go.html#4030221">dst</a></span><span class="op" id="4030296">[</span><span class="num" id="4030297">0</span><span class="op" id="4030298">]</span><span class="op" id="4030299">,</span>&nbsp;<span class="op" id="4030301">&amp;</span><span class="ident" id="4030302"><a href="/crypto/aes/cipher_asm.go.html#4030226">src</a></span><span class="op" id="4030305">[</span><span class="num" id="4030306">0</span><span class="op" id="4030307">]</span><span class="op" id="4030308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4030311">}</span>&nbsp;<span class="keyword" id="4030313">else</span>&nbsp;<span class="op" id="4030318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4030322"><a href="/crypto/aes/block.go.html#4024777">decryptBlockGo</a></span><span class="op" id="4030336">(</span><span class="ident" id="4030337"><a href="/crypto/aes/cipher_asm.go.html#4030208">xk</a></span><span class="op" id="4030339">,</span>&nbsp;<span class="ident" id="4030341"><a href="/crypto/aes/cipher_asm.go.html#4030221">dst</a></span><span class="op" id="4030344">,</span>&nbsp;<span class="ident" id="4030346"><a href="/crypto/aes/cipher_asm.go.html#4030226">src</a></span><span class="op" id="4030349">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4030352">}</span><br>
<span class="lineno"></span><span class="op" id="4030354">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4030357">func</span>&nbsp;<span class="ident" id="4030362">expandKey</span><span class="op" id="4030371">(</span><span class="ident" id="4030372">key</span>&nbsp;<span class="op" id="4030376">[</span><span class="op" id="4030377">]</span><span class="builtintype" id="4030378">byte</span><span class="op" id="4030382">,</span>&nbsp;<span class="ident" id="4030384">enc</span><span class="op" id="4030387">,</span>&nbsp;<span class="ident" id="4030389">dec</span>&nbsp;<span class="op" id="4030393">[</span><span class="op" id="4030394">]</span><span class="builtintype" id="4030395">uint32</span><span class="op" id="4030401">)</span>&nbsp;<span class="op" id="4030403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4030406">if</span>&nbsp;<span class="ident" id="4030409"><a href="/crypto/aes/cipher_asm.go.html#4030004">useAsm</a></span>&nbsp;<span class="op" id="4030416">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4030420">rounds</span>&nbsp;<span class="op" id="4030427">:=</span>&nbsp;<span class="num" id="4030430">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4030435">switch</span>&nbsp;<span class="builtinfunc" id="4030442">len</span><span class="op" id="4030445">(</span><span class="ident" id="4030446"><a href="/crypto/aes/cipher_asm.go.html#4030372">key</a></span><span class="op" id="4030449">)</span>&nbsp;<span class="op" id="4030451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4030455">case</span>&nbsp;<span class="num" id="4030460">128</span>&nbsp;<span class="op" id="4030464">/</span>&nbsp;<span class="num" id="4030466">8</span><span class="op" id="4030467">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4030472"><a href="/crypto/aes/cipher_asm.go.html#4030420">rounds</a></span>&nbsp;<span class="op" id="4030479">=</span>&nbsp;<span class="num" id="4030481">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4030486">case</span>&nbsp;<span class="num" id="4030491">192</span>&nbsp;<span class="op" id="4030495">/</span>&nbsp;<span class="num" id="4030497">8</span><span class="op" id="4030498">:</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4030503"><a href="/crypto/aes/cipher_asm.go.html#4030420">rounds</a></span>&nbsp;<span class="op" id="4030510">=</span>&nbsp;<span class="num" id="4030512">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4030517">case</span>&nbsp;<span class="num" id="4030522">256</span>&nbsp;<span class="op" id="4030526">/</span>&nbsp;<span class="num" id="4030528">8</span><span class="op" id="4030529">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4030534"><a href="/crypto/aes/cipher_asm.go.html#4030420">rounds</a></span>&nbsp;<span class="op" id="4030541">=</span>&nbsp;<span class="num" id="4030543">14</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4030548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4030552"><a href="/crypto/aes/cipher_asm.go.html#4029941">expandKeyAsm</a></span><span class="op" id="4030564">(</span><span class="ident" id="4030565"><a href="/crypto/aes/cipher_asm.go.html#4030420">rounds</a></span><span class="op" id="4030571">,</span>&nbsp;<span class="op" id="4030573">&amp;</span><span class="ident" id="4030574"><a href="/crypto/aes/cipher_asm.go.html#4030372">key</a></span><span class="op" id="4030577">[</span><span class="num" id="4030578">0</span><span class="op" id="4030579">]</span><span class="op" id="4030580">,</span>&nbsp;<span class="op" id="4030582">&amp;</span><span class="ident" id="4030583"><a href="/crypto/aes/cipher_asm.go.html#4030384">enc</a></span><span class="op" id="4030586">[</span><span class="num" id="4030587">0</span><span class="op" id="4030588">]</span><span class="op" id="4030589">,</span>&nbsp;<span class="op" id="4030591">&amp;</span><span class="ident" id="4030592"><a href="/crypto/aes/cipher_asm.go.html#4030389">dec</a></span><span class="op" id="4030595">[</span><span class="num" id="4030596">0</span><span class="op" id="4030597">]</span><span class="op" id="4030598">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4030601">}</span>&nbsp;<span class="keyword" id="4030603">else</span>&nbsp;<span class="op" id="4030608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4030612"><a href="/crypto/aes/block.go.html#4027217">expandKeyGo</a></span><span class="op" id="4030623">(</span><span class="ident" id="4030624"><a href="/crypto/aes/cipher_asm.go.html#4030372">key</a></span><span class="op" id="4030627">,</span>&nbsp;<span class="ident" id="4030629"><a href="/crypto/aes/cipher_asm.go.html#4030384">enc</a></span><span class="op" id="4030632">,</span>&nbsp;<span class="ident" id="4030634"><a href="/crypto/aes/cipher_asm.go.html#4030389">dec</a></span><span class="op" id="4030637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4030640">}</span><br>
<span class="lineno"></span><span class="op" id="4030642">}</span>
</div>
</body>
</html>
