<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/textproto</h2>
<ul>
<li><a href="/gostd/net/textproto/header.go.html">header.go</a></li>
<li><a href="/gostd/net/textproto/pipeline.go.html">pipeline.go</a></li>
<li><a href="/gostd/net/textproto/reader.go.html">reader.go</a></li>
<li><a href="/gostd/net/textproto/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/net/textproto/textproto.go.html">textproto.go</a></li>
<li><a href="/gostd/net/textproto/writer.go.html">writer.go</a></li>
<li><a href="/gostd/net/textproto/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5101692">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5101748">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5101802">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5101853">//&nbsp;Package&nbsp;textproto&nbsp;implements&nbsp;generic&nbsp;support&nbsp;for&nbsp;text-based&nbsp;request/response</span><br>
<span class="lineno"></span><span class="comment" id="5101933">//&nbsp;protocols&nbsp;in&nbsp;the&nbsp;style&nbsp;of&nbsp;HTTP,&nbsp;NNTP,&nbsp;and&nbsp;SMTP.</span><br>
<span class="lineno"></span><span class="comment" id="5101984">//</span><br>
<span class="lineno"></span><span class="comment" id="5101987">//&nbsp;The&nbsp;package&nbsp;provides:</span><br>
<span class="lineno"></span><span class="comment" id="5102012">//</span><br>
<span class="lineno">10</span><span class="comment" id="5102015">//&nbsp;Error,&nbsp;which&nbsp;represents&nbsp;a&nbsp;numeric&nbsp;error&nbsp;response&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="5102072">//&nbsp;a&nbsp;server.</span><br>
<span class="lineno"></span><span class="comment" id="5102085">//</span><br>
<span class="lineno"></span><span class="comment" id="5102088">//&nbsp;Pipeline,&nbsp;to&nbsp;manage&nbsp;pipelined&nbsp;requests&nbsp;and&nbsp;responses</span><br>
<span class="lineno"></span><span class="comment" id="5102144">//&nbsp;in&nbsp;a&nbsp;client.</span><br>
<span class="lineno">15</span><span class="comment" id="5102160">//</span><br>
<span class="lineno"></span><span class="comment" id="5102163">//&nbsp;Reader,&nbsp;to&nbsp;read&nbsp;numeric&nbsp;response&nbsp;code&nbsp;lines,</span><br>
<span class="lineno"></span><span class="comment" id="5102211">//&nbsp;key:&nbsp;value&nbsp;headers,&nbsp;lines&nbsp;wrapped&nbsp;with&nbsp;leading&nbsp;spaces</span><br>
<span class="lineno"></span><span class="comment" id="5102268">//&nbsp;on&nbsp;continuation&nbsp;lines,&nbsp;and&nbsp;whole&nbsp;text&nbsp;blocks&nbsp;ending</span><br>
<span class="lineno"></span><span class="comment" id="5102323">//&nbsp;with&nbsp;a&nbsp;dot&nbsp;on&nbsp;a&nbsp;line&nbsp;by&nbsp;itself.</span><br>
<span class="lineno">20</span><span class="comment" id="5102358">//</span><br>
<span class="lineno"></span><span class="comment" id="5102361">//&nbsp;Writer,&nbsp;to&nbsp;write&nbsp;dot-encoded&nbsp;text&nbsp;blocks.</span><br>
<span class="lineno"></span><span class="comment" id="5102406">//</span><br>
<span class="lineno"></span><span class="comment" id="5102409">//&nbsp;Conn,&nbsp;a&nbsp;convenient&nbsp;packaging&nbsp;of&nbsp;Reader,&nbsp;Writer,&nbsp;and&nbsp;Pipeline&nbsp;for&nbsp;use</span><br>
<span class="lineno"></span><span class="comment" id="5102481">//&nbsp;with&nbsp;a&nbsp;single&nbsp;network&nbsp;connection.</span><br>
<span class="lineno">25</span><span class="comment" id="5102518">//</span><br>
<span class="lineno"></span><span class="keyword" id="5102521">package</span>&nbsp;<span class="ident" id="5102529">textproto</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5102540">import</span>&nbsp;<span class="op" id="5102547">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5102550">&#34;bufio&#34;</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5102559">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5102566">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5102572">&#34;net&#34;</span><br>
<span class="lineno"></span><span class="op" id="5102578">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="5102581">//&nbsp;An&nbsp;Error&nbsp;represents&nbsp;a&nbsp;numeric&nbsp;error&nbsp;response&nbsp;from&nbsp;a&nbsp;server.</span><br>
<span class="lineno"></span><span class="keyword" id="5102644">type</span>&nbsp;<span class="ident" id="5102649">Error</span>&nbsp;<span class="keyword" id="5102655">struct</span>&nbsp;<span class="op" id="5102662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5102665">Code</span>&nbsp;<span class="builtintype" id="5102670">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5102675">Msg</span>&nbsp;&nbsp;<span class="builtintype" id="5102680">string</span><br>
<span class="lineno"></span><span class="op" id="5102687">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="5102690">func</span>&nbsp;<span class="op" id="5102695">(</span><span class="ident" id="5102696">e</span>&nbsp;<span class="op" id="5102698">*</span><span class="ident" id="5102699">Error</span><span class="op" id="5102704">)</span>&nbsp;<span class="ident" id="5102706">Error</span><span class="op" id="5102711">(</span><span class="op" id="5102712">)</span>&nbsp;<span class="builtintype" id="5102714">string</span>&nbsp;<span class="op" id="5102721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5102724">return</span>&nbsp;<span class="ident" id="5102731">fmt</span><span class="op" id="5102734">.</span><span class="ident" id="5102735">Sprintf</span><span class="op" id="5102742">(</span><span class="string" id="5102743">&#34;%03d&nbsp;%s&#34;</span><span class="op" id="5102752">,</span>&nbsp;<span class="ident" id="5102754">e</span><span class="op" id="5102755">.</span><span class="ident" id="5102756">Code</span><span class="op" id="5102760">,</span>&nbsp;<span class="ident" id="5102762">e</span><span class="op" id="5102763">.</span><span class="ident" id="5102764">Msg</span><span class="op" id="5102767">)</span><br>
<span class="lineno"></span><span class="op" id="5102769">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="5102772">//&nbsp;A&nbsp;ProtocolError&nbsp;describes&nbsp;a&nbsp;protocol&nbsp;violation&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="5102827">//&nbsp;as&nbsp;an&nbsp;invalid&nbsp;response&nbsp;or&nbsp;a&nbsp;hung-up&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="5102878">type</span>&nbsp;<span class="ident" id="5102883">ProtocolError</span>&nbsp;<span class="builtintype" id="5102897">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5102905">func</span>&nbsp;<span class="op" id="5102910">(</span><span class="ident" id="5102911">p</span>&nbsp;<span class="ident" id="5102913">ProtocolError</span><span class="op" id="5102926">)</span>&nbsp;<span class="ident" id="5102928">Error</span><span class="op" id="5102933">(</span><span class="op" id="5102934">)</span>&nbsp;<span class="builtintype" id="5102936">string</span>&nbsp;<span class="op" id="5102943">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5102946">return</span>&nbsp;<span class="builtintype" id="5102953">string</span><span class="op" id="5102959">(</span><span class="ident" id="5102960">p</span><span class="op" id="5102961">)</span><br>
<span class="lineno"></span><span class="op" id="5102963">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5102966">//&nbsp;A&nbsp;Conn&nbsp;represents&nbsp;a&nbsp;textual&nbsp;network&nbsp;protocol&nbsp;connection.</span><br>
<span class="lineno"></span><span class="comment" id="5103026">//&nbsp;It&nbsp;consists&nbsp;of&nbsp;a&nbsp;Reader&nbsp;and&nbsp;Writer&nbsp;to&nbsp;manage&nbsp;I/O</span><br>
<span class="lineno">55</span><span class="comment" id="5103078">//&nbsp;and&nbsp;a&nbsp;Pipeline&nbsp;to&nbsp;sequence&nbsp;concurrent&nbsp;requests&nbsp;on&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="comment" id="5103147">//&nbsp;These&nbsp;embedded&nbsp;types&nbsp;carry&nbsp;methods&nbsp;with&nbsp;them;</span><br>
<span class="lineno"></span><span class="comment" id="5103196">//&nbsp;see&nbsp;the&nbsp;documentation&nbsp;of&nbsp;those&nbsp;types&nbsp;for&nbsp;details.</span><br>
<span class="lineno"></span><span class="keyword" id="5103249">type</span>&nbsp;<span class="ident" id="5103254">Conn</span>&nbsp;<span class="keyword" id="5103259">struct</span>&nbsp;<span class="op" id="5103266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5103269">Reader</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5103277">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5103285">Pipeline</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5103295">conn</span>&nbsp;<span class="ident" id="5103300">io</span><span class="op" id="5103302">.</span><span class="ident" id="5103303">ReadWriteCloser</span><br>
<span class="lineno"></span><span class="op" id="5103319">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="comment" id="5103322">//&nbsp;NewConn&nbsp;returns&nbsp;a&nbsp;new&nbsp;Conn&nbsp;using&nbsp;conn&nbsp;for&nbsp;I/O.</span><br>
<span class="lineno"></span><span class="keyword" id="5103372">func</span>&nbsp;<span class="ident" id="5103377">NewConn</span><span class="op" id="5103384">(</span><span class="ident" id="5103385">conn</span>&nbsp;<span class="ident" id="5103390">io</span><span class="op" id="5103392">.</span><span class="ident" id="5103393">ReadWriteCloser</span><span class="op" id="5103408">)</span>&nbsp;<span class="op" id="5103410">*</span><span class="ident" id="5103411">Conn</span>&nbsp;<span class="op" id="5103416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5103419">return</span>&nbsp;<span class="op" id="5103426">&amp;</span><span class="ident" id="5103427">Conn</span><span class="op" id="5103431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5103435">Reader</span><span class="op" id="5103441">:</span>&nbsp;<span class="ident" id="5103443">Reader</span><span class="op" id="5103449">{</span><span class="ident" id="5103450">R</span><span class="op" id="5103451">:</span>&nbsp;<span class="ident" id="5103453">bufio</span><span class="op" id="5103458">.</span><span class="ident" id="5103459">NewReader</span><span class="op" id="5103468">(</span><span class="ident" id="5103469">conn</span><span class="op" id="5103473">)</span><span class="op" id="5103474">}</span><span class="op" id="5103475">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5103479">Writer</span><span class="op" id="5103485">:</span>&nbsp;<span class="ident" id="5103487">Writer</span><span class="op" id="5103493">{</span><span class="ident" id="5103494">W</span><span class="op" id="5103495">:</span>&nbsp;<span class="ident" id="5103497">bufio</span><span class="op" id="5103502">.</span><span class="ident" id="5103503">NewWriter</span><span class="op" id="5103512">(</span><span class="ident" id="5103513">conn</span><span class="op" id="5103517">)</span><span class="op" id="5103518">}</span><span class="op" id="5103519">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5103523">conn</span><span class="op" id="5103527">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5103531">conn</span><span class="op" id="5103535">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5103538">}</span><br>
<span class="lineno"></span><span class="op" id="5103540">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5103543">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;connection.</span><br>
<span class="lineno">75</span><span class="keyword" id="5103575">func</span>&nbsp;<span class="op" id="5103580">(</span><span class="ident" id="5103581">c</span>&nbsp;<span class="op" id="5103583">*</span><span class="ident" id="5103584">Conn</span><span class="op" id="5103588">)</span>&nbsp;<span class="ident" id="5103590">Close</span><span class="op" id="5103595">(</span><span class="op" id="5103596">)</span>&nbsp;<span class="builtintype" id="5103598">error</span>&nbsp;<span class="op" id="5103604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5103607">return</span>&nbsp;<span class="ident" id="5103614">c</span><span class="op" id="5103615">.</span><span class="ident" id="5103616">conn</span><span class="op" id="5103620">.</span><span class="ident" id="5103621">Close</span><span class="op" id="5103626">(</span><span class="op" id="5103627">)</span><br>
<span class="lineno"></span><span class="op" id="5103629">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5103632">//&nbsp;Dial&nbsp;connects&nbsp;to&nbsp;the&nbsp;given&nbsp;address&nbsp;on&nbsp;the&nbsp;given&nbsp;network&nbsp;using&nbsp;net.Dial</span><br>
<span class="lineno">80</span><span class="comment" id="5103706">//&nbsp;and&nbsp;then&nbsp;returns&nbsp;a&nbsp;new&nbsp;Conn&nbsp;for&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="5103757">func</span>&nbsp;<span class="ident" id="5103762">Dial</span><span class="op" id="5103766">(</span><span class="ident" id="5103767">network</span><span class="op" id="5103774">,</span>&nbsp;<span class="ident" id="5103776">addr</span>&nbsp;<span class="builtintype" id="5103781">string</span><span class="op" id="5103787">)</span>&nbsp;<span class="op" id="5103789">(</span><span class="op" id="5103790">*</span><span class="ident" id="5103791">Conn</span><span class="op" id="5103795">,</span>&nbsp;<span class="builtintype" id="5103797">error</span><span class="op" id="5103802">)</span>&nbsp;<span class="op" id="5103804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5103807">c</span><span class="op" id="5103808">,</span>&nbsp;<span class="ident" id="5103810">err</span>&nbsp;<span class="op" id="5103814">:=</span>&nbsp;<span class="ident" id="5103817">net</span><span class="op" id="5103820">.</span><span class="ident" id="5103821">Dial</span><span class="op" id="5103825">(</span><span class="ident" id="5103826">network</span><span class="op" id="5103833">,</span>&nbsp;<span class="ident" id="5103835">addr</span><span class="op" id="5103839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5103842">if</span>&nbsp;<span class="ident" id="5103845">err</span>&nbsp;<span class="op" id="5103849">!=</span>&nbsp;<span class="ident" id="5103852">nil</span>&nbsp;<span class="op" id="5103856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5103860">return</span>&nbsp;<span class="ident" id="5103867">nil</span><span class="op" id="5103870">,</span>&nbsp;<span class="ident" id="5103872">err</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5103877">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5103880">return</span>&nbsp;<span class="ident" id="5103887">NewConn</span><span class="op" id="5103894">(</span><span class="ident" id="5103895">c</span><span class="op" id="5103896">)</span><span class="op" id="5103897">,</span>&nbsp;<span class="ident" id="5103899">nil</span><br>
<span class="lineno"></span><span class="op" id="5103903">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5103906">//&nbsp;Cmd&nbsp;is&nbsp;a&nbsp;convenience&nbsp;method&nbsp;that&nbsp;sends&nbsp;a&nbsp;command&nbsp;after</span><br>
<span class="lineno">90</span><span class="comment" id="5103964">//&nbsp;waiting&nbsp;its&nbsp;turn&nbsp;in&nbsp;the&nbsp;pipeline.&nbsp;&nbsp;The&nbsp;command&nbsp;text&nbsp;is&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5104026">//&nbsp;result&nbsp;of&nbsp;formatting&nbsp;format&nbsp;with&nbsp;args&nbsp;and&nbsp;appending&nbsp;\r\n.</span><br>
<span class="lineno"></span><span class="comment" id="5104087">//&nbsp;Cmd&nbsp;returns&nbsp;the&nbsp;id&nbsp;of&nbsp;the&nbsp;command,&nbsp;for&nbsp;use&nbsp;with&nbsp;StartResponse&nbsp;and&nbsp;EndResponse.</span><br>
<span class="lineno"></span><span class="comment" id="5104169">//</span><br>
<span class="lineno"></span><span class="comment" id="5104172">//&nbsp;For&nbsp;example,&nbsp;a&nbsp;client&nbsp;might&nbsp;run&nbsp;a&nbsp;HELP&nbsp;command&nbsp;that&nbsp;returns&nbsp;a&nbsp;dot-body</span><br>
<span class="lineno">95</span><span class="comment" id="5104246">//&nbsp;by&nbsp;using:</span><br>
<span class="lineno"></span><span class="comment" id="5104259">//</span><br>
<span class="lineno"></span><span class="comment" id="5104262">//&nbsp;&nbsp;&nbsp;&nbspid,&nbsp;err&nbsp;:=&nbsp;c.Cmd(&#34;HELP&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="5104290">//&nbsp;&nbsp;&nbsp;&nbspif&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="5104309">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;nil,&nbsp;err</span><br>
<span class="lineno">100</span><span class="comment" id="5104329">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno"></span><span class="comment" id="5104334">//</span><br>
<span class="lineno"></span><span class="comment" id="5104337">//&nbsp;&nbsp;&nbsp;&nbspc.StartResponse(id)</span><br>
<span class="lineno"></span><span class="comment" id="5104360">//&nbsp;&nbsp;&nbsp;&nbspdefer&nbsp;c.EndResponse(id)</span><br>
<span class="lineno"></span><span class="comment" id="5104387">//</span><br>
<span class="lineno">105</span><span class="comment" id="5104390">//&nbsp;&nbsp;&nbsp;&nbspif&nbsp;_,&nbsp;_,&nbsp;err&nbsp;=&nbsp;c.ReadCodeLine(110);&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="5104442">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;nil,&nbsp;err</span><br>
<span class="lineno"></span><span class="comment" id="5104462">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno"></span><span class="comment" id="5104467">//&nbsp;&nbsp;&nbsp;&nbsptext,&nbsp;err&nbsp;:=&nbsp;c.ReadDotBytes()</span><br>
<span class="lineno"></span><span class="comment" id="5104500">//&nbsp;&nbsp;&nbsp;&nbspif&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{</span><br>
<span class="lineno">110</span><span class="comment" id="5104519">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;nil,&nbsp;err</span><br>
<span class="lineno"></span><span class="comment" id="5104539">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno"></span><span class="comment" id="5104544">//&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;c.ReadCodeLine(250)</span><br>
<span class="lineno"></span><span class="comment" id="5104574">//</span><br>
<span class="lineno"></span><span class="keyword" id="5104577">func</span>&nbsp;<span class="op" id="5104582">(</span><span class="ident" id="5104583">c</span>&nbsp;<span class="op" id="5104585">*</span><span class="ident" id="5104586">Conn</span><span class="op" id="5104590">)</span>&nbsp;<span class="ident" id="5104592">Cmd</span><span class="op" id="5104595">(</span><span class="ident" id="5104596">format</span>&nbsp;<span class="builtintype" id="5104603">string</span><span class="op" id="5104609">,</span>&nbsp;<span class="ident" id="5104611">args</span>&nbsp;<span class="op" id="5104616">...</span><span class="keyword" id="5104619">interface</span><span class="op" id="5104628">{</span><span class="op" id="5104629">}</span><span class="op" id="5104630">)</span>&nbsp;<span class="op" id="5104632">(</span><span class="ident" id="5104633">id</span>&nbsp;<span class="builtintype" id="5104636">uint</span><span class="op" id="5104640">,</span>&nbsp;<span class="ident" id="5104642">err</span>&nbsp;<span class="builtintype" id="5104646">error</span><span class="op" id="5104651">)</span>&nbsp;<span class="op" id="5104653">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5104656">id</span>&nbsp;<span class="op" id="5104659">=</span>&nbsp;<span class="ident" id="5104661">c</span><span class="op" id="5104662">.</span><span class="ident" id="5104663">Next</span><span class="op" id="5104667">(</span><span class="op" id="5104668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5104671">c</span><span class="op" id="5104672">.</span><span class="ident" id="5104673">StartRequest</span><span class="op" id="5104685">(</span><span class="ident" id="5104686">id</span><span class="op" id="5104688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5104691">err</span>&nbsp;<span class="op" id="5104695">=</span>&nbsp;<span class="ident" id="5104697">c</span><span class="op" id="5104698">.</span><span class="ident" id="5104699">PrintfLine</span><span class="op" id="5104709">(</span><span class="ident" id="5104710">format</span><span class="op" id="5104716">,</span>&nbsp;<span class="ident" id="5104718">args</span><span class="op" id="5104722">...</span><span class="op" id="5104725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5104728">c</span><span class="op" id="5104729">.</span><span class="ident" id="5104730">EndRequest</span><span class="op" id="5104740">(</span><span class="ident" id="5104741">id</span><span class="op" id="5104743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5104746">if</span>&nbsp;<span class="ident" id="5104749">err</span>&nbsp;<span class="op" id="5104753">!=</span>&nbsp;<span class="ident" id="5104756">nil</span>&nbsp;<span class="op" id="5104760">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5104764">return</span>&nbsp;<span class="num" id="5104771">0</span><span class="op" id="5104772">,</span>&nbsp;<span class="ident" id="5104774">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5104779">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5104782">return</span>&nbsp;<span class="ident" id="5104789">id</span><span class="op" id="5104791">,</span>&nbsp;<span class="ident" id="5104793">nil</span><br>
<span class="lineno"></span><span class="op" id="5104797">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="5104800">//&nbsp;TrimString&nbsp;returns&nbsp;s&nbsp;without&nbsp;leading&nbsp;and&nbsp;trailing&nbsp;ASCII&nbsp;space.</span><br>
<span class="lineno"></span><span class="keyword" id="5104866">func</span>&nbsp;<span class="ident" id="5104871">TrimString</span><span class="op" id="5104881">(</span><span class="ident" id="5104882">s</span>&nbsp;<span class="builtintype" id="5104884">string</span><span class="op" id="5104890">)</span>&nbsp;<span class="builtintype" id="5104892">string</span>&nbsp;<span class="op" id="5104899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5104902">for</span>&nbsp;<span class="builtinfunc" id="5104906">len</span><span class="op" id="5104909">(</span><span class="ident" id="5104910">s</span><span class="op" id="5104911">)</span>&nbsp;<span class="op" id="5104913">&gt;</span>&nbsp;<span class="num" id="5104915">0</span>&nbsp;<span class="op" id="5104917">&amp;&amp;</span>&nbsp;<span class="ident" id="5104920">isASCIISpace</span><span class="op" id="5104932">(</span><span class="ident" id="5104933">s</span><span class="op" id="5104934">[</span><span class="num" id="5104935">0</span><span class="op" id="5104936">]</span><span class="op" id="5104937">)</span>&nbsp;<span class="op" id="5104939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5104943">s</span>&nbsp;<span class="op" id="5104945">=</span>&nbsp;<span class="ident" id="5104947">s</span><span class="op" id="5104948">[</span><span class="num" id="5104949">1</span><span class="op" id="5104950">:</span><span class="op" id="5104951">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5104954">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5104957">for</span>&nbsp;<span class="builtinfunc" id="5104961">len</span><span class="op" id="5104964">(</span><span class="ident" id="5104965">s</span><span class="op" id="5104966">)</span>&nbsp;<span class="op" id="5104968">&gt;</span>&nbsp;<span class="num" id="5104970">0</span>&nbsp;<span class="op" id="5104972">&amp;&amp;</span>&nbsp;<span class="ident" id="5104975">isASCIISpace</span><span class="op" id="5104987">(</span><span class="ident" id="5104988">s</span><span class="op" id="5104989">[</span><span class="builtinfunc" id="5104990">len</span><span class="op" id="5104993">(</span><span class="ident" id="5104994">s</span><span class="op" id="5104995">)</span><span class="op" id="5104996">-</span><span class="num" id="5104997">1</span><span class="op" id="5104998">]</span><span class="op" id="5104999">)</span>&nbsp;<span class="op" id="5105001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5105005">s</span>&nbsp;<span class="op" id="5105007">=</span>&nbsp;<span class="ident" id="5105009">s</span><span class="op" id="5105010">[</span><span class="op" id="5105011">:</span><span class="builtinfunc" id="5105012">len</span><span class="op" id="5105015">(</span><span class="ident" id="5105016">s</span><span class="op" id="5105017">)</span><span class="op" id="5105018">-</span><span class="num" id="5105019">1</span><span class="op" id="5105020">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5105023">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5105026">return</span>&nbsp;<span class="ident" id="5105033">s</span><br>
<span class="lineno"></span><span class="op" id="5105035">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="comment" id="5105038">//&nbsp;TrimBytes&nbsp;returns&nbsp;b&nbsp;without&nbsp;leading&nbsp;and&nbsp;trailing&nbsp;ASCII&nbsp;space.</span><br>
<span class="lineno"></span><span class="keyword" id="5105103">func</span>&nbsp;<span class="ident" id="5105108">TrimBytes</span><span class="op" id="5105117">(</span><span class="ident" id="5105118">b</span>&nbsp;<span class="op" id="5105120">[</span><span class="op" id="5105121">]</span><span class="builtintype" id="5105122">byte</span><span class="op" id="5105126">)</span>&nbsp;<span class="op" id="5105128">[</span><span class="op" id="5105129">]</span><span class="builtintype" id="5105130">byte</span>&nbsp;<span class="op" id="5105135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5105138">for</span>&nbsp;<span class="builtinfunc" id="5105142">len</span><span class="op" id="5105145">(</span><span class="ident" id="5105146">b</span><span class="op" id="5105147">)</span>&nbsp;<span class="op" id="5105149">&gt;</span>&nbsp;<span class="num" id="5105151">0</span>&nbsp;<span class="op" id="5105153">&amp;&amp;</span>&nbsp;<span class="ident" id="5105156">isASCIISpace</span><span class="op" id="5105168">(</span><span class="ident" id="5105169">b</span><span class="op" id="5105170">[</span><span class="num" id="5105171">0</span><span class="op" id="5105172">]</span><span class="op" id="5105173">)</span>&nbsp;<span class="op" id="5105175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5105179">b</span>&nbsp;<span class="op" id="5105181">=</span>&nbsp;<span class="ident" id="5105183">b</span><span class="op" id="5105184">[</span><span class="num" id="5105185">1</span><span class="op" id="5105186">:</span><span class="op" id="5105187">]</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5105190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5105193">for</span>&nbsp;<span class="builtinfunc" id="5105197">len</span><span class="op" id="5105200">(</span><span class="ident" id="5105201">b</span><span class="op" id="5105202">)</span>&nbsp;<span class="op" id="5105204">&gt;</span>&nbsp;<span class="num" id="5105206">0</span>&nbsp;<span class="op" id="5105208">&amp;&amp;</span>&nbsp;<span class="ident" id="5105211">isASCIISpace</span><span class="op" id="5105223">(</span><span class="ident" id="5105224">b</span><span class="op" id="5105225">[</span><span class="builtinfunc" id="5105226">len</span><span class="op" id="5105229">(</span><span class="ident" id="5105230">b</span><span class="op" id="5105231">)</span><span class="op" id="5105232">-</span><span class="num" id="5105233">1</span><span class="op" id="5105234">]</span><span class="op" id="5105235">)</span>&nbsp;<span class="op" id="5105237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5105241">b</span>&nbsp;<span class="op" id="5105243">=</span>&nbsp;<span class="ident" id="5105245">b</span><span class="op" id="5105246">[</span><span class="op" id="5105247">:</span><span class="builtinfunc" id="5105248">len</span><span class="op" id="5105251">(</span><span class="ident" id="5105252">b</span><span class="op" id="5105253">)</span><span class="op" id="5105254">-</span><span class="num" id="5105255">1</span><span class="op" id="5105256">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5105259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5105262">return</span>&nbsp;<span class="ident" id="5105269">b</span><br>
<span class="lineno">145</span><span class="op" id="5105271">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5105274">func</span>&nbsp;<span class="ident" id="5105279">isASCIISpace</span><span class="op" id="5105291">(</span><span class="ident" id="5105292">b</span>&nbsp;<span class="builtintype" id="5105294">byte</span><span class="op" id="5105298">)</span>&nbsp;<span class="builtintype" id="5105300">bool</span>&nbsp;<span class="op" id="5105305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5105308">return</span>&nbsp;<span class="ident" id="5105315">b</span>&nbsp;<span class="op" id="5105317">==</span>&nbsp;<span class="string" id="5105320">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5105324">||</span>&nbsp;<span class="ident" id="5105327">b</span>&nbsp;<span class="op" id="5105329">==</span>&nbsp;<span class="string" id="5105332">&#39;\t&#39;</span>&nbsp;<span class="op" id="5105337">||</span>&nbsp;<span class="ident" id="5105340">b</span>&nbsp;<span class="op" id="5105342">==</span>&nbsp;<span class="string" id="5105345">&#39;\n&#39;</span>&nbsp;<span class="op" id="5105350">||</span>&nbsp;<span class="ident" id="5105353">b</span>&nbsp;<span class="op" id="5105355">==</span>&nbsp;<span class="string" id="5105358">&#39;\r&#39;</span><br>
<span class="lineno"></span><span class="op" id="5105363">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="5105366">func</span>&nbsp;<span class="ident" id="5105371">isASCIILetter</span><span class="op" id="5105384">(</span><span class="ident" id="5105385">b</span>&nbsp;<span class="builtintype" id="5105387">byte</span><span class="op" id="5105391">)</span>&nbsp;<span class="builtintype" id="5105393">bool</span>&nbsp;<span class="op" id="5105398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5105401">b</span>&nbsp;<span class="op" id="5105403">|=</span>&nbsp;<span class="num" id="5105406">0x20</span>&nbsp;<span class="comment" id="5105411">//&nbsp;make&nbsp;lower&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5105431">return</span>&nbsp;<span class="string" id="5105438">&#39;a&#39;</span>&nbsp;<span class="op" id="5105442">&lt;=</span>&nbsp;<span class="ident" id="5105445">b</span>&nbsp;<span class="op" id="5105447">&amp;&amp;</span>&nbsp;<span class="ident" id="5105450">b</span>&nbsp;<span class="op" id="5105452">&lt;=</span>&nbsp;<span class="string" id="5105455">&#39;z&#39;</span><br>
<span class="lineno"></span><span class="op" id="5105459">}</span>
</div>
</body>
</html>
