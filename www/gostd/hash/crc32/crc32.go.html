<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>hash/crc32</h2>
<ul>
<li><a href="/gostd/hash/crc32/crc32.go.html">crc32.go</a></li>
<li><a href="/gostd/hash/crc32/crc32_amd64x.go.html">crc32_amd64x.go</a></li>
<li><a href="/gostd/hash/crc32/crc32_test.go.html">crc32_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4240297">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4240352">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4240406">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4240457">//&nbsp;Package&nbsp;crc32&nbsp;implements&nbsp;the&nbsp;32-bit&nbsp;cyclic&nbsp;redundancy&nbsp;check,&nbsp;or&nbsp;CRC-32,</span><br>
<span class="lineno"></span><span class="comment" id="4240532">//&nbsp;checksum.&nbsp;See&nbsp;http://en.wikipedia.org/wiki/Cyclic_redundancy_check&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="4240606">//&nbsp;information.</span><br>
<span class="lineno"></span><span class="keyword" id="4240622">package</span>&nbsp;<span class="ident" id="4240630">crc32</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="4240637">import</span>&nbsp;<span class="op" id="4240644">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4240647">&#34;hash&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4240655">&#34;sync&#34;</span><br>
<span class="lineno"></span><span class="op" id="4240662">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="4240665">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;CRC-32&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4240708">const</span>&nbsp;<span class="ident" id="4240714">Size</span>&nbsp;<span class="op" id="4240719">=</span>&nbsp;<span class="num" id="4240721">4</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4240724">//&nbsp;Predefined&nbsp;polynomials.</span><br>
<span class="lineno"></span><span class="keyword" id="4240751">const</span>&nbsp;<span class="op" id="4240757">(</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4240760">//&nbsp;IEEE&nbsp;is&nbsp;by&nbsp;far&nbsp;and&nbsp;away&nbsp;the&nbsp;most&nbsp;common&nbsp;CRC-32&nbsp;polynomial.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4240823">//&nbsp;Used&nbsp;by&nbsp;ethernet&nbsp;(IEEE&nbsp;802.3),&nbsp;v.42,&nbsp;fddi,&nbsp;gzip,&nbsp;zip,&nbsp;png,&nbsp;...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4240890">IEEE</span>&nbsp;<span class="op" id="4240895">=</span>&nbsp;<span class="num" id="4240897">0xedb88320</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4240910">//&nbsp;Castagnoli&#39;s&nbsp;polynomial,&nbsp;used&nbsp;in&nbsp;iSCSI.</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4240954">//&nbsp;Has&nbsp;better&nbsp;error&nbsp;detection&nbsp;characteristics&nbsp;than&nbsp;IEEE.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4241012">//&nbsp;http://dx.doi.org/10.1109/26.231911</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4241052">Castagnoli</span>&nbsp;<span class="op" id="4241063">=</span>&nbsp;<span class="num" id="4241065">0x82f63b78</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4241078">//&nbsp;Koopman&#39;s&nbsp;polynomial.</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4241104">//&nbsp;Also&nbsp;has&nbsp;better&nbsp;error&nbsp;detection&nbsp;characteristics&nbsp;than&nbsp;IEEE.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4241167">//&nbsp;http://dx.doi.org/10.1109/DSN.2002.1028931</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4241214">Koopman</span>&nbsp;<span class="op" id="4241222">=</span>&nbsp;<span class="num" id="4241224">0xeb31d82e</span><br>
<span class="lineno"></span><span class="op" id="4241235">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="4241238">//&nbsp;Table&nbsp;is&nbsp;a&nbsp;256-word&nbsp;table&nbsp;representing&nbsp;the&nbsp;polynomial&nbsp;for&nbsp;efficient&nbsp;processing.</span><br>
<span class="lineno"></span><span class="keyword" id="4241321">type</span>&nbsp;<span class="ident" id="4241326">Table</span>&nbsp;<span class="op" id="4241332">[</span><span class="num" id="4241333">256</span><span class="op" id="4241336">]</span><span class="builtintype" id="4241337">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4241345">//&nbsp;castagnoliTable&nbsp;points&nbsp;to&nbsp;a&nbsp;lazily&nbsp;initialized&nbsp;Table&nbsp;for&nbsp;the&nbsp;Castagnoli</span><br>
<span class="lineno"></span><span class="comment" id="4241420">//&nbsp;polynomial.&nbsp;MakeTable&nbsp;will&nbsp;always&nbsp;return&nbsp;this&nbsp;value&nbsp;when&nbsp;asked&nbsp;to&nbsp;make&nbsp;a</span><br>
<span class="lineno">40</span><span class="comment" id="4241496">//&nbsp;Castagnoli&nbsp;table&nbsp;so&nbsp;we&nbsp;can&nbsp;compare&nbsp;against&nbsp;it&nbsp;to&nbsp;find&nbsp;when&nbsp;the&nbsp;caller&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="4241572">//&nbsp;using&nbsp;this&nbsp;polynomial.</span><br>
<span class="lineno"></span><span class="keyword" id="4241598">var</span>&nbsp;<span class="ident" id="4241602">castagnoliTable</span>&nbsp;<span class="op" id="4241618">*</span><span class="ident" id="4241619">Table</span><br>
<span class="lineno"></span><span class="keyword" id="4241625">var</span>&nbsp;<span class="ident" id="4241629">castagnoliOnce</span>&nbsp;<span class="ident" id="4241644">sync</span><span class="op" id="4241648">.</span><span class="ident" id="4241649">Once</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="keyword" id="4241655">func</span>&nbsp;<span class="ident" id="4241660">castagnoliInit</span><span class="op" id="4241674">(</span><span class="op" id="4241675">)</span>&nbsp;<span class="op" id="4241677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4241680">castagnoliTable</span>&nbsp;<span class="op" id="4241696">=</span>&nbsp;<span class="ident" id="4241698">makeTable</span><span class="op" id="4241707">(</span><span class="ident" id="4241708">Castagnoli</span><span class="op" id="4241718">)</span><br>
<span class="lineno"></span><span class="op" id="4241720">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4241723">//&nbsp;IEEETable&nbsp;is&nbsp;the&nbsp;table&nbsp;for&nbsp;the&nbsp;IEEE&nbsp;polynomial.</span><br>
<span class="lineno">50</span><span class="keyword" id="4241774">var</span>&nbsp;<span class="ident" id="4241778">IEEETable</span>&nbsp;<span class="op" id="4241788">=</span>&nbsp;<span class="ident" id="4241790">makeTable</span><span class="op" id="4241799">(</span><span class="ident" id="4241800">IEEE</span><span class="op" id="4241804">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4241807">//&nbsp;MakeTable&nbsp;returns&nbsp;the&nbsp;Table&nbsp;constructed&nbsp;from&nbsp;the&nbsp;specified&nbsp;polynomial.</span><br>
<span class="lineno"></span><span class="keyword" id="4241881">func</span>&nbsp;<span class="ident" id="4241886">MakeTable</span><span class="op" id="4241895">(</span><span class="ident" id="4241896">poly</span>&nbsp;<span class="builtintype" id="4241901">uint32</span><span class="op" id="4241907">)</span>&nbsp;<span class="op" id="4241909">*</span><span class="ident" id="4241910">Table</span>&nbsp;<span class="op" id="4241916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4241919">switch</span>&nbsp;<span class="ident" id="4241926">poly</span>&nbsp;<span class="op" id="4241931">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4241934">case</span>&nbsp;<span class="ident" id="4241939">IEEE</span><span class="op" id="4241943">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4241947">return</span>&nbsp;<span class="ident" id="4241954">IEEETable</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4241965">case</span>&nbsp;<span class="ident" id="4241970">Castagnoli</span><span class="op" id="4241980">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4241984">castagnoliOnce</span><span class="op" id="4241998">.</span><span class="ident" id="4241999">Do</span><span class="op" id="4242001">(</span><span class="ident" id="4242002">castagnoliInit</span><span class="op" id="4242016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4242020">return</span>&nbsp;<span class="ident" id="4242027">castagnoliTable</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4242044">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4242047">return</span>&nbsp;<span class="ident" id="4242054">makeTable</span><span class="op" id="4242063">(</span><span class="ident" id="4242064">poly</span><span class="op" id="4242068">)</span><br>
<span class="lineno"></span><span class="op" id="4242070">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4242073">//&nbsp;makeTable&nbsp;returns&nbsp;the&nbsp;Table&nbsp;constructed&nbsp;from&nbsp;the&nbsp;specified&nbsp;polynomial.</span><br>
<span class="lineno">65</span><span class="keyword" id="4242147">func</span>&nbsp;<span class="ident" id="4242152">makeTable</span><span class="op" id="4242161">(</span><span class="ident" id="4242162">poly</span>&nbsp;<span class="builtintype" id="4242167">uint32</span><span class="op" id="4242173">)</span>&nbsp;<span class="op" id="4242175">*</span><span class="ident" id="4242176">Table</span>&nbsp;<span class="op" id="4242182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4242185">t</span>&nbsp;<span class="op" id="4242187">:=</span>&nbsp;<span class="builtinfunc" id="4242190">new</span><span class="op" id="4242193">(</span><span class="ident" id="4242194">Table</span><span class="op" id="4242199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4242202">for</span>&nbsp;<span class="ident" id="4242206">i</span>&nbsp;<span class="op" id="4242208">:=</span>&nbsp;<span class="num" id="4242211">0</span><span class="op" id="4242212">;</span>&nbsp;<span class="ident" id="4242214">i</span>&nbsp;<span class="op" id="4242216">&lt;</span>&nbsp;<span class="num" id="4242218">256</span><span class="op" id="4242221">;</span>&nbsp;<span class="ident" id="4242223">i</span><span class="op" id="4242224">++</span>&nbsp;<span class="op" id="4242227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4242231">crc</span>&nbsp;<span class="op" id="4242235">:=</span>&nbsp;<span class="builtintype" id="4242238">uint32</span><span class="op" id="4242244">(</span><span class="ident" id="4242245">i</span><span class="op" id="4242246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4242250">for</span>&nbsp;<span class="ident" id="4242254">j</span>&nbsp;<span class="op" id="4242256">:=</span>&nbsp;<span class="num" id="4242259">0</span><span class="op" id="4242260">;</span>&nbsp;<span class="ident" id="4242262">j</span>&nbsp;<span class="op" id="4242264">&lt;</span>&nbsp;<span class="num" id="4242266">8</span><span class="op" id="4242267">;</span>&nbsp;<span class="ident" id="4242269">j</span><span class="op" id="4242270">++</span>&nbsp;<span class="op" id="4242273">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4242278">if</span>&nbsp;<span class="ident" id="4242281">crc</span><span class="op" id="4242284">&amp;</span><span class="num" id="4242285">1</span>&nbsp;<span class="op" id="4242287">==</span>&nbsp;<span class="num" id="4242290">1</span>&nbsp;<span class="op" id="4242292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4242298">crc</span>&nbsp;<span class="op" id="4242302">=</span>&nbsp;<span class="op" id="4242304">(</span><span class="ident" id="4242305">crc</span>&nbsp;<span class="op" id="4242309">&gt;&gt;</span>&nbsp;<span class="num" id="4242312">1</span><span class="op" id="4242313">)</span>&nbsp;<span class="op" id="4242315">^</span>&nbsp;<span class="ident" id="4242317">poly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4242325">}</span>&nbsp;<span class="keyword" id="4242327">else</span>&nbsp;<span class="op" id="4242332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4242338">crc</span>&nbsp;<span class="op" id="4242342">&gt;&gt;=</span>&nbsp;<span class="num" id="4242346">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4242351">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4242355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4242359">t</span><span class="op" id="4242360">[</span><span class="ident" id="4242361">i</span><span class="op" id="4242362">]</span>&nbsp;<span class="op" id="4242364">=</span>&nbsp;<span class="ident" id="4242366">crc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4242371">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4242374">return</span>&nbsp;<span class="ident" id="4242381">t</span><br>
<span class="lineno"></span><span class="op" id="4242383">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="4242386">//&nbsp;digest&nbsp;represents&nbsp;the&nbsp;partial&nbsp;evaluation&nbsp;of&nbsp;a&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4242445">type</span>&nbsp;<span class="ident" id="4242450">digest</span>&nbsp;<span class="keyword" id="4242457">struct</span>&nbsp;<span class="op" id="4242464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4242467">crc</span>&nbsp;<span class="builtintype" id="4242471">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4242479">tab</span>&nbsp;<span class="op" id="4242483">*</span><span class="ident" id="4242484">Table</span><br>
<span class="lineno">85</span><span class="op" id="4242490">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4242493">//&nbsp;New&nbsp;creates&nbsp;a&nbsp;new&nbsp;hash.Hash32&nbsp;computing&nbsp;the&nbsp;CRC-32&nbsp;checksum</span><br>
<span class="lineno"></span><span class="comment" id="4242556">//&nbsp;using&nbsp;the&nbsp;polynomial&nbsp;represented&nbsp;by&nbsp;the&nbsp;Table.</span><br>
<span class="lineno"></span><span class="keyword" id="4242606">func</span>&nbsp;<span class="ident" id="4242611">New</span><span class="op" id="4242614">(</span><span class="ident" id="4242615">tab</span>&nbsp;<span class="op" id="4242619">*</span><span class="ident" id="4242620">Table</span><span class="op" id="4242625">)</span>&nbsp;<span class="ident" id="4242627">hash</span><span class="op" id="4242631">.</span><span class="ident" id="4242632">Hash32</span>&nbsp;<span class="op" id="4242639">{</span>&nbsp;<span class="keyword" id="4242641">return</span>&nbsp;<span class="op" id="4242648">&amp;</span><span class="ident" id="4242649">digest</span><span class="op" id="4242655">{</span><span class="num" id="4242656">0</span><span class="op" id="4242657">,</span>&nbsp;<span class="ident" id="4242659">tab</span><span class="op" id="4242662">}</span>&nbsp;<span class="op" id="4242664">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="4242667">//&nbsp;NewIEEE&nbsp;creates&nbsp;a&nbsp;new&nbsp;hash.Hash32&nbsp;computing&nbsp;the&nbsp;CRC-32&nbsp;checksum</span><br>
<span class="lineno"></span><span class="comment" id="4242734">//&nbsp;using&nbsp;the&nbsp;IEEE&nbsp;polynomial.</span><br>
<span class="lineno"></span><span class="keyword" id="4242764">func</span>&nbsp;<span class="ident" id="4242769">NewIEEE</span><span class="op" id="4242776">(</span><span class="op" id="4242777">)</span>&nbsp;<span class="ident" id="4242779">hash</span><span class="op" id="4242783">.</span><span class="ident" id="4242784">Hash32</span>&nbsp;<span class="op" id="4242791">{</span>&nbsp;<span class="keyword" id="4242793">return</span>&nbsp;<span class="ident" id="4242800">New</span><span class="op" id="4242803">(</span><span class="ident" id="4242804">IEEETable</span><span class="op" id="4242813">)</span>&nbsp;<span class="op" id="4242815">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="keyword" id="4242818">func</span>&nbsp;<span class="op" id="4242823">(</span><span class="ident" id="4242824">d</span>&nbsp;<span class="op" id="4242826">*</span><span class="ident" id="4242827">digest</span><span class="op" id="4242833">)</span>&nbsp;<span class="ident" id="4242835">Size</span><span class="op" id="4242839">(</span><span class="op" id="4242840">)</span>&nbsp;<span class="builtintype" id="4242842">int</span>&nbsp;<span class="op" id="4242846">{</span>&nbsp;<span class="keyword" id="4242848">return</span>&nbsp;<span class="ident" id="4242855">Size</span>&nbsp;<span class="op" id="4242860">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4242863">func</span>&nbsp;<span class="op" id="4242868">(</span><span class="ident" id="4242869">d</span>&nbsp;<span class="op" id="4242871">*</span><span class="ident" id="4242872">digest</span><span class="op" id="4242878">)</span>&nbsp;<span class="ident" id="4242880">BlockSize</span><span class="op" id="4242889">(</span><span class="op" id="4242890">)</span>&nbsp;<span class="builtintype" id="4242892">int</span>&nbsp;<span class="op" id="4242896">{</span>&nbsp;<span class="keyword" id="4242898">return</span>&nbsp;<span class="num" id="4242905">1</span>&nbsp;<span class="op" id="4242907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4242910">func</span>&nbsp;<span class="op" id="4242915">(</span><span class="ident" id="4242916">d</span>&nbsp;<span class="op" id="4242918">*</span><span class="ident" id="4242919">digest</span><span class="op" id="4242925">)</span>&nbsp;<span class="ident" id="4242927">Reset</span><span class="op" id="4242932">(</span><span class="op" id="4242933">)</span>&nbsp;<span class="op" id="4242935">{</span>&nbsp;<span class="ident" id="4242937">d</span><span class="op" id="4242938">.</span><span class="ident" id="4242939">crc</span>&nbsp;<span class="op" id="4242943">=</span>&nbsp;<span class="num" id="4242945">0</span>&nbsp;<span class="op" id="4242947">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="keyword" id="4242950">func</span>&nbsp;<span class="ident" id="4242955">update</span><span class="op" id="4242961">(</span><span class="ident" id="4242962">crc</span>&nbsp;<span class="builtintype" id="4242966">uint32</span><span class="op" id="4242972">,</span>&nbsp;<span class="ident" id="4242974">tab</span>&nbsp;<span class="op" id="4242978">*</span><span class="ident" id="4242979">Table</span><span class="op" id="4242984">,</span>&nbsp;<span class="ident" id="4242986">p</span>&nbsp;<span class="op" id="4242988">[</span><span class="op" id="4242989">]</span><span class="builtintype" id="4242990">byte</span><span class="op" id="4242994">)</span>&nbsp;<span class="builtintype" id="4242996">uint32</span>&nbsp;<span class="op" id="4243003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4243006">crc</span>&nbsp;<span class="op" id="4243010">=</span>&nbsp;<span class="op" id="4243012">^</span><span class="ident" id="4243013">crc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4243018">for</span>&nbsp;<span class="ident" id="4243022">_</span><span class="op" id="4243023">,</span>&nbsp;<span class="ident" id="4243025">v</span>&nbsp;<span class="op" id="4243027">:=</span>&nbsp;<span class="keyword" id="4243030">range</span>&nbsp;<span class="ident" id="4243036">p</span>&nbsp;<span class="op" id="4243038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4243042">crc</span>&nbsp;<span class="op" id="4243046">=</span>&nbsp;<span class="ident" id="4243048">tab</span><span class="op" id="4243051">[</span><span class="builtintype" id="4243052">byte</span><span class="op" id="4243056">(</span><span class="ident" id="4243057">crc</span><span class="op" id="4243060">)</span><span class="op" id="4243061">^</span><span class="ident" id="4243062">v</span><span class="op" id="4243063">]</span>&nbsp;<span class="op" id="4243065">^</span>&nbsp;<span class="op" id="4243067">(</span><span class="ident" id="4243068">crc</span>&nbsp;<span class="op" id="4243072">&gt;&gt;</span>&nbsp;<span class="num" id="4243075">8</span><span class="op" id="4243076">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4243079">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4243082">return</span>&nbsp;<span class="op" id="4243089">^</span><span class="ident" id="4243090">crc</span><br>
<span class="lineno"></span><span class="op" id="4243094">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4243097">//&nbsp;Update&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;adding&nbsp;the&nbsp;bytes&nbsp;in&nbsp;p&nbsp;to&nbsp;the&nbsp;crc.</span><br>
<span class="lineno">110</span><span class="keyword" id="4243163">func</span>&nbsp;<span class="ident" id="4243168">Update</span><span class="op" id="4243174">(</span><span class="ident" id="4243175">crc</span>&nbsp;<span class="builtintype" id="4243179">uint32</span><span class="op" id="4243185">,</span>&nbsp;<span class="ident" id="4243187">tab</span>&nbsp;<span class="op" id="4243191">*</span><span class="ident" id="4243192">Table</span><span class="op" id="4243197">,</span>&nbsp;<span class="ident" id="4243199">p</span>&nbsp;<span class="op" id="4243201">[</span><span class="op" id="4243202">]</span><span class="builtintype" id="4243203">byte</span><span class="op" id="4243207">)</span>&nbsp;<span class="builtintype" id="4243209">uint32</span>&nbsp;<span class="op" id="4243216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4243219">if</span>&nbsp;<span class="ident" id="4243222">tab</span>&nbsp;<span class="op" id="4243226">==</span>&nbsp;<span class="ident" id="4243229">castagnoliTable</span>&nbsp;<span class="op" id="4243245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4243249">return</span>&nbsp;<span class="ident" id="4243256">updateCastagnoli</span><span class="op" id="4243272">(</span><span class="ident" id="4243273">crc</span><span class="op" id="4243276">,</span>&nbsp;<span class="ident" id="4243278">p</span><span class="op" id="4243279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4243282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4243285">return</span>&nbsp;<span class="ident" id="4243292">update</span><span class="op" id="4243298">(</span><span class="ident" id="4243299">crc</span><span class="op" id="4243302">,</span>&nbsp;<span class="ident" id="4243304">tab</span><span class="op" id="4243307">,</span>&nbsp;<span class="ident" id="4243309">p</span><span class="op" id="4243310">)</span><br>
<span class="lineno">115</span><span class="op" id="4243312">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4243315">func</span>&nbsp;<span class="op" id="4243320">(</span><span class="ident" id="4243321">d</span>&nbsp;<span class="op" id="4243323">*</span><span class="ident" id="4243324">digest</span><span class="op" id="4243330">)</span>&nbsp;<span class="ident" id="4243332">Write</span><span class="op" id="4243337">(</span><span class="ident" id="4243338">p</span>&nbsp;<span class="op" id="4243340">[</span><span class="op" id="4243341">]</span><span class="builtintype" id="4243342">byte</span><span class="op" id="4243346">)</span>&nbsp;<span class="op" id="4243348">(</span><span class="ident" id="4243349">n</span>&nbsp;<span class="builtintype" id="4243351">int</span><span class="op" id="4243354">,</span>&nbsp;<span class="ident" id="4243356">err</span>&nbsp;<span class="builtintype" id="4243360">error</span><span class="op" id="4243365">)</span>&nbsp;<span class="op" id="4243367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4243370">d</span><span class="op" id="4243371">.</span><span class="ident" id="4243372">crc</span>&nbsp;<span class="op" id="4243376">=</span>&nbsp;<span class="ident" id="4243378">Update</span><span class="op" id="4243384">(</span><span class="ident" id="4243385">d</span><span class="op" id="4243386">.</span><span class="ident" id="4243387">crc</span><span class="op" id="4243390">,</span>&nbsp;<span class="ident" id="4243392">d</span><span class="op" id="4243393">.</span><span class="ident" id="4243394">tab</span><span class="op" id="4243397">,</span>&nbsp;<span class="ident" id="4243399">p</span><span class="op" id="4243400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4243403">return</span>&nbsp;<span class="builtinfunc" id="4243410">len</span><span class="op" id="4243413">(</span><span class="ident" id="4243414">p</span><span class="op" id="4243415">)</span><span class="op" id="4243416">,</span>&nbsp;<span class="ident" id="4243418">nil</span><br>
<span class="lineno">120</span><span class="op" id="4243422">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4243425">func</span>&nbsp;<span class="op" id="4243430">(</span><span class="ident" id="4243431">d</span>&nbsp;<span class="op" id="4243433">*</span><span class="ident" id="4243434">digest</span><span class="op" id="4243440">)</span>&nbsp;<span class="ident" id="4243442">Sum32</span><span class="op" id="4243447">(</span><span class="op" id="4243448">)</span>&nbsp;<span class="builtintype" id="4243450">uint32</span>&nbsp;<span class="op" id="4243457">{</span>&nbsp;<span class="keyword" id="4243459">return</span>&nbsp;<span class="ident" id="4243466">d</span><span class="op" id="4243467">.</span><span class="ident" id="4243468">crc</span>&nbsp;<span class="op" id="4243472">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4243475">func</span>&nbsp;<span class="op" id="4243480">(</span><span class="ident" id="4243481">d</span>&nbsp;<span class="op" id="4243483">*</span><span class="ident" id="4243484">digest</span><span class="op" id="4243490">)</span>&nbsp;<span class="ident" id="4243492">Sum</span><span class="op" id="4243495">(</span><span class="ident" id="4243496">in</span>&nbsp;<span class="op" id="4243499">[</span><span class="op" id="4243500">]</span><span class="builtintype" id="4243501">byte</span><span class="op" id="4243505">)</span>&nbsp;<span class="op" id="4243507">[</span><span class="op" id="4243508">]</span><span class="builtintype" id="4243509">byte</span>&nbsp;<span class="op" id="4243514">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4243517">s</span>&nbsp;<span class="op" id="4243519">:=</span>&nbsp;<span class="ident" id="4243522">d</span><span class="op" id="4243523">.</span><span class="ident" id="4243524">Sum32</span><span class="op" id="4243529">(</span><span class="op" id="4243530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4243533">return</span>&nbsp;<span class="builtinfunc" id="4243540">append</span><span class="op" id="4243546">(</span><span class="ident" id="4243547">in</span><span class="op" id="4243549">,</span>&nbsp;<span class="builtintype" id="4243551">byte</span><span class="op" id="4243555">(</span><span class="ident" id="4243556">s</span><span class="op" id="4243557">&gt;&gt;</span><span class="num" id="4243559">24</span><span class="op" id="4243561">)</span><span class="op" id="4243562">,</span>&nbsp;<span class="builtintype" id="4243564">byte</span><span class="op" id="4243568">(</span><span class="ident" id="4243569">s</span><span class="op" id="4243570">&gt;&gt;</span><span class="num" id="4243572">16</span><span class="op" id="4243574">)</span><span class="op" id="4243575">,</span>&nbsp;<span class="builtintype" id="4243577">byte</span><span class="op" id="4243581">(</span><span class="ident" id="4243582">s</span><span class="op" id="4243583">&gt;&gt;</span><span class="num" id="4243585">8</span><span class="op" id="4243586">)</span><span class="op" id="4243587">,</span>&nbsp;<span class="builtintype" id="4243589">byte</span><span class="op" id="4243593">(</span><span class="ident" id="4243594">s</span><span class="op" id="4243595">)</span><span class="op" id="4243596">)</span><br>
<span class="lineno"></span><span class="op" id="4243598">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4243601">//&nbsp;Checksum&nbsp;returns&nbsp;the&nbsp;CRC-32&nbsp;checksum&nbsp;of&nbsp;data</span><br>
<span class="lineno">130</span><span class="comment" id="4243649">//&nbsp;using&nbsp;the&nbsp;polynomial&nbsp;represented&nbsp;by&nbsp;the&nbsp;Table.</span><br>
<span class="lineno"></span><span class="keyword" id="4243699">func</span>&nbsp;<span class="ident" id="4243704">Checksum</span><span class="op" id="4243712">(</span><span class="ident" id="4243713">data</span>&nbsp;<span class="op" id="4243718">[</span><span class="op" id="4243719">]</span><span class="builtintype" id="4243720">byte</span><span class="op" id="4243724">,</span>&nbsp;<span class="ident" id="4243726">tab</span>&nbsp;<span class="op" id="4243730">*</span><span class="ident" id="4243731">Table</span><span class="op" id="4243736">)</span>&nbsp;<span class="builtintype" id="4243738">uint32</span>&nbsp;<span class="op" id="4243745">{</span>&nbsp;<span class="keyword" id="4243747">return</span>&nbsp;<span class="ident" id="4243754">Update</span><span class="op" id="4243760">(</span><span class="num" id="4243761">0</span><span class="op" id="4243762">,</span>&nbsp;<span class="ident" id="4243764">tab</span><span class="op" id="4243767">,</span>&nbsp;<span class="ident" id="4243769">data</span><span class="op" id="4243773">)</span>&nbsp;<span class="op" id="4243775">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4243778">//&nbsp;ChecksumIEEE&nbsp;returns&nbsp;the&nbsp;CRC-32&nbsp;checksum&nbsp;of&nbsp;data</span><br>
<span class="lineno"></span><span class="comment" id="4243830">//&nbsp;using&nbsp;the&nbsp;IEEE&nbsp;polynomial.</span><br>
<span class="lineno">135</span><span class="keyword" id="4243860">func</span>&nbsp;<span class="ident" id="4243865">ChecksumIEEE</span><span class="op" id="4243877">(</span><span class="ident" id="4243878">data</span>&nbsp;<span class="op" id="4243883">[</span><span class="op" id="4243884">]</span><span class="builtintype" id="4243885">byte</span><span class="op" id="4243889">)</span>&nbsp;<span class="builtintype" id="4243891">uint32</span>&nbsp;<span class="op" id="4243898">{</span>&nbsp;<span class="keyword" id="4243900">return</span>&nbsp;<span class="ident" id="4243907">update</span><span class="op" id="4243913">(</span><span class="num" id="4243914">0</span><span class="op" id="4243915">,</span>&nbsp;<span class="ident" id="4243917">IEEETable</span><span class="op" id="4243926">,</span>&nbsp;<span class="ident" id="4243928">data</span><span class="op" id="4243932">)</span>&nbsp;<span class="op" id="4243934">}</span>
</div>
</body>
</html>
