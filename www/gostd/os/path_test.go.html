<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>os</h2>
<ul>
<li><a href="/gostd/os/dir_unix.go.html">dir_unix.go</a></li>
<li><a href="/gostd/os/doc.go.html">doc.go</a></li>
<li><a href="/gostd/os/env.go.html">env.go</a></li>
<li><a href="/gostd/os/env_test.go.html">env_test.go</a></li>
<li><a href="/gostd/os/env_unix_test.go.html">env_unix_test.go</a></li>
<li><a href="/gostd/os/error.go.html">error.go</a></li>
<li><a href="/gostd/os/error_test.go.html">error_test.go</a></li>
<li><a href="/gostd/os/error_unix.go.html">error_unix.go</a></li>
<li><a href="/gostd/os/exec.go.html">exec.go</a></li>
<li><a href="/gostd/os/exec_posix.go.html">exec_posix.go</a></li>
<li><a href="/gostd/os/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/os/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/os/file.go.html">file.go</a></li>
<li><a href="/gostd/os/file_posix.go.html">file_posix.go</a></li>
<li><a href="/gostd/os/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/os/getwd.go.html">getwd.go</a></li>
<li><a href="/gostd/os/os_test.go.html">os_test.go</a></li>
<li><a href="/gostd/os/os_unix_test.go.html">os_unix_test.go</a></li>
<li><a href="/gostd/os/path.go.html">path.go</a></li>
<li><a href="/gostd/os/path_test.go.html">path_test.go</a></li>
<li><a href="/gostd/os/path_unix.go.html">path_unix.go</a></li>
<li><a href="/gostd/os/pipe_linux.go.html">pipe_linux.go</a></li>
<li><a href="/gostd/os/proc.go.html">proc.go</a></li>
<li><a href="/gostd/os/stat_linux.go.html">stat_linux.go</a></li>
<li><a href="/gostd/os/sys_linux.go.html">sys_linux.go</a></li>
<li><a href="/gostd/os/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/os/types.go.html">types.go</a></li>
<li><a href="/gostd/os/types_notwin.go.html">types_notwin.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="669532">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="669587">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="669641">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="669692">package</span>&nbsp;<span class="ident" id="669700">os_test</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="669709">import</span>&nbsp;<span class="op" id="669716">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="669719">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="669732">.</span>&nbsp;<span class="string" id="669734">&#34;os&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="669740">&#34;path/filepath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="669757">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="669768">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="669779">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="669789">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="669792">func</span>&nbsp;<span class="ident" id="669797">TestMkdirAll</span><span class="op" id="669809">(</span><span class="ident" id="669810">t</span>&nbsp;<span class="op" id="669812">*</span><span class="ident" id="669813">testing</span><span class="op" id="669820">.</span><span class="ident" id="669821">T</span><span class="op" id="669822">)</span>&nbsp;<span class="op" id="669824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="669827">tmpDir</span>&nbsp;<span class="op" id="669834">:=</span>&nbsp;<span class="ident" id="669837">TempDir</span><span class="op" id="669844">(</span><span class="op" id="669845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="669848">path</span>&nbsp;<span class="op" id="669853">:=</span>&nbsp;<span class="ident" id="669856">tmpDir</span>&nbsp;<span class="op" id="669863">+</span>&nbsp;<span class="string" id="669865">&#34;/_TestMkdirAll_/dir/./dir2&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="669895">err</span>&nbsp;<span class="op" id="669899">:=</span>&nbsp;<span class="ident" id="669902">MkdirAll</span><span class="op" id="669910">(</span><span class="ident" id="669911">path</span><span class="op" id="669915">,</span>&nbsp;<span class="num" id="669917">0777</span><span class="op" id="669921">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="669924">if</span>&nbsp;<span class="ident" id="669927">err</span>&nbsp;<span class="op" id="669931">!=</span>&nbsp;<span class="ident" id="669934">nil</span>&nbsp;<span class="op" id="669938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="669942">t</span><span class="op" id="669943">.</span><span class="ident" id="669944">Fatalf</span><span class="op" id="669950">(</span><span class="string" id="669951">&#34;MkdirAll&nbsp;%q:&nbsp;%s&#34;</span><span class="op" id="669968">,</span>&nbsp;<span class="ident" id="669970">path</span><span class="op" id="669974">,</span>&nbsp;<span class="ident" id="669976">err</span><span class="op" id="669979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="669982">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="669985">defer</span>&nbsp;<span class="ident" id="669991">RemoveAll</span><span class="op" id="670000">(</span><span class="ident" id="670001">tmpDir</span>&nbsp;<span class="op" id="670008">+</span>&nbsp;<span class="string" id="670010">&#34;/_TestMkdirAll_&#34;</span><span class="op" id="670027">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="670031">//&nbsp;Already&nbsp;exists,&nbsp;should&nbsp;succeed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="670067">err</span>&nbsp;<span class="op" id="670071">=</span>&nbsp;<span class="ident" id="670073">MkdirAll</span><span class="op" id="670081">(</span><span class="ident" id="670082">path</span><span class="op" id="670086">,</span>&nbsp;<span class="num" id="670088">0777</span><span class="op" id="670092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="670095">if</span>&nbsp;<span class="ident" id="670098">err</span>&nbsp;<span class="op" id="670102">!=</span>&nbsp;<span class="ident" id="670105">nil</span>&nbsp;<span class="op" id="670109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="670113">t</span><span class="op" id="670114">.</span><span class="ident" id="670115">Fatalf</span><span class="op" id="670121">(</span><span class="string" id="670122">&#34;MkdirAll&nbsp;%q&nbsp;(second&nbsp;time):&nbsp;%s&#34;</span><span class="op" id="670153">,</span>&nbsp;<span class="ident" id="670155">path</span><span class="op" id="670159">,</span>&nbsp;<span class="ident" id="670161">err</span><span class="op" id="670164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="670167">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="670171">//&nbsp;Make&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="670186">fpath</span>&nbsp;<span class="op" id="670192">:=</span>&nbsp;<span class="ident" id="670195">path</span>&nbsp;<span class="op" id="670200">+</span>&nbsp;<span class="string" id="670202">&#34;/file&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="670211">f</span><span class="op" id="670212">,</span>&nbsp;<span class="ident" id="670214">err</span>&nbsp;<span class="op" id="670218">:=</span>&nbsp;<span class="ident" id="670221">Create</span><span class="op" id="670227">(</span><span class="ident" id="670228">fpath</span><span class="op" id="670233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="670236">if</span>&nbsp;<span class="ident" id="670239">err</span>&nbsp;<span class="op" id="670243">!=</span>&nbsp;<span class="ident" id="670246">nil</span>&nbsp;<span class="op" id="670250">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="670254">t</span><span class="op" id="670255">.</span><span class="ident" id="670256">Fatalf</span><span class="op" id="670262">(</span><span class="string" id="670263">&#34;create&nbsp;%q:&nbsp;%s&#34;</span><span class="op" id="670278">,</span>&nbsp;<span class="ident" id="670280">fpath</span><span class="op" id="670285">,</span>&nbsp;<span class="ident" id="670287">err</span><span class="op" id="670290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="670293">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="670296">defer</span>&nbsp;<span class="ident" id="670302">f</span><span class="op" id="670303">.</span><span class="ident" id="670304">Close</span><span class="op" id="670309">(</span><span class="op" id="670310">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="670314">//&nbsp;Can&#39;t&nbsp;make&nbsp;directory&nbsp;named&nbsp;after&nbsp;file.</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="670357">err</span>&nbsp;<span class="op" id="670361">=</span>&nbsp;<span class="ident" id="670363">MkdirAll</span><span class="op" id="670371">(</span><span class="ident" id="670372">fpath</span><span class="op" id="670377">,</span>&nbsp;<span class="num" id="670379">0777</span><span class="op" id="670383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="670386">if</span>&nbsp;<span class="ident" id="670389">err</span>&nbsp;<span class="op" id="670393">==</span>&nbsp;<span class="ident" id="670396">nil</span>&nbsp;<span class="op" id="670400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="670404">t</span><span class="op" id="670405">.</span><span class="ident" id="670406">Fatalf</span><span class="op" id="670412">(</span><span class="string" id="670413">&#34;MkdirAll&nbsp;%q:&nbsp;no&nbsp;error&#34;</span><span class="op" id="670436">,</span>&nbsp;<span class="ident" id="670438">fpath</span><span class="op" id="670443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="670446">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="670449">perr</span><span class="op" id="670453">,</span>&nbsp;<span class="ident" id="670455">ok</span>&nbsp;<span class="op" id="670458">:=</span>&nbsp;<span class="ident" id="670461">err</span><span class="op" id="670464">.</span><span class="op" id="670465">(</span><span class="op" id="670466">*</span><span class="ident" id="670467">PathError</span><span class="op" id="670476">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="670479">if</span>&nbsp;<span class="op" id="670482">!</span><span class="ident" id="670483">ok</span>&nbsp;<span class="op" id="670486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="670490">t</span><span class="op" id="670491">.</span><span class="ident" id="670492">Fatalf</span><span class="op" id="670498">(</span><span class="string" id="670499">&#34;MkdirAll&nbsp;%q&nbsp;returned&nbsp;%T,&nbsp;not&nbsp;*PathError&#34;</span><span class="op" id="670540">,</span>&nbsp;<span class="ident" id="670542">fpath</span><span class="op" id="670547">,</span>&nbsp;<span class="ident" id="670549">err</span><span class="op" id="670552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="670555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="670558">if</span>&nbsp;<span class="ident" id="670561">filepath</span><span class="op" id="670569">.</span><span class="ident" id="670570">Clean</span><span class="op" id="670575">(</span><span class="ident" id="670576">perr</span><span class="op" id="670580">.</span><span class="ident" id="670581">Path</span><span class="op" id="670585">)</span>&nbsp;<span class="op" id="670587">!=</span>&nbsp;<span class="ident" id="670590">filepath</span><span class="op" id="670598">.</span><span class="ident" id="670599">Clean</span><span class="op" id="670604">(</span><span class="ident" id="670605">fpath</span><span class="op" id="670610">)</span>&nbsp;<span class="op" id="670612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="670616">t</span><span class="op" id="670617">.</span><span class="ident" id="670618">Fatalf</span><span class="op" id="670624">(</span><span class="string" id="670625">&#34;MkdirAll&nbsp;%q&nbsp;returned&nbsp;wrong&nbsp;error&nbsp;path:&nbsp;%q&nbsp;not&nbsp;%q&#34;</span><span class="op" id="670675">,</span>&nbsp;<span class="ident" id="670677">fpath</span><span class="op" id="670682">,</span>&nbsp;<span class="ident" id="670684">filepath</span><span class="op" id="670692">.</span><span class="ident" id="670693">Clean</span><span class="op" id="670698">(</span><span class="ident" id="670699">perr</span><span class="op" id="670703">.</span><span class="ident" id="670704">Path</span><span class="op" id="670708">)</span><span class="op" id="670709">,</span>&nbsp;<span class="ident" id="670711">filepath</span><span class="op" id="670719">.</span><span class="ident" id="670720">Clean</span><span class="op" id="670725">(</span><span class="ident" id="670726">fpath</span><span class="op" id="670731">)</span><span class="op" id="670732">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="670735">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="670739">//&nbsp;Can&#39;t&nbsp;make&nbsp;subdirectory&nbsp;of&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="670776">ffpath</span>&nbsp;<span class="op" id="670783">:=</span>&nbsp;<span class="ident" id="670786">fpath</span>&nbsp;<span class="op" id="670792">+</span>&nbsp;<span class="string" id="670794">&#34;/subdir&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="670805">err</span>&nbsp;<span class="op" id="670809">=</span>&nbsp;<span class="ident" id="670811">MkdirAll</span><span class="op" id="670819">(</span><span class="ident" id="670820">ffpath</span><span class="op" id="670826">,</span>&nbsp;<span class="num" id="670828">0777</span><span class="op" id="670832">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="670835">if</span>&nbsp;<span class="ident" id="670838">err</span>&nbsp;<span class="op" id="670842">==</span>&nbsp;<span class="ident" id="670845">nil</span>&nbsp;<span class="op" id="670849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="670853">t</span><span class="op" id="670854">.</span><span class="ident" id="670855">Fatalf</span><span class="op" id="670861">(</span><span class="string" id="670862">&#34;MkdirAll&nbsp;%q:&nbsp;no&nbsp;error&#34;</span><span class="op" id="670885">,</span>&nbsp;<span class="ident" id="670887">ffpath</span><span class="op" id="670893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="670896">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="670899">perr</span><span class="op" id="670903">,</span>&nbsp;<span class="ident" id="670905">ok</span>&nbsp;<span class="op" id="670908">=</span>&nbsp;<span class="ident" id="670910">err</span><span class="op" id="670913">.</span><span class="op" id="670914">(</span><span class="op" id="670915">*</span><span class="ident" id="670916">PathError</span><span class="op" id="670925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="670928">if</span>&nbsp;<span class="op" id="670931">!</span><span class="ident" id="670932">ok</span>&nbsp;<span class="op" id="670935">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="670939">t</span><span class="op" id="670940">.</span><span class="ident" id="670941">Fatalf</span><span class="op" id="670947">(</span><span class="string" id="670948">&#34;MkdirAll&nbsp;%q&nbsp;returned&nbsp;%T,&nbsp;not&nbsp;*PathError&#34;</span><span class="op" id="670989">,</span>&nbsp;<span class="ident" id="670991">ffpath</span><span class="op" id="670997">,</span>&nbsp;<span class="ident" id="670999">err</span><span class="op" id="671002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="671005">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="671008">if</span>&nbsp;<span class="ident" id="671011">filepath</span><span class="op" id="671019">.</span><span class="ident" id="671020">Clean</span><span class="op" id="671025">(</span><span class="ident" id="671026">perr</span><span class="op" id="671030">.</span><span class="ident" id="671031">Path</span><span class="op" id="671035">)</span>&nbsp;<span class="op" id="671037">!=</span>&nbsp;<span class="ident" id="671040">filepath</span><span class="op" id="671048">.</span><span class="ident" id="671049">Clean</span><span class="op" id="671054">(</span><span class="ident" id="671055">fpath</span><span class="op" id="671060">)</span>&nbsp;<span class="op" id="671062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="671066">t</span><span class="op" id="671067">.</span><span class="ident" id="671068">Fatalf</span><span class="op" id="671074">(</span><span class="string" id="671075">&#34;MkdirAll&nbsp;%q&nbsp;returned&nbsp;wrong&nbsp;error&nbsp;path:&nbsp;%q&nbsp;not&nbsp;%q&#34;</span><span class="op" id="671125">,</span>&nbsp;<span class="ident" id="671127">ffpath</span><span class="op" id="671133">,</span>&nbsp;<span class="ident" id="671135">filepath</span><span class="op" id="671143">.</span><span class="ident" id="671144">Clean</span><span class="op" id="671149">(</span><span class="ident" id="671150">perr</span><span class="op" id="671154">.</span><span class="ident" id="671155">Path</span><span class="op" id="671159">)</span><span class="op" id="671160">,</span>&nbsp;<span class="ident" id="671162">filepath</span><span class="op" id="671170">.</span><span class="ident" id="671171">Clean</span><span class="op" id="671176">(</span><span class="ident" id="671177">fpath</span><span class="op" id="671182">)</span><span class="op" id="671183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="671186">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="671190">if</span>&nbsp;<span class="ident" id="671193">runtime</span><span class="op" id="671200">.</span><span class="ident" id="671201">GOOS</span>&nbsp;<span class="op" id="671206">==</span>&nbsp;<span class="string" id="671209">&#34;windows&#34;</span>&nbsp;<span class="op" id="671219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="671223">path</span>&nbsp;<span class="op" id="671228">:=</span>&nbsp;<span class="ident" id="671231">tmpDir</span>&nbsp;<span class="op" id="671238">+</span>&nbsp;<span class="string" id="671240">`\_TestMkdirAll_\dir\.\dir2\`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="671272">err</span>&nbsp;<span class="op" id="671276">:=</span>&nbsp;<span class="ident" id="671279">MkdirAll</span><span class="op" id="671287">(</span><span class="ident" id="671288">path</span><span class="op" id="671292">,</span>&nbsp;<span class="num" id="671294">0777</span><span class="op" id="671298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="671302">if</span>&nbsp;<span class="ident" id="671305">err</span>&nbsp;<span class="op" id="671309">!=</span>&nbsp;<span class="ident" id="671312">nil</span>&nbsp;<span class="op" id="671316">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="671321">t</span><span class="op" id="671322">.</span><span class="ident" id="671323">Fatalf</span><span class="op" id="671329">(</span><span class="string" id="671330">&#34;MkdirAll&nbsp;%q:&nbsp;%s&#34;</span><span class="op" id="671347">,</span>&nbsp;<span class="ident" id="671349">path</span><span class="op" id="671353">,</span>&nbsp;<span class="ident" id="671355">err</span><span class="op" id="671358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="671362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="671365">}</span><br>
<span class="lineno"></span><span class="op" id="671367">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="671370">func</span>&nbsp;<span class="ident" id="671375">TestRemoveAll</span><span class="op" id="671388">(</span><span class="ident" id="671389">t</span>&nbsp;<span class="op" id="671391">*</span><span class="ident" id="671392">testing</span><span class="op" id="671399">.</span><span class="ident" id="671400">T</span><span class="op" id="671401">)</span>&nbsp;<span class="op" id="671403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="671406">tmpDir</span>&nbsp;<span class="op" id="671413">:=</span>&nbsp;<span class="ident" id="671416">TempDir</span><span class="op" id="671423">(</span><span class="op" id="671424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="671427">//&nbsp;Work&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="671447">path</span>&nbsp;<span class="op" id="671452">:=</span>&nbsp;<span class="ident" id="671455">tmpDir</span>&nbsp;<span class="op" id="671462">+</span>&nbsp;<span class="string" id="671464">&#34;/_TestRemoveAll_&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="671484">fpath</span>&nbsp;<span class="op" id="671490">:=</span>&nbsp;<span class="ident" id="671493">path</span>&nbsp;<span class="op" id="671498">+</span>&nbsp;<span class="string" id="671500">&#34;/file&#34;</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="671509">dpath</span>&nbsp;<span class="op" id="671515">:=</span>&nbsp;<span class="ident" id="671518">path</span>&nbsp;<span class="op" id="671523">+</span>&nbsp;<span class="string" id="671525">&#34;/dir&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="671534">//&nbsp;Make&nbsp;directory&nbsp;with&nbsp;1&nbsp;file&nbsp;and&nbsp;remove.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="671577">if</span>&nbsp;<span class="ident" id="671580">err</span>&nbsp;<span class="op" id="671584">:=</span>&nbsp;<span class="ident" id="671587">MkdirAll</span><span class="op" id="671595">(</span><span class="ident" id="671596">path</span><span class="op" id="671600">,</span>&nbsp;<span class="num" id="671602">0777</span><span class="op" id="671606">)</span><span class="op" id="671607">;</span>&nbsp;<span class="ident" id="671609">err</span>&nbsp;<span class="op" id="671613">!=</span>&nbsp;<span class="ident" id="671616">nil</span>&nbsp;<span class="op" id="671620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="671624">t</span><span class="op" id="671625">.</span><span class="ident" id="671626">Fatalf</span><span class="op" id="671632">(</span><span class="string" id="671633">&#34;MkdirAll&nbsp;%q:&nbsp;%s&#34;</span><span class="op" id="671650">,</span>&nbsp;<span class="ident" id="671652">path</span><span class="op" id="671656">,</span>&nbsp;<span class="ident" id="671658">err</span><span class="op" id="671661">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="671664">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="671667">fd</span><span class="op" id="671669">,</span>&nbsp;<span class="ident" id="671671">err</span>&nbsp;<span class="op" id="671675">:=</span>&nbsp;<span class="ident" id="671678">Create</span><span class="op" id="671684">(</span><span class="ident" id="671685">fpath</span><span class="op" id="671690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="671693">if</span>&nbsp;<span class="ident" id="671696">err</span>&nbsp;<span class="op" id="671700">!=</span>&nbsp;<span class="ident" id="671703">nil</span>&nbsp;<span class="op" id="671707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="671711">t</span><span class="op" id="671712">.</span><span class="ident" id="671713">Fatalf</span><span class="op" id="671719">(</span><span class="string" id="671720">&#34;create&nbsp;%q:&nbsp;%s&#34;</span><span class="op" id="671735">,</span>&nbsp;<span class="ident" id="671737">fpath</span><span class="op" id="671742">,</span>&nbsp;<span class="ident" id="671744">err</span><span class="op" id="671747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="671750">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="671753">fd</span><span class="op" id="671755">.</span><span class="ident" id="671756">Close</span><span class="op" id="671761">(</span><span class="op" id="671762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="671765">if</span>&nbsp;<span class="ident" id="671768">err</span>&nbsp;<span class="op" id="671772">=</span>&nbsp;<span class="ident" id="671774">RemoveAll</span><span class="op" id="671783">(</span><span class="ident" id="671784">path</span><span class="op" id="671788">)</span><span class="op" id="671789">;</span>&nbsp;<span class="ident" id="671791">err</span>&nbsp;<span class="op" id="671795">!=</span>&nbsp;<span class="ident" id="671798">nil</span>&nbsp;<span class="op" id="671802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="671806">t</span><span class="op" id="671807">.</span><span class="ident" id="671808">Fatalf</span><span class="op" id="671814">(</span><span class="string" id="671815">&#34;RemoveAll&nbsp;%q&nbsp;(first):&nbsp;%s&#34;</span><span class="op" id="671841">,</span>&nbsp;<span class="ident" id="671843">path</span><span class="op" id="671847">,</span>&nbsp;<span class="ident" id="671849">err</span><span class="op" id="671852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="671855">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="671858">if</span>&nbsp;<span class="ident" id="671861">_</span><span class="op" id="671862">,</span>&nbsp;<span class="ident" id="671864">err</span>&nbsp;<span class="op" id="671868">=</span>&nbsp;<span class="ident" id="671870">Lstat</span><span class="op" id="671875">(</span><span class="ident" id="671876">path</span><span class="op" id="671880">)</span><span class="op" id="671881">;</span>&nbsp;<span class="ident" id="671883">err</span>&nbsp;<span class="op" id="671887">==</span>&nbsp;<span class="ident" id="671890">nil</span>&nbsp;<span class="op" id="671894">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="671898">t</span><span class="op" id="671899">.</span><span class="ident" id="671900">Fatalf</span><span class="op" id="671906">(</span><span class="string" id="671907">&#34;Lstat&nbsp;%q&nbsp;succeeded&nbsp;after&nbsp;RemoveAll&nbsp;(first)&#34;</span><span class="op" id="671951">,</span>&nbsp;<span class="ident" id="671953">path</span><span class="op" id="671957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="671960">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="671964">//&nbsp;Make&nbsp;directory&nbsp;with&nbsp;file&nbsp;and&nbsp;subdirectory&nbsp;and&nbsp;remove.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="672022">if</span>&nbsp;<span class="ident" id="672025">err</span>&nbsp;<span class="op" id="672029">=</span>&nbsp;<span class="ident" id="672031">MkdirAll</span><span class="op" id="672039">(</span><span class="ident" id="672040">dpath</span><span class="op" id="672045">,</span>&nbsp;<span class="num" id="672047">0777</span><span class="op" id="672051">)</span><span class="op" id="672052">;</span>&nbsp;<span class="ident" id="672054">err</span>&nbsp;<span class="op" id="672058">!=</span>&nbsp;<span class="ident" id="672061">nil</span>&nbsp;<span class="op" id="672065">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="672069">t</span><span class="op" id="672070">.</span><span class="ident" id="672071">Fatalf</span><span class="op" id="672077">(</span><span class="string" id="672078">&#34;MkdirAll&nbsp;%q:&nbsp;%s&#34;</span><span class="op" id="672095">,</span>&nbsp;<span class="ident" id="672097">dpath</span><span class="op" id="672102">,</span>&nbsp;<span class="ident" id="672104">err</span><span class="op" id="672107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="672110">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="672113">fd</span><span class="op" id="672115">,</span>&nbsp;<span class="ident" id="672117">err</span>&nbsp;<span class="op" id="672121">=</span>&nbsp;<span class="ident" id="672123">Create</span><span class="op" id="672129">(</span><span class="ident" id="672130">fpath</span><span class="op" id="672135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="672138">if</span>&nbsp;<span class="ident" id="672141">err</span>&nbsp;<span class="op" id="672145">!=</span>&nbsp;<span class="ident" id="672148">nil</span>&nbsp;<span class="op" id="672152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="672156">t</span><span class="op" id="672157">.</span><span class="ident" id="672158">Fatalf</span><span class="op" id="672164">(</span><span class="string" id="672165">&#34;create&nbsp;%q:&nbsp;%s&#34;</span><span class="op" id="672180">,</span>&nbsp;<span class="ident" id="672182">fpath</span><span class="op" id="672187">,</span>&nbsp;<span class="ident" id="672189">err</span><span class="op" id="672192">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="672195">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="672198">fd</span><span class="op" id="672200">.</span><span class="ident" id="672201">Close</span><span class="op" id="672206">(</span><span class="op" id="672207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="672210">fd</span><span class="op" id="672212">,</span>&nbsp;<span class="ident" id="672214">err</span>&nbsp;<span class="op" id="672218">=</span>&nbsp;<span class="ident" id="672220">Create</span><span class="op" id="672226">(</span><span class="ident" id="672227">dpath</span>&nbsp;<span class="op" id="672233">+</span>&nbsp;<span class="string" id="672235">&#34;/file&#34;</span><span class="op" id="672242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="672245">if</span>&nbsp;<span class="ident" id="672248">err</span>&nbsp;<span class="op" id="672252">!=</span>&nbsp;<span class="ident" id="672255">nil</span>&nbsp;<span class="op" id="672259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="672263">t</span><span class="op" id="672264">.</span><span class="ident" id="672265">Fatalf</span><span class="op" id="672271">(</span><span class="string" id="672272">&#34;create&nbsp;%q:&nbsp;%s&#34;</span><span class="op" id="672287">,</span>&nbsp;<span class="ident" id="672289">fpath</span><span class="op" id="672294">,</span>&nbsp;<span class="ident" id="672296">err</span><span class="op" id="672299">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="672302">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="672305">fd</span><span class="op" id="672307">.</span><span class="ident" id="672308">Close</span><span class="op" id="672313">(</span><span class="op" id="672314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="672317">if</span>&nbsp;<span class="ident" id="672320">err</span>&nbsp;<span class="op" id="672324">=</span>&nbsp;<span class="ident" id="672326">RemoveAll</span><span class="op" id="672335">(</span><span class="ident" id="672336">path</span><span class="op" id="672340">)</span><span class="op" id="672341">;</span>&nbsp;<span class="ident" id="672343">err</span>&nbsp;<span class="op" id="672347">!=</span>&nbsp;<span class="ident" id="672350">nil</span>&nbsp;<span class="op" id="672354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="672358">t</span><span class="op" id="672359">.</span><span class="ident" id="672360">Fatalf</span><span class="op" id="672366">(</span><span class="string" id="672367">&#34;RemoveAll&nbsp;%q&nbsp;(second):&nbsp;%s&#34;</span><span class="op" id="672394">,</span>&nbsp;<span class="ident" id="672396">path</span><span class="op" id="672400">,</span>&nbsp;<span class="ident" id="672402">err</span><span class="op" id="672405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="672408">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="672411">if</span>&nbsp;<span class="ident" id="672414">_</span><span class="op" id="672415">,</span>&nbsp;<span class="ident" id="672417">err</span>&nbsp;<span class="op" id="672421">:=</span>&nbsp;<span class="ident" id="672424">Lstat</span><span class="op" id="672429">(</span><span class="ident" id="672430">path</span><span class="op" id="672434">)</span><span class="op" id="672435">;</span>&nbsp;<span class="ident" id="672437">err</span>&nbsp;<span class="op" id="672441">==</span>&nbsp;<span class="ident" id="672444">nil</span>&nbsp;<span class="op" id="672448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="672452">t</span><span class="op" id="672453">.</span><span class="ident" id="672454">Fatalf</span><span class="op" id="672460">(</span><span class="string" id="672461">&#34;Lstat&nbsp;%q&nbsp;succeeded&nbsp;after&nbsp;RemoveAll&nbsp;(second)&#34;</span><span class="op" id="672506">,</span>&nbsp;<span class="ident" id="672508">path</span><span class="op" id="672512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="672515">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="672519">//&nbsp;Determine&nbsp;if&nbsp;we&nbsp;should&nbsp;run&nbsp;the&nbsp;following&nbsp;test.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="672570">testit</span>&nbsp;<span class="op" id="672577">:=</span>&nbsp;<span class="builtintype" id="672580">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="672586">if</span>&nbsp;<span class="ident" id="672589">runtime</span><span class="op" id="672596">.</span><span class="ident" id="672597">GOOS</span>&nbsp;<span class="op" id="672602">==</span>&nbsp;<span class="string" id="672605">&#34;windows&#34;</span>&nbsp;<span class="op" id="672615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="672619">//&nbsp;Chmod&nbsp;is&nbsp;not&nbsp;supported&nbsp;under&nbsp;windows.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="672662">testit</span>&nbsp;<span class="op" id="672669">=</span>&nbsp;<span class="builtintype" id="672671">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="672678">}</span>&nbsp;<span class="keyword" id="672680">else</span>&nbsp;<span class="op" id="672685">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="672689">//&nbsp;Test&nbsp;fails&nbsp;as&nbsp;root.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="672714">testit</span>&nbsp;<span class="op" id="672721">=</span>&nbsp;<span class="ident" id="672723">Getuid</span><span class="op" id="672729">(</span><span class="op" id="672730">)</span>&nbsp;<span class="op" id="672732">!=</span>&nbsp;<span class="num" id="672735">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="672738">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="672741">if</span>&nbsp;<span class="ident" id="672744">testit</span>&nbsp;<span class="op" id="672751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="672755">//&nbsp;Make&nbsp;directory&nbsp;with&nbsp;file&nbsp;and&nbsp;subdirectory&nbsp;and&nbsp;trigger&nbsp;error.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="672821">if</span>&nbsp;<span class="ident" id="672824">err</span>&nbsp;<span class="op" id="672828">=</span>&nbsp;<span class="ident" id="672830">MkdirAll</span><span class="op" id="672838">(</span><span class="ident" id="672839">dpath</span><span class="op" id="672844">,</span>&nbsp;<span class="num" id="672846">0777</span><span class="op" id="672850">)</span><span class="op" id="672851">;</span>&nbsp;<span class="ident" id="672853">err</span>&nbsp;<span class="op" id="672857">!=</span>&nbsp;<span class="ident" id="672860">nil</span>&nbsp;<span class="op" id="672864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="672869">t</span><span class="op" id="672870">.</span><span class="ident" id="672871">Fatalf</span><span class="op" id="672877">(</span><span class="string" id="672878">&#34;MkdirAll&nbsp;%q:&nbsp;%s&#34;</span><span class="op" id="672895">,</span>&nbsp;<span class="ident" id="672897">dpath</span><span class="op" id="672902">,</span>&nbsp;<span class="ident" id="672904">err</span><span class="op" id="672907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="672911">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="672916">for</span>&nbsp;<span class="ident" id="672920">_</span><span class="op" id="672921">,</span>&nbsp;<span class="ident" id="672923">s</span>&nbsp;<span class="op" id="672925">:=</span>&nbsp;<span class="keyword" id="672928">range</span>&nbsp;<span class="op" id="672934">[</span><span class="op" id="672935">]</span><span class="builtintype" id="672936">string</span><span class="op" id="672942">{</span><span class="ident" id="672943">fpath</span><span class="op" id="672948">,</span>&nbsp;<span class="ident" id="672950">dpath</span>&nbsp;<span class="op" id="672956">+</span>&nbsp;<span class="string" id="672958">&#34;/file1&#34;</span><span class="op" id="672966">,</span>&nbsp;<span class="ident" id="672968">path</span>&nbsp;<span class="op" id="672973">+</span>&nbsp;<span class="string" id="672975">&#34;/zzz&#34;</span><span class="op" id="672981">}</span>&nbsp;<span class="op" id="672983">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="672988">fd</span><span class="op" id="672990">,</span>&nbsp;<span class="ident" id="672992">err</span>&nbsp;<span class="op" id="672996">=</span>&nbsp;<span class="ident" id="672998">Create</span><span class="op" id="673004">(</span><span class="ident" id="673005">s</span><span class="op" id="673006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="673011">if</span>&nbsp;<span class="ident" id="673014">err</span>&nbsp;<span class="op" id="673018">!=</span>&nbsp;<span class="ident" id="673021">nil</span>&nbsp;<span class="op" id="673025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="673031">t</span><span class="op" id="673032">.</span><span class="ident" id="673033">Fatalf</span><span class="op" id="673039">(</span><span class="string" id="673040">&#34;create&nbsp;%q:&nbsp;%s&#34;</span><span class="op" id="673055">,</span>&nbsp;<span class="ident" id="673057">s</span><span class="op" id="673058">,</span>&nbsp;<span class="ident" id="673060">err</span><span class="op" id="673063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="673068">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="673073">fd</span><span class="op" id="673075">.</span><span class="ident" id="673076">Close</span><span class="op" id="673081">(</span><span class="op" id="673082">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="673086">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="673090">if</span>&nbsp;<span class="ident" id="673093">err</span>&nbsp;<span class="op" id="673097">=</span>&nbsp;<span class="ident" id="673099">Chmod</span><span class="op" id="673104">(</span><span class="ident" id="673105">dpath</span><span class="op" id="673110">,</span>&nbsp;<span class="num" id="673112">0</span><span class="op" id="673113">)</span><span class="op" id="673114">;</span>&nbsp;<span class="ident" id="673116">err</span>&nbsp;<span class="op" id="673120">!=</span>&nbsp;<span class="ident" id="673123">nil</span>&nbsp;<span class="op" id="673127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="673132">t</span><span class="op" id="673133">.</span><span class="ident" id="673134">Fatalf</span><span class="op" id="673140">(</span><span class="string" id="673141">&#34;Chmod&nbsp;%q&nbsp;0:&nbsp;%s&#34;</span><span class="op" id="673157">,</span>&nbsp;<span class="ident" id="673159">dpath</span><span class="op" id="673164">,</span>&nbsp;<span class="ident" id="673166">err</span><span class="op" id="673169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="673173">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="673178">//&nbsp;No&nbsp;error&nbsp;checking&nbsp;here:&nbsp;either&nbsp;RemoveAll</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="673224">//&nbsp;will&nbsp;or&nbsp;won&#39;t&nbsp;be&nbsp;able&nbsp;to&nbsp;remove&nbsp;dpath;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="673268">//&nbsp;either&nbsp;way&nbsp;we&nbsp;want&nbsp;to&nbsp;see&nbsp;if&nbsp;it&nbsp;removes&nbsp;fpath</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="673319">//&nbsp;and&nbsp;path/zzz.&nbsp;&nbsp;Reasons&nbsp;why&nbsp;RemoveAll&nbsp;might</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="673367">//&nbsp;succeed&nbsp;in&nbsp;removing&nbsp;dpath&nbsp;as&nbsp;well&nbsp;include:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="673415">//&nbsp;&nbsp;&nbsp;&nbsp*&nbsp;running&nbsp;as&nbsp;root</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="673438">//&nbsp;&nbsp;&nbsp;&nbsp*&nbsp;running&nbsp;on&nbsp;a&nbsp;file&nbsp;system&nbsp;without&nbsp;permissions&nbsp;(FAT)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="673496">RemoveAll</span><span class="op" id="673505">(</span><span class="ident" id="673506">path</span><span class="op" id="673510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="673514">Chmod</span><span class="op" id="673519">(</span><span class="ident" id="673520">dpath</span><span class="op" id="673525">,</span>&nbsp;<span class="num" id="673527">0777</span><span class="op" id="673531">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="673536">for</span>&nbsp;<span class="ident" id="673540">_</span><span class="op" id="673541">,</span>&nbsp;<span class="ident" id="673543">s</span>&nbsp;<span class="op" id="673545">:=</span>&nbsp;<span class="keyword" id="673548">range</span>&nbsp;<span class="op" id="673554">[</span><span class="op" id="673555">]</span><span class="builtintype" id="673556">string</span><span class="op" id="673562">{</span><span class="ident" id="673563">fpath</span><span class="op" id="673568">,</span>&nbsp;<span class="ident" id="673570">path</span>&nbsp;<span class="op" id="673575">+</span>&nbsp;<span class="string" id="673577">&#34;/zzz&#34;</span><span class="op" id="673583">}</span>&nbsp;<span class="op" id="673585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="673590">if</span>&nbsp;<span class="ident" id="673593">_</span><span class="op" id="673594">,</span>&nbsp;<span class="ident" id="673596">err</span>&nbsp;<span class="op" id="673600">=</span>&nbsp;<span class="ident" id="673602">Lstat</span><span class="op" id="673607">(</span><span class="ident" id="673608">s</span><span class="op" id="673609">)</span><span class="op" id="673610">;</span>&nbsp;<span class="ident" id="673612">err</span>&nbsp;<span class="op" id="673616">==</span>&nbsp;<span class="ident" id="673619">nil</span>&nbsp;<span class="op" id="673623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="673629">t</span><span class="op" id="673630">.</span><span class="ident" id="673631">Fatalf</span><span class="op" id="673637">(</span><span class="string" id="673638">&#34;Lstat&nbsp;%q&nbsp;succeeded&nbsp;after&nbsp;partial&nbsp;RemoveAll&#34;</span><span class="op" id="673682">,</span>&nbsp;<span class="ident" id="673684">s</span><span class="op" id="673685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="673690">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="673694">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="673697">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="673700">if</span>&nbsp;<span class="ident" id="673703">err</span>&nbsp;<span class="op" id="673707">=</span>&nbsp;<span class="ident" id="673709">RemoveAll</span><span class="op" id="673718">(</span><span class="ident" id="673719">path</span><span class="op" id="673723">)</span><span class="op" id="673724">;</span>&nbsp;<span class="ident" id="673726">err</span>&nbsp;<span class="op" id="673730">!=</span>&nbsp;<span class="ident" id="673733">nil</span>&nbsp;<span class="op" id="673737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="673741">t</span><span class="op" id="673742">.</span><span class="ident" id="673743">Fatalf</span><span class="op" id="673749">(</span><span class="string" id="673750">&#34;RemoveAll&nbsp;%q&nbsp;after&nbsp;partial&nbsp;RemoveAll:&nbsp;%s&#34;</span><span class="op" id="673792">,</span>&nbsp;<span class="ident" id="673794">path</span><span class="op" id="673798">,</span>&nbsp;<span class="ident" id="673800">err</span><span class="op" id="673803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="673806">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="673809">if</span>&nbsp;<span class="ident" id="673812">_</span><span class="op" id="673813">,</span>&nbsp;<span class="ident" id="673815">err</span>&nbsp;<span class="op" id="673819">=</span>&nbsp;<span class="ident" id="673821">Lstat</span><span class="op" id="673826">(</span><span class="ident" id="673827">path</span><span class="op" id="673831">)</span><span class="op" id="673832">;</span>&nbsp;<span class="ident" id="673834">err</span>&nbsp;<span class="op" id="673838">==</span>&nbsp;<span class="ident" id="673841">nil</span>&nbsp;<span class="op" id="673845">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="673849">t</span><span class="op" id="673850">.</span><span class="ident" id="673851">Fatalf</span><span class="op" id="673857">(</span><span class="string" id="673858">&#34;Lstat&nbsp;%q&nbsp;succeeded&nbsp;after&nbsp;RemoveAll&nbsp;(final)&#34;</span><span class="op" id="673902">,</span>&nbsp;<span class="ident" id="673904">path</span><span class="op" id="673908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="673911">}</span><br>
<span class="lineno"></span><span class="op" id="673913">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="673916">func</span>&nbsp;<span class="ident" id="673921">TestMkdirAllWithSymlink</span><span class="op" id="673944">(</span><span class="ident" id="673945">t</span>&nbsp;<span class="op" id="673947">*</span><span class="ident" id="673948">testing</span><span class="op" id="673955">.</span><span class="ident" id="673956">T</span><span class="op" id="673957">)</span>&nbsp;<span class="op" id="673959">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="673962">switch</span>&nbsp;<span class="ident" id="673969">runtime</span><span class="op" id="673976">.</span><span class="ident" id="673977">GOOS</span>&nbsp;<span class="op" id="673982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="673985">case</span>&nbsp;<span class="string" id="673990">&#34;nacl&#34;</span><span class="op" id="673996">,</span>&nbsp;<span class="string" id="673998">&#34;plan9&#34;</span><span class="op" id="674005">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="674009">t</span><span class="op" id="674010">.</span><span class="ident" id="674011">Skipf</span><span class="op" id="674016">(</span><span class="string" id="674017">&#34;skipping&nbsp;on&nbsp;%s&#34;</span><span class="op" id="674033">,</span>&nbsp;<span class="ident" id="674035">runtime</span><span class="op" id="674042">.</span><span class="ident" id="674043">GOOS</span><span class="op" id="674047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="674050">case</span>&nbsp;<span class="string" id="674055">&#34;windows&#34;</span><span class="op" id="674064">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="674068">if</span>&nbsp;<span class="op" id="674071">!</span><span class="ident" id="674072">supportsSymlinks</span>&nbsp;<span class="op" id="674089">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="674094">t</span><span class="op" id="674095">.</span><span class="ident" id="674096">Skipf</span><span class="op" id="674101">(</span><span class="string" id="674102">&#34;skipping&nbsp;on&nbsp;%s&#34;</span><span class="op" id="674118">,</span>&nbsp;<span class="ident" id="674120">runtime</span><span class="op" id="674127">.</span><span class="ident" id="674128">GOOS</span><span class="op" id="674132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="674136">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="674139">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="674143">tmpDir</span><span class="op" id="674149">,</span>&nbsp;<span class="ident" id="674151">err</span>&nbsp;<span class="op" id="674155">:=</span>&nbsp;<span class="ident" id="674158">ioutil</span><span class="op" id="674164">.</span><span class="ident" id="674165">TempDir</span><span class="op" id="674172">(</span><span class="string" id="674173">&#34;&#34;</span><span class="op" id="674175">,</span>&nbsp;<span class="string" id="674177">&#34;TestMkdirAllWithSymlink-&#34;</span><span class="op" id="674203">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="674206">if</span>&nbsp;<span class="ident" id="674209">err</span>&nbsp;<span class="op" id="674213">!=</span>&nbsp;<span class="ident" id="674216">nil</span>&nbsp;<span class="op" id="674220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="674224">t</span><span class="op" id="674225">.</span><span class="ident" id="674226">Fatal</span><span class="op" id="674231">(</span><span class="ident" id="674232">err</span><span class="op" id="674235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="674238">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="674241">defer</span>&nbsp;<span class="ident" id="674247">RemoveAll</span><span class="op" id="674256">(</span><span class="ident" id="674257">tmpDir</span><span class="op" id="674263">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="674267">dir</span>&nbsp;<span class="op" id="674271">:=</span>&nbsp;<span class="ident" id="674274">tmpDir</span>&nbsp;<span class="op" id="674281">+</span>&nbsp;<span class="string" id="674283">&#34;/dir&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="674291">err</span>&nbsp;<span class="op" id="674295">=</span>&nbsp;<span class="ident" id="674297">Mkdir</span><span class="op" id="674302">(</span><span class="ident" id="674303">dir</span><span class="op" id="674306">,</span>&nbsp;<span class="num" id="674308">0755</span><span class="op" id="674312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="674315">if</span>&nbsp;<span class="ident" id="674318">err</span>&nbsp;<span class="op" id="674322">!=</span>&nbsp;<span class="ident" id="674325">nil</span>&nbsp;<span class="op" id="674329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="674333">t</span><span class="op" id="674334">.</span><span class="ident" id="674335">Fatalf</span><span class="op" id="674341">(</span><span class="string" id="674342">&#34;Mkdir&nbsp;%s:&nbsp;%s&#34;</span><span class="op" id="674356">,</span>&nbsp;<span class="ident" id="674358">dir</span><span class="op" id="674361">,</span>&nbsp;<span class="ident" id="674363">err</span><span class="op" id="674366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="674369">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="674373">link</span>&nbsp;<span class="op" id="674378">:=</span>&nbsp;<span class="ident" id="674381">tmpDir</span>&nbsp;<span class="op" id="674388">+</span>&nbsp;<span class="string" id="674390">&#34;/link&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="674399">err</span>&nbsp;<span class="op" id="674403">=</span>&nbsp;<span class="ident" id="674405">Symlink</span><span class="op" id="674412">(</span><span class="string" id="674413">&#34;dir&#34;</span><span class="op" id="674418">,</span>&nbsp;<span class="ident" id="674420">link</span><span class="op" id="674424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="674427">if</span>&nbsp;<span class="ident" id="674430">err</span>&nbsp;<span class="op" id="674434">!=</span>&nbsp;<span class="ident" id="674437">nil</span>&nbsp;<span class="op" id="674441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="674445">t</span><span class="op" id="674446">.</span><span class="ident" id="674447">Fatalf</span><span class="op" id="674453">(</span><span class="string" id="674454">&#34;Symlink&nbsp;%s:&nbsp;%s&#34;</span><span class="op" id="674470">,</span>&nbsp;<span class="ident" id="674472">link</span><span class="op" id="674476">,</span>&nbsp;<span class="ident" id="674478">err</span><span class="op" id="674481">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="674484">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="674488">path</span>&nbsp;<span class="op" id="674493">:=</span>&nbsp;<span class="ident" id="674496">link</span>&nbsp;<span class="op" id="674501">+</span>&nbsp;<span class="string" id="674503">&#34;/foo&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="674511">err</span>&nbsp;<span class="op" id="674515">=</span>&nbsp;<span class="ident" id="674517">MkdirAll</span><span class="op" id="674525">(</span><span class="ident" id="674526">path</span><span class="op" id="674530">,</span>&nbsp;<span class="num" id="674532">0755</span><span class="op" id="674536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="674539">if</span>&nbsp;<span class="ident" id="674542">err</span>&nbsp;<span class="op" id="674546">!=</span>&nbsp;<span class="ident" id="674549">nil</span>&nbsp;<span class="op" id="674553">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="674557">t</span><span class="op" id="674558">.</span><span class="ident" id="674559">Errorf</span><span class="op" id="674565">(</span><span class="string" id="674566">&#34;MkdirAll&nbsp;%q:&nbsp;%s&#34;</span><span class="op" id="674583">,</span>&nbsp;<span class="ident" id="674585">path</span><span class="op" id="674589">,</span>&nbsp;<span class="ident" id="674591">err</span><span class="op" id="674594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="674597">}</span><br>
<span class="lineno"></span><span class="op" id="674599">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="674602">func</span>&nbsp;<span class="ident" id="674607">TestMkdirAllAtSlash</span><span class="op" id="674626">(</span><span class="ident" id="674627">t</span>&nbsp;<span class="op" id="674629">*</span><span class="ident" id="674630">testing</span><span class="op" id="674637">.</span><span class="ident" id="674638">T</span><span class="op" id="674639">)</span>&nbsp;<span class="op" id="674641">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="674644">switch</span>&nbsp;<span class="ident" id="674651">runtime</span><span class="op" id="674658">.</span><span class="ident" id="674659">GOOS</span>&nbsp;<span class="op" id="674664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="674667">case</span>&nbsp;<span class="string" id="674672">&#34;android&#34;</span><span class="op" id="674681">,</span>&nbsp;<span class="string" id="674683">&#34;plan9&#34;</span><span class="op" id="674690">,</span>&nbsp;<span class="string" id="674692">&#34;windows&#34;</span><span class="op" id="674701">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="674705">t</span><span class="op" id="674706">.</span><span class="ident" id="674707">Skipf</span><span class="op" id="674712">(</span><span class="string" id="674713">&#34;skipping&nbsp;on&nbsp;%s&#34;</span><span class="op" id="674729">,</span>&nbsp;<span class="ident" id="674731">runtime</span><span class="op" id="674738">.</span><span class="ident" id="674739">GOOS</span><span class="op" id="674743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="674746">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="674749">RemoveAll</span><span class="op" id="674758">(</span><span class="string" id="674759">&#34;/_go_os_test&#34;</span><span class="op" id="674773">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="674776">err</span>&nbsp;<span class="op" id="674780">:=</span>&nbsp;<span class="ident" id="674783">MkdirAll</span><span class="op" id="674791">(</span><span class="string" id="674792">&#34;/_go_os_test/dir&#34;</span><span class="op" id="674810">,</span>&nbsp;<span class="num" id="674812">0777</span><span class="op" id="674816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="674819">if</span>&nbsp;<span class="ident" id="674822">err</span>&nbsp;<span class="op" id="674826">!=</span>&nbsp;<span class="ident" id="674829">nil</span>&nbsp;<span class="op" id="674833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="674837">pathErr</span><span class="op" id="674844">,</span>&nbsp;<span class="ident" id="674846">ok</span>&nbsp;<span class="op" id="674849">:=</span>&nbsp;<span class="ident" id="674852">err</span><span class="op" id="674855">.</span><span class="op" id="674856">(</span><span class="op" id="674857">*</span><span class="ident" id="674858">PathError</span><span class="op" id="674867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="674871">//&nbsp;common&nbsp;for&nbsp;users&nbsp;not&nbsp;to&nbsp;be&nbsp;able&nbsp;to&nbsp;write&nbsp;to&nbsp;/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="674922">if</span>&nbsp;<span class="ident" id="674925">ok</span>&nbsp;<span class="op" id="674928">&amp;&amp;</span>&nbsp;<span class="ident" id="674931">pathErr</span><span class="op" id="674938">.</span><span class="ident" id="674939">Err</span>&nbsp;<span class="op" id="674943">==</span>&nbsp;<span class="ident" id="674946">syscall</span><span class="op" id="674953">.</span><span class="ident" id="674954">EACCES</span>&nbsp;<span class="op" id="674961">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="674966">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="674975">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="674979">t</span><span class="op" id="674980">.</span><span class="ident" id="674981">Fatalf</span><span class="op" id="674987">(</span><span class="string" id="674988">`MkdirAll&nbsp;&#34;/_go_os_test/dir&#34;:&nbsp;%v`</span><span class="op" id="675021">,</span>&nbsp;<span class="ident" id="675023">err</span><span class="op" id="675026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="675029">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="675032">RemoveAll</span><span class="op" id="675041">(</span><span class="string" id="675042">&#34;/_go_os_test&#34;</span><span class="op" id="675056">)</span><br>
<span class="lineno">220</span><span class="op" id="675058">}</span>
</div>
</body>
</html>
