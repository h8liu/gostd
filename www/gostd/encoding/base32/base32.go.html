<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/base32</h2>
<ul>
<li><a href="/gostd/encoding/base32/base32.go.html">base32.go</a></li>
<li><a href="/gostd/encoding/base32/base32_test.go.html">base32_test.go</a></li>
<li><a href="/gostd/encoding/base32/example_test.go.html">example_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5554762">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5554817">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5554871">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5554922">//&nbsp;Package&nbsp;base32&nbsp;implements&nbsp;base32&nbsp;encoding&nbsp;as&nbsp;specified&nbsp;by&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno"></span><span class="keyword" id="5554993">package</span>&nbsp;<span class="ident" id="5555001">base32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5555009">import</span>&nbsp;<span class="op" id="5555016">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5555019">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5555028">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5555034">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5555045">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="5555055">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="5555058">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Encodings<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5555079">//&nbsp;An&nbsp;Encoding&nbsp;is&nbsp;a&nbsp;radix&nbsp;32&nbsp;encoding/decoding&nbsp;scheme,&nbsp;defined&nbsp;by&nbsp;a</span><br>
<span class="lineno">20</span><span class="comment" id="5555147">//&nbsp;32-character&nbsp;alphabet.&nbsp;&nbsp;The&nbsp;most&nbsp;common&nbsp;is&nbsp;the&nbsp;&#34;base32&#34;&nbsp;encoding</span><br>
<span class="lineno"></span><span class="comment" id="5555215">//&nbsp;introduced&nbsp;for&nbsp;SASL&nbsp;GSSAPI&nbsp;and&nbsp;standardized&nbsp;in&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno"></span><span class="comment" id="5555275">//&nbsp;The&nbsp;alternate&nbsp;&#34;base32hex&#34;&nbsp;encoding&nbsp;is&nbsp;used&nbsp;in&nbsp;DNSSEC.</span><br>
<span class="lineno"></span><span class="keyword" id="5555332">type</span>&nbsp;<span class="ident" id="5555337">Encoding</span>&nbsp;<span class="keyword" id="5555346">struct</span>&nbsp;<span class="op" id="5555353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5555356">encode</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5555366">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5555374">decodeMap</span>&nbsp;<span class="op" id="5555384">[</span><span class="num" id="5555385">256</span><span class="op" id="5555388">]</span><span class="builtintype" id="5555389">byte</span><br>
<span class="lineno"></span><span class="op" id="5555394">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5555397">const</span>&nbsp;<span class="ident" id="5555403">encodeStd</span>&nbsp;<span class="op" id="5555413">=</span>&nbsp;<span class="string" id="5555415">&#34;ABCDEFGHIJKLMNOPQRSTUVWXYZ234567&#34;</span><br>
<span class="lineno"></span><span class="keyword" id="5555450">const</span>&nbsp;<span class="ident" id="5555456">encodeHex</span>&nbsp;<span class="op" id="5555466">=</span>&nbsp;<span class="string" id="5555468">&#34;0123456789ABCDEFGHIJKLMNOPQRSTUV&#34;</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="5555504">//&nbsp;NewEncoding&nbsp;returns&nbsp;a&nbsp;new&nbsp;Encoding&nbsp;defined&nbsp;by&nbsp;the&nbsp;given&nbsp;alphabet,</span><br>
<span class="lineno"></span><span class="comment" id="5555573">//&nbsp;which&nbsp;must&nbsp;be&nbsp;a&nbsp;32-byte&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="5555608">func</span>&nbsp;<span class="ident" id="5555613">NewEncoding</span><span class="op" id="5555624">(</span><span class="ident" id="5555625">encoder</span>&nbsp;<span class="builtintype" id="5555633">string</span><span class="op" id="5555639">)</span>&nbsp;<span class="op" id="5555641">*</span><span class="ident" id="5555642">Encoding</span>&nbsp;<span class="op" id="5555651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5555654">e</span>&nbsp;<span class="op" id="5555656">:=</span>&nbsp;<span class="builtinfunc" id="5555659">new</span><span class="op" id="5555662">(</span><span class="ident" id="5555663">Encoding</span><span class="op" id="5555671">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5555674">e</span><span class="op" id="5555675">.</span><span class="ident" id="5555676">encode</span>&nbsp;<span class="op" id="5555683">=</span>&nbsp;<span class="ident" id="5555685">encoder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5555694">for</span>&nbsp;<span class="ident" id="5555698">i</span>&nbsp;<span class="op" id="5555700">:=</span>&nbsp;<span class="num" id="5555703">0</span><span class="op" id="5555704">;</span>&nbsp;<span class="ident" id="5555706">i</span>&nbsp;<span class="op" id="5555708">&lt;</span>&nbsp;<span class="builtinfunc" id="5555710">len</span><span class="op" id="5555713">(</span><span class="ident" id="5555714">e</span><span class="op" id="5555715">.</span><span class="ident" id="5555716">decodeMap</span><span class="op" id="5555725">)</span><span class="op" id="5555726">;</span>&nbsp;<span class="ident" id="5555728">i</span><span class="op" id="5555729">++</span>&nbsp;<span class="op" id="5555732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5555736">e</span><span class="op" id="5555737">.</span><span class="ident" id="5555738">decodeMap</span><span class="op" id="5555747">[</span><span class="ident" id="5555748">i</span><span class="op" id="5555749">]</span>&nbsp;<span class="op" id="5555751">=</span>&nbsp;<span class="num" id="5555753">0xFF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5555759">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5555762">for</span>&nbsp;<span class="ident" id="5555766">i</span>&nbsp;<span class="op" id="5555768">:=</span>&nbsp;<span class="num" id="5555771">0</span><span class="op" id="5555772">;</span>&nbsp;<span class="ident" id="5555774">i</span>&nbsp;<span class="op" id="5555776">&lt;</span>&nbsp;<span class="builtinfunc" id="5555778">len</span><span class="op" id="5555781">(</span><span class="ident" id="5555782">encoder</span><span class="op" id="5555789">)</span><span class="op" id="5555790">;</span>&nbsp;<span class="ident" id="5555792">i</span><span class="op" id="5555793">++</span>&nbsp;<span class="op" id="5555796">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5555800">e</span><span class="op" id="5555801">.</span><span class="ident" id="5555802">decodeMap</span><span class="op" id="5555811">[</span><span class="ident" id="5555812">encoder</span><span class="op" id="5555819">[</span><span class="ident" id="5555820">i</span><span class="op" id="5555821">]</span><span class="op" id="5555822">]</span>&nbsp;<span class="op" id="5555824">=</span>&nbsp;<span class="builtintype" id="5555826">byte</span><span class="op" id="5555830">(</span><span class="ident" id="5555831">i</span><span class="op" id="5555832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5555835">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5555838">return</span>&nbsp;<span class="ident" id="5555845">e</span><br>
<span class="lineno"></span><span class="op" id="5555847">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="5555850">//&nbsp;StdEncoding&nbsp;is&nbsp;the&nbsp;standard&nbsp;base32&nbsp;encoding,&nbsp;as&nbsp;defined&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="5555912">//&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno"></span><span class="keyword" id="5555925">var</span>&nbsp;<span class="ident" id="5555929">StdEncoding</span>&nbsp;<span class="op" id="5555941">=</span>&nbsp;<span class="ident" id="5555943">NewEncoding</span><span class="op" id="5555954">(</span><span class="ident" id="5555955">encodeStd</span><span class="op" id="5555964">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5555967">//&nbsp;HexEncoding&nbsp;is&nbsp;the&nbsp;``Extended&nbsp;Hex&nbsp;Alphabet&#39;&#39;&nbsp;defined&nbsp;in&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno">50</span><span class="comment" id="5556036">//&nbsp;It&nbsp;is&nbsp;typically&nbsp;used&nbsp;in&nbsp;DNS.</span><br>
<span class="lineno"></span><span class="keyword" id="5556068">var</span>&nbsp;<span class="ident" id="5556072">HexEncoding</span>&nbsp;<span class="op" id="5556084">=</span>&nbsp;<span class="ident" id="5556086">NewEncoding</span><span class="op" id="5556097">(</span><span class="ident" id="5556098">encodeHex</span><span class="op" id="5556107">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5556110">var</span>&nbsp;<span class="ident" id="5556114">removeNewlinesMapper</span>&nbsp;<span class="op" id="5556135">=</span>&nbsp;<span class="keyword" id="5556137">func</span><span class="op" id="5556141">(</span><span class="ident" id="5556142">r</span>&nbsp;<span class="builtintype" id="5556144">rune</span><span class="op" id="5556148">)</span>&nbsp;<span class="builtintype" id="5556150">rune</span>&nbsp;<span class="op" id="5556155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5556158">if</span>&nbsp;<span class="ident" id="5556161">r</span>&nbsp;<span class="op" id="5556163">==</span>&nbsp;<span class="string" id="5556166">&#39;\r&#39;</span>&nbsp;<span class="op" id="5556171">||</span>&nbsp;<span class="ident" id="5556174">r</span>&nbsp;<span class="op" id="5556176">==</span>&nbsp;<span class="string" id="5556179">&#39;\n&#39;</span>&nbsp;<span class="op" id="5556184">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5556188">return</span>&nbsp;<span class="op" id="5556195">-</span><span class="num" id="5556196">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5556199">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5556202">return</span>&nbsp;<span class="ident" id="5556209">r</span><br>
<span class="lineno"></span><span class="op" id="5556211">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="comment" id="5556214">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Encoder<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5556233">//&nbsp;Encode&nbsp;encodes&nbsp;src&nbsp;using&nbsp;the&nbsp;encoding&nbsp;enc,&nbsp;writing</span><br>
<span class="lineno">65</span><span class="comment" id="5556287">//&nbsp;EncodedLen(len(src))&nbsp;bytes&nbsp;to&nbsp;dst.</span><br>
<span class="lineno"></span><span class="comment" id="5556325">//</span><br>
<span class="lineno"></span><span class="comment" id="5556328">//&nbsp;The&nbsp;encoding&nbsp;pads&nbsp;the&nbsp;output&nbsp;to&nbsp;a&nbsp;multiple&nbsp;of&nbsp;8&nbsp;bytes,</span><br>
<span class="lineno"></span><span class="comment" id="5556386">//&nbsp;so&nbsp;Encode&nbsp;is&nbsp;not&nbsp;appropriate&nbsp;for&nbsp;use&nbsp;on&nbsp;individual&nbsp;blocks</span><br>
<span class="lineno"></span><span class="comment" id="5556447">//&nbsp;of&nbsp;a&nbsp;large&nbsp;data&nbsp;stream.&nbsp;&nbsp;Use&nbsp;NewEncoder()&nbsp;instead.</span><br>
<span class="lineno">70</span><span class="keyword" id="5556501">func</span>&nbsp;<span class="op" id="5556506">(</span><span class="ident" id="5556507">enc</span>&nbsp;<span class="op" id="5556511">*</span><span class="ident" id="5556512">Encoding</span><span class="op" id="5556520">)</span>&nbsp;<span class="ident" id="5556522">Encode</span><span class="op" id="5556528">(</span><span class="ident" id="5556529">dst</span><span class="op" id="5556532">,</span>&nbsp;<span class="ident" id="5556534">src</span>&nbsp;<span class="op" id="5556538">[</span><span class="op" id="5556539">]</span><span class="builtintype" id="5556540">byte</span><span class="op" id="5556544">)</span>&nbsp;<span class="op" id="5556546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5556549">if</span>&nbsp;<span class="builtinfunc" id="5556552">len</span><span class="op" id="5556555">(</span><span class="ident" id="5556556">src</span><span class="op" id="5556559">)</span>&nbsp;<span class="op" id="5556561">==</span>&nbsp;<span class="num" id="5556564">0</span>&nbsp;<span class="op" id="5556566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5556570">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5556578">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5556582">for</span>&nbsp;<span class="builtinfunc" id="5556586">len</span><span class="op" id="5556589">(</span><span class="ident" id="5556590">src</span><span class="op" id="5556593">)</span>&nbsp;<span class="op" id="5556595">&gt;</span>&nbsp;<span class="num" id="5556597">0</span>&nbsp;<span class="op" id="5556599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5556603">var</span>&nbsp;<span class="ident" id="5556607">b0</span><span class="op" id="5556609">,</span>&nbsp;<span class="ident" id="5556611">b1</span><span class="op" id="5556613">,</span>&nbsp;<span class="ident" id="5556615">b2</span><span class="op" id="5556617">,</span>&nbsp;<span class="ident" id="5556619">b3</span><span class="op" id="5556621">,</span>&nbsp;<span class="ident" id="5556623">b4</span><span class="op" id="5556625">,</span>&nbsp;<span class="ident" id="5556627">b5</span><span class="op" id="5556629">,</span>&nbsp;<span class="ident" id="5556631">b6</span><span class="op" id="5556633">,</span>&nbsp;<span class="ident" id="5556635">b7</span>&nbsp;<span class="builtintype" id="5556638">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5556646">//&nbsp;Unpack&nbsp;8x&nbsp;5-bit&nbsp;source&nbsp;blocks&nbsp;into&nbsp;a&nbsp;5&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5556695">//&nbsp;destination&nbsp;quantum</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5556720">switch</span>&nbsp;<span class="builtinfunc" id="5556727">len</span><span class="op" id="5556730">(</span><span class="ident" id="5556731">src</span><span class="op" id="5556734">)</span>&nbsp;<span class="op" id="5556736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5556740">default</span><span class="op" id="5556747">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5556752">b7</span>&nbsp;<span class="op" id="5556755">=</span>&nbsp;<span class="ident" id="5556757">src</span><span class="op" id="5556760">[</span><span class="num" id="5556761">4</span><span class="op" id="5556762">]</span>&nbsp;<span class="op" id="5556764">&amp;</span>&nbsp;<span class="num" id="5556766">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5556774">b6</span>&nbsp;<span class="op" id="5556777">=</span>&nbsp;<span class="ident" id="5556779">src</span><span class="op" id="5556782">[</span><span class="num" id="5556783">4</span><span class="op" id="5556784">]</span>&nbsp;<span class="op" id="5556786">&gt;&gt;</span>&nbsp;<span class="num" id="5556789">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5556794">fallthrough</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5556808">case</span>&nbsp;<span class="num" id="5556813">4</span><span class="op" id="5556814">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5556819">b6</span>&nbsp;<span class="op" id="5556822">|=</span>&nbsp;<span class="op" id="5556825">(</span><span class="ident" id="5556826">src</span><span class="op" id="5556829">[</span><span class="num" id="5556830">3</span><span class="op" id="5556831">]</span>&nbsp;<span class="op" id="5556833">&lt;&lt;</span>&nbsp;<span class="num" id="5556836">3</span><span class="op" id="5556837">)</span>&nbsp;<span class="op" id="5556839">&amp;</span>&nbsp;<span class="num" id="5556841">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5556849">b5</span>&nbsp;<span class="op" id="5556852">=</span>&nbsp;<span class="op" id="5556854">(</span><span class="ident" id="5556855">src</span><span class="op" id="5556858">[</span><span class="num" id="5556859">3</span><span class="op" id="5556860">]</span>&nbsp;<span class="op" id="5556862">&gt;&gt;</span>&nbsp;<span class="num" id="5556865">2</span><span class="op" id="5556866">)</span>&nbsp;<span class="op" id="5556868">&amp;</span>&nbsp;<span class="num" id="5556870">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5556878">b4</span>&nbsp;<span class="op" id="5556881">=</span>&nbsp;<span class="ident" id="5556883">src</span><span class="op" id="5556886">[</span><span class="num" id="5556887">3</span><span class="op" id="5556888">]</span>&nbsp;<span class="op" id="5556890">&gt;&gt;</span>&nbsp;<span class="num" id="5556893">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5556898">fallthrough</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5556912">case</span>&nbsp;<span class="num" id="5556917">3</span><span class="op" id="5556918">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5556923">b4</span>&nbsp;<span class="op" id="5556926">|=</span>&nbsp;<span class="op" id="5556929">(</span><span class="ident" id="5556930">src</span><span class="op" id="5556933">[</span><span class="num" id="5556934">2</span><span class="op" id="5556935">]</span>&nbsp;<span class="op" id="5556937">&lt;&lt;</span>&nbsp;<span class="num" id="5556940">1</span><span class="op" id="5556941">)</span>&nbsp;<span class="op" id="5556943">&amp;</span>&nbsp;<span class="num" id="5556945">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5556953">b3</span>&nbsp;<span class="op" id="5556956">=</span>&nbsp;<span class="op" id="5556958">(</span><span class="ident" id="5556959">src</span><span class="op" id="5556962">[</span><span class="num" id="5556963">2</span><span class="op" id="5556964">]</span>&nbsp;<span class="op" id="5556966">&gt;&gt;</span>&nbsp;<span class="num" id="5556969">4</span><span class="op" id="5556970">)</span>&nbsp;<span class="op" id="5556972">&amp;</span>&nbsp;<span class="num" id="5556974">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5556982">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5556996">case</span>&nbsp;<span class="num" id="5557001">2</span><span class="op" id="5557002">:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5557007">b3</span>&nbsp;<span class="op" id="5557010">|=</span>&nbsp;<span class="op" id="5557013">(</span><span class="ident" id="5557014">src</span><span class="op" id="5557017">[</span><span class="num" id="5557018">1</span><span class="op" id="5557019">]</span>&nbsp;<span class="op" id="5557021">&lt;&lt;</span>&nbsp;<span class="num" id="5557024">4</span><span class="op" id="5557025">)</span>&nbsp;<span class="op" id="5557027">&amp;</span>&nbsp;<span class="num" id="5557029">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5557037">b2</span>&nbsp;<span class="op" id="5557040">=</span>&nbsp;<span class="op" id="5557042">(</span><span class="ident" id="5557043">src</span><span class="op" id="5557046">[</span><span class="num" id="5557047">1</span><span class="op" id="5557048">]</span>&nbsp;<span class="op" id="5557050">&gt;&gt;</span>&nbsp;<span class="num" id="5557053">1</span><span class="op" id="5557054">)</span>&nbsp;<span class="op" id="5557056">&amp;</span>&nbsp;<span class="num" id="5557058">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5557066">b1</span>&nbsp;<span class="op" id="5557069">=</span>&nbsp;<span class="op" id="5557071">(</span><span class="ident" id="5557072">src</span><span class="op" id="5557075">[</span><span class="num" id="5557076">1</span><span class="op" id="5557077">]</span>&nbsp;<span class="op" id="5557079">&gt;&gt;</span>&nbsp;<span class="num" id="5557082">6</span><span class="op" id="5557083">)</span>&nbsp;<span class="op" id="5557085">&amp;</span>&nbsp;<span class="num" id="5557087">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5557095">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5557109">case</span>&nbsp;<span class="num" id="5557114">1</span><span class="op" id="5557115">:</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5557120">b1</span>&nbsp;<span class="op" id="5557123">|=</span>&nbsp;<span class="op" id="5557126">(</span><span class="ident" id="5557127">src</span><span class="op" id="5557130">[</span><span class="num" id="5557131">0</span><span class="op" id="5557132">]</span>&nbsp;<span class="op" id="5557134">&lt;&lt;</span>&nbsp;<span class="num" id="5557137">2</span><span class="op" id="5557138">)</span>&nbsp;<span class="op" id="5557140">&amp;</span>&nbsp;<span class="num" id="5557142">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5557150">b0</span>&nbsp;<span class="op" id="5557153">=</span>&nbsp;<span class="ident" id="5557155">src</span><span class="op" id="5557158">[</span><span class="num" id="5557159">0</span><span class="op" id="5557160">]</span>&nbsp;<span class="op" id="5557162">&gt;&gt;</span>&nbsp;<span class="num" id="5557165">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5557169">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5557174">//&nbsp;Encode&nbsp;5-bit&nbsp;blocks&nbsp;using&nbsp;the&nbsp;base32&nbsp;alphabet</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5557225">dst</span><span class="op" id="5557228">[</span><span class="num" id="5557229">0</span><span class="op" id="5557230">]</span>&nbsp;<span class="op" id="5557232">=</span>&nbsp;<span class="ident" id="5557234">enc</span><span class="op" id="5557237">.</span><span class="ident" id="5557238">encode</span><span class="op" id="5557244">[</span><span class="ident" id="5557245">b0</span><span class="op" id="5557247">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5557251">dst</span><span class="op" id="5557254">[</span><span class="num" id="5557255">1</span><span class="op" id="5557256">]</span>&nbsp;<span class="op" id="5557258">=</span>&nbsp;<span class="ident" id="5557260">enc</span><span class="op" id="5557263">.</span><span class="ident" id="5557264">encode</span><span class="op" id="5557270">[</span><span class="ident" id="5557271">b1</span><span class="op" id="5557273">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5557277">dst</span><span class="op" id="5557280">[</span><span class="num" id="5557281">2</span><span class="op" id="5557282">]</span>&nbsp;<span class="op" id="5557284">=</span>&nbsp;<span class="ident" id="5557286">enc</span><span class="op" id="5557289">.</span><span class="ident" id="5557290">encode</span><span class="op" id="5557296">[</span><span class="ident" id="5557297">b2</span><span class="op" id="5557299">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5557303">dst</span><span class="op" id="5557306">[</span><span class="num" id="5557307">3</span><span class="op" id="5557308">]</span>&nbsp;<span class="op" id="5557310">=</span>&nbsp;<span class="ident" id="5557312">enc</span><span class="op" id="5557315">.</span><span class="ident" id="5557316">encode</span><span class="op" id="5557322">[</span><span class="ident" id="5557323">b3</span><span class="op" id="5557325">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5557329">dst</span><span class="op" id="5557332">[</span><span class="num" id="5557333">4</span><span class="op" id="5557334">]</span>&nbsp;<span class="op" id="5557336">=</span>&nbsp;<span class="ident" id="5557338">enc</span><span class="op" id="5557341">.</span><span class="ident" id="5557342">encode</span><span class="op" id="5557348">[</span><span class="ident" id="5557349">b4</span><span class="op" id="5557351">]</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5557355">dst</span><span class="op" id="5557358">[</span><span class="num" id="5557359">5</span><span class="op" id="5557360">]</span>&nbsp;<span class="op" id="5557362">=</span>&nbsp;<span class="ident" id="5557364">enc</span><span class="op" id="5557367">.</span><span class="ident" id="5557368">encode</span><span class="op" id="5557374">[</span><span class="ident" id="5557375">b5</span><span class="op" id="5557377">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5557381">dst</span><span class="op" id="5557384">[</span><span class="num" id="5557385">6</span><span class="op" id="5557386">]</span>&nbsp;<span class="op" id="5557388">=</span>&nbsp;<span class="ident" id="5557390">enc</span><span class="op" id="5557393">.</span><span class="ident" id="5557394">encode</span><span class="op" id="5557400">[</span><span class="ident" id="5557401">b6</span><span class="op" id="5557403">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5557407">dst</span><span class="op" id="5557410">[</span><span class="num" id="5557411">7</span><span class="op" id="5557412">]</span>&nbsp;<span class="op" id="5557414">=</span>&nbsp;<span class="ident" id="5557416">enc</span><span class="op" id="5557419">.</span><span class="ident" id="5557420">encode</span><span class="op" id="5557426">[</span><span class="ident" id="5557427">b7</span><span class="op" id="5557429">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5557434">//&nbsp;Pad&nbsp;the&nbsp;final&nbsp;quantum</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5557461">if</span>&nbsp;<span class="builtinfunc" id="5557464">len</span><span class="op" id="5557467">(</span><span class="ident" id="5557468">src</span><span class="op" id="5557471">)</span>&nbsp;<span class="op" id="5557473">&lt;</span>&nbsp;<span class="num" id="5557475">5</span>&nbsp;<span class="op" id="5557477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5557482">dst</span><span class="op" id="5557485">[</span><span class="num" id="5557486">7</span><span class="op" id="5557487">]</span>&nbsp;<span class="op" id="5557489">=</span>&nbsp;<span class="string" id="5557491">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5557498">if</span>&nbsp;<span class="builtinfunc" id="5557501">len</span><span class="op" id="5557504">(</span><span class="ident" id="5557505">src</span><span class="op" id="5557508">)</span>&nbsp;<span class="op" id="5557510">&lt;</span>&nbsp;<span class="num" id="5557512">4</span>&nbsp;<span class="op" id="5557514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5557520">dst</span><span class="op" id="5557523">[</span><span class="num" id="5557524">6</span><span class="op" id="5557525">]</span>&nbsp;<span class="op" id="5557527">=</span>&nbsp;<span class="string" id="5557529">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5557537">dst</span><span class="op" id="5557540">[</span><span class="num" id="5557541">5</span><span class="op" id="5557542">]</span>&nbsp;<span class="op" id="5557544">=</span>&nbsp;<span class="string" id="5557546">&#39;=&#39;</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5557554">if</span>&nbsp;<span class="builtinfunc" id="5557557">len</span><span class="op" id="5557560">(</span><span class="ident" id="5557561">src</span><span class="op" id="5557564">)</span>&nbsp;<span class="op" id="5557566">&lt;</span>&nbsp;<span class="num" id="5557568">3</span>&nbsp;<span class="op" id="5557570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5557577">dst</span><span class="op" id="5557580">[</span><span class="num" id="5557581">4</span><span class="op" id="5557582">]</span>&nbsp;<span class="op" id="5557584">=</span>&nbsp;<span class="string" id="5557586">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5557595">if</span>&nbsp;<span class="builtinfunc" id="5557598">len</span><span class="op" id="5557601">(</span><span class="ident" id="5557602">src</span><span class="op" id="5557605">)</span>&nbsp;<span class="op" id="5557607">&lt;</span>&nbsp;<span class="num" id="5557609">2</span>&nbsp;<span class="op" id="5557611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5557619">dst</span><span class="op" id="5557622">[</span><span class="num" id="5557623">3</span><span class="op" id="5557624">]</span>&nbsp;<span class="op" id="5557626">=</span>&nbsp;<span class="string" id="5557628">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5557638">dst</span><span class="op" id="5557641">[</span><span class="num" id="5557642">2</span><span class="op" id="5557643">]</span>&nbsp;<span class="op" id="5557645">=</span>&nbsp;<span class="string" id="5557647">&#39;=&#39;</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5557656">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5557662">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5557667">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5557672">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5557680">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5557684">src</span>&nbsp;<span class="op" id="5557688">=</span>&nbsp;<span class="ident" id="5557690">src</span><span class="op" id="5557693">[</span><span class="num" id="5557694">5</span><span class="op" id="5557695">:</span><span class="op" id="5557696">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5557700">dst</span>&nbsp;<span class="op" id="5557704">=</span>&nbsp;<span class="ident" id="5557706">dst</span><span class="op" id="5557709">[</span><span class="num" id="5557710">8</span><span class="op" id="5557711">:</span><span class="op" id="5557712">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5557715">}</span><br>
<span class="lineno"></span><span class="op" id="5557717">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="5557720">//&nbsp;EncodeToString&nbsp;returns&nbsp;the&nbsp;base32&nbsp;encoding&nbsp;of&nbsp;src.</span><br>
<span class="lineno"></span><span class="keyword" id="5557774">func</span>&nbsp;<span class="op" id="5557779">(</span><span class="ident" id="5557780">enc</span>&nbsp;<span class="op" id="5557784">*</span><span class="ident" id="5557785">Encoding</span><span class="op" id="5557793">)</span>&nbsp;<span class="ident" id="5557795">EncodeToString</span><span class="op" id="5557809">(</span><span class="ident" id="5557810">src</span>&nbsp;<span class="op" id="5557814">[</span><span class="op" id="5557815">]</span><span class="builtintype" id="5557816">byte</span><span class="op" id="5557820">)</span>&nbsp;<span class="builtintype" id="5557822">string</span>&nbsp;<span class="op" id="5557829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5557832">buf</span>&nbsp;<span class="op" id="5557836">:=</span>&nbsp;<span class="builtinfunc" id="5557839">make</span><span class="op" id="5557843">(</span><span class="op" id="5557844">[</span><span class="op" id="5557845">]</span><span class="builtintype" id="5557846">byte</span><span class="op" id="5557850">,</span>&nbsp;<span class="ident" id="5557852">enc</span><span class="op" id="5557855">.</span><span class="ident" id="5557856">EncodedLen</span><span class="op" id="5557866">(</span><span class="builtinfunc" id="5557867">len</span><span class="op" id="5557870">(</span><span class="ident" id="5557871">src</span><span class="op" id="5557874">)</span><span class="op" id="5557875">)</span><span class="op" id="5557876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5557879">enc</span><span class="op" id="5557882">.</span><span class="ident" id="5557883">Encode</span><span class="op" id="5557889">(</span><span class="ident" id="5557890">buf</span><span class="op" id="5557893">,</span>&nbsp;<span class="ident" id="5557895">src</span><span class="op" id="5557898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5557901">return</span>&nbsp;<span class="builtintype" id="5557908">string</span><span class="op" id="5557914">(</span><span class="ident" id="5557915">buf</span><span class="op" id="5557918">)</span><br>
<span class="lineno">140</span><span class="op" id="5557920">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5557923">type</span>&nbsp;<span class="ident" id="5557928">encoder</span>&nbsp;<span class="keyword" id="5557936">struct</span>&nbsp;<span class="op" id="5557943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5557946">err</span>&nbsp;&nbsp;<span class="builtintype" id="5557951">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5557958">enc</span>&nbsp;&nbsp;<span class="op" id="5557963">*</span><span class="ident" id="5557964">Encoding</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5557974">w</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5557979">io</span><span class="op" id="5557981">.</span><span class="ident" id="5557982">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5557990">buf</span>&nbsp;&nbsp;<span class="op" id="5557995">[</span><span class="num" id="5557996">5</span><span class="op" id="5557997">]</span><span class="builtintype" id="5557998">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5558006">//&nbsp;buffered&nbsp;data&nbsp;waiting&nbsp;to&nbsp;be&nbsp;encoded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5558046">nbuf</span>&nbsp;<span class="builtintype" id="5558051">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5558062">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;in&nbsp;buf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5558089">out</span>&nbsp;&nbsp;<span class="op" id="5558094">[</span><span class="num" id="5558095">1024</span><span class="op" id="5558099">]</span><span class="builtintype" id="5558100">byte</span>&nbsp;<span class="comment" id="5558105">//&nbsp;output&nbsp;buffer</span><br>
<span class="lineno"></span><span class="op" id="5558122">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="5558125">func</span>&nbsp;<span class="op" id="5558130">(</span><span class="ident" id="5558131">e</span>&nbsp;<span class="op" id="5558133">*</span><span class="ident" id="5558134">encoder</span><span class="op" id="5558141">)</span>&nbsp;<span class="ident" id="5558143">Write</span><span class="op" id="5558148">(</span><span class="ident" id="5558149">p</span>&nbsp;<span class="op" id="5558151">[</span><span class="op" id="5558152">]</span><span class="builtintype" id="5558153">byte</span><span class="op" id="5558157">)</span>&nbsp;<span class="op" id="5558159">(</span><span class="ident" id="5558160">n</span>&nbsp;<span class="builtintype" id="5558162">int</span><span class="op" id="5558165">,</span>&nbsp;<span class="ident" id="5558167">err</span>&nbsp;<span class="builtintype" id="5558171">error</span><span class="op" id="5558176">)</span>&nbsp;<span class="op" id="5558178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5558181">if</span>&nbsp;<span class="ident" id="5558184">e</span><span class="op" id="5558185">.</span><span class="ident" id="5558186">err</span>&nbsp;<span class="op" id="5558190">!=</span>&nbsp;<span class="ident" id="5558193">nil</span>&nbsp;<span class="op" id="5558197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5558201">return</span>&nbsp;<span class="num" id="5558208">0</span><span class="op" id="5558209">,</span>&nbsp;<span class="ident" id="5558211">e</span><span class="op" id="5558212">.</span><span class="ident" id="5558213">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5558218">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5558222">//&nbsp;Leading&nbsp;fringe.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5558242">if</span>&nbsp;<span class="ident" id="5558245">e</span><span class="op" id="5558246">.</span><span class="ident" id="5558247">nbuf</span>&nbsp;<span class="op" id="5558252">&gt;</span>&nbsp;<span class="num" id="5558254">0</span>&nbsp;<span class="op" id="5558256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5558260">var</span>&nbsp;<span class="ident" id="5558264">i</span>&nbsp;<span class="builtintype" id="5558266">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5558272">for</span>&nbsp;<span class="ident" id="5558276">i</span>&nbsp;<span class="op" id="5558278">=</span>&nbsp;<span class="num" id="5558280">0</span><span class="op" id="5558281">;</span>&nbsp;<span class="ident" id="5558283">i</span>&nbsp;<span class="op" id="5558285">&lt;</span>&nbsp;<span class="builtinfunc" id="5558287">len</span><span class="op" id="5558290">(</span><span class="ident" id="5558291">p</span><span class="op" id="5558292">)</span>&nbsp;<span class="op" id="5558294">&amp;&amp;</span>&nbsp;<span class="ident" id="5558297">e</span><span class="op" id="5558298">.</span><span class="ident" id="5558299">nbuf</span>&nbsp;<span class="op" id="5558304">&lt;</span>&nbsp;<span class="num" id="5558306">5</span><span class="op" id="5558307">;</span>&nbsp;<span class="ident" id="5558309">i</span><span class="op" id="5558310">++</span>&nbsp;<span class="op" id="5558313">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5558318">e</span><span class="op" id="5558319">.</span><span class="ident" id="5558320">buf</span><span class="op" id="5558323">[</span><span class="ident" id="5558324">e</span><span class="op" id="5558325">.</span><span class="ident" id="5558326">nbuf</span><span class="op" id="5558330">]</span>&nbsp;<span class="op" id="5558332">=</span>&nbsp;<span class="ident" id="5558334">p</span><span class="op" id="5558335">[</span><span class="ident" id="5558336">i</span><span class="op" id="5558337">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5558342">e</span><span class="op" id="5558343">.</span><span class="ident" id="5558344">nbuf</span><span class="op" id="5558348">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5558353">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5558357">n</span>&nbsp;<span class="op" id="5558359">+=</span>&nbsp;<span class="ident" id="5558362">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5558366">p</span>&nbsp;<span class="op" id="5558368">=</span>&nbsp;<span class="ident" id="5558370">p</span><span class="op" id="5558371">[</span><span class="ident" id="5558372">i</span><span class="op" id="5558373">:</span><span class="op" id="5558374">]</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5558378">if</span>&nbsp;<span class="ident" id="5558381">e</span><span class="op" id="5558382">.</span><span class="ident" id="5558383">nbuf</span>&nbsp;<span class="op" id="5558388">&lt;</span>&nbsp;<span class="num" id="5558390">5</span>&nbsp;<span class="op" id="5558392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5558397">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5558406">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5558410">e</span><span class="op" id="5558411">.</span><span class="ident" id="5558412">enc</span><span class="op" id="5558415">.</span><span class="ident" id="5558416">Encode</span><span class="op" id="5558422">(</span><span class="ident" id="5558423">e</span><span class="op" id="5558424">.</span><span class="ident" id="5558425">out</span><span class="op" id="5558428">[</span><span class="num" id="5558429">0</span><span class="op" id="5558430">:</span><span class="op" id="5558431">]</span><span class="op" id="5558432">,</span>&nbsp;<span class="ident" id="5558434">e</span><span class="op" id="5558435">.</span><span class="ident" id="5558436">buf</span><span class="op" id="5558439">[</span><span class="num" id="5558440">0</span><span class="op" id="5558441">:</span><span class="op" id="5558442">]</span><span class="op" id="5558443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5558447">if</span>&nbsp;<span class="ident" id="5558450">_</span><span class="op" id="5558451">,</span>&nbsp;<span class="ident" id="5558453">e</span><span class="op" id="5558454">.</span><span class="ident" id="5558455">err</span>&nbsp;<span class="op" id="5558459">=</span>&nbsp;<span class="ident" id="5558461">e</span><span class="op" id="5558462">.</span><span class="ident" id="5558463">w</span><span class="op" id="5558464">.</span><span class="ident" id="5558465">Write</span><span class="op" id="5558470">(</span><span class="ident" id="5558471">e</span><span class="op" id="5558472">.</span><span class="ident" id="5558473">out</span><span class="op" id="5558476">[</span><span class="num" id="5558477">0</span><span class="op" id="5558478">:</span><span class="num" id="5558479">8</span><span class="op" id="5558480">]</span><span class="op" id="5558481">)</span><span class="op" id="5558482">;</span>&nbsp;<span class="ident" id="5558484">e</span><span class="op" id="5558485">.</span><span class="ident" id="5558486">err</span>&nbsp;<span class="op" id="5558490">!=</span>&nbsp;<span class="ident" id="5558493">nil</span>&nbsp;<span class="op" id="5558497">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5558502">return</span>&nbsp;<span class="ident" id="5558509">n</span><span class="op" id="5558510">,</span>&nbsp;<span class="ident" id="5558512">e</span><span class="op" id="5558513">.</span><span class="ident" id="5558514">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5558520">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5558524">e</span><span class="op" id="5558525">.</span><span class="ident" id="5558526">nbuf</span>&nbsp;<span class="op" id="5558531">=</span>&nbsp;<span class="num" id="5558533">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5558536">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5558540">//&nbsp;Large&nbsp;interior&nbsp;chunks.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5558567">for</span>&nbsp;<span class="builtinfunc" id="5558571">len</span><span class="op" id="5558574">(</span><span class="ident" id="5558575">p</span><span class="op" id="5558576">)</span>&nbsp;<span class="op" id="5558578">&gt;=</span>&nbsp;<span class="num" id="5558581">5</span>&nbsp;<span class="op" id="5558583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5558587">nn</span>&nbsp;<span class="op" id="5558590">:=</span>&nbsp;<span class="builtinfunc" id="5558593">len</span><span class="op" id="5558596">(</span><span class="ident" id="5558597">e</span><span class="op" id="5558598">.</span><span class="ident" id="5558599">out</span><span class="op" id="5558602">)</span>&nbsp;<span class="op" id="5558604">/</span>&nbsp;<span class="num" id="5558606">8</span>&nbsp;<span class="op" id="5558608">*</span>&nbsp;<span class="num" id="5558610">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5558614">if</span>&nbsp;<span class="ident" id="5558617">nn</span>&nbsp;<span class="op" id="5558620">&gt;</span>&nbsp;<span class="builtinfunc" id="5558622">len</span><span class="op" id="5558625">(</span><span class="ident" id="5558626">p</span><span class="op" id="5558627">)</span>&nbsp;<span class="op" id="5558629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5558634">nn</span>&nbsp;<span class="op" id="5558637">=</span>&nbsp;<span class="builtinfunc" id="5558639">len</span><span class="op" id="5558642">(</span><span class="ident" id="5558643">p</span><span class="op" id="5558644">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5558649">nn</span>&nbsp;<span class="op" id="5558652">-=</span>&nbsp;<span class="ident" id="5558655">nn</span>&nbsp;<span class="op" id="5558658">%</span>&nbsp;<span class="num" id="5558660">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5558664">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5558668">e</span><span class="op" id="5558669">.</span><span class="ident" id="5558670">enc</span><span class="op" id="5558673">.</span><span class="ident" id="5558674">Encode</span><span class="op" id="5558680">(</span><span class="ident" id="5558681">e</span><span class="op" id="5558682">.</span><span class="ident" id="5558683">out</span><span class="op" id="5558686">[</span><span class="num" id="5558687">0</span><span class="op" id="5558688">:</span><span class="op" id="5558689">]</span><span class="op" id="5558690">,</span>&nbsp;<span class="ident" id="5558692">p</span><span class="op" id="5558693">[</span><span class="num" id="5558694">0</span><span class="op" id="5558695">:</span><span class="ident" id="5558696">nn</span><span class="op" id="5558698">]</span><span class="op" id="5558699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5558703">if</span>&nbsp;<span class="ident" id="5558706">_</span><span class="op" id="5558707">,</span>&nbsp;<span class="ident" id="5558709">e</span><span class="op" id="5558710">.</span><span class="ident" id="5558711">err</span>&nbsp;<span class="op" id="5558715">=</span>&nbsp;<span class="ident" id="5558717">e</span><span class="op" id="5558718">.</span><span class="ident" id="5558719">w</span><span class="op" id="5558720">.</span><span class="ident" id="5558721">Write</span><span class="op" id="5558726">(</span><span class="ident" id="5558727">e</span><span class="op" id="5558728">.</span><span class="ident" id="5558729">out</span><span class="op" id="5558732">[</span><span class="num" id="5558733">0</span>&nbsp;<span class="op" id="5558735">:</span>&nbsp;<span class="ident" id="5558737">nn</span><span class="op" id="5558739">/</span><span class="num" id="5558740">5</span><span class="op" id="5558741">*</span><span class="num" id="5558742">8</span><span class="op" id="5558743">]</span><span class="op" id="5558744">)</span><span class="op" id="5558745">;</span>&nbsp;<span class="ident" id="5558747">e</span><span class="op" id="5558748">.</span><span class="ident" id="5558749">err</span>&nbsp;<span class="op" id="5558753">!=</span>&nbsp;<span class="ident" id="5558756">nil</span>&nbsp;<span class="op" id="5558760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5558765">return</span>&nbsp;<span class="ident" id="5558772">n</span><span class="op" id="5558773">,</span>&nbsp;<span class="ident" id="5558775">e</span><span class="op" id="5558776">.</span><span class="ident" id="5558777">err</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5558783">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5558787">n</span>&nbsp;<span class="op" id="5558789">+=</span>&nbsp;<span class="ident" id="5558792">nn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5558797">p</span>&nbsp;<span class="op" id="5558799">=</span>&nbsp;<span class="ident" id="5558801">p</span><span class="op" id="5558802">[</span><span class="ident" id="5558803">nn</span><span class="op" id="5558805">:</span><span class="op" id="5558806">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5558809">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5558813">//&nbsp;Trailing&nbsp;fringe.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5558834">for</span>&nbsp;<span class="ident" id="5558838">i</span>&nbsp;<span class="op" id="5558840">:=</span>&nbsp;<span class="num" id="5558843">0</span><span class="op" id="5558844">;</span>&nbsp;<span class="ident" id="5558846">i</span>&nbsp;<span class="op" id="5558848">&lt;</span>&nbsp;<span class="builtinfunc" id="5558850">len</span><span class="op" id="5558853">(</span><span class="ident" id="5558854">p</span><span class="op" id="5558855">)</span><span class="op" id="5558856">;</span>&nbsp;<span class="ident" id="5558858">i</span><span class="op" id="5558859">++</span>&nbsp;<span class="op" id="5558862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5558866">e</span><span class="op" id="5558867">.</span><span class="ident" id="5558868">buf</span><span class="op" id="5558871">[</span><span class="ident" id="5558872">i</span><span class="op" id="5558873">]</span>&nbsp;<span class="op" id="5558875">=</span>&nbsp;<span class="ident" id="5558877">p</span><span class="op" id="5558878">[</span><span class="ident" id="5558879">i</span><span class="op" id="5558880">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5558883">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5558886">e</span><span class="op" id="5558887">.</span><span class="ident" id="5558888">nbuf</span>&nbsp;<span class="op" id="5558893">=</span>&nbsp;<span class="builtinfunc" id="5558895">len</span><span class="op" id="5558898">(</span><span class="ident" id="5558899">p</span><span class="op" id="5558900">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5558903">n</span>&nbsp;<span class="op" id="5558905">+=</span>&nbsp;<span class="builtinfunc" id="5558908">len</span><span class="op" id="5558911">(</span><span class="ident" id="5558912">p</span><span class="op" id="5558913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5558916">return</span><br>
<span class="lineno"></span><span class="op" id="5558923">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5558926">//&nbsp;Close&nbsp;flushes&nbsp;any&nbsp;pending&nbsp;output&nbsp;from&nbsp;the&nbsp;encoder.</span><br>
<span class="lineno">200</span><span class="comment" id="5558980">//&nbsp;It&nbsp;is&nbsp;an&nbsp;error&nbsp;to&nbsp;call&nbsp;Write&nbsp;after&nbsp;calling&nbsp;Close.</span><br>
<span class="lineno"></span><span class="keyword" id="5559033">func</span>&nbsp;<span class="op" id="5559038">(</span><span class="ident" id="5559039">e</span>&nbsp;<span class="op" id="5559041">*</span><span class="ident" id="5559042">encoder</span><span class="op" id="5559049">)</span>&nbsp;<span class="ident" id="5559051">Close</span><span class="op" id="5559056">(</span><span class="op" id="5559057">)</span>&nbsp;<span class="builtintype" id="5559059">error</span>&nbsp;<span class="op" id="5559065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5559068">//&nbsp;If&nbsp;there&#39;s&nbsp;anything&nbsp;left&nbsp;in&nbsp;the&nbsp;buffer,&nbsp;flush&nbsp;it&nbsp;out</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5559125">if</span>&nbsp;<span class="ident" id="5559128">e</span><span class="op" id="5559129">.</span><span class="ident" id="5559130">err</span>&nbsp;<span class="op" id="5559134">==</span>&nbsp;<span class="ident" id="5559137">nil</span>&nbsp;<span class="op" id="5559141">&amp;&amp;</span>&nbsp;<span class="ident" id="5559144">e</span><span class="op" id="5559145">.</span><span class="ident" id="5559146">nbuf</span>&nbsp;<span class="op" id="5559151">&gt;</span>&nbsp;<span class="num" id="5559153">0</span>&nbsp;<span class="op" id="5559155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5559159">e</span><span class="op" id="5559160">.</span><span class="ident" id="5559161">enc</span><span class="op" id="5559164">.</span><span class="ident" id="5559165">Encode</span><span class="op" id="5559171">(</span><span class="ident" id="5559172">e</span><span class="op" id="5559173">.</span><span class="ident" id="5559174">out</span><span class="op" id="5559177">[</span><span class="num" id="5559178">0</span><span class="op" id="5559179">:</span><span class="op" id="5559180">]</span><span class="op" id="5559181">,</span>&nbsp;<span class="ident" id="5559183">e</span><span class="op" id="5559184">.</span><span class="ident" id="5559185">buf</span><span class="op" id="5559188">[</span><span class="num" id="5559189">0</span><span class="op" id="5559190">:</span><span class="ident" id="5559191">e</span><span class="op" id="5559192">.</span><span class="ident" id="5559193">nbuf</span><span class="op" id="5559197">]</span><span class="op" id="5559198">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5559202">e</span><span class="op" id="5559203">.</span><span class="ident" id="5559204">nbuf</span>&nbsp;<span class="op" id="5559209">=</span>&nbsp;<span class="num" id="5559211">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5559215">_</span><span class="op" id="5559216">,</span>&nbsp;<span class="ident" id="5559218">e</span><span class="op" id="5559219">.</span><span class="ident" id="5559220">err</span>&nbsp;<span class="op" id="5559224">=</span>&nbsp;<span class="ident" id="5559226">e</span><span class="op" id="5559227">.</span><span class="ident" id="5559228">w</span><span class="op" id="5559229">.</span><span class="ident" id="5559230">Write</span><span class="op" id="5559235">(</span><span class="ident" id="5559236">e</span><span class="op" id="5559237">.</span><span class="ident" id="5559238">out</span><span class="op" id="5559241">[</span><span class="num" id="5559242">0</span><span class="op" id="5559243">:</span><span class="num" id="5559244">8</span><span class="op" id="5559245">]</span><span class="op" id="5559246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5559249">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5559252">return</span>&nbsp;<span class="ident" id="5559259">e</span><span class="op" id="5559260">.</span><span class="ident" id="5559261">err</span><br>
<span class="lineno"></span><span class="op" id="5559265">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="comment" id="5559268">//&nbsp;NewEncoder&nbsp;returns&nbsp;a&nbsp;new&nbsp;base32&nbsp;stream&nbsp;encoder.&nbsp;&nbsp;Data&nbsp;written&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5559336">//&nbsp;the&nbsp;returned&nbsp;writer&nbsp;will&nbsp;be&nbsp;encoded&nbsp;using&nbsp;enc&nbsp;and&nbsp;then&nbsp;written&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="comment" id="5559408">//&nbsp;Base32&nbsp;encodings&nbsp;operate&nbsp;in&nbsp;5-byte&nbsp;blocks;&nbsp;when&nbsp;finished</span><br>
<span class="lineno"></span><span class="comment" id="5559468">//&nbsp;writing,&nbsp;the&nbsp;caller&nbsp;must&nbsp;Close&nbsp;the&nbsp;returned&nbsp;encoder&nbsp;to&nbsp;flush&nbsp;any</span><br>
<span class="lineno">215</span><span class="comment" id="5559536">//&nbsp;partially&nbsp;written&nbsp;blocks.</span><br>
<span class="lineno"></span><span class="keyword" id="5559565">func</span>&nbsp;<span class="ident" id="5559570">NewEncoder</span><span class="op" id="5559580">(</span><span class="ident" id="5559581">enc</span>&nbsp;<span class="op" id="5559585">*</span><span class="ident" id="5559586">Encoding</span><span class="op" id="5559594">,</span>&nbsp;<span class="ident" id="5559596">w</span>&nbsp;<span class="ident" id="5559598">io</span><span class="op" id="5559600">.</span><span class="ident" id="5559601">Writer</span><span class="op" id="5559607">)</span>&nbsp;<span class="ident" id="5559609">io</span><span class="op" id="5559611">.</span><span class="ident" id="5559612">WriteCloser</span>&nbsp;<span class="op" id="5559624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5559627">return</span>&nbsp;<span class="op" id="5559634">&amp;</span><span class="ident" id="5559635">encoder</span><span class="op" id="5559642">{</span><span class="ident" id="5559643">enc</span><span class="op" id="5559646">:</span>&nbsp;<span class="ident" id="5559648">enc</span><span class="op" id="5559651">,</span>&nbsp;<span class="ident" id="5559653">w</span><span class="op" id="5559654">:</span>&nbsp;<span class="ident" id="5559656">w</span><span class="op" id="5559657">}</span><br>
<span class="lineno"></span><span class="op" id="5559659">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="5559662">//&nbsp;EncodedLen&nbsp;returns&nbsp;the&nbsp;length&nbsp;in&nbsp;bytes&nbsp;of&nbsp;the&nbsp;base32&nbsp;encoding</span><br>
<span class="lineno"></span><span class="comment" id="5559727">//&nbsp;of&nbsp;an&nbsp;input&nbsp;buffer&nbsp;of&nbsp;length&nbsp;n.</span><br>
<span class="lineno"></span><span class="keyword" id="5559762">func</span>&nbsp;<span class="op" id="5559767">(</span><span class="ident" id="5559768">enc</span>&nbsp;<span class="op" id="5559772">*</span><span class="ident" id="5559773">Encoding</span><span class="op" id="5559781">)</span>&nbsp;<span class="ident" id="5559783">EncodedLen</span><span class="op" id="5559793">(</span><span class="ident" id="5559794">n</span>&nbsp;<span class="builtintype" id="5559796">int</span><span class="op" id="5559799">)</span>&nbsp;<span class="builtintype" id="5559801">int</span>&nbsp;<span class="op" id="5559805">{</span>&nbsp;<span class="keyword" id="5559807">return</span>&nbsp;<span class="op" id="5559814">(</span><span class="ident" id="5559815">n</span>&nbsp;<span class="op" id="5559817">+</span>&nbsp;<span class="num" id="5559819">4</span><span class="op" id="5559820">)</span>&nbsp;<span class="op" id="5559822">/</span>&nbsp;<span class="num" id="5559824">5</span>&nbsp;<span class="op" id="5559826">*</span>&nbsp;<span class="num" id="5559828">8</span>&nbsp;<span class="op" id="5559830">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5559833">/*<br>
<span class="lineno">225</span>&nbsp;*&nbsp;Decoder<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5559852">type</span>&nbsp;<span class="ident" id="5559857">CorruptInputError</span>&nbsp;<span class="ident" id="5559875">int64</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span><span class="keyword" id="5559882">func</span>&nbsp;<span class="op" id="5559887">(</span><span class="ident" id="5559888">e</span>&nbsp;<span class="ident" id="5559890">CorruptInputError</span><span class="op" id="5559907">)</span>&nbsp;<span class="ident" id="5559909">Error</span><span class="op" id="5559914">(</span><span class="op" id="5559915">)</span>&nbsp;<span class="builtintype" id="5559917">string</span>&nbsp;<span class="op" id="5559924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5559927">return</span>&nbsp;<span class="string" id="5559934">&#34;illegal&nbsp;base32&nbsp;data&nbsp;at&nbsp;input&nbsp;byte&nbsp;&#34;</span>&nbsp;<span class="op" id="5559971">+</span>&nbsp;<span class="ident" id="5559973">strconv</span><span class="op" id="5559980">.</span><span class="ident" id="5559981">FormatInt</span><span class="op" id="5559990">(</span><span class="ident" id="5559991">int64</span><span class="op" id="5559996">(</span><span class="ident" id="5559997">e</span><span class="op" id="5559998">)</span><span class="op" id="5559999">,</span>&nbsp;<span class="num" id="5560001">10</span><span class="op" id="5560003">)</span><br>
<span class="lineno"></span><span class="op" id="5560005">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5560008">//&nbsp;decode&nbsp;is&nbsp;like&nbsp;Decode&nbsp;but&nbsp;returns&nbsp;an&nbsp;additional&nbsp;&#39;end&#39;&nbsp;value,&nbsp;which</span><br>
<span class="lineno">235</span><span class="comment" id="5560078">//&nbsp;indicates&nbsp;if&nbsp;end-of-message&nbsp;padding&nbsp;was&nbsp;encountered&nbsp;and&nbsp;thus&nbsp;any</span><br>
<span class="lineno"></span><span class="comment" id="5560146">//&nbsp;additional&nbsp;data&nbsp;is&nbsp;an&nbsp;error.&nbsp;This&nbsp;method&nbsp;assumes&nbsp;that&nbsp;src&nbsp;has&nbsp;been</span><br>
<span class="lineno"></span><span class="comment" id="5560216">//&nbsp;stripped&nbsp;of&nbsp;all&nbsp;supported&nbsp;whitespace&nbsp;(&#39;\r&#39;&nbsp;and&nbsp;&#39;\n&#39;).</span><br>
<span class="lineno"></span><span class="keyword" id="5560273">func</span>&nbsp;<span class="op" id="5560278">(</span><span class="ident" id="5560279">enc</span>&nbsp;<span class="op" id="5560283">*</span><span class="ident" id="5560284">Encoding</span><span class="op" id="5560292">)</span>&nbsp;<span class="ident" id="5560294">decode</span><span class="op" id="5560300">(</span><span class="ident" id="5560301">dst</span><span class="op" id="5560304">,</span>&nbsp;<span class="ident" id="5560306">src</span>&nbsp;<span class="op" id="5560310">[</span><span class="op" id="5560311">]</span><span class="builtintype" id="5560312">byte</span><span class="op" id="5560316">)</span>&nbsp;<span class="op" id="5560318">(</span><span class="ident" id="5560319">n</span>&nbsp;<span class="builtintype" id="5560321">int</span><span class="op" id="5560324">,</span>&nbsp;<span class="ident" id="5560326">end</span>&nbsp;<span class="builtintype" id="5560330">bool</span><span class="op" id="5560334">,</span>&nbsp;<span class="ident" id="5560336">err</span>&nbsp;<span class="builtintype" id="5560340">error</span><span class="op" id="5560345">)</span>&nbsp;<span class="op" id="5560347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5560350">olen</span>&nbsp;<span class="op" id="5560355">:=</span>&nbsp;<span class="builtinfunc" id="5560358">len</span><span class="op" id="5560361">(</span><span class="ident" id="5560362">src</span><span class="op" id="5560365">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5560368">for</span>&nbsp;<span class="builtinfunc" id="5560372">len</span><span class="op" id="5560375">(</span><span class="ident" id="5560376">src</span><span class="op" id="5560379">)</span>&nbsp;<span class="op" id="5560381">&gt;</span>&nbsp;<span class="num" id="5560383">0</span>&nbsp;<span class="op" id="5560385">&amp;&amp;</span>&nbsp;<span class="op" id="5560388">!</span><span class="ident" id="5560389">end</span>&nbsp;<span class="op" id="5560393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5560397">//&nbsp;Decode&nbsp;quantum&nbsp;using&nbsp;the&nbsp;base32&nbsp;alphabet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5560443">var</span>&nbsp;<span class="ident" id="5560447">dbuf</span>&nbsp;<span class="op" id="5560452">[</span><span class="num" id="5560453">8</span><span class="op" id="5560454">]</span><span class="builtintype" id="5560455">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5560462">dlen</span>&nbsp;<span class="op" id="5560467">:=</span>&nbsp;<span class="num" id="5560470">8</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5560475">for</span>&nbsp;<span class="ident" id="5560479">j</span>&nbsp;<span class="op" id="5560481">:=</span>&nbsp;<span class="num" id="5560484">0</span><span class="op" id="5560485">;</span>&nbsp;<span class="ident" id="5560487">j</span>&nbsp;<span class="op" id="5560489">&lt;</span>&nbsp;<span class="num" id="5560491">8</span><span class="op" id="5560492">;</span>&nbsp;<span class="op" id="5560494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5560499">if</span>&nbsp;<span class="builtinfunc" id="5560502">len</span><span class="op" id="5560505">(</span><span class="ident" id="5560506">src</span><span class="op" id="5560509">)</span>&nbsp;<span class="op" id="5560511">==</span>&nbsp;<span class="num" id="5560514">0</span>&nbsp;<span class="op" id="5560516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5560522">return</span>&nbsp;<span class="ident" id="5560529">n</span><span class="op" id="5560530">,</span>&nbsp;<span class="builtintype" id="5560532">false</span><span class="op" id="5560537">,</span>&nbsp;<span class="ident" id="5560539">CorruptInputError</span><span class="op" id="5560556">(</span><span class="ident" id="5560557">olen</span>&nbsp;<span class="op" id="5560562">-</span>&nbsp;<span class="builtinfunc" id="5560564">len</span><span class="op" id="5560567">(</span><span class="ident" id="5560568">src</span><span class="op" id="5560571">)</span>&nbsp;<span class="op" id="5560573">-</span>&nbsp;<span class="ident" id="5560575">j</span><span class="op" id="5560576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5560581">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5560586">in</span>&nbsp;<span class="op" id="5560589">:=</span>&nbsp;<span class="ident" id="5560592">src</span><span class="op" id="5560595">[</span><span class="num" id="5560596">0</span><span class="op" id="5560597">]</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5560602">src</span>&nbsp;<span class="op" id="5560606">=</span>&nbsp;<span class="ident" id="5560608">src</span><span class="op" id="5560611">[</span><span class="num" id="5560612">1</span><span class="op" id="5560613">:</span><span class="op" id="5560614">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5560619">if</span>&nbsp;<span class="ident" id="5560622">in</span>&nbsp;<span class="op" id="5560625">==</span>&nbsp;<span class="string" id="5560628">&#39;=&#39;</span>&nbsp;<span class="op" id="5560632">&amp;&amp;</span>&nbsp;<span class="ident" id="5560635">j</span>&nbsp;<span class="op" id="5560637">&gt;=</span>&nbsp;<span class="num" id="5560640">2</span>&nbsp;<span class="op" id="5560642">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="5560645">len</span><span class="op" id="5560648">(</span><span class="ident" id="5560649">src</span><span class="op" id="5560652">)</span>&nbsp;<span class="op" id="5560654">&lt;</span>&nbsp;<span class="num" id="5560656">8</span>&nbsp;<span class="op" id="5560658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5560664">//&nbsp;We&#39;ve&nbsp;reached&nbsp;the&nbsp;end&nbsp;and&nbsp;there&#39;s&nbsp;padding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5560713">if</span>&nbsp;<span class="builtinfunc" id="5560716">len</span><span class="op" id="5560719">(</span><span class="ident" id="5560720">src</span><span class="op" id="5560723">)</span><span class="op" id="5560724">+</span><span class="ident" id="5560725">j</span>&nbsp;<span class="op" id="5560727">&lt;</span>&nbsp;<span class="num" id="5560729">8</span><span class="op" id="5560730">-</span><span class="num" id="5560731">1</span>&nbsp;<span class="op" id="5560733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5560740">//&nbsp;not&nbsp;enough&nbsp;padding</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5560767">return</span>&nbsp;<span class="ident" id="5560774">n</span><span class="op" id="5560775">,</span>&nbsp;<span class="builtintype" id="5560777">false</span><span class="op" id="5560782">,</span>&nbsp;<span class="ident" id="5560784">CorruptInputError</span><span class="op" id="5560801">(</span><span class="ident" id="5560802">olen</span><span class="op" id="5560806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5560812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5560818">for</span>&nbsp;<span class="ident" id="5560822">k</span>&nbsp;<span class="op" id="5560824">:=</span>&nbsp;<span class="num" id="5560827">0</span><span class="op" id="5560828">;</span>&nbsp;<span class="ident" id="5560830">k</span>&nbsp;<span class="op" id="5560832">&lt;</span>&nbsp;<span class="num" id="5560834">8</span><span class="op" id="5560835">-</span><span class="num" id="5560836">1</span><span class="op" id="5560837">-</span><span class="ident" id="5560838">j</span><span class="op" id="5560839">;</span>&nbsp;<span class="ident" id="5560841">k</span><span class="op" id="5560842">++</span>&nbsp;<span class="op" id="5560845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5560852">if</span>&nbsp;<span class="builtinfunc" id="5560855">len</span><span class="op" id="5560858">(</span><span class="ident" id="5560859">src</span><span class="op" id="5560862">)</span>&nbsp;<span class="op" id="5560864">&gt;</span>&nbsp;<span class="ident" id="5560866">k</span>&nbsp;<span class="op" id="5560868">&amp;&amp;</span>&nbsp;<span class="ident" id="5560871">src</span><span class="op" id="5560874">[</span><span class="ident" id="5560875">k</span><span class="op" id="5560876">]</span>&nbsp;<span class="op" id="5560878">!=</span>&nbsp;<span class="string" id="5560881">&#39;=&#39;</span>&nbsp;<span class="op" id="5560885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5560893">//&nbsp;incorrect&nbsp;padding</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5560920">return</span>&nbsp;<span class="ident" id="5560927">n</span><span class="op" id="5560928">,</span>&nbsp;<span class="builtintype" id="5560930">false</span><span class="op" id="5560935">,</span>&nbsp;<span class="ident" id="5560937">CorruptInputError</span><span class="op" id="5560954">(</span><span class="ident" id="5560955">olen</span>&nbsp;<span class="op" id="5560960">-</span>&nbsp;<span class="builtinfunc" id="5560962">len</span><span class="op" id="5560965">(</span><span class="ident" id="5560966">src</span><span class="op" id="5560969">)</span>&nbsp;<span class="op" id="5560971">+</span>&nbsp;<span class="ident" id="5560973">k</span>&nbsp;<span class="op" id="5560975">-</span>&nbsp;<span class="num" id="5560977">1</span><span class="op" id="5560978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5560985">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5560991">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5560997">dlen</span><span class="op" id="5561001">,</span>&nbsp;<span class="ident" id="5561003">end</span>&nbsp;<span class="op" id="5561007">=</span>&nbsp;<span class="ident" id="5561009">j</span><span class="op" id="5561010">,</span>&nbsp;<span class="builtintype" id="5561012">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5561021">//&nbsp;7,&nbsp;5&nbsp;and&nbsp;2&nbsp;are&nbsp;not&nbsp;valid&nbsp;padding&nbsp;lengths,&nbsp;and&nbsp;so&nbsp;1,&nbsp;3&nbsp;and&nbsp;6&nbsp;are&nbsp;not</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5561096">//&nbsp;valid&nbsp;dlen&nbsp;values.&nbsp;See&nbsp;RFC&nbsp;4648&nbsp;Section&nbsp;6&nbsp;&#34;Base&nbsp;32&nbsp;Encoding&#34;&nbsp;listing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5561172">//&nbsp;the&nbsp;five&nbsp;valid&nbsp;padding&nbsp;lengths,&nbsp;and&nbsp;Section&nbsp;9&nbsp;&#34;Illustrations&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5561244">//&nbsp;Examples&#34;&nbsp;for&nbsp;an&nbsp;illustration&nbsp;for&nbsp;how&nbsp;the&nbsp;1st,&nbsp;3rd&nbsp;and&nbsp;6th&nbsp;base32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5561317">//&nbsp;src&nbsp;bytes&nbsp;do&nbsp;not&nbsp;yield&nbsp;enough&nbsp;information&nbsp;to&nbsp;decode&nbsp;a&nbsp;dst&nbsp;byte.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5561388">if</span>&nbsp;<span class="ident" id="5561391">dlen</span>&nbsp;<span class="op" id="5561396">==</span>&nbsp;<span class="num" id="5561399">1</span>&nbsp;<span class="op" id="5561401">||</span>&nbsp;<span class="ident" id="5561404">dlen</span>&nbsp;<span class="op" id="5561409">==</span>&nbsp;<span class="num" id="5561412">3</span>&nbsp;<span class="op" id="5561414">||</span>&nbsp;<span class="ident" id="5561417">dlen</span>&nbsp;<span class="op" id="5561422">==</span>&nbsp;<span class="num" id="5561425">6</span>&nbsp;<span class="op" id="5561427">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5561434">return</span>&nbsp;<span class="ident" id="5561441">n</span><span class="op" id="5561442">,</span>&nbsp;<span class="builtintype" id="5561444">false</span><span class="op" id="5561449">,</span>&nbsp;<span class="ident" id="5561451">CorruptInputError</span><span class="op" id="5561468">(</span><span class="ident" id="5561469">olen</span>&nbsp;<span class="op" id="5561474">-</span>&nbsp;<span class="builtinfunc" id="5561476">len</span><span class="op" id="5561479">(</span><span class="ident" id="5561480">src</span><span class="op" id="5561483">)</span>&nbsp;<span class="op" id="5561485">-</span>&nbsp;<span class="num" id="5561487">1</span><span class="op" id="5561488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5561494">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5561500">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5561509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5561514">dbuf</span><span class="op" id="5561518">[</span><span class="ident" id="5561519">j</span><span class="op" id="5561520">]</span>&nbsp;<span class="op" id="5561522">=</span>&nbsp;<span class="ident" id="5561524">enc</span><span class="op" id="5561527">.</span><span class="ident" id="5561528">decodeMap</span><span class="op" id="5561537">[</span><span class="ident" id="5561538">in</span><span class="op" id="5561540">]</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5561545">if</span>&nbsp;<span class="ident" id="5561548">dbuf</span><span class="op" id="5561552">[</span><span class="ident" id="5561553">j</span><span class="op" id="5561554">]</span>&nbsp;<span class="op" id="5561556">==</span>&nbsp;<span class="num" id="5561559">0xFF</span>&nbsp;<span class="op" id="5561564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5561570">return</span>&nbsp;<span class="ident" id="5561577">n</span><span class="op" id="5561578">,</span>&nbsp;<span class="builtintype" id="5561580">false</span><span class="op" id="5561585">,</span>&nbsp;<span class="ident" id="5561587">CorruptInputError</span><span class="op" id="5561604">(</span><span class="ident" id="5561605">olen</span>&nbsp;<span class="op" id="5561610">-</span>&nbsp;<span class="builtinfunc" id="5561612">len</span><span class="op" id="5561615">(</span><span class="ident" id="5561616">src</span><span class="op" id="5561619">)</span>&nbsp;<span class="op" id="5561621">-</span>&nbsp;<span class="num" id="5561623">1</span><span class="op" id="5561624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5561629">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5561634">j</span><span class="op" id="5561635">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5561640">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5561645">//&nbsp;Pack&nbsp;8x&nbsp;5-bit&nbsp;source&nbsp;blocks&nbsp;into&nbsp;5&nbsp;byte&nbsp;destination</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5561702">//&nbsp;quantum</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5561715">switch</span>&nbsp;<span class="ident" id="5561722">dlen</span>&nbsp;<span class="op" id="5561727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5561731">case</span>&nbsp;<span class="num" id="5561736">8</span><span class="op" id="5561737">:</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5561742">dst</span><span class="op" id="5561745">[</span><span class="num" id="5561746">4</span><span class="op" id="5561747">]</span>&nbsp;<span class="op" id="5561749">=</span>&nbsp;<span class="ident" id="5561751">dbuf</span><span class="op" id="5561755">[</span><span class="num" id="5561756">6</span><span class="op" id="5561757">]</span><span class="op" id="5561758">&lt;&lt;</span><span class="num" id="5561760">5</span>&nbsp;<span class="op" id="5561762">|</span>&nbsp;<span class="ident" id="5561764">dbuf</span><span class="op" id="5561768">[</span><span class="num" id="5561769">7</span><span class="op" id="5561770">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5561775">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5561789">case</span>&nbsp;<span class="num" id="5561794">7</span><span class="op" id="5561795">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5561800">dst</span><span class="op" id="5561803">[</span><span class="num" id="5561804">3</span><span class="op" id="5561805">]</span>&nbsp;<span class="op" id="5561807">=</span>&nbsp;<span class="ident" id="5561809">dbuf</span><span class="op" id="5561813">[</span><span class="num" id="5561814">4</span><span class="op" id="5561815">]</span><span class="op" id="5561816">&lt;&lt;</span><span class="num" id="5561818">7</span>&nbsp;<span class="op" id="5561820">|</span>&nbsp;<span class="ident" id="5561822">dbuf</span><span class="op" id="5561826">[</span><span class="num" id="5561827">5</span><span class="op" id="5561828">]</span><span class="op" id="5561829">&lt;&lt;</span><span class="num" id="5561831">2</span>&nbsp;<span class="op" id="5561833">|</span>&nbsp;<span class="ident" id="5561835">dbuf</span><span class="op" id="5561839">[</span><span class="num" id="5561840">6</span><span class="op" id="5561841">]</span><span class="op" id="5561842">&gt;&gt;</span><span class="num" id="5561844">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5561849">fallthrough</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5561863">case</span>&nbsp;<span class="num" id="5561868">5</span><span class="op" id="5561869">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5561874">dst</span><span class="op" id="5561877">[</span><span class="num" id="5561878">2</span><span class="op" id="5561879">]</span>&nbsp;<span class="op" id="5561881">=</span>&nbsp;<span class="ident" id="5561883">dbuf</span><span class="op" id="5561887">[</span><span class="num" id="5561888">3</span><span class="op" id="5561889">]</span><span class="op" id="5561890">&lt;&lt;</span><span class="num" id="5561892">4</span>&nbsp;<span class="op" id="5561894">|</span>&nbsp;<span class="ident" id="5561896">dbuf</span><span class="op" id="5561900">[</span><span class="num" id="5561901">4</span><span class="op" id="5561902">]</span><span class="op" id="5561903">&gt;&gt;</span><span class="num" id="5561905">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5561910">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5561924">case</span>&nbsp;<span class="num" id="5561929">4</span><span class="op" id="5561930">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5561935">dst</span><span class="op" id="5561938">[</span><span class="num" id="5561939">1</span><span class="op" id="5561940">]</span>&nbsp;<span class="op" id="5561942">=</span>&nbsp;<span class="ident" id="5561944">dbuf</span><span class="op" id="5561948">[</span><span class="num" id="5561949">1</span><span class="op" id="5561950">]</span><span class="op" id="5561951">&lt;&lt;</span><span class="num" id="5561953">6</span>&nbsp;<span class="op" id="5561955">|</span>&nbsp;<span class="ident" id="5561957">dbuf</span><span class="op" id="5561961">[</span><span class="num" id="5561962">2</span><span class="op" id="5561963">]</span><span class="op" id="5561964">&lt;&lt;</span><span class="num" id="5561966">1</span>&nbsp;<span class="op" id="5561968">|</span>&nbsp;<span class="ident" id="5561970">dbuf</span><span class="op" id="5561974">[</span><span class="num" id="5561975">3</span><span class="op" id="5561976">]</span><span class="op" id="5561977">&gt;&gt;</span><span class="num" id="5561979">4</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5561984">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5561998">case</span>&nbsp;<span class="num" id="5562003">2</span><span class="op" id="5562004">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5562009">dst</span><span class="op" id="5562012">[</span><span class="num" id="5562013">0</span><span class="op" id="5562014">]</span>&nbsp;<span class="op" id="5562016">=</span>&nbsp;<span class="ident" id="5562018">dbuf</span><span class="op" id="5562022">[</span><span class="num" id="5562023">0</span><span class="op" id="5562024">]</span><span class="op" id="5562025">&lt;&lt;</span><span class="num" id="5562027">3</span>&nbsp;<span class="op" id="5562029">|</span>&nbsp;<span class="ident" id="5562031">dbuf</span><span class="op" id="5562035">[</span><span class="num" id="5562036">1</span><span class="op" id="5562037">]</span><span class="op" id="5562038">&gt;&gt;</span><span class="num" id="5562040">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5562044">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5562048">dst</span>&nbsp;<span class="op" id="5562052">=</span>&nbsp;<span class="ident" id="5562054">dst</span><span class="op" id="5562057">[</span><span class="num" id="5562058">5</span><span class="op" id="5562059">:</span><span class="op" id="5562060">]</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5562064">switch</span>&nbsp;<span class="ident" id="5562071">dlen</span>&nbsp;<span class="op" id="5562076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5562080">case</span>&nbsp;<span class="num" id="5562085">2</span><span class="op" id="5562086">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5562091">n</span>&nbsp;<span class="op" id="5562093">+=</span>&nbsp;<span class="num" id="5562096">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5562100">case</span>&nbsp;<span class="num" id="5562105">4</span><span class="op" id="5562106">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5562111">n</span>&nbsp;<span class="op" id="5562113">+=</span>&nbsp;<span class="num" id="5562116">2</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5562120">case</span>&nbsp;<span class="num" id="5562125">5</span><span class="op" id="5562126">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5562131">n</span>&nbsp;<span class="op" id="5562133">+=</span>&nbsp;<span class="num" id="5562136">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5562140">case</span>&nbsp;<span class="num" id="5562145">7</span><span class="op" id="5562146">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5562151">n</span>&nbsp;<span class="op" id="5562153">+=</span>&nbsp;<span class="num" id="5562156">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5562160">case</span>&nbsp;<span class="num" id="5562165">8</span><span class="op" id="5562166">:</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5562171">n</span>&nbsp;<span class="op" id="5562173">+=</span>&nbsp;<span class="num" id="5562176">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5562180">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5562183">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5562186">return</span>&nbsp;<span class="ident" id="5562193">n</span><span class="op" id="5562194">,</span>&nbsp;<span class="ident" id="5562196">end</span><span class="op" id="5562199">,</span>&nbsp;<span class="ident" id="5562201">nil</span><br>
<span class="lineno"></span><span class="op" id="5562205">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="comment" id="5562208">//&nbsp;Decode&nbsp;decodes&nbsp;src&nbsp;using&nbsp;the&nbsp;encoding&nbsp;enc.&nbsp;&nbsp;It&nbsp;writes&nbsp;at&nbsp;most</span><br>
<span class="lineno"></span><span class="comment" id="5562273">//&nbsp;DecodedLen(len(src))&nbsp;bytes&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno"></span><span class="comment" id="5562342">//&nbsp;written.&nbsp;&nbsp;If&nbsp;src&nbsp;contains&nbsp;invalid&nbsp;base32&nbsp;data,&nbsp;it&nbsp;will&nbsp;return&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5562411">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;successfully&nbsp;written&nbsp;and&nbsp;CorruptInputError.</span><br>
<span class="lineno">320</span><span class="comment" id="5562474">//&nbsp;New&nbsp;line&nbsp;characters&nbsp;(\r&nbsp;and&nbsp;\n)&nbsp;are&nbsp;ignored.</span><br>
<span class="lineno"></span><span class="keyword" id="5562522">func</span>&nbsp;<span class="op" id="5562527">(</span><span class="ident" id="5562528">enc</span>&nbsp;<span class="op" id="5562532">*</span><span class="ident" id="5562533">Encoding</span><span class="op" id="5562541">)</span>&nbsp;<span class="ident" id="5562543">Decode</span><span class="op" id="5562549">(</span><span class="ident" id="5562550">dst</span><span class="op" id="5562553">,</span>&nbsp;<span class="ident" id="5562555">src</span>&nbsp;<span class="op" id="5562559">[</span><span class="op" id="5562560">]</span><span class="builtintype" id="5562561">byte</span><span class="op" id="5562565">)</span>&nbsp;<span class="op" id="5562567">(</span><span class="ident" id="5562568">n</span>&nbsp;<span class="builtintype" id="5562570">int</span><span class="op" id="5562573">,</span>&nbsp;<span class="ident" id="5562575">err</span>&nbsp;<span class="builtintype" id="5562579">error</span><span class="op" id="5562584">)</span>&nbsp;<span class="op" id="5562586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5562589">src</span>&nbsp;<span class="op" id="5562593">=</span>&nbsp;<span class="ident" id="5562595">bytes</span><span class="op" id="5562600">.</span><span class="ident" id="5562601">Map</span><span class="op" id="5562604">(</span><span class="ident" id="5562605">removeNewlinesMapper</span><span class="op" id="5562625">,</span>&nbsp;<span class="ident" id="5562627">src</span><span class="op" id="5562630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5562633">n</span><span class="op" id="5562634">,</span>&nbsp;<span class="ident" id="5562636">_</span><span class="op" id="5562637">,</span>&nbsp;<span class="ident" id="5562639">err</span>&nbsp;<span class="op" id="5562643">=</span>&nbsp;<span class="ident" id="5562645">enc</span><span class="op" id="5562648">.</span><span class="ident" id="5562649">decode</span><span class="op" id="5562655">(</span><span class="ident" id="5562656">dst</span><span class="op" id="5562659">,</span>&nbsp;<span class="ident" id="5562661">src</span><span class="op" id="5562664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5562667">return</span><br>
<span class="lineno">325</span><span class="op" id="5562674">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5562677">//&nbsp;DecodeString&nbsp;returns&nbsp;the&nbsp;bytes&nbsp;represented&nbsp;by&nbsp;the&nbsp;base32&nbsp;string&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="5562747">func</span>&nbsp;<span class="op" id="5562752">(</span><span class="ident" id="5562753">enc</span>&nbsp;<span class="op" id="5562757">*</span><span class="ident" id="5562758">Encoding</span><span class="op" id="5562766">)</span>&nbsp;<span class="ident" id="5562768">DecodeString</span><span class="op" id="5562780">(</span><span class="ident" id="5562781">s</span>&nbsp;<span class="builtintype" id="5562783">string</span><span class="op" id="5562789">)</span>&nbsp;<span class="op" id="5562791">(</span><span class="op" id="5562792">[</span><span class="op" id="5562793">]</span><span class="builtintype" id="5562794">byte</span><span class="op" id="5562798">,</span>&nbsp;<span class="builtintype" id="5562800">error</span><span class="op" id="5562805">)</span>&nbsp;<span class="op" id="5562807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5562810">s</span>&nbsp;<span class="op" id="5562812">=</span>&nbsp;<span class="ident" id="5562814">strings</span><span class="op" id="5562821">.</span><span class="ident" id="5562822">Map</span><span class="op" id="5562825">(</span><span class="ident" id="5562826">removeNewlinesMapper</span><span class="op" id="5562846">,</span>&nbsp;<span class="ident" id="5562848">s</span><span class="op" id="5562849">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5562852">dbuf</span>&nbsp;<span class="op" id="5562857">:=</span>&nbsp;<span class="builtinfunc" id="5562860">make</span><span class="op" id="5562864">(</span><span class="op" id="5562865">[</span><span class="op" id="5562866">]</span><span class="builtintype" id="5562867">byte</span><span class="op" id="5562871">,</span>&nbsp;<span class="ident" id="5562873">enc</span><span class="op" id="5562876">.</span><span class="ident" id="5562877">DecodedLen</span><span class="op" id="5562887">(</span><span class="builtinfunc" id="5562888">len</span><span class="op" id="5562891">(</span><span class="ident" id="5562892">s</span><span class="op" id="5562893">)</span><span class="op" id="5562894">)</span><span class="op" id="5562895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5562898">n</span><span class="op" id="5562899">,</span>&nbsp;<span class="ident" id="5562901">_</span><span class="op" id="5562902">,</span>&nbsp;<span class="ident" id="5562904">err</span>&nbsp;<span class="op" id="5562908">:=</span>&nbsp;<span class="ident" id="5562911">enc</span><span class="op" id="5562914">.</span><span class="ident" id="5562915">decode</span><span class="op" id="5562921">(</span><span class="ident" id="5562922">dbuf</span><span class="op" id="5562926">,</span>&nbsp;<span class="op" id="5562928">[</span><span class="op" id="5562929">]</span><span class="builtintype" id="5562930">byte</span><span class="op" id="5562934">(</span><span class="ident" id="5562935">s</span><span class="op" id="5562936">)</span><span class="op" id="5562937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5562940">return</span>&nbsp;<span class="ident" id="5562947">dbuf</span><span class="op" id="5562951">[</span><span class="op" id="5562952">:</span><span class="ident" id="5562953">n</span><span class="op" id="5562954">]</span><span class="op" id="5562955">,</span>&nbsp;<span class="ident" id="5562957">err</span><br>
<span class="lineno"></span><span class="op" id="5562961">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="keyword" id="5562964">type</span>&nbsp;<span class="ident" id="5562969">decoder</span>&nbsp;<span class="keyword" id="5562977">struct</span>&nbsp;<span class="op" id="5562984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5562987">err</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5562994">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5563001">enc</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5563008">*</span><span class="ident" id="5563009">Encoding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5563019">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5563026">io</span><span class="op" id="5563028">.</span><span class="ident" id="5563029">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5563037">end</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5563044">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5563055">//&nbsp;saw&nbsp;end&nbsp;of&nbsp;message</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5563078">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5563085">[</span><span class="num" id="5563086">1024</span><span class="op" id="5563090">]</span><span class="builtintype" id="5563091">byte</span>&nbsp;<span class="comment" id="5563096">//&nbsp;leftover&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5563115">nbuf</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5563122">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5563127">out</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5563134">[</span><span class="op" id="5563135">]</span><span class="builtintype" id="5563136">byte</span>&nbsp;<span class="comment" id="5563141">//&nbsp;leftover&nbsp;decoded&nbsp;output</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5563169">outbuf</span>&nbsp;<span class="op" id="5563176">[</span><span class="num" id="5563177">1024</span>&nbsp;<span class="op" id="5563182">/</span>&nbsp;<span class="num" id="5563184">8</span>&nbsp;<span class="op" id="5563186">*</span>&nbsp;<span class="num" id="5563188">5</span><span class="op" id="5563189">]</span><span class="builtintype" id="5563190">byte</span><br>
<span class="lineno"></span><span class="op" id="5563195">}</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span><span class="keyword" id="5563198">func</span>&nbsp;<span class="op" id="5563203">(</span><span class="ident" id="5563204">d</span>&nbsp;<span class="op" id="5563206">*</span><span class="ident" id="5563207">decoder</span><span class="op" id="5563214">)</span>&nbsp;<span class="ident" id="5563216">Read</span><span class="op" id="5563220">(</span><span class="ident" id="5563221">p</span>&nbsp;<span class="op" id="5563223">[</span><span class="op" id="5563224">]</span><span class="builtintype" id="5563225">byte</span><span class="op" id="5563229">)</span>&nbsp;<span class="op" id="5563231">(</span><span class="ident" id="5563232">n</span>&nbsp;<span class="builtintype" id="5563234">int</span><span class="op" id="5563237">,</span>&nbsp;<span class="ident" id="5563239">err</span>&nbsp;<span class="builtintype" id="5563243">error</span><span class="op" id="5563248">)</span>&nbsp;<span class="op" id="5563250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5563253">if</span>&nbsp;<span class="ident" id="5563256">d</span><span class="op" id="5563257">.</span><span class="ident" id="5563258">err</span>&nbsp;<span class="op" id="5563262">!=</span>&nbsp;<span class="ident" id="5563265">nil</span>&nbsp;<span class="op" id="5563269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5563273">return</span>&nbsp;<span class="num" id="5563280">0</span><span class="op" id="5563281">,</span>&nbsp;<span class="ident" id="5563283">d</span><span class="op" id="5563284">.</span><span class="ident" id="5563285">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5563290">}</span><br>
<span class="lineno">350</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5563294">//&nbsp;Use&nbsp;leftover&nbsp;decoded&nbsp;output&nbsp;from&nbsp;last&nbsp;read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5563342">if</span>&nbsp;<span class="builtinfunc" id="5563345">len</span><span class="op" id="5563348">(</span><span class="ident" id="5563349">d</span><span class="op" id="5563350">.</span><span class="ident" id="5563351">out</span><span class="op" id="5563354">)</span>&nbsp;<span class="op" id="5563356">&gt;</span>&nbsp;<span class="num" id="5563358">0</span>&nbsp;<span class="op" id="5563360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5563364">n</span>&nbsp;<span class="op" id="5563366">=</span>&nbsp;<span class="builtinfunc" id="5563368">copy</span><span class="op" id="5563372">(</span><span class="ident" id="5563373">p</span><span class="op" id="5563374">,</span>&nbsp;<span class="ident" id="5563376">d</span><span class="op" id="5563377">.</span><span class="ident" id="5563378">out</span><span class="op" id="5563381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5563385">d</span><span class="op" id="5563386">.</span><span class="ident" id="5563387">out</span>&nbsp;<span class="op" id="5563391">=</span>&nbsp;<span class="ident" id="5563393">d</span><span class="op" id="5563394">.</span><span class="ident" id="5563395">out</span><span class="op" id="5563398">[</span><span class="ident" id="5563399">n</span><span class="op" id="5563400">:</span><span class="op" id="5563401">]</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5563405">return</span>&nbsp;<span class="ident" id="5563412">n</span><span class="op" id="5563413">,</span>&nbsp;<span class="ident" id="5563415">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5563420">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5563424">//&nbsp;Read&nbsp;a&nbsp;chunk.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5563442">nn</span>&nbsp;<span class="op" id="5563445">:=</span>&nbsp;<span class="builtinfunc" id="5563448">len</span><span class="op" id="5563451">(</span><span class="ident" id="5563452">p</span><span class="op" id="5563453">)</span>&nbsp;<span class="op" id="5563455">/</span>&nbsp;<span class="num" id="5563457">5</span>&nbsp;<span class="op" id="5563459">*</span>&nbsp;<span class="num" id="5563461">8</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5563464">if</span>&nbsp;<span class="ident" id="5563467">nn</span>&nbsp;<span class="op" id="5563470">&lt;</span>&nbsp;<span class="num" id="5563472">8</span>&nbsp;<span class="op" id="5563474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5563478">nn</span>&nbsp;<span class="op" id="5563481">=</span>&nbsp;<span class="num" id="5563483">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5563486">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5563489">if</span>&nbsp;<span class="ident" id="5563492">nn</span>&nbsp;<span class="op" id="5563495">&gt;</span>&nbsp;<span class="builtinfunc" id="5563497">len</span><span class="op" id="5563500">(</span><span class="ident" id="5563501">d</span><span class="op" id="5563502">.</span><span class="ident" id="5563503">buf</span><span class="op" id="5563506">)</span>&nbsp;<span class="op" id="5563508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5563512">nn</span>&nbsp;<span class="op" id="5563515">=</span>&nbsp;<span class="builtinfunc" id="5563517">len</span><span class="op" id="5563520">(</span><span class="ident" id="5563521">d</span><span class="op" id="5563522">.</span><span class="ident" id="5563523">buf</span><span class="op" id="5563526">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5563529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5563532">nn</span><span class="op" id="5563534">,</span>&nbsp;<span class="ident" id="5563536">d</span><span class="op" id="5563537">.</span><span class="ident" id="5563538">err</span>&nbsp;<span class="op" id="5563542">=</span>&nbsp;<span class="ident" id="5563544">io</span><span class="op" id="5563546">.</span><span class="ident" id="5563547">ReadAtLeast</span><span class="op" id="5563558">(</span><span class="ident" id="5563559">d</span><span class="op" id="5563560">.</span><span class="ident" id="5563561">r</span><span class="op" id="5563562">,</span>&nbsp;<span class="ident" id="5563564">d</span><span class="op" id="5563565">.</span><span class="ident" id="5563566">buf</span><span class="op" id="5563569">[</span><span class="ident" id="5563570">d</span><span class="op" id="5563571">.</span><span class="ident" id="5563572">nbuf</span><span class="op" id="5563576">:</span><span class="ident" id="5563577">nn</span><span class="op" id="5563579">]</span><span class="op" id="5563580">,</span>&nbsp;<span class="num" id="5563582">8</span><span class="op" id="5563583">-</span><span class="ident" id="5563584">d</span><span class="op" id="5563585">.</span><span class="ident" id="5563586">nbuf</span><span class="op" id="5563590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5563593">d</span><span class="op" id="5563594">.</span><span class="ident" id="5563595">nbuf</span>&nbsp;<span class="op" id="5563600">+=</span>&nbsp;<span class="ident" id="5563603">nn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5563607">if</span>&nbsp;<span class="ident" id="5563610">d</span><span class="op" id="5563611">.</span><span class="ident" id="5563612">nbuf</span>&nbsp;<span class="op" id="5563617">&lt;</span>&nbsp;<span class="num" id="5563619">8</span>&nbsp;<span class="op" id="5563621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5563625">return</span>&nbsp;<span class="num" id="5563632">0</span><span class="op" id="5563633">,</span>&nbsp;<span class="ident" id="5563635">d</span><span class="op" id="5563636">.</span><span class="ident" id="5563637">err</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5563642">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5563646">//&nbsp;Decode&nbsp;chunk&nbsp;into&nbsp;p,&nbsp;or&nbsp;d.out&nbsp;and&nbsp;then&nbsp;p&nbsp;if&nbsp;p&nbsp;is&nbsp;too&nbsp;small.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5563710">nr</span>&nbsp;<span class="op" id="5563713">:=</span>&nbsp;<span class="ident" id="5563716">d</span><span class="op" id="5563717">.</span><span class="ident" id="5563718">nbuf</span>&nbsp;<span class="op" id="5563723">/</span>&nbsp;<span class="num" id="5563725">8</span>&nbsp;<span class="op" id="5563727">*</span>&nbsp;<span class="num" id="5563729">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5563732">nw</span>&nbsp;<span class="op" id="5563735">:=</span>&nbsp;<span class="ident" id="5563738">d</span><span class="op" id="5563739">.</span><span class="ident" id="5563740">nbuf</span>&nbsp;<span class="op" id="5563745">/</span>&nbsp;<span class="num" id="5563747">8</span>&nbsp;<span class="op" id="5563749">*</span>&nbsp;<span class="num" id="5563751">5</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5563754">if</span>&nbsp;<span class="ident" id="5563757">nw</span>&nbsp;<span class="op" id="5563760">&gt;</span>&nbsp;<span class="builtinfunc" id="5563762">len</span><span class="op" id="5563765">(</span><span class="ident" id="5563766">p</span><span class="op" id="5563767">)</span>&nbsp;<span class="op" id="5563769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5563773">nw</span><span class="op" id="5563775">,</span>&nbsp;<span class="ident" id="5563777">d</span><span class="op" id="5563778">.</span><span class="ident" id="5563779">end</span><span class="op" id="5563782">,</span>&nbsp;<span class="ident" id="5563784">d</span><span class="op" id="5563785">.</span><span class="ident" id="5563786">err</span>&nbsp;<span class="op" id="5563790">=</span>&nbsp;<span class="ident" id="5563792">d</span><span class="op" id="5563793">.</span><span class="ident" id="5563794">enc</span><span class="op" id="5563797">.</span><span class="ident" id="5563798">decode</span><span class="op" id="5563804">(</span><span class="ident" id="5563805">d</span><span class="op" id="5563806">.</span><span class="ident" id="5563807">outbuf</span><span class="op" id="5563813">[</span><span class="num" id="5563814">0</span><span class="op" id="5563815">:</span><span class="op" id="5563816">]</span><span class="op" id="5563817">,</span>&nbsp;<span class="ident" id="5563819">d</span><span class="op" id="5563820">.</span><span class="ident" id="5563821">buf</span><span class="op" id="5563824">[</span><span class="num" id="5563825">0</span><span class="op" id="5563826">:</span><span class="ident" id="5563827">nr</span><span class="op" id="5563829">]</span><span class="op" id="5563830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5563834">d</span><span class="op" id="5563835">.</span><span class="ident" id="5563836">out</span>&nbsp;<span class="op" id="5563840">=</span>&nbsp;<span class="ident" id="5563842">d</span><span class="op" id="5563843">.</span><span class="ident" id="5563844">outbuf</span><span class="op" id="5563850">[</span><span class="num" id="5563851">0</span><span class="op" id="5563852">:</span><span class="ident" id="5563853">nw</span><span class="op" id="5563855">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5563859">n</span>&nbsp;<span class="op" id="5563861">=</span>&nbsp;<span class="builtinfunc" id="5563863">copy</span><span class="op" id="5563867">(</span><span class="ident" id="5563868">p</span><span class="op" id="5563869">,</span>&nbsp;<span class="ident" id="5563871">d</span><span class="op" id="5563872">.</span><span class="ident" id="5563873">out</span><span class="op" id="5563876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5563880">d</span><span class="op" id="5563881">.</span><span class="ident" id="5563882">out</span>&nbsp;<span class="op" id="5563886">=</span>&nbsp;<span class="ident" id="5563888">d</span><span class="op" id="5563889">.</span><span class="ident" id="5563890">out</span><span class="op" id="5563893">[</span><span class="ident" id="5563894">n</span><span class="op" id="5563895">:</span><span class="op" id="5563896">]</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5563899">}</span>&nbsp;<span class="keyword" id="5563901">else</span>&nbsp;<span class="op" id="5563906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5563910">n</span><span class="op" id="5563911">,</span>&nbsp;<span class="ident" id="5563913">d</span><span class="op" id="5563914">.</span><span class="ident" id="5563915">end</span><span class="op" id="5563918">,</span>&nbsp;<span class="ident" id="5563920">d</span><span class="op" id="5563921">.</span><span class="ident" id="5563922">err</span>&nbsp;<span class="op" id="5563926">=</span>&nbsp;<span class="ident" id="5563928">d</span><span class="op" id="5563929">.</span><span class="ident" id="5563930">enc</span><span class="op" id="5563933">.</span><span class="ident" id="5563934">decode</span><span class="op" id="5563940">(</span><span class="ident" id="5563941">p</span><span class="op" id="5563942">,</span>&nbsp;<span class="ident" id="5563944">d</span><span class="op" id="5563945">.</span><span class="ident" id="5563946">buf</span><span class="op" id="5563949">[</span><span class="num" id="5563950">0</span><span class="op" id="5563951">:</span><span class="ident" id="5563952">nr</span><span class="op" id="5563954">]</span><span class="op" id="5563955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5563958">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5563961">d</span><span class="op" id="5563962">.</span><span class="ident" id="5563963">nbuf</span>&nbsp;<span class="op" id="5563968">-=</span>&nbsp;<span class="ident" id="5563971">nr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5563975">for</span>&nbsp;<span class="ident" id="5563979">i</span>&nbsp;<span class="op" id="5563981">:=</span>&nbsp;<span class="num" id="5563984">0</span><span class="op" id="5563985">;</span>&nbsp;<span class="ident" id="5563987">i</span>&nbsp;<span class="op" id="5563989">&lt;</span>&nbsp;<span class="ident" id="5563991">d</span><span class="op" id="5563992">.</span><span class="ident" id="5563993">nbuf</span><span class="op" id="5563997">;</span>&nbsp;<span class="ident" id="5563999">i</span><span class="op" id="5564000">++</span>&nbsp;<span class="op" id="5564003">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5564007">d</span><span class="op" id="5564008">.</span><span class="ident" id="5564009">buf</span><span class="op" id="5564012">[</span><span class="ident" id="5564013">i</span><span class="op" id="5564014">]</span>&nbsp;<span class="op" id="5564016">=</span>&nbsp;<span class="ident" id="5564018">d</span><span class="op" id="5564019">.</span><span class="ident" id="5564020">buf</span><span class="op" id="5564023">[</span><span class="ident" id="5564024">i</span><span class="op" id="5564025">+</span><span class="ident" id="5564026">nr</span><span class="op" id="5564028">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5564031">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5564035">if</span>&nbsp;<span class="ident" id="5564038">d</span><span class="op" id="5564039">.</span><span class="ident" id="5564040">err</span>&nbsp;<span class="op" id="5564044">==</span>&nbsp;<span class="ident" id="5564047">nil</span>&nbsp;<span class="op" id="5564051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5564055">d</span><span class="op" id="5564056">.</span><span class="ident" id="5564057">err</span>&nbsp;<span class="op" id="5564061">=</span>&nbsp;<span class="ident" id="5564063">err</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5564068">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5564071">return</span>&nbsp;<span class="ident" id="5564078">n</span><span class="op" id="5564079">,</span>&nbsp;<span class="ident" id="5564081">d</span><span class="op" id="5564082">.</span><span class="ident" id="5564083">err</span><br>
<span class="lineno"></span><span class="op" id="5564087">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5564090">type</span>&nbsp;<span class="ident" id="5564095">newlineFilteringReader</span>&nbsp;<span class="keyword" id="5564118">struct</span>&nbsp;<span class="op" id="5564125">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5564128">wrapped</span>&nbsp;<span class="ident" id="5564136">io</span><span class="op" id="5564138">.</span><span class="ident" id="5564139">Reader</span><br>
<span class="lineno"></span><span class="op" id="5564146">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5564149">func</span>&nbsp;<span class="op" id="5564154">(</span><span class="ident" id="5564155">r</span>&nbsp;<span class="op" id="5564157">*</span><span class="ident" id="5564158">newlineFilteringReader</span><span class="op" id="5564180">)</span>&nbsp;<span class="ident" id="5564182">Read</span><span class="op" id="5564186">(</span><span class="ident" id="5564187">p</span>&nbsp;<span class="op" id="5564189">[</span><span class="op" id="5564190">]</span><span class="builtintype" id="5564191">byte</span><span class="op" id="5564195">)</span>&nbsp;<span class="op" id="5564197">(</span><span class="builtintype" id="5564198">int</span><span class="op" id="5564201">,</span>&nbsp;<span class="builtintype" id="5564203">error</span><span class="op" id="5564208">)</span>&nbsp;<span class="op" id="5564210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5564213">n</span><span class="op" id="5564214">,</span>&nbsp;<span class="ident" id="5564216">err</span>&nbsp;<span class="op" id="5564220">:=</span>&nbsp;<span class="ident" id="5564223">r</span><span class="op" id="5564224">.</span><span class="ident" id="5564225">wrapped</span><span class="op" id="5564232">.</span><span class="ident" id="5564233">Read</span><span class="op" id="5564237">(</span><span class="ident" id="5564238">p</span><span class="op" id="5564239">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5564242">for</span>&nbsp;<span class="ident" id="5564246">n</span>&nbsp;<span class="op" id="5564248">&gt;</span>&nbsp;<span class="num" id="5564250">0</span>&nbsp;<span class="op" id="5564252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5564256">offset</span>&nbsp;<span class="op" id="5564263">:=</span>&nbsp;<span class="num" id="5564266">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5564270">for</span>&nbsp;<span class="ident" id="5564274">i</span><span class="op" id="5564275">,</span>&nbsp;<span class="ident" id="5564277">b</span>&nbsp;<span class="op" id="5564279">:=</span>&nbsp;<span class="keyword" id="5564282">range</span>&nbsp;<span class="ident" id="5564288">p</span><span class="op" id="5564289">[</span><span class="num" id="5564290">0</span><span class="op" id="5564291">:</span><span class="ident" id="5564292">n</span><span class="op" id="5564293">]</span>&nbsp;<span class="op" id="5564295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5564300">if</span>&nbsp;<span class="ident" id="5564303">b</span>&nbsp;<span class="op" id="5564305">!=</span>&nbsp;<span class="string" id="5564308">&#39;\r&#39;</span>&nbsp;<span class="op" id="5564313">&amp;&amp;</span>&nbsp;<span class="ident" id="5564316">b</span>&nbsp;<span class="op" id="5564318">!=</span>&nbsp;<span class="string" id="5564321">&#39;\n&#39;</span>&nbsp;<span class="op" id="5564326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5564332">if</span>&nbsp;<span class="ident" id="5564335">i</span>&nbsp;<span class="op" id="5564337">!=</span>&nbsp;<span class="ident" id="5564340">offset</span>&nbsp;<span class="op" id="5564347">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5564354">p</span><span class="op" id="5564355">[</span><span class="ident" id="5564356">offset</span><span class="op" id="5564362">]</span>&nbsp;<span class="op" id="5564364">=</span>&nbsp;<span class="ident" id="5564366">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5564372">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5564378">offset</span><span class="op" id="5564384">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5564390">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5564394">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5564398">if</span>&nbsp;<span class="ident" id="5564401">offset</span>&nbsp;<span class="op" id="5564408">&gt;</span>&nbsp;<span class="num" id="5564410">0</span>&nbsp;<span class="op" id="5564412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5564417">return</span>&nbsp;<span class="ident" id="5564424">offset</span><span class="op" id="5564430">,</span>&nbsp;<span class="ident" id="5564432">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5564438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5564442">//&nbsp;Previous&nbsp;buffer&nbsp;entirely&nbsp;whitespace,&nbsp;read&nbsp;again</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5564495">n</span><span class="op" id="5564496">,</span>&nbsp;<span class="ident" id="5564498">err</span>&nbsp;<span class="op" id="5564502">=</span>&nbsp;<span class="ident" id="5564504">r</span><span class="op" id="5564505">.</span><span class="ident" id="5564506">wrapped</span><span class="op" id="5564513">.</span><span class="ident" id="5564514">Read</span><span class="op" id="5564518">(</span><span class="ident" id="5564519">p</span><span class="op" id="5564520">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5564523">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5564526">return</span>&nbsp;<span class="ident" id="5564533">n</span><span class="op" id="5564534">,</span>&nbsp;<span class="ident" id="5564536">err</span><br>
<span class="lineno"></span><span class="op" id="5564540">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5564543">//&nbsp;NewDecoder&nbsp;constructs&nbsp;a&nbsp;new&nbsp;base32&nbsp;stream&nbsp;decoder.</span><br>
<span class="lineno">420</span><span class="keyword" id="5564597">func</span>&nbsp;<span class="ident" id="5564602">NewDecoder</span><span class="op" id="5564612">(</span><span class="ident" id="5564613">enc</span>&nbsp;<span class="op" id="5564617">*</span><span class="ident" id="5564618">Encoding</span><span class="op" id="5564626">,</span>&nbsp;<span class="ident" id="5564628">r</span>&nbsp;<span class="ident" id="5564630">io</span><span class="op" id="5564632">.</span><span class="ident" id="5564633">Reader</span><span class="op" id="5564639">)</span>&nbsp;<span class="ident" id="5564641">io</span><span class="op" id="5564643">.</span><span class="ident" id="5564644">Reader</span>&nbsp;<span class="op" id="5564651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5564654">return</span>&nbsp;<span class="op" id="5564661">&amp;</span><span class="ident" id="5564662">decoder</span><span class="op" id="5564669">{</span><span class="ident" id="5564670">enc</span><span class="op" id="5564673">:</span>&nbsp;<span class="ident" id="5564675">enc</span><span class="op" id="5564678">,</span>&nbsp;<span class="ident" id="5564680">r</span><span class="op" id="5564681">:</span>&nbsp;<span class="op" id="5564683">&amp;</span><span class="ident" id="5564684">newlineFilteringReader</span><span class="op" id="5564706">{</span><span class="ident" id="5564707">r</span><span class="op" id="5564708">}</span><span class="op" id="5564709">}</span><br>
<span class="lineno"></span><span class="op" id="5564711">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5564714">//&nbsp;DecodedLen&nbsp;returns&nbsp;the&nbsp;maximum&nbsp;length&nbsp;in&nbsp;bytes&nbsp;of&nbsp;the&nbsp;decoded&nbsp;data</span><br>
<span class="lineno">425</span><span class="comment" id="5564784">//&nbsp;corresponding&nbsp;to&nbsp;n&nbsp;bytes&nbsp;of&nbsp;base32-encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="5564836">func</span>&nbsp;<span class="op" id="5564841">(</span><span class="ident" id="5564842">enc</span>&nbsp;<span class="op" id="5564846">*</span><span class="ident" id="5564847">Encoding</span><span class="op" id="5564855">)</span>&nbsp;<span class="ident" id="5564857">DecodedLen</span><span class="op" id="5564867">(</span><span class="ident" id="5564868">n</span>&nbsp;<span class="builtintype" id="5564870">int</span><span class="op" id="5564873">)</span>&nbsp;<span class="builtintype" id="5564875">int</span>&nbsp;<span class="op" id="5564879">{</span>&nbsp;<span class="keyword" id="5564881">return</span>&nbsp;<span class="ident" id="5564888">n</span>&nbsp;<span class="op" id="5564890">/</span>&nbsp;<span class="num" id="5564892">8</span>&nbsp;<span class="op" id="5564894">*</span>&nbsp;<span class="num" id="5564896">5</span>&nbsp;<span class="op" id="5564898">}</span>
</div>
</body>
</html>
