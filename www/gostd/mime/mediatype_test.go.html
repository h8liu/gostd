<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>mime</h2>
<ul>
<li><a href="/gostd/mime/grammar.go.html">grammar.go</a></li>
<li><a href="/gostd/mime/mediatype.go.html">mediatype.go</a></li>
<li><a href="/gostd/mime/mediatype_test.go.html">mediatype_test.go</a></li>
<li><a href="/gostd/mime/type.go.html">type.go</a></li>
<li><a href="/gostd/mime/type_test.go.html">type_test.go</a></li>
<li><a href="/gostd/mime/type_unix.go.html">type_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7509054">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7509109">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7509163">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7509214">package</span>&nbsp;<span class="ident" id="7509222">mime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7509228">import</span>&nbsp;<span class="op" id="7509235">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7509238">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7509249">&#34;testing&#34;</span><br>
<span class="lineno">10</span><span class="op" id="7509259">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7509262">func</span>&nbsp;<span class="ident" id="7509267">TestConsumeToken</span><span class="op" id="7509283">(</span><span class="ident" id="7509284">t</span>&nbsp;<span class="op" id="7509286">*</span><span class="ident" id="7509287">testing</span><span class="op" id="7509294">.</span><span class="ident" id="7509295">T</span><span class="op" id="7509296">)</span>&nbsp;<span class="op" id="7509298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7509301">tests</span>&nbsp;<span class="op" id="7509307">:=</span>&nbsp;<span class="op" id="7509310">[</span><span class="op" id="7509311">...</span><span class="op" id="7509314">]</span><span class="op" id="7509315">[</span><span class="num" id="7509316">3</span><span class="op" id="7509317">]</span><span class="builtintype" id="7509318">string</span><span class="op" id="7509324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7509328">{</span><span class="string" id="7509329">&#34;foo&nbsp;bar&#34;</span><span class="op" id="7509338">,</span>&nbsp;<span class="string" id="7509340">&#34;foo&#34;</span><span class="op" id="7509345">,</span>&nbsp;<span class="string" id="7509347">&#34;&nbsp;bar&#34;</span><span class="op" id="7509353">}</span><span class="op" id="7509354">,</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7509358">{</span><span class="string" id="7509359">&#34;bar&#34;</span><span class="op" id="7509364">,</span>&nbsp;<span class="string" id="7509366">&#34;bar&#34;</span><span class="op" id="7509371">,</span>&nbsp;<span class="string" id="7509373">&#34;&#34;</span><span class="op" id="7509375">}</span><span class="op" id="7509376">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7509380">{</span><span class="string" id="7509381">&#34;&#34;</span><span class="op" id="7509383">,</span>&nbsp;<span class="string" id="7509385">&#34;&#34;</span><span class="op" id="7509387">,</span>&nbsp;<span class="string" id="7509389">&#34;&#34;</span><span class="op" id="7509391">}</span><span class="op" id="7509392">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7509396">{</span><span class="string" id="7509397">&#34;&nbsp;foo&#34;</span><span class="op" id="7509403">,</span>&nbsp;<span class="string" id="7509405">&#34;&#34;</span><span class="op" id="7509407">,</span>&nbsp;<span class="string" id="7509409">&#34;&nbsp;foo&#34;</span><span class="op" id="7509415">}</span><span class="op" id="7509416">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7509419">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7509422">for</span>&nbsp;<span class="ident" id="7509426">_</span><span class="op" id="7509427">,</span>&nbsp;<span class="ident" id="7509429">test</span>&nbsp;<span class="op" id="7509434">:=</span>&nbsp;<span class="keyword" id="7509437">range</span>&nbsp;<span class="ident" id="7509443">tests</span>&nbsp;<span class="op" id="7509449">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7509453">token</span><span class="op" id="7509458">,</span>&nbsp;<span class="ident" id="7509460">rest</span>&nbsp;<span class="op" id="7509465">:=</span>&nbsp;<span class="ident" id="7509468">consumeToken</span><span class="op" id="7509480">(</span><span class="ident" id="7509481">test</span><span class="op" id="7509485">[</span><span class="num" id="7509486">0</span><span class="op" id="7509487">]</span><span class="op" id="7509488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7509492">expectedToken</span>&nbsp;<span class="op" id="7509506">:=</span>&nbsp;<span class="ident" id="7509509">test</span><span class="op" id="7509513">[</span><span class="num" id="7509514">1</span><span class="op" id="7509515">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7509519">expectedRest</span>&nbsp;<span class="op" id="7509532">:=</span>&nbsp;<span class="ident" id="7509535">test</span><span class="op" id="7509539">[</span><span class="num" id="7509540">2</span><span class="op" id="7509541">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7509545">if</span>&nbsp;<span class="ident" id="7509548">token</span>&nbsp;<span class="op" id="7509554">!=</span>&nbsp;<span class="ident" id="7509557">expectedToken</span>&nbsp;<span class="op" id="7509571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7509576">t</span><span class="op" id="7509577">.</span><span class="ident" id="7509578">Errorf</span><span class="op" id="7509584">(</span><span class="string" id="7509585">&#34;expected&nbsp;to&nbsp;consume&nbsp;token&nbsp;&#39;%s&#39;,&nbsp;not&nbsp;&#39;%s&#39;&nbsp;from&nbsp;&#39;%s&#39;&#34;</span><span class="op" id="7509637">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7509643">expectedToken</span><span class="op" id="7509656">,</span>&nbsp;<span class="ident" id="7509658">token</span><span class="op" id="7509663">,</span>&nbsp;<span class="ident" id="7509665">test</span><span class="op" id="7509669">[</span><span class="num" id="7509670">0</span><span class="op" id="7509671">]</span><span class="op" id="7509672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7509676">}</span>&nbsp;<span class="keyword" id="7509678">else</span>&nbsp;<span class="keyword" id="7509683">if</span>&nbsp;<span class="ident" id="7509686">rest</span>&nbsp;<span class="op" id="7509691">!=</span>&nbsp;<span class="ident" id="7509694">expectedRest</span>&nbsp;<span class="op" id="7509707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7509712">t</span><span class="op" id="7509713">.</span><span class="ident" id="7509714">Errorf</span><span class="op" id="7509720">(</span><span class="string" id="7509721">&#34;expected&nbsp;to&nbsp;have&nbsp;left&nbsp;&#39;%s&#39;,&nbsp;not&nbsp;&#39;%s&#39;&nbsp;after&nbsp;reading&nbsp;token&nbsp;&#39;%s&#39;&nbsp;from&nbsp;&#39;%s&#39;&#34;</span><span class="op" id="7509794">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7509800">expectedRest</span><span class="op" id="7509812">,</span>&nbsp;<span class="ident" id="7509814">rest</span><span class="op" id="7509818">,</span>&nbsp;<span class="ident" id="7509820">token</span><span class="op" id="7509825">,</span>&nbsp;<span class="ident" id="7509827">test</span><span class="op" id="7509831">[</span><span class="num" id="7509832">0</span><span class="op" id="7509833">]</span><span class="op" id="7509834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7509838">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7509841">}</span><br>
<span class="lineno"></span><span class="op" id="7509843">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7509846">func</span>&nbsp;<span class="ident" id="7509851">TestConsumeValue</span><span class="op" id="7509867">(</span><span class="ident" id="7509868">t</span>&nbsp;<span class="op" id="7509870">*</span><span class="ident" id="7509871">testing</span><span class="op" id="7509878">.</span><span class="ident" id="7509879">T</span><span class="op" id="7509880">)</span>&nbsp;<span class="op" id="7509882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7509885">tests</span>&nbsp;<span class="op" id="7509891">:=</span>&nbsp;<span class="op" id="7509894">[</span><span class="op" id="7509895">...</span><span class="op" id="7509898">]</span><span class="op" id="7509899">[</span><span class="num" id="7509900">3</span><span class="op" id="7509901">]</span><span class="builtintype" id="7509902">string</span><span class="op" id="7509908">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7509912">{</span><span class="string" id="7509913">&#34;foo&nbsp;bar&#34;</span><span class="op" id="7509922">,</span>&nbsp;<span class="string" id="7509924">&#34;foo&#34;</span><span class="op" id="7509929">,</span>&nbsp;<span class="string" id="7509931">&#34;&nbsp;bar&#34;</span><span class="op" id="7509937">}</span><span class="op" id="7509938">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7509942">{</span><span class="string" id="7509943">&#34;bar&#34;</span><span class="op" id="7509948">,</span>&nbsp;<span class="string" id="7509950">&#34;bar&#34;</span><span class="op" id="7509955">,</span>&nbsp;<span class="string" id="7509957">&#34;&#34;</span><span class="op" id="7509959">}</span><span class="op" id="7509960">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7509964">{</span><span class="string" id="7509965">&#34;&nbsp;bar&nbsp;&#34;</span><span class="op" id="7509972">,</span>&nbsp;<span class="string" id="7509974">&#34;&#34;</span><span class="op" id="7509976">,</span>&nbsp;<span class="string" id="7509978">&#34;&nbsp;bar&nbsp;&#34;</span><span class="op" id="7509985">}</span><span class="op" id="7509986">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7509990">{</span><span class="string" id="7509991">`&#34;My&nbsp;value&#34;end`</span><span class="op" id="7510006">,</span>&nbsp;<span class="string" id="7510008">&#34;My&nbsp;value&#34;</span><span class="op" id="7510018">,</span>&nbsp;<span class="string" id="7510020">&#34;end&#34;</span><span class="op" id="7510025">}</span><span class="op" id="7510026">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7510030">{</span><span class="string" id="7510031">`&#34;My&nbsp;value&#34;&nbsp;end`</span><span class="op" id="7510047">,</span>&nbsp;<span class="string" id="7510049">&#34;My&nbsp;value&#34;</span><span class="op" id="7510059">,</span>&nbsp;<span class="string" id="7510061">&#34;&nbsp;end&#34;</span><span class="op" id="7510067">}</span><span class="op" id="7510068">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7510072">{</span><span class="string" id="7510073">`&#34;\\&#34;&nbsp;rest`</span><span class="op" id="7510084">,</span>&nbsp;<span class="string" id="7510086">&#34;\\&#34;</span><span class="op" id="7510090">,</span>&nbsp;<span class="string" id="7510092">&#34;&nbsp;rest&#34;</span><span class="op" id="7510099">}</span><span class="op" id="7510100">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7510104">{</span><span class="string" id="7510105">`&#34;My&nbsp;\&#34;&nbsp;value&#34;end`</span><span class="op" id="7510123">,</span>&nbsp;<span class="string" id="7510125">&#34;My&nbsp;\&#34;&nbsp;value&#34;</span><span class="op" id="7510138">,</span>&nbsp;<span class="string" id="7510140">&#34;end&#34;</span><span class="op" id="7510145">}</span><span class="op" id="7510146">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7510150">{</span><span class="string" id="7510151">`&#34;\&#34;&nbsp;rest`</span><span class="op" id="7510161">,</span>&nbsp;<span class="string" id="7510163">&#34;&#34;</span><span class="op" id="7510165">,</span>&nbsp;<span class="string" id="7510167">`&#34;\&#34;&nbsp;rest`</span><span class="op" id="7510177">}</span><span class="op" id="7510178">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7510181">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7510184">for</span>&nbsp;<span class="ident" id="7510188">_</span><span class="op" id="7510189">,</span>&nbsp;<span class="ident" id="7510191">test</span>&nbsp;<span class="op" id="7510196">:=</span>&nbsp;<span class="keyword" id="7510199">range</span>&nbsp;<span class="ident" id="7510205">tests</span>&nbsp;<span class="op" id="7510211">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7510215">value</span><span class="op" id="7510220">,</span>&nbsp;<span class="ident" id="7510222">rest</span>&nbsp;<span class="op" id="7510227">:=</span>&nbsp;<span class="ident" id="7510230">consumeValue</span><span class="op" id="7510242">(</span><span class="ident" id="7510243">test</span><span class="op" id="7510247">[</span><span class="num" id="7510248">0</span><span class="op" id="7510249">]</span><span class="op" id="7510250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7510254">expectedValue</span>&nbsp;<span class="op" id="7510268">:=</span>&nbsp;<span class="ident" id="7510271">test</span><span class="op" id="7510275">[</span><span class="num" id="7510276">1</span><span class="op" id="7510277">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7510281">expectedRest</span>&nbsp;<span class="op" id="7510294">:=</span>&nbsp;<span class="ident" id="7510297">test</span><span class="op" id="7510301">[</span><span class="num" id="7510302">2</span><span class="op" id="7510303">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7510307">if</span>&nbsp;<span class="ident" id="7510310">value</span>&nbsp;<span class="op" id="7510316">!=</span>&nbsp;<span class="ident" id="7510319">expectedValue</span>&nbsp;<span class="op" id="7510333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7510338">t</span><span class="op" id="7510339">.</span><span class="ident" id="7510340">Errorf</span><span class="op" id="7510346">(</span><span class="string" id="7510347">&#34;expected&nbsp;to&nbsp;consume&nbsp;value&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="7510399">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7510405">expectedValue</span><span class="op" id="7510418">,</span>&nbsp;<span class="ident" id="7510420">value</span><span class="op" id="7510425">,</span>&nbsp;<span class="ident" id="7510427">test</span><span class="op" id="7510431">[</span><span class="num" id="7510432">0</span><span class="op" id="7510433">]</span><span class="op" id="7510434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7510438">}</span>&nbsp;<span class="keyword" id="7510440">else</span>&nbsp;<span class="keyword" id="7510445">if</span>&nbsp;<span class="ident" id="7510448">rest</span>&nbsp;<span class="op" id="7510453">!=</span>&nbsp;<span class="ident" id="7510456">expectedRest</span>&nbsp;<span class="op" id="7510469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7510474">t</span><span class="op" id="7510475">.</span><span class="ident" id="7510476">Errorf</span><span class="op" id="7510482">(</span><span class="string" id="7510483">&#34;expected&nbsp;to&nbsp;have&nbsp;left&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;after&nbsp;reading&nbsp;value&nbsp;[%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="7510556">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7510562">expectedRest</span><span class="op" id="7510574">,</span>&nbsp;<span class="ident" id="7510576">rest</span><span class="op" id="7510580">,</span>&nbsp;<span class="ident" id="7510582">value</span><span class="op" id="7510587">,</span>&nbsp;<span class="ident" id="7510589">test</span><span class="op" id="7510593">[</span><span class="num" id="7510594">0</span><span class="op" id="7510595">]</span><span class="op" id="7510596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7510600">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7510603">}</span><br>
<span class="lineno"></span><span class="op" id="7510605">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7510608">func</span>&nbsp;<span class="ident" id="7510613">TestConsumeMediaParam</span><span class="op" id="7510634">(</span><span class="ident" id="7510635">t</span>&nbsp;<span class="op" id="7510637">*</span><span class="ident" id="7510638">testing</span><span class="op" id="7510645">.</span><span class="ident" id="7510646">T</span><span class="op" id="7510647">)</span>&nbsp;<span class="op" id="7510649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7510652">tests</span>&nbsp;<span class="op" id="7510658">:=</span>&nbsp;<span class="op" id="7510661">[</span><span class="op" id="7510662">...</span><span class="op" id="7510665">]</span><span class="op" id="7510666">[</span><span class="num" id="7510667">4</span><span class="op" id="7510668">]</span><span class="builtintype" id="7510669">string</span><span class="op" id="7510675">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7510679">{</span><span class="string" id="7510680">&#34;&nbsp;;&nbsp;foo=bar&#34;</span><span class="op" id="7510692">,</span>&nbsp;<span class="string" id="7510694">&#34;foo&#34;</span><span class="op" id="7510699">,</span>&nbsp;<span class="string" id="7510701">&#34;bar&#34;</span><span class="op" id="7510706">,</span>&nbsp;<span class="string" id="7510708">&#34;&#34;</span><span class="op" id="7510710">}</span><span class="op" id="7510711">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7510715">{</span><span class="string" id="7510716">&#34;;&nbsp;foo=bar&#34;</span><span class="op" id="7510727">,</span>&nbsp;<span class="string" id="7510729">&#34;foo&#34;</span><span class="op" id="7510734">,</span>&nbsp;<span class="string" id="7510736">&#34;bar&#34;</span><span class="op" id="7510741">,</span>&nbsp;<span class="string" id="7510743">&#34;&#34;</span><span class="op" id="7510745">}</span><span class="op" id="7510746">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7510750">{</span><span class="string" id="7510751">&#34;;foo=bar&#34;</span><span class="op" id="7510761">,</span>&nbsp;<span class="string" id="7510763">&#34;foo&#34;</span><span class="op" id="7510768">,</span>&nbsp;<span class="string" id="7510770">&#34;bar&#34;</span><span class="op" id="7510775">,</span>&nbsp;<span class="string" id="7510777">&#34;&#34;</span><span class="op" id="7510779">}</span><span class="op" id="7510780">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7510784">{</span><span class="string" id="7510785">&#34;;FOO=bar&#34;</span><span class="op" id="7510795">,</span>&nbsp;<span class="string" id="7510797">&#34;foo&#34;</span><span class="op" id="7510802">,</span>&nbsp;<span class="string" id="7510804">&#34;bar&#34;</span><span class="op" id="7510809">,</span>&nbsp;<span class="string" id="7510811">&#34;&#34;</span><span class="op" id="7510813">}</span><span class="op" id="7510814">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7510818">{</span><span class="string" id="7510819">`;foo=&#34;bar&#34;`</span><span class="op" id="7510831">,</span>&nbsp;<span class="string" id="7510833">&#34;foo&#34;</span><span class="op" id="7510838">,</span>&nbsp;<span class="string" id="7510840">&#34;bar&#34;</span><span class="op" id="7510845">,</span>&nbsp;<span class="string" id="7510847">&#34;&#34;</span><span class="op" id="7510849">}</span><span class="op" id="7510850">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7510854">{</span><span class="string" id="7510855">`;foo=&#34;bar&#34;;&nbsp;`</span><span class="op" id="7510869">,</span>&nbsp;<span class="string" id="7510871">&#34;foo&#34;</span><span class="op" id="7510876">,</span>&nbsp;<span class="string" id="7510878">&#34;bar&#34;</span><span class="op" id="7510883">,</span>&nbsp;<span class="string" id="7510885">&#34;;&nbsp;&#34;</span><span class="op" id="7510889">}</span><span class="op" id="7510890">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7510894">{</span><span class="string" id="7510895">`;foo=&#34;bar&#34;;&nbsp;foo=baz`</span><span class="op" id="7510916">,</span>&nbsp;<span class="string" id="7510918">&#34;foo&#34;</span><span class="op" id="7510923">,</span>&nbsp;<span class="string" id="7510925">&#34;bar&#34;</span><span class="op" id="7510930">,</span>&nbsp;<span class="string" id="7510932">&#34;;&nbsp;foo=baz&#34;</span><span class="op" id="7510943">}</span><span class="op" id="7510944">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7510948">{</span><span class="string" id="7510949">`&nbsp;;&nbsp;boundary=----CUT;`</span><span class="op" id="7510971">,</span>&nbsp;<span class="string" id="7510973">&#34;boundary&#34;</span><span class="op" id="7510983">,</span>&nbsp;<span class="string" id="7510985">&#34;----CUT&#34;</span><span class="op" id="7510994">,</span>&nbsp;<span class="string" id="7510996">&#34;;&#34;</span><span class="op" id="7510999">}</span><span class="op" id="7511000">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7511004">{</span><span class="string" id="7511005">`&nbsp;;&nbsp;key=value;&nbsp;&nbsp;blah=&#34;value&#34;;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="7511046">,</span>&nbsp;<span class="string" id="7511048">&#34;key&#34;</span><span class="op" id="7511053">,</span>&nbsp;<span class="string" id="7511055">&#34;value&#34;</span><span class="op" id="7511062">,</span>&nbsp;<span class="string" id="7511064">`;&nbsp;&nbsp;blah=&#34;value&#34;;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="7511093">}</span><span class="op" id="7511094">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7511098">{</span><span class="string" id="7511099">`;&nbsp;&nbsp;blah=&#34;value&#34;;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="7511128">,</span>&nbsp;<span class="string" id="7511130">&#34;blah&#34;</span><span class="op" id="7511136">,</span>&nbsp;<span class="string" id="7511138">&#34;value&#34;</span><span class="op" id="7511145">,</span>&nbsp;<span class="string" id="7511147">`;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="7511161">}</span><span class="op" id="7511162">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7511166">{</span><span class="string" id="7511167">`;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="7511181">,</span>&nbsp;<span class="string" id="7511183">&#34;name&#34;</span><span class="op" id="7511189">,</span>&nbsp;<span class="string" id="7511191">&#34;foo&#34;</span><span class="op" id="7511196">,</span>&nbsp;<span class="string" id="7511198">`&nbsp;`</span><span class="op" id="7511201">}</span><span class="op" id="7511202">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7511205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7511208">for</span>&nbsp;<span class="ident" id="7511212">_</span><span class="op" id="7511213">,</span>&nbsp;<span class="ident" id="7511215">test</span>&nbsp;<span class="op" id="7511220">:=</span>&nbsp;<span class="keyword" id="7511223">range</span>&nbsp;<span class="ident" id="7511229">tests</span>&nbsp;<span class="op" id="7511235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7511239">param</span><span class="op" id="7511244">,</span>&nbsp;<span class="ident" id="7511246">value</span><span class="op" id="7511251">,</span>&nbsp;<span class="ident" id="7511253">rest</span>&nbsp;<span class="op" id="7511258">:=</span>&nbsp;<span class="ident" id="7511261">consumeMediaParam</span><span class="op" id="7511278">(</span><span class="ident" id="7511279">test</span><span class="op" id="7511283">[</span><span class="num" id="7511284">0</span><span class="op" id="7511285">]</span><span class="op" id="7511286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7511290">expectedParam</span>&nbsp;<span class="op" id="7511304">:=</span>&nbsp;<span class="ident" id="7511307">test</span><span class="op" id="7511311">[</span><span class="num" id="7511312">1</span><span class="op" id="7511313">]</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7511317">expectedValue</span>&nbsp;<span class="op" id="7511331">:=</span>&nbsp;<span class="ident" id="7511334">test</span><span class="op" id="7511338">[</span><span class="num" id="7511339">2</span><span class="op" id="7511340">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7511344">expectedRest</span>&nbsp;<span class="op" id="7511357">:=</span>&nbsp;<span class="ident" id="7511360">test</span><span class="op" id="7511364">[</span><span class="num" id="7511365">3</span><span class="op" id="7511366">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7511370">if</span>&nbsp;<span class="ident" id="7511373">param</span>&nbsp;<span class="op" id="7511379">!=</span>&nbsp;<span class="ident" id="7511382">expectedParam</span>&nbsp;<span class="op" id="7511396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7511401">t</span><span class="op" id="7511402">.</span><span class="ident" id="7511403">Errorf</span><span class="op" id="7511409">(</span><span class="string" id="7511410">&#34;expected&nbsp;to&nbsp;consume&nbsp;param&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="7511462">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7511468">expectedParam</span><span class="op" id="7511481">,</span>&nbsp;<span class="ident" id="7511483">param</span><span class="op" id="7511488">,</span>&nbsp;<span class="ident" id="7511490">test</span><span class="op" id="7511494">[</span><span class="num" id="7511495">0</span><span class="op" id="7511496">]</span><span class="op" id="7511497">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7511501">}</span>&nbsp;<span class="keyword" id="7511503">else</span>&nbsp;<span class="keyword" id="7511508">if</span>&nbsp;<span class="ident" id="7511511">value</span>&nbsp;<span class="op" id="7511517">!=</span>&nbsp;<span class="ident" id="7511520">expectedValue</span>&nbsp;<span class="op" id="7511534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7511539">t</span><span class="op" id="7511540">.</span><span class="ident" id="7511541">Errorf</span><span class="op" id="7511547">(</span><span class="string" id="7511548">&#34;expected&nbsp;to&nbsp;consume&nbsp;value&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="7511600">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7511606">expectedValue</span><span class="op" id="7511619">,</span>&nbsp;<span class="ident" id="7511621">value</span><span class="op" id="7511626">,</span>&nbsp;<span class="ident" id="7511628">test</span><span class="op" id="7511632">[</span><span class="num" id="7511633">0</span><span class="op" id="7511634">]</span><span class="op" id="7511635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7511639">}</span>&nbsp;<span class="keyword" id="7511641">else</span>&nbsp;<span class="keyword" id="7511646">if</span>&nbsp;<span class="ident" id="7511649">rest</span>&nbsp;<span class="op" id="7511654">!=</span>&nbsp;<span class="ident" id="7511657">expectedRest</span>&nbsp;<span class="op" id="7511670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7511675">t</span><span class="op" id="7511676">.</span><span class="ident" id="7511677">Errorf</span><span class="op" id="7511683">(</span><span class="string" id="7511684">&#34;expected&nbsp;to&nbsp;have&nbsp;left&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;after&nbsp;reading&nbsp;[%s/%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="7511754">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7511760">expectedRest</span><span class="op" id="7511772">,</span>&nbsp;<span class="ident" id="7511774">rest</span><span class="op" id="7511778">,</span>&nbsp;<span class="ident" id="7511780">param</span><span class="op" id="7511785">,</span>&nbsp;<span class="ident" id="7511787">value</span><span class="op" id="7511792">,</span>&nbsp;<span class="ident" id="7511794">test</span><span class="op" id="7511798">[</span><span class="num" id="7511799">0</span><span class="op" id="7511800">]</span><span class="op" id="7511801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7511805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7511808">}</span><br>
<span class="lineno"></span><span class="op" id="7511810">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="7511813">type</span>&nbsp;<span class="ident" id="7511818">mediaTypeTest</span>&nbsp;<span class="keyword" id="7511832">struct</span>&nbsp;<span class="op" id="7511839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7511842">in</span>&nbsp;<span class="builtintype" id="7511845">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7511853">t</span>&nbsp;&nbsp;<span class="builtintype" id="7511856">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7511864">p</span>&nbsp;&nbsp;<span class="keyword" id="7511867">map</span><span class="op" id="7511870">[</span><span class="builtintype" id="7511871">string</span><span class="op" id="7511877">]</span><span class="builtintype" id="7511878">string</span><br>
<span class="lineno"></span><span class="op" id="7511885">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="7511888">func</span>&nbsp;<span class="ident" id="7511893">TestParseMediaType</span><span class="op" id="7511911">(</span><span class="ident" id="7511912">t</span>&nbsp;<span class="op" id="7511914">*</span><span class="ident" id="7511915">testing</span><span class="op" id="7511922">.</span><span class="ident" id="7511923">T</span><span class="op" id="7511924">)</span>&nbsp;<span class="op" id="7511926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7511929">//&nbsp;Convenience&nbsp;map&nbsp;initializer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7511961">m</span>&nbsp;<span class="op" id="7511963">:=</span>&nbsp;<span class="keyword" id="7511966">func</span><span class="op" id="7511970">(</span><span class="ident" id="7511971">s</span>&nbsp;<span class="op" id="7511973">...</span><span class="builtintype" id="7511976">string</span><span class="op" id="7511982">)</span>&nbsp;<span class="keyword" id="7511984">map</span><span class="op" id="7511987">[</span><span class="builtintype" id="7511988">string</span><span class="op" id="7511994">]</span><span class="builtintype" id="7511995">string</span>&nbsp;<span class="op" id="7512002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7512006">sm</span>&nbsp;<span class="op" id="7512009">:=</span>&nbsp;<span class="builtinfunc" id="7512012">make</span><span class="op" id="7512016">(</span><span class="keyword" id="7512017">map</span><span class="op" id="7512020">[</span><span class="builtintype" id="7512021">string</span><span class="op" id="7512027">]</span><span class="builtintype" id="7512028">string</span><span class="op" id="7512034">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7512038">for</span>&nbsp;<span class="ident" id="7512042">i</span>&nbsp;<span class="op" id="7512044">:=</span>&nbsp;<span class="num" id="7512047">0</span><span class="op" id="7512048">;</span>&nbsp;<span class="ident" id="7512050">i</span>&nbsp;<span class="op" id="7512052">&lt;</span>&nbsp;<span class="builtinfunc" id="7512054">len</span><span class="op" id="7512057">(</span><span class="ident" id="7512058">s</span><span class="op" id="7512059">)</span><span class="op" id="7512060">;</span>&nbsp;<span class="ident" id="7512062">i</span>&nbsp;<span class="op" id="7512064">+=</span>&nbsp;<span class="num" id="7512067">2</span>&nbsp;<span class="op" id="7512069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7512074">sm</span><span class="op" id="7512076">[</span><span class="ident" id="7512077">s</span><span class="op" id="7512078">[</span><span class="ident" id="7512079">i</span><span class="op" id="7512080">]</span><span class="op" id="7512081">]</span>&nbsp;<span class="op" id="7512083">=</span>&nbsp;<span class="ident" id="7512085">s</span><span class="op" id="7512086">[</span><span class="ident" id="7512087">i</span><span class="op" id="7512088">+</span><span class="num" id="7512089">1</span><span class="op" id="7512090">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7512094">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7512098">return</span>&nbsp;<span class="ident" id="7512105">sm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7512109">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7512113">nameFoo</span>&nbsp;<span class="op" id="7512121">:=</span>&nbsp;<span class="keyword" id="7512124">map</span><span class="op" id="7512127">[</span><span class="builtintype" id="7512128">string</span><span class="op" id="7512134">]</span><span class="builtintype" id="7512135">string</span><span class="op" id="7512141">{</span><span class="string" id="7512142">&#34;name&#34;</span><span class="op" id="7512148">:</span>&nbsp;<span class="string" id="7512150">&#34;foo&#34;</span><span class="op" id="7512155">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7512158">tests</span>&nbsp;<span class="op" id="7512164">:=</span>&nbsp;<span class="op" id="7512167">[</span><span class="op" id="7512168">]</span><span class="ident" id="7512169">mediaTypeTest</span><span class="op" id="7512182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7512186">{</span><span class="string" id="7512187">`form-data;&nbsp;name=&#34;foo&#34;`</span><span class="op" id="7512210">,</span>&nbsp;<span class="string" id="7512212">&#34;form-data&#34;</span><span class="op" id="7512223">,</span>&nbsp;<span class="ident" id="7512225">nameFoo</span><span class="op" id="7512232">}</span><span class="op" id="7512233">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7512237">{</span><span class="string" id="7512238">`&nbsp;form-data&nbsp;;&nbsp;name=foo`</span><span class="op" id="7512261">,</span>&nbsp;<span class="string" id="7512263">&#34;form-data&#34;</span><span class="op" id="7512274">,</span>&nbsp;<span class="ident" id="7512276">nameFoo</span><span class="op" id="7512283">}</span><span class="op" id="7512284">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7512288">{</span><span class="string" id="7512289">`FORM-DATA;name=&#34;foo&#34;`</span><span class="op" id="7512311">,</span>&nbsp;<span class="string" id="7512313">&#34;form-data&#34;</span><span class="op" id="7512324">,</span>&nbsp;<span class="ident" id="7512326">nameFoo</span><span class="op" id="7512333">}</span><span class="op" id="7512334">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7512338">{</span><span class="string" id="7512339">`&nbsp;FORM-DATA&nbsp;;&nbsp;name=&#34;foo&#34;`</span><span class="op" id="7512364">,</span>&nbsp;<span class="string" id="7512366">&#34;form-data&#34;</span><span class="op" id="7512377">,</span>&nbsp;<span class="ident" id="7512379">nameFoo</span><span class="op" id="7512386">}</span><span class="op" id="7512387">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7512391">{</span><span class="string" id="7512392">`&nbsp;FORM-DATA&nbsp;;&nbsp;name=&#34;foo&#34;`</span><span class="op" id="7512417">,</span>&nbsp;<span class="string" id="7512419">&#34;form-data&#34;</span><span class="op" id="7512430">,</span>&nbsp;<span class="ident" id="7512432">nameFoo</span><span class="op" id="7512439">}</span><span class="op" id="7512440">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7512445">{</span><span class="string" id="7512446">`form-data;&nbsp;key=value;&nbsp;&nbsp;blah=&#34;value&#34;;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="7512495">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7512500">&#34;form-data&#34;</span><span class="op" id="7512511">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7512516">m</span><span class="op" id="7512517">(</span><span class="string" id="7512518">&#34;key&#34;</span><span class="op" id="7512523">,</span>&nbsp;<span class="string" id="7512525">&#34;value&#34;</span><span class="op" id="7512532">,</span>&nbsp;<span class="string" id="7512534">&#34;blah&#34;</span><span class="op" id="7512540">,</span>&nbsp;<span class="string" id="7512542">&#34;value&#34;</span><span class="op" id="7512549">,</span>&nbsp;<span class="string" id="7512551">&#34;name&#34;</span><span class="op" id="7512557">,</span>&nbsp;<span class="string" id="7512559">&#34;foo&#34;</span><span class="op" id="7512564">)</span><span class="op" id="7512565">}</span><span class="op" id="7512566">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7512571">{</span><span class="string" id="7512572">`foo;&nbsp;key=val1;&nbsp;key=the-key-appears-again-which-is-bogus`</span><span class="op" id="7512629">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7512634">&#34;&#34;</span><span class="op" id="7512636">,</span>&nbsp;<span class="ident" id="7512638">m</span><span class="op" id="7512639">(</span><span class="op" id="7512640">)</span><span class="op" id="7512641">}</span><span class="op" id="7512642">,</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7512647">//&nbsp;From&nbsp;RFC&nbsp;2231:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7512667">{</span><span class="string" id="7512668">`application/x-stuff;&nbsp;title*=us-ascii&#39;en-us&#39;This%20is%20%2A%2A%2Afun%2A%2A%2A`</span><span class="op" id="7512746">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7512751">&#34;application/x-stuff&#34;</span><span class="op" id="7512772">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7512777">m</span><span class="op" id="7512778">(</span><span class="string" id="7512779">&#34;title&#34;</span><span class="op" id="7512786">,</span>&nbsp;<span class="string" id="7512788">&#34;This&nbsp;is&nbsp;***fun***&#34;</span><span class="op" id="7512807">)</span><span class="op" id="7512808">}</span><span class="op" id="7512809">,</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7512814">{</span><span class="string" id="7512815">`message/external-body;&nbsp;access-type=URL;&nbsp;`</span>&nbsp;<span class="op" id="7512858">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7512863">`URL*0=&#34;ftp://&#34;;`</span>&nbsp;<span class="op" id="7512881">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7512886">`URL*1=&#34;cs.utk.edu/pub/moore/bulk-mailer/bulk-mailer.tar&#34;`</span><span class="op" id="7512944">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7512949">&#34;message/external-body&#34;</span><span class="op" id="7512972">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7512977">m</span><span class="op" id="7512978">(</span><span class="string" id="7512979">&#34;access-type&#34;</span><span class="op" id="7512992">,</span>&nbsp;<span class="string" id="7512994">&#34;URL&#34;</span><span class="op" id="7512999">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7513005">&#34;url&#34;</span><span class="op" id="7513010">,</span>&nbsp;<span class="string" id="7513012">&#34;ftp://cs.utk.edu/pub/moore/bulk-mailer/bulk-mailer.tar&#34;</span><span class="op" id="7513068">)</span><span class="op" id="7513069">}</span><span class="op" id="7513070">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7513075">{</span><span class="string" id="7513076">`application/x-stuff;&nbsp;`</span>&nbsp;<span class="op" id="7513100">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7513105">`title*0*=us-ascii&#39;en&#39;This%20is%20even%20more%20;&nbsp;`</span>&nbsp;<span class="op" id="7513157">+</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7513162">`title*1*=%2A%2A%2Afun%2A%2A%2A%20;&nbsp;`</span>&nbsp;<span class="op" id="7513200">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7513205">`title*2=&#34;isn&#39;t&nbsp;it!&#34;`</span><span class="op" id="7513226">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7513231">&#34;application/x-stuff&#34;</span><span class="op" id="7513252">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7513257">m</span><span class="op" id="7513258">(</span><span class="string" id="7513259">&#34;title&#34;</span><span class="op" id="7513266">,</span>&nbsp;<span class="string" id="7513268">&#34;This&nbsp;is&nbsp;even&nbsp;more&nbsp;***fun***&nbsp;isn&#39;t&nbsp;it!&#34;</span><span class="op" id="7513307">)</span><span class="op" id="7513308">}</span><span class="op" id="7513309">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7513314">//&nbsp;Tests&nbsp;from&nbsp;http://greenbytes.de/tech/tc2231/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7513364">//&nbsp;TODO(bradfitz):&nbsp;add&nbsp;the&nbsp;rest&nbsp;of&nbsp;the&nbsp;tests&nbsp;from&nbsp;that&nbsp;site.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7513427">{</span><span class="string" id="7513428">`attachment;&nbsp;filename=&#34;f\oo.html&#34;`</span><span class="op" id="7513462">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7513467">&#34;attachment&#34;</span><span class="op" id="7513479">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7513484">m</span><span class="op" id="7513485">(</span><span class="string" id="7513486">&#34;filename&#34;</span><span class="op" id="7513496">,</span>&nbsp;<span class="string" id="7513498">&#34;foo.html&#34;</span><span class="op" id="7513508">)</span><span class="op" id="7513509">}</span><span class="op" id="7513510">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7513514">{</span><span class="string" id="7513515">`attachment;&nbsp;filename=&#34;\&#34;quoting\&#34;&nbsp;tested.html&#34;`</span><span class="op" id="7513563">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7513568">&#34;attachment&#34;</span><span class="op" id="7513580">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7513585">m</span><span class="op" id="7513586">(</span><span class="string" id="7513587">&#34;filename&#34;</span><span class="op" id="7513597">,</span>&nbsp;<span class="string" id="7513599">`&#34;quoting&#34;&nbsp;tested.html`</span><span class="op" id="7513622">)</span><span class="op" id="7513623">}</span><span class="op" id="7513624">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7513628">{</span><span class="string" id="7513629">`attachment;&nbsp;filename=&#34;Here&#39;s&nbsp;a&nbsp;semicolon;.html&#34;`</span><span class="op" id="7513678">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7513683">&#34;attachment&#34;</span><span class="op" id="7513695">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7513700">m</span><span class="op" id="7513701">(</span><span class="string" id="7513702">&#34;filename&#34;</span><span class="op" id="7513712">,</span>&nbsp;<span class="string" id="7513714">&#34;Here&#39;s&nbsp;a&nbsp;semicolon;.html&#34;</span><span class="op" id="7513740">)</span><span class="op" id="7513741">}</span><span class="op" id="7513742">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7513746">{</span><span class="string" id="7513747">`attachment;&nbsp;foo=&#34;\&#34;\\&#34;;filename=&#34;foo.html&#34;`</span><span class="op" id="7513791">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7513796">&#34;attachment&#34;</span><span class="op" id="7513808">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7513813">m</span><span class="op" id="7513814">(</span><span class="string" id="7513815">&#34;foo&#34;</span><span class="op" id="7513820">,</span>&nbsp;<span class="string" id="7513822">&#34;\&#34;\\&#34;</span><span class="op" id="7513828">,</span>&nbsp;<span class="string" id="7513830">&#34;filename&#34;</span><span class="op" id="7513840">,</span>&nbsp;<span class="string" id="7513842">&#34;foo.html&#34;</span><span class="op" id="7513852">)</span><span class="op" id="7513853">}</span><span class="op" id="7513854">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7513858">{</span><span class="string" id="7513859">`attachment;&nbsp;filename=foo.html`</span><span class="op" id="7513890">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7513895">&#34;attachment&#34;</span><span class="op" id="7513907">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7513912">m</span><span class="op" id="7513913">(</span><span class="string" id="7513914">&#34;filename&#34;</span><span class="op" id="7513924">,</span>&nbsp;<span class="string" id="7513926">&#34;foo.html&#34;</span><span class="op" id="7513936">)</span><span class="op" id="7513937">}</span><span class="op" id="7513938">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7513942">{</span><span class="string" id="7513943">`attachment;&nbsp;filename=foo.html&nbsp;;`</span><span class="op" id="7513976">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7513981">&#34;attachment&#34;</span><span class="op" id="7513993">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7513998">m</span><span class="op" id="7513999">(</span><span class="string" id="7514000">&#34;filename&#34;</span><span class="op" id="7514010">,</span>&nbsp;<span class="string" id="7514012">&#34;foo.html&#34;</span><span class="op" id="7514022">)</span><span class="op" id="7514023">}</span><span class="op" id="7514024">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7514028">{</span><span class="string" id="7514029">`attachment;&nbsp;filename=&#39;foo.html&#39;`</span><span class="op" id="7514062">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7514067">&#34;attachment&#34;</span><span class="op" id="7514079">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7514084">m</span><span class="op" id="7514085">(</span><span class="string" id="7514086">&#34;filename&#34;</span><span class="op" id="7514096">,</span>&nbsp;<span class="string" id="7514098">&#34;foo.html&#34;</span><span class="op" id="7514108">)</span><span class="op" id="7514109">}</span><span class="op" id="7514110">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7514114">{</span><span class="string" id="7514115">`attachment;&nbsp;filename=&#34;foo-%41.html&#34;`</span><span class="op" id="7514152">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7514157">&#34;attachment&#34;</span><span class="op" id="7514169">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7514174">m</span><span class="op" id="7514175">(</span><span class="string" id="7514176">&#34;filename&#34;</span><span class="op" id="7514186">,</span>&nbsp;<span class="string" id="7514188">&#34;foo-%41.html&#34;</span><span class="op" id="7514202">)</span><span class="op" id="7514203">}</span><span class="op" id="7514204">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7514208">{</span><span class="string" id="7514209">`attachment;&nbsp;filename=&#34;foo-%\41.html&#34;`</span><span class="op" id="7514247">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7514252">&#34;attachment&#34;</span><span class="op" id="7514264">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7514269">m</span><span class="op" id="7514270">(</span><span class="string" id="7514271">&#34;filename&#34;</span><span class="op" id="7514281">,</span>&nbsp;<span class="string" id="7514283">&#34;foo-%41.html&#34;</span><span class="op" id="7514297">)</span><span class="op" id="7514298">}</span><span class="op" id="7514299">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7514303">{</span><span class="string" id="7514304">`filename=foo.html`</span><span class="op" id="7514323">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7514328">&#34;&#34;</span><span class="op" id="7514330">,</span>&nbsp;<span class="ident" id="7514332">m</span><span class="op" id="7514333">(</span><span class="op" id="7514334">)</span><span class="op" id="7514335">}</span><span class="op" id="7514336">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7514340">{</span><span class="string" id="7514341">`x=y;&nbsp;filename=foo.html`</span><span class="op" id="7514365">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7514370">&#34;&#34;</span><span class="op" id="7514372">,</span>&nbsp;<span class="ident" id="7514374">m</span><span class="op" id="7514375">(</span><span class="op" id="7514376">)</span><span class="op" id="7514377">}</span><span class="op" id="7514378">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7514382">{</span><span class="string" id="7514383">`&#34;foo;&nbsp;filename=bar;baz&#34;;&nbsp;filename=qux`</span><span class="op" id="7514422">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7514427">&#34;&#34;</span><span class="op" id="7514429">,</span>&nbsp;<span class="ident" id="7514431">m</span><span class="op" id="7514432">(</span><span class="op" id="7514433">)</span><span class="op" id="7514434">}</span><span class="op" id="7514435">,</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7514439">{</span><span class="string" id="7514440">`inline;&nbsp;attachment;&nbsp;filename=foo.html`</span><span class="op" id="7514479">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7514484">&#34;&#34;</span><span class="op" id="7514486">,</span>&nbsp;<span class="ident" id="7514488">m</span><span class="op" id="7514489">(</span><span class="op" id="7514490">)</span><span class="op" id="7514491">}</span><span class="op" id="7514492">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7514496">{</span><span class="string" id="7514497">`attachment;&nbsp;filename=&#34;foo.html&#34;.txt`</span><span class="op" id="7514534">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7514539">&#34;&#34;</span><span class="op" id="7514541">,</span>&nbsp;<span class="ident" id="7514543">m</span><span class="op" id="7514544">(</span><span class="op" id="7514545">)</span><span class="op" id="7514546">}</span><span class="op" id="7514547">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7514551">{</span><span class="string" id="7514552">`attachment;&nbsp;filename=&#34;bar`</span><span class="op" id="7514579">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7514584">&#34;&#34;</span><span class="op" id="7514586">,</span>&nbsp;<span class="ident" id="7514588">m</span><span class="op" id="7514589">(</span><span class="op" id="7514590">)</span><span class="op" id="7514591">}</span><span class="op" id="7514592">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7514596">{</span><span class="string" id="7514597">`attachment;&nbsp;creation-date=&#34;Wed,&nbsp;12&nbsp;Feb&nbsp;1997&nbsp;16:29:51&nbsp;-0500&#34;`</span><span class="op" id="7514658">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7514663">&#34;attachment&#34;</span><span class="op" id="7514675">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7514680">m</span><span class="op" id="7514681">(</span><span class="string" id="7514682">&#34;creation-date&#34;</span><span class="op" id="7514697">,</span>&nbsp;<span class="string" id="7514699">&#34;Wed,&nbsp;12&nbsp;Feb&nbsp;1997&nbsp;16:29:51&nbsp;-0500&#34;</span><span class="op" id="7514732">)</span><span class="op" id="7514733">}</span><span class="op" id="7514734">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7514738">{</span><span class="string" id="7514739">`foobar`</span><span class="op" id="7514747">,</span>&nbsp;<span class="string" id="7514749">&#34;foobar&#34;</span><span class="op" id="7514757">,</span>&nbsp;<span class="ident" id="7514759">m</span><span class="op" id="7514760">(</span><span class="op" id="7514761">)</span><span class="op" id="7514762">}</span><span class="op" id="7514763">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7514767">{</span><span class="string" id="7514768">`attachment;&nbsp;filename*&nbsp;=UTF-8&#39;&#39;foo-%c3%a4.html`</span><span class="op" id="7514815">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7514820">&#34;attachment&#34;</span><span class="op" id="7514832">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7514837">m</span><span class="op" id="7514838">(</span><span class="string" id="7514839">&#34;filename&#34;</span><span class="op" id="7514849">,</span>&nbsp;<span class="string" id="7514851">&#34;foo-.html&#34;</span><span class="op" id="7514864">)</span><span class="op" id="7514865">}</span><span class="op" id="7514866">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7514870">{</span><span class="string" id="7514871">`attachment;&nbsp;filename*=UTF-8&#39;&#39;A-%2541.html`</span><span class="op" id="7514914">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7514919">&#34;attachment&#34;</span><span class="op" id="7514931">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7514936">m</span><span class="op" id="7514937">(</span><span class="string" id="7514938">&#34;filename&#34;</span><span class="op" id="7514948">,</span>&nbsp;<span class="string" id="7514950">&#34;A-%41.html&#34;</span><span class="op" id="7514962">)</span><span class="op" id="7514963">}</span><span class="op" id="7514964">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7514968">{</span><span class="string" id="7514969">`attachment;&nbsp;filename*0=&#34;foo.&#34;;&nbsp;filename*1=&#34;html&#34;`</span><span class="op" id="7515019">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7515024">&#34;attachment&#34;</span><span class="op" id="7515036">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7515041">m</span><span class="op" id="7515042">(</span><span class="string" id="7515043">&#34;filename&#34;</span><span class="op" id="7515053">,</span>&nbsp;<span class="string" id="7515055">&#34;foo.html&#34;</span><span class="op" id="7515065">)</span><span class="op" id="7515066">}</span><span class="op" id="7515067">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7515071">{</span><span class="string" id="7515072">`attachment;&nbsp;filename*0*=UTF-8&#39;&#39;foo-%c3%a4;&nbsp;filename*1=&#34;.html&#34;`</span><span class="op" id="7515135">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7515140">&#34;attachment&#34;</span><span class="op" id="7515152">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7515157">m</span><span class="op" id="7515158">(</span><span class="string" id="7515159">&#34;filename&#34;</span><span class="op" id="7515169">,</span>&nbsp;<span class="string" id="7515171">&#34;foo-.html&#34;</span><span class="op" id="7515184">)</span><span class="op" id="7515185">}</span><span class="op" id="7515186">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7515190">{</span><span class="string" id="7515191">`attachment;&nbsp;filename*0=&#34;foo&#34;;&nbsp;filename*01=&#34;bar&#34;`</span><span class="op" id="7515240">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7515245">&#34;attachment&#34;</span><span class="op" id="7515257">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7515262">m</span><span class="op" id="7515263">(</span><span class="string" id="7515264">&#34;filename&#34;</span><span class="op" id="7515274">,</span>&nbsp;<span class="string" id="7515276">&#34;foo&#34;</span><span class="op" id="7515281">)</span><span class="op" id="7515282">}</span><span class="op" id="7515283">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7515287">{</span><span class="string" id="7515288">`attachment;&nbsp;filename*0=&#34;foo&#34;;&nbsp;filename*2=&#34;bar&#34;`</span><span class="op" id="7515336">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7515341">&#34;attachment&#34;</span><span class="op" id="7515353">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7515358">m</span><span class="op" id="7515359">(</span><span class="string" id="7515360">&#34;filename&#34;</span><span class="op" id="7515370">,</span>&nbsp;<span class="string" id="7515372">&#34;foo&#34;</span><span class="op" id="7515377">)</span><span class="op" id="7515378">}</span><span class="op" id="7515379">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7515383">{</span><span class="string" id="7515384">`attachment;&nbsp;filename*1=&#34;foo&#34;;&nbsp;filename*2=&#34;bar&#34;`</span><span class="op" id="7515432">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7515437">&#34;attachment&#34;</span><span class="op" id="7515449">,</span>&nbsp;<span class="ident" id="7515451">m</span><span class="op" id="7515452">(</span><span class="op" id="7515453">)</span><span class="op" id="7515454">}</span><span class="op" id="7515455">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7515459">{</span><span class="string" id="7515460">`attachment;&nbsp;filename*1=&#34;bar&#34;;&nbsp;filename*0=&#34;foo&#34;`</span><span class="op" id="7515508">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7515513">&#34;attachment&#34;</span><span class="op" id="7515525">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7515530">m</span><span class="op" id="7515531">(</span><span class="string" id="7515532">&#34;filename&#34;</span><span class="op" id="7515542">,</span>&nbsp;<span class="string" id="7515544">&#34;foobar&#34;</span><span class="op" id="7515552">)</span><span class="op" id="7515553">}</span><span class="op" id="7515554">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7515558">{</span><span class="string" id="7515559">`attachment;&nbsp;filename=&#34;foo-ae.html&#34;;&nbsp;filename*=UTF-8&#39;&#39;foo-%c3%a4.html`</span><span class="op" id="7515629">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7515634">&#34;attachment&#34;</span><span class="op" id="7515646">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7515651">m</span><span class="op" id="7515652">(</span><span class="string" id="7515653">&#34;filename&#34;</span><span class="op" id="7515663">,</span>&nbsp;<span class="string" id="7515665">&#34;foo-.html&#34;</span><span class="op" id="7515678">)</span><span class="op" id="7515679">}</span><span class="op" id="7515680">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7515684">{</span><span class="string" id="7515685">`attachment;&nbsp;filename*=UTF-8&#39;&#39;foo-%c3%a4.html;&nbsp;filename=&#34;foo-ae.html&#34;`</span><span class="op" id="7515755">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7515760">&#34;attachment&#34;</span><span class="op" id="7515772">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7515777">m</span><span class="op" id="7515778">(</span><span class="string" id="7515779">&#34;filename&#34;</span><span class="op" id="7515789">,</span>&nbsp;<span class="string" id="7515791">&#34;foo-.html&#34;</span><span class="op" id="7515804">)</span><span class="op" id="7515805">}</span><span class="op" id="7515806">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7515811">//&nbsp;Browsers&nbsp;also&nbsp;just&nbsp;send&nbsp;UTF-8&nbsp;directly&nbsp;without&nbsp;RFC&nbsp;2231,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7515873">//&nbsp;at&nbsp;least&nbsp;when&nbsp;the&nbsp;source&nbsp;page&nbsp;is&nbsp;served&nbsp;with&nbsp;UTF-8.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7515930">{</span><span class="string" id="7515931">`form-data;&nbsp;firstname=&#34;&#34;;&nbsp;lastname=&#34;&#34;`</span><span class="op" id="7515995">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7516000">&#34;form-data&#34;</span><span class="op" id="7516011">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7516016">m</span><span class="op" id="7516017">(</span><span class="string" id="7516018">&#34;firstname&#34;</span><span class="op" id="7516029">,</span>&nbsp;<span class="string" id="7516031">&#34;&#34;</span><span class="op" id="7516041">,</span>&nbsp;<span class="string" id="7516043">&#34;lastname&#34;</span><span class="op" id="7516053">,</span>&nbsp;<span class="string" id="7516055">&#34;&#34;</span><span class="op" id="7516075">)</span><span class="op" id="7516076">}</span><span class="op" id="7516077">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7516080">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7516083">for</span>&nbsp;<span class="ident" id="7516087">_</span><span class="op" id="7516088">,</span>&nbsp;<span class="ident" id="7516090">test</span>&nbsp;<span class="op" id="7516095">:=</span>&nbsp;<span class="keyword" id="7516098">range</span>&nbsp;<span class="ident" id="7516104">tests</span>&nbsp;<span class="op" id="7516110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7516114">mt</span><span class="op" id="7516116">,</span>&nbsp;<span class="ident" id="7516118">params</span><span class="op" id="7516124">,</span>&nbsp;<span class="ident" id="7516126">err</span>&nbsp;<span class="op" id="7516130">:=</span>&nbsp;<span class="ident" id="7516133">ParseMediaType</span><span class="op" id="7516147">(</span><span class="ident" id="7516148">test</span><span class="op" id="7516152">.</span><span class="ident" id="7516153">in</span><span class="op" id="7516155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7516159">if</span>&nbsp;<span class="ident" id="7516162">err</span>&nbsp;<span class="op" id="7516166">!=</span>&nbsp;<span class="ident" id="7516169">nil</span>&nbsp;<span class="op" id="7516173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7516178">if</span>&nbsp;<span class="ident" id="7516181">test</span><span class="op" id="7516185">.</span><span class="ident" id="7516186">t</span>&nbsp;<span class="op" id="7516188">!=</span>&nbsp;<span class="string" id="7516191">&#34;&#34;</span>&nbsp;<span class="op" id="7516194">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7516200">t</span><span class="op" id="7516201">.</span><span class="ident" id="7516202">Errorf</span><span class="op" id="7516208">(</span><span class="string" id="7516209">&#34;for&nbsp;input&nbsp;%q,&nbsp;unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="7516245">,</span>&nbsp;<span class="ident" id="7516247">test</span><span class="op" id="7516251">.</span><span class="ident" id="7516252">in</span><span class="op" id="7516254">,</span>&nbsp;<span class="ident" id="7516256">err</span><span class="op" id="7516259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7516265">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7516277">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7516282">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7516293">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7516297">if</span>&nbsp;<span class="ident" id="7516300">g</span><span class="op" id="7516301">,</span>&nbsp;<span class="ident" id="7516303">e</span>&nbsp;<span class="op" id="7516305">:=</span>&nbsp;<span class="ident" id="7516308">mt</span><span class="op" id="7516310">,</span>&nbsp;<span class="ident" id="7516312">test</span><span class="op" id="7516316">.</span><span class="ident" id="7516317">t</span><span class="op" id="7516318">;</span>&nbsp;<span class="ident" id="7516320">g</span>&nbsp;<span class="op" id="7516322">!=</span>&nbsp;<span class="ident" id="7516325">e</span>&nbsp;<span class="op" id="7516327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7516332">t</span><span class="op" id="7516333">.</span><span class="ident" id="7516334">Errorf</span><span class="op" id="7516340">(</span><span class="string" id="7516341">&#34;for&nbsp;input&nbsp;%q,&nbsp;expected&nbsp;type&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7516381">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7516387">test</span><span class="op" id="7516391">.</span><span class="ident" id="7516392">in</span><span class="op" id="7516394">,</span>&nbsp;<span class="ident" id="7516396">e</span><span class="op" id="7516397">,</span>&nbsp;<span class="ident" id="7516399">g</span><span class="op" id="7516400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7516405">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7516416">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7516420">if</span>&nbsp;<span class="builtinfunc" id="7516423">len</span><span class="op" id="7516426">(</span><span class="ident" id="7516427">params</span><span class="op" id="7516433">)</span>&nbsp;<span class="op" id="7516435">==</span>&nbsp;<span class="num" id="7516438">0</span>&nbsp;<span class="op" id="7516440">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="7516443">len</span><span class="op" id="7516446">(</span><span class="ident" id="7516447">test</span><span class="op" id="7516451">.</span><span class="ident" id="7516452">p</span><span class="op" id="7516453">)</span>&nbsp;<span class="op" id="7516455">==</span>&nbsp;<span class="num" id="7516458">0</span>&nbsp;<span class="op" id="7516460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7516465">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7516476">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7516480">if</span>&nbsp;<span class="op" id="7516483">!</span><span class="ident" id="7516484">reflect</span><span class="op" id="7516491">.</span><span class="ident" id="7516492">DeepEqual</span><span class="op" id="7516501">(</span><span class="ident" id="7516502">params</span><span class="op" id="7516508">,</span>&nbsp;<span class="ident" id="7516510">test</span><span class="op" id="7516514">.</span><span class="ident" id="7516515">p</span><span class="op" id="7516516">)</span>&nbsp;<span class="op" id="7516518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7516523">t</span><span class="op" id="7516524">.</span><span class="ident" id="7516525">Errorf</span><span class="op" id="7516531">(</span><span class="string" id="7516532">&#34;for&nbsp;input&nbsp;%q,&nbsp;wrong&nbsp;params.\n&#34;</span><span class="op" id="7516563">+</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7516569">&#34;expected:&nbsp;%#v\n&#34;</span><span class="op" id="7516586">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7516592">&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;got:&nbsp;%#v&#34;</span><span class="op" id="7516607">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7516613">test</span><span class="op" id="7516617">.</span><span class="ident" id="7516618">in</span><span class="op" id="7516620">,</span>&nbsp;<span class="ident" id="7516622">test</span><span class="op" id="7516626">.</span><span class="ident" id="7516627">p</span><span class="op" id="7516628">,</span>&nbsp;<span class="ident" id="7516630">params</span><span class="op" id="7516636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7516640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7516643">}</span><br>
<span class="lineno">245</span><span class="op" id="7516645">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7516648">type</span>&nbsp;<span class="ident" id="7516653">badMediaTypeTest</span>&nbsp;<span class="keyword" id="7516670">struct</span>&nbsp;<span class="op" id="7516677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7516680">in</span>&nbsp;&nbsp;<span class="builtintype" id="7516684">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7516692">err</span>&nbsp;<span class="builtintype" id="7516696">string</span><br>
<span class="lineno">250</span><span class="op" id="7516703">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7516706">var</span>&nbsp;<span class="ident" id="7516710">badMediaTypeTests</span>&nbsp;<span class="op" id="7516728">=</span>&nbsp;<span class="op" id="7516730">[</span><span class="op" id="7516731">]</span><span class="ident" id="7516732">badMediaTypeTest</span><span class="op" id="7516748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7516751">{</span><span class="string" id="7516752">&#34;bogus&nbsp;;=========&#34;</span><span class="op" id="7516770">,</span>&nbsp;<span class="string" id="7516772">&#34;mime:&nbsp;invalid&nbsp;media&nbsp;parameter&#34;</span><span class="op" id="7516803">}</span><span class="op" id="7516804">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7516807">{</span><span class="string" id="7516808">&#34;bogus/&lt;script&gt;alert&lt;/script&gt;&#34;</span><span class="op" id="7516838">,</span>&nbsp;<span class="string" id="7516840">&#34;mime:&nbsp;expected&nbsp;token&nbsp;after&nbsp;slash&#34;</span><span class="op" id="7516874">}</span><span class="op" id="7516875">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7516878">{</span><span class="string" id="7516879">&#34;bogus/bogus&lt;script&gt;alert&lt;/script&gt;&#34;</span><span class="op" id="7516914">,</span>&nbsp;<span class="string" id="7516916">&#34;mime:&nbsp;unexpected&nbsp;content&nbsp;after&nbsp;media&nbsp;subtype&#34;</span><span class="op" id="7516962">}</span><span class="op" id="7516963">,</span><br>
<span class="lineno"></span><span class="op" id="7516965">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7516968">func</span>&nbsp;<span class="ident" id="7516973">TestParseMediaTypeBogus</span><span class="op" id="7516996">(</span><span class="ident" id="7516997">t</span>&nbsp;<span class="op" id="7516999">*</span><span class="ident" id="7517000">testing</span><span class="op" id="7517007">.</span><span class="ident" id="7517008">T</span><span class="op" id="7517009">)</span>&nbsp;<span class="op" id="7517011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7517014">for</span>&nbsp;<span class="ident" id="7517018">_</span><span class="op" id="7517019">,</span>&nbsp;<span class="ident" id="7517021">tt</span>&nbsp;<span class="op" id="7517024">:=</span>&nbsp;<span class="keyword" id="7517027">range</span>&nbsp;<span class="ident" id="7517033">badMediaTypeTests</span>&nbsp;<span class="op" id="7517051">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7517055">mt</span><span class="op" id="7517057">,</span>&nbsp;<span class="ident" id="7517059">params</span><span class="op" id="7517065">,</span>&nbsp;<span class="ident" id="7517067">err</span>&nbsp;<span class="op" id="7517071">:=</span>&nbsp;<span class="ident" id="7517074">ParseMediaType</span><span class="op" id="7517088">(</span><span class="ident" id="7517089">tt</span><span class="op" id="7517091">.</span><span class="ident" id="7517092">in</span><span class="op" id="7517094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7517098">if</span>&nbsp;<span class="ident" id="7517101">err</span>&nbsp;<span class="op" id="7517105">==</span>&nbsp;<span class="ident" id="7517108">nil</span>&nbsp;<span class="op" id="7517112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7517117">t</span><span class="op" id="7517118">.</span><span class="ident" id="7517119">Errorf</span><span class="op" id="7517125">(</span><span class="string" id="7517126">&#34;ParseMediaType(%q)&nbsp;=&nbsp;nil&nbsp;error;&nbsp;want&nbsp;parse&nbsp;error&#34;</span><span class="op" id="7517176">,</span>&nbsp;<span class="ident" id="7517178">tt</span><span class="op" id="7517180">.</span><span class="ident" id="7517181">in</span><span class="op" id="7517183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7517188">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7517199">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7517203">if</span>&nbsp;<span class="ident" id="7517206">err</span><span class="op" id="7517209">.</span><span class="ident" id="7517210">Error</span><span class="op" id="7517215">(</span><span class="op" id="7517216">)</span>&nbsp;<span class="op" id="7517218">!=</span>&nbsp;<span class="ident" id="7517221">tt</span><span class="op" id="7517223">.</span><span class="ident" id="7517224">err</span>&nbsp;<span class="op" id="7517228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7517233">t</span><span class="op" id="7517234">.</span><span class="ident" id="7517235">Errorf</span><span class="op" id="7517241">(</span><span class="string" id="7517242">&#34;ParseMediaType(%q)&nbsp;=&nbsp;err&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7517280">,</span>&nbsp;<span class="ident" id="7517282">tt</span><span class="op" id="7517284">.</span><span class="ident" id="7517285">in</span><span class="op" id="7517287">,</span>&nbsp;<span class="ident" id="7517289">err</span><span class="op" id="7517292">.</span><span class="ident" id="7517293">Error</span><span class="op" id="7517298">(</span><span class="op" id="7517299">)</span><span class="op" id="7517300">,</span>&nbsp;<span class="ident" id="7517302">tt</span><span class="op" id="7517304">.</span><span class="ident" id="7517305">err</span><span class="op" id="7517308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7517312">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7517316">if</span>&nbsp;<span class="ident" id="7517319">params</span>&nbsp;<span class="op" id="7517326">!=</span>&nbsp;<span class="ident" id="7517329">nil</span>&nbsp;<span class="op" id="7517333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7517338">t</span><span class="op" id="7517339">.</span><span class="ident" id="7517340">Errorf</span><span class="op" id="7517346">(</span><span class="string" id="7517347">&#34;ParseMediaType(%q):&nbsp;got&nbsp;non-nil&nbsp;params&nbsp;on&nbsp;error&#34;</span><span class="op" id="7517396">,</span>&nbsp;<span class="ident" id="7517398">tt</span><span class="op" id="7517400">.</span><span class="ident" id="7517401">in</span><span class="op" id="7517403">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7517407">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7517411">if</span>&nbsp;<span class="ident" id="7517414">mt</span>&nbsp;<span class="op" id="7517417">!=</span>&nbsp;<span class="string" id="7517420">&#34;&#34;</span>&nbsp;<span class="op" id="7517423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7517428">t</span><span class="op" id="7517429">.</span><span class="ident" id="7517430">Errorf</span><span class="op" id="7517436">(</span><span class="string" id="7517437">&#34;ParseMediaType(%q):&nbsp;got&nbsp;non-empty&nbsp;media&nbsp;type&nbsp;string&nbsp;on&nbsp;error&#34;</span><span class="op" id="7517499">,</span>&nbsp;<span class="ident" id="7517501">tt</span><span class="op" id="7517503">.</span><span class="ident" id="7517504">in</span><span class="op" id="7517506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7517510">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7517513">}</span><br>
<span class="lineno">275</span><span class="op" id="7517515">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7517518">type</span>&nbsp;<span class="ident" id="7517523">formatTest</span>&nbsp;<span class="keyword" id="7517534">struct</span>&nbsp;<span class="op" id="7517541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7517544">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7517551">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7517559">params</span>&nbsp;<span class="keyword" id="7517566">map</span><span class="op" id="7517569">[</span><span class="builtintype" id="7517570">string</span><span class="op" id="7517576">]</span><span class="builtintype" id="7517577">string</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7517585">want</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7517592">string</span><br>
<span class="lineno"></span><span class="op" id="7517599">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7517602">var</span>&nbsp;<span class="ident" id="7517606">formatTests</span>&nbsp;<span class="op" id="7517618">=</span>&nbsp;<span class="op" id="7517620">[</span><span class="op" id="7517621">]</span><span class="ident" id="7517622">formatTest</span><span class="op" id="7517632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7517635">{</span><span class="string" id="7517636">&#34;noslash&#34;</span><span class="op" id="7517645">,</span>&nbsp;<span class="ident" id="7517647">nil</span><span class="op" id="7517650">,</span>&nbsp;<span class="string" id="7517652">&#34;&#34;</span><span class="op" id="7517654">}</span><span class="op" id="7517655">,</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7517658">{</span><span class="string" id="7517659">&#34;foo&nbsp;bar/baz&#34;</span><span class="op" id="7517672">,</span>&nbsp;<span class="ident" id="7517674">nil</span><span class="op" id="7517677">,</span>&nbsp;<span class="string" id="7517679">&#34;&#34;</span><span class="op" id="7517681">}</span><span class="op" id="7517682">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7517685">{</span><span class="string" id="7517686">&#34;foo/bar&nbsp;baz&#34;</span><span class="op" id="7517699">,</span>&nbsp;<span class="ident" id="7517701">nil</span><span class="op" id="7517704">,</span>&nbsp;<span class="string" id="7517706">&#34;&#34;</span><span class="op" id="7517708">}</span><span class="op" id="7517709">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7517712">{</span><span class="string" id="7517713">&#34;foo/BAR&#34;</span><span class="op" id="7517722">,</span>&nbsp;<span class="ident" id="7517724">nil</span><span class="op" id="7517727">,</span>&nbsp;<span class="string" id="7517729">&#34;foo/bar&#34;</span><span class="op" id="7517738">}</span><span class="op" id="7517739">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7517742">{</span><span class="string" id="7517743">&#34;foo/BAR&#34;</span><span class="op" id="7517752">,</span>&nbsp;<span class="keyword" id="7517754">map</span><span class="op" id="7517757">[</span><span class="builtintype" id="7517758">string</span><span class="op" id="7517764">]</span><span class="builtintype" id="7517765">string</span><span class="op" id="7517771">{</span><span class="string" id="7517772">&#34;X&#34;</span><span class="op" id="7517775">:</span>&nbsp;<span class="string" id="7517777">&#34;Y&#34;</span><span class="op" id="7517780">}</span><span class="op" id="7517781">,</span>&nbsp;<span class="string" id="7517783">&#34;foo/bar;&nbsp;x=Y&#34;</span><span class="op" id="7517797">}</span><span class="op" id="7517798">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7517801">{</span><span class="string" id="7517802">&#34;foo/BAR&#34;</span><span class="op" id="7517811">,</span>&nbsp;<span class="keyword" id="7517813">map</span><span class="op" id="7517816">[</span><span class="builtintype" id="7517817">string</span><span class="op" id="7517823">]</span><span class="builtintype" id="7517824">string</span><span class="op" id="7517830">{</span><span class="string" id="7517831">&#34;space&#34;</span><span class="op" id="7517838">:</span>&nbsp;<span class="string" id="7517840">&#34;With&nbsp;space&#34;</span><span class="op" id="7517852">}</span><span class="op" id="7517853">,</span>&nbsp;<span class="string" id="7517855">`foo/bar;&nbsp;space=&#34;With&nbsp;space&#34;`</span><span class="op" id="7517884">}</span><span class="op" id="7517885">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7517888">{</span><span class="string" id="7517889">&#34;foo/BAR&#34;</span><span class="op" id="7517898">,</span>&nbsp;<span class="keyword" id="7517900">map</span><span class="op" id="7517903">[</span><span class="builtintype" id="7517904">string</span><span class="op" id="7517910">]</span><span class="builtintype" id="7517911">string</span><span class="op" id="7517917">{</span><span class="string" id="7517918">&#34;quote&#34;</span><span class="op" id="7517925">:</span>&nbsp;<span class="string" id="7517927">`With&nbsp;&#34;quote`</span><span class="op" id="7517940">}</span><span class="op" id="7517941">,</span>&nbsp;<span class="string" id="7517943">`foo/bar;&nbsp;quote=&#34;With&nbsp;\&#34;quote&#34;`</span><span class="op" id="7517974">}</span><span class="op" id="7517975">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7517978">{</span><span class="string" id="7517979">&#34;foo/BAR&#34;</span><span class="op" id="7517988">,</span>&nbsp;<span class="keyword" id="7517990">map</span><span class="op" id="7517993">[</span><span class="builtintype" id="7517994">string</span><span class="op" id="7518000">]</span><span class="builtintype" id="7518001">string</span><span class="op" id="7518007">{</span><span class="string" id="7518008">&#34;bslash&#34;</span><span class="op" id="7518016">:</span>&nbsp;<span class="string" id="7518018">`With&nbsp;\backslash`</span><span class="op" id="7518035">}</span><span class="op" id="7518036">,</span>&nbsp;<span class="string" id="7518038">`foo/bar;&nbsp;bslash=&#34;With&nbsp;\\backslash&#34;`</span><span class="op" id="7518074">}</span><span class="op" id="7518075">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7518078">{</span><span class="string" id="7518079">&#34;foo/BAR&#34;</span><span class="op" id="7518088">,</span>&nbsp;<span class="keyword" id="7518090">map</span><span class="op" id="7518093">[</span><span class="builtintype" id="7518094">string</span><span class="op" id="7518100">]</span><span class="builtintype" id="7518101">string</span><span class="op" id="7518107">{</span><span class="string" id="7518108">&#34;both&#34;</span><span class="op" id="7518114">:</span>&nbsp;<span class="string" id="7518116">`With&nbsp;\backslash&nbsp;and&nbsp;&#34;quote`</span><span class="op" id="7518144">}</span><span class="op" id="7518145">,</span>&nbsp;<span class="string" id="7518147">`foo/bar;&nbsp;both=&#34;With&nbsp;\\backslash&nbsp;and&nbsp;\&#34;quote&#34;`</span><span class="op" id="7518193">}</span><span class="op" id="7518194">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7518197">{</span><span class="string" id="7518198">&#34;foo/BAR&#34;</span><span class="op" id="7518207">,</span>&nbsp;<span class="keyword" id="7518209">map</span><span class="op" id="7518212">[</span><span class="builtintype" id="7518213">string</span><span class="op" id="7518219">]</span><span class="builtintype" id="7518220">string</span><span class="op" id="7518226">{</span><span class="string" id="7518227">&#34;&#34;</span><span class="op" id="7518229">:</span>&nbsp;<span class="string" id="7518231">&#34;empty&nbsp;attribute&#34;</span><span class="op" id="7518248">}</span><span class="op" id="7518249">,</span>&nbsp;<span class="string" id="7518251">&#34;&#34;</span><span class="op" id="7518253">}</span><span class="op" id="7518254">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7518257">{</span><span class="string" id="7518258">&#34;foo/BAR&#34;</span><span class="op" id="7518267">,</span>&nbsp;<span class="keyword" id="7518269">map</span><span class="op" id="7518272">[</span><span class="builtintype" id="7518273">string</span><span class="op" id="7518279">]</span><span class="builtintype" id="7518280">string</span><span class="op" id="7518286">{</span><span class="string" id="7518287">&#34;bad&nbsp;attribute&#34;</span><span class="op" id="7518302">:</span>&nbsp;<span class="string" id="7518304">&#34;baz&#34;</span><span class="op" id="7518309">}</span><span class="op" id="7518310">,</span>&nbsp;<span class="string" id="7518312">&#34;&#34;</span><span class="op" id="7518314">}</span><span class="op" id="7518315">,</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7518318">{</span><span class="string" id="7518319">&#34;foo/BAR&#34;</span><span class="op" id="7518328">,</span>&nbsp;<span class="keyword" id="7518330">map</span><span class="op" id="7518333">[</span><span class="builtintype" id="7518334">string</span><span class="op" id="7518340">]</span><span class="builtintype" id="7518341">string</span><span class="op" id="7518347">{</span><span class="string" id="7518348">&#34;nonascii&#34;</span><span class="op" id="7518358">:</span>&nbsp;<span class="string" id="7518360">&#34;not&nbsp;an&nbsp;ascii&nbsp;character:&nbsp;&#34;</span><span class="op" id="7518388">}</span><span class="op" id="7518389">,</span>&nbsp;<span class="string" id="7518391">&#34;&#34;</span><span class="op" id="7518393">}</span><span class="op" id="7518394">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7518397">{</span><span class="string" id="7518398">&#34;foo/bar&#34;</span><span class="op" id="7518407">,</span>&nbsp;<span class="keyword" id="7518409">map</span><span class="op" id="7518412">[</span><span class="builtintype" id="7518413">string</span><span class="op" id="7518419">]</span><span class="builtintype" id="7518420">string</span><span class="op" id="7518426">{</span><span class="string" id="7518427">&#34;a&#34;</span><span class="op" id="7518430">:</span>&nbsp;<span class="string" id="7518432">&#34;av&#34;</span><span class="op" id="7518436">,</span>&nbsp;<span class="string" id="7518438">&#34;b&#34;</span><span class="op" id="7518441">:</span>&nbsp;<span class="string" id="7518443">&#34;bv&#34;</span><span class="op" id="7518447">,</span>&nbsp;<span class="string" id="7518449">&#34;c&#34;</span><span class="op" id="7518452">:</span>&nbsp;<span class="string" id="7518454">&#34;cv&#34;</span><span class="op" id="7518458">}</span><span class="op" id="7518459">,</span>&nbsp;<span class="string" id="7518461">&#34;foo/bar;&nbsp;a=av;&nbsp;b=bv;&nbsp;c=cv&#34;</span><span class="op" id="7518488">}</span><span class="op" id="7518489">,</span><br>
<span class="lineno"></span><span class="op" id="7518491">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7518494">func</span>&nbsp;<span class="ident" id="7518499">TestFormatMediaType</span><span class="op" id="7518518">(</span><span class="ident" id="7518519">t</span>&nbsp;<span class="op" id="7518521">*</span><span class="ident" id="7518522">testing</span><span class="op" id="7518529">.</span><span class="ident" id="7518530">T</span><span class="op" id="7518531">)</span>&nbsp;<span class="op" id="7518533">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7518536">for</span>&nbsp;<span class="ident" id="7518540">i</span><span class="op" id="7518541">,</span>&nbsp;<span class="ident" id="7518543">tt</span>&nbsp;<span class="op" id="7518546">:=</span>&nbsp;<span class="keyword" id="7518549">range</span>&nbsp;<span class="ident" id="7518555">formatTests</span>&nbsp;<span class="op" id="7518567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7518571">got</span>&nbsp;<span class="op" id="7518575">:=</span>&nbsp;<span class="ident" id="7518578">FormatMediaType</span><span class="op" id="7518593">(</span><span class="ident" id="7518594">tt</span><span class="op" id="7518596">.</span><span class="ident" id="7518597">typ</span><span class="op" id="7518600">,</span>&nbsp;<span class="ident" id="7518602">tt</span><span class="op" id="7518604">.</span><span class="ident" id="7518605">params</span><span class="op" id="7518611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7518615">if</span>&nbsp;<span class="ident" id="7518618">got</span>&nbsp;<span class="op" id="7518622">!=</span>&nbsp;<span class="ident" id="7518625">tt</span><span class="op" id="7518627">.</span><span class="ident" id="7518628">want</span>&nbsp;<span class="op" id="7518633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7518638">t</span><span class="op" id="7518639">.</span><span class="ident" id="7518640">Errorf</span><span class="op" id="7518646">(</span><span class="string" id="7518647">&#34;%d.&nbsp;FormatMediaType(%q,&nbsp;%v)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7518690">,</span>&nbsp;<span class="ident" id="7518692">i</span><span class="op" id="7518693">,</span>&nbsp;<span class="ident" id="7518695">tt</span><span class="op" id="7518697">.</span><span class="ident" id="7518698">typ</span><span class="op" id="7518701">,</span>&nbsp;<span class="ident" id="7518703">tt</span><span class="op" id="7518705">.</span><span class="ident" id="7518706">params</span><span class="op" id="7518712">,</span>&nbsp;<span class="ident" id="7518714">got</span><span class="op" id="7518717">,</span>&nbsp;<span class="ident" id="7518719">tt</span><span class="op" id="7518721">.</span><span class="ident" id="7518722">want</span><span class="op" id="7518726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7518730">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7518733">}</span><br>
<span class="lineno"></span><span class="op" id="7518735">}</span>
</div>
</body>
</html>
