<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>time</h2>
<ul>
<li><a href="/gostd/time/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/time/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/time/format.go.html">format.go</a></li>
<li><a href="/gostd/time/format_test.go.html">format_test.go</a></li>
<li><a href="/gostd/time/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/time/sleep.go.html">sleep.go</a></li>
<li><a href="/gostd/time/sleep_test.go.html">sleep_test.go</a></li>
<li><a href="/gostd/time/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/time/tick.go.html">tick.go</a></li>
<li><a href="/gostd/time/tick_test.go.html">tick_test.go</a></li>
<li><a href="/gostd/time/time.go.html">time.go</a></li>
<li><a href="/gostd/time/time_test.go.html">time_test.go</a></li>
<li><a href="/gostd/time/zoneinfo.go.html" class="current">zoneinfo.go</a></li>
<li><a href="/gostd/time/zoneinfo_read.go.html">zoneinfo_read.go</a></li>
<li><a href="/gostd/time/zoneinfo_test.go.html">zoneinfo_test.go</a></li>
<li><a href="/gostd/time/zoneinfo_unix.go.html">zoneinfo_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2811592">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2811647">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2811701">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2811752">package</span>&nbsp;<span class="ident" id="2811760">time</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2811766">import</span>&nbsp;<span class="op" id="2811773">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2811776">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2811784">&#34;syscall&#34;</span><br>
<span class="lineno">10</span><span class="op" id="2811794">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2811797">//&nbsp;A&nbsp;Location&nbsp;maps&nbsp;time&nbsp;instants&nbsp;to&nbsp;the&nbsp;zone&nbsp;in&nbsp;use&nbsp;at&nbsp;that&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="2811863">//&nbsp;Typically,&nbsp;the&nbsp;Location&nbsp;represents&nbsp;the&nbsp;collection&nbsp;of&nbsp;time&nbsp;offsets</span><br>
<span class="lineno"></span><span class="comment" id="2811932">//&nbsp;in&nbsp;use&nbsp;in&nbsp;a&nbsp;geographical&nbsp;area,&nbsp;such&nbsp;as&nbsp;CEST&nbsp;and&nbsp;CET&nbsp;for&nbsp;central&nbsp;Europe.</span><br>
<span class="lineno">15</span><span class="keyword" id="2812007">type</span>&nbsp;<span class="ident" id="2812012">Location</span>&nbsp;<span class="keyword" id="2812021">struct</span>&nbsp;<span class="op" id="2812028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2812031">name</span>&nbsp;<span class="builtintype" id="2812036">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2812044">zone</span>&nbsp;<span class="op" id="2812049">[</span><span class="op" id="2812050">]</span><span class="ident" id="2812051">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2812057">tx</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2812062">[</span><span class="op" id="2812063">]</span><span class="ident" id="2812064">zoneTrans</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2812076">//&nbsp;Most&nbsp;lookups&nbsp;will&nbsp;be&nbsp;for&nbsp;the&nbsp;current&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2812123">//&nbsp;To&nbsp;avoid&nbsp;the&nbsp;binary&nbsp;search&nbsp;through&nbsp;tx,&nbsp;keep&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2812173">//&nbsp;static&nbsp;one-element&nbsp;cache&nbsp;that&nbsp;gives&nbsp;the&nbsp;correct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2812225">//&nbsp;zone&nbsp;for&nbsp;the&nbsp;time&nbsp;when&nbsp;the&nbsp;Location&nbsp;was&nbsp;created.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2812278">//&nbsp;if&nbsp;cacheStart&nbsp;&lt;=&nbsp;t&nbsp;&lt;=&nbsp;cacheEnd,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2812314">//&nbsp;lookup&nbsp;can&nbsp;return&nbsp;cacheZone.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2812347">//&nbsp;The&nbsp;units&nbsp;for&nbsp;cacheStart&nbsp;and&nbsp;cacheEnd&nbsp;are&nbsp;seconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2812401">//&nbsp;since&nbsp;January&nbsp;1,&nbsp;1970&nbsp;UTC,&nbsp;to&nbsp;match&nbsp;the&nbsp;argument</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2812454">//&nbsp;to&nbsp;lookup.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2812469">cacheStart</span>&nbsp;<span class="ident" id="2812480">int64</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2812487">cacheEnd</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2812498">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2812505">cacheZone</span>&nbsp;&nbsp;<span class="op" id="2812516">*</span><span class="ident" id="2812517">zone</span><br>
<span class="lineno"></span><span class="op" id="2812522">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2812525">//&nbsp;A&nbsp;zone&nbsp;represents&nbsp;a&nbsp;single&nbsp;time&nbsp;zone&nbsp;such&nbsp;as&nbsp;CEST&nbsp;or&nbsp;CET.</span><br>
<span class="lineno">35</span><span class="keyword" id="2812586">type</span>&nbsp;<span class="ident" id="2812591">zone</span>&nbsp;<span class="keyword" id="2812596">struct</span>&nbsp;<span class="op" id="2812603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2812606">name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2812613">string</span>&nbsp;<span class="comment" id="2812620">//&nbsp;abbreviated&nbsp;name,&nbsp;&#34;CET&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2812648">offset</span>&nbsp;<span class="builtintype" id="2812655">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2812662">//&nbsp;seconds&nbsp;east&nbsp;of&nbsp;UTC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2812686">isDST</span>&nbsp;&nbsp;<span class="builtintype" id="2812693">bool</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2812700">//&nbsp;is&nbsp;this&nbsp;zone&nbsp;Daylight&nbsp;Savings&nbsp;Time?</span><br>
<span class="lineno"></span><span class="op" id="2812739">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="2812742">//&nbsp;A&nbsp;zoneTrans&nbsp;represents&nbsp;a&nbsp;single&nbsp;time&nbsp;zone&nbsp;transition.</span><br>
<span class="lineno"></span><span class="keyword" id="2812799">type</span>&nbsp;<span class="ident" id="2812804">zoneTrans</span>&nbsp;<span class="keyword" id="2812814">struct</span>&nbsp;<span class="op" id="2812821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2812824">when</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2812837">int64</span>&nbsp;<span class="comment" id="2812843">//&nbsp;transition&nbsp;time,&nbsp;in&nbsp;seconds&nbsp;since&nbsp;1970&nbsp;GMT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2812890">index</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2812903">uint8</span>&nbsp;<span class="comment" id="2812909">//&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;zone&nbsp;that&nbsp;goes&nbsp;into&nbsp;effect&nbsp;at&nbsp;that&nbsp;time</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2812970">isstd</span><span class="op" id="2812975">,</span>&nbsp;<span class="ident" id="2812977">isutc</span>&nbsp;<span class="builtintype" id="2812983">bool</span>&nbsp;&nbsp;<span class="comment" id="2812989">//&nbsp;ignored&nbsp;-&nbsp;no&nbsp;idea&nbsp;what&nbsp;these&nbsp;mean</span><br>
<span class="lineno"></span><span class="op" id="2813026">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2813029">//&nbsp;alpha&nbsp;and&nbsp;omega&nbsp;are&nbsp;the&nbsp;beginning&nbsp;and&nbsp;end&nbsp;of&nbsp;time&nbsp;for&nbsp;zone</span><br>
<span class="lineno"></span><span class="comment" id="2813091">//&nbsp;transitions.</span><br>
<span class="lineno">50</span><span class="keyword" id="2813107">const</span>&nbsp;<span class="op" id="2813113">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2813116">alpha</span>&nbsp;<span class="op" id="2813122">=</span>&nbsp;<span class="op" id="2813124">-</span><span class="num" id="2813125">1</span>&nbsp;<span class="op" id="2813127">&lt;&lt;</span>&nbsp;<span class="num" id="2813130">63</span>&nbsp;&nbsp;<span class="comment" id="2813134">//&nbsp;math.MinInt64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2813152">omega</span>&nbsp;<span class="op" id="2813158">=</span>&nbsp;<span class="num" id="2813160">1</span><span class="op" id="2813161">&lt;&lt;</span><span class="num" id="2813163">63</span>&nbsp;<span class="op" id="2813166">-</span>&nbsp;<span class="num" id="2813168">1</span>&nbsp;<span class="comment" id="2813170">//&nbsp;math.MaxInt64</span><br>
<span class="lineno"></span><span class="op" id="2813187">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="comment" id="2813190">//&nbsp;UTC&nbsp;represents&nbsp;Universal&nbsp;Coordinated&nbsp;Time&nbsp;(UTC).</span><br>
<span class="lineno"></span><span class="keyword" id="2813242">var</span>&nbsp;<span class="ident" id="2813246">UTC</span>&nbsp;<span class="op" id="2813250">*</span><span class="ident" id="2813251">Location</span>&nbsp;<span class="op" id="2813260">=</span>&nbsp;<span class="op" id="2813262">&amp;</span><span class="ident" id="2813263">utcLoc</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2813271">//&nbsp;utcLoc&nbsp;is&nbsp;separate&nbsp;so&nbsp;that&nbsp;get&nbsp;can&nbsp;refer&nbsp;to&nbsp;&amp;utcLoc</span><br>
<span class="lineno"></span><span class="comment" id="2813326">//&nbsp;and&nbsp;ensure&nbsp;that&nbsp;it&nbsp;never&nbsp;returns&nbsp;a&nbsp;nil&nbsp;*Location,</span><br>
<span class="lineno">60</span><span class="comment" id="2813379">//&nbsp;even&nbsp;if&nbsp;a&nbsp;badly&nbsp;behaved&nbsp;client&nbsp;has&nbsp;changed&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="keyword" id="2813430">var</span>&nbsp;<span class="ident" id="2813434">utcLoc</span>&nbsp;<span class="op" id="2813441">=</span>&nbsp;<span class="ident" id="2813443">Location</span><span class="op" id="2813451">{</span><span class="ident" id="2813452">name</span><span class="op" id="2813456">:</span>&nbsp;<span class="string" id="2813458">&#34;UTC&#34;</span><span class="op" id="2813463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2813466">//&nbsp;Local&nbsp;represents&nbsp;the&nbsp;system&#39;s&nbsp;local&nbsp;time&nbsp;zone.</span><br>
<span class="lineno"></span><span class="keyword" id="2813516">var</span>&nbsp;<span class="ident" id="2813520">Local</span>&nbsp;<span class="op" id="2813526">*</span><span class="ident" id="2813527">Location</span>&nbsp;<span class="op" id="2813536">=</span>&nbsp;<span class="op" id="2813538">&amp;</span><span class="ident" id="2813539">localLoc</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="comment" id="2813549">//&nbsp;localLoc&nbsp;is&nbsp;separate&nbsp;so&nbsp;that&nbsp;initLocal&nbsp;can&nbsp;initialize</span><br>
<span class="lineno"></span><span class="comment" id="2813606">//&nbsp;it&nbsp;even&nbsp;if&nbsp;a&nbsp;client&nbsp;has&nbsp;changed&nbsp;Local.</span><br>
<span class="lineno"></span><span class="keyword" id="2813648">var</span>&nbsp;<span class="ident" id="2813652">localLoc</span>&nbsp;<span class="ident" id="2813661">Location</span><br>
<span class="lineno"></span><span class="keyword" id="2813670">var</span>&nbsp;<span class="ident" id="2813674">localOnce</span>&nbsp;<span class="ident" id="2813684">sync</span><span class="op" id="2813688">.</span><span class="ident" id="2813689">Once</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="2813695">func</span>&nbsp;<span class="op" id="2813700">(</span><span class="ident" id="2813701">l</span>&nbsp;<span class="op" id="2813703">*</span><span class="ident" id="2813704">Location</span><span class="op" id="2813712">)</span>&nbsp;<span class="ident" id="2813714">get</span><span class="op" id="2813717">(</span><span class="op" id="2813718">)</span>&nbsp;<span class="op" id="2813720">*</span><span class="ident" id="2813721">Location</span>&nbsp;<span class="op" id="2813730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2813733">if</span>&nbsp;<span class="ident" id="2813736">l</span>&nbsp;<span class="op" id="2813738">==</span>&nbsp;<span class="ident" id="2813741">nil</span>&nbsp;<span class="op" id="2813745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2813749">return</span>&nbsp;<span class="op" id="2813756">&amp;</span><span class="ident" id="2813757">utcLoc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2813765">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2813768">if</span>&nbsp;<span class="ident" id="2813771">l</span>&nbsp;<span class="op" id="2813773">==</span>&nbsp;<span class="op" id="2813776">&amp;</span><span class="ident" id="2813777">localLoc</span>&nbsp;<span class="op" id="2813786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2813790">localOnce</span><span class="op" id="2813799">.</span><span class="ident" id="2813800">Do</span><span class="op" id="2813802">(</span><span class="ident" id="2813803">initLocal</span><span class="op" id="2813812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2813815">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2813818">return</span>&nbsp;<span class="ident" id="2813825">l</span><br>
<span class="lineno"></span><span class="op" id="2813827">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="2813830">//&nbsp;String&nbsp;returns&nbsp;a&nbsp;descriptive&nbsp;name&nbsp;for&nbsp;the&nbsp;time&nbsp;zone&nbsp;information,</span><br>
<span class="lineno"></span><span class="comment" id="2813898">//&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;argument&nbsp;to&nbsp;LoadLocation.</span><br>
<span class="lineno"></span><span class="keyword" id="2813948">func</span>&nbsp;<span class="op" id="2813953">(</span><span class="ident" id="2813954">l</span>&nbsp;<span class="op" id="2813956">*</span><span class="ident" id="2813957">Location</span><span class="op" id="2813965">)</span>&nbsp;<span class="ident" id="2813967">String</span><span class="op" id="2813973">(</span><span class="op" id="2813974">)</span>&nbsp;<span class="builtintype" id="2813976">string</span>&nbsp;<span class="op" id="2813983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2813986">return</span>&nbsp;<span class="ident" id="2813993">l</span><span class="op" id="2813994">.</span><span class="ident" id="2813995">get</span><span class="op" id="2813998">(</span><span class="op" id="2813999">)</span><span class="op" id="2814000">.</span><span class="ident" id="2814001">name</span><br>
<span class="lineno">85</span><span class="op" id="2814006">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2814009">//&nbsp;FixedZone&nbsp;returns&nbsp;a&nbsp;Location&nbsp;that&nbsp;always&nbsp;uses</span><br>
<span class="lineno"></span><span class="comment" id="2814058">//&nbsp;the&nbsp;given&nbsp;zone&nbsp;name&nbsp;and&nbsp;offset&nbsp;(seconds&nbsp;east&nbsp;of&nbsp;UTC).</span><br>
<span class="lineno"></span><span class="keyword" id="2814115">func</span>&nbsp;<span class="ident" id="2814120">FixedZone</span><span class="op" id="2814129">(</span><span class="ident" id="2814130">name</span>&nbsp;<span class="builtintype" id="2814135">string</span><span class="op" id="2814141">,</span>&nbsp;<span class="ident" id="2814143">offset</span>&nbsp;<span class="builtintype" id="2814150">int</span><span class="op" id="2814153">)</span>&nbsp;<span class="op" id="2814155">*</span><span class="ident" id="2814156">Location</span>&nbsp;<span class="op" id="2814165">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2814168">l</span>&nbsp;<span class="op" id="2814170">:=</span>&nbsp;<span class="op" id="2814173">&amp;</span><span class="ident" id="2814174">Location</span><span class="op" id="2814182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2814186">name</span><span class="op" id="2814190">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2814198">name</span><span class="op" id="2814202">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2814206">zone</span><span class="op" id="2814210">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2814218">[</span><span class="op" id="2814219">]</span><span class="ident" id="2814220">zone</span><span class="op" id="2814224">{</span><span class="op" id="2814225">{</span><span class="ident" id="2814226">name</span><span class="op" id="2814230">,</span>&nbsp;<span class="ident" id="2814232">offset</span><span class="op" id="2814238">,</span>&nbsp;<span class="builtintype" id="2814240">false</span><span class="op" id="2814245">}</span><span class="op" id="2814246">}</span><span class="op" id="2814247">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2814251">tx</span><span class="op" id="2814253">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2814263">[</span><span class="op" id="2814264">]</span><span class="ident" id="2814265">zoneTrans</span><span class="op" id="2814274">{</span><span class="op" id="2814275">{</span><span class="ident" id="2814276">alpha</span><span class="op" id="2814281">,</span>&nbsp;<span class="num" id="2814283">0</span><span class="op" id="2814284">,</span>&nbsp;<span class="builtintype" id="2814286">false</span><span class="op" id="2814291">,</span>&nbsp;<span class="builtintype" id="2814293">false</span><span class="op" id="2814298">}</span><span class="op" id="2814299">}</span><span class="op" id="2814300">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2814304">cacheStart</span><span class="op" id="2814314">:</span>&nbsp;<span class="ident" id="2814316">alpha</span><span class="op" id="2814321">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2814325">cacheEnd</span><span class="op" id="2814333">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2814337">omega</span><span class="op" id="2814342">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2814345">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2814348">l</span><span class="op" id="2814349">.</span><span class="ident" id="2814350">cacheZone</span>&nbsp;<span class="op" id="2814360">=</span>&nbsp;<span class="op" id="2814362">&amp;</span><span class="ident" id="2814363">l</span><span class="op" id="2814364">.</span><span class="ident" id="2814365">zone</span><span class="op" id="2814369">[</span><span class="num" id="2814370">0</span><span class="op" id="2814371">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2814374">return</span>&nbsp;<span class="ident" id="2814381">l</span><br>
<span class="lineno"></span><span class="op" id="2814383">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="2814386">//&nbsp;lookup&nbsp;returns&nbsp;information&nbsp;about&nbsp;the&nbsp;time&nbsp;zone&nbsp;in&nbsp;use&nbsp;at&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="2814449">//&nbsp;instant&nbsp;in&nbsp;time&nbsp;expressed&nbsp;as&nbsp;seconds&nbsp;since&nbsp;January&nbsp;1,&nbsp;1970&nbsp;00:00:00&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="comment" id="2814525">//</span><br>
<span class="lineno"></span><span class="comment" id="2814528">//&nbsp;The&nbsp;returned&nbsp;information&nbsp;gives&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;zone&nbsp;(such&nbsp;as&nbsp;&#34;CET&#34;),</span><br>
<span class="lineno">105</span><span class="comment" id="2814600">//&nbsp;the&nbsp;start&nbsp;and&nbsp;end&nbsp;times&nbsp;bracketing&nbsp;sec&nbsp;when&nbsp;that&nbsp;zone&nbsp;is&nbsp;in&nbsp;effect,</span><br>
<span class="lineno"></span><span class="comment" id="2814671">//&nbsp;the&nbsp;offset&nbsp;in&nbsp;seconds&nbsp;east&nbsp;of&nbsp;UTC&nbsp;(such&nbsp;as&nbsp;-5*60*60),&nbsp;and&nbsp;whether</span><br>
<span class="lineno"></span><span class="comment" id="2814740">//&nbsp;the&nbsp;daylight&nbsp;savings&nbsp;is&nbsp;being&nbsp;observed&nbsp;at&nbsp;that&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="2814796">func</span>&nbsp;<span class="op" id="2814801">(</span><span class="ident" id="2814802">l</span>&nbsp;<span class="op" id="2814804">*</span><span class="ident" id="2814805">Location</span><span class="op" id="2814813">)</span>&nbsp;<span class="ident" id="2814815">lookup</span><span class="op" id="2814821">(</span><span class="ident" id="2814822">sec</span>&nbsp;<span class="ident" id="2814826">int64</span><span class="op" id="2814831">)</span>&nbsp;<span class="op" id="2814833">(</span><span class="ident" id="2814834">name</span>&nbsp;<span class="builtintype" id="2814839">string</span><span class="op" id="2814845">,</span>&nbsp;<span class="ident" id="2814847">offset</span>&nbsp;<span class="builtintype" id="2814854">int</span><span class="op" id="2814857">,</span>&nbsp;<span class="ident" id="2814859">isDST</span>&nbsp;<span class="builtintype" id="2814865">bool</span><span class="op" id="2814869">,</span>&nbsp;<span class="ident" id="2814871">start</span><span class="op" id="2814876">,</span>&nbsp;<span class="ident" id="2814878">end</span>&nbsp;<span class="ident" id="2814882">int64</span><span class="op" id="2814887">)</span>&nbsp;<span class="op" id="2814889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2814892">l</span>&nbsp;<span class="op" id="2814894">=</span>&nbsp;<span class="ident" id="2814896">l</span><span class="op" id="2814897">.</span><span class="ident" id="2814898">get</span><span class="op" id="2814901">(</span><span class="op" id="2814902">)</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2814906">if</span>&nbsp;<span class="builtinfunc" id="2814909">len</span><span class="op" id="2814912">(</span><span class="ident" id="2814913">l</span><span class="op" id="2814914">.</span><span class="ident" id="2814915">zone</span><span class="op" id="2814919">)</span>&nbsp;<span class="op" id="2814921">==</span>&nbsp;<span class="num" id="2814924">0</span>&nbsp;<span class="op" id="2814926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2814930">name</span>&nbsp;<span class="op" id="2814935">=</span>&nbsp;<span class="string" id="2814937">&#34;UTC&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2814945">offset</span>&nbsp;<span class="op" id="2814952">=</span>&nbsp;<span class="num" id="2814954">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2814958">isDST</span>&nbsp;<span class="op" id="2814964">=</span>&nbsp;<span class="builtintype" id="2814966">false</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2814974">start</span>&nbsp;<span class="op" id="2814980">=</span>&nbsp;<span class="ident" id="2814982">alpha</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2814990">end</span>&nbsp;<span class="op" id="2814994">=</span>&nbsp;<span class="ident" id="2814996">omega</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2815004">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2815012">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2815016">if</span>&nbsp;<span class="ident" id="2815019">zone</span>&nbsp;<span class="op" id="2815024">:=</span>&nbsp;<span class="ident" id="2815027">l</span><span class="op" id="2815028">.</span><span class="ident" id="2815029">cacheZone</span><span class="op" id="2815038">;</span>&nbsp;<span class="ident" id="2815040">zone</span>&nbsp;<span class="op" id="2815045">!=</span>&nbsp;<span class="ident" id="2815048">nil</span>&nbsp;<span class="op" id="2815052">&amp;&amp;</span>&nbsp;<span class="ident" id="2815055">l</span><span class="op" id="2815056">.</span><span class="ident" id="2815057">cacheStart</span>&nbsp;<span class="op" id="2815068">&lt;=</span>&nbsp;<span class="ident" id="2815071">sec</span>&nbsp;<span class="op" id="2815075">&amp;&amp;</span>&nbsp;<span class="ident" id="2815078">sec</span>&nbsp;<span class="op" id="2815082">&lt;</span>&nbsp;<span class="ident" id="2815084">l</span><span class="op" id="2815085">.</span><span class="ident" id="2815086">cacheEnd</span>&nbsp;<span class="op" id="2815095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2815099">name</span>&nbsp;<span class="op" id="2815104">=</span>&nbsp;<span class="ident" id="2815106">zone</span><span class="op" id="2815110">.</span><span class="ident" id="2815111">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2815118">offset</span>&nbsp;<span class="op" id="2815125">=</span>&nbsp;<span class="ident" id="2815127">zone</span><span class="op" id="2815131">.</span><span class="ident" id="2815132">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2815141">isDST</span>&nbsp;<span class="op" id="2815147">=</span>&nbsp;<span class="ident" id="2815149">zone</span><span class="op" id="2815153">.</span><span class="ident" id="2815154">isDST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2815162">start</span>&nbsp;<span class="op" id="2815168">=</span>&nbsp;<span class="ident" id="2815170">l</span><span class="op" id="2815171">.</span><span class="ident" id="2815172">cacheStart</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2815185">end</span>&nbsp;<span class="op" id="2815189">=</span>&nbsp;<span class="ident" id="2815191">l</span><span class="op" id="2815192">.</span><span class="ident" id="2815193">cacheEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2815204">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2815212">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2815216">if</span>&nbsp;<span class="builtinfunc" id="2815219">len</span><span class="op" id="2815222">(</span><span class="ident" id="2815223">l</span><span class="op" id="2815224">.</span><span class="ident" id="2815225">tx</span><span class="op" id="2815227">)</span>&nbsp;<span class="op" id="2815229">==</span>&nbsp;<span class="num" id="2815232">0</span>&nbsp;<span class="op" id="2815234">||</span>&nbsp;<span class="ident" id="2815237">sec</span>&nbsp;<span class="op" id="2815241">&lt;</span>&nbsp;<span class="ident" id="2815243">l</span><span class="op" id="2815244">.</span><span class="ident" id="2815245">tx</span><span class="op" id="2815247">[</span><span class="num" id="2815248">0</span><span class="op" id="2815249">]</span><span class="op" id="2815250">.</span><span class="ident" id="2815251">when</span>&nbsp;<span class="op" id="2815256">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2815260">zone</span>&nbsp;<span class="op" id="2815265">:=</span>&nbsp;<span class="op" id="2815268">&amp;</span><span class="ident" id="2815269">l</span><span class="op" id="2815270">.</span><span class="ident" id="2815271">zone</span><span class="op" id="2815275">[</span><span class="ident" id="2815276">l</span><span class="op" id="2815277">.</span><span class="ident" id="2815278">lookupFirstZone</span><span class="op" id="2815293">(</span><span class="op" id="2815294">)</span><span class="op" id="2815295">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2815299">name</span>&nbsp;<span class="op" id="2815304">=</span>&nbsp;<span class="ident" id="2815306">zone</span><span class="op" id="2815310">.</span><span class="ident" id="2815311">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2815318">offset</span>&nbsp;<span class="op" id="2815325">=</span>&nbsp;<span class="ident" id="2815327">zone</span><span class="op" id="2815331">.</span><span class="ident" id="2815332">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2815341">isDST</span>&nbsp;<span class="op" id="2815347">=</span>&nbsp;<span class="ident" id="2815349">zone</span><span class="op" id="2815353">.</span><span class="ident" id="2815354">isDST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2815362">start</span>&nbsp;<span class="op" id="2815368">=</span>&nbsp;<span class="ident" id="2815370">alpha</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2815378">if</span>&nbsp;<span class="builtinfunc" id="2815381">len</span><span class="op" id="2815384">(</span><span class="ident" id="2815385">l</span><span class="op" id="2815386">.</span><span class="ident" id="2815387">tx</span><span class="op" id="2815389">)</span>&nbsp;<span class="op" id="2815391">&gt;</span>&nbsp;<span class="num" id="2815393">0</span>&nbsp;<span class="op" id="2815395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2815400">end</span>&nbsp;<span class="op" id="2815404">=</span>&nbsp;<span class="ident" id="2815406">l</span><span class="op" id="2815407">.</span><span class="ident" id="2815408">tx</span><span class="op" id="2815410">[</span><span class="num" id="2815411">0</span><span class="op" id="2815412">]</span><span class="op" id="2815413">.</span><span class="ident" id="2815414">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2815421">}</span>&nbsp;<span class="keyword" id="2815423">else</span>&nbsp;<span class="op" id="2815428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2815433">end</span>&nbsp;<span class="op" id="2815437">=</span>&nbsp;<span class="ident" id="2815439">omega</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2815447">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2815451">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2815459">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2815463">//&nbsp;Binary&nbsp;search&nbsp;for&nbsp;entry&nbsp;with&nbsp;largest&nbsp;time&nbsp;&lt;=&nbsp;sec.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2815517">//&nbsp;Not&nbsp;using&nbsp;sort.Search&nbsp;to&nbsp;avoid&nbsp;dependencies.</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2815566">tx</span>&nbsp;<span class="op" id="2815569">:=</span>&nbsp;<span class="ident" id="2815572">l</span><span class="op" id="2815573">.</span><span class="ident" id="2815574">tx</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2815578">end</span>&nbsp;<span class="op" id="2815582">=</span>&nbsp;<span class="ident" id="2815584">omega</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2815591">lo</span>&nbsp;<span class="op" id="2815594">:=</span>&nbsp;<span class="num" id="2815597">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2815600">hi</span>&nbsp;<span class="op" id="2815603">:=</span>&nbsp;<span class="builtinfunc" id="2815606">len</span><span class="op" id="2815609">(</span><span class="ident" id="2815610">tx</span><span class="op" id="2815612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2815615">for</span>&nbsp;<span class="ident" id="2815619">hi</span><span class="op" id="2815621">-</span><span class="ident" id="2815622">lo</span>&nbsp;<span class="op" id="2815625">&gt;</span>&nbsp;<span class="num" id="2815627">1</span>&nbsp;<span class="op" id="2815629">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2815633">m</span>&nbsp;<span class="op" id="2815635">:=</span>&nbsp;<span class="ident" id="2815638">lo</span>&nbsp;<span class="op" id="2815641">+</span>&nbsp;<span class="op" id="2815643">(</span><span class="ident" id="2815644">hi</span><span class="op" id="2815646">-</span><span class="ident" id="2815647">lo</span><span class="op" id="2815649">)</span><span class="op" id="2815650">/</span><span class="num" id="2815651">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2815655">lim</span>&nbsp;<span class="op" id="2815659">:=</span>&nbsp;<span class="ident" id="2815662">tx</span><span class="op" id="2815664">[</span><span class="ident" id="2815665">m</span><span class="op" id="2815666">]</span><span class="op" id="2815667">.</span><span class="ident" id="2815668">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2815675">if</span>&nbsp;<span class="ident" id="2815678">sec</span>&nbsp;<span class="op" id="2815682">&lt;</span>&nbsp;<span class="ident" id="2815684">lim</span>&nbsp;<span class="op" id="2815688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2815693">end</span>&nbsp;<span class="op" id="2815697">=</span>&nbsp;<span class="ident" id="2815699">lim</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2815706">hi</span>&nbsp;<span class="op" id="2815709">=</span>&nbsp;<span class="ident" id="2815711">m</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2815715">}</span>&nbsp;<span class="keyword" id="2815717">else</span>&nbsp;<span class="op" id="2815722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2815727">lo</span>&nbsp;<span class="op" id="2815730">=</span>&nbsp;<span class="ident" id="2815732">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2815736">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2815739">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2815742">zone</span>&nbsp;<span class="op" id="2815747">:=</span>&nbsp;<span class="op" id="2815750">&amp;</span><span class="ident" id="2815751">l</span><span class="op" id="2815752">.</span><span class="ident" id="2815753">zone</span><span class="op" id="2815757">[</span><span class="ident" id="2815758">tx</span><span class="op" id="2815760">[</span><span class="ident" id="2815761">lo</span><span class="op" id="2815763">]</span><span class="op" id="2815764">.</span><span class="ident" id="2815765">index</span><span class="op" id="2815770">]</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2815773">name</span>&nbsp;<span class="op" id="2815778">=</span>&nbsp;<span class="ident" id="2815780">zone</span><span class="op" id="2815784">.</span><span class="ident" id="2815785">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2815791">offset</span>&nbsp;<span class="op" id="2815798">=</span>&nbsp;<span class="ident" id="2815800">zone</span><span class="op" id="2815804">.</span><span class="ident" id="2815805">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2815813">isDST</span>&nbsp;<span class="op" id="2815819">=</span>&nbsp;<span class="ident" id="2815821">zone</span><span class="op" id="2815825">.</span><span class="ident" id="2815826">isDST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2815833">start</span>&nbsp;<span class="op" id="2815839">=</span>&nbsp;<span class="ident" id="2815841">tx</span><span class="op" id="2815843">[</span><span class="ident" id="2815844">lo</span><span class="op" id="2815846">]</span><span class="op" id="2815847">.</span><span class="ident" id="2815848">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2815854">//&nbsp;end&nbsp;=&nbsp;maintained&nbsp;during&nbsp;the&nbsp;search</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2815893">return</span><br>
<span class="lineno"></span><span class="op" id="2815900">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2815903">//&nbsp;lookupFirstZone&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;time&nbsp;zone&nbsp;to&nbsp;use&nbsp;for&nbsp;times</span><br>
<span class="lineno"></span><span class="comment" id="2815974">//&nbsp;before&nbsp;the&nbsp;first&nbsp;transition&nbsp;time,&nbsp;or&nbsp;when&nbsp;there&nbsp;are&nbsp;no&nbsp;transition</span><br>
<span class="lineno">170</span><span class="comment" id="2816043">//&nbsp;times.</span><br>
<span class="lineno"></span><span class="comment" id="2816053">//</span><br>
<span class="lineno"></span><span class="comment" id="2816056">//&nbsp;The&nbsp;reference&nbsp;implementation&nbsp;in&nbsp;localtime.c&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="2816108">//&nbsp;http://www.iana.org/time-zones/repository/releases/tzcode2013g.tar.gz</span><br>
<span class="lineno"></span><span class="comment" id="2816181">//&nbsp;implements&nbsp;the&nbsp;following&nbsp;algorithm&nbsp;for&nbsp;these&nbsp;cases:</span><br>
<span class="lineno">175</span><span class="comment" id="2816236">//&nbsp;1)&nbsp;If&nbsp;the&nbsp;first&nbsp;zone&nbsp;is&nbsp;unused&nbsp;by&nbsp;the&nbsp;transitions,&nbsp;use&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="2816298">//&nbsp;2)&nbsp;Otherwise,&nbsp;if&nbsp;there&nbsp;are&nbsp;transition&nbsp;times,&nbsp;and&nbsp;the&nbsp;first</span><br>
<span class="lineno"></span><span class="comment" id="2816360">//&nbsp;&nbsp;&nbsp;&nbsp;transition&nbsp;is&nbsp;to&nbsp;a&nbsp;zone&nbsp;in&nbsp;daylight&nbsp;time,&nbsp;find&nbsp;the&nbsp;first</span><br>
<span class="lineno"></span><span class="comment" id="2816423">//&nbsp;&nbsp;&nbsp;&nbsp;non-daylight-time&nbsp;zone&nbsp;before&nbsp;and&nbsp;closest&nbsp;to&nbsp;the&nbsp;first&nbsp;transition</span><br>
<span class="lineno"></span><span class="comment" id="2816495">//&nbsp;&nbsp;&nbsp;&nbsp;zone.</span><br>
<span class="lineno">180</span><span class="comment" id="2816507">//&nbsp;3)&nbsp;Otherwise,&nbsp;use&nbsp;the&nbsp;first&nbsp;zone&nbsp;that&nbsp;is&nbsp;not&nbsp;daylight&nbsp;time,&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="2816573">//&nbsp;&nbsp;&nbsp;&nbsp;there&nbsp;is&nbsp;one.</span><br>
<span class="lineno"></span><span class="comment" id="2816593">//&nbsp;4)&nbsp;Otherwise,&nbsp;use&nbsp;the&nbsp;first&nbsp;zone.</span><br>
<span class="lineno"></span><span class="keyword" id="2816630">func</span>&nbsp;<span class="op" id="2816635">(</span><span class="ident" id="2816636">l</span>&nbsp;<span class="op" id="2816638">*</span><span class="ident" id="2816639">Location</span><span class="op" id="2816647">)</span>&nbsp;<span class="ident" id="2816649">lookupFirstZone</span><span class="op" id="2816664">(</span><span class="op" id="2816665">)</span>&nbsp;<span class="builtintype" id="2816667">int</span>&nbsp;<span class="op" id="2816671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2816674">//&nbsp;Case&nbsp;1.</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2816686">if</span>&nbsp;<span class="op" id="2816689">!</span><span class="ident" id="2816690">l</span><span class="op" id="2816691">.</span><span class="ident" id="2816692">firstZoneUsed</span><span class="op" id="2816705">(</span><span class="op" id="2816706">)</span>&nbsp;<span class="op" id="2816708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2816712">return</span>&nbsp;<span class="num" id="2816719">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2816722">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2816726">//&nbsp;Case&nbsp;2.</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2816738">if</span>&nbsp;<span class="builtinfunc" id="2816741">len</span><span class="op" id="2816744">(</span><span class="ident" id="2816745">l</span><span class="op" id="2816746">.</span><span class="ident" id="2816747">tx</span><span class="op" id="2816749">)</span>&nbsp;<span class="op" id="2816751">&gt;</span>&nbsp;<span class="num" id="2816753">0</span>&nbsp;<span class="op" id="2816755">&amp;&amp;</span>&nbsp;<span class="ident" id="2816758">l</span><span class="op" id="2816759">.</span><span class="ident" id="2816760">zone</span><span class="op" id="2816764">[</span><span class="ident" id="2816765">l</span><span class="op" id="2816766">.</span><span class="ident" id="2816767">tx</span><span class="op" id="2816769">[</span><span class="num" id="2816770">0</span><span class="op" id="2816771">]</span><span class="op" id="2816772">.</span><span class="ident" id="2816773">index</span><span class="op" id="2816778">]</span><span class="op" id="2816779">.</span><span class="ident" id="2816780">isDST</span>&nbsp;<span class="op" id="2816786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2816790">for</span>&nbsp;<span class="ident" id="2816794">zi</span>&nbsp;<span class="op" id="2816797">:=</span>&nbsp;<span class="builtintype" id="2816800">int</span><span class="op" id="2816803">(</span><span class="ident" id="2816804">l</span><span class="op" id="2816805">.</span><span class="ident" id="2816806">tx</span><span class="op" id="2816808">[</span><span class="num" id="2816809">0</span><span class="op" id="2816810">]</span><span class="op" id="2816811">.</span><span class="ident" id="2816812">index</span><span class="op" id="2816817">)</span>&nbsp;<span class="op" id="2816819">-</span>&nbsp;<span class="num" id="2816821">1</span><span class="op" id="2816822">;</span>&nbsp;<span class="ident" id="2816824">zi</span>&nbsp;<span class="op" id="2816827">&gt;=</span>&nbsp;<span class="num" id="2816830">0</span><span class="op" id="2816831">;</span>&nbsp;<span class="ident" id="2816833">zi</span><span class="op" id="2816835">--</span>&nbsp;<span class="op" id="2816838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2816843">if</span>&nbsp;<span class="op" id="2816846">!</span><span class="ident" id="2816847">l</span><span class="op" id="2816848">.</span><span class="ident" id="2816849">zone</span><span class="op" id="2816853">[</span><span class="ident" id="2816854">zi</span><span class="op" id="2816856">]</span><span class="op" id="2816857">.</span><span class="ident" id="2816858">isDST</span>&nbsp;<span class="op" id="2816864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2816870">return</span>&nbsp;<span class="ident" id="2816877">zi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2816883">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2816887">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2816890">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2816894">//&nbsp;Case&nbsp;3.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2816906">for</span>&nbsp;<span class="ident" id="2816910">zi</span>&nbsp;<span class="op" id="2816913">:=</span>&nbsp;<span class="keyword" id="2816916">range</span>&nbsp;<span class="ident" id="2816922">l</span><span class="op" id="2816923">.</span><span class="ident" id="2816924">zone</span>&nbsp;<span class="op" id="2816929">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2816933">if</span>&nbsp;<span class="op" id="2816936">!</span><span class="ident" id="2816937">l</span><span class="op" id="2816938">.</span><span class="ident" id="2816939">zone</span><span class="op" id="2816943">[</span><span class="ident" id="2816944">zi</span><span class="op" id="2816946">]</span><span class="op" id="2816947">.</span><span class="ident" id="2816948">isDST</span>&nbsp;<span class="op" id="2816954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2816959">return</span>&nbsp;<span class="ident" id="2816966">zi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2816971">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2816974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2816978">//&nbsp;Case&nbsp;4.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2816990">return</span>&nbsp;<span class="num" id="2816997">0</span><br>
<span class="lineno"></span><span class="op" id="2816999">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2817002">//&nbsp;firstZoneUsed&nbsp;returns&nbsp;whether&nbsp;the&nbsp;first&nbsp;zone&nbsp;is&nbsp;used&nbsp;by&nbsp;some</span><br>
<span class="lineno">210</span><span class="comment" id="2817066">//&nbsp;transition.</span><br>
<span class="lineno"></span><span class="keyword" id="2817081">func</span>&nbsp;<span class="op" id="2817086">(</span><span class="ident" id="2817087">l</span>&nbsp;<span class="op" id="2817089">*</span><span class="ident" id="2817090">Location</span><span class="op" id="2817098">)</span>&nbsp;<span class="ident" id="2817100">firstZoneUsed</span><span class="op" id="2817113">(</span><span class="op" id="2817114">)</span>&nbsp;<span class="builtintype" id="2817116">bool</span>&nbsp;<span class="op" id="2817121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2817124">for</span>&nbsp;<span class="ident" id="2817128">_</span><span class="op" id="2817129">,</span>&nbsp;<span class="ident" id="2817131">tx</span>&nbsp;<span class="op" id="2817134">:=</span>&nbsp;<span class="keyword" id="2817137">range</span>&nbsp;<span class="ident" id="2817143">l</span><span class="op" id="2817144">.</span><span class="ident" id="2817145">tx</span>&nbsp;<span class="op" id="2817148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2817152">if</span>&nbsp;<span class="ident" id="2817155">tx</span><span class="op" id="2817157">.</span><span class="ident" id="2817158">index</span>&nbsp;<span class="op" id="2817164">==</span>&nbsp;<span class="num" id="2817167">0</span>&nbsp;<span class="op" id="2817169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2817174">return</span>&nbsp;<span class="builtintype" id="2817181">true</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2817188">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2817191">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2817194">return</span>&nbsp;<span class="builtintype" id="2817201">false</span><br>
<span class="lineno"></span><span class="op" id="2817207">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="2817210">//&nbsp;lookupName&nbsp;returns&nbsp;information&nbsp;about&nbsp;the&nbsp;time&nbsp;zone&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="2817269">//&nbsp;the&nbsp;given&nbsp;name&nbsp;(such&nbsp;as&nbsp;&#34;EST&#34;)&nbsp;at&nbsp;the&nbsp;given&nbsp;pseudo-Unix&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="2817333">//&nbsp;(what&nbsp;the&nbsp;given&nbsp;time&nbsp;of&nbsp;day&nbsp;would&nbsp;be&nbsp;in&nbsp;UTC).</span><br>
<span class="lineno"></span><span class="keyword" id="2817382">func</span>&nbsp;<span class="op" id="2817387">(</span><span class="ident" id="2817388">l</span>&nbsp;<span class="op" id="2817390">*</span><span class="ident" id="2817391">Location</span><span class="op" id="2817399">)</span>&nbsp;<span class="ident" id="2817401">lookupName</span><span class="op" id="2817411">(</span><span class="ident" id="2817412">name</span>&nbsp;<span class="builtintype" id="2817417">string</span><span class="op" id="2817423">,</span>&nbsp;<span class="ident" id="2817425">unix</span>&nbsp;<span class="ident" id="2817430">int64</span><span class="op" id="2817435">)</span>&nbsp;<span class="op" id="2817437">(</span><span class="ident" id="2817438">offset</span>&nbsp;<span class="builtintype" id="2817445">int</span><span class="op" id="2817448">,</span>&nbsp;<span class="ident" id="2817450">isDST</span>&nbsp;<span class="builtintype" id="2817456">bool</span><span class="op" id="2817460">,</span>&nbsp;<span class="ident" id="2817462">ok</span>&nbsp;<span class="builtintype" id="2817465">bool</span><span class="op" id="2817469">)</span>&nbsp;<span class="op" id="2817471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2817474">l</span>&nbsp;<span class="op" id="2817476">=</span>&nbsp;<span class="ident" id="2817478">l</span><span class="op" id="2817479">.</span><span class="ident" id="2817480">get</span><span class="op" id="2817483">(</span><span class="op" id="2817484">)</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2817488">//&nbsp;First&nbsp;try&nbsp;for&nbsp;a&nbsp;zone&nbsp;with&nbsp;the&nbsp;right&nbsp;name&nbsp;that&nbsp;was&nbsp;actually</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2817551">//&nbsp;in&nbsp;effect&nbsp;at&nbsp;the&nbsp;given&nbsp;time.&nbsp;(In&nbsp;Sydney,&nbsp;Australia,&nbsp;both&nbsp;standard</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2817621">//&nbsp;and&nbsp;daylight-savings&nbsp;time&nbsp;are&nbsp;abbreviated&nbsp;&#34;EST&#34;.&nbsp;Using&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2817684">//&nbsp;offset&nbsp;helps&nbsp;us&nbsp;pick&nbsp;the&nbsp;right&nbsp;one&nbsp;for&nbsp;the&nbsp;given&nbsp;time.</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2817743">//&nbsp;It&#39;s&nbsp;not&nbsp;perfect:&nbsp;during&nbsp;the&nbsp;backward&nbsp;transition&nbsp;we&nbsp;might&nbsp;pick</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2817810">//&nbsp;either&nbsp;one.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2817827">for</span>&nbsp;<span class="ident" id="2817831">i</span>&nbsp;<span class="op" id="2817833">:=</span>&nbsp;<span class="keyword" id="2817836">range</span>&nbsp;<span class="ident" id="2817842">l</span><span class="op" id="2817843">.</span><span class="ident" id="2817844">zone</span>&nbsp;<span class="op" id="2817849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2817853">zone</span>&nbsp;<span class="op" id="2817858">:=</span>&nbsp;<span class="op" id="2817861">&amp;</span><span class="ident" id="2817862">l</span><span class="op" id="2817863">.</span><span class="ident" id="2817864">zone</span><span class="op" id="2817868">[</span><span class="ident" id="2817869">i</span><span class="op" id="2817870">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2817874">if</span>&nbsp;<span class="ident" id="2817877">zone</span><span class="op" id="2817881">.</span><span class="ident" id="2817882">name</span>&nbsp;<span class="op" id="2817887">==</span>&nbsp;<span class="ident" id="2817890">name</span>&nbsp;<span class="op" id="2817895">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2817900">nam</span><span class="op" id="2817903">,</span>&nbsp;<span class="ident" id="2817905">offset</span><span class="op" id="2817911">,</span>&nbsp;<span class="ident" id="2817913">isDST</span><span class="op" id="2817918">,</span>&nbsp;<span class="ident" id="2817920">_</span><span class="op" id="2817921">,</span>&nbsp;<span class="ident" id="2817923">_</span>&nbsp;<span class="op" id="2817925">:=</span>&nbsp;<span class="ident" id="2817928">l</span><span class="op" id="2817929">.</span><span class="ident" id="2817930">lookup</span><span class="op" id="2817936">(</span><span class="ident" id="2817937">unix</span>&nbsp;<span class="op" id="2817942">-</span>&nbsp;<span class="ident" id="2817944">int64</span><span class="op" id="2817949">(</span><span class="ident" id="2817950">zone</span><span class="op" id="2817954">.</span><span class="ident" id="2817955">offset</span><span class="op" id="2817961">)</span><span class="op" id="2817962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2817967">if</span>&nbsp;<span class="ident" id="2817970">nam</span>&nbsp;<span class="op" id="2817974">==</span>&nbsp;<span class="ident" id="2817977">zone</span><span class="op" id="2817981">.</span><span class="ident" id="2817982">name</span>&nbsp;<span class="op" id="2817987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2817993">return</span>&nbsp;<span class="ident" id="2818000">offset</span><span class="op" id="2818006">,</span>&nbsp;<span class="ident" id="2818008">isDST</span><span class="op" id="2818013">,</span>&nbsp;<span class="builtintype" id="2818015">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2818023">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2818027">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2818030">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2818034">//&nbsp;Otherwise&nbsp;fall&nbsp;back&nbsp;to&nbsp;an&nbsp;ordinary&nbsp;name&nbsp;match.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2818085">for</span>&nbsp;<span class="ident" id="2818089">i</span>&nbsp;<span class="op" id="2818091">:=</span>&nbsp;<span class="keyword" id="2818094">range</span>&nbsp;<span class="ident" id="2818100">l</span><span class="op" id="2818101">.</span><span class="ident" id="2818102">zone</span>&nbsp;<span class="op" id="2818107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2818111">zone</span>&nbsp;<span class="op" id="2818116">:=</span>&nbsp;<span class="op" id="2818119">&amp;</span><span class="ident" id="2818120">l</span><span class="op" id="2818121">.</span><span class="ident" id="2818122">zone</span><span class="op" id="2818126">[</span><span class="ident" id="2818127">i</span><span class="op" id="2818128">]</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2818132">if</span>&nbsp;<span class="ident" id="2818135">zone</span><span class="op" id="2818139">.</span><span class="ident" id="2818140">name</span>&nbsp;<span class="op" id="2818145">==</span>&nbsp;<span class="ident" id="2818148">name</span>&nbsp;<span class="op" id="2818153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2818158">return</span>&nbsp;<span class="ident" id="2818165">zone</span><span class="op" id="2818169">.</span><span class="ident" id="2818170">offset</span><span class="op" id="2818176">,</span>&nbsp;<span class="ident" id="2818178">zone</span><span class="op" id="2818182">.</span><span class="ident" id="2818183">isDST</span><span class="op" id="2818188">,</span>&nbsp;<span class="builtintype" id="2818190">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2818197">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2818200">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2818204">//&nbsp;Otherwise,&nbsp;give&nbsp;up.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2818228">return</span><br>
<span class="lineno"></span><span class="op" id="2818235">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2818238">//&nbsp;NOTE(rsc):&nbsp;Eventually&nbsp;we&nbsp;will&nbsp;need&nbsp;to&nbsp;accept&nbsp;the&nbsp;POSIX&nbsp;TZ&nbsp;environment</span><br>
<span class="lineno">255</span><span class="comment" id="2818311">//&nbsp;syntax&nbsp;too,&nbsp;but&nbsp;I&nbsp;don&#39;t&nbsp;feel&nbsp;like&nbsp;implementing&nbsp;it&nbsp;today.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2818372">var</span>&nbsp;<span class="ident" id="2818376">zoneinfo</span><span class="op" id="2818384">,</span>&nbsp;<span class="ident" id="2818386">_</span>&nbsp;<span class="op" id="2818388">=</span>&nbsp;<span class="ident" id="2818390">syscall</span><span class="op" id="2818397">.</span><span class="ident" id="2818398">Getenv</span><span class="op" id="2818404">(</span><span class="string" id="2818405">&#34;ZONEINFO&#34;</span><span class="op" id="2818415">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2818418">//&nbsp;LoadLocation&nbsp;returns&nbsp;the&nbsp;Location&nbsp;with&nbsp;the&nbsp;given&nbsp;name.</span><br>
<span class="lineno">260</span><span class="comment" id="2818476">//</span><br>
<span class="lineno"></span><span class="comment" id="2818479">//&nbsp;If&nbsp;the&nbsp;name&nbsp;is&nbsp;&#34;&#34;&nbsp;or&nbsp;&#34;UTC&#34;,&nbsp;LoadLocation&nbsp;returns&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="comment" id="2818536">//&nbsp;If&nbsp;the&nbsp;name&nbsp;is&nbsp;&#34;Local&#34;,&nbsp;LoadLocation&nbsp;returns&nbsp;Local.</span><br>
<span class="lineno"></span><span class="comment" id="2818591">//</span><br>
<span class="lineno"></span><span class="comment" id="2818594">//&nbsp;Otherwise,&nbsp;the&nbsp;name&nbsp;is&nbsp;taken&nbsp;to&nbsp;be&nbsp;a&nbsp;location&nbsp;name&nbsp;corresponding&nbsp;to&nbsp;a&nbsp;file</span><br>
<span class="lineno">265</span><span class="comment" id="2818672">//&nbsp;in&nbsp;the&nbsp;IANA&nbsp;Time&nbsp;Zone&nbsp;database,&nbsp;such&nbsp;as&nbsp;&#34;America/New_York&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="2818735">//</span><br>
<span class="lineno"></span><span class="comment" id="2818738">//&nbsp;The&nbsp;time&nbsp;zone&nbsp;database&nbsp;needed&nbsp;by&nbsp;LoadLocation&nbsp;may&nbsp;not&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="2818798">//&nbsp;present&nbsp;on&nbsp;all&nbsp;systems,&nbsp;especially&nbsp;non-Unix&nbsp;systems.</span><br>
<span class="lineno"></span><span class="comment" id="2818854">//&nbsp;LoadLocation&nbsp;looks&nbsp;in&nbsp;the&nbsp;directory&nbsp;or&nbsp;uncompressed&nbsp;zip&nbsp;file</span><br>
<span class="lineno">270</span><span class="comment" id="2818918">//&nbsp;named&nbsp;by&nbsp;the&nbsp;ZONEINFO&nbsp;environment&nbsp;variable,&nbsp;if&nbsp;any,&nbsp;then&nbsp;looks&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="2818987">//&nbsp;known&nbsp;installation&nbsp;locations&nbsp;on&nbsp;Unix&nbsp;systems,</span><br>
<span class="lineno"></span><span class="comment" id="2819036">//&nbsp;and&nbsp;finally&nbsp;looks&nbsp;in&nbsp;$GOROOT/lib/time/zoneinfo.zip.</span><br>
<span class="lineno"></span><span class="keyword" id="2819091">func</span>&nbsp;<span class="ident" id="2819096">LoadLocation</span><span class="op" id="2819108">(</span><span class="ident" id="2819109">name</span>&nbsp;<span class="builtintype" id="2819114">string</span><span class="op" id="2819120">)</span>&nbsp;<span class="op" id="2819122">(</span><span class="op" id="2819123">*</span><span class="ident" id="2819124">Location</span><span class="op" id="2819132">,</span>&nbsp;<span class="builtintype" id="2819134">error</span><span class="op" id="2819139">)</span>&nbsp;<span class="op" id="2819141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2819144">if</span>&nbsp;<span class="ident" id="2819147">name</span>&nbsp;<span class="op" id="2819152">==</span>&nbsp;<span class="string" id="2819155">&#34;&#34;</span>&nbsp;<span class="op" id="2819158">||</span>&nbsp;<span class="ident" id="2819161">name</span>&nbsp;<span class="op" id="2819166">==</span>&nbsp;<span class="string" id="2819169">&#34;UTC&#34;</span>&nbsp;<span class="op" id="2819175">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2819179">return</span>&nbsp;<span class="ident" id="2819186">UTC</span><span class="op" id="2819189">,</span>&nbsp;<span class="ident" id="2819191">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2819196">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2819199">if</span>&nbsp;<span class="ident" id="2819202">name</span>&nbsp;<span class="op" id="2819207">==</span>&nbsp;<span class="string" id="2819210">&#34;Local&#34;</span>&nbsp;<span class="op" id="2819218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2819222">return</span>&nbsp;<span class="ident" id="2819229">Local</span><span class="op" id="2819234">,</span>&nbsp;<span class="ident" id="2819236">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2819241">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2819244">if</span>&nbsp;<span class="ident" id="2819247">zoneinfo</span>&nbsp;<span class="op" id="2819256">!=</span>&nbsp;<span class="string" id="2819259">&#34;&#34;</span>&nbsp;<span class="op" id="2819262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2819266">if</span>&nbsp;<span class="ident" id="2819269">z</span><span class="op" id="2819270">,</span>&nbsp;<span class="ident" id="2819272">err</span>&nbsp;<span class="op" id="2819276">:=</span>&nbsp;<span class="ident" id="2819279">loadZoneFile</span><span class="op" id="2819291">(</span><span class="ident" id="2819292">zoneinfo</span><span class="op" id="2819300">,</span>&nbsp;<span class="ident" id="2819302">name</span><span class="op" id="2819306">)</span><span class="op" id="2819307">;</span>&nbsp;<span class="ident" id="2819309">err</span>&nbsp;<span class="op" id="2819313">==</span>&nbsp;<span class="ident" id="2819316">nil</span>&nbsp;<span class="op" id="2819320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2819325">z</span><span class="op" id="2819326">.</span><span class="ident" id="2819327">name</span>&nbsp;<span class="op" id="2819332">=</span>&nbsp;<span class="ident" id="2819334">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2819342">return</span>&nbsp;<span class="ident" id="2819349">z</span><span class="op" id="2819350">,</span>&nbsp;<span class="ident" id="2819352">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2819358">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2819361">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2819364">return</span>&nbsp;<span class="ident" id="2819371">loadLocation</span><span class="op" id="2819383">(</span><span class="ident" id="2819384">name</span><span class="op" id="2819388">)</span><br>
<span class="lineno"></span><span class="op" id="2819390">}</span>
</div>
</body>
</html>
