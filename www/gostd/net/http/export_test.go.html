<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html" class="current">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7503613">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7503669">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7503723">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="7503774">//&nbsp;Bridge&nbsp;package&nbsp;to&nbsp;expose&nbsp;http&nbsp;internals&nbsp;to&nbsp;tests&nbsp;in&nbsp;the&nbsp;http_test</span><br>
<span class="lineno"></span><span class="comment" id="7503843">//&nbsp;package.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7503856">package</span>&nbsp;<span class="ident" id="7503864">http</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="7503870">import</span>&nbsp;<span class="op" id="7503877">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7503880">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7503887">&#34;net/url&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7503898">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="7503905">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="7503908">func</span>&nbsp;<span class="ident" id="7503913">NewLoggingConn</span><span class="op" id="7503927">(</span><span class="ident" id="7503928">baseName</span>&nbsp;<span class="builtintype" id="7503937">string</span><span class="op" id="7503943">,</span>&nbsp;<span class="ident" id="7503945">c</span>&nbsp;<span class="ident" id="7503947"><a href="/gostd/net/http/export_test.go.html#7503880">net</a></span><span class="op" id="7503950">.</span><span class="ident" id="7503951"><a href="/gostd/net/net.go.html#3334417">Conn</a></span><span class="op" id="7503955">)</span>&nbsp;<span class="ident" id="7503957"><a href="/gostd/net/http/export_test.go.html#7503880">net</a></span><span class="op" id="7503960">.</span><span class="ident" id="7503961"><a href="/gostd/net/net.go.html#3334417">Conn</a></span>&nbsp;<span class="op" id="7503966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7503969">return</span>&nbsp;<span class="ident" id="7503976"><a href="/gostd/net/http/server.go.html#4229352">newLoggingConn</a></span><span class="op" id="7503990">(</span><span class="ident" id="7503991"><a href="/gostd/net/http/export_test.go.html#7503928">baseName</a></span><span class="op" id="7503999">,</span>&nbsp;<span class="ident" id="7504001"><a href="/gostd/net/http/export_test.go.html#7503945">c</a></span><span class="op" id="7504002">)</span><br>
<span class="lineno"></span><span class="op" id="7504004">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="7504007">var</span>&nbsp;<span class="ident" id="7504011">ExportAppendTime</span>&nbsp;<span class="op" id="7504028">=</span>&nbsp;<span class="ident" id="7504030"><a href="/gostd/net/http/server.go.html#4184384">appendTime</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7504042">func</span>&nbsp;<span class="op" id="7504047">(</span><span class="ident" id="7504048">t</span>&nbsp;<span class="op" id="7504050">*</span><span class="ident" id="7504051"><a href="/gostd/net/http/transport.go.html#4260801">Transport</a></span><span class="op" id="7504060">)</span>&nbsp;<span class="ident" id="7504062">NumPendingRequestsForTesting</span><span class="op" id="7504090">(</span><span class="op" id="7504091">)</span>&nbsp;<span class="builtintype" id="7504093">int</span>&nbsp;<span class="op" id="7504097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7504100"><a href="/gostd/net/http/export_test.go.html#7504048">t</a></span><span class="op" id="7504101">.</span><span class="ident" id="7504102"><a href="/gostd/net/http/transport.go.html#4261007">reqMu</a></span><span class="op" id="7504107">.</span><span class="ident" id="7504108"><a href="/gostd/sync/mutex.go.html#1444351">Lock</a></span><span class="op" id="7504112">(</span><span class="op" id="7504113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7504116">defer</span>&nbsp;<span class="ident" id="7504122"><a href="/gostd/net/http/export_test.go.html#7504048">t</a></span><span class="op" id="7504123">.</span><span class="ident" id="7504124"><a href="/gostd/net/http/transport.go.html#4261007">reqMu</a></span><span class="op" id="7504129">.</span><span class="ident" id="7504130"><a href="/gostd/sync/mutex.go.html#1445283">Unlock</a></span><span class="op" id="7504136">(</span><span class="op" id="7504137">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7504140">return</span>&nbsp;<span class="builtinfunc" id="7504147">len</span><span class="op" id="7504150">(</span><span class="ident" id="7504151"><a href="/gostd/net/http/export_test.go.html#7504048">t</a></span><span class="op" id="7504152">.</span><span class="ident" id="7504153"><a href="/gostd/net/http/transport.go.html#4261031">reqCanceler</a></span><span class="op" id="7504164">)</span><br>
<span class="lineno"></span><span class="op" id="7504166">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7504169">func</span>&nbsp;<span class="op" id="7504174">(</span><span class="ident" id="7504175">t</span>&nbsp;<span class="op" id="7504177">*</span><span class="ident" id="7504178"><a href="/gostd/net/http/transport.go.html#4260801">Transport</a></span><span class="op" id="7504187">)</span>&nbsp;<span class="ident" id="7504189">IdleConnKeysForTesting</span><span class="op" id="7504211">(</span><span class="op" id="7504212">)</span>&nbsp;<span class="op" id="7504214">(</span><span class="ident" id="7504215">keys</span>&nbsp;<span class="op" id="7504220">[</span><span class="op" id="7504221">]</span><span class="builtintype" id="7504222">string</span><span class="op" id="7504228">)</span>&nbsp;<span class="op" id="7504230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7504233"><a href="/gostd/net/http/export_test.go.html#7504215">keys</a></span>&nbsp;<span class="op" id="7504238">=</span>&nbsp;<span class="builtinfunc" id="7504240">make</span><span class="op" id="7504244">(</span><span class="op" id="7504245">[</span><span class="op" id="7504246">]</span><span class="builtintype" id="7504247">string</span><span class="op" id="7504253">,</span>&nbsp;<span class="num" id="7504255">0</span><span class="op" id="7504256">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7504259"><a href="/gostd/net/http/export_test.go.html#7504175">t</a></span><span class="op" id="7504260">.</span><span class="ident" id="7504261"><a href="/gostd/net/http/transport.go.html#4260821">idleMu</a></span><span class="op" id="7504267">.</span><span class="ident" id="7504268"><a href="/gostd/sync/mutex.go.html#1444351">Lock</a></span><span class="op" id="7504272">(</span><span class="op" id="7504273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7504276">defer</span>&nbsp;<span class="ident" id="7504282"><a href="/gostd/net/http/export_test.go.html#7504175">t</a></span><span class="op" id="7504283">.</span><span class="ident" id="7504284"><a href="/gostd/net/http/transport.go.html#4260821">idleMu</a></span><span class="op" id="7504290">.</span><span class="ident" id="7504291"><a href="/gostd/sync/mutex.go.html#1445283">Unlock</a></span><span class="op" id="7504297">(</span><span class="op" id="7504298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7504301">if</span>&nbsp;<span class="ident" id="7504304"><a href="/gostd/net/http/export_test.go.html#7504175">t</a></span><span class="op" id="7504305">.</span><span class="ident" id="7504306"><a href="/gostd/net/http/transport.go.html#4260907">idleConn</a></span>&nbsp;<span class="op" id="7504315">==</span>&nbsp;<span class="builtintype" id="7504318">nil</span>&nbsp;<span class="op" id="7504322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7504326">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7504334">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7504337">for</span>&nbsp;<span class="ident" id="7504341">key</span>&nbsp;<span class="op" id="7504345">:=</span>&nbsp;<span class="keyword" id="7504348">range</span>&nbsp;<span class="ident" id="7504354"><a href="/gostd/net/http/export_test.go.html#7504175">t</a></span><span class="op" id="7504355">.</span><span class="ident" id="7504356"><a href="/gostd/net/http/transport.go.html#4260907">idleConn</a></span>&nbsp;<span class="op" id="7504365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7504369"><a href="/gostd/net/http/export_test.go.html#7504215">keys</a></span>&nbsp;<span class="op" id="7504374">=</span>&nbsp;<span class="builtinfunc" id="7504376">append</span><span class="op" id="7504382">(</span><span class="ident" id="7504383"><a href="/gostd/net/http/export_test.go.html#7504215">keys</a></span><span class="op" id="7504387">,</span>&nbsp;<span class="ident" id="7504389"><a href="/gostd/net/http/export_test.go.html#7504341">key</a></span><span class="op" id="7504392">.</span><span class="ident" id="7504393"><a href="/gostd/net/http/transport.go.html#4280364">String</a></span><span class="op" id="7504399">(</span><span class="op" id="7504400">)</span><span class="op" id="7504401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7504404">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7504407">return</span><br>
<span class="lineno"></span><span class="op" id="7504414">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="7504417">func</span>&nbsp;<span class="op" id="7504422">(</span><span class="ident" id="7504423">t</span>&nbsp;<span class="op" id="7504425">*</span><span class="ident" id="7504426"><a href="/gostd/net/http/transport.go.html#4260801">Transport</a></span><span class="op" id="7504435">)</span>&nbsp;<span class="ident" id="7504437">IdleConnCountForTesting</span><span class="op" id="7504460">(</span><span class="ident" id="7504461">cacheKey</span>&nbsp;<span class="builtintype" id="7504470">string</span><span class="op" id="7504476">)</span>&nbsp;<span class="builtintype" id="7504478">int</span>&nbsp;<span class="op" id="7504482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7504485"><a href="/gostd/net/http/export_test.go.html#7504423">t</a></span><span class="op" id="7504486">.</span><span class="ident" id="7504487"><a href="/gostd/net/http/transport.go.html#4260821">idleMu</a></span><span class="op" id="7504493">.</span><span class="ident" id="7504494"><a href="/gostd/sync/mutex.go.html#1444351">Lock</a></span><span class="op" id="7504498">(</span><span class="op" id="7504499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7504502">defer</span>&nbsp;<span class="ident" id="7504508"><a href="/gostd/net/http/export_test.go.html#7504423">t</a></span><span class="op" id="7504509">.</span><span class="ident" id="7504510"><a href="/gostd/net/http/transport.go.html#4260821">idleMu</a></span><span class="op" id="7504516">.</span><span class="ident" id="7504517"><a href="/gostd/sync/mutex.go.html#1445283">Unlock</a></span><span class="op" id="7504523">(</span><span class="op" id="7504524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7504527">if</span>&nbsp;<span class="ident" id="7504530"><a href="/gostd/net/http/export_test.go.html#7504423">t</a></span><span class="op" id="7504531">.</span><span class="ident" id="7504532"><a href="/gostd/net/http/transport.go.html#4260907">idleConn</a></span>&nbsp;<span class="op" id="7504541">==</span>&nbsp;<span class="builtintype" id="7504544">nil</span>&nbsp;<span class="op" id="7504548">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7504552">return</span>&nbsp;<span class="num" id="7504559">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7504562">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7504565">for</span>&nbsp;<span class="ident" id="7504569">k</span><span class="op" id="7504570">,</span>&nbsp;<span class="ident" id="7504572">conns</span>&nbsp;<span class="op" id="7504578">:=</span>&nbsp;<span class="keyword" id="7504581">range</span>&nbsp;<span class="ident" id="7504587"><a href="/gostd/net/http/export_test.go.html#7504423">t</a></span><span class="op" id="7504588">.</span><span class="ident" id="7504589"><a href="/gostd/net/http/transport.go.html#4260907">idleConn</a></span>&nbsp;<span class="op" id="7504598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7504602">if</span>&nbsp;<span class="ident" id="7504605"><a href="/gostd/net/http/export_test.go.html#7504569">k</a></span><span class="op" id="7504606">.</span><span class="ident" id="7504607"><a href="/gostd/net/http/transport.go.html#4280364">String</a></span><span class="op" id="7504613">(</span><span class="op" id="7504614">)</span>&nbsp;<span class="op" id="7504616">==</span>&nbsp;<span class="ident" id="7504619"><a href="/gostd/net/http/export_test.go.html#7504461">cacheKey</a></span>&nbsp;<span class="op" id="7504628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7504633">return</span>&nbsp;<span class="builtinfunc" id="7504640">len</span><span class="op" id="7504643">(</span><span class="ident" id="7504644"><a href="/gostd/net/http/export_test.go.html#7504572">conns</a></span><span class="op" id="7504649">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7504653">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7504656">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7504659">return</span>&nbsp;<span class="num" id="7504666">0</span><br>
<span class="lineno"></span><span class="op" id="7504668">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="7504671">func</span>&nbsp;<span class="op" id="7504676">(</span><span class="ident" id="7504677">t</span>&nbsp;<span class="op" id="7504679">*</span><span class="ident" id="7504680"><a href="/gostd/net/http/transport.go.html#4260801">Transport</a></span><span class="op" id="7504689">)</span>&nbsp;<span class="ident" id="7504691">IdleConnChMapSizeForTesting</span><span class="op" id="7504718">(</span><span class="op" id="7504719">)</span>&nbsp;<span class="builtintype" id="7504721">int</span>&nbsp;<span class="op" id="7504725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7504728"><a href="/gostd/net/http/export_test.go.html#7504677">t</a></span><span class="op" id="7504729">.</span><span class="ident" id="7504730"><a href="/gostd/net/http/transport.go.html#4260821">idleMu</a></span><span class="op" id="7504736">.</span><span class="ident" id="7504737"><a href="/gostd/sync/mutex.go.html#1444351">Lock</a></span><span class="op" id="7504741">(</span><span class="op" id="7504742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7504745">defer</span>&nbsp;<span class="ident" id="7504751"><a href="/gostd/net/http/export_test.go.html#7504677">t</a></span><span class="op" id="7504752">.</span><span class="ident" id="7504753"><a href="/gostd/net/http/transport.go.html#4260821">idleMu</a></span><span class="op" id="7504759">.</span><span class="ident" id="7504760"><a href="/gostd/sync/mutex.go.html#1445283">Unlock</a></span><span class="op" id="7504766">(</span><span class="op" id="7504767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7504770">return</span>&nbsp;<span class="builtinfunc" id="7504777">len</span><span class="op" id="7504780">(</span><span class="ident" id="7504781"><a href="/gostd/net/http/export_test.go.html#7504677">t</a></span><span class="op" id="7504782">.</span><span class="ident" id="7504783"><a href="/gostd/net/http/transport.go.html#4260955">idleConnCh</a></span><span class="op" id="7504793">)</span><br>
<span class="lineno"></span><span class="op" id="7504795">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="7504798">func</span>&nbsp;<span class="op" id="7504803">(</span><span class="ident" id="7504804">t</span>&nbsp;<span class="op" id="7504806">*</span><span class="ident" id="7504807"><a href="/gostd/net/http/transport.go.html#4260801">Transport</a></span><span class="op" id="7504816">)</span>&nbsp;<span class="ident" id="7504818">IsIdleForTesting</span><span class="op" id="7504834">(</span><span class="op" id="7504835">)</span>&nbsp;<span class="builtintype" id="7504837">bool</span>&nbsp;<span class="op" id="7504842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7504845"><a href="/gostd/net/http/export_test.go.html#7504804">t</a></span><span class="op" id="7504846">.</span><span class="ident" id="7504847"><a href="/gostd/net/http/transport.go.html#4260821">idleMu</a></span><span class="op" id="7504853">.</span><span class="ident" id="7504854"><a href="/gostd/sync/mutex.go.html#1444351">Lock</a></span><span class="op" id="7504858">(</span><span class="op" id="7504859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7504862">defer</span>&nbsp;<span class="ident" id="7504868"><a href="/gostd/net/http/export_test.go.html#7504804">t</a></span><span class="op" id="7504869">.</span><span class="ident" id="7504870"><a href="/gostd/net/http/transport.go.html#4260821">idleMu</a></span><span class="op" id="7504876">.</span><span class="ident" id="7504877"><a href="/gostd/sync/mutex.go.html#1445283">Unlock</a></span><span class="op" id="7504883">(</span><span class="op" id="7504884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7504887">return</span>&nbsp;<span class="ident" id="7504894"><a href="/gostd/net/http/export_test.go.html#7504804">t</a></span><span class="op" id="7504895">.</span><span class="ident" id="7504896"><a href="/gostd/net/http/transport.go.html#4260844">wantIdle</a></span><br>
<span class="lineno">65</span><span class="op" id="7504905">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7504908">func</span>&nbsp;<span class="op" id="7504913">(</span><span class="ident" id="7504914">t</span>&nbsp;<span class="op" id="7504916">*</span><span class="ident" id="7504917"><a href="/gostd/net/http/transport.go.html#4260801">Transport</a></span><span class="op" id="7504926">)</span>&nbsp;<span class="ident" id="7504928">RequestIdleConnChForTesting</span><span class="op" id="7504955">(</span><span class="op" id="7504956">)</span>&nbsp;<span class="op" id="7504958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7504961"><a href="/gostd/net/http/export_test.go.html#7504914">t</a></span><span class="op" id="7504962">.</span><span class="ident" id="7504963"><a href="/gostd/net/http/transport.go.html#4271537">getIdleConnCh</a></span><span class="op" id="7504976">(</span><span class="ident" id="7504977"><a href="/gostd/net/http/transport.go.html#4279173">connectMethod</a></span><span class="op" id="7504990">{</span><span class="builtintype" id="7504991">nil</span><span class="op" id="7504994">,</span>&nbsp;<span class="string" id="7504996">&#34;http&#34;</span><span class="op" id="7505002">,</span>&nbsp;<span class="string" id="7505004">&#34;example.com&#34;</span><span class="op" id="7505017">}</span><span class="op" id="7505018">)</span><br>
<span class="lineno"></span><span class="op" id="7505020">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="7505023">func</span>&nbsp;<span class="op" id="7505028">(</span><span class="ident" id="7505029">t</span>&nbsp;<span class="op" id="7505031">*</span><span class="ident" id="7505032"><a href="/gostd/net/http/transport.go.html#4260801">Transport</a></span><span class="op" id="7505041">)</span>&nbsp;<span class="ident" id="7505043">PutIdleTestConn</span><span class="op" id="7505058">(</span><span class="op" id="7505059">)</span>&nbsp;<span class="builtintype" id="7505061">bool</span>&nbsp;<span class="op" id="7505066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7505069">c</span><span class="op" id="7505070">,</span>&nbsp;<span class="ident" id="7505072">_</span>&nbsp;<span class="op" id="7505074">:=</span>&nbsp;<span class="ident" id="7505077"><a href="/gostd/net/http/export_test.go.html#7503880">net</a></span><span class="op" id="7505080">.</span><span class="ident" id="7505081"><a href="/gostd/net/pipe.go.html#3349719">Pipe</a></span><span class="op" id="7505085">(</span><span class="op" id="7505086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7505089">return</span>&nbsp;<span class="ident" id="7505096"><a href="/gostd/net/http/export_test.go.html#7505029">t</a></span><span class="op" id="7505097">.</span><span class="ident" id="7505098"><a href="/gostd/net/http/transport.go.html#4270026">putIdleConn</a></span><span class="op" id="7505109">(</span><span class="op" id="7505110">&amp;</span><span class="ident" id="7505111"><a href="/gostd/net/http/transport.go.html#4280590">persistConn</a></span><span class="op" id="7505122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7505126"><a href="/gostd/net/http/transport.go.html#4280612">t</a></span><span class="op" id="7505127">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7505136"><a href="/gostd/net/http/export_test.go.html#7505029">t</a></span><span class="op" id="7505137">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7505141"><a href="/gostd/net/http/transport.go.html#4280660">conn</a></span><span class="op" id="7505145">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7505151"><a href="/gostd/net/http/export_test.go.html#7505069">c</a></span><span class="op" id="7505152">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7505172">//&nbsp;dummy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7505183"><a href="/gostd/net/http/transport.go.html#4281024">closech</a></span><span class="op" id="7505190">:</span>&nbsp;&nbsp;<span class="builtinfunc" id="7505193">make</span><span class="op" id="7505197">(</span><span class="keyword" id="7505198">chan</span>&nbsp;<span class="keyword" id="7505203">struct</span><span class="op" id="7505209">{</span><span class="op" id="7505210">}</span><span class="op" id="7505211">)</span><span class="op" id="7505212">,</span>&nbsp;<span class="comment" id="7505214">//&nbsp;so&nbsp;it&nbsp;can&nbsp;be&nbsp;closed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7505239"><a href="/gostd/net/http/transport.go.html#4280633">cacheKey</a></span><span class="op" id="7505247">:</span>&nbsp;<span class="ident" id="7505249"><a href="/gostd/net/http/transport.go.html#4280281">connectMethodKey</a></span><span class="op" id="7505265">{</span><span class="string" id="7505266">&#34;&#34;</span><span class="op" id="7505268">,</span>&nbsp;<span class="string" id="7505270">&#34;http&#34;</span><span class="op" id="7505276">,</span>&nbsp;<span class="string" id="7505278">&#34;example.com&#34;</span><span class="op" id="7505291">}</span><span class="op" id="7505292">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7505295">}</span><span class="op" id="7505296">)</span><br>
<span class="lineno"></span><span class="op" id="7505298">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="keyword" id="7505301">func</span>&nbsp;<span class="ident" id="7505306">NewTestTimeoutHandler</span><span class="op" id="7505327">(</span><span class="ident" id="7505328">handler</span>&nbsp;<span class="ident" id="7505336"><a href="/gostd/net/http/server.go.html#4170413">Handler</a></span><span class="op" id="7505343">,</span>&nbsp;<span class="ident" id="7505345">ch</span>&nbsp;<span class="op" id="7505348">&lt;-</span><span class="keyword" id="7505350">chan</span>&nbsp;<span class="ident" id="7505355"><a href="/gostd/net/http/export_test.go.html#7503898">time</a></span><span class="op" id="7505359">.</span><span class="ident" id="7505360"><a href="/gostd/time/time.go.html#2722087">Time</a></span><span class="op" id="7505364">)</span>&nbsp;<span class="ident" id="7505366"><a href="/gostd/net/http/server.go.html#4170413">Handler</a></span>&nbsp;<span class="op" id="7505374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7505377">f</span>&nbsp;<span class="op" id="7505379">:=</span>&nbsp;<span class="keyword" id="7505382">func</span><span class="op" id="7505386">(</span><span class="op" id="7505387">)</span>&nbsp;<span class="op" id="7505389">&lt;-</span><span class="keyword" id="7505391">chan</span>&nbsp;<span class="ident" id="7505396"><a href="/gostd/net/http/export_test.go.html#7503898">time</a></span><span class="op" id="7505400">.</span><span class="ident" id="7505401"><a href="/gostd/time/time.go.html#2722087">Time</a></span>&nbsp;<span class="op" id="7505406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7505410">return</span>&nbsp;<span class="ident" id="7505417"><a href="/gostd/net/http/export_test.go.html#7505345">ch</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7505421">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7505424">return</span>&nbsp;<span class="op" id="7505431">&amp;</span><span class="ident" id="7505432"><a href="/gostd/net/http/server.go.html#4225741">timeoutHandler</a></span><span class="op" id="7505446">{</span><span class="ident" id="7505447"><a href="/gostd/net/http/export_test.go.html#7505328">handler</a></span><span class="op" id="7505454">,</span>&nbsp;<span class="ident" id="7505456"><a href="/gostd/net/http/export_test.go.html#7505377">f</a></span><span class="op" id="7505457">,</span>&nbsp;<span class="string" id="7505459">&#34;&#34;</span><span class="op" id="7505461">}</span><br>
<span class="lineno"></span><span class="op" id="7505463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7505466">func</span>&nbsp;<span class="ident" id="7505471">ResetCachedEnvironment</span><span class="op" id="7505493">(</span><span class="op" id="7505494">)</span>&nbsp;<span class="op" id="7505496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7505499"><a href="/gostd/net/http/transport.go.html#4268495">httpProxyEnv</a></span><span class="op" id="7505511">.</span><span class="ident" id="7505512"><a href="/gostd/net/http/transport.go.html#4269177">reset</a></span><span class="op" id="7505517">(</span><span class="op" id="7505518">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7505521"><a href="/gostd/net/http/transport.go.html#4268571">httpsProxyEnv</a></span><span class="op" id="7505534">.</span><span class="ident" id="7505535"><a href="/gostd/net/http/transport.go.html#4269177">reset</a></span><span class="op" id="7505540">(</span><span class="op" id="7505541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7505544"><a href="/gostd/net/http/transport.go.html#4268650">noProxyEnv</a></span><span class="op" id="7505554">.</span><span class="ident" id="7505555"><a href="/gostd/net/http/transport.go.html#4269177">reset</a></span><span class="op" id="7505560">(</span><span class="op" id="7505561">)</span><br>
<span class="lineno"></span><span class="op" id="7505563">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7505566">var</span>&nbsp;<span class="ident" id="7505570">DefaultUserAgent</span>&nbsp;<span class="op" id="7505587">=</span>&nbsp;<span class="ident" id="7505589"><a href="/gostd/net/http/request.go.html#4145518">defaultUserAgent</a></span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="7505607">func</span>&nbsp;<span class="ident" id="7505612">ExportRefererForURL</span><span class="op" id="7505631">(</span><span class="ident" id="7505632">lastReq</span><span class="op" id="7505639">,</span>&nbsp;<span class="ident" id="7505641">newReq</span>&nbsp;<span class="op" id="7505648">*</span><span class="ident" id="7505649"><a href="/gostd/net/http/export_test.go.html#7503887">url</a></span><span class="op" id="7505652">.</span><span class="ident" id="7505653"><a href="/gostd/net/url/url.go.html#3751194">URL</a></span><span class="op" id="7505656">)</span>&nbsp;<span class="builtintype" id="7505658">string</span>&nbsp;<span class="op" id="7505665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7505668">return</span>&nbsp;<span class="ident" id="7505675"><a href="/gostd/net/http/client.go.html#4083765">refererForURL</a></span><span class="op" id="7505688">(</span><span class="ident" id="7505689"><a href="/gostd/net/http/export_test.go.html#7505632">lastReq</a></span><span class="op" id="7505696">,</span>&nbsp;<span class="ident" id="7505698"><a href="/gostd/net/http/export_test.go.html#7505641">newReq</a></span><span class="op" id="7505704">)</span><br>
<span class="lineno"></span><span class="op" id="7505706">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="comment" id="7505709">//&nbsp;SetPendingDialHooks&nbsp;sets&nbsp;the&nbsp;hooks&nbsp;that&nbsp;run&nbsp;before&nbsp;and&nbsp;after&nbsp;handling</span><br>
<span class="lineno"></span><span class="comment" id="7505782">//&nbsp;pending&nbsp;dials.</span><br>
<span class="lineno"></span><span class="keyword" id="7505800">func</span>&nbsp;<span class="ident" id="7505805">SetPendingDialHooks</span><span class="op" id="7505824">(</span><span class="ident" id="7505825">before</span><span class="op" id="7505831">,</span>&nbsp;<span class="ident" id="7505833">after</span>&nbsp;<span class="keyword" id="7505839">func</span><span class="op" id="7505843">(</span><span class="op" id="7505844">)</span><span class="op" id="7505845">)</span>&nbsp;<span class="op" id="7505847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7505850"><a href="/gostd/net/http/transport.go.html#4272867">prePendingDial</a></span><span class="op" id="7505864">,</span>&nbsp;<span class="ident" id="7505866"><a href="/gostd/net/http/transport.go.html#4272883">postPendingDial</a></span>&nbsp;<span class="op" id="7505882">=</span>&nbsp;<span class="ident" id="7505884"><a href="/gostd/net/http/export_test.go.html#7505825">before</a></span><span class="op" id="7505890">,</span>&nbsp;<span class="ident" id="7505892"><a href="/gostd/net/http/export_test.go.html#7505833">after</a></span><br>
<span class="lineno"></span><span class="op" id="7505898">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="keyword" id="7505901">var</span>&nbsp;<span class="ident" id="7505905">ExportServerNewConn</span>&nbsp;<span class="op" id="7505925">=</span>&nbsp;<span class="op" id="7505927">(</span><span class="op" id="7505928">*</span><span class="ident" id="7505929"><a href="/gostd/net/http/server.go.html#4216561">Server</a></span><span class="op" id="7505935">)</span><span class="op" id="7505936">.</span><span class="ident" id="7505937"><a href="/gostd/net/http/server.go.html#4181604">newConn</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7505946">var</span>&nbsp;<span class="ident" id="7505950">ExportCloseWriteAndWait</span>&nbsp;<span class="op" id="7505974">=</span>&nbsp;<span class="op" id="7505976">(</span><span class="op" id="7505977">*</span><span class="ident" id="7505978"><a href="/gostd/net/http/server.go.html#4172792">conn</a></span><span class="op" id="7505982">)</span><span class="op" id="7505983">.</span><span class="ident" id="7505984"><a href="/gostd/net/http/server.go.html#4200776">closeWriteAndWait</a></span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
