<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>os</h2>
<ul>
<li><a href="/gostd/os/dir_unix.go.html">dir_unix.go</a></li>
<li><a href="/gostd/os/doc.go.html">doc.go</a></li>
<li><a href="/gostd/os/env.go.html">env.go</a></li>
<li><a href="/gostd/os/env_test.go.html">env_test.go</a></li>
<li><a href="/gostd/os/env_unix_test.go.html">env_unix_test.go</a></li>
<li><a href="/gostd/os/error.go.html">error.go</a></li>
<li><a href="/gostd/os/error_test.go.html">error_test.go</a></li>
<li><a href="/gostd/os/error_unix.go.html">error_unix.go</a></li>
<li><a href="/gostd/os/exec.go.html">exec.go</a></li>
<li><a href="/gostd/os/exec_posix.go.html">exec_posix.go</a></li>
<li><a href="/gostd/os/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/os/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/os/file.go.html">file.go</a></li>
<li><a href="/gostd/os/file_posix.go.html">file_posix.go</a></li>
<li><a href="/gostd/os/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/os/getwd.go.html">getwd.go</a></li>
<li><a href="/gostd/os/os_test.go.html">os_test.go</a></li>
<li><a href="/gostd/os/os_unix_test.go.html">os_unix_test.go</a></li>
<li><a href="/gostd/os/path.go.html">path.go</a></li>
<li><a href="/gostd/os/path_test.go.html">path_test.go</a></li>
<li><a href="/gostd/os/path_unix.go.html">path_unix.go</a></li>
<li><a href="/gostd/os/pipe_linux.go.html">pipe_linux.go</a></li>
<li><a href="/gostd/os/proc.go.html">proc.go</a></li>
<li><a href="/gostd/os/stat_linux.go.html">stat_linux.go</a></li>
<li><a href="/gostd/os/sys_linux.go.html">sys_linux.go</a></li>
<li><a href="/gostd/os/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/os/types.go.html">types.go</a></li>
<li><a href="/gostd/os/types_notwin.go.html">types_notwin.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2312051">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2312107">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2312161">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2312212">//&nbsp;General&nbsp;environment&nbsp;variables.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2312247">package</span>&nbsp;<span class="ident" id="2312255">os</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2312259">import</span>&nbsp;<span class="string" id="2312266">&#34;syscall&#34;</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2312277">//&nbsp;Expand&nbsp;replaces&nbsp;${var}&nbsp;or&nbsp;$var&nbsp;in&nbsp;the&nbsp;string&nbsp;based&nbsp;on&nbsp;the&nbsp;mapping&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="2312356">//&nbsp;For&nbsp;example,&nbsp;os.ExpandEnv(s)&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;os.Expand(s,&nbsp;os.Getenv).</span><br>
<span class="lineno"></span><span class="keyword" id="2312430">func</span>&nbsp;<span class="ident" id="2312435">Expand</span><span class="op" id="2312441">(</span><span class="ident" id="2312442">s</span>&nbsp;<span class="builtintype" id="2312444">string</span><span class="op" id="2312450">,</span>&nbsp;<span class="ident" id="2312452">mapping</span>&nbsp;<span class="keyword" id="2312460">func</span><span class="op" id="2312464">(</span><span class="builtintype" id="2312465">string</span><span class="op" id="2312471">)</span>&nbsp;<span class="builtintype" id="2312473">string</span><span class="op" id="2312479">)</span>&nbsp;<span class="builtintype" id="2312481">string</span>&nbsp;<span class="op" id="2312488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2312491">buf</span>&nbsp;<span class="op" id="2312495">:=</span>&nbsp;<span class="builtinfunc" id="2312498">make</span><span class="op" id="2312502">(</span><span class="op" id="2312503">[</span><span class="op" id="2312504">]</span><span class="builtintype" id="2312505">byte</span><span class="op" id="2312509">,</span>&nbsp;<span class="num" id="2312511">0</span><span class="op" id="2312512">,</span>&nbsp;<span class="num" id="2312514">2</span><span class="op" id="2312515">*</span><span class="builtinfunc" id="2312516">len</span><span class="op" id="2312519">(</span><span class="ident" id="2312520">s</span><span class="op" id="2312521">)</span><span class="op" id="2312522">)</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2312525">//&nbsp;${}&nbsp;is&nbsp;all&nbsp;ASCII,&nbsp;so&nbsp;bytes&nbsp;are&nbsp;fine&nbsp;for&nbsp;this&nbsp;operation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2312585">i</span>&nbsp;<span class="op" id="2312587">:=</span>&nbsp;<span class="num" id="2312590">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2312593">for</span>&nbsp;<span class="ident" id="2312597">j</span>&nbsp;<span class="op" id="2312599">:=</span>&nbsp;<span class="num" id="2312602">0</span><span class="op" id="2312603">;</span>&nbsp;<span class="ident" id="2312605">j</span>&nbsp;<span class="op" id="2312607">&lt;</span>&nbsp;<span class="builtinfunc" id="2312609">len</span><span class="op" id="2312612">(</span><span class="ident" id="2312613">s</span><span class="op" id="2312614">)</span><span class="op" id="2312615">;</span>&nbsp;<span class="ident" id="2312617">j</span><span class="op" id="2312618">++</span>&nbsp;<span class="op" id="2312621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2312625">if</span>&nbsp;<span class="ident" id="2312628">s</span><span class="op" id="2312629">[</span><span class="ident" id="2312630">j</span><span class="op" id="2312631">]</span>&nbsp;<span class="op" id="2312633">==</span>&nbsp;<span class="string" id="2312636">&#39;$&#39;</span>&nbsp;<span class="op" id="2312640">&amp;&amp;</span>&nbsp;<span class="ident" id="2312643">j</span><span class="op" id="2312644">+</span><span class="num" id="2312645">1</span>&nbsp;<span class="op" id="2312647">&lt;</span>&nbsp;<span class="builtinfunc" id="2312649">len</span><span class="op" id="2312652">(</span><span class="ident" id="2312653">s</span><span class="op" id="2312654">)</span>&nbsp;<span class="op" id="2312656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2312661">buf</span>&nbsp;<span class="op" id="2312665">=</span>&nbsp;<span class="builtinfunc" id="2312667">append</span><span class="op" id="2312673">(</span><span class="ident" id="2312674">buf</span><span class="op" id="2312677">,</span>&nbsp;<span class="ident" id="2312679">s</span><span class="op" id="2312680">[</span><span class="ident" id="2312681">i</span><span class="op" id="2312682">:</span><span class="ident" id="2312683">j</span><span class="op" id="2312684">]</span><span class="op" id="2312685">...</span><span class="op" id="2312688">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2312693">name</span><span class="op" id="2312697">,</span>&nbsp;<span class="ident" id="2312699">w</span>&nbsp;<span class="op" id="2312701">:=</span>&nbsp;<span class="ident" id="2312704">getShellName</span><span class="op" id="2312716">(</span><span class="ident" id="2312717">s</span><span class="op" id="2312718">[</span><span class="ident" id="2312719">j</span><span class="op" id="2312720">+</span><span class="num" id="2312721">1</span><span class="op" id="2312722">:</span><span class="op" id="2312723">]</span><span class="op" id="2312724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2312729">buf</span>&nbsp;<span class="op" id="2312733">=</span>&nbsp;<span class="builtinfunc" id="2312735">append</span><span class="op" id="2312741">(</span><span class="ident" id="2312742">buf</span><span class="op" id="2312745">,</span>&nbsp;<span class="ident" id="2312747">mapping</span><span class="op" id="2312754">(</span><span class="ident" id="2312755">name</span><span class="op" id="2312759">)</span><span class="op" id="2312760">...</span><span class="op" id="2312763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2312768">j</span>&nbsp;<span class="op" id="2312770">+=</span>&nbsp;<span class="ident" id="2312773">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2312778">i</span>&nbsp;<span class="op" id="2312780">=</span>&nbsp;<span class="ident" id="2312782">j</span>&nbsp;<span class="op" id="2312784">+</span>&nbsp;<span class="num" id="2312786">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2312790">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2312793">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2312796">return</span>&nbsp;<span class="builtintype" id="2312803">string</span><span class="op" id="2312809">(</span><span class="ident" id="2312810">buf</span><span class="op" id="2312813">)</span>&nbsp;<span class="op" id="2312815">+</span>&nbsp;<span class="ident" id="2312817">s</span><span class="op" id="2312818">[</span><span class="ident" id="2312819">i</span><span class="op" id="2312820">:</span><span class="op" id="2312821">]</span><br>
<span class="lineno"></span><span class="op" id="2312823">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2312826">//&nbsp;ExpandEnv&nbsp;replaces&nbsp;${var}&nbsp;or&nbsp;$var&nbsp;in&nbsp;the&nbsp;string&nbsp;according&nbsp;to&nbsp;the&nbsp;values</span><br>
<span class="lineno">30</span><span class="comment" id="2312901">//&nbsp;of&nbsp;the&nbsp;current&nbsp;environment&nbsp;variables.&nbsp;&nbsp;References&nbsp;to&nbsp;undefined</span><br>
<span class="lineno"></span><span class="comment" id="2312967">//&nbsp;variables&nbsp;are&nbsp;replaced&nbsp;by&nbsp;the&nbsp;empty&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2313014">func</span>&nbsp;<span class="ident" id="2313019">ExpandEnv</span><span class="op" id="2313028">(</span><span class="ident" id="2313029">s</span>&nbsp;<span class="builtintype" id="2313031">string</span><span class="op" id="2313037">)</span>&nbsp;<span class="builtintype" id="2313039">string</span>&nbsp;<span class="op" id="2313046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2313049">return</span>&nbsp;<span class="ident" id="2313056">Expand</span><span class="op" id="2313062">(</span><span class="ident" id="2313063">s</span><span class="op" id="2313064">,</span>&nbsp;<span class="ident" id="2313066">Getenv</span><span class="op" id="2313072">)</span><br>
<span class="lineno"></span><span class="op" id="2313074">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="2313077">//&nbsp;isSpellSpecialVar&nbsp;reports&nbsp;whether&nbsp;the&nbsp;character&nbsp;identifies&nbsp;a&nbsp;special</span><br>
<span class="lineno"></span><span class="comment" id="2313149">//&nbsp;shell&nbsp;variable&nbsp;such&nbsp;as&nbsp;$*.</span><br>
<span class="lineno"></span><span class="keyword" id="2313179">func</span>&nbsp;<span class="ident" id="2313184">isShellSpecialVar</span><span class="op" id="2313201">(</span><span class="ident" id="2313202">c</span>&nbsp;<span class="builtintype" id="2313204">uint8</span><span class="op" id="2313209">)</span>&nbsp;<span class="builtintype" id="2313211">bool</span>&nbsp;<span class="op" id="2313216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2313219">switch</span>&nbsp;<span class="ident" id="2313226">c</span>&nbsp;<span class="op" id="2313228">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2313231">case</span>&nbsp;<span class="string" id="2313236">&#39;*&#39;</span><span class="op" id="2313239">,</span>&nbsp;<span class="string" id="2313241">&#39;#&#39;</span><span class="op" id="2313244">,</span>&nbsp;<span class="string" id="2313246">&#39;$&#39;</span><span class="op" id="2313249">,</span>&nbsp;<span class="string" id="2313251">&#39;@&#39;</span><span class="op" id="2313254">,</span>&nbsp;<span class="string" id="2313256">&#39;!&#39;</span><span class="op" id="2313259">,</span>&nbsp;<span class="string" id="2313261">&#39;?&#39;</span><span class="op" id="2313264">,</span>&nbsp;<span class="string" id="2313266">&#39;0&#39;</span><span class="op" id="2313269">,</span>&nbsp;<span class="string" id="2313271">&#39;1&#39;</span><span class="op" id="2313274">,</span>&nbsp;<span class="string" id="2313276">&#39;2&#39;</span><span class="op" id="2313279">,</span>&nbsp;<span class="string" id="2313281">&#39;3&#39;</span><span class="op" id="2313284">,</span>&nbsp;<span class="string" id="2313286">&#39;4&#39;</span><span class="op" id="2313289">,</span>&nbsp;<span class="string" id="2313291">&#39;5&#39;</span><span class="op" id="2313294">,</span>&nbsp;<span class="string" id="2313296">&#39;6&#39;</span><span class="op" id="2313299">,</span>&nbsp;<span class="string" id="2313301">&#39;7&#39;</span><span class="op" id="2313304">,</span>&nbsp;<span class="string" id="2313306">&#39;8&#39;</span><span class="op" id="2313309">,</span>&nbsp;<span class="string" id="2313311">&#39;9&#39;</span><span class="op" id="2313314">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2313318">return</span>&nbsp;<span class="builtintype" id="2313325">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2313331">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2313334">return</span>&nbsp;<span class="builtintype" id="2313341">false</span><br>
<span class="lineno"></span><span class="op" id="2313347">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="comment" id="2313350">//&nbsp;isAlphaNum&nbsp;reports&nbsp;whether&nbsp;the&nbsp;byte&nbsp;is&nbsp;an&nbsp;ASCII&nbsp;letter,&nbsp;number,&nbsp;or&nbsp;underscore</span><br>
<span class="lineno"></span><span class="keyword" id="2313431">func</span>&nbsp;<span class="ident" id="2313436">isAlphaNum</span><span class="op" id="2313446">(</span><span class="ident" id="2313447">c</span>&nbsp;<span class="builtintype" id="2313449">uint8</span><span class="op" id="2313454">)</span>&nbsp;<span class="builtintype" id="2313456">bool</span>&nbsp;<span class="op" id="2313461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2313464">return</span>&nbsp;<span class="ident" id="2313471">c</span>&nbsp;<span class="op" id="2313473">==</span>&nbsp;<span class="string" id="2313476">&#39;_&#39;</span>&nbsp;<span class="op" id="2313480">||</span>&nbsp;<span class="string" id="2313483">&#39;0&#39;</span>&nbsp;<span class="op" id="2313487">&lt;=</span>&nbsp;<span class="ident" id="2313490">c</span>&nbsp;<span class="op" id="2313492">&amp;&amp;</span>&nbsp;<span class="ident" id="2313495">c</span>&nbsp;<span class="op" id="2313497">&lt;=</span>&nbsp;<span class="string" id="2313500">&#39;9&#39;</span>&nbsp;<span class="op" id="2313504">||</span>&nbsp;<span class="string" id="2313507">&#39;a&#39;</span>&nbsp;<span class="op" id="2313511">&lt;=</span>&nbsp;<span class="ident" id="2313514">c</span>&nbsp;<span class="op" id="2313516">&amp;&amp;</span>&nbsp;<span class="ident" id="2313519">c</span>&nbsp;<span class="op" id="2313521">&lt;=</span>&nbsp;<span class="string" id="2313524">&#39;z&#39;</span>&nbsp;<span class="op" id="2313528">||</span>&nbsp;<span class="string" id="2313531">&#39;A&#39;</span>&nbsp;<span class="op" id="2313535">&lt;=</span>&nbsp;<span class="ident" id="2313538">c</span>&nbsp;<span class="op" id="2313540">&amp;&amp;</span>&nbsp;<span class="ident" id="2313543">c</span>&nbsp;<span class="op" id="2313545">&lt;=</span>&nbsp;<span class="string" id="2313548">&#39;Z&#39;</span><br>
<span class="lineno"></span><span class="op" id="2313552">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="comment" id="2313555">//&nbsp;getName&nbsp;returns&nbsp;the&nbsp;name&nbsp;that&nbsp;begins&nbsp;the&nbsp;string&nbsp;and&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno"></span><span class="comment" id="2313630">//&nbsp;consumed&nbsp;to&nbsp;extract&nbsp;it.&nbsp;&nbsp;If&nbsp;the&nbsp;name&nbsp;is&nbsp;enclosed&nbsp;in&nbsp;{},&nbsp;it&#39;s&nbsp;part&nbsp;of&nbsp;a&nbsp;${}</span><br>
<span class="lineno"></span><span class="comment" id="2313708">//&nbsp;expansion&nbsp;and&nbsp;two&nbsp;more&nbsp;bytes&nbsp;are&nbsp;needed&nbsp;than&nbsp;the&nbsp;length&nbsp;of&nbsp;the&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="2313780">func</span>&nbsp;<span class="ident" id="2313785">getShellName</span><span class="op" id="2313797">(</span><span class="ident" id="2313798">s</span>&nbsp;<span class="builtintype" id="2313800">string</span><span class="op" id="2313806">)</span>&nbsp;<span class="op" id="2313808">(</span><span class="builtintype" id="2313809">string</span><span class="op" id="2313815">,</span>&nbsp;<span class="builtintype" id="2313817">int</span><span class="op" id="2313820">)</span>&nbsp;<span class="op" id="2313822">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2313825">switch</span>&nbsp;<span class="op" id="2313832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2313835">case</span>&nbsp;<span class="ident" id="2313840">s</span><span class="op" id="2313841">[</span><span class="num" id="2313842">0</span><span class="op" id="2313843">]</span>&nbsp;<span class="op" id="2313845">==</span>&nbsp;<span class="string" id="2313848">&#39;{&#39;</span><span class="op" id="2313851">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2313855">if</span>&nbsp;<span class="builtinfunc" id="2313858">len</span><span class="op" id="2313861">(</span><span class="ident" id="2313862">s</span><span class="op" id="2313863">)</span>&nbsp;<span class="op" id="2313865">&gt;</span>&nbsp;<span class="num" id="2313867">2</span>&nbsp;<span class="op" id="2313869">&amp;&amp;</span>&nbsp;<span class="ident" id="2313872">isShellSpecialVar</span><span class="op" id="2313889">(</span><span class="ident" id="2313890">s</span><span class="op" id="2313891">[</span><span class="num" id="2313892">1</span><span class="op" id="2313893">]</span><span class="op" id="2313894">)</span>&nbsp;<span class="op" id="2313896">&amp;&amp;</span>&nbsp;<span class="ident" id="2313899">s</span><span class="op" id="2313900">[</span><span class="num" id="2313901">2</span><span class="op" id="2313902">]</span>&nbsp;<span class="op" id="2313904">==</span>&nbsp;<span class="string" id="2313907">&#39;}&#39;</span>&nbsp;<span class="op" id="2313911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2313916">return</span>&nbsp;<span class="ident" id="2313923">s</span><span class="op" id="2313924">[</span><span class="num" id="2313925">1</span><span class="op" id="2313926">:</span><span class="num" id="2313927">2</span><span class="op" id="2313928">]</span><span class="op" id="2313929">,</span>&nbsp;<span class="num" id="2313931">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2313935">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2313939">//&nbsp;Scan&nbsp;to&nbsp;closing&nbsp;brace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2313966">for</span>&nbsp;<span class="ident" id="2313970">i</span>&nbsp;<span class="op" id="2313972">:=</span>&nbsp;<span class="num" id="2313975">1</span><span class="op" id="2313976">;</span>&nbsp;<span class="ident" id="2313978">i</span>&nbsp;<span class="op" id="2313980">&lt;</span>&nbsp;<span class="builtinfunc" id="2313982">len</span><span class="op" id="2313985">(</span><span class="ident" id="2313986">s</span><span class="op" id="2313987">)</span><span class="op" id="2313988">;</span>&nbsp;<span class="ident" id="2313990">i</span><span class="op" id="2313991">++</span>&nbsp;<span class="op" id="2313994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2313999">if</span>&nbsp;<span class="ident" id="2314002">s</span><span class="op" id="2314003">[</span><span class="ident" id="2314004">i</span><span class="op" id="2314005">]</span>&nbsp;<span class="op" id="2314007">==</span>&nbsp;<span class="string" id="2314010">&#39;}&#39;</span>&nbsp;<span class="op" id="2314014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2314020">return</span>&nbsp;<span class="ident" id="2314027">s</span><span class="op" id="2314028">[</span><span class="num" id="2314029">1</span><span class="op" id="2314030">:</span><span class="ident" id="2314031">i</span><span class="op" id="2314032">]</span><span class="op" id="2314033">,</span>&nbsp;<span class="ident" id="2314035">i</span>&nbsp;<span class="op" id="2314037">+</span>&nbsp;<span class="num" id="2314039">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2314044">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2314048">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2314052">return</span>&nbsp;<span class="string" id="2314059">&#34;&#34;</span><span class="op" id="2314061">,</span>&nbsp;<span class="num" id="2314063">1</span>&nbsp;<span class="comment" id="2314065">//&nbsp;Bad&nbsp;syntax;&nbsp;just&nbsp;eat&nbsp;the&nbsp;brace.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2314101">case</span>&nbsp;<span class="ident" id="2314106">isShellSpecialVar</span><span class="op" id="2314123">(</span><span class="ident" id="2314124">s</span><span class="op" id="2314125">[</span><span class="num" id="2314126">0</span><span class="op" id="2314127">]</span><span class="op" id="2314128">)</span><span class="op" id="2314129">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2314133">return</span>&nbsp;<span class="ident" id="2314140">s</span><span class="op" id="2314141">[</span><span class="num" id="2314142">0</span><span class="op" id="2314143">:</span><span class="num" id="2314144">1</span><span class="op" id="2314145">]</span><span class="op" id="2314146">,</span>&nbsp;<span class="num" id="2314148">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2314151">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2314154">//&nbsp;Scan&nbsp;alphanumerics.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2314178">var</span>&nbsp;<span class="ident" id="2314182">i</span>&nbsp;<span class="builtintype" id="2314184">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2314189">for</span>&nbsp;<span class="ident" id="2314193">i</span>&nbsp;<span class="op" id="2314195">=</span>&nbsp;<span class="num" id="2314197">0</span><span class="op" id="2314198">;</span>&nbsp;<span class="ident" id="2314200">i</span>&nbsp;<span class="op" id="2314202">&lt;</span>&nbsp;<span class="builtinfunc" id="2314204">len</span><span class="op" id="2314207">(</span><span class="ident" id="2314208">s</span><span class="op" id="2314209">)</span>&nbsp;<span class="op" id="2314211">&amp;&amp;</span>&nbsp;<span class="ident" id="2314214">isAlphaNum</span><span class="op" id="2314224">(</span><span class="ident" id="2314225">s</span><span class="op" id="2314226">[</span><span class="ident" id="2314227">i</span><span class="op" id="2314228">]</span><span class="op" id="2314229">)</span><span class="op" id="2314230">;</span>&nbsp;<span class="ident" id="2314232">i</span><span class="op" id="2314233">++</span>&nbsp;<span class="op" id="2314236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2314239">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2314242">return</span>&nbsp;<span class="ident" id="2314249">s</span><span class="op" id="2314250">[</span><span class="op" id="2314251">:</span><span class="ident" id="2314252">i</span><span class="op" id="2314253">]</span><span class="op" id="2314254">,</span>&nbsp;<span class="ident" id="2314256">i</span><br>
<span class="lineno">75</span><span class="op" id="2314258">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2314261">//&nbsp;Getenv&nbsp;retrieves&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;environment&nbsp;variable&nbsp;named&nbsp;by&nbsp;the&nbsp;key.</span><br>
<span class="lineno"></span><span class="comment" id="2314337">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;value,&nbsp;which&nbsp;will&nbsp;be&nbsp;empty&nbsp;if&nbsp;the&nbsp;variable&nbsp;is&nbsp;not&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="2314414">func</span>&nbsp;<span class="ident" id="2314419">Getenv</span><span class="op" id="2314425">(</span><span class="ident" id="2314426">key</span>&nbsp;<span class="builtintype" id="2314430">string</span><span class="op" id="2314436">)</span>&nbsp;<span class="builtintype" id="2314438">string</span>&nbsp;<span class="op" id="2314445">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2314448">v</span><span class="op" id="2314449">,</span>&nbsp;<span class="ident" id="2314451">_</span>&nbsp;<span class="op" id="2314453">:=</span>&nbsp;<span class="ident" id="2314456">syscall</span><span class="op" id="2314463">.</span><span class="ident" id="2314464">Getenv</span><span class="op" id="2314470">(</span><span class="ident" id="2314471">key</span><span class="op" id="2314474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2314477">return</span>&nbsp;<span class="ident" id="2314484">v</span><br>
<span class="lineno"></span><span class="op" id="2314486">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2314489">//&nbsp;Setenv&nbsp;sets&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;environment&nbsp;variable&nbsp;named&nbsp;by&nbsp;the&nbsp;key.</span><br>
<span class="lineno">85</span><span class="comment" id="2314560">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;error,&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span><span class="keyword" id="2314592">func</span>&nbsp;<span class="ident" id="2314597">Setenv</span><span class="op" id="2314603">(</span><span class="ident" id="2314604">key</span><span class="op" id="2314607">,</span>&nbsp;<span class="ident" id="2314609">value</span>&nbsp;<span class="builtintype" id="2314615">string</span><span class="op" id="2314621">)</span>&nbsp;<span class="builtintype" id="2314623">error</span>&nbsp;<span class="op" id="2314629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2314632">err</span>&nbsp;<span class="op" id="2314636">:=</span>&nbsp;<span class="ident" id="2314639">syscall</span><span class="op" id="2314646">.</span><span class="ident" id="2314647">Setenv</span><span class="op" id="2314653">(</span><span class="ident" id="2314654">key</span><span class="op" id="2314657">,</span>&nbsp;<span class="ident" id="2314659">value</span><span class="op" id="2314664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2314667">if</span>&nbsp;<span class="ident" id="2314670">err</span>&nbsp;<span class="op" id="2314674">!=</span>&nbsp;<span class="ident" id="2314677">nil</span>&nbsp;<span class="op" id="2314681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2314685">return</span>&nbsp;<span class="ident" id="2314692">NewSyscallError</span><span class="op" id="2314707">(</span><span class="string" id="2314708">&#34;setenv&#34;</span><span class="op" id="2314716">,</span>&nbsp;<span class="ident" id="2314718">err</span><span class="op" id="2314721">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2314724">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2314727">return</span>&nbsp;<span class="ident" id="2314734">nil</span><br>
<span class="lineno"></span><span class="op" id="2314738">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2314741">//&nbsp;Unsetenv&nbsp;unsets&nbsp;a&nbsp;single&nbsp;environment&nbsp;variable.</span><br>
<span class="lineno">95</span><span class="keyword" id="2314791">func</span>&nbsp;<span class="ident" id="2314796">Unsetenv</span><span class="op" id="2314804">(</span><span class="ident" id="2314805">key</span>&nbsp;<span class="builtintype" id="2314809">string</span><span class="op" id="2314815">)</span>&nbsp;<span class="builtintype" id="2314817">error</span>&nbsp;<span class="op" id="2314823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2314826">return</span>&nbsp;<span class="ident" id="2314833">syscall</span><span class="op" id="2314840">.</span><span class="ident" id="2314841">Unsetenv</span><span class="op" id="2314849">(</span><span class="ident" id="2314850">key</span><span class="op" id="2314853">)</span><br>
<span class="lineno"></span><span class="op" id="2314855">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2314858">//&nbsp;Clearenv&nbsp;deletes&nbsp;all&nbsp;environment&nbsp;variables.</span><br>
<span class="lineno">100</span><span class="keyword" id="2314905">func</span>&nbsp;<span class="ident" id="2314910">Clearenv</span><span class="op" id="2314918">(</span><span class="op" id="2314919">)</span>&nbsp;<span class="op" id="2314921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2314924">syscall</span><span class="op" id="2314931">.</span><span class="ident" id="2314932">Clearenv</span><span class="op" id="2314940">(</span><span class="op" id="2314941">)</span><br>
<span class="lineno"></span><span class="op" id="2314943">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2314946">//&nbsp;Environ&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;strings&nbsp;representing&nbsp;the&nbsp;environment,</span><br>
<span class="lineno">105</span><span class="comment" id="2315013">//&nbsp;in&nbsp;the&nbsp;form&nbsp;&#34;key=value&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="2315041">func</span>&nbsp;<span class="ident" id="2315046">Environ</span><span class="op" id="2315053">(</span><span class="op" id="2315054">)</span>&nbsp;<span class="op" id="2315056">[</span><span class="op" id="2315057">]</span><span class="builtintype" id="2315058">string</span>&nbsp;<span class="op" id="2315065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2315068">return</span>&nbsp;<span class="ident" id="2315075">syscall</span><span class="op" id="2315082">.</span><span class="ident" id="2315083">Environ</span><span class="op" id="2315090">(</span><span class="op" id="2315091">)</span><br>
<span class="lineno"></span><span class="op" id="2315093">}</span>
</div>
</body>
</html>
