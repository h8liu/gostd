<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4083529">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4083584">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4083638">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4083689">//&nbsp;Package&nbsp;subtle&nbsp;implements&nbsp;functions&nbsp;that&nbsp;are&nbsp;often&nbsp;useful&nbsp;in&nbsp;cryptographic</span><br>
<span class="lineno"></span><span class="comment" id="4083767">//&nbsp;code&nbsp;but&nbsp;require&nbsp;careful&nbsp;thought&nbsp;to&nbsp;use&nbsp;correctly.</span><br>
<span class="lineno"></span><span class="keyword" id="4083821">package</span>&nbsp;<span class="ident" id="4083829">subtle</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4083837">//&nbsp;ConstantTimeCompare&nbsp;returns&nbsp;1&nbsp;iff&nbsp;the&nbsp;two&nbsp;slices,&nbsp;x</span><br>
<span class="lineno">10</span><span class="comment" id="4083892">//&nbsp;and&nbsp;y,&nbsp;have&nbsp;equal&nbsp;contents.&nbsp;The&nbsp;time&nbsp;taken&nbsp;is&nbsp;a&nbsp;function&nbsp;of&nbsp;the&nbsp;length&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4083969">//&nbsp;the&nbsp;slices&nbsp;and&nbsp;is&nbsp;independent&nbsp;of&nbsp;the&nbsp;contents.</span><br>
<span class="lineno"></span><span class="keyword" id="4084019">func</span>&nbsp;<span class="ident" id="4084024">ConstantTimeCompare</span><span class="op" id="4084043">(</span><span class="ident" id="4084044">x</span><span class="op" id="4084045">,</span>&nbsp;<span class="ident" id="4084047">y</span>&nbsp;<span class="op" id="4084049">[</span><span class="op" id="4084050">]</span><span class="builtintype" id="4084051">byte</span><span class="op" id="4084055">)</span>&nbsp;<span class="builtintype" id="4084057">int</span>&nbsp;<span class="op" id="4084061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084064">if</span>&nbsp;<span class="builtinfunc" id="4084067">len</span><span class="op" id="4084070">(</span><span class="ident" id="4084071"><a href="/crypto/subtle/constant_time.go.html#4084044">x</a></span><span class="op" id="4084072">)</span>&nbsp;<span class="op" id="4084074">!=</span>&nbsp;<span class="builtinfunc" id="4084077">len</span><span class="op" id="4084080">(</span><span class="ident" id="4084081"><a href="/crypto/subtle/constant_time.go.html#4084047">y</a></span><span class="op" id="4084082">)</span>&nbsp;<span class="op" id="4084084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084088">return</span>&nbsp;<span class="num" id="4084095">0</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4084098">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084102">var</span>&nbsp;<span class="ident" id="4084106">v</span>&nbsp;<span class="builtintype" id="4084108">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084115">for</span>&nbsp;<span class="ident" id="4084119">i</span>&nbsp;<span class="op" id="4084121">:=</span>&nbsp;<span class="num" id="4084124">0</span><span class="op" id="4084125">;</span>&nbsp;<span class="ident" id="4084127"><a href="/crypto/subtle/constant_time.go.html#4084119">i</a></span>&nbsp;<span class="op" id="4084129">&lt;</span>&nbsp;<span class="builtinfunc" id="4084131">len</span><span class="op" id="4084134">(</span><span class="ident" id="4084135"><a href="/crypto/subtle/constant_time.go.html#4084044">x</a></span><span class="op" id="4084136">)</span><span class="op" id="4084137">;</span>&nbsp;<span class="ident" id="4084139"><a href="/crypto/subtle/constant_time.go.html#4084119">i</a></span><span class="op" id="4084140">++</span>&nbsp;<span class="op" id="4084143">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084147"><a href="/crypto/subtle/constant_time.go.html#4084106">v</a></span>&nbsp;<span class="op" id="4084149">|=</span>&nbsp;<span class="ident" id="4084152"><a href="/crypto/subtle/constant_time.go.html#4084044">x</a></span><span class="op" id="4084153">[</span><span class="ident" id="4084154"><a href="/crypto/subtle/constant_time.go.html#4084119">i</a></span><span class="op" id="4084155">]</span>&nbsp;<span class="op" id="4084157">^</span>&nbsp;<span class="ident" id="4084159"><a href="/crypto/subtle/constant_time.go.html#4084047">y</a></span><span class="op" id="4084160">[</span><span class="ident" id="4084161"><a href="/crypto/subtle/constant_time.go.html#4084119">i</a></span><span class="op" id="4084162">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4084165">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084169">return</span>&nbsp;<span class="ident" id="4084176"><a href="/crypto/subtle/constant_time.go.html#4084456">ConstantTimeByteEq</a></span><span class="op" id="4084194">(</span><span class="ident" id="4084195"><a href="/crypto/subtle/constant_time.go.html#4084106">v</a></span><span class="op" id="4084196">,</span>&nbsp;<span class="num" id="4084198">0</span><span class="op" id="4084199">)</span><br>
<span class="lineno"></span><span class="op" id="4084201">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="4084204">//&nbsp;ConstantTimeSelect&nbsp;returns&nbsp;x&nbsp;if&nbsp;v&nbsp;is&nbsp;1&nbsp;and&nbsp;y&nbsp;if&nbsp;v&nbsp;is&nbsp;0.</span><br>
<span class="lineno"></span><span class="comment" id="4084263">//&nbsp;Its&nbsp;behavior&nbsp;is&nbsp;undefined&nbsp;if&nbsp;v&nbsp;takes&nbsp;any&nbsp;other&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="4084320">func</span>&nbsp;<span class="ident" id="4084325">ConstantTimeSelect</span><span class="op" id="4084343">(</span><span class="ident" id="4084344">v</span><span class="op" id="4084345">,</span>&nbsp;<span class="ident" id="4084347">x</span><span class="op" id="4084348">,</span>&nbsp;<span class="ident" id="4084350">y</span>&nbsp;<span class="builtintype" id="4084352">int</span><span class="op" id="4084355">)</span>&nbsp;<span class="builtintype" id="4084357">int</span>&nbsp;<span class="op" id="4084361">{</span>&nbsp;<span class="keyword" id="4084363">return</span>&nbsp;<span class="op" id="4084370">^</span><span class="op" id="4084371">(</span><span class="ident" id="4084372"><a href="/crypto/subtle/constant_time.go.html#4084344">v</a></span><span class="op" id="4084373">-</span><span class="num" id="4084374">1</span><span class="op" id="4084375">)</span><span class="op" id="4084376">&amp;</span><span class="ident" id="4084377"><a href="/crypto/subtle/constant_time.go.html#4084347">x</a></span>&nbsp;<span class="op" id="4084379">|</span>&nbsp;<span class="op" id="4084381">(</span><span class="ident" id="4084382"><a href="/crypto/subtle/constant_time.go.html#4084344">v</a></span><span class="op" id="4084383">-</span><span class="num" id="4084384">1</span><span class="op" id="4084385">)</span><span class="op" id="4084386">&amp;</span><span class="ident" id="4084387"><a href="/crypto/subtle/constant_time.go.html#4084350">y</a></span>&nbsp;<span class="op" id="4084389">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="4084392">//&nbsp;ConstantTimeByteEq&nbsp;returns&nbsp;1&nbsp;if&nbsp;x&nbsp;==&nbsp;y&nbsp;and&nbsp;0&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="keyword" id="4084451">func</span>&nbsp;<span class="ident" id="4084456">ConstantTimeByteEq</span><span class="op" id="4084474">(</span><span class="ident" id="4084475">x</span><span class="op" id="4084476">,</span>&nbsp;<span class="ident" id="4084478">y</span>&nbsp;<span class="builtintype" id="4084480">uint8</span><span class="op" id="4084485">)</span>&nbsp;<span class="builtintype" id="4084487">int</span>&nbsp;<span class="op" id="4084491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084494">z</span>&nbsp;<span class="op" id="4084496">:=</span>&nbsp;<span class="op" id="4084499">^</span><span class="op" id="4084500">(</span><span class="ident" id="4084501"><a href="/crypto/subtle/constant_time.go.html#4084475">x</a></span>&nbsp;<span class="op" id="4084503">^</span>&nbsp;<span class="ident" id="4084505"><a href="/crypto/subtle/constant_time.go.html#4084478">y</a></span><span class="op" id="4084506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084509"><a href="/crypto/subtle/constant_time.go.html#4084494">z</a></span>&nbsp;<span class="op" id="4084511">&amp;=</span>&nbsp;<span class="ident" id="4084514"><a href="/crypto/subtle/constant_time.go.html#4084494">z</a></span>&nbsp;<span class="op" id="4084516">&gt;&gt;</span>&nbsp;<span class="num" id="4084519">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084522"><a href="/crypto/subtle/constant_time.go.html#4084494">z</a></span>&nbsp;<span class="op" id="4084524">&amp;=</span>&nbsp;<span class="ident" id="4084527"><a href="/crypto/subtle/constant_time.go.html#4084494">z</a></span>&nbsp;<span class="op" id="4084529">&gt;&gt;</span>&nbsp;<span class="num" id="4084532">2</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084535"><a href="/crypto/subtle/constant_time.go.html#4084494">z</a></span>&nbsp;<span class="op" id="4084537">&amp;=</span>&nbsp;<span class="ident" id="4084540"><a href="/crypto/subtle/constant_time.go.html#4084494">z</a></span>&nbsp;<span class="op" id="4084542">&gt;&gt;</span>&nbsp;<span class="num" id="4084545">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084549">return</span>&nbsp;<span class="builtintype" id="4084556">int</span><span class="op" id="4084559">(</span><span class="ident" id="4084560"><a href="/crypto/subtle/constant_time.go.html#4084494">z</a></span><span class="op" id="4084561">)</span><br>
<span class="lineno"></span><span class="op" id="4084563">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="4084566">//&nbsp;ConstantTimeEq&nbsp;returns&nbsp;1&nbsp;if&nbsp;x&nbsp;==&nbsp;y&nbsp;and&nbsp;0&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="keyword" id="4084621">func</span>&nbsp;<span class="ident" id="4084626">ConstantTimeEq</span><span class="op" id="4084640">(</span><span class="ident" id="4084641">x</span><span class="op" id="4084642">,</span>&nbsp;<span class="ident" id="4084644">y</span>&nbsp;<span class="builtintype" id="4084646">int32</span><span class="op" id="4084651">)</span>&nbsp;<span class="builtintype" id="4084653">int</span>&nbsp;<span class="op" id="4084657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084660">z</span>&nbsp;<span class="op" id="4084662">:=</span>&nbsp;<span class="op" id="4084665">^</span><span class="op" id="4084666">(</span><span class="ident" id="4084667"><a href="/crypto/subtle/constant_time.go.html#4084641">x</a></span>&nbsp;<span class="op" id="4084669">^</span>&nbsp;<span class="ident" id="4084671"><a href="/crypto/subtle/constant_time.go.html#4084644">y</a></span><span class="op" id="4084672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084675"><a href="/crypto/subtle/constant_time.go.html#4084660">z</a></span>&nbsp;<span class="op" id="4084677">&amp;=</span>&nbsp;<span class="ident" id="4084680"><a href="/crypto/subtle/constant_time.go.html#4084660">z</a></span>&nbsp;<span class="op" id="4084682">&gt;&gt;</span>&nbsp;<span class="num" id="4084685">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084689"><a href="/crypto/subtle/constant_time.go.html#4084660">z</a></span>&nbsp;<span class="op" id="4084691">&amp;=</span>&nbsp;<span class="ident" id="4084694"><a href="/crypto/subtle/constant_time.go.html#4084660">z</a></span>&nbsp;<span class="op" id="4084696">&gt;&gt;</span>&nbsp;<span class="num" id="4084699">8</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084702"><a href="/crypto/subtle/constant_time.go.html#4084660">z</a></span>&nbsp;<span class="op" id="4084704">&amp;=</span>&nbsp;<span class="ident" id="4084707"><a href="/crypto/subtle/constant_time.go.html#4084660">z</a></span>&nbsp;<span class="op" id="4084709">&gt;&gt;</span>&nbsp;<span class="num" id="4084712">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084715"><a href="/crypto/subtle/constant_time.go.html#4084660">z</a></span>&nbsp;<span class="op" id="4084717">&amp;=</span>&nbsp;<span class="ident" id="4084720"><a href="/crypto/subtle/constant_time.go.html#4084660">z</a></span>&nbsp;<span class="op" id="4084722">&gt;&gt;</span>&nbsp;<span class="num" id="4084725">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084728"><a href="/crypto/subtle/constant_time.go.html#4084660">z</a></span>&nbsp;<span class="op" id="4084730">&amp;=</span>&nbsp;<span class="ident" id="4084733"><a href="/crypto/subtle/constant_time.go.html#4084660">z</a></span>&nbsp;<span class="op" id="4084735">&gt;&gt;</span>&nbsp;<span class="num" id="4084738">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084742">return</span>&nbsp;<span class="builtintype" id="4084749">int</span><span class="op" id="4084752">(</span><span class="ident" id="4084753"><a href="/crypto/subtle/constant_time.go.html#4084660">z</a></span>&nbsp;<span class="op" id="4084755">&amp;</span>&nbsp;<span class="num" id="4084757">1</span><span class="op" id="4084758">)</span><br>
<span class="lineno">50</span><span class="op" id="4084760">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4084763">//&nbsp;ConstantTimeCopy&nbsp;copies&nbsp;the&nbsp;contents&nbsp;of&nbsp;y&nbsp;into&nbsp;x&nbsp;(a&nbsp;slice&nbsp;of&nbsp;equal&nbsp;length)</span><br>
<span class="lineno"></span><span class="comment" id="4084841">//&nbsp;if&nbsp;v&nbsp;==&nbsp;1.&nbsp;If&nbsp;v&nbsp;==&nbsp;0,&nbsp;x&nbsp;is&nbsp;left&nbsp;unchanged.&nbsp;Its&nbsp;behavior&nbsp;is&nbsp;undefined&nbsp;if&nbsp;v</span><br>
<span class="lineno"></span><span class="comment" id="4084918">//&nbsp;takes&nbsp;any&nbsp;other&nbsp;value.</span><br>
<span class="lineno">55</span><span class="keyword" id="4084944">func</span>&nbsp;<span class="ident" id="4084949">ConstantTimeCopy</span><span class="op" id="4084965">(</span><span class="ident" id="4084966">v</span>&nbsp;<span class="builtintype" id="4084968">int</span><span class="op" id="4084971">,</span>&nbsp;<span class="ident" id="4084973">x</span><span class="op" id="4084974">,</span>&nbsp;<span class="ident" id="4084976">y</span>&nbsp;<span class="op" id="4084978">[</span><span class="op" id="4084979">]</span><span class="builtintype" id="4084980">byte</span><span class="op" id="4084984">)</span>&nbsp;<span class="op" id="4084986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084989">if</span>&nbsp;<span class="builtinfunc" id="4084992">len</span><span class="op" id="4084995">(</span><span class="ident" id="4084996"><a href="/crypto/subtle/constant_time.go.html#4084973">x</a></span><span class="op" id="4084997">)</span>&nbsp;<span class="op" id="4084999">!=</span>&nbsp;<span class="builtinfunc" id="4085002">len</span><span class="op" id="4085005">(</span><span class="ident" id="4085006"><a href="/crypto/subtle/constant_time.go.html#4084976">y</a></span><span class="op" id="4085007">)</span>&nbsp;<span class="op" id="4085009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4085013">panic</span><span class="op" id="4085018">(</span><span class="string" id="4085019">&#34;subtle:&nbsp;slices&nbsp;have&nbsp;different&nbsp;lengths&#34;</span><span class="op" id="4085058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4085061">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4085065">xmask</span>&nbsp;<span class="op" id="4085071">:=</span>&nbsp;<span class="builtintype" id="4085074">byte</span><span class="op" id="4085078">(</span><span class="ident" id="4085079"><a href="/crypto/subtle/constant_time.go.html#4084966">v</a></span>&nbsp;<span class="op" id="4085081">-</span>&nbsp;<span class="num" id="4085083">1</span><span class="op" id="4085084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4085087">ymask</span>&nbsp;<span class="op" id="4085093">:=</span>&nbsp;<span class="builtintype" id="4085096">byte</span><span class="op" id="4085100">(</span><span class="op" id="4085101">^</span><span class="op" id="4085102">(</span><span class="ident" id="4085103"><a href="/crypto/subtle/constant_time.go.html#4084966">v</a></span>&nbsp;<span class="op" id="4085105">-</span>&nbsp;<span class="num" id="4085107">1</span><span class="op" id="4085108">)</span><span class="op" id="4085109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085112">for</span>&nbsp;<span class="ident" id="4085116">i</span>&nbsp;<span class="op" id="4085118">:=</span>&nbsp;<span class="num" id="4085121">0</span><span class="op" id="4085122">;</span>&nbsp;<span class="ident" id="4085124"><a href="/crypto/subtle/constant_time.go.html#4085116">i</a></span>&nbsp;<span class="op" id="4085126">&lt;</span>&nbsp;<span class="builtinfunc" id="4085128">len</span><span class="op" id="4085131">(</span><span class="ident" id="4085132"><a href="/crypto/subtle/constant_time.go.html#4084973">x</a></span><span class="op" id="4085133">)</span><span class="op" id="4085134">;</span>&nbsp;<span class="ident" id="4085136"><a href="/crypto/subtle/constant_time.go.html#4085116">i</a></span><span class="op" id="4085137">++</span>&nbsp;<span class="op" id="4085140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4085144"><a href="/crypto/subtle/constant_time.go.html#4084973">x</a></span><span class="op" id="4085145">[</span><span class="ident" id="4085146"><a href="/crypto/subtle/constant_time.go.html#4085116">i</a></span><span class="op" id="4085147">]</span>&nbsp;<span class="op" id="4085149">=</span>&nbsp;<span class="ident" id="4085151"><a href="/crypto/subtle/constant_time.go.html#4084973">x</a></span><span class="op" id="4085152">[</span><span class="ident" id="4085153"><a href="/crypto/subtle/constant_time.go.html#4085116">i</a></span><span class="op" id="4085154">]</span><span class="op" id="4085155">&amp;</span><span class="ident" id="4085156"><a href="/crypto/subtle/constant_time.go.html#4085065">xmask</a></span>&nbsp;<span class="op" id="4085162">|</span>&nbsp;<span class="ident" id="4085164"><a href="/crypto/subtle/constant_time.go.html#4084976">y</a></span><span class="op" id="4085165">[</span><span class="ident" id="4085166"><a href="/crypto/subtle/constant_time.go.html#4085116">i</a></span><span class="op" id="4085167">]</span><span class="op" id="4085168">&amp;</span><span class="ident" id="4085169"><a href="/crypto/subtle/constant_time.go.html#4085087">ymask</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4085176">}</span><br>
<span class="lineno">65</span><span class="op" id="4085178">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4085181">//&nbsp;ConstantTimeLessOrEq&nbsp;returns&nbsp;1&nbsp;if&nbsp;x&nbsp;&lt;=&nbsp;y&nbsp;and&nbsp;0&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="comment" id="4085242">//&nbsp;Its&nbsp;behavior&nbsp;is&nbsp;undefined&nbsp;if&nbsp;x&nbsp;or&nbsp;y&nbsp;are&nbsp;negative&nbsp;or&nbsp;&gt;&nbsp;2**31&nbsp;-&nbsp;1.</span><br>
<span class="lineno"></span><span class="keyword" id="4085310">func</span>&nbsp;<span class="ident" id="4085315">ConstantTimeLessOrEq</span><span class="op" id="4085335">(</span><span class="ident" id="4085336">x</span><span class="op" id="4085337">,</span>&nbsp;<span class="ident" id="4085339">y</span>&nbsp;<span class="builtintype" id="4085341">int</span><span class="op" id="4085344">)</span>&nbsp;<span class="builtintype" id="4085346">int</span>&nbsp;<span class="op" id="4085350">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4085353">x32</span>&nbsp;<span class="op" id="4085357">:=</span>&nbsp;<span class="builtintype" id="4085360">int32</span><span class="op" id="4085365">(</span><span class="ident" id="4085366"><a href="/crypto/subtle/constant_time.go.html#4085336">x</a></span><span class="op" id="4085367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4085370">y32</span>&nbsp;<span class="op" id="4085374">:=</span>&nbsp;<span class="builtintype" id="4085377">int32</span><span class="op" id="4085382">(</span><span class="ident" id="4085383"><a href="/crypto/subtle/constant_time.go.html#4085339">y</a></span><span class="op" id="4085384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085387">return</span>&nbsp;<span class="builtintype" id="4085394">int</span><span class="op" id="4085397">(</span><span class="op" id="4085398">(</span><span class="op" id="4085399">(</span><span class="ident" id="4085400"><a href="/crypto/subtle/constant_time.go.html#4085353">x32</a></span>&nbsp;<span class="op" id="4085404">-</span>&nbsp;<span class="ident" id="4085406"><a href="/crypto/subtle/constant_time.go.html#4085370">y32</a></span>&nbsp;<span class="op" id="4085410">-</span>&nbsp;<span class="num" id="4085412">1</span><span class="op" id="4085413">)</span>&nbsp;<span class="op" id="4085415">&gt;&gt;</span>&nbsp;<span class="num" id="4085418">31</span><span class="op" id="4085420">)</span>&nbsp;<span class="op" id="4085422">&amp;</span>&nbsp;<span class="num" id="4085424">1</span><span class="op" id="4085425">)</span><br>
<span class="lineno"></span><span class="op" id="4085427">}</span>
</div>
</body>
</html>
