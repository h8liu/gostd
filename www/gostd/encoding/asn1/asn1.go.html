<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/asn1</h2>
<ul>
<li><a href="/gostd/encoding/asn1/asn1.go.html" class="current">asn1.go</a></li>
<li><a href="/gostd/encoding/asn1/asn1_test.go.html">asn1_test.go</a></li>
<li><a href="/gostd/encoding/asn1/common.go.html">common.go</a></li>
<li><a href="/gostd/encoding/asn1/marshal.go.html">marshal.go</a></li>
<li><a href="/gostd/encoding/asn1/marshal_test.go.html">marshal_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3942839">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3942894">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3942948">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3942999">//&nbsp;Package&nbsp;asn1&nbsp;implements&nbsp;parsing&nbsp;of&nbsp;DER-encoded&nbsp;ASN.1&nbsp;data&nbsp;structures,</span><br>
<span class="lineno"></span><span class="comment" id="3943072">//&nbsp;as&nbsp;defined&nbsp;in&nbsp;ITU-T&nbsp;Rec&nbsp;X.690.</span><br>
<span class="lineno"></span><span class="comment" id="3943106">//</span><br>
<span class="lineno"></span><span class="comment" id="3943109">//&nbsp;See&nbsp;also&nbsp;``A&nbsp;Layman&#39;s&nbsp;Guide&nbsp;to&nbsp;a&nbsp;Subset&nbsp;of&nbsp;ASN.1,&nbsp;BER,&nbsp;and&nbsp;DER,&#39;&#39;</span><br>
<span class="lineno"></span><span class="comment" id="3943178">//&nbsp;http://luca.ntop.org/Teaching/Appunti/asn1.html.</span><br>
<span class="lineno">10</span><span class="keyword" id="3943230">package</span>&nbsp;<span class="ident" id="3943238">asn1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3943244">//&nbsp;ASN.1&nbsp;is&nbsp;a&nbsp;syntax&nbsp;for&nbsp;specifying&nbsp;abstract&nbsp;objects&nbsp;and&nbsp;BER,&nbsp;DER,&nbsp;PER,&nbsp;XER&nbsp;etc</span><br>
<span class="lineno"></span><span class="comment" id="3943324">//&nbsp;are&nbsp;different&nbsp;encoding&nbsp;formats&nbsp;for&nbsp;those&nbsp;objects.&nbsp;Here,&nbsp;we&#39;ll&nbsp;be&nbsp;dealing</span><br>
<span class="lineno"></span><span class="comment" id="3943400">//&nbsp;with&nbsp;DER,&nbsp;the&nbsp;Distinguished&nbsp;Encoding&nbsp;Rules.&nbsp;DER&nbsp;is&nbsp;used&nbsp;in&nbsp;X.509&nbsp;because</span><br>
<span class="lineno">15</span><span class="comment" id="3943476">//&nbsp;it&#39;s&nbsp;fast&nbsp;to&nbsp;parse&nbsp;and,&nbsp;unlike&nbsp;BER,&nbsp;has&nbsp;a&nbsp;unique&nbsp;encoding&nbsp;for&nbsp;every&nbsp;object.</span><br>
<span class="lineno"></span><span class="comment" id="3943555">//&nbsp;When&nbsp;calculating&nbsp;hashes&nbsp;over&nbsp;objects,&nbsp;it&#39;s&nbsp;important&nbsp;that&nbsp;the&nbsp;resulting</span><br>
<span class="lineno"></span><span class="comment" id="3943630">//&nbsp;bytes&nbsp;be&nbsp;the&nbsp;same&nbsp;at&nbsp;both&nbsp;ends&nbsp;and&nbsp;DER&nbsp;removes&nbsp;this&nbsp;margin&nbsp;of&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="3943702">//</span><br>
<span class="lineno"></span><span class="comment" id="3943705">//&nbsp;ASN.1&nbsp;is&nbsp;very&nbsp;complex&nbsp;and&nbsp;this&nbsp;package&nbsp;doesn&#39;t&nbsp;attempt&nbsp;to&nbsp;implement</span><br>
<span class="lineno">20</span><span class="comment" id="3943776">//&nbsp;everything&nbsp;by&nbsp;any&nbsp;means.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3943805">import</span>&nbsp;<span class="op" id="3943812">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3943815">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3943822">&#34;math/big&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3943834">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3943845">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3943856">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="3943863">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="3943866">//&nbsp;A&nbsp;StructuralError&nbsp;suggests&nbsp;that&nbsp;the&nbsp;ASN.1&nbsp;data&nbsp;is&nbsp;valid,&nbsp;but&nbsp;the&nbsp;Go&nbsp;type</span><br>
<span class="lineno"></span><span class="comment" id="3943942">//&nbsp;which&nbsp;is&nbsp;receiving&nbsp;it&nbsp;doesn&#39;t&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="3943982">type</span>&nbsp;<span class="ident" id="3943987">StructuralError</span>&nbsp;<span class="keyword" id="3944003">struct</span>&nbsp;<span class="op" id="3944010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3944013">Msg</span>&nbsp;<span class="builtintype" id="3944017">string</span><br>
<span class="lineno"></span><span class="op" id="3944024">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="3944027">func</span>&nbsp;<span class="op" id="3944032">(</span><span class="ident" id="3944033">e</span>&nbsp;<span class="ident" id="3944035">StructuralError</span><span class="op" id="3944050">)</span>&nbsp;<span class="ident" id="3944052">Error</span><span class="op" id="3944057">(</span><span class="op" id="3944058">)</span>&nbsp;<span class="builtintype" id="3944060">string</span>&nbsp;<span class="op" id="3944067">{</span>&nbsp;<span class="keyword" id="3944069">return</span>&nbsp;<span class="string" id="3944076">&#34;asn1:&nbsp;structure&nbsp;error:&nbsp;&#34;</span>&nbsp;<span class="op" id="3944102">+</span>&nbsp;<span class="ident" id="3944104">e</span><span class="op" id="3944105">.</span><span class="ident" id="3944106">Msg</span>&nbsp;<span class="op" id="3944110">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3944113">//&nbsp;A&nbsp;SyntaxError&nbsp;suggests&nbsp;that&nbsp;the&nbsp;ASN.1&nbsp;data&nbsp;is&nbsp;invalid.</span><br>
<span class="lineno"></span><span class="keyword" id="3944171">type</span>&nbsp;<span class="ident" id="3944176">SyntaxError</span>&nbsp;<span class="keyword" id="3944188">struct</span>&nbsp;<span class="op" id="3944195">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3944198">Msg</span>&nbsp;<span class="builtintype" id="3944202">string</span><br>
<span class="lineno"></span><span class="op" id="3944209">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3944212">func</span>&nbsp;<span class="op" id="3944217">(</span><span class="ident" id="3944218">e</span>&nbsp;<span class="ident" id="3944220">SyntaxError</span><span class="op" id="3944231">)</span>&nbsp;<span class="ident" id="3944233">Error</span><span class="op" id="3944238">(</span><span class="op" id="3944239">)</span>&nbsp;<span class="builtintype" id="3944241">string</span>&nbsp;<span class="op" id="3944248">{</span>&nbsp;<span class="keyword" id="3944250">return</span>&nbsp;<span class="string" id="3944257">&#34;asn1:&nbsp;syntax&nbsp;error:&nbsp;&#34;</span>&nbsp;<span class="op" id="3944280">+</span>&nbsp;<span class="ident" id="3944282">e</span><span class="op" id="3944283">.</span><span class="ident" id="3944284">Msg</span>&nbsp;<span class="op" id="3944288">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="3944291">//&nbsp;We&nbsp;start&nbsp;by&nbsp;dealing&nbsp;with&nbsp;each&nbsp;of&nbsp;the&nbsp;primitive&nbsp;types&nbsp;in&nbsp;turn.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3944357">//&nbsp;BOOLEAN</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3944369">func</span>&nbsp;<span class="ident" id="3944374">parseBool</span><span class="op" id="3944383">(</span><span class="ident" id="3944384">bytes</span>&nbsp;<span class="op" id="3944390">[</span><span class="op" id="3944391">]</span><span class="builtintype" id="3944392">byte</span><span class="op" id="3944396">)</span>&nbsp;<span class="op" id="3944398">(</span><span class="ident" id="3944399">ret</span>&nbsp;<span class="builtintype" id="3944403">bool</span><span class="op" id="3944407">,</span>&nbsp;<span class="ident" id="3944409">err</span>&nbsp;<span class="builtintype" id="3944413">error</span><span class="op" id="3944418">)</span>&nbsp;<span class="op" id="3944420">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3944423">if</span>&nbsp;<span class="builtinfunc" id="3944426">len</span><span class="op" id="3944429">(</span><span class="ident" id="3944430">bytes</span><span class="op" id="3944435">)</span>&nbsp;<span class="op" id="3944437">!=</span>&nbsp;<span class="num" id="3944440">1</span>&nbsp;<span class="op" id="3944442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3944446">err</span>&nbsp;<span class="op" id="3944450">=</span>&nbsp;<span class="ident" id="3944452">SyntaxError</span><span class="op" id="3944463">{</span><span class="string" id="3944464">&#34;invalid&nbsp;boolean&#34;</span><span class="op" id="3944481">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3944485">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3944493">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3944497">//&nbsp;DER&nbsp;demands&nbsp;that&nbsp;&#34;If&nbsp;the&nbsp;encoding&nbsp;represents&nbsp;the&nbsp;boolean&nbsp;value&nbsp;TRUE,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3944570">//&nbsp;its&nbsp;single&nbsp;contents&nbsp;octet&nbsp;shall&nbsp;have&nbsp;all&nbsp;eight&nbsp;bits&nbsp;set&nbsp;to&nbsp;one.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3944639">//&nbsp;Thus&nbsp;only&nbsp;0&nbsp;and&nbsp;255&nbsp;are&nbsp;valid&nbsp;encoded&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3944689">switch</span>&nbsp;<span class="ident" id="3944696">bytes</span><span class="op" id="3944701">[</span><span class="num" id="3944702">0</span><span class="op" id="3944703">]</span>&nbsp;<span class="op" id="3944705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3944708">case</span>&nbsp;<span class="num" id="3944713">0</span><span class="op" id="3944714">:</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3944718">ret</span>&nbsp;<span class="op" id="3944722">=</span>&nbsp;<span class="builtintype" id="3944724">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3944731">case</span>&nbsp;<span class="num" id="3944736">0xff</span><span class="op" id="3944740">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3944744">ret</span>&nbsp;<span class="op" id="3944748">=</span>&nbsp;<span class="builtintype" id="3944750">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3944756">default</span><span class="op" id="3944763">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3944767">err</span>&nbsp;<span class="op" id="3944771">=</span>&nbsp;<span class="ident" id="3944773">SyntaxError</span><span class="op" id="3944784">{</span><span class="string" id="3944785">&#34;invalid&nbsp;boolean&#34;</span><span class="op" id="3944802">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3944805">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3944809">return</span><br>
<span class="lineno"></span><span class="op" id="3944816">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="3944819">//&nbsp;INTEGER</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3944831">//&nbsp;parseInt64&nbsp;treats&nbsp;the&nbsp;given&nbsp;bytes&nbsp;as&nbsp;a&nbsp;big-endian,&nbsp;signed&nbsp;integer&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3944904">//&nbsp;returns&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="keyword" id="3944927">func</span>&nbsp;<span class="ident" id="3944932">parseInt64</span><span class="op" id="3944942">(</span><span class="ident" id="3944943">bytes</span>&nbsp;<span class="op" id="3944949">[</span><span class="op" id="3944950">]</span><span class="builtintype" id="3944951">byte</span><span class="op" id="3944955">)</span>&nbsp;<span class="op" id="3944957">(</span><span class="ident" id="3944958">ret</span>&nbsp;<span class="ident" id="3944962">int64</span><span class="op" id="3944967">,</span>&nbsp;<span class="ident" id="3944969">err</span>&nbsp;<span class="builtintype" id="3944973">error</span><span class="op" id="3944978">)</span>&nbsp;<span class="op" id="3944980">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3944983">if</span>&nbsp;<span class="builtinfunc" id="3944986">len</span><span class="op" id="3944989">(</span><span class="ident" id="3944990">bytes</span><span class="op" id="3944995">)</span>&nbsp;<span class="op" id="3944997">&gt;</span>&nbsp;<span class="num" id="3944999">8</span>&nbsp;<span class="op" id="3945001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3945005">//&nbsp;We&#39;ll&nbsp;overflow&nbsp;an&nbsp;int64&nbsp;in&nbsp;this&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3945048">err</span>&nbsp;<span class="op" id="3945052">=</span>&nbsp;<span class="ident" id="3945054">StructuralError</span><span class="op" id="3945069">{</span><span class="string" id="3945070">&#34;integer&nbsp;too&nbsp;large&#34;</span><span class="op" id="3945089">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3945093">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3945101">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3945104">for</span>&nbsp;<span class="ident" id="3945108">bytesRead</span>&nbsp;<span class="op" id="3945118">:=</span>&nbsp;<span class="num" id="3945121">0</span><span class="op" id="3945122">;</span>&nbsp;<span class="ident" id="3945124">bytesRead</span>&nbsp;<span class="op" id="3945134">&lt;</span>&nbsp;<span class="builtinfunc" id="3945136">len</span><span class="op" id="3945139">(</span><span class="ident" id="3945140">bytes</span><span class="op" id="3945145">)</span><span class="op" id="3945146">;</span>&nbsp;<span class="ident" id="3945148">bytesRead</span><span class="op" id="3945157">++</span>&nbsp;<span class="op" id="3945160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3945164">ret</span>&nbsp;<span class="op" id="3945168">&lt;&lt;=</span>&nbsp;<span class="num" id="3945172">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3945176">ret</span>&nbsp;<span class="op" id="3945180">|=</span>&nbsp;<span class="ident" id="3945183">int64</span><span class="op" id="3945188">(</span><span class="ident" id="3945189">bytes</span><span class="op" id="3945194">[</span><span class="ident" id="3945195">bytesRead</span><span class="op" id="3945204">]</span><span class="op" id="3945205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3945208">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3945212">//&nbsp;Shift&nbsp;up&nbsp;and&nbsp;down&nbsp;in&nbsp;order&nbsp;to&nbsp;sign&nbsp;extend&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3945270">ret</span>&nbsp;<span class="op" id="3945274">&lt;&lt;=</span>&nbsp;<span class="num" id="3945278">64</span>&nbsp;<span class="op" id="3945281">-</span>&nbsp;<span class="builtintype" id="3945283">uint8</span><span class="op" id="3945288">(</span><span class="builtinfunc" id="3945289">len</span><span class="op" id="3945292">(</span><span class="ident" id="3945293">bytes</span><span class="op" id="3945298">)</span><span class="op" id="3945299">)</span><span class="op" id="3945300">*</span><span class="num" id="3945301">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3945304">ret</span>&nbsp;<span class="op" id="3945308">&gt;&gt;=</span>&nbsp;<span class="num" id="3945312">64</span>&nbsp;<span class="op" id="3945315">-</span>&nbsp;<span class="builtintype" id="3945317">uint8</span><span class="op" id="3945322">(</span><span class="builtinfunc" id="3945323">len</span><span class="op" id="3945326">(</span><span class="ident" id="3945327">bytes</span><span class="op" id="3945332">)</span><span class="op" id="3945333">)</span><span class="op" id="3945334">*</span><span class="num" id="3945335">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3945338">return</span><br>
<span class="lineno"></span><span class="op" id="3945345">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="3945348">//&nbsp;parseInt&nbsp;treats&nbsp;the&nbsp;given&nbsp;bytes&nbsp;as&nbsp;a&nbsp;big-endian,&nbsp;signed&nbsp;integer&nbsp;and&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="3945427">//&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="keyword" id="3945442">func</span>&nbsp;<span class="ident" id="3945447">parseInt32</span><span class="op" id="3945457">(</span><span class="ident" id="3945458">bytes</span>&nbsp;<span class="op" id="3945464">[</span><span class="op" id="3945465">]</span><span class="builtintype" id="3945466">byte</span><span class="op" id="3945470">)</span>&nbsp;<span class="op" id="3945472">(</span><span class="builtintype" id="3945473">int32</span><span class="op" id="3945478">,</span>&nbsp;<span class="builtintype" id="3945480">error</span><span class="op" id="3945485">)</span>&nbsp;<span class="op" id="3945487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3945490">ret64</span><span class="op" id="3945495">,</span>&nbsp;<span class="ident" id="3945497">err</span>&nbsp;<span class="op" id="3945501">:=</span>&nbsp;<span class="ident" id="3945504">parseInt64</span><span class="op" id="3945514">(</span><span class="ident" id="3945515">bytes</span><span class="op" id="3945520">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3945523">if</span>&nbsp;<span class="ident" id="3945526">err</span>&nbsp;<span class="op" id="3945530">!=</span>&nbsp;<span class="ident" id="3945533">nil</span>&nbsp;<span class="op" id="3945537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3945541">return</span>&nbsp;<span class="num" id="3945548">0</span><span class="op" id="3945549">,</span>&nbsp;<span class="ident" id="3945551">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3945556">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3945559">if</span>&nbsp;<span class="ident" id="3945562">ret64</span>&nbsp;<span class="op" id="3945568">!=</span>&nbsp;<span class="ident" id="3945571">int64</span><span class="op" id="3945576">(</span><span class="builtintype" id="3945577">int32</span><span class="op" id="3945582">(</span><span class="ident" id="3945583">ret64</span><span class="op" id="3945588">)</span><span class="op" id="3945589">)</span>&nbsp;<span class="op" id="3945591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3945595">return</span>&nbsp;<span class="num" id="3945602">0</span><span class="op" id="3945603">,</span>&nbsp;<span class="ident" id="3945605">StructuralError</span><span class="op" id="3945620">{</span><span class="string" id="3945621">&#34;integer&nbsp;too&nbsp;large&#34;</span><span class="op" id="3945640">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3945643">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3945646">return</span>&nbsp;<span class="builtintype" id="3945653">int32</span><span class="op" id="3945658">(</span><span class="ident" id="3945659">ret64</span><span class="op" id="3945664">)</span><span class="op" id="3945665">,</span>&nbsp;<span class="ident" id="3945667">nil</span><br>
<span class="lineno"></span><span class="op" id="3945671">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3945674">var</span>&nbsp;<span class="ident" id="3945678">bigOne</span>&nbsp;<span class="op" id="3945685">=</span>&nbsp;<span class="ident" id="3945687">big</span><span class="op" id="3945690">.</span><span class="ident" id="3945691">NewInt</span><span class="op" id="3945697">(</span><span class="num" id="3945698">1</span><span class="op" id="3945699">)</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="3945702">//&nbsp;parseBigInt&nbsp;treats&nbsp;the&nbsp;given&nbsp;bytes&nbsp;as&nbsp;a&nbsp;big-endian,&nbsp;signed&nbsp;integer&nbsp;and&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="3945784">//&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="keyword" id="3945799">func</span>&nbsp;<span class="ident" id="3945804">parseBigInt</span><span class="op" id="3945815">(</span><span class="ident" id="3945816">bytes</span>&nbsp;<span class="op" id="3945822">[</span><span class="op" id="3945823">]</span><span class="builtintype" id="3945824">byte</span><span class="op" id="3945828">)</span>&nbsp;<span class="op" id="3945830">*</span><span class="ident" id="3945831">big</span><span class="op" id="3945834">.</span><span class="ident" id="3945835">Int</span>&nbsp;<span class="op" id="3945839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3945842">ret</span>&nbsp;<span class="op" id="3945846">:=</span>&nbsp;<span class="builtinfunc" id="3945849">new</span><span class="op" id="3945852">(</span><span class="ident" id="3945853">big</span><span class="op" id="3945856">.</span><span class="ident" id="3945857">Int</span><span class="op" id="3945860">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3945863">if</span>&nbsp;<span class="builtinfunc" id="3945866">len</span><span class="op" id="3945869">(</span><span class="ident" id="3945870">bytes</span><span class="op" id="3945875">)</span>&nbsp;<span class="op" id="3945877">&gt;</span>&nbsp;<span class="num" id="3945879">0</span>&nbsp;<span class="op" id="3945881">&amp;&amp;</span>&nbsp;<span class="ident" id="3945884">bytes</span><span class="op" id="3945889">[</span><span class="num" id="3945890">0</span><span class="op" id="3945891">]</span><span class="op" id="3945892">&amp;</span><span class="num" id="3945893">0x80</span>&nbsp;<span class="op" id="3945898">==</span>&nbsp;<span class="num" id="3945901">0x80</span>&nbsp;<span class="op" id="3945906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3945910">//&nbsp;This&nbsp;is&nbsp;a&nbsp;negative&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3945942">notBytes</span>&nbsp;<span class="op" id="3945951">:=</span>&nbsp;<span class="builtinfunc" id="3945954">make</span><span class="op" id="3945958">(</span><span class="op" id="3945959">[</span><span class="op" id="3945960">]</span><span class="builtintype" id="3945961">byte</span><span class="op" id="3945965">,</span>&nbsp;<span class="builtinfunc" id="3945967">len</span><span class="op" id="3945970">(</span><span class="ident" id="3945971">bytes</span><span class="op" id="3945976">)</span><span class="op" id="3945977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3945981">for</span>&nbsp;<span class="ident" id="3945985">i</span>&nbsp;<span class="op" id="3945987">:=</span>&nbsp;<span class="keyword" id="3945990">range</span>&nbsp;<span class="ident" id="3945996">notBytes</span>&nbsp;<span class="op" id="3946005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3946010">notBytes</span><span class="op" id="3946018">[</span><span class="ident" id="3946019">i</span><span class="op" id="3946020">]</span>&nbsp;<span class="op" id="3946022">=</span>&nbsp;<span class="op" id="3946024">^</span><span class="ident" id="3946025">bytes</span><span class="op" id="3946030">[</span><span class="ident" id="3946031">i</span><span class="op" id="3946032">]</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3946036">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3946040">ret</span><span class="op" id="3946043">.</span><span class="ident" id="3946044">SetBytes</span><span class="op" id="3946052">(</span><span class="ident" id="3946053">notBytes</span><span class="op" id="3946061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3946065">ret</span><span class="op" id="3946068">.</span><span class="ident" id="3946069">Add</span><span class="op" id="3946072">(</span><span class="ident" id="3946073">ret</span><span class="op" id="3946076">,</span>&nbsp;<span class="ident" id="3946078">bigOne</span><span class="op" id="3946084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3946088">ret</span><span class="op" id="3946091">.</span><span class="ident" id="3946092">Neg</span><span class="op" id="3946095">(</span><span class="ident" id="3946096">ret</span><span class="op" id="3946099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3946103">return</span>&nbsp;<span class="ident" id="3946110">ret</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3946115">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3946118">ret</span><span class="op" id="3946121">.</span><span class="ident" id="3946122">SetBytes</span><span class="op" id="3946130">(</span><span class="ident" id="3946131">bytes</span><span class="op" id="3946136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3946139">return</span>&nbsp;<span class="ident" id="3946146">ret</span><br>
<span class="lineno"></span><span class="op" id="3946150">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="3946153">//&nbsp;BIT&nbsp;STRING</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3946168">//&nbsp;BitString&nbsp;is&nbsp;the&nbsp;structure&nbsp;to&nbsp;use&nbsp;when&nbsp;you&nbsp;want&nbsp;an&nbsp;ASN.1&nbsp;BIT&nbsp;STRING&nbsp;type.&nbsp;A</span><br>
<span class="lineno"></span><span class="comment" id="3946247">//&nbsp;bit&nbsp;string&nbsp;is&nbsp;padded&nbsp;up&nbsp;to&nbsp;the&nbsp;nearest&nbsp;byte&nbsp;in&nbsp;memory&nbsp;and&nbsp;the&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3946322">//&nbsp;valid&nbsp;bits&nbsp;is&nbsp;recorded.&nbsp;Padding&nbsp;bits&nbsp;will&nbsp;be&nbsp;zero.</span><br>
<span class="lineno">130</span><span class="keyword" id="3946376">type</span>&nbsp;<span class="ident" id="3946381">BitString</span>&nbsp;<span class="keyword" id="3946391">struct</span>&nbsp;<span class="op" id="3946398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3946401">Bytes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3946411">[</span><span class="op" id="3946412">]</span><span class="builtintype" id="3946413">byte</span>&nbsp;<span class="comment" id="3946418">//&nbsp;bits&nbsp;packed&nbsp;into&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3946446">BitLength</span>&nbsp;<span class="builtintype" id="3946456">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3946463">//&nbsp;length&nbsp;in&nbsp;bits.</span><br>
<span class="lineno"></span><span class="op" id="3946482">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="3946485">//&nbsp;At&nbsp;returns&nbsp;the&nbsp;bit&nbsp;at&nbsp;the&nbsp;given&nbsp;index.&nbsp;If&nbsp;the&nbsp;index&nbsp;is&nbsp;out&nbsp;of&nbsp;range&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="3946559">//&nbsp;returns&nbsp;false.</span><br>
<span class="lineno"></span><span class="keyword" id="3946577">func</span>&nbsp;<span class="op" id="3946582">(</span><span class="ident" id="3946583">b</span>&nbsp;<span class="ident" id="3946585">BitString</span><span class="op" id="3946594">)</span>&nbsp;<span class="ident" id="3946596">At</span><span class="op" id="3946598">(</span><span class="ident" id="3946599">i</span>&nbsp;<span class="builtintype" id="3946601">int</span><span class="op" id="3946604">)</span>&nbsp;<span class="builtintype" id="3946606">int</span>&nbsp;<span class="op" id="3946610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3946613">if</span>&nbsp;<span class="ident" id="3946616">i</span>&nbsp;<span class="op" id="3946618">&lt;</span>&nbsp;<span class="num" id="3946620">0</span>&nbsp;<span class="op" id="3946622">||</span>&nbsp;<span class="ident" id="3946625">i</span>&nbsp;<span class="op" id="3946627">&gt;=</span>&nbsp;<span class="ident" id="3946630">b</span><span class="op" id="3946631">.</span><span class="ident" id="3946632">BitLength</span>&nbsp;<span class="op" id="3946642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3946646">return</span>&nbsp;<span class="num" id="3946653">0</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3946656">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3946659">x</span>&nbsp;<span class="op" id="3946661">:=</span>&nbsp;<span class="ident" id="3946664">i</span>&nbsp;<span class="op" id="3946666">/</span>&nbsp;<span class="num" id="3946668">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3946671">y</span>&nbsp;<span class="op" id="3946673">:=</span>&nbsp;<span class="num" id="3946676">7</span>&nbsp;<span class="op" id="3946678">-</span>&nbsp;<span class="builtintype" id="3946680">uint</span><span class="op" id="3946684">(</span><span class="ident" id="3946685">i</span><span class="op" id="3946686">%</span><span class="num" id="3946687">8</span><span class="op" id="3946688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3946691">return</span>&nbsp;<span class="builtintype" id="3946698">int</span><span class="op" id="3946701">(</span><span class="ident" id="3946702">b</span><span class="op" id="3946703">.</span><span class="ident" id="3946704">Bytes</span><span class="op" id="3946709">[</span><span class="ident" id="3946710">x</span><span class="op" id="3946711">]</span><span class="op" id="3946712">&gt;&gt;</span><span class="ident" id="3946714">y</span><span class="op" id="3946715">)</span>&nbsp;<span class="op" id="3946717">&amp;</span>&nbsp;<span class="num" id="3946719">1</span><br>
<span class="lineno"></span><span class="op" id="3946721">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="comment" id="3946724">//&nbsp;RightAlign&nbsp;returns&nbsp;a&nbsp;slice&nbsp;where&nbsp;the&nbsp;padding&nbsp;bits&nbsp;are&nbsp;at&nbsp;the&nbsp;beginning.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="3946803">//&nbsp;slice&nbsp;may&nbsp;share&nbsp;memory&nbsp;with&nbsp;the&nbsp;BitString.</span><br>
<span class="lineno"></span><span class="keyword" id="3946849">func</span>&nbsp;<span class="op" id="3946854">(</span><span class="ident" id="3946855">b</span>&nbsp;<span class="ident" id="3946857">BitString</span><span class="op" id="3946866">)</span>&nbsp;<span class="ident" id="3946868">RightAlign</span><span class="op" id="3946878">(</span><span class="op" id="3946879">)</span>&nbsp;<span class="op" id="3946881">[</span><span class="op" id="3946882">]</span><span class="builtintype" id="3946883">byte</span>&nbsp;<span class="op" id="3946888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3946891">shift</span>&nbsp;<span class="op" id="3946897">:=</span>&nbsp;<span class="builtintype" id="3946900">uint</span><span class="op" id="3946904">(</span><span class="num" id="3946905">8</span>&nbsp;<span class="op" id="3946907">-</span>&nbsp;<span class="op" id="3946909">(</span><span class="ident" id="3946910">b</span><span class="op" id="3946911">.</span><span class="ident" id="3946912">BitLength</span>&nbsp;<span class="op" id="3946922">%</span>&nbsp;<span class="num" id="3946924">8</span><span class="op" id="3946925">)</span><span class="op" id="3946926">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3946929">if</span>&nbsp;<span class="ident" id="3946932">shift</span>&nbsp;<span class="op" id="3946938">==</span>&nbsp;<span class="num" id="3946941">8</span>&nbsp;<span class="op" id="3946943">||</span>&nbsp;<span class="builtinfunc" id="3946946">len</span><span class="op" id="3946949">(</span><span class="ident" id="3946950">b</span><span class="op" id="3946951">.</span><span class="ident" id="3946952">Bytes</span><span class="op" id="3946957">)</span>&nbsp;<span class="op" id="3946959">==</span>&nbsp;<span class="num" id="3946962">0</span>&nbsp;<span class="op" id="3946964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3946968">return</span>&nbsp;<span class="ident" id="3946975">b</span><span class="op" id="3946976">.</span><span class="ident" id="3946977">Bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3946984">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3946988">a</span>&nbsp;<span class="op" id="3946990">:=</span>&nbsp;<span class="builtinfunc" id="3946993">make</span><span class="op" id="3946997">(</span><span class="op" id="3946998">[</span><span class="op" id="3946999">]</span><span class="builtintype" id="3947000">byte</span><span class="op" id="3947004">,</span>&nbsp;<span class="builtinfunc" id="3947006">len</span><span class="op" id="3947009">(</span><span class="ident" id="3947010">b</span><span class="op" id="3947011">.</span><span class="ident" id="3947012">Bytes</span><span class="op" id="3947017">)</span><span class="op" id="3947018">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3947021">a</span><span class="op" id="3947022">[</span><span class="num" id="3947023">0</span><span class="op" id="3947024">]</span>&nbsp;<span class="op" id="3947026">=</span>&nbsp;<span class="ident" id="3947028">b</span><span class="op" id="3947029">.</span><span class="ident" id="3947030">Bytes</span><span class="op" id="3947035">[</span><span class="num" id="3947036">0</span><span class="op" id="3947037">]</span>&nbsp;<span class="op" id="3947039">&gt;&gt;</span>&nbsp;<span class="ident" id="3947042">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3947049">for</span>&nbsp;<span class="ident" id="3947053">i</span>&nbsp;<span class="op" id="3947055">:=</span>&nbsp;<span class="num" id="3947058">1</span><span class="op" id="3947059">;</span>&nbsp;<span class="ident" id="3947061">i</span>&nbsp;<span class="op" id="3947063">&lt;</span>&nbsp;<span class="builtinfunc" id="3947065">len</span><span class="op" id="3947068">(</span><span class="ident" id="3947069">b</span><span class="op" id="3947070">.</span><span class="ident" id="3947071">Bytes</span><span class="op" id="3947076">)</span><span class="op" id="3947077">;</span>&nbsp;<span class="ident" id="3947079">i</span><span class="op" id="3947080">++</span>&nbsp;<span class="op" id="3947083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3947087">a</span><span class="op" id="3947088">[</span><span class="ident" id="3947089">i</span><span class="op" id="3947090">]</span>&nbsp;<span class="op" id="3947092">=</span>&nbsp;<span class="ident" id="3947094">b</span><span class="op" id="3947095">.</span><span class="ident" id="3947096">Bytes</span><span class="op" id="3947101">[</span><span class="ident" id="3947102">i</span><span class="op" id="3947103">-</span><span class="num" id="3947104">1</span><span class="op" id="3947105">]</span>&nbsp;<span class="op" id="3947107">&lt;&lt;</span>&nbsp;<span class="op" id="3947110">(</span><span class="num" id="3947111">8</span>&nbsp;<span class="op" id="3947113">-</span>&nbsp;<span class="ident" id="3947115">shift</span><span class="op" id="3947120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3947124">a</span><span class="op" id="3947125">[</span><span class="ident" id="3947126">i</span><span class="op" id="3947127">]</span>&nbsp;<span class="op" id="3947129">|=</span>&nbsp;<span class="ident" id="3947132">b</span><span class="op" id="3947133">.</span><span class="ident" id="3947134">Bytes</span><span class="op" id="3947139">[</span><span class="ident" id="3947140">i</span><span class="op" id="3947141">]</span>&nbsp;<span class="op" id="3947143">&gt;&gt;</span>&nbsp;<span class="ident" id="3947146">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3947153">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3947157">return</span>&nbsp;<span class="ident" id="3947164">a</span><br>
<span class="lineno"></span><span class="op" id="3947166">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3947169">//&nbsp;parseBitString&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;bit&nbsp;string&nbsp;from&nbsp;the&nbsp;given&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno">165</span><span class="keyword" id="3947256">func</span>&nbsp;<span class="ident" id="3947261">parseBitString</span><span class="op" id="3947275">(</span><span class="ident" id="3947276">bytes</span>&nbsp;<span class="op" id="3947282">[</span><span class="op" id="3947283">]</span><span class="builtintype" id="3947284">byte</span><span class="op" id="3947288">)</span>&nbsp;<span class="op" id="3947290">(</span><span class="ident" id="3947291">ret</span>&nbsp;<span class="ident" id="3947295">BitString</span><span class="op" id="3947304">,</span>&nbsp;<span class="ident" id="3947306">err</span>&nbsp;<span class="builtintype" id="3947310">error</span><span class="op" id="3947315">)</span>&nbsp;<span class="op" id="3947317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3947320">if</span>&nbsp;<span class="builtinfunc" id="3947323">len</span><span class="op" id="3947326">(</span><span class="ident" id="3947327">bytes</span><span class="op" id="3947332">)</span>&nbsp;<span class="op" id="3947334">==</span>&nbsp;<span class="num" id="3947337">0</span>&nbsp;<span class="op" id="3947339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3947343">err</span>&nbsp;<span class="op" id="3947347">=</span>&nbsp;<span class="ident" id="3947349">SyntaxError</span><span class="op" id="3947360">{</span><span class="string" id="3947361">&#34;zero&nbsp;length&nbsp;BIT&nbsp;STRING&#34;</span><span class="op" id="3947385">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3947389">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3947397">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3947400">paddingBits</span>&nbsp;<span class="op" id="3947412">:=</span>&nbsp;<span class="builtintype" id="3947415">int</span><span class="op" id="3947418">(</span><span class="ident" id="3947419">bytes</span><span class="op" id="3947424">[</span><span class="num" id="3947425">0</span><span class="op" id="3947426">]</span><span class="op" id="3947427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3947430">if</span>&nbsp;<span class="ident" id="3947433">paddingBits</span>&nbsp;<span class="op" id="3947445">&gt;</span>&nbsp;<span class="num" id="3947447">7</span>&nbsp;<span class="op" id="3947449">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3947454">len</span><span class="op" id="3947457">(</span><span class="ident" id="3947458">bytes</span><span class="op" id="3947463">)</span>&nbsp;<span class="op" id="3947465">==</span>&nbsp;<span class="num" id="3947468">1</span>&nbsp;<span class="op" id="3947470">&amp;&amp;</span>&nbsp;<span class="ident" id="3947473">paddingBits</span>&nbsp;<span class="op" id="3947485">&gt;</span>&nbsp;<span class="num" id="3947487">0</span>&nbsp;<span class="op" id="3947489">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3947494">bytes</span><span class="op" id="3947499">[</span><span class="builtinfunc" id="3947500">len</span><span class="op" id="3947503">(</span><span class="ident" id="3947504">bytes</span><span class="op" id="3947509">)</span><span class="op" id="3947510">-</span><span class="num" id="3947511">1</span><span class="op" id="3947512">]</span><span class="op" id="3947513">&amp;</span><span class="op" id="3947514">(</span><span class="op" id="3947515">(</span><span class="num" id="3947516">1</span><span class="op" id="3947517">&lt;&lt;</span><span class="ident" id="3947519">bytes</span><span class="op" id="3947524">[</span><span class="num" id="3947525">0</span><span class="op" id="3947526">]</span><span class="op" id="3947527">)</span><span class="op" id="3947528">-</span><span class="num" id="3947529">1</span><span class="op" id="3947530">)</span>&nbsp;<span class="op" id="3947532">!=</span>&nbsp;<span class="num" id="3947535">0</span>&nbsp;<span class="op" id="3947537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3947541">err</span>&nbsp;<span class="op" id="3947545">=</span>&nbsp;<span class="ident" id="3947547">SyntaxError</span><span class="op" id="3947558">{</span><span class="string" id="3947559">&#34;invalid&nbsp;padding&nbsp;bits&nbsp;in&nbsp;BIT&nbsp;STRING&#34;</span><span class="op" id="3947595">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3947599">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3947607">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3947610">ret</span><span class="op" id="3947613">.</span><span class="ident" id="3947614">BitLength</span>&nbsp;<span class="op" id="3947624">=</span>&nbsp;<span class="op" id="3947626">(</span><span class="builtinfunc" id="3947627">len</span><span class="op" id="3947630">(</span><span class="ident" id="3947631">bytes</span><span class="op" id="3947636">)</span><span class="op" id="3947637">-</span><span class="num" id="3947638">1</span><span class="op" id="3947639">)</span><span class="op" id="3947640">*</span><span class="num" id="3947641">8</span>&nbsp;<span class="op" id="3947643">-</span>&nbsp;<span class="ident" id="3947645">paddingBits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3947658">ret</span><span class="op" id="3947661">.</span><span class="ident" id="3947662">Bytes</span>&nbsp;<span class="op" id="3947668">=</span>&nbsp;<span class="ident" id="3947670">bytes</span><span class="op" id="3947675">[</span><span class="num" id="3947676">1</span><span class="op" id="3947677">:</span><span class="op" id="3947678">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3947681">return</span><br>
<span class="lineno">180</span><span class="op" id="3947688">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3947691">//&nbsp;OBJECT&nbsp;IDENTIFIER</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3947713">//&nbsp;An&nbsp;ObjectIdentifier&nbsp;represents&nbsp;an&nbsp;ASN.1&nbsp;OBJECT&nbsp;IDENTIFIER.</span><br>
<span class="lineno">185</span><span class="keyword" id="3947775">type</span>&nbsp;<span class="ident" id="3947780">ObjectIdentifier</span>&nbsp;<span class="op" id="3947797">[</span><span class="op" id="3947798">]</span><span class="builtintype" id="3947799">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3947804">//&nbsp;Equal&nbsp;reports&nbsp;whether&nbsp;oi&nbsp;and&nbsp;other&nbsp;represent&nbsp;the&nbsp;same&nbsp;identifier.</span><br>
<span class="lineno"></span><span class="keyword" id="3947873">func</span>&nbsp;<span class="op" id="3947878">(</span><span class="ident" id="3947879">oi</span>&nbsp;<span class="ident" id="3947882">ObjectIdentifier</span><span class="op" id="3947898">)</span>&nbsp;<span class="ident" id="3947900">Equal</span><span class="op" id="3947905">(</span><span class="ident" id="3947906">other</span>&nbsp;<span class="ident" id="3947912">ObjectIdentifier</span><span class="op" id="3947928">)</span>&nbsp;<span class="builtintype" id="3947930">bool</span>&nbsp;<span class="op" id="3947935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3947938">if</span>&nbsp;<span class="builtinfunc" id="3947941">len</span><span class="op" id="3947944">(</span><span class="ident" id="3947945">oi</span><span class="op" id="3947947">)</span>&nbsp;<span class="op" id="3947949">!=</span>&nbsp;<span class="builtinfunc" id="3947952">len</span><span class="op" id="3947955">(</span><span class="ident" id="3947956">other</span><span class="op" id="3947961">)</span>&nbsp;<span class="op" id="3947963">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3947967">return</span>&nbsp;<span class="builtintype" id="3947974">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3947981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3947984">for</span>&nbsp;<span class="ident" id="3947988">i</span>&nbsp;<span class="op" id="3947990">:=</span>&nbsp;<span class="num" id="3947993">0</span><span class="op" id="3947994">;</span>&nbsp;<span class="ident" id="3947996">i</span>&nbsp;<span class="op" id="3947998">&lt;</span>&nbsp;<span class="builtinfunc" id="3948000">len</span><span class="op" id="3948003">(</span><span class="ident" id="3948004">oi</span><span class="op" id="3948006">)</span><span class="op" id="3948007">;</span>&nbsp;<span class="ident" id="3948009">i</span><span class="op" id="3948010">++</span>&nbsp;<span class="op" id="3948013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3948017">if</span>&nbsp;<span class="ident" id="3948020">oi</span><span class="op" id="3948022">[</span><span class="ident" id="3948023">i</span><span class="op" id="3948024">]</span>&nbsp;<span class="op" id="3948026">!=</span>&nbsp;<span class="ident" id="3948029">other</span><span class="op" id="3948034">[</span><span class="ident" id="3948035">i</span><span class="op" id="3948036">]</span>&nbsp;<span class="op" id="3948038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3948043">return</span>&nbsp;<span class="builtintype" id="3948050">false</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3948058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3948061">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3948065">return</span>&nbsp;<span class="builtintype" id="3948072">true</span><br>
<span class="lineno"></span><span class="op" id="3948077">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span><span class="keyword" id="3948080">func</span>&nbsp;<span class="op" id="3948085">(</span><span class="ident" id="3948086">oi</span>&nbsp;<span class="ident" id="3948089">ObjectIdentifier</span><span class="op" id="3948105">)</span>&nbsp;<span class="ident" id="3948107">String</span><span class="op" id="3948113">(</span><span class="op" id="3948114">)</span>&nbsp;<span class="builtintype" id="3948116">string</span>&nbsp;<span class="op" id="3948123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3948126">var</span>&nbsp;<span class="ident" id="3948130">s</span>&nbsp;<span class="builtintype" id="3948132">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3948141">for</span>&nbsp;<span class="ident" id="3948145">i</span><span class="op" id="3948146">,</span>&nbsp;<span class="ident" id="3948148">v</span>&nbsp;<span class="op" id="3948150">:=</span>&nbsp;<span class="keyword" id="3948153">range</span>&nbsp;<span class="ident" id="3948159">oi</span>&nbsp;<span class="op" id="3948162">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3948166">if</span>&nbsp;<span class="ident" id="3948169">i</span>&nbsp;<span class="op" id="3948171">&gt;</span>&nbsp;<span class="num" id="3948173">0</span>&nbsp;<span class="op" id="3948175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3948180">s</span>&nbsp;<span class="op" id="3948182">+=</span>&nbsp;<span class="string" id="3948185">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3948191">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3948195">s</span>&nbsp;<span class="op" id="3948197">+=</span>&nbsp;<span class="ident" id="3948200">strconv</span><span class="op" id="3948207">.</span><span class="ident" id="3948208">Itoa</span><span class="op" id="3948212">(</span><span class="ident" id="3948213">v</span><span class="op" id="3948214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3948217">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3948221">return</span>&nbsp;<span class="ident" id="3948228">s</span><br>
<span class="lineno"></span><span class="op" id="3948230">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3948233">//&nbsp;parseObjectIdentifier&nbsp;parses&nbsp;an&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;from&nbsp;the&nbsp;given&nbsp;bytes&nbsp;and</span><br>
<span class="lineno">215</span><span class="comment" id="3948311">//&nbsp;returns&nbsp;it.&nbsp;An&nbsp;object&nbsp;identifier&nbsp;is&nbsp;a&nbsp;sequence&nbsp;of&nbsp;variable&nbsp;length&nbsp;integers</span><br>
<span class="lineno"></span><span class="comment" id="3948389">//&nbsp;that&nbsp;are&nbsp;assigned&nbsp;in&nbsp;a&nbsp;hierarchy.</span><br>
<span class="lineno"></span><span class="keyword" id="3948426">func</span>&nbsp;<span class="ident" id="3948431">parseObjectIdentifier</span><span class="op" id="3948452">(</span><span class="ident" id="3948453">bytes</span>&nbsp;<span class="op" id="3948459">[</span><span class="op" id="3948460">]</span><span class="builtintype" id="3948461">byte</span><span class="op" id="3948465">)</span>&nbsp;<span class="op" id="3948467">(</span><span class="ident" id="3948468">s</span>&nbsp;<span class="op" id="3948470">[</span><span class="op" id="3948471">]</span><span class="builtintype" id="3948472">int</span><span class="op" id="3948475">,</span>&nbsp;<span class="ident" id="3948477">err</span>&nbsp;<span class="builtintype" id="3948481">error</span><span class="op" id="3948486">)</span>&nbsp;<span class="op" id="3948488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3948491">if</span>&nbsp;<span class="builtinfunc" id="3948494">len</span><span class="op" id="3948497">(</span><span class="ident" id="3948498">bytes</span><span class="op" id="3948503">)</span>&nbsp;<span class="op" id="3948505">==</span>&nbsp;<span class="num" id="3948508">0</span>&nbsp;<span class="op" id="3948510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3948514">err</span>&nbsp;<span class="op" id="3948518">=</span>&nbsp;<span class="ident" id="3948520">SyntaxError</span><span class="op" id="3948531">{</span><span class="string" id="3948532">&#34;zero&nbsp;length&nbsp;OBJECT&nbsp;IDENTIFIER&#34;</span><span class="op" id="3948563">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3948567">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3948575">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3948579">//&nbsp;In&nbsp;the&nbsp;worst&nbsp;case,&nbsp;we&nbsp;get&nbsp;two&nbsp;elements&nbsp;from&nbsp;the&nbsp;first&nbsp;byte&nbsp;(which&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3948652">//&nbsp;encoded&nbsp;differently)&nbsp;and&nbsp;then&nbsp;every&nbsp;varint&nbsp;is&nbsp;a&nbsp;single&nbsp;byte&nbsp;long.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3948722">s</span>&nbsp;<span class="op" id="3948724">=</span>&nbsp;<span class="builtinfunc" id="3948726">make</span><span class="op" id="3948730">(</span><span class="op" id="3948731">[</span><span class="op" id="3948732">]</span><span class="builtintype" id="3948733">int</span><span class="op" id="3948736">,</span>&nbsp;<span class="builtinfunc" id="3948738">len</span><span class="op" id="3948741">(</span><span class="ident" id="3948742">bytes</span><span class="op" id="3948747">)</span><span class="op" id="3948748">+</span><span class="num" id="3948749">1</span><span class="op" id="3948750">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3948754">//&nbsp;The&nbsp;first&nbsp;varint&nbsp;is&nbsp;40*value1&nbsp;+&nbsp;value2:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3948798">//&nbsp;According&nbsp;to&nbsp;this&nbsp;packing,&nbsp;value1&nbsp;can&nbsp;take&nbsp;the&nbsp;values&nbsp;0,&nbsp;1&nbsp;and&nbsp;2&nbsp;only.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3948873">//&nbsp;When&nbsp;value1&nbsp;=&nbsp;0&nbsp;or&nbsp;value1&nbsp;=&nbsp;1,&nbsp;then&nbsp;value2&nbsp;is&nbsp;&lt;=&nbsp;39.&nbsp;When&nbsp;value1&nbsp;=&nbsp;2,</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3948947">//&nbsp;then&nbsp;there&nbsp;are&nbsp;no&nbsp;restrictions&nbsp;on&nbsp;value2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3948993">v</span><span class="op" id="3948994">,</span>&nbsp;<span class="ident" id="3948996">offset</span><span class="op" id="3949002">,</span>&nbsp;<span class="ident" id="3949004">err</span>&nbsp;<span class="op" id="3949008">:=</span>&nbsp;<span class="ident" id="3949011">parseBase128Int</span><span class="op" id="3949026">(</span><span class="ident" id="3949027">bytes</span><span class="op" id="3949032">,</span>&nbsp;<span class="num" id="3949034">0</span><span class="op" id="3949035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3949038">if</span>&nbsp;<span class="ident" id="3949041">err</span>&nbsp;<span class="op" id="3949045">!=</span>&nbsp;<span class="ident" id="3949048">nil</span>&nbsp;<span class="op" id="3949052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3949056">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3949064">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3949067">if</span>&nbsp;<span class="ident" id="3949070">v</span>&nbsp;<span class="op" id="3949072">&lt;</span>&nbsp;<span class="num" id="3949074">80</span>&nbsp;<span class="op" id="3949077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949081">s</span><span class="op" id="3949082">[</span><span class="num" id="3949083">0</span><span class="op" id="3949084">]</span>&nbsp;<span class="op" id="3949086">=</span>&nbsp;<span class="ident" id="3949088">v</span>&nbsp;<span class="op" id="3949090">/</span>&nbsp;<span class="num" id="3949092">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949097">s</span><span class="op" id="3949098">[</span><span class="num" id="3949099">1</span><span class="op" id="3949100">]</span>&nbsp;<span class="op" id="3949102">=</span>&nbsp;<span class="ident" id="3949104">v</span>&nbsp;<span class="op" id="3949106">%</span>&nbsp;<span class="num" id="3949108">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3949112">}</span>&nbsp;<span class="keyword" id="3949114">else</span>&nbsp;<span class="op" id="3949119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949123">s</span><span class="op" id="3949124">[</span><span class="num" id="3949125">0</span><span class="op" id="3949126">]</span>&nbsp;<span class="op" id="3949128">=</span>&nbsp;<span class="num" id="3949130">2</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949134">s</span><span class="op" id="3949135">[</span><span class="num" id="3949136">1</span><span class="op" id="3949137">]</span>&nbsp;<span class="op" id="3949139">=</span>&nbsp;<span class="ident" id="3949141">v</span>&nbsp;<span class="op" id="3949143">-</span>&nbsp;<span class="num" id="3949145">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3949149">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949153">i</span>&nbsp;<span class="op" id="3949155">:=</span>&nbsp;<span class="num" id="3949158">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3949161">for</span>&nbsp;<span class="op" id="3949165">;</span>&nbsp;<span class="ident" id="3949167">offset</span>&nbsp;<span class="op" id="3949174">&lt;</span>&nbsp;<span class="builtinfunc" id="3949176">len</span><span class="op" id="3949179">(</span><span class="ident" id="3949180">bytes</span><span class="op" id="3949185">)</span><span class="op" id="3949186">;</span>&nbsp;<span class="ident" id="3949188">i</span><span class="op" id="3949189">++</span>&nbsp;<span class="op" id="3949192">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949196">v</span><span class="op" id="3949197">,</span>&nbsp;<span class="ident" id="3949199">offset</span><span class="op" id="3949205">,</span>&nbsp;<span class="ident" id="3949207">err</span>&nbsp;<span class="op" id="3949211">=</span>&nbsp;<span class="ident" id="3949213">parseBase128Int</span><span class="op" id="3949228">(</span><span class="ident" id="3949229">bytes</span><span class="op" id="3949234">,</span>&nbsp;<span class="ident" id="3949236">offset</span><span class="op" id="3949242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3949246">if</span>&nbsp;<span class="ident" id="3949249">err</span>&nbsp;<span class="op" id="3949253">!=</span>&nbsp;<span class="ident" id="3949256">nil</span>&nbsp;<span class="op" id="3949260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3949265">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3949274">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949278">s</span><span class="op" id="3949279">[</span><span class="ident" id="3949280">i</span><span class="op" id="3949281">]</span>&nbsp;<span class="op" id="3949283">=</span>&nbsp;<span class="ident" id="3949285">v</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3949288">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949291">s</span>&nbsp;<span class="op" id="3949293">=</span>&nbsp;<span class="ident" id="3949295">s</span><span class="op" id="3949296">[</span><span class="num" id="3949297">0</span><span class="op" id="3949298">:</span><span class="ident" id="3949299">i</span><span class="op" id="3949300">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3949303">return</span><br>
<span class="lineno"></span><span class="op" id="3949310">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="comment" id="3949313">//&nbsp;ENUMERATED</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3949328">//&nbsp;An&nbsp;Enumerated&nbsp;is&nbsp;represented&nbsp;as&nbsp;a&nbsp;plain&nbsp;int.</span><br>
<span class="lineno"></span><span class="keyword" id="3949376">type</span>&nbsp;<span class="ident" id="3949381">Enumerated</span>&nbsp;<span class="builtintype" id="3949392">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="comment" id="3949397">//&nbsp;FLAG</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3949406">//&nbsp;A&nbsp;Flag&nbsp;accepts&nbsp;any&nbsp;data&nbsp;and&nbsp;is&nbsp;set&nbsp;to&nbsp;true&nbsp;if&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="3949464">type</span>&nbsp;<span class="ident" id="3949469">Flag</span>&nbsp;<span class="builtintype" id="3949474">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="comment" id="3949480">//&nbsp;parseBase128Int&nbsp;parses&nbsp;a&nbsp;base-128&nbsp;encoded&nbsp;int&nbsp;from&nbsp;the&nbsp;given&nbsp;offset&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3949558">//&nbsp;given&nbsp;byte&nbsp;slice.&nbsp;It&nbsp;returns&nbsp;the&nbsp;value&nbsp;and&nbsp;the&nbsp;new&nbsp;offset.</span><br>
<span class="lineno"></span><span class="keyword" id="3949620">func</span>&nbsp;<span class="ident" id="3949625">parseBase128Int</span><span class="op" id="3949640">(</span><span class="ident" id="3949641">bytes</span>&nbsp;<span class="op" id="3949647">[</span><span class="op" id="3949648">]</span><span class="builtintype" id="3949649">byte</span><span class="op" id="3949653">,</span>&nbsp;<span class="ident" id="3949655">initOffset</span>&nbsp;<span class="builtintype" id="3949666">int</span><span class="op" id="3949669">)</span>&nbsp;<span class="op" id="3949671">(</span><span class="ident" id="3949672">ret</span><span class="op" id="3949675">,</span>&nbsp;<span class="ident" id="3949677">offset</span>&nbsp;<span class="builtintype" id="3949684">int</span><span class="op" id="3949687">,</span>&nbsp;<span class="ident" id="3949689">err</span>&nbsp;<span class="builtintype" id="3949693">error</span><span class="op" id="3949698">)</span>&nbsp;<span class="op" id="3949700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949703">offset</span>&nbsp;<span class="op" id="3949710">=</span>&nbsp;<span class="ident" id="3949712">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3949724">for</span>&nbsp;<span class="ident" id="3949728">shifted</span>&nbsp;<span class="op" id="3949736">:=</span>&nbsp;<span class="num" id="3949739">0</span><span class="op" id="3949740">;</span>&nbsp;<span class="ident" id="3949742">offset</span>&nbsp;<span class="op" id="3949749">&lt;</span>&nbsp;<span class="builtinfunc" id="3949751">len</span><span class="op" id="3949754">(</span><span class="ident" id="3949755">bytes</span><span class="op" id="3949760">)</span><span class="op" id="3949761">;</span>&nbsp;<span class="ident" id="3949763">shifted</span><span class="op" id="3949770">++</span>&nbsp;<span class="op" id="3949773">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3949777">if</span>&nbsp;<span class="ident" id="3949780">shifted</span>&nbsp;<span class="op" id="3949788">&gt;</span>&nbsp;<span class="num" id="3949790">4</span>&nbsp;<span class="op" id="3949792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949797">err</span>&nbsp;<span class="op" id="3949801">=</span>&nbsp;<span class="ident" id="3949803">StructuralError</span><span class="op" id="3949818">{</span><span class="string" id="3949819">&#34;base&nbsp;128&nbsp;integer&nbsp;too&nbsp;large&#34;</span><span class="op" id="3949847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3949852">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3949861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949865">ret</span>&nbsp;<span class="op" id="3949869">&lt;&lt;=</span>&nbsp;<span class="num" id="3949873">7</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949877">b</span>&nbsp;<span class="op" id="3949879">:=</span>&nbsp;<span class="ident" id="3949882">bytes</span><span class="op" id="3949887">[</span><span class="ident" id="3949888">offset</span><span class="op" id="3949894">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949898">ret</span>&nbsp;<span class="op" id="3949902">|=</span>&nbsp;<span class="builtintype" id="3949905">int</span><span class="op" id="3949908">(</span><span class="ident" id="3949909">b</span>&nbsp;<span class="op" id="3949911">&amp;</span>&nbsp;<span class="num" id="3949913">0x7f</span><span class="op" id="3949917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949921">offset</span><span class="op" id="3949927">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3949932">if</span>&nbsp;<span class="ident" id="3949935">b</span><span class="op" id="3949936">&amp;</span><span class="num" id="3949937">0x80</span>&nbsp;<span class="op" id="3949942">==</span>&nbsp;<span class="num" id="3949945">0</span>&nbsp;<span class="op" id="3949947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3949952">return</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3949961">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3949964">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3949967">err</span>&nbsp;<span class="op" id="3949971">=</span>&nbsp;<span class="ident" id="3949973">SyntaxError</span><span class="op" id="3949984">{</span><span class="string" id="3949985">&#34;truncated&nbsp;base&nbsp;128&nbsp;integer&#34;</span><span class="op" id="3950013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3950016">return</span><br>
<span class="lineno"></span><span class="op" id="3950023">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span><span class="comment" id="3950026">//&nbsp;UTCTime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3950038">func</span>&nbsp;<span class="ident" id="3950043">parseUTCTime</span><span class="op" id="3950055">(</span><span class="ident" id="3950056">bytes</span>&nbsp;<span class="op" id="3950062">[</span><span class="op" id="3950063">]</span><span class="builtintype" id="3950064">byte</span><span class="op" id="3950068">)</span>&nbsp;<span class="op" id="3950070">(</span><span class="ident" id="3950071">ret</span>&nbsp;<span class="ident" id="3950075">time</span><span class="op" id="3950079">.</span><span class="ident" id="3950080">Time</span><span class="op" id="3950084">,</span>&nbsp;<span class="ident" id="3950086">err</span>&nbsp;<span class="builtintype" id="3950090">error</span><span class="op" id="3950095">)</span>&nbsp;<span class="op" id="3950097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950100">s</span>&nbsp;<span class="op" id="3950102">:=</span>&nbsp;<span class="builtintype" id="3950105">string</span><span class="op" id="3950111">(</span><span class="ident" id="3950112">bytes</span><span class="op" id="3950117">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950120">ret</span><span class="op" id="3950123">,</span>&nbsp;<span class="ident" id="3950125">err</span>&nbsp;<span class="op" id="3950129">=</span>&nbsp;<span class="ident" id="3950131">time</span><span class="op" id="3950135">.</span><span class="ident" id="3950136">Parse</span><span class="op" id="3950141">(</span><span class="string" id="3950142">&#34;0601021504Z0700&#34;</span><span class="op" id="3950159">,</span>&nbsp;<span class="ident" id="3950161">s</span><span class="op" id="3950162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3950165">if</span>&nbsp;<span class="ident" id="3950168">err</span>&nbsp;<span class="op" id="3950172">!=</span>&nbsp;<span class="ident" id="3950175">nil</span>&nbsp;<span class="op" id="3950179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950183">ret</span><span class="op" id="3950186">,</span>&nbsp;<span class="ident" id="3950188">err</span>&nbsp;<span class="op" id="3950192">=</span>&nbsp;<span class="ident" id="3950194">time</span><span class="op" id="3950198">.</span><span class="ident" id="3950199">Parse</span><span class="op" id="3950204">(</span><span class="string" id="3950205">&#34;060102150405Z0700&#34;</span><span class="op" id="3950224">,</span>&nbsp;<span class="ident" id="3950226">s</span><span class="op" id="3950227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3950230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3950233">if</span>&nbsp;<span class="ident" id="3950236">err</span>&nbsp;<span class="op" id="3950240">==</span>&nbsp;<span class="ident" id="3950243">nil</span>&nbsp;<span class="op" id="3950247">&amp;&amp;</span>&nbsp;<span class="ident" id="3950250">ret</span><span class="op" id="3950253">.</span><span class="ident" id="3950254">Year</span><span class="op" id="3950258">(</span><span class="op" id="3950259">)</span>&nbsp;<span class="op" id="3950261">&gt;=</span>&nbsp;<span class="num" id="3950264">2050</span>&nbsp;<span class="op" id="3950269">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3950273">//&nbsp;UTCTime&nbsp;only&nbsp;encodes&nbsp;times&nbsp;prior&nbsp;to&nbsp;2050.&nbsp;See&nbsp;https://tools.ietf.org/html/rfc5280#section-4.1.2.5.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950378">ret</span>&nbsp;<span class="op" id="3950382">=</span>&nbsp;<span class="ident" id="3950384">ret</span><span class="op" id="3950387">.</span><span class="ident" id="3950388">AddDate</span><span class="op" id="3950395">(</span><span class="op" id="3950396">-</span><span class="num" id="3950397">100</span><span class="op" id="3950400">,</span>&nbsp;<span class="num" id="3950402">0</span><span class="op" id="3950403">,</span>&nbsp;<span class="num" id="3950405">0</span><span class="op" id="3950406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3950409">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3950413">return</span><br>
<span class="lineno">300</span><span class="op" id="3950420">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3950423">//&nbsp;parseGeneralizedTime&nbsp;parses&nbsp;the&nbsp;GeneralizedTime&nbsp;from&nbsp;the&nbsp;given&nbsp;byte&nbsp;slice</span><br>
<span class="lineno"></span><span class="comment" id="3950500">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;resulting&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="3950535">func</span>&nbsp;<span class="ident" id="3950540">parseGeneralizedTime</span><span class="op" id="3950560">(</span><span class="ident" id="3950561">bytes</span>&nbsp;<span class="op" id="3950567">[</span><span class="op" id="3950568">]</span><span class="builtintype" id="3950569">byte</span><span class="op" id="3950573">)</span>&nbsp;<span class="op" id="3950575">(</span><span class="ident" id="3950576">ret</span>&nbsp;<span class="ident" id="3950580">time</span><span class="op" id="3950584">.</span><span class="ident" id="3950585">Time</span><span class="op" id="3950589">,</span>&nbsp;<span class="ident" id="3950591">err</span>&nbsp;<span class="builtintype" id="3950595">error</span><span class="op" id="3950600">)</span>&nbsp;<span class="op" id="3950602">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3950605">return</span>&nbsp;<span class="ident" id="3950612">time</span><span class="op" id="3950616">.</span><span class="ident" id="3950617">Parse</span><span class="op" id="3950622">(</span><span class="string" id="3950623">&#34;20060102150405Z0700&#34;</span><span class="op" id="3950644">,</span>&nbsp;<span class="builtintype" id="3950646">string</span><span class="op" id="3950652">(</span><span class="ident" id="3950653">bytes</span><span class="op" id="3950658">)</span><span class="op" id="3950659">)</span><br>
<span class="lineno"></span><span class="op" id="3950661">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3950664">//&nbsp;PrintableString</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="3950684">//&nbsp;parsePrintableString&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;PrintableString&nbsp;from&nbsp;the&nbsp;given&nbsp;byte</span><br>
<span class="lineno"></span><span class="comment" id="3950759">//&nbsp;array&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="3950784">func</span>&nbsp;<span class="ident" id="3950789">parsePrintableString</span><span class="op" id="3950809">(</span><span class="ident" id="3950810">bytes</span>&nbsp;<span class="op" id="3950816">[</span><span class="op" id="3950817">]</span><span class="builtintype" id="3950818">byte</span><span class="op" id="3950822">)</span>&nbsp;<span class="op" id="3950824">(</span><span class="ident" id="3950825">ret</span>&nbsp;<span class="builtintype" id="3950829">string</span><span class="op" id="3950835">,</span>&nbsp;<span class="ident" id="3950837">err</span>&nbsp;<span class="builtintype" id="3950841">error</span><span class="op" id="3950846">)</span>&nbsp;<span class="op" id="3950848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3950851">for</span>&nbsp;<span class="ident" id="3950855">_</span><span class="op" id="3950856">,</span>&nbsp;<span class="ident" id="3950858">b</span>&nbsp;<span class="op" id="3950860">:=</span>&nbsp;<span class="keyword" id="3950863">range</span>&nbsp;<span class="ident" id="3950869">bytes</span>&nbsp;<span class="op" id="3950875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3950879">if</span>&nbsp;<span class="op" id="3950882">!</span><span class="ident" id="3950883">isPrintable</span><span class="op" id="3950894">(</span><span class="ident" id="3950895">b</span><span class="op" id="3950896">)</span>&nbsp;<span class="op" id="3950898">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950903">err</span>&nbsp;<span class="op" id="3950907">=</span>&nbsp;<span class="ident" id="3950909">SyntaxError</span><span class="op" id="3950920">{</span><span class="string" id="3950921">&#34;PrintableString&nbsp;contains&nbsp;invalid&nbsp;character&#34;</span><span class="op" id="3950965">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3950970">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3950979">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3950982">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3950985">ret</span>&nbsp;<span class="op" id="3950989">=</span>&nbsp;<span class="builtintype" id="3950991">string</span><span class="op" id="3950997">(</span><span class="ident" id="3950998">bytes</span><span class="op" id="3951003">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3951006">return</span><br>
<span class="lineno"></span><span class="op" id="3951013">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3951016">//&nbsp;isPrintable&nbsp;returns&nbsp;true&nbsp;iff&nbsp;the&nbsp;given&nbsp;b&nbsp;is&nbsp;in&nbsp;the&nbsp;ASN.1&nbsp;PrintableString&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="3951097">func</span>&nbsp;<span class="ident" id="3951102">isPrintable</span><span class="op" id="3951113">(</span><span class="ident" id="3951114">b</span>&nbsp;<span class="builtintype" id="3951116">byte</span><span class="op" id="3951120">)</span>&nbsp;<span class="builtintype" id="3951122">bool</span>&nbsp;<span class="op" id="3951127">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3951130">return</span>&nbsp;<span class="string" id="3951137">&#39;a&#39;</span>&nbsp;<span class="op" id="3951141">&lt;=</span>&nbsp;<span class="ident" id="3951144">b</span>&nbsp;<span class="op" id="3951146">&amp;&amp;</span>&nbsp;<span class="ident" id="3951149">b</span>&nbsp;<span class="op" id="3951151">&lt;=</span>&nbsp;<span class="string" id="3951154">&#39;z&#39;</span>&nbsp;<span class="op" id="3951158">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3951163">&#39;A&#39;</span>&nbsp;<span class="op" id="3951167">&lt;=</span>&nbsp;<span class="ident" id="3951170">b</span>&nbsp;<span class="op" id="3951172">&amp;&amp;</span>&nbsp;<span class="ident" id="3951175">b</span>&nbsp;<span class="op" id="3951177">&lt;=</span>&nbsp;<span class="string" id="3951180">&#39;Z&#39;</span>&nbsp;<span class="op" id="3951184">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3951189">&#39;0&#39;</span>&nbsp;<span class="op" id="3951193">&lt;=</span>&nbsp;<span class="ident" id="3951196">b</span>&nbsp;<span class="op" id="3951198">&amp;&amp;</span>&nbsp;<span class="ident" id="3951201">b</span>&nbsp;<span class="op" id="3951203">&lt;=</span>&nbsp;<span class="string" id="3951206">&#39;9&#39;</span>&nbsp;<span class="op" id="3951210">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3951215">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="3951220">&lt;=</span>&nbsp;<span class="ident" id="3951223">b</span>&nbsp;<span class="op" id="3951225">&amp;&amp;</span>&nbsp;<span class="ident" id="3951228">b</span>&nbsp;<span class="op" id="3951230">&lt;=</span>&nbsp;<span class="string" id="3951233">&#39;)&#39;</span>&nbsp;<span class="op" id="3951237">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3951242">&#39;+&#39;</span>&nbsp;<span class="op" id="3951246">&lt;=</span>&nbsp;<span class="ident" id="3951249">b</span>&nbsp;<span class="op" id="3951251">&amp;&amp;</span>&nbsp;<span class="ident" id="3951254">b</span>&nbsp;<span class="op" id="3951256">&lt;=</span>&nbsp;<span class="string" id="3951259">&#39;/&#39;</span>&nbsp;<span class="op" id="3951263">||</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951268">b</span>&nbsp;<span class="op" id="3951270">==</span>&nbsp;<span class="string" id="3951273">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3951277">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951282">b</span>&nbsp;<span class="op" id="3951284">==</span>&nbsp;<span class="string" id="3951287">&#39;:&#39;</span>&nbsp;<span class="op" id="3951291">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951296">b</span>&nbsp;<span class="op" id="3951298">==</span>&nbsp;<span class="string" id="3951301">&#39;=&#39;</span>&nbsp;<span class="op" id="3951305">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951310">b</span>&nbsp;<span class="op" id="3951312">==</span>&nbsp;<span class="string" id="3951315">&#39;?&#39;</span>&nbsp;<span class="op" id="3951319">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3951324">//&nbsp;This&nbsp;is&nbsp;technically&nbsp;not&nbsp;allowed&nbsp;in&nbsp;a&nbsp;PrintableString.</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3951383">//&nbsp;However,&nbsp;x509&nbsp;certificates&nbsp;with&nbsp;wildcard&nbsp;strings&nbsp;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3951443">//&nbsp;always&nbsp;use&nbsp;the&nbsp;correct&nbsp;string&nbsp;type&nbsp;so&nbsp;we&nbsp;permit&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951500">b</span>&nbsp;<span class="op" id="3951502">==</span>&nbsp;<span class="string" id="3951505">&#39;*&#39;</span><br>
<span class="lineno"></span><span class="op" id="3951509">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span><span class="comment" id="3951512">//&nbsp;IA5String</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3951526">//&nbsp;parseIA5String&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;IA5String&nbsp;(ASCII&nbsp;string)&nbsp;from&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="3951599">//&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="3951629">func</span>&nbsp;<span class="ident" id="3951634">parseIA5String</span><span class="op" id="3951648">(</span><span class="ident" id="3951649">bytes</span>&nbsp;<span class="op" id="3951655">[</span><span class="op" id="3951656">]</span><span class="builtintype" id="3951657">byte</span><span class="op" id="3951661">)</span>&nbsp;<span class="op" id="3951663">(</span><span class="ident" id="3951664">ret</span>&nbsp;<span class="builtintype" id="3951668">string</span><span class="op" id="3951674">,</span>&nbsp;<span class="ident" id="3951676">err</span>&nbsp;<span class="builtintype" id="3951680">error</span><span class="op" id="3951685">)</span>&nbsp;<span class="op" id="3951687">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3951690">for</span>&nbsp;<span class="ident" id="3951694">_</span><span class="op" id="3951695">,</span>&nbsp;<span class="ident" id="3951697">b</span>&nbsp;<span class="op" id="3951699">:=</span>&nbsp;<span class="keyword" id="3951702">range</span>&nbsp;<span class="ident" id="3951708">bytes</span>&nbsp;<span class="op" id="3951714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3951718">if</span>&nbsp;<span class="ident" id="3951721">b</span>&nbsp;<span class="op" id="3951723">&gt;=</span>&nbsp;<span class="num" id="3951726">0x80</span>&nbsp;<span class="op" id="3951731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951736">err</span>&nbsp;<span class="op" id="3951740">=</span>&nbsp;<span class="ident" id="3951742">SyntaxError</span><span class="op" id="3951753">{</span><span class="string" id="3951754">&#34;IA5String&nbsp;contains&nbsp;invalid&nbsp;character&#34;</span><span class="op" id="3951792">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3951797">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3951806">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3951809">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951812">ret</span>&nbsp;<span class="op" id="3951816">=</span>&nbsp;<span class="builtintype" id="3951818">string</span><span class="op" id="3951824">(</span><span class="ident" id="3951825">bytes</span><span class="op" id="3951830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3951833">return</span><br>
<span class="lineno"></span><span class="op" id="3951840">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="comment" id="3951843">//&nbsp;T61String</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3951857">//&nbsp;parseT61String&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;T61String&nbsp;(8-bit&nbsp;clean&nbsp;string)&nbsp;from&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="3951936">//&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="3951966">func</span>&nbsp;<span class="ident" id="3951971">parseT61String</span><span class="op" id="3951985">(</span><span class="ident" id="3951986">bytes</span>&nbsp;<span class="op" id="3951992">[</span><span class="op" id="3951993">]</span><span class="builtintype" id="3951994">byte</span><span class="op" id="3951998">)</span>&nbsp;<span class="op" id="3952000">(</span><span class="ident" id="3952001">ret</span>&nbsp;<span class="builtintype" id="3952005">string</span><span class="op" id="3952011">,</span>&nbsp;<span class="ident" id="3952013">err</span>&nbsp;<span class="builtintype" id="3952017">error</span><span class="op" id="3952022">)</span>&nbsp;<span class="op" id="3952024">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3952027">return</span>&nbsp;<span class="builtintype" id="3952034">string</span><span class="op" id="3952040">(</span><span class="ident" id="3952041">bytes</span><span class="op" id="3952046">)</span><span class="op" id="3952047">,</span>&nbsp;<span class="ident" id="3952049">nil</span><br>
<span class="lineno"></span><span class="op" id="3952053">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3952056">//&nbsp;UTF8String</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span><span class="comment" id="3952071">//&nbsp;parseUTF8String&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;UTF8String&nbsp;(raw&nbsp;UTF-8)&nbsp;from&nbsp;the&nbsp;given&nbsp;byte</span><br>
<span class="lineno"></span><span class="comment" id="3952148">//&nbsp;array&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="3952173">func</span>&nbsp;<span class="ident" id="3952178">parseUTF8String</span><span class="op" id="3952193">(</span><span class="ident" id="3952194">bytes</span>&nbsp;<span class="op" id="3952200">[</span><span class="op" id="3952201">]</span><span class="builtintype" id="3952202">byte</span><span class="op" id="3952206">)</span>&nbsp;<span class="op" id="3952208">(</span><span class="ident" id="3952209">ret</span>&nbsp;<span class="builtintype" id="3952213">string</span><span class="op" id="3952219">,</span>&nbsp;<span class="ident" id="3952221">err</span>&nbsp;<span class="builtintype" id="3952225">error</span><span class="op" id="3952230">)</span>&nbsp;<span class="op" id="3952232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3952235">return</span>&nbsp;<span class="builtintype" id="3952242">string</span><span class="op" id="3952248">(</span><span class="ident" id="3952249">bytes</span><span class="op" id="3952254">)</span><span class="op" id="3952255">,</span>&nbsp;<span class="ident" id="3952257">nil</span><br>
<span class="lineno"></span><span class="op" id="3952261">}</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span><span class="comment" id="3952264">//&nbsp;A&nbsp;RawValue&nbsp;represents&nbsp;an&nbsp;undecoded&nbsp;ASN.1&nbsp;object.</span><br>
<span class="lineno"></span><span class="keyword" id="3952316">type</span>&nbsp;<span class="ident" id="3952321">RawValue</span>&nbsp;<span class="keyword" id="3952330">struct</span>&nbsp;<span class="op" id="3952337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3952340">Class</span><span class="op" id="3952345">,</span>&nbsp;<span class="ident" id="3952347">Tag</span>&nbsp;<span class="builtintype" id="3952351">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3952356">IsCompound</span>&nbsp;<span class="builtintype" id="3952367">bool</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3952373">Bytes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3952384">[</span><span class="op" id="3952385">]</span><span class="builtintype" id="3952386">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3952392">FullBytes</span>&nbsp;&nbsp;<span class="op" id="3952403">[</span><span class="op" id="3952404">]</span><span class="builtintype" id="3952405">byte</span>&nbsp;<span class="comment" id="3952410">//&nbsp;includes&nbsp;the&nbsp;tag&nbsp;and&nbsp;length</span><br>
<span class="lineno"></span><span class="op" id="3952441">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3952444">//&nbsp;RawContent&nbsp;is&nbsp;used&nbsp;to&nbsp;signal&nbsp;that&nbsp;the&nbsp;undecoded,&nbsp;DER&nbsp;data&nbsp;needs&nbsp;to&nbsp;be</span><br>
<span class="lineno">380</span><span class="comment" id="3952517">//&nbsp;preserved&nbsp;for&nbsp;a&nbsp;struct.&nbsp;To&nbsp;use&nbsp;it,&nbsp;the&nbsp;first&nbsp;field&nbsp;of&nbsp;the&nbsp;struct&nbsp;must&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="3952595">//&nbsp;this&nbsp;type.&nbsp;It&#39;s&nbsp;an&nbsp;error&nbsp;for&nbsp;any&nbsp;of&nbsp;the&nbsp;other&nbsp;fields&nbsp;to&nbsp;have&nbsp;this&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="3952670">type</span>&nbsp;<span class="ident" id="3952675">RawContent</span>&nbsp;<span class="op" id="3952686">[</span><span class="op" id="3952687">]</span><span class="builtintype" id="3952688">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3952694">//&nbsp;Tagging</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span><span class="comment" id="3952706">//&nbsp;parseTagAndLength&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;tag&nbsp;and&nbsp;length&nbsp;pair&nbsp;from&nbsp;the&nbsp;given&nbsp;offset</span><br>
<span class="lineno"></span><span class="comment" id="3952785">//&nbsp;into&nbsp;a&nbsp;byte&nbsp;slice.&nbsp;It&nbsp;returns&nbsp;the&nbsp;parsed&nbsp;data&nbsp;and&nbsp;the&nbsp;new&nbsp;offset.&nbsp;SET&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3952862">//&nbsp;SET&nbsp;OF&nbsp;(tag&nbsp;17)&nbsp;are&nbsp;mapped&nbsp;to&nbsp;SEQUENCE&nbsp;and&nbsp;SEQUENCE&nbsp;OF&nbsp;(tag&nbsp;16)&nbsp;since&nbsp;we</span><br>
<span class="lineno"></span><span class="comment" id="3952938">//&nbsp;don&#39;t&nbsp;distinguish&nbsp;between&nbsp;ordered&nbsp;and&nbsp;unordered&nbsp;objects&nbsp;in&nbsp;this&nbsp;code.</span><br>
<span class="lineno">390</span><span class="keyword" id="3953011">func</span>&nbsp;<span class="ident" id="3953016">parseTagAndLength</span><span class="op" id="3953033">(</span><span class="ident" id="3953034">bytes</span>&nbsp;<span class="op" id="3953040">[</span><span class="op" id="3953041">]</span><span class="builtintype" id="3953042">byte</span><span class="op" id="3953046">,</span>&nbsp;<span class="ident" id="3953048">initOffset</span>&nbsp;<span class="builtintype" id="3953059">int</span><span class="op" id="3953062">)</span>&nbsp;<span class="op" id="3953064">(</span><span class="ident" id="3953065">ret</span>&nbsp;<span class="ident" id="3953069">tagAndLength</span><span class="op" id="3953081">,</span>&nbsp;<span class="ident" id="3953083">offset</span>&nbsp;<span class="builtintype" id="3953090">int</span><span class="op" id="3953093">,</span>&nbsp;<span class="ident" id="3953095">err</span>&nbsp;<span class="builtintype" id="3953099">error</span><span class="op" id="3953104">)</span>&nbsp;<span class="op" id="3953106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953109">offset</span>&nbsp;<span class="op" id="3953116">=</span>&nbsp;<span class="ident" id="3953118">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953130">b</span>&nbsp;<span class="op" id="3953132">:=</span>&nbsp;<span class="ident" id="3953135">bytes</span><span class="op" id="3953140">[</span><span class="ident" id="3953141">offset</span><span class="op" id="3953147">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953150">offset</span><span class="op" id="3953156">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953160">ret</span><span class="op" id="3953163">.</span><span class="ident" id="3953164">class</span>&nbsp;<span class="op" id="3953170">=</span>&nbsp;<span class="builtintype" id="3953172">int</span><span class="op" id="3953175">(</span><span class="ident" id="3953176">b</span>&nbsp;<span class="op" id="3953178">&gt;&gt;</span>&nbsp;<span class="num" id="3953181">6</span><span class="op" id="3953182">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953185">ret</span><span class="op" id="3953188">.</span><span class="ident" id="3953189">isCompound</span>&nbsp;<span class="op" id="3953200">=</span>&nbsp;<span class="ident" id="3953202">b</span><span class="op" id="3953203">&amp;</span><span class="num" id="3953204">0x20</span>&nbsp;<span class="op" id="3953209">==</span>&nbsp;<span class="num" id="3953212">0x20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953218">ret</span><span class="op" id="3953221">.</span><span class="ident" id="3953222">tag</span>&nbsp;<span class="op" id="3953226">=</span>&nbsp;<span class="builtintype" id="3953228">int</span><span class="op" id="3953231">(</span><span class="ident" id="3953232">b</span>&nbsp;<span class="op" id="3953234">&amp;</span>&nbsp;<span class="num" id="3953236">0x1f</span><span class="op" id="3953240">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3953244">//&nbsp;If&nbsp;the&nbsp;bottom&nbsp;five&nbsp;bits&nbsp;are&nbsp;set,&nbsp;then&nbsp;the&nbsp;tag&nbsp;number&nbsp;is&nbsp;actually&nbsp;base&nbsp;128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3953322">//&nbsp;encoded&nbsp;afterwards</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3953345">if</span>&nbsp;<span class="ident" id="3953348">ret</span><span class="op" id="3953351">.</span><span class="ident" id="3953352">tag</span>&nbsp;<span class="op" id="3953356">==</span>&nbsp;<span class="num" id="3953359">0x1f</span>&nbsp;<span class="op" id="3953364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953368">ret</span><span class="op" id="3953371">.</span><span class="ident" id="3953372">tag</span><span class="op" id="3953375">,</span>&nbsp;<span class="ident" id="3953377">offset</span><span class="op" id="3953383">,</span>&nbsp;<span class="ident" id="3953385">err</span>&nbsp;<span class="op" id="3953389">=</span>&nbsp;<span class="ident" id="3953391">parseBase128Int</span><span class="op" id="3953406">(</span><span class="ident" id="3953407">bytes</span><span class="op" id="3953412">,</span>&nbsp;<span class="ident" id="3953414">offset</span><span class="op" id="3953420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3953424">if</span>&nbsp;<span class="ident" id="3953427">err</span>&nbsp;<span class="op" id="3953431">!=</span>&nbsp;<span class="ident" id="3953434">nil</span>&nbsp;<span class="op" id="3953438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3953443">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3953452">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3953455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3953458">if</span>&nbsp;<span class="ident" id="3953461">offset</span>&nbsp;<span class="op" id="3953468">&gt;=</span>&nbsp;<span class="builtinfunc" id="3953471">len</span><span class="op" id="3953474">(</span><span class="ident" id="3953475">bytes</span><span class="op" id="3953480">)</span>&nbsp;<span class="op" id="3953482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953486">err</span>&nbsp;<span class="op" id="3953490">=</span>&nbsp;<span class="ident" id="3953492">SyntaxError</span><span class="op" id="3953503">{</span><span class="string" id="3953504">&#34;truncated&nbsp;tag&nbsp;or&nbsp;length&#34;</span><span class="op" id="3953529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3953533">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3953541">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953544">b</span>&nbsp;<span class="op" id="3953546">=</span>&nbsp;<span class="ident" id="3953548">bytes</span><span class="op" id="3953553">[</span><span class="ident" id="3953554">offset</span><span class="op" id="3953560">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953563">offset</span><span class="op" id="3953569">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3953573">if</span>&nbsp;<span class="ident" id="3953576">b</span><span class="op" id="3953577">&amp;</span><span class="num" id="3953578">0x80</span>&nbsp;<span class="op" id="3953583">==</span>&nbsp;<span class="num" id="3953586">0</span>&nbsp;<span class="op" id="3953588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3953592">//&nbsp;The&nbsp;length&nbsp;is&nbsp;encoded&nbsp;in&nbsp;the&nbsp;bottom&nbsp;7&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953641">ret</span><span class="op" id="3953644">.</span><span class="ident" id="3953645">length</span>&nbsp;<span class="op" id="3953652">=</span>&nbsp;<span class="builtintype" id="3953654">int</span><span class="op" id="3953657">(</span><span class="ident" id="3953658">b</span>&nbsp;<span class="op" id="3953660">&amp;</span>&nbsp;<span class="num" id="3953662">0x7f</span><span class="op" id="3953666">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3953669">}</span>&nbsp;<span class="keyword" id="3953671">else</span>&nbsp;<span class="op" id="3953676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3953680">//&nbsp;Bottom&nbsp;7&nbsp;bits&nbsp;give&nbsp;the&nbsp;number&nbsp;of&nbsp;length&nbsp;bytes&nbsp;to&nbsp;follow.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953742">numBytes</span>&nbsp;<span class="op" id="3953751">:=</span>&nbsp;<span class="builtintype" id="3953754">int</span><span class="op" id="3953757">(</span><span class="ident" id="3953758">b</span>&nbsp;<span class="op" id="3953760">&amp;</span>&nbsp;<span class="num" id="3953762">0x7f</span><span class="op" id="3953766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3953770">if</span>&nbsp;<span class="ident" id="3953773">numBytes</span>&nbsp;<span class="op" id="3953782">==</span>&nbsp;<span class="num" id="3953785">0</span>&nbsp;<span class="op" id="3953787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953792">err</span>&nbsp;<span class="op" id="3953796">=</span>&nbsp;<span class="ident" id="3953798">SyntaxError</span><span class="op" id="3953809">{</span><span class="string" id="3953810">&#34;indefinite&nbsp;length&nbsp;found&nbsp;(not&nbsp;DER)&#34;</span><span class="op" id="3953845">}</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3953850">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3953859">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953863">ret</span><span class="op" id="3953866">.</span><span class="ident" id="3953867">length</span>&nbsp;<span class="op" id="3953874">=</span>&nbsp;<span class="num" id="3953876">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3953880">for</span>&nbsp;<span class="ident" id="3953884">i</span>&nbsp;<span class="op" id="3953886">:=</span>&nbsp;<span class="num" id="3953889">0</span><span class="op" id="3953890">;</span>&nbsp;<span class="ident" id="3953892">i</span>&nbsp;<span class="op" id="3953894">&lt;</span>&nbsp;<span class="ident" id="3953896">numBytes</span><span class="op" id="3953904">;</span>&nbsp;<span class="ident" id="3953906">i</span><span class="op" id="3953907">++</span>&nbsp;<span class="op" id="3953910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3953915">if</span>&nbsp;<span class="ident" id="3953918">offset</span>&nbsp;<span class="op" id="3953925">&gt;=</span>&nbsp;<span class="builtinfunc" id="3953928">len</span><span class="op" id="3953931">(</span><span class="ident" id="3953932">bytes</span><span class="op" id="3953937">)</span>&nbsp;<span class="op" id="3953939">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953945">err</span>&nbsp;<span class="op" id="3953949">=</span>&nbsp;<span class="ident" id="3953951">SyntaxError</span><span class="op" id="3953962">{</span><span class="string" id="3953963">&#34;truncated&nbsp;tag&nbsp;or&nbsp;length&#34;</span><span class="op" id="3953988">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3953994">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3954004">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954009">b</span>&nbsp;<span class="op" id="3954011">=</span>&nbsp;<span class="ident" id="3954013">bytes</span><span class="op" id="3954018">[</span><span class="ident" id="3954019">offset</span><span class="op" id="3954025">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954030">offset</span><span class="op" id="3954036">++</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3954042">if</span>&nbsp;<span class="ident" id="3954045">ret</span><span class="op" id="3954048">.</span><span class="ident" id="3954049">length</span>&nbsp;<span class="op" id="3954056">&gt;=</span>&nbsp;<span class="num" id="3954059">1</span><span class="op" id="3954060">&lt;&lt;</span><span class="num" id="3954062">23</span>&nbsp;<span class="op" id="3954065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3954071">//&nbsp;We&nbsp;can&#39;t&nbsp;shift&nbsp;ret.length&nbsp;up&nbsp;without</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3954115">//&nbsp;overflowing.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954135">err</span>&nbsp;<span class="op" id="3954139">=</span>&nbsp;<span class="ident" id="3954141">StructuralError</span><span class="op" id="3954156">{</span><span class="string" id="3954157">&#34;length&nbsp;too&nbsp;large&#34;</span><span class="op" id="3954175">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3954181">return</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3954191">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954196">ret</span><span class="op" id="3954199">.</span><span class="ident" id="3954200">length</span>&nbsp;<span class="op" id="3954207">&lt;&lt;=</span>&nbsp;<span class="num" id="3954211">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954216">ret</span><span class="op" id="3954219">.</span><span class="ident" id="3954220">length</span>&nbsp;<span class="op" id="3954227">|=</span>&nbsp;<span class="builtintype" id="3954230">int</span><span class="op" id="3954233">(</span><span class="ident" id="3954234">b</span><span class="op" id="3954235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3954240">if</span>&nbsp;<span class="ident" id="3954243">ret</span><span class="op" id="3954246">.</span><span class="ident" id="3954247">length</span>&nbsp;<span class="op" id="3954254">==</span>&nbsp;<span class="num" id="3954257">0</span>&nbsp;<span class="op" id="3954259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3954265">//&nbsp;DER&nbsp;requires&nbsp;that&nbsp;lengths&nbsp;be&nbsp;minimal.</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954310">err</span>&nbsp;<span class="op" id="3954314">=</span>&nbsp;<span class="ident" id="3954316">StructuralError</span><span class="op" id="3954331">{</span><span class="string" id="3954332">&#34;superfluous&nbsp;leading&nbsp;zeros&nbsp;in&nbsp;length&#34;</span><span class="op" id="3954369">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3954375">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3954385">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3954389">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3954392">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3954396">return</span><br>
<span class="lineno"></span><span class="op" id="3954403">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3954406">//&nbsp;parseSequenceOf&nbsp;is&nbsp;used&nbsp;for&nbsp;SEQUENCE&nbsp;OF&nbsp;and&nbsp;SET&nbsp;OF&nbsp;values.&nbsp;It&nbsp;tries&nbsp;to&nbsp;parse</span><br>
<span class="lineno">450</span><span class="comment" id="3954486">//&nbsp;a&nbsp;number&nbsp;of&nbsp;ASN.1&nbsp;values&nbsp;from&nbsp;the&nbsp;given&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;them&nbsp;as&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3954562">//&nbsp;slice&nbsp;of&nbsp;Go&nbsp;values&nbsp;of&nbsp;the&nbsp;given&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="3954603">func</span>&nbsp;<span class="ident" id="3954608">parseSequenceOf</span><span class="op" id="3954623">(</span><span class="ident" id="3954624">bytes</span>&nbsp;<span class="op" id="3954630">[</span><span class="op" id="3954631">]</span><span class="builtintype" id="3954632">byte</span><span class="op" id="3954636">,</span>&nbsp;<span class="ident" id="3954638">sliceType</span>&nbsp;<span class="ident" id="3954648">reflect</span><span class="op" id="3954655">.</span><span class="ident" id="3954656">Type</span><span class="op" id="3954660">,</span>&nbsp;<span class="ident" id="3954662">elemType</span>&nbsp;<span class="ident" id="3954671">reflect</span><span class="op" id="3954678">.</span><span class="ident" id="3954679">Type</span><span class="op" id="3954683">)</span>&nbsp;<span class="op" id="3954685">(</span><span class="ident" id="3954686">ret</span>&nbsp;<span class="ident" id="3954690">reflect</span><span class="op" id="3954697">.</span><span class="ident" id="3954698">Value</span><span class="op" id="3954703">,</span>&nbsp;<span class="ident" id="3954705">err</span>&nbsp;<span class="builtintype" id="3954709">error</span><span class="op" id="3954714">)</span>&nbsp;<span class="op" id="3954716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954719">expectedTag</span><span class="op" id="3954730">,</span>&nbsp;<span class="ident" id="3954732">compoundType</span><span class="op" id="3954744">,</span>&nbsp;<span class="ident" id="3954746">ok</span>&nbsp;<span class="op" id="3954749">:=</span>&nbsp;<span class="ident" id="3954752">getUniversalType</span><span class="op" id="3954768">(</span><span class="ident" id="3954769">elemType</span><span class="op" id="3954777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3954780">if</span>&nbsp;<span class="op" id="3954783">!</span><span class="ident" id="3954784">ok</span>&nbsp;<span class="op" id="3954787">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954791">err</span>&nbsp;<span class="op" id="3954795">=</span>&nbsp;<span class="ident" id="3954797">StructuralError</span><span class="op" id="3954812">{</span><span class="string" id="3954813">&#34;unknown&nbsp;Go&nbsp;type&nbsp;for&nbsp;slice&#34;</span><span class="op" id="3954840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3954844">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3954852">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3954856">//&nbsp;First&nbsp;we&nbsp;iterate&nbsp;over&nbsp;the&nbsp;input&nbsp;and&nbsp;count&nbsp;the&nbsp;number&nbsp;of&nbsp;elements,</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3954926">//&nbsp;checking&nbsp;that&nbsp;the&nbsp;types&nbsp;are&nbsp;correct&nbsp;in&nbsp;each&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954980">numElements</span>&nbsp;<span class="op" id="3954992">:=</span>&nbsp;<span class="num" id="3954995">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3954998">for</span>&nbsp;<span class="ident" id="3955002">offset</span>&nbsp;<span class="op" id="3955009">:=</span>&nbsp;<span class="num" id="3955012">0</span><span class="op" id="3955013">;</span>&nbsp;<span class="ident" id="3955015">offset</span>&nbsp;<span class="op" id="3955022">&lt;</span>&nbsp;<span class="builtinfunc" id="3955024">len</span><span class="op" id="3955027">(</span><span class="ident" id="3955028">bytes</span><span class="op" id="3955033">)</span><span class="op" id="3955034">;</span>&nbsp;<span class="op" id="3955036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3955040">var</span>&nbsp;<span class="ident" id="3955044">t</span>&nbsp;<span class="ident" id="3955046">tagAndLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955061">t</span><span class="op" id="3955062">,</span>&nbsp;<span class="ident" id="3955064">offset</span><span class="op" id="3955070">,</span>&nbsp;<span class="ident" id="3955072">err</span>&nbsp;<span class="op" id="3955076">=</span>&nbsp;<span class="ident" id="3955078">parseTagAndLength</span><span class="op" id="3955095">(</span><span class="ident" id="3955096">bytes</span><span class="op" id="3955101">,</span>&nbsp;<span class="ident" id="3955103">offset</span><span class="op" id="3955109">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3955113">if</span>&nbsp;<span class="ident" id="3955116">err</span>&nbsp;<span class="op" id="3955120">!=</span>&nbsp;<span class="ident" id="3955123">nil</span>&nbsp;<span class="op" id="3955127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3955132">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3955141">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3955145">switch</span>&nbsp;<span class="ident" id="3955152">t</span><span class="op" id="3955153">.</span><span class="ident" id="3955154">tag</span>&nbsp;<span class="op" id="3955158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3955162">case</span>&nbsp;<span class="ident" id="3955167">tagIA5String</span><span class="op" id="3955179">,</span>&nbsp;<span class="ident" id="3955181">tagGeneralString</span><span class="op" id="3955197">,</span>&nbsp;<span class="ident" id="3955199">tagT61String</span><span class="op" id="3955211">,</span>&nbsp;<span class="ident" id="3955213">tagUTF8String</span><span class="op" id="3955226">:</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3955231">//&nbsp;We&nbsp;pretend&nbsp;that&nbsp;various&nbsp;other&nbsp;string&nbsp;types&nbsp;are</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3955284">//&nbsp;PRINTABLE&nbsp;STRINGs&nbsp;so&nbsp;that&nbsp;a&nbsp;sequence&nbsp;of&nbsp;them&nbsp;can&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3955342">//&nbsp;parsed&nbsp;into&nbsp;a&nbsp;[]string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955372">t</span><span class="op" id="3955373">.</span><span class="ident" id="3955374">tag</span>&nbsp;<span class="op" id="3955378">=</span>&nbsp;<span class="ident" id="3955380">tagPrintableString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3955401">case</span>&nbsp;<span class="ident" id="3955406">tagGeneralizedTime</span><span class="op" id="3955424">,</span>&nbsp;<span class="ident" id="3955426">tagUTCTime</span><span class="op" id="3955436">:</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3955441">//&nbsp;Likewise,&nbsp;both&nbsp;time&nbsp;types&nbsp;are&nbsp;treated&nbsp;the&nbsp;same.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955495">t</span><span class="op" id="3955496">.</span><span class="ident" id="3955497">tag</span>&nbsp;<span class="op" id="3955501">=</span>&nbsp;<span class="ident" id="3955503">tagUTCTime</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3955516">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3955521">if</span>&nbsp;<span class="ident" id="3955524">t</span><span class="op" id="3955525">.</span><span class="ident" id="3955526">class</span>&nbsp;<span class="op" id="3955532">!=</span>&nbsp;<span class="ident" id="3955535">classUniversal</span>&nbsp;<span class="op" id="3955550">||</span>&nbsp;<span class="ident" id="3955553">t</span><span class="op" id="3955554">.</span><span class="ident" id="3955555">isCompound</span>&nbsp;<span class="op" id="3955566">!=</span>&nbsp;<span class="ident" id="3955569">compoundType</span>&nbsp;<span class="op" id="3955582">||</span>&nbsp;<span class="ident" id="3955585">t</span><span class="op" id="3955586">.</span><span class="ident" id="3955587">tag</span>&nbsp;<span class="op" id="3955591">!=</span>&nbsp;<span class="ident" id="3955594">expectedTag</span>&nbsp;<span class="op" id="3955606">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955611">err</span>&nbsp;<span class="op" id="3955615">=</span>&nbsp;<span class="ident" id="3955617">StructuralError</span><span class="op" id="3955632">{</span><span class="string" id="3955633">&#34;sequence&nbsp;tag&nbsp;mismatch&#34;</span><span class="op" id="3955656">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3955661">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3955670">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3955674">if</span>&nbsp;<span class="ident" id="3955677">invalidLength</span><span class="op" id="3955690">(</span><span class="ident" id="3955691">offset</span><span class="op" id="3955697">,</span>&nbsp;<span class="ident" id="3955699">t</span><span class="op" id="3955700">.</span><span class="ident" id="3955701">length</span><span class="op" id="3955707">,</span>&nbsp;<span class="builtinfunc" id="3955709">len</span><span class="op" id="3955712">(</span><span class="ident" id="3955713">bytes</span><span class="op" id="3955718">)</span><span class="op" id="3955719">)</span>&nbsp;<span class="op" id="3955721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955726">err</span>&nbsp;<span class="op" id="3955730">=</span>&nbsp;<span class="ident" id="3955732">SyntaxError</span><span class="op" id="3955743">{</span><span class="string" id="3955744">&#34;truncated&nbsp;sequence&#34;</span><span class="op" id="3955764">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3955769">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3955778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955782">offset</span>&nbsp;<span class="op" id="3955789">+=</span>&nbsp;<span class="ident" id="3955792">t</span><span class="op" id="3955793">.</span><span class="ident" id="3955794">length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955803">numElements</span><span class="op" id="3955814">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3955818">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955821">ret</span>&nbsp;<span class="op" id="3955825">=</span>&nbsp;<span class="ident" id="3955827">reflect</span><span class="op" id="3955834">.</span><span class="ident" id="3955835">MakeSlice</span><span class="op" id="3955844">(</span><span class="ident" id="3955845">sliceType</span><span class="op" id="3955854">,</span>&nbsp;<span class="ident" id="3955856">numElements</span><span class="op" id="3955867">,</span>&nbsp;<span class="ident" id="3955869">numElements</span><span class="op" id="3955880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955883">params</span>&nbsp;<span class="op" id="3955890">:=</span>&nbsp;<span class="ident" id="3955893">fieldParameters</span><span class="op" id="3955908">{</span><span class="op" id="3955909">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955912">offset</span>&nbsp;<span class="op" id="3955919">:=</span>&nbsp;<span class="num" id="3955922">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3955925">for</span>&nbsp;<span class="ident" id="3955929">i</span>&nbsp;<span class="op" id="3955931">:=</span>&nbsp;<span class="num" id="3955934">0</span><span class="op" id="3955935">;</span>&nbsp;<span class="ident" id="3955937">i</span>&nbsp;<span class="op" id="3955939">&lt;</span>&nbsp;<span class="ident" id="3955941">numElements</span><span class="op" id="3955952">;</span>&nbsp;<span class="ident" id="3955954">i</span><span class="op" id="3955955">++</span>&nbsp;<span class="op" id="3955958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955962">offset</span><span class="op" id="3955968">,</span>&nbsp;<span class="ident" id="3955970">err</span>&nbsp;<span class="op" id="3955974">=</span>&nbsp;<span class="ident" id="3955976">parseField</span><span class="op" id="3955986">(</span><span class="ident" id="3955987">ret</span><span class="op" id="3955990">.</span><span class="ident" id="3955991">Index</span><span class="op" id="3955996">(</span><span class="ident" id="3955997">i</span><span class="op" id="3955998">)</span><span class="op" id="3955999">,</span>&nbsp;<span class="ident" id="3956001">bytes</span><span class="op" id="3956006">,</span>&nbsp;<span class="ident" id="3956008">offset</span><span class="op" id="3956014">,</span>&nbsp;<span class="ident" id="3956016">params</span><span class="op" id="3956022">)</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3956026">if</span>&nbsp;<span class="ident" id="3956029">err</span>&nbsp;<span class="op" id="3956033">!=</span>&nbsp;<span class="ident" id="3956036">nil</span>&nbsp;<span class="op" id="3956040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3956045">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3956054">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3956057">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3956060">return</span><br>
<span class="lineno">500</span><span class="op" id="3956067">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3956070">var</span>&nbsp;<span class="op" id="3956074">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956077">bitStringType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3956098">=</span>&nbsp;<span class="ident" id="3956100">reflect</span><span class="op" id="3956107">.</span><span class="ident" id="3956108">TypeOf</span><span class="op" id="3956114">(</span><span class="ident" id="3956115">BitString</span><span class="op" id="3956124">{</span><span class="op" id="3956125">}</span><span class="op" id="3956126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956129">objectIdentifierType</span>&nbsp;<span class="op" id="3956150">=</span>&nbsp;<span class="ident" id="3956152">reflect</span><span class="op" id="3956159">.</span><span class="ident" id="3956160">TypeOf</span><span class="op" id="3956166">(</span><span class="ident" id="3956167">ObjectIdentifier</span><span class="op" id="3956183">{</span><span class="op" id="3956184">}</span><span class="op" id="3956185">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956188">enumeratedType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3956209">=</span>&nbsp;<span class="ident" id="3956211">reflect</span><span class="op" id="3956218">.</span><span class="ident" id="3956219">TypeOf</span><span class="op" id="3956225">(</span><span class="ident" id="3956226">Enumerated</span><span class="op" id="3956236">(</span><span class="num" id="3956237">0</span><span class="op" id="3956238">)</span><span class="op" id="3956239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956242">flagType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3956263">=</span>&nbsp;<span class="ident" id="3956265">reflect</span><span class="op" id="3956272">.</span><span class="ident" id="3956273">TypeOf</span><span class="op" id="3956279">(</span><span class="ident" id="3956280">Flag</span><span class="op" id="3956284">(</span><span class="builtintype" id="3956285">false</span><span class="op" id="3956290">)</span><span class="op" id="3956291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956294">timeType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3956315">=</span>&nbsp;<span class="ident" id="3956317">reflect</span><span class="op" id="3956324">.</span><span class="ident" id="3956325">TypeOf</span><span class="op" id="3956331">(</span><span class="ident" id="3956332">time</span><span class="op" id="3956336">.</span><span class="ident" id="3956337">Time</span><span class="op" id="3956341">{</span><span class="op" id="3956342">}</span><span class="op" id="3956343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956346">rawValueType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3956367">=</span>&nbsp;<span class="ident" id="3956369">reflect</span><span class="op" id="3956376">.</span><span class="ident" id="3956377">TypeOf</span><span class="op" id="3956383">(</span><span class="ident" id="3956384">RawValue</span><span class="op" id="3956392">{</span><span class="op" id="3956393">}</span><span class="op" id="3956394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956397">rawContentsType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3956418">=</span>&nbsp;<span class="ident" id="3956420">reflect</span><span class="op" id="3956427">.</span><span class="ident" id="3956428">TypeOf</span><span class="op" id="3956434">(</span><span class="ident" id="3956435">RawContent</span><span class="op" id="3956445">(</span><span class="ident" id="3956446">nil</span><span class="op" id="3956449">)</span><span class="op" id="3956450">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956453">bigIntType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3956474">=</span>&nbsp;<span class="ident" id="3956476">reflect</span><span class="op" id="3956483">.</span><span class="ident" id="3956484">TypeOf</span><span class="op" id="3956490">(</span><span class="builtinfunc" id="3956491">new</span><span class="op" id="3956494">(</span><span class="ident" id="3956495">big</span><span class="op" id="3956498">.</span><span class="ident" id="3956499">Int</span><span class="op" id="3956502">)</span><span class="op" id="3956503">)</span><br>
<span class="lineno"></span><span class="op" id="3956505">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3956508">//&nbsp;invalidLength&nbsp;returns&nbsp;true&nbsp;iff&nbsp;offset&nbsp;+&nbsp;length&nbsp;&gt;&nbsp;sliceLength,&nbsp;or&nbsp;if&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3956583">//&nbsp;addition&nbsp;would&nbsp;overflow.</span><br>
<span class="lineno">515</span><span class="keyword" id="3956611">func</span>&nbsp;<span class="ident" id="3956616">invalidLength</span><span class="op" id="3956629">(</span><span class="ident" id="3956630">offset</span><span class="op" id="3956636">,</span>&nbsp;<span class="ident" id="3956638">length</span><span class="op" id="3956644">,</span>&nbsp;<span class="ident" id="3956646">sliceLength</span>&nbsp;<span class="builtintype" id="3956658">int</span><span class="op" id="3956661">)</span>&nbsp;<span class="builtintype" id="3956663">bool</span>&nbsp;<span class="op" id="3956668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3956671">return</span>&nbsp;<span class="ident" id="3956678">offset</span><span class="op" id="3956684">+</span><span class="ident" id="3956685">length</span>&nbsp;<span class="op" id="3956692">&lt;</span>&nbsp;<span class="ident" id="3956694">offset</span>&nbsp;<span class="op" id="3956701">||</span>&nbsp;<span class="ident" id="3956704">offset</span><span class="op" id="3956710">+</span><span class="ident" id="3956711">length</span>&nbsp;<span class="op" id="3956718">&gt;</span>&nbsp;<span class="ident" id="3956720">sliceLength</span><br>
<span class="lineno"></span><span class="op" id="3956732">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3956735">//&nbsp;parseField&nbsp;is&nbsp;the&nbsp;main&nbsp;parsing&nbsp;function.&nbsp;Given&nbsp;a&nbsp;byte&nbsp;slice&nbsp;and&nbsp;an&nbsp;offset</span><br>
<span class="lineno">520</span><span class="comment" id="3956812">//&nbsp;into&nbsp;the&nbsp;array,&nbsp;it&nbsp;will&nbsp;try&nbsp;to&nbsp;parse&nbsp;a&nbsp;suitable&nbsp;ASN.1&nbsp;value&nbsp;out&nbsp;and&nbsp;store&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="3956892">//&nbsp;in&nbsp;the&nbsp;given&nbsp;Value.</span><br>
<span class="lineno"></span><span class="keyword" id="3956915">func</span>&nbsp;<span class="ident" id="3956920">parseField</span><span class="op" id="3956930">(</span><span class="ident" id="3956931">v</span>&nbsp;<span class="ident" id="3956933">reflect</span><span class="op" id="3956940">.</span><span class="ident" id="3956941">Value</span><span class="op" id="3956946">,</span>&nbsp;<span class="ident" id="3956948">bytes</span>&nbsp;<span class="op" id="3956954">[</span><span class="op" id="3956955">]</span><span class="builtintype" id="3956956">byte</span><span class="op" id="3956960">,</span>&nbsp;<span class="ident" id="3956962">initOffset</span>&nbsp;<span class="builtintype" id="3956973">int</span><span class="op" id="3956976">,</span>&nbsp;<span class="ident" id="3956978">params</span>&nbsp;<span class="ident" id="3956985">fieldParameters</span><span class="op" id="3957000">)</span>&nbsp;<span class="op" id="3957002">(</span><span class="ident" id="3957003">offset</span>&nbsp;<span class="builtintype" id="3957010">int</span><span class="op" id="3957013">,</span>&nbsp;<span class="ident" id="3957015">err</span>&nbsp;<span class="builtintype" id="3957019">error</span><span class="op" id="3957024">)</span>&nbsp;<span class="op" id="3957026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957029">offset</span>&nbsp;<span class="op" id="3957036">=</span>&nbsp;<span class="ident" id="3957038">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957050">fieldType</span>&nbsp;<span class="op" id="3957060">:=</span>&nbsp;<span class="ident" id="3957063">v</span><span class="op" id="3957064">.</span><span class="ident" id="3957065">Type</span><span class="op" id="3957069">(</span><span class="op" id="3957070">)</span><br>
<span class="lineno">525</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3957074">//&nbsp;If&nbsp;we&nbsp;have&nbsp;run&nbsp;out&nbsp;of&nbsp;data,&nbsp;it&nbsp;may&nbsp;be&nbsp;that&nbsp;there&nbsp;are&nbsp;optional&nbsp;elements&nbsp;at&nbsp;the&nbsp;end.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957161">if</span>&nbsp;<span class="ident" id="3957164">offset</span>&nbsp;<span class="op" id="3957171">==</span>&nbsp;<span class="builtinfunc" id="3957174">len</span><span class="op" id="3957177">(</span><span class="ident" id="3957178">bytes</span><span class="op" id="3957183">)</span>&nbsp;<span class="op" id="3957185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957189">if</span>&nbsp;<span class="op" id="3957192">!</span><span class="ident" id="3957193">setDefaultValue</span><span class="op" id="3957208">(</span><span class="ident" id="3957209">v</span><span class="op" id="3957210">,</span>&nbsp;<span class="ident" id="3957212">params</span><span class="op" id="3957218">)</span>&nbsp;<span class="op" id="3957220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957225">err</span>&nbsp;<span class="op" id="3957229">=</span>&nbsp;<span class="ident" id="3957231">SyntaxError</span><span class="op" id="3957242">{</span><span class="string" id="3957243">&#34;sequence&nbsp;truncated&#34;</span><span class="op" id="3957263">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3957267">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957271">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3957279">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3957283">//&nbsp;Deal&nbsp;with&nbsp;raw&nbsp;values.</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957309">if</span>&nbsp;<span class="ident" id="3957312">fieldType</span>&nbsp;<span class="op" id="3957322">==</span>&nbsp;<span class="ident" id="3957325">rawValueType</span>&nbsp;<span class="op" id="3957338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957342">var</span>&nbsp;<span class="ident" id="3957346">t</span>&nbsp;<span class="ident" id="3957348">tagAndLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957363">t</span><span class="op" id="3957364">,</span>&nbsp;<span class="ident" id="3957366">offset</span><span class="op" id="3957372">,</span>&nbsp;<span class="ident" id="3957374">err</span>&nbsp;<span class="op" id="3957378">=</span>&nbsp;<span class="ident" id="3957380">parseTagAndLength</span><span class="op" id="3957397">(</span><span class="ident" id="3957398">bytes</span><span class="op" id="3957403">,</span>&nbsp;<span class="ident" id="3957405">offset</span><span class="op" id="3957411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957415">if</span>&nbsp;<span class="ident" id="3957418">err</span>&nbsp;<span class="op" id="3957422">!=</span>&nbsp;<span class="ident" id="3957425">nil</span>&nbsp;<span class="op" id="3957429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957434">return</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3957443">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957447">if</span>&nbsp;<span class="ident" id="3957450">invalidLength</span><span class="op" id="3957463">(</span><span class="ident" id="3957464">offset</span><span class="op" id="3957470">,</span>&nbsp;<span class="ident" id="3957472">t</span><span class="op" id="3957473">.</span><span class="ident" id="3957474">length</span><span class="op" id="3957480">,</span>&nbsp;<span class="builtinfunc" id="3957482">len</span><span class="op" id="3957485">(</span><span class="ident" id="3957486">bytes</span><span class="op" id="3957491">)</span><span class="op" id="3957492">)</span>&nbsp;<span class="op" id="3957494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957499">err</span>&nbsp;<span class="op" id="3957503">=</span>&nbsp;<span class="ident" id="3957505">SyntaxError</span><span class="op" id="3957516">{</span><span class="string" id="3957517">&#34;data&nbsp;truncated&#34;</span><span class="op" id="3957533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957538">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3957547">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957551">result</span>&nbsp;<span class="op" id="3957558">:=</span>&nbsp;<span class="ident" id="3957561">RawValue</span><span class="op" id="3957569">{</span><span class="ident" id="3957570">t</span><span class="op" id="3957571">.</span><span class="ident" id="3957572">class</span><span class="op" id="3957577">,</span>&nbsp;<span class="ident" id="3957579">t</span><span class="op" id="3957580">.</span><span class="ident" id="3957581">tag</span><span class="op" id="3957584">,</span>&nbsp;<span class="ident" id="3957586">t</span><span class="op" id="3957587">.</span><span class="ident" id="3957588">isCompound</span><span class="op" id="3957598">,</span>&nbsp;<span class="ident" id="3957600">bytes</span><span class="op" id="3957605">[</span><span class="ident" id="3957606">offset</span>&nbsp;<span class="op" id="3957613">:</span>&nbsp;<span class="ident" id="3957615">offset</span><span class="op" id="3957621">+</span><span class="ident" id="3957622">t</span><span class="op" id="3957623">.</span><span class="ident" id="3957624">length</span><span class="op" id="3957630">]</span><span class="op" id="3957631">,</span>&nbsp;<span class="ident" id="3957633">bytes</span><span class="op" id="3957638">[</span><span class="ident" id="3957639">initOffset</span>&nbsp;<span class="op" id="3957650">:</span>&nbsp;<span class="ident" id="3957652">offset</span><span class="op" id="3957658">+</span><span class="ident" id="3957659">t</span><span class="op" id="3957660">.</span><span class="ident" id="3957661">length</span><span class="op" id="3957667">]</span><span class="op" id="3957668">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957672">offset</span>&nbsp;<span class="op" id="3957679">+=</span>&nbsp;<span class="ident" id="3957682">t</span><span class="op" id="3957683">.</span><span class="ident" id="3957684">length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957693">v</span><span class="op" id="3957694">.</span><span class="ident" id="3957695">Set</span><span class="op" id="3957698">(</span><span class="ident" id="3957699">reflect</span><span class="op" id="3957706">.</span><span class="ident" id="3957707">ValueOf</span><span class="op" id="3957714">(</span><span class="ident" id="3957715">result</span><span class="op" id="3957721">)</span><span class="op" id="3957722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957726">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3957734">}</span><br>
<span class="lineno">550</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3957738">//&nbsp;Deal&nbsp;with&nbsp;the&nbsp;ANY&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957766">if</span>&nbsp;<span class="ident" id="3957769">ifaceType</span>&nbsp;<span class="op" id="3957779">:=</span>&nbsp;<span class="ident" id="3957782">fieldType</span><span class="op" id="3957791">;</span>&nbsp;<span class="ident" id="3957793">ifaceType</span><span class="op" id="3957802">.</span><span class="ident" id="3957803">Kind</span><span class="op" id="3957807">(</span><span class="op" id="3957808">)</span>&nbsp;<span class="op" id="3957810">==</span>&nbsp;<span class="ident" id="3957813">reflect</span><span class="op" id="3957820">.</span><span class="ident" id="3957821">Interface</span>&nbsp;<span class="op" id="3957831">&amp;&amp;</span>&nbsp;<span class="ident" id="3957834">ifaceType</span><span class="op" id="3957843">.</span><span class="ident" id="3957844">NumMethod</span><span class="op" id="3957853">(</span><span class="op" id="3957854">)</span>&nbsp;<span class="op" id="3957856">==</span>&nbsp;<span class="num" id="3957859">0</span>&nbsp;<span class="op" id="3957861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957865">var</span>&nbsp;<span class="ident" id="3957869">t</span>&nbsp;<span class="ident" id="3957871">tagAndLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957886">t</span><span class="op" id="3957887">,</span>&nbsp;<span class="ident" id="3957889">offset</span><span class="op" id="3957895">,</span>&nbsp;<span class="ident" id="3957897">err</span>&nbsp;<span class="op" id="3957901">=</span>&nbsp;<span class="ident" id="3957903">parseTagAndLength</span><span class="op" id="3957920">(</span><span class="ident" id="3957921">bytes</span><span class="op" id="3957926">,</span>&nbsp;<span class="ident" id="3957928">offset</span><span class="op" id="3957934">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957938">if</span>&nbsp;<span class="ident" id="3957941">err</span>&nbsp;<span class="op" id="3957945">!=</span>&nbsp;<span class="ident" id="3957948">nil</span>&nbsp;<span class="op" id="3957952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957957">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3957966">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957970">if</span>&nbsp;<span class="ident" id="3957973">invalidLength</span><span class="op" id="3957986">(</span><span class="ident" id="3957987">offset</span><span class="op" id="3957993">,</span>&nbsp;<span class="ident" id="3957995">t</span><span class="op" id="3957996">.</span><span class="ident" id="3957997">length</span><span class="op" id="3958003">,</span>&nbsp;<span class="builtinfunc" id="3958005">len</span><span class="op" id="3958008">(</span><span class="ident" id="3958009">bytes</span><span class="op" id="3958014">)</span><span class="op" id="3958015">)</span>&nbsp;<span class="op" id="3958017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3958022">err</span>&nbsp;<span class="op" id="3958026">=</span>&nbsp;<span class="ident" id="3958028">SyntaxError</span><span class="op" id="3958039">{</span><span class="string" id="3958040">&#34;data&nbsp;truncated&#34;</span><span class="op" id="3958056">}</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958061">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3958070">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958074">var</span>&nbsp;<span class="ident" id="3958078">result</span>&nbsp;<span class="keyword" id="3958085">interface</span><span class="op" id="3958094">{</span><span class="op" id="3958095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958099">if</span>&nbsp;<span class="op" id="3958102">!</span><span class="ident" id="3958103">t</span><span class="op" id="3958104">.</span><span class="ident" id="3958105">isCompound</span>&nbsp;<span class="op" id="3958116">&amp;&amp;</span>&nbsp;<span class="ident" id="3958119">t</span><span class="op" id="3958120">.</span><span class="ident" id="3958121">class</span>&nbsp;<span class="op" id="3958127">==</span>&nbsp;<span class="ident" id="3958130">classUniversal</span>&nbsp;<span class="op" id="3958145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3958150">innerBytes</span>&nbsp;<span class="op" id="3958161">:=</span>&nbsp;<span class="ident" id="3958164">bytes</span><span class="op" id="3958169">[</span><span class="ident" id="3958170">offset</span>&nbsp;<span class="op" id="3958177">:</span>&nbsp;<span class="ident" id="3958179">offset</span><span class="op" id="3958185">+</span><span class="ident" id="3958186">t</span><span class="op" id="3958187">.</span><span class="ident" id="3958188">length</span><span class="op" id="3958194">]</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958199">switch</span>&nbsp;<span class="ident" id="3958206">t</span><span class="op" id="3958207">.</span><span class="ident" id="3958208">tag</span>&nbsp;<span class="op" id="3958212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958217">case</span>&nbsp;<span class="ident" id="3958222">tagPrintableString</span><span class="op" id="3958240">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3958246">result</span><span class="op" id="3958252">,</span>&nbsp;<span class="ident" id="3958254">err</span>&nbsp;<span class="op" id="3958258">=</span>&nbsp;<span class="ident" id="3958260">parsePrintableString</span><span class="op" id="3958280">(</span><span class="ident" id="3958281">innerBytes</span><span class="op" id="3958291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958296">case</span>&nbsp;<span class="ident" id="3958301">tagIA5String</span><span class="op" id="3958313">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3958319">result</span><span class="op" id="3958325">,</span>&nbsp;<span class="ident" id="3958327">err</span>&nbsp;<span class="op" id="3958331">=</span>&nbsp;<span class="ident" id="3958333">parseIA5String</span><span class="op" id="3958347">(</span><span class="ident" id="3958348">innerBytes</span><span class="op" id="3958358">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958363">case</span>&nbsp;<span class="ident" id="3958368">tagT61String</span><span class="op" id="3958380">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3958386">result</span><span class="op" id="3958392">,</span>&nbsp;<span class="ident" id="3958394">err</span>&nbsp;<span class="op" id="3958398">=</span>&nbsp;<span class="ident" id="3958400">parseT61String</span><span class="op" id="3958414">(</span><span class="ident" id="3958415">innerBytes</span><span class="op" id="3958425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958430">case</span>&nbsp;<span class="ident" id="3958435">tagUTF8String</span><span class="op" id="3958448">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3958454">result</span><span class="op" id="3958460">,</span>&nbsp;<span class="ident" id="3958462">err</span>&nbsp;<span class="op" id="3958466">=</span>&nbsp;<span class="ident" id="3958468">parseUTF8String</span><span class="op" id="3958483">(</span><span class="ident" id="3958484">innerBytes</span><span class="op" id="3958494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958499">case</span>&nbsp;<span class="ident" id="3958504">tagInteger</span><span class="op" id="3958514">:</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3958520">result</span><span class="op" id="3958526">,</span>&nbsp;<span class="ident" id="3958528">err</span>&nbsp;<span class="op" id="3958532">=</span>&nbsp;<span class="ident" id="3958534">parseInt64</span><span class="op" id="3958544">(</span><span class="ident" id="3958545">innerBytes</span><span class="op" id="3958555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958560">case</span>&nbsp;<span class="ident" id="3958565">tagBitString</span><span class="op" id="3958577">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3958583">result</span><span class="op" id="3958589">,</span>&nbsp;<span class="ident" id="3958591">err</span>&nbsp;<span class="op" id="3958595">=</span>&nbsp;<span class="ident" id="3958597">parseBitString</span><span class="op" id="3958611">(</span><span class="ident" id="3958612">innerBytes</span><span class="op" id="3958622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958627">case</span>&nbsp;<span class="ident" id="3958632">tagOID</span><span class="op" id="3958638">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3958644">result</span><span class="op" id="3958650">,</span>&nbsp;<span class="ident" id="3958652">err</span>&nbsp;<span class="op" id="3958656">=</span>&nbsp;<span class="ident" id="3958658">parseObjectIdentifier</span><span class="op" id="3958679">(</span><span class="ident" id="3958680">innerBytes</span><span class="op" id="3958690">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958695">case</span>&nbsp;<span class="ident" id="3958700">tagUTCTime</span><span class="op" id="3958710">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3958716">result</span><span class="op" id="3958722">,</span>&nbsp;<span class="ident" id="3958724">err</span>&nbsp;<span class="op" id="3958728">=</span>&nbsp;<span class="ident" id="3958730">parseUTCTime</span><span class="op" id="3958742">(</span><span class="ident" id="3958743">innerBytes</span><span class="op" id="3958753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958758">case</span>&nbsp;<span class="ident" id="3958763">tagOctetString</span><span class="op" id="3958777">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3958783">result</span>&nbsp;<span class="op" id="3958790">=</span>&nbsp;<span class="ident" id="3958792">innerBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958806">default</span><span class="op" id="3958813">:</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3958819">//&nbsp;If&nbsp;we&nbsp;don&#39;t&nbsp;know&nbsp;how&nbsp;to&nbsp;handle&nbsp;the&nbsp;type,&nbsp;we&nbsp;just&nbsp;leave&nbsp;Value&nbsp;as&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3958894">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3958898">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3958902">offset</span>&nbsp;<span class="op" id="3958909">+=</span>&nbsp;<span class="ident" id="3958912">t</span><span class="op" id="3958913">.</span><span class="ident" id="3958914">length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958923">if</span>&nbsp;<span class="ident" id="3958926">err</span>&nbsp;<span class="op" id="3958930">!=</span>&nbsp;<span class="ident" id="3958933">nil</span>&nbsp;<span class="op" id="3958937">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958942">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3958951">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958955">if</span>&nbsp;<span class="ident" id="3958958">result</span>&nbsp;<span class="op" id="3958965">!=</span>&nbsp;<span class="ident" id="3958968">nil</span>&nbsp;<span class="op" id="3958972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3958977">v</span><span class="op" id="3958978">.</span><span class="ident" id="3958979">Set</span><span class="op" id="3958982">(</span><span class="ident" id="3958983">reflect</span><span class="op" id="3958990">.</span><span class="ident" id="3958991">ValueOf</span><span class="op" id="3958998">(</span><span class="ident" id="3958999">result</span><span class="op" id="3959005">)</span><span class="op" id="3959006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3959010">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3959014">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3959022">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3959025">universalTag</span><span class="op" id="3959037">,</span>&nbsp;<span class="ident" id="3959039">compoundType</span><span class="op" id="3959051">,</span>&nbsp;<span class="ident" id="3959053">ok1</span>&nbsp;<span class="op" id="3959057">:=</span>&nbsp;<span class="ident" id="3959060">getUniversalType</span><span class="op" id="3959076">(</span><span class="ident" id="3959077">fieldType</span><span class="op" id="3959086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3959089">if</span>&nbsp;<span class="op" id="3959092">!</span><span class="ident" id="3959093">ok1</span>&nbsp;<span class="op" id="3959097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3959101">err</span>&nbsp;<span class="op" id="3959105">=</span>&nbsp;<span class="ident" id="3959107">StructuralError</span><span class="op" id="3959122">{</span><span class="ident" id="3959123">fmt</span><span class="op" id="3959126">.</span><span class="ident" id="3959127">Sprintf</span><span class="op" id="3959134">(</span><span class="string" id="3959135">&#34;unknown&nbsp;Go&nbsp;type:&nbsp;%v&#34;</span><span class="op" id="3959156">,</span>&nbsp;<span class="ident" id="3959158">fieldType</span><span class="op" id="3959167">)</span><span class="op" id="3959168">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3959172">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3959180">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3959184">t</span><span class="op" id="3959185">,</span>&nbsp;<span class="ident" id="3959187">offset</span><span class="op" id="3959193">,</span>&nbsp;<span class="ident" id="3959195">err</span>&nbsp;<span class="op" id="3959199">:=</span>&nbsp;<span class="ident" id="3959202">parseTagAndLength</span><span class="op" id="3959219">(</span><span class="ident" id="3959220">bytes</span><span class="op" id="3959225">,</span>&nbsp;<span class="ident" id="3959227">offset</span><span class="op" id="3959233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3959236">if</span>&nbsp;<span class="ident" id="3959239">err</span>&nbsp;<span class="op" id="3959243">!=</span>&nbsp;<span class="ident" id="3959246">nil</span>&nbsp;<span class="op" id="3959250">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3959254">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3959262">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3959265">if</span>&nbsp;<span class="ident" id="3959268">params</span><span class="op" id="3959274">.</span><span class="ident" id="3959275">explicit</span>&nbsp;<span class="op" id="3959284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3959288">expectedClass</span>&nbsp;<span class="op" id="3959302">:=</span>&nbsp;<span class="ident" id="3959305">classContextSpecific</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3959328">if</span>&nbsp;<span class="ident" id="3959331">params</span><span class="op" id="3959337">.</span><span class="ident" id="3959338">application</span>&nbsp;<span class="op" id="3959350">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3959355">expectedClass</span>&nbsp;<span class="op" id="3959369">=</span>&nbsp;<span class="ident" id="3959371">classApplication</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3959390">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3959394">if</span>&nbsp;<span class="ident" id="3959397">t</span><span class="op" id="3959398">.</span><span class="ident" id="3959399">class</span>&nbsp;<span class="op" id="3959405">==</span>&nbsp;<span class="ident" id="3959408">expectedClass</span>&nbsp;<span class="op" id="3959422">&amp;&amp;</span>&nbsp;<span class="ident" id="3959425">t</span><span class="op" id="3959426">.</span><span class="ident" id="3959427">tag</span>&nbsp;<span class="op" id="3959431">==</span>&nbsp;<span class="op" id="3959434">*</span><span class="ident" id="3959435">params</span><span class="op" id="3959441">.</span><span class="ident" id="3959442">tag</span>&nbsp;<span class="op" id="3959446">&amp;&amp;</span>&nbsp;<span class="op" id="3959449">(</span><span class="ident" id="3959450">t</span><span class="op" id="3959451">.</span><span class="ident" id="3959452">length</span>&nbsp;<span class="op" id="3959459">==</span>&nbsp;<span class="num" id="3959462">0</span>&nbsp;<span class="op" id="3959464">||</span>&nbsp;<span class="ident" id="3959467">t</span><span class="op" id="3959468">.</span><span class="ident" id="3959469">isCompound</span><span class="op" id="3959479">)</span>&nbsp;<span class="op" id="3959481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3959486">if</span>&nbsp;<span class="ident" id="3959489">t</span><span class="op" id="3959490">.</span><span class="ident" id="3959491">length</span>&nbsp;<span class="op" id="3959498">&gt;</span>&nbsp;<span class="num" id="3959500">0</span>&nbsp;<span class="op" id="3959502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3959508">t</span><span class="op" id="3959509">,</span>&nbsp;<span class="ident" id="3959511">offset</span><span class="op" id="3959517">,</span>&nbsp;<span class="ident" id="3959519">err</span>&nbsp;<span class="op" id="3959523">=</span>&nbsp;<span class="ident" id="3959525">parseTagAndLength</span><span class="op" id="3959542">(</span><span class="ident" id="3959543">bytes</span><span class="op" id="3959548">,</span>&nbsp;<span class="ident" id="3959550">offset</span><span class="op" id="3959556">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3959562">if</span>&nbsp;<span class="ident" id="3959565">err</span>&nbsp;<span class="op" id="3959569">!=</span>&nbsp;<span class="ident" id="3959572">nil</span>&nbsp;<span class="op" id="3959576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3959583">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3959594">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3959599">}</span>&nbsp;<span class="keyword" id="3959601">else</span>&nbsp;<span class="op" id="3959606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3959612">if</span>&nbsp;<span class="ident" id="3959615">fieldType</span>&nbsp;<span class="op" id="3959625">!=</span>&nbsp;<span class="ident" id="3959628">flagType</span>&nbsp;<span class="op" id="3959637">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3959644">err</span>&nbsp;<span class="op" id="3959648">=</span>&nbsp;<span class="ident" id="3959650">StructuralError</span><span class="op" id="3959665">{</span><span class="string" id="3959666">&#34;zero&nbsp;length&nbsp;explicit&nbsp;tag&nbsp;was&nbsp;not&nbsp;an&nbsp;asn1.Flag&#34;</span><span class="op" id="3959713">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3959720">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3959731">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3959737">v</span><span class="op" id="3959738">.</span><span class="ident" id="3959739">SetBool</span><span class="op" id="3959746">(</span><span class="builtintype" id="3959747">true</span><span class="op" id="3959751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3959757">return</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3959767">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3959771">}</span>&nbsp;<span class="keyword" id="3959773">else</span>&nbsp;<span class="op" id="3959778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3959783">//&nbsp;The&nbsp;tags&nbsp;didn&#39;t&nbsp;match,&nbsp;it&nbsp;might&nbsp;be&nbsp;an&nbsp;optional&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3959845">ok</span>&nbsp;<span class="op" id="3959848">:=</span>&nbsp;<span class="ident" id="3959851">setDefaultValue</span><span class="op" id="3959866">(</span><span class="ident" id="3959867">v</span><span class="op" id="3959868">,</span>&nbsp;<span class="ident" id="3959870">params</span><span class="op" id="3959876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3959881">if</span>&nbsp;<span class="ident" id="3959884">ok</span>&nbsp;<span class="op" id="3959887">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3959893">offset</span>&nbsp;<span class="op" id="3959900">=</span>&nbsp;<span class="ident" id="3959902">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3959916">}</span>&nbsp;<span class="keyword" id="3959918">else</span>&nbsp;<span class="op" id="3959923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3959929">err</span>&nbsp;<span class="op" id="3959933">=</span>&nbsp;<span class="ident" id="3959935">StructuralError</span><span class="op" id="3959950">{</span><span class="string" id="3959951">&#34;explicitly&nbsp;tagged&nbsp;member&nbsp;didn&#39;t&nbsp;match&#34;</span><span class="op" id="3959990">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3959995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3960000">return</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3960009">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3960012">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3960016">//&nbsp;Special&nbsp;case&nbsp;for&nbsp;strings:&nbsp;all&nbsp;the&nbsp;ASN.1&nbsp;string&nbsp;types&nbsp;map&nbsp;to&nbsp;the&nbsp;Go</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3960087">//&nbsp;type&nbsp;string.&nbsp;getUniversalType&nbsp;returns&nbsp;the&nbsp;tag&nbsp;for&nbsp;PrintableString</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3960157">//&nbsp;when&nbsp;it&nbsp;sees&nbsp;a&nbsp;string,&nbsp;so&nbsp;if&nbsp;we&nbsp;see&nbsp;a&nbsp;different&nbsp;string&nbsp;type&nbsp;on&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3960228">//&nbsp;wire,&nbsp;we&nbsp;change&nbsp;the&nbsp;universal&nbsp;type&nbsp;to&nbsp;match.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3960277">if</span>&nbsp;<span class="ident" id="3960280">universalTag</span>&nbsp;<span class="op" id="3960293">==</span>&nbsp;<span class="ident" id="3960296">tagPrintableString</span>&nbsp;<span class="op" id="3960315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3960319">if</span>&nbsp;<span class="ident" id="3960322">t</span><span class="op" id="3960323">.</span><span class="ident" id="3960324">class</span>&nbsp;<span class="op" id="3960330">==</span>&nbsp;<span class="ident" id="3960333">classUniversal</span>&nbsp;<span class="op" id="3960348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3960353">switch</span>&nbsp;<span class="ident" id="3960360">t</span><span class="op" id="3960361">.</span><span class="ident" id="3960362">tag</span>&nbsp;<span class="op" id="3960366">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3960371">case</span>&nbsp;<span class="ident" id="3960376">tagIA5String</span><span class="op" id="3960388">,</span>&nbsp;<span class="ident" id="3960390">tagGeneralString</span><span class="op" id="3960406">,</span>&nbsp;<span class="ident" id="3960408">tagT61String</span><span class="op" id="3960420">,</span>&nbsp;<span class="ident" id="3960422">tagUTF8String</span><span class="op" id="3960435">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960441">universalTag</span>&nbsp;<span class="op" id="3960454">=</span>&nbsp;<span class="ident" id="3960456">t</span><span class="op" id="3960457">.</span><span class="ident" id="3960458">tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3960465">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3960469">}</span>&nbsp;<span class="keyword" id="3960471">else</span>&nbsp;<span class="keyword" id="3960476">if</span>&nbsp;<span class="ident" id="3960479">params</span><span class="op" id="3960485">.</span><span class="ident" id="3960486">stringType</span>&nbsp;<span class="op" id="3960497">!=</span>&nbsp;<span class="num" id="3960500">0</span>&nbsp;<span class="op" id="3960502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960507">universalTag</span>&nbsp;<span class="op" id="3960520">=</span>&nbsp;<span class="ident" id="3960522">params</span><span class="op" id="3960528">.</span><span class="ident" id="3960529">stringType</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3960542">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3960545">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3960549">//&nbsp;Special&nbsp;case&nbsp;for&nbsp;time:&nbsp;UTCTime&nbsp;and&nbsp;GeneralizedTime&nbsp;both&nbsp;map&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3960620">//&nbsp;Go&nbsp;type&nbsp;time.Time.</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3960643">if</span>&nbsp;<span class="ident" id="3960646">universalTag</span>&nbsp;<span class="op" id="3960659">==</span>&nbsp;<span class="ident" id="3960662">tagUTCTime</span>&nbsp;<span class="op" id="3960673">&amp;&amp;</span>&nbsp;<span class="ident" id="3960676">t</span><span class="op" id="3960677">.</span><span class="ident" id="3960678">tag</span>&nbsp;<span class="op" id="3960682">==</span>&nbsp;<span class="ident" id="3960685">tagGeneralizedTime</span>&nbsp;<span class="op" id="3960704">&amp;&amp;</span>&nbsp;<span class="ident" id="3960707">t</span><span class="op" id="3960708">.</span><span class="ident" id="3960709">class</span>&nbsp;<span class="op" id="3960715">==</span>&nbsp;<span class="ident" id="3960718">classUniversal</span>&nbsp;<span class="op" id="3960733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960737">universalTag</span>&nbsp;<span class="op" id="3960750">=</span>&nbsp;<span class="ident" id="3960752">tagGeneralizedTime</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3960772">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3960776">if</span>&nbsp;<span class="ident" id="3960779">params</span><span class="op" id="3960785">.</span><span class="ident" id="3960786">set</span>&nbsp;<span class="op" id="3960790">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960794">universalTag</span>&nbsp;<span class="op" id="3960807">=</span>&nbsp;<span class="ident" id="3960809">tagSet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3960817">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960821">expectedClass</span>&nbsp;<span class="op" id="3960835">:=</span>&nbsp;<span class="ident" id="3960838">classUniversal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960854">expectedTag</span>&nbsp;<span class="op" id="3960866">:=</span>&nbsp;<span class="ident" id="3960869">universalTag</span><br>
<span class="lineno">665</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3960884">if</span>&nbsp;<span class="op" id="3960887">!</span><span class="ident" id="3960888">params</span><span class="op" id="3960894">.</span><span class="ident" id="3960895">explicit</span>&nbsp;<span class="op" id="3960904">&amp;&amp;</span>&nbsp;<span class="ident" id="3960907">params</span><span class="op" id="3960913">.</span><span class="ident" id="3960914">tag</span>&nbsp;<span class="op" id="3960918">!=</span>&nbsp;<span class="ident" id="3960921">nil</span>&nbsp;<span class="op" id="3960925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960929">expectedClass</span>&nbsp;<span class="op" id="3960943">=</span>&nbsp;<span class="ident" id="3960945">classContextSpecific</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3960968">expectedTag</span>&nbsp;<span class="op" id="3960980">=</span>&nbsp;<span class="op" id="3960982">*</span><span class="ident" id="3960983">params</span><span class="op" id="3960989">.</span><span class="ident" id="3960990">tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3960995">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3960999">if</span>&nbsp;<span class="op" id="3961002">!</span><span class="ident" id="3961003">params</span><span class="op" id="3961009">.</span><span class="ident" id="3961010">explicit</span>&nbsp;<span class="op" id="3961019">&amp;&amp;</span>&nbsp;<span class="ident" id="3961022">params</span><span class="op" id="3961028">.</span><span class="ident" id="3961029">application</span>&nbsp;<span class="op" id="3961041">&amp;&amp;</span>&nbsp;<span class="ident" id="3961044">params</span><span class="op" id="3961050">.</span><span class="ident" id="3961051">tag</span>&nbsp;<span class="op" id="3961055">!=</span>&nbsp;<span class="ident" id="3961058">nil</span>&nbsp;<span class="op" id="3961062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961066">expectedClass</span>&nbsp;<span class="op" id="3961080">=</span>&nbsp;<span class="ident" id="3961082">classApplication</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961101">expectedTag</span>&nbsp;<span class="op" id="3961113">=</span>&nbsp;<span class="op" id="3961115">*</span><span class="ident" id="3961116">params</span><span class="op" id="3961122">.</span><span class="ident" id="3961123">tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3961128">}</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3961132">//&nbsp;We&nbsp;have&nbsp;unwrapped&nbsp;any&nbsp;explicit&nbsp;tagging&nbsp;at&nbsp;this&nbsp;point.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3961190">if</span>&nbsp;<span class="ident" id="3961193">t</span><span class="op" id="3961194">.</span><span class="ident" id="3961195">class</span>&nbsp;<span class="op" id="3961201">!=</span>&nbsp;<span class="ident" id="3961204">expectedClass</span>&nbsp;<span class="op" id="3961218">||</span>&nbsp;<span class="ident" id="3961221">t</span><span class="op" id="3961222">.</span><span class="ident" id="3961223">tag</span>&nbsp;<span class="op" id="3961227">!=</span>&nbsp;<span class="ident" id="3961230">expectedTag</span>&nbsp;<span class="op" id="3961242">||</span>&nbsp;<span class="ident" id="3961245">t</span><span class="op" id="3961246">.</span><span class="ident" id="3961247">isCompound</span>&nbsp;<span class="op" id="3961258">!=</span>&nbsp;<span class="ident" id="3961261">compoundType</span>&nbsp;<span class="op" id="3961274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3961278">//&nbsp;Tags&nbsp;don&#39;t&nbsp;match.&nbsp;Again,&nbsp;it&nbsp;could&nbsp;be&nbsp;an&nbsp;optional&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961341">ok</span>&nbsp;<span class="op" id="3961344">:=</span>&nbsp;<span class="ident" id="3961347">setDefaultValue</span><span class="op" id="3961362">(</span><span class="ident" id="3961363">v</span><span class="op" id="3961364">,</span>&nbsp;<span class="ident" id="3961366">params</span><span class="op" id="3961372">)</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3961376">if</span>&nbsp;<span class="ident" id="3961379">ok</span>&nbsp;<span class="op" id="3961382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961387">offset</span>&nbsp;<span class="op" id="3961394">=</span>&nbsp;<span class="ident" id="3961396">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3961409">}</span>&nbsp;<span class="keyword" id="3961411">else</span>&nbsp;<span class="op" id="3961416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961421">err</span>&nbsp;<span class="op" id="3961425">=</span>&nbsp;<span class="ident" id="3961427">StructuralError</span><span class="op" id="3961442">{</span><span class="ident" id="3961443">fmt</span><span class="op" id="3961446">.</span><span class="ident" id="3961447">Sprintf</span><span class="op" id="3961454">(</span><span class="string" id="3961455">&#34;tags&nbsp;don&#39;t&nbsp;match&nbsp;(%d&nbsp;vs&nbsp;%+v)&nbsp;%+v&nbsp;%s&nbsp;@%d&#34;</span><span class="op" id="3961496">,</span>&nbsp;<span class="ident" id="3961498">expectedTag</span><span class="op" id="3961509">,</span>&nbsp;<span class="ident" id="3961511">t</span><span class="op" id="3961512">,</span>&nbsp;<span class="ident" id="3961514">params</span><span class="op" id="3961520">,</span>&nbsp;<span class="ident" id="3961522">fieldType</span><span class="op" id="3961531">.</span><span class="ident" id="3961532">Name</span><span class="op" id="3961536">(</span><span class="op" id="3961537">)</span><span class="op" id="3961538">,</span>&nbsp;<span class="ident" id="3961540">offset</span><span class="op" id="3961546">)</span><span class="op" id="3961547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3961551">}</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3961555">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3961563">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3961566">if</span>&nbsp;<span class="ident" id="3961569">invalidLength</span><span class="op" id="3961582">(</span><span class="ident" id="3961583">offset</span><span class="op" id="3961589">,</span>&nbsp;<span class="ident" id="3961591">t</span><span class="op" id="3961592">.</span><span class="ident" id="3961593">length</span><span class="op" id="3961599">,</span>&nbsp;<span class="builtinfunc" id="3961601">len</span><span class="op" id="3961604">(</span><span class="ident" id="3961605">bytes</span><span class="op" id="3961610">)</span><span class="op" id="3961611">)</span>&nbsp;<span class="op" id="3961613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961617">err</span>&nbsp;<span class="op" id="3961621">=</span>&nbsp;<span class="ident" id="3961623">SyntaxError</span><span class="op" id="3961634">{</span><span class="string" id="3961635">&#34;data&nbsp;truncated&#34;</span><span class="op" id="3961651">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3961655">return</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3961663">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961666">innerBytes</span>&nbsp;<span class="op" id="3961677">:=</span>&nbsp;<span class="ident" id="3961680">bytes</span><span class="op" id="3961685">[</span><span class="ident" id="3961686">offset</span>&nbsp;<span class="op" id="3961693">:</span>&nbsp;<span class="ident" id="3961695">offset</span><span class="op" id="3961701">+</span><span class="ident" id="3961702">t</span><span class="op" id="3961703">.</span><span class="ident" id="3961704">length</span><span class="op" id="3961710">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961713">offset</span>&nbsp;<span class="op" id="3961720">+=</span>&nbsp;<span class="ident" id="3961723">t</span><span class="op" id="3961724">.</span><span class="ident" id="3961725">length</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3961734">//&nbsp;We&nbsp;deal&nbsp;with&nbsp;the&nbsp;structures&nbsp;defined&nbsp;in&nbsp;this&nbsp;package&nbsp;first.</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3961797">switch</span>&nbsp;<span class="ident" id="3961804">fieldType</span>&nbsp;<span class="op" id="3961814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3961817">case</span>&nbsp;<span class="ident" id="3961822">objectIdentifierType</span><span class="op" id="3961842">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961846">newSlice</span><span class="op" id="3961854">,</span>&nbsp;<span class="ident" id="3961856">err1</span>&nbsp;<span class="op" id="3961861">:=</span>&nbsp;<span class="ident" id="3961864">parseObjectIdentifier</span><span class="op" id="3961885">(</span><span class="ident" id="3961886">innerBytes</span><span class="op" id="3961896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961900">v</span><span class="op" id="3961901">.</span><span class="ident" id="3961902">Set</span><span class="op" id="3961905">(</span><span class="ident" id="3961906">reflect</span><span class="op" id="3961913">.</span><span class="ident" id="3961914">MakeSlice</span><span class="op" id="3961923">(</span><span class="ident" id="3961924">v</span><span class="op" id="3961925">.</span><span class="ident" id="3961926">Type</span><span class="op" id="3961930">(</span><span class="op" id="3961931">)</span><span class="op" id="3961932">,</span>&nbsp;<span class="builtinfunc" id="3961934">len</span><span class="op" id="3961937">(</span><span class="ident" id="3961938">newSlice</span><span class="op" id="3961946">)</span><span class="op" id="3961947">,</span>&nbsp;<span class="builtinfunc" id="3961949">len</span><span class="op" id="3961952">(</span><span class="ident" id="3961953">newSlice</span><span class="op" id="3961961">)</span><span class="op" id="3961962">)</span><span class="op" id="3961963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3961967">if</span>&nbsp;<span class="ident" id="3961970">err1</span>&nbsp;<span class="op" id="3961975">==</span>&nbsp;<span class="ident" id="3961978">nil</span>&nbsp;<span class="op" id="3961982">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3961987">reflect</span><span class="op" id="3961994">.</span><span class="ident" id="3961995">Copy</span><span class="op" id="3961999">(</span><span class="ident" id="3962000">v</span><span class="op" id="3962001">,</span>&nbsp;<span class="ident" id="3962003">reflect</span><span class="op" id="3962010">.</span><span class="ident" id="3962011">ValueOf</span><span class="op" id="3962018">(</span><span class="ident" id="3962019">newSlice</span><span class="op" id="3962027">)</span><span class="op" id="3962028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3962032">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962036">err</span>&nbsp;<span class="op" id="3962040">=</span>&nbsp;<span class="ident" id="3962042">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962049">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962057">case</span>&nbsp;<span class="ident" id="3962062">bitStringType</span><span class="op" id="3962075">:</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962079">bs</span><span class="op" id="3962081">,</span>&nbsp;<span class="ident" id="3962083">err1</span>&nbsp;<span class="op" id="3962088">:=</span>&nbsp;<span class="ident" id="3962091">parseBitString</span><span class="op" id="3962105">(</span><span class="ident" id="3962106">innerBytes</span><span class="op" id="3962116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962120">if</span>&nbsp;<span class="ident" id="3962123">err1</span>&nbsp;<span class="op" id="3962128">==</span>&nbsp;<span class="ident" id="3962131">nil</span>&nbsp;<span class="op" id="3962135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962140">v</span><span class="op" id="3962141">.</span><span class="ident" id="3962142">Set</span><span class="op" id="3962145">(</span><span class="ident" id="3962146">reflect</span><span class="op" id="3962153">.</span><span class="ident" id="3962154">ValueOf</span><span class="op" id="3962161">(</span><span class="ident" id="3962162">bs</span><span class="op" id="3962164">)</span><span class="op" id="3962165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3962169">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962173">err</span>&nbsp;<span class="op" id="3962177">=</span>&nbsp;<span class="ident" id="3962179">err1</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962186">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962194">case</span>&nbsp;<span class="ident" id="3962199">timeType</span><span class="op" id="3962207">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962211">var</span>&nbsp;<span class="ident" id="3962215">time</span>&nbsp;<span class="ident" id="3962220">time</span><span class="op" id="3962224">.</span><span class="ident" id="3962225">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962232">var</span>&nbsp;<span class="ident" id="3962236">err1</span>&nbsp;<span class="builtintype" id="3962241">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962249">if</span>&nbsp;<span class="ident" id="3962252">universalTag</span>&nbsp;<span class="op" id="3962265">==</span>&nbsp;<span class="ident" id="3962268">tagUTCTime</span>&nbsp;<span class="op" id="3962279">{</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962284">time</span><span class="op" id="3962288">,</span>&nbsp;<span class="ident" id="3962290">err1</span>&nbsp;<span class="op" id="3962295">=</span>&nbsp;<span class="ident" id="3962297">parseUTCTime</span><span class="op" id="3962309">(</span><span class="ident" id="3962310">innerBytes</span><span class="op" id="3962320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3962324">}</span>&nbsp;<span class="keyword" id="3962326">else</span>&nbsp;<span class="op" id="3962331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962336">time</span><span class="op" id="3962340">,</span>&nbsp;<span class="ident" id="3962342">err1</span>&nbsp;<span class="op" id="3962347">=</span>&nbsp;<span class="ident" id="3962349">parseGeneralizedTime</span><span class="op" id="3962369">(</span><span class="ident" id="3962370">innerBytes</span><span class="op" id="3962380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3962384">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962388">if</span>&nbsp;<span class="ident" id="3962391">err1</span>&nbsp;<span class="op" id="3962396">==</span>&nbsp;<span class="ident" id="3962399">nil</span>&nbsp;<span class="op" id="3962403">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962408">v</span><span class="op" id="3962409">.</span><span class="ident" id="3962410">Set</span><span class="op" id="3962413">(</span><span class="ident" id="3962414">reflect</span><span class="op" id="3962421">.</span><span class="ident" id="3962422">ValueOf</span><span class="op" id="3962429">(</span><span class="ident" id="3962430">time</span><span class="op" id="3962434">)</span><span class="op" id="3962435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3962439">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962443">err</span>&nbsp;<span class="op" id="3962447">=</span>&nbsp;<span class="ident" id="3962449">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962456">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962464">case</span>&nbsp;<span class="ident" id="3962469">enumeratedType</span><span class="op" id="3962483">:</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962487">parsedInt</span><span class="op" id="3962496">,</span>&nbsp;<span class="ident" id="3962498">err1</span>&nbsp;<span class="op" id="3962503">:=</span>&nbsp;<span class="ident" id="3962506">parseInt32</span><span class="op" id="3962516">(</span><span class="ident" id="3962517">innerBytes</span><span class="op" id="3962527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962531">if</span>&nbsp;<span class="ident" id="3962534">err1</span>&nbsp;<span class="op" id="3962539">==</span>&nbsp;<span class="ident" id="3962542">nil</span>&nbsp;<span class="op" id="3962546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962551">v</span><span class="op" id="3962552">.</span><span class="ident" id="3962553">SetInt</span><span class="op" id="3962559">(</span><span class="ident" id="3962560">int64</span><span class="op" id="3962565">(</span><span class="ident" id="3962566">parsedInt</span><span class="op" id="3962575">)</span><span class="op" id="3962576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3962580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962584">err</span>&nbsp;<span class="op" id="3962588">=</span>&nbsp;<span class="ident" id="3962590">err1</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962597">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962605">case</span>&nbsp;<span class="ident" id="3962610">flagType</span><span class="op" id="3962618">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962622">v</span><span class="op" id="3962623">.</span><span class="ident" id="3962624">SetBool</span><span class="op" id="3962631">(</span><span class="builtintype" id="3962632">true</span><span class="op" id="3962636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962640">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962648">case</span>&nbsp;<span class="ident" id="3962653">bigIntType</span><span class="op" id="3962663">:</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962667">parsedInt</span>&nbsp;<span class="op" id="3962677">:=</span>&nbsp;<span class="ident" id="3962680">parseBigInt</span><span class="op" id="3962691">(</span><span class="ident" id="3962692">innerBytes</span><span class="op" id="3962702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962706">v</span><span class="op" id="3962707">.</span><span class="ident" id="3962708">Set</span><span class="op" id="3962711">(</span><span class="ident" id="3962712">reflect</span><span class="op" id="3962719">.</span><span class="ident" id="3962720">ValueOf</span><span class="op" id="3962727">(</span><span class="ident" id="3962728">parsedInt</span><span class="op" id="3962737">)</span><span class="op" id="3962738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962742">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3962750">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962753">switch</span>&nbsp;<span class="ident" id="3962760">val</span>&nbsp;<span class="op" id="3962764">:=</span>&nbsp;<span class="ident" id="3962767">v</span><span class="op" id="3962768">;</span>&nbsp;<span class="ident" id="3962770">val</span><span class="op" id="3962773">.</span><span class="ident" id="3962774">Kind</span><span class="op" id="3962778">(</span><span class="op" id="3962779">)</span>&nbsp;<span class="op" id="3962781">{</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962784">case</span>&nbsp;<span class="ident" id="3962789">reflect</span><span class="op" id="3962796">.</span><span class="ident" id="3962797">Bool</span><span class="op" id="3962801">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962805">parsedBool</span><span class="op" id="3962815">,</span>&nbsp;<span class="ident" id="3962817">err1</span>&nbsp;<span class="op" id="3962822">:=</span>&nbsp;<span class="ident" id="3962825">parseBool</span><span class="op" id="3962834">(</span><span class="ident" id="3962835">innerBytes</span><span class="op" id="3962845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962849">if</span>&nbsp;<span class="ident" id="3962852">err1</span>&nbsp;<span class="op" id="3962857">==</span>&nbsp;<span class="ident" id="3962860">nil</span>&nbsp;<span class="op" id="3962864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962869">val</span><span class="op" id="3962872">.</span><span class="ident" id="3962873">SetBool</span><span class="op" id="3962880">(</span><span class="ident" id="3962881">parsedBool</span><span class="op" id="3962891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3962895">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962899">err</span>&nbsp;<span class="op" id="3962903">=</span>&nbsp;<span class="ident" id="3962905">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962912">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962920">case</span>&nbsp;<span class="ident" id="3962925">reflect</span><span class="op" id="3962932">.</span><span class="ident" id="3962933">Int</span><span class="op" id="3962936">,</span>&nbsp;<span class="ident" id="3962938">reflect</span><span class="op" id="3962945">.</span><span class="ident" id="3962946">Int32</span><span class="op" id="3962951">,</span>&nbsp;<span class="ident" id="3962953">reflect</span><span class="op" id="3962960">.</span><span class="ident" id="3962961">Int64</span><span class="op" id="3962966">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962970">if</span>&nbsp;<span class="ident" id="3962973">val</span><span class="op" id="3962976">.</span><span class="ident" id="3962977">Type</span><span class="op" id="3962981">(</span><span class="op" id="3962982">)</span><span class="op" id="3962983">.</span><span class="ident" id="3962984">Size</span><span class="op" id="3962988">(</span><span class="op" id="3962989">)</span>&nbsp;<span class="op" id="3962991">==</span>&nbsp;<span class="num" id="3962994">4</span>&nbsp;<span class="op" id="3962996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963001">parsedInt</span><span class="op" id="3963010">,</span>&nbsp;<span class="ident" id="3963012">err1</span>&nbsp;<span class="op" id="3963017">:=</span>&nbsp;<span class="ident" id="3963020">parseInt32</span><span class="op" id="3963030">(</span><span class="ident" id="3963031">innerBytes</span><span class="op" id="3963041">)</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3963046">if</span>&nbsp;<span class="ident" id="3963049">err1</span>&nbsp;<span class="op" id="3963054">==</span>&nbsp;<span class="ident" id="3963057">nil</span>&nbsp;<span class="op" id="3963061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963067">val</span><span class="op" id="3963070">.</span><span class="ident" id="3963071">SetInt</span><span class="op" id="3963077">(</span><span class="ident" id="3963078">int64</span><span class="op" id="3963083">(</span><span class="ident" id="3963084">parsedInt</span><span class="op" id="3963093">)</span><span class="op" id="3963094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3963099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963104">err</span>&nbsp;<span class="op" id="3963108">=</span>&nbsp;<span class="ident" id="3963110">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3963117">}</span>&nbsp;<span class="keyword" id="3963119">else</span>&nbsp;<span class="op" id="3963124">{</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963129">parsedInt</span><span class="op" id="3963138">,</span>&nbsp;<span class="ident" id="3963140">err1</span>&nbsp;<span class="op" id="3963145">:=</span>&nbsp;<span class="ident" id="3963148">parseInt64</span><span class="op" id="3963158">(</span><span class="ident" id="3963159">innerBytes</span><span class="op" id="3963169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3963174">if</span>&nbsp;<span class="ident" id="3963177">err1</span>&nbsp;<span class="op" id="3963182">==</span>&nbsp;<span class="ident" id="3963185">nil</span>&nbsp;<span class="op" id="3963189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963195">val</span><span class="op" id="3963198">.</span><span class="ident" id="3963199">SetInt</span><span class="op" id="3963205">(</span><span class="ident" id="3963206">parsedInt</span><span class="op" id="3963215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3963220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963225">err</span>&nbsp;<span class="op" id="3963229">=</span>&nbsp;<span class="ident" id="3963231">err1</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3963238">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3963242">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3963250">//&nbsp;TODO(dfc)&nbsp;Add&nbsp;support&nbsp;for&nbsp;the&nbsp;remaining&nbsp;integer&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3963308">case</span>&nbsp;<span class="ident" id="3963313">reflect</span><span class="op" id="3963320">.</span><span class="ident" id="3963321">Struct</span><span class="op" id="3963327">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963331">structType</span>&nbsp;<span class="op" id="3963342">:=</span>&nbsp;<span class="ident" id="3963345">fieldType</span><br>
<span class="lineno">765</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3963358">if</span>&nbsp;<span class="ident" id="3963361">structType</span><span class="op" id="3963371">.</span><span class="ident" id="3963372">NumField</span><span class="op" id="3963380">(</span><span class="op" id="3963381">)</span>&nbsp;<span class="op" id="3963383">&gt;</span>&nbsp;<span class="num" id="3963385">0</span>&nbsp;<span class="op" id="3963387">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963393">structType</span><span class="op" id="3963403">.</span><span class="ident" id="3963404">Field</span><span class="op" id="3963409">(</span><span class="num" id="3963410">0</span><span class="op" id="3963411">)</span><span class="op" id="3963412">.</span><span class="ident" id="3963413">Type</span>&nbsp;<span class="op" id="3963418">==</span>&nbsp;<span class="ident" id="3963421">rawContentsType</span>&nbsp;<span class="op" id="3963437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963442">bytes</span>&nbsp;<span class="op" id="3963448">:=</span>&nbsp;<span class="ident" id="3963451">bytes</span><span class="op" id="3963456">[</span><span class="ident" id="3963457">initOffset</span><span class="op" id="3963467">:</span><span class="ident" id="3963468">offset</span><span class="op" id="3963474">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963479">val</span><span class="op" id="3963482">.</span><span class="ident" id="3963483">Field</span><span class="op" id="3963488">(</span><span class="num" id="3963489">0</span><span class="op" id="3963490">)</span><span class="op" id="3963491">.</span><span class="ident" id="3963492">Set</span><span class="op" id="3963495">(</span><span class="ident" id="3963496">reflect</span><span class="op" id="3963503">.</span><span class="ident" id="3963504">ValueOf</span><span class="op" id="3963511">(</span><span class="ident" id="3963512">RawContent</span><span class="op" id="3963522">(</span><span class="ident" id="3963523">bytes</span><span class="op" id="3963528">)</span><span class="op" id="3963529">)</span><span class="op" id="3963530">)</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3963534">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963539">innerOffset</span>&nbsp;<span class="op" id="3963551">:=</span>&nbsp;<span class="num" id="3963554">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3963558">for</span>&nbsp;<span class="ident" id="3963562">i</span>&nbsp;<span class="op" id="3963564">:=</span>&nbsp;<span class="num" id="3963567">0</span><span class="op" id="3963568">;</span>&nbsp;<span class="ident" id="3963570">i</span>&nbsp;<span class="op" id="3963572">&lt;</span>&nbsp;<span class="ident" id="3963574">structType</span><span class="op" id="3963584">.</span><span class="ident" id="3963585">NumField</span><span class="op" id="3963593">(</span><span class="op" id="3963594">)</span><span class="op" id="3963595">;</span>&nbsp;<span class="ident" id="3963597">i</span><span class="op" id="3963598">++</span>&nbsp;<span class="op" id="3963601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963606">field</span>&nbsp;<span class="op" id="3963612">:=</span>&nbsp;<span class="ident" id="3963615">structType</span><span class="op" id="3963625">.</span><span class="ident" id="3963626">Field</span><span class="op" id="3963631">(</span><span class="ident" id="3963632">i</span><span class="op" id="3963633">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3963638">if</span>&nbsp;<span class="ident" id="3963641">i</span>&nbsp;<span class="op" id="3963643">==</span>&nbsp;<span class="num" id="3963646">0</span>&nbsp;<span class="op" id="3963648">&amp;&amp;</span>&nbsp;<span class="ident" id="3963651">field</span><span class="op" id="3963656">.</span><span class="ident" id="3963657">Type</span>&nbsp;<span class="op" id="3963662">==</span>&nbsp;<span class="ident" id="3963665">rawContentsType</span>&nbsp;<span class="op" id="3963681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3963687">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3963699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3963704">innerOffset</span><span class="op" id="3963715">,</span>&nbsp;<span class="ident" id="3963717">err</span>&nbsp;<span class="op" id="3963721">=</span>&nbsp;<span class="ident" id="3963723">parseField</span><span class="op" id="3963733">(</span><span class="ident" id="3963734">val</span><span class="op" id="3963737">.</span><span class="ident" id="3963738">Field</span><span class="op" id="3963743">(</span><span class="ident" id="3963744">i</span><span class="op" id="3963745">)</span><span class="op" id="3963746">,</span>&nbsp;<span class="ident" id="3963748">innerBytes</span><span class="op" id="3963758">,</span>&nbsp;<span class="ident" id="3963760">innerOffset</span><span class="op" id="3963771">,</span>&nbsp;<span class="ident" id="3963773">parseFieldParameters</span><span class="op" id="3963793">(</span><span class="ident" id="3963794">field</span><span class="op" id="3963799">.</span><span class="ident" id="3963800">Tag</span><span class="op" id="3963803">.</span><span class="ident" id="3963804">Get</span><span class="op" id="3963807">(</span><span class="string" id="3963808">&#34;asn1&#34;</span><span class="op" id="3963814">)</span><span class="op" id="3963815">)</span><span class="op" id="3963816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3963821">if</span>&nbsp;<span class="ident" id="3963824">err</span>&nbsp;<span class="op" id="3963828">!=</span>&nbsp;<span class="ident" id="3963831">nil</span>&nbsp;<span class="op" id="3963835">{</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3963841">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3963851">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3963855">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3963859">//&nbsp;We&nbsp;allow&nbsp;extra&nbsp;bytes&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;SEQUENCE&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3963920">//&nbsp;adding&nbsp;elements&nbsp;to&nbsp;the&nbsp;end&nbsp;has&nbsp;been&nbsp;used&nbsp;in&nbsp;X.509&nbsp;as&nbsp;the</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3963982">//&nbsp;version&nbsp;numbers&nbsp;have&nbsp;increased.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3964019">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3964027">case</span>&nbsp;<span class="ident" id="3964032">reflect</span><span class="op" id="3964039">.</span><span class="ident" id="3964040">Slice</span><span class="op" id="3964045">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3964049">sliceType</span>&nbsp;<span class="op" id="3964059">:=</span>&nbsp;<span class="ident" id="3964062">fieldType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3964074">if</span>&nbsp;<span class="ident" id="3964077">sliceType</span><span class="op" id="3964086">.</span><span class="ident" id="3964087">Elem</span><span class="op" id="3964091">(</span><span class="op" id="3964092">)</span><span class="op" id="3964093">.</span><span class="ident" id="3964094">Kind</span><span class="op" id="3964098">(</span><span class="op" id="3964099">)</span>&nbsp;<span class="op" id="3964101">==</span>&nbsp;<span class="ident" id="3964104">reflect</span><span class="op" id="3964111">.</span><span class="ident" id="3964112">Uint8</span>&nbsp;<span class="op" id="3964118">{</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3964123">val</span><span class="op" id="3964126">.</span><span class="ident" id="3964127">Set</span><span class="op" id="3964130">(</span><span class="ident" id="3964131">reflect</span><span class="op" id="3964138">.</span><span class="ident" id="3964139">MakeSlice</span><span class="op" id="3964148">(</span><span class="ident" id="3964149">sliceType</span><span class="op" id="3964158">,</span>&nbsp;<span class="builtinfunc" id="3964160">len</span><span class="op" id="3964163">(</span><span class="ident" id="3964164">innerBytes</span><span class="op" id="3964174">)</span><span class="op" id="3964175">,</span>&nbsp;<span class="builtinfunc" id="3964177">len</span><span class="op" id="3964180">(</span><span class="ident" id="3964181">innerBytes</span><span class="op" id="3964191">)</span><span class="op" id="3964192">)</span><span class="op" id="3964193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3964198">reflect</span><span class="op" id="3964205">.</span><span class="ident" id="3964206">Copy</span><span class="op" id="3964210">(</span><span class="ident" id="3964211">val</span><span class="op" id="3964214">,</span>&nbsp;<span class="ident" id="3964216">reflect</span><span class="op" id="3964223">.</span><span class="ident" id="3964224">ValueOf</span><span class="op" id="3964231">(</span><span class="ident" id="3964232">innerBytes</span><span class="op" id="3964242">)</span><span class="op" id="3964243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3964248">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3964257">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3964261">newSlice</span><span class="op" id="3964269">,</span>&nbsp;<span class="ident" id="3964271">err1</span>&nbsp;<span class="op" id="3964276">:=</span>&nbsp;<span class="ident" id="3964279">parseSequenceOf</span><span class="op" id="3964294">(</span><span class="ident" id="3964295">innerBytes</span><span class="op" id="3964305">,</span>&nbsp;<span class="ident" id="3964307">sliceType</span><span class="op" id="3964316">,</span>&nbsp;<span class="ident" id="3964318">sliceType</span><span class="op" id="3964327">.</span><span class="ident" id="3964328">Elem</span><span class="op" id="3964332">(</span><span class="op" id="3964333">)</span><span class="op" id="3964334">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3964338">if</span>&nbsp;<span class="ident" id="3964341">err1</span>&nbsp;<span class="op" id="3964346">==</span>&nbsp;<span class="ident" id="3964349">nil</span>&nbsp;<span class="op" id="3964353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3964358">val</span><span class="op" id="3964361">.</span><span class="ident" id="3964362">Set</span><span class="op" id="3964365">(</span><span class="ident" id="3964366">newSlice</span><span class="op" id="3964374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3964378">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3964382">err</span>&nbsp;<span class="op" id="3964386">=</span>&nbsp;<span class="ident" id="3964388">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3964395">return</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3964403">case</span>&nbsp;<span class="ident" id="3964408">reflect</span><span class="op" id="3964415">.</span><span class="ident" id="3964416">String</span><span class="op" id="3964422">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3964426">var</span>&nbsp;<span class="ident" id="3964430">v</span>&nbsp;<span class="builtintype" id="3964432">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3964441">switch</span>&nbsp;<span class="ident" id="3964448">universalTag</span>&nbsp;<span class="op" id="3964461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3964465">case</span>&nbsp;<span class="ident" id="3964470">tagPrintableString</span><span class="op" id="3964488">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3964493">v</span><span class="op" id="3964494">,</span>&nbsp;<span class="ident" id="3964496">err</span>&nbsp;<span class="op" id="3964500">=</span>&nbsp;<span class="ident" id="3964502">parsePrintableString</span><span class="op" id="3964522">(</span><span class="ident" id="3964523">innerBytes</span><span class="op" id="3964533">)</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3964537">case</span>&nbsp;<span class="ident" id="3964542">tagIA5String</span><span class="op" id="3964554">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3964559">v</span><span class="op" id="3964560">,</span>&nbsp;<span class="ident" id="3964562">err</span>&nbsp;<span class="op" id="3964566">=</span>&nbsp;<span class="ident" id="3964568">parseIA5String</span><span class="op" id="3964582">(</span><span class="ident" id="3964583">innerBytes</span><span class="op" id="3964593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3964597">case</span>&nbsp;<span class="ident" id="3964602">tagT61String</span><span class="op" id="3964614">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3964619">v</span><span class="op" id="3964620">,</span>&nbsp;<span class="ident" id="3964622">err</span>&nbsp;<span class="op" id="3964626">=</span>&nbsp;<span class="ident" id="3964628">parseT61String</span><span class="op" id="3964642">(</span><span class="ident" id="3964643">innerBytes</span><span class="op" id="3964653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3964657">case</span>&nbsp;<span class="ident" id="3964662">tagUTF8String</span><span class="op" id="3964675">:</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3964680">v</span><span class="op" id="3964681">,</span>&nbsp;<span class="ident" id="3964683">err</span>&nbsp;<span class="op" id="3964687">=</span>&nbsp;<span class="ident" id="3964689">parseUTF8String</span><span class="op" id="3964704">(</span><span class="ident" id="3964705">innerBytes</span><span class="op" id="3964715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3964719">case</span>&nbsp;<span class="ident" id="3964724">tagGeneralString</span><span class="op" id="3964740">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3964745">//&nbsp;GeneralString&nbsp;is&nbsp;specified&nbsp;in&nbsp;ISO-2022/ECMA-35,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3964799">//&nbsp;A&nbsp;brief&nbsp;review&nbsp;suggests&nbsp;that&nbsp;it&nbsp;includes&nbsp;structures</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3964857">//&nbsp;that&nbsp;allow&nbsp;the&nbsp;encoding&nbsp;to&nbsp;change&nbsp;midstring&nbsp;and</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3964911">//&nbsp;such.&nbsp;We&nbsp;give&nbsp;up&nbsp;and&nbsp;pass&nbsp;it&nbsp;as&nbsp;an&nbsp;8-bit&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3964966">v</span><span class="op" id="3964967">,</span>&nbsp;<span class="ident" id="3964969">err</span>&nbsp;<span class="op" id="3964973">=</span>&nbsp;<span class="ident" id="3964975">parseT61String</span><span class="op" id="3964989">(</span><span class="ident" id="3964990">innerBytes</span><span class="op" id="3965000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3965004">default</span><span class="op" id="3965011">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3965016">err</span>&nbsp;<span class="op" id="3965020">=</span>&nbsp;<span class="ident" id="3965022">SyntaxError</span><span class="op" id="3965033">{</span><span class="ident" id="3965034">fmt</span><span class="op" id="3965037">.</span><span class="ident" id="3965038">Sprintf</span><span class="op" id="3965045">(</span><span class="string" id="3965046">&#34;internal&nbsp;error:&nbsp;unknown&nbsp;string&nbsp;type&nbsp;%d&#34;</span><span class="op" id="3965086">,</span>&nbsp;<span class="ident" id="3965088">universalTag</span><span class="op" id="3965100">)</span><span class="op" id="3965101">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3965105">}</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3965109">if</span>&nbsp;<span class="ident" id="3965112">err</span>&nbsp;<span class="op" id="3965116">==</span>&nbsp;<span class="ident" id="3965119">nil</span>&nbsp;<span class="op" id="3965123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3965128">val</span><span class="op" id="3965131">.</span><span class="ident" id="3965132">SetString</span><span class="op" id="3965141">(</span><span class="ident" id="3965142">v</span><span class="op" id="3965143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3965147">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3965151">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3965159">}</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3965162">err</span>&nbsp;<span class="op" id="3965166">=</span>&nbsp;<span class="ident" id="3965168">StructuralError</span><span class="op" id="3965183">{</span><span class="string" id="3965184">&#34;unsupported:&nbsp;&#34;</span>&nbsp;<span class="op" id="3965200">+</span>&nbsp;<span class="ident" id="3965202">v</span><span class="op" id="3965203">.</span><span class="ident" id="3965204">Type</span><span class="op" id="3965208">(</span><span class="op" id="3965209">)</span><span class="op" id="3965210">.</span><span class="ident" id="3965211">String</span><span class="op" id="3965217">(</span><span class="op" id="3965218">)</span><span class="op" id="3965219">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3965222">return</span><br>
<span class="lineno"></span><span class="op" id="3965229">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3965232">//&nbsp;canHaveDefaultValue&nbsp;reports&nbsp;whether&nbsp;k&nbsp;is&nbsp;a&nbsp;Kind&nbsp;that&nbsp;we&nbsp;will&nbsp;set&nbsp;a&nbsp;default</span><br>
<span class="lineno">830</span><span class="comment" id="3965310">//&nbsp;value&nbsp;for.&nbsp;(A&nbsp;signed&nbsp;integer,&nbsp;essentially.)</span><br>
<span class="lineno"></span><span class="keyword" id="3965357">func</span>&nbsp;<span class="ident" id="3965362">canHaveDefaultValue</span><span class="op" id="3965381">(</span><span class="ident" id="3965382">k</span>&nbsp;<span class="ident" id="3965384">reflect</span><span class="op" id="3965391">.</span><span class="ident" id="3965392">Kind</span><span class="op" id="3965396">)</span>&nbsp;<span class="builtintype" id="3965398">bool</span>&nbsp;<span class="op" id="3965403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3965406">switch</span>&nbsp;<span class="ident" id="3965413">k</span>&nbsp;<span class="op" id="3965415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3965418">case</span>&nbsp;<span class="ident" id="3965423">reflect</span><span class="op" id="3965430">.</span><span class="ident" id="3965431">Int</span><span class="op" id="3965434">,</span>&nbsp;<span class="ident" id="3965436">reflect</span><span class="op" id="3965443">.</span><span class="ident" id="3965444">Int8</span><span class="op" id="3965448">,</span>&nbsp;<span class="ident" id="3965450">reflect</span><span class="op" id="3965457">.</span><span class="ident" id="3965458">Int16</span><span class="op" id="3965463">,</span>&nbsp;<span class="ident" id="3965465">reflect</span><span class="op" id="3965472">.</span><span class="ident" id="3965473">Int32</span><span class="op" id="3965478">,</span>&nbsp;<span class="ident" id="3965480">reflect</span><span class="op" id="3965487">.</span><span class="ident" id="3965488">Int64</span><span class="op" id="3965493">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3965497">return</span>&nbsp;<span class="builtintype" id="3965504">true</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3965510">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3965514">return</span>&nbsp;<span class="builtintype" id="3965521">false</span><br>
<span class="lineno"></span><span class="op" id="3965527">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span><span class="comment" id="3965530">//&nbsp;setDefaultValue&nbsp;is&nbsp;used&nbsp;to&nbsp;install&nbsp;a&nbsp;default&nbsp;value,&nbsp;from&nbsp;a&nbsp;tag&nbsp;string,&nbsp;into</span><br>
<span class="lineno"></span><span class="comment" id="3965609">//&nbsp;a&nbsp;Value.&nbsp;It&nbsp;is&nbsp;successful&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;optional,&nbsp;even&nbsp;if&nbsp;a&nbsp;default&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="3965689">//&nbsp;wasn&#39;t&nbsp;provided&nbsp;or&nbsp;it&nbsp;failed&nbsp;to&nbsp;install&nbsp;it&nbsp;into&nbsp;the&nbsp;Value.</span><br>
<span class="lineno"></span><span class="keyword" id="3965751">func</span>&nbsp;<span class="ident" id="3965756">setDefaultValue</span><span class="op" id="3965771">(</span><span class="ident" id="3965772">v</span>&nbsp;<span class="ident" id="3965774">reflect</span><span class="op" id="3965781">.</span><span class="ident" id="3965782">Value</span><span class="op" id="3965787">,</span>&nbsp;<span class="ident" id="3965789">params</span>&nbsp;<span class="ident" id="3965796">fieldParameters</span><span class="op" id="3965811">)</span>&nbsp;<span class="op" id="3965813">(</span><span class="ident" id="3965814">ok</span>&nbsp;<span class="builtintype" id="3965817">bool</span><span class="op" id="3965821">)</span>&nbsp;<span class="op" id="3965823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3965826">if</span>&nbsp;<span class="op" id="3965829">!</span><span class="ident" id="3965830">params</span><span class="op" id="3965836">.</span><span class="ident" id="3965837">optional</span>&nbsp;<span class="op" id="3965846">{</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3965850">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3965858">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3965861">ok</span>&nbsp;<span class="op" id="3965864">=</span>&nbsp;<span class="builtintype" id="3965866">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3965872">if</span>&nbsp;<span class="ident" id="3965875">params</span><span class="op" id="3965881">.</span><span class="ident" id="3965882">defaultValue</span>&nbsp;<span class="op" id="3965895">==</span>&nbsp;<span class="ident" id="3965898">nil</span>&nbsp;<span class="op" id="3965902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3965906">return</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3965914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3965917">if</span>&nbsp;<span class="ident" id="3965920">canHaveDefaultValue</span><span class="op" id="3965939">(</span><span class="ident" id="3965940">v</span><span class="op" id="3965941">.</span><span class="ident" id="3965942">Kind</span><span class="op" id="3965946">(</span><span class="op" id="3965947">)</span><span class="op" id="3965948">)</span>&nbsp;<span class="op" id="3965950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3965954">v</span><span class="op" id="3965955">.</span><span class="ident" id="3965956">SetInt</span><span class="op" id="3965962">(</span><span class="op" id="3965963">*</span><span class="ident" id="3965964">params</span><span class="op" id="3965970">.</span><span class="ident" id="3965971">defaultValue</span><span class="op" id="3965983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3965986">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3965989">return</span><br>
<span class="lineno">855</span><span class="op" id="3965996">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3965999">//&nbsp;Unmarshal&nbsp;parses&nbsp;the&nbsp;DER-encoded&nbsp;ASN.1&nbsp;data&nbsp;structure&nbsp;b</span><br>
<span class="lineno"></span><span class="comment" id="3966058">//&nbsp;and&nbsp;uses&nbsp;the&nbsp;reflect&nbsp;package&nbsp;to&nbsp;fill&nbsp;in&nbsp;an&nbsp;arbitrary&nbsp;value&nbsp;pointed&nbsp;at&nbsp;by&nbsp;val.</span><br>
<span class="lineno"></span><span class="comment" id="3966139">//&nbsp;Because&nbsp;Unmarshal&nbsp;uses&nbsp;the&nbsp;reflect&nbsp;package,&nbsp;the&nbsp;structs</span><br>
<span class="lineno">860</span><span class="comment" id="3966198">//&nbsp;being&nbsp;written&nbsp;to&nbsp;must&nbsp;use&nbsp;upper&nbsp;case&nbsp;field&nbsp;names.</span><br>
<span class="lineno"></span><span class="comment" id="3966251">//</span><br>
<span class="lineno"></span><span class="comment" id="3966254">//&nbsp;An&nbsp;ASN.1&nbsp;INTEGER&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an&nbsp;int,&nbsp;int32,&nbsp;int64,</span><br>
<span class="lineno"></span><span class="comment" id="3966314">//&nbsp;or&nbsp;*big.Int&nbsp;(from&nbsp;the&nbsp;math/big&nbsp;package).</span><br>
<span class="lineno"></span><span class="comment" id="3966358">//&nbsp;If&nbsp;the&nbsp;encoded&nbsp;value&nbsp;does&nbsp;not&nbsp;fit&nbsp;in&nbsp;the&nbsp;Go&nbsp;type,</span><br>
<span class="lineno">865</span><span class="comment" id="3966411">//&nbsp;Unmarshal&nbsp;returns&nbsp;a&nbsp;parse&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="3966447">//</span><br>
<span class="lineno"></span><span class="comment" id="3966450">//&nbsp;An&nbsp;ASN.1&nbsp;BIT&nbsp;STRING&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;BitString.</span><br>
<span class="lineno"></span><span class="comment" id="3966504">//</span><br>
<span class="lineno"></span><span class="comment" id="3966507">//&nbsp;An&nbsp;ASN.1&nbsp;OCTET&nbsp;STRING&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;[]byte.</span><br>
<span class="lineno">870</span><span class="comment" id="3966560">//</span><br>
<span class="lineno"></span><span class="comment" id="3966563">//&nbsp;An&nbsp;ASN.1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="3966614">//&nbsp;ObjectIdentifier.</span><br>
<span class="lineno"></span><span class="comment" id="3966635">//</span><br>
<span class="lineno"></span><span class="comment" id="3966638">//&nbsp;An&nbsp;ASN.1&nbsp;ENUMERATED&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an&nbsp;Enumerated.</span><br>
<span class="lineno">875</span><span class="comment" id="3966694">//</span><br>
<span class="lineno"></span><span class="comment" id="3966697">//&nbsp;An&nbsp;ASN.1&nbsp;UTCTIME&nbsp;or&nbsp;GENERALIZEDTIME&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;time.Time.</span><br>
<span class="lineno"></span><span class="comment" id="3966767">//</span><br>
<span class="lineno"></span><span class="comment" id="3966770">//&nbsp;An&nbsp;ASN.1&nbsp;PrintableString&nbsp;or&nbsp;IA5String&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="3966839">//</span><br>
<span class="lineno">880</span><span class="comment" id="3966842">//&nbsp;Any&nbsp;of&nbsp;the&nbsp;above&nbsp;ASN.1&nbsp;values&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an&nbsp;interface{}.</span><br>
<span class="lineno"></span><span class="comment" id="3966909">//&nbsp;The&nbsp;value&nbsp;stored&nbsp;in&nbsp;the&nbsp;interface&nbsp;has&nbsp;the&nbsp;corresponding&nbsp;Go&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="3966977">//&nbsp;For&nbsp;integers,&nbsp;that&nbsp;type&nbsp;is&nbsp;int64.</span><br>
<span class="lineno"></span><span class="comment" id="3967014">//</span><br>
<span class="lineno"></span><span class="comment" id="3967017">//&nbsp;An&nbsp;ASN.1&nbsp;SEQUENCE&nbsp;OF&nbsp;x&nbsp;or&nbsp;SET&nbsp;OF&nbsp;x&nbsp;can&nbsp;be&nbsp;written</span><br>
<span class="lineno">885</span><span class="comment" id="3967070">//&nbsp;to&nbsp;a&nbsp;slice&nbsp;if&nbsp;an&nbsp;x&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;the&nbsp;slice&#39;s&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="3967136">//</span><br>
<span class="lineno"></span><span class="comment" id="3967139">//&nbsp;An&nbsp;ASN.1&nbsp;SEQUENCE&nbsp;or&nbsp;SET&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;struct</span><br>
<span class="lineno"></span><span class="comment" id="3967194">//&nbsp;if&nbsp;each&nbsp;of&nbsp;the&nbsp;elements&nbsp;in&nbsp;the&nbsp;sequence&nbsp;can&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="3967244">//&nbsp;written&nbsp;to&nbsp;the&nbsp;corresponding&nbsp;element&nbsp;in&nbsp;the&nbsp;struct.</span><br>
<span class="lineno">890</span><span class="comment" id="3967299">//</span><br>
<span class="lineno"></span><span class="comment" id="3967302">//&nbsp;The&nbsp;following&nbsp;tags&nbsp;on&nbsp;struct&nbsp;fields&nbsp;have&nbsp;special&nbsp;meaning&nbsp;to&nbsp;Unmarshal:</span><br>
<span class="lineno"></span><span class="comment" id="3967376">//</span><br>
<span class="lineno"></span><span class="comment" id="3967379">//&nbsp;&nbsp;&nbsp;&nbspapplication&nbsp;&nbsp;&nbsp;&nbspspecifies&nbsp;that&nbsp;a&nbsp;APPLICATION&nbsp;tag&nbsp;is&nbsp;used</span><br>
<span class="lineno"></span><span class="comment" id="3967435">//&nbsp;&nbsp;&nbsp;&nbspdefault:x&nbsp;&nbsp;&nbsp;&nbspsets&nbsp;the&nbsp;default&nbsp;value&nbsp;for&nbsp;optional&nbsp;integer&nbsp;fields</span><br>
<span class="lineno">895</span><span class="comment" id="3967499">//&nbsp;&nbsp;&nbsp;&nbspexplicit&nbsp;&nbsp;&nbsp;&nbspspecifies&nbsp;that&nbsp;an&nbsp;additional,&nbsp;explicit&nbsp;tag&nbsp;wraps&nbsp;the&nbsp;implicit&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="3967577">//&nbsp;&nbsp;&nbsp;&nbspoptional&nbsp;&nbsp;&nbsp;&nbspmarks&nbsp;the&nbsp;field&nbsp;as&nbsp;ASN.1&nbsp;OPTIONAL</span><br>
<span class="lineno"></span><span class="comment" id="3967623">//&nbsp;&nbsp;&nbsp;&nbspset&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspcauses&nbsp;a&nbsp;SET,&nbsp;rather&nbsp;than&nbsp;a&nbsp;SEQUENCE&nbsp;type&nbsp;to&nbsp;be&nbsp;expected</span><br>
<span class="lineno"></span><span class="comment" id="3967688">//&nbsp;&nbsp;&nbsp;&nbsptag:x&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspspecifies&nbsp;the&nbsp;ASN.1&nbsp;tag&nbsp;number;&nbsp;implies&nbsp;ASN.1&nbsp;CONTEXT&nbsp;SPECIFIC</span><br>
<span class="lineno"></span><span class="comment" id="3967761">//</span><br>
<span class="lineno">900</span><span class="comment" id="3967764">//&nbsp;If&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;first&nbsp;field&nbsp;of&nbsp;a&nbsp;structure&nbsp;is&nbsp;RawContent&nbsp;then&nbsp;the&nbsp;raw</span><br>
<span class="lineno"></span><span class="comment" id="3967840">//&nbsp;ASN1&nbsp;contents&nbsp;of&nbsp;the&nbsp;struct&nbsp;will&nbsp;be&nbsp;stored&nbsp;in&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="3967893">//</span><br>
<span class="lineno"></span><span class="comment" id="3967896">//&nbsp;If&nbsp;the&nbsp;type&nbsp;name&nbsp;of&nbsp;a&nbsp;slice&nbsp;element&nbsp;ends&nbsp;with&nbsp;&#34;SET&#34;&nbsp;then&nbsp;it&#39;s&nbsp;treated&nbsp;as&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="3967975">//&nbsp;the&nbsp;&#34;set&#34;&nbsp;tag&nbsp;was&nbsp;set&nbsp;on&nbsp;it.&nbsp;This&nbsp;can&nbsp;be&nbsp;used&nbsp;with&nbsp;nested&nbsp;slices&nbsp;where&nbsp;a</span><br>
<span class="lineno">905</span><span class="comment" id="3968051">//&nbsp;struct&nbsp;tag&nbsp;cannot&nbsp;be&nbsp;given.</span><br>
<span class="lineno"></span><span class="comment" id="3968082">//</span><br>
<span class="lineno"></span><span class="comment" id="3968085">//&nbsp;Other&nbsp;ASN.1&nbsp;types&nbsp;are&nbsp;not&nbsp;supported;&nbsp;if&nbsp;it&nbsp;encounters&nbsp;them,</span><br>
<span class="lineno"></span><span class="comment" id="3968148">//&nbsp;Unmarshal&nbsp;returns&nbsp;a&nbsp;parse&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="3968184">func</span>&nbsp;<span class="ident" id="3968189">Unmarshal</span><span class="op" id="3968198">(</span><span class="ident" id="3968199">b</span>&nbsp;<span class="op" id="3968201">[</span><span class="op" id="3968202">]</span><span class="builtintype" id="3968203">byte</span><span class="op" id="3968207">,</span>&nbsp;<span class="ident" id="3968209">val</span>&nbsp;<span class="keyword" id="3968213">interface</span><span class="op" id="3968222">{</span><span class="op" id="3968223">}</span><span class="op" id="3968224">)</span>&nbsp;<span class="op" id="3968226">(</span><span class="ident" id="3968227">rest</span>&nbsp;<span class="op" id="3968232">[</span><span class="op" id="3968233">]</span><span class="builtintype" id="3968234">byte</span><span class="op" id="3968238">,</span>&nbsp;<span class="ident" id="3968240">err</span>&nbsp;<span class="builtintype" id="3968244">error</span><span class="op" id="3968249">)</span>&nbsp;<span class="op" id="3968251">{</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3968254">return</span>&nbsp;<span class="ident" id="3968261">UnmarshalWithParams</span><span class="op" id="3968280">(</span><span class="ident" id="3968281">b</span><span class="op" id="3968282">,</span>&nbsp;<span class="ident" id="3968284">val</span><span class="op" id="3968287">,</span>&nbsp;<span class="string" id="3968289">&#34;&#34;</span><span class="op" id="3968291">)</span><br>
<span class="lineno"></span><span class="op" id="3968293">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3968296">//&nbsp;UnmarshalWithParams&nbsp;allows&nbsp;field&nbsp;parameters&nbsp;to&nbsp;be&nbsp;specified&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3968367">//&nbsp;top-level&nbsp;element.&nbsp;The&nbsp;form&nbsp;of&nbsp;the&nbsp;params&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;the&nbsp;field&nbsp;tags.</span><br>
<span class="lineno">915</span><span class="keyword" id="3968443">func</span>&nbsp;<span class="ident" id="3968448">UnmarshalWithParams</span><span class="op" id="3968467">(</span><span class="ident" id="3968468">b</span>&nbsp;<span class="op" id="3968470">[</span><span class="op" id="3968471">]</span><span class="builtintype" id="3968472">byte</span><span class="op" id="3968476">,</span>&nbsp;<span class="ident" id="3968478">val</span>&nbsp;<span class="keyword" id="3968482">interface</span><span class="op" id="3968491">{</span><span class="op" id="3968492">}</span><span class="op" id="3968493">,</span>&nbsp;<span class="ident" id="3968495">params</span>&nbsp;<span class="builtintype" id="3968502">string</span><span class="op" id="3968508">)</span>&nbsp;<span class="op" id="3968510">(</span><span class="ident" id="3968511">rest</span>&nbsp;<span class="op" id="3968516">[</span><span class="op" id="3968517">]</span><span class="builtintype" id="3968518">byte</span><span class="op" id="3968522">,</span>&nbsp;<span class="ident" id="3968524">err</span>&nbsp;<span class="builtintype" id="3968528">error</span><span class="op" id="3968533">)</span>&nbsp;<span class="op" id="3968535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3968538">v</span>&nbsp;<span class="op" id="3968540">:=</span>&nbsp;<span class="ident" id="3968543">reflect</span><span class="op" id="3968550">.</span><span class="ident" id="3968551">ValueOf</span><span class="op" id="3968558">(</span><span class="ident" id="3968559">val</span><span class="op" id="3968562">)</span><span class="op" id="3968563">.</span><span class="ident" id="3968564">Elem</span><span class="op" id="3968568">(</span><span class="op" id="3968569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3968572">offset</span><span class="op" id="3968578">,</span>&nbsp;<span class="ident" id="3968580">err</span>&nbsp;<span class="op" id="3968584">:=</span>&nbsp;<span class="ident" id="3968587">parseField</span><span class="op" id="3968597">(</span><span class="ident" id="3968598">v</span><span class="op" id="3968599">,</span>&nbsp;<span class="ident" id="3968601">b</span><span class="op" id="3968602">,</span>&nbsp;<span class="num" id="3968604">0</span><span class="op" id="3968605">,</span>&nbsp;<span class="ident" id="3968607">parseFieldParameters</span><span class="op" id="3968627">(</span><span class="ident" id="3968628">params</span><span class="op" id="3968634">)</span><span class="op" id="3968635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3968638">if</span>&nbsp;<span class="ident" id="3968641">err</span>&nbsp;<span class="op" id="3968645">!=</span>&nbsp;<span class="ident" id="3968648">nil</span>&nbsp;<span class="op" id="3968652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3968656">return</span>&nbsp;<span class="ident" id="3968663">nil</span><span class="op" id="3968666">,</span>&nbsp;<span class="ident" id="3968668">err</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3968673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3968676">return</span>&nbsp;<span class="ident" id="3968683">b</span><span class="op" id="3968684">[</span><span class="ident" id="3968685">offset</span><span class="op" id="3968691">:</span><span class="op" id="3968692">]</span><span class="op" id="3968693">,</span>&nbsp;<span class="ident" id="3968695">nil</span><br>
<span class="lineno"></span><span class="op" id="3968699">}</span>
</div>
</body>
</html>
