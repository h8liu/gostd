<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>log</h2>
<ul>
<li><a href="/gostd/log/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/log/log.go.html">log.go</a></li>
<li><a href="/gostd/log/log_test.go.html">log_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6455106">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6455161">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6455215">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6455266">package</span>&nbsp;<span class="ident" id="6455274">log</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6455279">//&nbsp;These&nbsp;tests&nbsp;are&nbsp;too&nbsp;simple.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6455311">import</span>&nbsp;<span class="op" id="6455318">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6455321">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6455330">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6455336">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6455346">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6455356">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="6455359">const</span>&nbsp;<span class="op" id="6455365">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6455368">Rdate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6455382">=</span>&nbsp;<span class="string" id="6455384">`[0-9][0-9][0-9][0-9]/[0-9][0-9]/[0-9][0-9]`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6455430">Rtime</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6455444">=</span>&nbsp;<span class="string" id="6455446">`[0-9][0-9]:[0-9][0-9]:[0-9][0-9]`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6455482">Rmicroseconds</span>&nbsp;<span class="op" id="6455496">=</span>&nbsp;<span class="string" id="6455498">`\.[0-9][0-9][0-9][0-9][0-9][0-9]`</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6455534">Rline</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6455548">=</span>&nbsp;<span class="string" id="6455550">`(54|56):`</span>&nbsp;<span class="comment" id="6455561">//&nbsp;must&nbsp;update&nbsp;if&nbsp;the&nbsp;calls&nbsp;to&nbsp;l.Printf&nbsp;/&nbsp;l.Print&nbsp;below&nbsp;move</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6455623">Rlongfile</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6455637">=</span>&nbsp;<span class="string" id="6455639">`.*/[A-Za-z0-9_\-]+\.go:`</span>&nbsp;<span class="op" id="6455665">+</span>&nbsp;<span class="ident" id="6455667">Rline</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6455674">Rshortfile</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6455688">=</span>&nbsp;<span class="string" id="6455690">`[A-Za-z0-9_\-]+\.go:`</span>&nbsp;<span class="op" id="6455713">+</span>&nbsp;<span class="ident" id="6455715">Rline</span><br>
<span class="lineno"></span><span class="op" id="6455721">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="6455724">type</span>&nbsp;<span class="ident" id="6455729">tester</span>&nbsp;<span class="keyword" id="6455736">struct</span>&nbsp;<span class="op" id="6455743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6455746">flag</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6455754">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6455759">prefix</span>&nbsp;&nbsp;<span class="builtintype" id="6455767">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6455775">pattern</span>&nbsp;<span class="builtintype" id="6455783">string</span>&nbsp;<span class="comment" id="6455790">//&nbsp;regexp&nbsp;that&nbsp;log&nbsp;output&nbsp;must&nbsp;match;&nbsp;we&nbsp;add&nbsp;^&nbsp;and&nbsp;expected_text$&nbsp;always</span><br>
<span class="lineno"></span><span class="op" id="6455863">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="6455866">var</span>&nbsp;<span class="ident" id="6455870">tests</span>&nbsp;<span class="op" id="6455876">=</span>&nbsp;<span class="op" id="6455878">[</span><span class="op" id="6455879">]</span><span class="ident" id="6455880">tester</span><span class="op" id="6455886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6455889">//&nbsp;individual&nbsp;pieces:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6455912">{</span><span class="num" id="6455913">0</span><span class="op" id="6455914">,</span>&nbsp;<span class="string" id="6455916">&#34;&#34;</span><span class="op" id="6455918">,</span>&nbsp;<span class="string" id="6455920">&#34;&#34;</span><span class="op" id="6455922">}</span><span class="op" id="6455923">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6455926">{</span><span class="num" id="6455927">0</span><span class="op" id="6455928">,</span>&nbsp;<span class="string" id="6455930">&#34;XXX&#34;</span><span class="op" id="6455935">,</span>&nbsp;<span class="string" id="6455937">&#34;XXX&#34;</span><span class="op" id="6455942">}</span><span class="op" id="6455943">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6455946">{</span><span class="ident" id="6455947">Ldate</span><span class="op" id="6455952">,</span>&nbsp;<span class="string" id="6455954">&#34;&#34;</span><span class="op" id="6455956">,</span>&nbsp;<span class="ident" id="6455958">Rdate</span>&nbsp;<span class="op" id="6455964">+</span>&nbsp;<span class="string" id="6455966">&#34;&nbsp;&#34;</span><span class="op" id="6455969">}</span><span class="op" id="6455970">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6455973">{</span><span class="ident" id="6455974">Ltime</span><span class="op" id="6455979">,</span>&nbsp;<span class="string" id="6455981">&#34;&#34;</span><span class="op" id="6455983">,</span>&nbsp;<span class="ident" id="6455985">Rtime</span>&nbsp;<span class="op" id="6455991">+</span>&nbsp;<span class="string" id="6455993">&#34;&nbsp;&#34;</span><span class="op" id="6455996">}</span><span class="op" id="6455997">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6456000">{</span><span class="ident" id="6456001">Ltime</span>&nbsp;<span class="op" id="6456007">|</span>&nbsp;<span class="ident" id="6456009">Lmicroseconds</span><span class="op" id="6456022">,</span>&nbsp;<span class="string" id="6456024">&#34;&#34;</span><span class="op" id="6456026">,</span>&nbsp;<span class="ident" id="6456028">Rtime</span>&nbsp;<span class="op" id="6456034">+</span>&nbsp;<span class="ident" id="6456036">Rmicroseconds</span>&nbsp;<span class="op" id="6456050">+</span>&nbsp;<span class="string" id="6456052">&#34;&nbsp;&#34;</span><span class="op" id="6456055">}</span><span class="op" id="6456056">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6456059">{</span><span class="ident" id="6456060">Lmicroseconds</span><span class="op" id="6456073">,</span>&nbsp;<span class="string" id="6456075">&#34;&#34;</span><span class="op" id="6456077">,</span>&nbsp;<span class="ident" id="6456079">Rtime</span>&nbsp;<span class="op" id="6456085">+</span>&nbsp;<span class="ident" id="6456087">Rmicroseconds</span>&nbsp;<span class="op" id="6456101">+</span>&nbsp;<span class="string" id="6456103">&#34;&nbsp;&#34;</span><span class="op" id="6456106">}</span><span class="op" id="6456107">,</span>&nbsp;<span class="comment" id="6456109">//&nbsp;microsec&nbsp;implies&nbsp;time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6456135">{</span><span class="ident" id="6456136">Llongfile</span><span class="op" id="6456145">,</span>&nbsp;<span class="string" id="6456147">&#34;&#34;</span><span class="op" id="6456149">,</span>&nbsp;<span class="ident" id="6456151">Rlongfile</span>&nbsp;<span class="op" id="6456161">+</span>&nbsp;<span class="string" id="6456163">&#34;&nbsp;&#34;</span><span class="op" id="6456166">}</span><span class="op" id="6456167">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6456170">{</span><span class="ident" id="6456171">Lshortfile</span><span class="op" id="6456181">,</span>&nbsp;<span class="string" id="6456183">&#34;&#34;</span><span class="op" id="6456185">,</span>&nbsp;<span class="ident" id="6456187">Rshortfile</span>&nbsp;<span class="op" id="6456198">+</span>&nbsp;<span class="string" id="6456200">&#34;&nbsp;&#34;</span><span class="op" id="6456203">}</span><span class="op" id="6456204">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6456207">{</span><span class="ident" id="6456208">Llongfile</span>&nbsp;<span class="op" id="6456218">|</span>&nbsp;<span class="ident" id="6456220">Lshortfile</span><span class="op" id="6456230">,</span>&nbsp;<span class="string" id="6456232">&#34;&#34;</span><span class="op" id="6456234">,</span>&nbsp;<span class="ident" id="6456236">Rshortfile</span>&nbsp;<span class="op" id="6456247">+</span>&nbsp;<span class="string" id="6456249">&#34;&nbsp;&#34;</span><span class="op" id="6456252">}</span><span class="op" id="6456253">,</span>&nbsp;<span class="comment" id="6456255">//&nbsp;shortfile&nbsp;overrides&nbsp;longfile</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6456288">//&nbsp;everything&nbsp;at&nbsp;once:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6456312">{</span><span class="ident" id="6456313">Ldate</span>&nbsp;<span class="op" id="6456319">|</span>&nbsp;<span class="ident" id="6456321">Ltime</span>&nbsp;<span class="op" id="6456327">|</span>&nbsp;<span class="ident" id="6456329">Lmicroseconds</span>&nbsp;<span class="op" id="6456343">|</span>&nbsp;<span class="ident" id="6456345">Llongfile</span><span class="op" id="6456354">,</span>&nbsp;<span class="string" id="6456356">&#34;XXX&#34;</span><span class="op" id="6456361">,</span>&nbsp;<span class="string" id="6456363">&#34;XXX&#34;</span>&nbsp;<span class="op" id="6456369">+</span>&nbsp;<span class="ident" id="6456371">Rdate</span>&nbsp;<span class="op" id="6456377">+</span>&nbsp;<span class="string" id="6456379">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="6456383">+</span>&nbsp;<span class="ident" id="6456385">Rtime</span>&nbsp;<span class="op" id="6456391">+</span>&nbsp;<span class="ident" id="6456393">Rmicroseconds</span>&nbsp;<span class="op" id="6456407">+</span>&nbsp;<span class="string" id="6456409">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="6456413">+</span>&nbsp;<span class="ident" id="6456415">Rlongfile</span>&nbsp;<span class="op" id="6456425">+</span>&nbsp;<span class="string" id="6456427">&#34;&nbsp;&#34;</span><span class="op" id="6456430">}</span><span class="op" id="6456431">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6456434">{</span><span class="ident" id="6456435">Ldate</span>&nbsp;<span class="op" id="6456441">|</span>&nbsp;<span class="ident" id="6456443">Ltime</span>&nbsp;<span class="op" id="6456449">|</span>&nbsp;<span class="ident" id="6456451">Lmicroseconds</span>&nbsp;<span class="op" id="6456465">|</span>&nbsp;<span class="ident" id="6456467">Lshortfile</span><span class="op" id="6456477">,</span>&nbsp;<span class="string" id="6456479">&#34;XXX&#34;</span><span class="op" id="6456484">,</span>&nbsp;<span class="string" id="6456486">&#34;XXX&#34;</span>&nbsp;<span class="op" id="6456492">+</span>&nbsp;<span class="ident" id="6456494">Rdate</span>&nbsp;<span class="op" id="6456500">+</span>&nbsp;<span class="string" id="6456502">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="6456506">+</span>&nbsp;<span class="ident" id="6456508">Rtime</span>&nbsp;<span class="op" id="6456514">+</span>&nbsp;<span class="ident" id="6456516">Rmicroseconds</span>&nbsp;<span class="op" id="6456530">+</span>&nbsp;<span class="string" id="6456532">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="6456536">+</span>&nbsp;<span class="ident" id="6456538">Rshortfile</span>&nbsp;<span class="op" id="6456549">+</span>&nbsp;<span class="string" id="6456551">&#34;&nbsp;&#34;</span><span class="op" id="6456554">}</span><span class="op" id="6456555">,</span><br>
<span class="lineno">45</span><span class="op" id="6456557">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6456560">//&nbsp;Test&nbsp;using&nbsp;Println(&#34;hello&#34;,&nbsp;23,&nbsp;&#34;world&#34;)&nbsp;or&nbsp;using&nbsp;Printf(&#34;hello&nbsp;%d&nbsp;world&#34;,&nbsp;23)</span><br>
<span class="lineno"></span><span class="keyword" id="6456642">func</span>&nbsp;<span class="ident" id="6456647">testPrint</span><span class="op" id="6456656">(</span><span class="ident" id="6456657">t</span>&nbsp;<span class="op" id="6456659">*</span><span class="ident" id="6456660">testing</span><span class="op" id="6456667">.</span><span class="ident" id="6456668">T</span><span class="op" id="6456669">,</span>&nbsp;<span class="ident" id="6456671">flag</span>&nbsp;<span class="builtintype" id="6456676">int</span><span class="op" id="6456679">,</span>&nbsp;<span class="ident" id="6456681">prefix</span>&nbsp;<span class="builtintype" id="6456688">string</span><span class="op" id="6456694">,</span>&nbsp;<span class="ident" id="6456696">pattern</span>&nbsp;<span class="builtintype" id="6456704">string</span><span class="op" id="6456710">,</span>&nbsp;<span class="ident" id="6456712">useFormat</span>&nbsp;<span class="builtintype" id="6456722">bool</span><span class="op" id="6456726">)</span>&nbsp;<span class="op" id="6456728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6456731">buf</span>&nbsp;<span class="op" id="6456735">:=</span>&nbsp;<span class="builtinfunc" id="6456738">new</span><span class="op" id="6456741">(</span><span class="ident" id="6456742">bytes</span><span class="op" id="6456747">.</span><span class="ident" id="6456748">Buffer</span><span class="op" id="6456754">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6456757">SetOutput</span><span class="op" id="6456766">(</span><span class="ident" id="6456767">buf</span><span class="op" id="6456770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6456773">SetFlags</span><span class="op" id="6456781">(</span><span class="ident" id="6456782">flag</span><span class="op" id="6456786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6456789">SetPrefix</span><span class="op" id="6456798">(</span><span class="ident" id="6456799">prefix</span><span class="op" id="6456805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6456808">if</span>&nbsp;<span class="ident" id="6456811">useFormat</span>&nbsp;<span class="op" id="6456821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6456825">Printf</span><span class="op" id="6456831">(</span><span class="string" id="6456832">&#34;hello&nbsp;%d&nbsp;world&#34;</span><span class="op" id="6456848">,</span>&nbsp;<span class="num" id="6456850">23</span><span class="op" id="6456852">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6456855">}</span>&nbsp;<span class="keyword" id="6456857">else</span>&nbsp;<span class="op" id="6456862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6456866">Println</span><span class="op" id="6456873">(</span><span class="string" id="6456874">&#34;hello&#34;</span><span class="op" id="6456881">,</span>&nbsp;<span class="num" id="6456883">23</span><span class="op" id="6456885">,</span>&nbsp;<span class="string" id="6456887">&#34;world&#34;</span><span class="op" id="6456894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6456897">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6456900">line</span>&nbsp;<span class="op" id="6456905">:=</span>&nbsp;<span class="ident" id="6456908">buf</span><span class="op" id="6456911">.</span><span class="ident" id="6456912">String</span><span class="op" id="6456918">(</span><span class="op" id="6456919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6456922">line</span>&nbsp;<span class="op" id="6456927">=</span>&nbsp;<span class="ident" id="6456929">line</span><span class="op" id="6456933">[</span><span class="num" id="6456934">0</span>&nbsp;<span class="op" id="6456936">:</span>&nbsp;<span class="builtinfunc" id="6456938">len</span><span class="op" id="6456941">(</span><span class="ident" id="6456942">line</span><span class="op" id="6456946">)</span><span class="op" id="6456947">-</span><span class="num" id="6456948">1</span><span class="op" id="6456949">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6456952">pattern</span>&nbsp;<span class="op" id="6456960">=</span>&nbsp;<span class="string" id="6456962">&#34;^&#34;</span>&nbsp;<span class="op" id="6456966">+</span>&nbsp;<span class="ident" id="6456968">pattern</span>&nbsp;<span class="op" id="6456976">+</span>&nbsp;<span class="string" id="6456978">&#34;hello&nbsp;23&nbsp;world$&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6456997">matched</span><span class="op" id="6457004">,</span>&nbsp;<span class="ident" id="6457006">err4</span>&nbsp;<span class="op" id="6457011">:=</span>&nbsp;<span class="ident" id="6457014">regexp</span><span class="op" id="6457020">.</span><span class="ident" id="6457021">MatchString</span><span class="op" id="6457032">(</span><span class="ident" id="6457033">pattern</span><span class="op" id="6457040">,</span>&nbsp;<span class="ident" id="6457042">line</span><span class="op" id="6457046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6457049">if</span>&nbsp;<span class="ident" id="6457052">err4</span>&nbsp;<span class="op" id="6457057">!=</span>&nbsp;<span class="ident" id="6457060">nil</span>&nbsp;<span class="op" id="6457064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6457068">t</span><span class="op" id="6457069">.</span><span class="ident" id="6457070">Fatal</span><span class="op" id="6457075">(</span><span class="string" id="6457076">&#34;pattern&nbsp;did&nbsp;not&nbsp;compile:&#34;</span><span class="op" id="6457102">,</span>&nbsp;<span class="ident" id="6457104">err4</span><span class="op" id="6457108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6457111">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6457114">if</span>&nbsp;<span class="op" id="6457117">!</span><span class="ident" id="6457118">matched</span>&nbsp;<span class="op" id="6457126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6457130">t</span><span class="op" id="6457131">.</span><span class="ident" id="6457132">Errorf</span><span class="op" id="6457138">(</span><span class="string" id="6457139">&#34;log&nbsp;output&nbsp;should&nbsp;match&nbsp;%q&nbsp;is&nbsp;%q&#34;</span><span class="op" id="6457173">,</span>&nbsp;<span class="ident" id="6457175">pattern</span><span class="op" id="6457182">,</span>&nbsp;<span class="ident" id="6457184">line</span><span class="op" id="6457188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6457191">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6457194">SetOutput</span><span class="op" id="6457203">(</span><span class="ident" id="6457204">os</span><span class="op" id="6457206">.</span><span class="ident" id="6457207">Stderr</span><span class="op" id="6457213">)</span><br>
<span class="lineno"></span><span class="op" id="6457215">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="6457218">func</span>&nbsp;<span class="ident" id="6457223">TestAll</span><span class="op" id="6457230">(</span><span class="ident" id="6457231">t</span>&nbsp;<span class="op" id="6457233">*</span><span class="ident" id="6457234">testing</span><span class="op" id="6457241">.</span><span class="ident" id="6457242">T</span><span class="op" id="6457243">)</span>&nbsp;<span class="op" id="6457245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6457248">for</span>&nbsp;<span class="ident" id="6457252">_</span><span class="op" id="6457253">,</span>&nbsp;<span class="ident" id="6457255">testcase</span>&nbsp;<span class="op" id="6457264">:=</span>&nbsp;<span class="keyword" id="6457267">range</span>&nbsp;<span class="ident" id="6457273">tests</span>&nbsp;<span class="op" id="6457279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6457283">testPrint</span><span class="op" id="6457292">(</span><span class="ident" id="6457293">t</span><span class="op" id="6457294">,</span>&nbsp;<span class="ident" id="6457296">testcase</span><span class="op" id="6457304">.</span><span class="ident" id="6457305">flag</span><span class="op" id="6457309">,</span>&nbsp;<span class="ident" id="6457311">testcase</span><span class="op" id="6457319">.</span><span class="ident" id="6457320">prefix</span><span class="op" id="6457326">,</span>&nbsp;<span class="ident" id="6457328">testcase</span><span class="op" id="6457336">.</span><span class="ident" id="6457337">pattern</span><span class="op" id="6457344">,</span>&nbsp;<span class="builtintype" id="6457346">false</span><span class="op" id="6457351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6457355">testPrint</span><span class="op" id="6457364">(</span><span class="ident" id="6457365">t</span><span class="op" id="6457366">,</span>&nbsp;<span class="ident" id="6457368">testcase</span><span class="op" id="6457376">.</span><span class="ident" id="6457377">flag</span><span class="op" id="6457381">,</span>&nbsp;<span class="ident" id="6457383">testcase</span><span class="op" id="6457391">.</span><span class="ident" id="6457392">prefix</span><span class="op" id="6457398">,</span>&nbsp;<span class="ident" id="6457400">testcase</span><span class="op" id="6457408">.</span><span class="ident" id="6457409">pattern</span><span class="op" id="6457416">,</span>&nbsp;<span class="builtintype" id="6457418">true</span><span class="op" id="6457422">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6457425">}</span><br>
<span class="lineno"></span><span class="op" id="6457427">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6457430">func</span>&nbsp;<span class="ident" id="6457435">TestOutput</span><span class="op" id="6457445">(</span><span class="ident" id="6457446">t</span>&nbsp;<span class="op" id="6457448">*</span><span class="ident" id="6457449">testing</span><span class="op" id="6457456">.</span><span class="ident" id="6457457">T</span><span class="op" id="6457458">)</span>&nbsp;<span class="op" id="6457460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6457463">const</span>&nbsp;<span class="ident" id="6457469">testString</span>&nbsp;<span class="op" id="6457480">=</span>&nbsp;<span class="string" id="6457482">&#34;test&#34;</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6457490">var</span>&nbsp;<span class="ident" id="6457494">b</span>&nbsp;<span class="ident" id="6457496">bytes</span><span class="op" id="6457501">.</span><span class="ident" id="6457502">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6457510">l</span>&nbsp;<span class="op" id="6457512">:=</span>&nbsp;<span class="ident" id="6457515">New</span><span class="op" id="6457518">(</span><span class="op" id="6457519">&amp;</span><span class="ident" id="6457520">b</span><span class="op" id="6457521">,</span>&nbsp;<span class="string" id="6457523">&#34;&#34;</span><span class="op" id="6457525">,</span>&nbsp;<span class="num" id="6457527">0</span><span class="op" id="6457528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6457531">l</span><span class="op" id="6457532">.</span><span class="ident" id="6457533">Println</span><span class="op" id="6457540">(</span><span class="ident" id="6457541">testString</span><span class="op" id="6457551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6457554">if</span>&nbsp;<span class="ident" id="6457557">expect</span>&nbsp;<span class="op" id="6457564">:=</span>&nbsp;<span class="ident" id="6457567">testString</span>&nbsp;<span class="op" id="6457578">+</span>&nbsp;<span class="string" id="6457580">&#34;\n&#34;</span><span class="op" id="6457584">;</span>&nbsp;<span class="ident" id="6457586">b</span><span class="op" id="6457587">.</span><span class="ident" id="6457588">String</span><span class="op" id="6457594">(</span><span class="op" id="6457595">)</span>&nbsp;<span class="op" id="6457597">!=</span>&nbsp;<span class="ident" id="6457600">expect</span>&nbsp;<span class="op" id="6457607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6457611">t</span><span class="op" id="6457612">.</span><span class="ident" id="6457613">Errorf</span><span class="op" id="6457619">(</span><span class="string" id="6457620">&#34;log&nbsp;output&nbsp;should&nbsp;match&nbsp;%q&nbsp;is&nbsp;%q&#34;</span><span class="op" id="6457654">,</span>&nbsp;<span class="ident" id="6457656">expect</span><span class="op" id="6457662">,</span>&nbsp;<span class="ident" id="6457664">b</span><span class="op" id="6457665">.</span><span class="ident" id="6457666">String</span><span class="op" id="6457672">(</span><span class="op" id="6457673">)</span><span class="op" id="6457674">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6457677">}</span><br>
<span class="lineno"></span><span class="op" id="6457679">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6457682">func</span>&nbsp;<span class="ident" id="6457687">TestFlagAndPrefixSetting</span><span class="op" id="6457711">(</span><span class="ident" id="6457712">t</span>&nbsp;<span class="op" id="6457714">*</span><span class="ident" id="6457715">testing</span><span class="op" id="6457722">.</span><span class="ident" id="6457723">T</span><span class="op" id="6457724">)</span>&nbsp;<span class="op" id="6457726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6457729">var</span>&nbsp;<span class="ident" id="6457733">b</span>&nbsp;<span class="ident" id="6457735">bytes</span><span class="op" id="6457740">.</span><span class="ident" id="6457741">Buffer</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6457749">l</span>&nbsp;<span class="op" id="6457751">:=</span>&nbsp;<span class="ident" id="6457754">New</span><span class="op" id="6457757">(</span><span class="op" id="6457758">&amp;</span><span class="ident" id="6457759">b</span><span class="op" id="6457760">,</span>&nbsp;<span class="string" id="6457762">&#34;Test:&#34;</span><span class="op" id="6457769">,</span>&nbsp;<span class="ident" id="6457771">LstdFlags</span><span class="op" id="6457780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6457783">f</span>&nbsp;<span class="op" id="6457785">:=</span>&nbsp;<span class="ident" id="6457788">l</span><span class="op" id="6457789">.</span><span class="ident" id="6457790">Flags</span><span class="op" id="6457795">(</span><span class="op" id="6457796">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6457799">if</span>&nbsp;<span class="ident" id="6457802">f</span>&nbsp;<span class="op" id="6457804">!=</span>&nbsp;<span class="ident" id="6457807">LstdFlags</span>&nbsp;<span class="op" id="6457817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6457821">t</span><span class="op" id="6457822">.</span><span class="ident" id="6457823">Errorf</span><span class="op" id="6457829">(</span><span class="string" id="6457830">&#34;Flags&nbsp;1:&nbsp;expected&nbsp;%x&nbsp;got&nbsp;%x&#34;</span><span class="op" id="6457859">,</span>&nbsp;<span class="ident" id="6457861">LstdFlags</span><span class="op" id="6457870">,</span>&nbsp;<span class="ident" id="6457872">f</span><span class="op" id="6457873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6457876">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6457879">l</span><span class="op" id="6457880">.</span><span class="ident" id="6457881">SetFlags</span><span class="op" id="6457889">(</span><span class="ident" id="6457890">f</span>&nbsp;<span class="op" id="6457892">|</span>&nbsp;<span class="ident" id="6457894">Lmicroseconds</span><span class="op" id="6457907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6457910">f</span>&nbsp;<span class="op" id="6457912">=</span>&nbsp;<span class="ident" id="6457914">l</span><span class="op" id="6457915">.</span><span class="ident" id="6457916">Flags</span><span class="op" id="6457921">(</span><span class="op" id="6457922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6457925">if</span>&nbsp;<span class="ident" id="6457928">f</span>&nbsp;<span class="op" id="6457930">!=</span>&nbsp;<span class="ident" id="6457933">LstdFlags</span><span class="op" id="6457942">|</span><span class="ident" id="6457943">Lmicroseconds</span>&nbsp;<span class="op" id="6457957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6457961">t</span><span class="op" id="6457962">.</span><span class="ident" id="6457963">Errorf</span><span class="op" id="6457969">(</span><span class="string" id="6457970">&#34;Flags&nbsp;2:&nbsp;expected&nbsp;%x&nbsp;got&nbsp;%x&#34;</span><span class="op" id="6457999">,</span>&nbsp;<span class="ident" id="6458001">LstdFlags</span><span class="op" id="6458010">|</span><span class="ident" id="6458011">Lmicroseconds</span><span class="op" id="6458024">,</span>&nbsp;<span class="ident" id="6458026">f</span><span class="op" id="6458027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6458030">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6458033">p</span>&nbsp;<span class="op" id="6458035">:=</span>&nbsp;<span class="ident" id="6458038">l</span><span class="op" id="6458039">.</span><span class="ident" id="6458040">Prefix</span><span class="op" id="6458046">(</span><span class="op" id="6458047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6458050">if</span>&nbsp;<span class="ident" id="6458053">p</span>&nbsp;<span class="op" id="6458055">!=</span>&nbsp;<span class="string" id="6458058">&#34;Test:&#34;</span>&nbsp;<span class="op" id="6458066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6458070">t</span><span class="op" id="6458071">.</span><span class="ident" id="6458072">Errorf</span><span class="op" id="6458078">(</span><span class="string" id="6458079">`Prefix:&nbsp;expected&nbsp;&#34;Test:&#34;&nbsp;got&nbsp;%q`</span><span class="op" id="6458112">,</span>&nbsp;<span class="ident" id="6458114">p</span><span class="op" id="6458115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6458118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6458121">l</span><span class="op" id="6458122">.</span><span class="ident" id="6458123">SetPrefix</span><span class="op" id="6458132">(</span><span class="string" id="6458133">&#34;Reality:&#34;</span><span class="op" id="6458143">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6458146">p</span>&nbsp;<span class="op" id="6458148">=</span>&nbsp;<span class="ident" id="6458150">l</span><span class="op" id="6458151">.</span><span class="ident" id="6458152">Prefix</span><span class="op" id="6458158">(</span><span class="op" id="6458159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6458162">if</span>&nbsp;<span class="ident" id="6458165">p</span>&nbsp;<span class="op" id="6458167">!=</span>&nbsp;<span class="string" id="6458170">&#34;Reality:&#34;</span>&nbsp;<span class="op" id="6458181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6458185">t</span><span class="op" id="6458186">.</span><span class="ident" id="6458187">Errorf</span><span class="op" id="6458193">(</span><span class="string" id="6458194">`Prefix:&nbsp;expected&nbsp;&#34;Reality:&#34;&nbsp;got&nbsp;%q`</span><span class="op" id="6458230">,</span>&nbsp;<span class="ident" id="6458232">p</span><span class="op" id="6458233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6458236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6458239">//&nbsp;Verify&nbsp;a&nbsp;log&nbsp;message&nbsp;looks&nbsp;right,&nbsp;with&nbsp;our&nbsp;prefix&nbsp;and&nbsp;microseconds&nbsp;present.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6458319">l</span><span class="op" id="6458320">.</span><span class="ident" id="6458321">Print</span><span class="op" id="6458326">(</span><span class="string" id="6458327">&#34;hello&#34;</span><span class="op" id="6458334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6458337">pattern</span>&nbsp;<span class="op" id="6458345">:=</span>&nbsp;<span class="string" id="6458348">&#34;^Reality:&#34;</span>&nbsp;<span class="op" id="6458360">+</span>&nbsp;<span class="ident" id="6458362">Rdate</span>&nbsp;<span class="op" id="6458368">+</span>&nbsp;<span class="string" id="6458370">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="6458374">+</span>&nbsp;<span class="ident" id="6458376">Rtime</span>&nbsp;<span class="op" id="6458382">+</span>&nbsp;<span class="ident" id="6458384">Rmicroseconds</span>&nbsp;<span class="op" id="6458398">+</span>&nbsp;<span class="string" id="6458400">&#34;&nbsp;hello\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6458412">matched</span><span class="op" id="6458419">,</span>&nbsp;<span class="ident" id="6458421">err</span>&nbsp;<span class="op" id="6458425">:=</span>&nbsp;<span class="ident" id="6458428">regexp</span><span class="op" id="6458434">.</span><span class="ident" id="6458435">Match</span><span class="op" id="6458440">(</span><span class="ident" id="6458441">pattern</span><span class="op" id="6458448">,</span>&nbsp;<span class="ident" id="6458450">b</span><span class="op" id="6458451">.</span><span class="ident" id="6458452">Bytes</span><span class="op" id="6458457">(</span><span class="op" id="6458458">)</span><span class="op" id="6458459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6458462">if</span>&nbsp;<span class="ident" id="6458465">err</span>&nbsp;<span class="op" id="6458469">!=</span>&nbsp;<span class="ident" id="6458472">nil</span>&nbsp;<span class="op" id="6458476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6458480">t</span><span class="op" id="6458481">.</span><span class="ident" id="6458482">Fatalf</span><span class="op" id="6458488">(</span><span class="string" id="6458489">&#34;pattern&nbsp;%q&nbsp;did&nbsp;not&nbsp;compile:&nbsp;%s&#34;</span><span class="op" id="6458521">,</span>&nbsp;<span class="ident" id="6458523">pattern</span><span class="op" id="6458530">,</span>&nbsp;<span class="ident" id="6458532">err</span><span class="op" id="6458535">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6458538">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6458541">if</span>&nbsp;<span class="op" id="6458544">!</span><span class="ident" id="6458545">matched</span>&nbsp;<span class="op" id="6458553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6458557">t</span><span class="op" id="6458558">.</span><span class="ident" id="6458559">Error</span><span class="op" id="6458564">(</span><span class="string" id="6458565">&#34;message&nbsp;did&nbsp;not&nbsp;match&nbsp;pattern&#34;</span><span class="op" id="6458596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6458599">}</span><br>
<span class="lineno"></span><span class="op" id="6458601">}</span>
</div>
</body>
</html>
