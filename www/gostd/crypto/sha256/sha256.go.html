<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/sha256</h2>
<ul>
<li><a href="/gostd/crypto/sha256/sha256.go.html" class="current">sha256.go</a></li>
<li><a href="/gostd/crypto/sha256/sha256_test.go.html">sha256_test.go</a></li>
<li><a href="/gostd/crypto/sha256/sha256block_decl.go.html">sha256block_decl.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4740704">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4740759">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4740813">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4740864">//&nbsp;Package&nbsp;sha256&nbsp;implements&nbsp;the&nbsp;SHA224&nbsp;and&nbsp;SHA256&nbsp;hash&nbsp;algorithms&nbsp;as&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="4740942">//&nbsp;in&nbsp;FIPS&nbsp;180-4.</span><br>
<span class="lineno"></span><span class="keyword" id="4740960">package</span>&nbsp;<span class="ident" id="4740968">sha256</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4740976">import</span>&nbsp;<span class="op" id="4740983">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4740986">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4740996">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="4741003">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4741006">func</span>&nbsp;<span class="ident" id="4741011">init</span><span class="op" id="4741015">(</span><span class="op" id="4741016">)</span>&nbsp;<span class="op" id="4741018">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4741021">crypto</span><span class="op" id="4741027">.</span><span class="ident" id="4741028">RegisterHash</span><span class="op" id="4741040">(</span><span class="ident" id="4741041">crypto</span><span class="op" id="4741047">.</span><span class="ident" id="4741048">SHA224</span><span class="op" id="4741054">,</span>&nbsp;<span class="ident" id="4741056">New224</span><span class="op" id="4741062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4741065">crypto</span><span class="op" id="4741071">.</span><span class="ident" id="4741072">RegisterHash</span><span class="op" id="4741084">(</span><span class="ident" id="4741085">crypto</span><span class="op" id="4741091">.</span><span class="ident" id="4741092">SHA256</span><span class="op" id="4741098">,</span>&nbsp;<span class="ident" id="4741100">New</span><span class="op" id="4741103">)</span><br>
<span class="lineno"></span><span class="op" id="4741105">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4741108">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA256&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno">20</span><span class="keyword" id="4741151">const</span>&nbsp;<span class="ident" id="4741157">Size</span>&nbsp;<span class="op" id="4741162">=</span>&nbsp;<span class="num" id="4741164">32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4741168">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA224&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4741211">const</span>&nbsp;<span class="ident" id="4741217">Size224</span>&nbsp;<span class="op" id="4741225">=</span>&nbsp;<span class="num" id="4741227">28</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="4741231">//&nbsp;The&nbsp;blocksize&nbsp;of&nbsp;SHA256&nbsp;and&nbsp;SHA224&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4741279">const</span>&nbsp;<span class="ident" id="4741285">BlockSize</span>&nbsp;<span class="op" id="4741295">=</span>&nbsp;<span class="num" id="4741297">64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4741301">const</span>&nbsp;<span class="op" id="4741307">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4741310">chunk</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4741320">=</span>&nbsp;<span class="num" id="4741322">64</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4741326">init0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4741336">=</span>&nbsp;<span class="num" id="4741338">0x6A09E667</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4741350">init1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4741360">=</span>&nbsp;<span class="num" id="4741362">0xBB67AE85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4741374">init2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4741384">=</span>&nbsp;<span class="num" id="4741386">0x3C6EF372</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4741398">init3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4741408">=</span>&nbsp;<span class="num" id="4741410">0xA54FF53A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4741422">init4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4741432">=</span>&nbsp;<span class="num" id="4741434">0x510E527F</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4741446">init5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4741456">=</span>&nbsp;<span class="num" id="4741458">0x9B05688C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4741470">init6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4741480">=</span>&nbsp;<span class="num" id="4741482">0x1F83D9AB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4741494">init7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4741504">=</span>&nbsp;<span class="num" id="4741506">0x5BE0CD19</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4741518">init0_224</span>&nbsp;<span class="op" id="4741528">=</span>&nbsp;<span class="num" id="4741530">0xC1059ED8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4741542">init1_224</span>&nbsp;<span class="op" id="4741552">=</span>&nbsp;<span class="num" id="4741554">0x367CD507</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4741566">init2_224</span>&nbsp;<span class="op" id="4741576">=</span>&nbsp;<span class="num" id="4741578">0x3070DD17</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4741590">init3_224</span>&nbsp;<span class="op" id="4741600">=</span>&nbsp;<span class="num" id="4741602">0xF70E5939</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4741614">init4_224</span>&nbsp;<span class="op" id="4741624">=</span>&nbsp;<span class="num" id="4741626">0xFFC00B31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4741638">init5_224</span>&nbsp;<span class="op" id="4741648">=</span>&nbsp;<span class="num" id="4741650">0x68581511</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4741662">init6_224</span>&nbsp;<span class="op" id="4741672">=</span>&nbsp;<span class="num" id="4741674">0x64F98FA7</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4741686">init7_224</span>&nbsp;<span class="op" id="4741696">=</span>&nbsp;<span class="num" id="4741698">0xBEFA4FA4</span><br>
<span class="lineno"></span><span class="op" id="4741709">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4741712">//&nbsp;digest&nbsp;represents&nbsp;the&nbsp;partial&nbsp;evaluation&nbsp;of&nbsp;a&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4741771">type</span>&nbsp;<span class="ident" id="4741776">digest</span>&nbsp;<span class="keyword" id="4741783">struct</span>&nbsp;<span class="op" id="4741790">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4741793">h</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4741799">[</span><span class="num" id="4741800">8</span><span class="op" id="4741801">]</span><span class="builtintype" id="4741802">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4741810">x</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4741816">[</span><span class="ident" id="4741817">chunk</span><span class="op" id="4741822">]</span><span class="builtintype" id="4741823">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4741829">nx</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4741835">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4741840">len</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4741846">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4741854">is224</span>&nbsp;<span class="builtintype" id="4741860">bool</span>&nbsp;<span class="comment" id="4741865">//&nbsp;mark&nbsp;if&nbsp;this&nbsp;digest&nbsp;is&nbsp;SHA-224</span><br>
<span class="lineno">55</span><span class="op" id="4741899">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4741902">func</span>&nbsp;<span class="op" id="4741907">(</span><span class="ident" id="4741908">d</span>&nbsp;<span class="op" id="4741910">*</span><span class="ident" id="4741911">digest</span><span class="op" id="4741917">)</span>&nbsp;<span class="ident" id="4741919">Reset</span><span class="op" id="4741924">(</span><span class="op" id="4741925">)</span>&nbsp;<span class="op" id="4741927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4741930">if</span>&nbsp;<span class="op" id="4741933">!</span><span class="ident" id="4741934">d</span><span class="op" id="4741935">.</span><span class="ident" id="4741936">is224</span>&nbsp;<span class="op" id="4741942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4741946">d</span><span class="op" id="4741947">.</span><span class="ident" id="4741948">h</span><span class="op" id="4741949">[</span><span class="num" id="4741950">0</span><span class="op" id="4741951">]</span>&nbsp;<span class="op" id="4741953">=</span>&nbsp;<span class="ident" id="4741955">init0</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4741963">d</span><span class="op" id="4741964">.</span><span class="ident" id="4741965">h</span><span class="op" id="4741966">[</span><span class="num" id="4741967">1</span><span class="op" id="4741968">]</span>&nbsp;<span class="op" id="4741970">=</span>&nbsp;<span class="ident" id="4741972">init1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4741980">d</span><span class="op" id="4741981">.</span><span class="ident" id="4741982">h</span><span class="op" id="4741983">[</span><span class="num" id="4741984">2</span><span class="op" id="4741985">]</span>&nbsp;<span class="op" id="4741987">=</span>&nbsp;<span class="ident" id="4741989">init2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4741997">d</span><span class="op" id="4741998">.</span><span class="ident" id="4741999">h</span><span class="op" id="4742000">[</span><span class="num" id="4742001">3</span><span class="op" id="4742002">]</span>&nbsp;<span class="op" id="4742004">=</span>&nbsp;<span class="ident" id="4742006">init3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4742014">d</span><span class="op" id="4742015">.</span><span class="ident" id="4742016">h</span><span class="op" id="4742017">[</span><span class="num" id="4742018">4</span><span class="op" id="4742019">]</span>&nbsp;<span class="op" id="4742021">=</span>&nbsp;<span class="ident" id="4742023">init4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4742031">d</span><span class="op" id="4742032">.</span><span class="ident" id="4742033">h</span><span class="op" id="4742034">[</span><span class="num" id="4742035">5</span><span class="op" id="4742036">]</span>&nbsp;<span class="op" id="4742038">=</span>&nbsp;<span class="ident" id="4742040">init5</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4742048">d</span><span class="op" id="4742049">.</span><span class="ident" id="4742050">h</span><span class="op" id="4742051">[</span><span class="num" id="4742052">6</span><span class="op" id="4742053">]</span>&nbsp;<span class="op" id="4742055">=</span>&nbsp;<span class="ident" id="4742057">init6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4742065">d</span><span class="op" id="4742066">.</span><span class="ident" id="4742067">h</span><span class="op" id="4742068">[</span><span class="num" id="4742069">7</span><span class="op" id="4742070">]</span>&nbsp;<span class="op" id="4742072">=</span>&nbsp;<span class="ident" id="4742074">init7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4742081">}</span>&nbsp;<span class="keyword" id="4742083">else</span>&nbsp;<span class="op" id="4742088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4742092">d</span><span class="op" id="4742093">.</span><span class="ident" id="4742094">h</span><span class="op" id="4742095">[</span><span class="num" id="4742096">0</span><span class="op" id="4742097">]</span>&nbsp;<span class="op" id="4742099">=</span>&nbsp;<span class="ident" id="4742101">init0_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4742113">d</span><span class="op" id="4742114">.</span><span class="ident" id="4742115">h</span><span class="op" id="4742116">[</span><span class="num" id="4742117">1</span><span class="op" id="4742118">]</span>&nbsp;<span class="op" id="4742120">=</span>&nbsp;<span class="ident" id="4742122">init1_224</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4742134">d</span><span class="op" id="4742135">.</span><span class="ident" id="4742136">h</span><span class="op" id="4742137">[</span><span class="num" id="4742138">2</span><span class="op" id="4742139">]</span>&nbsp;<span class="op" id="4742141">=</span>&nbsp;<span class="ident" id="4742143">init2_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4742155">d</span><span class="op" id="4742156">.</span><span class="ident" id="4742157">h</span><span class="op" id="4742158">[</span><span class="num" id="4742159">3</span><span class="op" id="4742160">]</span>&nbsp;<span class="op" id="4742162">=</span>&nbsp;<span class="ident" id="4742164">init3_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4742176">d</span><span class="op" id="4742177">.</span><span class="ident" id="4742178">h</span><span class="op" id="4742179">[</span><span class="num" id="4742180">4</span><span class="op" id="4742181">]</span>&nbsp;<span class="op" id="4742183">=</span>&nbsp;<span class="ident" id="4742185">init4_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4742197">d</span><span class="op" id="4742198">.</span><span class="ident" id="4742199">h</span><span class="op" id="4742200">[</span><span class="num" id="4742201">5</span><span class="op" id="4742202">]</span>&nbsp;<span class="op" id="4742204">=</span>&nbsp;<span class="ident" id="4742206">init5_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4742218">d</span><span class="op" id="4742219">.</span><span class="ident" id="4742220">h</span><span class="op" id="4742221">[</span><span class="num" id="4742222">6</span><span class="op" id="4742223">]</span>&nbsp;<span class="op" id="4742225">=</span>&nbsp;<span class="ident" id="4742227">init6_224</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4742239">d</span><span class="op" id="4742240">.</span><span class="ident" id="4742241">h</span><span class="op" id="4742242">[</span><span class="num" id="4742243">7</span><span class="op" id="4742244">]</span>&nbsp;<span class="op" id="4742246">=</span>&nbsp;<span class="ident" id="4742248">init7_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4742259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4742262">d</span><span class="op" id="4742263">.</span><span class="ident" id="4742264">nx</span>&nbsp;<span class="op" id="4742267">=</span>&nbsp;<span class="num" id="4742269">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4742272">d</span><span class="op" id="4742273">.</span><span class="builtinfunc" id="4742274">len</span>&nbsp;<span class="op" id="4742278">=</span>&nbsp;<span class="num" id="4742280">0</span><br>
<span class="lineno"></span><span class="op" id="4742282">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="4742285">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA256&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4742347">func</span>&nbsp;<span class="ident" id="4742352">New</span><span class="op" id="4742355">(</span><span class="op" id="4742356">)</span>&nbsp;<span class="ident" id="4742358">hash</span><span class="op" id="4742362">.</span><span class="ident" id="4742363">Hash</span>&nbsp;<span class="op" id="4742368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4742371">d</span>&nbsp;<span class="op" id="4742373">:=</span>&nbsp;<span class="builtinfunc" id="4742376">new</span><span class="op" id="4742379">(</span><span class="ident" id="4742380">digest</span><span class="op" id="4742386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4742389">d</span><span class="op" id="4742390">.</span><span class="ident" id="4742391">Reset</span><span class="op" id="4742396">(</span><span class="op" id="4742397">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4742400">return</span>&nbsp;<span class="ident" id="4742407">d</span><br>
<span class="lineno"></span><span class="op" id="4742409">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4742412">//&nbsp;New224&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA224&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4742477">func</span>&nbsp;<span class="ident" id="4742482">New224</span><span class="op" id="4742488">(</span><span class="op" id="4742489">)</span>&nbsp;<span class="ident" id="4742491">hash</span><span class="op" id="4742495">.</span><span class="ident" id="4742496">Hash</span>&nbsp;<span class="op" id="4742501">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4742504">d</span>&nbsp;<span class="op" id="4742506">:=</span>&nbsp;<span class="builtinfunc" id="4742509">new</span><span class="op" id="4742512">(</span><span class="ident" id="4742513">digest</span><span class="op" id="4742519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4742522">d</span><span class="op" id="4742523">.</span><span class="ident" id="4742524">is224</span>&nbsp;<span class="op" id="4742530">=</span>&nbsp;<span class="builtintype" id="4742532">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4742538">d</span><span class="op" id="4742539">.</span><span class="ident" id="4742540">Reset</span><span class="op" id="4742545">(</span><span class="op" id="4742546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4742549">return</span>&nbsp;<span class="ident" id="4742556">d</span><br>
<span class="lineno"></span><span class="op" id="4742558">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="4742561">func</span>&nbsp;<span class="op" id="4742566">(</span><span class="ident" id="4742567">d</span>&nbsp;<span class="op" id="4742569">*</span><span class="ident" id="4742570">digest</span><span class="op" id="4742576">)</span>&nbsp;<span class="ident" id="4742578">Size</span><span class="op" id="4742582">(</span><span class="op" id="4742583">)</span>&nbsp;<span class="builtintype" id="4742585">int</span>&nbsp;<span class="op" id="4742589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4742592">if</span>&nbsp;<span class="op" id="4742595">!</span><span class="ident" id="4742596">d</span><span class="op" id="4742597">.</span><span class="ident" id="4742598">is224</span>&nbsp;<span class="op" id="4742604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4742608">return</span>&nbsp;<span class="ident" id="4742615">Size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4742621">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4742624">return</span>&nbsp;<span class="ident" id="4742631">Size224</span><br>
<span class="lineno"></span><span class="op" id="4742639">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4742642">func</span>&nbsp;<span class="op" id="4742647">(</span><span class="ident" id="4742648">d</span>&nbsp;<span class="op" id="4742650">*</span><span class="ident" id="4742651">digest</span><span class="op" id="4742657">)</span>&nbsp;<span class="ident" id="4742659">BlockSize</span><span class="op" id="4742668">(</span><span class="op" id="4742669">)</span>&nbsp;<span class="builtintype" id="4742671">int</span>&nbsp;<span class="op" id="4742675">{</span>&nbsp;<span class="keyword" id="4742677">return</span>&nbsp;<span class="ident" id="4742684">BlockSize</span>&nbsp;<span class="op" id="4742694">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="keyword" id="4742697">func</span>&nbsp;<span class="op" id="4742702">(</span><span class="ident" id="4742703">d</span>&nbsp;<span class="op" id="4742705">*</span><span class="ident" id="4742706">digest</span><span class="op" id="4742712">)</span>&nbsp;<span class="ident" id="4742714">Write</span><span class="op" id="4742719">(</span><span class="ident" id="4742720">p</span>&nbsp;<span class="op" id="4742722">[</span><span class="op" id="4742723">]</span><span class="builtintype" id="4742724">byte</span><span class="op" id="4742728">)</span>&nbsp;<span class="op" id="4742730">(</span><span class="ident" id="4742731">nn</span>&nbsp;<span class="builtintype" id="4742734">int</span><span class="op" id="4742737">,</span>&nbsp;<span class="ident" id="4742739">err</span>&nbsp;<span class="builtintype" id="4742743">error</span><span class="op" id="4742748">)</span>&nbsp;<span class="op" id="4742750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4742753">nn</span>&nbsp;<span class="op" id="4742756">=</span>&nbsp;<span class="builtinfunc" id="4742758">len</span><span class="op" id="4742761">(</span><span class="ident" id="4742762">p</span><span class="op" id="4742763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4742766">d</span><span class="op" id="4742767">.</span><span class="builtinfunc" id="4742768">len</span>&nbsp;<span class="op" id="4742772">+=</span>&nbsp;<span class="ident" id="4742775">uint64</span><span class="op" id="4742781">(</span><span class="ident" id="4742782">nn</span><span class="op" id="4742784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4742787">if</span>&nbsp;<span class="ident" id="4742790">d</span><span class="op" id="4742791">.</span><span class="ident" id="4742792">nx</span>&nbsp;<span class="op" id="4742795">&gt;</span>&nbsp;<span class="num" id="4742797">0</span>&nbsp;<span class="op" id="4742799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4742803">n</span>&nbsp;<span class="op" id="4742805">:=</span>&nbsp;<span class="builtinfunc" id="4742808">copy</span><span class="op" id="4742812">(</span><span class="ident" id="4742813">d</span><span class="op" id="4742814">.</span><span class="ident" id="4742815">x</span><span class="op" id="4742816">[</span><span class="ident" id="4742817">d</span><span class="op" id="4742818">.</span><span class="ident" id="4742819">nx</span><span class="op" id="4742821">:</span><span class="op" id="4742822">]</span><span class="op" id="4742823">,</span>&nbsp;<span class="ident" id="4742825">p</span><span class="op" id="4742826">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4742830">d</span><span class="op" id="4742831">.</span><span class="ident" id="4742832">nx</span>&nbsp;<span class="op" id="4742835">+=</span>&nbsp;<span class="ident" id="4742838">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4742842">if</span>&nbsp;<span class="ident" id="4742845">d</span><span class="op" id="4742846">.</span><span class="ident" id="4742847">nx</span>&nbsp;<span class="op" id="4742850">==</span>&nbsp;<span class="ident" id="4742853">chunk</span>&nbsp;<span class="op" id="4742859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4742864">block</span><span class="op" id="4742869">(</span><span class="ident" id="4742870">d</span><span class="op" id="4742871">,</span>&nbsp;<span class="ident" id="4742873">d</span><span class="op" id="4742874">.</span><span class="ident" id="4742875">x</span><span class="op" id="4742876">[</span><span class="op" id="4742877">:</span><span class="op" id="4742878">]</span><span class="op" id="4742879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4742884">d</span><span class="op" id="4742885">.</span><span class="ident" id="4742886">nx</span>&nbsp;<span class="op" id="4742889">=</span>&nbsp;<span class="num" id="4742891">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4742895">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4742899">p</span>&nbsp;<span class="op" id="4742901">=</span>&nbsp;<span class="ident" id="4742903">p</span><span class="op" id="4742904">[</span><span class="ident" id="4742905">n</span><span class="op" id="4742906">:</span><span class="op" id="4742907">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4742910">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4742913">if</span>&nbsp;<span class="builtinfunc" id="4742916">len</span><span class="op" id="4742919">(</span><span class="ident" id="4742920">p</span><span class="op" id="4742921">)</span>&nbsp;<span class="op" id="4742923">&gt;=</span>&nbsp;<span class="ident" id="4742926">chunk</span>&nbsp;<span class="op" id="4742932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4742936">n</span>&nbsp;<span class="op" id="4742938">:=</span>&nbsp;<span class="builtinfunc" id="4742941">len</span><span class="op" id="4742944">(</span><span class="ident" id="4742945">p</span><span class="op" id="4742946">)</span>&nbsp;<span class="op" id="4742948">&amp;^</span>&nbsp;<span class="op" id="4742951">(</span><span class="ident" id="4742952">chunk</span>&nbsp;<span class="op" id="4742958">-</span>&nbsp;<span class="num" id="4742960">1</span><span class="op" id="4742961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4742965">block</span><span class="op" id="4742970">(</span><span class="ident" id="4742971">d</span><span class="op" id="4742972">,</span>&nbsp;<span class="ident" id="4742974">p</span><span class="op" id="4742975">[</span><span class="op" id="4742976">:</span><span class="ident" id="4742977">n</span><span class="op" id="4742978">]</span><span class="op" id="4742979">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4742983">p</span>&nbsp;<span class="op" id="4742985">=</span>&nbsp;<span class="ident" id="4742987">p</span><span class="op" id="4742988">[</span><span class="ident" id="4742989">n</span><span class="op" id="4742990">:</span><span class="op" id="4742991">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4742994">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4742997">if</span>&nbsp;<span class="builtinfunc" id="4743000">len</span><span class="op" id="4743003">(</span><span class="ident" id="4743004">p</span><span class="op" id="4743005">)</span>&nbsp;<span class="op" id="4743007">&gt;</span>&nbsp;<span class="num" id="4743009">0</span>&nbsp;<span class="op" id="4743011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4743015">d</span><span class="op" id="4743016">.</span><span class="ident" id="4743017">nx</span>&nbsp;<span class="op" id="4743020">=</span>&nbsp;<span class="builtinfunc" id="4743022">copy</span><span class="op" id="4743026">(</span><span class="ident" id="4743027">d</span><span class="op" id="4743028">.</span><span class="ident" id="4743029">x</span><span class="op" id="4743030">[</span><span class="op" id="4743031">:</span><span class="op" id="4743032">]</span><span class="op" id="4743033">,</span>&nbsp;<span class="ident" id="4743035">p</span><span class="op" id="4743036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4743039">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4743042">return</span><br>
<span class="lineno"></span><span class="op" id="4743049">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4743052">func</span>&nbsp;<span class="op" id="4743057">(</span><span class="ident" id="4743058">d0</span>&nbsp;<span class="op" id="4743061">*</span><span class="ident" id="4743062">digest</span><span class="op" id="4743068">)</span>&nbsp;<span class="ident" id="4743070">Sum</span><span class="op" id="4743073">(</span><span class="ident" id="4743074">in</span>&nbsp;<span class="op" id="4743077">[</span><span class="op" id="4743078">]</span><span class="builtintype" id="4743079">byte</span><span class="op" id="4743083">)</span>&nbsp;<span class="op" id="4743085">[</span><span class="op" id="4743086">]</span><span class="builtintype" id="4743087">byte</span>&nbsp;<span class="op" id="4743092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4743095">//&nbsp;Make&nbsp;a&nbsp;copy&nbsp;of&nbsp;d0&nbsp;so&nbsp;that&nbsp;caller&nbsp;can&nbsp;keep&nbsp;writing&nbsp;and&nbsp;summing.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4743162">d</span>&nbsp;<span class="op" id="4743164">:=</span>&nbsp;<span class="op" id="4743167">*</span><span class="ident" id="4743168">d0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4743172">hash</span>&nbsp;<span class="op" id="4743177">:=</span>&nbsp;<span class="ident" id="4743180">d</span><span class="op" id="4743181">.</span><span class="ident" id="4743182">checkSum</span><span class="op" id="4743190">(</span><span class="op" id="4743191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4743194">if</span>&nbsp;<span class="ident" id="4743197">d</span><span class="op" id="4743198">.</span><span class="ident" id="4743199">is224</span>&nbsp;<span class="op" id="4743205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4743209">return</span>&nbsp;<span class="builtinfunc" id="4743216">append</span><span class="op" id="4743222">(</span><span class="ident" id="4743223">in</span><span class="op" id="4743225">,</span>&nbsp;<span class="ident" id="4743227">hash</span><span class="op" id="4743231">[</span><span class="op" id="4743232">:</span><span class="ident" id="4743233">Size224</span><span class="op" id="4743240">]</span><span class="op" id="4743241">...</span><span class="op" id="4743244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4743247">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4743250">return</span>&nbsp;<span class="builtinfunc" id="4743257">append</span><span class="op" id="4743263">(</span><span class="ident" id="4743264">in</span><span class="op" id="4743266">,</span>&nbsp;<span class="ident" id="4743268">hash</span><span class="op" id="4743272">[</span><span class="op" id="4743273">:</span><span class="op" id="4743274">]</span><span class="op" id="4743275">...</span><span class="op" id="4743278">)</span><br>
<span class="lineno"></span><span class="op" id="4743280">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4743283">func</span>&nbsp;<span class="op" id="4743288">(</span><span class="ident" id="4743289">d</span>&nbsp;<span class="op" id="4743291">*</span><span class="ident" id="4743292">digest</span><span class="op" id="4743298">)</span>&nbsp;<span class="ident" id="4743300">checkSum</span><span class="op" id="4743308">(</span><span class="op" id="4743309">)</span>&nbsp;<span class="op" id="4743311">[</span><span class="ident" id="4743312">Size</span><span class="op" id="4743316">]</span><span class="builtintype" id="4743317">byte</span>&nbsp;<span class="op" id="4743322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4743325">len</span>&nbsp;<span class="op" id="4743329">:=</span>&nbsp;<span class="ident" id="4743332">d</span><span class="op" id="4743333">.</span><span class="builtinfunc" id="4743334">len</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4743339">//&nbsp;Padding.&nbsp;&nbsp;Add&nbsp;a&nbsp;1&nbsp;bit&nbsp;and&nbsp;0&nbsp;bits&nbsp;until&nbsp;56&nbsp;bytes&nbsp;mod&nbsp;64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4743399">var</span>&nbsp;<span class="ident" id="4743403">tmp</span>&nbsp;<span class="op" id="4743407">[</span><span class="num" id="4743408">64</span><span class="op" id="4743410">]</span><span class="builtintype" id="4743411">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4743417">tmp</span><span class="op" id="4743420">[</span><span class="num" id="4743421">0</span><span class="op" id="4743422">]</span>&nbsp;<span class="op" id="4743424">=</span>&nbsp;<span class="num" id="4743426">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4743432">if</span>&nbsp;<span class="builtinfunc" id="4743435">len</span><span class="op" id="4743438">%</span><span class="num" id="4743439">64</span>&nbsp;<span class="op" id="4743442">&lt;</span>&nbsp;<span class="num" id="4743444">56</span>&nbsp;<span class="op" id="4743447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4743451">d</span><span class="op" id="4743452">.</span><span class="ident" id="4743453">Write</span><span class="op" id="4743458">(</span><span class="ident" id="4743459">tmp</span><span class="op" id="4743462">[</span><span class="num" id="4743463">0</span>&nbsp;<span class="op" id="4743465">:</span>&nbsp;<span class="num" id="4743467">56</span><span class="op" id="4743469">-</span><span class="builtinfunc" id="4743470">len</span><span class="op" id="4743473">%</span><span class="num" id="4743474">64</span><span class="op" id="4743476">]</span><span class="op" id="4743477">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4743480">}</span>&nbsp;<span class="keyword" id="4743482">else</span>&nbsp;<span class="op" id="4743487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4743491">d</span><span class="op" id="4743492">.</span><span class="ident" id="4743493">Write</span><span class="op" id="4743498">(</span><span class="ident" id="4743499">tmp</span><span class="op" id="4743502">[</span><span class="num" id="4743503">0</span>&nbsp;<span class="op" id="4743505">:</span>&nbsp;<span class="num" id="4743507">64</span><span class="op" id="4743509">+</span><span class="num" id="4743510">56</span><span class="op" id="4743512">-</span><span class="builtinfunc" id="4743513">len</span><span class="op" id="4743516">%</span><span class="num" id="4743517">64</span><span class="op" id="4743519">]</span><span class="op" id="4743520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4743523">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4743527">//&nbsp;Length&nbsp;in&nbsp;bits.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4743547">len</span>&nbsp;<span class="op" id="4743551">&lt;&lt;=</span>&nbsp;<span class="num" id="4743555">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4743558">for</span>&nbsp;<span class="ident" id="4743562">i</span>&nbsp;<span class="op" id="4743564">:=</span>&nbsp;<span class="builtintype" id="4743567">uint</span><span class="op" id="4743571">(</span><span class="num" id="4743572">0</span><span class="op" id="4743573">)</span><span class="op" id="4743574">;</span>&nbsp;<span class="ident" id="4743576">i</span>&nbsp;<span class="op" id="4743578">&lt;</span>&nbsp;<span class="num" id="4743580">8</span><span class="op" id="4743581">;</span>&nbsp;<span class="ident" id="4743583">i</span><span class="op" id="4743584">++</span>&nbsp;<span class="op" id="4743587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4743591">tmp</span><span class="op" id="4743594">[</span><span class="ident" id="4743595">i</span><span class="op" id="4743596">]</span>&nbsp;<span class="op" id="4743598">=</span>&nbsp;<span class="builtintype" id="4743600">byte</span><span class="op" id="4743604">(</span><span class="builtinfunc" id="4743605">len</span>&nbsp;<span class="op" id="4743609">&gt;&gt;</span>&nbsp;<span class="op" id="4743612">(</span><span class="num" id="4743613">56</span>&nbsp;<span class="op" id="4743616">-</span>&nbsp;<span class="num" id="4743618">8</span><span class="op" id="4743619">*</span><span class="ident" id="4743620">i</span><span class="op" id="4743621">)</span><span class="op" id="4743622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4743625">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4743628">d</span><span class="op" id="4743629">.</span><span class="ident" id="4743630">Write</span><span class="op" id="4743635">(</span><span class="ident" id="4743636">tmp</span><span class="op" id="4743639">[</span><span class="num" id="4743640">0</span><span class="op" id="4743641">:</span><span class="num" id="4743642">8</span><span class="op" id="4743643">]</span><span class="op" id="4743644">)</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4743648">if</span>&nbsp;<span class="ident" id="4743651">d</span><span class="op" id="4743652">.</span><span class="ident" id="4743653">nx</span>&nbsp;<span class="op" id="4743656">!=</span>&nbsp;<span class="num" id="4743659">0</span>&nbsp;<span class="op" id="4743661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4743665">panic</span><span class="op" id="4743670">(</span><span class="string" id="4743671">&#34;d.nx&nbsp;!=&nbsp;0&#34;</span><span class="op" id="4743682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4743685">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4743689">h</span>&nbsp;<span class="op" id="4743691">:=</span>&nbsp;<span class="ident" id="4743694">d</span><span class="op" id="4743695">.</span><span class="ident" id="4743696">h</span><span class="op" id="4743697">[</span><span class="op" id="4743698">:</span><span class="op" id="4743699">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4743702">if</span>&nbsp;<span class="ident" id="4743705">d</span><span class="op" id="4743706">.</span><span class="ident" id="4743707">is224</span>&nbsp;<span class="op" id="4743713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4743717">h</span>&nbsp;<span class="op" id="4743719">=</span>&nbsp;<span class="ident" id="4743721">d</span><span class="op" id="4743722">.</span><span class="ident" id="4743723">h</span><span class="op" id="4743724">[</span><span class="op" id="4743725">:</span><span class="num" id="4743726">7</span><span class="op" id="4743727">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4743730">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4743734">var</span>&nbsp;<span class="ident" id="4743738">digest</span>&nbsp;<span class="op" id="4743745">[</span><span class="ident" id="4743746">Size</span><span class="op" id="4743750">]</span><span class="builtintype" id="4743751">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4743757">for</span>&nbsp;<span class="ident" id="4743761">i</span><span class="op" id="4743762">,</span>&nbsp;<span class="ident" id="4743764">s</span>&nbsp;<span class="op" id="4743766">:=</span>&nbsp;<span class="keyword" id="4743769">range</span>&nbsp;<span class="ident" id="4743775">h</span>&nbsp;<span class="op" id="4743777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4743781">digest</span><span class="op" id="4743787">[</span><span class="ident" id="4743788">i</span><span class="op" id="4743789">*</span><span class="num" id="4743790">4</span><span class="op" id="4743791">]</span>&nbsp;<span class="op" id="4743793">=</span>&nbsp;<span class="builtintype" id="4743795">byte</span><span class="op" id="4743799">(</span><span class="ident" id="4743800">s</span>&nbsp;<span class="op" id="4743802">&gt;&gt;</span>&nbsp;<span class="num" id="4743805">24</span><span class="op" id="4743807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4743811">digest</span><span class="op" id="4743817">[</span><span class="ident" id="4743818">i</span><span class="op" id="4743819">*</span><span class="num" id="4743820">4</span><span class="op" id="4743821">+</span><span class="num" id="4743822">1</span><span class="op" id="4743823">]</span>&nbsp;<span class="op" id="4743825">=</span>&nbsp;<span class="builtintype" id="4743827">byte</span><span class="op" id="4743831">(</span><span class="ident" id="4743832">s</span>&nbsp;<span class="op" id="4743834">&gt;&gt;</span>&nbsp;<span class="num" id="4743837">16</span><span class="op" id="4743839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4743843">digest</span><span class="op" id="4743849">[</span><span class="ident" id="4743850">i</span><span class="op" id="4743851">*</span><span class="num" id="4743852">4</span><span class="op" id="4743853">+</span><span class="num" id="4743854">2</span><span class="op" id="4743855">]</span>&nbsp;<span class="op" id="4743857">=</span>&nbsp;<span class="builtintype" id="4743859">byte</span><span class="op" id="4743863">(</span><span class="ident" id="4743864">s</span>&nbsp;<span class="op" id="4743866">&gt;&gt;</span>&nbsp;<span class="num" id="4743869">8</span><span class="op" id="4743870">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4743874">digest</span><span class="op" id="4743880">[</span><span class="ident" id="4743881">i</span><span class="op" id="4743882">*</span><span class="num" id="4743883">4</span><span class="op" id="4743884">+</span><span class="num" id="4743885">3</span><span class="op" id="4743886">]</span>&nbsp;<span class="op" id="4743888">=</span>&nbsp;<span class="builtintype" id="4743890">byte</span><span class="op" id="4743894">(</span><span class="ident" id="4743895">s</span><span class="op" id="4743896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4743899">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4743903">return</span>&nbsp;<span class="ident" id="4743910">digest</span><br>
<span class="lineno"></span><span class="op" id="4743917">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="comment" id="4743920">//&nbsp;Sum256&nbsp;returns&nbsp;the&nbsp;SHA256&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4743971">func</span>&nbsp;<span class="ident" id="4743976">Sum256</span><span class="op" id="4743982">(</span><span class="ident" id="4743983">data</span>&nbsp;<span class="op" id="4743988">[</span><span class="op" id="4743989">]</span><span class="builtintype" id="4743990">byte</span><span class="op" id="4743994">)</span>&nbsp;<span class="op" id="4743996">[</span><span class="ident" id="4743997">Size</span><span class="op" id="4744001">]</span><span class="builtintype" id="4744002">byte</span>&nbsp;<span class="op" id="4744007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4744010">var</span>&nbsp;<span class="ident" id="4744014">d</span>&nbsp;<span class="ident" id="4744016">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4744024">d</span><span class="op" id="4744025">.</span><span class="ident" id="4744026">Reset</span><span class="op" id="4744031">(</span><span class="op" id="4744032">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4744035">d</span><span class="op" id="4744036">.</span><span class="ident" id="4744037">Write</span><span class="op" id="4744042">(</span><span class="ident" id="4744043">data</span><span class="op" id="4744047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4744050">return</span>&nbsp;<span class="ident" id="4744057">d</span><span class="op" id="4744058">.</span><span class="ident" id="4744059">checkSum</span><span class="op" id="4744067">(</span><span class="op" id="4744068">)</span><br>
<span class="lineno"></span><span class="op" id="4744070">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4744073">//&nbsp;Sum224&nbsp;returns&nbsp;the&nbsp;SHA224&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno">185</span><span class="keyword" id="4744124">func</span>&nbsp;<span class="ident" id="4744129">Sum224</span><span class="op" id="4744135">(</span><span class="ident" id="4744136">data</span>&nbsp;<span class="op" id="4744141">[</span><span class="op" id="4744142">]</span><span class="builtintype" id="4744143">byte</span><span class="op" id="4744147">)</span>&nbsp;<span class="op" id="4744149">(</span><span class="ident" id="4744150">sum224</span>&nbsp;<span class="op" id="4744157">[</span><span class="ident" id="4744158">Size224</span><span class="op" id="4744165">]</span><span class="builtintype" id="4744166">byte</span><span class="op" id="4744170">)</span>&nbsp;<span class="op" id="4744172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4744175">var</span>&nbsp;<span class="ident" id="4744179">d</span>&nbsp;<span class="ident" id="4744181">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4744189">d</span><span class="op" id="4744190">.</span><span class="ident" id="4744191">is224</span>&nbsp;<span class="op" id="4744197">=</span>&nbsp;<span class="builtintype" id="4744199">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4744205">d</span><span class="op" id="4744206">.</span><span class="ident" id="4744207">Reset</span><span class="op" id="4744212">(</span><span class="op" id="4744213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4744216">d</span><span class="op" id="4744217">.</span><span class="ident" id="4744218">Write</span><span class="op" id="4744223">(</span><span class="ident" id="4744224">data</span><span class="op" id="4744228">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4744231">sum</span>&nbsp;<span class="op" id="4744235">:=</span>&nbsp;<span class="ident" id="4744238">d</span><span class="op" id="4744239">.</span><span class="ident" id="4744240">checkSum</span><span class="op" id="4744248">(</span><span class="op" id="4744249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4744252">copy</span><span class="op" id="4744256">(</span><span class="ident" id="4744257">sum224</span><span class="op" id="4744263">[</span><span class="op" id="4744264">:</span><span class="op" id="4744265">]</span><span class="op" id="4744266">,</span>&nbsp;<span class="ident" id="4744268">sum</span><span class="op" id="4744271">[</span><span class="op" id="4744272">:</span><span class="ident" id="4744273">Size224</span><span class="op" id="4744280">]</span><span class="op" id="4744281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4744284">return</span><br>
<span class="lineno"></span><span class="op" id="4744291">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
