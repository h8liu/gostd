<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6641033">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6641088">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6641142">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6641193">package</span>&nbsp;<span class="ident" id="6641201">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6641211">//&nbsp;Tests&nbsp;for&nbsp;mulitple-template&nbsp;parsing&nbsp;and&nbsp;execution.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6641266">import</span>&nbsp;<span class="op" id="6641273">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6641276">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6641285">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6641292">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6641303">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6641314">&#34;text/template/parse&#34;</span><br>
<span class="lineno">15</span><span class="op" id="6641336">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6641339">const</span>&nbsp;<span class="op" id="6641345">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6641348">noError</span>&nbsp;&nbsp;<span class="op" id="6641357">=</span>&nbsp;<span class="builtintype" id="6641359">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6641365">hasError</span>&nbsp;<span class="op" id="6641374">=</span>&nbsp;<span class="builtintype" id="6641376">false</span><br>
<span class="lineno">20</span><span class="op" id="6641382">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6641385">type</span>&nbsp;<span class="ident" id="6641390">multiParseTest</span>&nbsp;<span class="keyword" id="6641405">struct</span>&nbsp;<span class="op" id="6641412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6641415">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6641423">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6641431">input</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6641439">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6641447">ok</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6641455">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6641461">names</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6641469">[</span><span class="op" id="6641470">]</span><span class="builtintype" id="6641471">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6641479">results</span>&nbsp;<span class="op" id="6641487">[</span><span class="op" id="6641488">]</span><span class="builtintype" id="6641489">string</span><br>
<span class="lineno"></span><span class="op" id="6641496">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="6641499">var</span>&nbsp;<span class="ident" id="6641503">multiParseTests</span>&nbsp;<span class="op" id="6641519">=</span>&nbsp;<span class="op" id="6641521">[</span><span class="op" id="6641522">]</span><span class="ident" id="6641523">multiParseTest</span><span class="op" id="6641537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6641540">{</span><span class="string" id="6641541">&#34;empty&#34;</span><span class="op" id="6641548">,</span>&nbsp;<span class="string" id="6641550">&#34;&#34;</span><span class="op" id="6641552">,</span>&nbsp;<span class="ident" id="6641554">noError</span><span class="op" id="6641561">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6641565">nil</span><span class="op" id="6641568">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6641572">nil</span><span class="op" id="6641575">}</span><span class="op" id="6641576">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6641579">{</span><span class="string" id="6641580">&#34;one&#34;</span><span class="op" id="6641585">,</span>&nbsp;<span class="string" id="6641587">`{{define&nbsp;&#34;foo&#34;}}&nbsp;FOO&nbsp;{{end}}`</span><span class="op" id="6641617">,</span>&nbsp;<span class="ident" id="6641619">noError</span><span class="op" id="6641626">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6641630">[</span><span class="op" id="6641631">]</span><span class="builtintype" id="6641632">string</span><span class="op" id="6641638">{</span><span class="string" id="6641639">&#34;foo&#34;</span><span class="op" id="6641644">}</span><span class="op" id="6641645">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6641649">[</span><span class="op" id="6641650">]</span><span class="builtintype" id="6641651">string</span><span class="op" id="6641657">{</span><span class="string" id="6641658">&#34;&nbsp;FOO&nbsp;&#34;</span><span class="op" id="6641665">}</span><span class="op" id="6641666">}</span><span class="op" id="6641667">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6641670">{</span><span class="string" id="6641671">&#34;two&#34;</span><span class="op" id="6641676">,</span>&nbsp;<span class="string" id="6641678">`{{define&nbsp;&#34;foo&#34;}}&nbsp;FOO&nbsp;{{end}}{{define&nbsp;&#34;bar&#34;}}&nbsp;BAR&nbsp;{{end}}`</span><span class="op" id="6641736">,</span>&nbsp;<span class="ident" id="6641738">noError</span><span class="op" id="6641745">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6641749">[</span><span class="op" id="6641750">]</span><span class="builtintype" id="6641751">string</span><span class="op" id="6641757">{</span><span class="string" id="6641758">&#34;foo&#34;</span><span class="op" id="6641763">,</span>&nbsp;<span class="string" id="6641765">&#34;bar&#34;</span><span class="op" id="6641770">}</span><span class="op" id="6641771">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6641775">[</span><span class="op" id="6641776">]</span><span class="builtintype" id="6641777">string</span><span class="op" id="6641783">{</span><span class="string" id="6641784">&#34;&nbsp;FOO&nbsp;&#34;</span><span class="op" id="6641791">,</span>&nbsp;<span class="string" id="6641793">&#34;&nbsp;BAR&nbsp;&#34;</span><span class="op" id="6641800">}</span><span class="op" id="6641801">}</span><span class="op" id="6641802">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6641805">//&nbsp;errors</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6641816">{</span><span class="string" id="6641817">&#34;missing&nbsp;end&#34;</span><span class="op" id="6641830">,</span>&nbsp;<span class="string" id="6641832">`{{define&nbsp;&#34;foo&#34;}}&nbsp;FOO&nbsp;`</span><span class="op" id="6641855">,</span>&nbsp;<span class="ident" id="6641857">hasError</span><span class="op" id="6641865">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6641869">nil</span><span class="op" id="6641872">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6641876">nil</span><span class="op" id="6641879">}</span><span class="op" id="6641880">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6641883">{</span><span class="string" id="6641884">&#34;malformed&nbsp;name&#34;</span><span class="op" id="6641900">,</span>&nbsp;<span class="string" id="6641902">`{{define&nbsp;&#34;foo}}&nbsp;FOO&nbsp;`</span><span class="op" id="6641924">,</span>&nbsp;<span class="ident" id="6641926">hasError</span><span class="op" id="6641934">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6641938">nil</span><span class="op" id="6641941">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6641945">nil</span><span class="op" id="6641948">}</span><span class="op" id="6641949">,</span><br>
<span class="lineno"></span><span class="op" id="6641951">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6641954">func</span>&nbsp;<span class="ident" id="6641959">TestMultiParse</span><span class="op" id="6641973">(</span><span class="ident" id="6641974">t</span>&nbsp;<span class="op" id="6641976">*</span><span class="ident" id="6641977">testing</span><span class="op" id="6641984">.</span><span class="ident" id="6641985">T</span><span class="op" id="6641986">)</span>&nbsp;<span class="op" id="6641988">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6641991">for</span>&nbsp;<span class="ident" id="6641995">_</span><span class="op" id="6641996">,</span>&nbsp;<span class="ident" id="6641998">test</span>&nbsp;<span class="op" id="6642003">:=</span>&nbsp;<span class="keyword" id="6642006">range</span>&nbsp;<span class="ident" id="6642012">multiParseTests</span>&nbsp;<span class="op" id="6642028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6642032">template</span><span class="op" id="6642040">,</span>&nbsp;<span class="ident" id="6642042">err</span>&nbsp;<span class="op" id="6642046">:=</span>&nbsp;<span class="ident" id="6642049">New</span><span class="op" id="6642052">(</span><span class="string" id="6642053">&#34;root&#34;</span><span class="op" id="6642059">)</span><span class="op" id="6642060">.</span><span class="ident" id="6642061">Parse</span><span class="op" id="6642066">(</span><span class="ident" id="6642067">test</span><span class="op" id="6642071">.</span><span class="ident" id="6642072">input</span><span class="op" id="6642077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6642081">switch</span>&nbsp;<span class="op" id="6642088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6642092">case</span>&nbsp;<span class="ident" id="6642097">err</span>&nbsp;<span class="op" id="6642101">==</span>&nbsp;<span class="ident" id="6642104">nil</span>&nbsp;<span class="op" id="6642108">&amp;&amp;</span>&nbsp;<span class="op" id="6642111">!</span><span class="ident" id="6642112">test</span><span class="op" id="6642116">.</span><span class="ident" id="6642117">ok</span><span class="op" id="6642119">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6642124">t</span><span class="op" id="6642125">.</span><span class="ident" id="6642126">Errorf</span><span class="op" id="6642132">(</span><span class="string" id="6642133">&#34;%q:&nbsp;expected&nbsp;error;&nbsp;got&nbsp;none&#34;</span><span class="op" id="6642163">,</span>&nbsp;<span class="ident" id="6642165">test</span><span class="op" id="6642169">.</span><span class="ident" id="6642170">name</span><span class="op" id="6642174">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6642179">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6642190">case</span>&nbsp;<span class="ident" id="6642195">err</span>&nbsp;<span class="op" id="6642199">!=</span>&nbsp;<span class="ident" id="6642202">nil</span>&nbsp;<span class="op" id="6642206">&amp;&amp;</span>&nbsp;<span class="ident" id="6642209">test</span><span class="op" id="6642213">.</span><span class="ident" id="6642214">ok</span><span class="op" id="6642216">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6642221">t</span><span class="op" id="6642222">.</span><span class="ident" id="6642223">Errorf</span><span class="op" id="6642229">(</span><span class="string" id="6642230">&#34;%q:&nbsp;unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="6642256">,</span>&nbsp;<span class="ident" id="6642258">test</span><span class="op" id="6642262">.</span><span class="ident" id="6642263">name</span><span class="op" id="6642267">,</span>&nbsp;<span class="ident" id="6642269">err</span><span class="op" id="6642272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6642277">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6642288">case</span>&nbsp;<span class="ident" id="6642293">err</span>&nbsp;<span class="op" id="6642297">!=</span>&nbsp;<span class="ident" id="6642300">nil</span>&nbsp;<span class="op" id="6642304">&amp;&amp;</span>&nbsp;<span class="op" id="6642307">!</span><span class="ident" id="6642308">test</span><span class="op" id="6642312">.</span><span class="ident" id="6642313">ok</span><span class="op" id="6642315">:</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6642320">//&nbsp;expected&nbsp;error,&nbsp;got&nbsp;one</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6642350">if</span>&nbsp;<span class="op" id="6642353">*</span><span class="ident" id="6642354">debug</span>&nbsp;<span class="op" id="6642360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6642366">fmt</span><span class="op" id="6642369">.</span><span class="ident" id="6642370">Printf</span><span class="op" id="6642376">(</span><span class="string" id="6642377">&#34;%s:&nbsp;%s\n\t%s\n&#34;</span><span class="op" id="6642393">,</span>&nbsp;<span class="ident" id="6642395">test</span><span class="op" id="6642399">.</span><span class="ident" id="6642400">name</span><span class="op" id="6642404">,</span>&nbsp;<span class="ident" id="6642406">test</span><span class="op" id="6642410">.</span><span class="ident" id="6642411">input</span><span class="op" id="6642416">,</span>&nbsp;<span class="ident" id="6642418">err</span><span class="op" id="6642421">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6642426">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6642431">continue</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6642442">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6642446">if</span>&nbsp;<span class="ident" id="6642449">template</span>&nbsp;<span class="op" id="6642458">==</span>&nbsp;<span class="ident" id="6642461">nil</span>&nbsp;<span class="op" id="6642465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6642470">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6642481">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6642485">if</span>&nbsp;<span class="builtinfunc" id="6642488">len</span><span class="op" id="6642491">(</span><span class="ident" id="6642492">template</span><span class="op" id="6642500">.</span><span class="ident" id="6642501">tmpl</span><span class="op" id="6642505">)</span>&nbsp;<span class="op" id="6642507">!=</span>&nbsp;<span class="builtinfunc" id="6642510">len</span><span class="op" id="6642513">(</span><span class="ident" id="6642514">test</span><span class="op" id="6642518">.</span><span class="ident" id="6642519">names</span><span class="op" id="6642524">)</span><span class="op" id="6642525">+</span><span class="num" id="6642526">1</span>&nbsp;<span class="op" id="6642528">{</span>&nbsp;<span class="comment" id="6642530">//&nbsp;+1&nbsp;for&nbsp;root</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6642548">t</span><span class="op" id="6642549">.</span><span class="ident" id="6642550">Errorf</span><span class="op" id="6642556">(</span><span class="string" id="6642557">&#34;%s:&nbsp;wrong&nbsp;number&nbsp;of&nbsp;templates;&nbsp;wanted&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="6642606">,</span>&nbsp;<span class="ident" id="6642608">test</span><span class="op" id="6642612">.</span><span class="ident" id="6642613">name</span><span class="op" id="6642617">,</span>&nbsp;<span class="builtinfunc" id="6642619">len</span><span class="op" id="6642622">(</span><span class="ident" id="6642623">test</span><span class="op" id="6642627">.</span><span class="ident" id="6642628">names</span><span class="op" id="6642633">)</span><span class="op" id="6642634">,</span>&nbsp;<span class="builtinfunc" id="6642636">len</span><span class="op" id="6642639">(</span><span class="ident" id="6642640">template</span><span class="op" id="6642648">.</span><span class="ident" id="6642649">tmpl</span><span class="op" id="6642653">)</span><span class="op" id="6642654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6642659">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6642670">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6642674">for</span>&nbsp;<span class="ident" id="6642678">i</span><span class="op" id="6642679">,</span>&nbsp;<span class="ident" id="6642681">name</span>&nbsp;<span class="op" id="6642686">:=</span>&nbsp;<span class="keyword" id="6642689">range</span>&nbsp;<span class="ident" id="6642695">test</span><span class="op" id="6642699">.</span><span class="ident" id="6642700">names</span>&nbsp;<span class="op" id="6642706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6642711">tmpl</span><span class="op" id="6642715">,</span>&nbsp;<span class="ident" id="6642717">ok</span>&nbsp;<span class="op" id="6642720">:=</span>&nbsp;<span class="ident" id="6642723">template</span><span class="op" id="6642731">.</span><span class="ident" id="6642732">tmpl</span><span class="op" id="6642736">[</span><span class="ident" id="6642737">name</span><span class="op" id="6642741">]</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6642746">if</span>&nbsp;<span class="op" id="6642749">!</span><span class="ident" id="6642750">ok</span>&nbsp;<span class="op" id="6642753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6642759">t</span><span class="op" id="6642760">.</span><span class="ident" id="6642761">Errorf</span><span class="op" id="6642767">(</span><span class="string" id="6642768">&#34;%s:&nbsp;can&#39;t&nbsp;find&nbsp;template&nbsp;%q&#34;</span><span class="op" id="6642796">,</span>&nbsp;<span class="ident" id="6642798">test</span><span class="op" id="6642802">.</span><span class="ident" id="6642803">name</span><span class="op" id="6642807">,</span>&nbsp;<span class="ident" id="6642809">name</span><span class="op" id="6642813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6642819">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6642831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6642836">result</span>&nbsp;<span class="op" id="6642843">:=</span>&nbsp;<span class="ident" id="6642846">tmpl</span><span class="op" id="6642850">.</span><span class="ident" id="6642851">Root</span><span class="op" id="6642855">.</span><span class="ident" id="6642856">String</span><span class="op" id="6642862">(</span><span class="op" id="6642863">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6642868">if</span>&nbsp;<span class="ident" id="6642871">result</span>&nbsp;<span class="op" id="6642878">!=</span>&nbsp;<span class="ident" id="6642881">test</span><span class="op" id="6642885">.</span><span class="ident" id="6642886">results</span><span class="op" id="6642893">[</span><span class="ident" id="6642894">i</span><span class="op" id="6642895">]</span>&nbsp;<span class="op" id="6642897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6642903">t</span><span class="op" id="6642904">.</span><span class="ident" id="6642905">Errorf</span><span class="op" id="6642911">(</span><span class="string" id="6642912">&#34;%s=(%q):&nbsp;got\n\t%v\nexpected\n\t%v&#34;</span><span class="op" id="6642948">,</span>&nbsp;<span class="ident" id="6642950">test</span><span class="op" id="6642954">.</span><span class="ident" id="6642955">name</span><span class="op" id="6642959">,</span>&nbsp;<span class="ident" id="6642961">test</span><span class="op" id="6642965">.</span><span class="ident" id="6642966">input</span><span class="op" id="6642971">,</span>&nbsp;<span class="ident" id="6642973">result</span><span class="op" id="6642979">,</span>&nbsp;<span class="ident" id="6642981">test</span><span class="op" id="6642985">.</span><span class="ident" id="6642986">results</span><span class="op" id="6642993">[</span><span class="ident" id="6642994">i</span><span class="op" id="6642995">]</span><span class="op" id="6642996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6643001">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6643005">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6643008">}</span><br>
<span class="lineno">85</span><span class="op" id="6643010">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6643013">var</span>&nbsp;<span class="ident" id="6643017">multiExecTests</span>&nbsp;<span class="op" id="6643032">=</span>&nbsp;<span class="op" id="6643034">[</span><span class="op" id="6643035">]</span><span class="ident" id="6643036">execTest</span><span class="op" id="6643044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6643047">{</span><span class="string" id="6643048">&#34;empty&#34;</span><span class="op" id="6643055">,</span>&nbsp;<span class="string" id="6643057">&#34;&#34;</span><span class="op" id="6643059">,</span>&nbsp;<span class="string" id="6643061">&#34;&#34;</span><span class="op" id="6643063">,</span>&nbsp;<span class="ident" id="6643065">nil</span><span class="op" id="6643068">,</span>&nbsp;<span class="builtintype" id="6643070">true</span><span class="op" id="6643074">}</span><span class="op" id="6643075">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6643078">{</span><span class="string" id="6643079">&#34;text&#34;</span><span class="op" id="6643085">,</span>&nbsp;<span class="string" id="6643087">&#34;some&nbsp;text&#34;</span><span class="op" id="6643098">,</span>&nbsp;<span class="string" id="6643100">&#34;some&nbsp;text&#34;</span><span class="op" id="6643111">,</span>&nbsp;<span class="ident" id="6643113">nil</span><span class="op" id="6643116">,</span>&nbsp;<span class="builtintype" id="6643118">true</span><span class="op" id="6643122">}</span><span class="op" id="6643123">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6643126">{</span><span class="string" id="6643127">&#34;invoke&nbsp;x&#34;</span><span class="op" id="6643137">,</span>&nbsp;<span class="string" id="6643139">`{{template&nbsp;&#34;x&#34;&nbsp;.SI}}`</span><span class="op" id="6643161">,</span>&nbsp;<span class="string" id="6643163">&#34;TEXT&#34;</span><span class="op" id="6643169">,</span>&nbsp;<span class="ident" id="6643171">tVal</span><span class="op" id="6643175">,</span>&nbsp;<span class="builtintype" id="6643177">true</span><span class="op" id="6643181">}</span><span class="op" id="6643182">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6643185">{</span><span class="string" id="6643186">&#34;invoke&nbsp;x&nbsp;no&nbsp;args&#34;</span><span class="op" id="6643204">,</span>&nbsp;<span class="string" id="6643206">`{{template&nbsp;&#34;x&#34;}}`</span><span class="op" id="6643224">,</span>&nbsp;<span class="string" id="6643226">&#34;TEXT&#34;</span><span class="op" id="6643232">,</span>&nbsp;<span class="ident" id="6643234">tVal</span><span class="op" id="6643238">,</span>&nbsp;<span class="builtintype" id="6643240">true</span><span class="op" id="6643244">}</span><span class="op" id="6643245">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6643248">{</span><span class="string" id="6643249">&#34;invoke&nbsp;dot&nbsp;int&#34;</span><span class="op" id="6643265">,</span>&nbsp;<span class="string" id="6643267">`{{template&nbsp;&#34;dot&#34;&nbsp;.I}}`</span><span class="op" id="6643290">,</span>&nbsp;<span class="string" id="6643292">&#34;17&#34;</span><span class="op" id="6643296">,</span>&nbsp;<span class="ident" id="6643298">tVal</span><span class="op" id="6643302">,</span>&nbsp;<span class="builtintype" id="6643304">true</span><span class="op" id="6643308">}</span><span class="op" id="6643309">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6643312">{</span><span class="string" id="6643313">&#34;invoke&nbsp;dot&nbsp;[]int&#34;</span><span class="op" id="6643331">,</span>&nbsp;<span class="string" id="6643333">`{{template&nbsp;&#34;dot&#34;&nbsp;.SI}}`</span><span class="op" id="6643357">,</span>&nbsp;<span class="string" id="6643359">&#34;[3&nbsp;4&nbsp;5]&#34;</span><span class="op" id="6643368">,</span>&nbsp;<span class="ident" id="6643370">tVal</span><span class="op" id="6643374">,</span>&nbsp;<span class="builtintype" id="6643376">true</span><span class="op" id="6643380">}</span><span class="op" id="6643381">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6643384">{</span><span class="string" id="6643385">&#34;invoke&nbsp;dotV&#34;</span><span class="op" id="6643398">,</span>&nbsp;<span class="string" id="6643400">`{{template&nbsp;&#34;dotV&#34;&nbsp;.U}}`</span><span class="op" id="6643424">,</span>&nbsp;<span class="string" id="6643426">&#34;v&#34;</span><span class="op" id="6643429">,</span>&nbsp;<span class="ident" id="6643431">tVal</span><span class="op" id="6643435">,</span>&nbsp;<span class="builtintype" id="6643437">true</span><span class="op" id="6643441">}</span><span class="op" id="6643442">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6643445">{</span><span class="string" id="6643446">&#34;invoke&nbsp;nested&nbsp;int&#34;</span><span class="op" id="6643465">,</span>&nbsp;<span class="string" id="6643467">`{{template&nbsp;&#34;nested&#34;&nbsp;.I}}`</span><span class="op" id="6643493">,</span>&nbsp;<span class="string" id="6643495">&#34;17&#34;</span><span class="op" id="6643499">,</span>&nbsp;<span class="ident" id="6643501">tVal</span><span class="op" id="6643505">,</span>&nbsp;<span class="builtintype" id="6643507">true</span><span class="op" id="6643511">}</span><span class="op" id="6643512">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6643515">{</span><span class="string" id="6643516">&#34;variable&nbsp;declared&nbsp;by&nbsp;template&#34;</span><span class="op" id="6643547">,</span>&nbsp;<span class="string" id="6643549">`{{template&nbsp;&#34;nested&#34;&nbsp;$x:=.SI}},{{index&nbsp;$x&nbsp;1}}`</span><span class="op" id="6643595">,</span>&nbsp;<span class="string" id="6643597">&#34;[3&nbsp;4&nbsp;5],4&#34;</span><span class="op" id="6643608">,</span>&nbsp;<span class="ident" id="6643610">tVal</span><span class="op" id="6643614">,</span>&nbsp;<span class="builtintype" id="6643616">true</span><span class="op" id="6643620">}</span><span class="op" id="6643621">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6643625">//&nbsp;User-defined&nbsp;function:&nbsp;test&nbsp;argument&nbsp;evaluator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6643677">{</span><span class="string" id="6643678">&#34;testFunc&nbsp;literal&#34;</span><span class="op" id="6643696">,</span>&nbsp;<span class="string" id="6643698">`{{oneArg&nbsp;&#34;joe&#34;}}`</span><span class="op" id="6643716">,</span>&nbsp;<span class="string" id="6643718">&#34;oneArg=joe&#34;</span><span class="op" id="6643730">,</span>&nbsp;<span class="ident" id="6643732">tVal</span><span class="op" id="6643736">,</span>&nbsp;<span class="builtintype" id="6643738">true</span><span class="op" id="6643742">}</span><span class="op" id="6643743">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6643746">{</span><span class="string" id="6643747">&#34;testFunc&nbsp;.&#34;</span><span class="op" id="6643759">,</span>&nbsp;<span class="string" id="6643761">`{{oneArg&nbsp;.}}`</span><span class="op" id="6643775">,</span>&nbsp;<span class="string" id="6643777">&#34;oneArg=joe&#34;</span><span class="op" id="6643789">,</span>&nbsp;<span class="string" id="6643791">&#34;joe&#34;</span><span class="op" id="6643796">,</span>&nbsp;<span class="builtintype" id="6643798">true</span><span class="op" id="6643802">}</span><span class="op" id="6643803">,</span><br>
<span class="lineno"></span><span class="op" id="6643805">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6643808">//&nbsp;These&nbsp;strings&nbsp;are&nbsp;also&nbsp;in&nbsp;testdata/*.</span><br>
<span class="lineno"></span><span class="keyword" id="6643849">const</span>&nbsp;<span class="ident" id="6643855">multiText1</span>&nbsp;<span class="op" id="6643866">=</span>&nbsp;<span class="string" id="6643868">`<br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp{{define&nbsp;&#34;x&#34;}}TEXT{{end}}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp{{define&nbsp;&#34;dotV&#34;}}{{.V}}{{end}}<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6643932">const</span>&nbsp;<span class="ident" id="6643938">multiText2</span>&nbsp;<span class="op" id="6643949">=</span>&nbsp;<span class="string" id="6643951">`<br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp{{define&nbsp;&#34;dot&#34;}}{{.}}{{end}}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp{{define&nbsp;&#34;nested&#34;}}{{template&nbsp;&#34;dot&#34;&nbsp;.}}{{end}}<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6644034">func</span>&nbsp;<span class="ident" id="6644039">TestMultiExecute</span><span class="op" id="6644055">(</span><span class="ident" id="6644056">t</span>&nbsp;<span class="op" id="6644058">*</span><span class="ident" id="6644059">testing</span><span class="op" id="6644066">.</span><span class="ident" id="6644067">T</span><span class="op" id="6644068">)</span>&nbsp;<span class="op" id="6644070">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6644073">//&nbsp;Declare&nbsp;a&nbsp;couple&nbsp;of&nbsp;templates&nbsp;first.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6644114">template</span><span class="op" id="6644122">,</span>&nbsp;<span class="ident" id="6644124">err</span>&nbsp;<span class="op" id="6644128">:=</span>&nbsp;<span class="ident" id="6644131">New</span><span class="op" id="6644134">(</span><span class="string" id="6644135">&#34;root&#34;</span><span class="op" id="6644141">)</span><span class="op" id="6644142">.</span><span class="ident" id="6644143">Parse</span><span class="op" id="6644148">(</span><span class="ident" id="6644149">multiText1</span><span class="op" id="6644159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6644162">if</span>&nbsp;<span class="ident" id="6644165">err</span>&nbsp;<span class="op" id="6644169">!=</span>&nbsp;<span class="ident" id="6644172">nil</span>&nbsp;<span class="op" id="6644176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6644180">t</span><span class="op" id="6644181">.</span><span class="ident" id="6644182">Fatalf</span><span class="op" id="6644188">(</span><span class="string" id="6644189">&#34;parse&nbsp;error&nbsp;for&nbsp;1:&nbsp;%s&#34;</span><span class="op" id="6644212">,</span>&nbsp;<span class="ident" id="6644214">err</span><span class="op" id="6644217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6644220">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6644223">_</span><span class="op" id="6644224">,</span>&nbsp;<span class="ident" id="6644226">err</span>&nbsp;<span class="op" id="6644230">=</span>&nbsp;<span class="ident" id="6644232">template</span><span class="op" id="6644240">.</span><span class="ident" id="6644241">Parse</span><span class="op" id="6644246">(</span><span class="ident" id="6644247">multiText2</span><span class="op" id="6644257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6644260">if</span>&nbsp;<span class="ident" id="6644263">err</span>&nbsp;<span class="op" id="6644267">!=</span>&nbsp;<span class="ident" id="6644270">nil</span>&nbsp;<span class="op" id="6644274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6644278">t</span><span class="op" id="6644279">.</span><span class="ident" id="6644280">Fatalf</span><span class="op" id="6644286">(</span><span class="string" id="6644287">&#34;parse&nbsp;error&nbsp;for&nbsp;2:&nbsp;%s&#34;</span><span class="op" id="6644310">,</span>&nbsp;<span class="ident" id="6644312">err</span><span class="op" id="6644315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6644318">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6644321">testExecute</span><span class="op" id="6644332">(</span><span class="ident" id="6644333">multiExecTests</span><span class="op" id="6644347">,</span>&nbsp;<span class="ident" id="6644349">template</span><span class="op" id="6644357">,</span>&nbsp;<span class="ident" id="6644359">t</span><span class="op" id="6644360">)</span><br>
<span class="lineno">125</span><span class="op" id="6644362">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6644365">func</span>&nbsp;<span class="ident" id="6644370">TestParseFiles</span><span class="op" id="6644384">(</span><span class="ident" id="6644385">t</span>&nbsp;<span class="op" id="6644387">*</span><span class="ident" id="6644388">testing</span><span class="op" id="6644395">.</span><span class="ident" id="6644396">T</span><span class="op" id="6644397">)</span>&nbsp;<span class="op" id="6644399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6644402">_</span><span class="op" id="6644403">,</span>&nbsp;<span class="ident" id="6644405">err</span>&nbsp;<span class="op" id="6644409">:=</span>&nbsp;<span class="ident" id="6644412">ParseFiles</span><span class="op" id="6644422">(</span><span class="string" id="6644423">&#34;DOES&nbsp;NOT&nbsp;EXIST&#34;</span><span class="op" id="6644439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6644442">if</span>&nbsp;<span class="ident" id="6644445">err</span>&nbsp;<span class="op" id="6644449">==</span>&nbsp;<span class="ident" id="6644452">nil</span>&nbsp;<span class="op" id="6644456">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6644460">t</span><span class="op" id="6644461">.</span><span class="ident" id="6644462">Error</span><span class="op" id="6644467">(</span><span class="string" id="6644468">&#34;expected&nbsp;error&nbsp;for&nbsp;non-existent&nbsp;file;&nbsp;got&nbsp;none&#34;</span><span class="op" id="6644516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6644519">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6644522">template</span>&nbsp;<span class="op" id="6644531">:=</span>&nbsp;<span class="ident" id="6644534">New</span><span class="op" id="6644537">(</span><span class="string" id="6644538">&#34;root&#34;</span><span class="op" id="6644544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6644547">_</span><span class="op" id="6644548">,</span>&nbsp;<span class="ident" id="6644550">err</span>&nbsp;<span class="op" id="6644554">=</span>&nbsp;<span class="ident" id="6644556">template</span><span class="op" id="6644564">.</span><span class="ident" id="6644565">ParseFiles</span><span class="op" id="6644575">(</span><span class="string" id="6644576">&#34;testdata/file1.tmpl&#34;</span><span class="op" id="6644597">,</span>&nbsp;<span class="string" id="6644599">&#34;testdata/file2.tmpl&#34;</span><span class="op" id="6644620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6644623">if</span>&nbsp;<span class="ident" id="6644626">err</span>&nbsp;<span class="op" id="6644630">!=</span>&nbsp;<span class="ident" id="6644633">nil</span>&nbsp;<span class="op" id="6644637">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6644641">t</span><span class="op" id="6644642">.</span><span class="ident" id="6644643">Fatalf</span><span class="op" id="6644649">(</span><span class="string" id="6644650">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="6644675">,</span>&nbsp;<span class="ident" id="6644677">err</span><span class="op" id="6644680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6644683">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6644686">testExecute</span><span class="op" id="6644697">(</span><span class="ident" id="6644698">multiExecTests</span><span class="op" id="6644712">,</span>&nbsp;<span class="ident" id="6644714">template</span><span class="op" id="6644722">,</span>&nbsp;<span class="ident" id="6644724">t</span><span class="op" id="6644725">)</span><br>
<span class="lineno"></span><span class="op" id="6644727">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="keyword" id="6644730">func</span>&nbsp;<span class="ident" id="6644735">TestParseGlob</span><span class="op" id="6644748">(</span><span class="ident" id="6644749">t</span>&nbsp;<span class="op" id="6644751">*</span><span class="ident" id="6644752">testing</span><span class="op" id="6644759">.</span><span class="ident" id="6644760">T</span><span class="op" id="6644761">)</span>&nbsp;<span class="op" id="6644763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6644766">_</span><span class="op" id="6644767">,</span>&nbsp;<span class="ident" id="6644769">err</span>&nbsp;<span class="op" id="6644773">:=</span>&nbsp;<span class="ident" id="6644776">ParseGlob</span><span class="op" id="6644785">(</span><span class="string" id="6644786">&#34;DOES&nbsp;NOT&nbsp;EXIST&#34;</span><span class="op" id="6644802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6644805">if</span>&nbsp;<span class="ident" id="6644808">err</span>&nbsp;<span class="op" id="6644812">==</span>&nbsp;<span class="ident" id="6644815">nil</span>&nbsp;<span class="op" id="6644819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6644823">t</span><span class="op" id="6644824">.</span><span class="ident" id="6644825">Error</span><span class="op" id="6644830">(</span><span class="string" id="6644831">&#34;expected&nbsp;error&nbsp;for&nbsp;non-existent&nbsp;file;&nbsp;got&nbsp;none&#34;</span><span class="op" id="6644879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6644882">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6644885">_</span><span class="op" id="6644886">,</span>&nbsp;<span class="ident" id="6644888">err</span>&nbsp;<span class="op" id="6644892">=</span>&nbsp;<span class="ident" id="6644894">New</span><span class="op" id="6644897">(</span><span class="string" id="6644898">&#34;error&#34;</span><span class="op" id="6644905">)</span><span class="op" id="6644906">.</span><span class="ident" id="6644907">ParseGlob</span><span class="op" id="6644916">(</span><span class="string" id="6644917">&#34;[x&#34;</span><span class="op" id="6644921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6644924">if</span>&nbsp;<span class="ident" id="6644927">err</span>&nbsp;<span class="op" id="6644931">==</span>&nbsp;<span class="ident" id="6644934">nil</span>&nbsp;<span class="op" id="6644938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6644942">t</span><span class="op" id="6644943">.</span><span class="ident" id="6644944">Error</span><span class="op" id="6644949">(</span><span class="string" id="6644950">&#34;expected&nbsp;error&nbsp;for&nbsp;bad&nbsp;pattern;&nbsp;got&nbsp;none&#34;</span><span class="op" id="6644992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6644995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6644998">template</span>&nbsp;<span class="op" id="6645007">:=</span>&nbsp;<span class="ident" id="6645010">New</span><span class="op" id="6645013">(</span><span class="string" id="6645014">&#34;root&#34;</span><span class="op" id="6645020">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6645023">_</span><span class="op" id="6645024">,</span>&nbsp;<span class="ident" id="6645026">err</span>&nbsp;<span class="op" id="6645030">=</span>&nbsp;<span class="ident" id="6645032">template</span><span class="op" id="6645040">.</span><span class="ident" id="6645041">ParseGlob</span><span class="op" id="6645050">(</span><span class="string" id="6645051">&#34;testdata/file*.tmpl&#34;</span><span class="op" id="6645072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6645075">if</span>&nbsp;<span class="ident" id="6645078">err</span>&nbsp;<span class="op" id="6645082">!=</span>&nbsp;<span class="ident" id="6645085">nil</span>&nbsp;<span class="op" id="6645089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6645093">t</span><span class="op" id="6645094">.</span><span class="ident" id="6645095">Fatalf</span><span class="op" id="6645101">(</span><span class="string" id="6645102">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="6645127">,</span>&nbsp;<span class="ident" id="6645129">err</span><span class="op" id="6645132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6645135">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6645138">testExecute</span><span class="op" id="6645149">(</span><span class="ident" id="6645150">multiExecTests</span><span class="op" id="6645164">,</span>&nbsp;<span class="ident" id="6645166">template</span><span class="op" id="6645174">,</span>&nbsp;<span class="ident" id="6645176">t</span><span class="op" id="6645177">)</span><br>
<span class="lineno">155</span><span class="op" id="6645179">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6645182">//&nbsp;In&nbsp;these&nbsp;tests,&nbsp;actual&nbsp;content&nbsp;(not&nbsp;just&nbsp;template&nbsp;definitions)&nbsp;comes&nbsp;from&nbsp;the&nbsp;parsed&nbsp;files.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6645278">var</span>&nbsp;<span class="ident" id="6645282">templateFileExecTests</span>&nbsp;<span class="op" id="6645304">=</span>&nbsp;<span class="op" id="6645306">[</span><span class="op" id="6645307">]</span><span class="ident" id="6645308">execTest</span><span class="op" id="6645316">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6645319">{</span><span class="string" id="6645320">&#34;test&#34;</span><span class="op" id="6645326">,</span>&nbsp;<span class="string" id="6645328">`{{template&nbsp;&#34;tmpl1.tmpl&#34;}}{{template&nbsp;&#34;tmpl2.tmpl&#34;}}`</span><span class="op" id="6645380">,</span>&nbsp;<span class="string" id="6645382">&#34;template1\n\ny\ntemplate2\n\nx\n&#34;</span><span class="op" id="6645416">,</span>&nbsp;<span class="num" id="6645418">0</span><span class="op" id="6645419">,</span>&nbsp;<span class="builtintype" id="6645421">true</span><span class="op" id="6645425">}</span><span class="op" id="6645426">,</span><br>
<span class="lineno"></span><span class="op" id="6645428">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6645431">func</span>&nbsp;<span class="ident" id="6645436">TestParseFilesWithData</span><span class="op" id="6645458">(</span><span class="ident" id="6645459">t</span>&nbsp;<span class="op" id="6645461">*</span><span class="ident" id="6645462">testing</span><span class="op" id="6645469">.</span><span class="ident" id="6645470">T</span><span class="op" id="6645471">)</span>&nbsp;<span class="op" id="6645473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6645476">template</span><span class="op" id="6645484">,</span>&nbsp;<span class="ident" id="6645486">err</span>&nbsp;<span class="op" id="6645490">:=</span>&nbsp;<span class="ident" id="6645493">New</span><span class="op" id="6645496">(</span><span class="string" id="6645497">&#34;root&#34;</span><span class="op" id="6645503">)</span><span class="op" id="6645504">.</span><span class="ident" id="6645505">ParseFiles</span><span class="op" id="6645515">(</span><span class="string" id="6645516">&#34;testdata/tmpl1.tmpl&#34;</span><span class="op" id="6645537">,</span>&nbsp;<span class="string" id="6645539">&#34;testdata/tmpl2.tmpl&#34;</span><span class="op" id="6645560">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6645563">if</span>&nbsp;<span class="ident" id="6645566">err</span>&nbsp;<span class="op" id="6645570">!=</span>&nbsp;<span class="ident" id="6645573">nil</span>&nbsp;<span class="op" id="6645577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6645581">t</span><span class="op" id="6645582">.</span><span class="ident" id="6645583">Fatalf</span><span class="op" id="6645589">(</span><span class="string" id="6645590">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="6645615">,</span>&nbsp;<span class="ident" id="6645617">err</span><span class="op" id="6645620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6645623">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6645626">testExecute</span><span class="op" id="6645637">(</span><span class="ident" id="6645638">templateFileExecTests</span><span class="op" id="6645659">,</span>&nbsp;<span class="ident" id="6645661">template</span><span class="op" id="6645669">,</span>&nbsp;<span class="ident" id="6645671">t</span><span class="op" id="6645672">)</span><br>
<span class="lineno"></span><span class="op" id="6645674">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="6645677">func</span>&nbsp;<span class="ident" id="6645682">TestParseGlobWithData</span><span class="op" id="6645703">(</span><span class="ident" id="6645704">t</span>&nbsp;<span class="op" id="6645706">*</span><span class="ident" id="6645707">testing</span><span class="op" id="6645714">.</span><span class="ident" id="6645715">T</span><span class="op" id="6645716">)</span>&nbsp;<span class="op" id="6645718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6645721">template</span><span class="op" id="6645729">,</span>&nbsp;<span class="ident" id="6645731">err</span>&nbsp;<span class="op" id="6645735">:=</span>&nbsp;<span class="ident" id="6645738">New</span><span class="op" id="6645741">(</span><span class="string" id="6645742">&#34;root&#34;</span><span class="op" id="6645748">)</span><span class="op" id="6645749">.</span><span class="ident" id="6645750">ParseGlob</span><span class="op" id="6645759">(</span><span class="string" id="6645760">&#34;testdata/tmpl*.tmpl&#34;</span><span class="op" id="6645781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6645784">if</span>&nbsp;<span class="ident" id="6645787">err</span>&nbsp;<span class="op" id="6645791">!=</span>&nbsp;<span class="ident" id="6645794">nil</span>&nbsp;<span class="op" id="6645798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6645802">t</span><span class="op" id="6645803">.</span><span class="ident" id="6645804">Fatalf</span><span class="op" id="6645810">(</span><span class="string" id="6645811">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="6645836">,</span>&nbsp;<span class="ident" id="6645838">err</span><span class="op" id="6645841">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6645844">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6645847">testExecute</span><span class="op" id="6645858">(</span><span class="ident" id="6645859">templateFileExecTests</span><span class="op" id="6645880">,</span>&nbsp;<span class="ident" id="6645882">template</span><span class="op" id="6645890">,</span>&nbsp;<span class="ident" id="6645892">t</span><span class="op" id="6645893">)</span><br>
<span class="lineno"></span><span class="op" id="6645895">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6645898">const</span>&nbsp;<span class="op" id="6645904">(</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6645907">cloneText1</span>&nbsp;<span class="op" id="6645918">=</span>&nbsp;<span class="string" id="6645920">`{{define&nbsp;&#34;a&#34;}}{{template&nbsp;&#34;b&#34;}}{{template&nbsp;&#34;c&#34;}}{{end}}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6645977">cloneText2</span>&nbsp;<span class="op" id="6645988">=</span>&nbsp;<span class="string" id="6645990">`{{define&nbsp;&#34;b&#34;}}b{{end}}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6646016">cloneText3</span>&nbsp;<span class="op" id="6646027">=</span>&nbsp;<span class="string" id="6646029">`{{define&nbsp;&#34;c&#34;}}root{{end}}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6646058">cloneText4</span>&nbsp;<span class="op" id="6646069">=</span>&nbsp;<span class="string" id="6646071">`{{define&nbsp;&#34;c&#34;}}clone{{end}}`</span><br>
<span class="lineno"></span><span class="op" id="6646100">)</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="6646103">func</span>&nbsp;<span class="ident" id="6646108">TestClone</span><span class="op" id="6646117">(</span><span class="ident" id="6646118">t</span>&nbsp;<span class="op" id="6646120">*</span><span class="ident" id="6646121">testing</span><span class="op" id="6646128">.</span><span class="ident" id="6646129">T</span><span class="op" id="6646130">)</span>&nbsp;<span class="op" id="6646132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6646135">//&nbsp;Create&nbsp;some&nbsp;templates&nbsp;and&nbsp;clone&nbsp;the&nbsp;root.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6646181">root</span><span class="op" id="6646185">,</span>&nbsp;<span class="ident" id="6646187">err</span>&nbsp;<span class="op" id="6646191">:=</span>&nbsp;<span class="ident" id="6646194">New</span><span class="op" id="6646197">(</span><span class="string" id="6646198">&#34;root&#34;</span><span class="op" id="6646204">)</span><span class="op" id="6646205">.</span><span class="ident" id="6646206">Parse</span><span class="op" id="6646211">(</span><span class="ident" id="6646212">cloneText1</span><span class="op" id="6646222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6646225">if</span>&nbsp;<span class="ident" id="6646228">err</span>&nbsp;<span class="op" id="6646232">!=</span>&nbsp;<span class="ident" id="6646235">nil</span>&nbsp;<span class="op" id="6646239">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6646243">t</span><span class="op" id="6646244">.</span><span class="ident" id="6646245">Fatal</span><span class="op" id="6646250">(</span><span class="ident" id="6646251">err</span><span class="op" id="6646254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6646257">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6646260">_</span><span class="op" id="6646261">,</span>&nbsp;<span class="ident" id="6646263">err</span>&nbsp;<span class="op" id="6646267">=</span>&nbsp;<span class="ident" id="6646269">root</span><span class="op" id="6646273">.</span><span class="ident" id="6646274">Parse</span><span class="op" id="6646279">(</span><span class="ident" id="6646280">cloneText2</span><span class="op" id="6646290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6646293">if</span>&nbsp;<span class="ident" id="6646296">err</span>&nbsp;<span class="op" id="6646300">!=</span>&nbsp;<span class="ident" id="6646303">nil</span>&nbsp;<span class="op" id="6646307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6646311">t</span><span class="op" id="6646312">.</span><span class="ident" id="6646313">Fatal</span><span class="op" id="6646318">(</span><span class="ident" id="6646319">err</span><span class="op" id="6646322">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6646325">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6646328">clone</span>&nbsp;<span class="op" id="6646334">:=</span>&nbsp;<span class="ident" id="6646337">Must</span><span class="op" id="6646341">(</span><span class="ident" id="6646342">root</span><span class="op" id="6646346">.</span><span class="ident" id="6646347">Clone</span><span class="op" id="6646352">(</span><span class="op" id="6646353">)</span><span class="op" id="6646354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6646357">//&nbsp;Add&nbsp;variants&nbsp;to&nbsp;both.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6646383">_</span><span class="op" id="6646384">,</span>&nbsp;<span class="ident" id="6646386">err</span>&nbsp;<span class="op" id="6646390">=</span>&nbsp;<span class="ident" id="6646392">root</span><span class="op" id="6646396">.</span><span class="ident" id="6646397">Parse</span><span class="op" id="6646402">(</span><span class="ident" id="6646403">cloneText3</span><span class="op" id="6646413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6646416">if</span>&nbsp;<span class="ident" id="6646419">err</span>&nbsp;<span class="op" id="6646423">!=</span>&nbsp;<span class="ident" id="6646426">nil</span>&nbsp;<span class="op" id="6646430">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6646434">t</span><span class="op" id="6646435">.</span><span class="ident" id="6646436">Fatal</span><span class="op" id="6646441">(</span><span class="ident" id="6646442">err</span><span class="op" id="6646445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6646448">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6646451">_</span><span class="op" id="6646452">,</span>&nbsp;<span class="ident" id="6646454">err</span>&nbsp;<span class="op" id="6646458">=</span>&nbsp;<span class="ident" id="6646460">clone</span><span class="op" id="6646465">.</span><span class="ident" id="6646466">Parse</span><span class="op" id="6646471">(</span><span class="ident" id="6646472">cloneText4</span><span class="op" id="6646482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6646485">if</span>&nbsp;<span class="ident" id="6646488">err</span>&nbsp;<span class="op" id="6646492">!=</span>&nbsp;<span class="ident" id="6646495">nil</span>&nbsp;<span class="op" id="6646499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6646503">t</span><span class="op" id="6646504">.</span><span class="ident" id="6646505">Fatal</span><span class="op" id="6646510">(</span><span class="ident" id="6646511">err</span><span class="op" id="6646514">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6646517">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6646520">//&nbsp;Verify&nbsp;that&nbsp;the&nbsp;clone&nbsp;is&nbsp;self-consistent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6646566">for</span>&nbsp;<span class="ident" id="6646570">k</span><span class="op" id="6646571">,</span>&nbsp;<span class="ident" id="6646573">v</span>&nbsp;<span class="op" id="6646575">:=</span>&nbsp;<span class="keyword" id="6646578">range</span>&nbsp;<span class="ident" id="6646584">clone</span><span class="op" id="6646589">.</span><span class="ident" id="6646590">tmpl</span>&nbsp;<span class="op" id="6646595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6646599">if</span>&nbsp;<span class="ident" id="6646602">k</span>&nbsp;<span class="op" id="6646604">==</span>&nbsp;<span class="ident" id="6646607">clone</span><span class="op" id="6646612">.</span><span class="ident" id="6646613">name</span>&nbsp;<span class="op" id="6646618">&amp;&amp;</span>&nbsp;<span class="ident" id="6646621">v</span><span class="op" id="6646622">.</span><span class="ident" id="6646623">tmpl</span><span class="op" id="6646627">[</span><span class="ident" id="6646628">k</span><span class="op" id="6646629">]</span>&nbsp;<span class="op" id="6646631">!=</span>&nbsp;<span class="ident" id="6646634">clone</span>&nbsp;<span class="op" id="6646640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6646645">t</span><span class="op" id="6646646">.</span><span class="ident" id="6646647">Error</span><span class="op" id="6646652">(</span><span class="string" id="6646653">&#34;clone&nbsp;does&nbsp;not&nbsp;contain&nbsp;root&#34;</span><span class="op" id="6646682">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6646686">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6646690">if</span>&nbsp;<span class="ident" id="6646693">v</span>&nbsp;<span class="op" id="6646695">!=</span>&nbsp;<span class="ident" id="6646698">v</span><span class="op" id="6646699">.</span><span class="ident" id="6646700">tmpl</span><span class="op" id="6646704">[</span><span class="ident" id="6646705">v</span><span class="op" id="6646706">.</span><span class="ident" id="6646707">name</span><span class="op" id="6646711">]</span>&nbsp;<span class="op" id="6646713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6646718">t</span><span class="op" id="6646719">.</span><span class="ident" id="6646720">Errorf</span><span class="op" id="6646726">(</span><span class="string" id="6646727">&#34;clone&nbsp;does&nbsp;not&nbsp;contain&nbsp;self&nbsp;for&nbsp;%q&#34;</span><span class="op" id="6646763">,</span>&nbsp;<span class="ident" id="6646765">k</span><span class="op" id="6646766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6646770">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6646773">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6646776">//&nbsp;Execute&nbsp;root.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6646794">var</span>&nbsp;<span class="ident" id="6646798">b</span>&nbsp;<span class="ident" id="6646800">bytes</span><span class="op" id="6646805">.</span><span class="ident" id="6646806">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6646814">err</span>&nbsp;<span class="op" id="6646818">=</span>&nbsp;<span class="ident" id="6646820">root</span><span class="op" id="6646824">.</span><span class="ident" id="6646825">ExecuteTemplate</span><span class="op" id="6646840">(</span><span class="op" id="6646841">&amp;</span><span class="ident" id="6646842">b</span><span class="op" id="6646843">,</span>&nbsp;<span class="string" id="6646845">&#34;a&#34;</span><span class="op" id="6646848">,</span>&nbsp;<span class="num" id="6646850">0</span><span class="op" id="6646851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6646854">if</span>&nbsp;<span class="ident" id="6646857">err</span>&nbsp;<span class="op" id="6646861">!=</span>&nbsp;<span class="ident" id="6646864">nil</span>&nbsp;<span class="op" id="6646868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6646872">t</span><span class="op" id="6646873">.</span><span class="ident" id="6646874">Fatal</span><span class="op" id="6646879">(</span><span class="ident" id="6646880">err</span><span class="op" id="6646883">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6646886">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6646889">if</span>&nbsp;<span class="ident" id="6646892">b</span><span class="op" id="6646893">.</span><span class="ident" id="6646894">String</span><span class="op" id="6646900">(</span><span class="op" id="6646901">)</span>&nbsp;<span class="op" id="6646903">!=</span>&nbsp;<span class="string" id="6646906">&#34;broot&#34;</span>&nbsp;<span class="op" id="6646914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6646918">t</span><span class="op" id="6646919">.</span><span class="ident" id="6646920">Errorf</span><span class="op" id="6646926">(</span><span class="string" id="6646927">&#34;expected&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="6646947">,</span>&nbsp;<span class="string" id="6646949">&#34;broot&#34;</span><span class="op" id="6646956">,</span>&nbsp;<span class="ident" id="6646958">b</span><span class="op" id="6646959">.</span><span class="ident" id="6646960">String</span><span class="op" id="6646966">(</span><span class="op" id="6646967">)</span><span class="op" id="6646968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6646971">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6646974">//&nbsp;Execute&nbsp;copy.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6646992">b</span><span class="op" id="6646993">.</span><span class="ident" id="6646994">Reset</span><span class="op" id="6646999">(</span><span class="op" id="6647000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6647003">err</span>&nbsp;<span class="op" id="6647007">=</span>&nbsp;<span class="ident" id="6647009">clone</span><span class="op" id="6647014">.</span><span class="ident" id="6647015">ExecuteTemplate</span><span class="op" id="6647030">(</span><span class="op" id="6647031">&amp;</span><span class="ident" id="6647032">b</span><span class="op" id="6647033">,</span>&nbsp;<span class="string" id="6647035">&#34;a&#34;</span><span class="op" id="6647038">,</span>&nbsp;<span class="num" id="6647040">0</span><span class="op" id="6647041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6647044">if</span>&nbsp;<span class="ident" id="6647047">err</span>&nbsp;<span class="op" id="6647051">!=</span>&nbsp;<span class="ident" id="6647054">nil</span>&nbsp;<span class="op" id="6647058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6647062">t</span><span class="op" id="6647063">.</span><span class="ident" id="6647064">Fatal</span><span class="op" id="6647069">(</span><span class="ident" id="6647070">err</span><span class="op" id="6647073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6647076">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6647079">if</span>&nbsp;<span class="ident" id="6647082">b</span><span class="op" id="6647083">.</span><span class="ident" id="6647084">String</span><span class="op" id="6647090">(</span><span class="op" id="6647091">)</span>&nbsp;<span class="op" id="6647093">!=</span>&nbsp;<span class="string" id="6647096">&#34;bclone&#34;</span>&nbsp;<span class="op" id="6647105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6647109">t</span><span class="op" id="6647110">.</span><span class="ident" id="6647111">Errorf</span><span class="op" id="6647117">(</span><span class="string" id="6647118">&#34;expected&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="6647138">,</span>&nbsp;<span class="string" id="6647140">&#34;bclone&#34;</span><span class="op" id="6647148">,</span>&nbsp;<span class="ident" id="6647150">b</span><span class="op" id="6647151">.</span><span class="ident" id="6647152">String</span><span class="op" id="6647158">(</span><span class="op" id="6647159">)</span><span class="op" id="6647160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6647163">}</span><br>
<span class="lineno"></span><span class="op" id="6647165">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="6647168">func</span>&nbsp;<span class="ident" id="6647173">TestAddParseTree</span><span class="op" id="6647189">(</span><span class="ident" id="6647190">t</span>&nbsp;<span class="op" id="6647192">*</span><span class="ident" id="6647193">testing</span><span class="op" id="6647200">.</span><span class="ident" id="6647201">T</span><span class="op" id="6647202">)</span>&nbsp;<span class="op" id="6647204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6647207">//&nbsp;Create&nbsp;some&nbsp;templates.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6647234">root</span><span class="op" id="6647238">,</span>&nbsp;<span class="ident" id="6647240">err</span>&nbsp;<span class="op" id="6647244">:=</span>&nbsp;<span class="ident" id="6647247">New</span><span class="op" id="6647250">(</span><span class="string" id="6647251">&#34;root&#34;</span><span class="op" id="6647257">)</span><span class="op" id="6647258">.</span><span class="ident" id="6647259">Parse</span><span class="op" id="6647264">(</span><span class="ident" id="6647265">cloneText1</span><span class="op" id="6647275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6647278">if</span>&nbsp;<span class="ident" id="6647281">err</span>&nbsp;<span class="op" id="6647285">!=</span>&nbsp;<span class="ident" id="6647288">nil</span>&nbsp;<span class="op" id="6647292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6647296">t</span><span class="op" id="6647297">.</span><span class="ident" id="6647298">Fatal</span><span class="op" id="6647303">(</span><span class="ident" id="6647304">err</span><span class="op" id="6647307">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6647310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6647313">_</span><span class="op" id="6647314">,</span>&nbsp;<span class="ident" id="6647316">err</span>&nbsp;<span class="op" id="6647320">=</span>&nbsp;<span class="ident" id="6647322">root</span><span class="op" id="6647326">.</span><span class="ident" id="6647327">Parse</span><span class="op" id="6647332">(</span><span class="ident" id="6647333">cloneText2</span><span class="op" id="6647343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6647346">if</span>&nbsp;<span class="ident" id="6647349">err</span>&nbsp;<span class="op" id="6647353">!=</span>&nbsp;<span class="ident" id="6647356">nil</span>&nbsp;<span class="op" id="6647360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6647364">t</span><span class="op" id="6647365">.</span><span class="ident" id="6647366">Fatal</span><span class="op" id="6647371">(</span><span class="ident" id="6647372">err</span><span class="op" id="6647375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6647378">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6647381">//&nbsp;Add&nbsp;a&nbsp;new&nbsp;parse&nbsp;tree.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6647407">tree</span><span class="op" id="6647411">,</span>&nbsp;<span class="ident" id="6647413">err</span>&nbsp;<span class="op" id="6647417">:=</span>&nbsp;<span class="ident" id="6647420">parse</span><span class="op" id="6647425">.</span><span class="ident" id="6647426">Parse</span><span class="op" id="6647431">(</span><span class="string" id="6647432">&#34;cloneText3&#34;</span><span class="op" id="6647444">,</span>&nbsp;<span class="ident" id="6647446">cloneText3</span><span class="op" id="6647456">,</span>&nbsp;<span class="string" id="6647458">&#34;&#34;</span><span class="op" id="6647460">,</span>&nbsp;<span class="string" id="6647462">&#34;&#34;</span><span class="op" id="6647464">,</span>&nbsp;<span class="ident" id="6647466">nil</span><span class="op" id="6647469">,</span>&nbsp;<span class="ident" id="6647471">builtins</span><span class="op" id="6647479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6647482">if</span>&nbsp;<span class="ident" id="6647485">err</span>&nbsp;<span class="op" id="6647489">!=</span>&nbsp;<span class="ident" id="6647492">nil</span>&nbsp;<span class="op" id="6647496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6647500">t</span><span class="op" id="6647501">.</span><span class="ident" id="6647502">Fatal</span><span class="op" id="6647507">(</span><span class="ident" id="6647508">err</span><span class="op" id="6647511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6647514">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6647517">added</span><span class="op" id="6647522">,</span>&nbsp;<span class="ident" id="6647524">err</span>&nbsp;<span class="op" id="6647528">:=</span>&nbsp;<span class="ident" id="6647531">root</span><span class="op" id="6647535">.</span><span class="ident" id="6647536">AddParseTree</span><span class="op" id="6647548">(</span><span class="string" id="6647549">&#34;c&#34;</span><span class="op" id="6647552">,</span>&nbsp;<span class="ident" id="6647554">tree</span><span class="op" id="6647558">[</span><span class="string" id="6647559">&#34;c&#34;</span><span class="op" id="6647562">]</span><span class="op" id="6647563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6647566">//&nbsp;Execute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6647579">var</span>&nbsp;<span class="ident" id="6647583">b</span>&nbsp;<span class="ident" id="6647585">bytes</span><span class="op" id="6647590">.</span><span class="ident" id="6647591">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6647599">err</span>&nbsp;<span class="op" id="6647603">=</span>&nbsp;<span class="ident" id="6647605">added</span><span class="op" id="6647610">.</span><span class="ident" id="6647611">ExecuteTemplate</span><span class="op" id="6647626">(</span><span class="op" id="6647627">&amp;</span><span class="ident" id="6647628">b</span><span class="op" id="6647629">,</span>&nbsp;<span class="string" id="6647631">&#34;a&#34;</span><span class="op" id="6647634">,</span>&nbsp;<span class="num" id="6647636">0</span><span class="op" id="6647637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6647640">if</span>&nbsp;<span class="ident" id="6647643">err</span>&nbsp;<span class="op" id="6647647">!=</span>&nbsp;<span class="ident" id="6647650">nil</span>&nbsp;<span class="op" id="6647654">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6647658">t</span><span class="op" id="6647659">.</span><span class="ident" id="6647660">Fatal</span><span class="op" id="6647665">(</span><span class="ident" id="6647666">err</span><span class="op" id="6647669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6647672">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6647675">if</span>&nbsp;<span class="ident" id="6647678">b</span><span class="op" id="6647679">.</span><span class="ident" id="6647680">String</span><span class="op" id="6647686">(</span><span class="op" id="6647687">)</span>&nbsp;<span class="op" id="6647689">!=</span>&nbsp;<span class="string" id="6647692">&#34;broot&#34;</span>&nbsp;<span class="op" id="6647700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6647704">t</span><span class="op" id="6647705">.</span><span class="ident" id="6647706">Errorf</span><span class="op" id="6647712">(</span><span class="string" id="6647713">&#34;expected&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="6647733">,</span>&nbsp;<span class="string" id="6647735">&#34;broot&#34;</span><span class="op" id="6647742">,</span>&nbsp;<span class="ident" id="6647744">b</span><span class="op" id="6647745">.</span><span class="ident" id="6647746">String</span><span class="op" id="6647752">(</span><span class="op" id="6647753">)</span><span class="op" id="6647754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6647757">}</span><br>
<span class="lineno">260</span><span class="op" id="6647759">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6647762">//&nbsp;Issue&nbsp;7032</span><br>
<span class="lineno"></span><span class="keyword" id="6647776">func</span>&nbsp;<span class="ident" id="6647781">TestAddParseTreeToUnparsedTemplate</span><span class="op" id="6647815">(</span><span class="ident" id="6647816">t</span>&nbsp;<span class="op" id="6647818">*</span><span class="ident" id="6647819">testing</span><span class="op" id="6647826">.</span><span class="ident" id="6647827">T</span><span class="op" id="6647828">)</span>&nbsp;<span class="op" id="6647830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6647833">master</span>&nbsp;<span class="op" id="6647840">:=</span>&nbsp;<span class="string" id="6647843">&#34;{{define&nbsp;\&#34;master\&#34;}}{{end}}&#34;</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6647875">tmpl</span>&nbsp;<span class="op" id="6647880">:=</span>&nbsp;<span class="ident" id="6647883">New</span><span class="op" id="6647886">(</span><span class="string" id="6647887">&#34;master&#34;</span><span class="op" id="6647895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6647898">tree</span><span class="op" id="6647902">,</span>&nbsp;<span class="ident" id="6647904">err</span>&nbsp;<span class="op" id="6647908">:=</span>&nbsp;<span class="ident" id="6647911">parse</span><span class="op" id="6647916">.</span><span class="ident" id="6647917">Parse</span><span class="op" id="6647922">(</span><span class="string" id="6647923">&#34;master&#34;</span><span class="op" id="6647931">,</span>&nbsp;<span class="ident" id="6647933">master</span><span class="op" id="6647939">,</span>&nbsp;<span class="string" id="6647941">&#34;&#34;</span><span class="op" id="6647943">,</span>&nbsp;<span class="string" id="6647945">&#34;&#34;</span><span class="op" id="6647947">,</span>&nbsp;<span class="ident" id="6647949">nil</span><span class="op" id="6647952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6647955">if</span>&nbsp;<span class="ident" id="6647958">err</span>&nbsp;<span class="op" id="6647962">!=</span>&nbsp;<span class="ident" id="6647965">nil</span>&nbsp;<span class="op" id="6647969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6647973">t</span><span class="op" id="6647974">.</span><span class="ident" id="6647975">Fatalf</span><span class="op" id="6647981">(</span><span class="string" id="6647982">&#34;unexpected&nbsp;parse&nbsp;err:&nbsp;%v&#34;</span><span class="op" id="6648008">,</span>&nbsp;<span class="ident" id="6648010">err</span><span class="op" id="6648013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6648016">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6648019">masterTree</span>&nbsp;<span class="op" id="6648030">:=</span>&nbsp;<span class="ident" id="6648033">tree</span><span class="op" id="6648037">[</span><span class="string" id="6648038">&#34;master&#34;</span><span class="op" id="6648046">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6648049">tmpl</span><span class="op" id="6648053">.</span><span class="ident" id="6648054">AddParseTree</span><span class="op" id="6648066">(</span><span class="string" id="6648067">&#34;master&#34;</span><span class="op" id="6648075">,</span>&nbsp;<span class="ident" id="6648077">masterTree</span><span class="op" id="6648087">)</span>&nbsp;<span class="comment" id="6648089">//&nbsp;used&nbsp;to&nbsp;panic</span><br>
<span class="lineno"></span><span class="op" id="6648106">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6648109">func</span>&nbsp;<span class="ident" id="6648114">TestRedefinition</span><span class="op" id="6648130">(</span><span class="ident" id="6648131">t</span>&nbsp;<span class="op" id="6648133">*</span><span class="ident" id="6648134">testing</span><span class="op" id="6648141">.</span><span class="ident" id="6648142">T</span><span class="op" id="6648143">)</span>&nbsp;<span class="op" id="6648145">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6648148">var</span>&nbsp;<span class="ident" id="6648152">tmpl</span>&nbsp;<span class="op" id="6648157">*</span><span class="ident" id="6648158">Template</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6648168">var</span>&nbsp;<span class="ident" id="6648172">err</span>&nbsp;<span class="builtintype" id="6648176">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6648183">if</span>&nbsp;<span class="ident" id="6648186">tmpl</span><span class="op" id="6648190">,</span>&nbsp;<span class="ident" id="6648192">err</span>&nbsp;<span class="op" id="6648196">=</span>&nbsp;<span class="ident" id="6648198">New</span><span class="op" id="6648201">(</span><span class="string" id="6648202">&#34;tmpl1&#34;</span><span class="op" id="6648209">)</span><span class="op" id="6648210">.</span><span class="ident" id="6648211">Parse</span><span class="op" id="6648216">(</span><span class="string" id="6648217">`{{define&nbsp;&#34;test&#34;}}foo{{end}}`</span><span class="op" id="6648246">)</span><span class="op" id="6648247">;</span>&nbsp;<span class="ident" id="6648249">err</span>&nbsp;<span class="op" id="6648253">!=</span>&nbsp;<span class="ident" id="6648256">nil</span>&nbsp;<span class="op" id="6648260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6648264">t</span><span class="op" id="6648265">.</span><span class="ident" id="6648266">Fatalf</span><span class="op" id="6648272">(</span><span class="string" id="6648273">&#34;parse&nbsp;1:&nbsp;%v&#34;</span><span class="op" id="6648286">,</span>&nbsp;<span class="ident" id="6648288">err</span><span class="op" id="6648291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6648294">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6648297">if</span>&nbsp;<span class="ident" id="6648300">_</span><span class="op" id="6648301">,</span>&nbsp;<span class="ident" id="6648303">err</span>&nbsp;<span class="op" id="6648307">=</span>&nbsp;<span class="ident" id="6648309">tmpl</span><span class="op" id="6648313">.</span><span class="ident" id="6648314">Parse</span><span class="op" id="6648319">(</span><span class="string" id="6648320">`{{define&nbsp;&#34;test&#34;}}bar{{end}}`</span><span class="op" id="6648349">)</span><span class="op" id="6648350">;</span>&nbsp;<span class="ident" id="6648352">err</span>&nbsp;<span class="op" id="6648356">==</span>&nbsp;<span class="ident" id="6648359">nil</span>&nbsp;<span class="op" id="6648363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6648367">t</span><span class="op" id="6648368">.</span><span class="ident" id="6648369">Fatal</span><span class="op" id="6648374">(</span><span class="string" id="6648375">&#34;expected&nbsp;error&#34;</span><span class="op" id="6648391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6648394">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6648397">if</span>&nbsp;<span class="op" id="6648400">!</span><span class="ident" id="6648401">strings</span><span class="op" id="6648408">.</span><span class="ident" id="6648409">Contains</span><span class="op" id="6648417">(</span><span class="ident" id="6648418">err</span><span class="op" id="6648421">.</span><span class="ident" id="6648422">Error</span><span class="op" id="6648427">(</span><span class="op" id="6648428">)</span><span class="op" id="6648429">,</span>&nbsp;<span class="string" id="6648431">&#34;redefinition&#34;</span><span class="op" id="6648445">)</span>&nbsp;<span class="op" id="6648447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6648451">t</span><span class="op" id="6648452">.</span><span class="ident" id="6648453">Fatalf</span><span class="op" id="6648459">(</span><span class="string" id="6648460">&#34;expected&nbsp;redefinition&nbsp;error;&nbsp;got&nbsp;%v&#34;</span><span class="op" id="6648497">,</span>&nbsp;<span class="ident" id="6648499">err</span><span class="op" id="6648502">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6648505">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6648508">if</span>&nbsp;<span class="ident" id="6648511">_</span><span class="op" id="6648512">,</span>&nbsp;<span class="ident" id="6648514">err</span>&nbsp;<span class="op" id="6648518">=</span>&nbsp;<span class="ident" id="6648520">tmpl</span><span class="op" id="6648524">.</span><span class="ident" id="6648525">New</span><span class="op" id="6648528">(</span><span class="string" id="6648529">&#34;tmpl2&#34;</span><span class="op" id="6648536">)</span><span class="op" id="6648537">.</span><span class="ident" id="6648538">Parse</span><span class="op" id="6648543">(</span><span class="string" id="6648544">`{{define&nbsp;&#34;test&#34;}}bar{{end}}`</span><span class="op" id="6648573">)</span><span class="op" id="6648574">;</span>&nbsp;<span class="ident" id="6648576">err</span>&nbsp;<span class="op" id="6648580">==</span>&nbsp;<span class="ident" id="6648583">nil</span>&nbsp;<span class="op" id="6648587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6648591">t</span><span class="op" id="6648592">.</span><span class="ident" id="6648593">Fatal</span><span class="op" id="6648598">(</span><span class="string" id="6648599">&#34;expected&nbsp;error&#34;</span><span class="op" id="6648615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6648618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6648621">if</span>&nbsp;<span class="op" id="6648624">!</span><span class="ident" id="6648625">strings</span><span class="op" id="6648632">.</span><span class="ident" id="6648633">Contains</span><span class="op" id="6648641">(</span><span class="ident" id="6648642">err</span><span class="op" id="6648645">.</span><span class="ident" id="6648646">Error</span><span class="op" id="6648651">(</span><span class="op" id="6648652">)</span><span class="op" id="6648653">,</span>&nbsp;<span class="string" id="6648655">&#34;redefinition&#34;</span><span class="op" id="6648669">)</span>&nbsp;<span class="op" id="6648671">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6648675">t</span><span class="op" id="6648676">.</span><span class="ident" id="6648677">Fatalf</span><span class="op" id="6648683">(</span><span class="string" id="6648684">&#34;expected&nbsp;redefinition&nbsp;error;&nbsp;got&nbsp;%v&#34;</span><span class="op" id="6648721">,</span>&nbsp;<span class="ident" id="6648723">err</span><span class="op" id="6648726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6648729">}</span><br>
<span class="lineno"></span><span class="op" id="6648731">}</span>
</div>
</body>
</html>
