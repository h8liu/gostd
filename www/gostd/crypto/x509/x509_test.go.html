<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html" class="current">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7493275">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7493330">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7493384">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7493435">package</span>&nbsp;<span class="ident" id="7493443">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7493449">import</span>&nbsp;<span class="op" id="7493456">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7493459">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7493468">&#34;crypto/dsa&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7493482">&#34;crypto/ecdsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7493498">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7493517">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7493532">&#34;crypto/rsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7493546">_</span>&nbsp;<span class="string" id="7493548">&#34;crypto/sha256&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7493565">_</span>&nbsp;<span class="string" id="7493567">&#34;crypto/sha512&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7493584">&#34;crypto/x509/pkix&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7493604">&#34;encoding/asn1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7493621">&#34;encoding/base64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7493640">&#34;encoding/hex&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7493656">&#34;encoding/pem&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7493672">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7493684">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7493691">&#34;os/exec&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7493702">&#34;reflect&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7493713">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7493724">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7493735">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="7493742">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="7493745">func</span>&nbsp;<span class="ident" id="7493750">TestParsePKCS1PrivateKey</span><span class="op" id="7493774">(</span><span class="ident" id="7493775">t</span>&nbsp;<span class="op" id="7493777">*</span><span class="ident" id="7493778">testing</span><span class="op" id="7493785">.</span><span class="ident" id="7493786">T</span><span class="op" id="7493787">)</span>&nbsp;<span class="op" id="7493789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7493792">block</span><span class="op" id="7493797">,</span>&nbsp;<span class="ident" id="7493799">_</span>&nbsp;<span class="op" id="7493801">:=</span>&nbsp;<span class="ident" id="7493804">pem</span><span class="op" id="7493807">.</span><span class="ident" id="7493808">Decode</span><span class="op" id="7493814">(</span><span class="op" id="7493815">[</span><span class="op" id="7493816">]</span><span class="builtintype" id="7493817">byte</span><span class="op" id="7493821">(</span><span class="ident" id="7493822">pemPrivateKey</span><span class="op" id="7493835">)</span><span class="op" id="7493836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7493839">priv</span><span class="op" id="7493843">,</span>&nbsp;<span class="ident" id="7493845">err</span>&nbsp;<span class="op" id="7493849">:=</span>&nbsp;<span class="ident" id="7493852">ParsePKCS1PrivateKey</span><span class="op" id="7493872">(</span><span class="ident" id="7493873">block</span><span class="op" id="7493878">.</span><span class="ident" id="7493879">Bytes</span><span class="op" id="7493884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7493887">if</span>&nbsp;<span class="ident" id="7493890">err</span>&nbsp;<span class="op" id="7493894">!=</span>&nbsp;<span class="builtintype" id="7493897">nil</span>&nbsp;<span class="op" id="7493901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7493905">t</span><span class="op" id="7493906">.</span><span class="ident" id="7493907">Errorf</span><span class="op" id="7493913">(</span><span class="string" id="7493914">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7493947">,</span>&nbsp;<span class="ident" id="7493949">err</span><span class="op" id="7493952">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7493956">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7493964">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7493967">if</span>&nbsp;<span class="ident" id="7493970">priv</span><span class="op" id="7493974">.</span><span class="ident" id="7493975">PublicKey</span><span class="op" id="7493984">.</span><span class="ident" id="7493985">N</span><span class="op" id="7493986">.</span><span class="ident" id="7493987">Cmp</span><span class="op" id="7493990">(</span><span class="ident" id="7493991">rsaPrivateKey</span><span class="op" id="7494004">.</span><span class="ident" id="7494005">PublicKey</span><span class="op" id="7494014">.</span><span class="ident" id="7494015">N</span><span class="op" id="7494016">)</span>&nbsp;<span class="op" id="7494018">!=</span>&nbsp;<span class="num" id="7494021">0</span>&nbsp;<span class="op" id="7494023">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7494028">priv</span><span class="op" id="7494032">.</span><span class="ident" id="7494033">PublicKey</span><span class="op" id="7494042">.</span><span class="ident" id="7494043">E</span>&nbsp;<span class="op" id="7494045">!=</span>&nbsp;<span class="ident" id="7494048">rsaPrivateKey</span><span class="op" id="7494061">.</span><span class="ident" id="7494062">PublicKey</span><span class="op" id="7494071">.</span><span class="ident" id="7494072">E</span>&nbsp;<span class="op" id="7494074">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7494079">priv</span><span class="op" id="7494083">.</span><span class="ident" id="7494084">D</span><span class="op" id="7494085">.</span><span class="ident" id="7494086">Cmp</span><span class="op" id="7494089">(</span><span class="ident" id="7494090">rsaPrivateKey</span><span class="op" id="7494103">.</span><span class="ident" id="7494104">D</span><span class="op" id="7494105">)</span>&nbsp;<span class="op" id="7494107">!=</span>&nbsp;<span class="num" id="7494110">0</span>&nbsp;<span class="op" id="7494112">||</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7494117">priv</span><span class="op" id="7494121">.</span><span class="ident" id="7494122">Primes</span><span class="op" id="7494128">[</span><span class="num" id="7494129">0</span><span class="op" id="7494130">]</span><span class="op" id="7494131">.</span><span class="ident" id="7494132">Cmp</span><span class="op" id="7494135">(</span><span class="ident" id="7494136">rsaPrivateKey</span><span class="op" id="7494149">.</span><span class="ident" id="7494150">Primes</span><span class="op" id="7494156">[</span><span class="num" id="7494157">0</span><span class="op" id="7494158">]</span><span class="op" id="7494159">)</span>&nbsp;<span class="op" id="7494161">!=</span>&nbsp;<span class="num" id="7494164">0</span>&nbsp;<span class="op" id="7494166">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7494171">priv</span><span class="op" id="7494175">.</span><span class="ident" id="7494176">Primes</span><span class="op" id="7494182">[</span><span class="num" id="7494183">1</span><span class="op" id="7494184">]</span><span class="op" id="7494185">.</span><span class="ident" id="7494186">Cmp</span><span class="op" id="7494189">(</span><span class="ident" id="7494190">rsaPrivateKey</span><span class="op" id="7494203">.</span><span class="ident" id="7494204">Primes</span><span class="op" id="7494210">[</span><span class="num" id="7494211">1</span><span class="op" id="7494212">]</span><span class="op" id="7494213">)</span>&nbsp;<span class="op" id="7494215">!=</span>&nbsp;<span class="num" id="7494218">0</span>&nbsp;<span class="op" id="7494220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7494224">t</span><span class="op" id="7494225">.</span><span class="ident" id="7494226">Errorf</span><span class="op" id="7494232">(</span><span class="string" id="7494233">&#34;got:%+v&nbsp;want:%+v&#34;</span><span class="op" id="7494251">,</span>&nbsp;<span class="ident" id="7494253">priv</span><span class="op" id="7494257">,</span>&nbsp;<span class="ident" id="7494259">rsaPrivateKey</span><span class="op" id="7494272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7494275">}</span><br>
<span class="lineno"></span><span class="op" id="7494277">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="7494280">func</span>&nbsp;<span class="ident" id="7494285">TestParsePKIXPublicKey</span><span class="op" id="7494307">(</span><span class="ident" id="7494308">t</span>&nbsp;<span class="op" id="7494310">*</span><span class="ident" id="7494311">testing</span><span class="op" id="7494318">.</span><span class="ident" id="7494319">T</span><span class="op" id="7494320">)</span>&nbsp;<span class="op" id="7494322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7494325">block</span><span class="op" id="7494330">,</span>&nbsp;<span class="ident" id="7494332">_</span>&nbsp;<span class="op" id="7494334">:=</span>&nbsp;<span class="ident" id="7494337">pem</span><span class="op" id="7494340">.</span><span class="ident" id="7494341">Decode</span><span class="op" id="7494347">(</span><span class="op" id="7494348">[</span><span class="op" id="7494349">]</span><span class="builtintype" id="7494350">byte</span><span class="op" id="7494354">(</span><span class="ident" id="7494355">pemPublicKey</span><span class="op" id="7494367">)</span><span class="op" id="7494368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7494371">pub</span><span class="op" id="7494374">,</span>&nbsp;<span class="ident" id="7494376">err</span>&nbsp;<span class="op" id="7494380">:=</span>&nbsp;<span class="ident" id="7494383">ParsePKIXPublicKey</span><span class="op" id="7494401">(</span><span class="ident" id="7494402">block</span><span class="op" id="7494407">.</span><span class="ident" id="7494408">Bytes</span><span class="op" id="7494413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7494416">if</span>&nbsp;<span class="ident" id="7494419">err</span>&nbsp;<span class="op" id="7494423">!=</span>&nbsp;<span class="builtintype" id="7494426">nil</span>&nbsp;<span class="op" id="7494430">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7494434">t</span><span class="op" id="7494435">.</span><span class="ident" id="7494436">Errorf</span><span class="op" id="7494442">(</span><span class="string" id="7494443">&#34;Failed&nbsp;to&nbsp;parse&nbsp;RSA&nbsp;public&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7494479">,</span>&nbsp;<span class="ident" id="7494481">err</span><span class="op" id="7494484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7494488">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7494496">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7494499">rsaPub</span><span class="op" id="7494505">,</span>&nbsp;<span class="ident" id="7494507">ok</span>&nbsp;<span class="op" id="7494510">:=</span>&nbsp;<span class="ident" id="7494513">pub</span><span class="op" id="7494516">.</span><span class="op" id="7494517">(</span><span class="op" id="7494518">*</span><span class="ident" id="7494519">rsa</span><span class="op" id="7494522">.</span><span class="ident" id="7494523">PublicKey</span><span class="op" id="7494532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7494535">if</span>&nbsp;<span class="op" id="7494538">!</span><span class="ident" id="7494539">ok</span>&nbsp;<span class="op" id="7494542">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7494546">t</span><span class="op" id="7494547">.</span><span class="ident" id="7494548">Errorf</span><span class="op" id="7494554">(</span><span class="string" id="7494555">&#34;Value&nbsp;returned&nbsp;from&nbsp;ParsePKIXPublicKey&nbsp;was&nbsp;not&nbsp;an&nbsp;RSA&nbsp;public&nbsp;key&#34;</span><span class="op" id="7494621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7494625">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7494633">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7494637">pubBytes2</span><span class="op" id="7494646">,</span>&nbsp;<span class="ident" id="7494648">err</span>&nbsp;<span class="op" id="7494652">:=</span>&nbsp;<span class="ident" id="7494655">MarshalPKIXPublicKey</span><span class="op" id="7494675">(</span><span class="ident" id="7494676">rsaPub</span><span class="op" id="7494682">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7494685">if</span>&nbsp;<span class="ident" id="7494688">err</span>&nbsp;<span class="op" id="7494692">!=</span>&nbsp;<span class="builtintype" id="7494695">nil</span>&nbsp;<span class="op" id="7494699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7494703">t</span><span class="op" id="7494704">.</span><span class="ident" id="7494705">Errorf</span><span class="op" id="7494711">(</span><span class="string" id="7494712">&#34;Failed&nbsp;to&nbsp;marshal&nbsp;RSA&nbsp;public&nbsp;key&nbsp;for&nbsp;the&nbsp;second&nbsp;time:&nbsp;%s&#34;</span><span class="op" id="7494770">,</span>&nbsp;<span class="ident" id="7494772">err</span><span class="op" id="7494775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7494779">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7494787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7494790">if</span>&nbsp;<span class="op" id="7494793">!</span><span class="ident" id="7494794">bytes</span><span class="op" id="7494799">.</span><span class="ident" id="7494800">Equal</span><span class="op" id="7494805">(</span><span class="ident" id="7494806">pubBytes2</span><span class="op" id="7494815">,</span>&nbsp;<span class="ident" id="7494817">block</span><span class="op" id="7494822">.</span><span class="ident" id="7494823">Bytes</span><span class="op" id="7494828">)</span>&nbsp;<span class="op" id="7494830">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7494834">t</span><span class="op" id="7494835">.</span><span class="ident" id="7494836">Errorf</span><span class="op" id="7494842">(</span><span class="string" id="7494843">&#34;Reserialization&nbsp;of&nbsp;public&nbsp;key&nbsp;didn&#39;t&nbsp;match.&nbsp;got&nbsp;%x,&nbsp;want&nbsp;%x&#34;</span><span class="op" id="7494904">,</span>&nbsp;<span class="ident" id="7494906">pubBytes2</span><span class="op" id="7494915">,</span>&nbsp;<span class="ident" id="7494917">block</span><span class="op" id="7494922">.</span><span class="ident" id="7494923">Bytes</span><span class="op" id="7494928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7494931">}</span><br>
<span class="lineno"></span><span class="op" id="7494933">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7494936">var</span>&nbsp;<span class="ident" id="7494940">pemPublicKey</span>&nbsp;<span class="op" id="7494953">=</span>&nbsp;<span class="string" id="7494955">`-----BEGIN&nbsp;PUBLIC&nbsp;KEY-----<br>
<span class="lineno">70</span>MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA3VoPN9PKUjKFLMwOge6+<br>
<span class="lineno"></span>wnDi8sbETGIx2FKXGgqtAKpzmem53kRGEQg8WeqRmp12wgp74TGpkEXsGae7RS1k<br>
<span class="lineno"></span>enJCnma4fii+noGH7R0qKgHvPrI2Bwa9hzsH8tHxpyM3qrXslOmD45EH9SxIDUBJ<br>
<span class="lineno"></span>FehNdaPbLP1gFyahKMsdfxFJLUvbUycuZSJ2ZnIgeVxwm4qbSvZInL9Iu4FzuPtg<br>
<span class="lineno"></span>fINKcbbovy1qq4KvPIrXzhbY3PWDc6btxCf3SE0JdE1MCPThntB62/bLMSQ7xdDR<br>
<span class="lineno">75</span>FF53oIpvxe/SCOymfWq/LW849Ytv3Xwod0+wzAP8STXG4HSELS4UedPYeHJJJYcZ<br>
<span class="lineno"></span>+QIDAQAB<br>
<span class="lineno"></span>-----END&nbsp;PUBLIC&nbsp;KEY-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="7495410">var</span>&nbsp;<span class="ident" id="7495414">pemPrivateKey</span>&nbsp;<span class="op" id="7495428">=</span>&nbsp;<span class="string" id="7495430">`-----BEGIN&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno"></span>MIIBOgIBAAJBALKZD0nEffqM1ACuak0bijtqE2QrI/KLADv7l3kK3ppMyCuLKoF0<br>
<span class="lineno"></span>fd7Ai2KW5ToIwzFofvJcS/STa6HA5gQenRUCAwEAAQJBAIq9amn00aS0h/CrjXqu<br>
<span class="lineno"></span>/ThglAXJmZhOMPVn4eiu7/ROixi9sex436MaVeMqSNf7Ex9a8fRNfWss7Sqd9eWu<br>
<span class="lineno"></span>RTUCIQDasvGASLqmjeffBNLTXV2A5g4t+kLVCpsEIZAycV5GswIhANEPLmax0ME/<br>
<span class="lineno">85</span>EO+ZJ79TJKN5yiGBRsv5yvx5UiHxajEXAiAhAol5N4EUyq6I9w1rYdhPMGpLfk7A<br>
<span class="lineno"></span>IU2snfRJ6Nq2CQIgFrPsWRCkV+gOYcajD17rEqmuLrdIRexpg8N1DOSXoJ8CIGlS<br>
<span class="lineno"></span>tAboUGBxTDq3ZroNism3DaMIbKPyYrAqhKov1h5V<br>
<span class="lineno"></span>-----END&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="7495927">func</span>&nbsp;<span class="ident" id="7495932">bigFromString</span><span class="op" id="7495945">(</span><span class="ident" id="7495946">s</span>&nbsp;<span class="builtintype" id="7495948">string</span><span class="op" id="7495954">)</span>&nbsp;<span class="op" id="7495956">*</span><span class="ident" id="7495957">big</span><span class="op" id="7495960">.</span><span class="ident" id="7495961">Int</span>&nbsp;<span class="op" id="7495965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7495968">ret</span>&nbsp;<span class="op" id="7495972">:=</span>&nbsp;<span class="builtinfunc" id="7495975">new</span><span class="op" id="7495978">(</span><span class="ident" id="7495979">big</span><span class="op" id="7495982">.</span><span class="ident" id="7495983">Int</span><span class="op" id="7495986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7495989">ret</span><span class="op" id="7495992">.</span><span class="ident" id="7495993">SetString</span><span class="op" id="7496002">(</span><span class="ident" id="7496003">s</span><span class="op" id="7496004">,</span>&nbsp;<span class="num" id="7496006">10</span><span class="op" id="7496008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7496011">return</span>&nbsp;<span class="ident" id="7496018">ret</span><br>
<span class="lineno">95</span><span class="op" id="7496022">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7496025">func</span>&nbsp;<span class="ident" id="7496030">fromBase10</span><span class="op" id="7496040">(</span><span class="ident" id="7496041">base10</span>&nbsp;<span class="builtintype" id="7496048">string</span><span class="op" id="7496054">)</span>&nbsp;<span class="op" id="7496056">*</span><span class="ident" id="7496057">big</span><span class="op" id="7496060">.</span><span class="ident" id="7496061">Int</span>&nbsp;<span class="op" id="7496065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7496068">i</span>&nbsp;<span class="op" id="7496070">:=</span>&nbsp;<span class="builtinfunc" id="7496073">new</span><span class="op" id="7496076">(</span><span class="ident" id="7496077">big</span><span class="op" id="7496080">.</span><span class="ident" id="7496081">Int</span><span class="op" id="7496084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7496087">i</span><span class="op" id="7496088">.</span><span class="ident" id="7496089">SetString</span><span class="op" id="7496098">(</span><span class="ident" id="7496099">base10</span><span class="op" id="7496105">,</span>&nbsp;<span class="num" id="7496107">10</span><span class="op" id="7496109">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7496112">return</span>&nbsp;<span class="ident" id="7496119">i</span><br>
<span class="lineno"></span><span class="op" id="7496121">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7496124">func</span>&nbsp;<span class="ident" id="7496129">bigFromHexString</span><span class="op" id="7496145">(</span><span class="ident" id="7496146">s</span>&nbsp;<span class="builtintype" id="7496148">string</span><span class="op" id="7496154">)</span>&nbsp;<span class="op" id="7496156">*</span><span class="ident" id="7496157">big</span><span class="op" id="7496160">.</span><span class="ident" id="7496161">Int</span>&nbsp;<span class="op" id="7496165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7496168">ret</span>&nbsp;<span class="op" id="7496172">:=</span>&nbsp;<span class="builtinfunc" id="7496175">new</span><span class="op" id="7496178">(</span><span class="ident" id="7496179">big</span><span class="op" id="7496182">.</span><span class="ident" id="7496183">Int</span><span class="op" id="7496186">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7496189">ret</span><span class="op" id="7496192">.</span><span class="ident" id="7496193">SetString</span><span class="op" id="7496202">(</span><span class="ident" id="7496203">s</span><span class="op" id="7496204">,</span>&nbsp;<span class="num" id="7496206">16</span><span class="op" id="7496208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7496211">return</span>&nbsp;<span class="ident" id="7496218">ret</span><br>
<span class="lineno"></span><span class="op" id="7496222">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7496225">var</span>&nbsp;<span class="ident" id="7496229">rsaPrivateKey</span>&nbsp;<span class="op" id="7496243">=</span>&nbsp;<span class="op" id="7496245">&amp;</span><span class="ident" id="7496246">rsa</span><span class="op" id="7496249">.</span><span class="ident" id="7496250">PrivateKey</span><span class="op" id="7496260">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7496263">PublicKey</span><span class="op" id="7496272">:</span>&nbsp;<span class="ident" id="7496274">rsa</span><span class="op" id="7496277">.</span><span class="ident" id="7496278">PublicKey</span><span class="op" id="7496287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7496291">N</span><span class="op" id="7496292">:</span>&nbsp;<span class="ident" id="7496294">bigFromString</span><span class="op" id="7496307">(</span><span class="string" id="7496308">&#34;9353930466774385905609975137998169297361893554149986716853295022578535724979677252958524466350471210367835187480748268864277464700638583474144061408845077&#34;</span><span class="op" id="7496464">)</span><span class="op" id="7496465">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7496469">E</span><span class="op" id="7496470">:</span>&nbsp;<span class="num" id="7496472">65537</span><span class="op" id="7496477">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7496480">}</span><span class="op" id="7496481">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7496484">D</span><span class="op" id="7496485">:</span>&nbsp;<span class="ident" id="7496487">bigFromString</span><span class="op" id="7496500">(</span><span class="string" id="7496501">&#34;7266398431328116344057699379749222532279343923819063639497049039389899328538543087657733766554155839834519529439851673014800261285757759040931985506583861&#34;</span><span class="op" id="7496657">)</span><span class="op" id="7496658">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7496661">Primes</span><span class="op" id="7496667">:</span>&nbsp;<span class="op" id="7496669">[</span><span class="op" id="7496670">]</span><span class="op" id="7496671">*</span><span class="ident" id="7496672">big</span><span class="op" id="7496675">.</span><span class="ident" id="7496676">Int</span><span class="op" id="7496679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7496683">bigFromString</span><span class="op" id="7496696">(</span><span class="string" id="7496697">&#34;98920366548084643601728869055592650835572950932266967461790948584315647051443&#34;</span><span class="op" id="7496776">)</span><span class="op" id="7496777">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7496781">bigFromString</span><span class="op" id="7496794">(</span><span class="string" id="7496795">&#34;94560208308847015747498523884063394671606671904944666360068158221458669711639&#34;</span><span class="op" id="7496874">)</span><span class="op" id="7496875">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7496878">}</span><span class="op" id="7496879">,</span><br>
<span class="lineno"></span><span class="op" id="7496881">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="7496884">func</span>&nbsp;<span class="ident" id="7496889">TestMarshalRSAPrivateKey</span><span class="op" id="7496913">(</span><span class="ident" id="7496914">t</span>&nbsp;<span class="op" id="7496916">*</span><span class="ident" id="7496917">testing</span><span class="op" id="7496924">.</span><span class="ident" id="7496925">T</span><span class="op" id="7496926">)</span>&nbsp;<span class="op" id="7496928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7496931">priv</span>&nbsp;<span class="op" id="7496936">:=</span>&nbsp;<span class="op" id="7496939">&amp;</span><span class="ident" id="7496940">rsa</span><span class="op" id="7496943">.</span><span class="ident" id="7496944">PrivateKey</span><span class="op" id="7496954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7496958">PublicKey</span><span class="op" id="7496967">:</span>&nbsp;<span class="ident" id="7496969">rsa</span><span class="op" id="7496972">.</span><span class="ident" id="7496973">PublicKey</span><span class="op" id="7496982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7496987">N</span><span class="op" id="7496988">:</span>&nbsp;<span class="ident" id="7496990">fromBase10</span><span class="op" id="7497000">(</span><span class="string" id="7497001">&#34;16346378922382193400538269749936049106320265317511766357599732575277382844051791096569333808598921852351577762718529818072849191122419410612033592401403764925096136759934497687765453905884149505175426053037420486697072448609022753683683718057795566811401938833367954642951433473337066311978821180526439641496973296037000052546108507805269279414789035461158073156772151892452251106173507240488993608650881929629163465099476849643165682709047462010581308719577053905787496296934240246311806555924593059995202856826239801816771116902778517096212527979497399966526283516447337775509777558018145573127308919204297111496233&#34;</span><span class="op" id="7497620">)</span><span class="op" id="7497621">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7497626">E</span><span class="op" id="7497627">:</span>&nbsp;<span class="num" id="7497629">3</span><span class="op" id="7497630">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7497634">}</span><span class="op" id="7497635">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7497639">D</span><span class="op" id="7497640">:</span>&nbsp;<span class="ident" id="7497642">fromBase10</span><span class="op" id="7497652">(</span><span class="string" id="7497653">&#34;10897585948254795600358846499957366070880176878341177571733155050184921896034527397712889205732614568234385175145686545381899460748279607074689061600935843283397424506622998458510302603922766336783617368686090042765718290914099334449154829375179958369993407724946186243249568928237086215759259909861748642124071874879861299389874230489928271621259294894142840428407196932444474088857746123104978617098858619445675532587787023228852383149557470077802718705420275739737958953794088728369933811184572620857678792001136676902250566845618813972833750098806496641114644760255910789397593428910198080271317419213080834885003&#34;</span><span class="op" id="7498272">)</span><span class="op" id="7498273">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7498277">Primes</span><span class="op" id="7498283">:</span>&nbsp;<span class="op" id="7498285">[</span><span class="op" id="7498286">]</span><span class="op" id="7498287">*</span><span class="ident" id="7498288">big</span><span class="op" id="7498291">.</span><span class="ident" id="7498292">Int</span><span class="op" id="7498295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7498300">fromBase10</span><span class="op" id="7498310">(</span><span class="string" id="7498311">&#34;1025363189502892836833747188838978207017355117492483312747347695538428729137306368764177201532277413433182799108299960196606011786562992097313508180436744488171474690412562218914213688661311117337381958560443&#34;</span><span class="op" id="7498521">)</span><span class="op" id="7498522">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7498527">fromBase10</span><span class="op" id="7498537">(</span><span class="string" id="7498538">&#34;3467903426626310123395340254094941045497208049900750380025518552334536945536837294961497712862519984786362199788654739924501424784631315081391467293694361474867825728031147665777546570788493758372218019373&#34;</span><span class="op" id="7498745">)</span><span class="op" id="7498746">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7498751">fromBase10</span><span class="op" id="7498761">(</span><span class="string" id="7498762">&#34;4597024781409332673052708605078359346966325141767460991205742124888960305710298765592730135879076084498363772408626791576005136245060321874472727132746643162385746062759369754202494417496879741537284589047&#34;</span><span class="op" id="7498969">)</span><span class="op" id="7498970">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7498974">}</span><span class="op" id="7498975">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7498978">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7498982">derBytes</span>&nbsp;<span class="op" id="7498991">:=</span>&nbsp;<span class="ident" id="7498994">MarshalPKCS1PrivateKey</span><span class="op" id="7499016">(</span><span class="ident" id="7499017">priv</span><span class="op" id="7499021">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7499025">priv2</span><span class="op" id="7499030">,</span>&nbsp;<span class="ident" id="7499032">err</span>&nbsp;<span class="op" id="7499036">:=</span>&nbsp;<span class="ident" id="7499039">ParsePKCS1PrivateKey</span><span class="op" id="7499059">(</span><span class="ident" id="7499060">derBytes</span><span class="op" id="7499068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7499071">if</span>&nbsp;<span class="ident" id="7499074">err</span>&nbsp;<span class="op" id="7499078">!=</span>&nbsp;<span class="builtintype" id="7499081">nil</span>&nbsp;<span class="op" id="7499085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7499089">t</span><span class="op" id="7499090">.</span><span class="ident" id="7499091">Errorf</span><span class="op" id="7499097">(</span><span class="string" id="7499098">&#34;error&nbsp;parsing&nbsp;serialized&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7499132">,</span>&nbsp;<span class="ident" id="7499134">err</span><span class="op" id="7499137">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7499141">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7499149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7499152">if</span>&nbsp;<span class="ident" id="7499155">priv</span><span class="op" id="7499159">.</span><span class="ident" id="7499160">PublicKey</span><span class="op" id="7499169">.</span><span class="ident" id="7499170">N</span><span class="op" id="7499171">.</span><span class="ident" id="7499172">Cmp</span><span class="op" id="7499175">(</span><span class="ident" id="7499176">priv2</span><span class="op" id="7499181">.</span><span class="ident" id="7499182">PublicKey</span><span class="op" id="7499191">.</span><span class="ident" id="7499192">N</span><span class="op" id="7499193">)</span>&nbsp;<span class="op" id="7499195">!=</span>&nbsp;<span class="num" id="7499198">0</span>&nbsp;<span class="op" id="7499200">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7499205">priv</span><span class="op" id="7499209">.</span><span class="ident" id="7499210">PublicKey</span><span class="op" id="7499219">.</span><span class="ident" id="7499220">E</span>&nbsp;<span class="op" id="7499222">!=</span>&nbsp;<span class="ident" id="7499225">priv2</span><span class="op" id="7499230">.</span><span class="ident" id="7499231">PublicKey</span><span class="op" id="7499240">.</span><span class="ident" id="7499241">E</span>&nbsp;<span class="op" id="7499243">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7499248">priv</span><span class="op" id="7499252">.</span><span class="ident" id="7499253">D</span><span class="op" id="7499254">.</span><span class="ident" id="7499255">Cmp</span><span class="op" id="7499258">(</span><span class="ident" id="7499259">priv2</span><span class="op" id="7499264">.</span><span class="ident" id="7499265">D</span><span class="op" id="7499266">)</span>&nbsp;<span class="op" id="7499268">!=</span>&nbsp;<span class="num" id="7499271">0</span>&nbsp;<span class="op" id="7499273">||</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7499278">len</span><span class="op" id="7499281">(</span><span class="ident" id="7499282">priv2</span><span class="op" id="7499287">.</span><span class="ident" id="7499288">Primes</span><span class="op" id="7499294">)</span>&nbsp;<span class="op" id="7499296">!=</span>&nbsp;<span class="num" id="7499299">3</span>&nbsp;<span class="op" id="7499301">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7499306">priv</span><span class="op" id="7499310">.</span><span class="ident" id="7499311">Primes</span><span class="op" id="7499317">[</span><span class="num" id="7499318">0</span><span class="op" id="7499319">]</span><span class="op" id="7499320">.</span><span class="ident" id="7499321">Cmp</span><span class="op" id="7499324">(</span><span class="ident" id="7499325">priv2</span><span class="op" id="7499330">.</span><span class="ident" id="7499331">Primes</span><span class="op" id="7499337">[</span><span class="num" id="7499338">0</span><span class="op" id="7499339">]</span><span class="op" id="7499340">)</span>&nbsp;<span class="op" id="7499342">!=</span>&nbsp;<span class="num" id="7499345">0</span>&nbsp;<span class="op" id="7499347">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7499352">priv</span><span class="op" id="7499356">.</span><span class="ident" id="7499357">Primes</span><span class="op" id="7499363">[</span><span class="num" id="7499364">1</span><span class="op" id="7499365">]</span><span class="op" id="7499366">.</span><span class="ident" id="7499367">Cmp</span><span class="op" id="7499370">(</span><span class="ident" id="7499371">priv2</span><span class="op" id="7499376">.</span><span class="ident" id="7499377">Primes</span><span class="op" id="7499383">[</span><span class="num" id="7499384">1</span><span class="op" id="7499385">]</span><span class="op" id="7499386">)</span>&nbsp;<span class="op" id="7499388">!=</span>&nbsp;<span class="num" id="7499391">0</span>&nbsp;<span class="op" id="7499393">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7499398">priv</span><span class="op" id="7499402">.</span><span class="ident" id="7499403">Primes</span><span class="op" id="7499409">[</span><span class="num" id="7499410">2</span><span class="op" id="7499411">]</span><span class="op" id="7499412">.</span><span class="ident" id="7499413">Cmp</span><span class="op" id="7499416">(</span><span class="ident" id="7499417">priv2</span><span class="op" id="7499422">.</span><span class="ident" id="7499423">Primes</span><span class="op" id="7499429">[</span><span class="num" id="7499430">2</span><span class="op" id="7499431">]</span><span class="op" id="7499432">)</span>&nbsp;<span class="op" id="7499434">!=</span>&nbsp;<span class="num" id="7499437">0</span>&nbsp;<span class="op" id="7499439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7499443">t</span><span class="op" id="7499444">.</span><span class="ident" id="7499445">Errorf</span><span class="op" id="7499451">(</span><span class="string" id="7499452">&#34;got:%+v&nbsp;want:%+v&#34;</span><span class="op" id="7499470">,</span>&nbsp;<span class="ident" id="7499472">priv</span><span class="op" id="7499476">,</span>&nbsp;<span class="ident" id="7499478">priv2</span><span class="op" id="7499483">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7499486">}</span><br>
<span class="lineno"></span><span class="op" id="7499488">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7499491">type</span>&nbsp;<span class="ident" id="7499496">matchHostnamesTest</span>&nbsp;<span class="keyword" id="7499515">struct</span>&nbsp;<span class="op" id="7499522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7499525">pattern</span><span class="op" id="7499532">,</span>&nbsp;<span class="ident" id="7499534">host</span>&nbsp;<span class="builtintype" id="7499539">string</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7499547">ok</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7499561">bool</span><br>
<span class="lineno"></span><span class="op" id="7499566">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7499569">var</span>&nbsp;<span class="ident" id="7499573">matchHostnamesTests</span>&nbsp;<span class="op" id="7499593">=</span>&nbsp;<span class="op" id="7499595">[</span><span class="op" id="7499596">]</span><span class="ident" id="7499597">matchHostnamesTest</span><span class="op" id="7499615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7499618">{</span><span class="string" id="7499619">&#34;a.b.c&#34;</span><span class="op" id="7499626">,</span>&nbsp;<span class="string" id="7499628">&#34;a.b.c&#34;</span><span class="op" id="7499635">,</span>&nbsp;<span class="builtintype" id="7499637">true</span><span class="op" id="7499641">}</span><span class="op" id="7499642">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7499645">{</span><span class="string" id="7499646">&#34;a.b.c&#34;</span><span class="op" id="7499653">,</span>&nbsp;<span class="string" id="7499655">&#34;b.b.c&#34;</span><span class="op" id="7499662">,</span>&nbsp;<span class="builtintype" id="7499664">false</span><span class="op" id="7499669">}</span><span class="op" id="7499670">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7499673">{</span><span class="string" id="7499674">&#34;&#34;</span><span class="op" id="7499676">,</span>&nbsp;<span class="string" id="7499678">&#34;b.b.c&#34;</span><span class="op" id="7499685">,</span>&nbsp;<span class="builtintype" id="7499687">false</span><span class="op" id="7499692">}</span><span class="op" id="7499693">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7499696">{</span><span class="string" id="7499697">&#34;a.b.c&#34;</span><span class="op" id="7499704">,</span>&nbsp;<span class="string" id="7499706">&#34;&#34;</span><span class="op" id="7499708">,</span>&nbsp;<span class="builtintype" id="7499710">false</span><span class="op" id="7499715">}</span><span class="op" id="7499716">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7499719">{</span><span class="string" id="7499720">&#34;example.com&#34;</span><span class="op" id="7499733">,</span>&nbsp;<span class="string" id="7499735">&#34;example.com&#34;</span><span class="op" id="7499748">,</span>&nbsp;<span class="builtintype" id="7499750">true</span><span class="op" id="7499754">}</span><span class="op" id="7499755">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7499758">{</span><span class="string" id="7499759">&#34;example.com&#34;</span><span class="op" id="7499772">,</span>&nbsp;<span class="string" id="7499774">&#34;www.example.com&#34;</span><span class="op" id="7499791">,</span>&nbsp;<span class="builtintype" id="7499793">false</span><span class="op" id="7499798">}</span><span class="op" id="7499799">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7499802">{</span><span class="string" id="7499803">&#34;*.example.com&#34;</span><span class="op" id="7499818">,</span>&nbsp;<span class="string" id="7499820">&#34;www.example.com&#34;</span><span class="op" id="7499837">,</span>&nbsp;<span class="builtintype" id="7499839">true</span><span class="op" id="7499843">}</span><span class="op" id="7499844">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7499847">{</span><span class="string" id="7499848">&#34;*.example.com&#34;</span><span class="op" id="7499863">,</span>&nbsp;<span class="string" id="7499865">&#34;xyz.www.example.com&#34;</span><span class="op" id="7499886">,</span>&nbsp;<span class="builtintype" id="7499888">false</span><span class="op" id="7499893">}</span><span class="op" id="7499894">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7499897">{</span><span class="string" id="7499898">&#34;*.*.example.com&#34;</span><span class="op" id="7499915">,</span>&nbsp;<span class="string" id="7499917">&#34;xyz.www.example.com&#34;</span><span class="op" id="7499938">,</span>&nbsp;<span class="builtintype" id="7499940">true</span><span class="op" id="7499944">}</span><span class="op" id="7499945">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7499948">{</span><span class="string" id="7499949">&#34;*.www.*.com&#34;</span><span class="op" id="7499962">,</span>&nbsp;<span class="string" id="7499964">&#34;xyz.www.example.com&#34;</span><span class="op" id="7499985">,</span>&nbsp;<span class="builtintype" id="7499987">true</span><span class="op" id="7499991">}</span><span class="op" id="7499992">,</span><br>
<span class="lineno"></span><span class="op" id="7499994">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="7499997">func</span>&nbsp;<span class="ident" id="7500002">TestMatchHostnames</span><span class="op" id="7500020">(</span><span class="ident" id="7500021">t</span>&nbsp;<span class="op" id="7500023">*</span><span class="ident" id="7500024">testing</span><span class="op" id="7500031">.</span><span class="ident" id="7500032">T</span><span class="op" id="7500033">)</span>&nbsp;<span class="op" id="7500035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7500038">for</span>&nbsp;<span class="ident" id="7500042">i</span><span class="op" id="7500043">,</span>&nbsp;<span class="ident" id="7500045">test</span>&nbsp;<span class="op" id="7500050">:=</span>&nbsp;<span class="keyword" id="7500053">range</span>&nbsp;<span class="ident" id="7500059">matchHostnamesTests</span>&nbsp;<span class="op" id="7500079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7500083">r</span>&nbsp;<span class="op" id="7500085">:=</span>&nbsp;<span class="ident" id="7500088">matchHostnames</span><span class="op" id="7500102">(</span><span class="ident" id="7500103">test</span><span class="op" id="7500107">.</span><span class="ident" id="7500108">pattern</span><span class="op" id="7500115">,</span>&nbsp;<span class="ident" id="7500117">test</span><span class="op" id="7500121">.</span><span class="ident" id="7500122">host</span><span class="op" id="7500126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7500130">if</span>&nbsp;<span class="ident" id="7500133">r</span>&nbsp;<span class="op" id="7500135">!=</span>&nbsp;<span class="ident" id="7500138">test</span><span class="op" id="7500142">.</span><span class="ident" id="7500143">ok</span>&nbsp;<span class="op" id="7500146">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7500151">t</span><span class="op" id="7500152">.</span><span class="ident" id="7500153">Errorf</span><span class="op" id="7500159">(</span><span class="string" id="7500160">&#34;#%d&nbsp;mismatch&nbsp;got:&nbsp;%t&nbsp;want:&nbsp;%t&#34;</span><span class="op" id="7500191">,</span>&nbsp;<span class="ident" id="7500193">i</span><span class="op" id="7500194">,</span>&nbsp;<span class="ident" id="7500196">r</span><span class="op" id="7500197">,</span>&nbsp;<span class="ident" id="7500199">test</span><span class="op" id="7500203">.</span><span class="ident" id="7500204">ok</span><span class="op" id="7500206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7500210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7500213">}</span><br>
<span class="lineno"></span><span class="op" id="7500215">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="keyword" id="7500218">func</span>&nbsp;<span class="ident" id="7500223">TestMatchIP</span><span class="op" id="7500234">(</span><span class="ident" id="7500235">t</span>&nbsp;<span class="op" id="7500237">*</span><span class="ident" id="7500238">testing</span><span class="op" id="7500245">.</span><span class="ident" id="7500246">T</span><span class="op" id="7500247">)</span>&nbsp;<span class="op" id="7500249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7500252">//&nbsp;Check&nbsp;that&nbsp;pattern&nbsp;matching&nbsp;is&nbsp;working.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7500296">c</span>&nbsp;<span class="op" id="7500298">:=</span>&nbsp;<span class="op" id="7500301">&amp;</span><span class="ident" id="7500302">Certificate</span><span class="op" id="7500313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7500317">DNSNames</span><span class="op" id="7500325">:</span>&nbsp;<span class="op" id="7500327">[</span><span class="op" id="7500328">]</span><span class="builtintype" id="7500329">string</span><span class="op" id="7500335">{</span><span class="string" id="7500336">&#34;*.foo.bar.baz&#34;</span><span class="op" id="7500351">}</span><span class="op" id="7500352">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7500356">Subject</span><span class="op" id="7500363">:</span>&nbsp;<span class="ident" id="7500365">pkix</span><span class="op" id="7500369">.</span><span class="ident" id="7500370">Name</span><span class="op" id="7500374">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7500379">CommonName</span><span class="op" id="7500389">:</span>&nbsp;<span class="string" id="7500391">&#34;*.foo.bar.baz&#34;</span><span class="op" id="7500406">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7500410">}</span><span class="op" id="7500411">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7500414">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7500417">err</span>&nbsp;<span class="op" id="7500421">:=</span>&nbsp;<span class="ident" id="7500424">c</span><span class="op" id="7500425">.</span><span class="ident" id="7500426">VerifyHostname</span><span class="op" id="7500440">(</span><span class="string" id="7500441">&#34;quux.foo.bar.baz&#34;</span><span class="op" id="7500459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7500462">if</span>&nbsp;<span class="ident" id="7500465">err</span>&nbsp;<span class="op" id="7500469">!=</span>&nbsp;<span class="builtintype" id="7500472">nil</span>&nbsp;<span class="op" id="7500476">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7500480">t</span><span class="op" id="7500481">.</span><span class="ident" id="7500482">Fatalf</span><span class="op" id="7500488">(</span><span class="string" id="7500489">&#34;VerifyHostname(quux.foo.bar.baz):&nbsp;%v&#34;</span><span class="op" id="7500527">,</span>&nbsp;<span class="ident" id="7500529">err</span><span class="op" id="7500532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7500535">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7500539">//&nbsp;But&nbsp;check&nbsp;that&nbsp;if&nbsp;we&nbsp;change&nbsp;it&nbsp;to&nbsp;be&nbsp;matching&nbsp;against&nbsp;an&nbsp;IP&nbsp;address,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7500612">//&nbsp;it&nbsp;is&nbsp;rejected.</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7500632">c</span>&nbsp;<span class="op" id="7500634">=</span>&nbsp;<span class="op" id="7500636">&amp;</span><span class="ident" id="7500637">Certificate</span><span class="op" id="7500648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7500652">DNSNames</span><span class="op" id="7500660">:</span>&nbsp;<span class="op" id="7500662">[</span><span class="op" id="7500663">]</span><span class="builtintype" id="7500664">string</span><span class="op" id="7500670">{</span><span class="string" id="7500671">&#34;*.2.3.4&#34;</span><span class="op" id="7500680">}</span><span class="op" id="7500681">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7500685">Subject</span><span class="op" id="7500692">:</span>&nbsp;<span class="ident" id="7500694">pkix</span><span class="op" id="7500698">.</span><span class="ident" id="7500699">Name</span><span class="op" id="7500703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7500708">CommonName</span><span class="op" id="7500718">:</span>&nbsp;<span class="string" id="7500720">&#34;*.2.3.4&#34;</span><span class="op" id="7500729">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7500733">}</span><span class="op" id="7500734">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7500737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7500740">err</span>&nbsp;<span class="op" id="7500744">=</span>&nbsp;<span class="ident" id="7500746">c</span><span class="op" id="7500747">.</span><span class="ident" id="7500748">VerifyHostname</span><span class="op" id="7500762">(</span><span class="string" id="7500763">&#34;1.2.3.4&#34;</span><span class="op" id="7500772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7500775">if</span>&nbsp;<span class="ident" id="7500778">err</span>&nbsp;<span class="op" id="7500782">==</span>&nbsp;<span class="builtintype" id="7500785">nil</span>&nbsp;<span class="op" id="7500789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7500793">t</span><span class="op" id="7500794">.</span><span class="ident" id="7500795">Fatalf</span><span class="op" id="7500801">(</span><span class="string" id="7500802">&#34;VerifyHostname(1.2.3.4)&nbsp;should&nbsp;have&nbsp;failed,&nbsp;did&nbsp;not&#34;</span><span class="op" id="7500855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7500858">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7500862">c</span>&nbsp;<span class="op" id="7500864">=</span>&nbsp;<span class="op" id="7500866">&amp;</span><span class="ident" id="7500867">Certificate</span><span class="op" id="7500878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7500882">IPAddresses</span><span class="op" id="7500893">:</span>&nbsp;<span class="op" id="7500895">[</span><span class="op" id="7500896">]</span><span class="ident" id="7500897">net</span><span class="op" id="7500900">.</span><span class="ident" id="7500901">IP</span><span class="op" id="7500903">{</span><span class="ident" id="7500904">net</span><span class="op" id="7500907">.</span><span class="ident" id="7500908">ParseIP</span><span class="op" id="7500915">(</span><span class="string" id="7500916">&#34;127.0.0.1&#34;</span><span class="op" id="7500927">)</span><span class="op" id="7500928">,</span>&nbsp;<span class="ident" id="7500930">net</span><span class="op" id="7500933">.</span><span class="ident" id="7500934">ParseIP</span><span class="op" id="7500941">(</span><span class="string" id="7500942">&#34;::1&#34;</span><span class="op" id="7500947">)</span><span class="op" id="7500948">}</span><span class="op" id="7500949">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7500952">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7500955">err</span>&nbsp;<span class="op" id="7500959">=</span>&nbsp;<span class="ident" id="7500961">c</span><span class="op" id="7500962">.</span><span class="ident" id="7500963">VerifyHostname</span><span class="op" id="7500977">(</span><span class="string" id="7500978">&#34;127.0.0.1&#34;</span><span class="op" id="7500989">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7500992">if</span>&nbsp;<span class="ident" id="7500995">err</span>&nbsp;<span class="op" id="7500999">!=</span>&nbsp;<span class="builtintype" id="7501002">nil</span>&nbsp;<span class="op" id="7501006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7501010">t</span><span class="op" id="7501011">.</span><span class="ident" id="7501012">Fatalf</span><span class="op" id="7501018">(</span><span class="string" id="7501019">&#34;VerifyHostname(127.0.0.1):&nbsp;%v&#34;</span><span class="op" id="7501050">,</span>&nbsp;<span class="ident" id="7501052">err</span><span class="op" id="7501055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7501058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7501061">err</span>&nbsp;<span class="op" id="7501065">=</span>&nbsp;<span class="ident" id="7501067">c</span><span class="op" id="7501068">.</span><span class="ident" id="7501069">VerifyHostname</span><span class="op" id="7501083">(</span><span class="string" id="7501084">&#34;::1&#34;</span><span class="op" id="7501089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7501092">if</span>&nbsp;<span class="ident" id="7501095">err</span>&nbsp;<span class="op" id="7501099">!=</span>&nbsp;<span class="builtintype" id="7501102">nil</span>&nbsp;<span class="op" id="7501106">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7501110">t</span><span class="op" id="7501111">.</span><span class="ident" id="7501112">Fatalf</span><span class="op" id="7501118">(</span><span class="string" id="7501119">&#34;VerifyHostname(::1):&nbsp;%v&#34;</span><span class="op" id="7501144">,</span>&nbsp;<span class="ident" id="7501146">err</span><span class="op" id="7501149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7501152">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7501155">err</span>&nbsp;<span class="op" id="7501159">=</span>&nbsp;<span class="ident" id="7501161">c</span><span class="op" id="7501162">.</span><span class="ident" id="7501163">VerifyHostname</span><span class="op" id="7501177">(</span><span class="string" id="7501178">&#34;[::1]&#34;</span><span class="op" id="7501185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7501188">if</span>&nbsp;<span class="ident" id="7501191">err</span>&nbsp;<span class="op" id="7501195">!=</span>&nbsp;<span class="builtintype" id="7501198">nil</span>&nbsp;<span class="op" id="7501202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7501206">t</span><span class="op" id="7501207">.</span><span class="ident" id="7501208">Fatalf</span><span class="op" id="7501214">(</span><span class="string" id="7501215">&#34;VerifyHostname([::1]):&nbsp;%v&#34;</span><span class="op" id="7501242">,</span>&nbsp;<span class="ident" id="7501244">err</span><span class="op" id="7501247">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7501250">}</span><br>
<span class="lineno"></span><span class="op" id="7501252">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7501255">func</span>&nbsp;<span class="ident" id="7501260">TestCertificateParse</span><span class="op" id="7501280">(</span><span class="ident" id="7501281">t</span>&nbsp;<span class="op" id="7501283">*</span><span class="ident" id="7501284">testing</span><span class="op" id="7501291">.</span><span class="ident" id="7501292">T</span><span class="op" id="7501293">)</span>&nbsp;<span class="op" id="7501295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7501298">s</span><span class="op" id="7501299">,</span>&nbsp;<span class="ident" id="7501301">_</span>&nbsp;<span class="op" id="7501303">:=</span>&nbsp;<span class="ident" id="7501306">hex</span><span class="op" id="7501309">.</span><span class="ident" id="7501310">DecodeString</span><span class="op" id="7501322">(</span><span class="ident" id="7501323">certBytes</span><span class="op" id="7501332">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7501335">certs</span><span class="op" id="7501340">,</span>&nbsp;<span class="ident" id="7501342">err</span>&nbsp;<span class="op" id="7501346">:=</span>&nbsp;<span class="ident" id="7501349">ParseCertificates</span><span class="op" id="7501366">(</span><span class="ident" id="7501367">s</span><span class="op" id="7501368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7501371">if</span>&nbsp;<span class="ident" id="7501374">err</span>&nbsp;<span class="op" id="7501378">!=</span>&nbsp;<span class="builtintype" id="7501381">nil</span>&nbsp;<span class="op" id="7501385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7501389">t</span><span class="op" id="7501390">.</span><span class="ident" id="7501391">Error</span><span class="op" id="7501396">(</span><span class="ident" id="7501397">err</span><span class="op" id="7501400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7501403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7501406">if</span>&nbsp;<span class="builtinfunc" id="7501409">len</span><span class="op" id="7501412">(</span><span class="ident" id="7501413">certs</span><span class="op" id="7501418">)</span>&nbsp;<span class="op" id="7501420">!=</span>&nbsp;<span class="num" id="7501423">2</span>&nbsp;<span class="op" id="7501425">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7501429">t</span><span class="op" id="7501430">.</span><span class="ident" id="7501431">Errorf</span><span class="op" id="7501437">(</span><span class="string" id="7501438">&#34;Wrong&nbsp;number&nbsp;of&nbsp;certs:&nbsp;got&nbsp;%d&nbsp;want&nbsp;2&#34;</span><span class="op" id="7501476">,</span>&nbsp;<span class="builtinfunc" id="7501478">len</span><span class="op" id="7501481">(</span><span class="ident" id="7501482">certs</span><span class="op" id="7501487">)</span><span class="op" id="7501488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7501492">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7501500">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7501504">err</span>&nbsp;<span class="op" id="7501508">=</span>&nbsp;<span class="ident" id="7501510">certs</span><span class="op" id="7501515">[</span><span class="num" id="7501516">0</span><span class="op" id="7501517">]</span><span class="op" id="7501518">.</span><span class="ident" id="7501519">CheckSignatureFrom</span><span class="op" id="7501537">(</span><span class="ident" id="7501538">certs</span><span class="op" id="7501543">[</span><span class="num" id="7501544">1</span><span class="op" id="7501545">]</span><span class="op" id="7501546">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7501549">if</span>&nbsp;<span class="ident" id="7501552">err</span>&nbsp;<span class="op" id="7501556">!=</span>&nbsp;<span class="builtintype" id="7501559">nil</span>&nbsp;<span class="op" id="7501563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7501567">t</span><span class="op" id="7501568">.</span><span class="ident" id="7501569">Error</span><span class="op" id="7501574">(</span><span class="ident" id="7501575">err</span><span class="op" id="7501578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7501581">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7501585">if</span>&nbsp;<span class="ident" id="7501588">err</span>&nbsp;<span class="op" id="7501592">:=</span>&nbsp;<span class="ident" id="7501595">certs</span><span class="op" id="7501600">[</span><span class="num" id="7501601">0</span><span class="op" id="7501602">]</span><span class="op" id="7501603">.</span><span class="ident" id="7501604">VerifyHostname</span><span class="op" id="7501618">(</span><span class="string" id="7501619">&#34;mail.google.com&#34;</span><span class="op" id="7501636">)</span><span class="op" id="7501637">;</span>&nbsp;<span class="ident" id="7501639">err</span>&nbsp;<span class="op" id="7501643">!=</span>&nbsp;<span class="builtintype" id="7501646">nil</span>&nbsp;<span class="op" id="7501650">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7501654">t</span><span class="op" id="7501655">.</span><span class="ident" id="7501656">Error</span><span class="op" id="7501661">(</span><span class="ident" id="7501662">err</span><span class="op" id="7501665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7501668">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7501672">const</span>&nbsp;<span class="ident" id="7501678">expectedExtensions</span>&nbsp;<span class="op" id="7501697">=</span>&nbsp;<span class="num" id="7501699">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7501702">if</span>&nbsp;<span class="ident" id="7501705">n</span>&nbsp;<span class="op" id="7501707">:=</span>&nbsp;<span class="builtinfunc" id="7501710">len</span><span class="op" id="7501713">(</span><span class="ident" id="7501714">certs</span><span class="op" id="7501719">[</span><span class="num" id="7501720">0</span><span class="op" id="7501721">]</span><span class="op" id="7501722">.</span><span class="ident" id="7501723">Extensions</span><span class="op" id="7501733">)</span><span class="op" id="7501734">;</span>&nbsp;<span class="ident" id="7501736">n</span>&nbsp;<span class="op" id="7501738">!=</span>&nbsp;<span class="ident" id="7501741">expectedExtensions</span>&nbsp;<span class="op" id="7501760">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7501764">t</span><span class="op" id="7501765">.</span><span class="ident" id="7501766">Errorf</span><span class="op" id="7501772">(</span><span class="string" id="7501773">&#34;want&nbsp;%d&nbsp;extensions,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7501801">,</span>&nbsp;<span class="ident" id="7501803">expectedExtensions</span><span class="op" id="7501821">,</span>&nbsp;<span class="ident" id="7501823">n</span><span class="op" id="7501824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7501827">}</span><br>
<span class="lineno"></span><span class="op" id="7501829">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7501832">var</span>&nbsp;<span class="ident" id="7501836">certBytes</span>&nbsp;<span class="op" id="7501846">=</span>&nbsp;<span class="string" id="7501848">&#34;308203223082028ba00302010202106edf0d9499fd4533dd1297fc42a93be1300d06092a864886&#34;</span>&nbsp;<span class="op" id="7501929">+</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7501932">&#34;f70d0101050500304c310b3009060355040613025a4131253023060355040a131c546861777465&#34;</span>&nbsp;<span class="op" id="7502013">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7502016">&#34;20436f6e73756c74696e67202850747929204c74642e311630140603550403130d546861777465&#34;</span>&nbsp;<span class="op" id="7502097">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7502100">&#34;20534743204341301e170d3039303332353136343932395a170d3130303332353136343932395a&#34;</span>&nbsp;<span class="op" id="7502181">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7502184">&#34;3069310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630&#34;</span>&nbsp;<span class="op" id="7502265">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7502268">&#34;140603550407130d4d6f756e7461696e205669657731133011060355040a130a476f6f676c6520&#34;</span>&nbsp;<span class="op" id="7502349">+</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7502352">&#34;496e63311830160603550403130f6d61696c2e676f6f676c652e636f6d30819f300d06092a8648&#34;</span>&nbsp;<span class="op" id="7502433">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7502436">&#34;86f70d010101050003818d0030818902818100c5d6f892fccaf5614b064149e80a2c9581a218ef&#34;</span>&nbsp;<span class="op" id="7502517">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7502520">&#34;41ec35bd7a58125ae76f9ea54ddc893abbeb029f6b73616bf0ffd868791fba7af9c4aebf3706ba&#34;</span>&nbsp;<span class="op" id="7502601">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7502604">&#34;3eeaeed27435b4ddcfb157c05f351d66aa87fee0de072d66d773affbd36ab78bef090e0cc861a9&#34;</span>&nbsp;<span class="op" id="7502685">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7502688">&#34;03ac90dd98b51c9c41566c017f0beec3bff391051ffba0f5cc6850ad2a590203010001a381e730&#34;</span>&nbsp;<span class="op" id="7502769">+</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7502772">&#34;81e430280603551d250421301f06082b0601050507030106082b06010505070302060960864801&#34;</span>&nbsp;<span class="op" id="7502853">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7502856">&#34;86f842040130360603551d1f042f302d302ba029a0278625687474703a2f2f63726c2e74686177&#34;</span>&nbsp;<span class="op" id="7502937">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7502940">&#34;74652e636f6d2f54686177746553474343412e63726c307206082b060105050701010466306430&#34;</span>&nbsp;<span class="op" id="7503021">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7503024">&#34;2206082b060105050730018616687474703a2f2f6f6373702e7468617774652e636f6d303e0608&#34;</span>&nbsp;<span class="op" id="7503105">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7503108">&#34;2b060105050730028632687474703a2f2f7777772e7468617774652e636f6d2f7265706f736974&#34;</span>&nbsp;<span class="op" id="7503189">+</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7503192">&#34;6f72792f5468617774655f5347435f43412e637274300c0603551d130101ff04023000300d0609&#34;</span>&nbsp;<span class="op" id="7503273">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7503276">&#34;2a864886f70d01010505000381810062f1f3050ebc105e497c7aedf87e24d2f4a986bb3b837bd1&#34;</span>&nbsp;<span class="op" id="7503357">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7503360">&#34;9b91ebcad98b065992f6bd2b49b7d6d3cb2e427a99d606c7b1d46352527fac39e6a8b6726de5bf&#34;</span>&nbsp;<span class="op" id="7503441">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7503444">&#34;70212a52cba07634a5e332011bd1868e78eb5e3c93cf03072276786f207494feaa0ed9d53b2110&#34;</span>&nbsp;<span class="op" id="7503525">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7503528">&#34;a76571f90209cdae884385c882587030ee15f33d761e2e45a6bc308203233082028ca003020102&#34;</span>&nbsp;<span class="op" id="7503609">+</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7503612">&#34;020430000002300d06092a864886f70d0101050500305f310b3009060355040613025553311730&#34;</span>&nbsp;<span class="op" id="7503693">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7503696">&#34;15060355040a130e566572695369676e2c20496e632e31373035060355040b132e436c61737320&#34;</span>&nbsp;<span class="op" id="7503777">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7503780">&#34;33205075626c6963205072696d6172792043657274696669636174696f6e20417574686f726974&#34;</span>&nbsp;<span class="op" id="7503861">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7503864">&#34;79301e170d3034303531333030303030305a170d3134303531323233353935395a304c310b3009&#34;</span>&nbsp;<span class="op" id="7503945">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7503948">&#34;060355040613025a4131253023060355040a131c54686177746520436f6e73756c74696e672028&#34;</span>&nbsp;<span class="op" id="7504029">+</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7504032">&#34;50747929204c74642e311630140603550403130d5468617774652053474320434130819f300d06&#34;</span>&nbsp;<span class="op" id="7504113">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7504116">&#34;092a864886f70d010101050003818d0030818902818100d4d367d08d157faecd31fe7d1d91a13f&#34;</span>&nbsp;<span class="op" id="7504197">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7504200">&#34;0b713cacccc864fb63fc324b0794bd6f80ba2fe10493c033fc093323e90b742b71c403c6d2cde2&#34;</span>&nbsp;<span class="op" id="7504281">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7504284">&#34;2ff50963cdff48a500bfe0e7f388b72d32de9836e60aad007bc4644a3b847503f270927d0e62f5&#34;</span>&nbsp;<span class="op" id="7504365">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7504368">&#34;21ab693684317590f8bfc76c881b06957cc9e5a8de75a12c7a68dfd5ca1c875860190203010001&#34;</span>&nbsp;<span class="op" id="7504449">+</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7504452">&#34;a381fe3081fb30120603551d130101ff040830060101ff020100300b0603551d0f040403020106&#34;</span>&nbsp;<span class="op" id="7504533">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7504536">&#34;301106096086480186f842010104040302010630280603551d110421301fa41d301b3119301706&#34;</span>&nbsp;<span class="op" id="7504617">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7504620">&#34;035504031310507269766174654c6162656c332d313530310603551d1f042a30283026a024a022&#34;</span>&nbsp;<span class="op" id="7504701">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7504704">&#34;8620687474703a2f2f63726c2e766572697369676e2e636f6d2f706361332e63726c303206082b&#34;</span>&nbsp;<span class="op" id="7504785">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7504788">&#34;0601050507010104263024302206082b060105050730018616687474703a2f2f6f6373702e7468&#34;</span>&nbsp;<span class="op" id="7504869">+</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7504872">&#34;617774652e636f6d30340603551d25042d302b06082b0601050507030106082b06010505070302&#34;</span>&nbsp;<span class="op" id="7504953">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7504956">&#34;06096086480186f8420401060a6086480186f845010801300d06092a864886f70d010105050003&#34;</span>&nbsp;<span class="op" id="7505037">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7505040">&#34;81810055ac63eadea1ddd2905f9f0bce76be13518f93d9052bc81b774bad6950a1eededcfddb07&#34;</span>&nbsp;<span class="op" id="7505121">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7505124">&#34;e9e83994dcab72792f06bfab8170c4a8edea5334edef1e53d906c7562bd15cf4d18a8eb42bb137&#34;</span>&nbsp;<span class="op" id="7505205">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7505208">&#34;9048084225c53e8acb7feb6f04d16dc574a2f7a27c7b603c77cd0ece48027f012fb69b37e02a2a&#34;</span>&nbsp;<span class="op" id="7505289">+</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7505292">&#34;36dcd585d6ace53f546f961e05af&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7505324">func</span>&nbsp;<span class="ident" id="7505329">TestCreateSelfSignedCertificate</span><span class="op" id="7505360">(</span><span class="ident" id="7505361">t</span>&nbsp;<span class="op" id="7505363">*</span><span class="ident" id="7505364">testing</span><span class="op" id="7505371">.</span><span class="ident" id="7505372">T</span><span class="op" id="7505373">)</span>&nbsp;<span class="op" id="7505375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7505378">random</span>&nbsp;<span class="op" id="7505385">:=</span>&nbsp;<span class="ident" id="7505388">rand</span><span class="op" id="7505392">.</span><span class="ident" id="7505393">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7505402">block</span><span class="op" id="7505407">,</span>&nbsp;<span class="ident" id="7505409">_</span>&nbsp;<span class="op" id="7505411">:=</span>&nbsp;<span class="ident" id="7505414">pem</span><span class="op" id="7505417">.</span><span class="ident" id="7505418">Decode</span><span class="op" id="7505424">(</span><span class="op" id="7505425">[</span><span class="op" id="7505426">]</span><span class="builtintype" id="7505427">byte</span><span class="op" id="7505431">(</span><span class="ident" id="7505432">pemPrivateKey</span><span class="op" id="7505445">)</span><span class="op" id="7505446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7505449">rsaPriv</span><span class="op" id="7505456">,</span>&nbsp;<span class="ident" id="7505458">err</span>&nbsp;<span class="op" id="7505462">:=</span>&nbsp;<span class="ident" id="7505465">ParsePKCS1PrivateKey</span><span class="op" id="7505485">(</span><span class="ident" id="7505486">block</span><span class="op" id="7505491">.</span><span class="ident" id="7505492">Bytes</span><span class="op" id="7505497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7505500">if</span>&nbsp;<span class="ident" id="7505503">err</span>&nbsp;<span class="op" id="7505507">!=</span>&nbsp;<span class="builtintype" id="7505510">nil</span>&nbsp;<span class="op" id="7505514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7505518">t</span><span class="op" id="7505519">.</span><span class="ident" id="7505520">Fatalf</span><span class="op" id="7505526">(</span><span class="string" id="7505527">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7505560">,</span>&nbsp;<span class="ident" id="7505562">err</span><span class="op" id="7505565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7505568">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7505572">ecdsaPriv</span><span class="op" id="7505581">,</span>&nbsp;<span class="ident" id="7505583">err</span>&nbsp;<span class="op" id="7505587">:=</span>&nbsp;<span class="ident" id="7505590">ecdsa</span><span class="op" id="7505595">.</span><span class="ident" id="7505596">GenerateKey</span><span class="op" id="7505607">(</span><span class="ident" id="7505608">elliptic</span><span class="op" id="7505616">.</span><span class="ident" id="7505617">P256</span><span class="op" id="7505621">(</span><span class="op" id="7505622">)</span><span class="op" id="7505623">,</span>&nbsp;<span class="ident" id="7505625">rand</span><span class="op" id="7505629">.</span><span class="ident" id="7505630">Reader</span><span class="op" id="7505636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7505639">if</span>&nbsp;<span class="ident" id="7505642">err</span>&nbsp;<span class="op" id="7505646">!=</span>&nbsp;<span class="builtintype" id="7505649">nil</span>&nbsp;<span class="op" id="7505653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7505657">t</span><span class="op" id="7505658">.</span><span class="ident" id="7505659">Fatalf</span><span class="op" id="7505665">(</span><span class="string" id="7505666">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7505700">,</span>&nbsp;<span class="ident" id="7505702">err</span><span class="op" id="7505705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7505708">}</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7505712">tests</span>&nbsp;<span class="op" id="7505718">:=</span>&nbsp;<span class="op" id="7505721">[</span><span class="op" id="7505722">]</span><span class="keyword" id="7505723">struct</span>&nbsp;<span class="op" id="7505730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7505734">name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7505744">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7505753">pub</span><span class="op" id="7505756">,</span>&nbsp;<span class="ident" id="7505758">priv</span>&nbsp;<span class="keyword" id="7505763">interface</span><span class="op" id="7505772">{</span><span class="op" id="7505773">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7505777">checkSig</span>&nbsp;&nbsp;<span class="builtintype" id="7505787">bool</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7505794">sigAlgo</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7505804">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7505824">}</span><span class="op" id="7505825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7505829">{</span><span class="string" id="7505830">&#34;RSA/RSA&#34;</span><span class="op" id="7505839">,</span>&nbsp;<span class="op" id="7505841">&amp;</span><span class="ident" id="7505842">rsaPriv</span><span class="op" id="7505849">.</span><span class="ident" id="7505850">PublicKey</span><span class="op" id="7505859">,</span>&nbsp;<span class="ident" id="7505861">rsaPriv</span><span class="op" id="7505868">,</span>&nbsp;<span class="builtintype" id="7505870">true</span><span class="op" id="7505874">,</span>&nbsp;<span class="ident" id="7505876">SHA1WithRSA</span><span class="op" id="7505887">}</span><span class="op" id="7505888">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7505892">{</span><span class="string" id="7505893">&#34;RSA/ECDSA&#34;</span><span class="op" id="7505904">,</span>&nbsp;<span class="op" id="7505906">&amp;</span><span class="ident" id="7505907">rsaPriv</span><span class="op" id="7505914">.</span><span class="ident" id="7505915">PublicKey</span><span class="op" id="7505924">,</span>&nbsp;<span class="ident" id="7505926">ecdsaPriv</span><span class="op" id="7505935">,</span>&nbsp;<span class="builtintype" id="7505937">false</span><span class="op" id="7505942">,</span>&nbsp;<span class="ident" id="7505944">ECDSAWithSHA384</span><span class="op" id="7505959">}</span><span class="op" id="7505960">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7505964">{</span><span class="string" id="7505965">&#34;ECDSA/RSA&#34;</span><span class="op" id="7505976">,</span>&nbsp;<span class="op" id="7505978">&amp;</span><span class="ident" id="7505979">ecdsaPriv</span><span class="op" id="7505988">.</span><span class="ident" id="7505989">PublicKey</span><span class="op" id="7505998">,</span>&nbsp;<span class="ident" id="7506000">rsaPriv</span><span class="op" id="7506007">,</span>&nbsp;<span class="builtintype" id="7506009">false</span><span class="op" id="7506014">,</span>&nbsp;<span class="ident" id="7506016">SHA256WithRSA</span><span class="op" id="7506029">}</span><span class="op" id="7506030">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7506034">{</span><span class="string" id="7506035">&#34;ECDSA/ECDSA&#34;</span><span class="op" id="7506048">,</span>&nbsp;<span class="op" id="7506050">&amp;</span><span class="ident" id="7506051">ecdsaPriv</span><span class="op" id="7506060">.</span><span class="ident" id="7506061">PublicKey</span><span class="op" id="7506070">,</span>&nbsp;<span class="ident" id="7506072">ecdsaPriv</span><span class="op" id="7506081">,</span>&nbsp;<span class="builtintype" id="7506083">true</span><span class="op" id="7506087">,</span>&nbsp;<span class="ident" id="7506089">ECDSAWithSHA1</span><span class="op" id="7506102">}</span><span class="op" id="7506103">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7506106">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7506110">testExtKeyUsage</span>&nbsp;<span class="op" id="7506126">:=</span>&nbsp;<span class="op" id="7506129">[</span><span class="op" id="7506130">]</span><span class="ident" id="7506131">ExtKeyUsage</span><span class="op" id="7506142">{</span><span class="ident" id="7506143">ExtKeyUsageClientAuth</span><span class="op" id="7506164">,</span>&nbsp;<span class="ident" id="7506166">ExtKeyUsageServerAuth</span><span class="op" id="7506187">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7506190">testUnknownExtKeyUsage</span>&nbsp;<span class="op" id="7506213">:=</span>&nbsp;<span class="op" id="7506216">[</span><span class="op" id="7506217">]</span><span class="ident" id="7506218">asn1</span><span class="op" id="7506222">.</span><span class="ident" id="7506223">ObjectIdentifier</span><span class="op" id="7506239">{</span><span class="op" id="7506240">[</span><span class="op" id="7506241">]</span><span class="builtintype" id="7506242">int</span><span class="op" id="7506245">{</span><span class="num" id="7506246">1</span><span class="op" id="7506247">,</span>&nbsp;<span class="num" id="7506249">2</span><span class="op" id="7506250">,</span>&nbsp;<span class="num" id="7506252">3</span><span class="op" id="7506253">}</span><span class="op" id="7506254">,</span>&nbsp;<span class="op" id="7506256">[</span><span class="op" id="7506257">]</span><span class="builtintype" id="7506258">int</span><span class="op" id="7506261">{</span><span class="num" id="7506262">2</span><span class="op" id="7506263">,</span>&nbsp;<span class="num" id="7506265">59</span><span class="op" id="7506267">,</span>&nbsp;<span class="num" id="7506269">1</span><span class="op" id="7506270">}</span><span class="op" id="7506271">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7506274">extraExtensionData</span>&nbsp;<span class="op" id="7506293">:=</span>&nbsp;<span class="op" id="7506296">[</span><span class="op" id="7506297">]</span><span class="builtintype" id="7506298">byte</span><span class="op" id="7506302">(</span><span class="string" id="7506303">&#34;extra&nbsp;extension&#34;</span><span class="op" id="7506320">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7506324">for</span>&nbsp;<span class="ident" id="7506328">_</span><span class="op" id="7506329">,</span>&nbsp;<span class="ident" id="7506331">test</span>&nbsp;<span class="op" id="7506336">:=</span>&nbsp;<span class="keyword" id="7506339">range</span>&nbsp;<span class="ident" id="7506345">tests</span>&nbsp;<span class="op" id="7506351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7506355">commonName</span>&nbsp;<span class="op" id="7506366">:=</span>&nbsp;<span class="string" id="7506369">&#34;test.example.com&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7506390">template</span>&nbsp;<span class="op" id="7506399">:=</span>&nbsp;<span class="ident" id="7506402">Certificate</span><span class="op" id="7506413">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7506418">SerialNumber</span><span class="op" id="7506430">:</span>&nbsp;<span class="ident" id="7506432">big</span><span class="op" id="7506435">.</span><span class="ident" id="7506436">NewInt</span><span class="op" id="7506442">(</span><span class="num" id="7506443">1</span><span class="op" id="7506444">)</span><span class="op" id="7506445">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7506450">Subject</span><span class="op" id="7506457">:</span>&nbsp;<span class="ident" id="7506459">pkix</span><span class="op" id="7506463">.</span><span class="ident" id="7506464">Name</span><span class="op" id="7506468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7506474">CommonName</span><span class="op" id="7506484">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7506488">commonName</span><span class="op" id="7506498">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7506504">Organization</span><span class="op" id="7506516">:</span>&nbsp;<span class="op" id="7506518">[</span><span class="op" id="7506519">]</span><span class="builtintype" id="7506520">string</span><span class="op" id="7506526">{</span><span class="string" id="7506527">&#34;Σ&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="7506539">}</span><span class="op" id="7506540">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7506545">}</span><span class="op" id="7506546">,</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7506551">NotBefore</span><span class="op" id="7506560">:</span>&nbsp;<span class="ident" id="7506562">time</span><span class="op" id="7506566">.</span><span class="ident" id="7506567">Unix</span><span class="op" id="7506571">(</span><span class="num" id="7506572">1000</span><span class="op" id="7506576">,</span>&nbsp;<span class="num" id="7506578">0</span><span class="op" id="7506579">)</span><span class="op" id="7506580">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7506585">NotAfter</span><span class="op" id="7506593">:</span>&nbsp;&nbsp;<span class="ident" id="7506596">time</span><span class="op" id="7506600">.</span><span class="ident" id="7506601">Unix</span><span class="op" id="7506605">(</span><span class="num" id="7506606">100000</span><span class="op" id="7506612">,</span>&nbsp;<span class="num" id="7506614">0</span><span class="op" id="7506615">)</span><span class="op" id="7506616">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7506622">SignatureAlgorithm</span><span class="op" id="7506640">:</span>&nbsp;<span class="ident" id="7506642">test</span><span class="op" id="7506646">.</span><span class="ident" id="7506647">sigAlgo</span><span class="op" id="7506654">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7506660">SubjectKeyId</span><span class="op" id="7506672">:</span>&nbsp;<span class="op" id="7506674">[</span><span class="op" id="7506675">]</span><span class="builtintype" id="7506676">byte</span><span class="op" id="7506680">{</span><span class="num" id="7506681">1</span><span class="op" id="7506682">,</span>&nbsp;<span class="num" id="7506684">2</span><span class="op" id="7506685">,</span>&nbsp;<span class="num" id="7506687">3</span><span class="op" id="7506688">,</span>&nbsp;<span class="num" id="7506690">4</span><span class="op" id="7506691">}</span><span class="op" id="7506692">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7506697">KeyUsage</span><span class="op" id="7506705">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7506711">KeyUsageCertSign</span><span class="op" id="7506727">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7506733">ExtKeyUsage</span><span class="op" id="7506744">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7506753">testExtKeyUsage</span><span class="op" id="7506768">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7506773">UnknownExtKeyUsage</span><span class="op" id="7506791">:</span>&nbsp;<span class="ident" id="7506793">testUnknownExtKeyUsage</span><span class="op" id="7506815">,</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7506821">BasicConstraintsValid</span><span class="op" id="7506842">:</span>&nbsp;<span class="builtintype" id="7506844">true</span><span class="op" id="7506848">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7506853">IsCA</span><span class="op" id="7506857">:</span>&nbsp;<span class="builtintype" id="7506859">true</span><span class="op" id="7506863">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7506869">OCSPServer</span><span class="op" id="7506879">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7506892">[</span><span class="op" id="7506893">]</span><span class="builtintype" id="7506894">string</span><span class="op" id="7506900">{</span><span class="string" id="7506901">&#34;http://ocsp.example.com&#34;</span><span class="op" id="7506926">}</span><span class="op" id="7506927">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7506932">IssuingCertificateURL</span><span class="op" id="7506953">:</span>&nbsp;<span class="op" id="7506955">[</span><span class="op" id="7506956">]</span><span class="builtintype" id="7506957">string</span><span class="op" id="7506963">{</span><span class="string" id="7506964">&#34;http://crt.example.com/ca1.crt&#34;</span><span class="op" id="7506996">}</span><span class="op" id="7506997">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7507003">DNSNames</span><span class="op" id="7507011">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7507019">[</span><span class="op" id="7507020">]</span><span class="builtintype" id="7507021">string</span><span class="op" id="7507027">{</span><span class="string" id="7507028">&#34;test.example.com&#34;</span><span class="op" id="7507046">}</span><span class="op" id="7507047">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7507052">EmailAddresses</span><span class="op" id="7507066">:</span>&nbsp;<span class="op" id="7507068">[</span><span class="op" id="7507069">]</span><span class="builtintype" id="7507070">string</span><span class="op" id="7507076">{</span><span class="string" id="7507077">&#34;gopher@golang.org&#34;</span><span class="op" id="7507096">}</span><span class="op" id="7507097">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7507102">IPAddresses</span><span class="op" id="7507113">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7507118">[</span><span class="op" id="7507119">]</span><span class="ident" id="7507120">net</span><span class="op" id="7507123">.</span><span class="ident" id="7507124">IP</span><span class="op" id="7507126">{</span><span class="ident" id="7507127">net</span><span class="op" id="7507130">.</span><span class="ident" id="7507131">IPv4</span><span class="op" id="7507135">(</span><span class="num" id="7507136">127</span><span class="op" id="7507139">,</span>&nbsp;<span class="num" id="7507141">0</span><span class="op" id="7507142">,</span>&nbsp;<span class="num" id="7507144">0</span><span class="op" id="7507145">,</span>&nbsp;<span class="num" id="7507147">1</span><span class="op" id="7507148">)</span><span class="op" id="7507149">.</span><span class="ident" id="7507150">To4</span><span class="op" id="7507153">(</span><span class="op" id="7507154">)</span><span class="op" id="7507155">,</span>&nbsp;<span class="ident" id="7507157">net</span><span class="op" id="7507160">.</span><span class="ident" id="7507161">ParseIP</span><span class="op" id="7507168">(</span><span class="string" id="7507169">&#34;2001:4860:0:2001::68&#34;</span><span class="op" id="7507191">)</span><span class="op" id="7507192">}</span><span class="op" id="7507193">,</span><br>
<span class="lineno">350</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7507199">PolicyIdentifiers</span><span class="op" id="7507216">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7507220">[</span><span class="op" id="7507221">]</span><span class="ident" id="7507222">asn1</span><span class="op" id="7507226">.</span><span class="ident" id="7507227">ObjectIdentifier</span><span class="op" id="7507243">{</span><span class="op" id="7507244">[</span><span class="op" id="7507245">]</span><span class="builtintype" id="7507246">int</span><span class="op" id="7507249">{</span><span class="num" id="7507250">1</span><span class="op" id="7507251">,</span>&nbsp;<span class="num" id="7507253">2</span><span class="op" id="7507254">,</span>&nbsp;<span class="num" id="7507256">3</span><span class="op" id="7507257">}</span><span class="op" id="7507258">}</span><span class="op" id="7507259">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7507264">PermittedDNSDomains</span><span class="op" id="7507283">:</span>&nbsp;<span class="op" id="7507285">[</span><span class="op" id="7507286">]</span><span class="builtintype" id="7507287">string</span><span class="op" id="7507293">{</span><span class="string" id="7507294">&#34;.example.com&#34;</span><span class="op" id="7507308">,</span>&nbsp;<span class="string" id="7507310">&#34;example.com&#34;</span><span class="op" id="7507323">}</span><span class="op" id="7507324">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7507330">CRLDistributionPoints</span><span class="op" id="7507351">:</span>&nbsp;<span class="op" id="7507353">[</span><span class="op" id="7507354">]</span><span class="builtintype" id="7507355">string</span><span class="op" id="7507361">{</span><span class="string" id="7507362">&#34;http://crl1.example.com/ca1.crl&#34;</span><span class="op" id="7507395">,</span>&nbsp;<span class="string" id="7507397">&#34;http://crl2.example.com/ca1.crl&#34;</span><span class="op" id="7507430">}</span><span class="op" id="7507431">,</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7507437">ExtraExtensions</span><span class="op" id="7507452">:</span>&nbsp;<span class="op" id="7507454">[</span><span class="op" id="7507455">]</span><span class="ident" id="7507456">pkix</span><span class="op" id="7507460">.</span><span class="ident" id="7507461">Extension</span><span class="op" id="7507470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7507476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7507483">Id</span><span class="op" id="7507485">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7507490">[</span><span class="op" id="7507491">]</span><span class="builtintype" id="7507492">int</span><span class="op" id="7507495">{</span><span class="num" id="7507496">1</span><span class="op" id="7507497">,</span>&nbsp;<span class="num" id="7507499">2</span><span class="op" id="7507500">,</span>&nbsp;<span class="num" id="7507502">3</span><span class="op" id="7507503">,</span>&nbsp;<span class="num" id="7507505">4</span><span class="op" id="7507506">}</span><span class="op" id="7507507">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7507514">Value</span><span class="op" id="7507519">:</span>&nbsp;<span class="ident" id="7507521">extraExtensionData</span><span class="op" id="7507539">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7507545">}</span><span class="op" id="7507546">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7507552">//&nbsp;This&nbsp;extension&nbsp;should&nbsp;override&nbsp;the&nbsp;SubjectKeyId,&nbsp;above.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7507615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7507622">Id</span><span class="op" id="7507624">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7507632">oidExtensionSubjectKeyId</span><span class="op" id="7507656">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7507663">Critical</span><span class="op" id="7507671">:</span>&nbsp;<span class="builtintype" id="7507673">false</span><span class="op" id="7507678">,</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7507685">Value</span><span class="op" id="7507690">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7507695">[</span><span class="op" id="7507696">]</span><span class="builtintype" id="7507697">byte</span><span class="op" id="7507701">{</span><span class="num" id="7507702">0x04</span><span class="op" id="7507706">,</span>&nbsp;<span class="num" id="7507708">0x04</span><span class="op" id="7507712">,</span>&nbsp;<span class="num" id="7507714">4</span><span class="op" id="7507715">,</span>&nbsp;<span class="num" id="7507717">3</span><span class="op" id="7507718">,</span>&nbsp;<span class="num" id="7507720">2</span><span class="op" id="7507721">,</span>&nbsp;<span class="num" id="7507723">1</span><span class="op" id="7507724">}</span><span class="op" id="7507725">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7507731">}</span><span class="op" id="7507732">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7507737">}</span><span class="op" id="7507738">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7507742">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7507747">derBytes</span><span class="op" id="7507755">,</span>&nbsp;<span class="ident" id="7507757">err</span>&nbsp;<span class="op" id="7507761">:=</span>&nbsp;<span class="ident" id="7507764">CreateCertificate</span><span class="op" id="7507781">(</span><span class="ident" id="7507782">random</span><span class="op" id="7507788">,</span>&nbsp;<span class="op" id="7507790">&amp;</span><span class="ident" id="7507791">template</span><span class="op" id="7507799">,</span>&nbsp;<span class="op" id="7507801">&amp;</span><span class="ident" id="7507802">template</span><span class="op" id="7507810">,</span>&nbsp;<span class="ident" id="7507812">test</span><span class="op" id="7507816">.</span><span class="ident" id="7507817">pub</span><span class="op" id="7507820">,</span>&nbsp;<span class="ident" id="7507822">test</span><span class="op" id="7507826">.</span><span class="ident" id="7507827">priv</span><span class="op" id="7507831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7507835">if</span>&nbsp;<span class="ident" id="7507838">err</span>&nbsp;<span class="op" id="7507842">!=</span>&nbsp;<span class="builtintype" id="7507845">nil</span>&nbsp;<span class="op" id="7507849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7507854">t</span><span class="op" id="7507855">.</span><span class="ident" id="7507856">Errorf</span><span class="op" id="7507862">(</span><span class="string" id="7507863">&#34;%s:&nbsp;failed&nbsp;to&nbsp;create&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7507901">,</span>&nbsp;<span class="ident" id="7507903">test</span><span class="op" id="7507907">.</span><span class="ident" id="7507908">name</span><span class="op" id="7507912">,</span>&nbsp;<span class="ident" id="7507914">err</span><span class="op" id="7507917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7507922">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7507933">}</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7507938">cert</span><span class="op" id="7507942">,</span>&nbsp;<span class="ident" id="7507944">err</span>&nbsp;<span class="op" id="7507948">:=</span>&nbsp;<span class="ident" id="7507951">ParseCertificate</span><span class="op" id="7507967">(</span><span class="ident" id="7507968">derBytes</span><span class="op" id="7507976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7507980">if</span>&nbsp;<span class="ident" id="7507983">err</span>&nbsp;<span class="op" id="7507987">!=</span>&nbsp;<span class="builtintype" id="7507990">nil</span>&nbsp;<span class="op" id="7507994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7507999">t</span><span class="op" id="7508000">.</span><span class="ident" id="7508001">Errorf</span><span class="op" id="7508007">(</span><span class="string" id="7508008">&#34;%s:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7508045">,</span>&nbsp;<span class="ident" id="7508047">test</span><span class="op" id="7508051">.</span><span class="ident" id="7508052">name</span><span class="op" id="7508056">,</span>&nbsp;<span class="ident" id="7508058">err</span><span class="op" id="7508061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7508066">continue</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7508077">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7508082">if</span>&nbsp;<span class="builtinfunc" id="7508085">len</span><span class="op" id="7508088">(</span><span class="ident" id="7508089">cert</span><span class="op" id="7508093">.</span><span class="ident" id="7508094">PolicyIdentifiers</span><span class="op" id="7508111">)</span>&nbsp;<span class="op" id="7508113">!=</span>&nbsp;<span class="num" id="7508116">1</span>&nbsp;<span class="op" id="7508118">||</span>&nbsp;<span class="op" id="7508121">!</span><span class="ident" id="7508122">cert</span><span class="op" id="7508126">.</span><span class="ident" id="7508127">PolicyIdentifiers</span><span class="op" id="7508144">[</span><span class="num" id="7508145">0</span><span class="op" id="7508146">]</span><span class="op" id="7508147">.</span><span class="ident" id="7508148">Equal</span><span class="op" id="7508153">(</span><span class="ident" id="7508154">template</span><span class="op" id="7508162">.</span><span class="ident" id="7508163">PolicyIdentifiers</span><span class="op" id="7508180">[</span><span class="num" id="7508181">0</span><span class="op" id="7508182">]</span><span class="op" id="7508183">)</span>&nbsp;<span class="op" id="7508185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7508190">t</span><span class="op" id="7508191">.</span><span class="ident" id="7508192">Errorf</span><span class="op" id="7508198">(</span><span class="string" id="7508199">&#34;%s:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;policy&nbsp;identifiers:&nbsp;got:%#v&nbsp;want:%#v&#34;</span><span class="op" id="7508257">,</span>&nbsp;<span class="ident" id="7508259">test</span><span class="op" id="7508263">.</span><span class="ident" id="7508264">name</span><span class="op" id="7508268">,</span>&nbsp;<span class="ident" id="7508270">cert</span><span class="op" id="7508274">.</span><span class="ident" id="7508275">PolicyIdentifiers</span><span class="op" id="7508292">,</span>&nbsp;<span class="ident" id="7508294">template</span><span class="op" id="7508302">.</span><span class="ident" id="7508303">PolicyIdentifiers</span><span class="op" id="7508320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7508324">}</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7508329">if</span>&nbsp;<span class="builtinfunc" id="7508332">len</span><span class="op" id="7508335">(</span><span class="ident" id="7508336">cert</span><span class="op" id="7508340">.</span><span class="ident" id="7508341">PermittedDNSDomains</span><span class="op" id="7508360">)</span>&nbsp;<span class="op" id="7508362">!=</span>&nbsp;<span class="num" id="7508365">2</span>&nbsp;<span class="op" id="7508367">||</span>&nbsp;<span class="ident" id="7508370">cert</span><span class="op" id="7508374">.</span><span class="ident" id="7508375">PermittedDNSDomains</span><span class="op" id="7508394">[</span><span class="num" id="7508395">0</span><span class="op" id="7508396">]</span>&nbsp;<span class="op" id="7508398">!=</span>&nbsp;<span class="string" id="7508401">&#34;.example.com&#34;</span>&nbsp;<span class="op" id="7508416">||</span>&nbsp;<span class="ident" id="7508419">cert</span><span class="op" id="7508423">.</span><span class="ident" id="7508424">PermittedDNSDomains</span><span class="op" id="7508443">[</span><span class="num" id="7508444">1</span><span class="op" id="7508445">]</span>&nbsp;<span class="op" id="7508447">!=</span>&nbsp;<span class="string" id="7508450">&#34;example.com&#34;</span>&nbsp;<span class="op" id="7508464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7508469">t</span><span class="op" id="7508470">.</span><span class="ident" id="7508471">Errorf</span><span class="op" id="7508477">(</span><span class="string" id="7508478">&#34;%s:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;name&nbsp;constraints:&nbsp;%#v&#34;</span><span class="op" id="7508521">,</span>&nbsp;<span class="ident" id="7508523">test</span><span class="op" id="7508527">.</span><span class="ident" id="7508528">name</span><span class="op" id="7508532">,</span>&nbsp;<span class="ident" id="7508534">cert</span><span class="op" id="7508538">.</span><span class="ident" id="7508539">PermittedDNSDomains</span><span class="op" id="7508558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7508562">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7508567">if</span>&nbsp;<span class="ident" id="7508570">cert</span><span class="op" id="7508574">.</span><span class="ident" id="7508575">Subject</span><span class="op" id="7508582">.</span><span class="ident" id="7508583">CommonName</span>&nbsp;<span class="op" id="7508594">!=</span>&nbsp;<span class="ident" id="7508597">commonName</span>&nbsp;<span class="op" id="7508608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7508613">t</span><span class="op" id="7508614">.</span><span class="ident" id="7508615">Errorf</span><span class="op" id="7508621">(</span><span class="string" id="7508622">&#34;%s:&nbsp;subject&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7508694">,</span>&nbsp;<span class="ident" id="7508696">test</span><span class="op" id="7508700">.</span><span class="ident" id="7508701">name</span><span class="op" id="7508705">,</span>&nbsp;<span class="ident" id="7508707">cert</span><span class="op" id="7508711">.</span><span class="ident" id="7508712">Subject</span><span class="op" id="7508719">.</span><span class="ident" id="7508720">CommonName</span><span class="op" id="7508730">,</span>&nbsp;<span class="ident" id="7508732">commonName</span><span class="op" id="7508742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7508746">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7508751">if</span>&nbsp;<span class="ident" id="7508754">cert</span><span class="op" id="7508758">.</span><span class="ident" id="7508759">Issuer</span><span class="op" id="7508765">.</span><span class="ident" id="7508766">CommonName</span>&nbsp;<span class="op" id="7508777">!=</span>&nbsp;<span class="ident" id="7508780">commonName</span>&nbsp;<span class="op" id="7508791">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7508796">t</span><span class="op" id="7508797">.</span><span class="ident" id="7508798">Errorf</span><span class="op" id="7508804">(</span><span class="string" id="7508805">&#34;%s:&nbsp;issuer&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7508876">,</span>&nbsp;<span class="ident" id="7508878">test</span><span class="op" id="7508882">.</span><span class="ident" id="7508883">name</span><span class="op" id="7508887">,</span>&nbsp;<span class="ident" id="7508889">cert</span><span class="op" id="7508893">.</span><span class="ident" id="7508894">Issuer</span><span class="op" id="7508900">.</span><span class="ident" id="7508901">CommonName</span><span class="op" id="7508911">,</span>&nbsp;<span class="ident" id="7508913">commonName</span><span class="op" id="7508923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7508927">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7508932">if</span>&nbsp;<span class="ident" id="7508935">cert</span><span class="op" id="7508939">.</span><span class="ident" id="7508940">SignatureAlgorithm</span>&nbsp;<span class="op" id="7508959">!=</span>&nbsp;<span class="ident" id="7508962">test</span><span class="op" id="7508966">.</span><span class="ident" id="7508967">sigAlgo</span>&nbsp;<span class="op" id="7508975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7508980">t</span><span class="op" id="7508981">.</span><span class="ident" id="7508982">Errorf</span><span class="op" id="7508988">(</span><span class="string" id="7508989">&#34;%s:&nbsp;SignatureAlgorithm&nbsp;wasn&#39;t&nbsp;copied&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7509058">,</span>&nbsp;<span class="ident" id="7509060">test</span><span class="op" id="7509064">.</span><span class="ident" id="7509065">name</span><span class="op" id="7509069">,</span>&nbsp;<span class="ident" id="7509071">cert</span><span class="op" id="7509075">.</span><span class="ident" id="7509076">SignatureAlgorithm</span><span class="op" id="7509094">,</span>&nbsp;<span class="ident" id="7509096">test</span><span class="op" id="7509100">.</span><span class="ident" id="7509101">sigAlgo</span><span class="op" id="7509108">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7509112">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7509117">if</span>&nbsp;<span class="op" id="7509120">!</span><span class="ident" id="7509121">reflect</span><span class="op" id="7509128">.</span><span class="ident" id="7509129">DeepEqual</span><span class="op" id="7509138">(</span><span class="ident" id="7509139">cert</span><span class="op" id="7509143">.</span><span class="ident" id="7509144">ExtKeyUsage</span><span class="op" id="7509155">,</span>&nbsp;<span class="ident" id="7509157">testExtKeyUsage</span><span class="op" id="7509172">)</span>&nbsp;<span class="op" id="7509174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7509179">t</span><span class="op" id="7509180">.</span><span class="ident" id="7509181">Errorf</span><span class="op" id="7509187">(</span><span class="string" id="7509188">&#34;%s:&nbsp;extkeyusage&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7509264">,</span>&nbsp;<span class="ident" id="7509266">test</span><span class="op" id="7509270">.</span><span class="ident" id="7509271">name</span><span class="op" id="7509275">,</span>&nbsp;<span class="ident" id="7509277">cert</span><span class="op" id="7509281">.</span><span class="ident" id="7509282">ExtKeyUsage</span><span class="op" id="7509293">,</span>&nbsp;<span class="ident" id="7509295">testExtKeyUsage</span><span class="op" id="7509310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7509314">}</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7509319">if</span>&nbsp;<span class="op" id="7509322">!</span><span class="ident" id="7509323">reflect</span><span class="op" id="7509330">.</span><span class="ident" id="7509331">DeepEqual</span><span class="op" id="7509340">(</span><span class="ident" id="7509341">cert</span><span class="op" id="7509345">.</span><span class="ident" id="7509346">UnknownExtKeyUsage</span><span class="op" id="7509364">,</span>&nbsp;<span class="ident" id="7509366">testUnknownExtKeyUsage</span><span class="op" id="7509388">)</span>&nbsp;<span class="op" id="7509390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7509395">t</span><span class="op" id="7509396">.</span><span class="ident" id="7509397">Errorf</span><span class="op" id="7509403">(</span><span class="string" id="7509404">&#34;%s:&nbsp;unknown&nbsp;extkeyusage&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7509488">,</span>&nbsp;<span class="ident" id="7509490">test</span><span class="op" id="7509494">.</span><span class="ident" id="7509495">name</span><span class="op" id="7509499">,</span>&nbsp;<span class="ident" id="7509501">cert</span><span class="op" id="7509505">.</span><span class="ident" id="7509506">UnknownExtKeyUsage</span><span class="op" id="7509524">,</span>&nbsp;<span class="ident" id="7509526">testUnknownExtKeyUsage</span><span class="op" id="7509548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7509552">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7509557">if</span>&nbsp;<span class="op" id="7509560">!</span><span class="ident" id="7509561">reflect</span><span class="op" id="7509568">.</span><span class="ident" id="7509569">DeepEqual</span><span class="op" id="7509578">(</span><span class="ident" id="7509579">cert</span><span class="op" id="7509583">.</span><span class="ident" id="7509584">OCSPServer</span><span class="op" id="7509594">,</span>&nbsp;<span class="ident" id="7509596">template</span><span class="op" id="7509604">.</span><span class="ident" id="7509605">OCSPServer</span><span class="op" id="7509615">)</span>&nbsp;<span class="op" id="7509617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7509622">t</span><span class="op" id="7509623">.</span><span class="ident" id="7509624">Errorf</span><span class="op" id="7509630">(</span><span class="string" id="7509631">&#34;%s:&nbsp;OCSP&nbsp;servers&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7509687">,</span>&nbsp;<span class="ident" id="7509689">test</span><span class="op" id="7509693">.</span><span class="ident" id="7509694">name</span><span class="op" id="7509698">,</span>&nbsp;<span class="ident" id="7509700">cert</span><span class="op" id="7509704">.</span><span class="ident" id="7509705">OCSPServer</span><span class="op" id="7509715">,</span>&nbsp;<span class="ident" id="7509717">template</span><span class="op" id="7509725">.</span><span class="ident" id="7509726">OCSPServer</span><span class="op" id="7509736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7509740">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7509745">if</span>&nbsp;<span class="op" id="7509748">!</span><span class="ident" id="7509749">reflect</span><span class="op" id="7509756">.</span><span class="ident" id="7509757">DeepEqual</span><span class="op" id="7509766">(</span><span class="ident" id="7509767">cert</span><span class="op" id="7509771">.</span><span class="ident" id="7509772">IssuingCertificateURL</span><span class="op" id="7509793">,</span>&nbsp;<span class="ident" id="7509795">template</span><span class="op" id="7509803">.</span><span class="ident" id="7509804">IssuingCertificateURL</span><span class="op" id="7509825">)</span>&nbsp;<span class="op" id="7509827">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7509832">t</span><span class="op" id="7509833">.</span><span class="ident" id="7509834">Errorf</span><span class="op" id="7509840">(</span><span class="string" id="7509841">&#34;%s:&nbsp;Issuing&nbsp;certificate&nbsp;URLs&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7509909">,</span>&nbsp;<span class="ident" id="7509911">test</span><span class="op" id="7509915">.</span><span class="ident" id="7509916">name</span><span class="op" id="7509920">,</span>&nbsp;<span class="ident" id="7509922">cert</span><span class="op" id="7509926">.</span><span class="ident" id="7509927">IssuingCertificateURL</span><span class="op" id="7509948">,</span>&nbsp;<span class="ident" id="7509950">template</span><span class="op" id="7509958">.</span><span class="ident" id="7509959">IssuingCertificateURL</span><span class="op" id="7509980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7509984">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7509989">if</span>&nbsp;<span class="op" id="7509992">!</span><span class="ident" id="7509993">reflect</span><span class="op" id="7510000">.</span><span class="ident" id="7510001">DeepEqual</span><span class="op" id="7510010">(</span><span class="ident" id="7510011">cert</span><span class="op" id="7510015">.</span><span class="ident" id="7510016">DNSNames</span><span class="op" id="7510024">,</span>&nbsp;<span class="ident" id="7510026">template</span><span class="op" id="7510034">.</span><span class="ident" id="7510035">DNSNames</span><span class="op" id="7510043">)</span>&nbsp;<span class="op" id="7510045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7510050">t</span><span class="op" id="7510051">.</span><span class="ident" id="7510052">Errorf</span><span class="op" id="7510058">(</span><span class="string" id="7510059">&#34;%s:&nbsp;SAN&nbsp;DNS&nbsp;names&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7510116">,</span>&nbsp;<span class="ident" id="7510118">test</span><span class="op" id="7510122">.</span><span class="ident" id="7510123">name</span><span class="op" id="7510127">,</span>&nbsp;<span class="ident" id="7510129">cert</span><span class="op" id="7510133">.</span><span class="ident" id="7510134">DNSNames</span><span class="op" id="7510142">,</span>&nbsp;<span class="ident" id="7510144">template</span><span class="op" id="7510152">.</span><span class="ident" id="7510153">DNSNames</span><span class="op" id="7510161">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7510165">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7510170">if</span>&nbsp;<span class="op" id="7510173">!</span><span class="ident" id="7510174">reflect</span><span class="op" id="7510181">.</span><span class="ident" id="7510182">DeepEqual</span><span class="op" id="7510191">(</span><span class="ident" id="7510192">cert</span><span class="op" id="7510196">.</span><span class="ident" id="7510197">EmailAddresses</span><span class="op" id="7510211">,</span>&nbsp;<span class="ident" id="7510213">template</span><span class="op" id="7510221">.</span><span class="ident" id="7510222">EmailAddresses</span><span class="op" id="7510236">)</span>&nbsp;<span class="op" id="7510238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7510243">t</span><span class="op" id="7510244">.</span><span class="ident" id="7510245">Errorf</span><span class="op" id="7510251">(</span><span class="string" id="7510252">&#34;%s:&nbsp;SAN&nbsp;emails&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7510306">,</span>&nbsp;<span class="ident" id="7510308">test</span><span class="op" id="7510312">.</span><span class="ident" id="7510313">name</span><span class="op" id="7510317">,</span>&nbsp;<span class="ident" id="7510319">cert</span><span class="op" id="7510323">.</span><span class="ident" id="7510324">EmailAddresses</span><span class="op" id="7510338">,</span>&nbsp;<span class="ident" id="7510340">template</span><span class="op" id="7510348">.</span><span class="ident" id="7510349">EmailAddresses</span><span class="op" id="7510363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7510367">}</span><br>
<span class="lineno">425</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7510372">if</span>&nbsp;<span class="op" id="7510375">!</span><span class="ident" id="7510376">reflect</span><span class="op" id="7510383">.</span><span class="ident" id="7510384">DeepEqual</span><span class="op" id="7510393">(</span><span class="ident" id="7510394">cert</span><span class="op" id="7510398">.</span><span class="ident" id="7510399">IPAddresses</span><span class="op" id="7510410">,</span>&nbsp;<span class="ident" id="7510412">template</span><span class="op" id="7510420">.</span><span class="ident" id="7510421">IPAddresses</span><span class="op" id="7510432">)</span>&nbsp;<span class="op" id="7510434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7510439">t</span><span class="op" id="7510440">.</span><span class="ident" id="7510441">Errorf</span><span class="op" id="7510447">(</span><span class="string" id="7510448">&#34;%s:&nbsp;SAN&nbsp;IPs&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7510499">,</span>&nbsp;<span class="ident" id="7510501">test</span><span class="op" id="7510505">.</span><span class="ident" id="7510506">name</span><span class="op" id="7510510">,</span>&nbsp;<span class="ident" id="7510512">cert</span><span class="op" id="7510516">.</span><span class="ident" id="7510517">IPAddresses</span><span class="op" id="7510528">,</span>&nbsp;<span class="ident" id="7510530">template</span><span class="op" id="7510538">.</span><span class="ident" id="7510539">IPAddresses</span><span class="op" id="7510550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7510554">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7510559">if</span>&nbsp;<span class="op" id="7510562">!</span><span class="ident" id="7510563">reflect</span><span class="op" id="7510570">.</span><span class="ident" id="7510571">DeepEqual</span><span class="op" id="7510580">(</span><span class="ident" id="7510581">cert</span><span class="op" id="7510585">.</span><span class="ident" id="7510586">CRLDistributionPoints</span><span class="op" id="7510607">,</span>&nbsp;<span class="ident" id="7510609">template</span><span class="op" id="7510617">.</span><span class="ident" id="7510618">CRLDistributionPoints</span><span class="op" id="7510639">)</span>&nbsp;<span class="op" id="7510641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7510646">t</span><span class="op" id="7510647">.</span><span class="ident" id="7510648">Errorf</span><span class="op" id="7510654">(</span><span class="string" id="7510655">&#34;%s:&nbsp;CRL&nbsp;distribution&nbsp;points&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7510722">,</span>&nbsp;<span class="ident" id="7510724">test</span><span class="op" id="7510728">.</span><span class="ident" id="7510729">name</span><span class="op" id="7510733">,</span>&nbsp;<span class="ident" id="7510735">cert</span><span class="op" id="7510739">.</span><span class="ident" id="7510740">CRLDistributionPoints</span><span class="op" id="7510761">,</span>&nbsp;<span class="ident" id="7510763">template</span><span class="op" id="7510771">.</span><span class="ident" id="7510772">CRLDistributionPoints</span><span class="op" id="7510793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7510797">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7510802">if</span>&nbsp;<span class="op" id="7510805">!</span><span class="ident" id="7510806">bytes</span><span class="op" id="7510811">.</span><span class="ident" id="7510812">Equal</span><span class="op" id="7510817">(</span><span class="ident" id="7510818">cert</span><span class="op" id="7510822">.</span><span class="ident" id="7510823">SubjectKeyId</span><span class="op" id="7510835">,</span>&nbsp;<span class="op" id="7510837">[</span><span class="op" id="7510838">]</span><span class="builtintype" id="7510839">byte</span><span class="op" id="7510843">{</span><span class="num" id="7510844">4</span><span class="op" id="7510845">,</span>&nbsp;<span class="num" id="7510847">3</span><span class="op" id="7510848">,</span>&nbsp;<span class="num" id="7510850">2</span><span class="op" id="7510851">,</span>&nbsp;<span class="num" id="7510853">1</span><span class="op" id="7510854">}</span><span class="op" id="7510855">)</span>&nbsp;<span class="op" id="7510857">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7510862">t</span><span class="op" id="7510863">.</span><span class="ident" id="7510864">Errorf</span><span class="op" id="7510870">(</span><span class="string" id="7510871">&#34;%s:&nbsp;ExtraExtensions&nbsp;didn&#39;t&nbsp;override&nbsp;SubjectKeyId&#34;</span><span class="op" id="7510921">,</span>&nbsp;<span class="ident" id="7510923">test</span><span class="op" id="7510927">.</span><span class="ident" id="7510928">name</span><span class="op" id="7510932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7510936">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7510941">if</span>&nbsp;<span class="ident" id="7510944">bytes</span><span class="op" id="7510949">.</span><span class="ident" id="7510950">Index</span><span class="op" id="7510955">(</span><span class="ident" id="7510956">derBytes</span><span class="op" id="7510964">,</span>&nbsp;<span class="ident" id="7510966">extraExtensionData</span><span class="op" id="7510984">)</span>&nbsp;<span class="op" id="7510986">==</span>&nbsp;<span class="op" id="7510989">-</span><span class="num" id="7510990">1</span>&nbsp;<span class="op" id="7510992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7510997">t</span><span class="op" id="7510998">.</span><span class="ident" id="7510999">Errorf</span><span class="op" id="7511005">(</span><span class="string" id="7511006">&#34;%s:&nbsp;didn&#39;t&nbsp;find&nbsp;extra&nbsp;extension&nbsp;in&nbsp;DER&nbsp;output&#34;</span><span class="op" id="7511053">,</span>&nbsp;<span class="ident" id="7511055">test</span><span class="op" id="7511059">.</span><span class="ident" id="7511060">name</span><span class="op" id="7511064">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7511068">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7511073">if</span>&nbsp;<span class="ident" id="7511076">test</span><span class="op" id="7511080">.</span><span class="ident" id="7511081">checkSig</span>&nbsp;<span class="op" id="7511090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7511095">err</span>&nbsp;<span class="op" id="7511099">=</span>&nbsp;<span class="ident" id="7511101">cert</span><span class="op" id="7511105">.</span><span class="ident" id="7511106">CheckSignatureFrom</span><span class="op" id="7511124">(</span><span class="ident" id="7511125">cert</span><span class="op" id="7511129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7511134">if</span>&nbsp;<span class="ident" id="7511137">err</span>&nbsp;<span class="op" id="7511141">!=</span>&nbsp;<span class="builtintype" id="7511144">nil</span>&nbsp;<span class="op" id="7511148">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7511154">t</span><span class="op" id="7511155">.</span><span class="ident" id="7511156">Errorf</span><span class="op" id="7511162">(</span><span class="string" id="7511163">&#34;%s:&nbsp;signature&nbsp;verification&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="7511202">,</span>&nbsp;<span class="ident" id="7511204">test</span><span class="op" id="7511208">.</span><span class="ident" id="7511209">name</span><span class="op" id="7511213">,</span>&nbsp;<span class="ident" id="7511215">err</span><span class="op" id="7511218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7511223">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7511227">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7511230">}</span><br>
<span class="lineno"></span><span class="op" id="7511232">}</span><br>
<span class="lineno">450</span><br>
<span class="lineno"></span><span class="comment" id="7511235">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA1&nbsp;&amp;&nbsp;secp256r1</span><br>
<span class="lineno"></span><span class="keyword" id="7511296">var</span>&nbsp;<span class="ident" id="7511300">ecdsaSHA1CertPem</span>&nbsp;<span class="op" id="7511317">=</span>&nbsp;<span class="string" id="7511319">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIICDjCCAbUCCQDF6SfN0nsnrjAJBgcqhkjOPQQBMIGPMQswCQYDVQQGEwJVUzET<br>
<span class="lineno">455</span>MBEGA1UECAwKQ2FsaWZvcm5pYTEWMBQGA1UEBwwNTW91bnRhaW4gVmlldzEVMBMG<br>
<span class="lineno"></span>A1UECgwMR29vZ2xlLCBJbmMuMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEG<br>
<span class="lineno"></span>CSqGSIb3DQEJARYUZ29sYW5nLWRldkBnbWFpbC5jb20wHhcNMTIwNTIwMjAyMDUw<br>
<span class="lineno"></span>WhcNMjIwNTE4MjAyMDUwWjCBjzELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlm<br>
<span class="lineno"></span>b3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFTATBgNVBAoMDEdvb2dsZSwg<br>
<span class="lineno">460</span>SW5jLjEXMBUGA1UEAwwOd3d3Lmdvb2dsZS5jb20xIzAhBgkqhkiG9w0BCQEWFGdv<br>
<span class="lineno"></span>bGFuZy1kZXZAZ21haWwuY29tMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE/Wgn<br>
<span class="lineno"></span>WQDo5+bz71T0327ERgd5SDDXFbXLpzIZDXTkjpe8QTEbsF+ezsQfrekrpDPC4Cd3<br>
<span class="lineno"></span>P9LY0tG+aI8IyVKdUjAJBgcqhkjOPQQBA0gAMEUCIGlsqMcRqWVIWTD6wXwe6Jk2<br>
<span class="lineno"></span>DKxL46r/FLgJYnzBEH99AiEA3fBouObsvV1R3oVkb4BQYnD4/4LeId6lAT43YvyV<br>
<span class="lineno">465</span>a/A=<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7512098">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA256&nbsp;&amp;&nbsp;secp256r1</span><br>
<span class="lineno">470</span><span class="keyword" id="7512161">var</span>&nbsp;<span class="ident" id="7512165">ecdsaSHA256p256CertPem</span>&nbsp;<span class="op" id="7512188">=</span>&nbsp;<span class="string" id="7512190">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIICDzCCAbYCCQDlsuMWvgQzhTAKBggqhkjOPQQDAjCBjzELMAkGA1UEBhMCVVMx<br>
<span class="lineno"></span>EzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFTAT<br>
<span class="lineno"></span>BgNVBAoMDEdvb2dsZSwgSW5jLjEXMBUGA1UEAwwOd3d3Lmdvb2dsZS5jb20xIzAh<br>
<span class="lineno">475</span>BgkqhkiG9w0BCQEWFGdvbGFuZy1kZXZAZ21haWwuY29tMB4XDTEyMDUyMTAwMTkx<br>
<span class="lineno"></span>NloXDTIyMDUxOTAwMTkxNlowgY8xCzAJBgNVBAYTAlVTMRMwEQYDVQQIDApDYWxp<br>
<span class="lineno"></span>Zm9ybmlhMRYwFAYDVQQHDA1Nb3VudGFpbiBWaWV3MRUwEwYDVQQKDAxHb29nbGUs<br>
<span class="lineno"></span>IEluYy4xFzAVBgNVBAMMDnd3dy5nb29nbGUuY29tMSMwIQYJKoZIhvcNAQkBFhRn<br>
<span class="lineno"></span>b2xhbmctZGV2QGdtYWlsLmNvbTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABPMt<br>
<span class="lineno">480</span>2ErhxAty5EJRu9yM+MTy+hUXm3pdW1ensAv382KoGExSXAFWP7pjJnNtHO+XSwVm<br>
<span class="lineno"></span>YNtqjcAGFKpweoN//kQwCgYIKoZIzj0EAwIDRwAwRAIgIYSaUA/IB81gjbIw/hUV<br>
<span class="lineno"></span>70twxJr5EcgOo0hLp3Jm+EYCIFDO3NNcgmURbJ1kfoS3N/0O+irUtoPw38YoNkqJ<br>
<span class="lineno"></span>h5wi<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno">485</span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7512969">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA256&nbsp;&amp;&nbsp;secp384r1</span><br>
<span class="lineno"></span><span class="keyword" id="7513032">var</span>&nbsp;<span class="ident" id="7513036">ecdsaSHA256p384CertPem</span>&nbsp;<span class="op" id="7513059">=</span>&nbsp;<span class="string" id="7513061">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno">490</span>MIICSjCCAdECCQDje/no7mXkVzAKBggqhkjOPQQDAjCBjjELMAkGA1UEBhMCVVMx<br>
<span class="lineno"></span>EzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDAS<br>
<span class="lineno"></span>BgNVBAoMC0dvb2dsZSwgSW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEG<br>
<span class="lineno"></span>CSqGSIb3DQEJARYUZ29sYW5nLWRldkBnbWFpbC5jb20wHhcNMTIwNTIxMDYxMDM0<br>
<span class="lineno"></span>WhcNMjIwNTE5MDYxMDM0WjCBjjELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlm<br>
<span class="lineno">495</span>b3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDASBgNVBAoMC0dvb2dsZSwg<br>
<span class="lineno"></span>SW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEGCSqGSIb3DQEJARYUZ29s<br>
<span class="lineno"></span>YW5nLWRldkBnbWFpbC5jb20wdjAQBgcqhkjOPQIBBgUrgQQAIgNiAARRuzRNIKRK<br>
<span class="lineno"></span>jIktEmXanNmrTR/q/FaHXLhWRZ6nHWe26Fw7Rsrbk+VjGy4vfWtNn7xSFKrOu5ze<br>
<span class="lineno"></span>qxKnmE0h5E480MNgrUiRkaGO2GMJJVmxx20aqkXOk59U8yGA4CghE6MwCgYIKoZI<br>
<span class="lineno">500</span>zj0EAwIDZwAwZAIwBZEN8gvmRmfeP/9C1PRLzODIY4JqWub2PLRT4mv9GU+yw3Gr<br>
<span class="lineno"></span>PU9A3CHMdEcdw/MEAjBBO1lId8KOCh9UZunsSMfqXiVurpzmhWd6VYZ/32G+M+Mh<br>
<span class="lineno"></span>3yILeYQzllt/g0rKVRk=<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span><span class="comment" id="7513921">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA384&nbsp;&amp;&nbsp;secp521r1</span><br>
<span class="lineno"></span><span class="keyword" id="7513984">var</span>&nbsp;<span class="ident" id="7513988">ecdsaSHA384p521CertPem</span>&nbsp;<span class="op" id="7514011">=</span>&nbsp;<span class="string" id="7514013">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIICljCCAfcCCQDhp1AFD/ahKjAKBggqhkjOPQQDAzCBjjELMAkGA1UEBhMCVVMx<br>
<span class="lineno">510</span>EzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDAS<br>
<span class="lineno"></span>BgNVBAoMC0dvb2dsZSwgSW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEG<br>
<span class="lineno"></span>CSqGSIb3DQEJARYUZ29sYW5nLWRldkBnbWFpbC5jb20wHhcNMTIwNTIxMTUwNDI5<br>
<span class="lineno"></span>WhcNMjIwNTE5MTUwNDI5WjCBjjELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlm<br>
<span class="lineno"></span>b3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDASBgNVBAoMC0dvb2dsZSwg<br>
<span class="lineno">515</span>SW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEGCSqGSIb3DQEJARYUZ29s<br>
<span class="lineno"></span>YW5nLWRldkBnbWFpbC5jb20wgZswEAYHKoZIzj0CAQYFK4EEACMDgYYABACqx9Rv<br>
<span class="lineno"></span>IssRs1LWYcNN+WffwlHw4Tv3y8/LIAA9MF1ZScIonU9nRMxt4a2uGJVCPDw6JHpz<br>
<span class="lineno"></span>PaYc0E9puLoE9AfKpwFr59Jkot7dBg55SKPEFkddoip/rvmN7NPAWjMBirOwjOkm<br>
<span class="lineno"></span>8FPthvPhGPqsu9AvgVuHu3PosWiHGNrhh379pva8MzAKBggqhkjOPQQDAwOBjAAw<br>
<span class="lineno">520</span>gYgCQgEHNmswkUdPpHqrVxp9PvLVl+xxPuHBkT+75z9JizyxtqykHQo9Uh6SWCYH<br>
<span class="lineno"></span>BF9KLolo01wMt8DjoYP5Fb3j5MH7xwJCAbWZzTOp4l4DPkIvAh4LeC4VWbwPPyqh<br>
<span class="lineno"></span>kBg71w/iEcSY3wUKgHGcJJrObZw7wys91I5kENljqw/Samdr3ka+jBJa<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">525</span><br>
<span class="lineno"></span><span class="keyword" id="7514974">var</span>&nbsp;<span class="ident" id="7514978">ecdsaTests</span>&nbsp;<span class="op" id="7514989">=</span>&nbsp;<span class="op" id="7514991">[</span><span class="op" id="7514992">]</span><span class="keyword" id="7514993">struct</span>&nbsp;<span class="op" id="7515000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7515003">sigAlgo</span>&nbsp;<span class="ident" id="7515011">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7515031">pemCert</span>&nbsp;<span class="builtintype" id="7515039">string</span><br>
<span class="lineno"></span><span class="op" id="7515046">}</span><span class="op" id="7515047">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7515050">{</span><span class="ident" id="7515051">ECDSAWithSHA1</span><span class="op" id="7515064">,</span>&nbsp;<span class="ident" id="7515066">ecdsaSHA1CertPem</span><span class="op" id="7515082">}</span><span class="op" id="7515083">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7515086">{</span><span class="ident" id="7515087">ECDSAWithSHA256</span><span class="op" id="7515102">,</span>&nbsp;<span class="ident" id="7515104">ecdsaSHA256p256CertPem</span><span class="op" id="7515126">}</span><span class="op" id="7515127">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7515130">{</span><span class="ident" id="7515131">ECDSAWithSHA256</span><span class="op" id="7515146">,</span>&nbsp;<span class="ident" id="7515148">ecdsaSHA256p384CertPem</span><span class="op" id="7515170">}</span><span class="op" id="7515171">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7515174">{</span><span class="ident" id="7515175">ECDSAWithSHA384</span><span class="op" id="7515190">,</span>&nbsp;<span class="ident" id="7515192">ecdsaSHA384p521CertPem</span><span class="op" id="7515214">}</span><span class="op" id="7515215">,</span><br>
<span class="lineno"></span><span class="op" id="7515217">}</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span><span class="keyword" id="7515220">func</span>&nbsp;<span class="ident" id="7515225">TestECDSA</span><span class="op" id="7515234">(</span><span class="ident" id="7515235">t</span>&nbsp;<span class="op" id="7515237">*</span><span class="ident" id="7515238">testing</span><span class="op" id="7515245">.</span><span class="ident" id="7515246">T</span><span class="op" id="7515247">)</span>&nbsp;<span class="op" id="7515249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7515252">for</span>&nbsp;<span class="ident" id="7515256">i</span><span class="op" id="7515257">,</span>&nbsp;<span class="ident" id="7515259">test</span>&nbsp;<span class="op" id="7515264">:=</span>&nbsp;<span class="keyword" id="7515267">range</span>&nbsp;<span class="ident" id="7515273">ecdsaTests</span>&nbsp;<span class="op" id="7515284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7515288">pemBlock</span><span class="op" id="7515296">,</span>&nbsp;<span class="ident" id="7515298">_</span>&nbsp;<span class="op" id="7515300">:=</span>&nbsp;<span class="ident" id="7515303">pem</span><span class="op" id="7515306">.</span><span class="ident" id="7515307">Decode</span><span class="op" id="7515313">(</span><span class="op" id="7515314">[</span><span class="op" id="7515315">]</span><span class="builtintype" id="7515316">byte</span><span class="op" id="7515320">(</span><span class="ident" id="7515321">test</span><span class="op" id="7515325">.</span><span class="ident" id="7515326">pemCert</span><span class="op" id="7515333">)</span><span class="op" id="7515334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7515338">cert</span><span class="op" id="7515342">,</span>&nbsp;<span class="ident" id="7515344">err</span>&nbsp;<span class="op" id="7515348">:=</span>&nbsp;<span class="ident" id="7515351">ParseCertificate</span><span class="op" id="7515367">(</span><span class="ident" id="7515368">pemBlock</span><span class="op" id="7515376">.</span><span class="ident" id="7515377">Bytes</span><span class="op" id="7515382">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7515386">if</span>&nbsp;<span class="ident" id="7515389">err</span>&nbsp;<span class="op" id="7515393">!=</span>&nbsp;<span class="builtintype" id="7515396">nil</span>&nbsp;<span class="op" id="7515400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7515405">t</span><span class="op" id="7515406">.</span><span class="ident" id="7515407">Errorf</span><span class="op" id="7515413">(</span><span class="string" id="7515414">&#34;%d:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7515451">,</span>&nbsp;<span class="ident" id="7515453">i</span><span class="op" id="7515454">,</span>&nbsp;<span class="ident" id="7515456">err</span><span class="op" id="7515459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7515464">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7515475">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7515479">if</span>&nbsp;<span class="ident" id="7515482">sa</span>&nbsp;<span class="op" id="7515485">:=</span>&nbsp;<span class="ident" id="7515488">cert</span><span class="op" id="7515492">.</span><span class="ident" id="7515493">SignatureAlgorithm</span><span class="op" id="7515511">;</span>&nbsp;<span class="ident" id="7515513">sa</span>&nbsp;<span class="op" id="7515516">!=</span>&nbsp;<span class="ident" id="7515519">test</span><span class="op" id="7515523">.</span><span class="ident" id="7515524">sigAlgo</span>&nbsp;<span class="op" id="7515532">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7515537">t</span><span class="op" id="7515538">.</span><span class="ident" id="7515539">Errorf</span><span class="op" id="7515545">(</span><span class="string" id="7515546">&#34;%d:&nbsp;signature&nbsp;algorithm&nbsp;is&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7515586">,</span>&nbsp;<span class="ident" id="7515588">i</span><span class="op" id="7515589">,</span>&nbsp;<span class="ident" id="7515591">sa</span><span class="op" id="7515593">,</span>&nbsp;<span class="ident" id="7515595">test</span><span class="op" id="7515599">.</span><span class="ident" id="7515600">sigAlgo</span><span class="op" id="7515607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7515611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7515615">if</span>&nbsp;<span class="ident" id="7515618">parsedKey</span><span class="op" id="7515627">,</span>&nbsp;<span class="ident" id="7515629">ok</span>&nbsp;<span class="op" id="7515632">:=</span>&nbsp;<span class="ident" id="7515635">cert</span><span class="op" id="7515639">.</span><span class="ident" id="7515640">PublicKey</span><span class="op" id="7515649">.</span><span class="op" id="7515650">(</span><span class="op" id="7515651">*</span><span class="ident" id="7515652">ecdsa</span><span class="op" id="7515657">.</span><span class="ident" id="7515658">PublicKey</span><span class="op" id="7515667">)</span><span class="op" id="7515668">;</span>&nbsp;<span class="op" id="7515670">!</span><span class="ident" id="7515671">ok</span>&nbsp;<span class="op" id="7515674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7515679">t</span><span class="op" id="7515680">.</span><span class="ident" id="7515681">Errorf</span><span class="op" id="7515687">(</span><span class="string" id="7515688">&#34;%d:&nbsp;wanted&nbsp;an&nbsp;ECDSA&nbsp;public&nbsp;key&nbsp;but&nbsp;found:&nbsp;%#v&#34;</span><span class="op" id="7515735">,</span>&nbsp;<span class="ident" id="7515737">i</span><span class="op" id="7515738">,</span>&nbsp;<span class="ident" id="7515740">parsedKey</span><span class="op" id="7515749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7515753">}</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7515757">if</span>&nbsp;<span class="ident" id="7515760">pka</span>&nbsp;<span class="op" id="7515764">:=</span>&nbsp;<span class="ident" id="7515767">cert</span><span class="op" id="7515771">.</span><span class="ident" id="7515772">PublicKeyAlgorithm</span><span class="op" id="7515790">;</span>&nbsp;<span class="ident" id="7515792">pka</span>&nbsp;<span class="op" id="7515796">!=</span>&nbsp;<span class="ident" id="7515799">ECDSA</span>&nbsp;<span class="op" id="7515805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7515810">t</span><span class="op" id="7515811">.</span><span class="ident" id="7515812">Errorf</span><span class="op" id="7515818">(</span><span class="string" id="7515819">&#34;%d:&nbsp;public&nbsp;key&nbsp;algorithm&nbsp;is&nbsp;%v,&nbsp;want&nbsp;ECDSA&#34;</span><span class="op" id="7515863">,</span>&nbsp;<span class="ident" id="7515865">i</span><span class="op" id="7515866">,</span>&nbsp;<span class="ident" id="7515868">pka</span><span class="op" id="7515871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7515875">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7515879">if</span>&nbsp;<span class="ident" id="7515882">err</span>&nbsp;<span class="op" id="7515886">=</span>&nbsp;<span class="ident" id="7515888">cert</span><span class="op" id="7515892">.</span><span class="ident" id="7515893">CheckSignatureFrom</span><span class="op" id="7515911">(</span><span class="ident" id="7515912">cert</span><span class="op" id="7515916">)</span><span class="op" id="7515917">;</span>&nbsp;<span class="ident" id="7515919">err</span>&nbsp;<span class="op" id="7515923">!=</span>&nbsp;<span class="builtintype" id="7515926">nil</span>&nbsp;<span class="op" id="7515930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7515935">t</span><span class="op" id="7515936">.</span><span class="ident" id="7515937">Errorf</span><span class="op" id="7515943">(</span><span class="string" id="7515944">&#34;%d:&nbsp;certificate&nbsp;verification&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="7515985">,</span>&nbsp;<span class="ident" id="7515987">i</span><span class="op" id="7515988">,</span>&nbsp;<span class="ident" id="7515990">err</span><span class="op" id="7515993">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7515997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7516000">}</span><br>
<span class="lineno"></span><span class="op" id="7516002">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7516005">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;DSA&nbsp;with&nbsp;SHA1</span><br>
<span class="lineno">560</span><span class="keyword" id="7516052">var</span>&nbsp;<span class="ident" id="7516056">dsaCertPem</span>&nbsp;<span class="op" id="7516067">=</span>&nbsp;<span class="string" id="7516069">`-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIIEDTCCA82gAwIBAgIJALHPghaoxeDhMAkGByqGSM44BAMweTELMAkGA1UEBhMC<br>
<span class="lineno"></span>VVMxCzAJBgNVBAgTAk5DMQ8wDQYDVQQHEwZOZXd0b24xFDASBgNVBAoTC0dvb2ds<br>
<span class="lineno"></span>ZSwgSW5jMRIwEAYDVQQDEwlKb24gQWxsaWUxIjAgBgkqhkiG9w0BCQEWE2pvbmFs<br>
<span class="lineno"></span>bGllQGdvb2dsZS5jb20wHhcNMTEwNTE0MDMwMTQ1WhcNMTEwNjEzMDMwMTQ1WjB5<br>
<span class="lineno">565</span>MQswCQYDVQQGEwJVUzELMAkGA1UECBMCTkMxDzANBgNVBAcTBk5ld3RvbjEUMBIG<br>
<span class="lineno"></span>A1UEChMLR29vZ2xlLCBJbmMxEjAQBgNVBAMTCUpvbiBBbGxpZTEiMCAGCSqGSIb3<br>
<span class="lineno"></span>DQEJARYTam9uYWxsaWVAZ29vZ2xlLmNvbTCCAbcwggEsBgcqhkjOOAQBMIIBHwKB<br>
<span class="lineno"></span>gQC8hLUnQ7FpFYu4WXTj6DKvXvz8QrJkNJCVMTpKAT7uBpobk32S5RrPKXocd4gN<br>
<span class="lineno"></span>8lyGB9ggS03EVlEwXvSmO0DH2MQtke2jl9j1HLydClMf4sbx5V6TV9IFw505U1iW<br>
<span class="lineno">570</span>jL7awRMgxge+FsudtJK254FjMFo03ZnOQ8ZJJ9E6AEDrlwIVAJpnBn9moyP11Ox5<br>
<span class="lineno"></span>Asc/5dnjb6dPAoGBAJFHd4KVv1iTVCvEG6gGiYop5DJh28hUQcN9kul+2A0yPUSC<br>
<span class="lineno"></span>X93oN00P8Vh3eYgSaCWZsha7zDG53MrVJ0Zf6v/X/CoZNhLldeNOepivTRAzn+Rz<br>
<span class="lineno"></span>kKUYy5l1sxYLHQKF0UGNCXfFKZT0PCmgU+PWhYNBBMn6/cIh44vp85ideo5CA4GE<br>
<span class="lineno"></span>AAKBgFmifCafzeRaohYKXJgMGSEaggCVCRq5xdyDCat+wbOkjC4mfG01/um3G8u5<br>
<span class="lineno">575</span>LxasjlWRKTR/tcAL7t0QuokVyQaYdVypZXNaMtx1db7YBuHjj3aP+8JOQRI9xz8c<br>
<span class="lineno"></span>bp5NDJ5pISiFOv4p3GZfqZPcqckDt78AtkQrmnal2txhhjF6o4HeMIHbMB0GA1Ud<br>
<span class="lineno"></span>DgQWBBQVyyr7hO11ZFFpWX50298Sa3V+rzCBqwYDVR0jBIGjMIGggBQVyyr7hO11<br>
<span class="lineno"></span>ZFFpWX50298Sa3V+r6F9pHsweTELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAk5DMQ8w<br>
<span class="lineno"></span>DQYDVQQHEwZOZXd0b24xFDASBgNVBAoTC0dvb2dsZSwgSW5jMRIwEAYDVQQDEwlK<br>
<span class="lineno">580</span>b24gQWxsaWUxIjAgBgkqhkiG9w0BCQEWE2pvbmFsbGllQGdvb2dsZS5jb22CCQCx<br>
<span class="lineno"></span>z4IWqMXg4TAMBgNVHRMEBTADAQH/MAkGByqGSM44BAMDLwAwLAIUPtn/5j8Q1jJI<br>
<span class="lineno"></span>7ggOIsgrhgUdjGQCFCsmDq1H11q9+9Wp9IMeGrTSKHIM<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">585</span><br>
<span class="lineno"></span><span class="keyword" id="7517537">func</span>&nbsp;<span class="ident" id="7517542">TestParseCertificateWithDsaPublicKey</span><span class="op" id="7517578">(</span><span class="ident" id="7517579">t</span>&nbsp;<span class="op" id="7517581">*</span><span class="ident" id="7517582">testing</span><span class="op" id="7517589">.</span><span class="ident" id="7517590">T</span><span class="op" id="7517591">)</span>&nbsp;<span class="op" id="7517593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7517596">expectedKey</span>&nbsp;<span class="op" id="7517608">:=</span>&nbsp;<span class="op" id="7517611">&amp;</span><span class="ident" id="7517612">dsa</span><span class="op" id="7517615">.</span><span class="ident" id="7517616">PublicKey</span><span class="op" id="7517625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7517629">Parameters</span><span class="op" id="7517639">:</span>&nbsp;<span class="ident" id="7517641">dsa</span><span class="op" id="7517644">.</span><span class="ident" id="7517645">Parameters</span><span class="op" id="7517655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7517660">P</span><span class="op" id="7517661">:</span>&nbsp;<span class="ident" id="7517663">bigFromHexString</span><span class="op" id="7517679">(</span><span class="string" id="7517680">&#34;00BC84B52743B169158BB85974E3E832AF5EFCFC42B264349095313A4A013EEE069A1B937D92E51ACF297A1C77880DF25C8607D8204B4DC45651305EF4A63B40C7D8C42D91EDA397D8F51CBC9D0A531FE2C6F1E55E9357D205C39D395358968CBEDAC11320C607BE16CB9DB492B6E78163305A34DD99CE43C64927D13A0040EB97&#34;</span><span class="op" id="7517940">)</span><span class="op" id="7517941">,</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7517946">Q</span><span class="op" id="7517947">:</span>&nbsp;<span class="ident" id="7517949">bigFromHexString</span><span class="op" id="7517965">(</span><span class="string" id="7517966">&#34;009A67067F66A323F5D4EC7902C73FE5D9E36FA74F&#34;</span><span class="op" id="7518010">)</span><span class="op" id="7518011">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7518016">G</span><span class="op" id="7518017">:</span>&nbsp;<span class="ident" id="7518019">bigFromHexString</span><span class="op" id="7518035">(</span><span class="string" id="7518036">&#34;009147778295BF5893542BC41BA806898A29E43261DBC85441C37D92E97ED80D323D44825FDDE8374D0FF15877798812682599B216BBCC31B9DCCAD527465FEAFFD7FC2A193612E575E34E7A98AF4D10339FE47390A518CB9975B3160B1D0285D1418D0977C52994F43C29A053E3D685834104C9FAFDC221E38BE9F3989D7A8E42&#34;</span><span class="op" id="7518296">)</span><span class="op" id="7518297">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7518301">}</span><span class="op" id="7518302">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7518306">Y</span><span class="op" id="7518307">:</span>&nbsp;<span class="ident" id="7518309">bigFromHexString</span><span class="op" id="7518325">(</span><span class="string" id="7518326">&#34;59A27C269FCDE45AA2160A5C980C19211A820095091AB9C5DC8309AB7EC1B3A48C2E267C6D35FEE9B71BCBB92F16AC8E559129347FB5C00BEEDD10BA8915C90698755CA965735A32DC7575BED806E1E38F768FFBC24E41123DC73F1C6E9E4D0C9E692128853AFE29DC665FA993DCA9C903B7BF00B6442B9A76A5DADC6186317A&#34;</span><span class="op" id="7518584">)</span><span class="op" id="7518585">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7518588">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7518591">pemBlock</span><span class="op" id="7518599">,</span>&nbsp;<span class="ident" id="7518601">_</span>&nbsp;<span class="op" id="7518603">:=</span>&nbsp;<span class="ident" id="7518606">pem</span><span class="op" id="7518609">.</span><span class="ident" id="7518610">Decode</span><span class="op" id="7518616">(</span><span class="op" id="7518617">[</span><span class="op" id="7518618">]</span><span class="builtintype" id="7518619">byte</span><span class="op" id="7518623">(</span><span class="ident" id="7518624">dsaCertPem</span><span class="op" id="7518634">)</span><span class="op" id="7518635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7518638">cert</span><span class="op" id="7518642">,</span>&nbsp;<span class="ident" id="7518644">err</span>&nbsp;<span class="op" id="7518648">:=</span>&nbsp;<span class="ident" id="7518651">ParseCertificate</span><span class="op" id="7518667">(</span><span class="ident" id="7518668">pemBlock</span><span class="op" id="7518676">.</span><span class="ident" id="7518677">Bytes</span><span class="op" id="7518682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7518685">if</span>&nbsp;<span class="ident" id="7518688">err</span>&nbsp;<span class="op" id="7518692">!=</span>&nbsp;<span class="builtintype" id="7518695">nil</span>&nbsp;<span class="op" id="7518699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7518703">t</span><span class="op" id="7518704">.</span><span class="ident" id="7518705">Fatalf</span><span class="op" id="7518711">(</span><span class="string" id="7518712">&#34;Failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7518745">,</span>&nbsp;<span class="ident" id="7518747">err</span><span class="op" id="7518750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7518753">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7518756">if</span>&nbsp;<span class="ident" id="7518759">cert</span><span class="op" id="7518763">.</span><span class="ident" id="7518764">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="7518783">!=</span>&nbsp;<span class="ident" id="7518786">DSA</span>&nbsp;<span class="op" id="7518790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7518794">t</span><span class="op" id="7518795">.</span><span class="ident" id="7518796">Errorf</span><span class="op" id="7518802">(</span><span class="string" id="7518803">&#34;Parsed&nbsp;key&nbsp;algorithm&nbsp;was&nbsp;not&nbsp;DSA&#34;</span><span class="op" id="7518837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7518840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7518843">parsedKey</span><span class="op" id="7518852">,</span>&nbsp;<span class="ident" id="7518854">ok</span>&nbsp;<span class="op" id="7518857">:=</span>&nbsp;<span class="ident" id="7518860">cert</span><span class="op" id="7518864">.</span><span class="ident" id="7518865">PublicKey</span><span class="op" id="7518874">.</span><span class="op" id="7518875">(</span><span class="op" id="7518876">*</span><span class="ident" id="7518877">dsa</span><span class="op" id="7518880">.</span><span class="ident" id="7518881">PublicKey</span><span class="op" id="7518890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7518893">if</span>&nbsp;<span class="op" id="7518896">!</span><span class="ident" id="7518897">ok</span>&nbsp;<span class="op" id="7518900">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7518904">t</span><span class="op" id="7518905">.</span><span class="ident" id="7518906">Fatalf</span><span class="op" id="7518912">(</span><span class="string" id="7518913">&#34;Parsed&nbsp;key&nbsp;was&nbsp;not&nbsp;a&nbsp;DSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7518947">,</span>&nbsp;<span class="ident" id="7518949">err</span><span class="op" id="7518952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7518955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7518958">if</span>&nbsp;<span class="ident" id="7518961">expectedKey</span><span class="op" id="7518972">.</span><span class="ident" id="7518973">Y</span><span class="op" id="7518974">.</span><span class="ident" id="7518975">Cmp</span><span class="op" id="7518978">(</span><span class="ident" id="7518979">parsedKey</span><span class="op" id="7518988">.</span><span class="ident" id="7518989">Y</span><span class="op" id="7518990">)</span>&nbsp;<span class="op" id="7518992">!=</span>&nbsp;<span class="num" id="7518995">0</span>&nbsp;<span class="op" id="7518997">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7519002">expectedKey</span><span class="op" id="7519013">.</span><span class="ident" id="7519014">P</span><span class="op" id="7519015">.</span><span class="ident" id="7519016">Cmp</span><span class="op" id="7519019">(</span><span class="ident" id="7519020">parsedKey</span><span class="op" id="7519029">.</span><span class="ident" id="7519030">P</span><span class="op" id="7519031">)</span>&nbsp;<span class="op" id="7519033">!=</span>&nbsp;<span class="num" id="7519036">0</span>&nbsp;<span class="op" id="7519038">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7519043">expectedKey</span><span class="op" id="7519054">.</span><span class="ident" id="7519055">Q</span><span class="op" id="7519056">.</span><span class="ident" id="7519057">Cmp</span><span class="op" id="7519060">(</span><span class="ident" id="7519061">parsedKey</span><span class="op" id="7519070">.</span><span class="ident" id="7519071">Q</span><span class="op" id="7519072">)</span>&nbsp;<span class="op" id="7519074">!=</span>&nbsp;<span class="num" id="7519077">0</span>&nbsp;<span class="op" id="7519079">||</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7519084">expectedKey</span><span class="op" id="7519095">.</span><span class="ident" id="7519096">G</span><span class="op" id="7519097">.</span><span class="ident" id="7519098">Cmp</span><span class="op" id="7519101">(</span><span class="ident" id="7519102">parsedKey</span><span class="op" id="7519111">.</span><span class="ident" id="7519112">G</span><span class="op" id="7519113">)</span>&nbsp;<span class="op" id="7519115">!=</span>&nbsp;<span class="num" id="7519118">0</span>&nbsp;<span class="op" id="7519120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7519124">t</span><span class="op" id="7519125">.</span><span class="ident" id="7519126">Fatal</span><span class="op" id="7519131">(</span><span class="string" id="7519132">&#34;Parsed&nbsp;key&nbsp;differs&nbsp;from&nbsp;expected&nbsp;key&#34;</span><span class="op" id="7519170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7519173">}</span><br>
<span class="lineno"></span><span class="op" id="7519175">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span><span class="keyword" id="7519178">func</span>&nbsp;<span class="ident" id="7519183">TestParseCertificateWithDSASignatureAlgorithm</span><span class="op" id="7519228">(</span><span class="ident" id="7519229">t</span>&nbsp;<span class="op" id="7519231">*</span><span class="ident" id="7519232">testing</span><span class="op" id="7519239">.</span><span class="ident" id="7519240">T</span><span class="op" id="7519241">)</span>&nbsp;<span class="op" id="7519243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7519246">pemBlock</span><span class="op" id="7519254">,</span>&nbsp;<span class="ident" id="7519256">_</span>&nbsp;<span class="op" id="7519258">:=</span>&nbsp;<span class="ident" id="7519261">pem</span><span class="op" id="7519264">.</span><span class="ident" id="7519265">Decode</span><span class="op" id="7519271">(</span><span class="op" id="7519272">[</span><span class="op" id="7519273">]</span><span class="builtintype" id="7519274">byte</span><span class="op" id="7519278">(</span><span class="ident" id="7519279">dsaCertPem</span><span class="op" id="7519289">)</span><span class="op" id="7519290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7519293">cert</span><span class="op" id="7519297">,</span>&nbsp;<span class="ident" id="7519299">err</span>&nbsp;<span class="op" id="7519303">:=</span>&nbsp;<span class="ident" id="7519306">ParseCertificate</span><span class="op" id="7519322">(</span><span class="ident" id="7519323">pemBlock</span><span class="op" id="7519331">.</span><span class="ident" id="7519332">Bytes</span><span class="op" id="7519337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7519340">if</span>&nbsp;<span class="ident" id="7519343">err</span>&nbsp;<span class="op" id="7519347">!=</span>&nbsp;<span class="builtintype" id="7519350">nil</span>&nbsp;<span class="op" id="7519354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7519358">t</span><span class="op" id="7519359">.</span><span class="ident" id="7519360">Fatalf</span><span class="op" id="7519366">(</span><span class="string" id="7519367">&#34;Failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7519400">,</span>&nbsp;<span class="ident" id="7519402">err</span><span class="op" id="7519405">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7519408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7519411">if</span>&nbsp;<span class="ident" id="7519414">cert</span><span class="op" id="7519418">.</span><span class="ident" id="7519419">SignatureAlgorithm</span>&nbsp;<span class="op" id="7519438">!=</span>&nbsp;<span class="ident" id="7519441">DSAWithSHA1</span>&nbsp;<span class="op" id="7519453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7519457">t</span><span class="op" id="7519458">.</span><span class="ident" id="7519459">Errorf</span><span class="op" id="7519465">(</span><span class="string" id="7519466">&#34;Parsed&nbsp;signature&nbsp;algorithm&nbsp;was&nbsp;not&nbsp;DSAWithSHA1&#34;</span><span class="op" id="7519514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7519517">}</span><br>
<span class="lineno"></span><span class="op" id="7519519">}</span><br>
<span class="lineno">625</span><br>
<span class="lineno"></span><span class="keyword" id="7519522">func</span>&nbsp;<span class="ident" id="7519527">TestVerifyCertificateWithDSASignature</span><span class="op" id="7519564">(</span><span class="ident" id="7519565">t</span>&nbsp;<span class="op" id="7519567">*</span><span class="ident" id="7519568">testing</span><span class="op" id="7519575">.</span><span class="ident" id="7519576">T</span><span class="op" id="7519577">)</span>&nbsp;<span class="op" id="7519579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7519582">pemBlock</span><span class="op" id="7519590">,</span>&nbsp;<span class="ident" id="7519592">_</span>&nbsp;<span class="op" id="7519594">:=</span>&nbsp;<span class="ident" id="7519597">pem</span><span class="op" id="7519600">.</span><span class="ident" id="7519601">Decode</span><span class="op" id="7519607">(</span><span class="op" id="7519608">[</span><span class="op" id="7519609">]</span><span class="builtintype" id="7519610">byte</span><span class="op" id="7519614">(</span><span class="ident" id="7519615">dsaCertPem</span><span class="op" id="7519625">)</span><span class="op" id="7519626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7519629">cert</span><span class="op" id="7519633">,</span>&nbsp;<span class="ident" id="7519635">err</span>&nbsp;<span class="op" id="7519639">:=</span>&nbsp;<span class="ident" id="7519642">ParseCertificate</span><span class="op" id="7519658">(</span><span class="ident" id="7519659">pemBlock</span><span class="op" id="7519667">.</span><span class="ident" id="7519668">Bytes</span><span class="op" id="7519673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7519676">if</span>&nbsp;<span class="ident" id="7519679">err</span>&nbsp;<span class="op" id="7519683">!=</span>&nbsp;<span class="builtintype" id="7519686">nil</span>&nbsp;<span class="op" id="7519690">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7519694">t</span><span class="op" id="7519695">.</span><span class="ident" id="7519696">Fatalf</span><span class="op" id="7519702">(</span><span class="string" id="7519703">&#34;Failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7519736">,</span>&nbsp;<span class="ident" id="7519738">err</span><span class="op" id="7519741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7519744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7519747">//&nbsp;test&nbsp;cert&nbsp;is&nbsp;self-signed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7519776">if</span>&nbsp;<span class="ident" id="7519779">err</span>&nbsp;<span class="op" id="7519783">=</span>&nbsp;<span class="ident" id="7519785">cert</span><span class="op" id="7519789">.</span><span class="ident" id="7519790">CheckSignatureFrom</span><span class="op" id="7519808">(</span><span class="ident" id="7519809">cert</span><span class="op" id="7519813">)</span><span class="op" id="7519814">;</span>&nbsp;<span class="ident" id="7519816">err</span>&nbsp;<span class="op" id="7519820">!=</span>&nbsp;<span class="builtintype" id="7519823">nil</span>&nbsp;<span class="op" id="7519827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7519831">t</span><span class="op" id="7519832">.</span><span class="ident" id="7519833">Fatalf</span><span class="op" id="7519839">(</span><span class="string" id="7519840">&#34;DSA&nbsp;Certificate&nbsp;verification&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="7519881">,</span>&nbsp;<span class="ident" id="7519883">err</span><span class="op" id="7519886">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7519889">}</span><br>
<span class="lineno"></span><span class="op" id="7519891">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7519894">const</span>&nbsp;<span class="ident" id="7519900">pemCertificate</span>&nbsp;<span class="op" id="7519915">=</span>&nbsp;<span class="string" id="7519917">`-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIIB5DCCAZCgAwIBAgIBATALBgkqhkiG9w0BAQUwLTEQMA4GA1UEChMHQWNtZSBDbzEZMBcGA1UE<br>
<span class="lineno">640</span>AxMQdGVzdC5leGFtcGxlLmNvbTAeFw03MDAxMDEwMDE2NDBaFw03MDAxMDIwMzQ2NDBaMC0xEDAO<br>
<span class="lineno"></span>BgNVBAoTB0FjbWUgQ28xGTAXBgNVBAMTEHRlc3QuZXhhbXBsZS5jb20wWjALBgkqhkiG9w0BAQED<br>
<span class="lineno"></span>SwAwSAJBALKZD0nEffqM1ACuak0bijtqE2QrI/KLADv7l3kK3ppMyCuLKoF0fd7Ai2KW5ToIwzFo<br>
<span class="lineno"></span>fvJcS/STa6HA5gQenRUCAwEAAaOBnjCBmzAOBgNVHQ8BAf8EBAMCAAQwDwYDVR0TAQH/BAUwAwEB<br>
<span class="lineno"></span>/zANBgNVHQ4EBgQEAQIDBDAPBgNVHSMECDAGgAQBAgMEMBsGA1UdEQQUMBKCEHRlc3QuZXhhbXBs<br>
<span class="lineno">645</span>ZS5jb20wDwYDVR0gBAgwBjAEBgIqAzAqBgNVHR4EIzAhoB8wDoIMLmV4YW1wbGUuY29tMA2CC2V4<br>
<span class="lineno"></span>YW1wbGUuY29tMAsGCSqGSIb3DQEBBQNBAHKZKoS1wEQOGhgklx4+/yFYQlnqwKXvar/ZecQvJwui<br>
<span class="lineno"></span>0seMQnwBhwdBkHfVIU2Fu5VUMRyxlf0ZNaDXcpU581k=<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----`</span><br>
<span class="lineno"></span><br>
<span class="lineno">650</span><span class="keyword" id="7520635">func</span>&nbsp;<span class="ident" id="7520640">TestCRLCreation</span><span class="op" id="7520655">(</span><span class="ident" id="7520656">t</span>&nbsp;<span class="op" id="7520658">*</span><span class="ident" id="7520659">testing</span><span class="op" id="7520666">.</span><span class="ident" id="7520667">T</span><span class="op" id="7520668">)</span>&nbsp;<span class="op" id="7520670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7520673">block</span><span class="op" id="7520678">,</span>&nbsp;<span class="ident" id="7520680">_</span>&nbsp;<span class="op" id="7520682">:=</span>&nbsp;<span class="ident" id="7520685">pem</span><span class="op" id="7520688">.</span><span class="ident" id="7520689">Decode</span><span class="op" id="7520695">(</span><span class="op" id="7520696">[</span><span class="op" id="7520697">]</span><span class="builtintype" id="7520698">byte</span><span class="op" id="7520702">(</span><span class="ident" id="7520703">pemPrivateKey</span><span class="op" id="7520716">)</span><span class="op" id="7520717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7520720">priv</span><span class="op" id="7520724">,</span>&nbsp;<span class="ident" id="7520726">_</span>&nbsp;<span class="op" id="7520728">:=</span>&nbsp;<span class="ident" id="7520731">ParsePKCS1PrivateKey</span><span class="op" id="7520751">(</span><span class="ident" id="7520752">block</span><span class="op" id="7520757">.</span><span class="ident" id="7520758">Bytes</span><span class="op" id="7520763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7520766">block</span><span class="op" id="7520771">,</span>&nbsp;<span class="ident" id="7520773">_</span>&nbsp;<span class="op" id="7520775">=</span>&nbsp;<span class="ident" id="7520777">pem</span><span class="op" id="7520780">.</span><span class="ident" id="7520781">Decode</span><span class="op" id="7520787">(</span><span class="op" id="7520788">[</span><span class="op" id="7520789">]</span><span class="builtintype" id="7520790">byte</span><span class="op" id="7520794">(</span><span class="ident" id="7520795">pemCertificate</span><span class="op" id="7520809">)</span><span class="op" id="7520810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7520813">cert</span><span class="op" id="7520817">,</span>&nbsp;<span class="ident" id="7520819">_</span>&nbsp;<span class="op" id="7520821">:=</span>&nbsp;<span class="ident" id="7520824">ParseCertificate</span><span class="op" id="7520840">(</span><span class="ident" id="7520841">block</span><span class="op" id="7520846">.</span><span class="ident" id="7520847">Bytes</span><span class="op" id="7520852">)</span><br>
<span class="lineno">655</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7520856">now</span>&nbsp;<span class="op" id="7520860">:=</span>&nbsp;<span class="ident" id="7520863">time</span><span class="op" id="7520867">.</span><span class="ident" id="7520868">Unix</span><span class="op" id="7520872">(</span><span class="num" id="7520873">1000</span><span class="op" id="7520877">,</span>&nbsp;<span class="num" id="7520879">0</span><span class="op" id="7520880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7520883">expiry</span>&nbsp;<span class="op" id="7520890">:=</span>&nbsp;<span class="ident" id="7520893">time</span><span class="op" id="7520897">.</span><span class="ident" id="7520898">Unix</span><span class="op" id="7520902">(</span><span class="num" id="7520903">10000</span><span class="op" id="7520908">,</span>&nbsp;<span class="num" id="7520910">0</span><span class="op" id="7520911">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7520915">revokedCerts</span>&nbsp;<span class="op" id="7520928">:=</span>&nbsp;<span class="op" id="7520931">[</span><span class="op" id="7520932">]</span><span class="ident" id="7520933">pkix</span><span class="op" id="7520937">.</span><span class="ident" id="7520938">RevokedCertificate</span><span class="op" id="7520956">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7520960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7520965">SerialNumber</span><span class="op" id="7520977">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7520981">big</span><span class="op" id="7520984">.</span><span class="ident" id="7520985">NewInt</span><span class="op" id="7520991">(</span><span class="num" id="7520992">1</span><span class="op" id="7520993">)</span><span class="op" id="7520994">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7520999">RevocationTime</span><span class="op" id="7521013">:</span>&nbsp;<span class="ident" id="7521015">now</span><span class="op" id="7521018">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7521022">}</span><span class="op" id="7521023">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7521027">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7521032">SerialNumber</span><span class="op" id="7521044">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7521048">big</span><span class="op" id="7521051">.</span><span class="ident" id="7521052">NewInt</span><span class="op" id="7521058">(</span><span class="num" id="7521059">42</span><span class="op" id="7521061">)</span><span class="op" id="7521062">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7521067">RevocationTime</span><span class="op" id="7521081">:</span>&nbsp;<span class="ident" id="7521083">now</span><span class="op" id="7521086">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7521090">}</span><span class="op" id="7521091">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7521094">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7521098">crlBytes</span><span class="op" id="7521106">,</span>&nbsp;<span class="ident" id="7521108">err</span>&nbsp;<span class="op" id="7521112">:=</span>&nbsp;<span class="ident" id="7521115">cert</span><span class="op" id="7521119">.</span><span class="ident" id="7521120">CreateCRL</span><span class="op" id="7521129">(</span><span class="ident" id="7521130">rand</span><span class="op" id="7521134">.</span><span class="ident" id="7521135">Reader</span><span class="op" id="7521141">,</span>&nbsp;<span class="ident" id="7521143">priv</span><span class="op" id="7521147">,</span>&nbsp;<span class="ident" id="7521149">revokedCerts</span><span class="op" id="7521161">,</span>&nbsp;<span class="ident" id="7521163">now</span><span class="op" id="7521166">,</span>&nbsp;<span class="ident" id="7521168">expiry</span><span class="op" id="7521174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7521177">if</span>&nbsp;<span class="ident" id="7521180">err</span>&nbsp;<span class="op" id="7521184">!=</span>&nbsp;<span class="builtintype" id="7521187">nil</span>&nbsp;<span class="op" id="7521191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7521195">t</span><span class="op" id="7521196">.</span><span class="ident" id="7521197">Errorf</span><span class="op" id="7521203">(</span><span class="string" id="7521204">&#34;error&nbsp;creating&nbsp;CRL:&nbsp;%s&#34;</span><span class="op" id="7521228">,</span>&nbsp;<span class="ident" id="7521230">err</span><span class="op" id="7521233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7521236">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7521240">_</span><span class="op" id="7521241">,</span>&nbsp;<span class="ident" id="7521243">err</span>&nbsp;<span class="op" id="7521247">=</span>&nbsp;<span class="ident" id="7521249">ParseDERCRL</span><span class="op" id="7521260">(</span><span class="ident" id="7521261">crlBytes</span><span class="op" id="7521269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7521272">if</span>&nbsp;<span class="ident" id="7521275">err</span>&nbsp;<span class="op" id="7521279">!=</span>&nbsp;<span class="builtintype" id="7521282">nil</span>&nbsp;<span class="op" id="7521286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7521290">t</span><span class="op" id="7521291">.</span><span class="ident" id="7521292">Errorf</span><span class="op" id="7521298">(</span><span class="string" id="7521299">&#34;error&nbsp;reparsing&nbsp;CRL:&nbsp;%s&#34;</span><span class="op" id="7521324">,</span>&nbsp;<span class="ident" id="7521326">err</span><span class="op" id="7521329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7521332">}</span><br>
<span class="lineno"></span><span class="op" id="7521334">}</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="7521337">func</span>&nbsp;<span class="ident" id="7521342">fromBase64</span><span class="op" id="7521352">(</span><span class="ident" id="7521353">in</span>&nbsp;<span class="builtintype" id="7521356">string</span><span class="op" id="7521362">)</span>&nbsp;<span class="op" id="7521364">[</span><span class="op" id="7521365">]</span><span class="builtintype" id="7521366">byte</span>&nbsp;<span class="op" id="7521371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7521374">out</span>&nbsp;<span class="op" id="7521378">:=</span>&nbsp;<span class="builtinfunc" id="7521381">make</span><span class="op" id="7521385">(</span><span class="op" id="7521386">[</span><span class="op" id="7521387">]</span><span class="builtintype" id="7521388">byte</span><span class="op" id="7521392">,</span>&nbsp;<span class="ident" id="7521394">base64</span><span class="op" id="7521400">.</span><span class="ident" id="7521401">StdEncoding</span><span class="op" id="7521412">.</span><span class="ident" id="7521413">DecodedLen</span><span class="op" id="7521423">(</span><span class="builtinfunc" id="7521424">len</span><span class="op" id="7521427">(</span><span class="ident" id="7521428">in</span><span class="op" id="7521430">)</span><span class="op" id="7521431">)</span><span class="op" id="7521432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7521435">n</span><span class="op" id="7521436">,</span>&nbsp;<span class="ident" id="7521438">err</span>&nbsp;<span class="op" id="7521442">:=</span>&nbsp;<span class="ident" id="7521445">base64</span><span class="op" id="7521451">.</span><span class="ident" id="7521452">StdEncoding</span><span class="op" id="7521463">.</span><span class="ident" id="7521464">Decode</span><span class="op" id="7521470">(</span><span class="ident" id="7521471">out</span><span class="op" id="7521474">,</span>&nbsp;<span class="op" id="7521476">[</span><span class="op" id="7521477">]</span><span class="builtintype" id="7521478">byte</span><span class="op" id="7521482">(</span><span class="ident" id="7521483">in</span><span class="op" id="7521485">)</span><span class="op" id="7521486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7521489">if</span>&nbsp;<span class="ident" id="7521492">err</span>&nbsp;<span class="op" id="7521496">!=</span>&nbsp;<span class="builtintype" id="7521499">nil</span>&nbsp;<span class="op" id="7521503">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7521507">panic</span><span class="op" id="7521512">(</span><span class="string" id="7521513">&#34;failed&nbsp;to&nbsp;base64&nbsp;decode&#34;</span><span class="op" id="7521538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7521541">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7521544">return</span>&nbsp;<span class="ident" id="7521551">out</span><span class="op" id="7521554">[</span><span class="op" id="7521555">:</span><span class="ident" id="7521556">n</span><span class="op" id="7521557">]</span><br>
<span class="lineno"></span><span class="op" id="7521559">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">690</span><span class="keyword" id="7521562">func</span>&nbsp;<span class="ident" id="7521567">TestParseDERCRL</span><span class="op" id="7521582">(</span><span class="ident" id="7521583">t</span>&nbsp;<span class="op" id="7521585">*</span><span class="ident" id="7521586">testing</span><span class="op" id="7521593">.</span><span class="ident" id="7521594">T</span><span class="op" id="7521595">)</span>&nbsp;<span class="op" id="7521597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7521600">derBytes</span>&nbsp;<span class="op" id="7521609">:=</span>&nbsp;<span class="ident" id="7521612">fromBase64</span><span class="op" id="7521622">(</span><span class="ident" id="7521623">derCRLBase64</span><span class="op" id="7521635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7521638">certList</span><span class="op" id="7521646">,</span>&nbsp;<span class="ident" id="7521648">err</span>&nbsp;<span class="op" id="7521652">:=</span>&nbsp;<span class="ident" id="7521655">ParseDERCRL</span><span class="op" id="7521666">(</span><span class="ident" id="7521667">derBytes</span><span class="op" id="7521675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7521678">if</span>&nbsp;<span class="ident" id="7521681">err</span>&nbsp;<span class="op" id="7521685">!=</span>&nbsp;<span class="builtintype" id="7521688">nil</span>&nbsp;<span class="op" id="7521692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7521696">t</span><span class="op" id="7521697">.</span><span class="ident" id="7521698">Errorf</span><span class="op" id="7521704">(</span><span class="string" id="7521705">&#34;error&nbsp;parsing:&nbsp;%s&#34;</span><span class="op" id="7521724">,</span>&nbsp;<span class="ident" id="7521726">err</span><span class="op" id="7521729">)</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7521733">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7521741">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7521744">numCerts</span>&nbsp;<span class="op" id="7521753">:=</span>&nbsp;<span class="builtinfunc" id="7521756">len</span><span class="op" id="7521759">(</span><span class="ident" id="7521760">certList</span><span class="op" id="7521768">.</span><span class="ident" id="7521769">TBSCertList</span><span class="op" id="7521780">.</span><span class="ident" id="7521781">RevokedCertificates</span><span class="op" id="7521800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7521803">expected</span>&nbsp;<span class="op" id="7521812">:=</span>&nbsp;<span class="num" id="7521815">88</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7521819">if</span>&nbsp;<span class="ident" id="7521822">numCerts</span>&nbsp;<span class="op" id="7521831">!=</span>&nbsp;<span class="ident" id="7521834">expected</span>&nbsp;<span class="op" id="7521843">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7521847">t</span><span class="op" id="7521848">.</span><span class="ident" id="7521849">Errorf</span><span class="op" id="7521855">(</span><span class="string" id="7521856">&#34;bad&nbsp;number&nbsp;of&nbsp;revoked&nbsp;certificates.&nbsp;got:&nbsp;%d&nbsp;want:&nbsp;%d&#34;</span><span class="op" id="7521910">,</span>&nbsp;<span class="ident" id="7521912">numCerts</span><span class="op" id="7521920">,</span>&nbsp;<span class="ident" id="7521922">expected</span><span class="op" id="7521930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7521933">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7521937">if</span>&nbsp;<span class="ident" id="7521940">certList</span><span class="op" id="7521948">.</span><span class="ident" id="7521949">HasExpired</span><span class="op" id="7521959">(</span><span class="ident" id="7521960">time</span><span class="op" id="7521964">.</span><span class="ident" id="7521965">Unix</span><span class="op" id="7521969">(</span><span class="num" id="7521970">1302517272</span><span class="op" id="7521980">,</span>&nbsp;<span class="num" id="7521982">0</span><span class="op" id="7521983">)</span><span class="op" id="7521984">)</span>&nbsp;<span class="op" id="7521986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7521990">t</span><span class="op" id="7521991">.</span><span class="ident" id="7521992">Errorf</span><span class="op" id="7521998">(</span><span class="string" id="7521999">&#34;CRL&nbsp;has&nbsp;expired&nbsp;(but&nbsp;shouldn&#39;t&nbsp;have)&#34;</span><span class="op" id="7522037">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7522040">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7522044">//&nbsp;Can&#39;t&nbsp;check&nbsp;the&nbsp;signature&nbsp;here&nbsp;without&nbsp;a&nbsp;package&nbsp;cycle.</span><br>
<span class="lineno"></span><span class="op" id="7522103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">710</span><span class="keyword" id="7522106">func</span>&nbsp;<span class="ident" id="7522111">TestCRLWithoutExpiry</span><span class="op" id="7522131">(</span><span class="ident" id="7522132">t</span>&nbsp;<span class="op" id="7522134">*</span><span class="ident" id="7522135">testing</span><span class="op" id="7522142">.</span><span class="ident" id="7522143">T</span><span class="op" id="7522144">)</span>&nbsp;<span class="op" id="7522146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7522149">derBytes</span>&nbsp;<span class="op" id="7522158">:=</span>&nbsp;<span class="ident" id="7522161">fromBase64</span><span class="op" id="7522171">(</span><span class="string" id="7522172">&#34;MIHYMIGZMAkGByqGSM44BAMwEjEQMA4GA1UEAxMHQ2FybERTUxcNOTkwODI3MDcwMDAwWjBpMBMCAgDIFw05OTA4MjIwNzAwMDBaMBMCAgDJFw05OTA4MjIwNzAwMDBaMBMCAgDTFw05OTA4MjIwNzAwMDBaMBMCAgDSFw05OTA4MjIwNzAwMDBaMBMCAgDUFw05OTA4MjQwNzAwMDBaMAkGByqGSM44BAMDLwAwLAIUfmVSdjP+NHMX0feW+aDU2G1cfT0CFAJ6W7fVWxjBz4fvftok8yqDnDWh&#34;</span><span class="op" id="7522466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7522469">certList</span><span class="op" id="7522477">,</span>&nbsp;<span class="ident" id="7522479">err</span>&nbsp;<span class="op" id="7522483">:=</span>&nbsp;<span class="ident" id="7522486">ParseDERCRL</span><span class="op" id="7522497">(</span><span class="ident" id="7522498">derBytes</span><span class="op" id="7522506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7522509">if</span>&nbsp;<span class="ident" id="7522512">err</span>&nbsp;<span class="op" id="7522516">!=</span>&nbsp;<span class="builtintype" id="7522519">nil</span>&nbsp;<span class="op" id="7522523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7522527">t</span><span class="op" id="7522528">.</span><span class="ident" id="7522529">Fatal</span><span class="op" id="7522534">(</span><span class="ident" id="7522535">err</span><span class="op" id="7522538">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7522541">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7522544">if</span>&nbsp;<span class="op" id="7522547">!</span><span class="ident" id="7522548">certList</span><span class="op" id="7522556">.</span><span class="ident" id="7522557">TBSCertList</span><span class="op" id="7522568">.</span><span class="ident" id="7522569">NextUpdate</span><span class="op" id="7522579">.</span><span class="ident" id="7522580">IsZero</span><span class="op" id="7522586">(</span><span class="op" id="7522587">)</span>&nbsp;<span class="op" id="7522589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7522593">t</span><span class="op" id="7522594">.</span><span class="ident" id="7522595">Errorf</span><span class="op" id="7522601">(</span><span class="string" id="7522602">&#34;NextUpdate&nbsp;is&nbsp;not&nbsp;the&nbsp;zero&nbsp;value&#34;</span><span class="op" id="7522636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7522639">}</span><br>
<span class="lineno"></span><span class="op" id="7522641">}</span><br>
<span class="lineno">720</span><br>
<span class="lineno"></span><span class="keyword" id="7522644">func</span>&nbsp;<span class="ident" id="7522649">TestParsePEMCRL</span><span class="op" id="7522664">(</span><span class="ident" id="7522665">t</span>&nbsp;<span class="op" id="7522667">*</span><span class="ident" id="7522668">testing</span><span class="op" id="7522675">.</span><span class="ident" id="7522676">T</span><span class="op" id="7522677">)</span>&nbsp;<span class="op" id="7522679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7522682">pemBytes</span>&nbsp;<span class="op" id="7522691">:=</span>&nbsp;<span class="ident" id="7522694">fromBase64</span><span class="op" id="7522704">(</span><span class="ident" id="7522705">pemCRLBase64</span><span class="op" id="7522717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7522720">certList</span><span class="op" id="7522728">,</span>&nbsp;<span class="ident" id="7522730">err</span>&nbsp;<span class="op" id="7522734">:=</span>&nbsp;<span class="ident" id="7522737">ParseCRL</span><span class="op" id="7522745">(</span><span class="ident" id="7522746">pemBytes</span><span class="op" id="7522754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7522757">if</span>&nbsp;<span class="ident" id="7522760">err</span>&nbsp;<span class="op" id="7522764">!=</span>&nbsp;<span class="builtintype" id="7522767">nil</span>&nbsp;<span class="op" id="7522771">{</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7522775">t</span><span class="op" id="7522776">.</span><span class="ident" id="7522777">Errorf</span><span class="op" id="7522783">(</span><span class="string" id="7522784">&#34;error&nbsp;parsing:&nbsp;%s&#34;</span><span class="op" id="7522803">,</span>&nbsp;<span class="ident" id="7522805">err</span><span class="op" id="7522808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7522812">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7522820">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7522823">numCerts</span>&nbsp;<span class="op" id="7522832">:=</span>&nbsp;<span class="builtinfunc" id="7522835">len</span><span class="op" id="7522838">(</span><span class="ident" id="7522839">certList</span><span class="op" id="7522847">.</span><span class="ident" id="7522848">TBSCertList</span><span class="op" id="7522859">.</span><span class="ident" id="7522860">RevokedCertificates</span><span class="op" id="7522879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7522882">expected</span>&nbsp;<span class="op" id="7522891">:=</span>&nbsp;<span class="num" id="7522894">2</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7522897">if</span>&nbsp;<span class="ident" id="7522900">numCerts</span>&nbsp;<span class="op" id="7522909">!=</span>&nbsp;<span class="ident" id="7522912">expected</span>&nbsp;<span class="op" id="7522921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7522925">t</span><span class="op" id="7522926">.</span><span class="ident" id="7522927">Errorf</span><span class="op" id="7522933">(</span><span class="string" id="7522934">&#34;bad&nbsp;number&nbsp;of&nbsp;revoked&nbsp;certificates.&nbsp;got:&nbsp;%d&nbsp;want:&nbsp;%d&#34;</span><span class="op" id="7522988">,</span>&nbsp;<span class="ident" id="7522990">numCerts</span><span class="op" id="7522998">,</span>&nbsp;<span class="ident" id="7523000">expected</span><span class="op" id="7523008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7523011">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7523015">if</span>&nbsp;<span class="ident" id="7523018">certList</span><span class="op" id="7523026">.</span><span class="ident" id="7523027">HasExpired</span><span class="op" id="7523037">(</span><span class="ident" id="7523038">time</span><span class="op" id="7523042">.</span><span class="ident" id="7523043">Unix</span><span class="op" id="7523047">(</span><span class="num" id="7523048">1302517272</span><span class="op" id="7523058">,</span>&nbsp;<span class="num" id="7523060">0</span><span class="op" id="7523061">)</span><span class="op" id="7523062">)</span>&nbsp;<span class="op" id="7523064">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7523068">t</span><span class="op" id="7523069">.</span><span class="ident" id="7523070">Errorf</span><span class="op" id="7523076">(</span><span class="string" id="7523077">&#34;CRL&nbsp;has&nbsp;expired&nbsp;(but&nbsp;shouldn&#39;t&nbsp;have)&#34;</span><span class="op" id="7523115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7523118">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7523122">//&nbsp;Can&#39;t&nbsp;check&nbsp;the&nbsp;signature&nbsp;here&nbsp;without&nbsp;a&nbsp;package&nbsp;cycle.</span><br>
<span class="lineno"></span><span class="op" id="7523181">}</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span><span class="keyword" id="7523184">func</span>&nbsp;<span class="ident" id="7523189">TestImports</span><span class="op" id="7523200">(</span><span class="ident" id="7523201">t</span>&nbsp;<span class="op" id="7523203">*</span><span class="ident" id="7523204">testing</span><span class="op" id="7523211">.</span><span class="ident" id="7523212">T</span><span class="op" id="7523213">)</span>&nbsp;<span class="op" id="7523215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7523218">switch</span>&nbsp;<span class="ident" id="7523225">runtime</span><span class="op" id="7523232">.</span><span class="ident" id="7523233">GOOS</span>&nbsp;<span class="op" id="7523238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7523241">case</span>&nbsp;<span class="string" id="7523246">&#34;android&#34;</span><span class="op" id="7523255">,</span>&nbsp;<span class="string" id="7523257">&#34;nacl&#34;</span><span class="op" id="7523263">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7523267">t</span><span class="op" id="7523268">.</span><span class="ident" id="7523269">Skipf</span><span class="op" id="7523274">(</span><span class="string" id="7523275">&#34;skipping&nbsp;on&nbsp;%s&#34;</span><span class="op" id="7523291">,</span>&nbsp;<span class="ident" id="7523293">runtime</span><span class="op" id="7523300">.</span><span class="ident" id="7523301">GOOS</span><span class="op" id="7523305">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7523308">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7523312">if</span>&nbsp;<span class="ident" id="7523315">err</span>&nbsp;<span class="op" id="7523319">:=</span>&nbsp;<span class="ident" id="7523322">exec</span><span class="op" id="7523326">.</span><span class="ident" id="7523327">Command</span><span class="op" id="7523334">(</span><span class="string" id="7523335">&#34;go&#34;</span><span class="op" id="7523339">,</span>&nbsp;<span class="string" id="7523341">&#34;run&#34;</span><span class="op" id="7523346">,</span>&nbsp;<span class="string" id="7523348">&#34;x509_test_import.go&#34;</span><span class="op" id="7523369">)</span><span class="op" id="7523370">.</span><span class="ident" id="7523371">Run</span><span class="op" id="7523374">(</span><span class="op" id="7523375">)</span><span class="op" id="7523376">;</span>&nbsp;<span class="ident" id="7523378">err</span>&nbsp;<span class="op" id="7523382">!=</span>&nbsp;<span class="builtintype" id="7523385">nil</span>&nbsp;<span class="op" id="7523389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7523393">t</span><span class="op" id="7523394">.</span><span class="ident" id="7523395">Errorf</span><span class="op" id="7523401">(</span><span class="string" id="7523402">&#34;failed&nbsp;to&nbsp;run&nbsp;x509_test_import.go:&nbsp;%s&#34;</span><span class="op" id="7523441">,</span>&nbsp;<span class="ident" id="7523443">err</span><span class="op" id="7523446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7523449">}</span><br>
<span class="lineno">750</span><span class="op" id="7523451">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7523454">const</span>&nbsp;<span class="ident" id="7523460">derCRLBase64</span>&nbsp;<span class="op" id="7523473">=</span>&nbsp;<span class="string" id="7523475">&#34;MIINqzCCDJMCAQEwDQYJKoZIhvcNAQEFBQAwVjEZMBcGA1UEAxMQUEtJIEZJTk1FQ0NBTklDQTEVMBMGA1UEChMMRklOTUVDQ0FOSUNBMRUwEwYDVQQLEwxGSU5NRUNDQU5JQ0ExCzAJBgNVBAYTAklUFw0xMTA1MDQxNjU3NDJaFw0xMTA1MDQyMDU3NDJaMIIMBzAhAg4Ze1od49Lt1qIXBydAzhcNMDkwNzE2MDg0MzIyWjAAMCECDl0HSL9bcZ1Ci/UHJ0DPFw0wOTA3MTYwODQzMTNaMAAwIQIOESB9tVAmX3cY7QcnQNAXDTA5MDcxNjA4NDUyMlowADAhAg4S1tGAQ3mHt8uVBydA1RcNMDkwODA0MTUyNTIyWjAAMCECDlQ249Y7vtC25ScHJ0DWFw0wOTA4MDQxNTI1MzdaMAAwIQIOISMop3NkA4PfYwcnQNkXDTA5MDgwNDExMDAzNFowADAhAg56/BMoS29KEShTBydA2hcNMDkwODA0MTEwMTAzWjAAMCECDnBp/22HPH5CSWoHJ0DbFw0wOTA4MDQxMDU0NDlaMAAwIQIOV9IP+8CD8bK+XAcnQNwXDTA5MDgwNDEwNTcxN1owADAhAg4v5aRz0IxWqYiXBydA3RcNMDkwODA0MTA1NzQ1WjAAMCECDlOU34VzvZAybQwHJ0DeFw0wOTA4MDQxMDU4MjFaMAAwIAINO4CD9lluIxcwBydBAxcNMDkwNzIyMTUzMTU5WjAAMCECDgOllfO8Y1QA7/wHJ0ExFw0wOTA3MjQxMTQxNDNaMAAwIQIOJBX7jbiCdRdyjgcnQUQXDTA5MDkxNjA5MzAwOFowADAhAg5iYSAgmDrlH/RZBydBRRcNMDkwOTE2MDkzMDE3WjAAMCECDmu6k6srP3jcMaQHJ0FRFw0wOTA4MDQxMDU2NDBaMAAwIQIOX8aHlO0V+WVH4QcnQVMXDTA5MDgwNDEwNTcyOVowADAhAg5flK2rg3NnsRgDBydBzhcNMTEwMjAxMTUzMzQ2WjAAMCECDg35yJDL1jOPTgoHJ0HPFw0xMTAyMDExNTM0MjZaMAAwIQIOMyFJ6+e9iiGVBQcnQdAXDTA5MDkxODEzMjAwNVowADAhAg5Emb/Oykucmn8fBydB1xcNMDkwOTIxMTAxMDQ3WjAAMCECDjQKCncV+MnUavMHJ0HaFw0wOTA5MjIwODE1MjZaMAAwIQIOaxiFUt3dpd+tPwcnQfQXDTEwMDYxODA4NDI1MVowADAhAg5G7P8nO0tkrMt7BydB9RcNMTAwNjE4MDg0MjMwWjAAMCECDmTCC3SXhmDRst4HJ0H2Fw0wOTA5MjgxMjA3MjBaMAAwIQIOHoGhUr/pRwzTKgcnQfcXDTA5MDkyODEyMDcyNFowADAhAg50wrcrCiw8mQmPBydCBBcNMTAwMjE2MTMwMTA2WjAAMCECDifWmkvwyhEqwEcHJ0IFFw0xMDAyMTYxMzAxMjBaMAAwIQIOfgPmlW9fg+osNgcnQhwXDTEwMDQxMzA5NTIwMFowADAhAg4YHAGuA6LgCk7tBydCHRcNMTAwNDEzMDk1MTM4WjAAMCECDi1zH1bxkNJhokAHJ0IsFw0xMDA0MTMwOTU5MzBaMAAwIQIOMipNccsb/wo2fwcnQi0XDTEwMDQxMzA5NTkwMFowADAhAg46lCmvPl4GpP6ABydCShcNMTAwMTE5MDk1MjE3WjAAMCECDjaTcaj+wBpcGAsHJ0JLFw0xMDAxMTkwOTUyMzRaMAAwIQIOOMC13EOrBuxIOQcnQloXDTEwMDIwMTA5NDcwNVowADAhAg5KmZl+krz4RsmrBydCWxcNMTAwMjAxMDk0NjQwWjAAMCECDmLG3zQJ/fzdSsUHJ0JiFw0xMDAzMDEwOTUxNDBaMAAwIQIOP39ksgHdojf4owcnQmMXDTEwMDMwMTA5NTExN1owADAhAg4LDQzvWNRlD6v9BydCZBcNMTAwMzAxMDk0NjIyWjAAMCECDkmNfeclaFhIaaUHJ0JlFw0xMDAzMDEwOTQ2MDVaMAAwIQIOT/qWWfpH/m8NTwcnQpQXDTEwMDUxMTA5MTgyMVowADAhAg5m/ksYxvCEgJSvBydClRcNMTAwNTExMDkxODAxWjAAMCECDgvf3Ohq6JOPU9AHJ0KWFw0xMDA1MTEwOTIxMjNaMAAwIQIOKSPas10z4jNVIQcnQpcXDTEwMDUxMTA5MjEwMlowADAhAg4mCWmhoZ3lyKCDBydCohcNMTEwNDI4MTEwMjI1WjAAMCECDkeiyRsBMK0Gvr4HJ0KjFw0xMTA0MjgxMTAyMDdaMAAwIQIOa09b/nH2+55SSwcnQq4XDTExMDQwMTA4Mjk0NlowADAhAg5O7M7iq7gGplr1BydCrxcNMTEwNDAxMDgzMDE3WjAAMCECDjlT6mJxUjTvyogHJ0K1Fw0xMTAxMjcxNTQ4NTJaMAAwIQIODS/l4UUFLe21NAcnQrYXDTExMDEyNzE1NDgyOFowADAhAg5lPRA0XdOUF6lSBydDHhcNMTEwMTI4MTQzNTA1WjAAMCECDixKX4fFGGpENwgHJ0MfFw0xMTAxMjgxNDM1MzBaMAAwIQIORNBkqsPnpKTtbAcnQ08XDTEwMDkwOTA4NDg0MlowADAhAg5QL+EMM3lohedEBydDUBcNMTAwOTA5MDg0ODE5WjAAMCECDlhDnHK+HiTRAXcHJ0NUFw0xMDEwMTkxNjIxNDBaMAAwIQIOdBFqAzq/INz53gcnQ1UXDTEwMTAxOTE2MjA0NFowADAhAg4OjR7s8MgKles1BydDWhcNMTEwMTI3MTY1MzM2WjAAMCECDmfR/elHee+d0SoHJ0NbFw0xMTAxMjcxNjUzNTZaMAAwIQIOBTKv2ui+KFMI+wcnQ5YXDTEwMDkxNTEwMjE1N1owADAhAg49F3c/GSah+oRUBydDmxcNMTEwMTI3MTczMjMzWjAAMCECDggv4I61WwpKFMMHJ0OcFw0xMTAxMjcxNzMyNTVaMAAwIQIOXx/Y8sEvwS10LAcnQ6UXDTExMDEyODExMjkzN1owADAhAg5LSLbnVrSKaw/9BydDphcNMTEwMTI4MTEyOTIwWjAAMCECDmFFoCuhKUeACQQHJ0PfFw0xMTAxMTExMDE3MzdaMAAwIQIOQTDdFh2fSPF6AAcnQ+AXDTExMDExMTEwMTcxMFowADAhAg5B8AOXX61FpvbbBydD5RcNMTAxMDA2MTAxNDM2WjAAMCECDh41P2Gmi7PkwI4HJ0PmFw0xMDEwMDYxMDE2MjVaMAAwIQIOWUHGLQCd+Ale9gcnQ/0XDTExMDUwMjA3NTYxMFowADAhAg5Z2c9AYkikmgWOBydD/hcNMTEwNTAyMDc1NjM0WjAAMCECDmf/UD+/h8nf+74HJ0QVFw0xMTA0MTUwNzI4MzNaMAAwIQIOICvj4epy3MrqfwcnRBYXDTExMDQxNTA3Mjg1NlowADAhAg4bouRMfOYqgv4xBydEHxcNMTEwMzA4MTYyNDI1WjAAMCECDhebWHGoKiTp7pEHJ0QgFw0xMTAzMDgxNjI0NDhaMAAwIQIOX+qnxxAqJ8LtawcnRDcXDTExMDEzMTE1MTIyOFowADAhAg4j0fICqZ+wkOdqBydEOBcNMTEwMTMxMTUxMTQxWjAAMCECDhmXjsV4SUpWtAMHJ0RLFw0xMTAxMjgxMTI0MTJaMAAwIQIODno/w+zG43kkTwcnREwXDTExMDEyODExMjM1MlowADAhAg4b1gc88767Fr+LBydETxcNMTEwMTI4MTEwMjA4WjAAMCECDn+M3Pa1w2nyFeUHJ0RQFw0xMTAxMjgxMDU4NDVaMAAwIQIOaduoyIH61tqybAcnRJUXDTEwMTIxNTA5NDMyMlowADAhAg4nLqQPkyi3ESAKBydElhcNMTAxMjE1MDk0MzM2WjAAMCECDi504NIMH8578gQHJ0SbFw0xMTAyMTQxNDA1NDFaMAAwIQIOGuaM8PDaC5u1egcnRJwXDTExMDIxNDE0MDYwNFowADAhAg4ehYq/BXGnB5PWBydEnxcNMTEwMjA0MDgwOTUxWjAAMCECDkSD4eS4FxW5H20HJ0SgFw0xMTAyMDQwODA5MjVaMAAwIQIOOCcb6ilYObt1egcnRKEXDTExMDEyNjEwNDEyOVowADAhAg58tISWCCwFnKGnBydEohcNMTEwMjA0MDgxMzQyWjAAMCECDn5rjtabY/L/WL0HJ0TJFw0xMTAyMDQxMTAzNDFaMAAwDQYJKoZIhvcNAQEFBQADggEBAGnF2Gs0+LNiYCW1Ipm83OXQYP/bd5tFFRzyz3iepFqNfYs4D68/QihjFoRHQoXEB0OEe1tvaVnnPGnEOpi6krwekquMxo4H88B5SlyiFIqemCOIss0SxlCFs69LmfRYvPPvPEhoXtQ3ZThe0UvKG83GOklhvGl6OaiRf4Mt+m8zOT4Wox/j6aOBK6cw6qKCdmD+Yj1rrNqFGg1CnSWMoD6S6mwNgkzwdBUJZ22BwrzAAo4RHa2Uy3ef1FjwD0XtU5N3uDSxGGBEDvOe5z82rps3E22FpAA8eYl8kaXtmWqyvYU0epp4brGuTxCuBMCAsxt/OjIjeNNQbBGkwxgfYA0=&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7528151">const</span>&nbsp;<span class="ident" id="7528157">pemCRLBase64</span>&nbsp;<span class="op" id="7528170">=</span>&nbsp;<span class="string" id="7528172">&#34;LS0tLS1CRUdJTiBYNTA5IENSTC0tLS0tDQpNSUlCOWpDQ0FWOENBUUV3RFFZSktvWklodmNOQVFFRkJRQXdiREVhTUJnR0ExVUVDaE1SVWxOQklGTmxZM1Z5DQphWFI1SUVsdVl5NHhIakFjQmdOVkJBTVRGVkpUUVNCUWRXSnNhV01nVW05dmRDQkRRU0IyTVRFdU1Dd0dDU3FHDQpTSWIzRFFFSkFSWWZjbk5oYTJWdmJuSnZiM1J6YVdkdVFISnpZWE5sWTNWeWFYUjVMbU52YlJjTk1URXdNakl6DQpNVGt5T0RNd1doY05NVEV3T0RJeU1Ua3lPRE13V2pDQmpEQktBaEVBckRxb2g5RkhKSFhUN09QZ3V1bjQrQmNODQpNRGt4TVRBeU1UUXlOekE1V2pBbU1Bb0dBMVVkRlFRRENnRUpNQmdHQTFVZEdBUVJHQTh5TURBNU1URXdNakUwDQpNalExTlZvd1BnSVJBTEd6blowOTVQQjVhQU9MUGc1N2ZNTVhEVEF5TVRBeU16RTBOVEF4TkZvd0dqQVlCZ05WDQpIUmdFRVJnUE1qQXdNakV3TWpNeE5EVXdNVFJhb0RBd0xqQWZCZ05WSFNNRUdEQVdnQlQxVERGNlVRTS9MTmVMDQpsNWx2cUhHUXEzZzltekFMQmdOVkhSUUVCQUlDQUlRd0RRWUpLb1pJaHZjTkFRRUZCUUFEZ1lFQUZVNUFzNk16DQpxNVBSc2lmYW9iUVBHaDFhSkx5QytNczVBZ2MwYld5QTNHQWR4dXI1U3BQWmVSV0NCamlQL01FSEJXSkNsQkhQDQpHUmNxNXlJZDNFakRrYUV5eFJhK2k2N0x6dmhJNmMyOUVlNks5cFNZd2ppLzdSVWhtbW5Qclh0VHhsTDBsckxyDQptUVFKNnhoRFJhNUczUUE0Q21VZHNITnZicnpnbUNZcHZWRT0NCi0tLS0tRU5EIFg1MDkgQ1JMLS0tLS0NCg0K&#34;</span><br>
<span class="lineno">755</span><br>
<span class="lineno"></span><span class="keyword" id="7529176">func</span>&nbsp;<span class="ident" id="7529181">TestCreateCertificateRequest</span><span class="op" id="7529209">(</span><span class="ident" id="7529210">t</span>&nbsp;<span class="op" id="7529212">*</span><span class="ident" id="7529213">testing</span><span class="op" id="7529220">.</span><span class="ident" id="7529221">T</span><span class="op" id="7529222">)</span>&nbsp;<span class="op" id="7529224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7529227">random</span>&nbsp;<span class="op" id="7529234">:=</span>&nbsp;<span class="ident" id="7529237">rand</span><span class="op" id="7529241">.</span><span class="ident" id="7529242">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7529251">block</span><span class="op" id="7529256">,</span>&nbsp;<span class="ident" id="7529258">_</span>&nbsp;<span class="op" id="7529260">:=</span>&nbsp;<span class="ident" id="7529263">pem</span><span class="op" id="7529266">.</span><span class="ident" id="7529267">Decode</span><span class="op" id="7529273">(</span><span class="op" id="7529274">[</span><span class="op" id="7529275">]</span><span class="builtintype" id="7529276">byte</span><span class="op" id="7529280">(</span><span class="ident" id="7529281">pemPrivateKey</span><span class="op" id="7529294">)</span><span class="op" id="7529295">)</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7529298">rsaPriv</span><span class="op" id="7529305">,</span>&nbsp;<span class="ident" id="7529307">err</span>&nbsp;<span class="op" id="7529311">:=</span>&nbsp;<span class="ident" id="7529314">ParsePKCS1PrivateKey</span><span class="op" id="7529334">(</span><span class="ident" id="7529335">block</span><span class="op" id="7529340">.</span><span class="ident" id="7529341">Bytes</span><span class="op" id="7529346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7529349">if</span>&nbsp;<span class="ident" id="7529352">err</span>&nbsp;<span class="op" id="7529356">!=</span>&nbsp;<span class="builtintype" id="7529359">nil</span>&nbsp;<span class="op" id="7529363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7529367">t</span><span class="op" id="7529368">.</span><span class="ident" id="7529369">Fatalf</span><span class="op" id="7529375">(</span><span class="string" id="7529376">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7529409">,</span>&nbsp;<span class="ident" id="7529411">err</span><span class="op" id="7529414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7529417">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7529421">ecdsa256Priv</span><span class="op" id="7529433">,</span>&nbsp;<span class="ident" id="7529435">err</span>&nbsp;<span class="op" id="7529439">:=</span>&nbsp;<span class="ident" id="7529442">ecdsa</span><span class="op" id="7529447">.</span><span class="ident" id="7529448">GenerateKey</span><span class="op" id="7529459">(</span><span class="ident" id="7529460">elliptic</span><span class="op" id="7529468">.</span><span class="ident" id="7529469">P256</span><span class="op" id="7529473">(</span><span class="op" id="7529474">)</span><span class="op" id="7529475">,</span>&nbsp;<span class="ident" id="7529477">rand</span><span class="op" id="7529481">.</span><span class="ident" id="7529482">Reader</span><span class="op" id="7529488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7529491">if</span>&nbsp;<span class="ident" id="7529494">err</span>&nbsp;<span class="op" id="7529498">!=</span>&nbsp;<span class="builtintype" id="7529501">nil</span>&nbsp;<span class="op" id="7529505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7529509">t</span><span class="op" id="7529510">.</span><span class="ident" id="7529511">Fatalf</span><span class="op" id="7529517">(</span><span class="string" id="7529518">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7529552">,</span>&nbsp;<span class="ident" id="7529554">err</span><span class="op" id="7529557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7529560">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7529564">ecdsa384Priv</span><span class="op" id="7529576">,</span>&nbsp;<span class="ident" id="7529578">err</span>&nbsp;<span class="op" id="7529582">:=</span>&nbsp;<span class="ident" id="7529585">ecdsa</span><span class="op" id="7529590">.</span><span class="ident" id="7529591">GenerateKey</span><span class="op" id="7529602">(</span><span class="ident" id="7529603">elliptic</span><span class="op" id="7529611">.</span><span class="ident" id="7529612">P384</span><span class="op" id="7529616">(</span><span class="op" id="7529617">)</span><span class="op" id="7529618">,</span>&nbsp;<span class="ident" id="7529620">rand</span><span class="op" id="7529624">.</span><span class="ident" id="7529625">Reader</span><span class="op" id="7529631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7529634">if</span>&nbsp;<span class="ident" id="7529637">err</span>&nbsp;<span class="op" id="7529641">!=</span>&nbsp;<span class="builtintype" id="7529644">nil</span>&nbsp;<span class="op" id="7529648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7529652">t</span><span class="op" id="7529653">.</span><span class="ident" id="7529654">Fatalf</span><span class="op" id="7529660">(</span><span class="string" id="7529661">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7529695">,</span>&nbsp;<span class="ident" id="7529697">err</span><span class="op" id="7529700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7529703">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7529707">ecdsa521Priv</span><span class="op" id="7529719">,</span>&nbsp;<span class="ident" id="7529721">err</span>&nbsp;<span class="op" id="7529725">:=</span>&nbsp;<span class="ident" id="7529728">ecdsa</span><span class="op" id="7529733">.</span><span class="ident" id="7529734">GenerateKey</span><span class="op" id="7529745">(</span><span class="ident" id="7529746">elliptic</span><span class="op" id="7529754">.</span><span class="ident" id="7529755">P521</span><span class="op" id="7529759">(</span><span class="op" id="7529760">)</span><span class="op" id="7529761">,</span>&nbsp;<span class="ident" id="7529763">rand</span><span class="op" id="7529767">.</span><span class="ident" id="7529768">Reader</span><span class="op" id="7529774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7529777">if</span>&nbsp;<span class="ident" id="7529780">err</span>&nbsp;<span class="op" id="7529784">!=</span>&nbsp;<span class="builtintype" id="7529787">nil</span>&nbsp;<span class="op" id="7529791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7529795">t</span><span class="op" id="7529796">.</span><span class="ident" id="7529797">Fatalf</span><span class="op" id="7529803">(</span><span class="string" id="7529804">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7529838">,</span>&nbsp;<span class="ident" id="7529840">err</span><span class="op" id="7529843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7529846">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7529850">tests</span>&nbsp;<span class="op" id="7529856">:=</span>&nbsp;<span class="op" id="7529859">[</span><span class="op" id="7529860">]</span><span class="keyword" id="7529861">struct</span>&nbsp;<span class="op" id="7529868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7529872">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7529880">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7529889">priv</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7529897">interface</span><span class="op" id="7529906">{</span><span class="op" id="7529907">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7529911">sigAlgo</span>&nbsp;<span class="ident" id="7529919">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7529939">}</span><span class="op" id="7529940">{</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7529944">{</span><span class="string" id="7529945">&#34;RSA&#34;</span><span class="op" id="7529950">,</span>&nbsp;<span class="ident" id="7529952">rsaPriv</span><span class="op" id="7529959">,</span>&nbsp;<span class="ident" id="7529961">SHA1WithRSA</span><span class="op" id="7529972">}</span><span class="op" id="7529973">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7529977">{</span><span class="string" id="7529978">&#34;ECDSA-256&#34;</span><span class="op" id="7529989">,</span>&nbsp;<span class="ident" id="7529991">ecdsa256Priv</span><span class="op" id="7530003">,</span>&nbsp;<span class="ident" id="7530005">ECDSAWithSHA1</span><span class="op" id="7530018">}</span><span class="op" id="7530019">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7530023">{</span><span class="string" id="7530024">&#34;ECDSA-384&#34;</span><span class="op" id="7530035">,</span>&nbsp;<span class="ident" id="7530037">ecdsa384Priv</span><span class="op" id="7530049">,</span>&nbsp;<span class="ident" id="7530051">ECDSAWithSHA1</span><span class="op" id="7530064">}</span><span class="op" id="7530065">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7530069">{</span><span class="string" id="7530070">&#34;ECDSA-521&#34;</span><span class="op" id="7530081">,</span>&nbsp;<span class="ident" id="7530083">ecdsa521Priv</span><span class="op" id="7530095">,</span>&nbsp;<span class="ident" id="7530097">ECDSAWithSHA1</span><span class="op" id="7530110">}</span><span class="op" id="7530111">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7530114">}</span><br>
<span class="lineno">790</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7530118">for</span>&nbsp;<span class="ident" id="7530122">_</span><span class="op" id="7530123">,</span>&nbsp;<span class="ident" id="7530125">test</span>&nbsp;<span class="op" id="7530130">:=</span>&nbsp;<span class="keyword" id="7530133">range</span>&nbsp;<span class="ident" id="7530139">tests</span>&nbsp;<span class="op" id="7530145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7530149">template</span>&nbsp;<span class="op" id="7530158">:=</span>&nbsp;<span class="ident" id="7530161">CertificateRequest</span><span class="op" id="7530179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7530184">Subject</span><span class="op" id="7530191">:</span>&nbsp;<span class="ident" id="7530193">pkix</span><span class="op" id="7530197">.</span><span class="ident" id="7530198">Name</span><span class="op" id="7530202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7530208">CommonName</span><span class="op" id="7530218">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7530222">&#34;test.example.com&#34;</span><span class="op" id="7530240">,</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7530246">Organization</span><span class="op" id="7530258">:</span>&nbsp;<span class="op" id="7530260">[</span><span class="op" id="7530261">]</span><span class="builtintype" id="7530262">string</span><span class="op" id="7530268">{</span><span class="string" id="7530269">&#34;Σ&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="7530281">}</span><span class="op" id="7530282">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7530287">}</span><span class="op" id="7530288">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7530293">SignatureAlgorithm</span><span class="op" id="7530311">:</span>&nbsp;<span class="ident" id="7530313">test</span><span class="op" id="7530317">.</span><span class="ident" id="7530318">sigAlgo</span><span class="op" id="7530325">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7530330">DNSNames</span><span class="op" id="7530338">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7530350">[</span><span class="op" id="7530351">]</span><span class="builtintype" id="7530352">string</span><span class="op" id="7530358">{</span><span class="string" id="7530359">&#34;test.example.com&#34;</span><span class="op" id="7530377">}</span><span class="op" id="7530378">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7530383">EmailAddresses</span><span class="op" id="7530397">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7530403">[</span><span class="op" id="7530404">]</span><span class="builtintype" id="7530405">string</span><span class="op" id="7530411">{</span><span class="string" id="7530412">&#34;gopher@golang.org&#34;</span><span class="op" id="7530431">}</span><span class="op" id="7530432">,</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7530437">IPAddresses</span><span class="op" id="7530448">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7530457">[</span><span class="op" id="7530458">]</span><span class="ident" id="7530459">net</span><span class="op" id="7530462">.</span><span class="ident" id="7530463">IP</span><span class="op" id="7530465">{</span><span class="ident" id="7530466">net</span><span class="op" id="7530469">.</span><span class="ident" id="7530470">IPv4</span><span class="op" id="7530474">(</span><span class="num" id="7530475">127</span><span class="op" id="7530478">,</span>&nbsp;<span class="num" id="7530480">0</span><span class="op" id="7530481">,</span>&nbsp;<span class="num" id="7530483">0</span><span class="op" id="7530484">,</span>&nbsp;<span class="num" id="7530486">1</span><span class="op" id="7530487">)</span><span class="op" id="7530488">.</span><span class="ident" id="7530489">To4</span><span class="op" id="7530492">(</span><span class="op" id="7530493">)</span><span class="op" id="7530494">,</span>&nbsp;<span class="ident" id="7530496">net</span><span class="op" id="7530499">.</span><span class="ident" id="7530500">ParseIP</span><span class="op" id="7530507">(</span><span class="string" id="7530508">&#34;2001:4860:0:2001::68&#34;</span><span class="op" id="7530530">)</span><span class="op" id="7530531">}</span><span class="op" id="7530532">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7530536">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7530541">derBytes</span><span class="op" id="7530549">,</span>&nbsp;<span class="ident" id="7530551">err</span>&nbsp;<span class="op" id="7530555">:=</span>&nbsp;<span class="ident" id="7530558">CreateCertificateRequest</span><span class="op" id="7530582">(</span><span class="ident" id="7530583">random</span><span class="op" id="7530589">,</span>&nbsp;<span class="op" id="7530591">&amp;</span><span class="ident" id="7530592">template</span><span class="op" id="7530600">,</span>&nbsp;<span class="ident" id="7530602">test</span><span class="op" id="7530606">.</span><span class="ident" id="7530607">priv</span><span class="op" id="7530611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7530615">if</span>&nbsp;<span class="ident" id="7530618">err</span>&nbsp;<span class="op" id="7530622">!=</span>&nbsp;<span class="builtintype" id="7530625">nil</span>&nbsp;<span class="op" id="7530629">{</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7530634">t</span><span class="op" id="7530635">.</span><span class="ident" id="7530636">Errorf</span><span class="op" id="7530642">(</span><span class="string" id="7530643">&#34;%s:&nbsp;failed&nbsp;to&nbsp;create&nbsp;certificate&nbsp;request:&nbsp;%s&#34;</span><span class="op" id="7530689">,</span>&nbsp;<span class="ident" id="7530691">test</span><span class="op" id="7530695">.</span><span class="ident" id="7530696">name</span><span class="op" id="7530700">,</span>&nbsp;<span class="ident" id="7530702">err</span><span class="op" id="7530705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7530710">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7530721">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7530726">out</span><span class="op" id="7530729">,</span>&nbsp;<span class="ident" id="7530731">err</span>&nbsp;<span class="op" id="7530735">:=</span>&nbsp;<span class="ident" id="7530738">ParseCertificateRequest</span><span class="op" id="7530761">(</span><span class="ident" id="7530762">derBytes</span><span class="op" id="7530770">)</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7530774">if</span>&nbsp;<span class="ident" id="7530777">err</span>&nbsp;<span class="op" id="7530781">!=</span>&nbsp;<span class="builtintype" id="7530784">nil</span>&nbsp;<span class="op" id="7530788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7530793">t</span><span class="op" id="7530794">.</span><span class="ident" id="7530795">Errorf</span><span class="op" id="7530801">(</span><span class="string" id="7530802">&#34;%s:&nbsp;failed&nbsp;to&nbsp;create&nbsp;certificate&nbsp;request:&nbsp;%s&#34;</span><span class="op" id="7530848">,</span>&nbsp;<span class="ident" id="7530850">test</span><span class="op" id="7530854">.</span><span class="ident" id="7530855">name</span><span class="op" id="7530859">,</span>&nbsp;<span class="ident" id="7530861">err</span><span class="op" id="7530864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7530869">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7530880">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7530885">if</span>&nbsp;<span class="ident" id="7530888">out</span><span class="op" id="7530891">.</span><span class="ident" id="7530892">Subject</span><span class="op" id="7530899">.</span><span class="ident" id="7530900">CommonName</span>&nbsp;<span class="op" id="7530911">!=</span>&nbsp;<span class="ident" id="7530914">template</span><span class="op" id="7530922">.</span><span class="ident" id="7530923">Subject</span><span class="op" id="7530930">.</span><span class="ident" id="7530931">CommonName</span>&nbsp;<span class="op" id="7530942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7530947">t</span><span class="op" id="7530948">.</span><span class="ident" id="7530949">Errorf</span><span class="op" id="7530955">(</span><span class="string" id="7530956">&#34;%s:&nbsp;output&nbsp;subject&nbsp;common&nbsp;name&nbsp;and&nbsp;template&nbsp;subject&nbsp;common&nbsp;name&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="7531033">,</span>&nbsp;<span class="ident" id="7531035">test</span><span class="op" id="7531039">.</span><span class="ident" id="7531040">name</span><span class="op" id="7531044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7531048">}</span>&nbsp;<span class="keyword" id="7531050">else</span>&nbsp;<span class="keyword" id="7531055">if</span>&nbsp;<span class="builtinfunc" id="7531058">len</span><span class="op" id="7531061">(</span><span class="ident" id="7531062">out</span><span class="op" id="7531065">.</span><span class="ident" id="7531066">Subject</span><span class="op" id="7531073">.</span><span class="ident" id="7531074">Organization</span><span class="op" id="7531086">)</span>&nbsp;<span class="op" id="7531088">!=</span>&nbsp;<span class="builtinfunc" id="7531091">len</span><span class="op" id="7531094">(</span><span class="ident" id="7531095">template</span><span class="op" id="7531103">.</span><span class="ident" id="7531104">Subject</span><span class="op" id="7531111">.</span><span class="ident" id="7531112">Organization</span><span class="op" id="7531124">)</span>&nbsp;<span class="op" id="7531126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7531131">t</span><span class="op" id="7531132">.</span><span class="ident" id="7531133">Errorf</span><span class="op" id="7531139">(</span><span class="string" id="7531140">&#34;%s:&nbsp;output&nbsp;subject&nbsp;organisation&nbsp;and&nbsp;template&nbsp;subject&nbsp;organisation&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="7531219">,</span>&nbsp;<span class="ident" id="7531221">test</span><span class="op" id="7531225">.</span><span class="ident" id="7531226">name</span><span class="op" id="7531230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7531234">}</span>&nbsp;<span class="keyword" id="7531236">else</span>&nbsp;<span class="keyword" id="7531241">if</span>&nbsp;<span class="builtinfunc" id="7531244">len</span><span class="op" id="7531247">(</span><span class="ident" id="7531248">out</span><span class="op" id="7531251">.</span><span class="ident" id="7531252">DNSNames</span><span class="op" id="7531260">)</span>&nbsp;<span class="op" id="7531262">!=</span>&nbsp;<span class="builtinfunc" id="7531265">len</span><span class="op" id="7531268">(</span><span class="ident" id="7531269">template</span><span class="op" id="7531277">.</span><span class="ident" id="7531278">DNSNames</span><span class="op" id="7531286">)</span>&nbsp;<span class="op" id="7531288">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7531293">t</span><span class="op" id="7531294">.</span><span class="ident" id="7531295">Errorf</span><span class="op" id="7531301">(</span><span class="string" id="7531302">&#34;%s:&nbsp;output&nbsp;DNS&nbsp;names&nbsp;and&nbsp;template&nbsp;DNS&nbsp;names&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="7531359">,</span>&nbsp;<span class="ident" id="7531361">test</span><span class="op" id="7531365">.</span><span class="ident" id="7531366">name</span><span class="op" id="7531370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7531374">}</span>&nbsp;<span class="keyword" id="7531376">else</span>&nbsp;<span class="keyword" id="7531381">if</span>&nbsp;<span class="builtinfunc" id="7531384">len</span><span class="op" id="7531387">(</span><span class="ident" id="7531388">out</span><span class="op" id="7531391">.</span><span class="ident" id="7531392">EmailAddresses</span><span class="op" id="7531406">)</span>&nbsp;<span class="op" id="7531408">!=</span>&nbsp;<span class="builtinfunc" id="7531411">len</span><span class="op" id="7531414">(</span><span class="ident" id="7531415">template</span><span class="op" id="7531423">.</span><span class="ident" id="7531424">EmailAddresses</span><span class="op" id="7531438">)</span>&nbsp;<span class="op" id="7531440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7531445">t</span><span class="op" id="7531446">.</span><span class="ident" id="7531447">Errorf</span><span class="op" id="7531453">(</span><span class="string" id="7531454">&#34;%s:&nbsp;output&nbsp;email&nbsp;addresses&nbsp;and&nbsp;template&nbsp;email&nbsp;addresses&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="7531523">,</span>&nbsp;<span class="ident" id="7531525">test</span><span class="op" id="7531529">.</span><span class="ident" id="7531530">name</span><span class="op" id="7531534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7531538">}</span>&nbsp;<span class="keyword" id="7531540">else</span>&nbsp;<span class="keyword" id="7531545">if</span>&nbsp;<span class="builtinfunc" id="7531548">len</span><span class="op" id="7531551">(</span><span class="ident" id="7531552">out</span><span class="op" id="7531555">.</span><span class="ident" id="7531556">IPAddresses</span><span class="op" id="7531567">)</span>&nbsp;<span class="op" id="7531569">!=</span>&nbsp;<span class="builtinfunc" id="7531572">len</span><span class="op" id="7531575">(</span><span class="ident" id="7531576">template</span><span class="op" id="7531584">.</span><span class="ident" id="7531585">IPAddresses</span><span class="op" id="7531596">)</span>&nbsp;<span class="op" id="7531598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7531603">t</span><span class="op" id="7531604">.</span><span class="ident" id="7531605">Errorf</span><span class="op" id="7531611">(</span><span class="string" id="7531612">&#34;%s:&nbsp;output&nbsp;IP&nbsp;addresses&nbsp;and&nbsp;template&nbsp;IP&nbsp;addresses&nbsp;names&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="7531681">,</span>&nbsp;<span class="ident" id="7531683">test</span><span class="op" id="7531687">.</span><span class="ident" id="7531688">name</span><span class="op" id="7531692">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7531696">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7531699">}</span><br>
<span class="lineno"></span><span class="op" id="7531701">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7531704">func</span>&nbsp;<span class="ident" id="7531709">marshalAndParseCSR</span><span class="op" id="7531727">(</span><span class="ident" id="7531728">t</span>&nbsp;<span class="op" id="7531730">*</span><span class="ident" id="7531731">testing</span><span class="op" id="7531738">.</span><span class="ident" id="7531739">T</span><span class="op" id="7531740">,</span>&nbsp;<span class="ident" id="7531742">template</span>&nbsp;<span class="op" id="7531751">*</span><span class="ident" id="7531752">CertificateRequest</span><span class="op" id="7531770">)</span>&nbsp;<span class="op" id="7531772">*</span><span class="ident" id="7531773">CertificateRequest</span>&nbsp;<span class="op" id="7531792">{</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7531795">block</span><span class="op" id="7531800">,</span>&nbsp;<span class="ident" id="7531802">_</span>&nbsp;<span class="op" id="7531804">:=</span>&nbsp;<span class="ident" id="7531807">pem</span><span class="op" id="7531810">.</span><span class="ident" id="7531811">Decode</span><span class="op" id="7531817">(</span><span class="op" id="7531818">[</span><span class="op" id="7531819">]</span><span class="builtintype" id="7531820">byte</span><span class="op" id="7531824">(</span><span class="ident" id="7531825">pemPrivateKey</span><span class="op" id="7531838">)</span><span class="op" id="7531839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7531842">rsaPriv</span><span class="op" id="7531849">,</span>&nbsp;<span class="ident" id="7531851">err</span>&nbsp;<span class="op" id="7531855">:=</span>&nbsp;<span class="ident" id="7531858">ParsePKCS1PrivateKey</span><span class="op" id="7531878">(</span><span class="ident" id="7531879">block</span><span class="op" id="7531884">.</span><span class="ident" id="7531885">Bytes</span><span class="op" id="7531890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7531893">if</span>&nbsp;<span class="ident" id="7531896">err</span>&nbsp;<span class="op" id="7531900">!=</span>&nbsp;<span class="builtintype" id="7531903">nil</span>&nbsp;<span class="op" id="7531907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7531911">t</span><span class="op" id="7531912">.</span><span class="ident" id="7531913">Fatal</span><span class="op" id="7531918">(</span><span class="ident" id="7531919">err</span><span class="op" id="7531922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7531925">}</span><br>
<span class="lineno">835</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7531929">derBytes</span><span class="op" id="7531937">,</span>&nbsp;<span class="ident" id="7531939">err</span>&nbsp;<span class="op" id="7531943">:=</span>&nbsp;<span class="ident" id="7531946">CreateCertificateRequest</span><span class="op" id="7531970">(</span><span class="ident" id="7531971">rand</span><span class="op" id="7531975">.</span><span class="ident" id="7531976">Reader</span><span class="op" id="7531982">,</span>&nbsp;<span class="ident" id="7531984">template</span><span class="op" id="7531992">,</span>&nbsp;<span class="ident" id="7531994">rsaPriv</span><span class="op" id="7532001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7532004">if</span>&nbsp;<span class="ident" id="7532007">err</span>&nbsp;<span class="op" id="7532011">!=</span>&nbsp;<span class="builtintype" id="7532014">nil</span>&nbsp;<span class="op" id="7532018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7532022">t</span><span class="op" id="7532023">.</span><span class="ident" id="7532024">Fatal</span><span class="op" id="7532029">(</span><span class="ident" id="7532030">err</span><span class="op" id="7532033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7532036">}</span><br>
<span class="lineno">840</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7532040">csr</span><span class="op" id="7532043">,</span>&nbsp;<span class="ident" id="7532045">err</span>&nbsp;<span class="op" id="7532049">:=</span>&nbsp;<span class="ident" id="7532052">ParseCertificateRequest</span><span class="op" id="7532075">(</span><span class="ident" id="7532076">derBytes</span><span class="op" id="7532084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7532087">if</span>&nbsp;<span class="ident" id="7532090">err</span>&nbsp;<span class="op" id="7532094">!=</span>&nbsp;<span class="builtintype" id="7532097">nil</span>&nbsp;<span class="op" id="7532101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7532105">t</span><span class="op" id="7532106">.</span><span class="ident" id="7532107">Fatal</span><span class="op" id="7532112">(</span><span class="ident" id="7532113">err</span><span class="op" id="7532116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7532119">}</span><br>
<span class="lineno">845</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7532123">return</span>&nbsp;<span class="ident" id="7532130">csr</span><br>
<span class="lineno"></span><span class="op" id="7532134">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7532137">func</span>&nbsp;<span class="ident" id="7532142">TestCertificateRequestOverrides</span><span class="op" id="7532173">(</span><span class="ident" id="7532174">t</span>&nbsp;<span class="op" id="7532176">*</span><span class="ident" id="7532177">testing</span><span class="op" id="7532184">.</span><span class="ident" id="7532185">T</span><span class="op" id="7532186">)</span>&nbsp;<span class="op" id="7532188">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7532191">sanContents</span><span class="op" id="7532202">,</span>&nbsp;<span class="ident" id="7532204">err</span>&nbsp;<span class="op" id="7532208">:=</span>&nbsp;<span class="ident" id="7532211">marshalSANs</span><span class="op" id="7532222">(</span><span class="op" id="7532223">[</span><span class="op" id="7532224">]</span><span class="builtintype" id="7532225">string</span><span class="op" id="7532231">{</span><span class="string" id="7532232">&#34;foo.example.com&#34;</span><span class="op" id="7532249">}</span><span class="op" id="7532250">,</span>&nbsp;<span class="builtintype" id="7532252">nil</span><span class="op" id="7532255">,</span>&nbsp;<span class="builtintype" id="7532257">nil</span><span class="op" id="7532260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7532263">if</span>&nbsp;<span class="ident" id="7532266">err</span>&nbsp;<span class="op" id="7532270">!=</span>&nbsp;<span class="builtintype" id="7532273">nil</span>&nbsp;<span class="op" id="7532277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7532281">t</span><span class="op" id="7532282">.</span><span class="ident" id="7532283">Fatal</span><span class="op" id="7532288">(</span><span class="ident" id="7532289">err</span><span class="op" id="7532292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7532295">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7532299">template</span>&nbsp;<span class="op" id="7532308">:=</span>&nbsp;<span class="ident" id="7532311">CertificateRequest</span><span class="op" id="7532329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7532333">Subject</span><span class="op" id="7532340">:</span>&nbsp;<span class="ident" id="7532342">pkix</span><span class="op" id="7532346">.</span><span class="ident" id="7532347">Name</span><span class="op" id="7532351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7532356">CommonName</span><span class="op" id="7532366">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7532370">&#34;test.example.com&#34;</span><span class="op" id="7532388">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7532393">Organization</span><span class="op" id="7532405">:</span>&nbsp;<span class="op" id="7532407">[</span><span class="op" id="7532408">]</span><span class="builtintype" id="7532409">string</span><span class="op" id="7532415">{</span><span class="string" id="7532416">&#34;Σ&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="7532428">}</span><span class="op" id="7532429">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7532433">}</span><span class="op" id="7532434">,</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7532438">DNSNames</span><span class="op" id="7532446">:</span>&nbsp;<span class="op" id="7532448">[</span><span class="op" id="7532449">]</span><span class="builtintype" id="7532450">string</span><span class="op" id="7532456">{</span><span class="string" id="7532457">&#34;test.example.com&#34;</span><span class="op" id="7532475">}</span><span class="op" id="7532476">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7532481">//&nbsp;An&nbsp;explicit&nbsp;extension&nbsp;should&nbsp;override&nbsp;the&nbsp;DNSNames&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7532546">//&nbsp;template.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7532561">ExtraExtensions</span><span class="op" id="7532576">:</span>&nbsp;<span class="op" id="7532578">[</span><span class="op" id="7532579">]</span><span class="ident" id="7532580">pkix</span><span class="op" id="7532584">.</span><span class="ident" id="7532585">Extension</span><span class="op" id="7532594">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7532599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7532605">Id</span><span class="op" id="7532607">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7532612">oidExtensionSubjectAltName</span><span class="op" id="7532638">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7532644">Value</span><span class="op" id="7532649">:</span>&nbsp;<span class="ident" id="7532651">sanContents</span><span class="op" id="7532662">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7532667">}</span><span class="op" id="7532668">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7532672">}</span><span class="op" id="7532673">,</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7532676">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7532680">csr</span>&nbsp;<span class="op" id="7532684">:=</span>&nbsp;<span class="ident" id="7532687">marshalAndParseCSR</span><span class="op" id="7532705">(</span><span class="ident" id="7532706">t</span><span class="op" id="7532707">,</span>&nbsp;<span class="op" id="7532709">&amp;</span><span class="ident" id="7532710">template</span><span class="op" id="7532718">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7532722">if</span>&nbsp;<span class="builtinfunc" id="7532725">len</span><span class="op" id="7532728">(</span><span class="ident" id="7532729">csr</span><span class="op" id="7532732">.</span><span class="ident" id="7532733">DNSNames</span><span class="op" id="7532741">)</span>&nbsp;<span class="op" id="7532743">!=</span>&nbsp;<span class="num" id="7532746">1</span>&nbsp;<span class="op" id="7532748">||</span>&nbsp;<span class="ident" id="7532751">csr</span><span class="op" id="7532754">.</span><span class="ident" id="7532755">DNSNames</span><span class="op" id="7532763">[</span><span class="num" id="7532764">0</span><span class="op" id="7532765">]</span>&nbsp;<span class="op" id="7532767">!=</span>&nbsp;<span class="string" id="7532770">&#34;foo.example.com&#34;</span>&nbsp;<span class="op" id="7532788">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7532792">t</span><span class="op" id="7532793">.</span><span class="ident" id="7532794">Errorf</span><span class="op" id="7532800">(</span><span class="string" id="7532801">&#34;Extension&nbsp;did&nbsp;not&nbsp;override&nbsp;template.&nbsp;Got&nbsp;%v\n&#34;</span><span class="op" id="7532848">,</span>&nbsp;<span class="ident" id="7532850">csr</span><span class="op" id="7532853">.</span><span class="ident" id="7532854">DNSNames</span><span class="op" id="7532862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7532865">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7532869">//&nbsp;If&nbsp;there&nbsp;is&nbsp;already&nbsp;an&nbsp;attribute&nbsp;with&nbsp;X.509&nbsp;extensions&nbsp;then&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7532937">//&nbsp;extra&nbsp;extensions&nbsp;should&nbsp;be&nbsp;added&nbsp;to&nbsp;it&nbsp;rather&nbsp;than&nbsp;creating&nbsp;a&nbsp;CSR</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7533007">//&nbsp;with&nbsp;two&nbsp;extension&nbsp;attributes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7533043">template</span><span class="op" id="7533051">.</span><span class="ident" id="7533052">Attributes</span>&nbsp;<span class="op" id="7533063">=</span>&nbsp;<span class="op" id="7533065">[</span><span class="op" id="7533066">]</span><span class="ident" id="7533067">pkix</span><span class="op" id="7533071">.</span><span class="ident" id="7533072">AttributeTypeAndValueSET</span><span class="op" id="7533096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7533100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7533105">Type</span><span class="op" id="7533109">:</span>&nbsp;<span class="ident" id="7533111">oidExtensionRequest</span><span class="op" id="7533130">,</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7533135">Value</span><span class="op" id="7533140">:</span>&nbsp;<span class="op" id="7533142">[</span><span class="op" id="7533143">]</span><span class="op" id="7533144">[</span><span class="op" id="7533145">]</span><span class="ident" id="7533146">pkix</span><span class="op" id="7533150">.</span><span class="ident" id="7533151">AttributeTypeAndValue</span><span class="op" id="7533172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7533178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7533185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7533193">Type</span><span class="op" id="7533197">:</span>&nbsp;&nbsp;<span class="ident" id="7533200">oidExtensionAuthorityInfoAccess</span><span class="op" id="7533231">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7533239">Value</span><span class="op" id="7533244">:</span>&nbsp;<span class="op" id="7533246">[</span><span class="op" id="7533247">]</span><span class="builtintype" id="7533248">byte</span><span class="op" id="7533252">(</span><span class="string" id="7533253">&#34;foo&#34;</span><span class="op" id="7533258">)</span><span class="op" id="7533259">,</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7533266">}</span><span class="op" id="7533267">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7533273">}</span><span class="op" id="7533274">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7533279">}</span><span class="op" id="7533280">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7533284">}</span><span class="op" id="7533285">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7533288">}</span><br>
<span class="lineno">895</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7533292">csr</span>&nbsp;<span class="op" id="7533296">=</span>&nbsp;<span class="ident" id="7533298">marshalAndParseCSR</span><span class="op" id="7533316">(</span><span class="ident" id="7533317">t</span><span class="op" id="7533318">,</span>&nbsp;<span class="op" id="7533320">&amp;</span><span class="ident" id="7533321">template</span><span class="op" id="7533329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7533332">if</span>&nbsp;<span class="ident" id="7533335">l</span>&nbsp;<span class="op" id="7533337">:=</span>&nbsp;<span class="builtinfunc" id="7533340">len</span><span class="op" id="7533343">(</span><span class="ident" id="7533344">csr</span><span class="op" id="7533347">.</span><span class="ident" id="7533348">Attributes</span><span class="op" id="7533358">)</span><span class="op" id="7533359">;</span>&nbsp;<span class="ident" id="7533361">l</span>&nbsp;<span class="op" id="7533363">!=</span>&nbsp;<span class="num" id="7533366">1</span>&nbsp;<span class="op" id="7533368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7533372">t</span><span class="op" id="7533373">.</span><span class="ident" id="7533374">Errorf</span><span class="op" id="7533380">(</span><span class="string" id="7533381">&#34;incorrect&nbsp;number&nbsp;of&nbsp;attributes:&nbsp;%d\n&#34;</span><span class="op" id="7533419">,</span>&nbsp;<span class="ident" id="7533421">l</span><span class="op" id="7533422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7533425">}</span><br>
<span class="lineno">900</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7533429">if</span>&nbsp;<span class="op" id="7533432">!</span><span class="ident" id="7533433">csr</span><span class="op" id="7533436">.</span><span class="ident" id="7533437">Attributes</span><span class="op" id="7533447">[</span><span class="num" id="7533448">0</span><span class="op" id="7533449">]</span><span class="op" id="7533450">.</span><span class="ident" id="7533451">Type</span><span class="op" id="7533455">.</span><span class="ident" id="7533456">Equal</span><span class="op" id="7533461">(</span><span class="ident" id="7533462">oidExtensionRequest</span><span class="op" id="7533481">)</span>&nbsp;<span class="op" id="7533483">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7533488">len</span><span class="op" id="7533491">(</span><span class="ident" id="7533492">csr</span><span class="op" id="7533495">.</span><span class="ident" id="7533496">Attributes</span><span class="op" id="7533506">[</span><span class="num" id="7533507">0</span><span class="op" id="7533508">]</span><span class="op" id="7533509">.</span><span class="ident" id="7533510">Value</span><span class="op" id="7533515">)</span>&nbsp;<span class="op" id="7533517">!=</span>&nbsp;<span class="num" id="7533520">1</span>&nbsp;<span class="op" id="7533522">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7533527">len</span><span class="op" id="7533530">(</span><span class="ident" id="7533531">csr</span><span class="op" id="7533534">.</span><span class="ident" id="7533535">Attributes</span><span class="op" id="7533545">[</span><span class="num" id="7533546">0</span><span class="op" id="7533547">]</span><span class="op" id="7533548">.</span><span class="ident" id="7533549">Value</span><span class="op" id="7533554">[</span><span class="num" id="7533555">0</span><span class="op" id="7533556">]</span><span class="op" id="7533557">)</span>&nbsp;<span class="op" id="7533559">!=</span>&nbsp;<span class="num" id="7533562">2</span>&nbsp;<span class="op" id="7533564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7533568">t</span><span class="op" id="7533569">.</span><span class="ident" id="7533570">Errorf</span><span class="op" id="7533576">(</span><span class="string" id="7533577">&#34;bad&nbsp;attributes:&nbsp;%#v\n&#34;</span><span class="op" id="7533600">,</span>&nbsp;<span class="ident" id="7533602">csr</span><span class="op" id="7533605">.</span><span class="ident" id="7533606">Attributes</span><span class="op" id="7533616">)</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7533619">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7533623">sanContents2</span><span class="op" id="7533635">,</span>&nbsp;<span class="ident" id="7533637">err</span>&nbsp;<span class="op" id="7533641">:=</span>&nbsp;<span class="ident" id="7533644">marshalSANs</span><span class="op" id="7533655">(</span><span class="op" id="7533656">[</span><span class="op" id="7533657">]</span><span class="builtintype" id="7533658">string</span><span class="op" id="7533664">{</span><span class="string" id="7533665">&#34;foo2.example.com&#34;</span><span class="op" id="7533683">}</span><span class="op" id="7533684">,</span>&nbsp;<span class="builtintype" id="7533686">nil</span><span class="op" id="7533689">,</span>&nbsp;<span class="builtintype" id="7533691">nil</span><span class="op" id="7533694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7533697">if</span>&nbsp;<span class="ident" id="7533700">err</span>&nbsp;<span class="op" id="7533704">!=</span>&nbsp;<span class="builtintype" id="7533707">nil</span>&nbsp;<span class="op" id="7533711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7533715">t</span><span class="op" id="7533716">.</span><span class="ident" id="7533717">Fatal</span><span class="op" id="7533722">(</span><span class="ident" id="7533723">err</span><span class="op" id="7533726">)</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7533729">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7533733">//&nbsp;Extensions&nbsp;in&nbsp;Attributes&nbsp;should&nbsp;override&nbsp;those&nbsp;in&nbsp;ExtraExtensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7533804">template</span><span class="op" id="7533812">.</span><span class="ident" id="7533813">Attributes</span><span class="op" id="7533823">[</span><span class="num" id="7533824">0</span><span class="op" id="7533825">]</span><span class="op" id="7533826">.</span><span class="ident" id="7533827">Value</span><span class="op" id="7533832">[</span><span class="num" id="7533833">0</span><span class="op" id="7533834">]</span>&nbsp;<span class="op" id="7533836">=</span>&nbsp;<span class="builtinfunc" id="7533838">append</span><span class="op" id="7533844">(</span><span class="ident" id="7533845">template</span><span class="op" id="7533853">.</span><span class="ident" id="7533854">Attributes</span><span class="op" id="7533864">[</span><span class="num" id="7533865">0</span><span class="op" id="7533866">]</span><span class="op" id="7533867">.</span><span class="ident" id="7533868">Value</span><span class="op" id="7533873">[</span><span class="num" id="7533874">0</span><span class="op" id="7533875">]</span><span class="op" id="7533876">,</span>&nbsp;<span class="ident" id="7533878">pkix</span><span class="op" id="7533882">.</span><span class="ident" id="7533883">AttributeTypeAndValue</span><span class="op" id="7533904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7533908">Type</span><span class="op" id="7533912">:</span>&nbsp;&nbsp;<span class="ident" id="7533915">oidExtensionSubjectAltName</span><span class="op" id="7533941">,</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7533945">Value</span><span class="op" id="7533950">:</span>&nbsp;<span class="ident" id="7533952">sanContents2</span><span class="op" id="7533964">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7533967">}</span><span class="op" id="7533968">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7533972">csr</span>&nbsp;<span class="op" id="7533976">=</span>&nbsp;<span class="ident" id="7533978">marshalAndParseCSR</span><span class="op" id="7533996">(</span><span class="ident" id="7533997">t</span><span class="op" id="7533998">,</span>&nbsp;<span class="op" id="7534000">&amp;</span><span class="ident" id="7534001">template</span><span class="op" id="7534009">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7534013">if</span>&nbsp;<span class="builtinfunc" id="7534016">len</span><span class="op" id="7534019">(</span><span class="ident" id="7534020">csr</span><span class="op" id="7534023">.</span><span class="ident" id="7534024">DNSNames</span><span class="op" id="7534032">)</span>&nbsp;<span class="op" id="7534034">!=</span>&nbsp;<span class="num" id="7534037">1</span>&nbsp;<span class="op" id="7534039">||</span>&nbsp;<span class="ident" id="7534042">csr</span><span class="op" id="7534045">.</span><span class="ident" id="7534046">DNSNames</span><span class="op" id="7534054">[</span><span class="num" id="7534055">0</span><span class="op" id="7534056">]</span>&nbsp;<span class="op" id="7534058">!=</span>&nbsp;<span class="string" id="7534061">&#34;foo2.example.com&#34;</span>&nbsp;<span class="op" id="7534080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7534084">t</span><span class="op" id="7534085">.</span><span class="ident" id="7534086">Errorf</span><span class="op" id="7534092">(</span><span class="string" id="7534093">&#34;Attributes&nbsp;did&nbsp;not&nbsp;override&nbsp;ExtraExtensions.&nbsp;Got&nbsp;%v\n&#34;</span><span class="op" id="7534148">,</span>&nbsp;<span class="ident" id="7534150">csr</span><span class="op" id="7534153">.</span><span class="ident" id="7534154">DNSNames</span><span class="op" id="7534162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7534165">}</span><br>
<span class="lineno"></span><span class="op" id="7534167">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">925</span><span class="keyword" id="7534170">func</span>&nbsp;<span class="ident" id="7534175">TestParseCertificateRequest</span><span class="op" id="7534202">(</span><span class="ident" id="7534203">t</span>&nbsp;<span class="op" id="7534205">*</span><span class="ident" id="7534206">testing</span><span class="op" id="7534213">.</span><span class="ident" id="7534214">T</span><span class="op" id="7534215">)</span>&nbsp;<span class="op" id="7534217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7534220">csrBytes</span>&nbsp;<span class="op" id="7534229">:=</span>&nbsp;<span class="ident" id="7534232">fromBase64</span><span class="op" id="7534242">(</span><span class="ident" id="7534243">csrBase64</span><span class="op" id="7534252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7534255">csr</span><span class="op" id="7534258">,</span>&nbsp;<span class="ident" id="7534260">err</span>&nbsp;<span class="op" id="7534264">:=</span>&nbsp;<span class="ident" id="7534267">ParseCertificateRequest</span><span class="op" id="7534290">(</span><span class="ident" id="7534291">csrBytes</span><span class="op" id="7534299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7534302">if</span>&nbsp;<span class="ident" id="7534305">err</span>&nbsp;<span class="op" id="7534309">!=</span>&nbsp;<span class="builtintype" id="7534312">nil</span>&nbsp;<span class="op" id="7534316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7534320">t</span><span class="op" id="7534321">.</span><span class="ident" id="7534322">Fatalf</span><span class="op" id="7534328">(</span><span class="string" id="7534329">&#34;failed&nbsp;to&nbsp;parse&nbsp;CSR:&nbsp;%s&#34;</span><span class="op" id="7534354">,</span>&nbsp;<span class="ident" id="7534356">err</span><span class="op" id="7534359">)</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7534362">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7534366">if</span>&nbsp;<span class="builtinfunc" id="7534369">len</span><span class="op" id="7534372">(</span><span class="ident" id="7534373">csr</span><span class="op" id="7534376">.</span><span class="ident" id="7534377">EmailAddresses</span><span class="op" id="7534391">)</span>&nbsp;<span class="op" id="7534393">!=</span>&nbsp;<span class="num" id="7534396">1</span>&nbsp;<span class="op" id="7534398">||</span>&nbsp;<span class="ident" id="7534401">csr</span><span class="op" id="7534404">.</span><span class="ident" id="7534405">EmailAddresses</span><span class="op" id="7534419">[</span><span class="num" id="7534420">0</span><span class="op" id="7534421">]</span>&nbsp;<span class="op" id="7534423">!=</span>&nbsp;<span class="string" id="7534426">&#34;gopher@golang.org&#34;</span>&nbsp;<span class="op" id="7534446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7534450">t</span><span class="op" id="7534451">.</span><span class="ident" id="7534452">Errorf</span><span class="op" id="7534458">(</span><span class="string" id="7534459">&#34;incorrect&nbsp;email&nbsp;addresses&nbsp;found:&nbsp;%v&#34;</span><span class="op" id="7534496">,</span>&nbsp;<span class="ident" id="7534498">csr</span><span class="op" id="7534501">.</span><span class="ident" id="7534502">EmailAddresses</span><span class="op" id="7534516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7534519">}</span><br>
<span class="lineno">935</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7534523">if</span>&nbsp;<span class="builtinfunc" id="7534526">len</span><span class="op" id="7534529">(</span><span class="ident" id="7534530">csr</span><span class="op" id="7534533">.</span><span class="ident" id="7534534">DNSNames</span><span class="op" id="7534542">)</span>&nbsp;<span class="op" id="7534544">!=</span>&nbsp;<span class="num" id="7534547">1</span>&nbsp;<span class="op" id="7534549">||</span>&nbsp;<span class="ident" id="7534552">csr</span><span class="op" id="7534555">.</span><span class="ident" id="7534556">DNSNames</span><span class="op" id="7534564">[</span><span class="num" id="7534565">0</span><span class="op" id="7534566">]</span>&nbsp;<span class="op" id="7534568">!=</span>&nbsp;<span class="string" id="7534571">&#34;test.example.com&#34;</span>&nbsp;<span class="op" id="7534590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7534594">t</span><span class="op" id="7534595">.</span><span class="ident" id="7534596">Errorf</span><span class="op" id="7534602">(</span><span class="string" id="7534603">&#34;incorrect&nbsp;DNS&nbsp;names&nbsp;found:&nbsp;%v&#34;</span><span class="op" id="7534634">,</span>&nbsp;<span class="ident" id="7534636">csr</span><span class="op" id="7534639">.</span><span class="ident" id="7534640">DNSNames</span><span class="op" id="7534648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7534651">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7534655">if</span>&nbsp;<span class="builtinfunc" id="7534658">len</span><span class="op" id="7534661">(</span><span class="ident" id="7534662">csr</span><span class="op" id="7534665">.</span><span class="ident" id="7534666">Subject</span><span class="op" id="7534673">.</span><span class="ident" id="7534674">Country</span><span class="op" id="7534681">)</span>&nbsp;<span class="op" id="7534683">!=</span>&nbsp;<span class="num" id="7534686">1</span>&nbsp;<span class="op" id="7534688">||</span>&nbsp;<span class="ident" id="7534691">csr</span><span class="op" id="7534694">.</span><span class="ident" id="7534695">Subject</span><span class="op" id="7534702">.</span><span class="ident" id="7534703">Country</span><span class="op" id="7534710">[</span><span class="num" id="7534711">0</span><span class="op" id="7534712">]</span>&nbsp;<span class="op" id="7534714">!=</span>&nbsp;<span class="string" id="7534717">&#34;AU&#34;</span>&nbsp;<span class="op" id="7534722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7534726">t</span><span class="op" id="7534727">.</span><span class="ident" id="7534728">Errorf</span><span class="op" id="7534734">(</span><span class="string" id="7534735">&#34;incorrect&nbsp;Subject&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="7534763">,</span>&nbsp;<span class="ident" id="7534765">csr</span><span class="op" id="7534768">.</span><span class="ident" id="7534769">Subject</span><span class="op" id="7534776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7534779">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7534783">found</span>&nbsp;<span class="op" id="7534789">:=</span>&nbsp;<span class="builtintype" id="7534792">false</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7534799">for</span>&nbsp;<span class="ident" id="7534803">_</span><span class="op" id="7534804">,</span>&nbsp;<span class="ident" id="7534806">e</span>&nbsp;<span class="op" id="7534808">:=</span>&nbsp;<span class="keyword" id="7534811">range</span>&nbsp;<span class="ident" id="7534817">csr</span><span class="op" id="7534820">.</span><span class="ident" id="7534821">Extensions</span>&nbsp;<span class="op" id="7534832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7534836">if</span>&nbsp;<span class="ident" id="7534839">e</span><span class="op" id="7534840">.</span><span class="ident" id="7534841">Id</span><span class="op" id="7534843">.</span><span class="ident" id="7534844">Equal</span><span class="op" id="7534849">(</span><span class="ident" id="7534850">oidExtensionBasicConstraints</span><span class="op" id="7534878">)</span>&nbsp;<span class="op" id="7534880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7534885">found</span>&nbsp;<span class="op" id="7534891">=</span>&nbsp;<span class="builtintype" id="7534893">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7534901">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7534909">}</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7534912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7534915">if</span>&nbsp;<span class="op" id="7534918">!</span><span class="ident" id="7534919">found</span>&nbsp;<span class="op" id="7534925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7534929">t</span><span class="op" id="7534930">.</span><span class="ident" id="7534931">Errorf</span><span class="op" id="7534937">(</span><span class="string" id="7534938">&#34;basic&nbsp;constraints&nbsp;extension&nbsp;not&nbsp;found&nbsp;in&nbsp;CSR&#34;</span><span class="op" id="7534984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7534987">}</span><br>
<span class="lineno"></span><span class="op" id="7534989">}</span><br>
<span class="lineno">955</span><br>
<span class="lineno"></span><span class="keyword" id="7534992">func</span>&nbsp;<span class="ident" id="7534997">TestMaxPathLen</span><span class="op" id="7535011">(</span><span class="ident" id="7535012">t</span>&nbsp;<span class="op" id="7535014">*</span><span class="ident" id="7535015">testing</span><span class="op" id="7535022">.</span><span class="ident" id="7535023">T</span><span class="op" id="7535024">)</span>&nbsp;<span class="op" id="7535026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7535029">block</span><span class="op" id="7535034">,</span>&nbsp;<span class="ident" id="7535036">_</span>&nbsp;<span class="op" id="7535038">:=</span>&nbsp;<span class="ident" id="7535041">pem</span><span class="op" id="7535044">.</span><span class="ident" id="7535045">Decode</span><span class="op" id="7535051">(</span><span class="op" id="7535052">[</span><span class="op" id="7535053">]</span><span class="builtintype" id="7535054">byte</span><span class="op" id="7535058">(</span><span class="ident" id="7535059">pemPrivateKey</span><span class="op" id="7535072">)</span><span class="op" id="7535073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7535076">rsaPriv</span><span class="op" id="7535083">,</span>&nbsp;<span class="ident" id="7535085">err</span>&nbsp;<span class="op" id="7535089">:=</span>&nbsp;<span class="ident" id="7535092">ParsePKCS1PrivateKey</span><span class="op" id="7535112">(</span><span class="ident" id="7535113">block</span><span class="op" id="7535118">.</span><span class="ident" id="7535119">Bytes</span><span class="op" id="7535124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7535127">if</span>&nbsp;<span class="ident" id="7535130">err</span>&nbsp;<span class="op" id="7535134">!=</span>&nbsp;<span class="builtintype" id="7535137">nil</span>&nbsp;<span class="op" id="7535141">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7535145">t</span><span class="op" id="7535146">.</span><span class="ident" id="7535147">Fatalf</span><span class="op" id="7535153">(</span><span class="string" id="7535154">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7535187">,</span>&nbsp;<span class="ident" id="7535189">err</span><span class="op" id="7535192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7535195">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7535199">template</span>&nbsp;<span class="op" id="7535208">:=</span>&nbsp;<span class="op" id="7535211">&amp;</span><span class="ident" id="7535212">Certificate</span><span class="op" id="7535223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7535227">SerialNumber</span><span class="op" id="7535239">:</span>&nbsp;<span class="ident" id="7535241">big</span><span class="op" id="7535244">.</span><span class="ident" id="7535245">NewInt</span><span class="op" id="7535251">(</span><span class="num" id="7535252">1</span><span class="op" id="7535253">)</span><span class="op" id="7535254">,</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7535258">Subject</span><span class="op" id="7535265">:</span>&nbsp;<span class="ident" id="7535267">pkix</span><span class="op" id="7535271">.</span><span class="ident" id="7535272">Name</span><span class="op" id="7535276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7535281">CommonName</span><span class="op" id="7535291">:</span>&nbsp;<span class="string" id="7535293">&#34;Σ&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="7535305">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7535309">}</span><span class="op" id="7535310">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7535314">NotBefore</span><span class="op" id="7535323">:</span>&nbsp;<span class="ident" id="7535325">time</span><span class="op" id="7535329">.</span><span class="ident" id="7535330">Unix</span><span class="op" id="7535334">(</span><span class="num" id="7535335">1000</span><span class="op" id="7535339">,</span>&nbsp;<span class="num" id="7535341">0</span><span class="op" id="7535342">)</span><span class="op" id="7535343">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7535347">NotAfter</span><span class="op" id="7535355">:</span>&nbsp;&nbsp;<span class="ident" id="7535358">time</span><span class="op" id="7535362">.</span><span class="ident" id="7535363">Unix</span><span class="op" id="7535367">(</span><span class="num" id="7535368">100000</span><span class="op" id="7535374">,</span>&nbsp;<span class="num" id="7535376">0</span><span class="op" id="7535377">)</span><span class="op" id="7535378">,</span><br>
<span class="lineno">970</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7535383">BasicConstraintsValid</span><span class="op" id="7535404">:</span>&nbsp;<span class="builtintype" id="7535406">true</span><span class="op" id="7535410">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7535414">IsCA</span><span class="op" id="7535418">:</span>&nbsp;<span class="builtintype" id="7535420">true</span><span class="op" id="7535424">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7535427">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7535431">serialiseAndParse</span>&nbsp;<span class="op" id="7535449">:=</span>&nbsp;<span class="keyword" id="7535452">func</span><span class="op" id="7535456">(</span><span class="ident" id="7535457">template</span>&nbsp;<span class="op" id="7535466">*</span><span class="ident" id="7535467">Certificate</span><span class="op" id="7535478">)</span>&nbsp;<span class="op" id="7535480">*</span><span class="ident" id="7535481">Certificate</span>&nbsp;<span class="op" id="7535493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7535497">derBytes</span><span class="op" id="7535505">,</span>&nbsp;<span class="ident" id="7535507">err</span>&nbsp;<span class="op" id="7535511">:=</span>&nbsp;<span class="ident" id="7535514">CreateCertificate</span><span class="op" id="7535531">(</span><span class="ident" id="7535532">rand</span><span class="op" id="7535536">.</span><span class="ident" id="7535537">Reader</span><span class="op" id="7535543">,</span>&nbsp;<span class="ident" id="7535545">template</span><span class="op" id="7535553">,</span>&nbsp;<span class="ident" id="7535555">template</span><span class="op" id="7535563">,</span>&nbsp;<span class="op" id="7535565">&amp;</span><span class="ident" id="7535566">rsaPriv</span><span class="op" id="7535573">.</span><span class="ident" id="7535574">PublicKey</span><span class="op" id="7535583">,</span>&nbsp;<span class="ident" id="7535585">rsaPriv</span><span class="op" id="7535592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7535596">if</span>&nbsp;<span class="ident" id="7535599">err</span>&nbsp;<span class="op" id="7535603">!=</span>&nbsp;<span class="builtintype" id="7535606">nil</span>&nbsp;<span class="op" id="7535610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7535615">t</span><span class="op" id="7535616">.</span><span class="ident" id="7535617">Fatalf</span><span class="op" id="7535623">(</span><span class="string" id="7535624">&#34;failed&nbsp;to&nbsp;create&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7535658">,</span>&nbsp;<span class="ident" id="7535660">err</span><span class="op" id="7535663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7535668">return</span>&nbsp;<span class="builtintype" id="7535675">nil</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7535681">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7535686">cert</span><span class="op" id="7535690">,</span>&nbsp;<span class="ident" id="7535692">err</span>&nbsp;<span class="op" id="7535696">:=</span>&nbsp;<span class="ident" id="7535699">ParseCertificate</span><span class="op" id="7535715">(</span><span class="ident" id="7535716">derBytes</span><span class="op" id="7535724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7535728">if</span>&nbsp;<span class="ident" id="7535731">err</span>&nbsp;<span class="op" id="7535735">!=</span>&nbsp;<span class="builtintype" id="7535738">nil</span>&nbsp;<span class="op" id="7535742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7535747">t</span><span class="op" id="7535748">.</span><span class="ident" id="7535749">Fatalf</span><span class="op" id="7535755">(</span><span class="string" id="7535756">&#34;failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7535789">,</span>&nbsp;<span class="ident" id="7535791">err</span><span class="op" id="7535794">)</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7535799">return</span>&nbsp;<span class="builtintype" id="7535806">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7535812">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7535817">return</span>&nbsp;<span class="ident" id="7535824">cert</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7535830">}</span><br>
<span class="lineno">990</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7535834">cert1</span>&nbsp;<span class="op" id="7535840">:=</span>&nbsp;<span class="ident" id="7535843">serialiseAndParse</span><span class="op" id="7535860">(</span><span class="ident" id="7535861">template</span><span class="op" id="7535869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7535872">if</span>&nbsp;<span class="ident" id="7535875">m</span>&nbsp;<span class="op" id="7535877">:=</span>&nbsp;<span class="ident" id="7535880">cert1</span><span class="op" id="7535885">.</span><span class="ident" id="7535886">MaxPathLen</span><span class="op" id="7535896">;</span>&nbsp;<span class="ident" id="7535898">m</span>&nbsp;<span class="op" id="7535900">!=</span>&nbsp;<span class="op" id="7535903">-</span><span class="num" id="7535904">1</span>&nbsp;<span class="op" id="7535906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7535910">t</span><span class="op" id="7535911">.</span><span class="ident" id="7535912">Errorf</span><span class="op" id="7535918">(</span><span class="string" id="7535919">&#34;Omitting&nbsp;MaxPathLen&nbsp;didn&#39;t&nbsp;turn&nbsp;into&nbsp;-1,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7535968">,</span>&nbsp;<span class="ident" id="7535970">m</span><span class="op" id="7535971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7535974">}</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7535977">if</span>&nbsp;<span class="ident" id="7535980">cert1</span><span class="op" id="7535985">.</span><span class="ident" id="7535986">MaxPathLenZero</span>&nbsp;<span class="op" id="7536001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7536005">t</span><span class="op" id="7536006">.</span><span class="ident" id="7536007">Errorf</span><span class="op" id="7536013">(</span><span class="string" id="7536014">&#34;Omitting&nbsp;MaxPathLen&nbsp;resulted&nbsp;in&nbsp;MaxPathLenZero&#34;</span><span class="op" id="7536062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7536065">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7536069">template</span><span class="op" id="7536077">.</span><span class="ident" id="7536078">MaxPathLen</span>&nbsp;<span class="op" id="7536089">=</span>&nbsp;<span class="num" id="7536091">1</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7536094">cert2</span>&nbsp;<span class="op" id="7536100">:=</span>&nbsp;<span class="ident" id="7536103">serialiseAndParse</span><span class="op" id="7536120">(</span><span class="ident" id="7536121">template</span><span class="op" id="7536129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7536132">if</span>&nbsp;<span class="ident" id="7536135">m</span>&nbsp;<span class="op" id="7536137">:=</span>&nbsp;<span class="ident" id="7536140">cert2</span><span class="op" id="7536145">.</span><span class="ident" id="7536146">MaxPathLen</span><span class="op" id="7536156">;</span>&nbsp;<span class="ident" id="7536158">m</span>&nbsp;<span class="op" id="7536160">!=</span>&nbsp;<span class="num" id="7536163">1</span>&nbsp;<span class="op" id="7536165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7536169">t</span><span class="op" id="7536170">.</span><span class="ident" id="7536171">Errorf</span><span class="op" id="7536177">(</span><span class="string" id="7536178">&#34;Setting&nbsp;MaxPathLen&nbsp;didn&#39;t&nbsp;work.&nbsp;Got&nbsp;%d&nbsp;but&nbsp;set&nbsp;1&#34;</span><span class="op" id="7536228">,</span>&nbsp;<span class="ident" id="7536230">m</span><span class="op" id="7536231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7536234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7536237">if</span>&nbsp;<span class="ident" id="7536240">cert2</span><span class="op" id="7536245">.</span><span class="ident" id="7536246">MaxPathLenZero</span>&nbsp;<span class="op" id="7536261">{</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7536265">t</span><span class="op" id="7536266">.</span><span class="ident" id="7536267">Errorf</span><span class="op" id="7536273">(</span><span class="string" id="7536274">&#34;Setting&nbsp;MaxPathLen&nbsp;resulted&nbsp;in&nbsp;MaxPathLenZero&#34;</span><span class="op" id="7536321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7536324">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7536328">template</span><span class="op" id="7536336">.</span><span class="ident" id="7536337">MaxPathLen</span>&nbsp;<span class="op" id="7536348">=</span>&nbsp;<span class="num" id="7536350">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7536353">template</span><span class="op" id="7536361">.</span><span class="ident" id="7536362">MaxPathLenZero</span>&nbsp;<span class="op" id="7536377">=</span>&nbsp;<span class="builtintype" id="7536379">true</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7536385">cert3</span>&nbsp;<span class="op" id="7536391">:=</span>&nbsp;<span class="ident" id="7536394">serialiseAndParse</span><span class="op" id="7536411">(</span><span class="ident" id="7536412">template</span><span class="op" id="7536420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7536423">if</span>&nbsp;<span class="ident" id="7536426">m</span>&nbsp;<span class="op" id="7536428">:=</span>&nbsp;<span class="ident" id="7536431">cert3</span><span class="op" id="7536436">.</span><span class="ident" id="7536437">MaxPathLen</span><span class="op" id="7536447">;</span>&nbsp;<span class="ident" id="7536449">m</span>&nbsp;<span class="op" id="7536451">!=</span>&nbsp;<span class="num" id="7536454">0</span>&nbsp;<span class="op" id="7536456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7536460">t</span><span class="op" id="7536461">.</span><span class="ident" id="7536462">Errorf</span><span class="op" id="7536468">(</span><span class="string" id="7536469">&#34;Setting&nbsp;MaxPathLenZero&nbsp;didn&#39;t&nbsp;work,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7536513">,</span>&nbsp;<span class="ident" id="7536515">m</span><span class="op" id="7536516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7536519">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7536522">if</span>&nbsp;<span class="op" id="7536525">!</span><span class="ident" id="7536526">cert3</span><span class="op" id="7536531">.</span><span class="ident" id="7536532">MaxPathLenZero</span>&nbsp;<span class="op" id="7536547">{</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7536551">t</span><span class="op" id="7536552">.</span><span class="ident" id="7536553">Errorf</span><span class="op" id="7536559">(</span><span class="string" id="7536560">&#34;Setting&nbsp;MaxPathLen&nbsp;to&nbsp;zero&nbsp;didn&#39;t&nbsp;result&nbsp;in&nbsp;MaxPathLenZero&#34;</span><span class="op" id="7536620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7536623">}</span><br>
<span class="lineno"></span><span class="op" id="7536625">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7536628">//&nbsp;This&nbsp;CSR&nbsp;was&nbsp;generated&nbsp;with&nbsp;OpenSSL:</span><br>
<span class="lineno">1020</span><span class="comment" id="7536668">//&nbsp;&nbsp;openssl&nbsp;req&nbsp;-out&nbsp;CSR.csr&nbsp;-new&nbsp;-newkey&nbsp;rsa:2048&nbsp;-nodes&nbsp;-keyout&nbsp;privateKey.key&nbsp;-config&nbsp;openssl.cnf</span><br>
<span class="lineno"></span><span class="comment" id="7536769">//</span><br>
<span class="lineno"></span><span class="comment" id="7536772">//&nbsp;The&nbsp;openssl.cnf&nbsp;needs&nbsp;to&nbsp;include&nbsp;this&nbsp;section:</span><br>
<span class="lineno"></span><span class="comment" id="7536822">//&nbsp;&nbsp;&nbsp;[&nbsp;v3_req&nbsp;]</span><br>
<span class="lineno"></span><span class="comment" id="7536838">//&nbsp;&nbsp;&nbsp;basicConstraints&nbsp;=&nbsp;CA:FALSE</span><br>
<span class="lineno">1025</span><span class="comment" id="7536871">//&nbsp;&nbsp;&nbsp;keyUsage&nbsp;=&nbsp;nonRepudiation,&nbsp;digitalSignature,&nbsp;keyEncipherment</span><br>
<span class="lineno"></span><span class="comment" id="7536937">//&nbsp;&nbsp;&nbsp;subjectAltName&nbsp;=&nbsp;email:gopher@golang.org,DNS:test.example.com</span><br>
<span class="lineno"></span><span class="keyword" id="7537004">const</span>&nbsp;<span class="ident" id="7537010">csrBase64</span>&nbsp;<span class="op" id="7537020">=</span>&nbsp;<span class="string" id="7537022">&#34;MIIC4zCCAcsCAQAwRTELMAkGA1UEBhMCQVUxEzARBgNVBAgMClNvbWUtU3RhdGUxITAfBgNVBAoMGEludGVybmV0IFdpZGdpdHMgUHR5IEx0ZDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAOY+MVedRg2JEnyeLcSzcsMv2VcsTfkB5+Etd6hihAh6MrGezNyASMMKuQN6YhCX1icQDiQtGsDLTtheNnSXK06tAhHjAP/hGlszRJp+5+rP2M58fDBAkUBEhskbCUWwpY14jFtVuGNJ8vF8h8IeczdolvQhX9lVai9G0EUXJMliMKdjA899H0mRs9PzHyidyrXFNiZlQXfD8Kg7gETn2Ny965iyI6ujAIYSCvam6TnxRHYH2MBKyVGvsYGbPYUQJCsgdgyajEg6ekihvQY3SzO1HSAlZAd7d1QYO4VeWJ2mY6Wu3Jpmh+AmG19S9CcHqGjd0bhuAX9cpPOKgnEmqn0CAwEAAaBZMFcGCSqGSIb3DQEJDjFKMEgwCQYDVR0TBAIwADALBgNVHQ8EBAMCBeAwLgYDVR0RBCcwJYERZ29waGVyQGdvbGFuZy5vcmeCEHRlc3QuZXhhbXBsZS5jb20wDQYJKoZIhvcNAQEFBQADggEBAC9+QpKfdabxwCWwf4IEe1cKjdXLS1ScSuw27a3kZzQiPV78WJMa6dB8dqhdH5BRwGZ/qsgLrO6ZHlNeIv2Ib41Ccq71ecHW/nXc94A1BzJ/bVdI9LZcmTUvR1/m1jCpN7UqQ0ml1u9VihK7Pe762hEYxuWDQzYEU0l15S/bXmqeq3eF1A59XT/2jwe5+NV0Wwf4UQlkTXsAQMsJ+KzrQafd8Qv2A49o048uRvmjeJDrXLawGVianZ7D5A6Fpd1rZh6XcjqBpmgLw41DRQWENOdzhy+HyphKRv1MlY8OLkNqpGMhu8DdgJVGoT16DGiickoEa7Z3UCPVNgdTkT9jq7U=&#34;</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
