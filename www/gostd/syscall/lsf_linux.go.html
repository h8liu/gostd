<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>syscall</h2>
<ul>
<li><a href="/gostd/syscall/creds_test.go.html">creds_test.go</a></li>
<li><a href="/gostd/syscall/env_unix.go.html">env_unix.go</a></li>
<li><a href="/gostd/syscall/exec_linux.go.html">exec_linux.go</a></li>
<li><a href="/gostd/syscall/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/syscall/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/syscall/flock.go.html">flock.go</a></li>
<li><a href="/gostd/syscall/lsf_linux.go.html" class="current">lsf_linux.go</a></li>
<li><a href="/gostd/syscall/mmap_unix_test.go.html">mmap_unix_test.go</a></li>
<li><a href="/gostd/syscall/netlink_linux.go.html">netlink_linux.go</a></li>
<li><a href="/gostd/syscall/race0.go.html">race0.go</a></li>
<li><a href="/gostd/syscall/sockcmsg_linux.go.html">sockcmsg_linux.go</a></li>
<li><a href="/gostd/syscall/sockcmsg_unix.go.html">sockcmsg_unix.go</a></li>
<li><a href="/gostd/syscall/str.go.html">str.go</a></li>
<li><a href="/gostd/syscall/syscall.go.html">syscall.go</a></li>
<li><a href="/gostd/syscall/syscall_linux.go.html">syscall_linux.go</a></li>
<li><a href="/gostd/syscall/syscall_linux_amd64.go.html">syscall_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/syscall_test.go.html">syscall_test.go</a></li>
<li><a href="/gostd/syscall/syscall_unix.go.html">syscall_unix.go</a></li>
<li><a href="/gostd/syscall/syscall_unix_test.go.html">syscall_unix_test.go</a></li>
<li><a href="/gostd/syscall/zerrors_linux_amd64.go.html">zerrors_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/zsyscall_linux_amd64.go.html">zsyscall_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/zsysnum_linux_amd64.go.html">zsysnum_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/ztypes_linux_amd64.go.html">ztypes_linux_amd64.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2497096">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2497152">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2497206">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2497257">//&nbsp;Linux&nbsp;socket&nbsp;filter</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2497281">package</span>&nbsp;<span class="ident" id="2497289">syscall</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2497298">import</span>&nbsp;<span class="op" id="2497305">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2497308">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="2497317">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2497320">func</span>&nbsp;<span class="ident" id="2497325">LsfStmt</span><span class="op" id="2497332">(</span><span class="ident" id="2497333">code</span><span class="op" id="2497337">,</span>&nbsp;<span class="ident" id="2497339">k</span>&nbsp;<span class="builtintype" id="2497341">int</span><span class="op" id="2497344">)</span>&nbsp;<span class="op" id="2497346">*</span><span class="ident" id="2497347"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2674802">SockFilter</a></span>&nbsp;<span class="op" id="2497358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2497361">return</span>&nbsp;<span class="op" id="2497368">&amp;</span><span class="ident" id="2497369"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2674802">SockFilter</a></span><span class="op" id="2497379">{</span><span class="ident" id="2497380"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2674823">Code</a></span><span class="op" id="2497384">:</span>&nbsp;<span class="builtintype" id="2497386">uint16</span><span class="op" id="2497392">(</span><span class="ident" id="2497393"><a href="/gostd/syscall/lsf_linux.go.html#2497333">code</a></span><span class="op" id="2497397">)</span><span class="op" id="2497398">,</span>&nbsp;<span class="ident" id="2497400"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2674860">K</a></span><span class="op" id="2497401">:</span>&nbsp;<span class="builtintype" id="2497403">uint32</span><span class="op" id="2497409">(</span><span class="ident" id="2497410"><a href="/gostd/syscall/lsf_linux.go.html#2497339">k</a></span><span class="op" id="2497411">)</span><span class="op" id="2497412">}</span><br>
<span class="lineno">15</span><span class="op" id="2497414">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2497417">func</span>&nbsp;<span class="ident" id="2497422">LsfJump</span><span class="op" id="2497429">(</span><span class="ident" id="2497430">code</span><span class="op" id="2497434">,</span>&nbsp;<span class="ident" id="2497436">k</span><span class="op" id="2497437">,</span>&nbsp;<span class="ident" id="2497439">jt</span><span class="op" id="2497441">,</span>&nbsp;<span class="ident" id="2497443">jf</span>&nbsp;<span class="builtintype" id="2497446">int</span><span class="op" id="2497449">)</span>&nbsp;<span class="op" id="2497451">*</span><span class="ident" id="2497452"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2674802">SockFilter</a></span>&nbsp;<span class="op" id="2497463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2497466">return</span>&nbsp;<span class="op" id="2497473">&amp;</span><span class="ident" id="2497474"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2674802">SockFilter</a></span><span class="op" id="2497484">{</span><span class="ident" id="2497485"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2674823">Code</a></span><span class="op" id="2497489">:</span>&nbsp;<span class="builtintype" id="2497491">uint16</span><span class="op" id="2497497">(</span><span class="ident" id="2497498"><a href="/gostd/syscall/lsf_linux.go.html#2497430">code</a></span><span class="op" id="2497502">)</span><span class="op" id="2497503">,</span>&nbsp;<span class="ident" id="2497505"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2674836">Jt</a></span><span class="op" id="2497507">:</span>&nbsp;<span class="builtintype" id="2497509">uint8</span><span class="op" id="2497514">(</span><span class="ident" id="2497515"><a href="/gostd/syscall/lsf_linux.go.html#2497439">jt</a></span><span class="op" id="2497517">)</span><span class="op" id="2497518">,</span>&nbsp;<span class="ident" id="2497520"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2674848">Jf</a></span><span class="op" id="2497522">:</span>&nbsp;<span class="builtintype" id="2497524">uint8</span><span class="op" id="2497529">(</span><span class="ident" id="2497530"><a href="/gostd/syscall/lsf_linux.go.html#2497443">jf</a></span><span class="op" id="2497532">)</span><span class="op" id="2497533">,</span>&nbsp;<span class="ident" id="2497535"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2674860">K</a></span><span class="op" id="2497536">:</span>&nbsp;<span class="builtintype" id="2497538">uint32</span><span class="op" id="2497544">(</span><span class="ident" id="2497545"><a href="/gostd/syscall/lsf_linux.go.html#2497436">k</a></span><span class="op" id="2497546">)</span><span class="op" id="2497547">}</span><br>
<span class="lineno"></span><span class="op" id="2497549">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="2497552">func</span>&nbsp;<span class="ident" id="2497557">LsfSocket</span><span class="op" id="2497566">(</span><span class="ident" id="2497567">ifindex</span><span class="op" id="2497574">,</span>&nbsp;<span class="ident" id="2497576">proto</span>&nbsp;<span class="builtintype" id="2497582">int</span><span class="op" id="2497585">)</span>&nbsp;<span class="op" id="2497587">(</span><span class="builtintype" id="2497588">int</span><span class="op" id="2497591">,</span>&nbsp;<span class="builtintype" id="2497593">error</span><span class="op" id="2497598">)</span>&nbsp;<span class="op" id="2497600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2497603">var</span>&nbsp;<span class="ident" id="2497607">lsall</span>&nbsp;<span class="ident" id="2497613"><a href="/gostd/syscall/syscall_linux.go.html#2518737">SockaddrLinklayer</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2497632">s</span><span class="op" id="2497633">,</span>&nbsp;<span class="ident" id="2497635">e</span>&nbsp;<span class="op" id="2497637">:=</span>&nbsp;<span class="ident" id="2497640"><a href="/gostd/syscall/syscall_unix.go.html#2549902">Socket</a></span><span class="op" id="2497646">(</span><span class="ident" id="2497647"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2551770">AF_PACKET</a></span><span class="op" id="2497656">,</span>&nbsp;<span class="ident" id="2497658"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2591910">SOCK_RAW</a></span><span class="op" id="2497666">,</span>&nbsp;<span class="ident" id="2497668"><a href="/gostd/syscall/lsf_linux.go.html#2497576">proto</a></span><span class="op" id="2497673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2497676">if</span>&nbsp;<span class="ident" id="2497679"><a href="/gostd/syscall/lsf_linux.go.html#2497635">e</a></span>&nbsp;<span class="op" id="2497681">!=</span>&nbsp;<span class="builtintype" id="2497684">nil</span>&nbsp;<span class="op" id="2497688">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2497692">return</span>&nbsp;<span class="num" id="2497699">0</span><span class="op" id="2497700">,</span>&nbsp;<span class="ident" id="2497702"><a href="/gostd/syscall/lsf_linux.go.html#2497635">e</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2497705">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2497708">p</span>&nbsp;<span class="op" id="2497710">:=</span>&nbsp;<span class="op" id="2497713">(</span><span class="op" id="2497714">*</span><span class="op" id="2497715">[</span><span class="num" id="2497716">2</span><span class="op" id="2497717">]</span><span class="builtintype" id="2497718">byte</span><span class="op" id="2497722">)</span><span class="op" id="2497723">(</span><span class="ident" id="2497724"><a href="/gostd/syscall/lsf_linux.go.html#2497308">unsafe</a></span><span class="op" id="2497730">.</span><span class="ident" id="2497731">Pointer</span><span class="op" id="2497738">(</span><span class="op" id="2497739">&amp;</span><span class="ident" id="2497740"><a href="/gostd/syscall/lsf_linux.go.html#2497607">lsall</a></span><span class="op" id="2497745">.</span><span class="ident" id="2497746"><a href="/gostd/syscall/syscall_linux.go.html#2518765">Protocol</a></span><span class="op" id="2497754">)</span><span class="op" id="2497755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2497758"><a href="/gostd/syscall/lsf_linux.go.html#2497708">p</a></span><span class="op" id="2497759">[</span><span class="num" id="2497760">0</span><span class="op" id="2497761">]</span>&nbsp;<span class="op" id="2497763">=</span>&nbsp;<span class="builtintype" id="2497765">byte</span><span class="op" id="2497769">(</span><span class="ident" id="2497770"><a href="/gostd/syscall/lsf_linux.go.html#2497576">proto</a></span>&nbsp;<span class="op" id="2497776">&gt;&gt;</span>&nbsp;<span class="num" id="2497779">8</span><span class="op" id="2497780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2497783"><a href="/gostd/syscall/lsf_linux.go.html#2497708">p</a></span><span class="op" id="2497784">[</span><span class="num" id="2497785">1</span><span class="op" id="2497786">]</span>&nbsp;<span class="op" id="2497788">=</span>&nbsp;<span class="builtintype" id="2497790">byte</span><span class="op" id="2497794">(</span><span class="ident" id="2497795"><a href="/gostd/syscall/lsf_linux.go.html#2497576">proto</a></span><span class="op" id="2497800">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2497803"><a href="/gostd/syscall/lsf_linux.go.html#2497607">lsall</a></span><span class="op" id="2497808">.</span><span class="ident" id="2497809"><a href="/gostd/syscall/syscall_linux.go.html#2518782">Ifindex</a></span>&nbsp;<span class="op" id="2497817">=</span>&nbsp;<span class="ident" id="2497819"><a href="/gostd/syscall/lsf_linux.go.html#2497567">ifindex</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2497828"><a href="/gostd/syscall/lsf_linux.go.html#2497635">e</a></span>&nbsp;<span class="op" id="2497830">=</span>&nbsp;<span class="ident" id="2497832"><a href="/gostd/syscall/syscall_unix.go.html#2547448">Bind</a></span><span class="op" id="2497836">(</span><span class="ident" id="2497837"><a href="/gostd/syscall/lsf_linux.go.html#2497632">s</a></span><span class="op" id="2497838">,</span>&nbsp;<span class="op" id="2497840">&amp;</span><span class="ident" id="2497841"><a href="/gostd/syscall/lsf_linux.go.html#2497607">lsall</a></span><span class="op" id="2497846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2497849">if</span>&nbsp;<span class="ident" id="2497852"><a href="/gostd/syscall/lsf_linux.go.html#2497635">e</a></span>&nbsp;<span class="op" id="2497854">!=</span>&nbsp;<span class="builtintype" id="2497857">nil</span>&nbsp;<span class="op" id="2497861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2497865"><a href="/gostd/syscall/zsyscall_linux_amd64.go.html#2616725">Close</a></span><span class="op" id="2497870">(</span><span class="ident" id="2497871"><a href="/gostd/syscall/lsf_linux.go.html#2497632">s</a></span><span class="op" id="2497872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2497876">return</span>&nbsp;<span class="num" id="2497883">0</span><span class="op" id="2497884">,</span>&nbsp;<span class="ident" id="2497886"><a href="/gostd/syscall/lsf_linux.go.html#2497635">e</a></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2497889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2497892">return</span>&nbsp;<span class="ident" id="2497899"><a href="/gostd/syscall/lsf_linux.go.html#2497632">s</a></span><span class="op" id="2497900">,</span>&nbsp;<span class="builtintype" id="2497902">nil</span><br>
<span class="lineno"></span><span class="op" id="2497906">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2497909">type</span>&nbsp;<span class="ident" id="2497914">iflags</span>&nbsp;<span class="keyword" id="2497921">struct</span>&nbsp;<span class="op" id="2497928">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2497931">name</span>&nbsp;&nbsp;<span class="op" id="2497937">[</span><span class="ident" id="2497938"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2563929">IFNAMSIZ</a></span><span class="op" id="2497946">]</span><span class="builtintype" id="2497947">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2497953">flags</span>&nbsp;<span class="builtintype" id="2497959">uint16</span><br>
<span class="lineno"></span><span class="op" id="2497966">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2497969">func</span>&nbsp;<span class="ident" id="2497974">SetLsfPromisc</span><span class="op" id="2497987">(</span><span class="ident" id="2497988">name</span>&nbsp;<span class="builtintype" id="2497993">string</span><span class="op" id="2497999">,</span>&nbsp;<span class="ident" id="2498001">m</span>&nbsp;<span class="builtintype" id="2498003">bool</span><span class="op" id="2498007">)</span>&nbsp;<span class="builtintype" id="2498009">error</span>&nbsp;<span class="op" id="2498015">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2498018">s</span><span class="op" id="2498019">,</span>&nbsp;<span class="ident" id="2498021">e</span>&nbsp;<span class="op" id="2498023">:=</span>&nbsp;<span class="ident" id="2498026"><a href="/gostd/syscall/syscall_unix.go.html#2549902">Socket</a></span><span class="op" id="2498032">(</span><span class="ident" id="2498033"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2551244">AF_INET</a></span><span class="op" id="2498040">,</span>&nbsp;<span class="ident" id="2498042"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2591788">SOCK_DGRAM</a></span><span class="op" id="2498052">,</span>&nbsp;<span class="num" id="2498054">0</span><span class="op" id="2498055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2498058">if</span>&nbsp;<span class="ident" id="2498061"><a href="/gostd/syscall/lsf_linux.go.html#2498021">e</a></span>&nbsp;<span class="op" id="2498063">!=</span>&nbsp;<span class="builtintype" id="2498066">nil</span>&nbsp;<span class="op" id="2498070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2498074">return</span>&nbsp;<span class="ident" id="2498081"><a href="/gostd/syscall/lsf_linux.go.html#2498021">e</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2498084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2498087">defer</span>&nbsp;<span class="ident" id="2498093"><a href="/gostd/syscall/zsyscall_linux_amd64.go.html#2616725">Close</a></span><span class="op" id="2498098">(</span><span class="ident" id="2498099"><a href="/gostd/syscall/lsf_linux.go.html#2498018">s</a></span><span class="op" id="2498100">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2498103">var</span>&nbsp;<span class="ident" id="2498107">ifl</span>&nbsp;<span class="ident" id="2498111"><a href="/gostd/syscall/lsf_linux.go.html#2497914">iflags</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2498119">copy</span><span class="op" id="2498123">(</span><span class="ident" id="2498124"><a href="/gostd/syscall/lsf_linux.go.html#2498107">ifl</a></span><span class="op" id="2498127">.</span><span class="ident" id="2498128"><a href="/gostd/syscall/lsf_linux.go.html#2497931">name</a></span><span class="op" id="2498132">[</span><span class="op" id="2498133">:</span><span class="op" id="2498134">]</span><span class="op" id="2498135">,</span>&nbsp;<span class="op" id="2498137">[</span><span class="op" id="2498138">]</span><span class="builtintype" id="2498139">byte</span><span class="op" id="2498143">(</span><span class="ident" id="2498144"><a href="/gostd/syscall/lsf_linux.go.html#2497988">name</a></span><span class="op" id="2498148">)</span><span class="op" id="2498149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2498152">_</span><span class="op" id="2498153">,</span>&nbsp;<span class="ident" id="2498155">_</span><span class="op" id="2498156">,</span>&nbsp;<span class="ident" id="2498158">ep</span>&nbsp;<span class="op" id="2498161">:=</span>&nbsp;<span class="ident" id="2498164"><a href="/gostd/syscall/syscall_unix.go.html#2543862">Syscall</a></span><span class="op" id="2498171">(</span><span class="ident" id="2498172"><a href="/gostd/syscall/zsysnum_linux_amd64.go.html#2656502">SYS_IOCTL</a></span><span class="op" id="2498181">,</span>&nbsp;<span class="builtintype" id="2498183">uintptr</span><span class="op" id="2498190">(</span><span class="ident" id="2498191"><a href="/gostd/syscall/lsf_linux.go.html#2498018">s</a></span><span class="op" id="2498192">)</span><span class="op" id="2498193">,</span>&nbsp;<span class="ident" id="2498195"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2590027">SIOCGIFFLAGS</a></span><span class="op" id="2498207">,</span>&nbsp;<span class="builtintype" id="2498209">uintptr</span><span class="op" id="2498216">(</span><span class="ident" id="2498217"><a href="/gostd/syscall/lsf_linux.go.html#2497308">unsafe</a></span><span class="op" id="2498223">.</span><span class="ident" id="2498224">Pointer</span><span class="op" id="2498231">(</span><span class="op" id="2498232">&amp;</span><span class="ident" id="2498233"><a href="/gostd/syscall/lsf_linux.go.html#2498107">ifl</a></span><span class="op" id="2498236">)</span><span class="op" id="2498237">)</span><span class="op" id="2498238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2498241">if</span>&nbsp;<span class="ident" id="2498244"><a href="/gostd/syscall/lsf_linux.go.html#2498158">ep</a></span>&nbsp;<span class="op" id="2498247">!=</span>&nbsp;<span class="num" id="2498250">0</span>&nbsp;<span class="op" id="2498252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2498256">return</span>&nbsp;<span class="ident" id="2498263"><a href="/gostd/syscall/syscall_unix.go.html#2545791">Errno</a></span><span class="op" id="2498268">(</span><span class="ident" id="2498269"><a href="/gostd/syscall/lsf_linux.go.html#2498158">ep</a></span><span class="op" id="2498271">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2498274">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2498277">if</span>&nbsp;<span class="ident" id="2498280"><a href="/gostd/syscall/lsf_linux.go.html#2498001">m</a></span>&nbsp;<span class="op" id="2498282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2498286"><a href="/gostd/syscall/lsf_linux.go.html#2498107">ifl</a></span><span class="op" id="2498289">.</span><span class="ident" id="2498290"><a href="/gostd/syscall/lsf_linux.go.html#2497953">flags</a></span>&nbsp;<span class="op" id="2498296">|=</span>&nbsp;<span class="builtintype" id="2498299">uint16</span><span class="op" id="2498305">(</span><span class="ident" id="2498306"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2563598">IFF_PROMISC</a></span><span class="op" id="2498317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2498320">}</span>&nbsp;<span class="keyword" id="2498322">else</span>&nbsp;<span class="op" id="2498327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2498331"><a href="/gostd/syscall/lsf_linux.go.html#2498107">ifl</a></span><span class="op" id="2498334">.</span><span class="ident" id="2498335"><a href="/gostd/syscall/lsf_linux.go.html#2497953">flags</a></span>&nbsp;<span class="op" id="2498341">&amp;=</span>&nbsp;<span class="op" id="2498344">^</span><span class="builtintype" id="2498345">uint16</span><span class="op" id="2498351">(</span><span class="ident" id="2498352"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2563598">IFF_PROMISC</a></span><span class="op" id="2498363">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2498366">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2498369">_</span><span class="op" id="2498370">,</span>&nbsp;<span class="ident" id="2498372">_</span><span class="op" id="2498373">,</span>&nbsp;<span class="ident" id="2498375"><a href="/gostd/syscall/lsf_linux.go.html#2498158">ep</a></span>&nbsp;<span class="op" id="2498378">=</span>&nbsp;<span class="ident" id="2498380"><a href="/gostd/syscall/syscall_unix.go.html#2543862">Syscall</a></span><span class="op" id="2498387">(</span><span class="ident" id="2498388"><a href="/gostd/syscall/zsysnum_linux_amd64.go.html#2656502">SYS_IOCTL</a></span><span class="op" id="2498397">,</span>&nbsp;<span class="builtintype" id="2498399">uintptr</span><span class="op" id="2498406">(</span><span class="ident" id="2498407"><a href="/gostd/syscall/lsf_linux.go.html#2498018">s</a></span><span class="op" id="2498408">)</span><span class="op" id="2498409">,</span>&nbsp;<span class="ident" id="2498411"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2591059">SIOCSIFFLAGS</a></span><span class="op" id="2498423">,</span>&nbsp;<span class="builtintype" id="2498425">uintptr</span><span class="op" id="2498432">(</span><span class="ident" id="2498433"><a href="/gostd/syscall/lsf_linux.go.html#2497308">unsafe</a></span><span class="op" id="2498439">.</span><span class="ident" id="2498440">Pointer</span><span class="op" id="2498447">(</span><span class="op" id="2498448">&amp;</span><span class="ident" id="2498449"><a href="/gostd/syscall/lsf_linux.go.html#2498107">ifl</a></span><span class="op" id="2498452">)</span><span class="op" id="2498453">)</span><span class="op" id="2498454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2498457">if</span>&nbsp;<span class="ident" id="2498460"><a href="/gostd/syscall/lsf_linux.go.html#2498158">ep</a></span>&nbsp;<span class="op" id="2498463">!=</span>&nbsp;<span class="num" id="2498466">0</span>&nbsp;<span class="op" id="2498468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2498472">return</span>&nbsp;<span class="ident" id="2498479"><a href="/gostd/syscall/syscall_unix.go.html#2545791">Errno</a></span><span class="op" id="2498484">(</span><span class="ident" id="2498485"><a href="/gostd/syscall/lsf_linux.go.html#2498158">ep</a></span><span class="op" id="2498487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2498490">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2498493">return</span>&nbsp;<span class="builtintype" id="2498500">nil</span><br>
<span class="lineno"></span><span class="op" id="2498504">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2498507">func</span>&nbsp;<span class="ident" id="2498512">AttachLsf</span><span class="op" id="2498521">(</span><span class="ident" id="2498522">fd</span>&nbsp;<span class="builtintype" id="2498525">int</span><span class="op" id="2498528">,</span>&nbsp;<span class="ident" id="2498530">i</span>&nbsp;<span class="op" id="2498532">[</span><span class="op" id="2498533">]</span><span class="ident" id="2498534"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2674802">SockFilter</a></span><span class="op" id="2498544">)</span>&nbsp;<span class="builtintype" id="2498546">error</span>&nbsp;<span class="op" id="2498552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2498555">var</span>&nbsp;<span class="ident" id="2498559">p</span>&nbsp;<span class="ident" id="2498561"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2674880">SockFprog</a></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2498572"><a href="/gostd/syscall/lsf_linux.go.html#2498559">p</a></span><span class="op" id="2498573">.</span><span class="ident" id="2498574"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2674900">Len</a></span>&nbsp;<span class="op" id="2498578">=</span>&nbsp;<span class="builtintype" id="2498580">uint16</span><span class="op" id="2498586">(</span><span class="builtinfunc" id="2498587">len</span><span class="op" id="2498590">(</span><span class="ident" id="2498591"><a href="/gostd/syscall/lsf_linux.go.html#2498530">i</a></span><span class="op" id="2498592">)</span><span class="op" id="2498593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2498596"><a href="/gostd/syscall/lsf_linux.go.html#2498559">p</a></span><span class="op" id="2498597">.</span><span class="ident" id="2498598"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2674937">Filter</a></span>&nbsp;<span class="op" id="2498605">=</span>&nbsp;<span class="op" id="2498607">(</span><span class="op" id="2498608">*</span><span class="ident" id="2498609"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2674802">SockFilter</a></span><span class="op" id="2498619">)</span><span class="op" id="2498620">(</span><span class="ident" id="2498621"><a href="/gostd/syscall/lsf_linux.go.html#2497308">unsafe</a></span><span class="op" id="2498627">.</span><span class="ident" id="2498628">Pointer</span><span class="op" id="2498635">(</span><span class="op" id="2498636">&amp;</span><span class="ident" id="2498637"><a href="/gostd/syscall/lsf_linux.go.html#2498530">i</a></span><span class="op" id="2498638">[</span><span class="num" id="2498639">0</span><span class="op" id="2498640">]</span><span class="op" id="2498641">)</span><span class="op" id="2498642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2498645">return</span>&nbsp;<span class="ident" id="2498652"><a href="/gostd/syscall/zsyscall_linux_amd64.go.html#2652573">setsockopt</a></span><span class="op" id="2498662">(</span><span class="ident" id="2498663"><a href="/gostd/syscall/lsf_linux.go.html#2498522">fd</a></span><span class="op" id="2498665">,</span>&nbsp;<span class="ident" id="2498667"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2592443">SOL_SOCKET</a></span><span class="op" id="2498677">,</span>&nbsp;<span class="ident" id="2498679"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2592647">SO_ATTACH_FILTER</a></span><span class="op" id="2498695">,</span>&nbsp;<span class="ident" id="2498697"><a href="/gostd/syscall/lsf_linux.go.html#2497308">unsafe</a></span><span class="op" id="2498703">.</span><span class="ident" id="2498704">Pointer</span><span class="op" id="2498711">(</span><span class="op" id="2498712">&amp;</span><span class="ident" id="2498713"><a href="/gostd/syscall/lsf_linux.go.html#2498559">p</a></span><span class="op" id="2498714">)</span><span class="op" id="2498715">,</span>&nbsp;<span class="ident" id="2498717"><a href="/gostd/syscall/lsf_linux.go.html#2497308">unsafe</a></span><span class="op" id="2498723">.</span><span class="ident" id="2498724">Sizeof</span><span class="op" id="2498730">(</span><span class="ident" id="2498731"><a href="/gostd/syscall/lsf_linux.go.html#2498559">p</a></span><span class="op" id="2498732">)</span><span class="op" id="2498733">)</span><br>
<span class="lineno"></span><span class="op" id="2498735">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="2498738">func</span>&nbsp;<span class="ident" id="2498743">DetachLsf</span><span class="op" id="2498752">(</span><span class="ident" id="2498753">fd</span>&nbsp;<span class="builtintype" id="2498756">int</span><span class="op" id="2498759">)</span>&nbsp;<span class="builtintype" id="2498761">error</span>&nbsp;<span class="op" id="2498767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2498770">var</span>&nbsp;<span class="ident" id="2498774">dummy</span>&nbsp;<span class="builtintype" id="2498780">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2498785">return</span>&nbsp;<span class="ident" id="2498792"><a href="/gostd/syscall/zsyscall_linux_amd64.go.html#2652573">setsockopt</a></span><span class="op" id="2498802">(</span><span class="ident" id="2498803"><a href="/gostd/syscall/lsf_linux.go.html#2498753">fd</a></span><span class="op" id="2498805">,</span>&nbsp;<span class="ident" id="2498807"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2592443">SOL_SOCKET</a></span><span class="op" id="2498817">,</span>&nbsp;<span class="ident" id="2498819"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2592849">SO_DETACH_FILTER</a></span><span class="op" id="2498835">,</span>&nbsp;<span class="ident" id="2498837"><a href="/gostd/syscall/lsf_linux.go.html#2497308">unsafe</a></span><span class="op" id="2498843">.</span><span class="ident" id="2498844">Pointer</span><span class="op" id="2498851">(</span><span class="op" id="2498852">&amp;</span><span class="ident" id="2498853"><a href="/gostd/syscall/lsf_linux.go.html#2498774">dummy</a></span><span class="op" id="2498858">)</span><span class="op" id="2498859">,</span>&nbsp;<span class="ident" id="2498861"><a href="/gostd/syscall/lsf_linux.go.html#2497308">unsafe</a></span><span class="op" id="2498867">.</span><span class="ident" id="2498868">Sizeof</span><span class="op" id="2498874">(</span><span class="ident" id="2498875"><a href="/gostd/syscall/lsf_linux.go.html#2498774">dummy</a></span><span class="op" id="2498880">)</span><span class="op" id="2498881">)</span><br>
<span class="lineno"></span><span class="op" id="2498883">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
