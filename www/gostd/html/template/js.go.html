<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>html/template</h2>
<ul>
<li><a href="/gostd/html/template/attr.go.html">attr.go</a></li>
<li><a href="/gostd/html/template/clone_test.go.html">clone_test.go</a></li>
<li><a href="/gostd/html/template/content.go.html">content.go</a></li>
<li><a href="/gostd/html/template/content_test.go.html">content_test.go</a></li>
<li><a href="/gostd/html/template/context.go.html">context.go</a></li>
<li><a href="/gostd/html/template/css.go.html">css.go</a></li>
<li><a href="/gostd/html/template/css_test.go.html">css_test.go</a></li>
<li><a href="/gostd/html/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/html/template/error.go.html">error.go</a></li>
<li><a href="/gostd/html/template/escape.go.html">escape.go</a></li>
<li><a href="/gostd/html/template/escape_test.go.html">escape_test.go</a></li>
<li><a href="/gostd/html/template/html.go.html">html.go</a></li>
<li><a href="/gostd/html/template/html_test.go.html">html_test.go</a></li>
<li><a href="/gostd/html/template/js.go.html" class="current">js.go</a></li>
<li><a href="/gostd/html/template/js_test.go.html">js_test.go</a></li>
<li><a href="/gostd/html/template/template.go.html">template.go</a></li>
<li><a href="/gostd/html/template/transition.go.html">transition.go</a></li>
<li><a href="/gostd/html/template/url.go.html">url.go</a></li>
<li><a href="/gostd/html/template/url_test.go.html">url_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4935984">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4936039">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4936093">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4936144">package</span>&nbsp;<span class="ident" id="4936152">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4936162">import</span>&nbsp;<span class="op" id="4936169">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4936172">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4936181">&#34;encoding/json&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4936198">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4936205">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4936216">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4936227">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="4936242">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="4936245">//&nbsp;nextJSCtx&nbsp;returns&nbsp;the&nbsp;context&nbsp;that&nbsp;determines&nbsp;whether&nbsp;a&nbsp;slash&nbsp;after&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4936320">//&nbsp;given&nbsp;run&nbsp;of&nbsp;tokens&nbsp;starts&nbsp;a&nbsp;regular&nbsp;expression&nbsp;instead&nbsp;of&nbsp;a&nbsp;division</span><br>
<span class="lineno"></span><span class="comment" id="4936393">//&nbsp;operator:&nbsp;/&nbsp;or&nbsp;/=.</span><br>
<span class="lineno"></span><span class="comment" id="4936415">//</span><br>
<span class="lineno">20</span><span class="comment" id="4936418">//&nbsp;This&nbsp;assumes&nbsp;that&nbsp;the&nbsp;token&nbsp;run&nbsp;does&nbsp;not&nbsp;include&nbsp;any&nbsp;string&nbsp;tokens,&nbsp;comment</span><br>
<span class="lineno"></span><span class="comment" id="4936497">//&nbsp;tokens,&nbsp;regular&nbsp;expression&nbsp;literal&nbsp;tokens,&nbsp;or&nbsp;division&nbsp;operators.</span><br>
<span class="lineno"></span><span class="comment" id="4936566">//</span><br>
<span class="lineno"></span><span class="comment" id="4936569">//&nbsp;This&nbsp;fails&nbsp;on&nbsp;some&nbsp;valid&nbsp;but&nbsp;nonsensical&nbsp;JavaScript&nbsp;programs&nbsp;like</span><br>
<span class="lineno"></span><span class="comment" id="4936638">//&nbsp;&#34;x&nbsp;=&nbsp;++/foo/i&#34;&nbsp;which&nbsp;is&nbsp;quite&nbsp;different&nbsp;than&nbsp;&#34;x++/foo/i&#34;,&nbsp;but&nbsp;is&nbsp;not&nbsp;known&nbsp;to</span><br>
<span class="lineno">25</span><span class="comment" id="4936719">//&nbsp;fail&nbsp;on&nbsp;any&nbsp;known&nbsp;useful&nbsp;programs.&nbsp;It&nbsp;is&nbsp;based&nbsp;on&nbsp;the&nbsp;draft</span><br>
<span class="lineno"></span><span class="comment" id="4936782">//&nbsp;JavaScript&nbsp;2.0&nbsp;lexical&nbsp;grammar&nbsp;and&nbsp;requires&nbsp;one&nbsp;token&nbsp;of&nbsp;lookbehind:</span><br>
<span class="lineno"></span><span class="comment" id="4936854">//&nbsp;http://www.mozilla.org/js/language/js20-2000-07/rationale/syntax.html</span><br>
<span class="lineno"></span><span class="keyword" id="4936927">func</span>&nbsp;<span class="ident" id="4936932">nextJSCtx</span><span class="op" id="4936941">(</span><span class="ident" id="4936942">s</span>&nbsp;<span class="op" id="4936944">[</span><span class="op" id="4936945">]</span><span class="builtintype" id="4936946">byte</span><span class="op" id="4936950">,</span>&nbsp;<span class="ident" id="4936952">preceding</span>&nbsp;<span class="ident" id="4936962"><a href="/gostd/html/template/context.go.html#4880324">jsCtx</a></span><span class="op" id="4936967">)</span>&nbsp;<span class="ident" id="4936969"><a href="/gostd/html/template/context.go.html#4880324">jsCtx</a></span>&nbsp;<span class="op" id="4936975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4936978"><a href="/gostd/html/template/js.go.html#4936942">s</a></span>&nbsp;<span class="op" id="4936980">=</span>&nbsp;<span class="ident" id="4936982"><a href="/gostd/html/template/js.go.html#4936172">bytes</a></span><span class="op" id="4936987">.</span><span class="ident" id="4936988"><a href="/gostd/bytes/bytes.go.html#1411590">TrimRight</a></span><span class="op" id="4936997">(</span><span class="ident" id="4936998"><a href="/gostd/html/template/js.go.html#4936942">s</a></span><span class="op" id="4936999">,</span>&nbsp;<span class="string" id="4937001">&#34;\t\n\f\r&nbsp;\u2028\u2029&#34;</span><span class="op" id="4937024">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4937027">if</span>&nbsp;<span class="builtinfunc" id="4937030">len</span><span class="op" id="4937033">(</span><span class="ident" id="4937034"><a href="/gostd/html/template/js.go.html#4936942">s</a></span><span class="op" id="4937035">)</span>&nbsp;<span class="op" id="4937037">==</span>&nbsp;<span class="num" id="4937040">0</span>&nbsp;<span class="op" id="4937042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4937046">return</span>&nbsp;<span class="ident" id="4937053"><a href="/gostd/html/template/js.go.html#4936952">preceding</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4937064">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4937068">//&nbsp;All&nbsp;cases&nbsp;below&nbsp;are&nbsp;in&nbsp;the&nbsp;single-byte&nbsp;UTF-8&nbsp;group.</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4937124">switch</span>&nbsp;<span class="ident" id="4937131">c</span><span class="op" id="4937132">,</span>&nbsp;<span class="ident" id="4937134">n</span>&nbsp;<span class="op" id="4937136">:=</span>&nbsp;<span class="ident" id="4937139"><a href="/gostd/html/template/js.go.html#4936942">s</a></span><span class="op" id="4937140">[</span><span class="builtinfunc" id="4937141">len</span><span class="op" id="4937144">(</span><span class="ident" id="4937145"><a href="/gostd/html/template/js.go.html#4936942">s</a></span><span class="op" id="4937146">)</span><span class="op" id="4937147">-</span><span class="num" id="4937148">1</span><span class="op" id="4937149">]</span><span class="op" id="4937150">,</span>&nbsp;<span class="builtinfunc" id="4937152">len</span><span class="op" id="4937155">(</span><span class="ident" id="4937156"><a href="/gostd/html/template/js.go.html#4936942">s</a></span><span class="op" id="4937157">)</span><span class="op" id="4937158">;</span>&nbsp;<span class="ident" id="4937160"><a href="/gostd/html/template/js.go.html#4937131">c</a></span>&nbsp;<span class="op" id="4937162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4937165">case</span>&nbsp;<span class="string" id="4937170">&#39;+&#39;</span><span class="op" id="4937173">,</span>&nbsp;<span class="string" id="4937175">&#39;-&#39;</span><span class="op" id="4937178">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4937182">//&nbsp;++&nbsp;and&nbsp;--&nbsp;are&nbsp;not&nbsp;regexp&nbsp;preceders,&nbsp;but&nbsp;+&nbsp;and&nbsp;-&nbsp;are&nbsp;whether</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4937247">//&nbsp;they&nbsp;are&nbsp;used&nbsp;as&nbsp;infix&nbsp;or&nbsp;prefix&nbsp;operators.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4937296">start</span>&nbsp;<span class="op" id="4937302">:=</span>&nbsp;<span class="ident" id="4937305"><a href="/gostd/html/template/js.go.html#4937134">n</a></span>&nbsp;<span class="op" id="4937307">-</span>&nbsp;<span class="num" id="4937309">1</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4937313">//&nbsp;Count&nbsp;the&nbsp;number&nbsp;of&nbsp;adjacent&nbsp;dashes&nbsp;or&nbsp;pluses.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4937365">for</span>&nbsp;<span class="ident" id="4937369"><a href="/gostd/html/template/js.go.html#4937296">start</a></span>&nbsp;<span class="op" id="4937375">&gt;</span>&nbsp;<span class="num" id="4937377">0</span>&nbsp;<span class="op" id="4937379">&amp;&amp;</span>&nbsp;<span class="ident" id="4937382"><a href="/gostd/html/template/js.go.html#4936942">s</a></span><span class="op" id="4937383">[</span><span class="ident" id="4937384"><a href="/gostd/html/template/js.go.html#4937296">start</a></span><span class="op" id="4937389">-</span><span class="num" id="4937390">1</span><span class="op" id="4937391">]</span>&nbsp;<span class="op" id="4937393">==</span>&nbsp;<span class="ident" id="4937396"><a href="/gostd/html/template/js.go.html#4937131">c</a></span>&nbsp;<span class="op" id="4937398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4937403"><a href="/gostd/html/template/js.go.html#4937296">start</a></span><span class="op" id="4937408">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4937413">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4937417">if</span>&nbsp;<span class="op" id="4937420">(</span><span class="ident" id="4937421"><a href="/gostd/html/template/js.go.html#4937134">n</a></span><span class="op" id="4937422">-</span><span class="ident" id="4937423"><a href="/gostd/html/template/js.go.html#4937296">start</a></span><span class="op" id="4937428">)</span><span class="op" id="4937429">&amp;</span><span class="num" id="4937430">1</span>&nbsp;<span class="op" id="4937432">==</span>&nbsp;<span class="num" id="4937435">1</span>&nbsp;<span class="op" id="4937437">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4937442">//&nbsp;Reached&nbsp;for&nbsp;trailing&nbsp;minus&nbsp;signs&nbsp;since&nbsp;&#34;---&#34;&nbsp;is&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4937500">//&nbsp;same&nbsp;as&nbsp;&#34;--&nbsp;-&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4937522">return</span>&nbsp;<span class="ident" id="4937529"><a href="/gostd/html/template/context.go.html#4880411">jsCtxRegexp</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4937543">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4937547">return</span>&nbsp;<span class="ident" id="4937554"><a href="/gostd/html/template/context.go.html#4880504">jsCtxDivOp</a></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4937566">case</span>&nbsp;<span class="string" id="4937571">&#39;.&#39;</span><span class="op" id="4937574">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4937578">//&nbsp;Handle&nbsp;&#34;42.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4937596">if</span>&nbsp;<span class="ident" id="4937599"><a href="/gostd/html/template/js.go.html#4937134">n</a></span>&nbsp;<span class="op" id="4937601">!=</span>&nbsp;<span class="num" id="4937604">1</span>&nbsp;<span class="op" id="4937606">&amp;&amp;</span>&nbsp;<span class="string" id="4937609">&#39;0&#39;</span>&nbsp;<span class="op" id="4937613">&lt;=</span>&nbsp;<span class="ident" id="4937616"><a href="/gostd/html/template/js.go.html#4936942">s</a></span><span class="op" id="4937617">[</span><span class="ident" id="4937618"><a href="/gostd/html/template/js.go.html#4937134">n</a></span><span class="op" id="4937619">-</span><span class="num" id="4937620">2</span><span class="op" id="4937621">]</span>&nbsp;<span class="op" id="4937623">&amp;&amp;</span>&nbsp;<span class="ident" id="4937626"><a href="/gostd/html/template/js.go.html#4936942">s</a></span><span class="op" id="4937627">[</span><span class="ident" id="4937628"><a href="/gostd/html/template/js.go.html#4937134">n</a></span><span class="op" id="4937629">-</span><span class="num" id="4937630">2</span><span class="op" id="4937631">]</span>&nbsp;<span class="op" id="4937633">&lt;=</span>&nbsp;<span class="string" id="4937636">&#39;9&#39;</span>&nbsp;<span class="op" id="4937640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4937645">return</span>&nbsp;<span class="ident" id="4937652"><a href="/gostd/html/template/context.go.html#4880504">jsCtxDivOp</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4937665">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4937669">return</span>&nbsp;<span class="ident" id="4937676"><a href="/gostd/html/template/context.go.html#4880411">jsCtxRegexp</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4937689">//&nbsp;Suffixes&nbsp;for&nbsp;all&nbsp;punctuators&nbsp;from&nbsp;section&nbsp;7.7&nbsp;of&nbsp;the&nbsp;language&nbsp;spec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4937760">//&nbsp;that&nbsp;only&nbsp;end&nbsp;binary&nbsp;operators&nbsp;not&nbsp;handled&nbsp;above.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4937814">case</span>&nbsp;<span class="string" id="4937819">&#39;,&#39;</span><span class="op" id="4937822">,</span>&nbsp;<span class="string" id="4937824">&#39;&lt;&#39;</span><span class="op" id="4937827">,</span>&nbsp;<span class="string" id="4937829">&#39;&gt;&#39;</span><span class="op" id="4937832">,</span>&nbsp;<span class="string" id="4937834">&#39;=&#39;</span><span class="op" id="4937837">,</span>&nbsp;<span class="string" id="4937839">&#39;*&#39;</span><span class="op" id="4937842">,</span>&nbsp;<span class="string" id="4937844">&#39;%&#39;</span><span class="op" id="4937847">,</span>&nbsp;<span class="string" id="4937849">&#39;&amp;&#39;</span><span class="op" id="4937852">,</span>&nbsp;<span class="string" id="4937854">&#39;|&#39;</span><span class="op" id="4937857">,</span>&nbsp;<span class="string" id="4937859">&#39;^&#39;</span><span class="op" id="4937862">,</span>&nbsp;<span class="string" id="4937864">&#39;?&#39;</span><span class="op" id="4937867">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4937871">return</span>&nbsp;<span class="ident" id="4937878"><a href="/gostd/html/template/context.go.html#4880411">jsCtxRegexp</a></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4937891">//&nbsp;Suffixes&nbsp;for&nbsp;all&nbsp;punctuators&nbsp;from&nbsp;section&nbsp;7.7&nbsp;of&nbsp;the&nbsp;language&nbsp;spec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4937962">//&nbsp;that&nbsp;are&nbsp;prefix&nbsp;operators&nbsp;not&nbsp;handled&nbsp;above.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4938011">case</span>&nbsp;<span class="string" id="4938016">&#39;!&#39;</span><span class="op" id="4938019">,</span>&nbsp;<span class="string" id="4938021">&#39;~&#39;</span><span class="op" id="4938024">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4938028">return</span>&nbsp;<span class="ident" id="4938035"><a href="/gostd/html/template/context.go.html#4880411">jsCtxRegexp</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4938048">//&nbsp;Matches&nbsp;all&nbsp;the&nbsp;punctuators&nbsp;from&nbsp;section&nbsp;7.7&nbsp;of&nbsp;the&nbsp;language&nbsp;spec</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4938118">//&nbsp;that&nbsp;are&nbsp;open&nbsp;brackets&nbsp;not&nbsp;handled&nbsp;above.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4938164">case</span>&nbsp;<span class="string" id="4938169">&#39;(&#39;</span><span class="op" id="4938172">,</span>&nbsp;<span class="string" id="4938174">&#39;[&#39;</span><span class="op" id="4938177">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4938181">return</span>&nbsp;<span class="ident" id="4938188"><a href="/gostd/html/template/context.go.html#4880411">jsCtxRegexp</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4938201">//&nbsp;Matches&nbsp;all&nbsp;the&nbsp;punctuators&nbsp;from&nbsp;section&nbsp;7.7&nbsp;of&nbsp;the&nbsp;language&nbsp;spec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4938271">//&nbsp;that&nbsp;precede&nbsp;expression&nbsp;starts.</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4938307">case</span>&nbsp;<span class="string" id="4938312">&#39;:&#39;</span><span class="op" id="4938315">,</span>&nbsp;<span class="string" id="4938317">&#39;;&#39;</span><span class="op" id="4938320">,</span>&nbsp;<span class="string" id="4938322">&#39;{&#39;</span><span class="op" id="4938325">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4938329">return</span>&nbsp;<span class="ident" id="4938336"><a href="/gostd/html/template/context.go.html#4880411">jsCtxRegexp</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4938349">//&nbsp;CAVEAT:&nbsp;the&nbsp;close&nbsp;punctuators&nbsp;(&#39;}&#39;,&nbsp;&#39;]&#39;,&nbsp;&#39;)&#39;)&nbsp;precede&nbsp;div&nbsp;ops&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4938419">//&nbsp;are&nbsp;handled&nbsp;in&nbsp;the&nbsp;default&nbsp;except&nbsp;for&nbsp;&#39;}&#39;&nbsp;which&nbsp;can&nbsp;precede&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4938485">//&nbsp;division&nbsp;op&nbsp;as&nbsp;in</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4938507">//&nbsp;&nbsp;&nbsp;&nbsp;({&nbsp;valueOf:&nbsp;function&nbsp;()&nbsp;{&nbsp;return&nbsp;42&nbsp;}&nbsp;}&nbsp;/&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4938558">//&nbsp;which&nbsp;is&nbsp;valid,&nbsp;but,&nbsp;in&nbsp;practice,&nbsp;developers&nbsp;don&#39;t&nbsp;divide&nbsp;object</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4938627">//&nbsp;literals,&nbsp;so&nbsp;our&nbsp;heuristic&nbsp;works&nbsp;well&nbsp;for&nbsp;code&nbsp;like</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4938683">//&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;()&nbsp;{&nbsp;...&nbsp;}&nbsp;&nbsp;/foo/.test(x)&nbsp;&amp;&amp;&nbsp;sideEffect();</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4938742">//&nbsp;The&nbsp;&#39;)&#39;&nbsp;punctuator&nbsp;can&nbsp;precede&nbsp;a&nbsp;regular&nbsp;expression&nbsp;as&nbsp;in</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4938804">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(b)&nbsp;/foo/.test(x)&nbsp;&amp;&amp;&nbsp;...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4938840">//&nbsp;but&nbsp;this&nbsp;is&nbsp;much&nbsp;less&nbsp;likely&nbsp;than</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4938878">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(a&nbsp;+&nbsp;b)&nbsp;/&nbsp;c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4938898">case</span>&nbsp;<span class="string" id="4938903">&#39;}&#39;</span><span class="op" id="4938906">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4938910">return</span>&nbsp;<span class="ident" id="4938917"><a href="/gostd/html/template/context.go.html#4880411">jsCtxRegexp</a></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4938930">default</span><span class="op" id="4938937">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4938941">//&nbsp;Look&nbsp;for&nbsp;an&nbsp;IdentifierName&nbsp;and&nbsp;see&nbsp;if&nbsp;it&nbsp;is&nbsp;a&nbsp;keyword&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4939005">//&nbsp;can&nbsp;precede&nbsp;a&nbsp;regular&nbsp;expression.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4939044">j</span>&nbsp;<span class="op" id="4939046">:=</span>&nbsp;<span class="ident" id="4939049"><a href="/gostd/html/template/js.go.html#4937134">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4939053">for</span>&nbsp;<span class="ident" id="4939057"><a href="/gostd/html/template/js.go.html#4939044">j</a></span>&nbsp;<span class="op" id="4939059">&gt;</span>&nbsp;<span class="num" id="4939061">0</span>&nbsp;<span class="op" id="4939063">&amp;&amp;</span>&nbsp;<span class="ident" id="4939066"><a href="/gostd/html/template/js.go.html#4945978">isJSIdentPart</a></span><span class="op" id="4939079">(</span><span class="builtintype" id="4939080">rune</span><span class="op" id="4939084">(</span><span class="ident" id="4939085"><a href="/gostd/html/template/js.go.html#4936942">s</a></span><span class="op" id="4939086">[</span><span class="ident" id="4939087"><a href="/gostd/html/template/js.go.html#4939044">j</a></span><span class="op" id="4939088">-</span><span class="num" id="4939089">1</span><span class="op" id="4939090">]</span><span class="op" id="4939091">)</span><span class="op" id="4939092">)</span>&nbsp;<span class="op" id="4939094">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4939099"><a href="/gostd/html/template/js.go.html#4939044">j</a></span><span class="op" id="4939100">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4939105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4939109">if</span>&nbsp;<span class="ident" id="4939112"><a href="/gostd/html/template/js.go.html#4939456">regexpPrecederKeywords</a></span><span class="op" id="4939134">[</span><span class="builtintype" id="4939135">string</span><span class="op" id="4939141">(</span><span class="ident" id="4939142"><a href="/gostd/html/template/js.go.html#4936942">s</a></span><span class="op" id="4939143">[</span><span class="ident" id="4939144"><a href="/gostd/html/template/js.go.html#4939044">j</a></span><span class="op" id="4939145">:</span><span class="op" id="4939146">]</span><span class="op" id="4939147">)</span><span class="op" id="4939148">]</span>&nbsp;<span class="op" id="4939150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4939155">return</span>&nbsp;<span class="ident" id="4939162"><a href="/gostd/html/template/context.go.html#4880411">jsCtxRegexp</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4939176">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4939179">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4939182">//&nbsp;Otherwise&nbsp;is&nbsp;a&nbsp;punctuator&nbsp;not&nbsp;listed&nbsp;above,&nbsp;or</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4939233">//&nbsp;a&nbsp;string&nbsp;which&nbsp;precedes&nbsp;a&nbsp;div&nbsp;op,&nbsp;or&nbsp;an&nbsp;identifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4939288">//&nbsp;which&nbsp;precedes&nbsp;a&nbsp;div&nbsp;op.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4939317">return</span>&nbsp;<span class="ident" id="4939324"><a href="/gostd/html/template/context.go.html#4880504">jsCtxDivOp</a></span><br>
<span class="lineno">100</span><span class="op" id="4939335">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4939338">//&nbsp;regexpPrecederKeywords&nbsp;is&nbsp;a&nbsp;set&nbsp;of&nbsp;reserved&nbsp;JS&nbsp;keywords&nbsp;that&nbsp;can&nbsp;precede&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4939416">//&nbsp;regular&nbsp;expression&nbsp;in&nbsp;JS&nbsp;source.</span><br>
<span class="lineno"></span><span class="keyword" id="4939452">var</span>&nbsp;<span class="ident" id="4939456">regexpPrecederKeywords</span>&nbsp;<span class="op" id="4939479">=</span>&nbsp;<span class="keyword" id="4939481">map</span><span class="op" id="4939484">[</span><span class="builtintype" id="4939485">string</span><span class="op" id="4939491">]</span><span class="builtintype" id="4939492">bool</span><span class="op" id="4939496">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4939499">&#34;break&#34;</span><span class="op" id="4939506">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4939513">true</span><span class="op" id="4939517">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4939520">&#34;case&#34;</span><span class="op" id="4939526">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4939534">true</span><span class="op" id="4939538">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4939541">&#34;continue&#34;</span><span class="op" id="4939551">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4939555">true</span><span class="op" id="4939559">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4939562">&#34;delete&#34;</span><span class="op" id="4939570">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4939576">true</span><span class="op" id="4939580">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4939583">&#34;do&#34;</span><span class="op" id="4939587">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4939597">true</span><span class="op" id="4939601">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4939604">&#34;else&#34;</span><span class="op" id="4939610">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4939618">true</span><span class="op" id="4939622">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4939625">&#34;finally&#34;</span><span class="op" id="4939634">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4939639">true</span><span class="op" id="4939643">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4939646">&#34;in&#34;</span><span class="op" id="4939650">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4939660">true</span><span class="op" id="4939664">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4939667">&#34;instanceof&#34;</span><span class="op" id="4939679">:</span>&nbsp;<span class="builtintype" id="4939681">true</span><span class="op" id="4939685">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4939688">&#34;return&#34;</span><span class="op" id="4939696">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4939702">true</span><span class="op" id="4939706">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4939709">&#34;throw&#34;</span><span class="op" id="4939716">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4939723">true</span><span class="op" id="4939727">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4939730">&#34;try&#34;</span><span class="op" id="4939735">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4939744">true</span><span class="op" id="4939748">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4939751">&#34;typeof&#34;</span><span class="op" id="4939759">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4939765">true</span><span class="op" id="4939769">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4939772">&#34;void&#34;</span><span class="op" id="4939778">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4939786">true</span><span class="op" id="4939790">,</span><br>
<span class="lineno"></span><span class="op" id="4939792">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="4939795">var</span>&nbsp;<span class="ident" id="4939799">jsonMarshalType</span>&nbsp;<span class="op" id="4939815">=</span>&nbsp;<span class="ident" id="4939817"><a href="/gostd/html/template/js.go.html#4936205">reflect</a></span><span class="op" id="4939824">.</span><span class="ident" id="4939825"><a href="/gostd/reflect/type.go.html#2808718">TypeOf</a></span><span class="op" id="4939831">(</span><span class="op" id="4939832">(</span><span class="op" id="4939833">*</span><span class="ident" id="4939834"><a href="/gostd/html/template/js.go.html#4936181">json</a></span><span class="op" id="4939838">.</span><span class="ident" id="4939839"><a href="/gostd/encoding/json/encode.go.html#3996721">Marshaler</a></span><span class="op" id="4939848">)</span><span class="op" id="4939849">(</span><span class="builtintype" id="4939850">nil</span><span class="op" id="4939853">)</span><span class="op" id="4939854">)</span><span class="op" id="4939855">.</span><span class="ident" id="4939856"><a href="/gostd/reflect/type.go.html#2785263">Elem</a></span><span class="op" id="4939860">(</span><span class="op" id="4939861">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4939864">//&nbsp;indirectToJSONMarshaler&nbsp;returns&nbsp;the&nbsp;value,&nbsp;after&nbsp;dereferencing&nbsp;as&nbsp;many&nbsp;times</span><br>
<span class="lineno"></span><span class="comment" id="4939944">//&nbsp;as&nbsp;necessary&nbsp;to&nbsp;reach&nbsp;the&nbsp;base&nbsp;type&nbsp;(or&nbsp;nil)&nbsp;or&nbsp;an&nbsp;implementation&nbsp;of&nbsp;json.Marshal.</span><br>
<span class="lineno">125</span><span class="keyword" id="4940030">func</span>&nbsp;<span class="ident" id="4940035">indirectToJSONMarshaler</span><span class="op" id="4940058">(</span><span class="ident" id="4940059">a</span>&nbsp;<span class="keyword" id="4940061">interface</span><span class="op" id="4940070">{</span><span class="op" id="4940071">}</span><span class="op" id="4940072">)</span>&nbsp;<span class="keyword" id="4940074">interface</span><span class="op" id="4940083">{</span><span class="op" id="4940084">}</span>&nbsp;<span class="op" id="4940086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4940089">v</span>&nbsp;<span class="op" id="4940091">:=</span>&nbsp;<span class="ident" id="4940094"><a href="/gostd/html/template/js.go.html#4936205">reflect</a></span><span class="op" id="4940101">.</span><span class="ident" id="4940102"><a href="/gostd/reflect/value.go.html#2892536">ValueOf</a></span><span class="op" id="4940109">(</span><span class="ident" id="4940110"><a href="/gostd/html/template/js.go.html#4940059">a</a></span><span class="op" id="4940111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4940114">for</span>&nbsp;<span class="op" id="4940118">!</span><span class="ident" id="4940119"><a href="/gostd/html/template/js.go.html#4940089">v</a></span><span class="op" id="4940120">.</span><span class="ident" id="4940121"><a href="/gostd/reflect/value.go.html#2880910">Type</a></span><span class="op" id="4940125">(</span><span class="op" id="4940126">)</span><span class="op" id="4940127">.</span><span class="ident" id="4940128"><a href="/gostd/reflect/type.go.html#2783706">Implements</a></span><span class="op" id="4940138">(</span><span class="ident" id="4940139"><a href="/gostd/html/template/js.go.html#4939799">jsonMarshalType</a></span><span class="op" id="4940154">)</span>&nbsp;<span class="op" id="4940156">&amp;&amp;</span>&nbsp;<span class="ident" id="4940159"><a href="/gostd/html/template/js.go.html#4940089">v</a></span><span class="op" id="4940160">.</span><span class="ident" id="4940161"><a href="/gostd/reflect/value.go.html#2861487">Kind</a></span><span class="op" id="4940165">(</span><span class="op" id="4940166">)</span>&nbsp;<span class="op" id="4940168">==</span>&nbsp;<span class="ident" id="4940171"><a href="/gostd/html/template/js.go.html#4936205">reflect</a></span><span class="op" id="4940178">.</span><span class="ident" id="4940179"><a href="/gostd/reflect/type.go.html#2788057">Ptr</a></span>&nbsp;<span class="op" id="4940183">&amp;&amp;</span>&nbsp;<span class="op" id="4940186">!</span><span class="ident" id="4940187"><a href="/gostd/html/template/js.go.html#4940089">v</a></span><span class="op" id="4940188">.</span><span class="ident" id="4940189"><a href="/gostd/reflect/value.go.html#2860565">IsNil</a></span><span class="op" id="4940194">(</span><span class="op" id="4940195">)</span>&nbsp;<span class="op" id="4940197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4940201"><a href="/gostd/html/template/js.go.html#4940089">v</a></span>&nbsp;<span class="op" id="4940203">=</span>&nbsp;<span class="ident" id="4940205"><a href="/gostd/html/template/js.go.html#4940089">v</a></span><span class="op" id="4940206">.</span><span class="ident" id="4940207"><a href="/gostd/reflect/value.go.html#2853087">Elem</a></span><span class="op" id="4940211">(</span><span class="op" id="4940212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4940215">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4940218">return</span>&nbsp;<span class="ident" id="4940225"><a href="/gostd/html/template/js.go.html#4940089">v</a></span><span class="op" id="4940226">.</span><span class="ident" id="4940227"><a href="/gostd/reflect/value.go.html#2858688">Interface</a></span><span class="op" id="4940236">(</span><span class="op" id="4940237">)</span><br>
<span class="lineno"></span><span class="op" id="4940239">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4940242">//&nbsp;jsValEscaper&nbsp;escapes&nbsp;its&nbsp;inputs&nbsp;to&nbsp;a&nbsp;JS&nbsp;Expression&nbsp;(section&nbsp;11.14)&nbsp;that&nbsp;has</span><br>
<span class="lineno"></span><span class="comment" id="4940321">//&nbsp;neither&nbsp;side-effects&nbsp;nor&nbsp;free&nbsp;variables&nbsp;outside&nbsp;(NaN,&nbsp;Infinity).</span><br>
<span class="lineno">135</span><span class="keyword" id="4940389">func</span>&nbsp;<span class="ident" id="4940394">jsValEscaper</span><span class="op" id="4940406">(</span><span class="ident" id="4940407">args</span>&nbsp;<span class="op" id="4940412">...</span><span class="keyword" id="4940415">interface</span><span class="op" id="4940424">{</span><span class="op" id="4940425">}</span><span class="op" id="4940426">)</span>&nbsp;<span class="builtintype" id="4940428">string</span>&nbsp;<span class="op" id="4940435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4940438">var</span>&nbsp;<span class="ident" id="4940442">a</span>&nbsp;<span class="keyword" id="4940444">interface</span><span class="op" id="4940453">{</span><span class="op" id="4940454">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4940457">if</span>&nbsp;<span class="builtinfunc" id="4940460">len</span><span class="op" id="4940463">(</span><span class="ident" id="4940464"><a href="/gostd/html/template/js.go.html#4940407">args</a></span><span class="op" id="4940468">)</span>&nbsp;<span class="op" id="4940470">==</span>&nbsp;<span class="num" id="4940473">1</span>&nbsp;<span class="op" id="4940475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4940479"><a href="/gostd/html/template/js.go.html#4940442">a</a></span>&nbsp;<span class="op" id="4940481">=</span>&nbsp;<span class="ident" id="4940483"><a href="/gostd/html/template/js.go.html#4940035">indirectToJSONMarshaler</a></span><span class="op" id="4940506">(</span><span class="ident" id="4940507"><a href="/gostd/html/template/js.go.html#4940407">args</a></span><span class="op" id="4940511">[</span><span class="num" id="4940512">0</span><span class="op" id="4940513">]</span><span class="op" id="4940514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4940518">switch</span>&nbsp;<span class="ident" id="4940525">t</span>&nbsp;<span class="op" id="4940527">:=</span>&nbsp;<span class="ident" id="4940530"><a href="/gostd/html/template/js.go.html#4940442">a</a></span><span class="op" id="4940531">.</span><span class="op" id="4940532">(</span><span class="keyword" id="4940533">type</span><span class="op" id="4940537">)</span>&nbsp;<span class="op" id="4940539">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4940543">case</span>&nbsp;<span class="ident" id="4940548"><a href="/gostd/html/template/content.go.html#4869492">JS</a></span><span class="op" id="4940550">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4940555">return</span>&nbsp;<span class="builtintype" id="4940562">string</span><span class="op" id="4940568">(</span><span class="ident" id="4940569"><a href="/gostd/html/template/js.go.html#4940525">t</a></span><span class="op" id="4940570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4940574">case</span>&nbsp;<span class="ident" id="4940579"><a href="/gostd/html/template/content.go.html#4869900">JSStr</a></span><span class="op" id="4940584">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4940589">//&nbsp;TODO:&nbsp;normalize&nbsp;quotes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4940619">return</span>&nbsp;<span class="string" id="4940626">`&#34;`</span>&nbsp;<span class="op" id="4940630">+</span>&nbsp;<span class="builtintype" id="4940632">string</span><span class="op" id="4940638">(</span><span class="ident" id="4940639"><a href="/gostd/html/template/js.go.html#4940525">t</a></span><span class="op" id="4940640">)</span>&nbsp;<span class="op" id="4940642">+</span>&nbsp;<span class="string" id="4940644">`&#34;`</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4940650">case</span>&nbsp;<span class="ident" id="4940655"><a href="/gostd/html/template/js.go.html#4936181">json</a></span><span class="op" id="4940659">.</span><span class="ident" id="4940660"><a href="/gostd/encoding/json/encode.go.html#3996721">Marshaler</a></span><span class="op" id="4940669">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4940674">//&nbsp;Do&nbsp;not&nbsp;treat&nbsp;as&nbsp;a&nbsp;Stringer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4940707">case</span>&nbsp;<span class="ident" id="4940712"><a href="/gostd/html/template/js.go.html#4936198">fmt</a></span><span class="op" id="4940715">.</span><span class="ident" id="4940716"><a href="/gostd/fmt/print.go.html#2140275">Stringer</a></span><span class="op" id="4940724">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4940729"><a href="/gostd/html/template/js.go.html#4940442">a</a></span>&nbsp;<span class="op" id="4940731">=</span>&nbsp;<span class="ident" id="4940733"><a href="/gostd/html/template/js.go.html#4940525">t</a></span><span class="op" id="4940734">.</span><span class="ident" id="4940735"><a href="/gostd/fmt/print.go.html#2140297">String</a></span><span class="op" id="4940741">(</span><span class="op" id="4940742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4940746">}</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4940749">}</span>&nbsp;<span class="keyword" id="4940751">else</span>&nbsp;<span class="op" id="4940756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4940760">for</span>&nbsp;<span class="ident" id="4940764">i</span><span class="op" id="4940765">,</span>&nbsp;<span class="ident" id="4940767">arg</span>&nbsp;<span class="op" id="4940771">:=</span>&nbsp;<span class="keyword" id="4940774">range</span>&nbsp;<span class="ident" id="4940780"><a href="/gostd/html/template/js.go.html#4940407">args</a></span>&nbsp;<span class="op" id="4940785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4940790"><a href="/gostd/html/template/js.go.html#4940407">args</a></span><span class="op" id="4940794">[</span><span class="ident" id="4940795"><a href="/gostd/html/template/js.go.html#4940764">i</a></span><span class="op" id="4940796">]</span>&nbsp;<span class="op" id="4940798">=</span>&nbsp;<span class="ident" id="4940800"><a href="/gostd/html/template/js.go.html#4940035">indirectToJSONMarshaler</a></span><span class="op" id="4940823">(</span><span class="ident" id="4940824"><a href="/gostd/html/template/js.go.html#4940767">arg</a></span><span class="op" id="4940827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4940831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4940835"><a href="/gostd/html/template/js.go.html#4940442">a</a></span>&nbsp;<span class="op" id="4940837">=</span>&nbsp;<span class="ident" id="4940839"><a href="/gostd/html/template/js.go.html#4936198">fmt</a></span><span class="op" id="4940842">.</span><span class="ident" id="4940843"><a href="/gostd/fmt/print.go.html#2144876">Sprint</a></span><span class="op" id="4940849">(</span><span class="ident" id="4940850"><a href="/gostd/html/template/js.go.html#4940407">args</a></span><span class="op" id="4940854">...</span><span class="op" id="4940857">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4940860">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4940863">//&nbsp;TODO:&nbsp;detect&nbsp;cycles&nbsp;before&nbsp;calling&nbsp;Marshal&nbsp;which&nbsp;loops&nbsp;infinitely&nbsp;on</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4940936">//&nbsp;cyclic&nbsp;data.&nbsp;This&nbsp;may&nbsp;be&nbsp;an&nbsp;unacceptable&nbsp;DoS&nbsp;risk.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4940992">b</span><span class="op" id="4940993">,</span>&nbsp;<span class="ident" id="4940995">err</span>&nbsp;<span class="op" id="4940999">:=</span>&nbsp;<span class="ident" id="4941002"><a href="/gostd/html/template/js.go.html#4936181">json</a></span><span class="op" id="4941006">.</span><span class="ident" id="4941007"><a href="/gostd/encoding/json/encode.go.html#3995033">Marshal</a></span><span class="op" id="4941014">(</span><span class="ident" id="4941015"><a href="/gostd/html/template/js.go.html#4940442">a</a></span><span class="op" id="4941016">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4941019">if</span>&nbsp;<span class="ident" id="4941022"><a href="/gostd/html/template/js.go.html#4940995">err</a></span>&nbsp;<span class="op" id="4941026">!=</span>&nbsp;<span class="builtintype" id="4941029">nil</span>&nbsp;<span class="op" id="4941033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4941037">//&nbsp;Put&nbsp;a&nbsp;space&nbsp;before&nbsp;comment&nbsp;so&nbsp;that&nbsp;if&nbsp;it&nbsp;is&nbsp;flush&nbsp;against</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4941100">//&nbsp;a&nbsp;division&nbsp;operator&nbsp;it&nbsp;is&nbsp;not&nbsp;turned&nbsp;into&nbsp;a&nbsp;line&nbsp;comment:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4941163">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x/{{y}}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4941180">//&nbsp;turning&nbsp;into</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4941198">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x//*&nbsp;error&nbsp;marshalling&nbsp;y:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4941233">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;second&nbsp;line&nbsp;of&nbsp;error&nbsp;message&nbsp;*/null</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4941283">return</span>&nbsp;<span class="ident" id="4941290"><a href="/gostd/html/template/js.go.html#4936198">fmt</a></span><span class="op" id="4941293">.</span><span class="ident" id="4941294"><a href="/gostd/fmt/print.go.html#2143637">Sprintf</a></span><span class="op" id="4941301">(</span><span class="string" id="4941302">&#34;&nbsp;/*&nbsp;%s&nbsp;*/null&nbsp;&#34;</span><span class="op" id="4941318">,</span>&nbsp;<span class="ident" id="4941320"><a href="/gostd/html/template/js.go.html#4936216">strings</a></span><span class="op" id="4941327">.</span><span class="ident" id="4941328"><a href="/gostd/strings/strings.go.html#2983409">Replace</a></span><span class="op" id="4941335">(</span><span class="ident" id="4941336"><a href="/gostd/html/template/js.go.html#4940995">err</a></span><span class="op" id="4941339">.</span><span class="ident" id="4941340">Error</span><span class="op" id="4941345">(</span><span class="op" id="4941346">)</span><span class="op" id="4941347">,</span>&nbsp;<span class="string" id="4941349">&#34;*/&#34;</span><span class="op" id="4941353">,</span>&nbsp;<span class="string" id="4941355">&#34;*&nbsp;/&#34;</span><span class="op" id="4941360">,</span>&nbsp;<span class="op" id="4941362">-</span><span class="num" id="4941363">1</span><span class="op" id="4941364">)</span><span class="op" id="4941365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4941368">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4941372">//&nbsp;TODO:&nbsp;maybe&nbsp;post-process&nbsp;output&nbsp;to&nbsp;prevent&nbsp;it&nbsp;from&nbsp;containing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4941438">//&nbsp;&#34;&lt;!--&#34;,&nbsp;&#34;--&gt;&#34;,&nbsp;&#34;&lt;![CDATA[&#34;,&nbsp;&#34;]]&gt;&#34;,&nbsp;or&nbsp;&#34;&lt;/script&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4941491">//&nbsp;in&nbsp;case&nbsp;custom&nbsp;marshallers&nbsp;produce&nbsp;output&nbsp;containing&nbsp;those.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4941556">//&nbsp;TODO:&nbsp;Maybe&nbsp;abbreviate&nbsp;\u00ab&nbsp;to&nbsp;\xab&nbsp;to&nbsp;produce&nbsp;more&nbsp;compact&nbsp;output.</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4941630">if</span>&nbsp;<span class="builtinfunc" id="4941633">len</span><span class="op" id="4941636">(</span><span class="ident" id="4941637"><a href="/gostd/html/template/js.go.html#4940992">b</a></span><span class="op" id="4941638">)</span>&nbsp;<span class="op" id="4941640">==</span>&nbsp;<span class="num" id="4941643">0</span>&nbsp;<span class="op" id="4941645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4941649">//&nbsp;In,&nbsp;`x=y/{{.}}*z`&nbsp;a&nbsp;json.Marshaler&nbsp;that&nbsp;produces&nbsp;&#34;&#34;&nbsp;should</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4941713">//&nbsp;not&nbsp;cause&nbsp;the&nbsp;output&nbsp;`x=y/*z`.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4941749">return</span>&nbsp;<span class="string" id="4941756">&#34;&nbsp;null&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4941766">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4941769">first</span><span class="op" id="4941774">,</span>&nbsp;<span class="ident" id="4941776">_</span>&nbsp;<span class="op" id="4941778">:=</span>&nbsp;<span class="ident" id="4941781"><a href="/gostd/html/template/js.go.html#4936227">utf8</a></span><span class="op" id="4941785">.</span><span class="ident" id="4941786"><a href="/gostd/unicode/utf8/utf8.go.html#1809912">DecodeRune</a></span><span class="op" id="4941796">(</span><span class="ident" id="4941797"><a href="/gostd/html/template/js.go.html#4940992">b</a></span><span class="op" id="4941798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4941801">last</span><span class="op" id="4941805">,</span>&nbsp;<span class="ident" id="4941807">_</span>&nbsp;<span class="op" id="4941809">:=</span>&nbsp;<span class="ident" id="4941812"><a href="/gostd/html/template/js.go.html#4936227">utf8</a></span><span class="op" id="4941816">.</span><span class="ident" id="4941817"><a href="/gostd/unicode/utf8/utf8.go.html#1810995">DecodeLastRune</a></span><span class="op" id="4941831">(</span><span class="ident" id="4941832"><a href="/gostd/html/template/js.go.html#4940992">b</a></span><span class="op" id="4941833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4941836">var</span>&nbsp;<span class="ident" id="4941840">buf</span>&nbsp;<span class="ident" id="4941844"><a href="/gostd/html/template/js.go.html#4936172">bytes</a></span><span class="op" id="4941849">.</span><span class="ident" id="4941850"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4941858">//&nbsp;Prevent&nbsp;IdentifierNames&nbsp;and&nbsp;NumericLiterals&nbsp;from&nbsp;running&nbsp;into</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4941924">//&nbsp;keywords:&nbsp;in,&nbsp;instanceof,&nbsp;typeof,&nbsp;void</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4941967">pad</span>&nbsp;<span class="op" id="4941971">:=</span>&nbsp;<span class="ident" id="4941974"><a href="/gostd/html/template/js.go.html#4945978">isJSIdentPart</a></span><span class="op" id="4941987">(</span><span class="ident" id="4941988"><a href="/gostd/html/template/js.go.html#4941769">first</a></span><span class="op" id="4941993">)</span>&nbsp;<span class="op" id="4941995">||</span>&nbsp;<span class="ident" id="4941998"><a href="/gostd/html/template/js.go.html#4945978">isJSIdentPart</a></span><span class="op" id="4942011">(</span><span class="ident" id="4942012"><a href="/gostd/html/template/js.go.html#4941801">last</a></span><span class="op" id="4942016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4942019">if</span>&nbsp;<span class="ident" id="4942022"><a href="/gostd/html/template/js.go.html#4941967">pad</a></span>&nbsp;<span class="op" id="4942026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4942030"><a href="/gostd/html/template/js.go.html#4941840">buf</a></span><span class="op" id="4942033">.</span><span class="ident" id="4942034"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4942043">(</span><span class="string" id="4942044">&#39;&nbsp;&#39;</span><span class="op" id="4942047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4942050">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4942053">written</span>&nbsp;<span class="op" id="4942061">:=</span>&nbsp;<span class="num" id="4942064">0</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4942067">//&nbsp;Make&nbsp;sure&nbsp;that&nbsp;json.Marshal&nbsp;escapes&nbsp;codepoints&nbsp;U+2028&nbsp;&amp;&nbsp;U+2029</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4942134">//&nbsp;so&nbsp;it&nbsp;falls&nbsp;within&nbsp;the&nbsp;subset&nbsp;of&nbsp;JSON&nbsp;which&nbsp;is&nbsp;valid&nbsp;JS.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4942195">for</span>&nbsp;<span class="ident" id="4942199">i</span>&nbsp;<span class="op" id="4942201">:=</span>&nbsp;<span class="num" id="4942204">0</span><span class="op" id="4942205">;</span>&nbsp;<span class="ident" id="4942207"><a href="/gostd/html/template/js.go.html#4942199">i</a></span>&nbsp;<span class="op" id="4942209">&lt;</span>&nbsp;<span class="builtinfunc" id="4942211">len</span><span class="op" id="4942214">(</span><span class="ident" id="4942215"><a href="/gostd/html/template/js.go.html#4940992">b</a></span><span class="op" id="4942216">)</span><span class="op" id="4942217">;</span>&nbsp;<span class="op" id="4942219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4942223">rune</span><span class="op" id="4942227">,</span>&nbsp;<span class="ident" id="4942229">n</span>&nbsp;<span class="op" id="4942231">:=</span>&nbsp;<span class="ident" id="4942234"><a href="/gostd/html/template/js.go.html#4936227">utf8</a></span><span class="op" id="4942238">.</span><span class="ident" id="4942239"><a href="/gostd/unicode/utf8/utf8.go.html#1809912">DecodeRune</a></span><span class="op" id="4942249">(</span><span class="ident" id="4942250"><a href="/gostd/html/template/js.go.html#4940992">b</a></span><span class="op" id="4942251">[</span><span class="ident" id="4942252"><a href="/gostd/html/template/js.go.html#4942199">i</a></span><span class="op" id="4942253">:</span><span class="op" id="4942254">]</span><span class="op" id="4942255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4942259">repl</span>&nbsp;<span class="op" id="4942264">:=</span>&nbsp;<span class="string" id="4942267">&#34;&#34;</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4942272">if</span>&nbsp;<span class="builtintype" id="4942275"><a href="/gostd/html/template/js.go.html#4942223">rune</a></span>&nbsp;<span class="op" id="4942280">==</span>&nbsp;<span class="num" id="4942283">0x2028</span>&nbsp;<span class="op" id="4942290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4942295"><a href="/gostd/html/template/js.go.html#4942259">repl</a></span>&nbsp;<span class="op" id="4942300">=</span>&nbsp;<span class="string" id="4942302">`\u2028`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4942313">}</span>&nbsp;<span class="keyword" id="4942315">else</span>&nbsp;<span class="keyword" id="4942320">if</span>&nbsp;<span class="builtintype" id="4942323"><a href="/gostd/html/template/js.go.html#4942223">rune</a></span>&nbsp;<span class="op" id="4942328">==</span>&nbsp;<span class="num" id="4942331">0x2029</span>&nbsp;<span class="op" id="4942338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4942343"><a href="/gostd/html/template/js.go.html#4942259">repl</a></span>&nbsp;<span class="op" id="4942348">=</span>&nbsp;<span class="string" id="4942350">`\u2029`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4942361">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4942365">if</span>&nbsp;<span class="ident" id="4942368"><a href="/gostd/html/template/js.go.html#4942259">repl</a></span>&nbsp;<span class="op" id="4942373">!=</span>&nbsp;<span class="string" id="4942376">&#34;&#34;</span>&nbsp;<span class="op" id="4942379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4942384"><a href="/gostd/html/template/js.go.html#4941840">buf</a></span><span class="op" id="4942387">.</span><span class="ident" id="4942388"><a href="/gostd/bytes/buffer.go.html#1387016">Write</a></span><span class="op" id="4942393">(</span><span class="ident" id="4942394"><a href="/gostd/html/template/js.go.html#4940992">b</a></span><span class="op" id="4942395">[</span><span class="ident" id="4942396"><a href="/gostd/html/template/js.go.html#4942053">written</a></span><span class="op" id="4942403">:</span><span class="ident" id="4942404"><a href="/gostd/html/template/js.go.html#4942199">i</a></span><span class="op" id="4942405">]</span><span class="op" id="4942406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4942411"><a href="/gostd/html/template/js.go.html#4941840">buf</a></span><span class="op" id="4942414">.</span><span class="ident" id="4942415"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="4942426">(</span><span class="ident" id="4942427"><a href="/gostd/html/template/js.go.html#4942259">repl</a></span><span class="op" id="4942431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4942436"><a href="/gostd/html/template/js.go.html#4942053">written</a></span>&nbsp;<span class="op" id="4942444">=</span>&nbsp;<span class="ident" id="4942446"><a href="/gostd/html/template/js.go.html#4942199">i</a></span>&nbsp;<span class="op" id="4942448">+</span>&nbsp;<span class="ident" id="4942450"><a href="/gostd/html/template/js.go.html#4942229">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4942454">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4942458"><a href="/gostd/html/template/js.go.html#4942199">i</a></span>&nbsp;<span class="op" id="4942460">+=</span>&nbsp;<span class="ident" id="4942463"><a href="/gostd/html/template/js.go.html#4942229">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4942466">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4942469">if</span>&nbsp;<span class="ident" id="4942472"><a href="/gostd/html/template/js.go.html#4941840">buf</a></span><span class="op" id="4942475">.</span><span class="ident" id="4942476"><a href="/gostd/bytes/buffer.go.html#1384893">Len</a></span><span class="op" id="4942479">(</span><span class="op" id="4942480">)</span>&nbsp;<span class="op" id="4942482">!=</span>&nbsp;<span class="num" id="4942485">0</span>&nbsp;<span class="op" id="4942487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4942491"><a href="/gostd/html/template/js.go.html#4941840">buf</a></span><span class="op" id="4942494">.</span><span class="ident" id="4942495"><a href="/gostd/bytes/buffer.go.html#1387016">Write</a></span><span class="op" id="4942500">(</span><span class="ident" id="4942501"><a href="/gostd/html/template/js.go.html#4940992">b</a></span><span class="op" id="4942502">[</span><span class="ident" id="4942503"><a href="/gostd/html/template/js.go.html#4942053">written</a></span><span class="op" id="4942510">:</span><span class="op" id="4942511">]</span><span class="op" id="4942512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4942516">if</span>&nbsp;<span class="ident" id="4942519"><a href="/gostd/html/template/js.go.html#4941967">pad</a></span>&nbsp;<span class="op" id="4942523">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4942528"><a href="/gostd/html/template/js.go.html#4941840">buf</a></span><span class="op" id="4942531">.</span><span class="ident" id="4942532"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="4942541">(</span><span class="string" id="4942542">&#39;&nbsp;&#39;</span><span class="op" id="4942545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4942549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4942553"><a href="/gostd/html/template/js.go.html#4940992">b</a></span>&nbsp;<span class="op" id="4942555">=</span>&nbsp;<span class="ident" id="4942557"><a href="/gostd/html/template/js.go.html#4941840">buf</a></span><span class="op" id="4942560">.</span><span class="ident" id="4942561"><a href="/gostd/bytes/buffer.go.html#1384454">Bytes</a></span><span class="op" id="4942566">(</span><span class="op" id="4942567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4942570">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4942573">return</span>&nbsp;<span class="builtintype" id="4942580">string</span><span class="op" id="4942586">(</span><span class="ident" id="4942587"><a href="/gostd/html/template/js.go.html#4940992">b</a></span><span class="op" id="4942588">)</span><br>
<span class="lineno">215</span><span class="op" id="4942590">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4942593">//&nbsp;jsStrEscaper&nbsp;produces&nbsp;a&nbsp;string&nbsp;that&nbsp;can&nbsp;be&nbsp;included&nbsp;between&nbsp;quotes&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4942666">//&nbsp;JavaScript&nbsp;source,&nbsp;in&nbsp;JavaScript&nbsp;embedded&nbsp;in&nbsp;an&nbsp;HTML5&nbsp;&lt;script&gt;&nbsp;element,</span><br>
<span class="lineno"></span><span class="comment" id="4942741">//&nbsp;or&nbsp;in&nbsp;an&nbsp;HTML5&nbsp;event&nbsp;handler&nbsp;attribute&nbsp;such&nbsp;as&nbsp;onclick.</span><br>
<span class="lineno">220</span><span class="keyword" id="4942800">func</span>&nbsp;<span class="ident" id="4942805">jsStrEscaper</span><span class="op" id="4942817">(</span><span class="ident" id="4942818">args</span>&nbsp;<span class="op" id="4942823">...</span><span class="keyword" id="4942826">interface</span><span class="op" id="4942835">{</span><span class="op" id="4942836">}</span><span class="op" id="4942837">)</span>&nbsp;<span class="builtintype" id="4942839">string</span>&nbsp;<span class="op" id="4942846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4942849">s</span><span class="op" id="4942850">,</span>&nbsp;<span class="ident" id="4942852">t</span>&nbsp;<span class="op" id="4942854">:=</span>&nbsp;<span class="ident" id="4942857"><a href="/gostd/html/template/content.go.html#4871796">stringify</a></span><span class="op" id="4942866">(</span><span class="ident" id="4942867"><a href="/gostd/html/template/js.go.html#4942818">args</a></span><span class="op" id="4942871">...</span><span class="op" id="4942874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4942877">if</span>&nbsp;<span class="ident" id="4942880"><a href="/gostd/html/template/js.go.html#4942852">t</a></span>&nbsp;<span class="op" id="4942882">==</span>&nbsp;<span class="ident" id="4942885"><a href="/gostd/html/template/content.go.html#4870381">contentTypeJSStr</a></span>&nbsp;<span class="op" id="4942902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4942906">return</span>&nbsp;<span class="ident" id="4942913"><a href="/gostd/html/template/js.go.html#4943792">replace</a></span><span class="op" id="4942920">(</span><span class="ident" id="4942921"><a href="/gostd/html/template/js.go.html#4942849">s</a></span><span class="op" id="4942922">,</span>&nbsp;<span class="ident" id="4942924"><a href="/gostd/html/template/js.go.html#4944827">jsStrNormReplacementTable</a></span><span class="op" id="4942949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4942952">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4942955">return</span>&nbsp;<span class="ident" id="4942962"><a href="/gostd/html/template/js.go.html#4943792">replace</a></span><span class="op" id="4942969">(</span><span class="ident" id="4942970"><a href="/gostd/html/template/js.go.html#4942849">s</a></span><span class="op" id="4942971">,</span>&nbsp;<span class="ident" id="4942973"><a href="/gostd/html/template/js.go.html#4944313">jsStrReplacementTable</a></span><span class="op" id="4942994">)</span><br>
<span class="lineno"></span><span class="op" id="4942996">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4942999">//&nbsp;jsRegexpEscaper&nbsp;behaves&nbsp;like&nbsp;jsStrEscaper&nbsp;but&nbsp;escapes&nbsp;regular&nbsp;expression</span><br>
<span class="lineno"></span><span class="comment" id="4943075">//&nbsp;specials&nbsp;so&nbsp;the&nbsp;result&nbsp;is&nbsp;treated&nbsp;literally&nbsp;when&nbsp;included&nbsp;in&nbsp;a&nbsp;regular</span><br>
<span class="lineno">230</span><span class="comment" id="4943149">//&nbsp;expression&nbsp;literal.&nbsp;/foo{{.X}}bar/&nbsp;matches&nbsp;the&nbsp;string&nbsp;&#34;foo&#34;&nbsp;followed&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="4943224">//&nbsp;the&nbsp;literal&nbsp;text&nbsp;of&nbsp;{{.X}}&nbsp;followed&nbsp;by&nbsp;the&nbsp;string&nbsp;&#34;bar&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="4943284">func</span>&nbsp;<span class="ident" id="4943289">jsRegexpEscaper</span><span class="op" id="4943304">(</span><span class="ident" id="4943305">args</span>&nbsp;<span class="op" id="4943310">...</span><span class="keyword" id="4943313">interface</span><span class="op" id="4943322">{</span><span class="op" id="4943323">}</span><span class="op" id="4943324">)</span>&nbsp;<span class="builtintype" id="4943326">string</span>&nbsp;<span class="op" id="4943333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4943336">s</span><span class="op" id="4943337">,</span>&nbsp;<span class="ident" id="4943339">_</span>&nbsp;<span class="op" id="4943341">:=</span>&nbsp;<span class="ident" id="4943344"><a href="/gostd/html/template/content.go.html#4871796">stringify</a></span><span class="op" id="4943353">(</span><span class="ident" id="4943354"><a href="/gostd/html/template/js.go.html#4943305">args</a></span><span class="op" id="4943358">...</span><span class="op" id="4943361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4943364"><a href="/gostd/html/template/js.go.html#4943336">s</a></span>&nbsp;<span class="op" id="4943366">=</span>&nbsp;<span class="ident" id="4943368"><a href="/gostd/html/template/js.go.html#4943792">replace</a></span><span class="op" id="4943375">(</span><span class="ident" id="4943376"><a href="/gostd/html/template/js.go.html#4943336">s</a></span><span class="op" id="4943377">,</span>&nbsp;<span class="ident" id="4943379"><a href="/gostd/html/template/js.go.html#4945190">jsRegexpReplacementTable</a></span><span class="op" id="4943403">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4943406">if</span>&nbsp;<span class="ident" id="4943409"><a href="/gostd/html/template/js.go.html#4943336">s</a></span>&nbsp;<span class="op" id="4943411">==</span>&nbsp;<span class="string" id="4943414">&#34;&#34;</span>&nbsp;<span class="op" id="4943417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4943421">//&nbsp;/{{.X}}/&nbsp;should&nbsp;not&nbsp;produce&nbsp;a&nbsp;line&nbsp;comment&nbsp;when&nbsp;.X&nbsp;==&nbsp;&#34;&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4943484">return</span>&nbsp;<span class="string" id="4943491">&#34;(?:)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4943499">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4943502">return</span>&nbsp;<span class="ident" id="4943509"><a href="/gostd/html/template/js.go.html#4943336">s</a></span><br>
<span class="lineno">240</span><span class="op" id="4943511">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4943514">//&nbsp;replace&nbsp;replaces&nbsp;each&nbsp;rune&nbsp;r&nbsp;of&nbsp;s&nbsp;with&nbsp;replacementTable[r],&nbsp;provided&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4943591">//&nbsp;r&nbsp;&lt;&nbsp;len(replacementTable).&nbsp;If&nbsp;replacementTable[r]&nbsp;is&nbsp;the&nbsp;empty&nbsp;string&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="4943669">//&nbsp;no&nbsp;replacement&nbsp;is&nbsp;made.</span><br>
<span class="lineno">245</span><span class="comment" id="4943696">//&nbsp;It&nbsp;also&nbsp;replaces&nbsp;runes&nbsp;U+2028&nbsp;and&nbsp;U+2029&nbsp;with&nbsp;the&nbsp;raw&nbsp;strings&nbsp;`\u2028`&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4943774">//&nbsp;`\u2029`.</span><br>
<span class="lineno"></span><span class="keyword" id="4943787">func</span>&nbsp;<span class="ident" id="4943792">replace</span><span class="op" id="4943799">(</span><span class="ident" id="4943800">s</span>&nbsp;<span class="builtintype" id="4943802">string</span><span class="op" id="4943808">,</span>&nbsp;<span class="ident" id="4943810">replacementTable</span>&nbsp;<span class="op" id="4943827">[</span><span class="op" id="4943828">]</span><span class="builtintype" id="4943829">string</span><span class="op" id="4943835">)</span>&nbsp;<span class="builtintype" id="4943837">string</span>&nbsp;<span class="op" id="4943844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4943847">var</span>&nbsp;<span class="ident" id="4943851">b</span>&nbsp;<span class="ident" id="4943853"><a href="/gostd/html/template/js.go.html#4936172">bytes</a></span><span class="op" id="4943858">.</span><span class="ident" id="4943859"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4943867">written</span>&nbsp;<span class="op" id="4943875">:=</span>&nbsp;<span class="num" id="4943878">0</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4943881">for</span>&nbsp;<span class="ident" id="4943885">i</span><span class="op" id="4943886">,</span>&nbsp;<span class="ident" id="4943888">r</span>&nbsp;<span class="op" id="4943890">:=</span>&nbsp;<span class="keyword" id="4943893">range</span>&nbsp;<span class="ident" id="4943899"><a href="/gostd/html/template/js.go.html#4943800">s</a></span>&nbsp;<span class="op" id="4943901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4943905">var</span>&nbsp;<span class="ident" id="4943909">repl</span>&nbsp;<span class="builtintype" id="4943914">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4943923">switch</span>&nbsp;<span class="op" id="4943930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4943934">case</span>&nbsp;<span class="builtintype" id="4943939">int</span><span class="op" id="4943942">(</span><span class="ident" id="4943943"><a href="/gostd/html/template/js.go.html#4943888">r</a></span><span class="op" id="4943944">)</span>&nbsp;<span class="op" id="4943946">&lt;</span>&nbsp;<span class="builtinfunc" id="4943948">len</span><span class="op" id="4943951">(</span><span class="ident" id="4943952"><a href="/gostd/html/template/js.go.html#4943810">replacementTable</a></span><span class="op" id="4943968">)</span>&nbsp;<span class="op" id="4943970">&amp;&amp;</span>&nbsp;<span class="ident" id="4943973"><a href="/gostd/html/template/js.go.html#4943810">replacementTable</a></span><span class="op" id="4943989">[</span><span class="ident" id="4943990"><a href="/gostd/html/template/js.go.html#4943888">r</a></span><span class="op" id="4943991">]</span>&nbsp;<span class="op" id="4943993">!=</span>&nbsp;<span class="string" id="4943996">&#34;&#34;</span><span class="op" id="4943998">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4944003"><a href="/gostd/html/template/js.go.html#4943909">repl</a></span>&nbsp;<span class="op" id="4944008">=</span>&nbsp;<span class="ident" id="4944010"><a href="/gostd/html/template/js.go.html#4943810">replacementTable</a></span><span class="op" id="4944026">[</span><span class="ident" id="4944027"><a href="/gostd/html/template/js.go.html#4943888">r</a></span><span class="op" id="4944028">]</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4944032">case</span>&nbsp;<span class="ident" id="4944037"><a href="/gostd/html/template/js.go.html#4943888">r</a></span>&nbsp;<span class="op" id="4944039">==</span>&nbsp;<span class="string" id="4944042">&#39;\u2028&#39;</span><span class="op" id="4944050">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4944055"><a href="/gostd/html/template/js.go.html#4943909">repl</a></span>&nbsp;<span class="op" id="4944060">=</span>&nbsp;<span class="string" id="4944062">`\u2028`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4944073">case</span>&nbsp;<span class="ident" id="4944078"><a href="/gostd/html/template/js.go.html#4943888">r</a></span>&nbsp;<span class="op" id="4944080">==</span>&nbsp;<span class="string" id="4944083">&#39;\u2029&#39;</span><span class="op" id="4944091">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4944096"><a href="/gostd/html/template/js.go.html#4943909">repl</a></span>&nbsp;<span class="op" id="4944101">=</span>&nbsp;<span class="string" id="4944103">`\u2029`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4944114">default</span><span class="op" id="4944121">:</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4944126">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4944137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4944141"><a href="/gostd/html/template/js.go.html#4943851">b</a></span><span class="op" id="4944142">.</span><span class="ident" id="4944143"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="4944154">(</span><span class="ident" id="4944155"><a href="/gostd/html/template/js.go.html#4943800">s</a></span><span class="op" id="4944156">[</span><span class="ident" id="4944157"><a href="/gostd/html/template/js.go.html#4943867">written</a></span><span class="op" id="4944164">:</span><span class="ident" id="4944165"><a href="/gostd/html/template/js.go.html#4943885">i</a></span><span class="op" id="4944166">]</span><span class="op" id="4944167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4944171"><a href="/gostd/html/template/js.go.html#4943851">b</a></span><span class="op" id="4944172">.</span><span class="ident" id="4944173"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="4944184">(</span><span class="ident" id="4944185"><a href="/gostd/html/template/js.go.html#4943909">repl</a></span><span class="op" id="4944189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4944193"><a href="/gostd/html/template/js.go.html#4943867">written</a></span>&nbsp;<span class="op" id="4944201">=</span>&nbsp;<span class="ident" id="4944203"><a href="/gostd/html/template/js.go.html#4943885">i</a></span>&nbsp;<span class="op" id="4944205">+</span>&nbsp;<span class="ident" id="4944207"><a href="/gostd/html/template/js.go.html#4936227">utf8</a></span><span class="op" id="4944211">.</span><span class="ident" id="4944212"><a href="/gostd/unicode/utf8/utf8.go.html#1812711">RuneLen</a></span><span class="op" id="4944219">(</span><span class="ident" id="4944220"><a href="/gostd/html/template/js.go.html#4943888">r</a></span><span class="op" id="4944221">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4944224">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4944227">if</span>&nbsp;<span class="ident" id="4944230"><a href="/gostd/html/template/js.go.html#4943867">written</a></span>&nbsp;<span class="op" id="4944238">==</span>&nbsp;<span class="num" id="4944241">0</span>&nbsp;<span class="op" id="4944243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4944247">return</span>&nbsp;<span class="ident" id="4944254"><a href="/gostd/html/template/js.go.html#4943800">s</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4944257">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4944260"><a href="/gostd/html/template/js.go.html#4943851">b</a></span><span class="op" id="4944261">.</span><span class="ident" id="4944262"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="4944273">(</span><span class="ident" id="4944274"><a href="/gostd/html/template/js.go.html#4943800">s</a></span><span class="op" id="4944275">[</span><span class="ident" id="4944276"><a href="/gostd/html/template/js.go.html#4943867">written</a></span><span class="op" id="4944283">:</span><span class="op" id="4944284">]</span><span class="op" id="4944285">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4944288">return</span>&nbsp;<span class="ident" id="4944295"><a href="/gostd/html/template/js.go.html#4943851">b</a></span><span class="op" id="4944296">.</span><span class="ident" id="4944297"><a href="/gostd/bytes/buffer.go.html#1384648">String</a></span><span class="op" id="4944303">(</span><span class="op" id="4944304">)</span><br>
<span class="lineno"></span><span class="op" id="4944306">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4944309">var</span>&nbsp;<span class="ident" id="4944313">jsStrReplacementTable</span>&nbsp;<span class="op" id="4944335">=</span>&nbsp;<span class="op" id="4944337">[</span><span class="op" id="4944338">]</span><span class="builtintype" id="4944339">string</span><span class="op" id="4944345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4944348">0</span><span class="op" id="4944349">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4944354">`\0`</span><span class="op" id="4944358">,</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4944361">&#39;\t&#39;</span><span class="op" id="4944365">:</span>&nbsp;<span class="string" id="4944367">`\t`</span><span class="op" id="4944371">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4944374">&#39;\n&#39;</span><span class="op" id="4944378">:</span>&nbsp;<span class="string" id="4944380">`\n`</span><span class="op" id="4944384">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4944387">&#39;\v&#39;</span><span class="op" id="4944391">:</span>&nbsp;<span class="string" id="4944393">`\x0b`</span><span class="op" id="4944399">,</span>&nbsp;<span class="comment" id="4944401">//&nbsp;&#34;\v&#34;&nbsp;==&nbsp;&#34;v&#34;&nbsp;on&nbsp;IE&nbsp;6.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4944426">&#39;\f&#39;</span><span class="op" id="4944430">:</span>&nbsp;<span class="string" id="4944432">`\f`</span><span class="op" id="4944436">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4944439">&#39;\r&#39;</span><span class="op" id="4944443">:</span>&nbsp;<span class="string" id="4944445">`\r`</span><span class="op" id="4944449">,</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4944452">//&nbsp;Encode&nbsp;HTML&nbsp;specials&nbsp;as&nbsp;hex&nbsp;so&nbsp;the&nbsp;output&nbsp;can&nbsp;be&nbsp;embedded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4944514">//&nbsp;in&nbsp;HTML&nbsp;attributes&nbsp;without&nbsp;further&nbsp;encoding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4944563">&#39;&#34;&#39;</span><span class="op" id="4944566">:</span>&nbsp;&nbsp;<span class="string" id="4944569">`\x22`</span><span class="op" id="4944575">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4944578">&#39;&amp;&#39;</span><span class="op" id="4944581">:</span>&nbsp;&nbsp;<span class="string" id="4944584">`\x26`</span><span class="op" id="4944590">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4944593">&#39;\&#39;&#39;</span><span class="op" id="4944597">:</span>&nbsp;<span class="string" id="4944599">`\x27`</span><span class="op" id="4944605">,</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4944608">&#39;+&#39;</span><span class="op" id="4944611">:</span>&nbsp;&nbsp;<span class="string" id="4944614">`\x2b`</span><span class="op" id="4944620">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4944623">&#39;/&#39;</span><span class="op" id="4944626">:</span>&nbsp;&nbsp;<span class="string" id="4944629">`\/`</span><span class="op" id="4944633">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4944636">&#39;&lt;&#39;</span><span class="op" id="4944639">:</span>&nbsp;&nbsp;<span class="string" id="4944642">`\x3c`</span><span class="op" id="4944648">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4944651">&#39;&gt;&#39;</span><span class="op" id="4944654">:</span>&nbsp;&nbsp;<span class="string" id="4944657">`\x3e`</span><span class="op" id="4944663">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4944666">&#39;\\&#39;</span><span class="op" id="4944670">:</span>&nbsp;<span class="string" id="4944672">`\\`</span><span class="op" id="4944676">,</span><br>
<span class="lineno">290</span><span class="op" id="4944678">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4944681">//&nbsp;jsStrNormReplacementTable&nbsp;is&nbsp;like&nbsp;jsStrReplacementTable&nbsp;but&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="4944753">//&nbsp;overencode&nbsp;existing&nbsp;escapes&nbsp;since&nbsp;this&nbsp;table&nbsp;has&nbsp;no&nbsp;entry&nbsp;for&nbsp;`\`.</span><br>
<span class="lineno"></span><span class="keyword" id="4944823">var</span>&nbsp;<span class="ident" id="4944827">jsStrNormReplacementTable</span>&nbsp;<span class="op" id="4944853">=</span>&nbsp;<span class="op" id="4944855">[</span><span class="op" id="4944856">]</span><span class="builtintype" id="4944857">string</span><span class="op" id="4944863">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4944866">0</span><span class="op" id="4944867">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4944872">`\0`</span><span class="op" id="4944876">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4944879">&#39;\t&#39;</span><span class="op" id="4944883">:</span>&nbsp;<span class="string" id="4944885">`\t`</span><span class="op" id="4944889">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4944892">&#39;\n&#39;</span><span class="op" id="4944896">:</span>&nbsp;<span class="string" id="4944898">`\n`</span><span class="op" id="4944902">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4944905">&#39;\v&#39;</span><span class="op" id="4944909">:</span>&nbsp;<span class="string" id="4944911">`\x0b`</span><span class="op" id="4944917">,</span>&nbsp;<span class="comment" id="4944919">//&nbsp;&#34;\v&#34;&nbsp;==&nbsp;&#34;v&#34;&nbsp;on&nbsp;IE&nbsp;6.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4944944">&#39;\f&#39;</span><span class="op" id="4944948">:</span>&nbsp;<span class="string" id="4944950">`\f`</span><span class="op" id="4944954">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4944957">&#39;\r&#39;</span><span class="op" id="4944961">:</span>&nbsp;<span class="string" id="4944963">`\r`</span><span class="op" id="4944967">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4944970">//&nbsp;Encode&nbsp;HTML&nbsp;specials&nbsp;as&nbsp;hex&nbsp;so&nbsp;the&nbsp;output&nbsp;can&nbsp;be&nbsp;embedded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4945032">//&nbsp;in&nbsp;HTML&nbsp;attributes&nbsp;without&nbsp;further&nbsp;encoding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4945081">&#39;&#34;&#39;</span><span class="op" id="4945084">:</span>&nbsp;&nbsp;<span class="string" id="4945087">`\x22`</span><span class="op" id="4945093">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4945096">&#39;&amp;&#39;</span><span class="op" id="4945099">:</span>&nbsp;&nbsp;<span class="string" id="4945102">`\x26`</span><span class="op" id="4945108">,</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4945111">&#39;\&#39;&#39;</span><span class="op" id="4945115">:</span>&nbsp;<span class="string" id="4945117">`\x27`</span><span class="op" id="4945123">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4945126">&#39;+&#39;</span><span class="op" id="4945129">:</span>&nbsp;&nbsp;<span class="string" id="4945132">`\x2b`</span><span class="op" id="4945138">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4945141">&#39;/&#39;</span><span class="op" id="4945144">:</span>&nbsp;&nbsp;<span class="string" id="4945147">`\/`</span><span class="op" id="4945151">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4945154">&#39;&lt;&#39;</span><span class="op" id="4945157">:</span>&nbsp;&nbsp;<span class="string" id="4945160">`\x3c`</span><span class="op" id="4945166">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4945169">&#39;&gt;&#39;</span><span class="op" id="4945172">:</span>&nbsp;&nbsp;<span class="string" id="4945175">`\x3e`</span><span class="op" id="4945181">,</span><br>
<span class="lineno">310</span><span class="op" id="4945183">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4945186">var</span>&nbsp;<span class="ident" id="4945190">jsRegexpReplacementTable</span>&nbsp;<span class="op" id="4945215">=</span>&nbsp;<span class="op" id="4945217">[</span><span class="op" id="4945218">]</span><span class="builtintype" id="4945219">string</span><span class="op" id="4945225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4945228">0</span><span class="op" id="4945229">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4945234">`\0`</span><span class="op" id="4945238">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4945241">&#39;\t&#39;</span><span class="op" id="4945245">:</span>&nbsp;<span class="string" id="4945247">`\t`</span><span class="op" id="4945251">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4945254">&#39;\n&#39;</span><span class="op" id="4945258">:</span>&nbsp;<span class="string" id="4945260">`\n`</span><span class="op" id="4945264">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4945267">&#39;\v&#39;</span><span class="op" id="4945271">:</span>&nbsp;<span class="string" id="4945273">`\x0b`</span><span class="op" id="4945279">,</span>&nbsp;<span class="comment" id="4945281">//&nbsp;&#34;\v&#34;&nbsp;==&nbsp;&#34;v&#34;&nbsp;on&nbsp;IE&nbsp;6.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4945306">&#39;\f&#39;</span><span class="op" id="4945310">:</span>&nbsp;<span class="string" id="4945312">`\f`</span><span class="op" id="4945316">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4945319">&#39;\r&#39;</span><span class="op" id="4945323">:</span>&nbsp;<span class="string" id="4945325">`\r`</span><span class="op" id="4945329">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4945332">//&nbsp;Encode&nbsp;HTML&nbsp;specials&nbsp;as&nbsp;hex&nbsp;so&nbsp;the&nbsp;output&nbsp;can&nbsp;be&nbsp;embedded</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4945394">//&nbsp;in&nbsp;HTML&nbsp;attributes&nbsp;without&nbsp;further&nbsp;encoding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4945443">&#39;&#34;&#39;</span><span class="op" id="4945446">:</span>&nbsp;&nbsp;<span class="string" id="4945449">`\x22`</span><span class="op" id="4945455">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4945458">&#39;$&#39;</span><span class="op" id="4945461">:</span>&nbsp;&nbsp;<span class="string" id="4945464">`\$`</span><span class="op" id="4945468">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4945471">&#39;&amp;&#39;</span><span class="op" id="4945474">:</span>&nbsp;&nbsp;<span class="string" id="4945477">`\x26`</span><span class="op" id="4945483">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4945486">&#39;\&#39;&#39;</span><span class="op" id="4945490">:</span>&nbsp;<span class="string" id="4945492">`\x27`</span><span class="op" id="4945498">,</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4945501">&#39;(&#39;</span><span class="op" id="4945504">:</span>&nbsp;&nbsp;<span class="string" id="4945507">`\(`</span><span class="op" id="4945511">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4945514">&#39;)&#39;</span><span class="op" id="4945517">:</span>&nbsp;&nbsp;<span class="string" id="4945520">`\)`</span><span class="op" id="4945524">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4945527">&#39;*&#39;</span><span class="op" id="4945530">:</span>&nbsp;&nbsp;<span class="string" id="4945533">`\*`</span><span class="op" id="4945537">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4945540">&#39;+&#39;</span><span class="op" id="4945543">:</span>&nbsp;&nbsp;<span class="string" id="4945546">`\x2b`</span><span class="op" id="4945552">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4945555">&#39;-&#39;</span><span class="op" id="4945558">:</span>&nbsp;&nbsp;<span class="string" id="4945561">`\-`</span><span class="op" id="4945565">,</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4945568">&#39;.&#39;</span><span class="op" id="4945571">:</span>&nbsp;&nbsp;<span class="string" id="4945574">`\.`</span><span class="op" id="4945578">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4945581">&#39;/&#39;</span><span class="op" id="4945584">:</span>&nbsp;&nbsp;<span class="string" id="4945587">`\/`</span><span class="op" id="4945591">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4945594">&#39;&lt;&#39;</span><span class="op" id="4945597">:</span>&nbsp;&nbsp;<span class="string" id="4945600">`\x3c`</span><span class="op" id="4945606">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4945609">&#39;&gt;&#39;</span><span class="op" id="4945612">:</span>&nbsp;&nbsp;<span class="string" id="4945615">`\x3e`</span><span class="op" id="4945621">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4945624">&#39;?&#39;</span><span class="op" id="4945627">:</span>&nbsp;&nbsp;<span class="string" id="4945630">`\?`</span><span class="op" id="4945634">,</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4945637">&#39;[&#39;</span><span class="op" id="4945640">:</span>&nbsp;&nbsp;<span class="string" id="4945643">`\[`</span><span class="op" id="4945647">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4945650">&#39;\\&#39;</span><span class="op" id="4945654">:</span>&nbsp;<span class="string" id="4945656">`\\`</span><span class="op" id="4945660">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4945663">&#39;]&#39;</span><span class="op" id="4945666">:</span>&nbsp;&nbsp;<span class="string" id="4945669">`\]`</span><span class="op" id="4945673">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4945676">&#39;^&#39;</span><span class="op" id="4945679">:</span>&nbsp;&nbsp;<span class="string" id="4945682">`\^`</span><span class="op" id="4945686">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4945689">&#39;{&#39;</span><span class="op" id="4945692">:</span>&nbsp;&nbsp;<span class="string" id="4945695">`\{`</span><span class="op" id="4945699">,</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4945702">&#39;|&#39;</span><span class="op" id="4945705">:</span>&nbsp;&nbsp;<span class="string" id="4945708">`\|`</span><span class="op" id="4945712">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4945715">&#39;}&#39;</span><span class="op" id="4945718">:</span>&nbsp;&nbsp;<span class="string" id="4945721">`\}`</span><span class="op" id="4945725">,</span><br>
<span class="lineno"></span><span class="op" id="4945727">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4945730">//&nbsp;isJSIdentPart&nbsp;reports&nbsp;whether&nbsp;the&nbsp;given&nbsp;rune&nbsp;is&nbsp;a&nbsp;JS&nbsp;identifier&nbsp;part.</span><br>
<span class="lineno">345</span><span class="comment" id="4945803">//&nbsp;It&nbsp;does&nbsp;not&nbsp;handle&nbsp;all&nbsp;the&nbsp;non-Latin&nbsp;letters,&nbsp;joiners,&nbsp;and&nbsp;combining&nbsp;marks,</span><br>
<span class="lineno"></span><span class="comment" id="4945882">//&nbsp;but&nbsp;it&nbsp;does&nbsp;handle&nbsp;every&nbsp;codepoint&nbsp;that&nbsp;can&nbsp;occur&nbsp;in&nbsp;a&nbsp;numeric&nbsp;literal&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="4945959">//&nbsp;a&nbsp;keyword.</span><br>
<span class="lineno"></span><span class="keyword" id="4945973">func</span>&nbsp;<span class="ident" id="4945978">isJSIdentPart</span><span class="op" id="4945991">(</span><span class="ident" id="4945992">r</span>&nbsp;<span class="builtintype" id="4945994">rune</span><span class="op" id="4945998">)</span>&nbsp;<span class="builtintype" id="4946000">bool</span>&nbsp;<span class="op" id="4946005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4946008">switch</span>&nbsp;<span class="op" id="4946015">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4946018">case</span>&nbsp;<span class="ident" id="4946023"><a href="/gostd/html/template/js.go.html#4945992">r</a></span>&nbsp;<span class="op" id="4946025">==</span>&nbsp;<span class="string" id="4946028">&#39;$&#39;</span><span class="op" id="4946031">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4946035">return</span>&nbsp;<span class="builtintype" id="4946042">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4946048">case</span>&nbsp;<span class="string" id="4946053">&#39;0&#39;</span>&nbsp;<span class="op" id="4946057">&lt;=</span>&nbsp;<span class="ident" id="4946060"><a href="/gostd/html/template/js.go.html#4945992">r</a></span>&nbsp;<span class="op" id="4946062">&amp;&amp;</span>&nbsp;<span class="ident" id="4946065"><a href="/gostd/html/template/js.go.html#4945992">r</a></span>&nbsp;<span class="op" id="4946067">&lt;=</span>&nbsp;<span class="string" id="4946070">&#39;9&#39;</span><span class="op" id="4946073">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4946077">return</span>&nbsp;<span class="builtintype" id="4946084">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4946090">case</span>&nbsp;<span class="string" id="4946095">&#39;A&#39;</span>&nbsp;<span class="op" id="4946099">&lt;=</span>&nbsp;<span class="ident" id="4946102"><a href="/gostd/html/template/js.go.html#4945992">r</a></span>&nbsp;<span class="op" id="4946104">&amp;&amp;</span>&nbsp;<span class="ident" id="4946107"><a href="/gostd/html/template/js.go.html#4945992">r</a></span>&nbsp;<span class="op" id="4946109">&lt;=</span>&nbsp;<span class="string" id="4946112">&#39;Z&#39;</span><span class="op" id="4946115">:</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4946119">return</span>&nbsp;<span class="builtintype" id="4946126">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4946132">case</span>&nbsp;<span class="ident" id="4946137"><a href="/gostd/html/template/js.go.html#4945992">r</a></span>&nbsp;<span class="op" id="4946139">==</span>&nbsp;<span class="string" id="4946142">&#39;_&#39;</span><span class="op" id="4946145">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4946149">return</span>&nbsp;<span class="builtintype" id="4946156">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4946162">case</span>&nbsp;<span class="string" id="4946167">&#39;a&#39;</span>&nbsp;<span class="op" id="4946171">&lt;=</span>&nbsp;<span class="ident" id="4946174"><a href="/gostd/html/template/js.go.html#4945992">r</a></span>&nbsp;<span class="op" id="4946176">&amp;&amp;</span>&nbsp;<span class="ident" id="4946179"><a href="/gostd/html/template/js.go.html#4945992">r</a></span>&nbsp;<span class="op" id="4946181">&lt;=</span>&nbsp;<span class="string" id="4946184">&#39;z&#39;</span><span class="op" id="4946187">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4946191">return</span>&nbsp;<span class="builtintype" id="4946198">true</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4946204">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4946207">return</span>&nbsp;<span class="builtintype" id="4946214">false</span><br>
<span class="lineno"></span><span class="op" id="4946220">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
