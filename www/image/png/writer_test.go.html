<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="8118578">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8118633">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8118687">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8118738">package</span>&nbsp;<span class="ident" id="8118746">png</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8118751">import</span>&nbsp;<span class="op" id="8118758">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8118761">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8118770">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8118777">&#34;image&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8118786">&#34;image/color&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8118801">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8118814">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8118824">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="8118827">func</span>&nbsp;<span class="ident" id="8118832">diff</span><span class="op" id="8118836">(</span><span class="ident" id="8118837">m0</span><span class="op" id="8118839">,</span>&nbsp;<span class="ident" id="8118841">m1</span>&nbsp;<span class="ident" id="8118844">image</span><span class="op" id="8118849">.</span><span class="ident" id="8118850">Image</span><span class="op" id="8118855">)</span>&nbsp;<span class="builtintype" id="8118857">error</span>&nbsp;<span class="op" id="8118863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8118866">b0</span><span class="op" id="8118868">,</span>&nbsp;<span class="ident" id="8118870">b1</span>&nbsp;<span class="op" id="8118873">:=</span>&nbsp;<span class="ident" id="8118876">m0</span><span class="op" id="8118878">.</span><span class="ident" id="8118879">Bounds</span><span class="op" id="8118885">(</span><span class="op" id="8118886">)</span><span class="op" id="8118887">,</span>&nbsp;<span class="ident" id="8118889">m1</span><span class="op" id="8118891">.</span><span class="ident" id="8118892">Bounds</span><span class="op" id="8118898">(</span><span class="op" id="8118899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8118902">if</span>&nbsp;<span class="op" id="8118905">!</span><span class="ident" id="8118906">b0</span><span class="op" id="8118908">.</span><span class="ident" id="8118909">Size</span><span class="op" id="8118913">(</span><span class="op" id="8118914">)</span><span class="op" id="8118915">.</span><span class="ident" id="8118916">Eq</span><span class="op" id="8118918">(</span><span class="ident" id="8118919">b1</span><span class="op" id="8118921">.</span><span class="ident" id="8118922">Size</span><span class="op" id="8118926">(</span><span class="op" id="8118927">)</span><span class="op" id="8118928">)</span>&nbsp;<span class="op" id="8118930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8118934">return</span>&nbsp;<span class="ident" id="8118941">fmt</span><span class="op" id="8118944">.</span><span class="ident" id="8118945">Errorf</span><span class="op" id="8118951">(</span><span class="string" id="8118952">&#34;dimensions&nbsp;differ:&nbsp;%v&nbsp;vs&nbsp;%v&#34;</span><span class="op" id="8118981">,</span>&nbsp;<span class="ident" id="8118983">b0</span><span class="op" id="8118985">,</span>&nbsp;<span class="ident" id="8118987">b1</span><span class="op" id="8118989">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8118992">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8118995">dx</span>&nbsp;<span class="op" id="8118998">:=</span>&nbsp;<span class="ident" id="8119001">b1</span><span class="op" id="8119003">.</span><span class="ident" id="8119004">Min</span><span class="op" id="8119007">.</span><span class="ident" id="8119008">X</span>&nbsp;<span class="op" id="8119010">-</span>&nbsp;<span class="ident" id="8119012">b0</span><span class="op" id="8119014">.</span><span class="ident" id="8119015">Min</span><span class="op" id="8119018">.</span><span class="ident" id="8119019">X</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8119022">dy</span>&nbsp;<span class="op" id="8119025">:=</span>&nbsp;<span class="ident" id="8119028">b1</span><span class="op" id="8119030">.</span><span class="ident" id="8119031">Min</span><span class="op" id="8119034">.</span><span class="ident" id="8119035">Y</span>&nbsp;<span class="op" id="8119037">-</span>&nbsp;<span class="ident" id="8119039">b0</span><span class="op" id="8119041">.</span><span class="ident" id="8119042">Min</span><span class="op" id="8119045">.</span><span class="ident" id="8119046">Y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8119049">for</span>&nbsp;<span class="ident" id="8119053">y</span>&nbsp;<span class="op" id="8119055">:=</span>&nbsp;<span class="ident" id="8119058">b0</span><span class="op" id="8119060">.</span><span class="ident" id="8119061">Min</span><span class="op" id="8119064">.</span><span class="ident" id="8119065">Y</span><span class="op" id="8119066">;</span>&nbsp;<span class="ident" id="8119068">y</span>&nbsp;<span class="op" id="8119070">&lt;</span>&nbsp;<span class="ident" id="8119072">b0</span><span class="op" id="8119074">.</span><span class="ident" id="8119075">Max</span><span class="op" id="8119078">.</span><span class="ident" id="8119079">Y</span><span class="op" id="8119080">;</span>&nbsp;<span class="ident" id="8119082">y</span><span class="op" id="8119083">++</span>&nbsp;<span class="op" id="8119086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8119090">for</span>&nbsp;<span class="ident" id="8119094">x</span>&nbsp;<span class="op" id="8119096">:=</span>&nbsp;<span class="ident" id="8119099">b0</span><span class="op" id="8119101">.</span><span class="ident" id="8119102">Min</span><span class="op" id="8119105">.</span><span class="ident" id="8119106">X</span><span class="op" id="8119107">;</span>&nbsp;<span class="ident" id="8119109">x</span>&nbsp;<span class="op" id="8119111">&lt;</span>&nbsp;<span class="ident" id="8119113">b0</span><span class="op" id="8119115">.</span><span class="ident" id="8119116">Max</span><span class="op" id="8119119">.</span><span class="ident" id="8119120">X</span><span class="op" id="8119121">;</span>&nbsp;<span class="ident" id="8119123">x</span><span class="op" id="8119124">++</span>&nbsp;<span class="op" id="8119127">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8119132">c0</span>&nbsp;<span class="op" id="8119135">:=</span>&nbsp;<span class="ident" id="8119138">m0</span><span class="op" id="8119140">.</span><span class="ident" id="8119141">At</span><span class="op" id="8119143">(</span><span class="ident" id="8119144">x</span><span class="op" id="8119145">,</span>&nbsp;<span class="ident" id="8119147">y</span><span class="op" id="8119148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8119153">c1</span>&nbsp;<span class="op" id="8119156">:=</span>&nbsp;<span class="ident" id="8119159">m1</span><span class="op" id="8119161">.</span><span class="ident" id="8119162">At</span><span class="op" id="8119164">(</span><span class="ident" id="8119165">x</span><span class="op" id="8119166">+</span><span class="ident" id="8119167">dx</span><span class="op" id="8119169">,</span>&nbsp;<span class="ident" id="8119171">y</span><span class="op" id="8119172">+</span><span class="ident" id="8119173">dy</span><span class="op" id="8119175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8119180">r0</span><span class="op" id="8119182">,</span>&nbsp;<span class="ident" id="8119184">g0</span><span class="op" id="8119186">,</span>&nbsp;<span class="ident" id="8119188">b0</span><span class="op" id="8119190">,</span>&nbsp;<span class="ident" id="8119192">a0</span>&nbsp;<span class="op" id="8119195">:=</span>&nbsp;<span class="ident" id="8119198">c0</span><span class="op" id="8119200">.</span><span class="ident" id="8119201">RGBA</span><span class="op" id="8119205">(</span><span class="op" id="8119206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8119211">r1</span><span class="op" id="8119213">,</span>&nbsp;<span class="ident" id="8119215">g1</span><span class="op" id="8119217">,</span>&nbsp;<span class="ident" id="8119219">b1</span><span class="op" id="8119221">,</span>&nbsp;<span class="ident" id="8119223">a1</span>&nbsp;<span class="op" id="8119226">:=</span>&nbsp;<span class="ident" id="8119229">c1</span><span class="op" id="8119231">.</span><span class="ident" id="8119232">RGBA</span><span class="op" id="8119236">(</span><span class="op" id="8119237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8119242">if</span>&nbsp;<span class="ident" id="8119245">r0</span>&nbsp;<span class="op" id="8119248">!=</span>&nbsp;<span class="ident" id="8119251">r1</span>&nbsp;<span class="op" id="8119254">||</span>&nbsp;<span class="ident" id="8119257">g0</span>&nbsp;<span class="op" id="8119260">!=</span>&nbsp;<span class="ident" id="8119263">g1</span>&nbsp;<span class="op" id="8119266">||</span>&nbsp;<span class="ident" id="8119269">b0</span>&nbsp;<span class="op" id="8119272">!=</span>&nbsp;<span class="ident" id="8119275">b1</span>&nbsp;<span class="op" id="8119278">||</span>&nbsp;<span class="ident" id="8119281">a0</span>&nbsp;<span class="op" id="8119284">!=</span>&nbsp;<span class="ident" id="8119287">a1</span>&nbsp;<span class="op" id="8119290">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8119296">return</span>&nbsp;<span class="ident" id="8119303">fmt</span><span class="op" id="8119306">.</span><span class="ident" id="8119307">Errorf</span><span class="op" id="8119313">(</span><span class="string" id="8119314">&#34;colors&nbsp;differ&nbsp;at&nbsp;(%d,&nbsp;%d):&nbsp;%v&nbsp;vs&nbsp;%v&#34;</span><span class="op" id="8119351">,</span>&nbsp;<span class="ident" id="8119353">x</span><span class="op" id="8119354">,</span>&nbsp;<span class="ident" id="8119356">y</span><span class="op" id="8119357">,</span>&nbsp;<span class="ident" id="8119359">c0</span><span class="op" id="8119361">,</span>&nbsp;<span class="ident" id="8119363">c1</span><span class="op" id="8119365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8119370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8119374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8119377">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8119380">return</span>&nbsp;<span class="ident" id="8119387">nil</span><br>
<span class="lineno">35</span><span class="op" id="8119391">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8119394">func</span>&nbsp;<span class="ident" id="8119399">encodeDecode</span><span class="op" id="8119411">(</span><span class="ident" id="8119412">m</span>&nbsp;<span class="ident" id="8119414">image</span><span class="op" id="8119419">.</span><span class="ident" id="8119420">Image</span><span class="op" id="8119425">)</span>&nbsp;<span class="op" id="8119427">(</span><span class="ident" id="8119428">image</span><span class="op" id="8119433">.</span><span class="ident" id="8119434">Image</span><span class="op" id="8119439">,</span>&nbsp;<span class="builtintype" id="8119441">error</span><span class="op" id="8119446">)</span>&nbsp;<span class="op" id="8119448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8119451">var</span>&nbsp;<span class="ident" id="8119455">b</span>&nbsp;<span class="ident" id="8119457">bytes</span><span class="op" id="8119462">.</span><span class="ident" id="8119463">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8119471">err</span>&nbsp;<span class="op" id="8119475">:=</span>&nbsp;<span class="ident" id="8119478">Encode</span><span class="op" id="8119484">(</span><span class="op" id="8119485">&amp;</span><span class="ident" id="8119486">b</span><span class="op" id="8119487">,</span>&nbsp;<span class="ident" id="8119489">m</span><span class="op" id="8119490">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8119493">if</span>&nbsp;<span class="ident" id="8119496">err</span>&nbsp;<span class="op" id="8119500">!=</span>&nbsp;<span class="ident" id="8119503">nil</span>&nbsp;<span class="op" id="8119507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8119511">return</span>&nbsp;<span class="ident" id="8119518">nil</span><span class="op" id="8119521">,</span>&nbsp;<span class="ident" id="8119523">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8119528">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8119531">return</span>&nbsp;<span class="ident" id="8119538">Decode</span><span class="op" id="8119544">(</span><span class="op" id="8119545">&amp;</span><span class="ident" id="8119546">b</span><span class="op" id="8119547">)</span><br>
<span class="lineno"></span><span class="op" id="8119549">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="8119552">func</span>&nbsp;<span class="ident" id="8119557">TestWriter</span><span class="op" id="8119567">(</span><span class="ident" id="8119568">t</span>&nbsp;<span class="op" id="8119570">*</span><span class="ident" id="8119571">testing</span><span class="op" id="8119578">.</span><span class="ident" id="8119579">T</span><span class="op" id="8119580">)</span>&nbsp;<span class="op" id="8119582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8119585">//&nbsp;The&nbsp;filenames&nbsp;variable&nbsp;is&nbsp;declared&nbsp;in&nbsp;reader_test.go.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8119643">names</span>&nbsp;<span class="op" id="8119649">:=</span>&nbsp;<span class="ident" id="8119652">filenames</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8119663">if</span>&nbsp;<span class="ident" id="8119666">testing</span><span class="op" id="8119673">.</span><span class="ident" id="8119674">Short</span><span class="op" id="8119679">(</span><span class="op" id="8119680">)</span>&nbsp;<span class="op" id="8119682">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8119686">names</span>&nbsp;<span class="op" id="8119692">=</span>&nbsp;<span class="ident" id="8119694">filenamesShort</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8119710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8119713">for</span>&nbsp;<span class="ident" id="8119717">_</span><span class="op" id="8119718">,</span>&nbsp;<span class="ident" id="8119720">fn</span>&nbsp;<span class="op" id="8119723">:=</span>&nbsp;<span class="keyword" id="8119726">range</span>&nbsp;<span class="ident" id="8119732">names</span>&nbsp;<span class="op" id="8119738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8119742">qfn</span>&nbsp;<span class="op" id="8119746">:=</span>&nbsp;<span class="string" id="8119749">&#34;testdata/pngsuite/&#34;</span>&nbsp;<span class="op" id="8119770">+</span>&nbsp;<span class="ident" id="8119772">fn</span>&nbsp;<span class="op" id="8119775">+</span>&nbsp;<span class="string" id="8119777">&#34;.png&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8119786">//&nbsp;Read&nbsp;the&nbsp;image.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8119807">m0</span><span class="op" id="8119809">,</span>&nbsp;<span class="ident" id="8119811">err</span>&nbsp;<span class="op" id="8119815">:=</span>&nbsp;<span class="ident" id="8119818">readPNG</span><span class="op" id="8119825">(</span><span class="ident" id="8119826">qfn</span><span class="op" id="8119829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8119833">if</span>&nbsp;<span class="ident" id="8119836">err</span>&nbsp;<span class="op" id="8119840">!=</span>&nbsp;<span class="ident" id="8119843">nil</span>&nbsp;<span class="op" id="8119847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8119852">t</span><span class="op" id="8119853">.</span><span class="ident" id="8119854">Error</span><span class="op" id="8119859">(</span><span class="ident" id="8119860">fn</span><span class="op" id="8119862">,</span>&nbsp;<span class="ident" id="8119864">err</span><span class="op" id="8119867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8119872">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8119883">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8119887">//&nbsp;Read&nbsp;the&nbsp;image&nbsp;again,&nbsp;encode&nbsp;it,&nbsp;and&nbsp;decode&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8119940">m1</span><span class="op" id="8119942">,</span>&nbsp;<span class="ident" id="8119944">err</span>&nbsp;<span class="op" id="8119948">:=</span>&nbsp;<span class="ident" id="8119951">readPNG</span><span class="op" id="8119958">(</span><span class="ident" id="8119959">qfn</span><span class="op" id="8119962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8119966">if</span>&nbsp;<span class="ident" id="8119969">err</span>&nbsp;<span class="op" id="8119973">!=</span>&nbsp;<span class="ident" id="8119976">nil</span>&nbsp;<span class="op" id="8119980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8119985">t</span><span class="op" id="8119986">.</span><span class="ident" id="8119987">Error</span><span class="op" id="8119992">(</span><span class="ident" id="8119993">fn</span><span class="op" id="8119995">,</span>&nbsp;<span class="ident" id="8119997">err</span><span class="op" id="8120000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8120005">return</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8120014">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8120018">m2</span><span class="op" id="8120020">,</span>&nbsp;<span class="ident" id="8120022">err</span>&nbsp;<span class="op" id="8120026">:=</span>&nbsp;<span class="ident" id="8120029">encodeDecode</span><span class="op" id="8120041">(</span><span class="ident" id="8120042">m1</span><span class="op" id="8120044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8120048">if</span>&nbsp;<span class="ident" id="8120051">err</span>&nbsp;<span class="op" id="8120055">!=</span>&nbsp;<span class="ident" id="8120058">nil</span>&nbsp;<span class="op" id="8120062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8120067">t</span><span class="op" id="8120068">.</span><span class="ident" id="8120069">Error</span><span class="op" id="8120074">(</span><span class="ident" id="8120075">fn</span><span class="op" id="8120077">,</span>&nbsp;<span class="ident" id="8120079">err</span><span class="op" id="8120082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8120087">return</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8120096">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8120100">//&nbsp;Compare&nbsp;the&nbsp;two.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8120122">err</span>&nbsp;<span class="op" id="8120126">=</span>&nbsp;<span class="ident" id="8120128">diff</span><span class="op" id="8120132">(</span><span class="ident" id="8120133">m0</span><span class="op" id="8120135">,</span>&nbsp;<span class="ident" id="8120137">m2</span><span class="op" id="8120139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8120143">if</span>&nbsp;<span class="ident" id="8120146">err</span>&nbsp;<span class="op" id="8120150">!=</span>&nbsp;<span class="ident" id="8120153">nil</span>&nbsp;<span class="op" id="8120157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8120162">t</span><span class="op" id="8120163">.</span><span class="ident" id="8120164">Error</span><span class="op" id="8120169">(</span><span class="ident" id="8120170">fn</span><span class="op" id="8120172">,</span>&nbsp;<span class="ident" id="8120174">err</span><span class="op" id="8120177">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8120182">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8120193">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8120196">}</span><br>
<span class="lineno"></span><span class="op" id="8120198">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="8120201">func</span>&nbsp;<span class="ident" id="8120206">TestWriterLevels</span><span class="op" id="8120222">(</span><span class="ident" id="8120223">t</span>&nbsp;<span class="op" id="8120225">*</span><span class="ident" id="8120226">testing</span><span class="op" id="8120233">.</span><span class="ident" id="8120234">T</span><span class="op" id="8120235">)</span>&nbsp;<span class="op" id="8120237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8120240">m</span>&nbsp;<span class="op" id="8120242">:=</span>&nbsp;<span class="ident" id="8120245">image</span><span class="op" id="8120250">.</span><span class="ident" id="8120251">NewNRGBA</span><span class="op" id="8120259">(</span><span class="ident" id="8120260">image</span><span class="op" id="8120265">.</span><span class="ident" id="8120266">Rect</span><span class="op" id="8120270">(</span><span class="num" id="8120271">0</span><span class="op" id="8120272">,</span>&nbsp;<span class="num" id="8120274">0</span><span class="op" id="8120275">,</span>&nbsp;<span class="num" id="8120277">100</span><span class="op" id="8120280">,</span>&nbsp;<span class="num" id="8120282">100</span><span class="op" id="8120285">)</span><span class="op" id="8120286">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8120290">var</span>&nbsp;<span class="ident" id="8120294">b1</span><span class="op" id="8120296">,</span>&nbsp;<span class="ident" id="8120298">b2</span>&nbsp;<span class="ident" id="8120301">bytes</span><span class="op" id="8120306">.</span><span class="ident" id="8120307">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8120315">if</span>&nbsp;<span class="ident" id="8120318">err</span>&nbsp;<span class="op" id="8120322">:=</span>&nbsp;<span class="op" id="8120325">(</span><span class="op" id="8120326">&amp;</span><span class="ident" id="8120327">Encoder</span><span class="op" id="8120334">{</span><span class="op" id="8120335">}</span><span class="op" id="8120336">)</span><span class="op" id="8120337">.</span><span class="ident" id="8120338">Encode</span><span class="op" id="8120344">(</span><span class="op" id="8120345">&amp;</span><span class="ident" id="8120346">b1</span><span class="op" id="8120348">,</span>&nbsp;<span class="ident" id="8120350">m</span><span class="op" id="8120351">)</span><span class="op" id="8120352">;</span>&nbsp;<span class="ident" id="8120354">err</span>&nbsp;<span class="op" id="8120358">!=</span>&nbsp;<span class="ident" id="8120361">nil</span>&nbsp;<span class="op" id="8120365">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8120369">t</span><span class="op" id="8120370">.</span><span class="ident" id="8120371">Fatal</span><span class="op" id="8120376">(</span><span class="ident" id="8120377">err</span><span class="op" id="8120380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8120383">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8120386">noenc</span>&nbsp;<span class="op" id="8120392">:=</span>&nbsp;<span class="op" id="8120395">&amp;</span><span class="ident" id="8120396">Encoder</span><span class="op" id="8120403">{</span><span class="ident" id="8120404">CompressionLevel</span><span class="op" id="8120420">:</span>&nbsp;<span class="ident" id="8120422">NoCompression</span><span class="op" id="8120435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8120438">if</span>&nbsp;<span class="ident" id="8120441">err</span>&nbsp;<span class="op" id="8120445">:=</span>&nbsp;<span class="ident" id="8120448">noenc</span><span class="op" id="8120453">.</span><span class="ident" id="8120454">Encode</span><span class="op" id="8120460">(</span><span class="op" id="8120461">&amp;</span><span class="ident" id="8120462">b2</span><span class="op" id="8120464">,</span>&nbsp;<span class="ident" id="8120466">m</span><span class="op" id="8120467">)</span><span class="op" id="8120468">;</span>&nbsp;<span class="ident" id="8120470">err</span>&nbsp;<span class="op" id="8120474">!=</span>&nbsp;<span class="ident" id="8120477">nil</span>&nbsp;<span class="op" id="8120481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8120485">t</span><span class="op" id="8120486">.</span><span class="ident" id="8120487">Fatal</span><span class="op" id="8120492">(</span><span class="ident" id="8120493">err</span><span class="op" id="8120496">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8120499">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8120503">if</span>&nbsp;<span class="ident" id="8120506">b2</span><span class="op" id="8120508">.</span><span class="ident" id="8120509">Len</span><span class="op" id="8120512">(</span><span class="op" id="8120513">)</span>&nbsp;<span class="op" id="8120515">&lt;=</span>&nbsp;<span class="ident" id="8120518">b1</span><span class="op" id="8120520">.</span><span class="ident" id="8120521">Len</span><span class="op" id="8120524">(</span><span class="op" id="8120525">)</span>&nbsp;<span class="op" id="8120527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8120531">t</span><span class="op" id="8120532">.</span><span class="ident" id="8120533">Error</span><span class="op" id="8120538">(</span><span class="string" id="8120539">&#34;DefaultCompression&nbsp;encoding&nbsp;was&nbsp;larger&nbsp;than&nbsp;NoCompression&nbsp;encoding&#34;</span><span class="op" id="8120607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8120610">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8120613">if</span>&nbsp;<span class="ident" id="8120616">_</span><span class="op" id="8120617">,</span>&nbsp;<span class="ident" id="8120619">err</span>&nbsp;<span class="op" id="8120623">:=</span>&nbsp;<span class="ident" id="8120626">Decode</span><span class="op" id="8120632">(</span><span class="op" id="8120633">&amp;</span><span class="ident" id="8120634">b1</span><span class="op" id="8120636">)</span><span class="op" id="8120637">;</span>&nbsp;<span class="ident" id="8120639">err</span>&nbsp;<span class="op" id="8120643">!=</span>&nbsp;<span class="ident" id="8120646">nil</span>&nbsp;<span class="op" id="8120650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8120654">t</span><span class="op" id="8120655">.</span><span class="ident" id="8120656">Error</span><span class="op" id="8120661">(</span><span class="string" id="8120662">&#34;cannot&nbsp;decode&nbsp;DefaultCompression&#34;</span><span class="op" id="8120696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8120699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8120702">if</span>&nbsp;<span class="ident" id="8120705">_</span><span class="op" id="8120706">,</span>&nbsp;<span class="ident" id="8120708">err</span>&nbsp;<span class="op" id="8120712">:=</span>&nbsp;<span class="ident" id="8120715">Decode</span><span class="op" id="8120721">(</span><span class="op" id="8120722">&amp;</span><span class="ident" id="8120723">b2</span><span class="op" id="8120725">)</span><span class="op" id="8120726">;</span>&nbsp;<span class="ident" id="8120728">err</span>&nbsp;<span class="op" id="8120732">!=</span>&nbsp;<span class="ident" id="8120735">nil</span>&nbsp;<span class="op" id="8120739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8120743">t</span><span class="op" id="8120744">.</span><span class="ident" id="8120745">Error</span><span class="op" id="8120750">(</span><span class="string" id="8120751">&#34;cannot&nbsp;decode&nbsp;NoCompression&#34;</span><span class="op" id="8120780">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8120783">}</span><br>
<span class="lineno"></span><span class="op" id="8120785">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8120788">func</span>&nbsp;<span class="ident" id="8120793">TestSubImage</span><span class="op" id="8120805">(</span><span class="ident" id="8120806">t</span>&nbsp;<span class="op" id="8120808">*</span><span class="ident" id="8120809">testing</span><span class="op" id="8120816">.</span><span class="ident" id="8120817">T</span><span class="op" id="8120818">)</span>&nbsp;<span class="op" id="8120820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8120823">m0</span>&nbsp;<span class="op" id="8120826">:=</span>&nbsp;<span class="ident" id="8120829">image</span><span class="op" id="8120834">.</span><span class="ident" id="8120835">NewRGBA</span><span class="op" id="8120842">(</span><span class="ident" id="8120843">image</span><span class="op" id="8120848">.</span><span class="ident" id="8120849">Rect</span><span class="op" id="8120853">(</span><span class="num" id="8120854">0</span><span class="op" id="8120855">,</span>&nbsp;<span class="num" id="8120857">0</span><span class="op" id="8120858">,</span>&nbsp;<span class="num" id="8120860">256</span><span class="op" id="8120863">,</span>&nbsp;<span class="num" id="8120865">256</span><span class="op" id="8120868">)</span><span class="op" id="8120869">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8120872">for</span>&nbsp;<span class="ident" id="8120876">y</span>&nbsp;<span class="op" id="8120878">:=</span>&nbsp;<span class="num" id="8120881">0</span><span class="op" id="8120882">;</span>&nbsp;<span class="ident" id="8120884">y</span>&nbsp;<span class="op" id="8120886">&lt;</span>&nbsp;<span class="num" id="8120888">256</span><span class="op" id="8120891">;</span>&nbsp;<span class="ident" id="8120893">y</span><span class="op" id="8120894">++</span>&nbsp;<span class="op" id="8120897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8120901">for</span>&nbsp;<span class="ident" id="8120905">x</span>&nbsp;<span class="op" id="8120907">:=</span>&nbsp;<span class="num" id="8120910">0</span><span class="op" id="8120911">;</span>&nbsp;<span class="ident" id="8120913">x</span>&nbsp;<span class="op" id="8120915">&lt;</span>&nbsp;<span class="num" id="8120917">256</span><span class="op" id="8120920">;</span>&nbsp;<span class="ident" id="8120922">x</span><span class="op" id="8120923">++</span>&nbsp;<span class="op" id="8120926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8120931">m0</span><span class="op" id="8120933">.</span><span class="ident" id="8120934">Set</span><span class="op" id="8120937">(</span><span class="ident" id="8120938">x</span><span class="op" id="8120939">,</span>&nbsp;<span class="ident" id="8120941">y</span><span class="op" id="8120942">,</span>&nbsp;<span class="ident" id="8120944">color</span><span class="op" id="8120949">.</span><span class="ident" id="8120950">RGBA</span><span class="op" id="8120954">{</span><span class="builtintype" id="8120955">uint8</span><span class="op" id="8120960">(</span><span class="ident" id="8120961">x</span><span class="op" id="8120962">)</span><span class="op" id="8120963">,</span>&nbsp;<span class="builtintype" id="8120965">uint8</span><span class="op" id="8120970">(</span><span class="ident" id="8120971">y</span><span class="op" id="8120972">)</span><span class="op" id="8120973">,</span>&nbsp;<span class="num" id="8120975">0</span><span class="op" id="8120976">,</span>&nbsp;<span class="num" id="8120978">255</span><span class="op" id="8120981">}</span><span class="op" id="8120982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8120986">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8120989">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8120992">m0</span>&nbsp;<span class="op" id="8120995">=</span>&nbsp;<span class="ident" id="8120997">m0</span><span class="op" id="8120999">.</span><span class="ident" id="8121000">SubImage</span><span class="op" id="8121008">(</span><span class="ident" id="8121009">image</span><span class="op" id="8121014">.</span><span class="ident" id="8121015">Rect</span><span class="op" id="8121019">(</span><span class="num" id="8121020">50</span><span class="op" id="8121022">,</span>&nbsp;<span class="num" id="8121024">30</span><span class="op" id="8121026">,</span>&nbsp;<span class="num" id="8121028">250</span><span class="op" id="8121031">,</span>&nbsp;<span class="num" id="8121033">130</span><span class="op" id="8121036">)</span><span class="op" id="8121037">)</span><span class="op" id="8121038">.</span><span class="op" id="8121039">(</span><span class="op" id="8121040">*</span><span class="ident" id="8121041">image</span><span class="op" id="8121046">.</span><span class="ident" id="8121047">RGBA</span><span class="op" id="8121051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8121054">m1</span><span class="op" id="8121056">,</span>&nbsp;<span class="ident" id="8121058">err</span>&nbsp;<span class="op" id="8121062">:=</span>&nbsp;<span class="ident" id="8121065">encodeDecode</span><span class="op" id="8121077">(</span><span class="ident" id="8121078">m0</span><span class="op" id="8121080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8121083">if</span>&nbsp;<span class="ident" id="8121086">err</span>&nbsp;<span class="op" id="8121090">!=</span>&nbsp;<span class="ident" id="8121093">nil</span>&nbsp;<span class="op" id="8121097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8121101">t</span><span class="op" id="8121102">.</span><span class="ident" id="8121103">Error</span><span class="op" id="8121108">(</span><span class="ident" id="8121109">err</span><span class="op" id="8121112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8121116">return</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8121124">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8121127">err</span>&nbsp;<span class="op" id="8121131">=</span>&nbsp;<span class="ident" id="8121133">diff</span><span class="op" id="8121137">(</span><span class="ident" id="8121138">m0</span><span class="op" id="8121140">,</span>&nbsp;<span class="ident" id="8121142">m1</span><span class="op" id="8121144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8121147">if</span>&nbsp;<span class="ident" id="8121150">err</span>&nbsp;<span class="op" id="8121154">!=</span>&nbsp;<span class="ident" id="8121157">nil</span>&nbsp;<span class="op" id="8121161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8121165">t</span><span class="op" id="8121166">.</span><span class="ident" id="8121167">Error</span><span class="op" id="8121172">(</span><span class="ident" id="8121173">err</span><span class="op" id="8121176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8121180">return</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8121188">}</span><br>
<span class="lineno"></span><span class="op" id="8121190">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8121193">func</span>&nbsp;<span class="ident" id="8121198">BenchmarkEncodeGray</span><span class="op" id="8121217">(</span><span class="ident" id="8121218">b</span>&nbsp;<span class="op" id="8121220">*</span><span class="ident" id="8121221">testing</span><span class="op" id="8121228">.</span><span class="ident" id="8121229">B</span><span class="op" id="8121230">)</span>&nbsp;<span class="op" id="8121232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8121235">b</span><span class="op" id="8121236">.</span><span class="ident" id="8121237">StopTimer</span><span class="op" id="8121246">(</span><span class="op" id="8121247">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8121250">img</span>&nbsp;<span class="op" id="8121254">:=</span>&nbsp;<span class="ident" id="8121257">image</span><span class="op" id="8121262">.</span><span class="ident" id="8121263">NewGray</span><span class="op" id="8121270">(</span><span class="ident" id="8121271">image</span><span class="op" id="8121276">.</span><span class="ident" id="8121277">Rect</span><span class="op" id="8121281">(</span><span class="num" id="8121282">0</span><span class="op" id="8121283">,</span>&nbsp;<span class="num" id="8121285">0</span><span class="op" id="8121286">,</span>&nbsp;<span class="num" id="8121288">640</span><span class="op" id="8121291">,</span>&nbsp;<span class="num" id="8121293">480</span><span class="op" id="8121296">)</span><span class="op" id="8121297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8121300">b</span><span class="op" id="8121301">.</span><span class="ident" id="8121302">SetBytes</span><span class="op" id="8121310">(</span><span class="num" id="8121311">640</span>&nbsp;<span class="op" id="8121315">*</span>&nbsp;<span class="num" id="8121317">480</span>&nbsp;<span class="op" id="8121321">*</span>&nbsp;<span class="num" id="8121323">1</span><span class="op" id="8121324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8121327">b</span><span class="op" id="8121328">.</span><span class="ident" id="8121329">StartTimer</span><span class="op" id="8121339">(</span><span class="op" id="8121340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8121343">for</span>&nbsp;<span class="ident" id="8121347">i</span>&nbsp;<span class="op" id="8121349">:=</span>&nbsp;<span class="num" id="8121352">0</span><span class="op" id="8121353">;</span>&nbsp;<span class="ident" id="8121355">i</span>&nbsp;<span class="op" id="8121357">&lt;</span>&nbsp;<span class="ident" id="8121359">b</span><span class="op" id="8121360">.</span><span class="ident" id="8121361">N</span><span class="op" id="8121362">;</span>&nbsp;<span class="ident" id="8121364">i</span><span class="op" id="8121365">++</span>&nbsp;<span class="op" id="8121368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8121372">Encode</span><span class="op" id="8121378">(</span><span class="ident" id="8121379">ioutil</span><span class="op" id="8121385">.</span><span class="ident" id="8121386">Discard</span><span class="op" id="8121393">,</span>&nbsp;<span class="ident" id="8121395">img</span><span class="op" id="8121398">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8121401">}</span><br>
<span class="lineno"></span><span class="op" id="8121403">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8121406">func</span>&nbsp;<span class="ident" id="8121411">BenchmarkEncodeNRGBOpaque</span><span class="op" id="8121436">(</span><span class="ident" id="8121437">b</span>&nbsp;<span class="op" id="8121439">*</span><span class="ident" id="8121440">testing</span><span class="op" id="8121447">.</span><span class="ident" id="8121448">B</span><span class="op" id="8121449">)</span>&nbsp;<span class="op" id="8121451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8121454">b</span><span class="op" id="8121455">.</span><span class="ident" id="8121456">StopTimer</span><span class="op" id="8121465">(</span><span class="op" id="8121466">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8121469">img</span>&nbsp;<span class="op" id="8121473">:=</span>&nbsp;<span class="ident" id="8121476">image</span><span class="op" id="8121481">.</span><span class="ident" id="8121482">NewNRGBA</span><span class="op" id="8121490">(</span><span class="ident" id="8121491">image</span><span class="op" id="8121496">.</span><span class="ident" id="8121497">Rect</span><span class="op" id="8121501">(</span><span class="num" id="8121502">0</span><span class="op" id="8121503">,</span>&nbsp;<span class="num" id="8121505">0</span><span class="op" id="8121506">,</span>&nbsp;<span class="num" id="8121508">640</span><span class="op" id="8121511">,</span>&nbsp;<span class="num" id="8121513">480</span><span class="op" id="8121516">)</span><span class="op" id="8121517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8121520">//&nbsp;Set&nbsp;all&nbsp;pixels&nbsp;to&nbsp;0xFF&nbsp;alpha&nbsp;to&nbsp;force&nbsp;opaque&nbsp;mode.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8121575">bo</span>&nbsp;<span class="op" id="8121578">:=</span>&nbsp;<span class="ident" id="8121581">img</span><span class="op" id="8121584">.</span><span class="ident" id="8121585">Bounds</span><span class="op" id="8121591">(</span><span class="op" id="8121592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8121595">for</span>&nbsp;<span class="ident" id="8121599">y</span>&nbsp;<span class="op" id="8121601">:=</span>&nbsp;<span class="ident" id="8121604">bo</span><span class="op" id="8121606">.</span><span class="ident" id="8121607">Min</span><span class="op" id="8121610">.</span><span class="ident" id="8121611">Y</span><span class="op" id="8121612">;</span>&nbsp;<span class="ident" id="8121614">y</span>&nbsp;<span class="op" id="8121616">&lt;</span>&nbsp;<span class="ident" id="8121618">bo</span><span class="op" id="8121620">.</span><span class="ident" id="8121621">Max</span><span class="op" id="8121624">.</span><span class="ident" id="8121625">Y</span><span class="op" id="8121626">;</span>&nbsp;<span class="ident" id="8121628">y</span><span class="op" id="8121629">++</span>&nbsp;<span class="op" id="8121632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8121636">for</span>&nbsp;<span class="ident" id="8121640">x</span>&nbsp;<span class="op" id="8121642">:=</span>&nbsp;<span class="ident" id="8121645">bo</span><span class="op" id="8121647">.</span><span class="ident" id="8121648">Min</span><span class="op" id="8121651">.</span><span class="ident" id="8121652">X</span><span class="op" id="8121653">;</span>&nbsp;<span class="ident" id="8121655">x</span>&nbsp;<span class="op" id="8121657">&lt;</span>&nbsp;<span class="ident" id="8121659">bo</span><span class="op" id="8121661">.</span><span class="ident" id="8121662">Max</span><span class="op" id="8121665">.</span><span class="ident" id="8121666">X</span><span class="op" id="8121667">;</span>&nbsp;<span class="ident" id="8121669">x</span><span class="op" id="8121670">++</span>&nbsp;<span class="op" id="8121673">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8121678">img</span><span class="op" id="8121681">.</span><span class="ident" id="8121682">Set</span><span class="op" id="8121685">(</span><span class="ident" id="8121686">x</span><span class="op" id="8121687">,</span>&nbsp;<span class="ident" id="8121689">y</span><span class="op" id="8121690">,</span>&nbsp;<span class="ident" id="8121692">color</span><span class="op" id="8121697">.</span><span class="ident" id="8121698">NRGBA</span><span class="op" id="8121703">{</span><span class="num" id="8121704">0</span><span class="op" id="8121705">,</span>&nbsp;<span class="num" id="8121707">0</span><span class="op" id="8121708">,</span>&nbsp;<span class="num" id="8121710">0</span><span class="op" id="8121711">,</span>&nbsp;<span class="num" id="8121713">255</span><span class="op" id="8121716">}</span><span class="op" id="8121717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8121721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8121724">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8121727">if</span>&nbsp;<span class="op" id="8121730">!</span><span class="ident" id="8121731">img</span><span class="op" id="8121734">.</span><span class="ident" id="8121735">Opaque</span><span class="op" id="8121741">(</span><span class="op" id="8121742">)</span>&nbsp;<span class="op" id="8121744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8121748">b</span><span class="op" id="8121749">.</span><span class="ident" id="8121750">Fatal</span><span class="op" id="8121755">(</span><span class="string" id="8121756">&#34;expected&nbsp;image&nbsp;to&nbsp;be&nbsp;opaque&#34;</span><span class="op" id="8121785">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8121788">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8121791">b</span><span class="op" id="8121792">.</span><span class="ident" id="8121793">SetBytes</span><span class="op" id="8121801">(</span><span class="num" id="8121802">640</span>&nbsp;<span class="op" id="8121806">*</span>&nbsp;<span class="num" id="8121808">480</span>&nbsp;<span class="op" id="8121812">*</span>&nbsp;<span class="num" id="8121814">4</span><span class="op" id="8121815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8121818">b</span><span class="op" id="8121819">.</span><span class="ident" id="8121820">StartTimer</span><span class="op" id="8121830">(</span><span class="op" id="8121831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8121834">for</span>&nbsp;<span class="ident" id="8121838">i</span>&nbsp;<span class="op" id="8121840">:=</span>&nbsp;<span class="num" id="8121843">0</span><span class="op" id="8121844">;</span>&nbsp;<span class="ident" id="8121846">i</span>&nbsp;<span class="op" id="8121848">&lt;</span>&nbsp;<span class="ident" id="8121850">b</span><span class="op" id="8121851">.</span><span class="ident" id="8121852">N</span><span class="op" id="8121853">;</span>&nbsp;<span class="ident" id="8121855">i</span><span class="op" id="8121856">++</span>&nbsp;<span class="op" id="8121859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8121863">Encode</span><span class="op" id="8121869">(</span><span class="ident" id="8121870">ioutil</span><span class="op" id="8121876">.</span><span class="ident" id="8121877">Discard</span><span class="op" id="8121884">,</span>&nbsp;<span class="ident" id="8121886">img</span><span class="op" id="8121889">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8121892">}</span><br>
<span class="lineno"></span><span class="op" id="8121894">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8121897">func</span>&nbsp;<span class="ident" id="8121902">BenchmarkEncodeNRGBA</span><span class="op" id="8121922">(</span><span class="ident" id="8121923">b</span>&nbsp;<span class="op" id="8121925">*</span><span class="ident" id="8121926">testing</span><span class="op" id="8121933">.</span><span class="ident" id="8121934">B</span><span class="op" id="8121935">)</span>&nbsp;<span class="op" id="8121937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8121940">b</span><span class="op" id="8121941">.</span><span class="ident" id="8121942">StopTimer</span><span class="op" id="8121951">(</span><span class="op" id="8121952">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8121955">img</span>&nbsp;<span class="op" id="8121959">:=</span>&nbsp;<span class="ident" id="8121962">image</span><span class="op" id="8121967">.</span><span class="ident" id="8121968">NewNRGBA</span><span class="op" id="8121976">(</span><span class="ident" id="8121977">image</span><span class="op" id="8121982">.</span><span class="ident" id="8121983">Rect</span><span class="op" id="8121987">(</span><span class="num" id="8121988">0</span><span class="op" id="8121989">,</span>&nbsp;<span class="num" id="8121991">0</span><span class="op" id="8121992">,</span>&nbsp;<span class="num" id="8121994">640</span><span class="op" id="8121997">,</span>&nbsp;<span class="num" id="8121999">480</span><span class="op" id="8122002">)</span><span class="op" id="8122003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8122006">if</span>&nbsp;<span class="ident" id="8122009">img</span><span class="op" id="8122012">.</span><span class="ident" id="8122013">Opaque</span><span class="op" id="8122019">(</span><span class="op" id="8122020">)</span>&nbsp;<span class="op" id="8122022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8122026">b</span><span class="op" id="8122027">.</span><span class="ident" id="8122028">Fatal</span><span class="op" id="8122033">(</span><span class="string" id="8122034">&#34;expected&nbsp;image&nbsp;not&nbsp;to&nbsp;be&nbsp;opaque&#34;</span><span class="op" id="8122067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8122070">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8122073">b</span><span class="op" id="8122074">.</span><span class="ident" id="8122075">SetBytes</span><span class="op" id="8122083">(</span><span class="num" id="8122084">640</span>&nbsp;<span class="op" id="8122088">*</span>&nbsp;<span class="num" id="8122090">480</span>&nbsp;<span class="op" id="8122094">*</span>&nbsp;<span class="num" id="8122096">4</span><span class="op" id="8122097">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8122100">b</span><span class="op" id="8122101">.</span><span class="ident" id="8122102">StartTimer</span><span class="op" id="8122112">(</span><span class="op" id="8122113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8122116">for</span>&nbsp;<span class="ident" id="8122120">i</span>&nbsp;<span class="op" id="8122122">:=</span>&nbsp;<span class="num" id="8122125">0</span><span class="op" id="8122126">;</span>&nbsp;<span class="ident" id="8122128">i</span>&nbsp;<span class="op" id="8122130">&lt;</span>&nbsp;<span class="ident" id="8122132">b</span><span class="op" id="8122133">.</span><span class="ident" id="8122134">N</span><span class="op" id="8122135">;</span>&nbsp;<span class="ident" id="8122137">i</span><span class="op" id="8122138">++</span>&nbsp;<span class="op" id="8122141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8122145">Encode</span><span class="op" id="8122151">(</span><span class="ident" id="8122152">ioutil</span><span class="op" id="8122158">.</span><span class="ident" id="8122159">Discard</span><span class="op" id="8122166">,</span>&nbsp;<span class="ident" id="8122168">img</span><span class="op" id="8122171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8122174">}</span><br>
<span class="lineno"></span><span class="op" id="8122176">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="keyword" id="8122179">func</span>&nbsp;<span class="ident" id="8122184">BenchmarkEncodePaletted</span><span class="op" id="8122207">(</span><span class="ident" id="8122208">b</span>&nbsp;<span class="op" id="8122210">*</span><span class="ident" id="8122211">testing</span><span class="op" id="8122218">.</span><span class="ident" id="8122219">B</span><span class="op" id="8122220">)</span>&nbsp;<span class="op" id="8122222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8122225">b</span><span class="op" id="8122226">.</span><span class="ident" id="8122227">StopTimer</span><span class="op" id="8122236">(</span><span class="op" id="8122237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8122240">img</span>&nbsp;<span class="op" id="8122244">:=</span>&nbsp;<span class="ident" id="8122247">image</span><span class="op" id="8122252">.</span><span class="ident" id="8122253">NewPaletted</span><span class="op" id="8122264">(</span><span class="ident" id="8122265">image</span><span class="op" id="8122270">.</span><span class="ident" id="8122271">Rect</span><span class="op" id="8122275">(</span><span class="num" id="8122276">0</span><span class="op" id="8122277">,</span>&nbsp;<span class="num" id="8122279">0</span><span class="op" id="8122280">,</span>&nbsp;<span class="num" id="8122282">640</span><span class="op" id="8122285">,</span>&nbsp;<span class="num" id="8122287">480</span><span class="op" id="8122290">)</span><span class="op" id="8122291">,</span>&nbsp;<span class="ident" id="8122293">color</span><span class="op" id="8122298">.</span><span class="ident" id="8122299">Palette</span><span class="op" id="8122306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8122310">color</span><span class="op" id="8122315">.</span><span class="ident" id="8122316">RGBA</span><span class="op" id="8122320">{</span><span class="num" id="8122321">0</span><span class="op" id="8122322">,</span>&nbsp;<span class="num" id="8122324">0</span><span class="op" id="8122325">,</span>&nbsp;<span class="num" id="8122327">0</span><span class="op" id="8122328">,</span>&nbsp;<span class="num" id="8122330">255</span><span class="op" id="8122333">}</span><span class="op" id="8122334">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8122338">color</span><span class="op" id="8122343">.</span><span class="ident" id="8122344">RGBA</span><span class="op" id="8122348">{</span><span class="num" id="8122349">255</span><span class="op" id="8122352">,</span>&nbsp;<span class="num" id="8122354">255</span><span class="op" id="8122357">,</span>&nbsp;<span class="num" id="8122359">255</span><span class="op" id="8122362">,</span>&nbsp;<span class="num" id="8122364">255</span><span class="op" id="8122367">}</span><span class="op" id="8122368">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8122371">}</span><span class="op" id="8122372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8122375">b</span><span class="op" id="8122376">.</span><span class="ident" id="8122377">SetBytes</span><span class="op" id="8122385">(</span><span class="num" id="8122386">640</span>&nbsp;<span class="op" id="8122390">*</span>&nbsp;<span class="num" id="8122392">480</span>&nbsp;<span class="op" id="8122396">*</span>&nbsp;<span class="num" id="8122398">1</span><span class="op" id="8122399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8122402">b</span><span class="op" id="8122403">.</span><span class="ident" id="8122404">StartTimer</span><span class="op" id="8122414">(</span><span class="op" id="8122415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8122418">for</span>&nbsp;<span class="ident" id="8122422">i</span>&nbsp;<span class="op" id="8122424">:=</span>&nbsp;<span class="num" id="8122427">0</span><span class="op" id="8122428">;</span>&nbsp;<span class="ident" id="8122430">i</span>&nbsp;<span class="op" id="8122432">&lt;</span>&nbsp;<span class="ident" id="8122434">b</span><span class="op" id="8122435">.</span><span class="ident" id="8122436">N</span><span class="op" id="8122437">;</span>&nbsp;<span class="ident" id="8122439">i</span><span class="op" id="8122440">++</span>&nbsp;<span class="op" id="8122443">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8122447">Encode</span><span class="op" id="8122453">(</span><span class="ident" id="8122454">ioutil</span><span class="op" id="8122460">.</span><span class="ident" id="8122461">Discard</span><span class="op" id="8122468">,</span>&nbsp;<span class="ident" id="8122470">img</span><span class="op" id="8122473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8122476">}</span><br>
<span class="lineno"></span><span class="op" id="8122478">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8122481">func</span>&nbsp;<span class="ident" id="8122486">BenchmarkEncodeRGBOpaque</span><span class="op" id="8122510">(</span><span class="ident" id="8122511">b</span>&nbsp;<span class="op" id="8122513">*</span><span class="ident" id="8122514">testing</span><span class="op" id="8122521">.</span><span class="ident" id="8122522">B</span><span class="op" id="8122523">)</span>&nbsp;<span class="op" id="8122525">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8122528">b</span><span class="op" id="8122529">.</span><span class="ident" id="8122530">StopTimer</span><span class="op" id="8122539">(</span><span class="op" id="8122540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8122543">img</span>&nbsp;<span class="op" id="8122547">:=</span>&nbsp;<span class="ident" id="8122550">image</span><span class="op" id="8122555">.</span><span class="ident" id="8122556">NewRGBA</span><span class="op" id="8122563">(</span><span class="ident" id="8122564">image</span><span class="op" id="8122569">.</span><span class="ident" id="8122570">Rect</span><span class="op" id="8122574">(</span><span class="num" id="8122575">0</span><span class="op" id="8122576">,</span>&nbsp;<span class="num" id="8122578">0</span><span class="op" id="8122579">,</span>&nbsp;<span class="num" id="8122581">640</span><span class="op" id="8122584">,</span>&nbsp;<span class="num" id="8122586">480</span><span class="op" id="8122589">)</span><span class="op" id="8122590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8122593">//&nbsp;Set&nbsp;all&nbsp;pixels&nbsp;to&nbsp;0xFF&nbsp;alpha&nbsp;to&nbsp;force&nbsp;opaque&nbsp;mode.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8122648">bo</span>&nbsp;<span class="op" id="8122651">:=</span>&nbsp;<span class="ident" id="8122654">img</span><span class="op" id="8122657">.</span><span class="ident" id="8122658">Bounds</span><span class="op" id="8122664">(</span><span class="op" id="8122665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8122668">for</span>&nbsp;<span class="ident" id="8122672">y</span>&nbsp;<span class="op" id="8122674">:=</span>&nbsp;<span class="ident" id="8122677">bo</span><span class="op" id="8122679">.</span><span class="ident" id="8122680">Min</span><span class="op" id="8122683">.</span><span class="ident" id="8122684">Y</span><span class="op" id="8122685">;</span>&nbsp;<span class="ident" id="8122687">y</span>&nbsp;<span class="op" id="8122689">&lt;</span>&nbsp;<span class="ident" id="8122691">bo</span><span class="op" id="8122693">.</span><span class="ident" id="8122694">Max</span><span class="op" id="8122697">.</span><span class="ident" id="8122698">Y</span><span class="op" id="8122699">;</span>&nbsp;<span class="ident" id="8122701">y</span><span class="op" id="8122702">++</span>&nbsp;<span class="op" id="8122705">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8122709">for</span>&nbsp;<span class="ident" id="8122713">x</span>&nbsp;<span class="op" id="8122715">:=</span>&nbsp;<span class="ident" id="8122718">bo</span><span class="op" id="8122720">.</span><span class="ident" id="8122721">Min</span><span class="op" id="8122724">.</span><span class="ident" id="8122725">X</span><span class="op" id="8122726">;</span>&nbsp;<span class="ident" id="8122728">x</span>&nbsp;<span class="op" id="8122730">&lt;</span>&nbsp;<span class="ident" id="8122732">bo</span><span class="op" id="8122734">.</span><span class="ident" id="8122735">Max</span><span class="op" id="8122738">.</span><span class="ident" id="8122739">X</span><span class="op" id="8122740">;</span>&nbsp;<span class="ident" id="8122742">x</span><span class="op" id="8122743">++</span>&nbsp;<span class="op" id="8122746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8122751">img</span><span class="op" id="8122754">.</span><span class="ident" id="8122755">Set</span><span class="op" id="8122758">(</span><span class="ident" id="8122759">x</span><span class="op" id="8122760">,</span>&nbsp;<span class="ident" id="8122762">y</span><span class="op" id="8122763">,</span>&nbsp;<span class="ident" id="8122765">color</span><span class="op" id="8122770">.</span><span class="ident" id="8122771">RGBA</span><span class="op" id="8122775">{</span><span class="num" id="8122776">0</span><span class="op" id="8122777">,</span>&nbsp;<span class="num" id="8122779">0</span><span class="op" id="8122780">,</span>&nbsp;<span class="num" id="8122782">0</span><span class="op" id="8122783">,</span>&nbsp;<span class="num" id="8122785">255</span><span class="op" id="8122788">}</span><span class="op" id="8122789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8122793">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8122796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8122799">if</span>&nbsp;<span class="op" id="8122802">!</span><span class="ident" id="8122803">img</span><span class="op" id="8122806">.</span><span class="ident" id="8122807">Opaque</span><span class="op" id="8122813">(</span><span class="op" id="8122814">)</span>&nbsp;<span class="op" id="8122816">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8122820">b</span><span class="op" id="8122821">.</span><span class="ident" id="8122822">Fatal</span><span class="op" id="8122827">(</span><span class="string" id="8122828">&#34;expected&nbsp;image&nbsp;to&nbsp;be&nbsp;opaque&#34;</span><span class="op" id="8122857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8122860">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8122863">b</span><span class="op" id="8122864">.</span><span class="ident" id="8122865">SetBytes</span><span class="op" id="8122873">(</span><span class="num" id="8122874">640</span>&nbsp;<span class="op" id="8122878">*</span>&nbsp;<span class="num" id="8122880">480</span>&nbsp;<span class="op" id="8122884">*</span>&nbsp;<span class="num" id="8122886">4</span><span class="op" id="8122887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8122890">b</span><span class="op" id="8122891">.</span><span class="ident" id="8122892">StartTimer</span><span class="op" id="8122902">(</span><span class="op" id="8122903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8122906">for</span>&nbsp;<span class="ident" id="8122910">i</span>&nbsp;<span class="op" id="8122912">:=</span>&nbsp;<span class="num" id="8122915">0</span><span class="op" id="8122916">;</span>&nbsp;<span class="ident" id="8122918">i</span>&nbsp;<span class="op" id="8122920">&lt;</span>&nbsp;<span class="ident" id="8122922">b</span><span class="op" id="8122923">.</span><span class="ident" id="8122924">N</span><span class="op" id="8122925">;</span>&nbsp;<span class="ident" id="8122927">i</span><span class="op" id="8122928">++</span>&nbsp;<span class="op" id="8122931">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8122935">Encode</span><span class="op" id="8122941">(</span><span class="ident" id="8122942">ioutil</span><span class="op" id="8122948">.</span><span class="ident" id="8122949">Discard</span><span class="op" id="8122956">,</span>&nbsp;<span class="ident" id="8122958">img</span><span class="op" id="8122961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8122964">}</span><br>
<span class="lineno"></span><span class="op" id="8122966">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8122969">func</span>&nbsp;<span class="ident" id="8122974">BenchmarkEncodeRGBA</span><span class="op" id="8122993">(</span><span class="ident" id="8122994">b</span>&nbsp;<span class="op" id="8122996">*</span><span class="ident" id="8122997">testing</span><span class="op" id="8123004">.</span><span class="ident" id="8123005">B</span><span class="op" id="8123006">)</span>&nbsp;<span class="op" id="8123008">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8123011">b</span><span class="op" id="8123012">.</span><span class="ident" id="8123013">StopTimer</span><span class="op" id="8123022">(</span><span class="op" id="8123023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8123026">img</span>&nbsp;<span class="op" id="8123030">:=</span>&nbsp;<span class="ident" id="8123033">image</span><span class="op" id="8123038">.</span><span class="ident" id="8123039">NewRGBA</span><span class="op" id="8123046">(</span><span class="ident" id="8123047">image</span><span class="op" id="8123052">.</span><span class="ident" id="8123053">Rect</span><span class="op" id="8123057">(</span><span class="num" id="8123058">0</span><span class="op" id="8123059">,</span>&nbsp;<span class="num" id="8123061">0</span><span class="op" id="8123062">,</span>&nbsp;<span class="num" id="8123064">640</span><span class="op" id="8123067">,</span>&nbsp;<span class="num" id="8123069">480</span><span class="op" id="8123072">)</span><span class="op" id="8123073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8123076">if</span>&nbsp;<span class="ident" id="8123079">img</span><span class="op" id="8123082">.</span><span class="ident" id="8123083">Opaque</span><span class="op" id="8123089">(</span><span class="op" id="8123090">)</span>&nbsp;<span class="op" id="8123092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8123096">b</span><span class="op" id="8123097">.</span><span class="ident" id="8123098">Fatal</span><span class="op" id="8123103">(</span><span class="string" id="8123104">&#34;expected&nbsp;image&nbsp;not&nbsp;to&nbsp;be&nbsp;opaque&#34;</span><span class="op" id="8123137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8123140">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8123143">b</span><span class="op" id="8123144">.</span><span class="ident" id="8123145">SetBytes</span><span class="op" id="8123153">(</span><span class="num" id="8123154">640</span>&nbsp;<span class="op" id="8123158">*</span>&nbsp;<span class="num" id="8123160">480</span>&nbsp;<span class="op" id="8123164">*</span>&nbsp;<span class="num" id="8123166">4</span><span class="op" id="8123167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8123170">b</span><span class="op" id="8123171">.</span><span class="ident" id="8123172">StartTimer</span><span class="op" id="8123182">(</span><span class="op" id="8123183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8123186">for</span>&nbsp;<span class="ident" id="8123190">i</span>&nbsp;<span class="op" id="8123192">:=</span>&nbsp;<span class="num" id="8123195">0</span><span class="op" id="8123196">;</span>&nbsp;<span class="ident" id="8123198">i</span>&nbsp;<span class="op" id="8123200">&lt;</span>&nbsp;<span class="ident" id="8123202">b</span><span class="op" id="8123203">.</span><span class="ident" id="8123204">N</span><span class="op" id="8123205">;</span>&nbsp;<span class="ident" id="8123207">i</span><span class="op" id="8123208">++</span>&nbsp;<span class="op" id="8123211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8123215">Encode</span><span class="op" id="8123221">(</span><span class="ident" id="8123222">ioutil</span><span class="op" id="8123228">.</span><span class="ident" id="8123229">Discard</span><span class="op" id="8123236">,</span>&nbsp;<span class="ident" id="8123238">img</span><span class="op" id="8123241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8123244">}</span><br>
<span class="lineno">210</span><span class="op" id="8123246">}</span>
</div>
</body>
</html>
