<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>unicode/utf8</h2>
<ul>
<li><a href="/gostd/unicode/utf8/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/unicode/utf8/utf8.go.html" class="current">utf8.go</a></li>
<li><a href="/gostd/unicode/utf8/utf8_test.go.html">utf8_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1804796">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1804851">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1804905">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1804956">//&nbsp;Package&nbsp;utf8&nbsp;implements&nbsp;functions&nbsp;and&nbsp;constants&nbsp;to&nbsp;support&nbsp;text&nbsp;encoded&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="1805034">//&nbsp;UTF-8.&nbsp;It&nbsp;includes&nbsp;functions&nbsp;to&nbsp;translate&nbsp;between&nbsp;runes&nbsp;and&nbsp;UTF-8&nbsp;byte&nbsp;sequences.</span><br>
<span class="lineno"></span><span class="keyword" id="1805119">package</span>&nbsp;<span class="ident" id="1805127">utf8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1805133">//&nbsp;The&nbsp;conditions&nbsp;RuneError==unicode.ReplacementChar&nbsp;and</span><br>
<span class="lineno">10</span><span class="comment" id="1805190">//&nbsp;MaxRune==unicode.MaxRune&nbsp;are&nbsp;verified&nbsp;in&nbsp;the&nbsp;tests.</span><br>
<span class="lineno"></span><span class="comment" id="1805245">//&nbsp;Defining&nbsp;them&nbsp;locally&nbsp;avoids&nbsp;this&nbsp;package&nbsp;depending&nbsp;on&nbsp;package&nbsp;unicode.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1805321">//&nbsp;Numbers&nbsp;fundamental&nbsp;to&nbsp;the&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="keyword" id="1805361">const</span>&nbsp;<span class="op" id="1805367">(</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1805370">RuneError</span>&nbsp;<span class="op" id="1805380">=</span>&nbsp;<span class="string" id="1805382">&#39;\uFFFD&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1805395">//&nbsp;the&nbsp;&#34;error&#34;&nbsp;Rune&nbsp;or&nbsp;&#34;Unicode&nbsp;replacement&nbsp;character&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1805451">RuneSelf</span>&nbsp;&nbsp;<span class="op" id="1805461">=</span>&nbsp;<span class="num" id="1805463">0x80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1805476">//&nbsp;characters&nbsp;below&nbsp;Runeself&nbsp;are&nbsp;represented&nbsp;as&nbsp;themselves&nbsp;in&nbsp;a&nbsp;single&nbsp;byte.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1805554">MaxRune</span>&nbsp;&nbsp;&nbsp;<span class="op" id="1805564">=</span>&nbsp;<span class="string" id="1805566">&#39;\U0010FFFF&#39;</span>&nbsp;<span class="comment" id="1805579">//&nbsp;Maximum&nbsp;valid&nbsp;Unicode&nbsp;code&nbsp;point.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1805617">UTFMax</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1805627">=</span>&nbsp;<span class="num" id="1805629">4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1805642">//&nbsp;maximum&nbsp;number&nbsp;of&nbsp;bytes&nbsp;of&nbsp;a&nbsp;UTF-8&nbsp;encoded&nbsp;Unicode&nbsp;character.</span><br>
<span class="lineno"></span><span class="op" id="1805707">)</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="1805710">//&nbsp;Code&nbsp;points&nbsp;in&nbsp;the&nbsp;surrogate&nbsp;range&nbsp;are&nbsp;not&nbsp;valid&nbsp;for&nbsp;UTF-8.</span><br>
<span class="lineno"></span><span class="keyword" id="1805773">const</span>&nbsp;<span class="op" id="1805779">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1805782">surrogateMin</span>&nbsp;<span class="op" id="1805795">=</span>&nbsp;<span class="num" id="1805797">0xD800</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1805805">surrogateMax</span>&nbsp;<span class="op" id="1805818">=</span>&nbsp;<span class="num" id="1805820">0xDFFF</span><br>
<span class="lineno">25</span><span class="op" id="1805827">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1805830">const</span>&nbsp;<span class="op" id="1805836">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1805839">t1</span>&nbsp;<span class="op" id="1805842">=</span>&nbsp;<span class="num" id="1805844">0x00</span>&nbsp;<span class="comment" id="1805849">//&nbsp;0000&nbsp;0000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1805863">tx</span>&nbsp;<span class="op" id="1805866">=</span>&nbsp;<span class="num" id="1805868">0x80</span>&nbsp;<span class="comment" id="1805873">//&nbsp;1000&nbsp;0000</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1805887">t2</span>&nbsp;<span class="op" id="1805890">=</span>&nbsp;<span class="num" id="1805892">0xC0</span>&nbsp;<span class="comment" id="1805897">//&nbsp;1100&nbsp;0000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1805911">t3</span>&nbsp;<span class="op" id="1805914">=</span>&nbsp;<span class="num" id="1805916">0xE0</span>&nbsp;<span class="comment" id="1805921">//&nbsp;1110&nbsp;0000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1805935">t4</span>&nbsp;<span class="op" id="1805938">=</span>&nbsp;<span class="num" id="1805940">0xF0</span>&nbsp;<span class="comment" id="1805945">//&nbsp;1111&nbsp;0000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1805959">t5</span>&nbsp;<span class="op" id="1805962">=</span>&nbsp;<span class="num" id="1805964">0xF8</span>&nbsp;<span class="comment" id="1805969">//&nbsp;1111&nbsp;1000</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1805984">maskx</span>&nbsp;<span class="op" id="1805990">=</span>&nbsp;<span class="num" id="1805992">0x3F</span>&nbsp;<span class="comment" id="1805997">//&nbsp;0011&nbsp;1111</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1806011">mask2</span>&nbsp;<span class="op" id="1806017">=</span>&nbsp;<span class="num" id="1806019">0x1F</span>&nbsp;<span class="comment" id="1806024">//&nbsp;0001&nbsp;1111</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1806038">mask3</span>&nbsp;<span class="op" id="1806044">=</span>&nbsp;<span class="num" id="1806046">0x0F</span>&nbsp;<span class="comment" id="1806051">//&nbsp;0000&nbsp;1111</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1806065">mask4</span>&nbsp;<span class="op" id="1806071">=</span>&nbsp;<span class="num" id="1806073">0x07</span>&nbsp;<span class="comment" id="1806078">//&nbsp;0000&nbsp;0111</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1806093">rune1Max</span>&nbsp;<span class="op" id="1806102">=</span>&nbsp;<span class="num" id="1806104">1</span><span class="op" id="1806105">&lt;&lt;</span><span class="num" id="1806107">7</span>&nbsp;<span class="op" id="1806109">-</span>&nbsp;<span class="num" id="1806111">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1806114">rune2Max</span>&nbsp;<span class="op" id="1806123">=</span>&nbsp;<span class="num" id="1806125">1</span><span class="op" id="1806126">&lt;&lt;</span><span class="num" id="1806128">11</span>&nbsp;<span class="op" id="1806131">-</span>&nbsp;<span class="num" id="1806133">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1806136">rune3Max</span>&nbsp;<span class="op" id="1806145">=</span>&nbsp;<span class="num" id="1806147">1</span><span class="op" id="1806148">&lt;&lt;</span><span class="num" id="1806150">16</span>&nbsp;<span class="op" id="1806153">-</span>&nbsp;<span class="num" id="1806155">1</span><br>
<span class="lineno"></span><span class="op" id="1806157">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="keyword" id="1806160">func</span>&nbsp;<span class="ident" id="1806165">decodeRuneInternal</span><span class="op" id="1806183">(</span><span class="ident" id="1806184">p</span>&nbsp;<span class="op" id="1806186">[</span><span class="op" id="1806187">]</span><span class="builtintype" id="1806188">byte</span><span class="op" id="1806192">)</span>&nbsp;<span class="op" id="1806194">(</span><span class="ident" id="1806195">r</span>&nbsp;<span class="builtintype" id="1806197">rune</span><span class="op" id="1806201">,</span>&nbsp;<span class="ident" id="1806203">size</span>&nbsp;<span class="builtintype" id="1806208">int</span><span class="op" id="1806211">,</span>&nbsp;<span class="ident" id="1806213">short</span>&nbsp;<span class="builtintype" id="1806219">bool</span><span class="op" id="1806223">)</span>&nbsp;<span class="op" id="1806225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1806228">n</span>&nbsp;<span class="op" id="1806230">:=</span>&nbsp;<span class="builtinfunc" id="1806233">len</span><span class="op" id="1806236">(</span><span class="ident" id="1806237"><a href="/gostd/unicode/utf8/utf8.go.html#1806184">p</a></span><span class="op" id="1806238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1806241">if</span>&nbsp;<span class="ident" id="1806244"><a href="/gostd/unicode/utf8/utf8.go.html#1806228">n</a></span>&nbsp;<span class="op" id="1806246">&lt;</span>&nbsp;<span class="num" id="1806248">1</span>&nbsp;<span class="op" id="1806250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1806254">return</span>&nbsp;<span class="ident" id="1806261"><a href="/gostd/unicode/utf8/utf8.go.html#1805370">RuneError</a></span><span class="op" id="1806270">,</span>&nbsp;<span class="num" id="1806272">0</span><span class="op" id="1806273">,</span>&nbsp;<span class="builtintype" id="1806275">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1806281">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1806284">c0</span>&nbsp;<span class="op" id="1806287">:=</span>&nbsp;<span class="ident" id="1806290"><a href="/gostd/unicode/utf8/utf8.go.html#1806184">p</a></span><span class="op" id="1806291">[</span><span class="num" id="1806292">0</span><span class="op" id="1806293">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1806297">//&nbsp;1-byte,&nbsp;7-bit&nbsp;sequence?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1806325">if</span>&nbsp;<span class="ident" id="1806328"><a href="/gostd/unicode/utf8/utf8.go.html#1806284">c0</a></span>&nbsp;<span class="op" id="1806331">&lt;</span>&nbsp;<span class="ident" id="1806333"><a href="/gostd/unicode/utf8/utf8.go.html#1805863">tx</a></span>&nbsp;<span class="op" id="1806336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1806340">return</span>&nbsp;<span class="builtintype" id="1806347">rune</span><span class="op" id="1806351">(</span><span class="ident" id="1806352"><a href="/gostd/unicode/utf8/utf8.go.html#1806284">c0</a></span><span class="op" id="1806354">)</span><span class="op" id="1806355">,</span>&nbsp;<span class="num" id="1806357">1</span><span class="op" id="1806358">,</span>&nbsp;<span class="builtintype" id="1806360">false</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1806367">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1806371">//&nbsp;unexpected&nbsp;continuation&nbsp;byte?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1806405">if</span>&nbsp;<span class="ident" id="1806408"><a href="/gostd/unicode/utf8/utf8.go.html#1806284">c0</a></span>&nbsp;<span class="op" id="1806411">&lt;</span>&nbsp;<span class="ident" id="1806413"><a href="/gostd/unicode/utf8/utf8.go.html#1805887">t2</a></span>&nbsp;<span class="op" id="1806416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1806420">return</span>&nbsp;<span class="ident" id="1806427"><a href="/gostd/unicode/utf8/utf8.go.html#1805370">RuneError</a></span><span class="op" id="1806436">,</span>&nbsp;<span class="num" id="1806438">1</span><span class="op" id="1806439">,</span>&nbsp;<span class="builtintype" id="1806441">false</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1806448">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1806452">//&nbsp;need&nbsp;first&nbsp;continuation&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1806485">if</span>&nbsp;<span class="ident" id="1806488"><a href="/gostd/unicode/utf8/utf8.go.html#1806228">n</a></span>&nbsp;<span class="op" id="1806490">&lt;</span>&nbsp;<span class="num" id="1806492">2</span>&nbsp;<span class="op" id="1806494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1806498">return</span>&nbsp;<span class="ident" id="1806505"><a href="/gostd/unicode/utf8/utf8.go.html#1805370">RuneError</a></span><span class="op" id="1806514">,</span>&nbsp;<span class="num" id="1806516">1</span><span class="op" id="1806517">,</span>&nbsp;<span class="builtintype" id="1806519">true</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1806525">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1806528">c1</span>&nbsp;<span class="op" id="1806531">:=</span>&nbsp;<span class="ident" id="1806534"><a href="/gostd/unicode/utf8/utf8.go.html#1806184">p</a></span><span class="op" id="1806535">[</span><span class="num" id="1806536">1</span><span class="op" id="1806537">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1806540">if</span>&nbsp;<span class="ident" id="1806543"><a href="/gostd/unicode/utf8/utf8.go.html#1806528">c1</a></span>&nbsp;<span class="op" id="1806546">&lt;</span>&nbsp;<span class="ident" id="1806548"><a href="/gostd/unicode/utf8/utf8.go.html#1805863">tx</a></span>&nbsp;<span class="op" id="1806551">||</span>&nbsp;<span class="ident" id="1806554"><a href="/gostd/unicode/utf8/utf8.go.html#1805887">t2</a></span>&nbsp;<span class="op" id="1806557">&lt;=</span>&nbsp;<span class="ident" id="1806560"><a href="/gostd/unicode/utf8/utf8.go.html#1806528">c1</a></span>&nbsp;<span class="op" id="1806563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1806567">return</span>&nbsp;<span class="ident" id="1806574"><a href="/gostd/unicode/utf8/utf8.go.html#1805370">RuneError</a></span><span class="op" id="1806583">,</span>&nbsp;<span class="num" id="1806585">1</span><span class="op" id="1806586">,</span>&nbsp;<span class="builtintype" id="1806588">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1806595">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1806599">//&nbsp;2-byte,&nbsp;11-bit&nbsp;sequence?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1806628">if</span>&nbsp;<span class="ident" id="1806631"><a href="/gostd/unicode/utf8/utf8.go.html#1806284">c0</a></span>&nbsp;<span class="op" id="1806634">&lt;</span>&nbsp;<span class="ident" id="1806636"><a href="/gostd/unicode/utf8/utf8.go.html#1805911">t3</a></span>&nbsp;<span class="op" id="1806639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1806643"><a href="/gostd/unicode/utf8/utf8.go.html#1806195">r</a></span>&nbsp;<span class="op" id="1806645">=</span>&nbsp;<span class="builtintype" id="1806647">rune</span><span class="op" id="1806651">(</span><span class="ident" id="1806652"><a href="/gostd/unicode/utf8/utf8.go.html#1806284">c0</a></span><span class="op" id="1806654">&amp;</span><span class="ident" id="1806655"><a href="/gostd/unicode/utf8/utf8.go.html#1806011">mask2</a></span><span class="op" id="1806660">)</span><span class="op" id="1806661">&lt;&lt;</span><span class="num" id="1806663">6</span>&nbsp;<span class="op" id="1806665">|</span>&nbsp;<span class="builtintype" id="1806667">rune</span><span class="op" id="1806671">(</span><span class="ident" id="1806672"><a href="/gostd/unicode/utf8/utf8.go.html#1806528">c1</a></span><span class="op" id="1806674">&amp;</span><span class="ident" id="1806675"><a href="/gostd/unicode/utf8/utf8.go.html#1805984">maskx</a></span><span class="op" id="1806680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1806684">if</span>&nbsp;<span class="ident" id="1806687"><a href="/gostd/unicode/utf8/utf8.go.html#1806195">r</a></span>&nbsp;<span class="op" id="1806689">&lt;=</span>&nbsp;<span class="ident" id="1806692"><a href="/gostd/unicode/utf8/utf8.go.html#1806093">rune1Max</a></span>&nbsp;<span class="op" id="1806701">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1806706">return</span>&nbsp;<span class="ident" id="1806713"><a href="/gostd/unicode/utf8/utf8.go.html#1805370">RuneError</a></span><span class="op" id="1806722">,</span>&nbsp;<span class="num" id="1806724">1</span><span class="op" id="1806725">,</span>&nbsp;<span class="builtintype" id="1806727">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1806735">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1806739">return</span>&nbsp;<span class="ident" id="1806746"><a href="/gostd/unicode/utf8/utf8.go.html#1806195">r</a></span><span class="op" id="1806747">,</span>&nbsp;<span class="num" id="1806749">2</span><span class="op" id="1806750">,</span>&nbsp;<span class="builtintype" id="1806752">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1806759">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1806763">//&nbsp;need&nbsp;second&nbsp;continuation&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1806797">if</span>&nbsp;<span class="ident" id="1806800"><a href="/gostd/unicode/utf8/utf8.go.html#1806228">n</a></span>&nbsp;<span class="op" id="1806802">&lt;</span>&nbsp;<span class="num" id="1806804">3</span>&nbsp;<span class="op" id="1806806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1806810">return</span>&nbsp;<span class="ident" id="1806817"><a href="/gostd/unicode/utf8/utf8.go.html#1805370">RuneError</a></span><span class="op" id="1806826">,</span>&nbsp;<span class="num" id="1806828">1</span><span class="op" id="1806829">,</span>&nbsp;<span class="builtintype" id="1806831">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1806837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1806840">c2</span>&nbsp;<span class="op" id="1806843">:=</span>&nbsp;<span class="ident" id="1806846"><a href="/gostd/unicode/utf8/utf8.go.html#1806184">p</a></span><span class="op" id="1806847">[</span><span class="num" id="1806848">2</span><span class="op" id="1806849">]</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1806852">if</span>&nbsp;<span class="ident" id="1806855"><a href="/gostd/unicode/utf8/utf8.go.html#1806840">c2</a></span>&nbsp;<span class="op" id="1806858">&lt;</span>&nbsp;<span class="ident" id="1806860"><a href="/gostd/unicode/utf8/utf8.go.html#1805863">tx</a></span>&nbsp;<span class="op" id="1806863">||</span>&nbsp;<span class="ident" id="1806866"><a href="/gostd/unicode/utf8/utf8.go.html#1805887">t2</a></span>&nbsp;<span class="op" id="1806869">&lt;=</span>&nbsp;<span class="ident" id="1806872"><a href="/gostd/unicode/utf8/utf8.go.html#1806840">c2</a></span>&nbsp;<span class="op" id="1806875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1806879">return</span>&nbsp;<span class="ident" id="1806886"><a href="/gostd/unicode/utf8/utf8.go.html#1805370">RuneError</a></span><span class="op" id="1806895">,</span>&nbsp;<span class="num" id="1806897">1</span><span class="op" id="1806898">,</span>&nbsp;<span class="builtintype" id="1806900">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1806907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1806911">//&nbsp;3-byte,&nbsp;16-bit&nbsp;sequence?</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1806940">if</span>&nbsp;<span class="ident" id="1806943"><a href="/gostd/unicode/utf8/utf8.go.html#1806284">c0</a></span>&nbsp;<span class="op" id="1806946">&lt;</span>&nbsp;<span class="ident" id="1806948"><a href="/gostd/unicode/utf8/utf8.go.html#1805935">t4</a></span>&nbsp;<span class="op" id="1806951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1806955"><a href="/gostd/unicode/utf8/utf8.go.html#1806195">r</a></span>&nbsp;<span class="op" id="1806957">=</span>&nbsp;<span class="builtintype" id="1806959">rune</span><span class="op" id="1806963">(</span><span class="ident" id="1806964"><a href="/gostd/unicode/utf8/utf8.go.html#1806284">c0</a></span><span class="op" id="1806966">&amp;</span><span class="ident" id="1806967"><a href="/gostd/unicode/utf8/utf8.go.html#1806038">mask3</a></span><span class="op" id="1806972">)</span><span class="op" id="1806973">&lt;&lt;</span><span class="num" id="1806975">12</span>&nbsp;<span class="op" id="1806978">|</span>&nbsp;<span class="builtintype" id="1806980">rune</span><span class="op" id="1806984">(</span><span class="ident" id="1806985"><a href="/gostd/unicode/utf8/utf8.go.html#1806528">c1</a></span><span class="op" id="1806987">&amp;</span><span class="ident" id="1806988"><a href="/gostd/unicode/utf8/utf8.go.html#1805984">maskx</a></span><span class="op" id="1806993">)</span><span class="op" id="1806994">&lt;&lt;</span><span class="num" id="1806996">6</span>&nbsp;<span class="op" id="1806998">|</span>&nbsp;<span class="builtintype" id="1807000">rune</span><span class="op" id="1807004">(</span><span class="ident" id="1807005"><a href="/gostd/unicode/utf8/utf8.go.html#1806840">c2</a></span><span class="op" id="1807007">&amp;</span><span class="ident" id="1807008"><a href="/gostd/unicode/utf8/utf8.go.html#1805984">maskx</a></span><span class="op" id="1807013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1807017">if</span>&nbsp;<span class="ident" id="1807020"><a href="/gostd/unicode/utf8/utf8.go.html#1806195">r</a></span>&nbsp;<span class="op" id="1807022">&lt;=</span>&nbsp;<span class="ident" id="1807025"><a href="/gostd/unicode/utf8/utf8.go.html#1806114">rune2Max</a></span>&nbsp;<span class="op" id="1807034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1807039">return</span>&nbsp;<span class="ident" id="1807046"><a href="/gostd/unicode/utf8/utf8.go.html#1805370">RuneError</a></span><span class="op" id="1807055">,</span>&nbsp;<span class="num" id="1807057">1</span><span class="op" id="1807058">,</span>&nbsp;<span class="builtintype" id="1807060">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1807068">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1807072">if</span>&nbsp;<span class="ident" id="1807075"><a href="/gostd/unicode/utf8/utf8.go.html#1805782">surrogateMin</a></span>&nbsp;<span class="op" id="1807088">&lt;=</span>&nbsp;<span class="ident" id="1807091"><a href="/gostd/unicode/utf8/utf8.go.html#1806195">r</a></span>&nbsp;<span class="op" id="1807093">&amp;&amp;</span>&nbsp;<span class="ident" id="1807096"><a href="/gostd/unicode/utf8/utf8.go.html#1806195">r</a></span>&nbsp;<span class="op" id="1807098">&lt;=</span>&nbsp;<span class="ident" id="1807101"><a href="/gostd/unicode/utf8/utf8.go.html#1805805">surrogateMax</a></span>&nbsp;<span class="op" id="1807114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1807119">return</span>&nbsp;<span class="ident" id="1807126"><a href="/gostd/unicode/utf8/utf8.go.html#1805370">RuneError</a></span><span class="op" id="1807135">,</span>&nbsp;<span class="num" id="1807137">1</span><span class="op" id="1807138">,</span>&nbsp;<span class="builtintype" id="1807140">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1807148">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1807152">return</span>&nbsp;<span class="ident" id="1807159"><a href="/gostd/unicode/utf8/utf8.go.html#1806195">r</a></span><span class="op" id="1807160">,</span>&nbsp;<span class="num" id="1807162">3</span><span class="op" id="1807163">,</span>&nbsp;<span class="builtintype" id="1807165">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1807172">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1807176">//&nbsp;need&nbsp;third&nbsp;continuation&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1807209">if</span>&nbsp;<span class="ident" id="1807212"><a href="/gostd/unicode/utf8/utf8.go.html#1806228">n</a></span>&nbsp;<span class="op" id="1807214">&lt;</span>&nbsp;<span class="num" id="1807216">4</span>&nbsp;<span class="op" id="1807218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1807222">return</span>&nbsp;<span class="ident" id="1807229"><a href="/gostd/unicode/utf8/utf8.go.html#1805370">RuneError</a></span><span class="op" id="1807238">,</span>&nbsp;<span class="num" id="1807240">1</span><span class="op" id="1807241">,</span>&nbsp;<span class="builtintype" id="1807243">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1807249">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1807252">c3</span>&nbsp;<span class="op" id="1807255">:=</span>&nbsp;<span class="ident" id="1807258"><a href="/gostd/unicode/utf8/utf8.go.html#1806184">p</a></span><span class="op" id="1807259">[</span><span class="num" id="1807260">3</span><span class="op" id="1807261">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1807264">if</span>&nbsp;<span class="ident" id="1807267"><a href="/gostd/unicode/utf8/utf8.go.html#1807252">c3</a></span>&nbsp;<span class="op" id="1807270">&lt;</span>&nbsp;<span class="ident" id="1807272"><a href="/gostd/unicode/utf8/utf8.go.html#1805863">tx</a></span>&nbsp;<span class="op" id="1807275">||</span>&nbsp;<span class="ident" id="1807278"><a href="/gostd/unicode/utf8/utf8.go.html#1805887">t2</a></span>&nbsp;<span class="op" id="1807281">&lt;=</span>&nbsp;<span class="ident" id="1807284"><a href="/gostd/unicode/utf8/utf8.go.html#1807252">c3</a></span>&nbsp;<span class="op" id="1807287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1807291">return</span>&nbsp;<span class="ident" id="1807298"><a href="/gostd/unicode/utf8/utf8.go.html#1805370">RuneError</a></span><span class="op" id="1807307">,</span>&nbsp;<span class="num" id="1807309">1</span><span class="op" id="1807310">,</span>&nbsp;<span class="builtintype" id="1807312">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1807319">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1807323">//&nbsp;4-byte,&nbsp;21-bit&nbsp;sequence?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1807352">if</span>&nbsp;<span class="ident" id="1807355"><a href="/gostd/unicode/utf8/utf8.go.html#1806284">c0</a></span>&nbsp;<span class="op" id="1807358">&lt;</span>&nbsp;<span class="ident" id="1807360"><a href="/gostd/unicode/utf8/utf8.go.html#1805959">t5</a></span>&nbsp;<span class="op" id="1807363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1807367"><a href="/gostd/unicode/utf8/utf8.go.html#1806195">r</a></span>&nbsp;<span class="op" id="1807369">=</span>&nbsp;<span class="builtintype" id="1807371">rune</span><span class="op" id="1807375">(</span><span class="ident" id="1807376"><a href="/gostd/unicode/utf8/utf8.go.html#1806284">c0</a></span><span class="op" id="1807378">&amp;</span><span class="ident" id="1807379"><a href="/gostd/unicode/utf8/utf8.go.html#1806065">mask4</a></span><span class="op" id="1807384">)</span><span class="op" id="1807385">&lt;&lt;</span><span class="num" id="1807387">18</span>&nbsp;<span class="op" id="1807390">|</span>&nbsp;<span class="builtintype" id="1807392">rune</span><span class="op" id="1807396">(</span><span class="ident" id="1807397"><a href="/gostd/unicode/utf8/utf8.go.html#1806528">c1</a></span><span class="op" id="1807399">&amp;</span><span class="ident" id="1807400"><a href="/gostd/unicode/utf8/utf8.go.html#1805984">maskx</a></span><span class="op" id="1807405">)</span><span class="op" id="1807406">&lt;&lt;</span><span class="num" id="1807408">12</span>&nbsp;<span class="op" id="1807411">|</span>&nbsp;<span class="builtintype" id="1807413">rune</span><span class="op" id="1807417">(</span><span class="ident" id="1807418"><a href="/gostd/unicode/utf8/utf8.go.html#1806840">c2</a></span><span class="op" id="1807420">&amp;</span><span class="ident" id="1807421"><a href="/gostd/unicode/utf8/utf8.go.html#1805984">maskx</a></span><span class="op" id="1807426">)</span><span class="op" id="1807427">&lt;&lt;</span><span class="num" id="1807429">6</span>&nbsp;<span class="op" id="1807431">|</span>&nbsp;<span class="builtintype" id="1807433">rune</span><span class="op" id="1807437">(</span><span class="ident" id="1807438"><a href="/gostd/unicode/utf8/utf8.go.html#1807252">c3</a></span><span class="op" id="1807440">&amp;</span><span class="ident" id="1807441"><a href="/gostd/unicode/utf8/utf8.go.html#1805984">maskx</a></span><span class="op" id="1807446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1807450">if</span>&nbsp;<span class="ident" id="1807453"><a href="/gostd/unicode/utf8/utf8.go.html#1806195">r</a></span>&nbsp;<span class="op" id="1807455">&lt;=</span>&nbsp;<span class="ident" id="1807458"><a href="/gostd/unicode/utf8/utf8.go.html#1806136">rune3Max</a></span>&nbsp;<span class="op" id="1807467">||</span>&nbsp;<span class="ident" id="1807470"><a href="/gostd/unicode/utf8/utf8.go.html#1805554">MaxRune</a></span>&nbsp;<span class="op" id="1807478">&lt;</span>&nbsp;<span class="ident" id="1807480"><a href="/gostd/unicode/utf8/utf8.go.html#1806195">r</a></span>&nbsp;<span class="op" id="1807482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1807487">return</span>&nbsp;<span class="ident" id="1807494"><a href="/gostd/unicode/utf8/utf8.go.html#1805370">RuneError</a></span><span class="op" id="1807503">,</span>&nbsp;<span class="num" id="1807505">1</span><span class="op" id="1807506">,</span>&nbsp;<span class="builtintype" id="1807508">false</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1807516">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1807520">return</span>&nbsp;<span class="ident" id="1807527"><a href="/gostd/unicode/utf8/utf8.go.html#1806195">r</a></span><span class="op" id="1807528">,</span>&nbsp;<span class="num" id="1807530">4</span><span class="op" id="1807531">,</span>&nbsp;<span class="builtintype" id="1807533">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1807540">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1807544">//&nbsp;error</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1807554">return</span>&nbsp;<span class="ident" id="1807561"><a href="/gostd/unicode/utf8/utf8.go.html#1805370">RuneError</a></span><span class="op" id="1807570">,</span>&nbsp;<span class="num" id="1807572">1</span><span class="op" id="1807573">,</span>&nbsp;<span class="builtintype" id="1807575">false</span><br>
<span class="lineno"></span><span class="op" id="1807581">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1807584">func</span>&nbsp;<span class="ident" id="1807589">decodeRuneInStringInternal</span><span class="op" id="1807615">(</span><span class="ident" id="1807616">s</span>&nbsp;<span class="builtintype" id="1807618">string</span><span class="op" id="1807624">)</span>&nbsp;<span class="op" id="1807626">(</span><span class="ident" id="1807627">r</span>&nbsp;<span class="builtintype" id="1807629">rune</span><span class="op" id="1807633">,</span>&nbsp;<span class="ident" id="1807635">size</span>&nbsp;<span class="builtintype" id="1807640">int</span><span class="op" id="1807643">,</span>&nbsp;<span class="ident" id="1807645">short</span>&nbsp;<span class="builtintype" id="1807651">bool</span><span class="op" id="1807655">)</span>&nbsp;<span class="op" id="1807657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1807660">n</span>&nbsp;<span class="op" id="1807662">:=</span>&nbsp;<span class="builtinfunc" id="1807665">len</span><span class="op" id="1807668">(</span><span class="ident" id="1807669"><a href="/gostd/unicode/utf8/utf8.go.html#1807616">s</a></span><span class="op" id="1807670">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1807673">if</span>&nbsp;<span class="ident" id="1807676"><a href="/gostd/unicode/utf8/utf8.go.html#1807660">n</a></span>&nbsp;<span class="op" id="1807678">&lt;</span>&nbsp;<span class="num" id="1807680">1</span>&nbsp;<span class="op" id="1807682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1807686">return</span>&nbsp;<span class="ident" id="1807693"><a href="/gostd/unicode/utf8/utf8.go.html#1805370">RuneError</a></span><span class="op" id="1807702">,</span>&nbsp;<span class="num" id="1807704">0</span><span class="op" id="1807705">,</span>&nbsp;<span class="builtintype" id="1807707">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1807713">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1807716">c0</span>&nbsp;<span class="op" id="1807719">:=</span>&nbsp;<span class="ident" id="1807722"><a href="/gostd/unicode/utf8/utf8.go.html#1807616">s</a></span><span class="op" id="1807723">[</span><span class="num" id="1807724">0</span><span class="op" id="1807725">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1807729">//&nbsp;1-byte,&nbsp;7-bit&nbsp;sequence?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1807757">if</span>&nbsp;<span class="ident" id="1807760"><a href="/gostd/unicode/utf8/utf8.go.html#1807716">c0</a></span>&nbsp;<span class="op" id="1807763">&lt;</span>&nbsp;<span class="ident" id="1807765"><a href="/gostd/unicode/utf8/utf8.go.html#1805863">tx</a></span>&nbsp;<span class="op" id="1807768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1807772">return</span>&nbsp;<span class="builtintype" id="1807779">rune</span><span class="op" id="1807783">(</span><span class="ident" id="1807784"><a href="/gostd/unicode/utf8/utf8.go.html#1807716">c0</a></span><span class="op" id="1807786">)</span><span class="op" id="1807787">,</span>&nbsp;<span class="num" id="1807789">1</span><span class="op" id="1807790">,</span>&nbsp;<span class="builtintype" id="1807792">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1807799">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1807803">//&nbsp;unexpected&nbsp;continuation&nbsp;byte?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1807837">if</span>&nbsp;<span class="ident" id="1807840"><a href="/gostd/unicode/utf8/utf8.go.html#1807716">c0</a></span>&nbsp;<span class="op" id="1807843">&lt;</span>&nbsp;<span class="ident" id="1807845"><a href="/gostd/unicode/utf8/utf8.go.html#1805887">t2</a></span>&nbsp;<span class="op" id="1807848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1807852">return</span>&nbsp;<span class="ident" id="1807859"><a href="/gostd/unicode/utf8/utf8.go.html#1805370">RuneError</a></span><span class="op" id="1807868">,</span>&nbsp;<span class="num" id="1807870">1</span><span class="op" id="1807871">,</span>&nbsp;<span class="builtintype" id="1807873">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1807880">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1807884">//&nbsp;need&nbsp;first&nbsp;continuation&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1807917">if</span>&nbsp;<span class="ident" id="1807920"><a href="/gostd/unicode/utf8/utf8.go.html#1807660">n</a></span>&nbsp;<span class="op" id="1807922">&lt;</span>&nbsp;<span class="num" id="1807924">2</span>&nbsp;<span class="op" id="1807926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1807930">return</span>&nbsp;<span class="ident" id="1807937"><a href="/gostd/unicode/utf8/utf8.go.html#1805370">RuneError</a></span><span class="op" id="1807946">,</span>&nbsp;<span class="num" id="1807948">1</span><span class="op" id="1807949">,</span>&nbsp;<span class="builtintype" id="1807951">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1807957">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1807960">c1</span>&nbsp;<span class="op" id="1807963">:=</span>&nbsp;<span class="ident" id="1807966"><a href="/gostd/unicode/utf8/utf8.go.html#1807616">s</a></span><span class="op" id="1807967">[</span><span class="num" id="1807968">1</span><span class="op" id="1807969">]</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1807972">if</span>&nbsp;<span class="ident" id="1807975"><a href="/gostd/unicode/utf8/utf8.go.html#1807960">c1</a></span>&nbsp;<span class="op" id="1807978">&lt;</span>&nbsp;<span class="ident" id="1807980"><a href="/gostd/unicode/utf8/utf8.go.html#1805863">tx</a></span>&nbsp;<span class="op" id="1807983">||</span>&nbsp;<span class="ident" id="1807986"><a href="/gostd/unicode/utf8/utf8.go.html#1805887">t2</a></span>&nbsp;<span class="op" id="1807989">&lt;=</span>&nbsp;<span class="ident" id="1807992"><a href="/gostd/unicode/utf8/utf8.go.html#1807960">c1</a></span>&nbsp;<span class="op" id="1807995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1807999">return</span>&nbsp;<span class="ident" id="1808006"><a href="/gostd/unicode/utf8/utf8.go.html#1805370">RuneError</a></span><span class="op" id="1808015">,</span>&nbsp;<span class="num" id="1808017">1</span><span class="op" id="1808018">,</span>&nbsp;<span class="builtintype" id="1808020">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1808027">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1808031">//&nbsp;2-byte,&nbsp;11-bit&nbsp;sequence?</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1808060">if</span>&nbsp;<span class="ident" id="1808063"><a href="/gostd/unicode/utf8/utf8.go.html#1807716">c0</a></span>&nbsp;<span class="op" id="1808066">&lt;</span>&nbsp;<span class="ident" id="1808068"><a href="/gostd/unicode/utf8/utf8.go.html#1805911">t3</a></span>&nbsp;<span class="op" id="1808071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1808075"><a href="/gostd/unicode/utf8/utf8.go.html#1807627">r</a></span>&nbsp;<span class="op" id="1808077">=</span>&nbsp;<span class="builtintype" id="1808079">rune</span><span class="op" id="1808083">(</span><span class="ident" id="1808084"><a href="/gostd/unicode/utf8/utf8.go.html#1807716">c0</a></span><span class="op" id="1808086">&amp;</span><span class="ident" id="1808087"><a href="/gostd/unicode/utf8/utf8.go.html#1806011">mask2</a></span><span class="op" id="1808092">)</span><span class="op" id="1808093">&lt;&lt;</span><span class="num" id="1808095">6</span>&nbsp;<span class="op" id="1808097">|</span>&nbsp;<span class="builtintype" id="1808099">rune</span><span class="op" id="1808103">(</span><span class="ident" id="1808104"><a href="/gostd/unicode/utf8/utf8.go.html#1807960">c1</a></span><span class="op" id="1808106">&amp;</span><span class="ident" id="1808107"><a href="/gostd/unicode/utf8/utf8.go.html#1805984">maskx</a></span><span class="op" id="1808112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1808116">if</span>&nbsp;<span class="ident" id="1808119"><a href="/gostd/unicode/utf8/utf8.go.html#1807627">r</a></span>&nbsp;<span class="op" id="1808121">&lt;=</span>&nbsp;<span class="ident" id="1808124"><a href="/gostd/unicode/utf8/utf8.go.html#1806093">rune1Max</a></span>&nbsp;<span class="op" id="1808133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1808138">return</span>&nbsp;<span class="ident" id="1808145"><a href="/gostd/unicode/utf8/utf8.go.html#1805370">RuneError</a></span><span class="op" id="1808154">,</span>&nbsp;<span class="num" id="1808156">1</span><span class="op" id="1808157">,</span>&nbsp;<span class="builtintype" id="1808159">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1808167">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1808171">return</span>&nbsp;<span class="ident" id="1808178"><a href="/gostd/unicode/utf8/utf8.go.html#1807627">r</a></span><span class="op" id="1808179">,</span>&nbsp;<span class="num" id="1808181">2</span><span class="op" id="1808182">,</span>&nbsp;<span class="builtintype" id="1808184">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1808191">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1808195">//&nbsp;need&nbsp;second&nbsp;continuation&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1808229">if</span>&nbsp;<span class="ident" id="1808232"><a href="/gostd/unicode/utf8/utf8.go.html#1807660">n</a></span>&nbsp;<span class="op" id="1808234">&lt;</span>&nbsp;<span class="num" id="1808236">3</span>&nbsp;<span class="op" id="1808238">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1808242">return</span>&nbsp;<span class="ident" id="1808249"><a href="/gostd/unicode/utf8/utf8.go.html#1805370">RuneError</a></span><span class="op" id="1808258">,</span>&nbsp;<span class="num" id="1808260">1</span><span class="op" id="1808261">,</span>&nbsp;<span class="builtintype" id="1808263">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1808269">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1808272">c2</span>&nbsp;<span class="op" id="1808275">:=</span>&nbsp;<span class="ident" id="1808278"><a href="/gostd/unicode/utf8/utf8.go.html#1807616">s</a></span><span class="op" id="1808279">[</span><span class="num" id="1808280">2</span><span class="op" id="1808281">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1808284">if</span>&nbsp;<span class="ident" id="1808287"><a href="/gostd/unicode/utf8/utf8.go.html#1808272">c2</a></span>&nbsp;<span class="op" id="1808290">&lt;</span>&nbsp;<span class="ident" id="1808292"><a href="/gostd/unicode/utf8/utf8.go.html#1805863">tx</a></span>&nbsp;<span class="op" id="1808295">||</span>&nbsp;<span class="ident" id="1808298"><a href="/gostd/unicode/utf8/utf8.go.html#1805887">t2</a></span>&nbsp;<span class="op" id="1808301">&lt;=</span>&nbsp;<span class="ident" id="1808304"><a href="/gostd/unicode/utf8/utf8.go.html#1808272">c2</a></span>&nbsp;<span class="op" id="1808307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1808311">return</span>&nbsp;<span class="ident" id="1808318"><a href="/gostd/unicode/utf8/utf8.go.html#1805370">RuneError</a></span><span class="op" id="1808327">,</span>&nbsp;<span class="num" id="1808329">1</span><span class="op" id="1808330">,</span>&nbsp;<span class="builtintype" id="1808332">false</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1808339">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1808343">//&nbsp;3-byte,&nbsp;16-bit&nbsp;sequence?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1808372">if</span>&nbsp;<span class="ident" id="1808375"><a href="/gostd/unicode/utf8/utf8.go.html#1807716">c0</a></span>&nbsp;<span class="op" id="1808378">&lt;</span>&nbsp;<span class="ident" id="1808380"><a href="/gostd/unicode/utf8/utf8.go.html#1805935">t4</a></span>&nbsp;<span class="op" id="1808383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1808387"><a href="/gostd/unicode/utf8/utf8.go.html#1807627">r</a></span>&nbsp;<span class="op" id="1808389">=</span>&nbsp;<span class="builtintype" id="1808391">rune</span><span class="op" id="1808395">(</span><span class="ident" id="1808396"><a href="/gostd/unicode/utf8/utf8.go.html#1807716">c0</a></span><span class="op" id="1808398">&amp;</span><span class="ident" id="1808399"><a href="/gostd/unicode/utf8/utf8.go.html#1806038">mask3</a></span><span class="op" id="1808404">)</span><span class="op" id="1808405">&lt;&lt;</span><span class="num" id="1808407">12</span>&nbsp;<span class="op" id="1808410">|</span>&nbsp;<span class="builtintype" id="1808412">rune</span><span class="op" id="1808416">(</span><span class="ident" id="1808417"><a href="/gostd/unicode/utf8/utf8.go.html#1807960">c1</a></span><span class="op" id="1808419">&amp;</span><span class="ident" id="1808420"><a href="/gostd/unicode/utf8/utf8.go.html#1805984">maskx</a></span><span class="op" id="1808425">)</span><span class="op" id="1808426">&lt;&lt;</span><span class="num" id="1808428">6</span>&nbsp;<span class="op" id="1808430">|</span>&nbsp;<span class="builtintype" id="1808432">rune</span><span class="op" id="1808436">(</span><span class="ident" id="1808437"><a href="/gostd/unicode/utf8/utf8.go.html#1808272">c2</a></span><span class="op" id="1808439">&amp;</span><span class="ident" id="1808440"><a href="/gostd/unicode/utf8/utf8.go.html#1805984">maskx</a></span><span class="op" id="1808445">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1808449">if</span>&nbsp;<span class="ident" id="1808452"><a href="/gostd/unicode/utf8/utf8.go.html#1807627">r</a></span>&nbsp;<span class="op" id="1808454">&lt;=</span>&nbsp;<span class="ident" id="1808457"><a href="/gostd/unicode/utf8/utf8.go.html#1806114">rune2Max</a></span>&nbsp;<span class="op" id="1808466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1808471">return</span>&nbsp;<span class="ident" id="1808478"><a href="/gostd/unicode/utf8/utf8.go.html#1805370">RuneError</a></span><span class="op" id="1808487">,</span>&nbsp;<span class="num" id="1808489">1</span><span class="op" id="1808490">,</span>&nbsp;<span class="builtintype" id="1808492">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1808500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1808504">if</span>&nbsp;<span class="ident" id="1808507"><a href="/gostd/unicode/utf8/utf8.go.html#1805782">surrogateMin</a></span>&nbsp;<span class="op" id="1808520">&lt;=</span>&nbsp;<span class="ident" id="1808523"><a href="/gostd/unicode/utf8/utf8.go.html#1807627">r</a></span>&nbsp;<span class="op" id="1808525">&amp;&amp;</span>&nbsp;<span class="ident" id="1808528"><a href="/gostd/unicode/utf8/utf8.go.html#1807627">r</a></span>&nbsp;<span class="op" id="1808530">&lt;=</span>&nbsp;<span class="ident" id="1808533"><a href="/gostd/unicode/utf8/utf8.go.html#1805805">surrogateMax</a></span>&nbsp;<span class="op" id="1808546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1808551">return</span>&nbsp;<span class="ident" id="1808558"><a href="/gostd/unicode/utf8/utf8.go.html#1805370">RuneError</a></span><span class="op" id="1808567">,</span>&nbsp;<span class="num" id="1808569">1</span><span class="op" id="1808570">,</span>&nbsp;<span class="builtintype" id="1808572">false</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1808580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1808584">return</span>&nbsp;<span class="ident" id="1808591"><a href="/gostd/unicode/utf8/utf8.go.html#1807627">r</a></span><span class="op" id="1808592">,</span>&nbsp;<span class="num" id="1808594">3</span><span class="op" id="1808595">,</span>&nbsp;<span class="builtintype" id="1808597">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1808604">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1808608">//&nbsp;need&nbsp;third&nbsp;continuation&nbsp;byte</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1808641">if</span>&nbsp;<span class="ident" id="1808644"><a href="/gostd/unicode/utf8/utf8.go.html#1807660">n</a></span>&nbsp;<span class="op" id="1808646">&lt;</span>&nbsp;<span class="num" id="1808648">4</span>&nbsp;<span class="op" id="1808650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1808654">return</span>&nbsp;<span class="ident" id="1808661"><a href="/gostd/unicode/utf8/utf8.go.html#1805370">RuneError</a></span><span class="op" id="1808670">,</span>&nbsp;<span class="num" id="1808672">1</span><span class="op" id="1808673">,</span>&nbsp;<span class="builtintype" id="1808675">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1808681">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1808684">c3</span>&nbsp;<span class="op" id="1808687">:=</span>&nbsp;<span class="ident" id="1808690"><a href="/gostd/unicode/utf8/utf8.go.html#1807616">s</a></span><span class="op" id="1808691">[</span><span class="num" id="1808692">3</span><span class="op" id="1808693">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1808696">if</span>&nbsp;<span class="ident" id="1808699"><a href="/gostd/unicode/utf8/utf8.go.html#1808684">c3</a></span>&nbsp;<span class="op" id="1808702">&lt;</span>&nbsp;<span class="ident" id="1808704"><a href="/gostd/unicode/utf8/utf8.go.html#1805863">tx</a></span>&nbsp;<span class="op" id="1808707">||</span>&nbsp;<span class="ident" id="1808710"><a href="/gostd/unicode/utf8/utf8.go.html#1805887">t2</a></span>&nbsp;<span class="op" id="1808713">&lt;=</span>&nbsp;<span class="ident" id="1808716"><a href="/gostd/unicode/utf8/utf8.go.html#1808684">c3</a></span>&nbsp;<span class="op" id="1808719">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1808723">return</span>&nbsp;<span class="ident" id="1808730"><a href="/gostd/unicode/utf8/utf8.go.html#1805370">RuneError</a></span><span class="op" id="1808739">,</span>&nbsp;<span class="num" id="1808741">1</span><span class="op" id="1808742">,</span>&nbsp;<span class="builtintype" id="1808744">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1808751">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1808755">//&nbsp;4-byte,&nbsp;21-bit&nbsp;sequence?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1808784">if</span>&nbsp;<span class="ident" id="1808787"><a href="/gostd/unicode/utf8/utf8.go.html#1807716">c0</a></span>&nbsp;<span class="op" id="1808790">&lt;</span>&nbsp;<span class="ident" id="1808792"><a href="/gostd/unicode/utf8/utf8.go.html#1805959">t5</a></span>&nbsp;<span class="op" id="1808795">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1808799"><a href="/gostd/unicode/utf8/utf8.go.html#1807627">r</a></span>&nbsp;<span class="op" id="1808801">=</span>&nbsp;<span class="builtintype" id="1808803">rune</span><span class="op" id="1808807">(</span><span class="ident" id="1808808"><a href="/gostd/unicode/utf8/utf8.go.html#1807716">c0</a></span><span class="op" id="1808810">&amp;</span><span class="ident" id="1808811"><a href="/gostd/unicode/utf8/utf8.go.html#1806065">mask4</a></span><span class="op" id="1808816">)</span><span class="op" id="1808817">&lt;&lt;</span><span class="num" id="1808819">18</span>&nbsp;<span class="op" id="1808822">|</span>&nbsp;<span class="builtintype" id="1808824">rune</span><span class="op" id="1808828">(</span><span class="ident" id="1808829"><a href="/gostd/unicode/utf8/utf8.go.html#1807960">c1</a></span><span class="op" id="1808831">&amp;</span><span class="ident" id="1808832"><a href="/gostd/unicode/utf8/utf8.go.html#1805984">maskx</a></span><span class="op" id="1808837">)</span><span class="op" id="1808838">&lt;&lt;</span><span class="num" id="1808840">12</span>&nbsp;<span class="op" id="1808843">|</span>&nbsp;<span class="builtintype" id="1808845">rune</span><span class="op" id="1808849">(</span><span class="ident" id="1808850"><a href="/gostd/unicode/utf8/utf8.go.html#1808272">c2</a></span><span class="op" id="1808852">&amp;</span><span class="ident" id="1808853"><a href="/gostd/unicode/utf8/utf8.go.html#1805984">maskx</a></span><span class="op" id="1808858">)</span><span class="op" id="1808859">&lt;&lt;</span><span class="num" id="1808861">6</span>&nbsp;<span class="op" id="1808863">|</span>&nbsp;<span class="builtintype" id="1808865">rune</span><span class="op" id="1808869">(</span><span class="ident" id="1808870"><a href="/gostd/unicode/utf8/utf8.go.html#1808684">c3</a></span><span class="op" id="1808872">&amp;</span><span class="ident" id="1808873"><a href="/gostd/unicode/utf8/utf8.go.html#1805984">maskx</a></span><span class="op" id="1808878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1808882">if</span>&nbsp;<span class="ident" id="1808885"><a href="/gostd/unicode/utf8/utf8.go.html#1807627">r</a></span>&nbsp;<span class="op" id="1808887">&lt;=</span>&nbsp;<span class="ident" id="1808890"><a href="/gostd/unicode/utf8/utf8.go.html#1806136">rune3Max</a></span>&nbsp;<span class="op" id="1808899">||</span>&nbsp;<span class="ident" id="1808902"><a href="/gostd/unicode/utf8/utf8.go.html#1805554">MaxRune</a></span>&nbsp;<span class="op" id="1808910">&lt;</span>&nbsp;<span class="ident" id="1808912"><a href="/gostd/unicode/utf8/utf8.go.html#1807627">r</a></span>&nbsp;<span class="op" id="1808914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1808919">return</span>&nbsp;<span class="ident" id="1808926"><a href="/gostd/unicode/utf8/utf8.go.html#1805370">RuneError</a></span><span class="op" id="1808935">,</span>&nbsp;<span class="num" id="1808937">1</span><span class="op" id="1808938">,</span>&nbsp;<span class="builtintype" id="1808940">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1808948">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1808952">return</span>&nbsp;<span class="ident" id="1808959"><a href="/gostd/unicode/utf8/utf8.go.html#1807627">r</a></span><span class="op" id="1808960">,</span>&nbsp;<span class="num" id="1808962">4</span><span class="op" id="1808963">,</span>&nbsp;<span class="builtintype" id="1808965">false</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1808972">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1808976">//&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1808986">return</span>&nbsp;<span class="ident" id="1808993"><a href="/gostd/unicode/utf8/utf8.go.html#1805370">RuneError</a></span><span class="op" id="1809002">,</span>&nbsp;<span class="num" id="1809004">1</span><span class="op" id="1809005">,</span>&nbsp;<span class="builtintype" id="1809007">false</span><br>
<span class="lineno"></span><span class="op" id="1809013">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span><span class="comment" id="1809016">//&nbsp;FullRune&nbsp;reports&nbsp;whether&nbsp;the&nbsp;bytes&nbsp;in&nbsp;p&nbsp;begin&nbsp;with&nbsp;a&nbsp;full&nbsp;UTF-8&nbsp;encoding&nbsp;of&nbsp;a&nbsp;rune.</span><br>
<span class="lineno"></span><span class="comment" id="1809103">//&nbsp;An&nbsp;invalid&nbsp;encoding&nbsp;is&nbsp;considered&nbsp;a&nbsp;full&nbsp;Rune&nbsp;since&nbsp;it&nbsp;will&nbsp;convert&nbsp;as&nbsp;a&nbsp;width-1&nbsp;error&nbsp;rune.</span><br>
<span class="lineno"></span><span class="keyword" id="1809199">func</span>&nbsp;<span class="ident" id="1809204">FullRune</span><span class="op" id="1809212">(</span><span class="ident" id="1809213">p</span>&nbsp;<span class="op" id="1809215">[</span><span class="op" id="1809216">]</span><span class="builtintype" id="1809217">byte</span><span class="op" id="1809221">)</span>&nbsp;<span class="builtintype" id="1809223">bool</span>&nbsp;<span class="op" id="1809228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1809231">_</span><span class="op" id="1809232">,</span>&nbsp;<span class="ident" id="1809234">_</span><span class="op" id="1809235">,</span>&nbsp;<span class="ident" id="1809237">short</span>&nbsp;<span class="op" id="1809243">:=</span>&nbsp;<span class="ident" id="1809246"><a href="/gostd/unicode/utf8/utf8.go.html#1806165">decodeRuneInternal</a></span><span class="op" id="1809264">(</span><span class="ident" id="1809265"><a href="/gostd/unicode/utf8/utf8.go.html#1809213">p</a></span><span class="op" id="1809266">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1809269">return</span>&nbsp;<span class="op" id="1809276">!</span><span class="ident" id="1809277"><a href="/gostd/unicode/utf8/utf8.go.html#1809237">short</a></span><br>
<span class="lineno"></span><span class="op" id="1809283">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1809286">//&nbsp;FullRuneInString&nbsp;is&nbsp;like&nbsp;FullRune&nbsp;but&nbsp;its&nbsp;input&nbsp;is&nbsp;a&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="1809350">func</span>&nbsp;<span class="ident" id="1809355">FullRuneInString</span><span class="op" id="1809371">(</span><span class="ident" id="1809372">s</span>&nbsp;<span class="builtintype" id="1809374">string</span><span class="op" id="1809380">)</span>&nbsp;<span class="builtintype" id="1809382">bool</span>&nbsp;<span class="op" id="1809387">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1809390">_</span><span class="op" id="1809391">,</span>&nbsp;<span class="ident" id="1809393">_</span><span class="op" id="1809394">,</span>&nbsp;<span class="ident" id="1809396">short</span>&nbsp;<span class="op" id="1809402">:=</span>&nbsp;<span class="ident" id="1809405"><a href="/gostd/unicode/utf8/utf8.go.html#1807589">decodeRuneInStringInternal</a></span><span class="op" id="1809431">(</span><span class="ident" id="1809432"><a href="/gostd/unicode/utf8/utf8.go.html#1809372">s</a></span><span class="op" id="1809433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1809436">return</span>&nbsp;<span class="op" id="1809443">!</span><span class="ident" id="1809444"><a href="/gostd/unicode/utf8/utf8.go.html#1809396">short</a></span><br>
<span class="lineno"></span><span class="op" id="1809450">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1809453">//&nbsp;DecodeRune&nbsp;unpacks&nbsp;the&nbsp;first&nbsp;UTF-8&nbsp;encoding&nbsp;in&nbsp;p&nbsp;and&nbsp;returns&nbsp;the&nbsp;rune&nbsp;and</span><br>
<span class="lineno">215</span><span class="comment" id="1809530">//&nbsp;its&nbsp;width&nbsp;in&nbsp;bytes.&nbsp;If&nbsp;p&nbsp;is&nbsp;empty&nbsp;it&nbsp;returns&nbsp;(RuneError,&nbsp;0).&nbsp;Otherwise,&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="1809608">//&nbsp;the&nbsp;encoding&nbsp;is&nbsp;invalid,&nbsp;it&nbsp;returns&nbsp;(RuneError,&nbsp;1).&nbsp;Both&nbsp;are&nbsp;impossible</span><br>
<span class="lineno"></span><span class="comment" id="1809683">//&nbsp;results&nbsp;for&nbsp;correct&nbsp;UTF-8.</span><br>
<span class="lineno"></span><span class="comment" id="1809713">//</span><br>
<span class="lineno"></span><span class="comment" id="1809716">//&nbsp;An&nbsp;encoding&nbsp;is&nbsp;invalid&nbsp;if&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;UTF-8,&nbsp;encodes&nbsp;a&nbsp;rune&nbsp;that&nbsp;is</span><br>
<span class="lineno">220</span><span class="comment" id="1809791">//&nbsp;out&nbsp;of&nbsp;range,&nbsp;or&nbsp;is&nbsp;not&nbsp;the&nbsp;shortest&nbsp;possible&nbsp;UTF-8&nbsp;encoding&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1809863">//&nbsp;value.&nbsp;No&nbsp;other&nbsp;validation&nbsp;is&nbsp;performed.</span><br>
<span class="lineno"></span><span class="keyword" id="1809907">func</span>&nbsp;<span class="ident" id="1809912">DecodeRune</span><span class="op" id="1809922">(</span><span class="ident" id="1809923">p</span>&nbsp;<span class="op" id="1809925">[</span><span class="op" id="1809926">]</span><span class="builtintype" id="1809927">byte</span><span class="op" id="1809931">)</span>&nbsp;<span class="op" id="1809933">(</span><span class="ident" id="1809934">r</span>&nbsp;<span class="builtintype" id="1809936">rune</span><span class="op" id="1809940">,</span>&nbsp;<span class="ident" id="1809942">size</span>&nbsp;<span class="builtintype" id="1809947">int</span><span class="op" id="1809950">)</span>&nbsp;<span class="op" id="1809952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1809955"><a href="/gostd/unicode/utf8/utf8.go.html#1809934">r</a></span><span class="op" id="1809956">,</span>&nbsp;<span class="ident" id="1809958"><a href="/gostd/unicode/utf8/utf8.go.html#1809942">size</a></span><span class="op" id="1809962">,</span>&nbsp;<span class="ident" id="1809964">_</span>&nbsp;<span class="op" id="1809966">=</span>&nbsp;<span class="ident" id="1809968"><a href="/gostd/unicode/utf8/utf8.go.html#1806165">decodeRuneInternal</a></span><span class="op" id="1809986">(</span><span class="ident" id="1809987"><a href="/gostd/unicode/utf8/utf8.go.html#1809923">p</a></span><span class="op" id="1809988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1809991">return</span><br>
<span class="lineno">225</span><span class="op" id="1809998">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1810001">//&nbsp;DecodeRuneInString&nbsp;is&nbsp;like&nbsp;DecodeRune&nbsp;but&nbsp;its&nbsp;input&nbsp;is&nbsp;a&nbsp;string.&nbsp;If&nbsp;s&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="1810077">//&nbsp;empty&nbsp;it&nbsp;returns&nbsp;(RuneError,&nbsp;0).&nbsp;Otherwise,&nbsp;if&nbsp;the&nbsp;encoding&nbsp;is&nbsp;invalid,&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="1810155">//&nbsp;returns&nbsp;(RuneError,&nbsp;1).&nbsp;Both&nbsp;are&nbsp;impossible&nbsp;results&nbsp;for&nbsp;correct&nbsp;UTF-8.</span><br>
<span class="lineno">230</span><span class="comment" id="1810229">//</span><br>
<span class="lineno"></span><span class="comment" id="1810232">//&nbsp;An&nbsp;encoding&nbsp;is&nbsp;invalid&nbsp;if&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;UTF-8,&nbsp;encodes&nbsp;a&nbsp;rune&nbsp;that&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="1810307">//&nbsp;out&nbsp;of&nbsp;range,&nbsp;or&nbsp;is&nbsp;not&nbsp;the&nbsp;shortest&nbsp;possible&nbsp;UTF-8&nbsp;encoding&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1810379">//&nbsp;value.&nbsp;No&nbsp;other&nbsp;validation&nbsp;is&nbsp;performed.</span><br>
<span class="lineno"></span><span class="keyword" id="1810423">func</span>&nbsp;<span class="ident" id="1810428">DecodeRuneInString</span><span class="op" id="1810446">(</span><span class="ident" id="1810447">s</span>&nbsp;<span class="builtintype" id="1810449">string</span><span class="op" id="1810455">)</span>&nbsp;<span class="op" id="1810457">(</span><span class="ident" id="1810458">r</span>&nbsp;<span class="builtintype" id="1810460">rune</span><span class="op" id="1810464">,</span>&nbsp;<span class="ident" id="1810466">size</span>&nbsp;<span class="builtintype" id="1810471">int</span><span class="op" id="1810474">)</span>&nbsp;<span class="op" id="1810476">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1810479"><a href="/gostd/unicode/utf8/utf8.go.html#1810458">r</a></span><span class="op" id="1810480">,</span>&nbsp;<span class="ident" id="1810482"><a href="/gostd/unicode/utf8/utf8.go.html#1810466">size</a></span><span class="op" id="1810486">,</span>&nbsp;<span class="ident" id="1810488">_</span>&nbsp;<span class="op" id="1810490">=</span>&nbsp;<span class="ident" id="1810492"><a href="/gostd/unicode/utf8/utf8.go.html#1807589">decodeRuneInStringInternal</a></span><span class="op" id="1810518">(</span><span class="ident" id="1810519"><a href="/gostd/unicode/utf8/utf8.go.html#1810447">s</a></span><span class="op" id="1810520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1810523">return</span><br>
<span class="lineno"></span><span class="op" id="1810530">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1810533">//&nbsp;DecodeLastRune&nbsp;unpacks&nbsp;the&nbsp;last&nbsp;UTF-8&nbsp;encoding&nbsp;in&nbsp;p&nbsp;and&nbsp;returns&nbsp;the&nbsp;rune&nbsp;and</span><br>
<span class="lineno">240</span><span class="comment" id="1810613">//&nbsp;its&nbsp;width&nbsp;in&nbsp;bytes.&nbsp;If&nbsp;p&nbsp;is&nbsp;empty&nbsp;it&nbsp;returns&nbsp;(RuneError,&nbsp;0).&nbsp;Otherwise,&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="1810691">//&nbsp;the&nbsp;encoding&nbsp;is&nbsp;invalid,&nbsp;it&nbsp;returns&nbsp;(RuneError,&nbsp;1).&nbsp;Both&nbsp;are&nbsp;impossible</span><br>
<span class="lineno"></span><span class="comment" id="1810766">//&nbsp;results&nbsp;for&nbsp;correct&nbsp;UTF-8.</span><br>
<span class="lineno"></span><span class="comment" id="1810796">//</span><br>
<span class="lineno"></span><span class="comment" id="1810799">//&nbsp;An&nbsp;encoding&nbsp;is&nbsp;invalid&nbsp;if&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;UTF-8,&nbsp;encodes&nbsp;a&nbsp;rune&nbsp;that&nbsp;is</span><br>
<span class="lineno">245</span><span class="comment" id="1810874">//&nbsp;out&nbsp;of&nbsp;range,&nbsp;or&nbsp;is&nbsp;not&nbsp;the&nbsp;shortest&nbsp;possible&nbsp;UTF-8&nbsp;encoding&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1810946">//&nbsp;value.&nbsp;No&nbsp;other&nbsp;validation&nbsp;is&nbsp;performed.</span><br>
<span class="lineno"></span><span class="keyword" id="1810990">func</span>&nbsp;<span class="ident" id="1810995">DecodeLastRune</span><span class="op" id="1811009">(</span><span class="ident" id="1811010">p</span>&nbsp;<span class="op" id="1811012">[</span><span class="op" id="1811013">]</span><span class="builtintype" id="1811014">byte</span><span class="op" id="1811018">)</span>&nbsp;<span class="op" id="1811020">(</span><span class="ident" id="1811021">r</span>&nbsp;<span class="builtintype" id="1811023">rune</span><span class="op" id="1811027">,</span>&nbsp;<span class="ident" id="1811029">size</span>&nbsp;<span class="builtintype" id="1811034">int</span><span class="op" id="1811037">)</span>&nbsp;<span class="op" id="1811039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1811042">end</span>&nbsp;<span class="op" id="1811046">:=</span>&nbsp;<span class="builtinfunc" id="1811049">len</span><span class="op" id="1811052">(</span><span class="ident" id="1811053"><a href="/gostd/unicode/utf8/utf8.go.html#1811010">p</a></span><span class="op" id="1811054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1811057">if</span>&nbsp;<span class="ident" id="1811060"><a href="/gostd/unicode/utf8/utf8.go.html#1811042">end</a></span>&nbsp;<span class="op" id="1811064">==</span>&nbsp;<span class="num" id="1811067">0</span>&nbsp;<span class="op" id="1811069">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1811073">return</span>&nbsp;<span class="ident" id="1811080"><a href="/gostd/unicode/utf8/utf8.go.html#1805370">RuneError</a></span><span class="op" id="1811089">,</span>&nbsp;<span class="num" id="1811091">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1811094">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1811097">start</span>&nbsp;<span class="op" id="1811103">:=</span>&nbsp;<span class="ident" id="1811106"><a href="/gostd/unicode/utf8/utf8.go.html#1811042">end</a></span>&nbsp;<span class="op" id="1811110">-</span>&nbsp;<span class="num" id="1811112">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1811115"><a href="/gostd/unicode/utf8/utf8.go.html#1811021">r</a></span>&nbsp;<span class="op" id="1811117">=</span>&nbsp;<span class="builtintype" id="1811119">rune</span><span class="op" id="1811123">(</span><span class="ident" id="1811124"><a href="/gostd/unicode/utf8/utf8.go.html#1811010">p</a></span><span class="op" id="1811125">[</span><span class="ident" id="1811126"><a href="/gostd/unicode/utf8/utf8.go.html#1811097">start</a></span><span class="op" id="1811131">]</span><span class="op" id="1811132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1811135">if</span>&nbsp;<span class="ident" id="1811138"><a href="/gostd/unicode/utf8/utf8.go.html#1811021">r</a></span>&nbsp;<span class="op" id="1811140">&lt;</span>&nbsp;<span class="ident" id="1811142"><a href="/gostd/unicode/utf8/utf8.go.html#1805451">RuneSelf</a></span>&nbsp;<span class="op" id="1811151">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1811155">return</span>&nbsp;<span class="ident" id="1811162"><a href="/gostd/unicode/utf8/utf8.go.html#1811021">r</a></span><span class="op" id="1811163">,</span>&nbsp;<span class="num" id="1811165">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1811168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1811171">//&nbsp;guard&nbsp;against&nbsp;O(n^2)&nbsp;behavior&nbsp;when&nbsp;traversing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1811221">//&nbsp;backwards&nbsp;through&nbsp;strings&nbsp;with&nbsp;long&nbsp;sequences&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1811274">//&nbsp;invalid&nbsp;UTF-8.</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1811293">lim</span>&nbsp;<span class="op" id="1811297">:=</span>&nbsp;<span class="ident" id="1811300"><a href="/gostd/unicode/utf8/utf8.go.html#1811042">end</a></span>&nbsp;<span class="op" id="1811304">-</span>&nbsp;<span class="ident" id="1811306"><a href="/gostd/unicode/utf8/utf8.go.html#1805617">UTFMax</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1811314">if</span>&nbsp;<span class="ident" id="1811317"><a href="/gostd/unicode/utf8/utf8.go.html#1811293">lim</a></span>&nbsp;<span class="op" id="1811321">&lt;</span>&nbsp;<span class="num" id="1811323">0</span>&nbsp;<span class="op" id="1811325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1811329"><a href="/gostd/unicode/utf8/utf8.go.html#1811293">lim</a></span>&nbsp;<span class="op" id="1811333">=</span>&nbsp;<span class="num" id="1811335">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1811338">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1811341">for</span>&nbsp;<span class="ident" id="1811345"><a href="/gostd/unicode/utf8/utf8.go.html#1811097">start</a></span><span class="op" id="1811350">--</span><span class="op" id="1811352">;</span>&nbsp;<span class="ident" id="1811354"><a href="/gostd/unicode/utf8/utf8.go.html#1811097">start</a></span>&nbsp;<span class="op" id="1811360">&gt;=</span>&nbsp;<span class="ident" id="1811363"><a href="/gostd/unicode/utf8/utf8.go.html#1811293">lim</a></span><span class="op" id="1811366">;</span>&nbsp;<span class="ident" id="1811368"><a href="/gostd/unicode/utf8/utf8.go.html#1811097">start</a></span><span class="op" id="1811373">--</span>&nbsp;<span class="op" id="1811376">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1811380">if</span>&nbsp;<span class="ident" id="1811383"><a href="/gostd/unicode/utf8/utf8.go.html#1814348">RuneStart</a></span><span class="op" id="1811392">(</span><span class="ident" id="1811393"><a href="/gostd/unicode/utf8/utf8.go.html#1811010">p</a></span><span class="op" id="1811394">[</span><span class="ident" id="1811395"><a href="/gostd/unicode/utf8/utf8.go.html#1811097">start</a></span><span class="op" id="1811400">]</span><span class="op" id="1811401">)</span>&nbsp;<span class="op" id="1811403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1811408">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1811416">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1811419">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1811422">if</span>&nbsp;<span class="ident" id="1811425"><a href="/gostd/unicode/utf8/utf8.go.html#1811097">start</a></span>&nbsp;<span class="op" id="1811431">&lt;</span>&nbsp;<span class="num" id="1811433">0</span>&nbsp;<span class="op" id="1811435">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1811439"><a href="/gostd/unicode/utf8/utf8.go.html#1811097">start</a></span>&nbsp;<span class="op" id="1811445">=</span>&nbsp;<span class="num" id="1811447">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1811450">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1811453"><a href="/gostd/unicode/utf8/utf8.go.html#1811021">r</a></span><span class="op" id="1811454">,</span>&nbsp;<span class="ident" id="1811456"><a href="/gostd/unicode/utf8/utf8.go.html#1811029">size</a></span>&nbsp;<span class="op" id="1811461">=</span>&nbsp;<span class="ident" id="1811463"><a href="/gostd/unicode/utf8/utf8.go.html#1809912">DecodeRune</a></span><span class="op" id="1811473">(</span><span class="ident" id="1811474"><a href="/gostd/unicode/utf8/utf8.go.html#1811010">p</a></span><span class="op" id="1811475">[</span><span class="ident" id="1811476"><a href="/gostd/unicode/utf8/utf8.go.html#1811097">start</a></span><span class="op" id="1811481">:</span><span class="ident" id="1811482"><a href="/gostd/unicode/utf8/utf8.go.html#1811042">end</a></span><span class="op" id="1811485">]</span><span class="op" id="1811486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1811489">if</span>&nbsp;<span class="ident" id="1811492"><a href="/gostd/unicode/utf8/utf8.go.html#1811097">start</a></span><span class="op" id="1811497">+</span><span class="ident" id="1811498"><a href="/gostd/unicode/utf8/utf8.go.html#1811029">size</a></span>&nbsp;<span class="op" id="1811503">!=</span>&nbsp;<span class="ident" id="1811506"><a href="/gostd/unicode/utf8/utf8.go.html#1811042">end</a></span>&nbsp;<span class="op" id="1811510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1811514">return</span>&nbsp;<span class="ident" id="1811521"><a href="/gostd/unicode/utf8/utf8.go.html#1805370">RuneError</a></span><span class="op" id="1811530">,</span>&nbsp;<span class="num" id="1811532">1</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1811535">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1811538">return</span>&nbsp;<span class="ident" id="1811545"><a href="/gostd/unicode/utf8/utf8.go.html#1811021">r</a></span><span class="op" id="1811546">,</span>&nbsp;<span class="ident" id="1811548"><a href="/gostd/unicode/utf8/utf8.go.html#1811029">size</a></span><br>
<span class="lineno"></span><span class="op" id="1811553">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1811556">//&nbsp;DecodeLastRuneInString&nbsp;is&nbsp;like&nbsp;DecodeLastRune&nbsp;but&nbsp;its&nbsp;input&nbsp;is&nbsp;a&nbsp;string.&nbsp;If</span><br>
<span class="lineno">280</span><span class="comment" id="1811635">//&nbsp;s&nbsp;is&nbsp;empty&nbsp;it&nbsp;returns&nbsp;(RuneError,&nbsp;0).&nbsp;Otherwise,&nbsp;if&nbsp;the&nbsp;encoding&nbsp;is&nbsp;invalid,</span><br>
<span class="lineno"></span><span class="comment" id="1811715">//&nbsp;it&nbsp;returns&nbsp;(RuneError,&nbsp;1).&nbsp;Both&nbsp;are&nbsp;impossible&nbsp;results&nbsp;for&nbsp;correct&nbsp;UTF-8.</span><br>
<span class="lineno"></span><span class="comment" id="1811792">//</span><br>
<span class="lineno"></span><span class="comment" id="1811795">//&nbsp;An&nbsp;encoding&nbsp;is&nbsp;invalid&nbsp;if&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;UTF-8,&nbsp;encodes&nbsp;a&nbsp;rune&nbsp;that&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="1811870">//&nbsp;out&nbsp;of&nbsp;range,&nbsp;or&nbsp;is&nbsp;not&nbsp;the&nbsp;shortest&nbsp;possible&nbsp;UTF-8&nbsp;encoding&nbsp;for&nbsp;the</span><br>
<span class="lineno">285</span><span class="comment" id="1811942">//&nbsp;value.&nbsp;No&nbsp;other&nbsp;validation&nbsp;is&nbsp;performed.</span><br>
<span class="lineno"></span><span class="keyword" id="1811986">func</span>&nbsp;<span class="ident" id="1811991">DecodeLastRuneInString</span><span class="op" id="1812013">(</span><span class="ident" id="1812014">s</span>&nbsp;<span class="builtintype" id="1812016">string</span><span class="op" id="1812022">)</span>&nbsp;<span class="op" id="1812024">(</span><span class="ident" id="1812025">r</span>&nbsp;<span class="builtintype" id="1812027">rune</span><span class="op" id="1812031">,</span>&nbsp;<span class="ident" id="1812033">size</span>&nbsp;<span class="builtintype" id="1812038">int</span><span class="op" id="1812041">)</span>&nbsp;<span class="op" id="1812043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1812046">end</span>&nbsp;<span class="op" id="1812050">:=</span>&nbsp;<span class="builtinfunc" id="1812053">len</span><span class="op" id="1812056">(</span><span class="ident" id="1812057"><a href="/gostd/unicode/utf8/utf8.go.html#1812014">s</a></span><span class="op" id="1812058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1812061">if</span>&nbsp;<span class="ident" id="1812064"><a href="/gostd/unicode/utf8/utf8.go.html#1812046">end</a></span>&nbsp;<span class="op" id="1812068">==</span>&nbsp;<span class="num" id="1812071">0</span>&nbsp;<span class="op" id="1812073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1812077">return</span>&nbsp;<span class="ident" id="1812084"><a href="/gostd/unicode/utf8/utf8.go.html#1805370">RuneError</a></span><span class="op" id="1812093">,</span>&nbsp;<span class="num" id="1812095">0</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1812098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1812101">start</span>&nbsp;<span class="op" id="1812107">:=</span>&nbsp;<span class="ident" id="1812110"><a href="/gostd/unicode/utf8/utf8.go.html#1812046">end</a></span>&nbsp;<span class="op" id="1812114">-</span>&nbsp;<span class="num" id="1812116">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1812119"><a href="/gostd/unicode/utf8/utf8.go.html#1812025">r</a></span>&nbsp;<span class="op" id="1812121">=</span>&nbsp;<span class="builtintype" id="1812123">rune</span><span class="op" id="1812127">(</span><span class="ident" id="1812128"><a href="/gostd/unicode/utf8/utf8.go.html#1812014">s</a></span><span class="op" id="1812129">[</span><span class="ident" id="1812130"><a href="/gostd/unicode/utf8/utf8.go.html#1812101">start</a></span><span class="op" id="1812135">]</span><span class="op" id="1812136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1812139">if</span>&nbsp;<span class="ident" id="1812142"><a href="/gostd/unicode/utf8/utf8.go.html#1812025">r</a></span>&nbsp;<span class="op" id="1812144">&lt;</span>&nbsp;<span class="ident" id="1812146"><a href="/gostd/unicode/utf8/utf8.go.html#1805451">RuneSelf</a></span>&nbsp;<span class="op" id="1812155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1812159">return</span>&nbsp;<span class="ident" id="1812166"><a href="/gostd/unicode/utf8/utf8.go.html#1812025">r</a></span><span class="op" id="1812167">,</span>&nbsp;<span class="num" id="1812169">1</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1812172">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1812175">//&nbsp;guard&nbsp;against&nbsp;O(n^2)&nbsp;behavior&nbsp;when&nbsp;traversing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1812225">//&nbsp;backwards&nbsp;through&nbsp;strings&nbsp;with&nbsp;long&nbsp;sequences&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1812278">//&nbsp;invalid&nbsp;UTF-8.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1812297">lim</span>&nbsp;<span class="op" id="1812301">:=</span>&nbsp;<span class="ident" id="1812304"><a href="/gostd/unicode/utf8/utf8.go.html#1812046">end</a></span>&nbsp;<span class="op" id="1812308">-</span>&nbsp;<span class="ident" id="1812310"><a href="/gostd/unicode/utf8/utf8.go.html#1805617">UTFMax</a></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1812318">if</span>&nbsp;<span class="ident" id="1812321"><a href="/gostd/unicode/utf8/utf8.go.html#1812297">lim</a></span>&nbsp;<span class="op" id="1812325">&lt;</span>&nbsp;<span class="num" id="1812327">0</span>&nbsp;<span class="op" id="1812329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1812333"><a href="/gostd/unicode/utf8/utf8.go.html#1812297">lim</a></span>&nbsp;<span class="op" id="1812337">=</span>&nbsp;<span class="num" id="1812339">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1812342">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1812345">for</span>&nbsp;<span class="ident" id="1812349"><a href="/gostd/unicode/utf8/utf8.go.html#1812101">start</a></span><span class="op" id="1812354">--</span><span class="op" id="1812356">;</span>&nbsp;<span class="ident" id="1812358"><a href="/gostd/unicode/utf8/utf8.go.html#1812101">start</a></span>&nbsp;<span class="op" id="1812364">&gt;=</span>&nbsp;<span class="ident" id="1812367"><a href="/gostd/unicode/utf8/utf8.go.html#1812297">lim</a></span><span class="op" id="1812370">;</span>&nbsp;<span class="ident" id="1812372"><a href="/gostd/unicode/utf8/utf8.go.html#1812101">start</a></span><span class="op" id="1812377">--</span>&nbsp;<span class="op" id="1812380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1812384">if</span>&nbsp;<span class="ident" id="1812387"><a href="/gostd/unicode/utf8/utf8.go.html#1814348">RuneStart</a></span><span class="op" id="1812396">(</span><span class="ident" id="1812397"><a href="/gostd/unicode/utf8/utf8.go.html#1812014">s</a></span><span class="op" id="1812398">[</span><span class="ident" id="1812399"><a href="/gostd/unicode/utf8/utf8.go.html#1812101">start</a></span><span class="op" id="1812404">]</span><span class="op" id="1812405">)</span>&nbsp;<span class="op" id="1812407">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1812412">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1812420">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1812423">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1812426">if</span>&nbsp;<span class="ident" id="1812429"><a href="/gostd/unicode/utf8/utf8.go.html#1812101">start</a></span>&nbsp;<span class="op" id="1812435">&lt;</span>&nbsp;<span class="num" id="1812437">0</span>&nbsp;<span class="op" id="1812439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1812443"><a href="/gostd/unicode/utf8/utf8.go.html#1812101">start</a></span>&nbsp;<span class="op" id="1812449">=</span>&nbsp;<span class="num" id="1812451">0</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1812454">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1812457"><a href="/gostd/unicode/utf8/utf8.go.html#1812025">r</a></span><span class="op" id="1812458">,</span>&nbsp;<span class="ident" id="1812460"><a href="/gostd/unicode/utf8/utf8.go.html#1812033">size</a></span>&nbsp;<span class="op" id="1812465">=</span>&nbsp;<span class="ident" id="1812467"><a href="/gostd/unicode/utf8/utf8.go.html#1810428">DecodeRuneInString</a></span><span class="op" id="1812485">(</span><span class="ident" id="1812486"><a href="/gostd/unicode/utf8/utf8.go.html#1812014">s</a></span><span class="op" id="1812487">[</span><span class="ident" id="1812488"><a href="/gostd/unicode/utf8/utf8.go.html#1812101">start</a></span><span class="op" id="1812493">:</span><span class="ident" id="1812494"><a href="/gostd/unicode/utf8/utf8.go.html#1812046">end</a></span><span class="op" id="1812497">]</span><span class="op" id="1812498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1812501">if</span>&nbsp;<span class="ident" id="1812504"><a href="/gostd/unicode/utf8/utf8.go.html#1812101">start</a></span><span class="op" id="1812509">+</span><span class="ident" id="1812510"><a href="/gostd/unicode/utf8/utf8.go.html#1812033">size</a></span>&nbsp;<span class="op" id="1812515">!=</span>&nbsp;<span class="ident" id="1812518"><a href="/gostd/unicode/utf8/utf8.go.html#1812046">end</a></span>&nbsp;<span class="op" id="1812522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1812526">return</span>&nbsp;<span class="ident" id="1812533"><a href="/gostd/unicode/utf8/utf8.go.html#1805370">RuneError</a></span><span class="op" id="1812542">,</span>&nbsp;<span class="num" id="1812544">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1812547">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1812550">return</span>&nbsp;<span class="ident" id="1812557"><a href="/gostd/unicode/utf8/utf8.go.html#1812025">r</a></span><span class="op" id="1812558">,</span>&nbsp;<span class="ident" id="1812560"><a href="/gostd/unicode/utf8/utf8.go.html#1812033">size</a></span><br>
<span class="lineno"></span><span class="op" id="1812565">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1812568">//&nbsp;RuneLen&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;required&nbsp;to&nbsp;encode&nbsp;the&nbsp;rune.</span><br>
<span class="lineno"></span><span class="comment" id="1812636">//&nbsp;It&nbsp;returns&nbsp;-1&nbsp;if&nbsp;the&nbsp;rune&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;value&nbsp;to&nbsp;encode&nbsp;in&nbsp;UTF-8.</span><br>
<span class="lineno">320</span><span class="keyword" id="1812706">func</span>&nbsp;<span class="ident" id="1812711">RuneLen</span><span class="op" id="1812718">(</span><span class="ident" id="1812719">r</span>&nbsp;<span class="builtintype" id="1812721">rune</span><span class="op" id="1812725">)</span>&nbsp;<span class="builtintype" id="1812727">int</span>&nbsp;<span class="op" id="1812731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1812734">switch</span>&nbsp;<span class="op" id="1812741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1812744">case</span>&nbsp;<span class="ident" id="1812749"><a href="/gostd/unicode/utf8/utf8.go.html#1812719">r</a></span>&nbsp;<span class="op" id="1812751">&lt;</span>&nbsp;<span class="num" id="1812753">0</span><span class="op" id="1812754">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1812758">return</span>&nbsp;<span class="op" id="1812765">-</span><span class="num" id="1812766">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1812769">case</span>&nbsp;<span class="ident" id="1812774"><a href="/gostd/unicode/utf8/utf8.go.html#1812719">r</a></span>&nbsp;<span class="op" id="1812776">&lt;=</span>&nbsp;<span class="ident" id="1812779"><a href="/gostd/unicode/utf8/utf8.go.html#1806093">rune1Max</a></span><span class="op" id="1812787">:</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1812791">return</span>&nbsp;<span class="num" id="1812798">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1812801">case</span>&nbsp;<span class="ident" id="1812806"><a href="/gostd/unicode/utf8/utf8.go.html#1812719">r</a></span>&nbsp;<span class="op" id="1812808">&lt;=</span>&nbsp;<span class="ident" id="1812811"><a href="/gostd/unicode/utf8/utf8.go.html#1806114">rune2Max</a></span><span class="op" id="1812819">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1812823">return</span>&nbsp;<span class="num" id="1812830">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1812833">case</span>&nbsp;<span class="ident" id="1812838"><a href="/gostd/unicode/utf8/utf8.go.html#1805782">surrogateMin</a></span>&nbsp;<span class="op" id="1812851">&lt;=</span>&nbsp;<span class="ident" id="1812854"><a href="/gostd/unicode/utf8/utf8.go.html#1812719">r</a></span>&nbsp;<span class="op" id="1812856">&amp;&amp;</span>&nbsp;<span class="ident" id="1812859"><a href="/gostd/unicode/utf8/utf8.go.html#1812719">r</a></span>&nbsp;<span class="op" id="1812861">&lt;=</span>&nbsp;<span class="ident" id="1812864"><a href="/gostd/unicode/utf8/utf8.go.html#1805805">surrogateMax</a></span><span class="op" id="1812876">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1812880">return</span>&nbsp;<span class="op" id="1812887">-</span><span class="num" id="1812888">1</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1812891">case</span>&nbsp;<span class="ident" id="1812896"><a href="/gostd/unicode/utf8/utf8.go.html#1812719">r</a></span>&nbsp;<span class="op" id="1812898">&lt;=</span>&nbsp;<span class="ident" id="1812901"><a href="/gostd/unicode/utf8/utf8.go.html#1806136">rune3Max</a></span><span class="op" id="1812909">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1812913">return</span>&nbsp;<span class="num" id="1812920">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1812923">case</span>&nbsp;<span class="ident" id="1812928"><a href="/gostd/unicode/utf8/utf8.go.html#1812719">r</a></span>&nbsp;<span class="op" id="1812930">&lt;=</span>&nbsp;<span class="ident" id="1812933"><a href="/gostd/unicode/utf8/utf8.go.html#1805554">MaxRune</a></span><span class="op" id="1812940">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1812944">return</span>&nbsp;<span class="num" id="1812951">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1812954">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1812957">return</span>&nbsp;<span class="op" id="1812964">-</span><span class="num" id="1812965">1</span><br>
<span class="lineno"></span><span class="op" id="1812967">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1812970">//&nbsp;EncodeRune&nbsp;writes&nbsp;into&nbsp;p&nbsp;(which&nbsp;must&nbsp;be&nbsp;large&nbsp;enough)&nbsp;the&nbsp;UTF-8&nbsp;encoding&nbsp;of&nbsp;the&nbsp;rune.</span><br>
<span class="lineno"></span><span class="comment" id="1813059">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;written.</span><br>
<span class="lineno">340</span><span class="keyword" id="1813102">func</span>&nbsp;<span class="ident" id="1813107">EncodeRune</span><span class="op" id="1813117">(</span><span class="ident" id="1813118">p</span>&nbsp;<span class="op" id="1813120">[</span><span class="op" id="1813121">]</span><span class="builtintype" id="1813122">byte</span><span class="op" id="1813126">,</span>&nbsp;<span class="ident" id="1813128">r</span>&nbsp;<span class="builtintype" id="1813130">rune</span><span class="op" id="1813134">)</span>&nbsp;<span class="builtintype" id="1813136">int</span>&nbsp;<span class="op" id="1813140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1813143">//&nbsp;Negative&nbsp;values&nbsp;are&nbsp;erroneous.&nbsp;&nbsp;Making&nbsp;it&nbsp;unsigned&nbsp;addresses&nbsp;the&nbsp;problem.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1813221">switch</span>&nbsp;<span class="ident" id="1813228">i</span>&nbsp;<span class="op" id="1813230">:=</span>&nbsp;<span class="builtintype" id="1813233">uint32</span><span class="op" id="1813239">(</span><span class="ident" id="1813240"><a href="/gostd/unicode/utf8/utf8.go.html#1813128">r</a></span><span class="op" id="1813241">)</span><span class="op" id="1813242">;</span>&nbsp;<span class="op" id="1813244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1813247">case</span>&nbsp;<span class="ident" id="1813252"><a href="/gostd/unicode/utf8/utf8.go.html#1813228">i</a></span>&nbsp;<span class="op" id="1813254">&lt;=</span>&nbsp;<span class="ident" id="1813257"><a href="/gostd/unicode/utf8/utf8.go.html#1806093">rune1Max</a></span><span class="op" id="1813265">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1813269"><a href="/gostd/unicode/utf8/utf8.go.html#1813118">p</a></span><span class="op" id="1813270">[</span><span class="num" id="1813271">0</span><span class="op" id="1813272">]</span>&nbsp;<span class="op" id="1813274">=</span>&nbsp;<span class="builtintype" id="1813276">byte</span><span class="op" id="1813280">(</span><span class="ident" id="1813281"><a href="/gostd/unicode/utf8/utf8.go.html#1813128">r</a></span><span class="op" id="1813282">)</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1813286">return</span>&nbsp;<span class="num" id="1813293">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1813296">case</span>&nbsp;<span class="ident" id="1813301"><a href="/gostd/unicode/utf8/utf8.go.html#1813228">i</a></span>&nbsp;<span class="op" id="1813303">&lt;=</span>&nbsp;<span class="ident" id="1813306"><a href="/gostd/unicode/utf8/utf8.go.html#1806114">rune2Max</a></span><span class="op" id="1813314">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1813318"><a href="/gostd/unicode/utf8/utf8.go.html#1813118">p</a></span><span class="op" id="1813319">[</span><span class="num" id="1813320">0</span><span class="op" id="1813321">]</span>&nbsp;<span class="op" id="1813323">=</span>&nbsp;<span class="ident" id="1813325"><a href="/gostd/unicode/utf8/utf8.go.html#1805887">t2</a></span>&nbsp;<span class="op" id="1813328">|</span>&nbsp;<span class="builtintype" id="1813330">byte</span><span class="op" id="1813334">(</span><span class="ident" id="1813335"><a href="/gostd/unicode/utf8/utf8.go.html#1813128">r</a></span><span class="op" id="1813336">&gt;&gt;</span><span class="num" id="1813338">6</span><span class="op" id="1813339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1813343"><a href="/gostd/unicode/utf8/utf8.go.html#1813118">p</a></span><span class="op" id="1813344">[</span><span class="num" id="1813345">1</span><span class="op" id="1813346">]</span>&nbsp;<span class="op" id="1813348">=</span>&nbsp;<span class="ident" id="1813350"><a href="/gostd/unicode/utf8/utf8.go.html#1805863">tx</a></span>&nbsp;<span class="op" id="1813353">|</span>&nbsp;<span class="builtintype" id="1813355">byte</span><span class="op" id="1813359">(</span><span class="ident" id="1813360"><a href="/gostd/unicode/utf8/utf8.go.html#1813128">r</a></span><span class="op" id="1813361">)</span><span class="op" id="1813362">&amp;</span><span class="ident" id="1813363"><a href="/gostd/unicode/utf8/utf8.go.html#1805984">maskx</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1813371">return</span>&nbsp;<span class="num" id="1813378">2</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1813381">case</span>&nbsp;<span class="ident" id="1813386"><a href="/gostd/unicode/utf8/utf8.go.html#1813228">i</a></span>&nbsp;<span class="op" id="1813388">&gt;</span>&nbsp;<span class="ident" id="1813390"><a href="/gostd/unicode/utf8/utf8.go.html#1805554">MaxRune</a></span><span class="op" id="1813397">,</span>&nbsp;<span class="ident" id="1813399"><a href="/gostd/unicode/utf8/utf8.go.html#1805782">surrogateMin</a></span>&nbsp;<span class="op" id="1813412">&lt;=</span>&nbsp;<span class="ident" id="1813415"><a href="/gostd/unicode/utf8/utf8.go.html#1813228">i</a></span>&nbsp;<span class="op" id="1813417">&amp;&amp;</span>&nbsp;<span class="ident" id="1813420"><a href="/gostd/unicode/utf8/utf8.go.html#1813228">i</a></span>&nbsp;<span class="op" id="1813422">&lt;=</span>&nbsp;<span class="ident" id="1813425"><a href="/gostd/unicode/utf8/utf8.go.html#1805805">surrogateMax</a></span><span class="op" id="1813437">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1813441"><a href="/gostd/unicode/utf8/utf8.go.html#1813128">r</a></span>&nbsp;<span class="op" id="1813443">=</span>&nbsp;<span class="ident" id="1813445"><a href="/gostd/unicode/utf8/utf8.go.html#1805370">RuneError</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1813457">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1813470">case</span>&nbsp;<span class="ident" id="1813475"><a href="/gostd/unicode/utf8/utf8.go.html#1813228">i</a></span>&nbsp;<span class="op" id="1813477">&lt;=</span>&nbsp;<span class="ident" id="1813480"><a href="/gostd/unicode/utf8/utf8.go.html#1806136">rune3Max</a></span><span class="op" id="1813488">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1813492"><a href="/gostd/unicode/utf8/utf8.go.html#1813118">p</a></span><span class="op" id="1813493">[</span><span class="num" id="1813494">0</span><span class="op" id="1813495">]</span>&nbsp;<span class="op" id="1813497">=</span>&nbsp;<span class="ident" id="1813499"><a href="/gostd/unicode/utf8/utf8.go.html#1805911">t3</a></span>&nbsp;<span class="op" id="1813502">|</span>&nbsp;<span class="builtintype" id="1813504">byte</span><span class="op" id="1813508">(</span><span class="ident" id="1813509"><a href="/gostd/unicode/utf8/utf8.go.html#1813128">r</a></span><span class="op" id="1813510">&gt;&gt;</span><span class="num" id="1813512">12</span><span class="op" id="1813514">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1813518"><a href="/gostd/unicode/utf8/utf8.go.html#1813118">p</a></span><span class="op" id="1813519">[</span><span class="num" id="1813520">1</span><span class="op" id="1813521">]</span>&nbsp;<span class="op" id="1813523">=</span>&nbsp;<span class="ident" id="1813525"><a href="/gostd/unicode/utf8/utf8.go.html#1805863">tx</a></span>&nbsp;<span class="op" id="1813528">|</span>&nbsp;<span class="builtintype" id="1813530">byte</span><span class="op" id="1813534">(</span><span class="ident" id="1813535"><a href="/gostd/unicode/utf8/utf8.go.html#1813128">r</a></span><span class="op" id="1813536">&gt;&gt;</span><span class="num" id="1813538">6</span><span class="op" id="1813539">)</span><span class="op" id="1813540">&amp;</span><span class="ident" id="1813541"><a href="/gostd/unicode/utf8/utf8.go.html#1805984">maskx</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1813549"><a href="/gostd/unicode/utf8/utf8.go.html#1813118">p</a></span><span class="op" id="1813550">[</span><span class="num" id="1813551">2</span><span class="op" id="1813552">]</span>&nbsp;<span class="op" id="1813554">=</span>&nbsp;<span class="ident" id="1813556"><a href="/gostd/unicode/utf8/utf8.go.html#1805863">tx</a></span>&nbsp;<span class="op" id="1813559">|</span>&nbsp;<span class="builtintype" id="1813561">byte</span><span class="op" id="1813565">(</span><span class="ident" id="1813566"><a href="/gostd/unicode/utf8/utf8.go.html#1813128">r</a></span><span class="op" id="1813567">)</span><span class="op" id="1813568">&amp;</span><span class="ident" id="1813569"><a href="/gostd/unicode/utf8/utf8.go.html#1805984">maskx</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1813577">return</span>&nbsp;<span class="num" id="1813584">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1813587">default</span><span class="op" id="1813594">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1813598"><a href="/gostd/unicode/utf8/utf8.go.html#1813118">p</a></span><span class="op" id="1813599">[</span><span class="num" id="1813600">0</span><span class="op" id="1813601">]</span>&nbsp;<span class="op" id="1813603">=</span>&nbsp;<span class="ident" id="1813605"><a href="/gostd/unicode/utf8/utf8.go.html#1805935">t4</a></span>&nbsp;<span class="op" id="1813608">|</span>&nbsp;<span class="builtintype" id="1813610">byte</span><span class="op" id="1813614">(</span><span class="ident" id="1813615"><a href="/gostd/unicode/utf8/utf8.go.html#1813128">r</a></span><span class="op" id="1813616">&gt;&gt;</span><span class="num" id="1813618">18</span><span class="op" id="1813620">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1813624"><a href="/gostd/unicode/utf8/utf8.go.html#1813118">p</a></span><span class="op" id="1813625">[</span><span class="num" id="1813626">1</span><span class="op" id="1813627">]</span>&nbsp;<span class="op" id="1813629">=</span>&nbsp;<span class="ident" id="1813631"><a href="/gostd/unicode/utf8/utf8.go.html#1805863">tx</a></span>&nbsp;<span class="op" id="1813634">|</span>&nbsp;<span class="builtintype" id="1813636">byte</span><span class="op" id="1813640">(</span><span class="ident" id="1813641"><a href="/gostd/unicode/utf8/utf8.go.html#1813128">r</a></span><span class="op" id="1813642">&gt;&gt;</span><span class="num" id="1813644">12</span><span class="op" id="1813646">)</span><span class="op" id="1813647">&amp;</span><span class="ident" id="1813648"><a href="/gostd/unicode/utf8/utf8.go.html#1805984">maskx</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1813656"><a href="/gostd/unicode/utf8/utf8.go.html#1813118">p</a></span><span class="op" id="1813657">[</span><span class="num" id="1813658">2</span><span class="op" id="1813659">]</span>&nbsp;<span class="op" id="1813661">=</span>&nbsp;<span class="ident" id="1813663"><a href="/gostd/unicode/utf8/utf8.go.html#1805863">tx</a></span>&nbsp;<span class="op" id="1813666">|</span>&nbsp;<span class="builtintype" id="1813668">byte</span><span class="op" id="1813672">(</span><span class="ident" id="1813673"><a href="/gostd/unicode/utf8/utf8.go.html#1813128">r</a></span><span class="op" id="1813674">&gt;&gt;</span><span class="num" id="1813676">6</span><span class="op" id="1813677">)</span><span class="op" id="1813678">&amp;</span><span class="ident" id="1813679"><a href="/gostd/unicode/utf8/utf8.go.html#1805984">maskx</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1813687"><a href="/gostd/unicode/utf8/utf8.go.html#1813118">p</a></span><span class="op" id="1813688">[</span><span class="num" id="1813689">3</span><span class="op" id="1813690">]</span>&nbsp;<span class="op" id="1813692">=</span>&nbsp;<span class="ident" id="1813694"><a href="/gostd/unicode/utf8/utf8.go.html#1805863">tx</a></span>&nbsp;<span class="op" id="1813697">|</span>&nbsp;<span class="builtintype" id="1813699">byte</span><span class="op" id="1813703">(</span><span class="ident" id="1813704"><a href="/gostd/unicode/utf8/utf8.go.html#1813128">r</a></span><span class="op" id="1813705">)</span><span class="op" id="1813706">&amp;</span><span class="ident" id="1813707"><a href="/gostd/unicode/utf8/utf8.go.html#1805984">maskx</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1813715">return</span>&nbsp;<span class="num" id="1813722">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1813725">}</span><br>
<span class="lineno">365</span><span class="op" id="1813727">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1813730">//&nbsp;RuneCount&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;runes&nbsp;in&nbsp;p.&nbsp;&nbsp;Erroneous&nbsp;and&nbsp;short</span><br>
<span class="lineno"></span><span class="comment" id="1813798">//&nbsp;encodings&nbsp;are&nbsp;treated&nbsp;as&nbsp;single&nbsp;runes&nbsp;of&nbsp;width&nbsp;1&nbsp;byte.</span><br>
<span class="lineno"></span><span class="keyword" id="1813856">func</span>&nbsp;<span class="ident" id="1813861">RuneCount</span><span class="op" id="1813870">(</span><span class="ident" id="1813871">p</span>&nbsp;<span class="op" id="1813873">[</span><span class="op" id="1813874">]</span><span class="builtintype" id="1813875">byte</span><span class="op" id="1813879">)</span>&nbsp;<span class="builtintype" id="1813881">int</span>&nbsp;<span class="op" id="1813885">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1813888">i</span>&nbsp;<span class="op" id="1813890">:=</span>&nbsp;<span class="num" id="1813893">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1813896">var</span>&nbsp;<span class="ident" id="1813900">n</span>&nbsp;<span class="builtintype" id="1813902">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1813907">for</span>&nbsp;<span class="ident" id="1813911"><a href="/gostd/unicode/utf8/utf8.go.html#1813900">n</a></span>&nbsp;<span class="op" id="1813913">=</span>&nbsp;<span class="num" id="1813915">0</span><span class="op" id="1813916">;</span>&nbsp;<span class="ident" id="1813918"><a href="/gostd/unicode/utf8/utf8.go.html#1813888">i</a></span>&nbsp;<span class="op" id="1813920">&lt;</span>&nbsp;<span class="builtinfunc" id="1813922">len</span><span class="op" id="1813925">(</span><span class="ident" id="1813926"><a href="/gostd/unicode/utf8/utf8.go.html#1813871">p</a></span><span class="op" id="1813927">)</span><span class="op" id="1813928">;</span>&nbsp;<span class="ident" id="1813930"><a href="/gostd/unicode/utf8/utf8.go.html#1813900">n</a></span><span class="op" id="1813931">++</span>&nbsp;<span class="op" id="1813934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1813938">if</span>&nbsp;<span class="ident" id="1813941"><a href="/gostd/unicode/utf8/utf8.go.html#1813871">p</a></span><span class="op" id="1813942">[</span><span class="ident" id="1813943"><a href="/gostd/unicode/utf8/utf8.go.html#1813888">i</a></span><span class="op" id="1813944">]</span>&nbsp;<span class="op" id="1813946">&lt;</span>&nbsp;<span class="ident" id="1813948"><a href="/gostd/unicode/utf8/utf8.go.html#1805451">RuneSelf</a></span>&nbsp;<span class="op" id="1813957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1813962"><a href="/gostd/unicode/utf8/utf8.go.html#1813888">i</a></span><span class="op" id="1813963">++</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1813968">}</span>&nbsp;<span class="keyword" id="1813970">else</span>&nbsp;<span class="op" id="1813975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1813980">_</span><span class="op" id="1813981">,</span>&nbsp;<span class="ident" id="1813983">size</span>&nbsp;<span class="op" id="1813988">:=</span>&nbsp;<span class="ident" id="1813991"><a href="/gostd/unicode/utf8/utf8.go.html#1809912">DecodeRune</a></span><span class="op" id="1814001">(</span><span class="ident" id="1814002"><a href="/gostd/unicode/utf8/utf8.go.html#1813871">p</a></span><span class="op" id="1814003">[</span><span class="ident" id="1814004"><a href="/gostd/unicode/utf8/utf8.go.html#1813888">i</a></span><span class="op" id="1814005">:</span><span class="op" id="1814006">]</span><span class="op" id="1814007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1814012"><a href="/gostd/unicode/utf8/utf8.go.html#1813888">i</a></span>&nbsp;<span class="op" id="1814014">+=</span>&nbsp;<span class="ident" id="1814017"><a href="/gostd/unicode/utf8/utf8.go.html#1813983">size</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1814024">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1814027">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1814030">return</span>&nbsp;<span class="ident" id="1814037"><a href="/gostd/unicode/utf8/utf8.go.html#1813900">n</a></span><br>
<span class="lineno"></span><span class="op" id="1814039">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1814042">//&nbsp;RuneCountInString&nbsp;is&nbsp;like&nbsp;RuneCount&nbsp;but&nbsp;its&nbsp;input&nbsp;is&nbsp;a&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="1814108">func</span>&nbsp;<span class="ident" id="1814113">RuneCountInString</span><span class="op" id="1814130">(</span><span class="ident" id="1814131">s</span>&nbsp;<span class="builtintype" id="1814133">string</span><span class="op" id="1814139">)</span>&nbsp;<span class="op" id="1814141">(</span><span class="ident" id="1814142">n</span>&nbsp;<span class="builtintype" id="1814144">int</span><span class="op" id="1814147">)</span>&nbsp;<span class="op" id="1814149">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1814152">for</span>&nbsp;<span class="keyword" id="1814156">range</span>&nbsp;<span class="ident" id="1814162"><a href="/gostd/unicode/utf8/utf8.go.html#1814131">s</a></span>&nbsp;<span class="op" id="1814164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1814168"><a href="/gostd/unicode/utf8/utf8.go.html#1814142">n</a></span><span class="op" id="1814169">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1814173">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1814176">return</span><br>
<span class="lineno"></span><span class="op" id="1814183">}</span><br>
<span class="lineno">390</span><br>
<span class="lineno"></span><span class="comment" id="1814186">//&nbsp;RuneStart&nbsp;reports&nbsp;whether&nbsp;the&nbsp;byte&nbsp;could&nbsp;be&nbsp;the&nbsp;first&nbsp;byte&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1814251">//&nbsp;an&nbsp;encoded&nbsp;rune.&nbsp;&nbsp;Second&nbsp;and&nbsp;subsequent&nbsp;bytes&nbsp;always&nbsp;have&nbsp;the&nbsp;top</span><br>
<span class="lineno"></span><span class="comment" id="1814320">//&nbsp;two&nbsp;bits&nbsp;set&nbsp;to&nbsp;10.</span><br>
<span class="lineno"></span><span class="keyword" id="1814343">func</span>&nbsp;<span class="ident" id="1814348">RuneStart</span><span class="op" id="1814357">(</span><span class="ident" id="1814358">b</span>&nbsp;<span class="builtintype" id="1814360">byte</span><span class="op" id="1814364">)</span>&nbsp;<span class="builtintype" id="1814366">bool</span>&nbsp;<span class="op" id="1814371">{</span>&nbsp;<span class="keyword" id="1814373">return</span>&nbsp;<span class="ident" id="1814380"><a href="/gostd/unicode/utf8/utf8.go.html#1814358">b</a></span><span class="op" id="1814381">&amp;</span><span class="num" id="1814382">0xC0</span>&nbsp;<span class="op" id="1814387">!=</span>&nbsp;<span class="num" id="1814390">0x80</span>&nbsp;<span class="op" id="1814395">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="comment" id="1814398">//&nbsp;Valid&nbsp;reports&nbsp;whether&nbsp;p&nbsp;consists&nbsp;entirely&nbsp;of&nbsp;valid&nbsp;UTF-8-encoded&nbsp;runes.</span><br>
<span class="lineno"></span><span class="keyword" id="1814473">func</span>&nbsp;<span class="ident" id="1814478">Valid</span><span class="op" id="1814483">(</span><span class="ident" id="1814484">p</span>&nbsp;<span class="op" id="1814486">[</span><span class="op" id="1814487">]</span><span class="builtintype" id="1814488">byte</span><span class="op" id="1814492">)</span>&nbsp;<span class="builtintype" id="1814494">bool</span>&nbsp;<span class="op" id="1814499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1814502">i</span>&nbsp;<span class="op" id="1814504">:=</span>&nbsp;<span class="num" id="1814507">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1814510">for</span>&nbsp;<span class="ident" id="1814514"><a href="/gostd/unicode/utf8/utf8.go.html#1814502">i</a></span>&nbsp;<span class="op" id="1814516">&lt;</span>&nbsp;<span class="builtinfunc" id="1814518">len</span><span class="op" id="1814521">(</span><span class="ident" id="1814522"><a href="/gostd/unicode/utf8/utf8.go.html#1814484">p</a></span><span class="op" id="1814523">)</span>&nbsp;<span class="op" id="1814525">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1814529">if</span>&nbsp;<span class="ident" id="1814532"><a href="/gostd/unicode/utf8/utf8.go.html#1814484">p</a></span><span class="op" id="1814533">[</span><span class="ident" id="1814534"><a href="/gostd/unicode/utf8/utf8.go.html#1814502">i</a></span><span class="op" id="1814535">]</span>&nbsp;<span class="op" id="1814537">&lt;</span>&nbsp;<span class="ident" id="1814539"><a href="/gostd/unicode/utf8/utf8.go.html#1805451">RuneSelf</a></span>&nbsp;<span class="op" id="1814548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1814553"><a href="/gostd/unicode/utf8/utf8.go.html#1814502">i</a></span><span class="op" id="1814554">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1814559">}</span>&nbsp;<span class="keyword" id="1814561">else</span>&nbsp;<span class="op" id="1814566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1814571">_</span><span class="op" id="1814572">,</span>&nbsp;<span class="ident" id="1814574">size</span>&nbsp;<span class="op" id="1814579">:=</span>&nbsp;<span class="ident" id="1814582"><a href="/gostd/unicode/utf8/utf8.go.html#1809912">DecodeRune</a></span><span class="op" id="1814592">(</span><span class="ident" id="1814593"><a href="/gostd/unicode/utf8/utf8.go.html#1814484">p</a></span><span class="op" id="1814594">[</span><span class="ident" id="1814595"><a href="/gostd/unicode/utf8/utf8.go.html#1814502">i</a></span><span class="op" id="1814596">:</span><span class="op" id="1814597">]</span><span class="op" id="1814598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1814603">if</span>&nbsp;<span class="ident" id="1814606"><a href="/gostd/unicode/utf8/utf8.go.html#1814574">size</a></span>&nbsp;<span class="op" id="1814611">==</span>&nbsp;<span class="num" id="1814614">1</span>&nbsp;<span class="op" id="1814616">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1814622">//&nbsp;All&nbsp;valid&nbsp;runes&nbsp;of&nbsp;size&nbsp;1&nbsp;(those</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1814662">//&nbsp;below&nbsp;RuneSelf)&nbsp;were&nbsp;handled&nbsp;above.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1814705">//&nbsp;This&nbsp;must&nbsp;be&nbsp;a&nbsp;RuneError.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1814738">return</span>&nbsp;<span class="builtintype" id="1814745">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1814754">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1814759"><a href="/gostd/unicode/utf8/utf8.go.html#1814502">i</a></span>&nbsp;<span class="op" id="1814761">+=</span>&nbsp;<span class="ident" id="1814764"><a href="/gostd/unicode/utf8/utf8.go.html#1814574">size</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1814771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1814774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1814777">return</span>&nbsp;<span class="builtintype" id="1814784">true</span><br>
<span class="lineno"></span><span class="op" id="1814789">}</span><br>
<span class="lineno">415</span><br>
<span class="lineno"></span><span class="comment" id="1814792">//&nbsp;ValidString&nbsp;reports&nbsp;whether&nbsp;s&nbsp;consists&nbsp;entirely&nbsp;of&nbsp;valid&nbsp;UTF-8-encoded&nbsp;runes.</span><br>
<span class="lineno"></span><span class="keyword" id="1814873">func</span>&nbsp;<span class="ident" id="1814878">ValidString</span><span class="op" id="1814889">(</span><span class="ident" id="1814890">s</span>&nbsp;<span class="builtintype" id="1814892">string</span><span class="op" id="1814898">)</span>&nbsp;<span class="builtintype" id="1814900">bool</span>&nbsp;<span class="op" id="1814905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1814908">for</span>&nbsp;<span class="ident" id="1814912">i</span><span class="op" id="1814913">,</span>&nbsp;<span class="ident" id="1814915">r</span>&nbsp;<span class="op" id="1814917">:=</span>&nbsp;<span class="keyword" id="1814920">range</span>&nbsp;<span class="ident" id="1814926"><a href="/gostd/unicode/utf8/utf8.go.html#1814890">s</a></span>&nbsp;<span class="op" id="1814928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1814932">if</span>&nbsp;<span class="ident" id="1814935"><a href="/gostd/unicode/utf8/utf8.go.html#1814915">r</a></span>&nbsp;<span class="op" id="1814937">==</span>&nbsp;<span class="ident" id="1814940"><a href="/gostd/unicode/utf8/utf8.go.html#1805370">RuneError</a></span>&nbsp;<span class="op" id="1814950">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1814955">//&nbsp;The&nbsp;RuneError&nbsp;value&nbsp;can&nbsp;be&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1814997">//&nbsp;sentinel&nbsp;value&nbsp;(if&nbsp;it&#39;s&nbsp;size&nbsp;1)&nbsp;or&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1815047">//&nbsp;value&nbsp;encoded&nbsp;properly.&nbsp;Decode&nbsp;it&nbsp;to&nbsp;see&nbsp;if</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1815097">//&nbsp;it&#39;s&nbsp;the&nbsp;1&nbsp;byte&nbsp;sentinel&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1815135">_</span><span class="op" id="1815136">,</span>&nbsp;<span class="ident" id="1815138">size</span>&nbsp;<span class="op" id="1815143">:=</span>&nbsp;<span class="ident" id="1815146"><a href="/gostd/unicode/utf8/utf8.go.html#1810428">DecodeRuneInString</a></span><span class="op" id="1815164">(</span><span class="ident" id="1815165"><a href="/gostd/unicode/utf8/utf8.go.html#1814890">s</a></span><span class="op" id="1815166">[</span><span class="ident" id="1815167"><a href="/gostd/unicode/utf8/utf8.go.html#1814912">i</a></span><span class="op" id="1815168">:</span><span class="op" id="1815169">]</span><span class="op" id="1815170">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1815175">if</span>&nbsp;<span class="ident" id="1815178"><a href="/gostd/unicode/utf8/utf8.go.html#1815138">size</a></span>&nbsp;<span class="op" id="1815183">==</span>&nbsp;<span class="num" id="1815186">1</span>&nbsp;<span class="op" id="1815188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1815194">return</span>&nbsp;<span class="builtintype" id="1815201">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1815210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1815214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1815217">}</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1815220">return</span>&nbsp;<span class="builtintype" id="1815227">true</span><br>
<span class="lineno"></span><span class="op" id="1815232">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1815235">//&nbsp;ValidRune&nbsp;reports&nbsp;whether&nbsp;r&nbsp;can&nbsp;be&nbsp;legally&nbsp;encoded&nbsp;as&nbsp;UTF-8.</span><br>
<span class="lineno"></span><span class="comment" id="1815299">//&nbsp;Code&nbsp;points&nbsp;that&nbsp;are&nbsp;out&nbsp;of&nbsp;range&nbsp;or&nbsp;a&nbsp;surrogate&nbsp;half&nbsp;are&nbsp;illegal.</span><br>
<span class="lineno">435</span><span class="keyword" id="1815369">func</span>&nbsp;<span class="ident" id="1815374">ValidRune</span><span class="op" id="1815383">(</span><span class="ident" id="1815384">r</span>&nbsp;<span class="builtintype" id="1815386">rune</span><span class="op" id="1815390">)</span>&nbsp;<span class="builtintype" id="1815392">bool</span>&nbsp;<span class="op" id="1815397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1815400">switch</span>&nbsp;<span class="op" id="1815407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1815410">case</span>&nbsp;<span class="ident" id="1815415"><a href="/gostd/unicode/utf8/utf8.go.html#1815384">r</a></span>&nbsp;<span class="op" id="1815417">&lt;</span>&nbsp;<span class="num" id="1815419">0</span><span class="op" id="1815420">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1815424">return</span>&nbsp;<span class="builtintype" id="1815431">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1815438">case</span>&nbsp;<span class="ident" id="1815443"><a href="/gostd/unicode/utf8/utf8.go.html#1805782">surrogateMin</a></span>&nbsp;<span class="op" id="1815456">&lt;=</span>&nbsp;<span class="ident" id="1815459"><a href="/gostd/unicode/utf8/utf8.go.html#1815384">r</a></span>&nbsp;<span class="op" id="1815461">&amp;&amp;</span>&nbsp;<span class="ident" id="1815464"><a href="/gostd/unicode/utf8/utf8.go.html#1815384">r</a></span>&nbsp;<span class="op" id="1815466">&lt;=</span>&nbsp;<span class="ident" id="1815469"><a href="/gostd/unicode/utf8/utf8.go.html#1805805">surrogateMax</a></span><span class="op" id="1815481">:</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1815485">return</span>&nbsp;<span class="builtintype" id="1815492">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1815499">case</span>&nbsp;<span class="ident" id="1815504"><a href="/gostd/unicode/utf8/utf8.go.html#1815384">r</a></span>&nbsp;<span class="op" id="1815506">&gt;</span>&nbsp;<span class="ident" id="1815508"><a href="/gostd/unicode/utf8/utf8.go.html#1805554">MaxRune</a></span><span class="op" id="1815515">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1815519">return</span>&nbsp;<span class="builtintype" id="1815526">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1815533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1815536">return</span>&nbsp;<span class="builtintype" id="1815543">true</span><br>
<span class="lineno">445</span><span class="op" id="1815548">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
