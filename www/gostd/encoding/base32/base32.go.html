<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/base32</h2>
<ul>
<li><a href="/gostd/encoding/base32/base32.go.html">base32.go</a></li>
<li><a href="/gostd/encoding/base32/base32_test.go.html">base32_test.go</a></li>
<li><a href="/gostd/encoding/base32/example_test.go.html">example_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6159019">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6159074">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6159128">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6159179">//&nbsp;Package&nbsp;base32&nbsp;implements&nbsp;base32&nbsp;encoding&nbsp;as&nbsp;specified&nbsp;by&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno"></span><span class="keyword" id="6159250">package</span>&nbsp;<span class="ident" id="6159258">base32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6159266">import</span>&nbsp;<span class="op" id="6159273">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6159276">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6159285">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6159291">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6159302">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="6159312">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="6159315">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Encodings<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6159336">//&nbsp;An&nbsp;Encoding&nbsp;is&nbsp;a&nbsp;radix&nbsp;32&nbsp;encoding/decoding&nbsp;scheme,&nbsp;defined&nbsp;by&nbsp;a</span><br>
<span class="lineno">20</span><span class="comment" id="6159404">//&nbsp;32-character&nbsp;alphabet.&nbsp;&nbsp;The&nbsp;most&nbsp;common&nbsp;is&nbsp;the&nbsp;&#34;base32&#34;&nbsp;encoding</span><br>
<span class="lineno"></span><span class="comment" id="6159472">//&nbsp;introduced&nbsp;for&nbsp;SASL&nbsp;GSSAPI&nbsp;and&nbsp;standardized&nbsp;in&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno"></span><span class="comment" id="6159532">//&nbsp;The&nbsp;alternate&nbsp;&#34;base32hex&#34;&nbsp;encoding&nbsp;is&nbsp;used&nbsp;in&nbsp;DNSSEC.</span><br>
<span class="lineno"></span><span class="keyword" id="6159589">type</span>&nbsp;<span class="ident" id="6159594">Encoding</span>&nbsp;<span class="keyword" id="6159603">struct</span>&nbsp;<span class="op" id="6159610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6159613">encode</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6159623">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6159631">decodeMap</span>&nbsp;<span class="op" id="6159641">[</span><span class="num" id="6159642">256</span><span class="op" id="6159645">]</span><span class="builtintype" id="6159646">byte</span><br>
<span class="lineno"></span><span class="op" id="6159651">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6159654">const</span>&nbsp;<span class="ident" id="6159660">encodeStd</span>&nbsp;<span class="op" id="6159670">=</span>&nbsp;<span class="string" id="6159672">&#34;ABCDEFGHIJKLMNOPQRSTUVWXYZ234567&#34;</span><br>
<span class="lineno"></span><span class="keyword" id="6159707">const</span>&nbsp;<span class="ident" id="6159713">encodeHex</span>&nbsp;<span class="op" id="6159723">=</span>&nbsp;<span class="string" id="6159725">&#34;0123456789ABCDEFGHIJKLMNOPQRSTUV&#34;</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="6159761">//&nbsp;NewEncoding&nbsp;returns&nbsp;a&nbsp;new&nbsp;Encoding&nbsp;defined&nbsp;by&nbsp;the&nbsp;given&nbsp;alphabet,</span><br>
<span class="lineno"></span><span class="comment" id="6159830">//&nbsp;which&nbsp;must&nbsp;be&nbsp;a&nbsp;32-byte&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="6159865">func</span>&nbsp;<span class="ident" id="6159870">NewEncoding</span><span class="op" id="6159881">(</span><span class="ident" id="6159882">encoder</span>&nbsp;<span class="builtintype" id="6159890">string</span><span class="op" id="6159896">)</span>&nbsp;<span class="op" id="6159898">*</span><span class="ident" id="6159899">Encoding</span>&nbsp;<span class="op" id="6159908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6159911">e</span>&nbsp;<span class="op" id="6159913">:=</span>&nbsp;<span class="builtinfunc" id="6159916">new</span><span class="op" id="6159919">(</span><span class="ident" id="6159920">Encoding</span><span class="op" id="6159928">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6159931">e</span><span class="op" id="6159932">.</span><span class="ident" id="6159933">encode</span>&nbsp;<span class="op" id="6159940">=</span>&nbsp;<span class="ident" id="6159942">encoder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6159951">for</span>&nbsp;<span class="ident" id="6159955">i</span>&nbsp;<span class="op" id="6159957">:=</span>&nbsp;<span class="num" id="6159960">0</span><span class="op" id="6159961">;</span>&nbsp;<span class="ident" id="6159963">i</span>&nbsp;<span class="op" id="6159965">&lt;</span>&nbsp;<span class="builtinfunc" id="6159967">len</span><span class="op" id="6159970">(</span><span class="ident" id="6159971">e</span><span class="op" id="6159972">.</span><span class="ident" id="6159973">decodeMap</span><span class="op" id="6159982">)</span><span class="op" id="6159983">;</span>&nbsp;<span class="ident" id="6159985">i</span><span class="op" id="6159986">++</span>&nbsp;<span class="op" id="6159989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6159993">e</span><span class="op" id="6159994">.</span><span class="ident" id="6159995">decodeMap</span><span class="op" id="6160004">[</span><span class="ident" id="6160005">i</span><span class="op" id="6160006">]</span>&nbsp;<span class="op" id="6160008">=</span>&nbsp;<span class="num" id="6160010">0xFF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6160016">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6160019">for</span>&nbsp;<span class="ident" id="6160023">i</span>&nbsp;<span class="op" id="6160025">:=</span>&nbsp;<span class="num" id="6160028">0</span><span class="op" id="6160029">;</span>&nbsp;<span class="ident" id="6160031">i</span>&nbsp;<span class="op" id="6160033">&lt;</span>&nbsp;<span class="builtinfunc" id="6160035">len</span><span class="op" id="6160038">(</span><span class="ident" id="6160039">encoder</span><span class="op" id="6160046">)</span><span class="op" id="6160047">;</span>&nbsp;<span class="ident" id="6160049">i</span><span class="op" id="6160050">++</span>&nbsp;<span class="op" id="6160053">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6160057">e</span><span class="op" id="6160058">.</span><span class="ident" id="6160059">decodeMap</span><span class="op" id="6160068">[</span><span class="ident" id="6160069">encoder</span><span class="op" id="6160076">[</span><span class="ident" id="6160077">i</span><span class="op" id="6160078">]</span><span class="op" id="6160079">]</span>&nbsp;<span class="op" id="6160081">=</span>&nbsp;<span class="builtintype" id="6160083">byte</span><span class="op" id="6160087">(</span><span class="ident" id="6160088">i</span><span class="op" id="6160089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6160092">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6160095">return</span>&nbsp;<span class="ident" id="6160102">e</span><br>
<span class="lineno"></span><span class="op" id="6160104">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="6160107">//&nbsp;StdEncoding&nbsp;is&nbsp;the&nbsp;standard&nbsp;base32&nbsp;encoding,&nbsp;as&nbsp;defined&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="6160169">//&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno"></span><span class="keyword" id="6160182">var</span>&nbsp;<span class="ident" id="6160186">StdEncoding</span>&nbsp;<span class="op" id="6160198">=</span>&nbsp;<span class="ident" id="6160200">NewEncoding</span><span class="op" id="6160211">(</span><span class="ident" id="6160212">encodeStd</span><span class="op" id="6160221">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6160224">//&nbsp;HexEncoding&nbsp;is&nbsp;the&nbsp;``Extended&nbsp;Hex&nbsp;Alphabet&#39;&#39;&nbsp;defined&nbsp;in&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno">50</span><span class="comment" id="6160293">//&nbsp;It&nbsp;is&nbsp;typically&nbsp;used&nbsp;in&nbsp;DNS.</span><br>
<span class="lineno"></span><span class="keyword" id="6160325">var</span>&nbsp;<span class="ident" id="6160329">HexEncoding</span>&nbsp;<span class="op" id="6160341">=</span>&nbsp;<span class="ident" id="6160343">NewEncoding</span><span class="op" id="6160354">(</span><span class="ident" id="6160355">encodeHex</span><span class="op" id="6160364">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6160367">var</span>&nbsp;<span class="ident" id="6160371">removeNewlinesMapper</span>&nbsp;<span class="op" id="6160392">=</span>&nbsp;<span class="keyword" id="6160394">func</span><span class="op" id="6160398">(</span><span class="ident" id="6160399">r</span>&nbsp;<span class="builtintype" id="6160401">rune</span><span class="op" id="6160405">)</span>&nbsp;<span class="builtintype" id="6160407">rune</span>&nbsp;<span class="op" id="6160412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6160415">if</span>&nbsp;<span class="ident" id="6160418">r</span>&nbsp;<span class="op" id="6160420">==</span>&nbsp;<span class="string" id="6160423">&#39;\r&#39;</span>&nbsp;<span class="op" id="6160428">||</span>&nbsp;<span class="ident" id="6160431">r</span>&nbsp;<span class="op" id="6160433">==</span>&nbsp;<span class="string" id="6160436">&#39;\n&#39;</span>&nbsp;<span class="op" id="6160441">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6160445">return</span>&nbsp;<span class="op" id="6160452">-</span><span class="num" id="6160453">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6160456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6160459">return</span>&nbsp;<span class="ident" id="6160466">r</span><br>
<span class="lineno"></span><span class="op" id="6160468">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="comment" id="6160471">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Encoder<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6160490">//&nbsp;Encode&nbsp;encodes&nbsp;src&nbsp;using&nbsp;the&nbsp;encoding&nbsp;enc,&nbsp;writing</span><br>
<span class="lineno">65</span><span class="comment" id="6160544">//&nbsp;EncodedLen(len(src))&nbsp;bytes&nbsp;to&nbsp;dst.</span><br>
<span class="lineno"></span><span class="comment" id="6160582">//</span><br>
<span class="lineno"></span><span class="comment" id="6160585">//&nbsp;The&nbsp;encoding&nbsp;pads&nbsp;the&nbsp;output&nbsp;to&nbsp;a&nbsp;multiple&nbsp;of&nbsp;8&nbsp;bytes,</span><br>
<span class="lineno"></span><span class="comment" id="6160643">//&nbsp;so&nbsp;Encode&nbsp;is&nbsp;not&nbsp;appropriate&nbsp;for&nbsp;use&nbsp;on&nbsp;individual&nbsp;blocks</span><br>
<span class="lineno"></span><span class="comment" id="6160704">//&nbsp;of&nbsp;a&nbsp;large&nbsp;data&nbsp;stream.&nbsp;&nbsp;Use&nbsp;NewEncoder()&nbsp;instead.</span><br>
<span class="lineno">70</span><span class="keyword" id="6160758">func</span>&nbsp;<span class="op" id="6160763">(</span><span class="ident" id="6160764">enc</span>&nbsp;<span class="op" id="6160768">*</span><span class="ident" id="6160769">Encoding</span><span class="op" id="6160777">)</span>&nbsp;<span class="ident" id="6160779">Encode</span><span class="op" id="6160785">(</span><span class="ident" id="6160786">dst</span><span class="op" id="6160789">,</span>&nbsp;<span class="ident" id="6160791">src</span>&nbsp;<span class="op" id="6160795">[</span><span class="op" id="6160796">]</span><span class="builtintype" id="6160797">byte</span><span class="op" id="6160801">)</span>&nbsp;<span class="op" id="6160803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6160806">if</span>&nbsp;<span class="builtinfunc" id="6160809">len</span><span class="op" id="6160812">(</span><span class="ident" id="6160813">src</span><span class="op" id="6160816">)</span>&nbsp;<span class="op" id="6160818">==</span>&nbsp;<span class="num" id="6160821">0</span>&nbsp;<span class="op" id="6160823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6160827">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6160835">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6160839">for</span>&nbsp;<span class="builtinfunc" id="6160843">len</span><span class="op" id="6160846">(</span><span class="ident" id="6160847">src</span><span class="op" id="6160850">)</span>&nbsp;<span class="op" id="6160852">&gt;</span>&nbsp;<span class="num" id="6160854">0</span>&nbsp;<span class="op" id="6160856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6160860">var</span>&nbsp;<span class="ident" id="6160864">b0</span><span class="op" id="6160866">,</span>&nbsp;<span class="ident" id="6160868">b1</span><span class="op" id="6160870">,</span>&nbsp;<span class="ident" id="6160872">b2</span><span class="op" id="6160874">,</span>&nbsp;<span class="ident" id="6160876">b3</span><span class="op" id="6160878">,</span>&nbsp;<span class="ident" id="6160880">b4</span><span class="op" id="6160882">,</span>&nbsp;<span class="ident" id="6160884">b5</span><span class="op" id="6160886">,</span>&nbsp;<span class="ident" id="6160888">b6</span><span class="op" id="6160890">,</span>&nbsp;<span class="ident" id="6160892">b7</span>&nbsp;<span class="builtintype" id="6160895">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6160903">//&nbsp;Unpack&nbsp;8x&nbsp;5-bit&nbsp;source&nbsp;blocks&nbsp;into&nbsp;a&nbsp;5&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6160952">//&nbsp;destination&nbsp;quantum</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6160977">switch</span>&nbsp;<span class="builtinfunc" id="6160984">len</span><span class="op" id="6160987">(</span><span class="ident" id="6160988">src</span><span class="op" id="6160991">)</span>&nbsp;<span class="op" id="6160993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6160997">default</span><span class="op" id="6161004">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161009">b7</span>&nbsp;<span class="op" id="6161012">=</span>&nbsp;<span class="ident" id="6161014">src</span><span class="op" id="6161017">[</span><span class="num" id="6161018">4</span><span class="op" id="6161019">]</span>&nbsp;<span class="op" id="6161021">&amp;</span>&nbsp;<span class="num" id="6161023">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161031">b6</span>&nbsp;<span class="op" id="6161034">=</span>&nbsp;<span class="ident" id="6161036">src</span><span class="op" id="6161039">[</span><span class="num" id="6161040">4</span><span class="op" id="6161041">]</span>&nbsp;<span class="op" id="6161043">&gt;&gt;</span>&nbsp;<span class="num" id="6161046">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161051">fallthrough</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161065">case</span>&nbsp;<span class="num" id="6161070">4</span><span class="op" id="6161071">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161076">b6</span>&nbsp;<span class="op" id="6161079">|=</span>&nbsp;<span class="op" id="6161082">(</span><span class="ident" id="6161083">src</span><span class="op" id="6161086">[</span><span class="num" id="6161087">3</span><span class="op" id="6161088">]</span>&nbsp;<span class="op" id="6161090">&lt;&lt;</span>&nbsp;<span class="num" id="6161093">3</span><span class="op" id="6161094">)</span>&nbsp;<span class="op" id="6161096">&amp;</span>&nbsp;<span class="num" id="6161098">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161106">b5</span>&nbsp;<span class="op" id="6161109">=</span>&nbsp;<span class="op" id="6161111">(</span><span class="ident" id="6161112">src</span><span class="op" id="6161115">[</span><span class="num" id="6161116">3</span><span class="op" id="6161117">]</span>&nbsp;<span class="op" id="6161119">&gt;&gt;</span>&nbsp;<span class="num" id="6161122">2</span><span class="op" id="6161123">)</span>&nbsp;<span class="op" id="6161125">&amp;</span>&nbsp;<span class="num" id="6161127">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161135">b4</span>&nbsp;<span class="op" id="6161138">=</span>&nbsp;<span class="ident" id="6161140">src</span><span class="op" id="6161143">[</span><span class="num" id="6161144">3</span><span class="op" id="6161145">]</span>&nbsp;<span class="op" id="6161147">&gt;&gt;</span>&nbsp;<span class="num" id="6161150">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161155">fallthrough</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161169">case</span>&nbsp;<span class="num" id="6161174">3</span><span class="op" id="6161175">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161180">b4</span>&nbsp;<span class="op" id="6161183">|=</span>&nbsp;<span class="op" id="6161186">(</span><span class="ident" id="6161187">src</span><span class="op" id="6161190">[</span><span class="num" id="6161191">2</span><span class="op" id="6161192">]</span>&nbsp;<span class="op" id="6161194">&lt;&lt;</span>&nbsp;<span class="num" id="6161197">1</span><span class="op" id="6161198">)</span>&nbsp;<span class="op" id="6161200">&amp;</span>&nbsp;<span class="num" id="6161202">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161210">b3</span>&nbsp;<span class="op" id="6161213">=</span>&nbsp;<span class="op" id="6161215">(</span><span class="ident" id="6161216">src</span><span class="op" id="6161219">[</span><span class="num" id="6161220">2</span><span class="op" id="6161221">]</span>&nbsp;<span class="op" id="6161223">&gt;&gt;</span>&nbsp;<span class="num" id="6161226">4</span><span class="op" id="6161227">)</span>&nbsp;<span class="op" id="6161229">&amp;</span>&nbsp;<span class="num" id="6161231">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161239">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161253">case</span>&nbsp;<span class="num" id="6161258">2</span><span class="op" id="6161259">:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161264">b3</span>&nbsp;<span class="op" id="6161267">|=</span>&nbsp;<span class="op" id="6161270">(</span><span class="ident" id="6161271">src</span><span class="op" id="6161274">[</span><span class="num" id="6161275">1</span><span class="op" id="6161276">]</span>&nbsp;<span class="op" id="6161278">&lt;&lt;</span>&nbsp;<span class="num" id="6161281">4</span><span class="op" id="6161282">)</span>&nbsp;<span class="op" id="6161284">&amp;</span>&nbsp;<span class="num" id="6161286">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161294">b2</span>&nbsp;<span class="op" id="6161297">=</span>&nbsp;<span class="op" id="6161299">(</span><span class="ident" id="6161300">src</span><span class="op" id="6161303">[</span><span class="num" id="6161304">1</span><span class="op" id="6161305">]</span>&nbsp;<span class="op" id="6161307">&gt;&gt;</span>&nbsp;<span class="num" id="6161310">1</span><span class="op" id="6161311">)</span>&nbsp;<span class="op" id="6161313">&amp;</span>&nbsp;<span class="num" id="6161315">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161323">b1</span>&nbsp;<span class="op" id="6161326">=</span>&nbsp;<span class="op" id="6161328">(</span><span class="ident" id="6161329">src</span><span class="op" id="6161332">[</span><span class="num" id="6161333">1</span><span class="op" id="6161334">]</span>&nbsp;<span class="op" id="6161336">&gt;&gt;</span>&nbsp;<span class="num" id="6161339">6</span><span class="op" id="6161340">)</span>&nbsp;<span class="op" id="6161342">&amp;</span>&nbsp;<span class="num" id="6161344">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161352">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161366">case</span>&nbsp;<span class="num" id="6161371">1</span><span class="op" id="6161372">:</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161377">b1</span>&nbsp;<span class="op" id="6161380">|=</span>&nbsp;<span class="op" id="6161383">(</span><span class="ident" id="6161384">src</span><span class="op" id="6161387">[</span><span class="num" id="6161388">0</span><span class="op" id="6161389">]</span>&nbsp;<span class="op" id="6161391">&lt;&lt;</span>&nbsp;<span class="num" id="6161394">2</span><span class="op" id="6161395">)</span>&nbsp;<span class="op" id="6161397">&amp;</span>&nbsp;<span class="num" id="6161399">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161407">b0</span>&nbsp;<span class="op" id="6161410">=</span>&nbsp;<span class="ident" id="6161412">src</span><span class="op" id="6161415">[</span><span class="num" id="6161416">0</span><span class="op" id="6161417">]</span>&nbsp;<span class="op" id="6161419">&gt;&gt;</span>&nbsp;<span class="num" id="6161422">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6161426">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6161431">//&nbsp;Encode&nbsp;5-bit&nbsp;blocks&nbsp;using&nbsp;the&nbsp;base32&nbsp;alphabet</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161482">dst</span><span class="op" id="6161485">[</span><span class="num" id="6161486">0</span><span class="op" id="6161487">]</span>&nbsp;<span class="op" id="6161489">=</span>&nbsp;<span class="ident" id="6161491">enc</span><span class="op" id="6161494">.</span><span class="ident" id="6161495">encode</span><span class="op" id="6161501">[</span><span class="ident" id="6161502">b0</span><span class="op" id="6161504">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161508">dst</span><span class="op" id="6161511">[</span><span class="num" id="6161512">1</span><span class="op" id="6161513">]</span>&nbsp;<span class="op" id="6161515">=</span>&nbsp;<span class="ident" id="6161517">enc</span><span class="op" id="6161520">.</span><span class="ident" id="6161521">encode</span><span class="op" id="6161527">[</span><span class="ident" id="6161528">b1</span><span class="op" id="6161530">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161534">dst</span><span class="op" id="6161537">[</span><span class="num" id="6161538">2</span><span class="op" id="6161539">]</span>&nbsp;<span class="op" id="6161541">=</span>&nbsp;<span class="ident" id="6161543">enc</span><span class="op" id="6161546">.</span><span class="ident" id="6161547">encode</span><span class="op" id="6161553">[</span><span class="ident" id="6161554">b2</span><span class="op" id="6161556">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161560">dst</span><span class="op" id="6161563">[</span><span class="num" id="6161564">3</span><span class="op" id="6161565">]</span>&nbsp;<span class="op" id="6161567">=</span>&nbsp;<span class="ident" id="6161569">enc</span><span class="op" id="6161572">.</span><span class="ident" id="6161573">encode</span><span class="op" id="6161579">[</span><span class="ident" id="6161580">b3</span><span class="op" id="6161582">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161586">dst</span><span class="op" id="6161589">[</span><span class="num" id="6161590">4</span><span class="op" id="6161591">]</span>&nbsp;<span class="op" id="6161593">=</span>&nbsp;<span class="ident" id="6161595">enc</span><span class="op" id="6161598">.</span><span class="ident" id="6161599">encode</span><span class="op" id="6161605">[</span><span class="ident" id="6161606">b4</span><span class="op" id="6161608">]</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161612">dst</span><span class="op" id="6161615">[</span><span class="num" id="6161616">5</span><span class="op" id="6161617">]</span>&nbsp;<span class="op" id="6161619">=</span>&nbsp;<span class="ident" id="6161621">enc</span><span class="op" id="6161624">.</span><span class="ident" id="6161625">encode</span><span class="op" id="6161631">[</span><span class="ident" id="6161632">b5</span><span class="op" id="6161634">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161638">dst</span><span class="op" id="6161641">[</span><span class="num" id="6161642">6</span><span class="op" id="6161643">]</span>&nbsp;<span class="op" id="6161645">=</span>&nbsp;<span class="ident" id="6161647">enc</span><span class="op" id="6161650">.</span><span class="ident" id="6161651">encode</span><span class="op" id="6161657">[</span><span class="ident" id="6161658">b6</span><span class="op" id="6161660">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161664">dst</span><span class="op" id="6161667">[</span><span class="num" id="6161668">7</span><span class="op" id="6161669">]</span>&nbsp;<span class="op" id="6161671">=</span>&nbsp;<span class="ident" id="6161673">enc</span><span class="op" id="6161676">.</span><span class="ident" id="6161677">encode</span><span class="op" id="6161683">[</span><span class="ident" id="6161684">b7</span><span class="op" id="6161686">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6161691">//&nbsp;Pad&nbsp;the&nbsp;final&nbsp;quantum</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161718">if</span>&nbsp;<span class="builtinfunc" id="6161721">len</span><span class="op" id="6161724">(</span><span class="ident" id="6161725">src</span><span class="op" id="6161728">)</span>&nbsp;<span class="op" id="6161730">&lt;</span>&nbsp;<span class="num" id="6161732">5</span>&nbsp;<span class="op" id="6161734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161739">dst</span><span class="op" id="6161742">[</span><span class="num" id="6161743">7</span><span class="op" id="6161744">]</span>&nbsp;<span class="op" id="6161746">=</span>&nbsp;<span class="string" id="6161748">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161755">if</span>&nbsp;<span class="builtinfunc" id="6161758">len</span><span class="op" id="6161761">(</span><span class="ident" id="6161762">src</span><span class="op" id="6161765">)</span>&nbsp;<span class="op" id="6161767">&lt;</span>&nbsp;<span class="num" id="6161769">4</span>&nbsp;<span class="op" id="6161771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161777">dst</span><span class="op" id="6161780">[</span><span class="num" id="6161781">6</span><span class="op" id="6161782">]</span>&nbsp;<span class="op" id="6161784">=</span>&nbsp;<span class="string" id="6161786">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161794">dst</span><span class="op" id="6161797">[</span><span class="num" id="6161798">5</span><span class="op" id="6161799">]</span>&nbsp;<span class="op" id="6161801">=</span>&nbsp;<span class="string" id="6161803">&#39;=&#39;</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161811">if</span>&nbsp;<span class="builtinfunc" id="6161814">len</span><span class="op" id="6161817">(</span><span class="ident" id="6161818">src</span><span class="op" id="6161821">)</span>&nbsp;<span class="op" id="6161823">&lt;</span>&nbsp;<span class="num" id="6161825">3</span>&nbsp;<span class="op" id="6161827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161834">dst</span><span class="op" id="6161837">[</span><span class="num" id="6161838">4</span><span class="op" id="6161839">]</span>&nbsp;<span class="op" id="6161841">=</span>&nbsp;<span class="string" id="6161843">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161852">if</span>&nbsp;<span class="builtinfunc" id="6161855">len</span><span class="op" id="6161858">(</span><span class="ident" id="6161859">src</span><span class="op" id="6161862">)</span>&nbsp;<span class="op" id="6161864">&lt;</span>&nbsp;<span class="num" id="6161866">2</span>&nbsp;<span class="op" id="6161868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161876">dst</span><span class="op" id="6161879">[</span><span class="num" id="6161880">3</span><span class="op" id="6161881">]</span>&nbsp;<span class="op" id="6161883">=</span>&nbsp;<span class="string" id="6161885">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161895">dst</span><span class="op" id="6161898">[</span><span class="num" id="6161899">2</span><span class="op" id="6161900">]</span>&nbsp;<span class="op" id="6161902">=</span>&nbsp;<span class="string" id="6161904">&#39;=&#39;</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6161913">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6161919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6161924">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6161929">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6161937">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161941">src</span>&nbsp;<span class="op" id="6161945">=</span>&nbsp;<span class="ident" id="6161947">src</span><span class="op" id="6161950">[</span><span class="num" id="6161951">5</span><span class="op" id="6161952">:</span><span class="op" id="6161953">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161957">dst</span>&nbsp;<span class="op" id="6161961">=</span>&nbsp;<span class="ident" id="6161963">dst</span><span class="op" id="6161966">[</span><span class="num" id="6161967">8</span><span class="op" id="6161968">:</span><span class="op" id="6161969">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6161972">}</span><br>
<span class="lineno"></span><span class="op" id="6161974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="6161977">//&nbsp;EncodeToString&nbsp;returns&nbsp;the&nbsp;base32&nbsp;encoding&nbsp;of&nbsp;src.</span><br>
<span class="lineno"></span><span class="keyword" id="6162031">func</span>&nbsp;<span class="op" id="6162036">(</span><span class="ident" id="6162037">enc</span>&nbsp;<span class="op" id="6162041">*</span><span class="ident" id="6162042">Encoding</span><span class="op" id="6162050">)</span>&nbsp;<span class="ident" id="6162052">EncodeToString</span><span class="op" id="6162066">(</span><span class="ident" id="6162067">src</span>&nbsp;<span class="op" id="6162071">[</span><span class="op" id="6162072">]</span><span class="builtintype" id="6162073">byte</span><span class="op" id="6162077">)</span>&nbsp;<span class="builtintype" id="6162079">string</span>&nbsp;<span class="op" id="6162086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6162089">buf</span>&nbsp;<span class="op" id="6162093">:=</span>&nbsp;<span class="builtinfunc" id="6162096">make</span><span class="op" id="6162100">(</span><span class="op" id="6162101">[</span><span class="op" id="6162102">]</span><span class="builtintype" id="6162103">byte</span><span class="op" id="6162107">,</span>&nbsp;<span class="ident" id="6162109">enc</span><span class="op" id="6162112">.</span><span class="ident" id="6162113">EncodedLen</span><span class="op" id="6162123">(</span><span class="builtinfunc" id="6162124">len</span><span class="op" id="6162127">(</span><span class="ident" id="6162128">src</span><span class="op" id="6162131">)</span><span class="op" id="6162132">)</span><span class="op" id="6162133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6162136">enc</span><span class="op" id="6162139">.</span><span class="ident" id="6162140">Encode</span><span class="op" id="6162146">(</span><span class="ident" id="6162147">buf</span><span class="op" id="6162150">,</span>&nbsp;<span class="ident" id="6162152">src</span><span class="op" id="6162155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6162158">return</span>&nbsp;<span class="builtintype" id="6162165">string</span><span class="op" id="6162171">(</span><span class="ident" id="6162172">buf</span><span class="op" id="6162175">)</span><br>
<span class="lineno">140</span><span class="op" id="6162177">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6162180">type</span>&nbsp;<span class="ident" id="6162185">encoder</span>&nbsp;<span class="keyword" id="6162193">struct</span>&nbsp;<span class="op" id="6162200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6162203">err</span>&nbsp;&nbsp;<span class="builtintype" id="6162208">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6162215">enc</span>&nbsp;&nbsp;<span class="op" id="6162220">*</span><span class="ident" id="6162221">Encoding</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6162231">w</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6162236">io</span><span class="op" id="6162238">.</span><span class="ident" id="6162239">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6162247">buf</span>&nbsp;&nbsp;<span class="op" id="6162252">[</span><span class="num" id="6162253">5</span><span class="op" id="6162254">]</span><span class="builtintype" id="6162255">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6162263">//&nbsp;buffered&nbsp;data&nbsp;waiting&nbsp;to&nbsp;be&nbsp;encoded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6162303">nbuf</span>&nbsp;<span class="builtintype" id="6162308">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6162319">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;in&nbsp;buf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6162346">out</span>&nbsp;&nbsp;<span class="op" id="6162351">[</span><span class="num" id="6162352">1024</span><span class="op" id="6162356">]</span><span class="builtintype" id="6162357">byte</span>&nbsp;<span class="comment" id="6162362">//&nbsp;output&nbsp;buffer</span><br>
<span class="lineno"></span><span class="op" id="6162379">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="6162382">func</span>&nbsp;<span class="op" id="6162387">(</span><span class="ident" id="6162388">e</span>&nbsp;<span class="op" id="6162390">*</span><span class="ident" id="6162391">encoder</span><span class="op" id="6162398">)</span>&nbsp;<span class="ident" id="6162400">Write</span><span class="op" id="6162405">(</span><span class="ident" id="6162406">p</span>&nbsp;<span class="op" id="6162408">[</span><span class="op" id="6162409">]</span><span class="builtintype" id="6162410">byte</span><span class="op" id="6162414">)</span>&nbsp;<span class="op" id="6162416">(</span><span class="ident" id="6162417">n</span>&nbsp;<span class="builtintype" id="6162419">int</span><span class="op" id="6162422">,</span>&nbsp;<span class="ident" id="6162424">err</span>&nbsp;<span class="builtintype" id="6162428">error</span><span class="op" id="6162433">)</span>&nbsp;<span class="op" id="6162435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6162438">if</span>&nbsp;<span class="ident" id="6162441">e</span><span class="op" id="6162442">.</span><span class="ident" id="6162443">err</span>&nbsp;<span class="op" id="6162447">!=</span>&nbsp;<span class="ident" id="6162450">nil</span>&nbsp;<span class="op" id="6162454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6162458">return</span>&nbsp;<span class="num" id="6162465">0</span><span class="op" id="6162466">,</span>&nbsp;<span class="ident" id="6162468">e</span><span class="op" id="6162469">.</span><span class="ident" id="6162470">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6162475">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6162479">//&nbsp;Leading&nbsp;fringe.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6162499">if</span>&nbsp;<span class="ident" id="6162502">e</span><span class="op" id="6162503">.</span><span class="ident" id="6162504">nbuf</span>&nbsp;<span class="op" id="6162509">&gt;</span>&nbsp;<span class="num" id="6162511">0</span>&nbsp;<span class="op" id="6162513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6162517">var</span>&nbsp;<span class="ident" id="6162521">i</span>&nbsp;<span class="builtintype" id="6162523">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6162529">for</span>&nbsp;<span class="ident" id="6162533">i</span>&nbsp;<span class="op" id="6162535">=</span>&nbsp;<span class="num" id="6162537">0</span><span class="op" id="6162538">;</span>&nbsp;<span class="ident" id="6162540">i</span>&nbsp;<span class="op" id="6162542">&lt;</span>&nbsp;<span class="builtinfunc" id="6162544">len</span><span class="op" id="6162547">(</span><span class="ident" id="6162548">p</span><span class="op" id="6162549">)</span>&nbsp;<span class="op" id="6162551">&amp;&amp;</span>&nbsp;<span class="ident" id="6162554">e</span><span class="op" id="6162555">.</span><span class="ident" id="6162556">nbuf</span>&nbsp;<span class="op" id="6162561">&lt;</span>&nbsp;<span class="num" id="6162563">5</span><span class="op" id="6162564">;</span>&nbsp;<span class="ident" id="6162566">i</span><span class="op" id="6162567">++</span>&nbsp;<span class="op" id="6162570">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6162575">e</span><span class="op" id="6162576">.</span><span class="ident" id="6162577">buf</span><span class="op" id="6162580">[</span><span class="ident" id="6162581">e</span><span class="op" id="6162582">.</span><span class="ident" id="6162583">nbuf</span><span class="op" id="6162587">]</span>&nbsp;<span class="op" id="6162589">=</span>&nbsp;<span class="ident" id="6162591">p</span><span class="op" id="6162592">[</span><span class="ident" id="6162593">i</span><span class="op" id="6162594">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6162599">e</span><span class="op" id="6162600">.</span><span class="ident" id="6162601">nbuf</span><span class="op" id="6162605">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6162610">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6162614">n</span>&nbsp;<span class="op" id="6162616">+=</span>&nbsp;<span class="ident" id="6162619">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6162623">p</span>&nbsp;<span class="op" id="6162625">=</span>&nbsp;<span class="ident" id="6162627">p</span><span class="op" id="6162628">[</span><span class="ident" id="6162629">i</span><span class="op" id="6162630">:</span><span class="op" id="6162631">]</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6162635">if</span>&nbsp;<span class="ident" id="6162638">e</span><span class="op" id="6162639">.</span><span class="ident" id="6162640">nbuf</span>&nbsp;<span class="op" id="6162645">&lt;</span>&nbsp;<span class="num" id="6162647">5</span>&nbsp;<span class="op" id="6162649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6162654">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6162663">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6162667">e</span><span class="op" id="6162668">.</span><span class="ident" id="6162669">enc</span><span class="op" id="6162672">.</span><span class="ident" id="6162673">Encode</span><span class="op" id="6162679">(</span><span class="ident" id="6162680">e</span><span class="op" id="6162681">.</span><span class="ident" id="6162682">out</span><span class="op" id="6162685">[</span><span class="num" id="6162686">0</span><span class="op" id="6162687">:</span><span class="op" id="6162688">]</span><span class="op" id="6162689">,</span>&nbsp;<span class="ident" id="6162691">e</span><span class="op" id="6162692">.</span><span class="ident" id="6162693">buf</span><span class="op" id="6162696">[</span><span class="num" id="6162697">0</span><span class="op" id="6162698">:</span><span class="op" id="6162699">]</span><span class="op" id="6162700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6162704">if</span>&nbsp;<span class="ident" id="6162707">_</span><span class="op" id="6162708">,</span>&nbsp;<span class="ident" id="6162710">e</span><span class="op" id="6162711">.</span><span class="ident" id="6162712">err</span>&nbsp;<span class="op" id="6162716">=</span>&nbsp;<span class="ident" id="6162718">e</span><span class="op" id="6162719">.</span><span class="ident" id="6162720">w</span><span class="op" id="6162721">.</span><span class="ident" id="6162722">Write</span><span class="op" id="6162727">(</span><span class="ident" id="6162728">e</span><span class="op" id="6162729">.</span><span class="ident" id="6162730">out</span><span class="op" id="6162733">[</span><span class="num" id="6162734">0</span><span class="op" id="6162735">:</span><span class="num" id="6162736">8</span><span class="op" id="6162737">]</span><span class="op" id="6162738">)</span><span class="op" id="6162739">;</span>&nbsp;<span class="ident" id="6162741">e</span><span class="op" id="6162742">.</span><span class="ident" id="6162743">err</span>&nbsp;<span class="op" id="6162747">!=</span>&nbsp;<span class="ident" id="6162750">nil</span>&nbsp;<span class="op" id="6162754">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6162759">return</span>&nbsp;<span class="ident" id="6162766">n</span><span class="op" id="6162767">,</span>&nbsp;<span class="ident" id="6162769">e</span><span class="op" id="6162770">.</span><span class="ident" id="6162771">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6162777">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6162781">e</span><span class="op" id="6162782">.</span><span class="ident" id="6162783">nbuf</span>&nbsp;<span class="op" id="6162788">=</span>&nbsp;<span class="num" id="6162790">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6162793">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6162797">//&nbsp;Large&nbsp;interior&nbsp;chunks.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6162824">for</span>&nbsp;<span class="builtinfunc" id="6162828">len</span><span class="op" id="6162831">(</span><span class="ident" id="6162832">p</span><span class="op" id="6162833">)</span>&nbsp;<span class="op" id="6162835">&gt;=</span>&nbsp;<span class="num" id="6162838">5</span>&nbsp;<span class="op" id="6162840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6162844">nn</span>&nbsp;<span class="op" id="6162847">:=</span>&nbsp;<span class="builtinfunc" id="6162850">len</span><span class="op" id="6162853">(</span><span class="ident" id="6162854">e</span><span class="op" id="6162855">.</span><span class="ident" id="6162856">out</span><span class="op" id="6162859">)</span>&nbsp;<span class="op" id="6162861">/</span>&nbsp;<span class="num" id="6162863">8</span>&nbsp;<span class="op" id="6162865">*</span>&nbsp;<span class="num" id="6162867">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6162871">if</span>&nbsp;<span class="ident" id="6162874">nn</span>&nbsp;<span class="op" id="6162877">&gt;</span>&nbsp;<span class="builtinfunc" id="6162879">len</span><span class="op" id="6162882">(</span><span class="ident" id="6162883">p</span><span class="op" id="6162884">)</span>&nbsp;<span class="op" id="6162886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6162891">nn</span>&nbsp;<span class="op" id="6162894">=</span>&nbsp;<span class="builtinfunc" id="6162896">len</span><span class="op" id="6162899">(</span><span class="ident" id="6162900">p</span><span class="op" id="6162901">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6162906">nn</span>&nbsp;<span class="op" id="6162909">-=</span>&nbsp;<span class="ident" id="6162912">nn</span>&nbsp;<span class="op" id="6162915">%</span>&nbsp;<span class="num" id="6162917">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6162921">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6162925">e</span><span class="op" id="6162926">.</span><span class="ident" id="6162927">enc</span><span class="op" id="6162930">.</span><span class="ident" id="6162931">Encode</span><span class="op" id="6162937">(</span><span class="ident" id="6162938">e</span><span class="op" id="6162939">.</span><span class="ident" id="6162940">out</span><span class="op" id="6162943">[</span><span class="num" id="6162944">0</span><span class="op" id="6162945">:</span><span class="op" id="6162946">]</span><span class="op" id="6162947">,</span>&nbsp;<span class="ident" id="6162949">p</span><span class="op" id="6162950">[</span><span class="num" id="6162951">0</span><span class="op" id="6162952">:</span><span class="ident" id="6162953">nn</span><span class="op" id="6162955">]</span><span class="op" id="6162956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6162960">if</span>&nbsp;<span class="ident" id="6162963">_</span><span class="op" id="6162964">,</span>&nbsp;<span class="ident" id="6162966">e</span><span class="op" id="6162967">.</span><span class="ident" id="6162968">err</span>&nbsp;<span class="op" id="6162972">=</span>&nbsp;<span class="ident" id="6162974">e</span><span class="op" id="6162975">.</span><span class="ident" id="6162976">w</span><span class="op" id="6162977">.</span><span class="ident" id="6162978">Write</span><span class="op" id="6162983">(</span><span class="ident" id="6162984">e</span><span class="op" id="6162985">.</span><span class="ident" id="6162986">out</span><span class="op" id="6162989">[</span><span class="num" id="6162990">0</span>&nbsp;<span class="op" id="6162992">:</span>&nbsp;<span class="ident" id="6162994">nn</span><span class="op" id="6162996">/</span><span class="num" id="6162997">5</span><span class="op" id="6162998">*</span><span class="num" id="6162999">8</span><span class="op" id="6163000">]</span><span class="op" id="6163001">)</span><span class="op" id="6163002">;</span>&nbsp;<span class="ident" id="6163004">e</span><span class="op" id="6163005">.</span><span class="ident" id="6163006">err</span>&nbsp;<span class="op" id="6163010">!=</span>&nbsp;<span class="ident" id="6163013">nil</span>&nbsp;<span class="op" id="6163017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6163022">return</span>&nbsp;<span class="ident" id="6163029">n</span><span class="op" id="6163030">,</span>&nbsp;<span class="ident" id="6163032">e</span><span class="op" id="6163033">.</span><span class="ident" id="6163034">err</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6163040">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6163044">n</span>&nbsp;<span class="op" id="6163046">+=</span>&nbsp;<span class="ident" id="6163049">nn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6163054">p</span>&nbsp;<span class="op" id="6163056">=</span>&nbsp;<span class="ident" id="6163058">p</span><span class="op" id="6163059">[</span><span class="ident" id="6163060">nn</span><span class="op" id="6163062">:</span><span class="op" id="6163063">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6163066">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6163070">//&nbsp;Trailing&nbsp;fringe.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6163091">for</span>&nbsp;<span class="ident" id="6163095">i</span>&nbsp;<span class="op" id="6163097">:=</span>&nbsp;<span class="num" id="6163100">0</span><span class="op" id="6163101">;</span>&nbsp;<span class="ident" id="6163103">i</span>&nbsp;<span class="op" id="6163105">&lt;</span>&nbsp;<span class="builtinfunc" id="6163107">len</span><span class="op" id="6163110">(</span><span class="ident" id="6163111">p</span><span class="op" id="6163112">)</span><span class="op" id="6163113">;</span>&nbsp;<span class="ident" id="6163115">i</span><span class="op" id="6163116">++</span>&nbsp;<span class="op" id="6163119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6163123">e</span><span class="op" id="6163124">.</span><span class="ident" id="6163125">buf</span><span class="op" id="6163128">[</span><span class="ident" id="6163129">i</span><span class="op" id="6163130">]</span>&nbsp;<span class="op" id="6163132">=</span>&nbsp;<span class="ident" id="6163134">p</span><span class="op" id="6163135">[</span><span class="ident" id="6163136">i</span><span class="op" id="6163137">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6163140">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6163143">e</span><span class="op" id="6163144">.</span><span class="ident" id="6163145">nbuf</span>&nbsp;<span class="op" id="6163150">=</span>&nbsp;<span class="builtinfunc" id="6163152">len</span><span class="op" id="6163155">(</span><span class="ident" id="6163156">p</span><span class="op" id="6163157">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6163160">n</span>&nbsp;<span class="op" id="6163162">+=</span>&nbsp;<span class="builtinfunc" id="6163165">len</span><span class="op" id="6163168">(</span><span class="ident" id="6163169">p</span><span class="op" id="6163170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6163173">return</span><br>
<span class="lineno"></span><span class="op" id="6163180">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6163183">//&nbsp;Close&nbsp;flushes&nbsp;any&nbsp;pending&nbsp;output&nbsp;from&nbsp;the&nbsp;encoder.</span><br>
<span class="lineno">200</span><span class="comment" id="6163237">//&nbsp;It&nbsp;is&nbsp;an&nbsp;error&nbsp;to&nbsp;call&nbsp;Write&nbsp;after&nbsp;calling&nbsp;Close.</span><br>
<span class="lineno"></span><span class="keyword" id="6163290">func</span>&nbsp;<span class="op" id="6163295">(</span><span class="ident" id="6163296">e</span>&nbsp;<span class="op" id="6163298">*</span><span class="ident" id="6163299">encoder</span><span class="op" id="6163306">)</span>&nbsp;<span class="ident" id="6163308">Close</span><span class="op" id="6163313">(</span><span class="op" id="6163314">)</span>&nbsp;<span class="builtintype" id="6163316">error</span>&nbsp;<span class="op" id="6163322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6163325">//&nbsp;If&nbsp;there&#39;s&nbsp;anything&nbsp;left&nbsp;in&nbsp;the&nbsp;buffer,&nbsp;flush&nbsp;it&nbsp;out</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6163382">if</span>&nbsp;<span class="ident" id="6163385">e</span><span class="op" id="6163386">.</span><span class="ident" id="6163387">err</span>&nbsp;<span class="op" id="6163391">==</span>&nbsp;<span class="ident" id="6163394">nil</span>&nbsp;<span class="op" id="6163398">&amp;&amp;</span>&nbsp;<span class="ident" id="6163401">e</span><span class="op" id="6163402">.</span><span class="ident" id="6163403">nbuf</span>&nbsp;<span class="op" id="6163408">&gt;</span>&nbsp;<span class="num" id="6163410">0</span>&nbsp;<span class="op" id="6163412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6163416">e</span><span class="op" id="6163417">.</span><span class="ident" id="6163418">enc</span><span class="op" id="6163421">.</span><span class="ident" id="6163422">Encode</span><span class="op" id="6163428">(</span><span class="ident" id="6163429">e</span><span class="op" id="6163430">.</span><span class="ident" id="6163431">out</span><span class="op" id="6163434">[</span><span class="num" id="6163435">0</span><span class="op" id="6163436">:</span><span class="op" id="6163437">]</span><span class="op" id="6163438">,</span>&nbsp;<span class="ident" id="6163440">e</span><span class="op" id="6163441">.</span><span class="ident" id="6163442">buf</span><span class="op" id="6163445">[</span><span class="num" id="6163446">0</span><span class="op" id="6163447">:</span><span class="ident" id="6163448">e</span><span class="op" id="6163449">.</span><span class="ident" id="6163450">nbuf</span><span class="op" id="6163454">]</span><span class="op" id="6163455">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6163459">e</span><span class="op" id="6163460">.</span><span class="ident" id="6163461">nbuf</span>&nbsp;<span class="op" id="6163466">=</span>&nbsp;<span class="num" id="6163468">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6163472">_</span><span class="op" id="6163473">,</span>&nbsp;<span class="ident" id="6163475">e</span><span class="op" id="6163476">.</span><span class="ident" id="6163477">err</span>&nbsp;<span class="op" id="6163481">=</span>&nbsp;<span class="ident" id="6163483">e</span><span class="op" id="6163484">.</span><span class="ident" id="6163485">w</span><span class="op" id="6163486">.</span><span class="ident" id="6163487">Write</span><span class="op" id="6163492">(</span><span class="ident" id="6163493">e</span><span class="op" id="6163494">.</span><span class="ident" id="6163495">out</span><span class="op" id="6163498">[</span><span class="num" id="6163499">0</span><span class="op" id="6163500">:</span><span class="num" id="6163501">8</span><span class="op" id="6163502">]</span><span class="op" id="6163503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6163506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6163509">return</span>&nbsp;<span class="ident" id="6163516">e</span><span class="op" id="6163517">.</span><span class="ident" id="6163518">err</span><br>
<span class="lineno"></span><span class="op" id="6163522">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="comment" id="6163525">//&nbsp;NewEncoder&nbsp;returns&nbsp;a&nbsp;new&nbsp;base32&nbsp;stream&nbsp;encoder.&nbsp;&nbsp;Data&nbsp;written&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="6163593">//&nbsp;the&nbsp;returned&nbsp;writer&nbsp;will&nbsp;be&nbsp;encoded&nbsp;using&nbsp;enc&nbsp;and&nbsp;then&nbsp;written&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="comment" id="6163665">//&nbsp;Base32&nbsp;encodings&nbsp;operate&nbsp;in&nbsp;5-byte&nbsp;blocks;&nbsp;when&nbsp;finished</span><br>
<span class="lineno"></span><span class="comment" id="6163725">//&nbsp;writing,&nbsp;the&nbsp;caller&nbsp;must&nbsp;Close&nbsp;the&nbsp;returned&nbsp;encoder&nbsp;to&nbsp;flush&nbsp;any</span><br>
<span class="lineno">215</span><span class="comment" id="6163793">//&nbsp;partially&nbsp;written&nbsp;blocks.</span><br>
<span class="lineno"></span><span class="keyword" id="6163822">func</span>&nbsp;<span class="ident" id="6163827">NewEncoder</span><span class="op" id="6163837">(</span><span class="ident" id="6163838">enc</span>&nbsp;<span class="op" id="6163842">*</span><span class="ident" id="6163843">Encoding</span><span class="op" id="6163851">,</span>&nbsp;<span class="ident" id="6163853">w</span>&nbsp;<span class="ident" id="6163855">io</span><span class="op" id="6163857">.</span><span class="ident" id="6163858">Writer</span><span class="op" id="6163864">)</span>&nbsp;<span class="ident" id="6163866">io</span><span class="op" id="6163868">.</span><span class="ident" id="6163869">WriteCloser</span>&nbsp;<span class="op" id="6163881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6163884">return</span>&nbsp;<span class="op" id="6163891">&amp;</span><span class="ident" id="6163892">encoder</span><span class="op" id="6163899">{</span><span class="ident" id="6163900">enc</span><span class="op" id="6163903">:</span>&nbsp;<span class="ident" id="6163905">enc</span><span class="op" id="6163908">,</span>&nbsp;<span class="ident" id="6163910">w</span><span class="op" id="6163911">:</span>&nbsp;<span class="ident" id="6163913">w</span><span class="op" id="6163914">}</span><br>
<span class="lineno"></span><span class="op" id="6163916">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="6163919">//&nbsp;EncodedLen&nbsp;returns&nbsp;the&nbsp;length&nbsp;in&nbsp;bytes&nbsp;of&nbsp;the&nbsp;base32&nbsp;encoding</span><br>
<span class="lineno"></span><span class="comment" id="6163984">//&nbsp;of&nbsp;an&nbsp;input&nbsp;buffer&nbsp;of&nbsp;length&nbsp;n.</span><br>
<span class="lineno"></span><span class="keyword" id="6164019">func</span>&nbsp;<span class="op" id="6164024">(</span><span class="ident" id="6164025">enc</span>&nbsp;<span class="op" id="6164029">*</span><span class="ident" id="6164030">Encoding</span><span class="op" id="6164038">)</span>&nbsp;<span class="ident" id="6164040">EncodedLen</span><span class="op" id="6164050">(</span><span class="ident" id="6164051">n</span>&nbsp;<span class="builtintype" id="6164053">int</span><span class="op" id="6164056">)</span>&nbsp;<span class="builtintype" id="6164058">int</span>&nbsp;<span class="op" id="6164062">{</span>&nbsp;<span class="keyword" id="6164064">return</span>&nbsp;<span class="op" id="6164071">(</span><span class="ident" id="6164072">n</span>&nbsp;<span class="op" id="6164074">+</span>&nbsp;<span class="num" id="6164076">4</span><span class="op" id="6164077">)</span>&nbsp;<span class="op" id="6164079">/</span>&nbsp;<span class="num" id="6164081">5</span>&nbsp;<span class="op" id="6164083">*</span>&nbsp;<span class="num" id="6164085">8</span>&nbsp;<span class="op" id="6164087">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6164090">/*<br>
<span class="lineno">225</span>&nbsp;*&nbsp;Decoder<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6164109">type</span>&nbsp;<span class="ident" id="6164114">CorruptInputError</span>&nbsp;<span class="ident" id="6164132">int64</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span><span class="keyword" id="6164139">func</span>&nbsp;<span class="op" id="6164144">(</span><span class="ident" id="6164145">e</span>&nbsp;<span class="ident" id="6164147">CorruptInputError</span><span class="op" id="6164164">)</span>&nbsp;<span class="ident" id="6164166">Error</span><span class="op" id="6164171">(</span><span class="op" id="6164172">)</span>&nbsp;<span class="builtintype" id="6164174">string</span>&nbsp;<span class="op" id="6164181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6164184">return</span>&nbsp;<span class="string" id="6164191">&#34;illegal&nbsp;base32&nbsp;data&nbsp;at&nbsp;input&nbsp;byte&nbsp;&#34;</span>&nbsp;<span class="op" id="6164228">+</span>&nbsp;<span class="ident" id="6164230">strconv</span><span class="op" id="6164237">.</span><span class="ident" id="6164238">FormatInt</span><span class="op" id="6164247">(</span><span class="ident" id="6164248">int64</span><span class="op" id="6164253">(</span><span class="ident" id="6164254">e</span><span class="op" id="6164255">)</span><span class="op" id="6164256">,</span>&nbsp;<span class="num" id="6164258">10</span><span class="op" id="6164260">)</span><br>
<span class="lineno"></span><span class="op" id="6164262">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6164265">//&nbsp;decode&nbsp;is&nbsp;like&nbsp;Decode&nbsp;but&nbsp;returns&nbsp;an&nbsp;additional&nbsp;&#39;end&#39;&nbsp;value,&nbsp;which</span><br>
<span class="lineno">235</span><span class="comment" id="6164335">//&nbsp;indicates&nbsp;if&nbsp;end-of-message&nbsp;padding&nbsp;was&nbsp;encountered&nbsp;and&nbsp;thus&nbsp;any</span><br>
<span class="lineno"></span><span class="comment" id="6164403">//&nbsp;additional&nbsp;data&nbsp;is&nbsp;an&nbsp;error.&nbsp;This&nbsp;method&nbsp;assumes&nbsp;that&nbsp;src&nbsp;has&nbsp;been</span><br>
<span class="lineno"></span><span class="comment" id="6164473">//&nbsp;stripped&nbsp;of&nbsp;all&nbsp;supported&nbsp;whitespace&nbsp;(&#39;\r&#39;&nbsp;and&nbsp;&#39;\n&#39;).</span><br>
<span class="lineno"></span><span class="keyword" id="6164530">func</span>&nbsp;<span class="op" id="6164535">(</span><span class="ident" id="6164536">enc</span>&nbsp;<span class="op" id="6164540">*</span><span class="ident" id="6164541">Encoding</span><span class="op" id="6164549">)</span>&nbsp;<span class="ident" id="6164551">decode</span><span class="op" id="6164557">(</span><span class="ident" id="6164558">dst</span><span class="op" id="6164561">,</span>&nbsp;<span class="ident" id="6164563">src</span>&nbsp;<span class="op" id="6164567">[</span><span class="op" id="6164568">]</span><span class="builtintype" id="6164569">byte</span><span class="op" id="6164573">)</span>&nbsp;<span class="op" id="6164575">(</span><span class="ident" id="6164576">n</span>&nbsp;<span class="builtintype" id="6164578">int</span><span class="op" id="6164581">,</span>&nbsp;<span class="ident" id="6164583">end</span>&nbsp;<span class="builtintype" id="6164587">bool</span><span class="op" id="6164591">,</span>&nbsp;<span class="ident" id="6164593">err</span>&nbsp;<span class="builtintype" id="6164597">error</span><span class="op" id="6164602">)</span>&nbsp;<span class="op" id="6164604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6164607">olen</span>&nbsp;<span class="op" id="6164612">:=</span>&nbsp;<span class="builtinfunc" id="6164615">len</span><span class="op" id="6164618">(</span><span class="ident" id="6164619">src</span><span class="op" id="6164622">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6164625">for</span>&nbsp;<span class="builtinfunc" id="6164629">len</span><span class="op" id="6164632">(</span><span class="ident" id="6164633">src</span><span class="op" id="6164636">)</span>&nbsp;<span class="op" id="6164638">&gt;</span>&nbsp;<span class="num" id="6164640">0</span>&nbsp;<span class="op" id="6164642">&amp;&amp;</span>&nbsp;<span class="op" id="6164645">!</span><span class="ident" id="6164646">end</span>&nbsp;<span class="op" id="6164650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6164654">//&nbsp;Decode&nbsp;quantum&nbsp;using&nbsp;the&nbsp;base32&nbsp;alphabet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6164700">var</span>&nbsp;<span class="ident" id="6164704">dbuf</span>&nbsp;<span class="op" id="6164709">[</span><span class="num" id="6164710">8</span><span class="op" id="6164711">]</span><span class="builtintype" id="6164712">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6164719">dlen</span>&nbsp;<span class="op" id="6164724">:=</span>&nbsp;<span class="num" id="6164727">8</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6164732">for</span>&nbsp;<span class="ident" id="6164736">j</span>&nbsp;<span class="op" id="6164738">:=</span>&nbsp;<span class="num" id="6164741">0</span><span class="op" id="6164742">;</span>&nbsp;<span class="ident" id="6164744">j</span>&nbsp;<span class="op" id="6164746">&lt;</span>&nbsp;<span class="num" id="6164748">8</span><span class="op" id="6164749">;</span>&nbsp;<span class="op" id="6164751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6164756">if</span>&nbsp;<span class="builtinfunc" id="6164759">len</span><span class="op" id="6164762">(</span><span class="ident" id="6164763">src</span><span class="op" id="6164766">)</span>&nbsp;<span class="op" id="6164768">==</span>&nbsp;<span class="num" id="6164771">0</span>&nbsp;<span class="op" id="6164773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6164779">return</span>&nbsp;<span class="ident" id="6164786">n</span><span class="op" id="6164787">,</span>&nbsp;<span class="builtintype" id="6164789">false</span><span class="op" id="6164794">,</span>&nbsp;<span class="ident" id="6164796">CorruptInputError</span><span class="op" id="6164813">(</span><span class="ident" id="6164814">olen</span>&nbsp;<span class="op" id="6164819">-</span>&nbsp;<span class="builtinfunc" id="6164821">len</span><span class="op" id="6164824">(</span><span class="ident" id="6164825">src</span><span class="op" id="6164828">)</span>&nbsp;<span class="op" id="6164830">-</span>&nbsp;<span class="ident" id="6164832">j</span><span class="op" id="6164833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6164838">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6164843">in</span>&nbsp;<span class="op" id="6164846">:=</span>&nbsp;<span class="ident" id="6164849">src</span><span class="op" id="6164852">[</span><span class="num" id="6164853">0</span><span class="op" id="6164854">]</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6164859">src</span>&nbsp;<span class="op" id="6164863">=</span>&nbsp;<span class="ident" id="6164865">src</span><span class="op" id="6164868">[</span><span class="num" id="6164869">1</span><span class="op" id="6164870">:</span><span class="op" id="6164871">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6164876">if</span>&nbsp;<span class="ident" id="6164879">in</span>&nbsp;<span class="op" id="6164882">==</span>&nbsp;<span class="string" id="6164885">&#39;=&#39;</span>&nbsp;<span class="op" id="6164889">&amp;&amp;</span>&nbsp;<span class="ident" id="6164892">j</span>&nbsp;<span class="op" id="6164894">&gt;=</span>&nbsp;<span class="num" id="6164897">2</span>&nbsp;<span class="op" id="6164899">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="6164902">len</span><span class="op" id="6164905">(</span><span class="ident" id="6164906">src</span><span class="op" id="6164909">)</span>&nbsp;<span class="op" id="6164911">&lt;</span>&nbsp;<span class="num" id="6164913">8</span>&nbsp;<span class="op" id="6164915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6164921">//&nbsp;We&#39;ve&nbsp;reached&nbsp;the&nbsp;end&nbsp;and&nbsp;there&#39;s&nbsp;padding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6164970">if</span>&nbsp;<span class="builtinfunc" id="6164973">len</span><span class="op" id="6164976">(</span><span class="ident" id="6164977">src</span><span class="op" id="6164980">)</span><span class="op" id="6164981">+</span><span class="ident" id="6164982">j</span>&nbsp;<span class="op" id="6164984">&lt;</span>&nbsp;<span class="num" id="6164986">8</span><span class="op" id="6164987">-</span><span class="num" id="6164988">1</span>&nbsp;<span class="op" id="6164990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6164997">//&nbsp;not&nbsp;enough&nbsp;padding</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6165024">return</span>&nbsp;<span class="ident" id="6165031">n</span><span class="op" id="6165032">,</span>&nbsp;<span class="builtintype" id="6165034">false</span><span class="op" id="6165039">,</span>&nbsp;<span class="ident" id="6165041">CorruptInputError</span><span class="op" id="6165058">(</span><span class="ident" id="6165059">olen</span><span class="op" id="6165063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6165069">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6165075">for</span>&nbsp;<span class="ident" id="6165079">k</span>&nbsp;<span class="op" id="6165081">:=</span>&nbsp;<span class="num" id="6165084">0</span><span class="op" id="6165085">;</span>&nbsp;<span class="ident" id="6165087">k</span>&nbsp;<span class="op" id="6165089">&lt;</span>&nbsp;<span class="num" id="6165091">8</span><span class="op" id="6165092">-</span><span class="num" id="6165093">1</span><span class="op" id="6165094">-</span><span class="ident" id="6165095">j</span><span class="op" id="6165096">;</span>&nbsp;<span class="ident" id="6165098">k</span><span class="op" id="6165099">++</span>&nbsp;<span class="op" id="6165102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6165109">if</span>&nbsp;<span class="builtinfunc" id="6165112">len</span><span class="op" id="6165115">(</span><span class="ident" id="6165116">src</span><span class="op" id="6165119">)</span>&nbsp;<span class="op" id="6165121">&gt;</span>&nbsp;<span class="ident" id="6165123">k</span>&nbsp;<span class="op" id="6165125">&amp;&amp;</span>&nbsp;<span class="ident" id="6165128">src</span><span class="op" id="6165131">[</span><span class="ident" id="6165132">k</span><span class="op" id="6165133">]</span>&nbsp;<span class="op" id="6165135">!=</span>&nbsp;<span class="string" id="6165138">&#39;=&#39;</span>&nbsp;<span class="op" id="6165142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6165150">//&nbsp;incorrect&nbsp;padding</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6165177">return</span>&nbsp;<span class="ident" id="6165184">n</span><span class="op" id="6165185">,</span>&nbsp;<span class="builtintype" id="6165187">false</span><span class="op" id="6165192">,</span>&nbsp;<span class="ident" id="6165194">CorruptInputError</span><span class="op" id="6165211">(</span><span class="ident" id="6165212">olen</span>&nbsp;<span class="op" id="6165217">-</span>&nbsp;<span class="builtinfunc" id="6165219">len</span><span class="op" id="6165222">(</span><span class="ident" id="6165223">src</span><span class="op" id="6165226">)</span>&nbsp;<span class="op" id="6165228">+</span>&nbsp;<span class="ident" id="6165230">k</span>&nbsp;<span class="op" id="6165232">-</span>&nbsp;<span class="num" id="6165234">1</span><span class="op" id="6165235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6165242">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6165248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6165254">dlen</span><span class="op" id="6165258">,</span>&nbsp;<span class="ident" id="6165260">end</span>&nbsp;<span class="op" id="6165264">=</span>&nbsp;<span class="ident" id="6165266">j</span><span class="op" id="6165267">,</span>&nbsp;<span class="builtintype" id="6165269">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6165278">//&nbsp;7,&nbsp;5&nbsp;and&nbsp;2&nbsp;are&nbsp;not&nbsp;valid&nbsp;padding&nbsp;lengths,&nbsp;and&nbsp;so&nbsp;1,&nbsp;3&nbsp;and&nbsp;6&nbsp;are&nbsp;not</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6165353">//&nbsp;valid&nbsp;dlen&nbsp;values.&nbsp;See&nbsp;RFC&nbsp;4648&nbsp;Section&nbsp;6&nbsp;&#34;Base&nbsp;32&nbsp;Encoding&#34;&nbsp;listing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6165429">//&nbsp;the&nbsp;five&nbsp;valid&nbsp;padding&nbsp;lengths,&nbsp;and&nbsp;Section&nbsp;9&nbsp;&#34;Illustrations&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6165501">//&nbsp;Examples&#34;&nbsp;for&nbsp;an&nbsp;illustration&nbsp;for&nbsp;how&nbsp;the&nbsp;1st,&nbsp;3rd&nbsp;and&nbsp;6th&nbsp;base32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6165574">//&nbsp;src&nbsp;bytes&nbsp;do&nbsp;not&nbsp;yield&nbsp;enough&nbsp;information&nbsp;to&nbsp;decode&nbsp;a&nbsp;dst&nbsp;byte.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6165645">if</span>&nbsp;<span class="ident" id="6165648">dlen</span>&nbsp;<span class="op" id="6165653">==</span>&nbsp;<span class="num" id="6165656">1</span>&nbsp;<span class="op" id="6165658">||</span>&nbsp;<span class="ident" id="6165661">dlen</span>&nbsp;<span class="op" id="6165666">==</span>&nbsp;<span class="num" id="6165669">3</span>&nbsp;<span class="op" id="6165671">||</span>&nbsp;<span class="ident" id="6165674">dlen</span>&nbsp;<span class="op" id="6165679">==</span>&nbsp;<span class="num" id="6165682">6</span>&nbsp;<span class="op" id="6165684">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6165691">return</span>&nbsp;<span class="ident" id="6165698">n</span><span class="op" id="6165699">,</span>&nbsp;<span class="builtintype" id="6165701">false</span><span class="op" id="6165706">,</span>&nbsp;<span class="ident" id="6165708">CorruptInputError</span><span class="op" id="6165725">(</span><span class="ident" id="6165726">olen</span>&nbsp;<span class="op" id="6165731">-</span>&nbsp;<span class="builtinfunc" id="6165733">len</span><span class="op" id="6165736">(</span><span class="ident" id="6165737">src</span><span class="op" id="6165740">)</span>&nbsp;<span class="op" id="6165742">-</span>&nbsp;<span class="num" id="6165744">1</span><span class="op" id="6165745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6165751">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6165757">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6165766">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6165771">dbuf</span><span class="op" id="6165775">[</span><span class="ident" id="6165776">j</span><span class="op" id="6165777">]</span>&nbsp;<span class="op" id="6165779">=</span>&nbsp;<span class="ident" id="6165781">enc</span><span class="op" id="6165784">.</span><span class="ident" id="6165785">decodeMap</span><span class="op" id="6165794">[</span><span class="ident" id="6165795">in</span><span class="op" id="6165797">]</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6165802">if</span>&nbsp;<span class="ident" id="6165805">dbuf</span><span class="op" id="6165809">[</span><span class="ident" id="6165810">j</span><span class="op" id="6165811">]</span>&nbsp;<span class="op" id="6165813">==</span>&nbsp;<span class="num" id="6165816">0xFF</span>&nbsp;<span class="op" id="6165821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6165827">return</span>&nbsp;<span class="ident" id="6165834">n</span><span class="op" id="6165835">,</span>&nbsp;<span class="builtintype" id="6165837">false</span><span class="op" id="6165842">,</span>&nbsp;<span class="ident" id="6165844">CorruptInputError</span><span class="op" id="6165861">(</span><span class="ident" id="6165862">olen</span>&nbsp;<span class="op" id="6165867">-</span>&nbsp;<span class="builtinfunc" id="6165869">len</span><span class="op" id="6165872">(</span><span class="ident" id="6165873">src</span><span class="op" id="6165876">)</span>&nbsp;<span class="op" id="6165878">-</span>&nbsp;<span class="num" id="6165880">1</span><span class="op" id="6165881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6165886">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6165891">j</span><span class="op" id="6165892">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6165897">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6165902">//&nbsp;Pack&nbsp;8x&nbsp;5-bit&nbsp;source&nbsp;blocks&nbsp;into&nbsp;5&nbsp;byte&nbsp;destination</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6165959">//&nbsp;quantum</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6165972">switch</span>&nbsp;<span class="ident" id="6165979">dlen</span>&nbsp;<span class="op" id="6165984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6165988">case</span>&nbsp;<span class="num" id="6165993">8</span><span class="op" id="6165994">:</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6165999">dst</span><span class="op" id="6166002">[</span><span class="num" id="6166003">4</span><span class="op" id="6166004">]</span>&nbsp;<span class="op" id="6166006">=</span>&nbsp;<span class="ident" id="6166008">dbuf</span><span class="op" id="6166012">[</span><span class="num" id="6166013">6</span><span class="op" id="6166014">]</span><span class="op" id="6166015">&lt;&lt;</span><span class="num" id="6166017">5</span>&nbsp;<span class="op" id="6166019">|</span>&nbsp;<span class="ident" id="6166021">dbuf</span><span class="op" id="6166025">[</span><span class="num" id="6166026">7</span><span class="op" id="6166027">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6166032">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6166046">case</span>&nbsp;<span class="num" id="6166051">7</span><span class="op" id="6166052">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6166057">dst</span><span class="op" id="6166060">[</span><span class="num" id="6166061">3</span><span class="op" id="6166062">]</span>&nbsp;<span class="op" id="6166064">=</span>&nbsp;<span class="ident" id="6166066">dbuf</span><span class="op" id="6166070">[</span><span class="num" id="6166071">4</span><span class="op" id="6166072">]</span><span class="op" id="6166073">&lt;&lt;</span><span class="num" id="6166075">7</span>&nbsp;<span class="op" id="6166077">|</span>&nbsp;<span class="ident" id="6166079">dbuf</span><span class="op" id="6166083">[</span><span class="num" id="6166084">5</span><span class="op" id="6166085">]</span><span class="op" id="6166086">&lt;&lt;</span><span class="num" id="6166088">2</span>&nbsp;<span class="op" id="6166090">|</span>&nbsp;<span class="ident" id="6166092">dbuf</span><span class="op" id="6166096">[</span><span class="num" id="6166097">6</span><span class="op" id="6166098">]</span><span class="op" id="6166099">&gt;&gt;</span><span class="num" id="6166101">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6166106">fallthrough</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6166120">case</span>&nbsp;<span class="num" id="6166125">5</span><span class="op" id="6166126">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6166131">dst</span><span class="op" id="6166134">[</span><span class="num" id="6166135">2</span><span class="op" id="6166136">]</span>&nbsp;<span class="op" id="6166138">=</span>&nbsp;<span class="ident" id="6166140">dbuf</span><span class="op" id="6166144">[</span><span class="num" id="6166145">3</span><span class="op" id="6166146">]</span><span class="op" id="6166147">&lt;&lt;</span><span class="num" id="6166149">4</span>&nbsp;<span class="op" id="6166151">|</span>&nbsp;<span class="ident" id="6166153">dbuf</span><span class="op" id="6166157">[</span><span class="num" id="6166158">4</span><span class="op" id="6166159">]</span><span class="op" id="6166160">&gt;&gt;</span><span class="num" id="6166162">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6166167">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6166181">case</span>&nbsp;<span class="num" id="6166186">4</span><span class="op" id="6166187">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6166192">dst</span><span class="op" id="6166195">[</span><span class="num" id="6166196">1</span><span class="op" id="6166197">]</span>&nbsp;<span class="op" id="6166199">=</span>&nbsp;<span class="ident" id="6166201">dbuf</span><span class="op" id="6166205">[</span><span class="num" id="6166206">1</span><span class="op" id="6166207">]</span><span class="op" id="6166208">&lt;&lt;</span><span class="num" id="6166210">6</span>&nbsp;<span class="op" id="6166212">|</span>&nbsp;<span class="ident" id="6166214">dbuf</span><span class="op" id="6166218">[</span><span class="num" id="6166219">2</span><span class="op" id="6166220">]</span><span class="op" id="6166221">&lt;&lt;</span><span class="num" id="6166223">1</span>&nbsp;<span class="op" id="6166225">|</span>&nbsp;<span class="ident" id="6166227">dbuf</span><span class="op" id="6166231">[</span><span class="num" id="6166232">3</span><span class="op" id="6166233">]</span><span class="op" id="6166234">&gt;&gt;</span><span class="num" id="6166236">4</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6166241">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6166255">case</span>&nbsp;<span class="num" id="6166260">2</span><span class="op" id="6166261">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6166266">dst</span><span class="op" id="6166269">[</span><span class="num" id="6166270">0</span><span class="op" id="6166271">]</span>&nbsp;<span class="op" id="6166273">=</span>&nbsp;<span class="ident" id="6166275">dbuf</span><span class="op" id="6166279">[</span><span class="num" id="6166280">0</span><span class="op" id="6166281">]</span><span class="op" id="6166282">&lt;&lt;</span><span class="num" id="6166284">3</span>&nbsp;<span class="op" id="6166286">|</span>&nbsp;<span class="ident" id="6166288">dbuf</span><span class="op" id="6166292">[</span><span class="num" id="6166293">1</span><span class="op" id="6166294">]</span><span class="op" id="6166295">&gt;&gt;</span><span class="num" id="6166297">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6166301">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6166305">dst</span>&nbsp;<span class="op" id="6166309">=</span>&nbsp;<span class="ident" id="6166311">dst</span><span class="op" id="6166314">[</span><span class="num" id="6166315">5</span><span class="op" id="6166316">:</span><span class="op" id="6166317">]</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6166321">switch</span>&nbsp;<span class="ident" id="6166328">dlen</span>&nbsp;<span class="op" id="6166333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6166337">case</span>&nbsp;<span class="num" id="6166342">2</span><span class="op" id="6166343">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6166348">n</span>&nbsp;<span class="op" id="6166350">+=</span>&nbsp;<span class="num" id="6166353">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6166357">case</span>&nbsp;<span class="num" id="6166362">4</span><span class="op" id="6166363">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6166368">n</span>&nbsp;<span class="op" id="6166370">+=</span>&nbsp;<span class="num" id="6166373">2</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6166377">case</span>&nbsp;<span class="num" id="6166382">5</span><span class="op" id="6166383">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6166388">n</span>&nbsp;<span class="op" id="6166390">+=</span>&nbsp;<span class="num" id="6166393">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6166397">case</span>&nbsp;<span class="num" id="6166402">7</span><span class="op" id="6166403">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6166408">n</span>&nbsp;<span class="op" id="6166410">+=</span>&nbsp;<span class="num" id="6166413">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6166417">case</span>&nbsp;<span class="num" id="6166422">8</span><span class="op" id="6166423">:</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6166428">n</span>&nbsp;<span class="op" id="6166430">+=</span>&nbsp;<span class="num" id="6166433">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6166437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6166440">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6166443">return</span>&nbsp;<span class="ident" id="6166450">n</span><span class="op" id="6166451">,</span>&nbsp;<span class="ident" id="6166453">end</span><span class="op" id="6166456">,</span>&nbsp;<span class="ident" id="6166458">nil</span><br>
<span class="lineno"></span><span class="op" id="6166462">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="comment" id="6166465">//&nbsp;Decode&nbsp;decodes&nbsp;src&nbsp;using&nbsp;the&nbsp;encoding&nbsp;enc.&nbsp;&nbsp;It&nbsp;writes&nbsp;at&nbsp;most</span><br>
<span class="lineno"></span><span class="comment" id="6166530">//&nbsp;DecodedLen(len(src))&nbsp;bytes&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno"></span><span class="comment" id="6166599">//&nbsp;written.&nbsp;&nbsp;If&nbsp;src&nbsp;contains&nbsp;invalid&nbsp;base32&nbsp;data,&nbsp;it&nbsp;will&nbsp;return&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6166668">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;successfully&nbsp;written&nbsp;and&nbsp;CorruptInputError.</span><br>
<span class="lineno">320</span><span class="comment" id="6166731">//&nbsp;New&nbsp;line&nbsp;characters&nbsp;(\r&nbsp;and&nbsp;\n)&nbsp;are&nbsp;ignored.</span><br>
<span class="lineno"></span><span class="keyword" id="6166779">func</span>&nbsp;<span class="op" id="6166784">(</span><span class="ident" id="6166785">enc</span>&nbsp;<span class="op" id="6166789">*</span><span class="ident" id="6166790">Encoding</span><span class="op" id="6166798">)</span>&nbsp;<span class="ident" id="6166800">Decode</span><span class="op" id="6166806">(</span><span class="ident" id="6166807">dst</span><span class="op" id="6166810">,</span>&nbsp;<span class="ident" id="6166812">src</span>&nbsp;<span class="op" id="6166816">[</span><span class="op" id="6166817">]</span><span class="builtintype" id="6166818">byte</span><span class="op" id="6166822">)</span>&nbsp;<span class="op" id="6166824">(</span><span class="ident" id="6166825">n</span>&nbsp;<span class="builtintype" id="6166827">int</span><span class="op" id="6166830">,</span>&nbsp;<span class="ident" id="6166832">err</span>&nbsp;<span class="builtintype" id="6166836">error</span><span class="op" id="6166841">)</span>&nbsp;<span class="op" id="6166843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6166846">src</span>&nbsp;<span class="op" id="6166850">=</span>&nbsp;<span class="ident" id="6166852">bytes</span><span class="op" id="6166857">.</span><span class="ident" id="6166858">Map</span><span class="op" id="6166861">(</span><span class="ident" id="6166862">removeNewlinesMapper</span><span class="op" id="6166882">,</span>&nbsp;<span class="ident" id="6166884">src</span><span class="op" id="6166887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6166890">n</span><span class="op" id="6166891">,</span>&nbsp;<span class="ident" id="6166893">_</span><span class="op" id="6166894">,</span>&nbsp;<span class="ident" id="6166896">err</span>&nbsp;<span class="op" id="6166900">=</span>&nbsp;<span class="ident" id="6166902">enc</span><span class="op" id="6166905">.</span><span class="ident" id="6166906">decode</span><span class="op" id="6166912">(</span><span class="ident" id="6166913">dst</span><span class="op" id="6166916">,</span>&nbsp;<span class="ident" id="6166918">src</span><span class="op" id="6166921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6166924">return</span><br>
<span class="lineno">325</span><span class="op" id="6166931">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6166934">//&nbsp;DecodeString&nbsp;returns&nbsp;the&nbsp;bytes&nbsp;represented&nbsp;by&nbsp;the&nbsp;base32&nbsp;string&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="6167004">func</span>&nbsp;<span class="op" id="6167009">(</span><span class="ident" id="6167010">enc</span>&nbsp;<span class="op" id="6167014">*</span><span class="ident" id="6167015">Encoding</span><span class="op" id="6167023">)</span>&nbsp;<span class="ident" id="6167025">DecodeString</span><span class="op" id="6167037">(</span><span class="ident" id="6167038">s</span>&nbsp;<span class="builtintype" id="6167040">string</span><span class="op" id="6167046">)</span>&nbsp;<span class="op" id="6167048">(</span><span class="op" id="6167049">[</span><span class="op" id="6167050">]</span><span class="builtintype" id="6167051">byte</span><span class="op" id="6167055">,</span>&nbsp;<span class="builtintype" id="6167057">error</span><span class="op" id="6167062">)</span>&nbsp;<span class="op" id="6167064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6167067">s</span>&nbsp;<span class="op" id="6167069">=</span>&nbsp;<span class="ident" id="6167071">strings</span><span class="op" id="6167078">.</span><span class="ident" id="6167079">Map</span><span class="op" id="6167082">(</span><span class="ident" id="6167083">removeNewlinesMapper</span><span class="op" id="6167103">,</span>&nbsp;<span class="ident" id="6167105">s</span><span class="op" id="6167106">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6167109">dbuf</span>&nbsp;<span class="op" id="6167114">:=</span>&nbsp;<span class="builtinfunc" id="6167117">make</span><span class="op" id="6167121">(</span><span class="op" id="6167122">[</span><span class="op" id="6167123">]</span><span class="builtintype" id="6167124">byte</span><span class="op" id="6167128">,</span>&nbsp;<span class="ident" id="6167130">enc</span><span class="op" id="6167133">.</span><span class="ident" id="6167134">DecodedLen</span><span class="op" id="6167144">(</span><span class="builtinfunc" id="6167145">len</span><span class="op" id="6167148">(</span><span class="ident" id="6167149">s</span><span class="op" id="6167150">)</span><span class="op" id="6167151">)</span><span class="op" id="6167152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6167155">n</span><span class="op" id="6167156">,</span>&nbsp;<span class="ident" id="6167158">_</span><span class="op" id="6167159">,</span>&nbsp;<span class="ident" id="6167161">err</span>&nbsp;<span class="op" id="6167165">:=</span>&nbsp;<span class="ident" id="6167168">enc</span><span class="op" id="6167171">.</span><span class="ident" id="6167172">decode</span><span class="op" id="6167178">(</span><span class="ident" id="6167179">dbuf</span><span class="op" id="6167183">,</span>&nbsp;<span class="op" id="6167185">[</span><span class="op" id="6167186">]</span><span class="builtintype" id="6167187">byte</span><span class="op" id="6167191">(</span><span class="ident" id="6167192">s</span><span class="op" id="6167193">)</span><span class="op" id="6167194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6167197">return</span>&nbsp;<span class="ident" id="6167204">dbuf</span><span class="op" id="6167208">[</span><span class="op" id="6167209">:</span><span class="ident" id="6167210">n</span><span class="op" id="6167211">]</span><span class="op" id="6167212">,</span>&nbsp;<span class="ident" id="6167214">err</span><br>
<span class="lineno"></span><span class="op" id="6167218">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="keyword" id="6167221">type</span>&nbsp;<span class="ident" id="6167226">decoder</span>&nbsp;<span class="keyword" id="6167234">struct</span>&nbsp;<span class="op" id="6167241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6167244">err</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6167251">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6167258">enc</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6167265">*</span><span class="ident" id="6167266">Encoding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6167276">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6167283">io</span><span class="op" id="6167285">.</span><span class="ident" id="6167286">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6167294">end</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6167301">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6167312">//&nbsp;saw&nbsp;end&nbsp;of&nbsp;message</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6167335">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6167342">[</span><span class="num" id="6167343">1024</span><span class="op" id="6167347">]</span><span class="builtintype" id="6167348">byte</span>&nbsp;<span class="comment" id="6167353">//&nbsp;leftover&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6167372">nbuf</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6167379">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6167384">out</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6167391">[</span><span class="op" id="6167392">]</span><span class="builtintype" id="6167393">byte</span>&nbsp;<span class="comment" id="6167398">//&nbsp;leftover&nbsp;decoded&nbsp;output</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6167426">outbuf</span>&nbsp;<span class="op" id="6167433">[</span><span class="num" id="6167434">1024</span>&nbsp;<span class="op" id="6167439">/</span>&nbsp;<span class="num" id="6167441">8</span>&nbsp;<span class="op" id="6167443">*</span>&nbsp;<span class="num" id="6167445">5</span><span class="op" id="6167446">]</span><span class="builtintype" id="6167447">byte</span><br>
<span class="lineno"></span><span class="op" id="6167452">}</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span><span class="keyword" id="6167455">func</span>&nbsp;<span class="op" id="6167460">(</span><span class="ident" id="6167461">d</span>&nbsp;<span class="op" id="6167463">*</span><span class="ident" id="6167464">decoder</span><span class="op" id="6167471">)</span>&nbsp;<span class="ident" id="6167473">Read</span><span class="op" id="6167477">(</span><span class="ident" id="6167478">p</span>&nbsp;<span class="op" id="6167480">[</span><span class="op" id="6167481">]</span><span class="builtintype" id="6167482">byte</span><span class="op" id="6167486">)</span>&nbsp;<span class="op" id="6167488">(</span><span class="ident" id="6167489">n</span>&nbsp;<span class="builtintype" id="6167491">int</span><span class="op" id="6167494">,</span>&nbsp;<span class="ident" id="6167496">err</span>&nbsp;<span class="builtintype" id="6167500">error</span><span class="op" id="6167505">)</span>&nbsp;<span class="op" id="6167507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6167510">if</span>&nbsp;<span class="ident" id="6167513">d</span><span class="op" id="6167514">.</span><span class="ident" id="6167515">err</span>&nbsp;<span class="op" id="6167519">!=</span>&nbsp;<span class="ident" id="6167522">nil</span>&nbsp;<span class="op" id="6167526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6167530">return</span>&nbsp;<span class="num" id="6167537">0</span><span class="op" id="6167538">,</span>&nbsp;<span class="ident" id="6167540">d</span><span class="op" id="6167541">.</span><span class="ident" id="6167542">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6167547">}</span><br>
<span class="lineno">350</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6167551">//&nbsp;Use&nbsp;leftover&nbsp;decoded&nbsp;output&nbsp;from&nbsp;last&nbsp;read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6167599">if</span>&nbsp;<span class="builtinfunc" id="6167602">len</span><span class="op" id="6167605">(</span><span class="ident" id="6167606">d</span><span class="op" id="6167607">.</span><span class="ident" id="6167608">out</span><span class="op" id="6167611">)</span>&nbsp;<span class="op" id="6167613">&gt;</span>&nbsp;<span class="num" id="6167615">0</span>&nbsp;<span class="op" id="6167617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6167621">n</span>&nbsp;<span class="op" id="6167623">=</span>&nbsp;<span class="builtinfunc" id="6167625">copy</span><span class="op" id="6167629">(</span><span class="ident" id="6167630">p</span><span class="op" id="6167631">,</span>&nbsp;<span class="ident" id="6167633">d</span><span class="op" id="6167634">.</span><span class="ident" id="6167635">out</span><span class="op" id="6167638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6167642">d</span><span class="op" id="6167643">.</span><span class="ident" id="6167644">out</span>&nbsp;<span class="op" id="6167648">=</span>&nbsp;<span class="ident" id="6167650">d</span><span class="op" id="6167651">.</span><span class="ident" id="6167652">out</span><span class="op" id="6167655">[</span><span class="ident" id="6167656">n</span><span class="op" id="6167657">:</span><span class="op" id="6167658">]</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6167662">return</span>&nbsp;<span class="ident" id="6167669">n</span><span class="op" id="6167670">,</span>&nbsp;<span class="ident" id="6167672">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6167677">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6167681">//&nbsp;Read&nbsp;a&nbsp;chunk.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6167699">nn</span>&nbsp;<span class="op" id="6167702">:=</span>&nbsp;<span class="builtinfunc" id="6167705">len</span><span class="op" id="6167708">(</span><span class="ident" id="6167709">p</span><span class="op" id="6167710">)</span>&nbsp;<span class="op" id="6167712">/</span>&nbsp;<span class="num" id="6167714">5</span>&nbsp;<span class="op" id="6167716">*</span>&nbsp;<span class="num" id="6167718">8</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6167721">if</span>&nbsp;<span class="ident" id="6167724">nn</span>&nbsp;<span class="op" id="6167727">&lt;</span>&nbsp;<span class="num" id="6167729">8</span>&nbsp;<span class="op" id="6167731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6167735">nn</span>&nbsp;<span class="op" id="6167738">=</span>&nbsp;<span class="num" id="6167740">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6167743">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6167746">if</span>&nbsp;<span class="ident" id="6167749">nn</span>&nbsp;<span class="op" id="6167752">&gt;</span>&nbsp;<span class="builtinfunc" id="6167754">len</span><span class="op" id="6167757">(</span><span class="ident" id="6167758">d</span><span class="op" id="6167759">.</span><span class="ident" id="6167760">buf</span><span class="op" id="6167763">)</span>&nbsp;<span class="op" id="6167765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6167769">nn</span>&nbsp;<span class="op" id="6167772">=</span>&nbsp;<span class="builtinfunc" id="6167774">len</span><span class="op" id="6167777">(</span><span class="ident" id="6167778">d</span><span class="op" id="6167779">.</span><span class="ident" id="6167780">buf</span><span class="op" id="6167783">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6167786">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6167789">nn</span><span class="op" id="6167791">,</span>&nbsp;<span class="ident" id="6167793">d</span><span class="op" id="6167794">.</span><span class="ident" id="6167795">err</span>&nbsp;<span class="op" id="6167799">=</span>&nbsp;<span class="ident" id="6167801">io</span><span class="op" id="6167803">.</span><span class="ident" id="6167804">ReadAtLeast</span><span class="op" id="6167815">(</span><span class="ident" id="6167816">d</span><span class="op" id="6167817">.</span><span class="ident" id="6167818">r</span><span class="op" id="6167819">,</span>&nbsp;<span class="ident" id="6167821">d</span><span class="op" id="6167822">.</span><span class="ident" id="6167823">buf</span><span class="op" id="6167826">[</span><span class="ident" id="6167827">d</span><span class="op" id="6167828">.</span><span class="ident" id="6167829">nbuf</span><span class="op" id="6167833">:</span><span class="ident" id="6167834">nn</span><span class="op" id="6167836">]</span><span class="op" id="6167837">,</span>&nbsp;<span class="num" id="6167839">8</span><span class="op" id="6167840">-</span><span class="ident" id="6167841">d</span><span class="op" id="6167842">.</span><span class="ident" id="6167843">nbuf</span><span class="op" id="6167847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6167850">d</span><span class="op" id="6167851">.</span><span class="ident" id="6167852">nbuf</span>&nbsp;<span class="op" id="6167857">+=</span>&nbsp;<span class="ident" id="6167860">nn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6167864">if</span>&nbsp;<span class="ident" id="6167867">d</span><span class="op" id="6167868">.</span><span class="ident" id="6167869">nbuf</span>&nbsp;<span class="op" id="6167874">&lt;</span>&nbsp;<span class="num" id="6167876">8</span>&nbsp;<span class="op" id="6167878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6167882">return</span>&nbsp;<span class="num" id="6167889">0</span><span class="op" id="6167890">,</span>&nbsp;<span class="ident" id="6167892">d</span><span class="op" id="6167893">.</span><span class="ident" id="6167894">err</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6167899">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6167903">//&nbsp;Decode&nbsp;chunk&nbsp;into&nbsp;p,&nbsp;or&nbsp;d.out&nbsp;and&nbsp;then&nbsp;p&nbsp;if&nbsp;p&nbsp;is&nbsp;too&nbsp;small.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6167967">nr</span>&nbsp;<span class="op" id="6167970">:=</span>&nbsp;<span class="ident" id="6167973">d</span><span class="op" id="6167974">.</span><span class="ident" id="6167975">nbuf</span>&nbsp;<span class="op" id="6167980">/</span>&nbsp;<span class="num" id="6167982">8</span>&nbsp;<span class="op" id="6167984">*</span>&nbsp;<span class="num" id="6167986">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6167989">nw</span>&nbsp;<span class="op" id="6167992">:=</span>&nbsp;<span class="ident" id="6167995">d</span><span class="op" id="6167996">.</span><span class="ident" id="6167997">nbuf</span>&nbsp;<span class="op" id="6168002">/</span>&nbsp;<span class="num" id="6168004">8</span>&nbsp;<span class="op" id="6168006">*</span>&nbsp;<span class="num" id="6168008">5</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6168011">if</span>&nbsp;<span class="ident" id="6168014">nw</span>&nbsp;<span class="op" id="6168017">&gt;</span>&nbsp;<span class="builtinfunc" id="6168019">len</span><span class="op" id="6168022">(</span><span class="ident" id="6168023">p</span><span class="op" id="6168024">)</span>&nbsp;<span class="op" id="6168026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6168030">nw</span><span class="op" id="6168032">,</span>&nbsp;<span class="ident" id="6168034">d</span><span class="op" id="6168035">.</span><span class="ident" id="6168036">end</span><span class="op" id="6168039">,</span>&nbsp;<span class="ident" id="6168041">d</span><span class="op" id="6168042">.</span><span class="ident" id="6168043">err</span>&nbsp;<span class="op" id="6168047">=</span>&nbsp;<span class="ident" id="6168049">d</span><span class="op" id="6168050">.</span><span class="ident" id="6168051">enc</span><span class="op" id="6168054">.</span><span class="ident" id="6168055">decode</span><span class="op" id="6168061">(</span><span class="ident" id="6168062">d</span><span class="op" id="6168063">.</span><span class="ident" id="6168064">outbuf</span><span class="op" id="6168070">[</span><span class="num" id="6168071">0</span><span class="op" id="6168072">:</span><span class="op" id="6168073">]</span><span class="op" id="6168074">,</span>&nbsp;<span class="ident" id="6168076">d</span><span class="op" id="6168077">.</span><span class="ident" id="6168078">buf</span><span class="op" id="6168081">[</span><span class="num" id="6168082">0</span><span class="op" id="6168083">:</span><span class="ident" id="6168084">nr</span><span class="op" id="6168086">]</span><span class="op" id="6168087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6168091">d</span><span class="op" id="6168092">.</span><span class="ident" id="6168093">out</span>&nbsp;<span class="op" id="6168097">=</span>&nbsp;<span class="ident" id="6168099">d</span><span class="op" id="6168100">.</span><span class="ident" id="6168101">outbuf</span><span class="op" id="6168107">[</span><span class="num" id="6168108">0</span><span class="op" id="6168109">:</span><span class="ident" id="6168110">nw</span><span class="op" id="6168112">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6168116">n</span>&nbsp;<span class="op" id="6168118">=</span>&nbsp;<span class="builtinfunc" id="6168120">copy</span><span class="op" id="6168124">(</span><span class="ident" id="6168125">p</span><span class="op" id="6168126">,</span>&nbsp;<span class="ident" id="6168128">d</span><span class="op" id="6168129">.</span><span class="ident" id="6168130">out</span><span class="op" id="6168133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6168137">d</span><span class="op" id="6168138">.</span><span class="ident" id="6168139">out</span>&nbsp;<span class="op" id="6168143">=</span>&nbsp;<span class="ident" id="6168145">d</span><span class="op" id="6168146">.</span><span class="ident" id="6168147">out</span><span class="op" id="6168150">[</span><span class="ident" id="6168151">n</span><span class="op" id="6168152">:</span><span class="op" id="6168153">]</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6168156">}</span>&nbsp;<span class="keyword" id="6168158">else</span>&nbsp;<span class="op" id="6168163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6168167">n</span><span class="op" id="6168168">,</span>&nbsp;<span class="ident" id="6168170">d</span><span class="op" id="6168171">.</span><span class="ident" id="6168172">end</span><span class="op" id="6168175">,</span>&nbsp;<span class="ident" id="6168177">d</span><span class="op" id="6168178">.</span><span class="ident" id="6168179">err</span>&nbsp;<span class="op" id="6168183">=</span>&nbsp;<span class="ident" id="6168185">d</span><span class="op" id="6168186">.</span><span class="ident" id="6168187">enc</span><span class="op" id="6168190">.</span><span class="ident" id="6168191">decode</span><span class="op" id="6168197">(</span><span class="ident" id="6168198">p</span><span class="op" id="6168199">,</span>&nbsp;<span class="ident" id="6168201">d</span><span class="op" id="6168202">.</span><span class="ident" id="6168203">buf</span><span class="op" id="6168206">[</span><span class="num" id="6168207">0</span><span class="op" id="6168208">:</span><span class="ident" id="6168209">nr</span><span class="op" id="6168211">]</span><span class="op" id="6168212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6168215">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6168218">d</span><span class="op" id="6168219">.</span><span class="ident" id="6168220">nbuf</span>&nbsp;<span class="op" id="6168225">-=</span>&nbsp;<span class="ident" id="6168228">nr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6168232">for</span>&nbsp;<span class="ident" id="6168236">i</span>&nbsp;<span class="op" id="6168238">:=</span>&nbsp;<span class="num" id="6168241">0</span><span class="op" id="6168242">;</span>&nbsp;<span class="ident" id="6168244">i</span>&nbsp;<span class="op" id="6168246">&lt;</span>&nbsp;<span class="ident" id="6168248">d</span><span class="op" id="6168249">.</span><span class="ident" id="6168250">nbuf</span><span class="op" id="6168254">;</span>&nbsp;<span class="ident" id="6168256">i</span><span class="op" id="6168257">++</span>&nbsp;<span class="op" id="6168260">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6168264">d</span><span class="op" id="6168265">.</span><span class="ident" id="6168266">buf</span><span class="op" id="6168269">[</span><span class="ident" id="6168270">i</span><span class="op" id="6168271">]</span>&nbsp;<span class="op" id="6168273">=</span>&nbsp;<span class="ident" id="6168275">d</span><span class="op" id="6168276">.</span><span class="ident" id="6168277">buf</span><span class="op" id="6168280">[</span><span class="ident" id="6168281">i</span><span class="op" id="6168282">+</span><span class="ident" id="6168283">nr</span><span class="op" id="6168285">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6168288">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6168292">if</span>&nbsp;<span class="ident" id="6168295">d</span><span class="op" id="6168296">.</span><span class="ident" id="6168297">err</span>&nbsp;<span class="op" id="6168301">==</span>&nbsp;<span class="ident" id="6168304">nil</span>&nbsp;<span class="op" id="6168308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6168312">d</span><span class="op" id="6168313">.</span><span class="ident" id="6168314">err</span>&nbsp;<span class="op" id="6168318">=</span>&nbsp;<span class="ident" id="6168320">err</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6168325">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6168328">return</span>&nbsp;<span class="ident" id="6168335">n</span><span class="op" id="6168336">,</span>&nbsp;<span class="ident" id="6168338">d</span><span class="op" id="6168339">.</span><span class="ident" id="6168340">err</span><br>
<span class="lineno"></span><span class="op" id="6168344">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6168347">type</span>&nbsp;<span class="ident" id="6168352">newlineFilteringReader</span>&nbsp;<span class="keyword" id="6168375">struct</span>&nbsp;<span class="op" id="6168382">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6168385">wrapped</span>&nbsp;<span class="ident" id="6168393">io</span><span class="op" id="6168395">.</span><span class="ident" id="6168396">Reader</span><br>
<span class="lineno"></span><span class="op" id="6168403">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6168406">func</span>&nbsp;<span class="op" id="6168411">(</span><span class="ident" id="6168412">r</span>&nbsp;<span class="op" id="6168414">*</span><span class="ident" id="6168415">newlineFilteringReader</span><span class="op" id="6168437">)</span>&nbsp;<span class="ident" id="6168439">Read</span><span class="op" id="6168443">(</span><span class="ident" id="6168444">p</span>&nbsp;<span class="op" id="6168446">[</span><span class="op" id="6168447">]</span><span class="builtintype" id="6168448">byte</span><span class="op" id="6168452">)</span>&nbsp;<span class="op" id="6168454">(</span><span class="builtintype" id="6168455">int</span><span class="op" id="6168458">,</span>&nbsp;<span class="builtintype" id="6168460">error</span><span class="op" id="6168465">)</span>&nbsp;<span class="op" id="6168467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6168470">n</span><span class="op" id="6168471">,</span>&nbsp;<span class="ident" id="6168473">err</span>&nbsp;<span class="op" id="6168477">:=</span>&nbsp;<span class="ident" id="6168480">r</span><span class="op" id="6168481">.</span><span class="ident" id="6168482">wrapped</span><span class="op" id="6168489">.</span><span class="ident" id="6168490">Read</span><span class="op" id="6168494">(</span><span class="ident" id="6168495">p</span><span class="op" id="6168496">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6168499">for</span>&nbsp;<span class="ident" id="6168503">n</span>&nbsp;<span class="op" id="6168505">&gt;</span>&nbsp;<span class="num" id="6168507">0</span>&nbsp;<span class="op" id="6168509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6168513">offset</span>&nbsp;<span class="op" id="6168520">:=</span>&nbsp;<span class="num" id="6168523">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6168527">for</span>&nbsp;<span class="ident" id="6168531">i</span><span class="op" id="6168532">,</span>&nbsp;<span class="ident" id="6168534">b</span>&nbsp;<span class="op" id="6168536">:=</span>&nbsp;<span class="keyword" id="6168539">range</span>&nbsp;<span class="ident" id="6168545">p</span><span class="op" id="6168546">[</span><span class="num" id="6168547">0</span><span class="op" id="6168548">:</span><span class="ident" id="6168549">n</span><span class="op" id="6168550">]</span>&nbsp;<span class="op" id="6168552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6168557">if</span>&nbsp;<span class="ident" id="6168560">b</span>&nbsp;<span class="op" id="6168562">!=</span>&nbsp;<span class="string" id="6168565">&#39;\r&#39;</span>&nbsp;<span class="op" id="6168570">&amp;&amp;</span>&nbsp;<span class="ident" id="6168573">b</span>&nbsp;<span class="op" id="6168575">!=</span>&nbsp;<span class="string" id="6168578">&#39;\n&#39;</span>&nbsp;<span class="op" id="6168583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6168589">if</span>&nbsp;<span class="ident" id="6168592">i</span>&nbsp;<span class="op" id="6168594">!=</span>&nbsp;<span class="ident" id="6168597">offset</span>&nbsp;<span class="op" id="6168604">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6168611">p</span><span class="op" id="6168612">[</span><span class="ident" id="6168613">offset</span><span class="op" id="6168619">]</span>&nbsp;<span class="op" id="6168621">=</span>&nbsp;<span class="ident" id="6168623">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6168629">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6168635">offset</span><span class="op" id="6168641">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6168647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6168651">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6168655">if</span>&nbsp;<span class="ident" id="6168658">offset</span>&nbsp;<span class="op" id="6168665">&gt;</span>&nbsp;<span class="num" id="6168667">0</span>&nbsp;<span class="op" id="6168669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6168674">return</span>&nbsp;<span class="ident" id="6168681">offset</span><span class="op" id="6168687">,</span>&nbsp;<span class="ident" id="6168689">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6168695">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6168699">//&nbsp;Previous&nbsp;buffer&nbsp;entirely&nbsp;whitespace,&nbsp;read&nbsp;again</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6168752">n</span><span class="op" id="6168753">,</span>&nbsp;<span class="ident" id="6168755">err</span>&nbsp;<span class="op" id="6168759">=</span>&nbsp;<span class="ident" id="6168761">r</span><span class="op" id="6168762">.</span><span class="ident" id="6168763">wrapped</span><span class="op" id="6168770">.</span><span class="ident" id="6168771">Read</span><span class="op" id="6168775">(</span><span class="ident" id="6168776">p</span><span class="op" id="6168777">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6168780">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6168783">return</span>&nbsp;<span class="ident" id="6168790">n</span><span class="op" id="6168791">,</span>&nbsp;<span class="ident" id="6168793">err</span><br>
<span class="lineno"></span><span class="op" id="6168797">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6168800">//&nbsp;NewDecoder&nbsp;constructs&nbsp;a&nbsp;new&nbsp;base32&nbsp;stream&nbsp;decoder.</span><br>
<span class="lineno">420</span><span class="keyword" id="6168854">func</span>&nbsp;<span class="ident" id="6168859">NewDecoder</span><span class="op" id="6168869">(</span><span class="ident" id="6168870">enc</span>&nbsp;<span class="op" id="6168874">*</span><span class="ident" id="6168875">Encoding</span><span class="op" id="6168883">,</span>&nbsp;<span class="ident" id="6168885">r</span>&nbsp;<span class="ident" id="6168887">io</span><span class="op" id="6168889">.</span><span class="ident" id="6168890">Reader</span><span class="op" id="6168896">)</span>&nbsp;<span class="ident" id="6168898">io</span><span class="op" id="6168900">.</span><span class="ident" id="6168901">Reader</span>&nbsp;<span class="op" id="6168908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6168911">return</span>&nbsp;<span class="op" id="6168918">&amp;</span><span class="ident" id="6168919">decoder</span><span class="op" id="6168926">{</span><span class="ident" id="6168927">enc</span><span class="op" id="6168930">:</span>&nbsp;<span class="ident" id="6168932">enc</span><span class="op" id="6168935">,</span>&nbsp;<span class="ident" id="6168937">r</span><span class="op" id="6168938">:</span>&nbsp;<span class="op" id="6168940">&amp;</span><span class="ident" id="6168941">newlineFilteringReader</span><span class="op" id="6168963">{</span><span class="ident" id="6168964">r</span><span class="op" id="6168965">}</span><span class="op" id="6168966">}</span><br>
<span class="lineno"></span><span class="op" id="6168968">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6168971">//&nbsp;DecodedLen&nbsp;returns&nbsp;the&nbsp;maximum&nbsp;length&nbsp;in&nbsp;bytes&nbsp;of&nbsp;the&nbsp;decoded&nbsp;data</span><br>
<span class="lineno">425</span><span class="comment" id="6169041">//&nbsp;corresponding&nbsp;to&nbsp;n&nbsp;bytes&nbsp;of&nbsp;base32-encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="6169093">func</span>&nbsp;<span class="op" id="6169098">(</span><span class="ident" id="6169099">enc</span>&nbsp;<span class="op" id="6169103">*</span><span class="ident" id="6169104">Encoding</span><span class="op" id="6169112">)</span>&nbsp;<span class="ident" id="6169114">DecodedLen</span><span class="op" id="6169124">(</span><span class="ident" id="6169125">n</span>&nbsp;<span class="builtintype" id="6169127">int</span><span class="op" id="6169130">)</span>&nbsp;<span class="builtintype" id="6169132">int</span>&nbsp;<span class="op" id="6169136">{</span>&nbsp;<span class="keyword" id="6169138">return</span>&nbsp;<span class="ident" id="6169145">n</span>&nbsp;<span class="op" id="6169147">/</span>&nbsp;<span class="num" id="6169149">8</span>&nbsp;<span class="op" id="6169151">*</span>&nbsp;<span class="num" id="6169153">5</span>&nbsp;<span class="op" id="6169155">}</span>
</div>
</body>
</html>
