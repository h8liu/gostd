<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/smtp</h2>
<ul>
<li><a href="/gostd/net/smtp/auth.go.html" class="current">auth.go</a></li>
<li><a href="/gostd/net/smtp/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/smtp/smtp.go.html">smtp.go</a></li>
<li><a href="/gostd/net/smtp/smtp_test.go.html">smtp_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5786982">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5787037">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5787091">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5787142">package</span>&nbsp;<span class="ident" id="5787150">smtp</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5787156">import</span>&nbsp;<span class="op" id="5787163">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5787166">&#34;crypto/hmac&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5787181">&#34;crypto/md5&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5787195">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5787205">&#34;fmt&#34;</span><br>
<span class="lineno"></span><span class="op" id="5787211">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5787214">//&nbsp;Auth&nbsp;is&nbsp;implemented&nbsp;by&nbsp;an&nbsp;SMTP&nbsp;authentication&nbsp;mechanism.</span><br>
<span class="lineno">15</span><span class="keyword" id="5787274">type</span>&nbsp;<span class="ident" id="5787279">Auth</span>&nbsp;<span class="keyword" id="5787284">interface</span>&nbsp;<span class="op" id="5787294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5787297">//&nbsp;Start&nbsp;begins&nbsp;an&nbsp;authentication&nbsp;with&nbsp;a&nbsp;server.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5787347">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;authentication&nbsp;protocol</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5787402">//&nbsp;and&nbsp;optionally&nbsp;data&nbsp;to&nbsp;include&nbsp;in&nbsp;the&nbsp;initial&nbsp;AUTH&nbsp;message</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5787465">//&nbsp;sent&nbsp;to&nbsp;the&nbsp;server.&nbsp;It&nbsp;can&nbsp;return&nbsp;proto&nbsp;==&nbsp;&#34;&#34;&nbsp;to&nbsp;indicate</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5787527">//&nbsp;that&nbsp;the&nbsp;authentication&nbsp;should&nbsp;be&nbsp;skipped.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5787574">//&nbsp;If&nbsp;it&nbsp;returns&nbsp;a&nbsp;non-nil&nbsp;error,&nbsp;the&nbsp;SMTP&nbsp;client&nbsp;aborts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5787632">//&nbsp;the&nbsp;authentication&nbsp;attempt&nbsp;and&nbsp;closes&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5787690">Start</span><span class="op" id="5787695">(</span><span class="ident" id="5787696">server</span>&nbsp;<span class="op" id="5787703">*</span><span class="ident" id="5787704"><a href="/gostd/net/smtp/auth.go.html#5788236">ServerInfo</a></span><span class="op" id="5787714">)</span>&nbsp;<span class="op" id="5787716">(</span><span class="ident" id="5787717">proto</span>&nbsp;<span class="builtintype" id="5787723">string</span><span class="op" id="5787729">,</span>&nbsp;<span class="ident" id="5787731">toServer</span>&nbsp;<span class="op" id="5787740">[</span><span class="op" id="5787741">]</span><span class="builtintype" id="5787742">byte</span><span class="op" id="5787746">,</span>&nbsp;<span class="ident" id="5787748">err</span>&nbsp;<span class="builtintype" id="5787752">error</span><span class="op" id="5787757">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5787761">//&nbsp;Next&nbsp;continues&nbsp;the&nbsp;authentication.&nbsp;The&nbsp;server&nbsp;has&nbsp;just&nbsp;sent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5787825">//&nbsp;the&nbsp;fromServer&nbsp;data.&nbsp;If&nbsp;more&nbsp;is&nbsp;true,&nbsp;the&nbsp;server&nbsp;expects&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5787888">//&nbsp;response,&nbsp;which&nbsp;Next&nbsp;should&nbsp;return&nbsp;as&nbsp;toServer;&nbsp;otherwise</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5787950">//&nbsp;Next&nbsp;should&nbsp;return&nbsp;toServer&nbsp;==&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5787990">//&nbsp;If&nbsp;Next&nbsp;returns&nbsp;a&nbsp;non-nil&nbsp;error,&nbsp;the&nbsp;SMTP&nbsp;client&nbsp;aborts</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5788050">//&nbsp;the&nbsp;authentication&nbsp;attempt&nbsp;and&nbsp;closes&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5788108">Next</span><span class="op" id="5788112">(</span><span class="ident" id="5788113">fromServer</span>&nbsp;<span class="op" id="5788124">[</span><span class="op" id="5788125">]</span><span class="builtintype" id="5788126">byte</span><span class="op" id="5788130">,</span>&nbsp;<span class="ident" id="5788132">more</span>&nbsp;<span class="builtintype" id="5788137">bool</span><span class="op" id="5788141">)</span>&nbsp;<span class="op" id="5788143">(</span><span class="ident" id="5788144">toServer</span>&nbsp;<span class="op" id="5788153">[</span><span class="op" id="5788154">]</span><span class="builtintype" id="5788155">byte</span><span class="op" id="5788159">,</span>&nbsp;<span class="ident" id="5788161">err</span>&nbsp;<span class="builtintype" id="5788165">error</span><span class="op" id="5788170">)</span><br>
<span class="lineno"></span><span class="op" id="5788172">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5788175">//&nbsp;ServerInfo&nbsp;records&nbsp;information&nbsp;about&nbsp;an&nbsp;SMTP&nbsp;server.</span><br>
<span class="lineno">35</span><span class="keyword" id="5788231">type</span>&nbsp;<span class="ident" id="5788236">ServerInfo</span>&nbsp;<span class="keyword" id="5788247">struct</span>&nbsp;<span class="op" id="5788254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5788257">Name</span>&nbsp;<span class="builtintype" id="5788262">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5788271">//&nbsp;SMTP&nbsp;server&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5788292">TLS</span>&nbsp;&nbsp;<span class="builtintype" id="5788297">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5788306">//&nbsp;using&nbsp;TLS,&nbsp;with&nbsp;valid&nbsp;certificate&nbsp;for&nbsp;Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5788353">Auth</span>&nbsp;<span class="op" id="5788358">[</span><span class="op" id="5788359">]</span><span class="builtintype" id="5788360">string</span>&nbsp;<span class="comment" id="5788367">//&nbsp;advertised&nbsp;authentication&nbsp;mechanisms</span><br>
<span class="lineno"></span><span class="op" id="5788407">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="5788410">type</span>&nbsp;<span class="ident" id="5788415">plainAuth</span>&nbsp;<span class="keyword" id="5788425">struct</span>&nbsp;<span class="op" id="5788432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5788435">identity</span><span class="op" id="5788443">,</span>&nbsp;<span class="ident" id="5788445">username</span><span class="op" id="5788453">,</span>&nbsp;<span class="ident" id="5788455">password</span>&nbsp;<span class="builtintype" id="5788464">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5788472">host</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5788501">string</span><br>
<span class="lineno"></span><span class="op" id="5788508">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="comment" id="5788511">//&nbsp;PlainAuth&nbsp;returns&nbsp;an&nbsp;Auth&nbsp;that&nbsp;implements&nbsp;the&nbsp;PLAIN&nbsp;authentication</span><br>
<span class="lineno"></span><span class="comment" id="5788581">//&nbsp;mechanism&nbsp;as&nbsp;defined&nbsp;in&nbsp;RFC&nbsp;4616.</span><br>
<span class="lineno"></span><span class="comment" id="5788618">//&nbsp;The&nbsp;returned&nbsp;Auth&nbsp;uses&nbsp;the&nbsp;given&nbsp;username&nbsp;and&nbsp;password&nbsp;to&nbsp;authenticate</span><br>
<span class="lineno"></span><span class="comment" id="5788692">//&nbsp;on&nbsp;TLS&nbsp;connections&nbsp;to&nbsp;host&nbsp;and&nbsp;act&nbsp;as&nbsp;identity.&nbsp;Usually&nbsp;identity&nbsp;will&nbsp;be</span><br>
<span class="lineno">50</span><span class="comment" id="5788768">//&nbsp;left&nbsp;blank&nbsp;to&nbsp;act&nbsp;as&nbsp;username.</span><br>
<span class="lineno"></span><span class="keyword" id="5788802">func</span>&nbsp;<span class="ident" id="5788807">PlainAuth</span><span class="op" id="5788816">(</span><span class="ident" id="5788817">identity</span><span class="op" id="5788825">,</span>&nbsp;<span class="ident" id="5788827">username</span><span class="op" id="5788835">,</span>&nbsp;<span class="ident" id="5788837">password</span><span class="op" id="5788845">,</span>&nbsp;<span class="ident" id="5788847">host</span>&nbsp;<span class="builtintype" id="5788852">string</span><span class="op" id="5788858">)</span>&nbsp;<span class="ident" id="5788860"><a href="/gostd/net/smtp/auth.go.html#5787279">Auth</a></span>&nbsp;<span class="op" id="5788865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5788868">return</span>&nbsp;<span class="op" id="5788875">&amp;</span><span class="ident" id="5788876"><a href="/gostd/net/smtp/auth.go.html#5788415">plainAuth</a></span><span class="op" id="5788885">{</span><span class="ident" id="5788886"><a href="/gostd/net/smtp/auth.go.html#5788817">identity</a></span><span class="op" id="5788894">,</span>&nbsp;<span class="ident" id="5788896"><a href="/gostd/net/smtp/auth.go.html#5788827">username</a></span><span class="op" id="5788904">,</span>&nbsp;<span class="ident" id="5788906"><a href="/gostd/net/smtp/auth.go.html#5788837">password</a></span><span class="op" id="5788914">,</span>&nbsp;<span class="ident" id="5788916"><a href="/gostd/net/smtp/auth.go.html#5788847">host</a></span><span class="op" id="5788920">}</span><br>
<span class="lineno"></span><span class="op" id="5788922">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="5788925">func</span>&nbsp;<span class="op" id="5788930">(</span><span class="ident" id="5788931">a</span>&nbsp;<span class="op" id="5788933">*</span><span class="ident" id="5788934"><a href="/gostd/net/smtp/auth.go.html#5788415">plainAuth</a></span><span class="op" id="5788943">)</span>&nbsp;<span class="ident" id="5788945">Start</span><span class="op" id="5788950">(</span><span class="ident" id="5788951">server</span>&nbsp;<span class="op" id="5788958">*</span><span class="ident" id="5788959"><a href="/gostd/net/smtp/auth.go.html#5788236">ServerInfo</a></span><span class="op" id="5788969">)</span>&nbsp;<span class="op" id="5788971">(</span><span class="builtintype" id="5788972">string</span><span class="op" id="5788978">,</span>&nbsp;<span class="op" id="5788980">[</span><span class="op" id="5788981">]</span><span class="builtintype" id="5788982">byte</span><span class="op" id="5788986">,</span>&nbsp;<span class="builtintype" id="5788988">error</span><span class="op" id="5788993">)</span>&nbsp;<span class="op" id="5788995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5788998">if</span>&nbsp;<span class="op" id="5789001">!</span><span class="ident" id="5789002"><a href="/gostd/net/smtp/auth.go.html#5788951">server</a></span><span class="op" id="5789008">.</span><span class="ident" id="5789009"><a href="/gostd/net/smtp/auth.go.html#5788292">TLS</a></span>&nbsp;<span class="op" id="5789013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5789017">advertised</span>&nbsp;<span class="op" id="5789028">:=</span>&nbsp;<span class="builtintype" id="5789031">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5789039">for</span>&nbsp;<span class="ident" id="5789043">_</span><span class="op" id="5789044">,</span>&nbsp;<span class="ident" id="5789046">mechanism</span>&nbsp;<span class="op" id="5789056">:=</span>&nbsp;<span class="keyword" id="5789059">range</span>&nbsp;<span class="ident" id="5789065"><a href="/gostd/net/smtp/auth.go.html#5788951">server</a></span><span class="op" id="5789071">.</span><span class="ident" id="5789072"><a href="/gostd/net/smtp/auth.go.html#5788353">Auth</a></span>&nbsp;<span class="op" id="5789077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5789082">if</span>&nbsp;<span class="ident" id="5789085"><a href="/gostd/net/smtp/auth.go.html#5789046">mechanism</a></span>&nbsp;<span class="op" id="5789095">==</span>&nbsp;<span class="string" id="5789098">&#34;PLAIN&#34;</span>&nbsp;<span class="op" id="5789106">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5789112"><a href="/gostd/net/smtp/auth.go.html#5789017">advertised</a></span>&nbsp;<span class="op" id="5789123">=</span>&nbsp;<span class="builtintype" id="5789125">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5789134">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5789143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5789147">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5789151">if</span>&nbsp;<span class="op" id="5789154">!</span><span class="ident" id="5789155"><a href="/gostd/net/smtp/auth.go.html#5789017">advertised</a></span>&nbsp;<span class="op" id="5789166">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5789171">return</span>&nbsp;<span class="string" id="5789178">&#34;&#34;</span><span class="op" id="5789180">,</span>&nbsp;<span class="builtintype" id="5789182">nil</span><span class="op" id="5789185">,</span>&nbsp;<span class="ident" id="5789187"><a href="/gostd/net/smtp/auth.go.html#5787195">errors</a></span><span class="op" id="5789193">.</span><span class="ident" id="5789194"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="5789197">(</span><span class="string" id="5789198">&#34;unencrypted&nbsp;connection&#34;</span><span class="op" id="5789222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5789226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5789229">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5789232">if</span>&nbsp;<span class="ident" id="5789235"><a href="/gostd/net/smtp/auth.go.html#5788951">server</a></span><span class="op" id="5789241">.</span><span class="ident" id="5789242"><a href="/gostd/net/smtp/auth.go.html#5788257">Name</a></span>&nbsp;<span class="op" id="5789247">!=</span>&nbsp;<span class="ident" id="5789250"><a href="/gostd/net/smtp/auth.go.html#5788931">a</a></span><span class="op" id="5789251">.</span><span class="ident" id="5789252"><a href="/gostd/net/smtp/auth.go.html#5788472">host</a></span>&nbsp;<span class="op" id="5789257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5789261">return</span>&nbsp;<span class="string" id="5789268">&#34;&#34;</span><span class="op" id="5789270">,</span>&nbsp;<span class="builtintype" id="5789272">nil</span><span class="op" id="5789275">,</span>&nbsp;<span class="ident" id="5789277"><a href="/gostd/net/smtp/auth.go.html#5787195">errors</a></span><span class="op" id="5789283">.</span><span class="ident" id="5789284"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="5789287">(</span><span class="string" id="5789288">&#34;wrong&nbsp;host&nbsp;name&#34;</span><span class="op" id="5789305">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5789308">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5789311">resp</span>&nbsp;<span class="op" id="5789316">:=</span>&nbsp;<span class="op" id="5789319">[</span><span class="op" id="5789320">]</span><span class="builtintype" id="5789321">byte</span><span class="op" id="5789325">(</span><span class="ident" id="5789326"><a href="/gostd/net/smtp/auth.go.html#5788931">a</a></span><span class="op" id="5789327">.</span><span class="ident" id="5789328"><a href="/gostd/net/smtp/auth.go.html#5788435">identity</a></span>&nbsp;<span class="op" id="5789337">+</span>&nbsp;<span class="string" id="5789339">&#34;\x00&#34;</span>&nbsp;<span class="op" id="5789346">+</span>&nbsp;<span class="ident" id="5789348"><a href="/gostd/net/smtp/auth.go.html#5788931">a</a></span><span class="op" id="5789349">.</span><span class="ident" id="5789350"><a href="/gostd/net/smtp/auth.go.html#5788445">username</a></span>&nbsp;<span class="op" id="5789359">+</span>&nbsp;<span class="string" id="5789361">&#34;\x00&#34;</span>&nbsp;<span class="op" id="5789368">+</span>&nbsp;<span class="ident" id="5789370"><a href="/gostd/net/smtp/auth.go.html#5788931">a</a></span><span class="op" id="5789371">.</span><span class="ident" id="5789372"><a href="/gostd/net/smtp/auth.go.html#5788455">password</a></span><span class="op" id="5789380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5789383">return</span>&nbsp;<span class="string" id="5789390">&#34;PLAIN&#34;</span><span class="op" id="5789397">,</span>&nbsp;<span class="ident" id="5789399"><a href="/gostd/net/smtp/auth.go.html#5789311">resp</a></span><span class="op" id="5789403">,</span>&nbsp;<span class="builtintype" id="5789405">nil</span><br>
<span class="lineno"></span><span class="op" id="5789409">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="5789412">func</span>&nbsp;<span class="op" id="5789417">(</span><span class="ident" id="5789418">a</span>&nbsp;<span class="op" id="5789420">*</span><span class="ident" id="5789421"><a href="/gostd/net/smtp/auth.go.html#5788415">plainAuth</a></span><span class="op" id="5789430">)</span>&nbsp;<span class="ident" id="5789432">Next</span><span class="op" id="5789436">(</span><span class="ident" id="5789437">fromServer</span>&nbsp;<span class="op" id="5789448">[</span><span class="op" id="5789449">]</span><span class="builtintype" id="5789450">byte</span><span class="op" id="5789454">,</span>&nbsp;<span class="ident" id="5789456">more</span>&nbsp;<span class="builtintype" id="5789461">bool</span><span class="op" id="5789465">)</span>&nbsp;<span class="op" id="5789467">(</span><span class="op" id="5789468">[</span><span class="op" id="5789469">]</span><span class="builtintype" id="5789470">byte</span><span class="op" id="5789474">,</span>&nbsp;<span class="builtintype" id="5789476">error</span><span class="op" id="5789481">)</span>&nbsp;<span class="op" id="5789483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5789486">if</span>&nbsp;<span class="ident" id="5789489"><a href="/gostd/net/smtp/auth.go.html#5789456">more</a></span>&nbsp;<span class="op" id="5789494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5789498">//&nbsp;We&#39;ve&nbsp;already&nbsp;sent&nbsp;everything.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5789534">return</span>&nbsp;<span class="builtintype" id="5789541">nil</span><span class="op" id="5789544">,</span>&nbsp;<span class="ident" id="5789546"><a href="/gostd/net/smtp/auth.go.html#5787195">errors</a></span><span class="op" id="5789552">.</span><span class="ident" id="5789553"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="5789556">(</span><span class="string" id="5789557">&#34;unexpected&nbsp;server&nbsp;challenge&#34;</span><span class="op" id="5789586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5789589">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5789592">return</span>&nbsp;<span class="builtintype" id="5789599">nil</span><span class="op" id="5789602">,</span>&nbsp;<span class="builtintype" id="5789604">nil</span><br>
<span class="lineno"></span><span class="op" id="5789608">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5789611">type</span>&nbsp;<span class="ident" id="5789616">cramMD5Auth</span>&nbsp;<span class="keyword" id="5789628">struct</span>&nbsp;<span class="op" id="5789635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5789638">username</span><span class="op" id="5789646">,</span>&nbsp;<span class="ident" id="5789648">secret</span>&nbsp;<span class="builtintype" id="5789655">string</span><br>
<span class="lineno">85</span><span class="op" id="5789662">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5789665">//&nbsp;CRAMMD5Auth&nbsp;returns&nbsp;an&nbsp;Auth&nbsp;that&nbsp;implements&nbsp;the&nbsp;CRAM-MD5&nbsp;authentication</span><br>
<span class="lineno"></span><span class="comment" id="5789740">//&nbsp;mechanism&nbsp;as&nbsp;defined&nbsp;in&nbsp;RFC&nbsp;2195.</span><br>
<span class="lineno"></span><span class="comment" id="5789777">//&nbsp;The&nbsp;returned&nbsp;Auth&nbsp;uses&nbsp;the&nbsp;given&nbsp;username&nbsp;and&nbsp;secret&nbsp;to&nbsp;authenticate</span><br>
<span class="lineno">90</span><span class="comment" id="5789849">//&nbsp;to&nbsp;the&nbsp;server&nbsp;using&nbsp;the&nbsp;challenge-response&nbsp;mechanism.</span><br>
<span class="lineno"></span><span class="keyword" id="5789906">func</span>&nbsp;<span class="ident" id="5789911">CRAMMD5Auth</span><span class="op" id="5789922">(</span><span class="ident" id="5789923">username</span><span class="op" id="5789931">,</span>&nbsp;<span class="ident" id="5789933">secret</span>&nbsp;<span class="builtintype" id="5789940">string</span><span class="op" id="5789946">)</span>&nbsp;<span class="ident" id="5789948"><a href="/gostd/net/smtp/auth.go.html#5787279">Auth</a></span>&nbsp;<span class="op" id="5789953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5789956">return</span>&nbsp;<span class="op" id="5789963">&amp;</span><span class="ident" id="5789964"><a href="/gostd/net/smtp/auth.go.html#5789616">cramMD5Auth</a></span><span class="op" id="5789975">{</span><span class="ident" id="5789976"><a href="/gostd/net/smtp/auth.go.html#5789923">username</a></span><span class="op" id="5789984">,</span>&nbsp;<span class="ident" id="5789986"><a href="/gostd/net/smtp/auth.go.html#5789933">secret</a></span><span class="op" id="5789992">}</span><br>
<span class="lineno"></span><span class="op" id="5789994">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="keyword" id="5789997">func</span>&nbsp;<span class="op" id="5790002">(</span><span class="ident" id="5790003">a</span>&nbsp;<span class="op" id="5790005">*</span><span class="ident" id="5790006"><a href="/gostd/net/smtp/auth.go.html#5789616">cramMD5Auth</a></span><span class="op" id="5790017">)</span>&nbsp;<span class="ident" id="5790019">Start</span><span class="op" id="5790024">(</span><span class="ident" id="5790025">server</span>&nbsp;<span class="op" id="5790032">*</span><span class="ident" id="5790033"><a href="/gostd/net/smtp/auth.go.html#5788236">ServerInfo</a></span><span class="op" id="5790043">)</span>&nbsp;<span class="op" id="5790045">(</span><span class="builtintype" id="5790046">string</span><span class="op" id="5790052">,</span>&nbsp;<span class="op" id="5790054">[</span><span class="op" id="5790055">]</span><span class="builtintype" id="5790056">byte</span><span class="op" id="5790060">,</span>&nbsp;<span class="builtintype" id="5790062">error</span><span class="op" id="5790067">)</span>&nbsp;<span class="op" id="5790069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5790072">return</span>&nbsp;<span class="string" id="5790079">&#34;CRAM-MD5&#34;</span><span class="op" id="5790089">,</span>&nbsp;<span class="builtintype" id="5790091">nil</span><span class="op" id="5790094">,</span>&nbsp;<span class="builtintype" id="5790096">nil</span><br>
<span class="lineno"></span><span class="op" id="5790100">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5790103">func</span>&nbsp;<span class="op" id="5790108">(</span><span class="ident" id="5790109">a</span>&nbsp;<span class="op" id="5790111">*</span><span class="ident" id="5790112"><a href="/gostd/net/smtp/auth.go.html#5789616">cramMD5Auth</a></span><span class="op" id="5790123">)</span>&nbsp;<span class="ident" id="5790125">Next</span><span class="op" id="5790129">(</span><span class="ident" id="5790130">fromServer</span>&nbsp;<span class="op" id="5790141">[</span><span class="op" id="5790142">]</span><span class="builtintype" id="5790143">byte</span><span class="op" id="5790147">,</span>&nbsp;<span class="ident" id="5790149">more</span>&nbsp;<span class="builtintype" id="5790154">bool</span><span class="op" id="5790158">)</span>&nbsp;<span class="op" id="5790160">(</span><span class="op" id="5790161">[</span><span class="op" id="5790162">]</span><span class="builtintype" id="5790163">byte</span><span class="op" id="5790167">,</span>&nbsp;<span class="builtintype" id="5790169">error</span><span class="op" id="5790174">)</span>&nbsp;<span class="op" id="5790176">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5790179">if</span>&nbsp;<span class="ident" id="5790182"><a href="/gostd/net/smtp/auth.go.html#5790149">more</a></span>&nbsp;<span class="op" id="5790187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5790191">d</span>&nbsp;<span class="op" id="5790193">:=</span>&nbsp;<span class="ident" id="5790196"><a href="/gostd/net/smtp/auth.go.html#5787166">hmac</a></span><span class="op" id="5790200">.</span><span class="ident" id="5790201"><a href="/gostd/crypto/hmac/hmac.go.html#4605122">New</a></span><span class="op" id="5790204">(</span><span class="ident" id="5790205"><a href="/gostd/net/smtp/auth.go.html#5787181">md5</a></span><span class="op" id="5790208">.</span><span class="ident" id="5790209"><a href="/gostd/crypto/md5/md5.go.html#4710829">New</a></span><span class="op" id="5790212">,</span>&nbsp;<span class="op" id="5790214">[</span><span class="op" id="5790215">]</span><span class="builtintype" id="5790216">byte</span><span class="op" id="5790220">(</span><span class="ident" id="5790221"><a href="/gostd/net/smtp/auth.go.html#5790109">a</a></span><span class="op" id="5790222">.</span><span class="ident" id="5790223"><a href="/gostd/net/smtp/auth.go.html#5789648">secret</a></span><span class="op" id="5790229">)</span><span class="op" id="5790230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5790234"><a href="/gostd/net/smtp/auth.go.html#5790191">d</a></span><span class="op" id="5790235">.</span><span class="ident" id="5790236"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="5790241">(</span><span class="ident" id="5790242"><a href="/gostd/net/smtp/auth.go.html#5790130">fromServer</a></span><span class="op" id="5790252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5790256">s</span>&nbsp;<span class="op" id="5790258">:=</span>&nbsp;<span class="builtinfunc" id="5790261">make</span><span class="op" id="5790265">(</span><span class="op" id="5790266">[</span><span class="op" id="5790267">]</span><span class="builtintype" id="5790268">byte</span><span class="op" id="5790272">,</span>&nbsp;<span class="num" id="5790274">0</span><span class="op" id="5790275">,</span>&nbsp;<span class="ident" id="5790277"><a href="/gostd/net/smtp/auth.go.html#5790191">d</a></span><span class="op" id="5790278">.</span><span class="ident" id="5790279"><a href="/gostd/hash/hash.go.html#3014507">Size</a></span><span class="op" id="5790283">(</span><span class="op" id="5790284">)</span><span class="op" id="5790285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5790289">return</span>&nbsp;<span class="op" id="5790296">[</span><span class="op" id="5790297">]</span><span class="builtintype" id="5790298">byte</span><span class="op" id="5790302">(</span><span class="ident" id="5790303"><a href="/gostd/net/smtp/auth.go.html#5787205">fmt</a></span><span class="op" id="5790306">.</span><span class="ident" id="5790307"><a href="/gostd/fmt/print.go.html#2143637">Sprintf</a></span><span class="op" id="5790314">(</span><span class="string" id="5790315">&#34;%s&nbsp;%x&#34;</span><span class="op" id="5790322">,</span>&nbsp;<span class="ident" id="5790324"><a href="/gostd/net/smtp/auth.go.html#5790109">a</a></span><span class="op" id="5790325">.</span><span class="ident" id="5790326"><a href="/gostd/net/smtp/auth.go.html#5789638">username</a></span><span class="op" id="5790334">,</span>&nbsp;<span class="ident" id="5790336"><a href="/gostd/net/smtp/auth.go.html#5790191">d</a></span><span class="op" id="5790337">.</span><span class="ident" id="5790338"><a href="/gostd/hash/hash.go.html#3014372">Sum</a></span><span class="op" id="5790341">(</span><span class="ident" id="5790342"><a href="/gostd/net/smtp/auth.go.html#5790256">s</a></span><span class="op" id="5790343">)</span><span class="op" id="5790344">)</span><span class="op" id="5790345">)</span><span class="op" id="5790346">,</span>&nbsp;<span class="builtintype" id="5790348">nil</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5790353">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5790356">return</span>&nbsp;<span class="builtintype" id="5790363">nil</span><span class="op" id="5790366">,</span>&nbsp;<span class="builtintype" id="5790368">nil</span><br>
<span class="lineno"></span><span class="op" id="5790372">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
