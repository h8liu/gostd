<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="5994271">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5994327">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5994381">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5994432">//&nbsp;Package&nbsp;draw&nbsp;provides&nbsp;image&nbsp;composition&nbsp;functions.</span><br>
<span class="lineno"></span><span class="comment" id="5994486">//</span><br>
<span class="lineno"></span><span class="comment" id="5994489">//&nbsp;See&nbsp;&#34;The&nbsp;Go&nbsp;image/draw&nbsp;package&#34;&nbsp;for&nbsp;an&nbsp;introduction&nbsp;to&nbsp;this&nbsp;package:</span><br>
<span class="lineno"></span><span class="comment" id="5994561">//&nbsp;http://golang.org/doc/articles/image_draw.html</span><br>
<span class="lineno"></span><span class="keyword" id="5994611">package</span>&nbsp;<span class="ident" id="5994619">draw</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="5994625">import</span>&nbsp;<span class="op" id="5994632">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5994635">&#34;image&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5994644">&#34;image/color&#34;</span><br>
<span class="lineno"></span><span class="op" id="5994658">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="5994661">//&nbsp;m&nbsp;is&nbsp;the&nbsp;maximum&nbsp;color&nbsp;value&nbsp;returned&nbsp;by&nbsp;image.Color.RGBA.</span><br>
<span class="lineno"></span><span class="keyword" id="5994723">const</span>&nbsp;<span class="ident" id="5994729">m</span>&nbsp;<span class="op" id="5994731">=</span>&nbsp;<span class="num" id="5994733">1</span><span class="op" id="5994734">&lt;&lt;</span><span class="num" id="5994736">16</span>&nbsp;<span class="op" id="5994739">-</span>&nbsp;<span class="num" id="5994741">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5994744">//&nbsp;Image&nbsp;is&nbsp;an&nbsp;image.Image&nbsp;with&nbsp;a&nbsp;Set&nbsp;method&nbsp;to&nbsp;change&nbsp;a&nbsp;single&nbsp;pixel.</span><br>
<span class="lineno">20</span><span class="keyword" id="5994815">type</span>&nbsp;<span class="ident" id="5994820">Image</span>&nbsp;<span class="keyword" id="5994826">interface</span>&nbsp;<span class="op" id="5994836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5994839"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="5994844">.</span><span class="ident" id="5994845">Image</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5994852">Set</span><span class="op" id="5994855">(</span><span class="ident" id="5994856">x</span><span class="op" id="5994857">,</span>&nbsp;<span class="ident" id="5994859">y</span>&nbsp;<span class="builtintype" id="5994861">int</span><span class="op" id="5994864">,</span>&nbsp;<span class="ident" id="5994866">c</span>&nbsp;<span class="ident" id="5994868"><a href="/image/draw/draw.go.html#5994644">color</a></span><span class="op" id="5994873">.</span><span class="ident" id="5994874">Color</span><span class="op" id="5994879">)</span><br>
<span class="lineno"></span><span class="op" id="5994881">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="5994884">//&nbsp;Quantizer&nbsp;produces&nbsp;a&nbsp;palette&nbsp;for&nbsp;an&nbsp;image.</span><br>
<span class="lineno"></span><span class="keyword" id="5994930">type</span>&nbsp;<span class="ident" id="5994935">Quantizer</span>&nbsp;<span class="keyword" id="5994945">interface</span>&nbsp;<span class="op" id="5994955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5994958">//&nbsp;Quantize&nbsp;appends&nbsp;up&nbsp;to&nbsp;cap(p)&nbsp;-&nbsp;len(p)&nbsp;colors&nbsp;to&nbsp;p&nbsp;and&nbsp;returns&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5995029">//&nbsp;updated&nbsp;palette&nbsp;suitable&nbsp;for&nbsp;converting&nbsp;m&nbsp;to&nbsp;a&nbsp;paletted&nbsp;image.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5995096">Quantize</span><span class="op" id="5995104">(</span><span class="ident" id="5995105">p</span>&nbsp;<span class="ident" id="5995107"><a href="/image/draw/draw.go.html#5994644">color</a></span><span class="op" id="5995112">.</span><span class="ident" id="5995113">Palette</span><span class="op" id="5995120">,</span>&nbsp;<span class="ident" id="5995122">m</span>&nbsp;<span class="ident" id="5995124"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="5995129">.</span><span class="ident" id="5995130">Image</span><span class="op" id="5995135">)</span>&nbsp;<span class="ident" id="5995137"><a href="/image/draw/draw.go.html#5994644">color</a></span><span class="op" id="5995142">.</span><span class="ident" id="5995143">Palette</span><br>
<span class="lineno">30</span><span class="op" id="5995151">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5995154">//&nbsp;Op&nbsp;is&nbsp;a&nbsp;Porter-Duff&nbsp;compositing&nbsp;operator.</span><br>
<span class="lineno"></span><span class="keyword" id="5995199">type</span>&nbsp;<span class="ident" id="5995204">Op</span>&nbsp;<span class="builtintype" id="5995207">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="5995212">const</span>&nbsp;<span class="op" id="5995218">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5995221">//&nbsp;Over&nbsp;specifies&nbsp;``(src&nbsp;in&nbsp;mask)&nbsp;over&nbsp;dst&#39;&#39;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5995268">Over</span>&nbsp;<span class="ident" id="5995273"><a href="/image/draw/draw.go.html#5995204">Op</a></span>&nbsp;<span class="op" id="5995276">=</span>&nbsp;<span class="ident" id="5995278">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5995284">//&nbsp;Src&nbsp;specifies&nbsp;``src&nbsp;in&nbsp;mask&#39;&#39;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5995319">Src</span><br>
<span class="lineno">40</span><span class="op" id="5995323">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5995326">//&nbsp;Draw&nbsp;implements&nbsp;the&nbsp;Drawer&nbsp;interface&nbsp;by&nbsp;calling&nbsp;the&nbsp;Draw&nbsp;function&nbsp;with&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="5995405">//&nbsp;Op.</span><br>
<span class="lineno"></span><span class="keyword" id="5995412">func</span>&nbsp;<span class="op" id="5995417">(</span><span class="ident" id="5995418">op</span>&nbsp;<span class="ident" id="5995421"><a href="/image/draw/draw.go.html#5995204">Op</a></span><span class="op" id="5995423">)</span>&nbsp;<span class="ident" id="5995425">Draw</span><span class="op" id="5995429">(</span><span class="ident" id="5995430">dst</span>&nbsp;<span class="ident" id="5995434"><a href="/image/draw/draw.go.html#5994820">Image</a></span><span class="op" id="5995439">,</span>&nbsp;<span class="ident" id="5995441">r</span>&nbsp;<span class="ident" id="5995443"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="5995448">.</span><span class="ident" id="5995449">Rectangle</span><span class="op" id="5995458">,</span>&nbsp;<span class="ident" id="5995460">src</span>&nbsp;<span class="ident" id="5995464"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="5995469">.</span><span class="ident" id="5995470">Image</span><span class="op" id="5995475">,</span>&nbsp;<span class="ident" id="5995477">sp</span>&nbsp;<span class="ident" id="5995480"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="5995485">.</span><span class="ident" id="5995486">Point</span><span class="op" id="5995491">)</span>&nbsp;<span class="op" id="5995493">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5995496"><a href="/image/draw/draw.go.html#5997385">DrawMask</a></span><span class="op" id="5995504">(</span><span class="ident" id="5995505"><a href="/image/draw/draw.go.html#5995430">dst</a></span><span class="op" id="5995508">,</span>&nbsp;<span class="ident" id="5995510"><a href="/image/draw/draw.go.html#5995441">r</a></span><span class="op" id="5995511">,</span>&nbsp;<span class="ident" id="5995513"><a href="/image/draw/draw.go.html#5995460">src</a></span><span class="op" id="5995516">,</span>&nbsp;<span class="ident" id="5995518"><a href="/image/draw/draw.go.html#5995477">sp</a></span><span class="op" id="5995520">,</span>&nbsp;<span class="ident" id="5995522">nil</span><span class="op" id="5995525">,</span>&nbsp;<span class="ident" id="5995527"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="5995532">.</span><span class="ident" id="5995533">Point</span><span class="op" id="5995538">{</span><span class="op" id="5995539">}</span><span class="op" id="5995540">,</span>&nbsp;<span class="ident" id="5995542"><a href="/image/draw/draw.go.html#5995418">op</a></span><span class="op" id="5995544">)</span><br>
<span class="lineno"></span><span class="op" id="5995546">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5995549">//&nbsp;Drawer&nbsp;contains&nbsp;the&nbsp;Draw&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="5995585">type</span>&nbsp;<span class="ident" id="5995590">Drawer</span>&nbsp;<span class="keyword" id="5995597">interface</span>&nbsp;<span class="op" id="5995607">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5995610">//&nbsp;Draw&nbsp;aligns&nbsp;r.Min&nbsp;in&nbsp;dst&nbsp;with&nbsp;sp&nbsp;in&nbsp;src&nbsp;and&nbsp;then&nbsp;replaces&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5995676">//&nbsp;rectangle&nbsp;r&nbsp;in&nbsp;dst&nbsp;with&nbsp;the&nbsp;result&nbsp;of&nbsp;drawing&nbsp;src&nbsp;on&nbsp;dst.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5995738">Draw</span><span class="op" id="5995742">(</span><span class="ident" id="5995743">dst</span>&nbsp;<span class="ident" id="5995747"><a href="/image/draw/draw.go.html#5994820">Image</a></span><span class="op" id="5995752">,</span>&nbsp;<span class="ident" id="5995754">r</span>&nbsp;<span class="ident" id="5995756"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="5995761">.</span><span class="ident" id="5995762">Rectangle</span><span class="op" id="5995771">,</span>&nbsp;<span class="ident" id="5995773">src</span>&nbsp;<span class="ident" id="5995777"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="5995782">.</span><span class="ident" id="5995783">Image</span><span class="op" id="5995788">,</span>&nbsp;<span class="ident" id="5995790">sp</span>&nbsp;<span class="ident" id="5995793"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="5995798">.</span><span class="ident" id="5995799">Point</span><span class="op" id="5995804">)</span><br>
<span class="lineno"></span><span class="op" id="5995806">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="comment" id="5995809">//&nbsp;FloydSteinberg&nbsp;is&nbsp;a&nbsp;Drawer&nbsp;that&nbsp;is&nbsp;the&nbsp;Src&nbsp;Op&nbsp;with&nbsp;Floyd-Steinberg&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="5995885">//&nbsp;diffusion.</span><br>
<span class="lineno"></span><span class="keyword" id="5995899">var</span>&nbsp;<span class="ident" id="5995903">FloydSteinberg</span>&nbsp;<span class="ident" id="5995918"><a href="/image/draw/draw.go.html#5995590">Drawer</a></span>&nbsp;<span class="op" id="5995925">=</span>&nbsp;<span class="ident" id="5995927"><a href="/image/draw/draw.go.html#5995950">floydSteinberg</a></span><span class="op" id="5995941">{</span><span class="op" id="5995942">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5995945">type</span>&nbsp;<span class="ident" id="5995950">floydSteinberg</span>&nbsp;<span class="keyword" id="5995965">struct</span><span class="op" id="5995971">{</span><span class="op" id="5995972">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="5995975">func</span>&nbsp;<span class="op" id="5995980">(</span><span class="ident" id="5995981"><a href="/image/draw/draw.go.html#5995950">floydSteinberg</a></span><span class="op" id="5995995">)</span>&nbsp;<span class="ident" id="5995997">Draw</span><span class="op" id="5996001">(</span><span class="ident" id="5996002">dst</span>&nbsp;<span class="ident" id="5996006"><a href="/image/draw/draw.go.html#5994820">Image</a></span><span class="op" id="5996011">,</span>&nbsp;<span class="ident" id="5996013">r</span>&nbsp;<span class="ident" id="5996015"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="5996020">.</span><span class="ident" id="5996021">Rectangle</span><span class="op" id="5996030">,</span>&nbsp;<span class="ident" id="5996032">src</span>&nbsp;<span class="ident" id="5996036"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="5996041">.</span><span class="ident" id="5996042">Image</span><span class="op" id="5996047">,</span>&nbsp;<span class="ident" id="5996049">sp</span>&nbsp;<span class="ident" id="5996052"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="5996057">.</span><span class="ident" id="5996058">Point</span><span class="op" id="5996063">)</span>&nbsp;<span class="op" id="5996065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5996068"><a href="/image/draw/draw.go.html#5996367">clip</a></span><span class="op" id="5996072">(</span><span class="ident" id="5996073"><a href="/image/draw/draw.go.html#5996002">dst</a></span><span class="op" id="5996076">,</span>&nbsp;<span class="op" id="5996078">&amp;</span><span class="ident" id="5996079"><a href="/image/draw/draw.go.html#5996013">r</a></span><span class="op" id="5996080">,</span>&nbsp;<span class="ident" id="5996082"><a href="/image/draw/draw.go.html#5996032">src</a></span><span class="op" id="5996085">,</span>&nbsp;<span class="op" id="5996087">&amp;</span><span class="ident" id="5996088"><a href="/image/draw/draw.go.html#5996049">sp</a></span><span class="op" id="5996090">,</span>&nbsp;<span class="ident" id="5996092">nil</span><span class="op" id="5996095">,</span>&nbsp;<span class="ident" id="5996097">nil</span><span class="op" id="5996100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5996103">if</span>&nbsp;<span class="ident" id="5996106"><a href="/image/draw/draw.go.html#5996013">r</a></span><span class="op" id="5996107">.</span><span class="ident" id="5996108">Empty</span><span class="op" id="5996113">(</span><span class="op" id="5996114">)</span>&nbsp;<span class="op" id="5996116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5996120">return</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5996128">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5996131"><a href="/image/draw/draw.go.html#6010987">drawPaletted</a></span><span class="op" id="5996143">(</span><span class="ident" id="5996144"><a href="/image/draw/draw.go.html#5996002">dst</a></span><span class="op" id="5996147">,</span>&nbsp;<span class="ident" id="5996149"><a href="/image/draw/draw.go.html#5996013">r</a></span><span class="op" id="5996150">,</span>&nbsp;<span class="ident" id="5996152"><a href="/image/draw/draw.go.html#5996032">src</a></span><span class="op" id="5996155">,</span>&nbsp;<span class="ident" id="5996157"><a href="/image/draw/draw.go.html#5996049">sp</a></span><span class="op" id="5996159">,</span>&nbsp;<span class="builtintype" id="5996161">true</span><span class="op" id="5996165">)</span><br>
<span class="lineno"></span><span class="op" id="5996167">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5996170">//&nbsp;clip&nbsp;clips&nbsp;r&nbsp;against&nbsp;each&nbsp;image&#39;s&nbsp;bounds&nbsp;(after&nbsp;translating&nbsp;into&nbsp;the</span><br>
<span class="lineno">70</span><span class="comment" id="5996242">//&nbsp;destination&nbsp;image&#39;s&nbsp;co-ordinate&nbsp;space)&nbsp;and&nbsp;shifts&nbsp;the&nbsp;points&nbsp;sp&nbsp;and&nbsp;mp&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="5996319">//&nbsp;the&nbsp;same&nbsp;amount&nbsp;as&nbsp;the&nbsp;change&nbsp;in&nbsp;r.Min.</span><br>
<span class="lineno"></span><span class="keyword" id="5996362">func</span>&nbsp;<span class="ident" id="5996367">clip</span><span class="op" id="5996371">(</span><span class="ident" id="5996372">dst</span>&nbsp;<span class="ident" id="5996376"><a href="/image/draw/draw.go.html#5994820">Image</a></span><span class="op" id="5996381">,</span>&nbsp;<span class="ident" id="5996383">r</span>&nbsp;<span class="op" id="5996385">*</span><span class="ident" id="5996386"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="5996391">.</span><span class="ident" id="5996392">Rectangle</span><span class="op" id="5996401">,</span>&nbsp;<span class="ident" id="5996403">src</span>&nbsp;<span class="ident" id="5996407"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="5996412">.</span><span class="ident" id="5996413">Image</span><span class="op" id="5996418">,</span>&nbsp;<span class="ident" id="5996420">sp</span>&nbsp;<span class="op" id="5996423">*</span><span class="ident" id="5996424"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="5996429">.</span><span class="ident" id="5996430">Point</span><span class="op" id="5996435">,</span>&nbsp;<span class="ident" id="5996437">mask</span>&nbsp;<span class="ident" id="5996442"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="5996447">.</span><span class="ident" id="5996448">Image</span><span class="op" id="5996453">,</span>&nbsp;<span class="ident" id="5996455">mp</span>&nbsp;<span class="op" id="5996458">*</span><span class="ident" id="5996459"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="5996464">.</span><span class="ident" id="5996465">Point</span><span class="op" id="5996470">)</span>&nbsp;<span class="op" id="5996472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5996475">orig</span>&nbsp;<span class="op" id="5996480">:=</span>&nbsp;<span class="ident" id="5996483"><a href="/image/draw/draw.go.html#5996383">r</a></span><span class="op" id="5996484">.</span><span class="ident" id="5996485">Min</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5996490">*</span><span class="ident" id="5996491"><a href="/image/draw/draw.go.html#5996383">r</a></span>&nbsp;<span class="op" id="5996493">=</span>&nbsp;<span class="ident" id="5996495"><a href="/image/draw/draw.go.html#5996383">r</a></span><span class="op" id="5996496">.</span><span class="ident" id="5996497">Intersect</span><span class="op" id="5996506">(</span><span class="ident" id="5996507"><a href="/image/draw/draw.go.html#5996372">dst</a></span><span class="op" id="5996510">.</span><span class="ident" id="5996511">Bounds</span><span class="op" id="5996517">(</span><span class="op" id="5996518">)</span><span class="op" id="5996519">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5996522">*</span><span class="ident" id="5996523"><a href="/image/draw/draw.go.html#5996383">r</a></span>&nbsp;<span class="op" id="5996525">=</span>&nbsp;<span class="ident" id="5996527"><a href="/image/draw/draw.go.html#5996383">r</a></span><span class="op" id="5996528">.</span><span class="ident" id="5996529">Intersect</span><span class="op" id="5996538">(</span><span class="ident" id="5996539"><a href="/image/draw/draw.go.html#5996403">src</a></span><span class="op" id="5996542">.</span><span class="ident" id="5996543">Bounds</span><span class="op" id="5996549">(</span><span class="op" id="5996550">)</span><span class="op" id="5996551">.</span><span class="ident" id="5996552">Add</span><span class="op" id="5996555">(</span><span class="ident" id="5996556"><a href="/image/draw/draw.go.html#5996475">orig</a></span><span class="op" id="5996560">.</span><span class="ident" id="5996561">Sub</span><span class="op" id="5996564">(</span><span class="op" id="5996565">*</span><span class="ident" id="5996566"><a href="/image/draw/draw.go.html#5996420">sp</a></span><span class="op" id="5996568">)</span><span class="op" id="5996569">)</span><span class="op" id="5996570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5996573">if</span>&nbsp;<span class="ident" id="5996576"><a href="/image/draw/draw.go.html#5996437">mask</a></span>&nbsp;<span class="op" id="5996581">!=</span>&nbsp;<span class="ident" id="5996584">nil</span>&nbsp;<span class="op" id="5996588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5996592">*</span><span class="ident" id="5996593"><a href="/image/draw/draw.go.html#5996383">r</a></span>&nbsp;<span class="op" id="5996595">=</span>&nbsp;<span class="ident" id="5996597"><a href="/image/draw/draw.go.html#5996383">r</a></span><span class="op" id="5996598">.</span><span class="ident" id="5996599">Intersect</span><span class="op" id="5996608">(</span><span class="ident" id="5996609"><a href="/image/draw/draw.go.html#5996437">mask</a></span><span class="op" id="5996613">.</span><span class="ident" id="5996614">Bounds</span><span class="op" id="5996620">(</span><span class="op" id="5996621">)</span><span class="op" id="5996622">.</span><span class="ident" id="5996623">Add</span><span class="op" id="5996626">(</span><span class="ident" id="5996627"><a href="/image/draw/draw.go.html#5996475">orig</a></span><span class="op" id="5996631">.</span><span class="ident" id="5996632">Sub</span><span class="op" id="5996635">(</span><span class="op" id="5996636">*</span><span class="ident" id="5996637"><a href="/image/draw/draw.go.html#5996455">mp</a></span><span class="op" id="5996639">)</span><span class="op" id="5996640">)</span><span class="op" id="5996641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5996644">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5996647">dx</span>&nbsp;<span class="op" id="5996650">:=</span>&nbsp;<span class="ident" id="5996653"><a href="/image/draw/draw.go.html#5996383">r</a></span><span class="op" id="5996654">.</span><span class="ident" id="5996655">Min</span><span class="op" id="5996658">.</span><span class="ident" id="5996659">X</span>&nbsp;<span class="op" id="5996661">-</span>&nbsp;<span class="ident" id="5996663"><a href="/image/draw/draw.go.html#5996475">orig</a></span><span class="op" id="5996667">.</span><span class="ident" id="5996668">X</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5996671">dy</span>&nbsp;<span class="op" id="5996674">:=</span>&nbsp;<span class="ident" id="5996677"><a href="/image/draw/draw.go.html#5996383">r</a></span><span class="op" id="5996678">.</span><span class="ident" id="5996679">Min</span><span class="op" id="5996682">.</span><span class="ident" id="5996683">Y</span>&nbsp;<span class="op" id="5996685">-</span>&nbsp;<span class="ident" id="5996687"><a href="/image/draw/draw.go.html#5996475">orig</a></span><span class="op" id="5996691">.</span><span class="ident" id="5996692">Y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5996695">if</span>&nbsp;<span class="ident" id="5996698"><a href="/image/draw/draw.go.html#5996647">dx</a></span>&nbsp;<span class="op" id="5996701">==</span>&nbsp;<span class="num" id="5996704">0</span>&nbsp;<span class="op" id="5996706">&amp;&amp;</span>&nbsp;<span class="ident" id="5996709"><a href="/image/draw/draw.go.html#5996671">dy</a></span>&nbsp;<span class="op" id="5996712">==</span>&nbsp;<span class="num" id="5996715">0</span>&nbsp;<span class="op" id="5996717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5996721">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5996729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5996732">(</span><span class="op" id="5996733">*</span><span class="ident" id="5996734"><a href="/image/draw/draw.go.html#5996420">sp</a></span><span class="op" id="5996736">)</span><span class="op" id="5996737">.</span><span class="ident" id="5996738">X</span>&nbsp;<span class="op" id="5996740">+=</span>&nbsp;<span class="ident" id="5996743"><a href="/image/draw/draw.go.html#5996647">dx</a></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5996747">(</span><span class="op" id="5996748">*</span><span class="ident" id="5996749"><a href="/image/draw/draw.go.html#5996420">sp</a></span><span class="op" id="5996751">)</span><span class="op" id="5996752">.</span><span class="ident" id="5996753">Y</span>&nbsp;<span class="op" id="5996755">+=</span>&nbsp;<span class="ident" id="5996758"><a href="/image/draw/draw.go.html#5996671">dy</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5996762">(</span><span class="op" id="5996763">*</span><span class="ident" id="5996764"><a href="/image/draw/draw.go.html#5996455">mp</a></span><span class="op" id="5996766">)</span><span class="op" id="5996767">.</span><span class="ident" id="5996768">X</span>&nbsp;<span class="op" id="5996770">+=</span>&nbsp;<span class="ident" id="5996773"><a href="/image/draw/draw.go.html#5996647">dx</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5996777">(</span><span class="op" id="5996778">*</span><span class="ident" id="5996779"><a href="/image/draw/draw.go.html#5996455">mp</a></span><span class="op" id="5996781">)</span><span class="op" id="5996782">.</span><span class="ident" id="5996783">Y</span>&nbsp;<span class="op" id="5996785">+=</span>&nbsp;<span class="ident" id="5996788"><a href="/image/draw/draw.go.html#5996671">dy</a></span><br>
<span class="lineno"></span><span class="op" id="5996791">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="5996794">func</span>&nbsp;<span class="ident" id="5996799">processBackward</span><span class="op" id="5996814">(</span><span class="ident" id="5996815">dst</span>&nbsp;<span class="ident" id="5996819"><a href="/image/draw/draw.go.html#5994820">Image</a></span><span class="op" id="5996824">,</span>&nbsp;<span class="ident" id="5996826">r</span>&nbsp;<span class="ident" id="5996828"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="5996833">.</span><span class="ident" id="5996834">Rectangle</span><span class="op" id="5996843">,</span>&nbsp;<span class="ident" id="5996845">src</span>&nbsp;<span class="ident" id="5996849"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="5996854">.</span><span class="ident" id="5996855">Image</span><span class="op" id="5996860">,</span>&nbsp;<span class="ident" id="5996862">sp</span>&nbsp;<span class="ident" id="5996865"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="5996870">.</span><span class="ident" id="5996871">Point</span><span class="op" id="5996876">)</span>&nbsp;<span class="builtintype" id="5996878">bool</span>&nbsp;<span class="op" id="5996883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5996886">return</span>&nbsp;<span class="ident" id="5996893"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="5996898">.</span><span class="ident" id="5996899">Image</span><span class="op" id="5996904">(</span><span class="ident" id="5996905"><a href="/image/draw/draw.go.html#5996815">dst</a></span><span class="op" id="5996908">)</span>&nbsp;<span class="op" id="5996910">==</span>&nbsp;<span class="ident" id="5996913"><a href="/image/draw/draw.go.html#5996845">src</a></span>&nbsp;<span class="op" id="5996917">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5996922"><a href="/image/draw/draw.go.html#5996826">r</a></span><span class="op" id="5996923">.</span><span class="ident" id="5996924">Overlaps</span><span class="op" id="5996932">(</span><span class="ident" id="5996933"><a href="/image/draw/draw.go.html#5996826">r</a></span><span class="op" id="5996934">.</span><span class="ident" id="5996935">Add</span><span class="op" id="5996938">(</span><span class="ident" id="5996939"><a href="/image/draw/draw.go.html#5996862">sp</a></span><span class="op" id="5996941">.</span><span class="ident" id="5996942">Sub</span><span class="op" id="5996945">(</span><span class="ident" id="5996946"><a href="/image/draw/draw.go.html#5996826">r</a></span><span class="op" id="5996947">.</span><span class="ident" id="5996948">Min</span><span class="op" id="5996951">)</span><span class="op" id="5996952">)</span><span class="op" id="5996953">)</span>&nbsp;<span class="op" id="5996955">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5996960">(</span><span class="ident" id="5996961"><a href="/image/draw/draw.go.html#5996862">sp</a></span><span class="op" id="5996963">.</span><span class="ident" id="5996964">Y</span>&nbsp;<span class="op" id="5996966">&lt;</span>&nbsp;<span class="ident" id="5996968"><a href="/image/draw/draw.go.html#5996826">r</a></span><span class="op" id="5996969">.</span><span class="ident" id="5996970">Min</span><span class="op" id="5996973">.</span><span class="ident" id="5996974">Y</span>&nbsp;<span class="op" id="5996976">||</span>&nbsp;<span class="op" id="5996979">(</span><span class="ident" id="5996980"><a href="/image/draw/draw.go.html#5996862">sp</a></span><span class="op" id="5996982">.</span><span class="ident" id="5996983">Y</span>&nbsp;<span class="op" id="5996985">==</span>&nbsp;<span class="ident" id="5996988"><a href="/image/draw/draw.go.html#5996826">r</a></span><span class="op" id="5996989">.</span><span class="ident" id="5996990">Min</span><span class="op" id="5996993">.</span><span class="ident" id="5996994">Y</span>&nbsp;<span class="op" id="5996996">&amp;&amp;</span>&nbsp;<span class="ident" id="5996999"><a href="/image/draw/draw.go.html#5996862">sp</a></span><span class="op" id="5997001">.</span><span class="ident" id="5997002">X</span>&nbsp;<span class="op" id="5997004">&lt;</span>&nbsp;<span class="ident" id="5997006"><a href="/image/draw/draw.go.html#5996826">r</a></span><span class="op" id="5997007">.</span><span class="ident" id="5997008">Min</span><span class="op" id="5997011">.</span><span class="ident" id="5997012">X</span><span class="op" id="5997013">)</span><span class="op" id="5997014">)</span><br>
<span class="lineno"></span><span class="op" id="5997016">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="comment" id="5997019">//&nbsp;Draw&nbsp;calls&nbsp;DrawMask&nbsp;with&nbsp;a&nbsp;nil&nbsp;mask.</span><br>
<span class="lineno"></span><span class="keyword" id="5997059">func</span>&nbsp;<span class="ident" id="5997064">Draw</span><span class="op" id="5997068">(</span><span class="ident" id="5997069">dst</span>&nbsp;<span class="ident" id="5997073"><a href="/image/draw/draw.go.html#5994820">Image</a></span><span class="op" id="5997078">,</span>&nbsp;<span class="ident" id="5997080">r</span>&nbsp;<span class="ident" id="5997082"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="5997087">.</span><span class="ident" id="5997088">Rectangle</span><span class="op" id="5997097">,</span>&nbsp;<span class="ident" id="5997099">src</span>&nbsp;<span class="ident" id="5997103"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="5997108">.</span><span class="ident" id="5997109">Image</span><span class="op" id="5997114">,</span>&nbsp;<span class="ident" id="5997116">sp</span>&nbsp;<span class="ident" id="5997119"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="5997124">.</span><span class="ident" id="5997125">Point</span><span class="op" id="5997130">,</span>&nbsp;<span class="ident" id="5997132">op</span>&nbsp;<span class="ident" id="5997135"><a href="/image/draw/draw.go.html#5995204">Op</a></span><span class="op" id="5997137">)</span>&nbsp;<span class="op" id="5997139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5997142"><a href="/image/draw/draw.go.html#5997385">DrawMask</a></span><span class="op" id="5997150">(</span><span class="ident" id="5997151"><a href="/image/draw/draw.go.html#5997069">dst</a></span><span class="op" id="5997154">,</span>&nbsp;<span class="ident" id="5997156"><a href="/image/draw/draw.go.html#5997080">r</a></span><span class="op" id="5997157">,</span>&nbsp;<span class="ident" id="5997159"><a href="/image/draw/draw.go.html#5997099">src</a></span><span class="op" id="5997162">,</span>&nbsp;<span class="ident" id="5997164"><a href="/image/draw/draw.go.html#5997116">sp</a></span><span class="op" id="5997166">,</span>&nbsp;<span class="ident" id="5997168">nil</span><span class="op" id="5997171">,</span>&nbsp;<span class="ident" id="5997173"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="5997178">.</span><span class="ident" id="5997179">Point</span><span class="op" id="5997184">{</span><span class="op" id="5997185">}</span><span class="op" id="5997186">,</span>&nbsp;<span class="ident" id="5997188"><a href="/image/draw/draw.go.html#5997132">op</a></span><span class="op" id="5997190">)</span><br>
<span class="lineno"></span><span class="op" id="5997192">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="5997195">//&nbsp;DrawMask&nbsp;aligns&nbsp;r.Min&nbsp;in&nbsp;dst&nbsp;with&nbsp;sp&nbsp;in&nbsp;src&nbsp;and&nbsp;mp&nbsp;in&nbsp;mask&nbsp;and&nbsp;then&nbsp;replaces&nbsp;the&nbsp;rectangle&nbsp;r</span><br>
<span class="lineno"></span><span class="comment" id="5997291">//&nbsp;in&nbsp;dst&nbsp;with&nbsp;the&nbsp;result&nbsp;of&nbsp;a&nbsp;Porter-Duff&nbsp;composition.&nbsp;A&nbsp;nil&nbsp;mask&nbsp;is&nbsp;treated&nbsp;as&nbsp;opaque.</span><br>
<span class="lineno"></span><span class="keyword" id="5997380">func</span>&nbsp;<span class="ident" id="5997385">DrawMask</span><span class="op" id="5997393">(</span><span class="ident" id="5997394">dst</span>&nbsp;<span class="ident" id="5997398"><a href="/image/draw/draw.go.html#5994820">Image</a></span><span class="op" id="5997403">,</span>&nbsp;<span class="ident" id="5997405">r</span>&nbsp;<span class="ident" id="5997407"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="5997412">.</span><span class="ident" id="5997413">Rectangle</span><span class="op" id="5997422">,</span>&nbsp;<span class="ident" id="5997424">src</span>&nbsp;<span class="ident" id="5997428"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="5997433">.</span><span class="ident" id="5997434">Image</span><span class="op" id="5997439">,</span>&nbsp;<span class="ident" id="5997441">sp</span>&nbsp;<span class="ident" id="5997444"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="5997449">.</span><span class="ident" id="5997450">Point</span><span class="op" id="5997455">,</span>&nbsp;<span class="ident" id="5997457">mask</span>&nbsp;<span class="ident" id="5997462"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="5997467">.</span><span class="ident" id="5997468">Image</span><span class="op" id="5997473">,</span>&nbsp;<span class="ident" id="5997475">mp</span>&nbsp;<span class="ident" id="5997478"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="5997483">.</span><span class="ident" id="5997484">Point</span><span class="op" id="5997489">,</span>&nbsp;<span class="ident" id="5997491">op</span>&nbsp;<span class="ident" id="5997494"><a href="/image/draw/draw.go.html#5995204">Op</a></span><span class="op" id="5997496">)</span>&nbsp;<span class="op" id="5997498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5997501"><a href="/image/draw/draw.go.html#5996367">clip</a></span><span class="op" id="5997505">(</span><span class="ident" id="5997506"><a href="/image/draw/draw.go.html#5997394">dst</a></span><span class="op" id="5997509">,</span>&nbsp;<span class="op" id="5997511">&amp;</span><span class="ident" id="5997512"><a href="/image/draw/draw.go.html#5997405">r</a></span><span class="op" id="5997513">,</span>&nbsp;<span class="ident" id="5997515"><a href="/image/draw/draw.go.html#5997424">src</a></span><span class="op" id="5997518">,</span>&nbsp;<span class="op" id="5997520">&amp;</span><span class="ident" id="5997521"><a href="/image/draw/draw.go.html#5997441">sp</a></span><span class="op" id="5997523">,</span>&nbsp;<span class="ident" id="5997525"><a href="/image/draw/draw.go.html#5997457">mask</a></span><span class="op" id="5997529">,</span>&nbsp;<span class="op" id="5997531">&amp;</span><span class="ident" id="5997532"><a href="/image/draw/draw.go.html#5997475">mp</a></span><span class="op" id="5997534">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5997537">if</span>&nbsp;<span class="ident" id="5997540"><a href="/image/draw/draw.go.html#5997405">r</a></span><span class="op" id="5997541">.</span><span class="ident" id="5997542">Empty</span><span class="op" id="5997547">(</span><span class="op" id="5997548">)</span>&nbsp;<span class="op" id="5997550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5997554">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5997562">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5997566">//&nbsp;Fast&nbsp;paths&nbsp;for&nbsp;special&nbsp;cases.&nbsp;If&nbsp;none&nbsp;of&nbsp;them&nbsp;apply,&nbsp;then&nbsp;we&nbsp;fall&nbsp;back&nbsp;to&nbsp;a&nbsp;general&nbsp;but&nbsp;slow&nbsp;implementation.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5997679">switch</span>&nbsp;<span class="ident" id="5997686">dst0</span>&nbsp;<span class="op" id="5997691">:=</span>&nbsp;<span class="ident" id="5997694"><a href="/image/draw/draw.go.html#5997394">dst</a></span><span class="op" id="5997697">.</span><span class="op" id="5997698">(</span><span class="keyword" id="5997699">type</span><span class="op" id="5997703">)</span>&nbsp;<span class="op" id="5997705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5997708">case</span>&nbsp;<span class="op" id="5997713">*</span><span class="ident" id="5997714"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="5997719">.</span><span class="ident" id="5997720">RGBA</span><span class="op" id="5997724">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5997728">if</span>&nbsp;<span class="ident" id="5997731"><a href="/image/draw/draw.go.html#5997491">op</a></span>&nbsp;<span class="op" id="5997734">==</span>&nbsp;<span class="ident" id="5997737"><a href="/image/draw/draw.go.html#5995268">Over</a></span>&nbsp;<span class="op" id="5997742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5997747">if</span>&nbsp;<span class="ident" id="5997750"><a href="/image/draw/draw.go.html#5997457">mask</a></span>&nbsp;<span class="op" id="5997755">==</span>&nbsp;<span class="ident" id="5997758">nil</span>&nbsp;<span class="op" id="5997762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5997768">switch</span>&nbsp;<span class="ident" id="5997775">src0</span>&nbsp;<span class="op" id="5997780">:=</span>&nbsp;<span class="ident" id="5997783"><a href="/image/draw/draw.go.html#5997424">src</a></span><span class="op" id="5997786">.</span><span class="op" id="5997787">(</span><span class="keyword" id="5997788">type</span><span class="op" id="5997792">)</span>&nbsp;<span class="op" id="5997794">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5997800">case</span>&nbsp;<span class="op" id="5997805">*</span><span class="ident" id="5997806"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="5997811">.</span><span class="ident" id="5997812">Uniform</span><span class="op" id="5997819">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5997826"><a href="/image/draw/draw.go.html#6000279">drawFillOver</a></span><span class="op" id="5997838">(</span><span class="ident" id="5997839"><a href="/image/draw/draw.go.html#5997686">dst0</a></span><span class="op" id="5997843">,</span>&nbsp;<span class="ident" id="5997845"><a href="/image/draw/draw.go.html#5997405">r</a></span><span class="op" id="5997846">,</span>&nbsp;<span class="ident" id="5997848"><a href="/image/draw/draw.go.html#5997775">src0</a></span><span class="op" id="5997852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5997859">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5997870">case</span>&nbsp;<span class="op" id="5997875">*</span><span class="ident" id="5997876"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="5997881">.</span><span class="ident" id="5997882">RGBA</span><span class="op" id="5997886">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5997893"><a href="/image/draw/draw.go.html#6001693">drawCopyOver</a></span><span class="op" id="5997905">(</span><span class="ident" id="5997906"><a href="/image/draw/draw.go.html#5997686">dst0</a></span><span class="op" id="5997910">,</span>&nbsp;<span class="ident" id="5997912"><a href="/image/draw/draw.go.html#5997405">r</a></span><span class="op" id="5997913">,</span>&nbsp;<span class="ident" id="5997915"><a href="/image/draw/draw.go.html#5997775">src0</a></span><span class="op" id="5997919">,</span>&nbsp;<span class="ident" id="5997921"><a href="/image/draw/draw.go.html#5997441">sp</a></span><span class="op" id="5997923">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5997930">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5997941">case</span>&nbsp;<span class="op" id="5997946">*</span><span class="ident" id="5997947"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="5997952">.</span><span class="ident" id="5997953">NRGBA</span><span class="op" id="5997958">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5997965"><a href="/image/draw/draw.go.html#6003864">drawNRGBAOver</a></span><span class="op" id="5997978">(</span><span class="ident" id="5997979"><a href="/image/draw/draw.go.html#5997686">dst0</a></span><span class="op" id="5997983">,</span>&nbsp;<span class="ident" id="5997985"><a href="/image/draw/draw.go.html#5997405">r</a></span><span class="op" id="5997986">,</span>&nbsp;<span class="ident" id="5997988"><a href="/image/draw/draw.go.html#5997775">src0</a></span><span class="op" id="5997992">,</span>&nbsp;<span class="ident" id="5997994"><a href="/image/draw/draw.go.html#5997441">sp</a></span><span class="op" id="5997996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5998003">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5998014">case</span>&nbsp;<span class="op" id="5998019">*</span><span class="ident" id="5998020"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="5998025">.</span><span class="ident" id="5998026">YCbCr</span><span class="op" id="5998031">:</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5998038">if</span>&nbsp;<span class="ident" id="5998041"><a href="/image/draw/draw.go.html#6005724">drawYCbCr</a></span><span class="op" id="5998050">(</span><span class="ident" id="5998051"><a href="/image/draw/draw.go.html#5997686">dst0</a></span><span class="op" id="5998055">,</span>&nbsp;<span class="ident" id="5998057"><a href="/image/draw/draw.go.html#5997405">r</a></span><span class="op" id="5998058">,</span>&nbsp;<span class="ident" id="5998060"><a href="/image/draw/draw.go.html#5997775">src0</a></span><span class="op" id="5998064">,</span>&nbsp;<span class="ident" id="5998066"><a href="/image/draw/draw.go.html#5997441">sp</a></span><span class="op" id="5998068">)</span>&nbsp;<span class="op" id="5998070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5998078">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5998090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5998096">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5998101">}</span>&nbsp;<span class="keyword" id="5998103">else</span>&nbsp;<span class="keyword" id="5998108">if</span>&nbsp;<span class="ident" id="5998111">mask0</span><span class="op" id="5998116">,</span>&nbsp;<span class="ident" id="5998118">ok</span>&nbsp;<span class="op" id="5998121">:=</span>&nbsp;<span class="ident" id="5998124"><a href="/image/draw/draw.go.html#5997457">mask</a></span><span class="op" id="5998128">.</span><span class="op" id="5998129">(</span><span class="op" id="5998130">*</span><span class="ident" id="5998131"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="5998136">.</span><span class="ident" id="5998137">Alpha</span><span class="op" id="5998142">)</span><span class="op" id="5998143">;</span>&nbsp;<span class="ident" id="5998145"><a href="/image/draw/draw.go.html#5998118">ok</a></span>&nbsp;<span class="op" id="5998148">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5998154">switch</span>&nbsp;<span class="ident" id="5998161">src0</span>&nbsp;<span class="op" id="5998166">:=</span>&nbsp;<span class="ident" id="5998169"><a href="/image/draw/draw.go.html#5997424">src</a></span><span class="op" id="5998172">.</span><span class="op" id="5998173">(</span><span class="keyword" id="5998174">type</span><span class="op" id="5998178">)</span>&nbsp;<span class="op" id="5998180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5998186">case</span>&nbsp;<span class="op" id="5998191">*</span><span class="ident" id="5998192"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="5998197">.</span><span class="ident" id="5998198">Uniform</span><span class="op" id="5998205">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5998212"><a href="/image/draw/draw.go.html#6008123">drawGlyphOver</a></span><span class="op" id="5998225">(</span><span class="ident" id="5998226"><a href="/image/draw/draw.go.html#5997686">dst0</a></span><span class="op" id="5998230">,</span>&nbsp;<span class="ident" id="5998232"><a href="/image/draw/draw.go.html#5997405">r</a></span><span class="op" id="5998233">,</span>&nbsp;<span class="ident" id="5998235"><a href="/image/draw/draw.go.html#5998161">src0</a></span><span class="op" id="5998239">,</span>&nbsp;<span class="ident" id="5998241"><a href="/image/draw/draw.go.html#5998111">mask0</a></span><span class="op" id="5998246">,</span>&nbsp;<span class="ident" id="5998248"><a href="/image/draw/draw.go.html#5997475">mp</a></span><span class="op" id="5998250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5998257">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5998268">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5998273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5998277">}</span>&nbsp;<span class="keyword" id="5998279">else</span>&nbsp;<span class="op" id="5998284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5998289">if</span>&nbsp;<span class="ident" id="5998292"><a href="/image/draw/draw.go.html#5997457">mask</a></span>&nbsp;<span class="op" id="5998297">==</span>&nbsp;<span class="ident" id="5998300">nil</span>&nbsp;<span class="op" id="5998304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5998310">switch</span>&nbsp;<span class="ident" id="5998317">src0</span>&nbsp;<span class="op" id="5998322">:=</span>&nbsp;<span class="ident" id="5998325"><a href="/image/draw/draw.go.html#5997424">src</a></span><span class="op" id="5998328">.</span><span class="op" id="5998329">(</span><span class="keyword" id="5998330">type</span><span class="op" id="5998334">)</span>&nbsp;<span class="op" id="5998336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5998342">case</span>&nbsp;<span class="op" id="5998347">*</span><span class="ident" id="5998348"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="5998353">.</span><span class="ident" id="5998354">Uniform</span><span class="op" id="5998361">:</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5998368"><a href="/image/draw/draw.go.html#6000942">drawFillSrc</a></span><span class="op" id="5998379">(</span><span class="ident" id="5998380"><a href="/image/draw/draw.go.html#5997686">dst0</a></span><span class="op" id="5998384">,</span>&nbsp;<span class="ident" id="5998386"><a href="/image/draw/draw.go.html#5997405">r</a></span><span class="op" id="5998387">,</span>&nbsp;<span class="ident" id="5998389"><a href="/image/draw/draw.go.html#5998317">src0</a></span><span class="op" id="5998393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5998400">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5998411">case</span>&nbsp;<span class="op" id="5998416">*</span><span class="ident" id="5998417"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="5998422">.</span><span class="ident" id="5998423">RGBA</span><span class="op" id="5998427">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5998434"><a href="/image/draw/draw.go.html#6003075">drawCopySrc</a></span><span class="op" id="5998445">(</span><span class="ident" id="5998446"><a href="/image/draw/draw.go.html#5997686">dst0</a></span><span class="op" id="5998450">,</span>&nbsp;<span class="ident" id="5998452"><a href="/image/draw/draw.go.html#5997405">r</a></span><span class="op" id="5998453">,</span>&nbsp;<span class="ident" id="5998455"><a href="/image/draw/draw.go.html#5998317">src0</a></span><span class="op" id="5998459">,</span>&nbsp;<span class="ident" id="5998461"><a href="/image/draw/draw.go.html#5997441">sp</a></span><span class="op" id="5998463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5998470">return</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5998481">case</span>&nbsp;<span class="op" id="5998486">*</span><span class="ident" id="5998487"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="5998492">.</span><span class="ident" id="5998493">NRGBA</span><span class="op" id="5998498">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5998505"><a href="/image/draw/draw.go.html#6004914">drawNRGBASrc</a></span><span class="op" id="5998517">(</span><span class="ident" id="5998518"><a href="/image/draw/draw.go.html#5997686">dst0</a></span><span class="op" id="5998522">,</span>&nbsp;<span class="ident" id="5998524"><a href="/image/draw/draw.go.html#5997405">r</a></span><span class="op" id="5998525">,</span>&nbsp;<span class="ident" id="5998527"><a href="/image/draw/draw.go.html#5998317">src0</a></span><span class="op" id="5998531">,</span>&nbsp;<span class="ident" id="5998533"><a href="/image/draw/draw.go.html#5997441">sp</a></span><span class="op" id="5998535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5998542">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5998553">case</span>&nbsp;<span class="op" id="5998558">*</span><span class="ident" id="5998559"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="5998564">.</span><span class="ident" id="5998565">YCbCr</span><span class="op" id="5998570">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5998577">if</span>&nbsp;<span class="ident" id="5998580"><a href="/image/draw/draw.go.html#6005724">drawYCbCr</a></span><span class="op" id="5998589">(</span><span class="ident" id="5998590"><a href="/image/draw/draw.go.html#5997686">dst0</a></span><span class="op" id="5998594">,</span>&nbsp;<span class="ident" id="5998596"><a href="/image/draw/draw.go.html#5997405">r</a></span><span class="op" id="5998597">,</span>&nbsp;<span class="ident" id="5998599"><a href="/image/draw/draw.go.html#5998317">src0</a></span><span class="op" id="5998603">,</span>&nbsp;<span class="ident" id="5998605"><a href="/image/draw/draw.go.html#5997441">sp</a></span><span class="op" id="5998607">)</span>&nbsp;<span class="op" id="5998609">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5998617">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5998629">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5998635">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5998640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5998644">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5998648"><a href="/image/draw/draw.go.html#6009040">drawRGBA</a></span><span class="op" id="5998656">(</span><span class="ident" id="5998657"><a href="/image/draw/draw.go.html#5997686">dst0</a></span><span class="op" id="5998661">,</span>&nbsp;<span class="ident" id="5998663"><a href="/image/draw/draw.go.html#5997405">r</a></span><span class="op" id="5998664">,</span>&nbsp;<span class="ident" id="5998666"><a href="/image/draw/draw.go.html#5997424">src</a></span><span class="op" id="5998669">,</span>&nbsp;<span class="ident" id="5998671"><a href="/image/draw/draw.go.html#5997441">sp</a></span><span class="op" id="5998673">,</span>&nbsp;<span class="ident" id="5998675"><a href="/image/draw/draw.go.html#5997457">mask</a></span><span class="op" id="5998679">,</span>&nbsp;<span class="ident" id="5998681"><a href="/image/draw/draw.go.html#5997475">mp</a></span><span class="op" id="5998683">,</span>&nbsp;<span class="ident" id="5998685"><a href="/image/draw/draw.go.html#5997491">op</a></span><span class="op" id="5998687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5998691">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5998699">case</span>&nbsp;<span class="op" id="5998704">*</span><span class="ident" id="5998705"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="5998710">.</span><span class="ident" id="5998711">Paletted</span><span class="op" id="5998719">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5998723">if</span>&nbsp;<span class="ident" id="5998726"><a href="/image/draw/draw.go.html#5997491">op</a></span>&nbsp;<span class="op" id="5998729">==</span>&nbsp;<span class="ident" id="5998732"><a href="/image/draw/draw.go.html#5995319">Src</a></span>&nbsp;<span class="op" id="5998736">&amp;&amp;</span>&nbsp;<span class="ident" id="5998739"><a href="/image/draw/draw.go.html#5997457">mask</a></span>&nbsp;<span class="op" id="5998744">==</span>&nbsp;<span class="ident" id="5998747">nil</span>&nbsp;<span class="op" id="5998751">&amp;&amp;</span>&nbsp;<span class="op" id="5998754">!</span><span class="ident" id="5998755"><a href="/image/draw/draw.go.html#5996799">processBackward</a></span><span class="op" id="5998770">(</span><span class="ident" id="5998771"><a href="/image/draw/draw.go.html#5997394">dst</a></span><span class="op" id="5998774">,</span>&nbsp;<span class="ident" id="5998776"><a href="/image/draw/draw.go.html#5997405">r</a></span><span class="op" id="5998777">,</span>&nbsp;<span class="ident" id="5998779"><a href="/image/draw/draw.go.html#5997424">src</a></span><span class="op" id="5998782">,</span>&nbsp;<span class="ident" id="5998784"><a href="/image/draw/draw.go.html#5997441">sp</a></span><span class="op" id="5998786">)</span>&nbsp;<span class="op" id="5998788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5998793"><a href="/image/draw/draw.go.html#6010987">drawPaletted</a></span><span class="op" id="5998805">(</span><span class="ident" id="5998806"><a href="/image/draw/draw.go.html#5997686">dst0</a></span><span class="op" id="5998810">,</span>&nbsp;<span class="ident" id="5998812"><a href="/image/draw/draw.go.html#5997405">r</a></span><span class="op" id="5998813">,</span>&nbsp;<span class="ident" id="5998815"><a href="/image/draw/draw.go.html#5997424">src</a></span><span class="op" id="5998818">,</span>&nbsp;<span class="ident" id="5998820"><a href="/image/draw/draw.go.html#5997441">sp</a></span><span class="op" id="5998822">,</span>&nbsp;<span class="builtintype" id="5998824">false</span><span class="op" id="5998829">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5998833">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5998836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5998840">x0</span><span class="op" id="5998842">,</span>&nbsp;<span class="ident" id="5998844">x1</span><span class="op" id="5998846">,</span>&nbsp;<span class="ident" id="5998848">dx</span>&nbsp;<span class="op" id="5998851">:=</span>&nbsp;<span class="ident" id="5998854"><a href="/image/draw/draw.go.html#5997405">r</a></span><span class="op" id="5998855">.</span><span class="ident" id="5998856">Min</span><span class="op" id="5998859">.</span><span class="ident" id="5998860">X</span><span class="op" id="5998861">,</span>&nbsp;<span class="ident" id="5998863"><a href="/image/draw/draw.go.html#5997405">r</a></span><span class="op" id="5998864">.</span><span class="ident" id="5998865">Max</span><span class="op" id="5998868">.</span><span class="ident" id="5998869">X</span><span class="op" id="5998870">,</span>&nbsp;<span class="num" id="5998872">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5998875">y0</span><span class="op" id="5998877">,</span>&nbsp;<span class="ident" id="5998879">y1</span><span class="op" id="5998881">,</span>&nbsp;<span class="ident" id="5998883">dy</span>&nbsp;<span class="op" id="5998886">:=</span>&nbsp;<span class="ident" id="5998889"><a href="/image/draw/draw.go.html#5997405">r</a></span><span class="op" id="5998890">.</span><span class="ident" id="5998891">Min</span><span class="op" id="5998894">.</span><span class="ident" id="5998895">Y</span><span class="op" id="5998896">,</span>&nbsp;<span class="ident" id="5998898"><a href="/image/draw/draw.go.html#5997405">r</a></span><span class="op" id="5998899">.</span><span class="ident" id="5998900">Max</span><span class="op" id="5998903">.</span><span class="ident" id="5998904">Y</span><span class="op" id="5998905">,</span>&nbsp;<span class="num" id="5998907">1</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5998910">if</span>&nbsp;<span class="ident" id="5998913"><a href="/image/draw/draw.go.html#5996799">processBackward</a></span><span class="op" id="5998928">(</span><span class="ident" id="5998929"><a href="/image/draw/draw.go.html#5997394">dst</a></span><span class="op" id="5998932">,</span>&nbsp;<span class="ident" id="5998934"><a href="/image/draw/draw.go.html#5997405">r</a></span><span class="op" id="5998935">,</span>&nbsp;<span class="ident" id="5998937"><a href="/image/draw/draw.go.html#5997424">src</a></span><span class="op" id="5998940">,</span>&nbsp;<span class="ident" id="5998942"><a href="/image/draw/draw.go.html#5997441">sp</a></span><span class="op" id="5998944">)</span>&nbsp;<span class="op" id="5998946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5998950"><a href="/image/draw/draw.go.html#5998840">x0</a></span><span class="op" id="5998952">,</span>&nbsp;<span class="ident" id="5998954"><a href="/image/draw/draw.go.html#5998844">x1</a></span><span class="op" id="5998956">,</span>&nbsp;<span class="ident" id="5998958"><a href="/image/draw/draw.go.html#5998848">dx</a></span>&nbsp;<span class="op" id="5998961">=</span>&nbsp;<span class="ident" id="5998963"><a href="/image/draw/draw.go.html#5998844">x1</a></span><span class="op" id="5998965">-</span><span class="num" id="5998966">1</span><span class="op" id="5998967">,</span>&nbsp;<span class="ident" id="5998969"><a href="/image/draw/draw.go.html#5998840">x0</a></span><span class="op" id="5998971">-</span><span class="num" id="5998972">1</span><span class="op" id="5998973">,</span>&nbsp;<span class="op" id="5998975">-</span><span class="num" id="5998976">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5998980"><a href="/image/draw/draw.go.html#5998875">y0</a></span><span class="op" id="5998982">,</span>&nbsp;<span class="ident" id="5998984"><a href="/image/draw/draw.go.html#5998879">y1</a></span><span class="op" id="5998986">,</span>&nbsp;<span class="ident" id="5998988"><a href="/image/draw/draw.go.html#5998883">dy</a></span>&nbsp;<span class="op" id="5998991">=</span>&nbsp;<span class="ident" id="5998993"><a href="/image/draw/draw.go.html#5998879">y1</a></span><span class="op" id="5998995">-</span><span class="num" id="5998996">1</span><span class="op" id="5998997">,</span>&nbsp;<span class="ident" id="5998999"><a href="/image/draw/draw.go.html#5998875">y0</a></span><span class="op" id="5999001">-</span><span class="num" id="5999002">1</span><span class="op" id="5999003">,</span>&nbsp;<span class="op" id="5999005">-</span><span class="num" id="5999006">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5999009">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5999013">var</span>&nbsp;<span class="ident" id="5999017">out</span>&nbsp;<span class="ident" id="5999021"><a href="/image/draw/draw.go.html#5994644">color</a></span><span class="op" id="5999026">.</span><span class="ident" id="5999027">RGBA64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5999035">sy</span>&nbsp;<span class="op" id="5999038">:=</span>&nbsp;<span class="ident" id="5999041"><a href="/image/draw/draw.go.html#5997441">sp</a></span><span class="op" id="5999043">.</span><span class="ident" id="5999044">Y</span>&nbsp;<span class="op" id="5999046">+</span>&nbsp;<span class="ident" id="5999048"><a href="/image/draw/draw.go.html#5998875">y0</a></span>&nbsp;<span class="op" id="5999051">-</span>&nbsp;<span class="ident" id="5999053"><a href="/image/draw/draw.go.html#5997405">r</a></span><span class="op" id="5999054">.</span><span class="ident" id="5999055">Min</span><span class="op" id="5999058">.</span><span class="ident" id="5999059">Y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5999062">my</span>&nbsp;<span class="op" id="5999065">:=</span>&nbsp;<span class="ident" id="5999068"><a href="/image/draw/draw.go.html#5997475">mp</a></span><span class="op" id="5999070">.</span><span class="ident" id="5999071">Y</span>&nbsp;<span class="op" id="5999073">+</span>&nbsp;<span class="ident" id="5999075"><a href="/image/draw/draw.go.html#5998875">y0</a></span>&nbsp;<span class="op" id="5999078">-</span>&nbsp;<span class="ident" id="5999080"><a href="/image/draw/draw.go.html#5997405">r</a></span><span class="op" id="5999081">.</span><span class="ident" id="5999082">Min</span><span class="op" id="5999085">.</span><span class="ident" id="5999086">Y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5999089">for</span>&nbsp;<span class="ident" id="5999093">y</span>&nbsp;<span class="op" id="5999095">:=</span>&nbsp;<span class="ident" id="5999098"><a href="/image/draw/draw.go.html#5998875">y0</a></span><span class="op" id="5999100">;</span>&nbsp;<span class="ident" id="5999102"><a href="/image/draw/draw.go.html#5999093">y</a></span>&nbsp;<span class="op" id="5999104">!=</span>&nbsp;<span class="ident" id="5999107"><a href="/image/draw/draw.go.html#5998879">y1</a></span><span class="op" id="5999109">;</span>&nbsp;<span class="ident" id="5999111"><a href="/image/draw/draw.go.html#5999093">y</a></span><span class="op" id="5999112">,</span>&nbsp;<span class="ident" id="5999114"><a href="/image/draw/draw.go.html#5999035">sy</a></span><span class="op" id="5999116">,</span>&nbsp;<span class="ident" id="5999118"><a href="/image/draw/draw.go.html#5999062">my</a></span>&nbsp;<span class="op" id="5999121">=</span>&nbsp;<span class="ident" id="5999123"><a href="/image/draw/draw.go.html#5999093">y</a></span><span class="op" id="5999124">+</span><span class="ident" id="5999125"><a href="/image/draw/draw.go.html#5998883">dy</a></span><span class="op" id="5999127">,</span>&nbsp;<span class="ident" id="5999129"><a href="/image/draw/draw.go.html#5999035">sy</a></span><span class="op" id="5999131">+</span><span class="ident" id="5999132"><a href="/image/draw/draw.go.html#5998883">dy</a></span><span class="op" id="5999134">,</span>&nbsp;<span class="ident" id="5999136"><a href="/image/draw/draw.go.html#5999062">my</a></span><span class="op" id="5999138">+</span><span class="ident" id="5999139"><a href="/image/draw/draw.go.html#5998883">dy</a></span>&nbsp;<span class="op" id="5999142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5999146">sx</span>&nbsp;<span class="op" id="5999149">:=</span>&nbsp;<span class="ident" id="5999152"><a href="/image/draw/draw.go.html#5997441">sp</a></span><span class="op" id="5999154">.</span><span class="ident" id="5999155">X</span>&nbsp;<span class="op" id="5999157">+</span>&nbsp;<span class="ident" id="5999159"><a href="/image/draw/draw.go.html#5998840">x0</a></span>&nbsp;<span class="op" id="5999162">-</span>&nbsp;<span class="ident" id="5999164"><a href="/image/draw/draw.go.html#5997405">r</a></span><span class="op" id="5999165">.</span><span class="ident" id="5999166">Min</span><span class="op" id="5999169">.</span><span class="ident" id="5999170">X</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5999174">mx</span>&nbsp;<span class="op" id="5999177">:=</span>&nbsp;<span class="ident" id="5999180"><a href="/image/draw/draw.go.html#5997475">mp</a></span><span class="op" id="5999182">.</span><span class="ident" id="5999183">X</span>&nbsp;<span class="op" id="5999185">+</span>&nbsp;<span class="ident" id="5999187"><a href="/image/draw/draw.go.html#5998840">x0</a></span>&nbsp;<span class="op" id="5999190">-</span>&nbsp;<span class="ident" id="5999192"><a href="/image/draw/draw.go.html#5997405">r</a></span><span class="op" id="5999193">.</span><span class="ident" id="5999194">Min</span><span class="op" id="5999197">.</span><span class="ident" id="5999198">X</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5999202">for</span>&nbsp;<span class="ident" id="5999206">x</span>&nbsp;<span class="op" id="5999208">:=</span>&nbsp;<span class="ident" id="5999211"><a href="/image/draw/draw.go.html#5998840">x0</a></span><span class="op" id="5999213">;</span>&nbsp;<span class="ident" id="5999215"><a href="/image/draw/draw.go.html#5999206">x</a></span>&nbsp;<span class="op" id="5999217">!=</span>&nbsp;<span class="ident" id="5999220"><a href="/image/draw/draw.go.html#5998844">x1</a></span><span class="op" id="5999222">;</span>&nbsp;<span class="ident" id="5999224"><a href="/image/draw/draw.go.html#5999206">x</a></span><span class="op" id="5999225">,</span>&nbsp;<span class="ident" id="5999227"><a href="/image/draw/draw.go.html#5999146">sx</a></span><span class="op" id="5999229">,</span>&nbsp;<span class="ident" id="5999231"><a href="/image/draw/draw.go.html#5999174">mx</a></span>&nbsp;<span class="op" id="5999234">=</span>&nbsp;<span class="ident" id="5999236"><a href="/image/draw/draw.go.html#5999206">x</a></span><span class="op" id="5999237">+</span><span class="ident" id="5999238"><a href="/image/draw/draw.go.html#5998848">dx</a></span><span class="op" id="5999240">,</span>&nbsp;<span class="ident" id="5999242"><a href="/image/draw/draw.go.html#5999146">sx</a></span><span class="op" id="5999244">+</span><span class="ident" id="5999245"><a href="/image/draw/draw.go.html#5998848">dx</a></span><span class="op" id="5999247">,</span>&nbsp;<span class="ident" id="5999249"><a href="/image/draw/draw.go.html#5999174">mx</a></span><span class="op" id="5999251">+</span><span class="ident" id="5999252"><a href="/image/draw/draw.go.html#5998848">dx</a></span>&nbsp;<span class="op" id="5999255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5999260">ma</span>&nbsp;<span class="op" id="5999263">:=</span>&nbsp;<span class="builtintype" id="5999266">uint32</span><span class="op" id="5999272">(</span><span class="ident" id="5999273"><a href="/image/draw/draw.go.html#5994729">m</a></span><span class="op" id="5999274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5999279">if</span>&nbsp;<span class="ident" id="5999282"><a href="/image/draw/draw.go.html#5997457">mask</a></span>&nbsp;<span class="op" id="5999287">!=</span>&nbsp;<span class="ident" id="5999290">nil</span>&nbsp;<span class="op" id="5999294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5999300">_</span><span class="op" id="5999301">,</span>&nbsp;<span class="ident" id="5999303">_</span><span class="op" id="5999304">,</span>&nbsp;<span class="ident" id="5999306">_</span><span class="op" id="5999307">,</span>&nbsp;<span class="ident" id="5999309"><a href="/image/draw/draw.go.html#5999260">ma</a></span>&nbsp;<span class="op" id="5999312">=</span>&nbsp;<span class="ident" id="5999314"><a href="/image/draw/draw.go.html#5997457">mask</a></span><span class="op" id="5999318">.</span><span class="ident" id="5999319">At</span><span class="op" id="5999321">(</span><span class="ident" id="5999322"><a href="/image/draw/draw.go.html#5999174">mx</a></span><span class="op" id="5999324">,</span>&nbsp;<span class="ident" id="5999326"><a href="/image/draw/draw.go.html#5999062">my</a></span><span class="op" id="5999328">)</span><span class="op" id="5999329">.</span><span class="ident" id="5999330">RGBA</span><span class="op" id="5999334">(</span><span class="op" id="5999335">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5999340">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5999345">switch</span>&nbsp;<span class="op" id="5999352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5999357">case</span>&nbsp;<span class="ident" id="5999362"><a href="/image/draw/draw.go.html#5999260">ma</a></span>&nbsp;<span class="op" id="5999365">==</span>&nbsp;<span class="num" id="5999368">0</span><span class="op" id="5999369">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5999375">if</span>&nbsp;<span class="ident" id="5999378"><a href="/image/draw/draw.go.html#5997491">op</a></span>&nbsp;<span class="op" id="5999381">==</span>&nbsp;<span class="ident" id="5999384"><a href="/image/draw/draw.go.html#5995268">Over</a></span>&nbsp;<span class="op" id="5999389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5999396">//&nbsp;No-op.</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5999410">}</span>&nbsp;<span class="keyword" id="5999412">else</span>&nbsp;<span class="op" id="5999417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5999424"><a href="/image/draw/draw.go.html#5997394">dst</a></span><span class="op" id="5999427">.</span><span class="ident" id="5999428">Set</span><span class="op" id="5999431">(</span><span class="ident" id="5999432"><a href="/image/draw/draw.go.html#5999206">x</a></span><span class="op" id="5999433">,</span>&nbsp;<span class="ident" id="5999435"><a href="/image/draw/draw.go.html#5999093">y</a></span><span class="op" id="5999436">,</span>&nbsp;<span class="ident" id="5999438"><a href="/image/draw/draw.go.html#5994644">color</a></span><span class="op" id="5999443">.</span><span class="ident" id="5999444">Transparent</span><span class="op" id="5999455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5999461">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5999466">case</span>&nbsp;<span class="ident" id="5999471"><a href="/image/draw/draw.go.html#5999260">ma</a></span>&nbsp;<span class="op" id="5999474">==</span>&nbsp;<span class="ident" id="5999477"><a href="/image/draw/draw.go.html#5994729">m</a></span>&nbsp;<span class="op" id="5999479">&amp;&amp;</span>&nbsp;<span class="ident" id="5999482"><a href="/image/draw/draw.go.html#5997491">op</a></span>&nbsp;<span class="op" id="5999485">==</span>&nbsp;<span class="ident" id="5999488"><a href="/image/draw/draw.go.html#5995319">Src</a></span><span class="op" id="5999491">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5999497"><a href="/image/draw/draw.go.html#5997394">dst</a></span><span class="op" id="5999500">.</span><span class="ident" id="5999501">Set</span><span class="op" id="5999504">(</span><span class="ident" id="5999505"><a href="/image/draw/draw.go.html#5999206">x</a></span><span class="op" id="5999506">,</span>&nbsp;<span class="ident" id="5999508"><a href="/image/draw/draw.go.html#5999093">y</a></span><span class="op" id="5999509">,</span>&nbsp;<span class="ident" id="5999511"><a href="/image/draw/draw.go.html#5997424">src</a></span><span class="op" id="5999514">.</span><span class="ident" id="5999515">At</span><span class="op" id="5999517">(</span><span class="ident" id="5999518"><a href="/image/draw/draw.go.html#5999146">sx</a></span><span class="op" id="5999520">,</span>&nbsp;<span class="ident" id="5999522"><a href="/image/draw/draw.go.html#5999035">sy</a></span><span class="op" id="5999524">)</span><span class="op" id="5999525">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5999530">default</span><span class="op" id="5999537">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5999543">sr</span><span class="op" id="5999545">,</span>&nbsp;<span class="ident" id="5999547">sg</span><span class="op" id="5999549">,</span>&nbsp;<span class="ident" id="5999551">sb</span><span class="op" id="5999553">,</span>&nbsp;<span class="ident" id="5999555">sa</span>&nbsp;<span class="op" id="5999558">:=</span>&nbsp;<span class="ident" id="5999561"><a href="/image/draw/draw.go.html#5997424">src</a></span><span class="op" id="5999564">.</span><span class="ident" id="5999565">At</span><span class="op" id="5999567">(</span><span class="ident" id="5999568"><a href="/image/draw/draw.go.html#5999146">sx</a></span><span class="op" id="5999570">,</span>&nbsp;<span class="ident" id="5999572"><a href="/image/draw/draw.go.html#5999035">sy</a></span><span class="op" id="5999574">)</span><span class="op" id="5999575">.</span><span class="ident" id="5999576">RGBA</span><span class="op" id="5999580">(</span><span class="op" id="5999581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5999587">if</span>&nbsp;<span class="ident" id="5999590"><a href="/image/draw/draw.go.html#5997491">op</a></span>&nbsp;<span class="op" id="5999593">==</span>&nbsp;<span class="ident" id="5999596"><a href="/image/draw/draw.go.html#5995268">Over</a></span>&nbsp;<span class="op" id="5999601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5999608">dr</span><span class="op" id="5999610">,</span>&nbsp;<span class="ident" id="5999612">dg</span><span class="op" id="5999614">,</span>&nbsp;<span class="ident" id="5999616">db</span><span class="op" id="5999618">,</span>&nbsp;<span class="ident" id="5999620">da</span>&nbsp;<span class="op" id="5999623">:=</span>&nbsp;<span class="ident" id="5999626"><a href="/image/draw/draw.go.html#5997394">dst</a></span><span class="op" id="5999629">.</span><span class="ident" id="5999630">At</span><span class="op" id="5999632">(</span><span class="ident" id="5999633"><a href="/image/draw/draw.go.html#5999206">x</a></span><span class="op" id="5999634">,</span>&nbsp;<span class="ident" id="5999636"><a href="/image/draw/draw.go.html#5999093">y</a></span><span class="op" id="5999637">)</span><span class="op" id="5999638">.</span><span class="ident" id="5999639">RGBA</span><span class="op" id="5999643">(</span><span class="op" id="5999644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5999651">a</span>&nbsp;<span class="op" id="5999653">:=</span>&nbsp;<span class="ident" id="5999656"><a href="/image/draw/draw.go.html#5994729">m</a></span>&nbsp;<span class="op" id="5999658">-</span>&nbsp;<span class="op" id="5999660">(</span><span class="ident" id="5999661"><a href="/image/draw/draw.go.html#5999555">sa</a></span>&nbsp;<span class="op" id="5999664">*</span>&nbsp;<span class="ident" id="5999666"><a href="/image/draw/draw.go.html#5999260">ma</a></span>&nbsp;<span class="op" id="5999669">/</span>&nbsp;<span class="ident" id="5999671"><a href="/image/draw/draw.go.html#5994729">m</a></span><span class="op" id="5999672">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5999679"><a href="/image/draw/draw.go.html#5999017">out</a></span><span class="op" id="5999682">.</span><span class="ident" id="5999683">R</span>&nbsp;<span class="op" id="5999685">=</span>&nbsp;<span class="builtintype" id="5999687">uint16</span><span class="op" id="5999693">(</span><span class="op" id="5999694">(</span><span class="ident" id="5999695"><a href="/image/draw/draw.go.html#5999608">dr</a></span><span class="op" id="5999697">*</span><span class="ident" id="5999698"><a href="/image/draw/draw.go.html#5999651">a</a></span>&nbsp;<span class="op" id="5999700">+</span>&nbsp;<span class="ident" id="5999702"><a href="/image/draw/draw.go.html#5999543">sr</a></span><span class="op" id="5999704">*</span><span class="ident" id="5999705"><a href="/image/draw/draw.go.html#5999260">ma</a></span><span class="op" id="5999707">)</span>&nbsp;<span class="op" id="5999709">/</span>&nbsp;<span class="ident" id="5999711"><a href="/image/draw/draw.go.html#5994729">m</a></span><span class="op" id="5999712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5999719"><a href="/image/draw/draw.go.html#5999017">out</a></span><span class="op" id="5999722">.</span><span class="ident" id="5999723">G</span>&nbsp;<span class="op" id="5999725">=</span>&nbsp;<span class="builtintype" id="5999727">uint16</span><span class="op" id="5999733">(</span><span class="op" id="5999734">(</span><span class="ident" id="5999735"><a href="/image/draw/draw.go.html#5999612">dg</a></span><span class="op" id="5999737">*</span><span class="ident" id="5999738"><a href="/image/draw/draw.go.html#5999651">a</a></span>&nbsp;<span class="op" id="5999740">+</span>&nbsp;<span class="ident" id="5999742"><a href="/image/draw/draw.go.html#5999547">sg</a></span><span class="op" id="5999744">*</span><span class="ident" id="5999745"><a href="/image/draw/draw.go.html#5999260">ma</a></span><span class="op" id="5999747">)</span>&nbsp;<span class="op" id="5999749">/</span>&nbsp;<span class="ident" id="5999751"><a href="/image/draw/draw.go.html#5994729">m</a></span><span class="op" id="5999752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5999759"><a href="/image/draw/draw.go.html#5999017">out</a></span><span class="op" id="5999762">.</span><span class="ident" id="5999763">B</span>&nbsp;<span class="op" id="5999765">=</span>&nbsp;<span class="builtintype" id="5999767">uint16</span><span class="op" id="5999773">(</span><span class="op" id="5999774">(</span><span class="ident" id="5999775"><a href="/image/draw/draw.go.html#5999616">db</a></span><span class="op" id="5999777">*</span><span class="ident" id="5999778"><a href="/image/draw/draw.go.html#5999651">a</a></span>&nbsp;<span class="op" id="5999780">+</span>&nbsp;<span class="ident" id="5999782"><a href="/image/draw/draw.go.html#5999551">sb</a></span><span class="op" id="5999784">*</span><span class="ident" id="5999785"><a href="/image/draw/draw.go.html#5999260">ma</a></span><span class="op" id="5999787">)</span>&nbsp;<span class="op" id="5999789">/</span>&nbsp;<span class="ident" id="5999791"><a href="/image/draw/draw.go.html#5994729">m</a></span><span class="op" id="5999792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5999799"><a href="/image/draw/draw.go.html#5999017">out</a></span><span class="op" id="5999802">.</span><span class="ident" id="5999803">A</span>&nbsp;<span class="op" id="5999805">=</span>&nbsp;<span class="builtintype" id="5999807">uint16</span><span class="op" id="5999813">(</span><span class="op" id="5999814">(</span><span class="ident" id="5999815"><a href="/image/draw/draw.go.html#5999620">da</a></span><span class="op" id="5999817">*</span><span class="ident" id="5999818"><a href="/image/draw/draw.go.html#5999651">a</a></span>&nbsp;<span class="op" id="5999820">+</span>&nbsp;<span class="ident" id="5999822"><a href="/image/draw/draw.go.html#5999555">sa</a></span><span class="op" id="5999824">*</span><span class="ident" id="5999825"><a href="/image/draw/draw.go.html#5999260">ma</a></span><span class="op" id="5999827">)</span>&nbsp;<span class="op" id="5999829">/</span>&nbsp;<span class="ident" id="5999831"><a href="/image/draw/draw.go.html#5994729">m</a></span><span class="op" id="5999832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5999838">}</span>&nbsp;<span class="keyword" id="5999840">else</span>&nbsp;<span class="op" id="5999845">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5999852"><a href="/image/draw/draw.go.html#5999017">out</a></span><span class="op" id="5999855">.</span><span class="ident" id="5999856">R</span>&nbsp;<span class="op" id="5999858">=</span>&nbsp;<span class="builtintype" id="5999860">uint16</span><span class="op" id="5999866">(</span><span class="ident" id="5999867"><a href="/image/draw/draw.go.html#5999543">sr</a></span>&nbsp;<span class="op" id="5999870">*</span>&nbsp;<span class="ident" id="5999872"><a href="/image/draw/draw.go.html#5999260">ma</a></span>&nbsp;<span class="op" id="5999875">/</span>&nbsp;<span class="ident" id="5999877"><a href="/image/draw/draw.go.html#5994729">m</a></span><span class="op" id="5999878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5999885"><a href="/image/draw/draw.go.html#5999017">out</a></span><span class="op" id="5999888">.</span><span class="ident" id="5999889">G</span>&nbsp;<span class="op" id="5999891">=</span>&nbsp;<span class="builtintype" id="5999893">uint16</span><span class="op" id="5999899">(</span><span class="ident" id="5999900"><a href="/image/draw/draw.go.html#5999547">sg</a></span>&nbsp;<span class="op" id="5999903">*</span>&nbsp;<span class="ident" id="5999905"><a href="/image/draw/draw.go.html#5999260">ma</a></span>&nbsp;<span class="op" id="5999908">/</span>&nbsp;<span class="ident" id="5999910"><a href="/image/draw/draw.go.html#5994729">m</a></span><span class="op" id="5999911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5999918"><a href="/image/draw/draw.go.html#5999017">out</a></span><span class="op" id="5999921">.</span><span class="ident" id="5999922">B</span>&nbsp;<span class="op" id="5999924">=</span>&nbsp;<span class="builtintype" id="5999926">uint16</span><span class="op" id="5999932">(</span><span class="ident" id="5999933"><a href="/image/draw/draw.go.html#5999551">sb</a></span>&nbsp;<span class="op" id="5999936">*</span>&nbsp;<span class="ident" id="5999938"><a href="/image/draw/draw.go.html#5999260">ma</a></span>&nbsp;<span class="op" id="5999941">/</span>&nbsp;<span class="ident" id="5999943"><a href="/image/draw/draw.go.html#5994729">m</a></span><span class="op" id="5999944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5999951"><a href="/image/draw/draw.go.html#5999017">out</a></span><span class="op" id="5999954">.</span><span class="ident" id="5999955">A</span>&nbsp;<span class="op" id="5999957">=</span>&nbsp;<span class="builtintype" id="5999959">uint16</span><span class="op" id="5999965">(</span><span class="ident" id="5999966"><a href="/image/draw/draw.go.html#5999555">sa</a></span>&nbsp;<span class="op" id="5999969">*</span>&nbsp;<span class="ident" id="5999971"><a href="/image/draw/draw.go.html#5999260">ma</a></span>&nbsp;<span class="op" id="5999974">/</span>&nbsp;<span class="ident" id="5999976"><a href="/image/draw/draw.go.html#5994729">m</a></span><span class="op" id="5999977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5999983">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5999989">//&nbsp;The&nbsp;third&nbsp;argument&nbsp;is&nbsp;&amp;out&nbsp;instead&nbsp;of&nbsp;out&nbsp;(and&nbsp;out&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6000050">//&nbsp;declared&nbsp;outside&nbsp;of&nbsp;the&nbsp;inner&nbsp;loop)&nbsp;to&nbsp;avoid&nbsp;the&nbsp;implicit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6000115">//&nbsp;conversion&nbsp;to&nbsp;color.Color&nbsp;here&nbsp;allocating&nbsp;memory&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6000178">//&nbsp;inner&nbsp;loop&nbsp;if&nbsp;sizeof(color.RGBA64)&nbsp;&gt;&nbsp;sizeof(uintptr).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6000239"><a href="/image/draw/draw.go.html#5997394">dst</a></span><span class="op" id="6000242">.</span><span class="ident" id="6000243">Set</span><span class="op" id="6000246">(</span><span class="ident" id="6000247"><a href="/image/draw/draw.go.html#5999206">x</a></span><span class="op" id="6000248">,</span>&nbsp;<span class="ident" id="6000250"><a href="/image/draw/draw.go.html#5999093">y</a></span><span class="op" id="6000251">,</span>&nbsp;<span class="op" id="6000253">&amp;</span><span class="ident" id="6000254"><a href="/image/draw/draw.go.html#5999017">out</a></span><span class="op" id="6000257">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6000262">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6000266">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6000269">}</span><br>
<span class="lineno"></span><span class="op" id="6000271">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="keyword" id="6000274">func</span>&nbsp;<span class="ident" id="6000279">drawFillOver</span><span class="op" id="6000291">(</span><span class="ident" id="6000292">dst</span>&nbsp;<span class="op" id="6000296">*</span><span class="ident" id="6000297"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="6000302">.</span><span class="ident" id="6000303">RGBA</span><span class="op" id="6000307">,</span>&nbsp;<span class="ident" id="6000309">r</span>&nbsp;<span class="ident" id="6000311"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="6000316">.</span><span class="ident" id="6000317">Rectangle</span><span class="op" id="6000326">,</span>&nbsp;<span class="ident" id="6000328">src</span>&nbsp;<span class="op" id="6000332">*</span><span class="ident" id="6000333"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="6000338">.</span><span class="ident" id="6000339">Uniform</span><span class="op" id="6000346">)</span>&nbsp;<span class="op" id="6000348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6000351">sr</span><span class="op" id="6000353">,</span>&nbsp;<span class="ident" id="6000355">sg</span><span class="op" id="6000357">,</span>&nbsp;<span class="ident" id="6000359">sb</span><span class="op" id="6000361">,</span>&nbsp;<span class="ident" id="6000363">sa</span>&nbsp;<span class="op" id="6000366">:=</span>&nbsp;<span class="ident" id="6000369"><a href="/image/draw/draw.go.html#6000328">src</a></span><span class="op" id="6000372">.</span><span class="ident" id="6000373">RGBA</span><span class="op" id="6000377">(</span><span class="op" id="6000378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6000381">//&nbsp;The&nbsp;0x101&nbsp;is&nbsp;here&nbsp;for&nbsp;the&nbsp;same&nbsp;reason&nbsp;as&nbsp;in&nbsp;drawRGBA.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6000439">a</span>&nbsp;<span class="op" id="6000441">:=</span>&nbsp;<span class="op" id="6000444">(</span><span class="ident" id="6000445"><a href="/image/draw/draw.go.html#5994729">m</a></span>&nbsp;<span class="op" id="6000447">-</span>&nbsp;<span class="ident" id="6000449"><a href="/image/draw/draw.go.html#6000363">sa</a></span><span class="op" id="6000451">)</span>&nbsp;<span class="op" id="6000453">*</span>&nbsp;<span class="num" id="6000455">0x101</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6000462">i0</span>&nbsp;<span class="op" id="6000465">:=</span>&nbsp;<span class="ident" id="6000468"><a href="/image/draw/draw.go.html#6000292">dst</a></span><span class="op" id="6000471">.</span><span class="ident" id="6000472">PixOffset</span><span class="op" id="6000481">(</span><span class="ident" id="6000482"><a href="/image/draw/draw.go.html#6000309">r</a></span><span class="op" id="6000483">.</span><span class="ident" id="6000484">Min</span><span class="op" id="6000487">.</span><span class="ident" id="6000488">X</span><span class="op" id="6000489">,</span>&nbsp;<span class="ident" id="6000491"><a href="/image/draw/draw.go.html#6000309">r</a></span><span class="op" id="6000492">.</span><span class="ident" id="6000493">Min</span><span class="op" id="6000496">.</span><span class="ident" id="6000497">Y</span><span class="op" id="6000498">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6000501">i1</span>&nbsp;<span class="op" id="6000504">:=</span>&nbsp;<span class="ident" id="6000507"><a href="/image/draw/draw.go.html#6000462">i0</a></span>&nbsp;<span class="op" id="6000510">+</span>&nbsp;<span class="ident" id="6000512"><a href="/image/draw/draw.go.html#6000309">r</a></span><span class="op" id="6000513">.</span><span class="ident" id="6000514">Dx</span><span class="op" id="6000516">(</span><span class="op" id="6000517">)</span><span class="op" id="6000518">*</span><span class="num" id="6000519">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6000522">for</span>&nbsp;<span class="ident" id="6000526">y</span>&nbsp;<span class="op" id="6000528">:=</span>&nbsp;<span class="ident" id="6000531"><a href="/image/draw/draw.go.html#6000309">r</a></span><span class="op" id="6000532">.</span><span class="ident" id="6000533">Min</span><span class="op" id="6000536">.</span><span class="ident" id="6000537">Y</span><span class="op" id="6000538">;</span>&nbsp;<span class="ident" id="6000540"><a href="/image/draw/draw.go.html#6000526">y</a></span>&nbsp;<span class="op" id="6000542">!=</span>&nbsp;<span class="ident" id="6000545"><a href="/image/draw/draw.go.html#6000309">r</a></span><span class="op" id="6000546">.</span><span class="ident" id="6000547">Max</span><span class="op" id="6000550">.</span><span class="ident" id="6000551">Y</span><span class="op" id="6000552">;</span>&nbsp;<span class="ident" id="6000554"><a href="/image/draw/draw.go.html#6000526">y</a></span><span class="op" id="6000555">++</span>&nbsp;<span class="op" id="6000558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6000562">for</span>&nbsp;<span class="ident" id="6000566">i</span>&nbsp;<span class="op" id="6000568">:=</span>&nbsp;<span class="ident" id="6000571"><a href="/image/draw/draw.go.html#6000462">i0</a></span><span class="op" id="6000573">;</span>&nbsp;<span class="ident" id="6000575"><a href="/image/draw/draw.go.html#6000566">i</a></span>&nbsp;<span class="op" id="6000577">&lt;</span>&nbsp;<span class="ident" id="6000579"><a href="/image/draw/draw.go.html#6000501">i1</a></span><span class="op" id="6000581">;</span>&nbsp;<span class="ident" id="6000583"><a href="/image/draw/draw.go.html#6000566">i</a></span>&nbsp;<span class="op" id="6000585">+=</span>&nbsp;<span class="num" id="6000588">4</span>&nbsp;<span class="op" id="6000590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6000595">dr</span>&nbsp;<span class="op" id="6000598">:=</span>&nbsp;<span class="builtintype" id="6000601">uint32</span><span class="op" id="6000607">(</span><span class="ident" id="6000608"><a href="/image/draw/draw.go.html#6000292">dst</a></span><span class="op" id="6000611">.</span><span class="ident" id="6000612">Pix</span><span class="op" id="6000615">[</span><span class="ident" id="6000616"><a href="/image/draw/draw.go.html#6000566">i</a></span><span class="op" id="6000617">+</span><span class="num" id="6000618">0</span><span class="op" id="6000619">]</span><span class="op" id="6000620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6000625">dg</span>&nbsp;<span class="op" id="6000628">:=</span>&nbsp;<span class="builtintype" id="6000631">uint32</span><span class="op" id="6000637">(</span><span class="ident" id="6000638"><a href="/image/draw/draw.go.html#6000292">dst</a></span><span class="op" id="6000641">.</span><span class="ident" id="6000642">Pix</span><span class="op" id="6000645">[</span><span class="ident" id="6000646"><a href="/image/draw/draw.go.html#6000566">i</a></span><span class="op" id="6000647">+</span><span class="num" id="6000648">1</span><span class="op" id="6000649">]</span><span class="op" id="6000650">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6000655">db</span>&nbsp;<span class="op" id="6000658">:=</span>&nbsp;<span class="builtintype" id="6000661">uint32</span><span class="op" id="6000667">(</span><span class="ident" id="6000668"><a href="/image/draw/draw.go.html#6000292">dst</a></span><span class="op" id="6000671">.</span><span class="ident" id="6000672">Pix</span><span class="op" id="6000675">[</span><span class="ident" id="6000676"><a href="/image/draw/draw.go.html#6000566">i</a></span><span class="op" id="6000677">+</span><span class="num" id="6000678">2</span><span class="op" id="6000679">]</span><span class="op" id="6000680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6000685">da</span>&nbsp;<span class="op" id="6000688">:=</span>&nbsp;<span class="builtintype" id="6000691">uint32</span><span class="op" id="6000697">(</span><span class="ident" id="6000698"><a href="/image/draw/draw.go.html#6000292">dst</a></span><span class="op" id="6000701">.</span><span class="ident" id="6000702">Pix</span><span class="op" id="6000705">[</span><span class="ident" id="6000706"><a href="/image/draw/draw.go.html#6000566">i</a></span><span class="op" id="6000707">+</span><span class="num" id="6000708">3</span><span class="op" id="6000709">]</span><span class="op" id="6000710">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6000716"><a href="/image/draw/draw.go.html#6000292">dst</a></span><span class="op" id="6000719">.</span><span class="ident" id="6000720">Pix</span><span class="op" id="6000723">[</span><span class="ident" id="6000724"><a href="/image/draw/draw.go.html#6000566">i</a></span><span class="op" id="6000725">+</span><span class="num" id="6000726">0</span><span class="op" id="6000727">]</span>&nbsp;<span class="op" id="6000729">=</span>&nbsp;<span class="builtintype" id="6000731">uint8</span><span class="op" id="6000736">(</span><span class="op" id="6000737">(</span><span class="ident" id="6000738"><a href="/image/draw/draw.go.html#6000595">dr</a></span><span class="op" id="6000740">*</span><span class="ident" id="6000741"><a href="/image/draw/draw.go.html#6000439">a</a></span><span class="op" id="6000742">/</span><span class="ident" id="6000743"><a href="/image/draw/draw.go.html#5994729">m</a></span>&nbsp;<span class="op" id="6000745">+</span>&nbsp;<span class="ident" id="6000747"><a href="/image/draw/draw.go.html#6000351">sr</a></span><span class="op" id="6000749">)</span>&nbsp;<span class="op" id="6000751">&gt;&gt;</span>&nbsp;<span class="num" id="6000754">8</span><span class="op" id="6000755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6000760"><a href="/image/draw/draw.go.html#6000292">dst</a></span><span class="op" id="6000763">.</span><span class="ident" id="6000764">Pix</span><span class="op" id="6000767">[</span><span class="ident" id="6000768"><a href="/image/draw/draw.go.html#6000566">i</a></span><span class="op" id="6000769">+</span><span class="num" id="6000770">1</span><span class="op" id="6000771">]</span>&nbsp;<span class="op" id="6000773">=</span>&nbsp;<span class="builtintype" id="6000775">uint8</span><span class="op" id="6000780">(</span><span class="op" id="6000781">(</span><span class="ident" id="6000782"><a href="/image/draw/draw.go.html#6000625">dg</a></span><span class="op" id="6000784">*</span><span class="ident" id="6000785"><a href="/image/draw/draw.go.html#6000439">a</a></span><span class="op" id="6000786">/</span><span class="ident" id="6000787"><a href="/image/draw/draw.go.html#5994729">m</a></span>&nbsp;<span class="op" id="6000789">+</span>&nbsp;<span class="ident" id="6000791"><a href="/image/draw/draw.go.html#6000355">sg</a></span><span class="op" id="6000793">)</span>&nbsp;<span class="op" id="6000795">&gt;&gt;</span>&nbsp;<span class="num" id="6000798">8</span><span class="op" id="6000799">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6000804"><a href="/image/draw/draw.go.html#6000292">dst</a></span><span class="op" id="6000807">.</span><span class="ident" id="6000808">Pix</span><span class="op" id="6000811">[</span><span class="ident" id="6000812"><a href="/image/draw/draw.go.html#6000566">i</a></span><span class="op" id="6000813">+</span><span class="num" id="6000814">2</span><span class="op" id="6000815">]</span>&nbsp;<span class="op" id="6000817">=</span>&nbsp;<span class="builtintype" id="6000819">uint8</span><span class="op" id="6000824">(</span><span class="op" id="6000825">(</span><span class="ident" id="6000826"><a href="/image/draw/draw.go.html#6000655">db</a></span><span class="op" id="6000828">*</span><span class="ident" id="6000829"><a href="/image/draw/draw.go.html#6000439">a</a></span><span class="op" id="6000830">/</span><span class="ident" id="6000831"><a href="/image/draw/draw.go.html#5994729">m</a></span>&nbsp;<span class="op" id="6000833">+</span>&nbsp;<span class="ident" id="6000835"><a href="/image/draw/draw.go.html#6000359">sb</a></span><span class="op" id="6000837">)</span>&nbsp;<span class="op" id="6000839">&gt;&gt;</span>&nbsp;<span class="num" id="6000842">8</span><span class="op" id="6000843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6000848"><a href="/image/draw/draw.go.html#6000292">dst</a></span><span class="op" id="6000851">.</span><span class="ident" id="6000852">Pix</span><span class="op" id="6000855">[</span><span class="ident" id="6000856"><a href="/image/draw/draw.go.html#6000566">i</a></span><span class="op" id="6000857">+</span><span class="num" id="6000858">3</span><span class="op" id="6000859">]</span>&nbsp;<span class="op" id="6000861">=</span>&nbsp;<span class="builtintype" id="6000863">uint8</span><span class="op" id="6000868">(</span><span class="op" id="6000869">(</span><span class="ident" id="6000870"><a href="/image/draw/draw.go.html#6000685">da</a></span><span class="op" id="6000872">*</span><span class="ident" id="6000873"><a href="/image/draw/draw.go.html#6000439">a</a></span><span class="op" id="6000874">/</span><span class="ident" id="6000875"><a href="/image/draw/draw.go.html#5994729">m</a></span>&nbsp;<span class="op" id="6000877">+</span>&nbsp;<span class="ident" id="6000879"><a href="/image/draw/draw.go.html#6000363">sa</a></span><span class="op" id="6000881">)</span>&nbsp;<span class="op" id="6000883">&gt;&gt;</span>&nbsp;<span class="num" id="6000886">8</span><span class="op" id="6000887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6000891">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6000895"><a href="/image/draw/draw.go.html#6000462">i0</a></span>&nbsp;<span class="op" id="6000898">+=</span>&nbsp;<span class="ident" id="6000901"><a href="/image/draw/draw.go.html#6000292">dst</a></span><span class="op" id="6000904">.</span><span class="ident" id="6000905">Stride</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6000914"><a href="/image/draw/draw.go.html#6000501">i1</a></span>&nbsp;<span class="op" id="6000917">+=</span>&nbsp;<span class="ident" id="6000920"><a href="/image/draw/draw.go.html#6000292">dst</a></span><span class="op" id="6000923">.</span><span class="ident" id="6000924">Stride</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6000932">}</span><br>
<span class="lineno"></span><span class="op" id="6000934">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6000937">func</span>&nbsp;<span class="ident" id="6000942">drawFillSrc</span><span class="op" id="6000953">(</span><span class="ident" id="6000954">dst</span>&nbsp;<span class="op" id="6000958">*</span><span class="ident" id="6000959"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="6000964">.</span><span class="ident" id="6000965">RGBA</span><span class="op" id="6000969">,</span>&nbsp;<span class="ident" id="6000971">r</span>&nbsp;<span class="ident" id="6000973"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="6000978">.</span><span class="ident" id="6000979">Rectangle</span><span class="op" id="6000988">,</span>&nbsp;<span class="ident" id="6000990">src</span>&nbsp;<span class="op" id="6000994">*</span><span class="ident" id="6000995"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="6001000">.</span><span class="ident" id="6001001">Uniform</span><span class="op" id="6001008">)</span>&nbsp;<span class="op" id="6001010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6001013">sr</span><span class="op" id="6001015">,</span>&nbsp;<span class="ident" id="6001017">sg</span><span class="op" id="6001019">,</span>&nbsp;<span class="ident" id="6001021">sb</span><span class="op" id="6001023">,</span>&nbsp;<span class="ident" id="6001025">sa</span>&nbsp;<span class="op" id="6001028">:=</span>&nbsp;<span class="ident" id="6001031"><a href="/image/draw/draw.go.html#6000990">src</a></span><span class="op" id="6001034">.</span><span class="ident" id="6001035">RGBA</span><span class="op" id="6001039">(</span><span class="op" id="6001040">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6001043">//&nbsp;The&nbsp;built-in&nbsp;copy&nbsp;function&nbsp;is&nbsp;faster&nbsp;than&nbsp;a&nbsp;straightforward&nbsp;for&nbsp;loop&nbsp;to&nbsp;fill&nbsp;the&nbsp;destination&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6001145">//&nbsp;the&nbsp;color,&nbsp;but&nbsp;copy&nbsp;requires&nbsp;a&nbsp;slice&nbsp;source.&nbsp;We&nbsp;therefore&nbsp;use&nbsp;a&nbsp;for&nbsp;loop&nbsp;to&nbsp;fill&nbsp;the&nbsp;first&nbsp;row,&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6001249">//&nbsp;then&nbsp;use&nbsp;the&nbsp;first&nbsp;row&nbsp;as&nbsp;the&nbsp;slice&nbsp;source&nbsp;for&nbsp;the&nbsp;remaining&nbsp;rows.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6001320">i0</span>&nbsp;<span class="op" id="6001323">:=</span>&nbsp;<span class="ident" id="6001326"><a href="/image/draw/draw.go.html#6000954">dst</a></span><span class="op" id="6001329">.</span><span class="ident" id="6001330">PixOffset</span><span class="op" id="6001339">(</span><span class="ident" id="6001340"><a href="/image/draw/draw.go.html#6000971">r</a></span><span class="op" id="6001341">.</span><span class="ident" id="6001342">Min</span><span class="op" id="6001345">.</span><span class="ident" id="6001346">X</span><span class="op" id="6001347">,</span>&nbsp;<span class="ident" id="6001349"><a href="/image/draw/draw.go.html#6000971">r</a></span><span class="op" id="6001350">.</span><span class="ident" id="6001351">Min</span><span class="op" id="6001354">.</span><span class="ident" id="6001355">Y</span><span class="op" id="6001356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6001359">i1</span>&nbsp;<span class="op" id="6001362">:=</span>&nbsp;<span class="ident" id="6001365"><a href="/image/draw/draw.go.html#6001320">i0</a></span>&nbsp;<span class="op" id="6001368">+</span>&nbsp;<span class="ident" id="6001370"><a href="/image/draw/draw.go.html#6000971">r</a></span><span class="op" id="6001371">.</span><span class="ident" id="6001372">Dx</span><span class="op" id="6001374">(</span><span class="op" id="6001375">)</span><span class="op" id="6001376">*</span><span class="num" id="6001377">4</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6001380">for</span>&nbsp;<span class="ident" id="6001384">i</span>&nbsp;<span class="op" id="6001386">:=</span>&nbsp;<span class="ident" id="6001389"><a href="/image/draw/draw.go.html#6001320">i0</a></span><span class="op" id="6001391">;</span>&nbsp;<span class="ident" id="6001393"><a href="/image/draw/draw.go.html#6001384">i</a></span>&nbsp;<span class="op" id="6001395">&lt;</span>&nbsp;<span class="ident" id="6001397"><a href="/image/draw/draw.go.html#6001359">i1</a></span><span class="op" id="6001399">;</span>&nbsp;<span class="ident" id="6001401"><a href="/image/draw/draw.go.html#6001384">i</a></span>&nbsp;<span class="op" id="6001403">+=</span>&nbsp;<span class="num" id="6001406">4</span>&nbsp;<span class="op" id="6001408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6001412"><a href="/image/draw/draw.go.html#6000954">dst</a></span><span class="op" id="6001415">.</span><span class="ident" id="6001416">Pix</span><span class="op" id="6001419">[</span><span class="ident" id="6001420"><a href="/image/draw/draw.go.html#6001384">i</a></span><span class="op" id="6001421">+</span><span class="num" id="6001422">0</span><span class="op" id="6001423">]</span>&nbsp;<span class="op" id="6001425">=</span>&nbsp;<span class="builtintype" id="6001427">uint8</span><span class="op" id="6001432">(</span><span class="ident" id="6001433"><a href="/image/draw/draw.go.html#6001013">sr</a></span>&nbsp;<span class="op" id="6001436">&gt;&gt;</span>&nbsp;<span class="num" id="6001439">8</span><span class="op" id="6001440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6001444"><a href="/image/draw/draw.go.html#6000954">dst</a></span><span class="op" id="6001447">.</span><span class="ident" id="6001448">Pix</span><span class="op" id="6001451">[</span><span class="ident" id="6001452"><a href="/image/draw/draw.go.html#6001384">i</a></span><span class="op" id="6001453">+</span><span class="num" id="6001454">1</span><span class="op" id="6001455">]</span>&nbsp;<span class="op" id="6001457">=</span>&nbsp;<span class="builtintype" id="6001459">uint8</span><span class="op" id="6001464">(</span><span class="ident" id="6001465"><a href="/image/draw/draw.go.html#6001017">sg</a></span>&nbsp;<span class="op" id="6001468">&gt;&gt;</span>&nbsp;<span class="num" id="6001471">8</span><span class="op" id="6001472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6001476"><a href="/image/draw/draw.go.html#6000954">dst</a></span><span class="op" id="6001479">.</span><span class="ident" id="6001480">Pix</span><span class="op" id="6001483">[</span><span class="ident" id="6001484"><a href="/image/draw/draw.go.html#6001384">i</a></span><span class="op" id="6001485">+</span><span class="num" id="6001486">2</span><span class="op" id="6001487">]</span>&nbsp;<span class="op" id="6001489">=</span>&nbsp;<span class="builtintype" id="6001491">uint8</span><span class="op" id="6001496">(</span><span class="ident" id="6001497"><a href="/image/draw/draw.go.html#6001021">sb</a></span>&nbsp;<span class="op" id="6001500">&gt;&gt;</span>&nbsp;<span class="num" id="6001503">8</span><span class="op" id="6001504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6001508"><a href="/image/draw/draw.go.html#6000954">dst</a></span><span class="op" id="6001511">.</span><span class="ident" id="6001512">Pix</span><span class="op" id="6001515">[</span><span class="ident" id="6001516"><a href="/image/draw/draw.go.html#6001384">i</a></span><span class="op" id="6001517">+</span><span class="num" id="6001518">3</span><span class="op" id="6001519">]</span>&nbsp;<span class="op" id="6001521">=</span>&nbsp;<span class="builtintype" id="6001523">uint8</span><span class="op" id="6001528">(</span><span class="ident" id="6001529"><a href="/image/draw/draw.go.html#6001025">sa</a></span>&nbsp;<span class="op" id="6001532">&gt;&gt;</span>&nbsp;<span class="num" id="6001535">8</span><span class="op" id="6001536">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6001539">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6001542">firstRow</span>&nbsp;<span class="op" id="6001551">:=</span>&nbsp;<span class="ident" id="6001554"><a href="/image/draw/draw.go.html#6000954">dst</a></span><span class="op" id="6001557">.</span><span class="ident" id="6001558">Pix</span><span class="op" id="6001561">[</span><span class="ident" id="6001562"><a href="/image/draw/draw.go.html#6001320">i0</a></span><span class="op" id="6001564">:</span><span class="ident" id="6001565"><a href="/image/draw/draw.go.html#6001359">i1</a></span><span class="op" id="6001567">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6001570">for</span>&nbsp;<span class="ident" id="6001574">y</span>&nbsp;<span class="op" id="6001576">:=</span>&nbsp;<span class="ident" id="6001579"><a href="/image/draw/draw.go.html#6000971">r</a></span><span class="op" id="6001580">.</span><span class="ident" id="6001581">Min</span><span class="op" id="6001584">.</span><span class="ident" id="6001585">Y</span>&nbsp;<span class="op" id="6001587">+</span>&nbsp;<span class="num" id="6001589">1</span><span class="op" id="6001590">;</span>&nbsp;<span class="ident" id="6001592"><a href="/image/draw/draw.go.html#6001574">y</a></span>&nbsp;<span class="op" id="6001594">&lt;</span>&nbsp;<span class="ident" id="6001596"><a href="/image/draw/draw.go.html#6000971">r</a></span><span class="op" id="6001597">.</span><span class="ident" id="6001598">Max</span><span class="op" id="6001601">.</span><span class="ident" id="6001602">Y</span><span class="op" id="6001603">;</span>&nbsp;<span class="ident" id="6001605"><a href="/image/draw/draw.go.html#6001574">y</a></span><span class="op" id="6001606">++</span>&nbsp;<span class="op" id="6001609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6001613"><a href="/image/draw/draw.go.html#6001320">i0</a></span>&nbsp;<span class="op" id="6001616">+=</span>&nbsp;<span class="ident" id="6001619"><a href="/image/draw/draw.go.html#6000954">dst</a></span><span class="op" id="6001622">.</span><span class="ident" id="6001623">Stride</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6001632"><a href="/image/draw/draw.go.html#6001359">i1</a></span>&nbsp;<span class="op" id="6001635">+=</span>&nbsp;<span class="ident" id="6001638"><a href="/image/draw/draw.go.html#6000954">dst</a></span><span class="op" id="6001641">.</span><span class="ident" id="6001642">Stride</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6001651">copy</span><span class="op" id="6001655">(</span><span class="ident" id="6001656"><a href="/image/draw/draw.go.html#6000954">dst</a></span><span class="op" id="6001659">.</span><span class="ident" id="6001660">Pix</span><span class="op" id="6001663">[</span><span class="ident" id="6001664"><a href="/image/draw/draw.go.html#6001320">i0</a></span><span class="op" id="6001666">:</span><span class="ident" id="6001667"><a href="/image/draw/draw.go.html#6001359">i1</a></span><span class="op" id="6001669">]</span><span class="op" id="6001670">,</span>&nbsp;<span class="ident" id="6001672"><a href="/image/draw/draw.go.html#6001542">firstRow</a></span><span class="op" id="6001680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6001683">}</span><br>
<span class="lineno"></span><span class="op" id="6001685">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6001688">func</span>&nbsp;<span class="ident" id="6001693">drawCopyOver</span><span class="op" id="6001705">(</span><span class="ident" id="6001706">dst</span>&nbsp;<span class="op" id="6001710">*</span><span class="ident" id="6001711"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="6001716">.</span><span class="ident" id="6001717">RGBA</span><span class="op" id="6001721">,</span>&nbsp;<span class="ident" id="6001723">r</span>&nbsp;<span class="ident" id="6001725"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="6001730">.</span><span class="ident" id="6001731">Rectangle</span><span class="op" id="6001740">,</span>&nbsp;<span class="ident" id="6001742">src</span>&nbsp;<span class="op" id="6001746">*</span><span class="ident" id="6001747"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="6001752">.</span><span class="ident" id="6001753">RGBA</span><span class="op" id="6001757">,</span>&nbsp;<span class="ident" id="6001759">sp</span>&nbsp;<span class="ident" id="6001762"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="6001767">.</span><span class="ident" id="6001768">Point</span><span class="op" id="6001773">)</span>&nbsp;<span class="op" id="6001775">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6001778">dx</span><span class="op" id="6001780">,</span>&nbsp;<span class="ident" id="6001782">dy</span>&nbsp;<span class="op" id="6001785">:=</span>&nbsp;<span class="ident" id="6001788"><a href="/image/draw/draw.go.html#6001723">r</a></span><span class="op" id="6001789">.</span><span class="ident" id="6001790">Dx</span><span class="op" id="6001792">(</span><span class="op" id="6001793">)</span><span class="op" id="6001794">,</span>&nbsp;<span class="ident" id="6001796"><a href="/image/draw/draw.go.html#6001723">r</a></span><span class="op" id="6001797">.</span><span class="ident" id="6001798">Dy</span><span class="op" id="6001800">(</span><span class="op" id="6001801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6001804">d0</span>&nbsp;<span class="op" id="6001807">:=</span>&nbsp;<span class="ident" id="6001810"><a href="/image/draw/draw.go.html#6001706">dst</a></span><span class="op" id="6001813">.</span><span class="ident" id="6001814">PixOffset</span><span class="op" id="6001823">(</span><span class="ident" id="6001824"><a href="/image/draw/draw.go.html#6001723">r</a></span><span class="op" id="6001825">.</span><span class="ident" id="6001826">Min</span><span class="op" id="6001829">.</span><span class="ident" id="6001830">X</span><span class="op" id="6001831">,</span>&nbsp;<span class="ident" id="6001833"><a href="/image/draw/draw.go.html#6001723">r</a></span><span class="op" id="6001834">.</span><span class="ident" id="6001835">Min</span><span class="op" id="6001838">.</span><span class="ident" id="6001839">Y</span><span class="op" id="6001840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6001843">s0</span>&nbsp;<span class="op" id="6001846">:=</span>&nbsp;<span class="ident" id="6001849"><a href="/image/draw/draw.go.html#6001742">src</a></span><span class="op" id="6001852">.</span><span class="ident" id="6001853">PixOffset</span><span class="op" id="6001862">(</span><span class="ident" id="6001863"><a href="/image/draw/draw.go.html#6001759">sp</a></span><span class="op" id="6001865">.</span><span class="ident" id="6001866">X</span><span class="op" id="6001867">,</span>&nbsp;<span class="ident" id="6001869"><a href="/image/draw/draw.go.html#6001759">sp</a></span><span class="op" id="6001871">.</span><span class="ident" id="6001872">Y</span><span class="op" id="6001873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6001876">var</span>&nbsp;<span class="op" id="6001880">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6001884">ddelta</span><span class="op" id="6001890">,</span>&nbsp;<span class="ident" id="6001892">sdelta</span>&nbsp;<span class="builtintype" id="6001899">int</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6001905">i0</span><span class="op" id="6001907">,</span>&nbsp;<span class="ident" id="6001909">i1</span><span class="op" id="6001911">,</span>&nbsp;<span class="ident" id="6001913">idelta</span>&nbsp;<span class="builtintype" id="6001920">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6001925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6001928">if</span>&nbsp;<span class="ident" id="6001931"><a href="/image/draw/draw.go.html#6001723">r</a></span><span class="op" id="6001932">.</span><span class="ident" id="6001933">Min</span><span class="op" id="6001936">.</span><span class="ident" id="6001937">Y</span>&nbsp;<span class="op" id="6001939">&lt;</span>&nbsp;<span class="ident" id="6001941"><a href="/image/draw/draw.go.html#6001759">sp</a></span><span class="op" id="6001943">.</span><span class="ident" id="6001944">Y</span>&nbsp;<span class="op" id="6001946">||</span>&nbsp;<span class="ident" id="6001949"><a href="/image/draw/draw.go.html#6001723">r</a></span><span class="op" id="6001950">.</span><span class="ident" id="6001951">Min</span><span class="op" id="6001954">.</span><span class="ident" id="6001955">Y</span>&nbsp;<span class="op" id="6001957">==</span>&nbsp;<span class="ident" id="6001960"><a href="/image/draw/draw.go.html#6001759">sp</a></span><span class="op" id="6001962">.</span><span class="ident" id="6001963">Y</span>&nbsp;<span class="op" id="6001965">&amp;&amp;</span>&nbsp;<span class="ident" id="6001968"><a href="/image/draw/draw.go.html#6001723">r</a></span><span class="op" id="6001969">.</span><span class="ident" id="6001970">Min</span><span class="op" id="6001973">.</span><span class="ident" id="6001974">X</span>&nbsp;<span class="op" id="6001976">&lt;=</span>&nbsp;<span class="ident" id="6001979"><a href="/image/draw/draw.go.html#6001759">sp</a></span><span class="op" id="6001981">.</span><span class="ident" id="6001982">X</span>&nbsp;<span class="op" id="6001984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6001988"><a href="/image/draw/draw.go.html#6001884">ddelta</a></span>&nbsp;<span class="op" id="6001995">=</span>&nbsp;<span class="ident" id="6001997"><a href="/image/draw/draw.go.html#6001706">dst</a></span><span class="op" id="6002000">.</span><span class="ident" id="6002001">Stride</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6002010"><a href="/image/draw/draw.go.html#6001892">sdelta</a></span>&nbsp;<span class="op" id="6002017">=</span>&nbsp;<span class="ident" id="6002019"><a href="/image/draw/draw.go.html#6001742">src</a></span><span class="op" id="6002022">.</span><span class="ident" id="6002023">Stride</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6002032"><a href="/image/draw/draw.go.html#6001905">i0</a></span><span class="op" id="6002034">,</span>&nbsp;<span class="ident" id="6002036"><a href="/image/draw/draw.go.html#6001909">i1</a></span><span class="op" id="6002038">,</span>&nbsp;<span class="ident" id="6002040"><a href="/image/draw/draw.go.html#6001913">idelta</a></span>&nbsp;<span class="op" id="6002047">=</span>&nbsp;<span class="num" id="6002049">0</span><span class="op" id="6002050">,</span>&nbsp;<span class="ident" id="6002052"><a href="/image/draw/draw.go.html#6001778">dx</a></span><span class="op" id="6002054">*</span><span class="num" id="6002055">4</span><span class="op" id="6002056">,</span>&nbsp;<span class="op" id="6002058">+</span><span class="num" id="6002059">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6002062">}</span>&nbsp;<span class="keyword" id="6002064">else</span>&nbsp;<span class="op" id="6002069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6002073">//&nbsp;If&nbsp;the&nbsp;source&nbsp;start&nbsp;point&nbsp;is&nbsp;higher&nbsp;than&nbsp;the&nbsp;destination&nbsp;start&nbsp;point,&nbsp;or&nbsp;equal&nbsp;height&nbsp;but&nbsp;to&nbsp;the&nbsp;left,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6002181">//&nbsp;then&nbsp;we&nbsp;compose&nbsp;the&nbsp;rows&nbsp;in&nbsp;right-to-left,&nbsp;bottom-up&nbsp;order&nbsp;instead&nbsp;of&nbsp;left-to-right,&nbsp;top-down.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6002281"><a href="/image/draw/draw.go.html#6001804">d0</a></span>&nbsp;<span class="op" id="6002284">+=</span>&nbsp;<span class="op" id="6002287">(</span><span class="ident" id="6002288"><a href="/image/draw/draw.go.html#6001782">dy</a></span>&nbsp;<span class="op" id="6002291">-</span>&nbsp;<span class="num" id="6002293">1</span><span class="op" id="6002294">)</span>&nbsp;<span class="op" id="6002296">*</span>&nbsp;<span class="ident" id="6002298"><a href="/image/draw/draw.go.html#6001706">dst</a></span><span class="op" id="6002301">.</span><span class="ident" id="6002302">Stride</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6002311"><a href="/image/draw/draw.go.html#6001843">s0</a></span>&nbsp;<span class="op" id="6002314">+=</span>&nbsp;<span class="op" id="6002317">(</span><span class="ident" id="6002318"><a href="/image/draw/draw.go.html#6001782">dy</a></span>&nbsp;<span class="op" id="6002321">-</span>&nbsp;<span class="num" id="6002323">1</span><span class="op" id="6002324">)</span>&nbsp;<span class="op" id="6002326">*</span>&nbsp;<span class="ident" id="6002328"><a href="/image/draw/draw.go.html#6001742">src</a></span><span class="op" id="6002331">.</span><span class="ident" id="6002332">Stride</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6002341"><a href="/image/draw/draw.go.html#6001884">ddelta</a></span>&nbsp;<span class="op" id="6002348">=</span>&nbsp;<span class="op" id="6002350">-</span><span class="ident" id="6002351"><a href="/image/draw/draw.go.html#6001706">dst</a></span><span class="op" id="6002354">.</span><span class="ident" id="6002355">Stride</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6002364"><a href="/image/draw/draw.go.html#6001892">sdelta</a></span>&nbsp;<span class="op" id="6002371">=</span>&nbsp;<span class="op" id="6002373">-</span><span class="ident" id="6002374"><a href="/image/draw/draw.go.html#6001742">src</a></span><span class="op" id="6002377">.</span><span class="ident" id="6002378">Stride</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6002387"><a href="/image/draw/draw.go.html#6001905">i0</a></span><span class="op" id="6002389">,</span>&nbsp;<span class="ident" id="6002391"><a href="/image/draw/draw.go.html#6001909">i1</a></span><span class="op" id="6002393">,</span>&nbsp;<span class="ident" id="6002395"><a href="/image/draw/draw.go.html#6001913">idelta</a></span>&nbsp;<span class="op" id="6002402">=</span>&nbsp;<span class="op" id="6002404">(</span><span class="ident" id="6002405"><a href="/image/draw/draw.go.html#6001778">dx</a></span><span class="op" id="6002407">-</span><span class="num" id="6002408">1</span><span class="op" id="6002409">)</span><span class="op" id="6002410">*</span><span class="num" id="6002411">4</span><span class="op" id="6002412">,</span>&nbsp;<span class="op" id="6002414">-</span><span class="num" id="6002415">4</span><span class="op" id="6002416">,</span>&nbsp;<span class="op" id="6002418">-</span><span class="num" id="6002419">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6002422">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6002425">for</span>&nbsp;<span class="op" id="6002429">;</span>&nbsp;<span class="ident" id="6002431"><a href="/image/draw/draw.go.html#6001782">dy</a></span>&nbsp;<span class="op" id="6002434">&gt;</span>&nbsp;<span class="num" id="6002436">0</span><span class="op" id="6002437">;</span>&nbsp;<span class="ident" id="6002439"><a href="/image/draw/draw.go.html#6001782">dy</a></span><span class="op" id="6002441">--</span>&nbsp;<span class="op" id="6002444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6002448">dpix</span>&nbsp;<span class="op" id="6002453">:=</span>&nbsp;<span class="ident" id="6002456"><a href="/image/draw/draw.go.html#6001706">dst</a></span><span class="op" id="6002459">.</span><span class="ident" id="6002460">Pix</span><span class="op" id="6002463">[</span><span class="ident" id="6002464"><a href="/image/draw/draw.go.html#6001804">d0</a></span><span class="op" id="6002466">:</span><span class="op" id="6002467">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6002471">spix</span>&nbsp;<span class="op" id="6002476">:=</span>&nbsp;<span class="ident" id="6002479"><a href="/image/draw/draw.go.html#6001742">src</a></span><span class="op" id="6002482">.</span><span class="ident" id="6002483">Pix</span><span class="op" id="6002486">[</span><span class="ident" id="6002487"><a href="/image/draw/draw.go.html#6001843">s0</a></span><span class="op" id="6002489">:</span><span class="op" id="6002490">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6002494">for</span>&nbsp;<span class="ident" id="6002498">i</span>&nbsp;<span class="op" id="6002500">:=</span>&nbsp;<span class="ident" id="6002503"><a href="/image/draw/draw.go.html#6001905">i0</a></span><span class="op" id="6002505">;</span>&nbsp;<span class="ident" id="6002507"><a href="/image/draw/draw.go.html#6002498">i</a></span>&nbsp;<span class="op" id="6002509">!=</span>&nbsp;<span class="ident" id="6002512"><a href="/image/draw/draw.go.html#6001909">i1</a></span><span class="op" id="6002514">;</span>&nbsp;<span class="ident" id="6002516"><a href="/image/draw/draw.go.html#6002498">i</a></span>&nbsp;<span class="op" id="6002518">+=</span>&nbsp;<span class="ident" id="6002521"><a href="/image/draw/draw.go.html#6001913">idelta</a></span>&nbsp;<span class="op" id="6002528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6002533">sr</span>&nbsp;<span class="op" id="6002536">:=</span>&nbsp;<span class="builtintype" id="6002539">uint32</span><span class="op" id="6002545">(</span><span class="ident" id="6002546"><a href="/image/draw/draw.go.html#6002471">spix</a></span><span class="op" id="6002550">[</span><span class="ident" id="6002551"><a href="/image/draw/draw.go.html#6002498">i</a></span><span class="op" id="6002552">+</span><span class="num" id="6002553">0</span><span class="op" id="6002554">]</span><span class="op" id="6002555">)</span>&nbsp;<span class="op" id="6002557">*</span>&nbsp;<span class="num" id="6002559">0x101</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6002568">sg</span>&nbsp;<span class="op" id="6002571">:=</span>&nbsp;<span class="builtintype" id="6002574">uint32</span><span class="op" id="6002580">(</span><span class="ident" id="6002581"><a href="/image/draw/draw.go.html#6002471">spix</a></span><span class="op" id="6002585">[</span><span class="ident" id="6002586"><a href="/image/draw/draw.go.html#6002498">i</a></span><span class="op" id="6002587">+</span><span class="num" id="6002588">1</span><span class="op" id="6002589">]</span><span class="op" id="6002590">)</span>&nbsp;<span class="op" id="6002592">*</span>&nbsp;<span class="num" id="6002594">0x101</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6002603">sb</span>&nbsp;<span class="op" id="6002606">:=</span>&nbsp;<span class="builtintype" id="6002609">uint32</span><span class="op" id="6002615">(</span><span class="ident" id="6002616"><a href="/image/draw/draw.go.html#6002471">spix</a></span><span class="op" id="6002620">[</span><span class="ident" id="6002621"><a href="/image/draw/draw.go.html#6002498">i</a></span><span class="op" id="6002622">+</span><span class="num" id="6002623">2</span><span class="op" id="6002624">]</span><span class="op" id="6002625">)</span>&nbsp;<span class="op" id="6002627">*</span>&nbsp;<span class="num" id="6002629">0x101</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6002638">sa</span>&nbsp;<span class="op" id="6002641">:=</span>&nbsp;<span class="builtintype" id="6002644">uint32</span><span class="op" id="6002650">(</span><span class="ident" id="6002651"><a href="/image/draw/draw.go.html#6002471">spix</a></span><span class="op" id="6002655">[</span><span class="ident" id="6002656"><a href="/image/draw/draw.go.html#6002498">i</a></span><span class="op" id="6002657">+</span><span class="num" id="6002658">3</span><span class="op" id="6002659">]</span><span class="op" id="6002660">)</span>&nbsp;<span class="op" id="6002662">*</span>&nbsp;<span class="num" id="6002664">0x101</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6002674">dr</span>&nbsp;<span class="op" id="6002677">:=</span>&nbsp;<span class="builtintype" id="6002680">uint32</span><span class="op" id="6002686">(</span><span class="ident" id="6002687"><a href="/image/draw/draw.go.html#6002448">dpix</a></span><span class="op" id="6002691">[</span><span class="ident" id="6002692"><a href="/image/draw/draw.go.html#6002498">i</a></span><span class="op" id="6002693">+</span><span class="num" id="6002694">0</span><span class="op" id="6002695">]</span><span class="op" id="6002696">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6002701">dg</span>&nbsp;<span class="op" id="6002704">:=</span>&nbsp;<span class="builtintype" id="6002707">uint32</span><span class="op" id="6002713">(</span><span class="ident" id="6002714"><a href="/image/draw/draw.go.html#6002448">dpix</a></span><span class="op" id="6002718">[</span><span class="ident" id="6002719"><a href="/image/draw/draw.go.html#6002498">i</a></span><span class="op" id="6002720">+</span><span class="num" id="6002721">1</span><span class="op" id="6002722">]</span><span class="op" id="6002723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6002728">db</span>&nbsp;<span class="op" id="6002731">:=</span>&nbsp;<span class="builtintype" id="6002734">uint32</span><span class="op" id="6002740">(</span><span class="ident" id="6002741"><a href="/image/draw/draw.go.html#6002448">dpix</a></span><span class="op" id="6002745">[</span><span class="ident" id="6002746"><a href="/image/draw/draw.go.html#6002498">i</a></span><span class="op" id="6002747">+</span><span class="num" id="6002748">2</span><span class="op" id="6002749">]</span><span class="op" id="6002750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6002755">da</span>&nbsp;<span class="op" id="6002758">:=</span>&nbsp;<span class="builtintype" id="6002761">uint32</span><span class="op" id="6002767">(</span><span class="ident" id="6002768"><a href="/image/draw/draw.go.html#6002448">dpix</a></span><span class="op" id="6002772">[</span><span class="ident" id="6002773"><a href="/image/draw/draw.go.html#6002498">i</a></span><span class="op" id="6002774">+</span><span class="num" id="6002775">3</span><span class="op" id="6002776">]</span><span class="op" id="6002777">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6002783">//&nbsp;The&nbsp;0x101&nbsp;is&nbsp;here&nbsp;for&nbsp;the&nbsp;same&nbsp;reason&nbsp;as&nbsp;in&nbsp;drawRGBA.</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6002843">a</span>&nbsp;<span class="op" id="6002845">:=</span>&nbsp;<span class="op" id="6002848">(</span><span class="ident" id="6002849"><a href="/image/draw/draw.go.html#5994729">m</a></span>&nbsp;<span class="op" id="6002851">-</span>&nbsp;<span class="ident" id="6002853"><a href="/image/draw/draw.go.html#6002638">sa</a></span><span class="op" id="6002855">)</span>&nbsp;<span class="op" id="6002857">*</span>&nbsp;<span class="num" id="6002859">0x101</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6002869"><a href="/image/draw/draw.go.html#6002448">dpix</a></span><span class="op" id="6002873">[</span><span class="ident" id="6002874"><a href="/image/draw/draw.go.html#6002498">i</a></span><span class="op" id="6002875">+</span><span class="num" id="6002876">0</span><span class="op" id="6002877">]</span>&nbsp;<span class="op" id="6002879">=</span>&nbsp;<span class="builtintype" id="6002881">uint8</span><span class="op" id="6002886">(</span><span class="op" id="6002887">(</span><span class="ident" id="6002888"><a href="/image/draw/draw.go.html#6002674">dr</a></span><span class="op" id="6002890">*</span><span class="ident" id="6002891"><a href="/image/draw/draw.go.html#6002843">a</a></span><span class="op" id="6002892">/</span><span class="ident" id="6002893"><a href="/image/draw/draw.go.html#5994729">m</a></span>&nbsp;<span class="op" id="6002895">+</span>&nbsp;<span class="ident" id="6002897"><a href="/image/draw/draw.go.html#6002533">sr</a></span><span class="op" id="6002899">)</span>&nbsp;<span class="op" id="6002901">&gt;&gt;</span>&nbsp;<span class="num" id="6002904">8</span><span class="op" id="6002905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6002910"><a href="/image/draw/draw.go.html#6002448">dpix</a></span><span class="op" id="6002914">[</span><span class="ident" id="6002915"><a href="/image/draw/draw.go.html#6002498">i</a></span><span class="op" id="6002916">+</span><span class="num" id="6002917">1</span><span class="op" id="6002918">]</span>&nbsp;<span class="op" id="6002920">=</span>&nbsp;<span class="builtintype" id="6002922">uint8</span><span class="op" id="6002927">(</span><span class="op" id="6002928">(</span><span class="ident" id="6002929"><a href="/image/draw/draw.go.html#6002701">dg</a></span><span class="op" id="6002931">*</span><span class="ident" id="6002932"><a href="/image/draw/draw.go.html#6002843">a</a></span><span class="op" id="6002933">/</span><span class="ident" id="6002934"><a href="/image/draw/draw.go.html#5994729">m</a></span>&nbsp;<span class="op" id="6002936">+</span>&nbsp;<span class="ident" id="6002938"><a href="/image/draw/draw.go.html#6002568">sg</a></span><span class="op" id="6002940">)</span>&nbsp;<span class="op" id="6002942">&gt;&gt;</span>&nbsp;<span class="num" id="6002945">8</span><span class="op" id="6002946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6002951"><a href="/image/draw/draw.go.html#6002448">dpix</a></span><span class="op" id="6002955">[</span><span class="ident" id="6002956"><a href="/image/draw/draw.go.html#6002498">i</a></span><span class="op" id="6002957">+</span><span class="num" id="6002958">2</span><span class="op" id="6002959">]</span>&nbsp;<span class="op" id="6002961">=</span>&nbsp;<span class="builtintype" id="6002963">uint8</span><span class="op" id="6002968">(</span><span class="op" id="6002969">(</span><span class="ident" id="6002970"><a href="/image/draw/draw.go.html#6002728">db</a></span><span class="op" id="6002972">*</span><span class="ident" id="6002973"><a href="/image/draw/draw.go.html#6002843">a</a></span><span class="op" id="6002974">/</span><span class="ident" id="6002975"><a href="/image/draw/draw.go.html#5994729">m</a></span>&nbsp;<span class="op" id="6002977">+</span>&nbsp;<span class="ident" id="6002979"><a href="/image/draw/draw.go.html#6002603">sb</a></span><span class="op" id="6002981">)</span>&nbsp;<span class="op" id="6002983">&gt;&gt;</span>&nbsp;<span class="num" id="6002986">8</span><span class="op" id="6002987">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6002992"><a href="/image/draw/draw.go.html#6002448">dpix</a></span><span class="op" id="6002996">[</span><span class="ident" id="6002997"><a href="/image/draw/draw.go.html#6002498">i</a></span><span class="op" id="6002998">+</span><span class="num" id="6002999">3</span><span class="op" id="6003000">]</span>&nbsp;<span class="op" id="6003002">=</span>&nbsp;<span class="builtintype" id="6003004">uint8</span><span class="op" id="6003009">(</span><span class="op" id="6003010">(</span><span class="ident" id="6003011"><a href="/image/draw/draw.go.html#6002755">da</a></span><span class="op" id="6003013">*</span><span class="ident" id="6003014"><a href="/image/draw/draw.go.html#6002843">a</a></span><span class="op" id="6003015">/</span><span class="ident" id="6003016"><a href="/image/draw/draw.go.html#5994729">m</a></span>&nbsp;<span class="op" id="6003018">+</span>&nbsp;<span class="ident" id="6003020"><a href="/image/draw/draw.go.html#6002638">sa</a></span><span class="op" id="6003022">)</span>&nbsp;<span class="op" id="6003024">&gt;&gt;</span>&nbsp;<span class="num" id="6003027">8</span><span class="op" id="6003028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6003032">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6003036"><a href="/image/draw/draw.go.html#6001804">d0</a></span>&nbsp;<span class="op" id="6003039">+=</span>&nbsp;<span class="ident" id="6003042"><a href="/image/draw/draw.go.html#6001884">ddelta</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6003051"><a href="/image/draw/draw.go.html#6001843">s0</a></span>&nbsp;<span class="op" id="6003054">+=</span>&nbsp;<span class="ident" id="6003057"><a href="/image/draw/draw.go.html#6001892">sdelta</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6003065">}</span><br>
<span class="lineno">305</span><span class="op" id="6003067">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6003070">func</span>&nbsp;<span class="ident" id="6003075">drawCopySrc</span><span class="op" id="6003086">(</span><span class="ident" id="6003087">dst</span>&nbsp;<span class="op" id="6003091">*</span><span class="ident" id="6003092"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="6003097">.</span><span class="ident" id="6003098">RGBA</span><span class="op" id="6003102">,</span>&nbsp;<span class="ident" id="6003104">r</span>&nbsp;<span class="ident" id="6003106"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="6003111">.</span><span class="ident" id="6003112">Rectangle</span><span class="op" id="6003121">,</span>&nbsp;<span class="ident" id="6003123">src</span>&nbsp;<span class="op" id="6003127">*</span><span class="ident" id="6003128"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="6003133">.</span><span class="ident" id="6003134">RGBA</span><span class="op" id="6003138">,</span>&nbsp;<span class="ident" id="6003140">sp</span>&nbsp;<span class="ident" id="6003143"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="6003148">.</span><span class="ident" id="6003149">Point</span><span class="op" id="6003154">)</span>&nbsp;<span class="op" id="6003156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6003159">n</span><span class="op" id="6003160">,</span>&nbsp;<span class="ident" id="6003162">dy</span>&nbsp;<span class="op" id="6003165">:=</span>&nbsp;<span class="num" id="6003168">4</span><span class="op" id="6003169">*</span><span class="ident" id="6003170"><a href="/image/draw/draw.go.html#6003104">r</a></span><span class="op" id="6003171">.</span><span class="ident" id="6003172">Dx</span><span class="op" id="6003174">(</span><span class="op" id="6003175">)</span><span class="op" id="6003176">,</span>&nbsp;<span class="ident" id="6003178"><a href="/image/draw/draw.go.html#6003104">r</a></span><span class="op" id="6003179">.</span><span class="ident" id="6003180">Dy</span><span class="op" id="6003182">(</span><span class="op" id="6003183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6003186">d0</span>&nbsp;<span class="op" id="6003189">:=</span>&nbsp;<span class="ident" id="6003192"><a href="/image/draw/draw.go.html#6003087">dst</a></span><span class="op" id="6003195">.</span><span class="ident" id="6003196">PixOffset</span><span class="op" id="6003205">(</span><span class="ident" id="6003206"><a href="/image/draw/draw.go.html#6003104">r</a></span><span class="op" id="6003207">.</span><span class="ident" id="6003208">Min</span><span class="op" id="6003211">.</span><span class="ident" id="6003212">X</span><span class="op" id="6003213">,</span>&nbsp;<span class="ident" id="6003215"><a href="/image/draw/draw.go.html#6003104">r</a></span><span class="op" id="6003216">.</span><span class="ident" id="6003217">Min</span><span class="op" id="6003220">.</span><span class="ident" id="6003221">Y</span><span class="op" id="6003222">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6003225">s0</span>&nbsp;<span class="op" id="6003228">:=</span>&nbsp;<span class="ident" id="6003231"><a href="/image/draw/draw.go.html#6003123">src</a></span><span class="op" id="6003234">.</span><span class="ident" id="6003235">PixOffset</span><span class="op" id="6003244">(</span><span class="ident" id="6003245"><a href="/image/draw/draw.go.html#6003140">sp</a></span><span class="op" id="6003247">.</span><span class="ident" id="6003248">X</span><span class="op" id="6003249">,</span>&nbsp;<span class="ident" id="6003251"><a href="/image/draw/draw.go.html#6003140">sp</a></span><span class="op" id="6003253">.</span><span class="ident" id="6003254">Y</span><span class="op" id="6003255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6003258">var</span>&nbsp;<span class="ident" id="6003262">ddelta</span><span class="op" id="6003268">,</span>&nbsp;<span class="ident" id="6003270">sdelta</span>&nbsp;<span class="builtintype" id="6003277">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6003282">if</span>&nbsp;<span class="ident" id="6003285"><a href="/image/draw/draw.go.html#6003104">r</a></span><span class="op" id="6003286">.</span><span class="ident" id="6003287">Min</span><span class="op" id="6003290">.</span><span class="ident" id="6003291">Y</span>&nbsp;<span class="op" id="6003293">&lt;=</span>&nbsp;<span class="ident" id="6003296"><a href="/image/draw/draw.go.html#6003140">sp</a></span><span class="op" id="6003298">.</span><span class="ident" id="6003299">Y</span>&nbsp;<span class="op" id="6003301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6003305"><a href="/image/draw/draw.go.html#6003262">ddelta</a></span>&nbsp;<span class="op" id="6003312">=</span>&nbsp;<span class="ident" id="6003314"><a href="/image/draw/draw.go.html#6003087">dst</a></span><span class="op" id="6003317">.</span><span class="ident" id="6003318">Stride</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6003327"><a href="/image/draw/draw.go.html#6003270">sdelta</a></span>&nbsp;<span class="op" id="6003334">=</span>&nbsp;<span class="ident" id="6003336"><a href="/image/draw/draw.go.html#6003123">src</a></span><span class="op" id="6003339">.</span><span class="ident" id="6003340">Stride</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6003348">}</span>&nbsp;<span class="keyword" id="6003350">else</span>&nbsp;<span class="op" id="6003355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6003359">//&nbsp;If&nbsp;the&nbsp;source&nbsp;start&nbsp;point&nbsp;is&nbsp;higher&nbsp;than&nbsp;the&nbsp;destination&nbsp;start&nbsp;point,&nbsp;then&nbsp;we&nbsp;compose&nbsp;the&nbsp;rows</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6003459">//&nbsp;in&nbsp;bottom-up&nbsp;order&nbsp;instead&nbsp;of&nbsp;top-down.&nbsp;Unlike&nbsp;the&nbsp;drawCopyOver&nbsp;function,&nbsp;we&nbsp;don&#39;t&nbsp;have&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6003555">//&nbsp;check&nbsp;the&nbsp;x&nbsp;co-ordinates&nbsp;because&nbsp;the&nbsp;built-in&nbsp;copy&nbsp;function&nbsp;can&nbsp;handle&nbsp;overlapping&nbsp;slices.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6003651"><a href="/image/draw/draw.go.html#6003186">d0</a></span>&nbsp;<span class="op" id="6003654">+=</span>&nbsp;<span class="op" id="6003657">(</span><span class="ident" id="6003658"><a href="/image/draw/draw.go.html#6003162">dy</a></span>&nbsp;<span class="op" id="6003661">-</span>&nbsp;<span class="num" id="6003663">1</span><span class="op" id="6003664">)</span>&nbsp;<span class="op" id="6003666">*</span>&nbsp;<span class="ident" id="6003668"><a href="/image/draw/draw.go.html#6003087">dst</a></span><span class="op" id="6003671">.</span><span class="ident" id="6003672">Stride</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6003681"><a href="/image/draw/draw.go.html#6003225">s0</a></span>&nbsp;<span class="op" id="6003684">+=</span>&nbsp;<span class="op" id="6003687">(</span><span class="ident" id="6003688"><a href="/image/draw/draw.go.html#6003162">dy</a></span>&nbsp;<span class="op" id="6003691">-</span>&nbsp;<span class="num" id="6003693">1</span><span class="op" id="6003694">)</span>&nbsp;<span class="op" id="6003696">*</span>&nbsp;<span class="ident" id="6003698"><a href="/image/draw/draw.go.html#6003123">src</a></span><span class="op" id="6003701">.</span><span class="ident" id="6003702">Stride</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6003711"><a href="/image/draw/draw.go.html#6003262">ddelta</a></span>&nbsp;<span class="op" id="6003718">=</span>&nbsp;<span class="op" id="6003720">-</span><span class="ident" id="6003721"><a href="/image/draw/draw.go.html#6003087">dst</a></span><span class="op" id="6003724">.</span><span class="ident" id="6003725">Stride</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6003734"><a href="/image/draw/draw.go.html#6003270">sdelta</a></span>&nbsp;<span class="op" id="6003741">=</span>&nbsp;<span class="op" id="6003743">-</span><span class="ident" id="6003744"><a href="/image/draw/draw.go.html#6003123">src</a></span><span class="op" id="6003747">.</span><span class="ident" id="6003748">Stride</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6003756">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6003759">for</span>&nbsp;<span class="op" id="6003763">;</span>&nbsp;<span class="ident" id="6003765"><a href="/image/draw/draw.go.html#6003162">dy</a></span>&nbsp;<span class="op" id="6003768">&gt;</span>&nbsp;<span class="num" id="6003770">0</span><span class="op" id="6003771">;</span>&nbsp;<span class="ident" id="6003773"><a href="/image/draw/draw.go.html#6003162">dy</a></span><span class="op" id="6003775">--</span>&nbsp;<span class="op" id="6003778">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6003782">copy</span><span class="op" id="6003786">(</span><span class="ident" id="6003787"><a href="/image/draw/draw.go.html#6003087">dst</a></span><span class="op" id="6003790">.</span><span class="ident" id="6003791">Pix</span><span class="op" id="6003794">[</span><span class="ident" id="6003795"><a href="/image/draw/draw.go.html#6003186">d0</a></span><span class="op" id="6003797">:</span><span class="ident" id="6003798"><a href="/image/draw/draw.go.html#6003186">d0</a></span><span class="op" id="6003800">+</span><span class="ident" id="6003801"><a href="/image/draw/draw.go.html#6003159">n</a></span><span class="op" id="6003802">]</span><span class="op" id="6003803">,</span>&nbsp;<span class="ident" id="6003805"><a href="/image/draw/draw.go.html#6003123">src</a></span><span class="op" id="6003808">.</span><span class="ident" id="6003809">Pix</span><span class="op" id="6003812">[</span><span class="ident" id="6003813"><a href="/image/draw/draw.go.html#6003225">s0</a></span><span class="op" id="6003815">:</span><span class="ident" id="6003816"><a href="/image/draw/draw.go.html#6003225">s0</a></span><span class="op" id="6003818">+</span><span class="ident" id="6003819"><a href="/image/draw/draw.go.html#6003159">n</a></span><span class="op" id="6003820">]</span><span class="op" id="6003821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6003825"><a href="/image/draw/draw.go.html#6003186">d0</a></span>&nbsp;<span class="op" id="6003828">+=</span>&nbsp;<span class="ident" id="6003831"><a href="/image/draw/draw.go.html#6003262">ddelta</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6003840"><a href="/image/draw/draw.go.html#6003225">s0</a></span>&nbsp;<span class="op" id="6003843">+=</span>&nbsp;<span class="ident" id="6003846"><a href="/image/draw/draw.go.html#6003270">sdelta</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6003854">}</span><br>
<span class="lineno"></span><span class="op" id="6003856">}</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span><span class="keyword" id="6003859">func</span>&nbsp;<span class="ident" id="6003864">drawNRGBAOver</span><span class="op" id="6003877">(</span><span class="ident" id="6003878">dst</span>&nbsp;<span class="op" id="6003882">*</span><span class="ident" id="6003883"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="6003888">.</span><span class="ident" id="6003889">RGBA</span><span class="op" id="6003893">,</span>&nbsp;<span class="ident" id="6003895">r</span>&nbsp;<span class="ident" id="6003897"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="6003902">.</span><span class="ident" id="6003903">Rectangle</span><span class="op" id="6003912">,</span>&nbsp;<span class="ident" id="6003914">src</span>&nbsp;<span class="op" id="6003918">*</span><span class="ident" id="6003919"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="6003924">.</span><span class="ident" id="6003925">NRGBA</span><span class="op" id="6003930">,</span>&nbsp;<span class="ident" id="6003932">sp</span>&nbsp;<span class="ident" id="6003935"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="6003940">.</span><span class="ident" id="6003941">Point</span><span class="op" id="6003946">)</span>&nbsp;<span class="op" id="6003948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6003951">i0</span>&nbsp;<span class="op" id="6003954">:=</span>&nbsp;<span class="op" id="6003957">(</span><span class="ident" id="6003958"><a href="/image/draw/draw.go.html#6003895">r</a></span><span class="op" id="6003959">.</span><span class="ident" id="6003960">Min</span><span class="op" id="6003963">.</span><span class="ident" id="6003964">X</span>&nbsp;<span class="op" id="6003966">-</span>&nbsp;<span class="ident" id="6003968"><a href="/image/draw/draw.go.html#6003878">dst</a></span><span class="op" id="6003971">.</span><span class="ident" id="6003972">Rect</span><span class="op" id="6003976">.</span><span class="ident" id="6003977">Min</span><span class="op" id="6003980">.</span><span class="ident" id="6003981">X</span><span class="op" id="6003982">)</span>&nbsp;<span class="op" id="6003984">*</span>&nbsp;<span class="num" id="6003986">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6003989">i1</span>&nbsp;<span class="op" id="6003992">:=</span>&nbsp;<span class="op" id="6003995">(</span><span class="ident" id="6003996"><a href="/image/draw/draw.go.html#6003895">r</a></span><span class="op" id="6003997">.</span><span class="ident" id="6003998">Max</span><span class="op" id="6004001">.</span><span class="ident" id="6004002">X</span>&nbsp;<span class="op" id="6004004">-</span>&nbsp;<span class="ident" id="6004006"><a href="/image/draw/draw.go.html#6003878">dst</a></span><span class="op" id="6004009">.</span><span class="ident" id="6004010">Rect</span><span class="op" id="6004014">.</span><span class="ident" id="6004015">Min</span><span class="op" id="6004018">.</span><span class="ident" id="6004019">X</span><span class="op" id="6004020">)</span>&nbsp;<span class="op" id="6004022">*</span>&nbsp;<span class="num" id="6004024">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6004027">si0</span>&nbsp;<span class="op" id="6004031">:=</span>&nbsp;<span class="op" id="6004034">(</span><span class="ident" id="6004035"><a href="/image/draw/draw.go.html#6003932">sp</a></span><span class="op" id="6004037">.</span><span class="ident" id="6004038">X</span>&nbsp;<span class="op" id="6004040">-</span>&nbsp;<span class="ident" id="6004042"><a href="/image/draw/draw.go.html#6003914">src</a></span><span class="op" id="6004045">.</span><span class="ident" id="6004046">Rect</span><span class="op" id="6004050">.</span><span class="ident" id="6004051">Min</span><span class="op" id="6004054">.</span><span class="ident" id="6004055">X</span><span class="op" id="6004056">)</span>&nbsp;<span class="op" id="6004058">*</span>&nbsp;<span class="num" id="6004060">4</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6004063">yMax</span>&nbsp;<span class="op" id="6004068">:=</span>&nbsp;<span class="ident" id="6004071"><a href="/image/draw/draw.go.html#6003895">r</a></span><span class="op" id="6004072">.</span><span class="ident" id="6004073">Max</span><span class="op" id="6004076">.</span><span class="ident" id="6004077">Y</span>&nbsp;<span class="op" id="6004079">-</span>&nbsp;<span class="ident" id="6004081"><a href="/image/draw/draw.go.html#6003878">dst</a></span><span class="op" id="6004084">.</span><span class="ident" id="6004085">Rect</span><span class="op" id="6004089">.</span><span class="ident" id="6004090">Min</span><span class="op" id="6004093">.</span><span class="ident" id="6004094">Y</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6004098">y</span>&nbsp;<span class="op" id="6004100">:=</span>&nbsp;<span class="ident" id="6004103"><a href="/image/draw/draw.go.html#6003895">r</a></span><span class="op" id="6004104">.</span><span class="ident" id="6004105">Min</span><span class="op" id="6004108">.</span><span class="ident" id="6004109">Y</span>&nbsp;<span class="op" id="6004111">-</span>&nbsp;<span class="ident" id="6004113"><a href="/image/draw/draw.go.html#6003878">dst</a></span><span class="op" id="6004116">.</span><span class="ident" id="6004117">Rect</span><span class="op" id="6004121">.</span><span class="ident" id="6004122">Min</span><span class="op" id="6004125">.</span><span class="ident" id="6004126">Y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6004129">sy</span>&nbsp;<span class="op" id="6004132">:=</span>&nbsp;<span class="ident" id="6004135"><a href="/image/draw/draw.go.html#6003932">sp</a></span><span class="op" id="6004137">.</span><span class="ident" id="6004138">Y</span>&nbsp;<span class="op" id="6004140">-</span>&nbsp;<span class="ident" id="6004142"><a href="/image/draw/draw.go.html#6003914">src</a></span><span class="op" id="6004145">.</span><span class="ident" id="6004146">Rect</span><span class="op" id="6004150">.</span><span class="ident" id="6004151">Min</span><span class="op" id="6004154">.</span><span class="ident" id="6004155">Y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6004158">for</span>&nbsp;<span class="op" id="6004162">;</span>&nbsp;<span class="ident" id="6004164"><a href="/image/draw/draw.go.html#6004098">y</a></span>&nbsp;<span class="op" id="6004166">!=</span>&nbsp;<span class="ident" id="6004169"><a href="/image/draw/draw.go.html#6004063">yMax</a></span><span class="op" id="6004173">;</span>&nbsp;<span class="ident" id="6004175"><a href="/image/draw/draw.go.html#6004098">y</a></span><span class="op" id="6004176">,</span>&nbsp;<span class="ident" id="6004178"><a href="/image/draw/draw.go.html#6004129">sy</a></span>&nbsp;<span class="op" id="6004181">=</span>&nbsp;<span class="ident" id="6004183"><a href="/image/draw/draw.go.html#6004098">y</a></span><span class="op" id="6004184">+</span><span class="num" id="6004185">1</span><span class="op" id="6004186">,</span>&nbsp;<span class="ident" id="6004188"><a href="/image/draw/draw.go.html#6004129">sy</a></span><span class="op" id="6004190">+</span><span class="num" id="6004191">1</span>&nbsp;<span class="op" id="6004193">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6004197">dpix</span>&nbsp;<span class="op" id="6004202">:=</span>&nbsp;<span class="ident" id="6004205"><a href="/image/draw/draw.go.html#6003878">dst</a></span><span class="op" id="6004208">.</span><span class="ident" id="6004209">Pix</span><span class="op" id="6004212">[</span><span class="ident" id="6004213"><a href="/image/draw/draw.go.html#6004098">y</a></span><span class="op" id="6004214">*</span><span class="ident" id="6004215"><a href="/image/draw/draw.go.html#6003878">dst</a></span><span class="op" id="6004218">.</span><span class="ident" id="6004219">Stride</span><span class="op" id="6004225">:</span><span class="op" id="6004226">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6004230">spix</span>&nbsp;<span class="op" id="6004235">:=</span>&nbsp;<span class="ident" id="6004238"><a href="/image/draw/draw.go.html#6003914">src</a></span><span class="op" id="6004241">.</span><span class="ident" id="6004242">Pix</span><span class="op" id="6004245">[</span><span class="ident" id="6004246"><a href="/image/draw/draw.go.html#6004129">sy</a></span><span class="op" id="6004248">*</span><span class="ident" id="6004249"><a href="/image/draw/draw.go.html#6003914">src</a></span><span class="op" id="6004252">.</span><span class="ident" id="6004253">Stride</span><span class="op" id="6004259">:</span><span class="op" id="6004260">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6004265">for</span>&nbsp;<span class="ident" id="6004269">i</span><span class="op" id="6004270">,</span>&nbsp;<span class="ident" id="6004272">si</span>&nbsp;<span class="op" id="6004275">:=</span>&nbsp;<span class="ident" id="6004278"><a href="/image/draw/draw.go.html#6003951">i0</a></span><span class="op" id="6004280">,</span>&nbsp;<span class="ident" id="6004282"><a href="/image/draw/draw.go.html#6004027">si0</a></span><span class="op" id="6004285">;</span>&nbsp;<span class="ident" id="6004287"><a href="/image/draw/draw.go.html#6004269">i</a></span>&nbsp;<span class="op" id="6004289">&lt;</span>&nbsp;<span class="ident" id="6004291"><a href="/image/draw/draw.go.html#6003989">i1</a></span><span class="op" id="6004293">;</span>&nbsp;<span class="ident" id="6004295"><a href="/image/draw/draw.go.html#6004269">i</a></span><span class="op" id="6004296">,</span>&nbsp;<span class="ident" id="6004298"><a href="/image/draw/draw.go.html#6004272">si</a></span>&nbsp;<span class="op" id="6004301">=</span>&nbsp;<span class="ident" id="6004303"><a href="/image/draw/draw.go.html#6004269">i</a></span><span class="op" id="6004304">+</span><span class="num" id="6004305">4</span><span class="op" id="6004306">,</span>&nbsp;<span class="ident" id="6004308"><a href="/image/draw/draw.go.html#6004272">si</a></span><span class="op" id="6004310">+</span><span class="num" id="6004311">4</span>&nbsp;<span class="op" id="6004313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6004318">//&nbsp;Convert&nbsp;from&nbsp;non-premultiplied&nbsp;color&nbsp;to&nbsp;pre-multiplied&nbsp;color.</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6004386">sa</span>&nbsp;<span class="op" id="6004389">:=</span>&nbsp;<span class="builtintype" id="6004392">uint32</span><span class="op" id="6004398">(</span><span class="ident" id="6004399"><a href="/image/draw/draw.go.html#6004230">spix</a></span><span class="op" id="6004403">[</span><span class="ident" id="6004404"><a href="/image/draw/draw.go.html#6004272">si</a></span><span class="op" id="6004406">+</span><span class="num" id="6004407">3</span><span class="op" id="6004408">]</span><span class="op" id="6004409">)</span>&nbsp;<span class="op" id="6004411">*</span>&nbsp;<span class="num" id="6004413">0x101</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6004422">sr</span>&nbsp;<span class="op" id="6004425">:=</span>&nbsp;<span class="builtintype" id="6004428">uint32</span><span class="op" id="6004434">(</span><span class="ident" id="6004435"><a href="/image/draw/draw.go.html#6004230">spix</a></span><span class="op" id="6004439">[</span><span class="ident" id="6004440"><a href="/image/draw/draw.go.html#6004272">si</a></span><span class="op" id="6004442">+</span><span class="num" id="6004443">0</span><span class="op" id="6004444">]</span><span class="op" id="6004445">)</span>&nbsp;<span class="op" id="6004447">*</span>&nbsp;<span class="ident" id="6004449"><a href="/image/draw/draw.go.html#6004386">sa</a></span>&nbsp;<span class="op" id="6004452">/</span>&nbsp;<span class="num" id="6004454">0xff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6004462">sg</span>&nbsp;<span class="op" id="6004465">:=</span>&nbsp;<span class="builtintype" id="6004468">uint32</span><span class="op" id="6004474">(</span><span class="ident" id="6004475"><a href="/image/draw/draw.go.html#6004230">spix</a></span><span class="op" id="6004479">[</span><span class="ident" id="6004480"><a href="/image/draw/draw.go.html#6004272">si</a></span><span class="op" id="6004482">+</span><span class="num" id="6004483">1</span><span class="op" id="6004484">]</span><span class="op" id="6004485">)</span>&nbsp;<span class="op" id="6004487">*</span>&nbsp;<span class="ident" id="6004489"><a href="/image/draw/draw.go.html#6004386">sa</a></span>&nbsp;<span class="op" id="6004492">/</span>&nbsp;<span class="num" id="6004494">0xff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6004502">sb</span>&nbsp;<span class="op" id="6004505">:=</span>&nbsp;<span class="builtintype" id="6004508">uint32</span><span class="op" id="6004514">(</span><span class="ident" id="6004515"><a href="/image/draw/draw.go.html#6004230">spix</a></span><span class="op" id="6004519">[</span><span class="ident" id="6004520"><a href="/image/draw/draw.go.html#6004272">si</a></span><span class="op" id="6004522">+</span><span class="num" id="6004523">2</span><span class="op" id="6004524">]</span><span class="op" id="6004525">)</span>&nbsp;<span class="op" id="6004527">*</span>&nbsp;<span class="ident" id="6004529"><a href="/image/draw/draw.go.html#6004386">sa</a></span>&nbsp;<span class="op" id="6004532">/</span>&nbsp;<span class="num" id="6004534">0xff</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6004543">dr</span>&nbsp;<span class="op" id="6004546">:=</span>&nbsp;<span class="builtintype" id="6004549">uint32</span><span class="op" id="6004555">(</span><span class="ident" id="6004556"><a href="/image/draw/draw.go.html#6004197">dpix</a></span><span class="op" id="6004560">[</span><span class="ident" id="6004561"><a href="/image/draw/draw.go.html#6004269">i</a></span><span class="op" id="6004562">+</span><span class="num" id="6004563">0</span><span class="op" id="6004564">]</span><span class="op" id="6004565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6004570">dg</span>&nbsp;<span class="op" id="6004573">:=</span>&nbsp;<span class="builtintype" id="6004576">uint32</span><span class="op" id="6004582">(</span><span class="ident" id="6004583"><a href="/image/draw/draw.go.html#6004197">dpix</a></span><span class="op" id="6004587">[</span><span class="ident" id="6004588"><a href="/image/draw/draw.go.html#6004269">i</a></span><span class="op" id="6004589">+</span><span class="num" id="6004590">1</span><span class="op" id="6004591">]</span><span class="op" id="6004592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6004597">db</span>&nbsp;<span class="op" id="6004600">:=</span>&nbsp;<span class="builtintype" id="6004603">uint32</span><span class="op" id="6004609">(</span><span class="ident" id="6004610"><a href="/image/draw/draw.go.html#6004197">dpix</a></span><span class="op" id="6004614">[</span><span class="ident" id="6004615"><a href="/image/draw/draw.go.html#6004269">i</a></span><span class="op" id="6004616">+</span><span class="num" id="6004617">2</span><span class="op" id="6004618">]</span><span class="op" id="6004619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6004624">da</span>&nbsp;<span class="op" id="6004627">:=</span>&nbsp;<span class="builtintype" id="6004630">uint32</span><span class="op" id="6004636">(</span><span class="ident" id="6004637"><a href="/image/draw/draw.go.html#6004197">dpix</a></span><span class="op" id="6004641">[</span><span class="ident" id="6004642"><a href="/image/draw/draw.go.html#6004269">i</a></span><span class="op" id="6004643">+</span><span class="num" id="6004644">3</span><span class="op" id="6004645">]</span><span class="op" id="6004646">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6004652">//&nbsp;The&nbsp;0x101&nbsp;is&nbsp;here&nbsp;for&nbsp;the&nbsp;same&nbsp;reason&nbsp;as&nbsp;in&nbsp;drawRGBA.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6004712">a</span>&nbsp;<span class="op" id="6004714">:=</span>&nbsp;<span class="op" id="6004717">(</span><span class="ident" id="6004718"><a href="/image/draw/draw.go.html#5994729">m</a></span>&nbsp;<span class="op" id="6004720">-</span>&nbsp;<span class="ident" id="6004722"><a href="/image/draw/draw.go.html#6004386">sa</a></span><span class="op" id="6004724">)</span>&nbsp;<span class="op" id="6004726">*</span>&nbsp;<span class="num" id="6004728">0x101</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6004738"><a href="/image/draw/draw.go.html#6004197">dpix</a></span><span class="op" id="6004742">[</span><span class="ident" id="6004743"><a href="/image/draw/draw.go.html#6004269">i</a></span><span class="op" id="6004744">+</span><span class="num" id="6004745">0</span><span class="op" id="6004746">]</span>&nbsp;<span class="op" id="6004748">=</span>&nbsp;<span class="builtintype" id="6004750">uint8</span><span class="op" id="6004755">(</span><span class="op" id="6004756">(</span><span class="ident" id="6004757"><a href="/image/draw/draw.go.html#6004543">dr</a></span><span class="op" id="6004759">*</span><span class="ident" id="6004760"><a href="/image/draw/draw.go.html#6004712">a</a></span><span class="op" id="6004761">/</span><span class="ident" id="6004762"><a href="/image/draw/draw.go.html#5994729">m</a></span>&nbsp;<span class="op" id="6004764">+</span>&nbsp;<span class="ident" id="6004766"><a href="/image/draw/draw.go.html#6004422">sr</a></span><span class="op" id="6004768">)</span>&nbsp;<span class="op" id="6004770">&gt;&gt;</span>&nbsp;<span class="num" id="6004773">8</span><span class="op" id="6004774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6004779"><a href="/image/draw/draw.go.html#6004197">dpix</a></span><span class="op" id="6004783">[</span><span class="ident" id="6004784"><a href="/image/draw/draw.go.html#6004269">i</a></span><span class="op" id="6004785">+</span><span class="num" id="6004786">1</span><span class="op" id="6004787">]</span>&nbsp;<span class="op" id="6004789">=</span>&nbsp;<span class="builtintype" id="6004791">uint8</span><span class="op" id="6004796">(</span><span class="op" id="6004797">(</span><span class="ident" id="6004798"><a href="/image/draw/draw.go.html#6004570">dg</a></span><span class="op" id="6004800">*</span><span class="ident" id="6004801"><a href="/image/draw/draw.go.html#6004712">a</a></span><span class="op" id="6004802">/</span><span class="ident" id="6004803"><a href="/image/draw/draw.go.html#5994729">m</a></span>&nbsp;<span class="op" id="6004805">+</span>&nbsp;<span class="ident" id="6004807"><a href="/image/draw/draw.go.html#6004462">sg</a></span><span class="op" id="6004809">)</span>&nbsp;<span class="op" id="6004811">&gt;&gt;</span>&nbsp;<span class="num" id="6004814">8</span><span class="op" id="6004815">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6004820"><a href="/image/draw/draw.go.html#6004197">dpix</a></span><span class="op" id="6004824">[</span><span class="ident" id="6004825"><a href="/image/draw/draw.go.html#6004269">i</a></span><span class="op" id="6004826">+</span><span class="num" id="6004827">2</span><span class="op" id="6004828">]</span>&nbsp;<span class="op" id="6004830">=</span>&nbsp;<span class="builtintype" id="6004832">uint8</span><span class="op" id="6004837">(</span><span class="op" id="6004838">(</span><span class="ident" id="6004839"><a href="/image/draw/draw.go.html#6004597">db</a></span><span class="op" id="6004841">*</span><span class="ident" id="6004842"><a href="/image/draw/draw.go.html#6004712">a</a></span><span class="op" id="6004843">/</span><span class="ident" id="6004844"><a href="/image/draw/draw.go.html#5994729">m</a></span>&nbsp;<span class="op" id="6004846">+</span>&nbsp;<span class="ident" id="6004848"><a href="/image/draw/draw.go.html#6004502">sb</a></span><span class="op" id="6004850">)</span>&nbsp;<span class="op" id="6004852">&gt;&gt;</span>&nbsp;<span class="num" id="6004855">8</span><span class="op" id="6004856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6004861"><a href="/image/draw/draw.go.html#6004197">dpix</a></span><span class="op" id="6004865">[</span><span class="ident" id="6004866"><a href="/image/draw/draw.go.html#6004269">i</a></span><span class="op" id="6004867">+</span><span class="num" id="6004868">3</span><span class="op" id="6004869">]</span>&nbsp;<span class="op" id="6004871">=</span>&nbsp;<span class="builtintype" id="6004873">uint8</span><span class="op" id="6004878">(</span><span class="op" id="6004879">(</span><span class="ident" id="6004880"><a href="/image/draw/draw.go.html#6004624">da</a></span><span class="op" id="6004882">*</span><span class="ident" id="6004883"><a href="/image/draw/draw.go.html#6004712">a</a></span><span class="op" id="6004884">/</span><span class="ident" id="6004885"><a href="/image/draw/draw.go.html#5994729">m</a></span>&nbsp;<span class="op" id="6004887">+</span>&nbsp;<span class="ident" id="6004889"><a href="/image/draw/draw.go.html#6004386">sa</a></span><span class="op" id="6004891">)</span>&nbsp;<span class="op" id="6004893">&gt;&gt;</span>&nbsp;<span class="num" id="6004896">8</span><span class="op" id="6004897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6004901">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6004904">}</span><br>
<span class="lineno"></span><span class="op" id="6004906">}</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span><span class="keyword" id="6004909">func</span>&nbsp;<span class="ident" id="6004914">drawNRGBASrc</span><span class="op" id="6004926">(</span><span class="ident" id="6004927">dst</span>&nbsp;<span class="op" id="6004931">*</span><span class="ident" id="6004932"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="6004937">.</span><span class="ident" id="6004938">RGBA</span><span class="op" id="6004942">,</span>&nbsp;<span class="ident" id="6004944">r</span>&nbsp;<span class="ident" id="6004946"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="6004951">.</span><span class="ident" id="6004952">Rectangle</span><span class="op" id="6004961">,</span>&nbsp;<span class="ident" id="6004963">src</span>&nbsp;<span class="op" id="6004967">*</span><span class="ident" id="6004968"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="6004973">.</span><span class="ident" id="6004974">NRGBA</span><span class="op" id="6004979">,</span>&nbsp;<span class="ident" id="6004981">sp</span>&nbsp;<span class="ident" id="6004984"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="6004989">.</span><span class="ident" id="6004990">Point</span><span class="op" id="6004995">)</span>&nbsp;<span class="op" id="6004997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6005000">i0</span>&nbsp;<span class="op" id="6005003">:=</span>&nbsp;<span class="op" id="6005006">(</span><span class="ident" id="6005007"><a href="/image/draw/draw.go.html#6004944">r</a></span><span class="op" id="6005008">.</span><span class="ident" id="6005009">Min</span><span class="op" id="6005012">.</span><span class="ident" id="6005013">X</span>&nbsp;<span class="op" id="6005015">-</span>&nbsp;<span class="ident" id="6005017"><a href="/image/draw/draw.go.html#6004927">dst</a></span><span class="op" id="6005020">.</span><span class="ident" id="6005021">Rect</span><span class="op" id="6005025">.</span><span class="ident" id="6005026">Min</span><span class="op" id="6005029">.</span><span class="ident" id="6005030">X</span><span class="op" id="6005031">)</span>&nbsp;<span class="op" id="6005033">*</span>&nbsp;<span class="num" id="6005035">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6005038">i1</span>&nbsp;<span class="op" id="6005041">:=</span>&nbsp;<span class="op" id="6005044">(</span><span class="ident" id="6005045"><a href="/image/draw/draw.go.html#6004944">r</a></span><span class="op" id="6005046">.</span><span class="ident" id="6005047">Max</span><span class="op" id="6005050">.</span><span class="ident" id="6005051">X</span>&nbsp;<span class="op" id="6005053">-</span>&nbsp;<span class="ident" id="6005055"><a href="/image/draw/draw.go.html#6004927">dst</a></span><span class="op" id="6005058">.</span><span class="ident" id="6005059">Rect</span><span class="op" id="6005063">.</span><span class="ident" id="6005064">Min</span><span class="op" id="6005067">.</span><span class="ident" id="6005068">X</span><span class="op" id="6005069">)</span>&nbsp;<span class="op" id="6005071">*</span>&nbsp;<span class="num" id="6005073">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6005076">si0</span>&nbsp;<span class="op" id="6005080">:=</span>&nbsp;<span class="op" id="6005083">(</span><span class="ident" id="6005084"><a href="/image/draw/draw.go.html#6004981">sp</a></span><span class="op" id="6005086">.</span><span class="ident" id="6005087">X</span>&nbsp;<span class="op" id="6005089">-</span>&nbsp;<span class="ident" id="6005091"><a href="/image/draw/draw.go.html#6004963">src</a></span><span class="op" id="6005094">.</span><span class="ident" id="6005095">Rect</span><span class="op" id="6005099">.</span><span class="ident" id="6005100">Min</span><span class="op" id="6005103">.</span><span class="ident" id="6005104">X</span><span class="op" id="6005105">)</span>&nbsp;<span class="op" id="6005107">*</span>&nbsp;<span class="num" id="6005109">4</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6005112">yMax</span>&nbsp;<span class="op" id="6005117">:=</span>&nbsp;<span class="ident" id="6005120"><a href="/image/draw/draw.go.html#6004944">r</a></span><span class="op" id="6005121">.</span><span class="ident" id="6005122">Max</span><span class="op" id="6005125">.</span><span class="ident" id="6005126">Y</span>&nbsp;<span class="op" id="6005128">-</span>&nbsp;<span class="ident" id="6005130"><a href="/image/draw/draw.go.html#6004927">dst</a></span><span class="op" id="6005133">.</span><span class="ident" id="6005134">Rect</span><span class="op" id="6005138">.</span><span class="ident" id="6005139">Min</span><span class="op" id="6005142">.</span><span class="ident" id="6005143">Y</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6005147">y</span>&nbsp;<span class="op" id="6005149">:=</span>&nbsp;<span class="ident" id="6005152"><a href="/image/draw/draw.go.html#6004944">r</a></span><span class="op" id="6005153">.</span><span class="ident" id="6005154">Min</span><span class="op" id="6005157">.</span><span class="ident" id="6005158">Y</span>&nbsp;<span class="op" id="6005160">-</span>&nbsp;<span class="ident" id="6005162"><a href="/image/draw/draw.go.html#6004927">dst</a></span><span class="op" id="6005165">.</span><span class="ident" id="6005166">Rect</span><span class="op" id="6005170">.</span><span class="ident" id="6005171">Min</span><span class="op" id="6005174">.</span><span class="ident" id="6005175">Y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6005178">sy</span>&nbsp;<span class="op" id="6005181">:=</span>&nbsp;<span class="ident" id="6005184"><a href="/image/draw/draw.go.html#6004981">sp</a></span><span class="op" id="6005186">.</span><span class="ident" id="6005187">Y</span>&nbsp;<span class="op" id="6005189">-</span>&nbsp;<span class="ident" id="6005191"><a href="/image/draw/draw.go.html#6004963">src</a></span><span class="op" id="6005194">.</span><span class="ident" id="6005195">Rect</span><span class="op" id="6005199">.</span><span class="ident" id="6005200">Min</span><span class="op" id="6005203">.</span><span class="ident" id="6005204">Y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6005207">for</span>&nbsp;<span class="op" id="6005211">;</span>&nbsp;<span class="ident" id="6005213"><a href="/image/draw/draw.go.html#6005147">y</a></span>&nbsp;<span class="op" id="6005215">!=</span>&nbsp;<span class="ident" id="6005218"><a href="/image/draw/draw.go.html#6005112">yMax</a></span><span class="op" id="6005222">;</span>&nbsp;<span class="ident" id="6005224"><a href="/image/draw/draw.go.html#6005147">y</a></span><span class="op" id="6005225">,</span>&nbsp;<span class="ident" id="6005227"><a href="/image/draw/draw.go.html#6005178">sy</a></span>&nbsp;<span class="op" id="6005230">=</span>&nbsp;<span class="ident" id="6005232"><a href="/image/draw/draw.go.html#6005147">y</a></span><span class="op" id="6005233">+</span><span class="num" id="6005234">1</span><span class="op" id="6005235">,</span>&nbsp;<span class="ident" id="6005237"><a href="/image/draw/draw.go.html#6005178">sy</a></span><span class="op" id="6005239">+</span><span class="num" id="6005240">1</span>&nbsp;<span class="op" id="6005242">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6005246">dpix</span>&nbsp;<span class="op" id="6005251">:=</span>&nbsp;<span class="ident" id="6005254"><a href="/image/draw/draw.go.html#6004927">dst</a></span><span class="op" id="6005257">.</span><span class="ident" id="6005258">Pix</span><span class="op" id="6005261">[</span><span class="ident" id="6005262"><a href="/image/draw/draw.go.html#6005147">y</a></span><span class="op" id="6005263">*</span><span class="ident" id="6005264"><a href="/image/draw/draw.go.html#6004927">dst</a></span><span class="op" id="6005267">.</span><span class="ident" id="6005268">Stride</span><span class="op" id="6005274">:</span><span class="op" id="6005275">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6005279">spix</span>&nbsp;<span class="op" id="6005284">:=</span>&nbsp;<span class="ident" id="6005287"><a href="/image/draw/draw.go.html#6004963">src</a></span><span class="op" id="6005290">.</span><span class="ident" id="6005291">Pix</span><span class="op" id="6005294">[</span><span class="ident" id="6005295"><a href="/image/draw/draw.go.html#6005178">sy</a></span><span class="op" id="6005297">*</span><span class="ident" id="6005298"><a href="/image/draw/draw.go.html#6004963">src</a></span><span class="op" id="6005301">.</span><span class="ident" id="6005302">Stride</span><span class="op" id="6005308">:</span><span class="op" id="6005309">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6005314">for</span>&nbsp;<span class="ident" id="6005318">i</span><span class="op" id="6005319">,</span>&nbsp;<span class="ident" id="6005321">si</span>&nbsp;<span class="op" id="6005324">:=</span>&nbsp;<span class="ident" id="6005327"><a href="/image/draw/draw.go.html#6005000">i0</a></span><span class="op" id="6005329">,</span>&nbsp;<span class="ident" id="6005331"><a href="/image/draw/draw.go.html#6005076">si0</a></span><span class="op" id="6005334">;</span>&nbsp;<span class="ident" id="6005336"><a href="/image/draw/draw.go.html#6005318">i</a></span>&nbsp;<span class="op" id="6005338">&lt;</span>&nbsp;<span class="ident" id="6005340"><a href="/image/draw/draw.go.html#6005038">i1</a></span><span class="op" id="6005342">;</span>&nbsp;<span class="ident" id="6005344"><a href="/image/draw/draw.go.html#6005318">i</a></span><span class="op" id="6005345">,</span>&nbsp;<span class="ident" id="6005347"><a href="/image/draw/draw.go.html#6005321">si</a></span>&nbsp;<span class="op" id="6005350">=</span>&nbsp;<span class="ident" id="6005352"><a href="/image/draw/draw.go.html#6005318">i</a></span><span class="op" id="6005353">+</span><span class="num" id="6005354">4</span><span class="op" id="6005355">,</span>&nbsp;<span class="ident" id="6005357"><a href="/image/draw/draw.go.html#6005321">si</a></span><span class="op" id="6005359">+</span><span class="num" id="6005360">4</span>&nbsp;<span class="op" id="6005362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6005367">//&nbsp;Convert&nbsp;from&nbsp;non-premultiplied&nbsp;color&nbsp;to&nbsp;pre-multiplied&nbsp;color.</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6005435">sa</span>&nbsp;<span class="op" id="6005438">:=</span>&nbsp;<span class="builtintype" id="6005441">uint32</span><span class="op" id="6005447">(</span><span class="ident" id="6005448"><a href="/image/draw/draw.go.html#6005279">spix</a></span><span class="op" id="6005452">[</span><span class="ident" id="6005453"><a href="/image/draw/draw.go.html#6005321">si</a></span><span class="op" id="6005455">+</span><span class="num" id="6005456">3</span><span class="op" id="6005457">]</span><span class="op" id="6005458">)</span>&nbsp;<span class="op" id="6005460">*</span>&nbsp;<span class="num" id="6005462">0x101</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6005471">sr</span>&nbsp;<span class="op" id="6005474">:=</span>&nbsp;<span class="builtintype" id="6005477">uint32</span><span class="op" id="6005483">(</span><span class="ident" id="6005484"><a href="/image/draw/draw.go.html#6005279">spix</a></span><span class="op" id="6005488">[</span><span class="ident" id="6005489"><a href="/image/draw/draw.go.html#6005321">si</a></span><span class="op" id="6005491">+</span><span class="num" id="6005492">0</span><span class="op" id="6005493">]</span><span class="op" id="6005494">)</span>&nbsp;<span class="op" id="6005496">*</span>&nbsp;<span class="ident" id="6005498"><a href="/image/draw/draw.go.html#6005435">sa</a></span>&nbsp;<span class="op" id="6005501">/</span>&nbsp;<span class="num" id="6005503">0xff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6005511">sg</span>&nbsp;<span class="op" id="6005514">:=</span>&nbsp;<span class="builtintype" id="6005517">uint32</span><span class="op" id="6005523">(</span><span class="ident" id="6005524"><a href="/image/draw/draw.go.html#6005279">spix</a></span><span class="op" id="6005528">[</span><span class="ident" id="6005529"><a href="/image/draw/draw.go.html#6005321">si</a></span><span class="op" id="6005531">+</span><span class="num" id="6005532">1</span><span class="op" id="6005533">]</span><span class="op" id="6005534">)</span>&nbsp;<span class="op" id="6005536">*</span>&nbsp;<span class="ident" id="6005538"><a href="/image/draw/draw.go.html#6005435">sa</a></span>&nbsp;<span class="op" id="6005541">/</span>&nbsp;<span class="num" id="6005543">0xff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6005551">sb</span>&nbsp;<span class="op" id="6005554">:=</span>&nbsp;<span class="builtintype" id="6005557">uint32</span><span class="op" id="6005563">(</span><span class="ident" id="6005564"><a href="/image/draw/draw.go.html#6005279">spix</a></span><span class="op" id="6005568">[</span><span class="ident" id="6005569"><a href="/image/draw/draw.go.html#6005321">si</a></span><span class="op" id="6005571">+</span><span class="num" id="6005572">2</span><span class="op" id="6005573">]</span><span class="op" id="6005574">)</span>&nbsp;<span class="op" id="6005576">*</span>&nbsp;<span class="ident" id="6005578"><a href="/image/draw/draw.go.html#6005435">sa</a></span>&nbsp;<span class="op" id="6005581">/</span>&nbsp;<span class="num" id="6005583">0xff</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6005592"><a href="/image/draw/draw.go.html#6005246">dpix</a></span><span class="op" id="6005596">[</span><span class="ident" id="6005597"><a href="/image/draw/draw.go.html#6005318">i</a></span><span class="op" id="6005598">+</span><span class="num" id="6005599">0</span><span class="op" id="6005600">]</span>&nbsp;<span class="op" id="6005602">=</span>&nbsp;<span class="builtintype" id="6005604">uint8</span><span class="op" id="6005609">(</span><span class="ident" id="6005610"><a href="/image/draw/draw.go.html#6005471">sr</a></span>&nbsp;<span class="op" id="6005613">&gt;&gt;</span>&nbsp;<span class="num" id="6005616">8</span><span class="op" id="6005617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6005622"><a href="/image/draw/draw.go.html#6005246">dpix</a></span><span class="op" id="6005626">[</span><span class="ident" id="6005627"><a href="/image/draw/draw.go.html#6005318">i</a></span><span class="op" id="6005628">+</span><span class="num" id="6005629">1</span><span class="op" id="6005630">]</span>&nbsp;<span class="op" id="6005632">=</span>&nbsp;<span class="builtintype" id="6005634">uint8</span><span class="op" id="6005639">(</span><span class="ident" id="6005640"><a href="/image/draw/draw.go.html#6005511">sg</a></span>&nbsp;<span class="op" id="6005643">&gt;&gt;</span>&nbsp;<span class="num" id="6005646">8</span><span class="op" id="6005647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6005652"><a href="/image/draw/draw.go.html#6005246">dpix</a></span><span class="op" id="6005656">[</span><span class="ident" id="6005657"><a href="/image/draw/draw.go.html#6005318">i</a></span><span class="op" id="6005658">+</span><span class="num" id="6005659">2</span><span class="op" id="6005660">]</span>&nbsp;<span class="op" id="6005662">=</span>&nbsp;<span class="builtintype" id="6005664">uint8</span><span class="op" id="6005669">(</span><span class="ident" id="6005670"><a href="/image/draw/draw.go.html#6005551">sb</a></span>&nbsp;<span class="op" id="6005673">&gt;&gt;</span>&nbsp;<span class="num" id="6005676">8</span><span class="op" id="6005677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6005682"><a href="/image/draw/draw.go.html#6005246">dpix</a></span><span class="op" id="6005686">[</span><span class="ident" id="6005687"><a href="/image/draw/draw.go.html#6005318">i</a></span><span class="op" id="6005688">+</span><span class="num" id="6005689">3</span><span class="op" id="6005690">]</span>&nbsp;<span class="op" id="6005692">=</span>&nbsp;<span class="builtintype" id="6005694">uint8</span><span class="op" id="6005699">(</span><span class="ident" id="6005700"><a href="/image/draw/draw.go.html#6005435">sa</a></span>&nbsp;<span class="op" id="6005703">&gt;&gt;</span>&nbsp;<span class="num" id="6005706">8</span><span class="op" id="6005707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6005711">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6005714">}</span><br>
<span class="lineno"></span><span class="op" id="6005716">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6005719">func</span>&nbsp;<span class="ident" id="6005724">drawYCbCr</span><span class="op" id="6005733">(</span><span class="ident" id="6005734">dst</span>&nbsp;<span class="op" id="6005738">*</span><span class="ident" id="6005739"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="6005744">.</span><span class="ident" id="6005745">RGBA</span><span class="op" id="6005749">,</span>&nbsp;<span class="ident" id="6005751">r</span>&nbsp;<span class="ident" id="6005753"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="6005758">.</span><span class="ident" id="6005759">Rectangle</span><span class="op" id="6005768">,</span>&nbsp;<span class="ident" id="6005770">src</span>&nbsp;<span class="op" id="6005774">*</span><span class="ident" id="6005775"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="6005780">.</span><span class="ident" id="6005781">YCbCr</span><span class="op" id="6005786">,</span>&nbsp;<span class="ident" id="6005788">sp</span>&nbsp;<span class="ident" id="6005791"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="6005796">.</span><span class="ident" id="6005797">Point</span><span class="op" id="6005802">)</span>&nbsp;<span class="op" id="6005804">(</span><span class="ident" id="6005805">ok</span>&nbsp;<span class="builtintype" id="6005808">bool</span><span class="op" id="6005812">)</span>&nbsp;<span class="op" id="6005814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6005817">//&nbsp;An&nbsp;image.YCbCr&nbsp;is&nbsp;always&nbsp;fully&nbsp;opaque,&nbsp;and&nbsp;so&nbsp;if&nbsp;the&nbsp;mask&nbsp;is&nbsp;implicitly&nbsp;nil</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6005897">//&nbsp;(i.e.&nbsp;fully&nbsp;opaque)&nbsp;then&nbsp;the&nbsp;op&nbsp;is&nbsp;effectively&nbsp;always&nbsp;Src.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6005960">x0</span>&nbsp;<span class="op" id="6005963">:=</span>&nbsp;<span class="op" id="6005966">(</span><span class="ident" id="6005967"><a href="/image/draw/draw.go.html#6005751">r</a></span><span class="op" id="6005968">.</span><span class="ident" id="6005969">Min</span><span class="op" id="6005972">.</span><span class="ident" id="6005973">X</span>&nbsp;<span class="op" id="6005975">-</span>&nbsp;<span class="ident" id="6005977"><a href="/image/draw/draw.go.html#6005734">dst</a></span><span class="op" id="6005980">.</span><span class="ident" id="6005981">Rect</span><span class="op" id="6005985">.</span><span class="ident" id="6005986">Min</span><span class="op" id="6005989">.</span><span class="ident" id="6005990">X</span><span class="op" id="6005991">)</span>&nbsp;<span class="op" id="6005993">*</span>&nbsp;<span class="num" id="6005995">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6005998">x1</span>&nbsp;<span class="op" id="6006001">:=</span>&nbsp;<span class="op" id="6006004">(</span><span class="ident" id="6006005"><a href="/image/draw/draw.go.html#6005751">r</a></span><span class="op" id="6006006">.</span><span class="ident" id="6006007">Max</span><span class="op" id="6006010">.</span><span class="ident" id="6006011">X</span>&nbsp;<span class="op" id="6006013">-</span>&nbsp;<span class="ident" id="6006015"><a href="/image/draw/draw.go.html#6005734">dst</a></span><span class="op" id="6006018">.</span><span class="ident" id="6006019">Rect</span><span class="op" id="6006023">.</span><span class="ident" id="6006024">Min</span><span class="op" id="6006027">.</span><span class="ident" id="6006028">X</span><span class="op" id="6006029">)</span>&nbsp;<span class="op" id="6006031">*</span>&nbsp;<span class="num" id="6006033">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6006036">y0</span>&nbsp;<span class="op" id="6006039">:=</span>&nbsp;<span class="ident" id="6006042"><a href="/image/draw/draw.go.html#6005751">r</a></span><span class="op" id="6006043">.</span><span class="ident" id="6006044">Min</span><span class="op" id="6006047">.</span><span class="ident" id="6006048">Y</span>&nbsp;<span class="op" id="6006050">-</span>&nbsp;<span class="ident" id="6006052"><a href="/image/draw/draw.go.html#6005734">dst</a></span><span class="op" id="6006055">.</span><span class="ident" id="6006056">Rect</span><span class="op" id="6006060">.</span><span class="ident" id="6006061">Min</span><span class="op" id="6006064">.</span><span class="ident" id="6006065">Y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6006068">y1</span>&nbsp;<span class="op" id="6006071">:=</span>&nbsp;<span class="ident" id="6006074"><a href="/image/draw/draw.go.html#6005751">r</a></span><span class="op" id="6006075">.</span><span class="ident" id="6006076">Max</span><span class="op" id="6006079">.</span><span class="ident" id="6006080">Y</span>&nbsp;<span class="op" id="6006082">-</span>&nbsp;<span class="ident" id="6006084"><a href="/image/draw/draw.go.html#6005734">dst</a></span><span class="op" id="6006087">.</span><span class="ident" id="6006088">Rect</span><span class="op" id="6006092">.</span><span class="ident" id="6006093">Min</span><span class="op" id="6006096">.</span><span class="ident" id="6006097">Y</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6006100">switch</span>&nbsp;<span class="ident" id="6006107"><a href="/image/draw/draw.go.html#6005770">src</a></span><span class="op" id="6006110">.</span><span class="ident" id="6006111">SubsampleRatio</span>&nbsp;<span class="op" id="6006126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6006129">case</span>&nbsp;<span class="ident" id="6006134"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="6006139">.</span><span class="ident" id="6006140">YCbCrSubsampleRatio444</span><span class="op" id="6006162">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6006166">for</span>&nbsp;<span class="ident" id="6006170">y</span><span class="op" id="6006171">,</span>&nbsp;<span class="ident" id="6006173">sy</span>&nbsp;<span class="op" id="6006176">:=</span>&nbsp;<span class="ident" id="6006179"><a href="/image/draw/draw.go.html#6006036">y0</a></span><span class="op" id="6006181">,</span>&nbsp;<span class="ident" id="6006183"><a href="/image/draw/draw.go.html#6005788">sp</a></span><span class="op" id="6006185">.</span><span class="ident" id="6006186">Y</span><span class="op" id="6006187">;</span>&nbsp;<span class="ident" id="6006189"><a href="/image/draw/draw.go.html#6006170">y</a></span>&nbsp;<span class="op" id="6006191">!=</span>&nbsp;<span class="ident" id="6006194"><a href="/image/draw/draw.go.html#6006068">y1</a></span><span class="op" id="6006196">;</span>&nbsp;<span class="ident" id="6006198"><a href="/image/draw/draw.go.html#6006170">y</a></span><span class="op" id="6006199">,</span>&nbsp;<span class="ident" id="6006201"><a href="/image/draw/draw.go.html#6006173">sy</a></span>&nbsp;<span class="op" id="6006204">=</span>&nbsp;<span class="ident" id="6006206"><a href="/image/draw/draw.go.html#6006170">y</a></span><span class="op" id="6006207">+</span><span class="num" id="6006208">1</span><span class="op" id="6006209">,</span>&nbsp;<span class="ident" id="6006211"><a href="/image/draw/draw.go.html#6006173">sy</a></span><span class="op" id="6006213">+</span><span class="num" id="6006214">1</span>&nbsp;<span class="op" id="6006216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6006221">dpix</span>&nbsp;<span class="op" id="6006226">:=</span>&nbsp;<span class="ident" id="6006229"><a href="/image/draw/draw.go.html#6005734">dst</a></span><span class="op" id="6006232">.</span><span class="ident" id="6006233">Pix</span><span class="op" id="6006236">[</span><span class="ident" id="6006237"><a href="/image/draw/draw.go.html#6006170">y</a></span><span class="op" id="6006238">*</span><span class="ident" id="6006239"><a href="/image/draw/draw.go.html#6005734">dst</a></span><span class="op" id="6006242">.</span><span class="ident" id="6006243">Stride</span><span class="op" id="6006249">:</span><span class="op" id="6006250">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6006255">yi</span>&nbsp;<span class="op" id="6006258">:=</span>&nbsp;<span class="op" id="6006261">(</span><span class="ident" id="6006262"><a href="/image/draw/draw.go.html#6006173">sy</a></span><span class="op" id="6006264">-</span><span class="ident" id="6006265"><a href="/image/draw/draw.go.html#6005770">src</a></span><span class="op" id="6006268">.</span><span class="ident" id="6006269">Rect</span><span class="op" id="6006273">.</span><span class="ident" id="6006274">Min</span><span class="op" id="6006277">.</span><span class="ident" id="6006278">Y</span><span class="op" id="6006279">)</span><span class="op" id="6006280">*</span><span class="ident" id="6006281"><a href="/image/draw/draw.go.html#6005770">src</a></span><span class="op" id="6006284">.</span><span class="ident" id="6006285">YStride</span>&nbsp;<span class="op" id="6006293">+</span>&nbsp;<span class="op" id="6006295">(</span><span class="ident" id="6006296"><a href="/image/draw/draw.go.html#6005788">sp</a></span><span class="op" id="6006298">.</span><span class="ident" id="6006299">X</span>&nbsp;<span class="op" id="6006301">-</span>&nbsp;<span class="ident" id="6006303"><a href="/image/draw/draw.go.html#6005770">src</a></span><span class="op" id="6006306">.</span><span class="ident" id="6006307">Rect</span><span class="op" id="6006311">.</span><span class="ident" id="6006312">Min</span><span class="op" id="6006315">.</span><span class="ident" id="6006316">X</span><span class="op" id="6006317">)</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6006322">ci</span>&nbsp;<span class="op" id="6006325">:=</span>&nbsp;<span class="op" id="6006328">(</span><span class="ident" id="6006329"><a href="/image/draw/draw.go.html#6006173">sy</a></span><span class="op" id="6006331">-</span><span class="ident" id="6006332"><a href="/image/draw/draw.go.html#6005770">src</a></span><span class="op" id="6006335">.</span><span class="ident" id="6006336">Rect</span><span class="op" id="6006340">.</span><span class="ident" id="6006341">Min</span><span class="op" id="6006344">.</span><span class="ident" id="6006345">Y</span><span class="op" id="6006346">)</span><span class="op" id="6006347">*</span><span class="ident" id="6006348"><a href="/image/draw/draw.go.html#6005770">src</a></span><span class="op" id="6006351">.</span><span class="ident" id="6006352">CStride</span>&nbsp;<span class="op" id="6006360">+</span>&nbsp;<span class="op" id="6006362">(</span><span class="ident" id="6006363"><a href="/image/draw/draw.go.html#6005788">sp</a></span><span class="op" id="6006365">.</span><span class="ident" id="6006366">X</span>&nbsp;<span class="op" id="6006368">-</span>&nbsp;<span class="ident" id="6006370"><a href="/image/draw/draw.go.html#6005770">src</a></span><span class="op" id="6006373">.</span><span class="ident" id="6006374">Rect</span><span class="op" id="6006378">.</span><span class="ident" id="6006379">Min</span><span class="op" id="6006382">.</span><span class="ident" id="6006383">X</span><span class="op" id="6006384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6006389">for</span>&nbsp;<span class="ident" id="6006393">x</span>&nbsp;<span class="op" id="6006395">:=</span>&nbsp;<span class="ident" id="6006398"><a href="/image/draw/draw.go.html#6005960">x0</a></span><span class="op" id="6006400">;</span>&nbsp;<span class="ident" id="6006402"><a href="/image/draw/draw.go.html#6006393">x</a></span>&nbsp;<span class="op" id="6006404">!=</span>&nbsp;<span class="ident" id="6006407"><a href="/image/draw/draw.go.html#6005998">x1</a></span><span class="op" id="6006409">;</span>&nbsp;<span class="ident" id="6006411"><a href="/image/draw/draw.go.html#6006393">x</a></span><span class="op" id="6006412">,</span>&nbsp;<span class="ident" id="6006414"><a href="/image/draw/draw.go.html#6006255">yi</a></span><span class="op" id="6006416">,</span>&nbsp;<span class="ident" id="6006418"><a href="/image/draw/draw.go.html#6006322">ci</a></span>&nbsp;<span class="op" id="6006421">=</span>&nbsp;<span class="ident" id="6006423"><a href="/image/draw/draw.go.html#6006393">x</a></span><span class="op" id="6006424">+</span><span class="num" id="6006425">4</span><span class="op" id="6006426">,</span>&nbsp;<span class="ident" id="6006428"><a href="/image/draw/draw.go.html#6006255">yi</a></span><span class="op" id="6006430">+</span><span class="num" id="6006431">1</span><span class="op" id="6006432">,</span>&nbsp;<span class="ident" id="6006434"><a href="/image/draw/draw.go.html#6006322">ci</a></span><span class="op" id="6006436">+</span><span class="num" id="6006437">1</span>&nbsp;<span class="op" id="6006439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6006445">rr</span><span class="op" id="6006447">,</span>&nbsp;<span class="ident" id="6006449">gg</span><span class="op" id="6006451">,</span>&nbsp;<span class="ident" id="6006453">bb</span>&nbsp;<span class="op" id="6006456">:=</span>&nbsp;<span class="ident" id="6006459"><a href="/image/draw/draw.go.html#5994644">color</a></span><span class="op" id="6006464">.</span><span class="ident" id="6006465">YCbCrToRGB</span><span class="op" id="6006475">(</span><span class="ident" id="6006476"><a href="/image/draw/draw.go.html#6005770">src</a></span><span class="op" id="6006479">.</span><span class="ident" id="6006480">Y</span><span class="op" id="6006481">[</span><span class="ident" id="6006482"><a href="/image/draw/draw.go.html#6006255">yi</a></span><span class="op" id="6006484">]</span><span class="op" id="6006485">,</span>&nbsp;<span class="ident" id="6006487"><a href="/image/draw/draw.go.html#6005770">src</a></span><span class="op" id="6006490">.</span><span class="ident" id="6006491">Cb</span><span class="op" id="6006493">[</span><span class="ident" id="6006494"><a href="/image/draw/draw.go.html#6006322">ci</a></span><span class="op" id="6006496">]</span><span class="op" id="6006497">,</span>&nbsp;<span class="ident" id="6006499"><a href="/image/draw/draw.go.html#6005770">src</a></span><span class="op" id="6006502">.</span><span class="ident" id="6006503">Cr</span><span class="op" id="6006505">[</span><span class="ident" id="6006506"><a href="/image/draw/draw.go.html#6006322">ci</a></span><span class="op" id="6006508">]</span><span class="op" id="6006509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6006515"><a href="/image/draw/draw.go.html#6006221">dpix</a></span><span class="op" id="6006519">[</span><span class="ident" id="6006520"><a href="/image/draw/draw.go.html#6006393">x</a></span><span class="op" id="6006521">+</span><span class="num" id="6006522">0</span><span class="op" id="6006523">]</span>&nbsp;<span class="op" id="6006525">=</span>&nbsp;<span class="ident" id="6006527"><a href="/image/draw/draw.go.html#6006445">rr</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6006534"><a href="/image/draw/draw.go.html#6006221">dpix</a></span><span class="op" id="6006538">[</span><span class="ident" id="6006539"><a href="/image/draw/draw.go.html#6006393">x</a></span><span class="op" id="6006540">+</span><span class="num" id="6006541">1</span><span class="op" id="6006542">]</span>&nbsp;<span class="op" id="6006544">=</span>&nbsp;<span class="ident" id="6006546"><a href="/image/draw/draw.go.html#6006449">gg</a></span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6006553"><a href="/image/draw/draw.go.html#6006221">dpix</a></span><span class="op" id="6006557">[</span><span class="ident" id="6006558"><a href="/image/draw/draw.go.html#6006393">x</a></span><span class="op" id="6006559">+</span><span class="num" id="6006560">2</span><span class="op" id="6006561">]</span>&nbsp;<span class="op" id="6006563">=</span>&nbsp;<span class="ident" id="6006565"><a href="/image/draw/draw.go.html#6006453">bb</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6006572"><a href="/image/draw/draw.go.html#6006221">dpix</a></span><span class="op" id="6006576">[</span><span class="ident" id="6006577"><a href="/image/draw/draw.go.html#6006393">x</a></span><span class="op" id="6006578">+</span><span class="num" id="6006579">3</span><span class="op" id="6006580">]</span>&nbsp;<span class="op" id="6006582">=</span>&nbsp;<span class="num" id="6006584">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6006591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6006595">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6006598">case</span>&nbsp;<span class="ident" id="6006603"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="6006608">.</span><span class="ident" id="6006609">YCbCrSubsampleRatio422</span><span class="op" id="6006631">:</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6006635">for</span>&nbsp;<span class="ident" id="6006639">y</span><span class="op" id="6006640">,</span>&nbsp;<span class="ident" id="6006642">sy</span>&nbsp;<span class="op" id="6006645">:=</span>&nbsp;<span class="ident" id="6006648"><a href="/image/draw/draw.go.html#6006036">y0</a></span><span class="op" id="6006650">,</span>&nbsp;<span class="ident" id="6006652"><a href="/image/draw/draw.go.html#6005788">sp</a></span><span class="op" id="6006654">.</span><span class="ident" id="6006655">Y</span><span class="op" id="6006656">;</span>&nbsp;<span class="ident" id="6006658"><a href="/image/draw/draw.go.html#6006639">y</a></span>&nbsp;<span class="op" id="6006660">!=</span>&nbsp;<span class="ident" id="6006663"><a href="/image/draw/draw.go.html#6006068">y1</a></span><span class="op" id="6006665">;</span>&nbsp;<span class="ident" id="6006667"><a href="/image/draw/draw.go.html#6006639">y</a></span><span class="op" id="6006668">,</span>&nbsp;<span class="ident" id="6006670"><a href="/image/draw/draw.go.html#6006642">sy</a></span>&nbsp;<span class="op" id="6006673">=</span>&nbsp;<span class="ident" id="6006675"><a href="/image/draw/draw.go.html#6006639">y</a></span><span class="op" id="6006676">+</span><span class="num" id="6006677">1</span><span class="op" id="6006678">,</span>&nbsp;<span class="ident" id="6006680"><a href="/image/draw/draw.go.html#6006642">sy</a></span><span class="op" id="6006682">+</span><span class="num" id="6006683">1</span>&nbsp;<span class="op" id="6006685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6006690">dpix</span>&nbsp;<span class="op" id="6006695">:=</span>&nbsp;<span class="ident" id="6006698"><a href="/image/draw/draw.go.html#6005734">dst</a></span><span class="op" id="6006701">.</span><span class="ident" id="6006702">Pix</span><span class="op" id="6006705">[</span><span class="ident" id="6006706"><a href="/image/draw/draw.go.html#6006639">y</a></span><span class="op" id="6006707">*</span><span class="ident" id="6006708"><a href="/image/draw/draw.go.html#6005734">dst</a></span><span class="op" id="6006711">.</span><span class="ident" id="6006712">Stride</span><span class="op" id="6006718">:</span><span class="op" id="6006719">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6006724">yi</span>&nbsp;<span class="op" id="6006727">:=</span>&nbsp;<span class="op" id="6006730">(</span><span class="ident" id="6006731"><a href="/image/draw/draw.go.html#6006642">sy</a></span><span class="op" id="6006733">-</span><span class="ident" id="6006734"><a href="/image/draw/draw.go.html#6005770">src</a></span><span class="op" id="6006737">.</span><span class="ident" id="6006738">Rect</span><span class="op" id="6006742">.</span><span class="ident" id="6006743">Min</span><span class="op" id="6006746">.</span><span class="ident" id="6006747">Y</span><span class="op" id="6006748">)</span><span class="op" id="6006749">*</span><span class="ident" id="6006750"><a href="/image/draw/draw.go.html#6005770">src</a></span><span class="op" id="6006753">.</span><span class="ident" id="6006754">YStride</span>&nbsp;<span class="op" id="6006762">+</span>&nbsp;<span class="op" id="6006764">(</span><span class="ident" id="6006765"><a href="/image/draw/draw.go.html#6005788">sp</a></span><span class="op" id="6006767">.</span><span class="ident" id="6006768">X</span>&nbsp;<span class="op" id="6006770">-</span>&nbsp;<span class="ident" id="6006772"><a href="/image/draw/draw.go.html#6005770">src</a></span><span class="op" id="6006775">.</span><span class="ident" id="6006776">Rect</span><span class="op" id="6006780">.</span><span class="ident" id="6006781">Min</span><span class="op" id="6006784">.</span><span class="ident" id="6006785">X</span><span class="op" id="6006786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6006791">ciBase</span>&nbsp;<span class="op" id="6006798">:=</span>&nbsp;<span class="op" id="6006801">(</span><span class="ident" id="6006802"><a href="/image/draw/draw.go.html#6006642">sy</a></span><span class="op" id="6006804">-</span><span class="ident" id="6006805"><a href="/image/draw/draw.go.html#6005770">src</a></span><span class="op" id="6006808">.</span><span class="ident" id="6006809">Rect</span><span class="op" id="6006813">.</span><span class="ident" id="6006814">Min</span><span class="op" id="6006817">.</span><span class="ident" id="6006818">Y</span><span class="op" id="6006819">)</span><span class="op" id="6006820">*</span><span class="ident" id="6006821"><a href="/image/draw/draw.go.html#6005770">src</a></span><span class="op" id="6006824">.</span><span class="ident" id="6006825">CStride</span>&nbsp;<span class="op" id="6006833">-</span>&nbsp;<span class="ident" id="6006835"><a href="/image/draw/draw.go.html#6005770">src</a></span><span class="op" id="6006838">.</span><span class="ident" id="6006839">Rect</span><span class="op" id="6006843">.</span><span class="ident" id="6006844">Min</span><span class="op" id="6006847">.</span><span class="ident" id="6006848">X</span><span class="op" id="6006849">/</span><span class="num" id="6006850">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6006855">for</span>&nbsp;<span class="ident" id="6006859">x</span><span class="op" id="6006860">,</span>&nbsp;<span class="ident" id="6006862">sx</span>&nbsp;<span class="op" id="6006865">:=</span>&nbsp;<span class="ident" id="6006868"><a href="/image/draw/draw.go.html#6005960">x0</a></span><span class="op" id="6006870">,</span>&nbsp;<span class="ident" id="6006872"><a href="/image/draw/draw.go.html#6005788">sp</a></span><span class="op" id="6006874">.</span><span class="ident" id="6006875">X</span><span class="op" id="6006876">;</span>&nbsp;<span class="ident" id="6006878"><a href="/image/draw/draw.go.html#6006859">x</a></span>&nbsp;<span class="op" id="6006880">!=</span>&nbsp;<span class="ident" id="6006883"><a href="/image/draw/draw.go.html#6005998">x1</a></span><span class="op" id="6006885">;</span>&nbsp;<span class="ident" id="6006887"><a href="/image/draw/draw.go.html#6006859">x</a></span><span class="op" id="6006888">,</span>&nbsp;<span class="ident" id="6006890"><a href="/image/draw/draw.go.html#6006862">sx</a></span><span class="op" id="6006892">,</span>&nbsp;<span class="ident" id="6006894"><a href="/image/draw/draw.go.html#6006724">yi</a></span>&nbsp;<span class="op" id="6006897">=</span>&nbsp;<span class="ident" id="6006899"><a href="/image/draw/draw.go.html#6006859">x</a></span><span class="op" id="6006900">+</span><span class="num" id="6006901">4</span><span class="op" id="6006902">,</span>&nbsp;<span class="ident" id="6006904"><a href="/image/draw/draw.go.html#6006862">sx</a></span><span class="op" id="6006906">+</span><span class="num" id="6006907">1</span><span class="op" id="6006908">,</span>&nbsp;<span class="ident" id="6006910"><a href="/image/draw/draw.go.html#6006724">yi</a></span><span class="op" id="6006912">+</span><span class="num" id="6006913">1</span>&nbsp;<span class="op" id="6006915">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6006921">ci</span>&nbsp;<span class="op" id="6006924">:=</span>&nbsp;<span class="ident" id="6006927"><a href="/image/draw/draw.go.html#6006791">ciBase</a></span>&nbsp;<span class="op" id="6006934">+</span>&nbsp;<span class="ident" id="6006936"><a href="/image/draw/draw.go.html#6006862">sx</a></span><span class="op" id="6006938">/</span><span class="num" id="6006939">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6006945">rr</span><span class="op" id="6006947">,</span>&nbsp;<span class="ident" id="6006949">gg</span><span class="op" id="6006951">,</span>&nbsp;<span class="ident" id="6006953">bb</span>&nbsp;<span class="op" id="6006956">:=</span>&nbsp;<span class="ident" id="6006959"><a href="/image/draw/draw.go.html#5994644">color</a></span><span class="op" id="6006964">.</span><span class="ident" id="6006965">YCbCrToRGB</span><span class="op" id="6006975">(</span><span class="ident" id="6006976"><a href="/image/draw/draw.go.html#6005770">src</a></span><span class="op" id="6006979">.</span><span class="ident" id="6006980">Y</span><span class="op" id="6006981">[</span><span class="ident" id="6006982"><a href="/image/draw/draw.go.html#6006724">yi</a></span><span class="op" id="6006984">]</span><span class="op" id="6006985">,</span>&nbsp;<span class="ident" id="6006987"><a href="/image/draw/draw.go.html#6005770">src</a></span><span class="op" id="6006990">.</span><span class="ident" id="6006991">Cb</span><span class="op" id="6006993">[</span><span class="ident" id="6006994"><a href="/image/draw/draw.go.html#6006921">ci</a></span><span class="op" id="6006996">]</span><span class="op" id="6006997">,</span>&nbsp;<span class="ident" id="6006999"><a href="/image/draw/draw.go.html#6005770">src</a></span><span class="op" id="6007002">.</span><span class="ident" id="6007003">Cr</span><span class="op" id="6007005">[</span><span class="ident" id="6007006"><a href="/image/draw/draw.go.html#6006921">ci</a></span><span class="op" id="6007008">]</span><span class="op" id="6007009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6007015"><a href="/image/draw/draw.go.html#6006690">dpix</a></span><span class="op" id="6007019">[</span><span class="ident" id="6007020"><a href="/image/draw/draw.go.html#6006859">x</a></span><span class="op" id="6007021">+</span><span class="num" id="6007022">0</span><span class="op" id="6007023">]</span>&nbsp;<span class="op" id="6007025">=</span>&nbsp;<span class="ident" id="6007027"><a href="/image/draw/draw.go.html#6006945">rr</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6007034"><a href="/image/draw/draw.go.html#6006690">dpix</a></span><span class="op" id="6007038">[</span><span class="ident" id="6007039"><a href="/image/draw/draw.go.html#6006859">x</a></span><span class="op" id="6007040">+</span><span class="num" id="6007041">1</span><span class="op" id="6007042">]</span>&nbsp;<span class="op" id="6007044">=</span>&nbsp;<span class="ident" id="6007046"><a href="/image/draw/draw.go.html#6006949">gg</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6007053"><a href="/image/draw/draw.go.html#6006690">dpix</a></span><span class="op" id="6007057">[</span><span class="ident" id="6007058"><a href="/image/draw/draw.go.html#6006859">x</a></span><span class="op" id="6007059">+</span><span class="num" id="6007060">2</span><span class="op" id="6007061">]</span>&nbsp;<span class="op" id="6007063">=</span>&nbsp;<span class="ident" id="6007065"><a href="/image/draw/draw.go.html#6006953">bb</a></span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6007072"><a href="/image/draw/draw.go.html#6006690">dpix</a></span><span class="op" id="6007076">[</span><span class="ident" id="6007077"><a href="/image/draw/draw.go.html#6006859">x</a></span><span class="op" id="6007078">+</span><span class="num" id="6007079">3</span><span class="op" id="6007080">]</span>&nbsp;<span class="op" id="6007082">=</span>&nbsp;<span class="num" id="6007084">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6007091">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6007095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6007098">case</span>&nbsp;<span class="ident" id="6007103"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="6007108">.</span><span class="ident" id="6007109">YCbCrSubsampleRatio420</span><span class="op" id="6007131">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6007135">for</span>&nbsp;<span class="ident" id="6007139">y</span><span class="op" id="6007140">,</span>&nbsp;<span class="ident" id="6007142">sy</span>&nbsp;<span class="op" id="6007145">:=</span>&nbsp;<span class="ident" id="6007148"><a href="/image/draw/draw.go.html#6006036">y0</a></span><span class="op" id="6007150">,</span>&nbsp;<span class="ident" id="6007152"><a href="/image/draw/draw.go.html#6005788">sp</a></span><span class="op" id="6007154">.</span><span class="ident" id="6007155">Y</span><span class="op" id="6007156">;</span>&nbsp;<span class="ident" id="6007158"><a href="/image/draw/draw.go.html#6007139">y</a></span>&nbsp;<span class="op" id="6007160">!=</span>&nbsp;<span class="ident" id="6007163"><a href="/image/draw/draw.go.html#6006068">y1</a></span><span class="op" id="6007165">;</span>&nbsp;<span class="ident" id="6007167"><a href="/image/draw/draw.go.html#6007139">y</a></span><span class="op" id="6007168">,</span>&nbsp;<span class="ident" id="6007170"><a href="/image/draw/draw.go.html#6007142">sy</a></span>&nbsp;<span class="op" id="6007173">=</span>&nbsp;<span class="ident" id="6007175"><a href="/image/draw/draw.go.html#6007139">y</a></span><span class="op" id="6007176">+</span><span class="num" id="6007177">1</span><span class="op" id="6007178">,</span>&nbsp;<span class="ident" id="6007180"><a href="/image/draw/draw.go.html#6007142">sy</a></span><span class="op" id="6007182">+</span><span class="num" id="6007183">1</span>&nbsp;<span class="op" id="6007185">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6007190">dpix</span>&nbsp;<span class="op" id="6007195">:=</span>&nbsp;<span class="ident" id="6007198"><a href="/image/draw/draw.go.html#6005734">dst</a></span><span class="op" id="6007201">.</span><span class="ident" id="6007202">Pix</span><span class="op" id="6007205">[</span><span class="ident" id="6007206"><a href="/image/draw/draw.go.html#6007139">y</a></span><span class="op" id="6007207">*</span><span class="ident" id="6007208"><a href="/image/draw/draw.go.html#6005734">dst</a></span><span class="op" id="6007211">.</span><span class="ident" id="6007212">Stride</span><span class="op" id="6007218">:</span><span class="op" id="6007219">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6007224">yi</span>&nbsp;<span class="op" id="6007227">:=</span>&nbsp;<span class="op" id="6007230">(</span><span class="ident" id="6007231"><a href="/image/draw/draw.go.html#6007142">sy</a></span><span class="op" id="6007233">-</span><span class="ident" id="6007234"><a href="/image/draw/draw.go.html#6005770">src</a></span><span class="op" id="6007237">.</span><span class="ident" id="6007238">Rect</span><span class="op" id="6007242">.</span><span class="ident" id="6007243">Min</span><span class="op" id="6007246">.</span><span class="ident" id="6007247">Y</span><span class="op" id="6007248">)</span><span class="op" id="6007249">*</span><span class="ident" id="6007250"><a href="/image/draw/draw.go.html#6005770">src</a></span><span class="op" id="6007253">.</span><span class="ident" id="6007254">YStride</span>&nbsp;<span class="op" id="6007262">+</span>&nbsp;<span class="op" id="6007264">(</span><span class="ident" id="6007265"><a href="/image/draw/draw.go.html#6005788">sp</a></span><span class="op" id="6007267">.</span><span class="ident" id="6007268">X</span>&nbsp;<span class="op" id="6007270">-</span>&nbsp;<span class="ident" id="6007272"><a href="/image/draw/draw.go.html#6005770">src</a></span><span class="op" id="6007275">.</span><span class="ident" id="6007276">Rect</span><span class="op" id="6007280">.</span><span class="ident" id="6007281">Min</span><span class="op" id="6007284">.</span><span class="ident" id="6007285">X</span><span class="op" id="6007286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6007291">ciBase</span>&nbsp;<span class="op" id="6007298">:=</span>&nbsp;<span class="op" id="6007301">(</span><span class="ident" id="6007302"><a href="/image/draw/draw.go.html#6007142">sy</a></span><span class="op" id="6007304">/</span><span class="num" id="6007305">2</span><span class="op" id="6007306">-</span><span class="ident" id="6007307"><a href="/image/draw/draw.go.html#6005770">src</a></span><span class="op" id="6007310">.</span><span class="ident" id="6007311">Rect</span><span class="op" id="6007315">.</span><span class="ident" id="6007316">Min</span><span class="op" id="6007319">.</span><span class="ident" id="6007320">Y</span><span class="op" id="6007321">/</span><span class="num" id="6007322">2</span><span class="op" id="6007323">)</span><span class="op" id="6007324">*</span><span class="ident" id="6007325"><a href="/image/draw/draw.go.html#6005770">src</a></span><span class="op" id="6007328">.</span><span class="ident" id="6007329">CStride</span>&nbsp;<span class="op" id="6007337">-</span>&nbsp;<span class="ident" id="6007339"><a href="/image/draw/draw.go.html#6005770">src</a></span><span class="op" id="6007342">.</span><span class="ident" id="6007343">Rect</span><span class="op" id="6007347">.</span><span class="ident" id="6007348">Min</span><span class="op" id="6007351">.</span><span class="ident" id="6007352">X</span><span class="op" id="6007353">/</span><span class="num" id="6007354">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6007359">for</span>&nbsp;<span class="ident" id="6007363">x</span><span class="op" id="6007364">,</span>&nbsp;<span class="ident" id="6007366">sx</span>&nbsp;<span class="op" id="6007369">:=</span>&nbsp;<span class="ident" id="6007372"><a href="/image/draw/draw.go.html#6005960">x0</a></span><span class="op" id="6007374">,</span>&nbsp;<span class="ident" id="6007376"><a href="/image/draw/draw.go.html#6005788">sp</a></span><span class="op" id="6007378">.</span><span class="ident" id="6007379">X</span><span class="op" id="6007380">;</span>&nbsp;<span class="ident" id="6007382"><a href="/image/draw/draw.go.html#6007363">x</a></span>&nbsp;<span class="op" id="6007384">!=</span>&nbsp;<span class="ident" id="6007387"><a href="/image/draw/draw.go.html#6005998">x1</a></span><span class="op" id="6007389">;</span>&nbsp;<span class="ident" id="6007391"><a href="/image/draw/draw.go.html#6007363">x</a></span><span class="op" id="6007392">,</span>&nbsp;<span class="ident" id="6007394"><a href="/image/draw/draw.go.html#6007366">sx</a></span><span class="op" id="6007396">,</span>&nbsp;<span class="ident" id="6007398"><a href="/image/draw/draw.go.html#6007224">yi</a></span>&nbsp;<span class="op" id="6007401">=</span>&nbsp;<span class="ident" id="6007403"><a href="/image/draw/draw.go.html#6007363">x</a></span><span class="op" id="6007404">+</span><span class="num" id="6007405">4</span><span class="op" id="6007406">,</span>&nbsp;<span class="ident" id="6007408"><a href="/image/draw/draw.go.html#6007366">sx</a></span><span class="op" id="6007410">+</span><span class="num" id="6007411">1</span><span class="op" id="6007412">,</span>&nbsp;<span class="ident" id="6007414"><a href="/image/draw/draw.go.html#6007224">yi</a></span><span class="op" id="6007416">+</span><span class="num" id="6007417">1</span>&nbsp;<span class="op" id="6007419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6007425">ci</span>&nbsp;<span class="op" id="6007428">:=</span>&nbsp;<span class="ident" id="6007431"><a href="/image/draw/draw.go.html#6007291">ciBase</a></span>&nbsp;<span class="op" id="6007438">+</span>&nbsp;<span class="ident" id="6007440"><a href="/image/draw/draw.go.html#6007366">sx</a></span><span class="op" id="6007442">/</span><span class="num" id="6007443">2</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6007449">rr</span><span class="op" id="6007451">,</span>&nbsp;<span class="ident" id="6007453">gg</span><span class="op" id="6007455">,</span>&nbsp;<span class="ident" id="6007457">bb</span>&nbsp;<span class="op" id="6007460">:=</span>&nbsp;<span class="ident" id="6007463"><a href="/image/draw/draw.go.html#5994644">color</a></span><span class="op" id="6007468">.</span><span class="ident" id="6007469">YCbCrToRGB</span><span class="op" id="6007479">(</span><span class="ident" id="6007480"><a href="/image/draw/draw.go.html#6005770">src</a></span><span class="op" id="6007483">.</span><span class="ident" id="6007484">Y</span><span class="op" id="6007485">[</span><span class="ident" id="6007486"><a href="/image/draw/draw.go.html#6007224">yi</a></span><span class="op" id="6007488">]</span><span class="op" id="6007489">,</span>&nbsp;<span class="ident" id="6007491"><a href="/image/draw/draw.go.html#6005770">src</a></span><span class="op" id="6007494">.</span><span class="ident" id="6007495">Cb</span><span class="op" id="6007497">[</span><span class="ident" id="6007498"><a href="/image/draw/draw.go.html#6007425">ci</a></span><span class="op" id="6007500">]</span><span class="op" id="6007501">,</span>&nbsp;<span class="ident" id="6007503"><a href="/image/draw/draw.go.html#6005770">src</a></span><span class="op" id="6007506">.</span><span class="ident" id="6007507">Cr</span><span class="op" id="6007509">[</span><span class="ident" id="6007510"><a href="/image/draw/draw.go.html#6007425">ci</a></span><span class="op" id="6007512">]</span><span class="op" id="6007513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6007519"><a href="/image/draw/draw.go.html#6007190">dpix</a></span><span class="op" id="6007523">[</span><span class="ident" id="6007524"><a href="/image/draw/draw.go.html#6007363">x</a></span><span class="op" id="6007525">+</span><span class="num" id="6007526">0</span><span class="op" id="6007527">]</span>&nbsp;<span class="op" id="6007529">=</span>&nbsp;<span class="ident" id="6007531"><a href="/image/draw/draw.go.html#6007449">rr</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6007538"><a href="/image/draw/draw.go.html#6007190">dpix</a></span><span class="op" id="6007542">[</span><span class="ident" id="6007543"><a href="/image/draw/draw.go.html#6007363">x</a></span><span class="op" id="6007544">+</span><span class="num" id="6007545">1</span><span class="op" id="6007546">]</span>&nbsp;<span class="op" id="6007548">=</span>&nbsp;<span class="ident" id="6007550"><a href="/image/draw/draw.go.html#6007453">gg</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6007557"><a href="/image/draw/draw.go.html#6007190">dpix</a></span><span class="op" id="6007561">[</span><span class="ident" id="6007562"><a href="/image/draw/draw.go.html#6007363">x</a></span><span class="op" id="6007563">+</span><span class="num" id="6007564">2</span><span class="op" id="6007565">]</span>&nbsp;<span class="op" id="6007567">=</span>&nbsp;<span class="ident" id="6007569"><a href="/image/draw/draw.go.html#6007457">bb</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6007576"><a href="/image/draw/draw.go.html#6007190">dpix</a></span><span class="op" id="6007580">[</span><span class="ident" id="6007581"><a href="/image/draw/draw.go.html#6007363">x</a></span><span class="op" id="6007582">+</span><span class="num" id="6007583">3</span><span class="op" id="6007584">]</span>&nbsp;<span class="op" id="6007586">=</span>&nbsp;<span class="num" id="6007588">255</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6007595">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6007599">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6007602">case</span>&nbsp;<span class="ident" id="6007607"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="6007612">.</span><span class="ident" id="6007613">YCbCrSubsampleRatio440</span><span class="op" id="6007635">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6007639">for</span>&nbsp;<span class="ident" id="6007643">y</span><span class="op" id="6007644">,</span>&nbsp;<span class="ident" id="6007646">sy</span>&nbsp;<span class="op" id="6007649">:=</span>&nbsp;<span class="ident" id="6007652"><a href="/image/draw/draw.go.html#6006036">y0</a></span><span class="op" id="6007654">,</span>&nbsp;<span class="ident" id="6007656"><a href="/image/draw/draw.go.html#6005788">sp</a></span><span class="op" id="6007658">.</span><span class="ident" id="6007659">Y</span><span class="op" id="6007660">;</span>&nbsp;<span class="ident" id="6007662"><a href="/image/draw/draw.go.html#6007643">y</a></span>&nbsp;<span class="op" id="6007664">!=</span>&nbsp;<span class="ident" id="6007667"><a href="/image/draw/draw.go.html#6006068">y1</a></span><span class="op" id="6007669">;</span>&nbsp;<span class="ident" id="6007671"><a href="/image/draw/draw.go.html#6007643">y</a></span><span class="op" id="6007672">,</span>&nbsp;<span class="ident" id="6007674"><a href="/image/draw/draw.go.html#6007646">sy</a></span>&nbsp;<span class="op" id="6007677">=</span>&nbsp;<span class="ident" id="6007679"><a href="/image/draw/draw.go.html#6007643">y</a></span><span class="op" id="6007680">+</span><span class="num" id="6007681">1</span><span class="op" id="6007682">,</span>&nbsp;<span class="ident" id="6007684"><a href="/image/draw/draw.go.html#6007646">sy</a></span><span class="op" id="6007686">+</span><span class="num" id="6007687">1</span>&nbsp;<span class="op" id="6007689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6007694">dpix</span>&nbsp;<span class="op" id="6007699">:=</span>&nbsp;<span class="ident" id="6007702"><a href="/image/draw/draw.go.html#6005734">dst</a></span><span class="op" id="6007705">.</span><span class="ident" id="6007706">Pix</span><span class="op" id="6007709">[</span><span class="ident" id="6007710"><a href="/image/draw/draw.go.html#6007643">y</a></span><span class="op" id="6007711">*</span><span class="ident" id="6007712"><a href="/image/draw/draw.go.html#6005734">dst</a></span><span class="op" id="6007715">.</span><span class="ident" id="6007716">Stride</span><span class="op" id="6007722">:</span><span class="op" id="6007723">]</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6007728">yi</span>&nbsp;<span class="op" id="6007731">:=</span>&nbsp;<span class="op" id="6007734">(</span><span class="ident" id="6007735"><a href="/image/draw/draw.go.html#6007646">sy</a></span><span class="op" id="6007737">-</span><span class="ident" id="6007738"><a href="/image/draw/draw.go.html#6005770">src</a></span><span class="op" id="6007741">.</span><span class="ident" id="6007742">Rect</span><span class="op" id="6007746">.</span><span class="ident" id="6007747">Min</span><span class="op" id="6007750">.</span><span class="ident" id="6007751">Y</span><span class="op" id="6007752">)</span><span class="op" id="6007753">*</span><span class="ident" id="6007754"><a href="/image/draw/draw.go.html#6005770">src</a></span><span class="op" id="6007757">.</span><span class="ident" id="6007758">YStride</span>&nbsp;<span class="op" id="6007766">+</span>&nbsp;<span class="op" id="6007768">(</span><span class="ident" id="6007769"><a href="/image/draw/draw.go.html#6005788">sp</a></span><span class="op" id="6007771">.</span><span class="ident" id="6007772">X</span>&nbsp;<span class="op" id="6007774">-</span>&nbsp;<span class="ident" id="6007776"><a href="/image/draw/draw.go.html#6005770">src</a></span><span class="op" id="6007779">.</span><span class="ident" id="6007780">Rect</span><span class="op" id="6007784">.</span><span class="ident" id="6007785">Min</span><span class="op" id="6007788">.</span><span class="ident" id="6007789">X</span><span class="op" id="6007790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6007795">ci</span>&nbsp;<span class="op" id="6007798">:=</span>&nbsp;<span class="op" id="6007801">(</span><span class="ident" id="6007802"><a href="/image/draw/draw.go.html#6007646">sy</a></span><span class="op" id="6007804">/</span><span class="num" id="6007805">2</span><span class="op" id="6007806">-</span><span class="ident" id="6007807"><a href="/image/draw/draw.go.html#6005770">src</a></span><span class="op" id="6007810">.</span><span class="ident" id="6007811">Rect</span><span class="op" id="6007815">.</span><span class="ident" id="6007816">Min</span><span class="op" id="6007819">.</span><span class="ident" id="6007820">Y</span><span class="op" id="6007821">/</span><span class="num" id="6007822">2</span><span class="op" id="6007823">)</span><span class="op" id="6007824">*</span><span class="ident" id="6007825"><a href="/image/draw/draw.go.html#6005770">src</a></span><span class="op" id="6007828">.</span><span class="ident" id="6007829">CStride</span>&nbsp;<span class="op" id="6007837">+</span>&nbsp;<span class="op" id="6007839">(</span><span class="ident" id="6007840"><a href="/image/draw/draw.go.html#6005788">sp</a></span><span class="op" id="6007842">.</span><span class="ident" id="6007843">X</span>&nbsp;<span class="op" id="6007845">-</span>&nbsp;<span class="ident" id="6007847"><a href="/image/draw/draw.go.html#6005770">src</a></span><span class="op" id="6007850">.</span><span class="ident" id="6007851">Rect</span><span class="op" id="6007855">.</span><span class="ident" id="6007856">Min</span><span class="op" id="6007859">.</span><span class="ident" id="6007860">X</span><span class="op" id="6007861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6007866">for</span>&nbsp;<span class="ident" id="6007870">x</span>&nbsp;<span class="op" id="6007872">:=</span>&nbsp;<span class="ident" id="6007875"><a href="/image/draw/draw.go.html#6005960">x0</a></span><span class="op" id="6007877">;</span>&nbsp;<span class="ident" id="6007879"><a href="/image/draw/draw.go.html#6007870">x</a></span>&nbsp;<span class="op" id="6007881">!=</span>&nbsp;<span class="ident" id="6007884"><a href="/image/draw/draw.go.html#6005998">x1</a></span><span class="op" id="6007886">;</span>&nbsp;<span class="ident" id="6007888"><a href="/image/draw/draw.go.html#6007870">x</a></span><span class="op" id="6007889">,</span>&nbsp;<span class="ident" id="6007891"><a href="/image/draw/draw.go.html#6007728">yi</a></span><span class="op" id="6007893">,</span>&nbsp;<span class="ident" id="6007895"><a href="/image/draw/draw.go.html#6007795">ci</a></span>&nbsp;<span class="op" id="6007898">=</span>&nbsp;<span class="ident" id="6007900"><a href="/image/draw/draw.go.html#6007870">x</a></span><span class="op" id="6007901">+</span><span class="num" id="6007902">4</span><span class="op" id="6007903">,</span>&nbsp;<span class="ident" id="6007905"><a href="/image/draw/draw.go.html#6007728">yi</a></span><span class="op" id="6007907">+</span><span class="num" id="6007908">1</span><span class="op" id="6007909">,</span>&nbsp;<span class="ident" id="6007911"><a href="/image/draw/draw.go.html#6007795">ci</a></span><span class="op" id="6007913">+</span><span class="num" id="6007914">1</span>&nbsp;<span class="op" id="6007916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6007922">rr</span><span class="op" id="6007924">,</span>&nbsp;<span class="ident" id="6007926">gg</span><span class="op" id="6007928">,</span>&nbsp;<span class="ident" id="6007930">bb</span>&nbsp;<span class="op" id="6007933">:=</span>&nbsp;<span class="ident" id="6007936"><a href="/image/draw/draw.go.html#5994644">color</a></span><span class="op" id="6007941">.</span><span class="ident" id="6007942">YCbCrToRGB</span><span class="op" id="6007952">(</span><span class="ident" id="6007953"><a href="/image/draw/draw.go.html#6005770">src</a></span><span class="op" id="6007956">.</span><span class="ident" id="6007957">Y</span><span class="op" id="6007958">[</span><span class="ident" id="6007959"><a href="/image/draw/draw.go.html#6007728">yi</a></span><span class="op" id="6007961">]</span><span class="op" id="6007962">,</span>&nbsp;<span class="ident" id="6007964"><a href="/image/draw/draw.go.html#6005770">src</a></span><span class="op" id="6007967">.</span><span class="ident" id="6007968">Cb</span><span class="op" id="6007970">[</span><span class="ident" id="6007971"><a href="/image/draw/draw.go.html#6007795">ci</a></span><span class="op" id="6007973">]</span><span class="op" id="6007974">,</span>&nbsp;<span class="ident" id="6007976"><a href="/image/draw/draw.go.html#6005770">src</a></span><span class="op" id="6007979">.</span><span class="ident" id="6007980">Cr</span><span class="op" id="6007982">[</span><span class="ident" id="6007983"><a href="/image/draw/draw.go.html#6007795">ci</a></span><span class="op" id="6007985">]</span><span class="op" id="6007986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6007992"><a href="/image/draw/draw.go.html#6007694">dpix</a></span><span class="op" id="6007996">[</span><span class="ident" id="6007997"><a href="/image/draw/draw.go.html#6007870">x</a></span><span class="op" id="6007998">+</span><span class="num" id="6007999">0</span><span class="op" id="6008000">]</span>&nbsp;<span class="op" id="6008002">=</span>&nbsp;<span class="ident" id="6008004"><a href="/image/draw/draw.go.html#6007922">rr</a></span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6008011"><a href="/image/draw/draw.go.html#6007694">dpix</a></span><span class="op" id="6008015">[</span><span class="ident" id="6008016"><a href="/image/draw/draw.go.html#6007870">x</a></span><span class="op" id="6008017">+</span><span class="num" id="6008018">1</span><span class="op" id="6008019">]</span>&nbsp;<span class="op" id="6008021">=</span>&nbsp;<span class="ident" id="6008023"><a href="/image/draw/draw.go.html#6007926">gg</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6008030"><a href="/image/draw/draw.go.html#6007694">dpix</a></span><span class="op" id="6008034">[</span><span class="ident" id="6008035"><a href="/image/draw/draw.go.html#6007870">x</a></span><span class="op" id="6008036">+</span><span class="num" id="6008037">2</span><span class="op" id="6008038">]</span>&nbsp;<span class="op" id="6008040">=</span>&nbsp;<span class="ident" id="6008042"><a href="/image/draw/draw.go.html#6007930">bb</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6008049"><a href="/image/draw/draw.go.html#6007694">dpix</a></span><span class="op" id="6008053">[</span><span class="ident" id="6008054"><a href="/image/draw/draw.go.html#6007870">x</a></span><span class="op" id="6008055">+</span><span class="num" id="6008056">3</span><span class="op" id="6008057">]</span>&nbsp;<span class="op" id="6008059">=</span>&nbsp;<span class="num" id="6008061">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6008068">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6008072">}</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6008075">default</span><span class="op" id="6008082">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6008086">return</span>&nbsp;<span class="builtintype" id="6008093">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6008100">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6008103">return</span>&nbsp;<span class="builtintype" id="6008110">true</span><br>
<span class="lineno"></span><span class="op" id="6008115">}</span><br>
<span class="lineno">460</span><br>
<span class="lineno"></span><span class="keyword" id="6008118">func</span>&nbsp;<span class="ident" id="6008123">drawGlyphOver</span><span class="op" id="6008136">(</span><span class="ident" id="6008137">dst</span>&nbsp;<span class="op" id="6008141">*</span><span class="ident" id="6008142"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="6008147">.</span><span class="ident" id="6008148">RGBA</span><span class="op" id="6008152">,</span>&nbsp;<span class="ident" id="6008154">r</span>&nbsp;<span class="ident" id="6008156"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="6008161">.</span><span class="ident" id="6008162">Rectangle</span><span class="op" id="6008171">,</span>&nbsp;<span class="ident" id="6008173">src</span>&nbsp;<span class="op" id="6008177">*</span><span class="ident" id="6008178"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="6008183">.</span><span class="ident" id="6008184">Uniform</span><span class="op" id="6008191">,</span>&nbsp;<span class="ident" id="6008193">mask</span>&nbsp;<span class="op" id="6008198">*</span><span class="ident" id="6008199"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="6008204">.</span><span class="ident" id="6008205">Alpha</span><span class="op" id="6008210">,</span>&nbsp;<span class="ident" id="6008212">mp</span>&nbsp;<span class="ident" id="6008215"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="6008220">.</span><span class="ident" id="6008221">Point</span><span class="op" id="6008226">)</span>&nbsp;<span class="op" id="6008228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6008231">i0</span>&nbsp;<span class="op" id="6008234">:=</span>&nbsp;<span class="ident" id="6008237"><a href="/image/draw/draw.go.html#6008137">dst</a></span><span class="op" id="6008240">.</span><span class="ident" id="6008241">PixOffset</span><span class="op" id="6008250">(</span><span class="ident" id="6008251"><a href="/image/draw/draw.go.html#6008154">r</a></span><span class="op" id="6008252">.</span><span class="ident" id="6008253">Min</span><span class="op" id="6008256">.</span><span class="ident" id="6008257">X</span><span class="op" id="6008258">,</span>&nbsp;<span class="ident" id="6008260"><a href="/image/draw/draw.go.html#6008154">r</a></span><span class="op" id="6008261">.</span><span class="ident" id="6008262">Min</span><span class="op" id="6008265">.</span><span class="ident" id="6008266">Y</span><span class="op" id="6008267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6008270">i1</span>&nbsp;<span class="op" id="6008273">:=</span>&nbsp;<span class="ident" id="6008276"><a href="/image/draw/draw.go.html#6008231">i0</a></span>&nbsp;<span class="op" id="6008279">+</span>&nbsp;<span class="ident" id="6008281"><a href="/image/draw/draw.go.html#6008154">r</a></span><span class="op" id="6008282">.</span><span class="ident" id="6008283">Dx</span><span class="op" id="6008285">(</span><span class="op" id="6008286">)</span><span class="op" id="6008287">*</span><span class="num" id="6008288">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6008291">mi0</span>&nbsp;<span class="op" id="6008295">:=</span>&nbsp;<span class="ident" id="6008298"><a href="/image/draw/draw.go.html#6008193">mask</a></span><span class="op" id="6008302">.</span><span class="ident" id="6008303">PixOffset</span><span class="op" id="6008312">(</span><span class="ident" id="6008313"><a href="/image/draw/draw.go.html#6008212">mp</a></span><span class="op" id="6008315">.</span><span class="ident" id="6008316">X</span><span class="op" id="6008317">,</span>&nbsp;<span class="ident" id="6008319"><a href="/image/draw/draw.go.html#6008212">mp</a></span><span class="op" id="6008321">.</span><span class="ident" id="6008322">Y</span><span class="op" id="6008323">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6008326">sr</span><span class="op" id="6008328">,</span>&nbsp;<span class="ident" id="6008330">sg</span><span class="op" id="6008332">,</span>&nbsp;<span class="ident" id="6008334">sb</span><span class="op" id="6008336">,</span>&nbsp;<span class="ident" id="6008338">sa</span>&nbsp;<span class="op" id="6008341">:=</span>&nbsp;<span class="ident" id="6008344"><a href="/image/draw/draw.go.html#6008173">src</a></span><span class="op" id="6008347">.</span><span class="ident" id="6008348">RGBA</span><span class="op" id="6008352">(</span><span class="op" id="6008353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6008356">for</span>&nbsp;<span class="ident" id="6008360">y</span><span class="op" id="6008361">,</span>&nbsp;<span class="ident" id="6008363">my</span>&nbsp;<span class="op" id="6008366">:=</span>&nbsp;<span class="ident" id="6008369"><a href="/image/draw/draw.go.html#6008154">r</a></span><span class="op" id="6008370">.</span><span class="ident" id="6008371">Min</span><span class="op" id="6008374">.</span><span class="ident" id="6008375">Y</span><span class="op" id="6008376">,</span>&nbsp;<span class="ident" id="6008378"><a href="/image/draw/draw.go.html#6008212">mp</a></span><span class="op" id="6008380">.</span><span class="ident" id="6008381">Y</span><span class="op" id="6008382">;</span>&nbsp;<span class="ident" id="6008384"><a href="/image/draw/draw.go.html#6008360">y</a></span>&nbsp;<span class="op" id="6008386">!=</span>&nbsp;<span class="ident" id="6008389"><a href="/image/draw/draw.go.html#6008154">r</a></span><span class="op" id="6008390">.</span><span class="ident" id="6008391">Max</span><span class="op" id="6008394">.</span><span class="ident" id="6008395">Y</span><span class="op" id="6008396">;</span>&nbsp;<span class="ident" id="6008398"><a href="/image/draw/draw.go.html#6008360">y</a></span><span class="op" id="6008399">,</span>&nbsp;<span class="ident" id="6008401"><a href="/image/draw/draw.go.html#6008363">my</a></span>&nbsp;<span class="op" id="6008404">=</span>&nbsp;<span class="ident" id="6008406"><a href="/image/draw/draw.go.html#6008360">y</a></span><span class="op" id="6008407">+</span><span class="num" id="6008408">1</span><span class="op" id="6008409">,</span>&nbsp;<span class="ident" id="6008411"><a href="/image/draw/draw.go.html#6008363">my</a></span><span class="op" id="6008413">+</span><span class="num" id="6008414">1</span>&nbsp;<span class="op" id="6008416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6008420">for</span>&nbsp;<span class="ident" id="6008424">i</span><span class="op" id="6008425">,</span>&nbsp;<span class="ident" id="6008427">mi</span>&nbsp;<span class="op" id="6008430">:=</span>&nbsp;<span class="ident" id="6008433"><a href="/image/draw/draw.go.html#6008231">i0</a></span><span class="op" id="6008435">,</span>&nbsp;<span class="ident" id="6008437"><a href="/image/draw/draw.go.html#6008291">mi0</a></span><span class="op" id="6008440">;</span>&nbsp;<span class="ident" id="6008442"><a href="/image/draw/draw.go.html#6008424">i</a></span>&nbsp;<span class="op" id="6008444">&lt;</span>&nbsp;<span class="ident" id="6008446"><a href="/image/draw/draw.go.html#6008270">i1</a></span><span class="op" id="6008448">;</span>&nbsp;<span class="ident" id="6008450"><a href="/image/draw/draw.go.html#6008424">i</a></span><span class="op" id="6008451">,</span>&nbsp;<span class="ident" id="6008453"><a href="/image/draw/draw.go.html#6008427">mi</a></span>&nbsp;<span class="op" id="6008456">=</span>&nbsp;<span class="ident" id="6008458"><a href="/image/draw/draw.go.html#6008424">i</a></span><span class="op" id="6008459">+</span><span class="num" id="6008460">4</span><span class="op" id="6008461">,</span>&nbsp;<span class="ident" id="6008463"><a href="/image/draw/draw.go.html#6008427">mi</a></span><span class="op" id="6008465">+</span><span class="num" id="6008466">1</span>&nbsp;<span class="op" id="6008468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6008473">ma</span>&nbsp;<span class="op" id="6008476">:=</span>&nbsp;<span class="builtintype" id="6008479">uint32</span><span class="op" id="6008485">(</span><span class="ident" id="6008486"><a href="/image/draw/draw.go.html#6008193">mask</a></span><span class="op" id="6008490">.</span><span class="ident" id="6008491">Pix</span><span class="op" id="6008494">[</span><span class="ident" id="6008495"><a href="/image/draw/draw.go.html#6008427">mi</a></span><span class="op" id="6008497">]</span><span class="op" id="6008498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6008503">if</span>&nbsp;<span class="ident" id="6008506"><a href="/image/draw/draw.go.html#6008473">ma</a></span>&nbsp;<span class="op" id="6008509">==</span>&nbsp;<span class="num" id="6008512">0</span>&nbsp;<span class="op" id="6008514">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6008520">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6008532">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6008537"><a href="/image/draw/draw.go.html#6008473">ma</a></span>&nbsp;<span class="op" id="6008540">|=</span>&nbsp;<span class="ident" id="6008543"><a href="/image/draw/draw.go.html#6008473">ma</a></span>&nbsp;<span class="op" id="6008546">&lt;&lt;</span>&nbsp;<span class="num" id="6008549">8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6008555">dr</span>&nbsp;<span class="op" id="6008558">:=</span>&nbsp;<span class="builtintype" id="6008561">uint32</span><span class="op" id="6008567">(</span><span class="ident" id="6008568"><a href="/image/draw/draw.go.html#6008137">dst</a></span><span class="op" id="6008571">.</span><span class="ident" id="6008572">Pix</span><span class="op" id="6008575">[</span><span class="ident" id="6008576"><a href="/image/draw/draw.go.html#6008424">i</a></span><span class="op" id="6008577">+</span><span class="num" id="6008578">0</span><span class="op" id="6008579">]</span><span class="op" id="6008580">)</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6008585">dg</span>&nbsp;<span class="op" id="6008588">:=</span>&nbsp;<span class="builtintype" id="6008591">uint32</span><span class="op" id="6008597">(</span><span class="ident" id="6008598"><a href="/image/draw/draw.go.html#6008137">dst</a></span><span class="op" id="6008601">.</span><span class="ident" id="6008602">Pix</span><span class="op" id="6008605">[</span><span class="ident" id="6008606"><a href="/image/draw/draw.go.html#6008424">i</a></span><span class="op" id="6008607">+</span><span class="num" id="6008608">1</span><span class="op" id="6008609">]</span><span class="op" id="6008610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6008615">db</span>&nbsp;<span class="op" id="6008618">:=</span>&nbsp;<span class="builtintype" id="6008621">uint32</span><span class="op" id="6008627">(</span><span class="ident" id="6008628"><a href="/image/draw/draw.go.html#6008137">dst</a></span><span class="op" id="6008631">.</span><span class="ident" id="6008632">Pix</span><span class="op" id="6008635">[</span><span class="ident" id="6008636"><a href="/image/draw/draw.go.html#6008424">i</a></span><span class="op" id="6008637">+</span><span class="num" id="6008638">2</span><span class="op" id="6008639">]</span><span class="op" id="6008640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6008645">da</span>&nbsp;<span class="op" id="6008648">:=</span>&nbsp;<span class="builtintype" id="6008651">uint32</span><span class="op" id="6008657">(</span><span class="ident" id="6008658"><a href="/image/draw/draw.go.html#6008137">dst</a></span><span class="op" id="6008661">.</span><span class="ident" id="6008662">Pix</span><span class="op" id="6008665">[</span><span class="ident" id="6008666"><a href="/image/draw/draw.go.html#6008424">i</a></span><span class="op" id="6008667">+</span><span class="num" id="6008668">3</span><span class="op" id="6008669">]</span><span class="op" id="6008670">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6008676">//&nbsp;The&nbsp;0x101&nbsp;is&nbsp;here&nbsp;for&nbsp;the&nbsp;same&nbsp;reason&nbsp;as&nbsp;in&nbsp;drawRGBA.</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6008736">a</span>&nbsp;<span class="op" id="6008738">:=</span>&nbsp;<span class="op" id="6008741">(</span><span class="ident" id="6008742"><a href="/image/draw/draw.go.html#5994729">m</a></span>&nbsp;<span class="op" id="6008744">-</span>&nbsp;<span class="op" id="6008746">(</span><span class="ident" id="6008747"><a href="/image/draw/draw.go.html#6008338">sa</a></span>&nbsp;<span class="op" id="6008750">*</span>&nbsp;<span class="ident" id="6008752"><a href="/image/draw/draw.go.html#6008473">ma</a></span>&nbsp;<span class="op" id="6008755">/</span>&nbsp;<span class="ident" id="6008757"><a href="/image/draw/draw.go.html#5994729">m</a></span><span class="op" id="6008758">)</span><span class="op" id="6008759">)</span>&nbsp;<span class="op" id="6008761">*</span>&nbsp;<span class="num" id="6008763">0x101</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6008773"><a href="/image/draw/draw.go.html#6008137">dst</a></span><span class="op" id="6008776">.</span><span class="ident" id="6008777">Pix</span><span class="op" id="6008780">[</span><span class="ident" id="6008781"><a href="/image/draw/draw.go.html#6008424">i</a></span><span class="op" id="6008782">+</span><span class="num" id="6008783">0</span><span class="op" id="6008784">]</span>&nbsp;<span class="op" id="6008786">=</span>&nbsp;<span class="builtintype" id="6008788">uint8</span><span class="op" id="6008793">(</span><span class="op" id="6008794">(</span><span class="ident" id="6008795"><a href="/image/draw/draw.go.html#6008555">dr</a></span><span class="op" id="6008797">*</span><span class="ident" id="6008798"><a href="/image/draw/draw.go.html#6008736">a</a></span>&nbsp;<span class="op" id="6008800">+</span>&nbsp;<span class="ident" id="6008802"><a href="/image/draw/draw.go.html#6008326">sr</a></span><span class="op" id="6008804">*</span><span class="ident" id="6008805"><a href="/image/draw/draw.go.html#6008473">ma</a></span><span class="op" id="6008807">)</span>&nbsp;<span class="op" id="6008809">/</span>&nbsp;<span class="ident" id="6008811"><a href="/image/draw/draw.go.html#5994729">m</a></span>&nbsp;<span class="op" id="6008813">&gt;&gt;</span>&nbsp;<span class="num" id="6008816">8</span><span class="op" id="6008817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6008822"><a href="/image/draw/draw.go.html#6008137">dst</a></span><span class="op" id="6008825">.</span><span class="ident" id="6008826">Pix</span><span class="op" id="6008829">[</span><span class="ident" id="6008830"><a href="/image/draw/draw.go.html#6008424">i</a></span><span class="op" id="6008831">+</span><span class="num" id="6008832">1</span><span class="op" id="6008833">]</span>&nbsp;<span class="op" id="6008835">=</span>&nbsp;<span class="builtintype" id="6008837">uint8</span><span class="op" id="6008842">(</span><span class="op" id="6008843">(</span><span class="ident" id="6008844"><a href="/image/draw/draw.go.html#6008585">dg</a></span><span class="op" id="6008846">*</span><span class="ident" id="6008847"><a href="/image/draw/draw.go.html#6008736">a</a></span>&nbsp;<span class="op" id="6008849">+</span>&nbsp;<span class="ident" id="6008851"><a href="/image/draw/draw.go.html#6008330">sg</a></span><span class="op" id="6008853">*</span><span class="ident" id="6008854"><a href="/image/draw/draw.go.html#6008473">ma</a></span><span class="op" id="6008856">)</span>&nbsp;<span class="op" id="6008858">/</span>&nbsp;<span class="ident" id="6008860"><a href="/image/draw/draw.go.html#5994729">m</a></span>&nbsp;<span class="op" id="6008862">&gt;&gt;</span>&nbsp;<span class="num" id="6008865">8</span><span class="op" id="6008866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6008871"><a href="/image/draw/draw.go.html#6008137">dst</a></span><span class="op" id="6008874">.</span><span class="ident" id="6008875">Pix</span><span class="op" id="6008878">[</span><span class="ident" id="6008879"><a href="/image/draw/draw.go.html#6008424">i</a></span><span class="op" id="6008880">+</span><span class="num" id="6008881">2</span><span class="op" id="6008882">]</span>&nbsp;<span class="op" id="6008884">=</span>&nbsp;<span class="builtintype" id="6008886">uint8</span><span class="op" id="6008891">(</span><span class="op" id="6008892">(</span><span class="ident" id="6008893"><a href="/image/draw/draw.go.html#6008615">db</a></span><span class="op" id="6008895">*</span><span class="ident" id="6008896"><a href="/image/draw/draw.go.html#6008736">a</a></span>&nbsp;<span class="op" id="6008898">+</span>&nbsp;<span class="ident" id="6008900"><a href="/image/draw/draw.go.html#6008334">sb</a></span><span class="op" id="6008902">*</span><span class="ident" id="6008903"><a href="/image/draw/draw.go.html#6008473">ma</a></span><span class="op" id="6008905">)</span>&nbsp;<span class="op" id="6008907">/</span>&nbsp;<span class="ident" id="6008909"><a href="/image/draw/draw.go.html#5994729">m</a></span>&nbsp;<span class="op" id="6008911">&gt;&gt;</span>&nbsp;<span class="num" id="6008914">8</span><span class="op" id="6008915">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6008920"><a href="/image/draw/draw.go.html#6008137">dst</a></span><span class="op" id="6008923">.</span><span class="ident" id="6008924">Pix</span><span class="op" id="6008927">[</span><span class="ident" id="6008928"><a href="/image/draw/draw.go.html#6008424">i</a></span><span class="op" id="6008929">+</span><span class="num" id="6008930">3</span><span class="op" id="6008931">]</span>&nbsp;<span class="op" id="6008933">=</span>&nbsp;<span class="builtintype" id="6008935">uint8</span><span class="op" id="6008940">(</span><span class="op" id="6008941">(</span><span class="ident" id="6008942"><a href="/image/draw/draw.go.html#6008645">da</a></span><span class="op" id="6008944">*</span><span class="ident" id="6008945"><a href="/image/draw/draw.go.html#6008736">a</a></span>&nbsp;<span class="op" id="6008947">+</span>&nbsp;<span class="ident" id="6008949"><a href="/image/draw/draw.go.html#6008338">sa</a></span><span class="op" id="6008951">*</span><span class="ident" id="6008952"><a href="/image/draw/draw.go.html#6008473">ma</a></span><span class="op" id="6008954">)</span>&nbsp;<span class="op" id="6008956">/</span>&nbsp;<span class="ident" id="6008958"><a href="/image/draw/draw.go.html#5994729">m</a></span>&nbsp;<span class="op" id="6008960">&gt;&gt;</span>&nbsp;<span class="num" id="6008963">8</span><span class="op" id="6008964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6008968">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6008972"><a href="/image/draw/draw.go.html#6008231">i0</a></span>&nbsp;<span class="op" id="6008975">+=</span>&nbsp;<span class="ident" id="6008978"><a href="/image/draw/draw.go.html#6008137">dst</a></span><span class="op" id="6008981">.</span><span class="ident" id="6008982">Stride</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6008991"><a href="/image/draw/draw.go.html#6008270">i1</a></span>&nbsp;<span class="op" id="6008994">+=</span>&nbsp;<span class="ident" id="6008997"><a href="/image/draw/draw.go.html#6008137">dst</a></span><span class="op" id="6009000">.</span><span class="ident" id="6009001">Stride</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6009010"><a href="/image/draw/draw.go.html#6008291">mi0</a></span>&nbsp;<span class="op" id="6009014">+=</span>&nbsp;<span class="ident" id="6009017"><a href="/image/draw/draw.go.html#6008193">mask</a></span><span class="op" id="6009021">.</span><span class="ident" id="6009022">Stride</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6009030">}</span><br>
<span class="lineno"></span><span class="op" id="6009032">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6009035">func</span>&nbsp;<span class="ident" id="6009040">drawRGBA</span><span class="op" id="6009048">(</span><span class="ident" id="6009049">dst</span>&nbsp;<span class="op" id="6009053">*</span><span class="ident" id="6009054"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="6009059">.</span><span class="ident" id="6009060">RGBA</span><span class="op" id="6009064">,</span>&nbsp;<span class="ident" id="6009066">r</span>&nbsp;<span class="ident" id="6009068"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="6009073">.</span><span class="ident" id="6009074">Rectangle</span><span class="op" id="6009083">,</span>&nbsp;<span class="ident" id="6009085">src</span>&nbsp;<span class="ident" id="6009089"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="6009094">.</span><span class="ident" id="6009095">Image</span><span class="op" id="6009100">,</span>&nbsp;<span class="ident" id="6009102">sp</span>&nbsp;<span class="ident" id="6009105"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="6009110">.</span><span class="ident" id="6009111">Point</span><span class="op" id="6009116">,</span>&nbsp;<span class="ident" id="6009118">mask</span>&nbsp;<span class="ident" id="6009123"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="6009128">.</span><span class="ident" id="6009129">Image</span><span class="op" id="6009134">,</span>&nbsp;<span class="ident" id="6009136">mp</span>&nbsp;<span class="ident" id="6009139"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="6009144">.</span><span class="ident" id="6009145">Point</span><span class="op" id="6009150">,</span>&nbsp;<span class="ident" id="6009152">op</span>&nbsp;<span class="ident" id="6009155"><a href="/image/draw/draw.go.html#5995204">Op</a></span><span class="op" id="6009157">)</span>&nbsp;<span class="op" id="6009159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6009162">x0</span><span class="op" id="6009164">,</span>&nbsp;<span class="ident" id="6009166">x1</span><span class="op" id="6009168">,</span>&nbsp;<span class="ident" id="6009170">dx</span>&nbsp;<span class="op" id="6009173">:=</span>&nbsp;<span class="ident" id="6009176"><a href="/image/draw/draw.go.html#6009066">r</a></span><span class="op" id="6009177">.</span><span class="ident" id="6009178">Min</span><span class="op" id="6009181">.</span><span class="ident" id="6009182">X</span><span class="op" id="6009183">,</span>&nbsp;<span class="ident" id="6009185"><a href="/image/draw/draw.go.html#6009066">r</a></span><span class="op" id="6009186">.</span><span class="ident" id="6009187">Max</span><span class="op" id="6009190">.</span><span class="ident" id="6009191">X</span><span class="op" id="6009192">,</span>&nbsp;<span class="num" id="6009194">1</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6009197">y0</span><span class="op" id="6009199">,</span>&nbsp;<span class="ident" id="6009201">y1</span><span class="op" id="6009203">,</span>&nbsp;<span class="ident" id="6009205">dy</span>&nbsp;<span class="op" id="6009208">:=</span>&nbsp;<span class="ident" id="6009211"><a href="/image/draw/draw.go.html#6009066">r</a></span><span class="op" id="6009212">.</span><span class="ident" id="6009213">Min</span><span class="op" id="6009216">.</span><span class="ident" id="6009217">Y</span><span class="op" id="6009218">,</span>&nbsp;<span class="ident" id="6009220"><a href="/image/draw/draw.go.html#6009066">r</a></span><span class="op" id="6009221">.</span><span class="ident" id="6009222">Max</span><span class="op" id="6009225">.</span><span class="ident" id="6009226">Y</span><span class="op" id="6009227">,</span>&nbsp;<span class="num" id="6009229">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6009232">if</span>&nbsp;<span class="ident" id="6009235"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="6009240">.</span><span class="ident" id="6009241">Image</span><span class="op" id="6009246">(</span><span class="ident" id="6009247"><a href="/image/draw/draw.go.html#6009049">dst</a></span><span class="op" id="6009250">)</span>&nbsp;<span class="op" id="6009252">==</span>&nbsp;<span class="ident" id="6009255"><a href="/image/draw/draw.go.html#6009085">src</a></span>&nbsp;<span class="op" id="6009259">&amp;&amp;</span>&nbsp;<span class="ident" id="6009262"><a href="/image/draw/draw.go.html#6009066">r</a></span><span class="op" id="6009263">.</span><span class="ident" id="6009264">Overlaps</span><span class="op" id="6009272">(</span><span class="ident" id="6009273"><a href="/image/draw/draw.go.html#6009066">r</a></span><span class="op" id="6009274">.</span><span class="ident" id="6009275">Add</span><span class="op" id="6009278">(</span><span class="ident" id="6009279"><a href="/image/draw/draw.go.html#6009102">sp</a></span><span class="op" id="6009281">.</span><span class="ident" id="6009282">Sub</span><span class="op" id="6009285">(</span><span class="ident" id="6009286"><a href="/image/draw/draw.go.html#6009066">r</a></span><span class="op" id="6009287">.</span><span class="ident" id="6009288">Min</span><span class="op" id="6009291">)</span><span class="op" id="6009292">)</span><span class="op" id="6009293">)</span>&nbsp;<span class="op" id="6009295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6009299">if</span>&nbsp;<span class="ident" id="6009302"><a href="/image/draw/draw.go.html#6009102">sp</a></span><span class="op" id="6009304">.</span><span class="ident" id="6009305">Y</span>&nbsp;<span class="op" id="6009307">&lt;</span>&nbsp;<span class="ident" id="6009309"><a href="/image/draw/draw.go.html#6009066">r</a></span><span class="op" id="6009310">.</span><span class="ident" id="6009311">Min</span><span class="op" id="6009314">.</span><span class="ident" id="6009315">Y</span>&nbsp;<span class="op" id="6009317">||</span>&nbsp;<span class="ident" id="6009320"><a href="/image/draw/draw.go.html#6009102">sp</a></span><span class="op" id="6009322">.</span><span class="ident" id="6009323">Y</span>&nbsp;<span class="op" id="6009325">==</span>&nbsp;<span class="ident" id="6009328"><a href="/image/draw/draw.go.html#6009066">r</a></span><span class="op" id="6009329">.</span><span class="ident" id="6009330">Min</span><span class="op" id="6009333">.</span><span class="ident" id="6009334">Y</span>&nbsp;<span class="op" id="6009336">&amp;&amp;</span>&nbsp;<span class="ident" id="6009339"><a href="/image/draw/draw.go.html#6009102">sp</a></span><span class="op" id="6009341">.</span><span class="ident" id="6009342">X</span>&nbsp;<span class="op" id="6009344">&lt;</span>&nbsp;<span class="ident" id="6009346"><a href="/image/draw/draw.go.html#6009066">r</a></span><span class="op" id="6009347">.</span><span class="ident" id="6009348">Min</span><span class="op" id="6009351">.</span><span class="ident" id="6009352">X</span>&nbsp;<span class="op" id="6009354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6009359"><a href="/image/draw/draw.go.html#6009162">x0</a></span><span class="op" id="6009361">,</span>&nbsp;<span class="ident" id="6009363"><a href="/image/draw/draw.go.html#6009166">x1</a></span><span class="op" id="6009365">,</span>&nbsp;<span class="ident" id="6009367"><a href="/image/draw/draw.go.html#6009170">dx</a></span>&nbsp;<span class="op" id="6009370">=</span>&nbsp;<span class="ident" id="6009372"><a href="/image/draw/draw.go.html#6009166">x1</a></span><span class="op" id="6009374">-</span><span class="num" id="6009375">1</span><span class="op" id="6009376">,</span>&nbsp;<span class="ident" id="6009378"><a href="/image/draw/draw.go.html#6009162">x0</a></span><span class="op" id="6009380">-</span><span class="num" id="6009381">1</span><span class="op" id="6009382">,</span>&nbsp;<span class="op" id="6009384">-</span><span class="num" id="6009385">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6009390"><a href="/image/draw/draw.go.html#6009197">y0</a></span><span class="op" id="6009392">,</span>&nbsp;<span class="ident" id="6009394"><a href="/image/draw/draw.go.html#6009201">y1</a></span><span class="op" id="6009396">,</span>&nbsp;<span class="ident" id="6009398"><a href="/image/draw/draw.go.html#6009205">dy</a></span>&nbsp;<span class="op" id="6009401">=</span>&nbsp;<span class="ident" id="6009403"><a href="/image/draw/draw.go.html#6009201">y1</a></span><span class="op" id="6009405">-</span><span class="num" id="6009406">1</span><span class="op" id="6009407">,</span>&nbsp;<span class="ident" id="6009409"><a href="/image/draw/draw.go.html#6009197">y0</a></span><span class="op" id="6009411">-</span><span class="num" id="6009412">1</span><span class="op" id="6009413">,</span>&nbsp;<span class="op" id="6009415">-</span><span class="num" id="6009416">1</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6009420">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6009423">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6009427">sy</span>&nbsp;<span class="op" id="6009430">:=</span>&nbsp;<span class="ident" id="6009433"><a href="/image/draw/draw.go.html#6009102">sp</a></span><span class="op" id="6009435">.</span><span class="ident" id="6009436">Y</span>&nbsp;<span class="op" id="6009438">+</span>&nbsp;<span class="ident" id="6009440"><a href="/image/draw/draw.go.html#6009197">y0</a></span>&nbsp;<span class="op" id="6009443">-</span>&nbsp;<span class="ident" id="6009445"><a href="/image/draw/draw.go.html#6009066">r</a></span><span class="op" id="6009446">.</span><span class="ident" id="6009447">Min</span><span class="op" id="6009450">.</span><span class="ident" id="6009451">Y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6009454">my</span>&nbsp;<span class="op" id="6009457">:=</span>&nbsp;<span class="ident" id="6009460"><a href="/image/draw/draw.go.html#6009136">mp</a></span><span class="op" id="6009462">.</span><span class="ident" id="6009463">Y</span>&nbsp;<span class="op" id="6009465">+</span>&nbsp;<span class="ident" id="6009467"><a href="/image/draw/draw.go.html#6009197">y0</a></span>&nbsp;<span class="op" id="6009470">-</span>&nbsp;<span class="ident" id="6009472"><a href="/image/draw/draw.go.html#6009066">r</a></span><span class="op" id="6009473">.</span><span class="ident" id="6009474">Min</span><span class="op" id="6009477">.</span><span class="ident" id="6009478">Y</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6009481">sx0</span>&nbsp;<span class="op" id="6009485">:=</span>&nbsp;<span class="ident" id="6009488"><a href="/image/draw/draw.go.html#6009102">sp</a></span><span class="op" id="6009490">.</span><span class="ident" id="6009491">X</span>&nbsp;<span class="op" id="6009493">+</span>&nbsp;<span class="ident" id="6009495"><a href="/image/draw/draw.go.html#6009162">x0</a></span>&nbsp;<span class="op" id="6009498">-</span>&nbsp;<span class="ident" id="6009500"><a href="/image/draw/draw.go.html#6009066">r</a></span><span class="op" id="6009501">.</span><span class="ident" id="6009502">Min</span><span class="op" id="6009505">.</span><span class="ident" id="6009506">X</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6009509">mx0</span>&nbsp;<span class="op" id="6009513">:=</span>&nbsp;<span class="ident" id="6009516"><a href="/image/draw/draw.go.html#6009136">mp</a></span><span class="op" id="6009518">.</span><span class="ident" id="6009519">X</span>&nbsp;<span class="op" id="6009521">+</span>&nbsp;<span class="ident" id="6009523"><a href="/image/draw/draw.go.html#6009162">x0</a></span>&nbsp;<span class="op" id="6009526">-</span>&nbsp;<span class="ident" id="6009528"><a href="/image/draw/draw.go.html#6009066">r</a></span><span class="op" id="6009529">.</span><span class="ident" id="6009530">Min</span><span class="op" id="6009533">.</span><span class="ident" id="6009534">X</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6009537">sx1</span>&nbsp;<span class="op" id="6009541">:=</span>&nbsp;<span class="ident" id="6009544"><a href="/image/draw/draw.go.html#6009481">sx0</a></span>&nbsp;<span class="op" id="6009548">+</span>&nbsp;<span class="op" id="6009550">(</span><span class="ident" id="6009551"><a href="/image/draw/draw.go.html#6009166">x1</a></span>&nbsp;<span class="op" id="6009554">-</span>&nbsp;<span class="ident" id="6009556"><a href="/image/draw/draw.go.html#6009162">x0</a></span><span class="op" id="6009558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6009561">i0</span>&nbsp;<span class="op" id="6009564">:=</span>&nbsp;<span class="ident" id="6009567"><a href="/image/draw/draw.go.html#6009049">dst</a></span><span class="op" id="6009570">.</span><span class="ident" id="6009571">PixOffset</span><span class="op" id="6009580">(</span><span class="ident" id="6009581"><a href="/image/draw/draw.go.html#6009162">x0</a></span><span class="op" id="6009583">,</span>&nbsp;<span class="ident" id="6009585"><a href="/image/draw/draw.go.html#6009197">y0</a></span><span class="op" id="6009587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6009590">di</span>&nbsp;<span class="op" id="6009593">:=</span>&nbsp;<span class="ident" id="6009596"><a href="/image/draw/draw.go.html#6009170">dx</a></span>&nbsp;<span class="op" id="6009599">*</span>&nbsp;<span class="num" id="6009601">4</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6009604">for</span>&nbsp;<span class="ident" id="6009608">y</span>&nbsp;<span class="op" id="6009610">:=</span>&nbsp;<span class="ident" id="6009613"><a href="/image/draw/draw.go.html#6009197">y0</a></span><span class="op" id="6009615">;</span>&nbsp;<span class="ident" id="6009617"><a href="/image/draw/draw.go.html#6009608">y</a></span>&nbsp;<span class="op" id="6009619">!=</span>&nbsp;<span class="ident" id="6009622"><a href="/image/draw/draw.go.html#6009201">y1</a></span><span class="op" id="6009624">;</span>&nbsp;<span class="ident" id="6009626"><a href="/image/draw/draw.go.html#6009608">y</a></span><span class="op" id="6009627">,</span>&nbsp;<span class="ident" id="6009629"><a href="/image/draw/draw.go.html#6009427">sy</a></span><span class="op" id="6009631">,</span>&nbsp;<span class="ident" id="6009633"><a href="/image/draw/draw.go.html#6009454">my</a></span>&nbsp;<span class="op" id="6009636">=</span>&nbsp;<span class="ident" id="6009638"><a href="/image/draw/draw.go.html#6009608">y</a></span><span class="op" id="6009639">+</span><span class="ident" id="6009640"><a href="/image/draw/draw.go.html#6009205">dy</a></span><span class="op" id="6009642">,</span>&nbsp;<span class="ident" id="6009644"><a href="/image/draw/draw.go.html#6009427">sy</a></span><span class="op" id="6009646">+</span><span class="ident" id="6009647"><a href="/image/draw/draw.go.html#6009205">dy</a></span><span class="op" id="6009649">,</span>&nbsp;<span class="ident" id="6009651"><a href="/image/draw/draw.go.html#6009454">my</a></span><span class="op" id="6009653">+</span><span class="ident" id="6009654"><a href="/image/draw/draw.go.html#6009205">dy</a></span>&nbsp;<span class="op" id="6009657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6009661">for</span>&nbsp;<span class="ident" id="6009665">i</span><span class="op" id="6009666">,</span>&nbsp;<span class="ident" id="6009668">sx</span><span class="op" id="6009670">,</span>&nbsp;<span class="ident" id="6009672">mx</span>&nbsp;<span class="op" id="6009675">:=</span>&nbsp;<span class="ident" id="6009678"><a href="/image/draw/draw.go.html#6009561">i0</a></span><span class="op" id="6009680">,</span>&nbsp;<span class="ident" id="6009682"><a href="/image/draw/draw.go.html#6009481">sx0</a></span><span class="op" id="6009685">,</span>&nbsp;<span class="ident" id="6009687"><a href="/image/draw/draw.go.html#6009509">mx0</a></span><span class="op" id="6009690">;</span>&nbsp;<span class="ident" id="6009692"><a href="/image/draw/draw.go.html#6009668">sx</a></span>&nbsp;<span class="op" id="6009695">!=</span>&nbsp;<span class="ident" id="6009698"><a href="/image/draw/draw.go.html#6009537">sx1</a></span><span class="op" id="6009701">;</span>&nbsp;<span class="ident" id="6009703"><a href="/image/draw/draw.go.html#6009665">i</a></span><span class="op" id="6009704">,</span>&nbsp;<span class="ident" id="6009706"><a href="/image/draw/draw.go.html#6009668">sx</a></span><span class="op" id="6009708">,</span>&nbsp;<span class="ident" id="6009710"><a href="/image/draw/draw.go.html#6009672">mx</a></span>&nbsp;<span class="op" id="6009713">=</span>&nbsp;<span class="ident" id="6009715"><a href="/image/draw/draw.go.html#6009665">i</a></span><span class="op" id="6009716">+</span><span class="ident" id="6009717"><a href="/image/draw/draw.go.html#6009590">di</a></span><span class="op" id="6009719">,</span>&nbsp;<span class="ident" id="6009721"><a href="/image/draw/draw.go.html#6009668">sx</a></span><span class="op" id="6009723">+</span><span class="ident" id="6009724"><a href="/image/draw/draw.go.html#6009170">dx</a></span><span class="op" id="6009726">,</span>&nbsp;<span class="ident" id="6009728"><a href="/image/draw/draw.go.html#6009672">mx</a></span><span class="op" id="6009730">+</span><span class="ident" id="6009731"><a href="/image/draw/draw.go.html#6009170">dx</a></span>&nbsp;<span class="op" id="6009734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6009739">ma</span>&nbsp;<span class="op" id="6009742">:=</span>&nbsp;<span class="builtintype" id="6009745">uint32</span><span class="op" id="6009751">(</span><span class="ident" id="6009752"><a href="/image/draw/draw.go.html#5994729">m</a></span><span class="op" id="6009753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6009758">if</span>&nbsp;<span class="ident" id="6009761"><a href="/image/draw/draw.go.html#6009118">mask</a></span>&nbsp;<span class="op" id="6009766">!=</span>&nbsp;<span class="ident" id="6009769">nil</span>&nbsp;<span class="op" id="6009773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6009779">_</span><span class="op" id="6009780">,</span>&nbsp;<span class="ident" id="6009782">_</span><span class="op" id="6009783">,</span>&nbsp;<span class="ident" id="6009785">_</span><span class="op" id="6009786">,</span>&nbsp;<span class="ident" id="6009788"><a href="/image/draw/draw.go.html#6009739">ma</a></span>&nbsp;<span class="op" id="6009791">=</span>&nbsp;<span class="ident" id="6009793"><a href="/image/draw/draw.go.html#6009118">mask</a></span><span class="op" id="6009797">.</span><span class="ident" id="6009798">At</span><span class="op" id="6009800">(</span><span class="ident" id="6009801"><a href="/image/draw/draw.go.html#6009672">mx</a></span><span class="op" id="6009803">,</span>&nbsp;<span class="ident" id="6009805"><a href="/image/draw/draw.go.html#6009454">my</a></span><span class="op" id="6009807">)</span><span class="op" id="6009808">.</span><span class="ident" id="6009809">RGBA</span><span class="op" id="6009813">(</span><span class="op" id="6009814">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6009819">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6009824">sr</span><span class="op" id="6009826">,</span>&nbsp;<span class="ident" id="6009828">sg</span><span class="op" id="6009830">,</span>&nbsp;<span class="ident" id="6009832">sb</span><span class="op" id="6009834">,</span>&nbsp;<span class="ident" id="6009836">sa</span>&nbsp;<span class="op" id="6009839">:=</span>&nbsp;<span class="ident" id="6009842"><a href="/image/draw/draw.go.html#6009085">src</a></span><span class="op" id="6009845">.</span><span class="ident" id="6009846">At</span><span class="op" id="6009848">(</span><span class="ident" id="6009849"><a href="/image/draw/draw.go.html#6009668">sx</a></span><span class="op" id="6009851">,</span>&nbsp;<span class="ident" id="6009853"><a href="/image/draw/draw.go.html#6009427">sy</a></span><span class="op" id="6009855">)</span><span class="op" id="6009856">.</span><span class="ident" id="6009857">RGBA</span><span class="op" id="6009861">(</span><span class="op" id="6009862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6009867">if</span>&nbsp;<span class="ident" id="6009870"><a href="/image/draw/draw.go.html#6009152">op</a></span>&nbsp;<span class="op" id="6009873">==</span>&nbsp;<span class="ident" id="6009876"><a href="/image/draw/draw.go.html#5995268">Over</a></span>&nbsp;<span class="op" id="6009881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6009887">dr</span>&nbsp;<span class="op" id="6009890">:=</span>&nbsp;<span class="builtintype" id="6009893">uint32</span><span class="op" id="6009899">(</span><span class="ident" id="6009900"><a href="/image/draw/draw.go.html#6009049">dst</a></span><span class="op" id="6009903">.</span><span class="ident" id="6009904">Pix</span><span class="op" id="6009907">[</span><span class="ident" id="6009908"><a href="/image/draw/draw.go.html#6009665">i</a></span><span class="op" id="6009909">+</span><span class="num" id="6009910">0</span><span class="op" id="6009911">]</span><span class="op" id="6009912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6009918">dg</span>&nbsp;<span class="op" id="6009921">:=</span>&nbsp;<span class="builtintype" id="6009924">uint32</span><span class="op" id="6009930">(</span><span class="ident" id="6009931"><a href="/image/draw/draw.go.html#6009049">dst</a></span><span class="op" id="6009934">.</span><span class="ident" id="6009935">Pix</span><span class="op" id="6009938">[</span><span class="ident" id="6009939"><a href="/image/draw/draw.go.html#6009665">i</a></span><span class="op" id="6009940">+</span><span class="num" id="6009941">1</span><span class="op" id="6009942">]</span><span class="op" id="6009943">)</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6009949">db</span>&nbsp;<span class="op" id="6009952">:=</span>&nbsp;<span class="builtintype" id="6009955">uint32</span><span class="op" id="6009961">(</span><span class="ident" id="6009962"><a href="/image/draw/draw.go.html#6009049">dst</a></span><span class="op" id="6009965">.</span><span class="ident" id="6009966">Pix</span><span class="op" id="6009969">[</span><span class="ident" id="6009970"><a href="/image/draw/draw.go.html#6009665">i</a></span><span class="op" id="6009971">+</span><span class="num" id="6009972">2</span><span class="op" id="6009973">]</span><span class="op" id="6009974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6009980">da</span>&nbsp;<span class="op" id="6009983">:=</span>&nbsp;<span class="builtintype" id="6009986">uint32</span><span class="op" id="6009992">(</span><span class="ident" id="6009993"><a href="/image/draw/draw.go.html#6009049">dst</a></span><span class="op" id="6009996">.</span><span class="ident" id="6009997">Pix</span><span class="op" id="6010000">[</span><span class="ident" id="6010001"><a href="/image/draw/draw.go.html#6009665">i</a></span><span class="op" id="6010002">+</span><span class="num" id="6010003">3</span><span class="op" id="6010004">]</span><span class="op" id="6010005">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6010012">//&nbsp;dr,&nbsp;dg,&nbsp;db&nbsp;and&nbsp;da&nbsp;are&nbsp;all&nbsp;8-bit&nbsp;color&nbsp;at&nbsp;the&nbsp;moment,&nbsp;ranging&nbsp;in&nbsp;[0,255].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6010092">//&nbsp;We&nbsp;work&nbsp;in&nbsp;16-bit&nbsp;color,&nbsp;and&nbsp;so&nbsp;would&nbsp;normally&nbsp;do:</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6010150">//&nbsp;dr&nbsp;|=&nbsp;dr&nbsp;&lt;&lt;&nbsp;8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6010171">//&nbsp;and&nbsp;similarly&nbsp;for&nbsp;dg,&nbsp;db&nbsp;and&nbsp;da,&nbsp;but&nbsp;instead&nbsp;we&nbsp;multiply&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6010237">//&nbsp;(which&nbsp;is&nbsp;a&nbsp;16-bit&nbsp;color,&nbsp;ranging&nbsp;in&nbsp;[0,65535])&nbsp;by&nbsp;0x101.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6010302">//&nbsp;This&nbsp;yields&nbsp;the&nbsp;same&nbsp;result,&nbsp;but&nbsp;is&nbsp;fewer&nbsp;arithmetic&nbsp;operations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6010374">a</span>&nbsp;<span class="op" id="6010376">:=</span>&nbsp;<span class="op" id="6010379">(</span><span class="ident" id="6010380"><a href="/image/draw/draw.go.html#5994729">m</a></span>&nbsp;<span class="op" id="6010382">-</span>&nbsp;<span class="op" id="6010384">(</span><span class="ident" id="6010385"><a href="/image/draw/draw.go.html#6009836">sa</a></span>&nbsp;<span class="op" id="6010388">*</span>&nbsp;<span class="ident" id="6010390"><a href="/image/draw/draw.go.html#6009739">ma</a></span>&nbsp;<span class="op" id="6010393">/</span>&nbsp;<span class="ident" id="6010395"><a href="/image/draw/draw.go.html#5994729">m</a></span><span class="op" id="6010396">)</span><span class="op" id="6010397">)</span>&nbsp;<span class="op" id="6010399">*</span>&nbsp;<span class="num" id="6010401">0x101</span><br>
<span class="lineno">530</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6010412"><a href="/image/draw/draw.go.html#6009049">dst</a></span><span class="op" id="6010415">.</span><span class="ident" id="6010416">Pix</span><span class="op" id="6010419">[</span><span class="ident" id="6010420"><a href="/image/draw/draw.go.html#6009665">i</a></span><span class="op" id="6010421">+</span><span class="num" id="6010422">0</span><span class="op" id="6010423">]</span>&nbsp;<span class="op" id="6010425">=</span>&nbsp;<span class="builtintype" id="6010427">uint8</span><span class="op" id="6010432">(</span><span class="op" id="6010433">(</span><span class="ident" id="6010434"><a href="/image/draw/draw.go.html#6009887">dr</a></span><span class="op" id="6010436">*</span><span class="ident" id="6010437"><a href="/image/draw/draw.go.html#6010374">a</a></span>&nbsp;<span class="op" id="6010439">+</span>&nbsp;<span class="ident" id="6010441"><a href="/image/draw/draw.go.html#6009824">sr</a></span><span class="op" id="6010443">*</span><span class="ident" id="6010444"><a href="/image/draw/draw.go.html#6009739">ma</a></span><span class="op" id="6010446">)</span>&nbsp;<span class="op" id="6010448">/</span>&nbsp;<span class="ident" id="6010450"><a href="/image/draw/draw.go.html#5994729">m</a></span>&nbsp;<span class="op" id="6010452">&gt;&gt;</span>&nbsp;<span class="num" id="6010455">8</span><span class="op" id="6010456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6010462"><a href="/image/draw/draw.go.html#6009049">dst</a></span><span class="op" id="6010465">.</span><span class="ident" id="6010466">Pix</span><span class="op" id="6010469">[</span><span class="ident" id="6010470"><a href="/image/draw/draw.go.html#6009665">i</a></span><span class="op" id="6010471">+</span><span class="num" id="6010472">1</span><span class="op" id="6010473">]</span>&nbsp;<span class="op" id="6010475">=</span>&nbsp;<span class="builtintype" id="6010477">uint8</span><span class="op" id="6010482">(</span><span class="op" id="6010483">(</span><span class="ident" id="6010484"><a href="/image/draw/draw.go.html#6009918">dg</a></span><span class="op" id="6010486">*</span><span class="ident" id="6010487"><a href="/image/draw/draw.go.html#6010374">a</a></span>&nbsp;<span class="op" id="6010489">+</span>&nbsp;<span class="ident" id="6010491"><a href="/image/draw/draw.go.html#6009828">sg</a></span><span class="op" id="6010493">*</span><span class="ident" id="6010494"><a href="/image/draw/draw.go.html#6009739">ma</a></span><span class="op" id="6010496">)</span>&nbsp;<span class="op" id="6010498">/</span>&nbsp;<span class="ident" id="6010500"><a href="/image/draw/draw.go.html#5994729">m</a></span>&nbsp;<span class="op" id="6010502">&gt;&gt;</span>&nbsp;<span class="num" id="6010505">8</span><span class="op" id="6010506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6010512"><a href="/image/draw/draw.go.html#6009049">dst</a></span><span class="op" id="6010515">.</span><span class="ident" id="6010516">Pix</span><span class="op" id="6010519">[</span><span class="ident" id="6010520"><a href="/image/draw/draw.go.html#6009665">i</a></span><span class="op" id="6010521">+</span><span class="num" id="6010522">2</span><span class="op" id="6010523">]</span>&nbsp;<span class="op" id="6010525">=</span>&nbsp;<span class="builtintype" id="6010527">uint8</span><span class="op" id="6010532">(</span><span class="op" id="6010533">(</span><span class="ident" id="6010534"><a href="/image/draw/draw.go.html#6009949">db</a></span><span class="op" id="6010536">*</span><span class="ident" id="6010537"><a href="/image/draw/draw.go.html#6010374">a</a></span>&nbsp;<span class="op" id="6010539">+</span>&nbsp;<span class="ident" id="6010541"><a href="/image/draw/draw.go.html#6009832">sb</a></span><span class="op" id="6010543">*</span><span class="ident" id="6010544"><a href="/image/draw/draw.go.html#6009739">ma</a></span><span class="op" id="6010546">)</span>&nbsp;<span class="op" id="6010548">/</span>&nbsp;<span class="ident" id="6010550"><a href="/image/draw/draw.go.html#5994729">m</a></span>&nbsp;<span class="op" id="6010552">&gt;&gt;</span>&nbsp;<span class="num" id="6010555">8</span><span class="op" id="6010556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6010562"><a href="/image/draw/draw.go.html#6009049">dst</a></span><span class="op" id="6010565">.</span><span class="ident" id="6010566">Pix</span><span class="op" id="6010569">[</span><span class="ident" id="6010570"><a href="/image/draw/draw.go.html#6009665">i</a></span><span class="op" id="6010571">+</span><span class="num" id="6010572">3</span><span class="op" id="6010573">]</span>&nbsp;<span class="op" id="6010575">=</span>&nbsp;<span class="builtintype" id="6010577">uint8</span><span class="op" id="6010582">(</span><span class="op" id="6010583">(</span><span class="ident" id="6010584"><a href="/image/draw/draw.go.html#6009980">da</a></span><span class="op" id="6010586">*</span><span class="ident" id="6010587"><a href="/image/draw/draw.go.html#6010374">a</a></span>&nbsp;<span class="op" id="6010589">+</span>&nbsp;<span class="ident" id="6010591"><a href="/image/draw/draw.go.html#6009836">sa</a></span><span class="op" id="6010593">*</span><span class="ident" id="6010594"><a href="/image/draw/draw.go.html#6009739">ma</a></span><span class="op" id="6010596">)</span>&nbsp;<span class="op" id="6010598">/</span>&nbsp;<span class="ident" id="6010600"><a href="/image/draw/draw.go.html#5994729">m</a></span>&nbsp;<span class="op" id="6010602">&gt;&gt;</span>&nbsp;<span class="num" id="6010605">8</span><span class="op" id="6010606">)</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6010612">}</span>&nbsp;<span class="keyword" id="6010614">else</span>&nbsp;<span class="op" id="6010619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6010625"><a href="/image/draw/draw.go.html#6009049">dst</a></span><span class="op" id="6010628">.</span><span class="ident" id="6010629">Pix</span><span class="op" id="6010632">[</span><span class="ident" id="6010633"><a href="/image/draw/draw.go.html#6009665">i</a></span><span class="op" id="6010634">+</span><span class="num" id="6010635">0</span><span class="op" id="6010636">]</span>&nbsp;<span class="op" id="6010638">=</span>&nbsp;<span class="builtintype" id="6010640">uint8</span><span class="op" id="6010645">(</span><span class="ident" id="6010646"><a href="/image/draw/draw.go.html#6009824">sr</a></span>&nbsp;<span class="op" id="6010649">*</span>&nbsp;<span class="ident" id="6010651"><a href="/image/draw/draw.go.html#6009739">ma</a></span>&nbsp;<span class="op" id="6010654">/</span>&nbsp;<span class="ident" id="6010656"><a href="/image/draw/draw.go.html#5994729">m</a></span>&nbsp;<span class="op" id="6010658">&gt;&gt;</span>&nbsp;<span class="num" id="6010661">8</span><span class="op" id="6010662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6010668"><a href="/image/draw/draw.go.html#6009049">dst</a></span><span class="op" id="6010671">.</span><span class="ident" id="6010672">Pix</span><span class="op" id="6010675">[</span><span class="ident" id="6010676"><a href="/image/draw/draw.go.html#6009665">i</a></span><span class="op" id="6010677">+</span><span class="num" id="6010678">1</span><span class="op" id="6010679">]</span>&nbsp;<span class="op" id="6010681">=</span>&nbsp;<span class="builtintype" id="6010683">uint8</span><span class="op" id="6010688">(</span><span class="ident" id="6010689"><a href="/image/draw/draw.go.html#6009828">sg</a></span>&nbsp;<span class="op" id="6010692">*</span>&nbsp;<span class="ident" id="6010694"><a href="/image/draw/draw.go.html#6009739">ma</a></span>&nbsp;<span class="op" id="6010697">/</span>&nbsp;<span class="ident" id="6010699"><a href="/image/draw/draw.go.html#5994729">m</a></span>&nbsp;<span class="op" id="6010701">&gt;&gt;</span>&nbsp;<span class="num" id="6010704">8</span><span class="op" id="6010705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6010711"><a href="/image/draw/draw.go.html#6009049">dst</a></span><span class="op" id="6010714">.</span><span class="ident" id="6010715">Pix</span><span class="op" id="6010718">[</span><span class="ident" id="6010719"><a href="/image/draw/draw.go.html#6009665">i</a></span><span class="op" id="6010720">+</span><span class="num" id="6010721">2</span><span class="op" id="6010722">]</span>&nbsp;<span class="op" id="6010724">=</span>&nbsp;<span class="builtintype" id="6010726">uint8</span><span class="op" id="6010731">(</span><span class="ident" id="6010732"><a href="/image/draw/draw.go.html#6009832">sb</a></span>&nbsp;<span class="op" id="6010735">*</span>&nbsp;<span class="ident" id="6010737"><a href="/image/draw/draw.go.html#6009739">ma</a></span>&nbsp;<span class="op" id="6010740">/</span>&nbsp;<span class="ident" id="6010742"><a href="/image/draw/draw.go.html#5994729">m</a></span>&nbsp;<span class="op" id="6010744">&gt;&gt;</span>&nbsp;<span class="num" id="6010747">8</span><span class="op" id="6010748">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6010754"><a href="/image/draw/draw.go.html#6009049">dst</a></span><span class="op" id="6010757">.</span><span class="ident" id="6010758">Pix</span><span class="op" id="6010761">[</span><span class="ident" id="6010762"><a href="/image/draw/draw.go.html#6009665">i</a></span><span class="op" id="6010763">+</span><span class="num" id="6010764">3</span><span class="op" id="6010765">]</span>&nbsp;<span class="op" id="6010767">=</span>&nbsp;<span class="builtintype" id="6010769">uint8</span><span class="op" id="6010774">(</span><span class="ident" id="6010775"><a href="/image/draw/draw.go.html#6009836">sa</a></span>&nbsp;<span class="op" id="6010778">*</span>&nbsp;<span class="ident" id="6010780"><a href="/image/draw/draw.go.html#6009739">ma</a></span>&nbsp;<span class="op" id="6010783">/</span>&nbsp;<span class="ident" id="6010785"><a href="/image/draw/draw.go.html#5994729">m</a></span>&nbsp;<span class="op" id="6010787">&gt;&gt;</span>&nbsp;<span class="num" id="6010790">8</span><span class="op" id="6010791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6010796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6010800">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6010804"><a href="/image/draw/draw.go.html#6009561">i0</a></span>&nbsp;<span class="op" id="6010807">+=</span>&nbsp;<span class="ident" id="6010810"><a href="/image/draw/draw.go.html#6009205">dy</a></span>&nbsp;<span class="op" id="6010813">*</span>&nbsp;<span class="ident" id="6010815"><a href="/image/draw/draw.go.html#6009049">dst</a></span><span class="op" id="6010818">.</span><span class="ident" id="6010819">Stride</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6010827">}</span><br>
<span class="lineno">545</span><span class="op" id="6010829">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6010832">//&nbsp;clamp&nbsp;clamps&nbsp;i&nbsp;to&nbsp;the&nbsp;interval&nbsp;[0,&nbsp;0xffff].</span><br>
<span class="lineno"></span><span class="keyword" id="6010879">func</span>&nbsp;<span class="ident" id="6010884">clamp</span><span class="op" id="6010889">(</span><span class="ident" id="6010890">i</span>&nbsp;<span class="builtintype" id="6010892">int32</span><span class="op" id="6010897">)</span>&nbsp;<span class="builtintype" id="6010899">int32</span>&nbsp;<span class="op" id="6010905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6010908">if</span>&nbsp;<span class="ident" id="6010911"><a href="/image/draw/draw.go.html#6010890">i</a></span>&nbsp;<span class="op" id="6010913">&lt;</span>&nbsp;<span class="num" id="6010915">0</span>&nbsp;<span class="op" id="6010917">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6010921">return</span>&nbsp;<span class="num" id="6010928">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6010931">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6010934">if</span>&nbsp;<span class="ident" id="6010937"><a href="/image/draw/draw.go.html#6010890">i</a></span>&nbsp;<span class="op" id="6010939">&gt;</span>&nbsp;<span class="num" id="6010941">0xffff</span>&nbsp;<span class="op" id="6010948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6010952">return</span>&nbsp;<span class="num" id="6010959">0xffff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6010967">}</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6010970">return</span>&nbsp;<span class="ident" id="6010977"><a href="/image/draw/draw.go.html#6010890">i</a></span><br>
<span class="lineno"></span><span class="op" id="6010979">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6010982">func</span>&nbsp;<span class="ident" id="6010987">drawPaletted</span><span class="op" id="6010999">(</span><span class="ident" id="6011000">dst</span>&nbsp;<span class="ident" id="6011004"><a href="/image/draw/draw.go.html#5994820">Image</a></span><span class="op" id="6011009">,</span>&nbsp;<span class="ident" id="6011011">r</span>&nbsp;<span class="ident" id="6011013"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="6011018">.</span><span class="ident" id="6011019">Rectangle</span><span class="op" id="6011028">,</span>&nbsp;<span class="ident" id="6011030">src</span>&nbsp;<span class="ident" id="6011034"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="6011039">.</span><span class="ident" id="6011040">Image</span><span class="op" id="6011045">,</span>&nbsp;<span class="ident" id="6011047">sp</span>&nbsp;<span class="ident" id="6011050"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="6011055">.</span><span class="ident" id="6011056">Point</span><span class="op" id="6011061">,</span>&nbsp;<span class="ident" id="6011063">floydSteinberg</span>&nbsp;<span class="builtintype" id="6011078">bool</span><span class="op" id="6011082">)</span>&nbsp;<span class="op" id="6011084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6011087">//&nbsp;TODO(nigeltao):&nbsp;handle&nbsp;the&nbsp;case&nbsp;where&nbsp;the&nbsp;dst&nbsp;and&nbsp;src&nbsp;overlap.</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6011154">//&nbsp;Does&nbsp;it&nbsp;even&nbsp;make&nbsp;sense&nbsp;to&nbsp;try&nbsp;and&nbsp;do&nbsp;Floyd-Steinberg&nbsp;whilst</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6011219">//&nbsp;walking&nbsp;the&nbsp;image&nbsp;backward&nbsp;(right-to-left&nbsp;bottom-to-top)?</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6011282">//&nbsp;If&nbsp;dst&nbsp;is&nbsp;an&nbsp;*image.Paletted,&nbsp;we&nbsp;have&nbsp;a&nbsp;fast&nbsp;path&nbsp;for&nbsp;dst.Set&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6011352">//&nbsp;dst.At.&nbsp;The&nbsp;dst.Set&nbsp;equivalent&nbsp;is&nbsp;a&nbsp;batch&nbsp;version&nbsp;of&nbsp;the&nbsp;algorithm</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6011423">//&nbsp;used&nbsp;by&nbsp;color.Palette&#39;s&nbsp;Index&nbsp;method&nbsp;in&nbsp;image/color/color.go,&nbsp;plus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6011494">//&nbsp;optional&nbsp;Floyd-Steinberg&nbsp;error&nbsp;diffusion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6011540">palette</span><span class="op" id="6011547">,</span>&nbsp;<span class="ident" id="6011549">pix</span><span class="op" id="6011552">,</span>&nbsp;<span class="ident" id="6011554">stride</span>&nbsp;<span class="op" id="6011561">:=</span>&nbsp;<span class="op" id="6011564">[</span><span class="op" id="6011565">]</span><span class="op" id="6011566">[</span><span class="num" id="6011567">3</span><span class="op" id="6011568">]</span><span class="builtintype" id="6011569">int32</span><span class="op" id="6011574">(</span><span class="ident" id="6011575">nil</span><span class="op" id="6011578">)</span><span class="op" id="6011579">,</span>&nbsp;<span class="op" id="6011581">[</span><span class="op" id="6011582">]</span><span class="builtintype" id="6011583">byte</span><span class="op" id="6011587">(</span><span class="ident" id="6011588">nil</span><span class="op" id="6011591">)</span><span class="op" id="6011592">,</span>&nbsp;<span class="num" id="6011594">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6011597">if</span>&nbsp;<span class="ident" id="6011600">p</span><span class="op" id="6011601">,</span>&nbsp;<span class="ident" id="6011603">ok</span>&nbsp;<span class="op" id="6011606">:=</span>&nbsp;<span class="ident" id="6011609"><a href="/image/draw/draw.go.html#6011000">dst</a></span><span class="op" id="6011612">.</span><span class="op" id="6011613">(</span><span class="op" id="6011614">*</span><span class="ident" id="6011615"><a href="/image/draw/draw.go.html#5994635">image</a></span><span class="op" id="6011620">.</span><span class="ident" id="6011621">Paletted</span><span class="op" id="6011629">)</span><span class="op" id="6011630">;</span>&nbsp;<span class="ident" id="6011632"><a href="/image/draw/draw.go.html#6011603">ok</a></span>&nbsp;<span class="op" id="6011635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6011639"><a href="/image/draw/draw.go.html#6011540">palette</a></span>&nbsp;<span class="op" id="6011647">=</span>&nbsp;<span class="builtinfunc" id="6011649">make</span><span class="op" id="6011653">(</span><span class="op" id="6011654">[</span><span class="op" id="6011655">]</span><span class="op" id="6011656">[</span><span class="num" id="6011657">3</span><span class="op" id="6011658">]</span><span class="builtintype" id="6011659">int32</span><span class="op" id="6011664">,</span>&nbsp;<span class="builtinfunc" id="6011666">len</span><span class="op" id="6011669">(</span><span class="ident" id="6011670"><a href="/image/draw/draw.go.html#6011600">p</a></span><span class="op" id="6011671">.</span><span class="ident" id="6011672">Palette</span><span class="op" id="6011679">)</span><span class="op" id="6011680">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6011684">for</span>&nbsp;<span class="ident" id="6011688">i</span><span class="op" id="6011689">,</span>&nbsp;<span class="ident" id="6011691">col</span>&nbsp;<span class="op" id="6011695">:=</span>&nbsp;<span class="keyword" id="6011698">range</span>&nbsp;<span class="ident" id="6011704"><a href="/image/draw/draw.go.html#6011600">p</a></span><span class="op" id="6011705">.</span><span class="ident" id="6011706">Palette</span>&nbsp;<span class="op" id="6011714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6011719">r</span><span class="op" id="6011720">,</span>&nbsp;<span class="ident" id="6011722">g</span><span class="op" id="6011723">,</span>&nbsp;<span class="ident" id="6011725">b</span><span class="op" id="6011726">,</span>&nbsp;<span class="ident" id="6011728">_</span>&nbsp;<span class="op" id="6011730">:=</span>&nbsp;<span class="ident" id="6011733"><a href="/image/draw/draw.go.html#6011691">col</a></span><span class="op" id="6011736">.</span><span class="ident" id="6011737">RGBA</span><span class="op" id="6011741">(</span><span class="op" id="6011742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6011747"><a href="/image/draw/draw.go.html#6011540">palette</a></span><span class="op" id="6011754">[</span><span class="ident" id="6011755"><a href="/image/draw/draw.go.html#6011688">i</a></span><span class="op" id="6011756">]</span><span class="op" id="6011757">[</span><span class="num" id="6011758">0</span><span class="op" id="6011759">]</span>&nbsp;<span class="op" id="6011761">=</span>&nbsp;<span class="builtintype" id="6011763">int32</span><span class="op" id="6011768">(</span><span class="ident" id="6011769"><a href="/image/draw/draw.go.html#6011719">r</a></span><span class="op" id="6011770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6011775"><a href="/image/draw/draw.go.html#6011540">palette</a></span><span class="op" id="6011782">[</span><span class="ident" id="6011783"><a href="/image/draw/draw.go.html#6011688">i</a></span><span class="op" id="6011784">]</span><span class="op" id="6011785">[</span><span class="num" id="6011786">1</span><span class="op" id="6011787">]</span>&nbsp;<span class="op" id="6011789">=</span>&nbsp;<span class="builtintype" id="6011791">int32</span><span class="op" id="6011796">(</span><span class="ident" id="6011797"><a href="/image/draw/draw.go.html#6011722">g</a></span><span class="op" id="6011798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6011803"><a href="/image/draw/draw.go.html#6011540">palette</a></span><span class="op" id="6011810">[</span><span class="ident" id="6011811"><a href="/image/draw/draw.go.html#6011688">i</a></span><span class="op" id="6011812">]</span><span class="op" id="6011813">[</span><span class="num" id="6011814">2</span><span class="op" id="6011815">]</span>&nbsp;<span class="op" id="6011817">=</span>&nbsp;<span class="builtintype" id="6011819">int32</span><span class="op" id="6011824">(</span><span class="ident" id="6011825"><a href="/image/draw/draw.go.html#6011725">b</a></span><span class="op" id="6011826">)</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6011830">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6011834"><a href="/image/draw/draw.go.html#6011549">pix</a></span><span class="op" id="6011837">,</span>&nbsp;<span class="ident" id="6011839"><a href="/image/draw/draw.go.html#6011554">stride</a></span>&nbsp;<span class="op" id="6011846">=</span>&nbsp;<span class="ident" id="6011848"><a href="/image/draw/draw.go.html#6011600">p</a></span><span class="op" id="6011849">.</span><span class="ident" id="6011850">Pix</span><span class="op" id="6011853">[</span><span class="ident" id="6011854"><a href="/image/draw/draw.go.html#6011600">p</a></span><span class="op" id="6011855">.</span><span class="ident" id="6011856">PixOffset</span><span class="op" id="6011865">(</span><span class="ident" id="6011866"><a href="/image/draw/draw.go.html#6011011">r</a></span><span class="op" id="6011867">.</span><span class="ident" id="6011868">Min</span><span class="op" id="6011871">.</span><span class="ident" id="6011872">X</span><span class="op" id="6011873">,</span>&nbsp;<span class="ident" id="6011875"><a href="/image/draw/draw.go.html#6011011">r</a></span><span class="op" id="6011876">.</span><span class="ident" id="6011877">Min</span><span class="op" id="6011880">.</span><span class="ident" id="6011881">Y</span><span class="op" id="6011882">)</span><span class="op" id="6011883">:</span><span class="op" id="6011884">]</span><span class="op" id="6011885">,</span>&nbsp;<span class="ident" id="6011887"><a href="/image/draw/draw.go.html#6011600">p</a></span><span class="op" id="6011888">.</span><span class="ident" id="6011889">Stride</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6011897">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6011901">//&nbsp;quantErrorCurr&nbsp;and&nbsp;quantErrorNext&nbsp;are&nbsp;the&nbsp;Floyd-Steinberg&nbsp;quantization</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6011976">//&nbsp;errors&nbsp;that&nbsp;have&nbsp;been&nbsp;propagated&nbsp;to&nbsp;the&nbsp;pixels&nbsp;in&nbsp;the&nbsp;current&nbsp;and&nbsp;next</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6012051">//&nbsp;rows.&nbsp;The&nbsp;+2&nbsp;simplifies&nbsp;calculation&nbsp;near&nbsp;the&nbsp;edges.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6012107">var</span>&nbsp;<span class="ident" id="6012111">quantErrorCurr</span><span class="op" id="6012125">,</span>&nbsp;<span class="ident" id="6012127">quantErrorNext</span>&nbsp;<span class="op" id="6012142">[</span><span class="op" id="6012143">]</span><span class="op" id="6012144">[</span><span class="num" id="6012145">3</span><span class="op" id="6012146">]</span><span class="builtintype" id="6012147">int32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6012154">if</span>&nbsp;<span class="ident" id="6012157"><a href="/image/draw/draw.go.html#6011063">floydSteinberg</a></span>&nbsp;<span class="op" id="6012172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6012176"><a href="/image/draw/draw.go.html#6012111">quantErrorCurr</a></span>&nbsp;<span class="op" id="6012191">=</span>&nbsp;<span class="builtinfunc" id="6012193">make</span><span class="op" id="6012197">(</span><span class="op" id="6012198">[</span><span class="op" id="6012199">]</span><span class="op" id="6012200">[</span><span class="num" id="6012201">3</span><span class="op" id="6012202">]</span><span class="builtintype" id="6012203">int32</span><span class="op" id="6012208">,</span>&nbsp;<span class="ident" id="6012210"><a href="/image/draw/draw.go.html#6011011">r</a></span><span class="op" id="6012211">.</span><span class="ident" id="6012212">Dx</span><span class="op" id="6012214">(</span><span class="op" id="6012215">)</span><span class="op" id="6012216">+</span><span class="num" id="6012217">2</span><span class="op" id="6012218">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6012222"><a href="/image/draw/draw.go.html#6012127">quantErrorNext</a></span>&nbsp;<span class="op" id="6012237">=</span>&nbsp;<span class="builtinfunc" id="6012239">make</span><span class="op" id="6012243">(</span><span class="op" id="6012244">[</span><span class="op" id="6012245">]</span><span class="op" id="6012246">[</span><span class="num" id="6012247">3</span><span class="op" id="6012248">]</span><span class="builtintype" id="6012249">int32</span><span class="op" id="6012254">,</span>&nbsp;<span class="ident" id="6012256"><a href="/image/draw/draw.go.html#6011011">r</a></span><span class="op" id="6012257">.</span><span class="ident" id="6012258">Dx</span><span class="op" id="6012260">(</span><span class="op" id="6012261">)</span><span class="op" id="6012262">+</span><span class="num" id="6012263">2</span><span class="op" id="6012264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6012267">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6012271">//&nbsp;Loop&nbsp;over&nbsp;each&nbsp;source&nbsp;pixel.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6012304">out</span>&nbsp;<span class="op" id="6012308">:=</span>&nbsp;<span class="ident" id="6012311"><a href="/image/draw/draw.go.html#5994644">color</a></span><span class="op" id="6012316">.</span><span class="ident" id="6012317">RGBA64</span><span class="op" id="6012323">{</span><span class="ident" id="6012324">A</span><span class="op" id="6012325">:</span>&nbsp;<span class="num" id="6012327">0xffff</span><span class="op" id="6012333">}</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6012336">for</span>&nbsp;<span class="ident" id="6012340">y</span>&nbsp;<span class="op" id="6012342">:=</span>&nbsp;<span class="num" id="6012345">0</span><span class="op" id="6012346">;</span>&nbsp;<span class="ident" id="6012348"><a href="/image/draw/draw.go.html#6012340">y</a></span>&nbsp;<span class="op" id="6012350">!=</span>&nbsp;<span class="ident" id="6012353"><a href="/image/draw/draw.go.html#6011011">r</a></span><span class="op" id="6012354">.</span><span class="ident" id="6012355">Dy</span><span class="op" id="6012357">(</span><span class="op" id="6012358">)</span><span class="op" id="6012359">;</span>&nbsp;<span class="ident" id="6012361"><a href="/image/draw/draw.go.html#6012340">y</a></span><span class="op" id="6012362">++</span>&nbsp;<span class="op" id="6012365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6012369">for</span>&nbsp;<span class="ident" id="6012373">x</span>&nbsp;<span class="op" id="6012375">:=</span>&nbsp;<span class="num" id="6012378">0</span><span class="op" id="6012379">;</span>&nbsp;<span class="ident" id="6012381"><a href="/image/draw/draw.go.html#6012373">x</a></span>&nbsp;<span class="op" id="6012383">!=</span>&nbsp;<span class="ident" id="6012386"><a href="/image/draw/draw.go.html#6011011">r</a></span><span class="op" id="6012387">.</span><span class="ident" id="6012388">Dx</span><span class="op" id="6012390">(</span><span class="op" id="6012391">)</span><span class="op" id="6012392">;</span>&nbsp;<span class="ident" id="6012394"><a href="/image/draw/draw.go.html#6012373">x</a></span><span class="op" id="6012395">++</span>&nbsp;<span class="op" id="6012398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6012403">//&nbsp;er,&nbsp;eg&nbsp;and&nbsp;eb&nbsp;are&nbsp;the&nbsp;pixel&#39;s&nbsp;R,G,B&nbsp;values&nbsp;plus&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6012461">//&nbsp;optional&nbsp;Floyd-Steinberg&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6012499">sr</span><span class="op" id="6012501">,</span>&nbsp;<span class="ident" id="6012503">sg</span><span class="op" id="6012505">,</span>&nbsp;<span class="ident" id="6012507">sb</span><span class="op" id="6012509">,</span>&nbsp;<span class="ident" id="6012511">_</span>&nbsp;<span class="op" id="6012513">:=</span>&nbsp;<span class="ident" id="6012516"><a href="/image/draw/draw.go.html#6011030">src</a></span><span class="op" id="6012519">.</span><span class="ident" id="6012520">At</span><span class="op" id="6012522">(</span><span class="ident" id="6012523"><a href="/image/draw/draw.go.html#6011047">sp</a></span><span class="op" id="6012525">.</span><span class="ident" id="6012526">X</span><span class="op" id="6012527">+</span><span class="ident" id="6012528"><a href="/image/draw/draw.go.html#6012373">x</a></span><span class="op" id="6012529">,</span>&nbsp;<span class="ident" id="6012531"><a href="/image/draw/draw.go.html#6011047">sp</a></span><span class="op" id="6012533">.</span><span class="ident" id="6012534">Y</span><span class="op" id="6012535">+</span><span class="ident" id="6012536"><a href="/image/draw/draw.go.html#6012340">y</a></span><span class="op" id="6012537">)</span><span class="op" id="6012538">.</span><span class="ident" id="6012539">RGBA</span><span class="op" id="6012543">(</span><span class="op" id="6012544">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6012549">er</span><span class="op" id="6012551">,</span>&nbsp;<span class="ident" id="6012553">eg</span><span class="op" id="6012555">,</span>&nbsp;<span class="ident" id="6012557">eb</span>&nbsp;<span class="op" id="6012560">:=</span>&nbsp;<span class="builtintype" id="6012563">int32</span><span class="op" id="6012568">(</span><span class="ident" id="6012569"><a href="/image/draw/draw.go.html#6012499">sr</a></span><span class="op" id="6012571">)</span><span class="op" id="6012572">,</span>&nbsp;<span class="builtintype" id="6012574">int32</span><span class="op" id="6012579">(</span><span class="ident" id="6012580"><a href="/image/draw/draw.go.html#6012503">sg</a></span><span class="op" id="6012582">)</span><span class="op" id="6012583">,</span>&nbsp;<span class="builtintype" id="6012585">int32</span><span class="op" id="6012590">(</span><span class="ident" id="6012591"><a href="/image/draw/draw.go.html#6012507">sb</a></span><span class="op" id="6012593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6012598">if</span>&nbsp;<span class="ident" id="6012601"><a href="/image/draw/draw.go.html#6011063">floydSteinberg</a></span>&nbsp;<span class="op" id="6012616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6012622"><a href="/image/draw/draw.go.html#6012549">er</a></span>&nbsp;<span class="op" id="6012625">=</span>&nbsp;<span class="ident" id="6012627"><a href="/image/draw/draw.go.html#6010884">clamp</a></span><span class="op" id="6012632">(</span><span class="ident" id="6012633"><a href="/image/draw/draw.go.html#6012549">er</a></span>&nbsp;<span class="op" id="6012636">+</span>&nbsp;<span class="ident" id="6012638"><a href="/image/draw/draw.go.html#6012111">quantErrorCurr</a></span><span class="op" id="6012652">[</span><span class="ident" id="6012653"><a href="/image/draw/draw.go.html#6012373">x</a></span><span class="op" id="6012654">+</span><span class="num" id="6012655">1</span><span class="op" id="6012656">]</span><span class="op" id="6012657">[</span><span class="num" id="6012658">0</span><span class="op" id="6012659">]</span><span class="op" id="6012660">/</span><span class="num" id="6012661">16</span><span class="op" id="6012663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6012669"><a href="/image/draw/draw.go.html#6012553">eg</a></span>&nbsp;<span class="op" id="6012672">=</span>&nbsp;<span class="ident" id="6012674"><a href="/image/draw/draw.go.html#6010884">clamp</a></span><span class="op" id="6012679">(</span><span class="ident" id="6012680"><a href="/image/draw/draw.go.html#6012553">eg</a></span>&nbsp;<span class="op" id="6012683">+</span>&nbsp;<span class="ident" id="6012685"><a href="/image/draw/draw.go.html#6012111">quantErrorCurr</a></span><span class="op" id="6012699">[</span><span class="ident" id="6012700"><a href="/image/draw/draw.go.html#6012373">x</a></span><span class="op" id="6012701">+</span><span class="num" id="6012702">1</span><span class="op" id="6012703">]</span><span class="op" id="6012704">[</span><span class="num" id="6012705">1</span><span class="op" id="6012706">]</span><span class="op" id="6012707">/</span><span class="num" id="6012708">16</span><span class="op" id="6012710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6012716"><a href="/image/draw/draw.go.html#6012557">eb</a></span>&nbsp;<span class="op" id="6012719">=</span>&nbsp;<span class="ident" id="6012721"><a href="/image/draw/draw.go.html#6010884">clamp</a></span><span class="op" id="6012726">(</span><span class="ident" id="6012727"><a href="/image/draw/draw.go.html#6012557">eb</a></span>&nbsp;<span class="op" id="6012730">+</span>&nbsp;<span class="ident" id="6012732"><a href="/image/draw/draw.go.html#6012111">quantErrorCurr</a></span><span class="op" id="6012746">[</span><span class="ident" id="6012747"><a href="/image/draw/draw.go.html#6012373">x</a></span><span class="op" id="6012748">+</span><span class="num" id="6012749">1</span><span class="op" id="6012750">]</span><span class="op" id="6012751">[</span><span class="num" id="6012752">2</span><span class="op" id="6012753">]</span><span class="op" id="6012754">/</span><span class="num" id="6012755">16</span><span class="op" id="6012757">)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6012762">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6012768">if</span>&nbsp;<span class="ident" id="6012771"><a href="/image/draw/draw.go.html#6011540">palette</a></span>&nbsp;<span class="op" id="6012779">!=</span>&nbsp;<span class="ident" id="6012782">nil</span>&nbsp;<span class="op" id="6012786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6012792">//&nbsp;Find&nbsp;the&nbsp;closest&nbsp;palette&nbsp;color&nbsp;in&nbsp;Euclidean&nbsp;R,G,B&nbsp;space:&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6012860">//&nbsp;one&nbsp;that&nbsp;minimizes&nbsp;sum-squared-difference.&nbsp;We&nbsp;shift&nbsp;by&nbsp;1&nbsp;bit</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6012928">//&nbsp;to&nbsp;avoid&nbsp;potential&nbsp;uint32&nbsp;overflow&nbsp;in&nbsp;sum-squared-difference.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6012997">//&nbsp;TODO(nigeltao):&nbsp;consider&nbsp;smarter&nbsp;algorithms.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6013049">bestIndex</span><span class="op" id="6013058">,</span>&nbsp;<span class="ident" id="6013060">bestSSD</span>&nbsp;<span class="op" id="6013068">:=</span>&nbsp;<span class="num" id="6013071">0</span><span class="op" id="6013072">,</span>&nbsp;<span class="builtintype" id="6013074">uint32</span><span class="op" id="6013080">(</span><span class="num" id="6013081">1</span><span class="op" id="6013082">&lt;&lt;</span><span class="num" id="6013084">32</span><span class="op" id="6013086">-</span><span class="num" id="6013087">1</span><span class="op" id="6013088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6013094">for</span>&nbsp;<span class="ident" id="6013098">index</span><span class="op" id="6013103">,</span>&nbsp;<span class="ident" id="6013105">p</span>&nbsp;<span class="op" id="6013107">:=</span>&nbsp;<span class="keyword" id="6013110">range</span>&nbsp;<span class="ident" id="6013116"><a href="/image/draw/draw.go.html#6011540">palette</a></span>&nbsp;<span class="op" id="6013124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6013131">delta</span>&nbsp;<span class="op" id="6013137">:=</span>&nbsp;<span class="op" id="6013140">(</span><span class="ident" id="6013141"><a href="/image/draw/draw.go.html#6012549">er</a></span>&nbsp;<span class="op" id="6013144">-</span>&nbsp;<span class="ident" id="6013146"><a href="/image/draw/draw.go.html#6013105">p</a></span><span class="op" id="6013147">[</span><span class="num" id="6013148">0</span><span class="op" id="6013149">]</span><span class="op" id="6013150">)</span>&nbsp;<span class="op" id="6013152">&gt;&gt;</span>&nbsp;<span class="num" id="6013155">1</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6013162">ssd</span>&nbsp;<span class="op" id="6013166">:=</span>&nbsp;<span class="builtintype" id="6013169">uint32</span><span class="op" id="6013175">(</span><span class="ident" id="6013176"><a href="/image/draw/draw.go.html#6013131">delta</a></span>&nbsp;<span class="op" id="6013182">*</span>&nbsp;<span class="ident" id="6013184"><a href="/image/draw/draw.go.html#6013131">delta</a></span><span class="op" id="6013189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6013196"><a href="/image/draw/draw.go.html#6013131">delta</a></span>&nbsp;<span class="op" id="6013202">=</span>&nbsp;<span class="op" id="6013204">(</span><span class="ident" id="6013205"><a href="/image/draw/draw.go.html#6012553">eg</a></span>&nbsp;<span class="op" id="6013208">-</span>&nbsp;<span class="ident" id="6013210"><a href="/image/draw/draw.go.html#6013105">p</a></span><span class="op" id="6013211">[</span><span class="num" id="6013212">1</span><span class="op" id="6013213">]</span><span class="op" id="6013214">)</span>&nbsp;<span class="op" id="6013216">&gt;&gt;</span>&nbsp;<span class="num" id="6013219">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6013226"><a href="/image/draw/draw.go.html#6013162">ssd</a></span>&nbsp;<span class="op" id="6013230">+=</span>&nbsp;<span class="builtintype" id="6013233">uint32</span><span class="op" id="6013239">(</span><span class="ident" id="6013240"><a href="/image/draw/draw.go.html#6013131">delta</a></span>&nbsp;<span class="op" id="6013246">*</span>&nbsp;<span class="ident" id="6013248"><a href="/image/draw/draw.go.html#6013131">delta</a></span><span class="op" id="6013253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6013260"><a href="/image/draw/draw.go.html#6013131">delta</a></span>&nbsp;<span class="op" id="6013266">=</span>&nbsp;<span class="op" id="6013268">(</span><span class="ident" id="6013269"><a href="/image/draw/draw.go.html#6012557">eb</a></span>&nbsp;<span class="op" id="6013272">-</span>&nbsp;<span class="ident" id="6013274"><a href="/image/draw/draw.go.html#6013105">p</a></span><span class="op" id="6013275">[</span><span class="num" id="6013276">2</span><span class="op" id="6013277">]</span><span class="op" id="6013278">)</span>&nbsp;<span class="op" id="6013280">&gt;&gt;</span>&nbsp;<span class="num" id="6013283">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6013290"><a href="/image/draw/draw.go.html#6013162">ssd</a></span>&nbsp;<span class="op" id="6013294">+=</span>&nbsp;<span class="builtintype" id="6013297">uint32</span><span class="op" id="6013303">(</span><span class="ident" id="6013304"><a href="/image/draw/draw.go.html#6013131">delta</a></span>&nbsp;<span class="op" id="6013310">*</span>&nbsp;<span class="ident" id="6013312"><a href="/image/draw/draw.go.html#6013131">delta</a></span><span class="op" id="6013317">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6013324">if</span>&nbsp;<span class="ident" id="6013327"><a href="/image/draw/draw.go.html#6013162">ssd</a></span>&nbsp;<span class="op" id="6013331">&lt;</span>&nbsp;<span class="ident" id="6013333"><a href="/image/draw/draw.go.html#6013060">bestSSD</a></span>&nbsp;<span class="op" id="6013341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6013349"><a href="/image/draw/draw.go.html#6013049">bestIndex</a></span><span class="op" id="6013358">,</span>&nbsp;<span class="ident" id="6013360"><a href="/image/draw/draw.go.html#6013060">bestSSD</a></span>&nbsp;<span class="op" id="6013368">=</span>&nbsp;<span class="ident" id="6013370"><a href="/image/draw/draw.go.html#6013098">index</a></span><span class="op" id="6013375">,</span>&nbsp;<span class="ident" id="6013377"><a href="/image/draw/draw.go.html#6013162">ssd</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6013387">if</span>&nbsp;<span class="ident" id="6013390"><a href="/image/draw/draw.go.html#6013162">ssd</a></span>&nbsp;<span class="op" id="6013394">==</span>&nbsp;<span class="num" id="6013397">0</span>&nbsp;<span class="op" id="6013399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6013408">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6013420">}</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6013427">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6013433">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6013439"><a href="/image/draw/draw.go.html#6011549">pix</a></span><span class="op" id="6013442">[</span><span class="ident" id="6013443"><a href="/image/draw/draw.go.html#6012340">y</a></span><span class="op" id="6013444">*</span><span class="ident" id="6013445"><a href="/image/draw/draw.go.html#6011554">stride</a></span><span class="op" id="6013451">+</span><span class="ident" id="6013452"><a href="/image/draw/draw.go.html#6012373">x</a></span><span class="op" id="6013453">]</span>&nbsp;<span class="op" id="6013455">=</span>&nbsp;<span class="builtintype" id="6013457">byte</span><span class="op" id="6013461">(</span><span class="ident" id="6013462"><a href="/image/draw/draw.go.html#6013049">bestIndex</a></span><span class="op" id="6013471">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6013478">if</span>&nbsp;<span class="op" id="6013481">!</span><span class="ident" id="6013482"><a href="/image/draw/draw.go.html#6011063">floydSteinberg</a></span>&nbsp;<span class="op" id="6013497">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6013504">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6013517">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6013523"><a href="/image/draw/draw.go.html#6012549">er</a></span>&nbsp;<span class="op" id="6013526">-=</span>&nbsp;<span class="builtintype" id="6013529">int32</span><span class="op" id="6013534">(</span><span class="ident" id="6013535"><a href="/image/draw/draw.go.html#6011540">palette</a></span><span class="op" id="6013542">[</span><span class="ident" id="6013543"><a href="/image/draw/draw.go.html#6013049">bestIndex</a></span><span class="op" id="6013552">]</span><span class="op" id="6013553">[</span><span class="num" id="6013554">0</span><span class="op" id="6013555">]</span><span class="op" id="6013556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6013562"><a href="/image/draw/draw.go.html#6012553">eg</a></span>&nbsp;<span class="op" id="6013565">-=</span>&nbsp;<span class="builtintype" id="6013568">int32</span><span class="op" id="6013573">(</span><span class="ident" id="6013574"><a href="/image/draw/draw.go.html#6011540">palette</a></span><span class="op" id="6013581">[</span><span class="ident" id="6013582"><a href="/image/draw/draw.go.html#6013049">bestIndex</a></span><span class="op" id="6013591">]</span><span class="op" id="6013592">[</span><span class="num" id="6013593">1</span><span class="op" id="6013594">]</span><span class="op" id="6013595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6013601"><a href="/image/draw/draw.go.html#6012557">eb</a></span>&nbsp;<span class="op" id="6013604">-=</span>&nbsp;<span class="builtintype" id="6013607">int32</span><span class="op" id="6013612">(</span><span class="ident" id="6013613"><a href="/image/draw/draw.go.html#6011540">palette</a></span><span class="op" id="6013620">[</span><span class="ident" id="6013621"><a href="/image/draw/draw.go.html#6013049">bestIndex</a></span><span class="op" id="6013630">]</span><span class="op" id="6013631">[</span><span class="num" id="6013632">2</span><span class="op" id="6013633">]</span><span class="op" id="6013634">)</span><br>
<span class="lineno">630</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6013640">}</span>&nbsp;<span class="keyword" id="6013642">else</span>&nbsp;<span class="op" id="6013647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6013653"><a href="/image/draw/draw.go.html#6012304">out</a></span><span class="op" id="6013656">.</span><span class="ident" id="6013657">R</span>&nbsp;<span class="op" id="6013659">=</span>&nbsp;<span class="builtintype" id="6013661">uint16</span><span class="op" id="6013667">(</span><span class="ident" id="6013668"><a href="/image/draw/draw.go.html#6012549">er</a></span><span class="op" id="6013670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6013676"><a href="/image/draw/draw.go.html#6012304">out</a></span><span class="op" id="6013679">.</span><span class="ident" id="6013680">G</span>&nbsp;<span class="op" id="6013682">=</span>&nbsp;<span class="builtintype" id="6013684">uint16</span><span class="op" id="6013690">(</span><span class="ident" id="6013691"><a href="/image/draw/draw.go.html#6012553">eg</a></span><span class="op" id="6013693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6013699"><a href="/image/draw/draw.go.html#6012304">out</a></span><span class="op" id="6013702">.</span><span class="ident" id="6013703">B</span>&nbsp;<span class="op" id="6013705">=</span>&nbsp;<span class="builtintype" id="6013707">uint16</span><span class="op" id="6013713">(</span><span class="ident" id="6013714"><a href="/image/draw/draw.go.html#6012557">eb</a></span><span class="op" id="6013716">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6013722">//&nbsp;The&nbsp;third&nbsp;argument&nbsp;is&nbsp;&amp;out&nbsp;instead&nbsp;of&nbsp;out&nbsp;(and&nbsp;out&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6013783">//&nbsp;declared&nbsp;outside&nbsp;of&nbsp;the&nbsp;inner&nbsp;loop)&nbsp;to&nbsp;avoid&nbsp;the&nbsp;implicit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6013848">//&nbsp;conversion&nbsp;to&nbsp;color.Color&nbsp;here&nbsp;allocating&nbsp;memory&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6013911">//&nbsp;inner&nbsp;loop&nbsp;if&nbsp;sizeof(color.RGBA64)&nbsp;&gt;&nbsp;sizeof(uintptr).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6013972"><a href="/image/draw/draw.go.html#6011000">dst</a></span><span class="op" id="6013975">.</span><span class="ident" id="6013976">Set</span><span class="op" id="6013979">(</span><span class="ident" id="6013980"><a href="/image/draw/draw.go.html#6011011">r</a></span><span class="op" id="6013981">.</span><span class="ident" id="6013982">Min</span><span class="op" id="6013985">.</span><span class="ident" id="6013986">X</span><span class="op" id="6013987">+</span><span class="ident" id="6013988"><a href="/image/draw/draw.go.html#6012373">x</a></span><span class="op" id="6013989">,</span>&nbsp;<span class="ident" id="6013991"><a href="/image/draw/draw.go.html#6011011">r</a></span><span class="op" id="6013992">.</span><span class="ident" id="6013993">Min</span><span class="op" id="6013996">.</span><span class="ident" id="6013997">Y</span><span class="op" id="6013998">+</span><span class="ident" id="6013999"><a href="/image/draw/draw.go.html#6012340">y</a></span><span class="op" id="6014000">,</span>&nbsp;<span class="op" id="6014002">&amp;</span><span class="ident" id="6014003"><a href="/image/draw/draw.go.html#6012304">out</a></span><span class="op" id="6014006">)</span><br>
<span class="lineno">640</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6014013">if</span>&nbsp;<span class="op" id="6014016">!</span><span class="ident" id="6014017"><a href="/image/draw/draw.go.html#6011063">floydSteinberg</a></span>&nbsp;<span class="op" id="6014032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6014039">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6014052">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6014058"><a href="/image/draw/draw.go.html#6012499">sr</a></span><span class="op" id="6014060">,</span>&nbsp;<span class="ident" id="6014062"><a href="/image/draw/draw.go.html#6012503">sg</a></span><span class="op" id="6014064">,</span>&nbsp;<span class="ident" id="6014066"><a href="/image/draw/draw.go.html#6012507">sb</a></span><span class="op" id="6014068">,</span>&nbsp;<span class="ident" id="6014070">_</span>&nbsp;<span class="op" id="6014072">=</span>&nbsp;<span class="ident" id="6014074"><a href="/image/draw/draw.go.html#6011000">dst</a></span><span class="op" id="6014077">.</span><span class="ident" id="6014078">At</span><span class="op" id="6014080">(</span><span class="ident" id="6014081"><a href="/image/draw/draw.go.html#6011011">r</a></span><span class="op" id="6014082">.</span><span class="ident" id="6014083">Min</span><span class="op" id="6014086">.</span><span class="ident" id="6014087">X</span><span class="op" id="6014088">+</span><span class="ident" id="6014089"><a href="/image/draw/draw.go.html#6012373">x</a></span><span class="op" id="6014090">,</span>&nbsp;<span class="ident" id="6014092"><a href="/image/draw/draw.go.html#6011011">r</a></span><span class="op" id="6014093">.</span><span class="ident" id="6014094">Min</span><span class="op" id="6014097">.</span><span class="ident" id="6014098">Y</span><span class="op" id="6014099">+</span><span class="ident" id="6014100"><a href="/image/draw/draw.go.html#6012340">y</a></span><span class="op" id="6014101">)</span><span class="op" id="6014102">.</span><span class="ident" id="6014103">RGBA</span><span class="op" id="6014107">(</span><span class="op" id="6014108">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6014114"><a href="/image/draw/draw.go.html#6012549">er</a></span>&nbsp;<span class="op" id="6014117">-=</span>&nbsp;<span class="builtintype" id="6014120">int32</span><span class="op" id="6014125">(</span><span class="ident" id="6014126"><a href="/image/draw/draw.go.html#6012499">sr</a></span><span class="op" id="6014128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6014134"><a href="/image/draw/draw.go.html#6012553">eg</a></span>&nbsp;<span class="op" id="6014137">-=</span>&nbsp;<span class="builtintype" id="6014140">int32</span><span class="op" id="6014145">(</span><span class="ident" id="6014146"><a href="/image/draw/draw.go.html#6012503">sg</a></span><span class="op" id="6014148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6014154"><a href="/image/draw/draw.go.html#6012557">eb</a></span>&nbsp;<span class="op" id="6014157">-=</span>&nbsp;<span class="builtintype" id="6014160">int32</span><span class="op" id="6014165">(</span><span class="ident" id="6014166"><a href="/image/draw/draw.go.html#6012507">sb</a></span><span class="op" id="6014168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6014173">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6014179">//&nbsp;Propagate&nbsp;the&nbsp;Floyd-Steinberg&nbsp;quantization&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6014235"><a href="/image/draw/draw.go.html#6012127">quantErrorNext</a></span><span class="op" id="6014249">[</span><span class="ident" id="6014250"><a href="/image/draw/draw.go.html#6012373">x</a></span><span class="op" id="6014251">+</span><span class="num" id="6014252">0</span><span class="op" id="6014253">]</span><span class="op" id="6014254">[</span><span class="num" id="6014255">0</span><span class="op" id="6014256">]</span>&nbsp;<span class="op" id="6014258">+=</span>&nbsp;<span class="ident" id="6014261"><a href="/image/draw/draw.go.html#6012549">er</a></span>&nbsp;<span class="op" id="6014264">*</span>&nbsp;<span class="num" id="6014266">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6014271"><a href="/image/draw/draw.go.html#6012127">quantErrorNext</a></span><span class="op" id="6014285">[</span><span class="ident" id="6014286"><a href="/image/draw/draw.go.html#6012373">x</a></span><span class="op" id="6014287">+</span><span class="num" id="6014288">0</span><span class="op" id="6014289">]</span><span class="op" id="6014290">[</span><span class="num" id="6014291">1</span><span class="op" id="6014292">]</span>&nbsp;<span class="op" id="6014294">+=</span>&nbsp;<span class="ident" id="6014297"><a href="/image/draw/draw.go.html#6012553">eg</a></span>&nbsp;<span class="op" id="6014300">*</span>&nbsp;<span class="num" id="6014302">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6014307"><a href="/image/draw/draw.go.html#6012127">quantErrorNext</a></span><span class="op" id="6014321">[</span><span class="ident" id="6014322"><a href="/image/draw/draw.go.html#6012373">x</a></span><span class="op" id="6014323">+</span><span class="num" id="6014324">0</span><span class="op" id="6014325">]</span><span class="op" id="6014326">[</span><span class="num" id="6014327">2</span><span class="op" id="6014328">]</span>&nbsp;<span class="op" id="6014330">+=</span>&nbsp;<span class="ident" id="6014333"><a href="/image/draw/draw.go.html#6012557">eb</a></span>&nbsp;<span class="op" id="6014336">*</span>&nbsp;<span class="num" id="6014338">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6014343"><a href="/image/draw/draw.go.html#6012127">quantErrorNext</a></span><span class="op" id="6014357">[</span><span class="ident" id="6014358"><a href="/image/draw/draw.go.html#6012373">x</a></span><span class="op" id="6014359">+</span><span class="num" id="6014360">1</span><span class="op" id="6014361">]</span><span class="op" id="6014362">[</span><span class="num" id="6014363">0</span><span class="op" id="6014364">]</span>&nbsp;<span class="op" id="6014366">+=</span>&nbsp;<span class="ident" id="6014369"><a href="/image/draw/draw.go.html#6012549">er</a></span>&nbsp;<span class="op" id="6014372">*</span>&nbsp;<span class="num" id="6014374">5</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6014379"><a href="/image/draw/draw.go.html#6012127">quantErrorNext</a></span><span class="op" id="6014393">[</span><span class="ident" id="6014394"><a href="/image/draw/draw.go.html#6012373">x</a></span><span class="op" id="6014395">+</span><span class="num" id="6014396">1</span><span class="op" id="6014397">]</span><span class="op" id="6014398">[</span><span class="num" id="6014399">1</span><span class="op" id="6014400">]</span>&nbsp;<span class="op" id="6014402">+=</span>&nbsp;<span class="ident" id="6014405"><a href="/image/draw/draw.go.html#6012553">eg</a></span>&nbsp;<span class="op" id="6014408">*</span>&nbsp;<span class="num" id="6014410">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6014415"><a href="/image/draw/draw.go.html#6012127">quantErrorNext</a></span><span class="op" id="6014429">[</span><span class="ident" id="6014430"><a href="/image/draw/draw.go.html#6012373">x</a></span><span class="op" id="6014431">+</span><span class="num" id="6014432">1</span><span class="op" id="6014433">]</span><span class="op" id="6014434">[</span><span class="num" id="6014435">2</span><span class="op" id="6014436">]</span>&nbsp;<span class="op" id="6014438">+=</span>&nbsp;<span class="ident" id="6014441"><a href="/image/draw/draw.go.html#6012557">eb</a></span>&nbsp;<span class="op" id="6014444">*</span>&nbsp;<span class="num" id="6014446">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6014451"><a href="/image/draw/draw.go.html#6012127">quantErrorNext</a></span><span class="op" id="6014465">[</span><span class="ident" id="6014466"><a href="/image/draw/draw.go.html#6012373">x</a></span><span class="op" id="6014467">+</span><span class="num" id="6014468">2</span><span class="op" id="6014469">]</span><span class="op" id="6014470">[</span><span class="num" id="6014471">0</span><span class="op" id="6014472">]</span>&nbsp;<span class="op" id="6014474">+=</span>&nbsp;<span class="ident" id="6014477"><a href="/image/draw/draw.go.html#6012549">er</a></span>&nbsp;<span class="op" id="6014480">*</span>&nbsp;<span class="num" id="6014482">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6014487"><a href="/image/draw/draw.go.html#6012127">quantErrorNext</a></span><span class="op" id="6014501">[</span><span class="ident" id="6014502"><a href="/image/draw/draw.go.html#6012373">x</a></span><span class="op" id="6014503">+</span><span class="num" id="6014504">2</span><span class="op" id="6014505">]</span><span class="op" id="6014506">[</span><span class="num" id="6014507">1</span><span class="op" id="6014508">]</span>&nbsp;<span class="op" id="6014510">+=</span>&nbsp;<span class="ident" id="6014513"><a href="/image/draw/draw.go.html#6012553">eg</a></span>&nbsp;<span class="op" id="6014516">*</span>&nbsp;<span class="num" id="6014518">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6014523"><a href="/image/draw/draw.go.html#6012127">quantErrorNext</a></span><span class="op" id="6014537">[</span><span class="ident" id="6014538"><a href="/image/draw/draw.go.html#6012373">x</a></span><span class="op" id="6014539">+</span><span class="num" id="6014540">2</span><span class="op" id="6014541">]</span><span class="op" id="6014542">[</span><span class="num" id="6014543">2</span><span class="op" id="6014544">]</span>&nbsp;<span class="op" id="6014546">+=</span>&nbsp;<span class="ident" id="6014549"><a href="/image/draw/draw.go.html#6012557">eb</a></span>&nbsp;<span class="op" id="6014552">*</span>&nbsp;<span class="num" id="6014554">1</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6014559"><a href="/image/draw/draw.go.html#6012111">quantErrorCurr</a></span><span class="op" id="6014573">[</span><span class="ident" id="6014574"><a href="/image/draw/draw.go.html#6012373">x</a></span><span class="op" id="6014575">+</span><span class="num" id="6014576">2</span><span class="op" id="6014577">]</span><span class="op" id="6014578">[</span><span class="num" id="6014579">0</span><span class="op" id="6014580">]</span>&nbsp;<span class="op" id="6014582">+=</span>&nbsp;<span class="ident" id="6014585"><a href="/image/draw/draw.go.html#6012549">er</a></span>&nbsp;<span class="op" id="6014588">*</span>&nbsp;<span class="num" id="6014590">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6014595"><a href="/image/draw/draw.go.html#6012111">quantErrorCurr</a></span><span class="op" id="6014609">[</span><span class="ident" id="6014610"><a href="/image/draw/draw.go.html#6012373">x</a></span><span class="op" id="6014611">+</span><span class="num" id="6014612">2</span><span class="op" id="6014613">]</span><span class="op" id="6014614">[</span><span class="num" id="6014615">1</span><span class="op" id="6014616">]</span>&nbsp;<span class="op" id="6014618">+=</span>&nbsp;<span class="ident" id="6014621"><a href="/image/draw/draw.go.html#6012553">eg</a></span>&nbsp;<span class="op" id="6014624">*</span>&nbsp;<span class="num" id="6014626">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6014631"><a href="/image/draw/draw.go.html#6012111">quantErrorCurr</a></span><span class="op" id="6014645">[</span><span class="ident" id="6014646"><a href="/image/draw/draw.go.html#6012373">x</a></span><span class="op" id="6014647">+</span><span class="num" id="6014648">2</span><span class="op" id="6014649">]</span><span class="op" id="6014650">[</span><span class="num" id="6014651">2</span><span class="op" id="6014652">]</span>&nbsp;<span class="op" id="6014654">+=</span>&nbsp;<span class="ident" id="6014657"><a href="/image/draw/draw.go.html#6012557">eb</a></span>&nbsp;<span class="op" id="6014660">*</span>&nbsp;<span class="num" id="6014662">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6014666">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6014671">//&nbsp;Recycle&nbsp;the&nbsp;quantization&nbsp;error&nbsp;buffers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6014716">if</span>&nbsp;<span class="ident" id="6014719"><a href="/image/draw/draw.go.html#6011063">floydSteinberg</a></span>&nbsp;<span class="op" id="6014734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6014739"><a href="/image/draw/draw.go.html#6012111">quantErrorCurr</a></span><span class="op" id="6014753">,</span>&nbsp;<span class="ident" id="6014755"><a href="/image/draw/draw.go.html#6012127">quantErrorNext</a></span>&nbsp;<span class="op" id="6014770">=</span>&nbsp;<span class="ident" id="6014772"><a href="/image/draw/draw.go.html#6012127">quantErrorNext</a></span><span class="op" id="6014786">,</span>&nbsp;<span class="ident" id="6014788"><a href="/image/draw/draw.go.html#6012111">quantErrorCurr</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6014806">for</span>&nbsp;<span class="ident" id="6014810">i</span>&nbsp;<span class="op" id="6014812">:=</span>&nbsp;<span class="keyword" id="6014815">range</span>&nbsp;<span class="ident" id="6014821"><a href="/image/draw/draw.go.html#6012127">quantErrorNext</a></span>&nbsp;<span class="op" id="6014836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6014842"><a href="/image/draw/draw.go.html#6012127">quantErrorNext</a></span><span class="op" id="6014856">[</span><span class="ident" id="6014857"><a href="/image/draw/draw.go.html#6014810">i</a></span><span class="op" id="6014858">]</span>&nbsp;<span class="op" id="6014860">=</span>&nbsp;<span class="op" id="6014862">[</span><span class="num" id="6014863">3</span><span class="op" id="6014864">]</span><span class="builtintype" id="6014865">int32</span><span class="op" id="6014870">{</span><span class="op" id="6014871">}</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6014876">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6014880">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6014883">}</span><br>
<span class="lineno"></span><span class="op" id="6014885">}</span>
</div>
</body>
</html>
