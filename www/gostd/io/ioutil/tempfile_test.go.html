<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="8422269">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8422324">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8422378">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8422429">package</span>&nbsp;<span class="ident" id="8422437">ioutil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8422445">import</span>&nbsp;<span class="op" id="8422452">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8422455">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8422461">&#34;path/filepath&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8422478">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8422488">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8422498">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8422501">func</span>&nbsp;<span class="ident" id="8422506">TestTempFile</span><span class="op" id="8422518">(</span><span class="ident" id="8422519">t</span>&nbsp;<span class="op" id="8422521">*</span><span class="ident" id="8422522">testing</span><span class="op" id="8422529">.</span><span class="ident" id="8422530">T</span><span class="op" id="8422531">)</span>&nbsp;<span class="op" id="8422533">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8422536">f</span><span class="op" id="8422537">,</span>&nbsp;<span class="ident" id="8422539">err</span>&nbsp;<span class="op" id="8422543">:=</span>&nbsp;<span class="ident" id="8422546">TempFile</span><span class="op" id="8422554">(</span><span class="string" id="8422555">&#34;/_not_exists_&#34;</span><span class="op" id="8422570">,</span>&nbsp;<span class="string" id="8422572">&#34;foo&#34;</span><span class="op" id="8422577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8422580">if</span>&nbsp;<span class="ident" id="8422583">f</span>&nbsp;<span class="op" id="8422585">!=</span>&nbsp;<span class="ident" id="8422588">nil</span>&nbsp;<span class="op" id="8422592">||</span>&nbsp;<span class="ident" id="8422595">err</span>&nbsp;<span class="op" id="8422599">==</span>&nbsp;<span class="ident" id="8422602">nil</span>&nbsp;<span class="op" id="8422606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8422610">t</span><span class="op" id="8422611">.</span><span class="ident" id="8422612">Errorf</span><span class="op" id="8422618">(</span><span class="string" id="8422619">&#34;TempFile(`/_not_exists_`,&nbsp;`foo`)&nbsp;=&nbsp;%v,&nbsp;%v&#34;</span><span class="op" id="8422662">,</span>&nbsp;<span class="ident" id="8422664">f</span><span class="op" id="8422665">,</span>&nbsp;<span class="ident" id="8422667">err</span><span class="op" id="8422670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8422673">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8422677">dir</span>&nbsp;<span class="op" id="8422681">:=</span>&nbsp;<span class="ident" id="8422684">os</span><span class="op" id="8422686">.</span><span class="ident" id="8422687">TempDir</span><span class="op" id="8422694">(</span><span class="op" id="8422695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8422698">f</span><span class="op" id="8422699">,</span>&nbsp;<span class="ident" id="8422701">err</span>&nbsp;<span class="op" id="8422705">=</span>&nbsp;<span class="ident" id="8422707">TempFile</span><span class="op" id="8422715">(</span><span class="ident" id="8422716">dir</span><span class="op" id="8422719">,</span>&nbsp;<span class="string" id="8422721">&#34;ioutil_test&#34;</span><span class="op" id="8422734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8422737">if</span>&nbsp;<span class="ident" id="8422740">f</span>&nbsp;<span class="op" id="8422742">==</span>&nbsp;<span class="ident" id="8422745">nil</span>&nbsp;<span class="op" id="8422749">||</span>&nbsp;<span class="ident" id="8422752">err</span>&nbsp;<span class="op" id="8422756">!=</span>&nbsp;<span class="ident" id="8422759">nil</span>&nbsp;<span class="op" id="8422763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8422767">t</span><span class="op" id="8422768">.</span><span class="ident" id="8422769">Errorf</span><span class="op" id="8422775">(</span><span class="string" id="8422776">&#34;TempFile(dir,&nbsp;`ioutil_test`)&nbsp;=&nbsp;%v,&nbsp;%v&#34;</span><span class="op" id="8422815">,</span>&nbsp;<span class="ident" id="8422817">f</span><span class="op" id="8422818">,</span>&nbsp;<span class="ident" id="8422820">err</span><span class="op" id="8422823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8422826">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8422829">if</span>&nbsp;<span class="ident" id="8422832">f</span>&nbsp;<span class="op" id="8422834">!=</span>&nbsp;<span class="ident" id="8422837">nil</span>&nbsp;<span class="op" id="8422841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8422845">f</span><span class="op" id="8422846">.</span><span class="ident" id="8422847">Close</span><span class="op" id="8422852">(</span><span class="op" id="8422853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8422857">os</span><span class="op" id="8422859">.</span><span class="ident" id="8422860">Remove</span><span class="op" id="8422866">(</span><span class="ident" id="8422867">f</span><span class="op" id="8422868">.</span><span class="ident" id="8422869">Name</span><span class="op" id="8422873">(</span><span class="op" id="8422874">)</span><span class="op" id="8422875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8422879">re</span>&nbsp;<span class="op" id="8422882">:=</span>&nbsp;<span class="ident" id="8422885">regexp</span><span class="op" id="8422891">.</span><span class="ident" id="8422892">MustCompile</span><span class="op" id="8422903">(</span><span class="string" id="8422904">&#34;^&#34;</span>&nbsp;<span class="op" id="8422908">+</span>&nbsp;<span class="ident" id="8422910">regexp</span><span class="op" id="8422916">.</span><span class="ident" id="8422917">QuoteMeta</span><span class="op" id="8422926">(</span><span class="ident" id="8422927">filepath</span><span class="op" id="8422935">.</span><span class="ident" id="8422936">Join</span><span class="op" id="8422940">(</span><span class="ident" id="8422941">dir</span><span class="op" id="8422944">,</span>&nbsp;<span class="string" id="8422946">&#34;ioutil_test&#34;</span><span class="op" id="8422959">)</span><span class="op" id="8422960">)</span>&nbsp;<span class="op" id="8422962">+</span>&nbsp;<span class="string" id="8422964">&#34;[0-9]+$&#34;</span><span class="op" id="8422973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8422977">if</span>&nbsp;<span class="op" id="8422980">!</span><span class="ident" id="8422981">re</span><span class="op" id="8422983">.</span><span class="ident" id="8422984">MatchString</span><span class="op" id="8422995">(</span><span class="ident" id="8422996">f</span><span class="op" id="8422997">.</span><span class="ident" id="8422998">Name</span><span class="op" id="8423002">(</span><span class="op" id="8423003">)</span><span class="op" id="8423004">)</span>&nbsp;<span class="op" id="8423006">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8423011">t</span><span class="op" id="8423012">.</span><span class="ident" id="8423013">Errorf</span><span class="op" id="8423019">(</span><span class="string" id="8423020">&#34;TempFile(`&#34;</span><span class="op" id="8423032">+</span><span class="ident" id="8423033">dir</span><span class="op" id="8423036">+</span><span class="string" id="8423037">&#34;`,&nbsp;`ioutil_test`)&nbsp;created&nbsp;bad&nbsp;name&nbsp;%s&#34;</span><span class="op" id="8423076">,</span>&nbsp;<span class="ident" id="8423078">f</span><span class="op" id="8423079">.</span><span class="ident" id="8423080">Name</span><span class="op" id="8423084">(</span><span class="op" id="8423085">)</span><span class="op" id="8423086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8423090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8423093">}</span><br>
<span class="lineno"></span><span class="op" id="8423095">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="8423098">func</span>&nbsp;<span class="ident" id="8423103">TestTempDir</span><span class="op" id="8423114">(</span><span class="ident" id="8423115">t</span>&nbsp;<span class="op" id="8423117">*</span><span class="ident" id="8423118">testing</span><span class="op" id="8423125">.</span><span class="ident" id="8423126">T</span><span class="op" id="8423127">)</span>&nbsp;<span class="op" id="8423129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8423132">name</span><span class="op" id="8423136">,</span>&nbsp;<span class="ident" id="8423138">err</span>&nbsp;<span class="op" id="8423142">:=</span>&nbsp;<span class="ident" id="8423145">TempDir</span><span class="op" id="8423152">(</span><span class="string" id="8423153">&#34;/_not_exists_&#34;</span><span class="op" id="8423168">,</span>&nbsp;<span class="string" id="8423170">&#34;foo&#34;</span><span class="op" id="8423175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8423178">if</span>&nbsp;<span class="ident" id="8423181">name</span>&nbsp;<span class="op" id="8423186">!=</span>&nbsp;<span class="string" id="8423189">&#34;&#34;</span>&nbsp;<span class="op" id="8423192">||</span>&nbsp;<span class="ident" id="8423195">err</span>&nbsp;<span class="op" id="8423199">==</span>&nbsp;<span class="ident" id="8423202">nil</span>&nbsp;<span class="op" id="8423206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8423210">t</span><span class="op" id="8423211">.</span><span class="ident" id="8423212">Errorf</span><span class="op" id="8423218">(</span><span class="string" id="8423219">&#34;TempDir(`/_not_exists_`,&nbsp;`foo`)&nbsp;=&nbsp;%v,&nbsp;%v&#34;</span><span class="op" id="8423261">,</span>&nbsp;<span class="ident" id="8423263">name</span><span class="op" id="8423267">,</span>&nbsp;<span class="ident" id="8423269">err</span><span class="op" id="8423272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8423275">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8423279">dir</span>&nbsp;<span class="op" id="8423283">:=</span>&nbsp;<span class="ident" id="8423286">os</span><span class="op" id="8423288">.</span><span class="ident" id="8423289">TempDir</span><span class="op" id="8423296">(</span><span class="op" id="8423297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8423300">name</span><span class="op" id="8423304">,</span>&nbsp;<span class="ident" id="8423306">err</span>&nbsp;<span class="op" id="8423310">=</span>&nbsp;<span class="ident" id="8423312">TempDir</span><span class="op" id="8423319">(</span><span class="ident" id="8423320">dir</span><span class="op" id="8423323">,</span>&nbsp;<span class="string" id="8423325">&#34;ioutil_test&#34;</span><span class="op" id="8423338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8423341">if</span>&nbsp;<span class="ident" id="8423344">name</span>&nbsp;<span class="op" id="8423349">==</span>&nbsp;<span class="string" id="8423352">&#34;&#34;</span>&nbsp;<span class="op" id="8423355">||</span>&nbsp;<span class="ident" id="8423358">err</span>&nbsp;<span class="op" id="8423362">!=</span>&nbsp;<span class="ident" id="8423365">nil</span>&nbsp;<span class="op" id="8423369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8423373">t</span><span class="op" id="8423374">.</span><span class="ident" id="8423375">Errorf</span><span class="op" id="8423381">(</span><span class="string" id="8423382">&#34;TempDir(dir,&nbsp;`ioutil_test`)&nbsp;=&nbsp;%v,&nbsp;%v&#34;</span><span class="op" id="8423420">,</span>&nbsp;<span class="ident" id="8423422">name</span><span class="op" id="8423426">,</span>&nbsp;<span class="ident" id="8423428">err</span><span class="op" id="8423431">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8423434">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8423437">if</span>&nbsp;<span class="ident" id="8423440">name</span>&nbsp;<span class="op" id="8423445">!=</span>&nbsp;<span class="string" id="8423448">&#34;&#34;</span>&nbsp;<span class="op" id="8423451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8423455">os</span><span class="op" id="8423457">.</span><span class="ident" id="8423458">Remove</span><span class="op" id="8423464">(</span><span class="ident" id="8423465">name</span><span class="op" id="8423469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8423473">re</span>&nbsp;<span class="op" id="8423476">:=</span>&nbsp;<span class="ident" id="8423479">regexp</span><span class="op" id="8423485">.</span><span class="ident" id="8423486">MustCompile</span><span class="op" id="8423497">(</span><span class="string" id="8423498">&#34;^&#34;</span>&nbsp;<span class="op" id="8423502">+</span>&nbsp;<span class="ident" id="8423504">regexp</span><span class="op" id="8423510">.</span><span class="ident" id="8423511">QuoteMeta</span><span class="op" id="8423520">(</span><span class="ident" id="8423521">filepath</span><span class="op" id="8423529">.</span><span class="ident" id="8423530">Join</span><span class="op" id="8423534">(</span><span class="ident" id="8423535">dir</span><span class="op" id="8423538">,</span>&nbsp;<span class="string" id="8423540">&#34;ioutil_test&#34;</span><span class="op" id="8423553">)</span><span class="op" id="8423554">)</span>&nbsp;<span class="op" id="8423556">+</span>&nbsp;<span class="string" id="8423558">&#34;[0-9]+$&#34;</span><span class="op" id="8423567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8423571">if</span>&nbsp;<span class="op" id="8423574">!</span><span class="ident" id="8423575">re</span><span class="op" id="8423577">.</span><span class="ident" id="8423578">MatchString</span><span class="op" id="8423589">(</span><span class="ident" id="8423590">name</span><span class="op" id="8423594">)</span>&nbsp;<span class="op" id="8423596">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8423601">t</span><span class="op" id="8423602">.</span><span class="ident" id="8423603">Errorf</span><span class="op" id="8423609">(</span><span class="string" id="8423610">&#34;TempDir(`&#34;</span><span class="op" id="8423621">+</span><span class="ident" id="8423622">dir</span><span class="op" id="8423625">+</span><span class="string" id="8423626">&#34;`,&nbsp;`ioutil_test`)&nbsp;created&nbsp;bad&nbsp;name&nbsp;%s&#34;</span><span class="op" id="8423665">,</span>&nbsp;<span class="ident" id="8423667">name</span><span class="op" id="8423671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8423675">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8423678">}</span><br>
<span class="lineno"></span><span class="op" id="8423680">}</span>
</div>
</body>
</html>
