<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1660111">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1660166">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1660220">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1660271">//&nbsp;Package&nbsp;strconv&nbsp;implements&nbsp;conversions&nbsp;to&nbsp;and&nbsp;from&nbsp;string&nbsp;representations</span><br>
<span class="lineno"></span><span class="comment" id="1660348">//&nbsp;of&nbsp;basic&nbsp;data&nbsp;types.</span><br>
<span class="lineno"></span><span class="keyword" id="1660372">package</span>&nbsp;<span class="ident" id="1660380">strconv</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1660389">//&nbsp;decimal&nbsp;to&nbsp;binary&nbsp;floating&nbsp;point&nbsp;conversion.</span><br>
<span class="lineno">10</span><span class="comment" id="1660437">//&nbsp;Algorithm:</span><br>
<span class="lineno"></span><span class="comment" id="1660451">//&nbsp;&nbsp;&nbsp;1)&nbsp;Store&nbsp;input&nbsp;in&nbsp;multiprecision&nbsp;decimal.</span><br>
<span class="lineno"></span><span class="comment" id="1660498">//&nbsp;&nbsp;&nbsp;2)&nbsp;Multiply/divide&nbsp;decimal&nbsp;by&nbsp;powers&nbsp;of&nbsp;two&nbsp;until&nbsp;in&nbsp;range&nbsp;[0.5,&nbsp;1)</span><br>
<span class="lineno"></span><span class="comment" id="1660571">//&nbsp;&nbsp;&nbsp;3)&nbsp;Multiply&nbsp;by&nbsp;2^precision&nbsp;and&nbsp;round&nbsp;to&nbsp;get&nbsp;mantissa.</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="1660631">import</span>&nbsp;<span class="string" id="1660638">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1660646">var</span>&nbsp;<span class="ident" id="1660650">optimize</span>&nbsp;<span class="op" id="1660659">=</span>&nbsp;<span class="builtintype" id="1660661">true</span>&nbsp;<span class="comment" id="1660666">//&nbsp;can&nbsp;change&nbsp;for&nbsp;testing</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1660693">func</span>&nbsp;<span class="ident" id="1660698">equalIgnoreCase</span><span class="op" id="1660713">(</span><span class="ident" id="1660714">s1</span><span class="op" id="1660716">,</span>&nbsp;<span class="ident" id="1660718">s2</span>&nbsp;<span class="builtintype" id="1660721">string</span><span class="op" id="1660727">)</span>&nbsp;<span class="builtintype" id="1660729">bool</span>&nbsp;<span class="op" id="1660734">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1660737">if</span>&nbsp;<span class="builtinfunc" id="1660740">len</span><span class="op" id="1660743">(</span><span class="ident" id="1660744">s1</span><span class="op" id="1660746">)</span>&nbsp;<span class="op" id="1660748">!=</span>&nbsp;<span class="builtinfunc" id="1660751">len</span><span class="op" id="1660754">(</span><span class="ident" id="1660755">s2</span><span class="op" id="1660757">)</span>&nbsp;<span class="op" id="1660759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1660763">return</span>&nbsp;<span class="builtintype" id="1660770">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1660777">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1660780">for</span>&nbsp;<span class="ident" id="1660784">i</span>&nbsp;<span class="op" id="1660786">:=</span>&nbsp;<span class="num" id="1660789">0</span><span class="op" id="1660790">;</span>&nbsp;<span class="ident" id="1660792">i</span>&nbsp;<span class="op" id="1660794">&lt;</span>&nbsp;<span class="builtinfunc" id="1660796">len</span><span class="op" id="1660799">(</span><span class="ident" id="1660800">s1</span><span class="op" id="1660802">)</span><span class="op" id="1660803">;</span>&nbsp;<span class="ident" id="1660805">i</span><span class="op" id="1660806">++</span>&nbsp;<span class="op" id="1660809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1660813">c1</span>&nbsp;<span class="op" id="1660816">:=</span>&nbsp;<span class="ident" id="1660819">s1</span><span class="op" id="1660821">[</span><span class="ident" id="1660822">i</span><span class="op" id="1660823">]</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1660827">if</span>&nbsp;<span class="string" id="1660830">&#39;A&#39;</span>&nbsp;<span class="op" id="1660834">&lt;=</span>&nbsp;<span class="ident" id="1660837">c1</span>&nbsp;<span class="op" id="1660840">&amp;&amp;</span>&nbsp;<span class="ident" id="1660843">c1</span>&nbsp;<span class="op" id="1660846">&lt;=</span>&nbsp;<span class="string" id="1660849">&#39;Z&#39;</span>&nbsp;<span class="op" id="1660853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1660858">c1</span>&nbsp;<span class="op" id="1660861">+=</span>&nbsp;<span class="string" id="1660864">&#39;a&#39;</span>&nbsp;<span class="op" id="1660868">-</span>&nbsp;<span class="string" id="1660870">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1660876">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1660880">c2</span>&nbsp;<span class="op" id="1660883">:=</span>&nbsp;<span class="ident" id="1660886">s2</span><span class="op" id="1660888">[</span><span class="ident" id="1660889">i</span><span class="op" id="1660890">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1660894">if</span>&nbsp;<span class="string" id="1660897">&#39;A&#39;</span>&nbsp;<span class="op" id="1660901">&lt;=</span>&nbsp;<span class="ident" id="1660904">c2</span>&nbsp;<span class="op" id="1660907">&amp;&amp;</span>&nbsp;<span class="ident" id="1660910">c2</span>&nbsp;<span class="op" id="1660913">&lt;=</span>&nbsp;<span class="string" id="1660916">&#39;Z&#39;</span>&nbsp;<span class="op" id="1660920">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1660925">c2</span>&nbsp;<span class="op" id="1660928">+=</span>&nbsp;<span class="string" id="1660931">&#39;a&#39;</span>&nbsp;<span class="op" id="1660935">-</span>&nbsp;<span class="string" id="1660937">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1660943">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1660947">if</span>&nbsp;<span class="ident" id="1660950">c1</span>&nbsp;<span class="op" id="1660953">!=</span>&nbsp;<span class="ident" id="1660956">c2</span>&nbsp;<span class="op" id="1660959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1660964">return</span>&nbsp;<span class="builtintype" id="1660971">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1660979">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1660982">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1660985">return</span>&nbsp;<span class="builtintype" id="1660992">true</span><br>
<span class="lineno"></span><span class="op" id="1660997">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1661000">func</span>&nbsp;<span class="ident" id="1661005">special</span><span class="op" id="1661012">(</span><span class="ident" id="1661013">s</span>&nbsp;<span class="builtintype" id="1661015">string</span><span class="op" id="1661021">)</span>&nbsp;<span class="op" id="1661023">(</span><span class="ident" id="1661024">f</span>&nbsp;<span class="builtintype" id="1661026">float64</span><span class="op" id="1661033">,</span>&nbsp;<span class="ident" id="1661035">ok</span>&nbsp;<span class="builtintype" id="1661038">bool</span><span class="op" id="1661042">)</span>&nbsp;<span class="op" id="1661044">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1661047">if</span>&nbsp;<span class="builtinfunc" id="1661050">len</span><span class="op" id="1661053">(</span><span class="ident" id="1661054">s</span><span class="op" id="1661055">)</span>&nbsp;<span class="op" id="1661057">==</span>&nbsp;<span class="num" id="1661060">0</span>&nbsp;<span class="op" id="1661062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1661066">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1661074">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1661077">switch</span>&nbsp;<span class="ident" id="1661084">s</span><span class="op" id="1661085">[</span><span class="num" id="1661086">0</span><span class="op" id="1661087">]</span>&nbsp;<span class="op" id="1661089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1661092">default</span><span class="op" id="1661099">:</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1661103">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1661111">case</span>&nbsp;<span class="string" id="1661116">&#39;+&#39;</span><span class="op" id="1661119">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1661123">if</span>&nbsp;<span class="ident" id="1661126">equalIgnoreCase</span><span class="op" id="1661141">(</span><span class="ident" id="1661142">s</span><span class="op" id="1661143">,</span>&nbsp;<span class="string" id="1661145">&#34;+inf&#34;</span><span class="op" id="1661151">)</span>&nbsp;<span class="op" id="1661153">||</span>&nbsp;<span class="ident" id="1661156">equalIgnoreCase</span><span class="op" id="1661171">(</span><span class="ident" id="1661172">s</span><span class="op" id="1661173">,</span>&nbsp;<span class="string" id="1661175">&#34;+infinity&#34;</span><span class="op" id="1661186">)</span>&nbsp;<span class="op" id="1661188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1661193">return</span>&nbsp;<span class="ident" id="1661200">math</span><span class="op" id="1661204">.</span><span class="ident" id="1661205">Inf</span><span class="op" id="1661208">(</span><span class="num" id="1661209">1</span><span class="op" id="1661210">)</span><span class="op" id="1661211">,</span>&nbsp;<span class="builtintype" id="1661213">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1661220">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1661223">case</span>&nbsp;<span class="string" id="1661228">&#39;-&#39;</span><span class="op" id="1661231">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1661235">if</span>&nbsp;<span class="ident" id="1661238">equalIgnoreCase</span><span class="op" id="1661253">(</span><span class="ident" id="1661254">s</span><span class="op" id="1661255">,</span>&nbsp;<span class="string" id="1661257">&#34;-inf&#34;</span><span class="op" id="1661263">)</span>&nbsp;<span class="op" id="1661265">||</span>&nbsp;<span class="ident" id="1661268">equalIgnoreCase</span><span class="op" id="1661283">(</span><span class="ident" id="1661284">s</span><span class="op" id="1661285">,</span>&nbsp;<span class="string" id="1661287">&#34;-infinity&#34;</span><span class="op" id="1661298">)</span>&nbsp;<span class="op" id="1661300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1661305">return</span>&nbsp;<span class="ident" id="1661312">math</span><span class="op" id="1661316">.</span><span class="ident" id="1661317">Inf</span><span class="op" id="1661320">(</span><span class="op" id="1661321">-</span><span class="num" id="1661322">1</span><span class="op" id="1661323">)</span><span class="op" id="1661324">,</span>&nbsp;<span class="builtintype" id="1661326">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1661333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1661336">case</span>&nbsp;<span class="string" id="1661341">&#39;n&#39;</span><span class="op" id="1661344">,</span>&nbsp;<span class="string" id="1661346">&#39;N&#39;</span><span class="op" id="1661349">:</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1661353">if</span>&nbsp;<span class="ident" id="1661356">equalIgnoreCase</span><span class="op" id="1661371">(</span><span class="ident" id="1661372">s</span><span class="op" id="1661373">,</span>&nbsp;<span class="string" id="1661375">&#34;nan&#34;</span><span class="op" id="1661380">)</span>&nbsp;<span class="op" id="1661382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1661387">return</span>&nbsp;<span class="ident" id="1661394">math</span><span class="op" id="1661398">.</span><span class="ident" id="1661399">NaN</span><span class="op" id="1661402">(</span><span class="op" id="1661403">)</span><span class="op" id="1661404">,</span>&nbsp;<span class="builtintype" id="1661406">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1661413">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1661416">case</span>&nbsp;<span class="string" id="1661421">&#39;i&#39;</span><span class="op" id="1661424">,</span>&nbsp;<span class="string" id="1661426">&#39;I&#39;</span><span class="op" id="1661429">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1661433">if</span>&nbsp;<span class="ident" id="1661436">equalIgnoreCase</span><span class="op" id="1661451">(</span><span class="ident" id="1661452">s</span><span class="op" id="1661453">,</span>&nbsp;<span class="string" id="1661455">&#34;inf&#34;</span><span class="op" id="1661460">)</span>&nbsp;<span class="op" id="1661462">||</span>&nbsp;<span class="ident" id="1661465">equalIgnoreCase</span><span class="op" id="1661480">(</span><span class="ident" id="1661481">s</span><span class="op" id="1661482">,</span>&nbsp;<span class="string" id="1661484">&#34;infinity&#34;</span><span class="op" id="1661494">)</span>&nbsp;<span class="op" id="1661496">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1661501">return</span>&nbsp;<span class="ident" id="1661508">math</span><span class="op" id="1661512">.</span><span class="ident" id="1661513">Inf</span><span class="op" id="1661516">(</span><span class="num" id="1661517">1</span><span class="op" id="1661518">)</span><span class="op" id="1661519">,</span>&nbsp;<span class="builtintype" id="1661521">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1661528">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1661531">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1661534">return</span><br>
<span class="lineno"></span><span class="op" id="1661541">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="1661544">func</span>&nbsp;<span class="op" id="1661549">(</span><span class="ident" id="1661550">b</span>&nbsp;<span class="op" id="1661552">*</span><span class="ident" id="1661553">decimal</span><span class="op" id="1661560">)</span>&nbsp;<span class="ident" id="1661562">set</span><span class="op" id="1661565">(</span><span class="ident" id="1661566">s</span>&nbsp;<span class="builtintype" id="1661568">string</span><span class="op" id="1661574">)</span>&nbsp;<span class="op" id="1661576">(</span><span class="ident" id="1661577">ok</span>&nbsp;<span class="builtintype" id="1661580">bool</span><span class="op" id="1661584">)</span>&nbsp;<span class="op" id="1661586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1661589">i</span>&nbsp;<span class="op" id="1661591">:=</span>&nbsp;<span class="num" id="1661594">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1661597">b</span><span class="op" id="1661598">.</span><span class="ident" id="1661599">neg</span>&nbsp;<span class="op" id="1661603">=</span>&nbsp;<span class="builtintype" id="1661605">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1661612">b</span><span class="op" id="1661613">.</span><span class="ident" id="1661614">trunc</span>&nbsp;<span class="op" id="1661620">=</span>&nbsp;<span class="builtintype" id="1661622">false</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1661630">//&nbsp;optional&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1661648">if</span>&nbsp;<span class="ident" id="1661651">i</span>&nbsp;<span class="op" id="1661653">&gt;=</span>&nbsp;<span class="builtinfunc" id="1661656">len</span><span class="op" id="1661659">(</span><span class="ident" id="1661660">s</span><span class="op" id="1661661">)</span>&nbsp;<span class="op" id="1661663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1661667">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1661675">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1661678">switch</span>&nbsp;<span class="op" id="1661685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1661688">case</span>&nbsp;<span class="ident" id="1661693">s</span><span class="op" id="1661694">[</span><span class="ident" id="1661695">i</span><span class="op" id="1661696">]</span>&nbsp;<span class="op" id="1661698">==</span>&nbsp;<span class="string" id="1661701">&#39;+&#39;</span><span class="op" id="1661704">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1661708">i</span><span class="op" id="1661709">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1661713">case</span>&nbsp;<span class="ident" id="1661718">s</span><span class="op" id="1661719">[</span><span class="ident" id="1661720">i</span><span class="op" id="1661721">]</span>&nbsp;<span class="op" id="1661723">==</span>&nbsp;<span class="string" id="1661726">&#39;-&#39;</span><span class="op" id="1661729">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1661733">b</span><span class="op" id="1661734">.</span><span class="ident" id="1661735">neg</span>&nbsp;<span class="op" id="1661739">=</span>&nbsp;<span class="builtintype" id="1661741">true</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1661748">i</span><span class="op" id="1661749">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1661753">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1661757">//&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1661768">sawdot</span>&nbsp;<span class="op" id="1661775">:=</span>&nbsp;<span class="builtintype" id="1661778">false</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1661785">sawdigits</span>&nbsp;<span class="op" id="1661795">:=</span>&nbsp;<span class="builtintype" id="1661798">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1661805">for</span>&nbsp;<span class="op" id="1661809">;</span>&nbsp;<span class="ident" id="1661811">i</span>&nbsp;<span class="op" id="1661813">&lt;</span>&nbsp;<span class="builtinfunc" id="1661815">len</span><span class="op" id="1661818">(</span><span class="ident" id="1661819">s</span><span class="op" id="1661820">)</span><span class="op" id="1661821">;</span>&nbsp;<span class="ident" id="1661823">i</span><span class="op" id="1661824">++</span>&nbsp;<span class="op" id="1661827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1661831">switch</span>&nbsp;<span class="op" id="1661838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1661842">case</span>&nbsp;<span class="ident" id="1661847">s</span><span class="op" id="1661848">[</span><span class="ident" id="1661849">i</span><span class="op" id="1661850">]</span>&nbsp;<span class="op" id="1661852">==</span>&nbsp;<span class="string" id="1661855">&#39;.&#39;</span><span class="op" id="1661858">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1661863">if</span>&nbsp;<span class="ident" id="1661866">sawdot</span>&nbsp;<span class="op" id="1661873">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1661879">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1661889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1661894">sawdot</span>&nbsp;<span class="op" id="1661901">=</span>&nbsp;<span class="builtintype" id="1661903">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1661911">b</span><span class="op" id="1661912">.</span><span class="ident" id="1661913">dp</span>&nbsp;<span class="op" id="1661916">=</span>&nbsp;<span class="ident" id="1661918">b</span><span class="op" id="1661919">.</span><span class="ident" id="1661920">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1661926">continue</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1661938">case</span>&nbsp;<span class="string" id="1661943">&#39;0&#39;</span>&nbsp;<span class="op" id="1661947">&lt;=</span>&nbsp;<span class="ident" id="1661950">s</span><span class="op" id="1661951">[</span><span class="ident" id="1661952">i</span><span class="op" id="1661953">]</span>&nbsp;<span class="op" id="1661955">&amp;&amp;</span>&nbsp;<span class="ident" id="1661958">s</span><span class="op" id="1661959">[</span><span class="ident" id="1661960">i</span><span class="op" id="1661961">]</span>&nbsp;<span class="op" id="1661963">&lt;=</span>&nbsp;<span class="string" id="1661966">&#39;9&#39;</span><span class="op" id="1661969">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1661974">sawdigits</span>&nbsp;<span class="op" id="1661984">=</span>&nbsp;<span class="builtintype" id="1661986">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1661994">if</span>&nbsp;<span class="ident" id="1661997">s</span><span class="op" id="1661998">[</span><span class="ident" id="1661999">i</span><span class="op" id="1662000">]</span>&nbsp;<span class="op" id="1662002">==</span>&nbsp;<span class="string" id="1662005">&#39;0&#39;</span>&nbsp;<span class="op" id="1662009">&amp;&amp;</span>&nbsp;<span class="ident" id="1662012">b</span><span class="op" id="1662013">.</span><span class="ident" id="1662014">nd</span>&nbsp;<span class="op" id="1662017">==</span>&nbsp;<span class="num" id="1662020">0</span>&nbsp;<span class="op" id="1662022">{</span>&nbsp;<span class="comment" id="1662024">//&nbsp;ignore&nbsp;leading&nbsp;zeros</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1662052">b</span><span class="op" id="1662053">.</span><span class="ident" id="1662054">dp</span><span class="op" id="1662056">--</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1662063">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1662075">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1662080">if</span>&nbsp;<span class="ident" id="1662083">b</span><span class="op" id="1662084">.</span><span class="ident" id="1662085">nd</span>&nbsp;<span class="op" id="1662088">&lt;</span>&nbsp;<span class="builtinfunc" id="1662090">len</span><span class="op" id="1662093">(</span><span class="ident" id="1662094">b</span><span class="op" id="1662095">.</span><span class="ident" id="1662096">d</span><span class="op" id="1662097">)</span>&nbsp;<span class="op" id="1662099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1662105">b</span><span class="op" id="1662106">.</span><span class="ident" id="1662107">d</span><span class="op" id="1662108">[</span><span class="ident" id="1662109">b</span><span class="op" id="1662110">.</span><span class="ident" id="1662111">nd</span><span class="op" id="1662113">]</span>&nbsp;<span class="op" id="1662115">=</span>&nbsp;<span class="ident" id="1662117">s</span><span class="op" id="1662118">[</span><span class="ident" id="1662119">i</span><span class="op" id="1662120">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1662126">b</span><span class="op" id="1662127">.</span><span class="ident" id="1662128">nd</span><span class="op" id="1662130">++</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1662136">}</span>&nbsp;<span class="keyword" id="1662138">else</span>&nbsp;<span class="keyword" id="1662143">if</span>&nbsp;<span class="ident" id="1662146">s</span><span class="op" id="1662147">[</span><span class="ident" id="1662148">i</span><span class="op" id="1662149">]</span>&nbsp;<span class="op" id="1662151">!=</span>&nbsp;<span class="string" id="1662154">&#39;0&#39;</span>&nbsp;<span class="op" id="1662158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1662164">b</span><span class="op" id="1662165">.</span><span class="ident" id="1662166">trunc</span>&nbsp;<span class="op" id="1662172">=</span>&nbsp;<span class="builtintype" id="1662174">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1662182">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1662187">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1662198">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1662202">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1662209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1662212">if</span>&nbsp;<span class="op" id="1662215">!</span><span class="ident" id="1662216">sawdigits</span>&nbsp;<span class="op" id="1662226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1662230">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1662238">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1662241">if</span>&nbsp;<span class="op" id="1662244">!</span><span class="ident" id="1662245">sawdot</span>&nbsp;<span class="op" id="1662252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1662256">b</span><span class="op" id="1662257">.</span><span class="ident" id="1662258">dp</span>&nbsp;<span class="op" id="1662261">=</span>&nbsp;<span class="ident" id="1662263">b</span><span class="op" id="1662264">.</span><span class="ident" id="1662265">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1662269">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1662273">//&nbsp;optional&nbsp;exponent&nbsp;moves&nbsp;decimal&nbsp;point.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1662316">//&nbsp;if&nbsp;we&nbsp;read&nbsp;a&nbsp;very&nbsp;large,&nbsp;very&nbsp;long&nbsp;number,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1662363">//&nbsp;just&nbsp;be&nbsp;sure&nbsp;to&nbsp;move&nbsp;the&nbsp;decimal&nbsp;point&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1662409">//&nbsp;a&nbsp;lot&nbsp;(say,&nbsp;100000).&nbsp;&nbsp;it&nbsp;doesn&#39;t&nbsp;matter&nbsp;if&nbsp;it&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1662461">//&nbsp;not&nbsp;the&nbsp;exact&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1662487">if</span>&nbsp;<span class="ident" id="1662490">i</span>&nbsp;<span class="op" id="1662492">&lt;</span>&nbsp;<span class="builtinfunc" id="1662494">len</span><span class="op" id="1662497">(</span><span class="ident" id="1662498">s</span><span class="op" id="1662499">)</span>&nbsp;<span class="op" id="1662501">&amp;&amp;</span>&nbsp;<span class="op" id="1662504">(</span><span class="ident" id="1662505">s</span><span class="op" id="1662506">[</span><span class="ident" id="1662507">i</span><span class="op" id="1662508">]</span>&nbsp;<span class="op" id="1662510">==</span>&nbsp;<span class="string" id="1662513">&#39;e&#39;</span>&nbsp;<span class="op" id="1662517">||</span>&nbsp;<span class="ident" id="1662520">s</span><span class="op" id="1662521">[</span><span class="ident" id="1662522">i</span><span class="op" id="1662523">]</span>&nbsp;<span class="op" id="1662525">==</span>&nbsp;<span class="string" id="1662528">&#39;E&#39;</span><span class="op" id="1662531">)</span>&nbsp;<span class="op" id="1662533">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1662537">i</span><span class="op" id="1662538">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1662543">if</span>&nbsp;<span class="ident" id="1662546">i</span>&nbsp;<span class="op" id="1662548">&gt;=</span>&nbsp;<span class="builtinfunc" id="1662551">len</span><span class="op" id="1662554">(</span><span class="ident" id="1662555">s</span><span class="op" id="1662556">)</span>&nbsp;<span class="op" id="1662558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1662563">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1662572">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1662576">esign</span>&nbsp;<span class="op" id="1662582">:=</span>&nbsp;<span class="num" id="1662585">1</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1662589">if</span>&nbsp;<span class="ident" id="1662592">s</span><span class="op" id="1662593">[</span><span class="ident" id="1662594">i</span><span class="op" id="1662595">]</span>&nbsp;<span class="op" id="1662597">==</span>&nbsp;<span class="string" id="1662600">&#39;+&#39;</span>&nbsp;<span class="op" id="1662604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1662609">i</span><span class="op" id="1662610">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1662615">}</span>&nbsp;<span class="keyword" id="1662617">else</span>&nbsp;<span class="keyword" id="1662622">if</span>&nbsp;<span class="ident" id="1662625">s</span><span class="op" id="1662626">[</span><span class="ident" id="1662627">i</span><span class="op" id="1662628">]</span>&nbsp;<span class="op" id="1662630">==</span>&nbsp;<span class="string" id="1662633">&#39;-&#39;</span>&nbsp;<span class="op" id="1662637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1662642">i</span><span class="op" id="1662643">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1662649">esign</span>&nbsp;<span class="op" id="1662655">=</span>&nbsp;<span class="op" id="1662657">-</span><span class="num" id="1662658">1</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1662662">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1662666">if</span>&nbsp;<span class="ident" id="1662669">i</span>&nbsp;<span class="op" id="1662671">&gt;=</span>&nbsp;<span class="builtinfunc" id="1662674">len</span><span class="op" id="1662677">(</span><span class="ident" id="1662678">s</span><span class="op" id="1662679">)</span>&nbsp;<span class="op" id="1662681">||</span>&nbsp;<span class="ident" id="1662684">s</span><span class="op" id="1662685">[</span><span class="ident" id="1662686">i</span><span class="op" id="1662687">]</span>&nbsp;<span class="op" id="1662689">&lt;</span>&nbsp;<span class="string" id="1662691">&#39;0&#39;</span>&nbsp;<span class="op" id="1662695">||</span>&nbsp;<span class="ident" id="1662698">s</span><span class="op" id="1662699">[</span><span class="ident" id="1662700">i</span><span class="op" id="1662701">]</span>&nbsp;<span class="op" id="1662703">&gt;</span>&nbsp;<span class="string" id="1662705">&#39;9&#39;</span>&nbsp;<span class="op" id="1662709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1662714">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1662723">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1662727">e</span>&nbsp;<span class="op" id="1662729">:=</span>&nbsp;<span class="num" id="1662732">0</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1662736">for</span>&nbsp;<span class="op" id="1662740">;</span>&nbsp;<span class="ident" id="1662742">i</span>&nbsp;<span class="op" id="1662744">&lt;</span>&nbsp;<span class="builtinfunc" id="1662746">len</span><span class="op" id="1662749">(</span><span class="ident" id="1662750">s</span><span class="op" id="1662751">)</span>&nbsp;<span class="op" id="1662753">&amp;&amp;</span>&nbsp;<span class="string" id="1662756">&#39;0&#39;</span>&nbsp;<span class="op" id="1662760">&lt;=</span>&nbsp;<span class="ident" id="1662763">s</span><span class="op" id="1662764">[</span><span class="ident" id="1662765">i</span><span class="op" id="1662766">]</span>&nbsp;<span class="op" id="1662768">&amp;&amp;</span>&nbsp;<span class="ident" id="1662771">s</span><span class="op" id="1662772">[</span><span class="ident" id="1662773">i</span><span class="op" id="1662774">]</span>&nbsp;<span class="op" id="1662776">&lt;=</span>&nbsp;<span class="string" id="1662779">&#39;9&#39;</span><span class="op" id="1662782">;</span>&nbsp;<span class="ident" id="1662784">i</span><span class="op" id="1662785">++</span>&nbsp;<span class="op" id="1662788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1662793">if</span>&nbsp;<span class="ident" id="1662796">e</span>&nbsp;<span class="op" id="1662798">&lt;</span>&nbsp;<span class="num" id="1662800">10000</span>&nbsp;<span class="op" id="1662806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1662812">e</span>&nbsp;<span class="op" id="1662814">=</span>&nbsp;<span class="ident" id="1662816">e</span><span class="op" id="1662817">*</span><span class="num" id="1662818">10</span>&nbsp;<span class="op" id="1662821">+</span>&nbsp;<span class="builtintype" id="1662823">int</span><span class="op" id="1662826">(</span><span class="ident" id="1662827">s</span><span class="op" id="1662828">[</span><span class="ident" id="1662829">i</span><span class="op" id="1662830">]</span><span class="op" id="1662831">)</span>&nbsp;<span class="op" id="1662833">-</span>&nbsp;<span class="string" id="1662835">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1662842">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1662846">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1662850">b</span><span class="op" id="1662851">.</span><span class="ident" id="1662852">dp</span>&nbsp;<span class="op" id="1662855">+=</span>&nbsp;<span class="ident" id="1662858">e</span>&nbsp;<span class="op" id="1662860">*</span>&nbsp;<span class="ident" id="1662862">esign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1662869">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1662873">if</span>&nbsp;<span class="ident" id="1662876">i</span>&nbsp;<span class="op" id="1662878">!=</span>&nbsp;<span class="builtinfunc" id="1662881">len</span><span class="op" id="1662884">(</span><span class="ident" id="1662885">s</span><span class="op" id="1662886">)</span>&nbsp;<span class="op" id="1662888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1662892">return</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1662900">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1662904">ok</span>&nbsp;<span class="op" id="1662907">=</span>&nbsp;<span class="builtintype" id="1662909">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1662915">return</span><br>
<span class="lineno"></span><span class="op" id="1662922">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="1662925">//&nbsp;readFloat&nbsp;reads&nbsp;a&nbsp;decimal&nbsp;mantissa&nbsp;and&nbsp;exponent&nbsp;from&nbsp;a&nbsp;float</span><br>
<span class="lineno"></span><span class="comment" id="1662989">//&nbsp;string&nbsp;representation.&nbsp;It&nbsp;sets&nbsp;ok&nbsp;to&nbsp;false&nbsp;if&nbsp;the&nbsp;number&nbsp;could</span><br>
<span class="lineno"></span><span class="comment" id="1663055">//&nbsp;not&nbsp;fit&nbsp;return&nbsp;types&nbsp;or&nbsp;is&nbsp;invalid.</span><br>
<span class="lineno"></span><span class="keyword" id="1663094">func</span>&nbsp;<span class="ident" id="1663099">readFloat</span><span class="op" id="1663108">(</span><span class="ident" id="1663109">s</span>&nbsp;<span class="builtintype" id="1663111">string</span><span class="op" id="1663117">)</span>&nbsp;<span class="op" id="1663119">(</span><span class="ident" id="1663120">mantissa</span>&nbsp;<span class="ident" id="1663129">uint64</span><span class="op" id="1663135">,</span>&nbsp;<span class="ident" id="1663137">exp</span>&nbsp;<span class="builtintype" id="1663141">int</span><span class="op" id="1663144">,</span>&nbsp;<span class="ident" id="1663146">neg</span><span class="op" id="1663149">,</span>&nbsp;<span class="ident" id="1663151">trunc</span><span class="op" id="1663156">,</span>&nbsp;<span class="ident" id="1663158">ok</span>&nbsp;<span class="builtintype" id="1663161">bool</span><span class="op" id="1663165">)</span>&nbsp;<span class="op" id="1663167">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1663170">const</span>&nbsp;<span class="ident" id="1663176">uint64digits</span>&nbsp;<span class="op" id="1663189">=</span>&nbsp;<span class="num" id="1663191">19</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1663195">i</span>&nbsp;<span class="op" id="1663197">:=</span>&nbsp;<span class="num" id="1663200">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1663204">//&nbsp;optional&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1663222">if</span>&nbsp;<span class="ident" id="1663225">i</span>&nbsp;<span class="op" id="1663227">&gt;=</span>&nbsp;<span class="builtinfunc" id="1663230">len</span><span class="op" id="1663233">(</span><span class="ident" id="1663234">s</span><span class="op" id="1663235">)</span>&nbsp;<span class="op" id="1663237">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1663241">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1663249">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1663252">switch</span>&nbsp;<span class="op" id="1663259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1663262">case</span>&nbsp;<span class="ident" id="1663267">s</span><span class="op" id="1663268">[</span><span class="ident" id="1663269">i</span><span class="op" id="1663270">]</span>&nbsp;<span class="op" id="1663272">==</span>&nbsp;<span class="string" id="1663275">&#39;+&#39;</span><span class="op" id="1663278">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1663282">i</span><span class="op" id="1663283">++</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1663287">case</span>&nbsp;<span class="ident" id="1663292">s</span><span class="op" id="1663293">[</span><span class="ident" id="1663294">i</span><span class="op" id="1663295">]</span>&nbsp;<span class="op" id="1663297">==</span>&nbsp;<span class="string" id="1663300">&#39;-&#39;</span><span class="op" id="1663303">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1663307">neg</span>&nbsp;<span class="op" id="1663311">=</span>&nbsp;<span class="builtintype" id="1663313">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1663320">i</span><span class="op" id="1663321">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1663325">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1663329">//&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1663340">sawdot</span>&nbsp;<span class="op" id="1663347">:=</span>&nbsp;<span class="builtintype" id="1663350">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1663357">sawdigits</span>&nbsp;<span class="op" id="1663367">:=</span>&nbsp;<span class="builtintype" id="1663370">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1663377">nd</span>&nbsp;<span class="op" id="1663380">:=</span>&nbsp;<span class="num" id="1663383">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1663386">ndMant</span>&nbsp;<span class="op" id="1663393">:=</span>&nbsp;<span class="num" id="1663396">0</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1663399">dp</span>&nbsp;<span class="op" id="1663402">:=</span>&nbsp;<span class="num" id="1663405">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1663408">for</span>&nbsp;<span class="op" id="1663412">;</span>&nbsp;<span class="ident" id="1663414">i</span>&nbsp;<span class="op" id="1663416">&lt;</span>&nbsp;<span class="builtinfunc" id="1663418">len</span><span class="op" id="1663421">(</span><span class="ident" id="1663422">s</span><span class="op" id="1663423">)</span><span class="op" id="1663424">;</span>&nbsp;<span class="ident" id="1663426">i</span><span class="op" id="1663427">++</span>&nbsp;<span class="op" id="1663430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1663434">switch</span>&nbsp;<span class="ident" id="1663441">c</span>&nbsp;<span class="op" id="1663443">:=</span>&nbsp;<span class="ident" id="1663446">s</span><span class="op" id="1663447">[</span><span class="ident" id="1663448">i</span><span class="op" id="1663449">]</span><span class="op" id="1663450">;</span>&nbsp;<span class="builtintype" id="1663452">true</span>&nbsp;<span class="op" id="1663457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1663461">case</span>&nbsp;<span class="ident" id="1663466">c</span>&nbsp;<span class="op" id="1663468">==</span>&nbsp;<span class="string" id="1663471">&#39;.&#39;</span><span class="op" id="1663474">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1663479">if</span>&nbsp;<span class="ident" id="1663482">sawdot</span>&nbsp;<span class="op" id="1663489">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1663495">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1663505">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1663510">sawdot</span>&nbsp;<span class="op" id="1663517">=</span>&nbsp;<span class="builtintype" id="1663519">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1663527">dp</span>&nbsp;<span class="op" id="1663530">=</span>&nbsp;<span class="ident" id="1663532">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1663538">continue</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1663550">case</span>&nbsp;<span class="string" id="1663555">&#39;0&#39;</span>&nbsp;<span class="op" id="1663559">&lt;=</span>&nbsp;<span class="ident" id="1663562">c</span>&nbsp;<span class="op" id="1663564">&amp;&amp;</span>&nbsp;<span class="ident" id="1663567">c</span>&nbsp;<span class="op" id="1663569">&lt;=</span>&nbsp;<span class="string" id="1663572">&#39;9&#39;</span><span class="op" id="1663575">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1663580">sawdigits</span>&nbsp;<span class="op" id="1663590">=</span>&nbsp;<span class="builtintype" id="1663592">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1663600">if</span>&nbsp;<span class="ident" id="1663603">c</span>&nbsp;<span class="op" id="1663605">==</span>&nbsp;<span class="string" id="1663608">&#39;0&#39;</span>&nbsp;<span class="op" id="1663612">&amp;&amp;</span>&nbsp;<span class="ident" id="1663615">nd</span>&nbsp;<span class="op" id="1663618">==</span>&nbsp;<span class="num" id="1663621">0</span>&nbsp;<span class="op" id="1663623">{</span>&nbsp;<span class="comment" id="1663625">//&nbsp;ignore&nbsp;leading&nbsp;zeros</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1663653">dp</span><span class="op" id="1663655">--</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1663662">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1663674">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1663679">nd</span><span class="op" id="1663681">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1663687">if</span>&nbsp;<span class="ident" id="1663690">ndMant</span>&nbsp;<span class="op" id="1663697">&lt;</span>&nbsp;<span class="ident" id="1663699">uint64digits</span>&nbsp;<span class="op" id="1663712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1663718">mantissa</span>&nbsp;<span class="op" id="1663727">*=</span>&nbsp;<span class="num" id="1663730">10</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1663737">mantissa</span>&nbsp;<span class="op" id="1663746">+=</span>&nbsp;<span class="ident" id="1663749">uint64</span><span class="op" id="1663755">(</span><span class="ident" id="1663756">c</span>&nbsp;<span class="op" id="1663758">-</span>&nbsp;<span class="string" id="1663760">&#39;0&#39;</span><span class="op" id="1663763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1663769">ndMant</span><span class="op" id="1663775">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1663781">}</span>&nbsp;<span class="keyword" id="1663783">else</span>&nbsp;<span class="keyword" id="1663788">if</span>&nbsp;<span class="ident" id="1663791">s</span><span class="op" id="1663792">[</span><span class="ident" id="1663793">i</span><span class="op" id="1663794">]</span>&nbsp;<span class="op" id="1663796">!=</span>&nbsp;<span class="string" id="1663799">&#39;0&#39;</span>&nbsp;<span class="op" id="1663803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1663809">trunc</span>&nbsp;<span class="op" id="1663815">=</span>&nbsp;<span class="builtintype" id="1663817">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1663825">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1663830">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1663841">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1663845">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1663852">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1663855">if</span>&nbsp;<span class="op" id="1663858">!</span><span class="ident" id="1663859">sawdigits</span>&nbsp;<span class="op" id="1663869">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1663873">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1663881">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1663884">if</span>&nbsp;<span class="op" id="1663887">!</span><span class="ident" id="1663888">sawdot</span>&nbsp;<span class="op" id="1663895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1663899">dp</span>&nbsp;<span class="op" id="1663902">=</span>&nbsp;<span class="ident" id="1663904">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1663908">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1663912">//&nbsp;optional&nbsp;exponent&nbsp;moves&nbsp;decimal&nbsp;point.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1663955">//&nbsp;if&nbsp;we&nbsp;read&nbsp;a&nbsp;very&nbsp;large,&nbsp;very&nbsp;long&nbsp;number,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1664002">//&nbsp;just&nbsp;be&nbsp;sure&nbsp;to&nbsp;move&nbsp;the&nbsp;decimal&nbsp;point&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1664048">//&nbsp;a&nbsp;lot&nbsp;(say,&nbsp;100000).&nbsp;&nbsp;it&nbsp;doesn&#39;t&nbsp;matter&nbsp;if&nbsp;it&#39;s</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1664100">//&nbsp;not&nbsp;the&nbsp;exact&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1664126">if</span>&nbsp;<span class="ident" id="1664129">i</span>&nbsp;<span class="op" id="1664131">&lt;</span>&nbsp;<span class="builtinfunc" id="1664133">len</span><span class="op" id="1664136">(</span><span class="ident" id="1664137">s</span><span class="op" id="1664138">)</span>&nbsp;<span class="op" id="1664140">&amp;&amp;</span>&nbsp;<span class="op" id="1664143">(</span><span class="ident" id="1664144">s</span><span class="op" id="1664145">[</span><span class="ident" id="1664146">i</span><span class="op" id="1664147">]</span>&nbsp;<span class="op" id="1664149">==</span>&nbsp;<span class="string" id="1664152">&#39;e&#39;</span>&nbsp;<span class="op" id="1664156">||</span>&nbsp;<span class="ident" id="1664159">s</span><span class="op" id="1664160">[</span><span class="ident" id="1664161">i</span><span class="op" id="1664162">]</span>&nbsp;<span class="op" id="1664164">==</span>&nbsp;<span class="string" id="1664167">&#39;E&#39;</span><span class="op" id="1664170">)</span>&nbsp;<span class="op" id="1664172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1664176">i</span><span class="op" id="1664177">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1664182">if</span>&nbsp;<span class="ident" id="1664185">i</span>&nbsp;<span class="op" id="1664187">&gt;=</span>&nbsp;<span class="builtinfunc" id="1664190">len</span><span class="op" id="1664193">(</span><span class="ident" id="1664194">s</span><span class="op" id="1664195">)</span>&nbsp;<span class="op" id="1664197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1664202">return</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1664211">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1664215">esign</span>&nbsp;<span class="op" id="1664221">:=</span>&nbsp;<span class="num" id="1664224">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1664228">if</span>&nbsp;<span class="ident" id="1664231">s</span><span class="op" id="1664232">[</span><span class="ident" id="1664233">i</span><span class="op" id="1664234">]</span>&nbsp;<span class="op" id="1664236">==</span>&nbsp;<span class="string" id="1664239">&#39;+&#39;</span>&nbsp;<span class="op" id="1664243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1664248">i</span><span class="op" id="1664249">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1664254">}</span>&nbsp;<span class="keyword" id="1664256">else</span>&nbsp;<span class="keyword" id="1664261">if</span>&nbsp;<span class="ident" id="1664264">s</span><span class="op" id="1664265">[</span><span class="ident" id="1664266">i</span><span class="op" id="1664267">]</span>&nbsp;<span class="op" id="1664269">==</span>&nbsp;<span class="string" id="1664272">&#39;-&#39;</span>&nbsp;<span class="op" id="1664276">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1664281">i</span><span class="op" id="1664282">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1664288">esign</span>&nbsp;<span class="op" id="1664294">=</span>&nbsp;<span class="op" id="1664296">-</span><span class="num" id="1664297">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1664301">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1664305">if</span>&nbsp;<span class="ident" id="1664308">i</span>&nbsp;<span class="op" id="1664310">&gt;=</span>&nbsp;<span class="builtinfunc" id="1664313">len</span><span class="op" id="1664316">(</span><span class="ident" id="1664317">s</span><span class="op" id="1664318">)</span>&nbsp;<span class="op" id="1664320">||</span>&nbsp;<span class="ident" id="1664323">s</span><span class="op" id="1664324">[</span><span class="ident" id="1664325">i</span><span class="op" id="1664326">]</span>&nbsp;<span class="op" id="1664328">&lt;</span>&nbsp;<span class="string" id="1664330">&#39;0&#39;</span>&nbsp;<span class="op" id="1664334">||</span>&nbsp;<span class="ident" id="1664337">s</span><span class="op" id="1664338">[</span><span class="ident" id="1664339">i</span><span class="op" id="1664340">]</span>&nbsp;<span class="op" id="1664342">&gt;</span>&nbsp;<span class="string" id="1664344">&#39;9&#39;</span>&nbsp;<span class="op" id="1664348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1664353">return</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1664362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1664366">e</span>&nbsp;<span class="op" id="1664368">:=</span>&nbsp;<span class="num" id="1664371">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1664375">for</span>&nbsp;<span class="op" id="1664379">;</span>&nbsp;<span class="ident" id="1664381">i</span>&nbsp;<span class="op" id="1664383">&lt;</span>&nbsp;<span class="builtinfunc" id="1664385">len</span><span class="op" id="1664388">(</span><span class="ident" id="1664389">s</span><span class="op" id="1664390">)</span>&nbsp;<span class="op" id="1664392">&amp;&amp;</span>&nbsp;<span class="string" id="1664395">&#39;0&#39;</span>&nbsp;<span class="op" id="1664399">&lt;=</span>&nbsp;<span class="ident" id="1664402">s</span><span class="op" id="1664403">[</span><span class="ident" id="1664404">i</span><span class="op" id="1664405">]</span>&nbsp;<span class="op" id="1664407">&amp;&amp;</span>&nbsp;<span class="ident" id="1664410">s</span><span class="op" id="1664411">[</span><span class="ident" id="1664412">i</span><span class="op" id="1664413">]</span>&nbsp;<span class="op" id="1664415">&lt;=</span>&nbsp;<span class="string" id="1664418">&#39;9&#39;</span><span class="op" id="1664421">;</span>&nbsp;<span class="ident" id="1664423">i</span><span class="op" id="1664424">++</span>&nbsp;<span class="op" id="1664427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1664432">if</span>&nbsp;<span class="ident" id="1664435">e</span>&nbsp;<span class="op" id="1664437">&lt;</span>&nbsp;<span class="num" id="1664439">10000</span>&nbsp;<span class="op" id="1664445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1664451">e</span>&nbsp;<span class="op" id="1664453">=</span>&nbsp;<span class="ident" id="1664455">e</span><span class="op" id="1664456">*</span><span class="num" id="1664457">10</span>&nbsp;<span class="op" id="1664460">+</span>&nbsp;<span class="builtintype" id="1664462">int</span><span class="op" id="1664465">(</span><span class="ident" id="1664466">s</span><span class="op" id="1664467">[</span><span class="ident" id="1664468">i</span><span class="op" id="1664469">]</span><span class="op" id="1664470">)</span>&nbsp;<span class="op" id="1664472">-</span>&nbsp;<span class="string" id="1664474">&#39;0&#39;</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1664481">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1664485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1664489">dp</span>&nbsp;<span class="op" id="1664492">+=</span>&nbsp;<span class="ident" id="1664495">e</span>&nbsp;<span class="op" id="1664497">*</span>&nbsp;<span class="ident" id="1664499">esign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1664506">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1664510">if</span>&nbsp;<span class="ident" id="1664513">i</span>&nbsp;<span class="op" id="1664515">!=</span>&nbsp;<span class="builtinfunc" id="1664518">len</span><span class="op" id="1664521">(</span><span class="ident" id="1664522">s</span><span class="op" id="1664523">)</span>&nbsp;<span class="op" id="1664525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1664529">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1664537">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1664541">exp</span>&nbsp;<span class="op" id="1664545">=</span>&nbsp;<span class="ident" id="1664547">dp</span>&nbsp;<span class="op" id="1664550">-</span>&nbsp;<span class="ident" id="1664552">ndMant</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1664560">ok</span>&nbsp;<span class="op" id="1664563">=</span>&nbsp;<span class="builtintype" id="1664565">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1664571">return</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="op" id="1664579">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="comment" id="1664582">//&nbsp;decimal&nbsp;power&nbsp;of&nbsp;ten&nbsp;to&nbsp;binary&nbsp;power&nbsp;of&nbsp;two.</span><br>
<span class="lineno"></span><span class="keyword" id="1664630">var</span>&nbsp;<span class="ident" id="1664634">powtab</span>&nbsp;<span class="op" id="1664641">=</span>&nbsp;<span class="op" id="1664643">[</span><span class="op" id="1664644">]</span><span class="builtintype" id="1664645">int</span><span class="op" id="1664648">{</span><span class="num" id="1664649">1</span><span class="op" id="1664650">,</span>&nbsp;<span class="num" id="1664652">3</span><span class="op" id="1664653">,</span>&nbsp;<span class="num" id="1664655">6</span><span class="op" id="1664656">,</span>&nbsp;<span class="num" id="1664658">9</span><span class="op" id="1664659">,</span>&nbsp;<span class="num" id="1664661">13</span><span class="op" id="1664663">,</span>&nbsp;<span class="num" id="1664665">16</span><span class="op" id="1664667">,</span>&nbsp;<span class="num" id="1664669">19</span><span class="op" id="1664671">,</span>&nbsp;<span class="num" id="1664673">23</span><span class="op" id="1664675">,</span>&nbsp;<span class="num" id="1664677">26</span><span class="op" id="1664679">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1664682">func</span>&nbsp;<span class="op" id="1664687">(</span><span class="ident" id="1664688">d</span>&nbsp;<span class="op" id="1664690">*</span><span class="ident" id="1664691">decimal</span><span class="op" id="1664698">)</span>&nbsp;<span class="ident" id="1664700">floatBits</span><span class="op" id="1664709">(</span><span class="ident" id="1664710">flt</span>&nbsp;<span class="op" id="1664714">*</span><span class="ident" id="1664715">floatInfo</span><span class="op" id="1664724">)</span>&nbsp;<span class="op" id="1664726">(</span><span class="ident" id="1664727">b</span>&nbsp;<span class="ident" id="1664729">uint64</span><span class="op" id="1664735">,</span>&nbsp;<span class="ident" id="1664737">overflow</span>&nbsp;<span class="builtintype" id="1664746">bool</span><span class="op" id="1664750">)</span>&nbsp;<span class="op" id="1664752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1664755">var</span>&nbsp;<span class="ident" id="1664759">exp</span>&nbsp;<span class="builtintype" id="1664763">int</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1664768">var</span>&nbsp;<span class="ident" id="1664772">mant</span>&nbsp;<span class="ident" id="1664777">uint64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1664786">//&nbsp;Zero&nbsp;is&nbsp;always&nbsp;a&nbsp;special&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1664821">if</span>&nbsp;<span class="ident" id="1664824">d</span><span class="op" id="1664825">.</span><span class="ident" id="1664826">nd</span>&nbsp;<span class="op" id="1664829">==</span>&nbsp;<span class="num" id="1664832">0</span>&nbsp;<span class="op" id="1664834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1664838">mant</span>&nbsp;<span class="op" id="1664843">=</span>&nbsp;<span class="num" id="1664845">0</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1664849">exp</span>&nbsp;<span class="op" id="1664853">=</span>&nbsp;<span class="ident" id="1664855">flt</span><span class="op" id="1664858">.</span><span class="ident" id="1664859">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1664866">goto</span>&nbsp;<span class="ident" id="1664871">out</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1664876">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1664880">//&nbsp;Obvious&nbsp;overflow/underflow.</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1664912">//&nbsp;These&nbsp;bounds&nbsp;are&nbsp;for&nbsp;64-bit&nbsp;floats.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1664952">//&nbsp;Will&nbsp;have&nbsp;to&nbsp;change&nbsp;if&nbsp;we&nbsp;want&nbsp;to&nbsp;support&nbsp;80-bit&nbsp;floats&nbsp;in&nbsp;the&nbsp;future.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1665027">if</span>&nbsp;<span class="ident" id="1665030">d</span><span class="op" id="1665031">.</span><span class="ident" id="1665032">dp</span>&nbsp;<span class="op" id="1665035">&gt;</span>&nbsp;<span class="num" id="1665037">310</span>&nbsp;<span class="op" id="1665041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1665045">goto</span>&nbsp;<span class="ident" id="1665050">overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1665060">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1665063">if</span>&nbsp;<span class="ident" id="1665066">d</span><span class="op" id="1665067">.</span><span class="ident" id="1665068">dp</span>&nbsp;<span class="op" id="1665071">&lt;</span>&nbsp;<span class="op" id="1665073">-</span><span class="num" id="1665074">330</span>&nbsp;<span class="op" id="1665078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1665082">//&nbsp;zero</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1665092">mant</span>&nbsp;<span class="op" id="1665097">=</span>&nbsp;<span class="num" id="1665099">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1665103">exp</span>&nbsp;<span class="op" id="1665107">=</span>&nbsp;<span class="ident" id="1665109">flt</span><span class="op" id="1665112">.</span><span class="ident" id="1665113">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1665120">goto</span>&nbsp;<span class="ident" id="1665125">out</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1665130">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1665134">//&nbsp;Scale&nbsp;by&nbsp;powers&nbsp;of&nbsp;two&nbsp;until&nbsp;in&nbsp;range&nbsp;[0.5,&nbsp;1.0)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1665187">exp</span>&nbsp;<span class="op" id="1665191">=</span>&nbsp;<span class="num" id="1665193">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1665196">for</span>&nbsp;<span class="ident" id="1665200">d</span><span class="op" id="1665201">.</span><span class="ident" id="1665202">dp</span>&nbsp;<span class="op" id="1665205">&gt;</span>&nbsp;<span class="num" id="1665207">0</span>&nbsp;<span class="op" id="1665209">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1665213">var</span>&nbsp;<span class="ident" id="1665217">n</span>&nbsp;<span class="builtintype" id="1665219">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1665225">if</span>&nbsp;<span class="ident" id="1665228">d</span><span class="op" id="1665229">.</span><span class="ident" id="1665230">dp</span>&nbsp;<span class="op" id="1665233">&gt;=</span>&nbsp;<span class="builtinfunc" id="1665236">len</span><span class="op" id="1665239">(</span><span class="ident" id="1665240">powtab</span><span class="op" id="1665246">)</span>&nbsp;<span class="op" id="1665248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1665253">n</span>&nbsp;<span class="op" id="1665255">=</span>&nbsp;<span class="num" id="1665257">27</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1665262">}</span>&nbsp;<span class="keyword" id="1665264">else</span>&nbsp;<span class="op" id="1665269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1665274">n</span>&nbsp;<span class="op" id="1665276">=</span>&nbsp;<span class="ident" id="1665278">powtab</span><span class="op" id="1665284">[</span><span class="ident" id="1665285">d</span><span class="op" id="1665286">.</span><span class="ident" id="1665287">dp</span><span class="op" id="1665289">]</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1665293">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1665297">d</span><span class="op" id="1665298">.</span><span class="ident" id="1665299">Shift</span><span class="op" id="1665304">(</span><span class="op" id="1665305">-</span><span class="ident" id="1665306">n</span><span class="op" id="1665307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1665311">exp</span>&nbsp;<span class="op" id="1665315">+=</span>&nbsp;<span class="ident" id="1665318">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1665321">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1665324">for</span>&nbsp;<span class="ident" id="1665328">d</span><span class="op" id="1665329">.</span><span class="ident" id="1665330">dp</span>&nbsp;<span class="op" id="1665333">&lt;</span>&nbsp;<span class="num" id="1665335">0</span>&nbsp;<span class="op" id="1665337">||</span>&nbsp;<span class="ident" id="1665340">d</span><span class="op" id="1665341">.</span><span class="ident" id="1665342">dp</span>&nbsp;<span class="op" id="1665345">==</span>&nbsp;<span class="num" id="1665348">0</span>&nbsp;<span class="op" id="1665350">&amp;&amp;</span>&nbsp;<span class="ident" id="1665353">d</span><span class="op" id="1665354">.</span><span class="ident" id="1665355">d</span><span class="op" id="1665356">[</span><span class="num" id="1665357">0</span><span class="op" id="1665358">]</span>&nbsp;<span class="op" id="1665360">&lt;</span>&nbsp;<span class="string" id="1665362">&#39;5&#39;</span>&nbsp;<span class="op" id="1665366">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1665370">var</span>&nbsp;<span class="ident" id="1665374">n</span>&nbsp;<span class="builtintype" id="1665376">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1665382">if</span>&nbsp;<span class="op" id="1665385">-</span><span class="ident" id="1665386">d</span><span class="op" id="1665387">.</span><span class="ident" id="1665388">dp</span>&nbsp;<span class="op" id="1665391">&gt;=</span>&nbsp;<span class="builtinfunc" id="1665394">len</span><span class="op" id="1665397">(</span><span class="ident" id="1665398">powtab</span><span class="op" id="1665404">)</span>&nbsp;<span class="op" id="1665406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1665411">n</span>&nbsp;<span class="op" id="1665413">=</span>&nbsp;<span class="num" id="1665415">27</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1665420">}</span>&nbsp;<span class="keyword" id="1665422">else</span>&nbsp;<span class="op" id="1665427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1665432">n</span>&nbsp;<span class="op" id="1665434">=</span>&nbsp;<span class="ident" id="1665436">powtab</span><span class="op" id="1665442">[</span><span class="op" id="1665443">-</span><span class="ident" id="1665444">d</span><span class="op" id="1665445">.</span><span class="ident" id="1665446">dp</span><span class="op" id="1665448">]</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1665452">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1665456">d</span><span class="op" id="1665457">.</span><span class="ident" id="1665458">Shift</span><span class="op" id="1665463">(</span><span class="ident" id="1665464">n</span><span class="op" id="1665465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1665469">exp</span>&nbsp;<span class="op" id="1665473">-=</span>&nbsp;<span class="ident" id="1665476">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1665479">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1665483">//&nbsp;Our&nbsp;range&nbsp;is&nbsp;[0.5,1)&nbsp;but&nbsp;floating&nbsp;point&nbsp;range&nbsp;is&nbsp;[1,2).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1665543">exp</span><span class="op" id="1665546">--</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1665551">//&nbsp;Minimum&nbsp;representable&nbsp;exponent&nbsp;is&nbsp;flt.bias+1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1665601">//&nbsp;If&nbsp;the&nbsp;exponent&nbsp;is&nbsp;smaller,&nbsp;move&nbsp;it&nbsp;up&nbsp;and</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1665648">//&nbsp;adjust&nbsp;d&nbsp;accordingly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1665674">if</span>&nbsp;<span class="ident" id="1665677">exp</span>&nbsp;<span class="op" id="1665681">&lt;</span>&nbsp;<span class="ident" id="1665683">flt</span><span class="op" id="1665686">.</span><span class="ident" id="1665687">bias</span><span class="op" id="1665691">+</span><span class="num" id="1665692">1</span>&nbsp;<span class="op" id="1665694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1665698">n</span>&nbsp;<span class="op" id="1665700">:=</span>&nbsp;<span class="ident" id="1665703">flt</span><span class="op" id="1665706">.</span><span class="ident" id="1665707">bias</span>&nbsp;<span class="op" id="1665712">+</span>&nbsp;<span class="num" id="1665714">1</span>&nbsp;<span class="op" id="1665716">-</span>&nbsp;<span class="ident" id="1665718">exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1665724">d</span><span class="op" id="1665725">.</span><span class="ident" id="1665726">Shift</span><span class="op" id="1665731">(</span><span class="op" id="1665732">-</span><span class="ident" id="1665733">n</span><span class="op" id="1665734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1665738">exp</span>&nbsp;<span class="op" id="1665742">+=</span>&nbsp;<span class="ident" id="1665745">n</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1665748">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1665752">if</span>&nbsp;<span class="ident" id="1665755">exp</span><span class="op" id="1665758">-</span><span class="ident" id="1665759">flt</span><span class="op" id="1665762">.</span><span class="ident" id="1665763">bias</span>&nbsp;<span class="op" id="1665768">&gt;=</span>&nbsp;<span class="num" id="1665771">1</span><span class="op" id="1665772">&lt;&lt;</span><span class="ident" id="1665774">flt</span><span class="op" id="1665777">.</span><span class="ident" id="1665778">expbits</span><span class="op" id="1665785">-</span><span class="num" id="1665786">1</span>&nbsp;<span class="op" id="1665788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1665792">goto</span>&nbsp;<span class="ident" id="1665797">overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1665807">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1665811">//&nbsp;Extract&nbsp;1+flt.mantbits&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1665844">d</span><span class="op" id="1665845">.</span><span class="ident" id="1665846">Shift</span><span class="op" id="1665851">(</span><span class="builtintype" id="1665852">int</span><span class="op" id="1665855">(</span><span class="num" id="1665856">1</span>&nbsp;<span class="op" id="1665858">+</span>&nbsp;<span class="ident" id="1665860">flt</span><span class="op" id="1665863">.</span><span class="ident" id="1665864">mantbits</span><span class="op" id="1665872">)</span><span class="op" id="1665873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1665876">mant</span>&nbsp;<span class="op" id="1665881">=</span>&nbsp;<span class="ident" id="1665883">d</span><span class="op" id="1665884">.</span><span class="ident" id="1665885">RoundedInteger</span><span class="op" id="1665899">(</span><span class="op" id="1665900">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1665904">//&nbsp;Rounding&nbsp;might&nbsp;have&nbsp;added&nbsp;a&nbsp;bit;&nbsp;shift&nbsp;down.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1665953">if</span>&nbsp;<span class="ident" id="1665956">mant</span>&nbsp;<span class="op" id="1665961">==</span>&nbsp;<span class="num" id="1665964">2</span><span class="op" id="1665965">&lt;&lt;</span><span class="ident" id="1665967">flt</span><span class="op" id="1665970">.</span><span class="ident" id="1665971">mantbits</span>&nbsp;<span class="op" id="1665980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1665984">mant</span>&nbsp;<span class="op" id="1665989">&gt;&gt;=</span>&nbsp;<span class="num" id="1665993">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1665997">exp</span><span class="op" id="1666000">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1666005">if</span>&nbsp;<span class="ident" id="1666008">exp</span><span class="op" id="1666011">-</span><span class="ident" id="1666012">flt</span><span class="op" id="1666015">.</span><span class="ident" id="1666016">bias</span>&nbsp;<span class="op" id="1666021">&gt;=</span>&nbsp;<span class="num" id="1666024">1</span><span class="op" id="1666025">&lt;&lt;</span><span class="ident" id="1666027">flt</span><span class="op" id="1666030">.</span><span class="ident" id="1666031">expbits</span><span class="op" id="1666038">-</span><span class="num" id="1666039">1</span>&nbsp;<span class="op" id="1666041">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1666046">goto</span>&nbsp;<span class="ident" id="1666051">overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1666062">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1666065">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1666069">//&nbsp;Denormalized?</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1666087">if</span>&nbsp;<span class="ident" id="1666090">mant</span><span class="op" id="1666094">&amp;</span><span class="op" id="1666095">(</span><span class="num" id="1666096">1</span><span class="op" id="1666097">&lt;&lt;</span><span class="ident" id="1666099">flt</span><span class="op" id="1666102">.</span><span class="ident" id="1666103">mantbits</span><span class="op" id="1666111">)</span>&nbsp;<span class="op" id="1666113">==</span>&nbsp;<span class="num" id="1666116">0</span>&nbsp;<span class="op" id="1666118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1666122">exp</span>&nbsp;<span class="op" id="1666126">=</span>&nbsp;<span class="ident" id="1666128">flt</span><span class="op" id="1666131">.</span><span class="ident" id="1666132">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1666138">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1666141">goto</span>&nbsp;<span class="ident" id="1666146">out</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span><span class="ident" id="1666151">overflow</span><span class="op" id="1666159">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1666162">//&nbsp;Inf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1666172">mant</span>&nbsp;<span class="op" id="1666177">=</span>&nbsp;<span class="num" id="1666179">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1666182">exp</span>&nbsp;<span class="op" id="1666186">=</span>&nbsp;<span class="num" id="1666188">1</span><span class="op" id="1666189">&lt;&lt;</span><span class="ident" id="1666191">flt</span><span class="op" id="1666194">.</span><span class="ident" id="1666195">expbits</span>&nbsp;<span class="op" id="1666203">-</span>&nbsp;<span class="num" id="1666205">1</span>&nbsp;<span class="op" id="1666207">+</span>&nbsp;<span class="ident" id="1666209">flt</span><span class="op" id="1666212">.</span><span class="ident" id="1666213">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1666219">overflow</span>&nbsp;<span class="op" id="1666228">=</span>&nbsp;<span class="builtintype" id="1666230">true</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span><span class="ident" id="1666236">out</span><span class="op" id="1666239">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1666242">//&nbsp;Assemble&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1666261">bits</span>&nbsp;<span class="op" id="1666266">:=</span>&nbsp;<span class="ident" id="1666269">mant</span>&nbsp;<span class="op" id="1666274">&amp;</span>&nbsp;<span class="op" id="1666276">(</span><span class="ident" id="1666277">uint64</span><span class="op" id="1666283">(</span><span class="num" id="1666284">1</span><span class="op" id="1666285">)</span><span class="op" id="1666286">&lt;&lt;</span><span class="ident" id="1666288">flt</span><span class="op" id="1666291">.</span><span class="ident" id="1666292">mantbits</span>&nbsp;<span class="op" id="1666301">-</span>&nbsp;<span class="num" id="1666303">1</span><span class="op" id="1666304">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1666307">bits</span>&nbsp;<span class="op" id="1666312">|=</span>&nbsp;<span class="ident" id="1666315">uint64</span><span class="op" id="1666321">(</span><span class="op" id="1666322">(</span><span class="ident" id="1666323">exp</span><span class="op" id="1666326">-</span><span class="ident" id="1666327">flt</span><span class="op" id="1666330">.</span><span class="ident" id="1666331">bias</span><span class="op" id="1666335">)</span><span class="op" id="1666336">&amp;</span><span class="op" id="1666337">(</span><span class="num" id="1666338">1</span><span class="op" id="1666339">&lt;&lt;</span><span class="ident" id="1666341">flt</span><span class="op" id="1666344">.</span><span class="ident" id="1666345">expbits</span><span class="op" id="1666352">-</span><span class="num" id="1666353">1</span><span class="op" id="1666354">)</span><span class="op" id="1666355">)</span>&nbsp;<span class="op" id="1666357">&lt;&lt;</span>&nbsp;<span class="ident" id="1666360">flt</span><span class="op" id="1666363">.</span><span class="ident" id="1666364">mantbits</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1666374">if</span>&nbsp;<span class="ident" id="1666377">d</span><span class="op" id="1666378">.</span><span class="ident" id="1666379">neg</span>&nbsp;<span class="op" id="1666383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1666387">bits</span>&nbsp;<span class="op" id="1666392">|=</span>&nbsp;<span class="num" id="1666395">1</span>&nbsp;<span class="op" id="1666397">&lt;&lt;</span>&nbsp;<span class="ident" id="1666400">flt</span><span class="op" id="1666403">.</span><span class="ident" id="1666404">mantbits</span>&nbsp;<span class="op" id="1666413">&lt;&lt;</span>&nbsp;<span class="ident" id="1666416">flt</span><span class="op" id="1666419">.</span><span class="ident" id="1666420">expbits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1666429">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1666432">return</span>&nbsp;<span class="ident" id="1666439">bits</span><span class="op" id="1666443">,</span>&nbsp;<span class="ident" id="1666445">overflow</span><br>
<span class="lineno"></span><span class="op" id="1666454">}</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span><span class="comment" id="1666457">//&nbsp;Exact&nbsp;powers&nbsp;of&nbsp;10.</span><br>
<span class="lineno"></span><span class="keyword" id="1666480">var</span>&nbsp;<span class="ident" id="1666484">float64pow10</span>&nbsp;<span class="op" id="1666497">=</span>&nbsp;<span class="op" id="1666499">[</span><span class="op" id="1666500">]</span><span class="builtintype" id="1666501">float64</span><span class="op" id="1666508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1666511">1e0</span><span class="op" id="1666514">,</span>&nbsp;<span class="num" id="1666516">1e1</span><span class="op" id="1666519">,</span>&nbsp;<span class="num" id="1666521">1e2</span><span class="op" id="1666524">,</span>&nbsp;<span class="num" id="1666526">1e3</span><span class="op" id="1666529">,</span>&nbsp;<span class="num" id="1666531">1e4</span><span class="op" id="1666534">,</span>&nbsp;<span class="num" id="1666536">1e5</span><span class="op" id="1666539">,</span>&nbsp;<span class="num" id="1666541">1e6</span><span class="op" id="1666544">,</span>&nbsp;<span class="num" id="1666546">1e7</span><span class="op" id="1666549">,</span>&nbsp;<span class="num" id="1666551">1e8</span><span class="op" id="1666554">,</span>&nbsp;<span class="num" id="1666556">1e9</span><span class="op" id="1666559">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1666562">1e10</span><span class="op" id="1666566">,</span>&nbsp;<span class="num" id="1666568">1e11</span><span class="op" id="1666572">,</span>&nbsp;<span class="num" id="1666574">1e12</span><span class="op" id="1666578">,</span>&nbsp;<span class="num" id="1666580">1e13</span><span class="op" id="1666584">,</span>&nbsp;<span class="num" id="1666586">1e14</span><span class="op" id="1666590">,</span>&nbsp;<span class="num" id="1666592">1e15</span><span class="op" id="1666596">,</span>&nbsp;<span class="num" id="1666598">1e16</span><span class="op" id="1666602">,</span>&nbsp;<span class="num" id="1666604">1e17</span><span class="op" id="1666608">,</span>&nbsp;<span class="num" id="1666610">1e18</span><span class="op" id="1666614">,</span>&nbsp;<span class="num" id="1666616">1e19</span><span class="op" id="1666620">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1666623">1e20</span><span class="op" id="1666627">,</span>&nbsp;<span class="num" id="1666629">1e21</span><span class="op" id="1666633">,</span>&nbsp;<span class="num" id="1666635">1e22</span><span class="op" id="1666639">,</span><br>
<span class="lineno"></span><span class="op" id="1666641">}</span><br>
<span class="lineno"></span><span class="keyword" id="1666643">var</span>&nbsp;<span class="ident" id="1666647">float32pow10</span>&nbsp;<span class="op" id="1666660">=</span>&nbsp;<span class="op" id="1666662">[</span><span class="op" id="1666663">]</span><span class="builtintype" id="1666664">float32</span><span class="op" id="1666671">{</span><span class="num" id="1666672">1e0</span><span class="op" id="1666675">,</span>&nbsp;<span class="num" id="1666677">1e1</span><span class="op" id="1666680">,</span>&nbsp;<span class="num" id="1666682">1e2</span><span class="op" id="1666685">,</span>&nbsp;<span class="num" id="1666687">1e3</span><span class="op" id="1666690">,</span>&nbsp;<span class="num" id="1666692">1e4</span><span class="op" id="1666695">,</span>&nbsp;<span class="num" id="1666697">1e5</span><span class="op" id="1666700">,</span>&nbsp;<span class="num" id="1666702">1e6</span><span class="op" id="1666705">,</span>&nbsp;<span class="num" id="1666707">1e7</span><span class="op" id="1666710">,</span>&nbsp;<span class="num" id="1666712">1e8</span><span class="op" id="1666715">,</span>&nbsp;<span class="num" id="1666717">1e9</span><span class="op" id="1666720">,</span>&nbsp;<span class="num" id="1666722">1e10</span><span class="op" id="1666726">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1666729">//&nbsp;If&nbsp;possible&nbsp;to&nbsp;convert&nbsp;decimal&nbsp;representation&nbsp;to&nbsp;64-bit&nbsp;float&nbsp;f&nbsp;exactly,</span><br>
<span class="lineno">365</span><span class="comment" id="1666805">//&nbsp;entirely&nbsp;in&nbsp;floating-point&nbsp;math,&nbsp;do&nbsp;so,&nbsp;avoiding&nbsp;the&nbsp;expense&nbsp;of&nbsp;decimalToFloatBits.</span><br>
<span class="lineno"></span><span class="comment" id="1666892">//&nbsp;Three&nbsp;common&nbsp;cases:</span><br>
<span class="lineno"></span><span class="comment" id="1666915">//&nbsp;&nbsp;&nbsp;&nbspvalue&nbsp;is&nbsp;exact&nbsp;integer</span><br>
<span class="lineno"></span><span class="comment" id="1666941">//&nbsp;&nbsp;&nbsp;&nbspvalue&nbsp;is&nbsp;exact&nbsp;integer&nbsp;*&nbsp;exact&nbsp;power&nbsp;of&nbsp;ten</span><br>
<span class="lineno"></span><span class="comment" id="1666988">//&nbsp;&nbsp;&nbsp;&nbspvalue&nbsp;is&nbsp;exact&nbsp;integer&nbsp;/&nbsp;exact&nbsp;power&nbsp;of&nbsp;ten</span><br>
<span class="lineno">370</span><span class="comment" id="1667035">//&nbsp;These&nbsp;all&nbsp;produce&nbsp;potentially&nbsp;inexact&nbsp;but&nbsp;correctly&nbsp;rounded&nbsp;answers.</span><br>
<span class="lineno"></span><span class="keyword" id="1667107">func</span>&nbsp;<span class="ident" id="1667112">atof64exact</span><span class="op" id="1667123">(</span><span class="ident" id="1667124">mantissa</span>&nbsp;<span class="ident" id="1667133">uint64</span><span class="op" id="1667139">,</span>&nbsp;<span class="ident" id="1667141">exp</span>&nbsp;<span class="builtintype" id="1667145">int</span><span class="op" id="1667148">,</span>&nbsp;<span class="ident" id="1667150">neg</span>&nbsp;<span class="builtintype" id="1667154">bool</span><span class="op" id="1667158">)</span>&nbsp;<span class="op" id="1667160">(</span><span class="ident" id="1667161">f</span>&nbsp;<span class="builtintype" id="1667163">float64</span><span class="op" id="1667170">,</span>&nbsp;<span class="ident" id="1667172">ok</span>&nbsp;<span class="builtintype" id="1667175">bool</span><span class="op" id="1667179">)</span>&nbsp;<span class="op" id="1667181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1667184">if</span>&nbsp;<span class="ident" id="1667187">mantissa</span><span class="op" id="1667195">&gt;&gt;</span><span class="ident" id="1667197">float64info</span><span class="op" id="1667208">.</span><span class="ident" id="1667209">mantbits</span>&nbsp;<span class="op" id="1667218">!=</span>&nbsp;<span class="num" id="1667221">0</span>&nbsp;<span class="op" id="1667223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1667227">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1667235">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1667238">f</span>&nbsp;<span class="op" id="1667240">=</span>&nbsp;<span class="builtintype" id="1667242">float64</span><span class="op" id="1667249">(</span><span class="ident" id="1667250">mantissa</span><span class="op" id="1667258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1667261">if</span>&nbsp;<span class="ident" id="1667264">neg</span>&nbsp;<span class="op" id="1667268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1667272">f</span>&nbsp;<span class="op" id="1667274">=</span>&nbsp;<span class="op" id="1667276">-</span><span class="ident" id="1667277">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1667280">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1667283">switch</span>&nbsp;<span class="op" id="1667290">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1667293">case</span>&nbsp;<span class="ident" id="1667298">exp</span>&nbsp;<span class="op" id="1667302">==</span>&nbsp;<span class="num" id="1667305">0</span><span class="op" id="1667306">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1667310">//&nbsp;an&nbsp;integer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1667327">return</span>&nbsp;<span class="ident" id="1667334">f</span><span class="op" id="1667335">,</span>&nbsp;<span class="builtintype" id="1667337">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1667343">//&nbsp;Exact&nbsp;integers&nbsp;are&nbsp;&lt;=&nbsp;10^15.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1667376">//&nbsp;Exact&nbsp;powers&nbsp;of&nbsp;ten&nbsp;are&nbsp;&lt;=&nbsp;10^22.</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1667414">case</span>&nbsp;<span class="ident" id="1667419">exp</span>&nbsp;<span class="op" id="1667423">&gt;</span>&nbsp;<span class="num" id="1667425">0</span>&nbsp;<span class="op" id="1667427">&amp;&amp;</span>&nbsp;<span class="ident" id="1667430">exp</span>&nbsp;<span class="op" id="1667434">&lt;=</span>&nbsp;<span class="num" id="1667437">15</span><span class="op" id="1667439">+</span><span class="num" id="1667440">22</span><span class="op" id="1667442">:</span>&nbsp;<span class="comment" id="1667444">//&nbsp;int&nbsp;*&nbsp;10^k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1667460">//&nbsp;If&nbsp;exponent&nbsp;is&nbsp;big&nbsp;but&nbsp;number&nbsp;of&nbsp;digits&nbsp;is&nbsp;not,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1667513">//&nbsp;can&nbsp;move&nbsp;a&nbsp;few&nbsp;zeros&nbsp;into&nbsp;the&nbsp;integer&nbsp;part.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1667562">if</span>&nbsp;<span class="ident" id="1667565">exp</span>&nbsp;<span class="op" id="1667569">&gt;</span>&nbsp;<span class="num" id="1667571">22</span>&nbsp;<span class="op" id="1667574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1667579">f</span>&nbsp;<span class="op" id="1667581">*=</span>&nbsp;<span class="ident" id="1667584">float64pow10</span><span class="op" id="1667596">[</span><span class="ident" id="1667597">exp</span><span class="op" id="1667600">-</span><span class="num" id="1667601">22</span><span class="op" id="1667603">]</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1667608">exp</span>&nbsp;<span class="op" id="1667612">=</span>&nbsp;<span class="num" id="1667614">22</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1667619">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1667623">if</span>&nbsp;<span class="ident" id="1667626">f</span>&nbsp;<span class="op" id="1667628">&gt;</span>&nbsp;<span class="num" id="1667630">1e15</span>&nbsp;<span class="op" id="1667635">||</span>&nbsp;<span class="ident" id="1667638">f</span>&nbsp;<span class="op" id="1667640">&lt;</span>&nbsp;<span class="op" id="1667642">-</span><span class="num" id="1667643">1e15</span>&nbsp;<span class="op" id="1667648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1667653">//&nbsp;the&nbsp;exponent&nbsp;was&nbsp;really&nbsp;too&nbsp;large.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1667694">return</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1667703">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1667707">return</span>&nbsp;<span class="ident" id="1667714">f</span>&nbsp;<span class="op" id="1667716">*</span>&nbsp;<span class="ident" id="1667718">float64pow10</span><span class="op" id="1667730">[</span><span class="ident" id="1667731">exp</span><span class="op" id="1667734">]</span><span class="op" id="1667735">,</span>&nbsp;<span class="builtintype" id="1667737">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1667743">case</span>&nbsp;<span class="ident" id="1667748">exp</span>&nbsp;<span class="op" id="1667752">&lt;</span>&nbsp;<span class="num" id="1667754">0</span>&nbsp;<span class="op" id="1667756">&amp;&amp;</span>&nbsp;<span class="ident" id="1667759">exp</span>&nbsp;<span class="op" id="1667763">&gt;=</span>&nbsp;<span class="op" id="1667766">-</span><span class="num" id="1667767">22</span><span class="op" id="1667769">:</span>&nbsp;<span class="comment" id="1667771">//&nbsp;int&nbsp;/&nbsp;10^k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1667787">return</span>&nbsp;<span class="ident" id="1667794">f</span>&nbsp;<span class="op" id="1667796">/</span>&nbsp;<span class="ident" id="1667798">float64pow10</span><span class="op" id="1667810">[</span><span class="op" id="1667811">-</span><span class="ident" id="1667812">exp</span><span class="op" id="1667815">]</span><span class="op" id="1667816">,</span>&nbsp;<span class="builtintype" id="1667818">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1667824">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1667827">return</span><br>
<span class="lineno"></span><span class="op" id="1667834">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1667837">//&nbsp;If&nbsp;possible&nbsp;to&nbsp;compute&nbsp;mantissa*10^exp&nbsp;to&nbsp;32-bit&nbsp;float&nbsp;f&nbsp;exactly,</span><br>
<span class="lineno"></span><span class="comment" id="1667906">//&nbsp;entirely&nbsp;in&nbsp;floating-point&nbsp;math,&nbsp;do&nbsp;so,&nbsp;avoiding&nbsp;the&nbsp;machinery&nbsp;above.</span><br>
<span class="lineno">405</span><span class="keyword" id="1667979">func</span>&nbsp;<span class="ident" id="1667984">atof32exact</span><span class="op" id="1667995">(</span><span class="ident" id="1667996">mantissa</span>&nbsp;<span class="ident" id="1668005">uint64</span><span class="op" id="1668011">,</span>&nbsp;<span class="ident" id="1668013">exp</span>&nbsp;<span class="builtintype" id="1668017">int</span><span class="op" id="1668020">,</span>&nbsp;<span class="ident" id="1668022">neg</span>&nbsp;<span class="builtintype" id="1668026">bool</span><span class="op" id="1668030">)</span>&nbsp;<span class="op" id="1668032">(</span><span class="ident" id="1668033">f</span>&nbsp;<span class="builtintype" id="1668035">float32</span><span class="op" id="1668042">,</span>&nbsp;<span class="ident" id="1668044">ok</span>&nbsp;<span class="builtintype" id="1668047">bool</span><span class="op" id="1668051">)</span>&nbsp;<span class="op" id="1668053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1668056">if</span>&nbsp;<span class="ident" id="1668059">mantissa</span><span class="op" id="1668067">&gt;&gt;</span><span class="ident" id="1668069">float32info</span><span class="op" id="1668080">.</span><span class="ident" id="1668081">mantbits</span>&nbsp;<span class="op" id="1668090">!=</span>&nbsp;<span class="num" id="1668093">0</span>&nbsp;<span class="op" id="1668095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1668099">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1668107">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1668110">f</span>&nbsp;<span class="op" id="1668112">=</span>&nbsp;<span class="builtintype" id="1668114">float32</span><span class="op" id="1668121">(</span><span class="ident" id="1668122">mantissa</span><span class="op" id="1668130">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1668133">if</span>&nbsp;<span class="ident" id="1668136">neg</span>&nbsp;<span class="op" id="1668140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1668144">f</span>&nbsp;<span class="op" id="1668146">=</span>&nbsp;<span class="op" id="1668148">-</span><span class="ident" id="1668149">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1668152">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1668155">switch</span>&nbsp;<span class="op" id="1668162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1668165">case</span>&nbsp;<span class="ident" id="1668170">exp</span>&nbsp;<span class="op" id="1668174">==</span>&nbsp;<span class="num" id="1668177">0</span><span class="op" id="1668178">:</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1668182">return</span>&nbsp;<span class="ident" id="1668189">f</span><span class="op" id="1668190">,</span>&nbsp;<span class="builtintype" id="1668192">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1668198">//&nbsp;Exact&nbsp;integers&nbsp;are&nbsp;&lt;=&nbsp;10^7.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1668230">//&nbsp;Exact&nbsp;powers&nbsp;of&nbsp;ten&nbsp;are&nbsp;&lt;=&nbsp;10^10.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1668268">case</span>&nbsp;<span class="ident" id="1668273">exp</span>&nbsp;<span class="op" id="1668277">&gt;</span>&nbsp;<span class="num" id="1668279">0</span>&nbsp;<span class="op" id="1668281">&amp;&amp;</span>&nbsp;<span class="ident" id="1668284">exp</span>&nbsp;<span class="op" id="1668288">&lt;=</span>&nbsp;<span class="num" id="1668291">7</span><span class="op" id="1668292">+</span><span class="num" id="1668293">10</span><span class="op" id="1668295">:</span>&nbsp;<span class="comment" id="1668297">//&nbsp;int&nbsp;*&nbsp;10^k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1668313">//&nbsp;If&nbsp;exponent&nbsp;is&nbsp;big&nbsp;but&nbsp;number&nbsp;of&nbsp;digits&nbsp;is&nbsp;not,</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1668366">//&nbsp;can&nbsp;move&nbsp;a&nbsp;few&nbsp;zeros&nbsp;into&nbsp;the&nbsp;integer&nbsp;part.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1668415">if</span>&nbsp;<span class="ident" id="1668418">exp</span>&nbsp;<span class="op" id="1668422">&gt;</span>&nbsp;<span class="num" id="1668424">10</span>&nbsp;<span class="op" id="1668427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1668432">f</span>&nbsp;<span class="op" id="1668434">*=</span>&nbsp;<span class="ident" id="1668437">float32pow10</span><span class="op" id="1668449">[</span><span class="ident" id="1668450">exp</span><span class="op" id="1668453">-</span><span class="num" id="1668454">10</span><span class="op" id="1668456">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1668461">exp</span>&nbsp;<span class="op" id="1668465">=</span>&nbsp;<span class="num" id="1668467">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1668472">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1668476">if</span>&nbsp;<span class="ident" id="1668479">f</span>&nbsp;<span class="op" id="1668481">&gt;</span>&nbsp;<span class="num" id="1668483">1e7</span>&nbsp;<span class="op" id="1668487">||</span>&nbsp;<span class="ident" id="1668490">f</span>&nbsp;<span class="op" id="1668492">&lt;</span>&nbsp;<span class="op" id="1668494">-</span><span class="num" id="1668495">1e7</span>&nbsp;<span class="op" id="1668499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1668504">//&nbsp;the&nbsp;exponent&nbsp;was&nbsp;really&nbsp;too&nbsp;large.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1668545">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1668554">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1668558">return</span>&nbsp;<span class="ident" id="1668565">f</span>&nbsp;<span class="op" id="1668567">*</span>&nbsp;<span class="ident" id="1668569">float32pow10</span><span class="op" id="1668581">[</span><span class="ident" id="1668582">exp</span><span class="op" id="1668585">]</span><span class="op" id="1668586">,</span>&nbsp;<span class="builtintype" id="1668588">true</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1668594">case</span>&nbsp;<span class="ident" id="1668599">exp</span>&nbsp;<span class="op" id="1668603">&lt;</span>&nbsp;<span class="num" id="1668605">0</span>&nbsp;<span class="op" id="1668607">&amp;&amp;</span>&nbsp;<span class="ident" id="1668610">exp</span>&nbsp;<span class="op" id="1668614">&gt;=</span>&nbsp;<span class="op" id="1668617">-</span><span class="num" id="1668618">10</span><span class="op" id="1668620">:</span>&nbsp;<span class="comment" id="1668622">//&nbsp;int&nbsp;/&nbsp;10^k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1668638">return</span>&nbsp;<span class="ident" id="1668645">f</span>&nbsp;<span class="op" id="1668647">/</span>&nbsp;<span class="ident" id="1668649">float32pow10</span><span class="op" id="1668661">[</span><span class="op" id="1668662">-</span><span class="ident" id="1668663">exp</span><span class="op" id="1668666">]</span><span class="op" id="1668667">,</span>&nbsp;<span class="builtintype" id="1668669">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1668675">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1668678">return</span><br>
<span class="lineno"></span><span class="op" id="1668685">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="keyword" id="1668688">const</span>&nbsp;<span class="ident" id="1668694">fnParseFloat</span>&nbsp;<span class="op" id="1668707">=</span>&nbsp;<span class="string" id="1668709">&#34;ParseFloat&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1668723">func</span>&nbsp;<span class="ident" id="1668728">atof32</span><span class="op" id="1668734">(</span><span class="ident" id="1668735">s</span>&nbsp;<span class="builtintype" id="1668737">string</span><span class="op" id="1668743">)</span>&nbsp;<span class="op" id="1668745">(</span><span class="ident" id="1668746">f</span>&nbsp;<span class="builtintype" id="1668748">float32</span><span class="op" id="1668755">,</span>&nbsp;<span class="ident" id="1668757">err</span>&nbsp;<span class="builtintype" id="1668761">error</span><span class="op" id="1668766">)</span>&nbsp;<span class="op" id="1668768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1668771">if</span>&nbsp;<span class="ident" id="1668774">val</span><span class="op" id="1668777">,</span>&nbsp;<span class="ident" id="1668779">ok</span>&nbsp;<span class="op" id="1668782">:=</span>&nbsp;<span class="ident" id="1668785">special</span><span class="op" id="1668792">(</span><span class="ident" id="1668793">s</span><span class="op" id="1668794">)</span><span class="op" id="1668795">;</span>&nbsp;<span class="ident" id="1668797">ok</span>&nbsp;<span class="op" id="1668800">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1668804">return</span>&nbsp;<span class="builtintype" id="1668811">float32</span><span class="op" id="1668818">(</span><span class="ident" id="1668819">val</span><span class="op" id="1668822">)</span><span class="op" id="1668823">,</span>&nbsp;<span class="ident" id="1668825">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1668830">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1668834">if</span>&nbsp;<span class="ident" id="1668837">optimize</span>&nbsp;<span class="op" id="1668846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1668850">//&nbsp;Parse&nbsp;mantissa&nbsp;and&nbsp;exponent.</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1668884">mantissa</span><span class="op" id="1668892">,</span>&nbsp;<span class="ident" id="1668894">exp</span><span class="op" id="1668897">,</span>&nbsp;<span class="ident" id="1668899">neg</span><span class="op" id="1668902">,</span>&nbsp;<span class="ident" id="1668904">trunc</span><span class="op" id="1668909">,</span>&nbsp;<span class="ident" id="1668911">ok</span>&nbsp;<span class="op" id="1668914">:=</span>&nbsp;<span class="ident" id="1668917">readFloat</span><span class="op" id="1668926">(</span><span class="ident" id="1668927">s</span><span class="op" id="1668928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1668932">if</span>&nbsp;<span class="ident" id="1668935">ok</span>&nbsp;<span class="op" id="1668938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1668943">//&nbsp;Try&nbsp;pure&nbsp;floating-point&nbsp;arithmetic&nbsp;conversion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1668996">if</span>&nbsp;<span class="op" id="1668999">!</span><span class="ident" id="1669000">trunc</span>&nbsp;<span class="op" id="1669006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1669012">if</span>&nbsp;<span class="ident" id="1669015">f</span><span class="op" id="1669016">,</span>&nbsp;<span class="ident" id="1669018">ok</span>&nbsp;<span class="op" id="1669021">:=</span>&nbsp;<span class="ident" id="1669024">atof32exact</span><span class="op" id="1669035">(</span><span class="ident" id="1669036">mantissa</span><span class="op" id="1669044">,</span>&nbsp;<span class="ident" id="1669046">exp</span><span class="op" id="1669049">,</span>&nbsp;<span class="ident" id="1669051">neg</span><span class="op" id="1669054">)</span><span class="op" id="1669055">;</span>&nbsp;<span class="ident" id="1669057">ok</span>&nbsp;<span class="op" id="1669060">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1669067">return</span>&nbsp;<span class="ident" id="1669074">f</span><span class="op" id="1669075">,</span>&nbsp;<span class="ident" id="1669077">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1669085">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1669090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1669095">//&nbsp;Try&nbsp;another&nbsp;fast&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1669124">ext</span>&nbsp;<span class="op" id="1669128">:=</span>&nbsp;<span class="builtinfunc" id="1669131">new</span><span class="op" id="1669134">(</span><span class="ident" id="1669135">extFloat</span><span class="op" id="1669143">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1669148">if</span>&nbsp;<span class="ident" id="1669151">ok</span>&nbsp;<span class="op" id="1669154">:=</span>&nbsp;<span class="ident" id="1669157">ext</span><span class="op" id="1669160">.</span><span class="ident" id="1669161">AssignDecimal</span><span class="op" id="1669174">(</span><span class="ident" id="1669175">mantissa</span><span class="op" id="1669183">,</span>&nbsp;<span class="ident" id="1669185">exp</span><span class="op" id="1669188">,</span>&nbsp;<span class="ident" id="1669190">neg</span><span class="op" id="1669193">,</span>&nbsp;<span class="ident" id="1669195">trunc</span><span class="op" id="1669200">,</span>&nbsp;<span class="op" id="1669202">&amp;</span><span class="ident" id="1669203">float32info</span><span class="op" id="1669214">)</span><span class="op" id="1669215">;</span>&nbsp;<span class="ident" id="1669217">ok</span>&nbsp;<span class="op" id="1669220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1669226">b</span><span class="op" id="1669227">,</span>&nbsp;<span class="ident" id="1669229">ovf</span>&nbsp;<span class="op" id="1669233">:=</span>&nbsp;<span class="ident" id="1669236">ext</span><span class="op" id="1669239">.</span><span class="ident" id="1669240">floatBits</span><span class="op" id="1669249">(</span><span class="op" id="1669250">&amp;</span><span class="ident" id="1669251">float32info</span><span class="op" id="1669262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1669268">f</span>&nbsp;<span class="op" id="1669270">=</span>&nbsp;<span class="ident" id="1669272">math</span><span class="op" id="1669276">.</span><span class="ident" id="1669277">Float32frombits</span><span class="op" id="1669292">(</span><span class="builtintype" id="1669293">uint32</span><span class="op" id="1669299">(</span><span class="ident" id="1669300">b</span><span class="op" id="1669301">)</span><span class="op" id="1669302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1669308">if</span>&nbsp;<span class="ident" id="1669311">ovf</span>&nbsp;<span class="op" id="1669315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1669322">err</span>&nbsp;<span class="op" id="1669326">=</span>&nbsp;<span class="ident" id="1669328">rangeError</span><span class="op" id="1669338">(</span><span class="ident" id="1669339">fnParseFloat</span><span class="op" id="1669351">,</span>&nbsp;<span class="ident" id="1669353">s</span><span class="op" id="1669354">)</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1669360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1669366">return</span>&nbsp;<span class="ident" id="1669373">f</span><span class="op" id="1669374">,</span>&nbsp;<span class="ident" id="1669376">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1669383">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1669387">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1669390">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1669393">var</span>&nbsp;<span class="ident" id="1669397">d</span>&nbsp;<span class="ident" id="1669399">decimal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1669408">if</span>&nbsp;<span class="op" id="1669411">!</span><span class="ident" id="1669412">d</span><span class="op" id="1669413">.</span><span class="ident" id="1669414">set</span><span class="op" id="1669417">(</span><span class="ident" id="1669418">s</span><span class="op" id="1669419">)</span>&nbsp;<span class="op" id="1669421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1669425">return</span>&nbsp;<span class="num" id="1669432">0</span><span class="op" id="1669433">,</span>&nbsp;<span class="ident" id="1669435">syntaxError</span><span class="op" id="1669446">(</span><span class="ident" id="1669447">fnParseFloat</span><span class="op" id="1669459">,</span>&nbsp;<span class="ident" id="1669461">s</span><span class="op" id="1669462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1669465">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1669468">b</span><span class="op" id="1669469">,</span>&nbsp;<span class="ident" id="1669471">ovf</span>&nbsp;<span class="op" id="1669475">:=</span>&nbsp;<span class="ident" id="1669478">d</span><span class="op" id="1669479">.</span><span class="ident" id="1669480">floatBits</span><span class="op" id="1669489">(</span><span class="op" id="1669490">&amp;</span><span class="ident" id="1669491">float32info</span><span class="op" id="1669502">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1669505">f</span>&nbsp;<span class="op" id="1669507">=</span>&nbsp;<span class="ident" id="1669509">math</span><span class="op" id="1669513">.</span><span class="ident" id="1669514">Float32frombits</span><span class="op" id="1669529">(</span><span class="builtintype" id="1669530">uint32</span><span class="op" id="1669536">(</span><span class="ident" id="1669537">b</span><span class="op" id="1669538">)</span><span class="op" id="1669539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1669542">if</span>&nbsp;<span class="ident" id="1669545">ovf</span>&nbsp;<span class="op" id="1669549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1669553">err</span>&nbsp;<span class="op" id="1669557">=</span>&nbsp;<span class="ident" id="1669559">rangeError</span><span class="op" id="1669569">(</span><span class="ident" id="1669570">fnParseFloat</span><span class="op" id="1669582">,</span>&nbsp;<span class="ident" id="1669584">s</span><span class="op" id="1669585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1669588">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1669591">return</span>&nbsp;<span class="ident" id="1669598">f</span><span class="op" id="1669599">,</span>&nbsp;<span class="ident" id="1669601">err</span><br>
<span class="lineno">475</span><span class="op" id="1669605">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1669608">func</span>&nbsp;<span class="ident" id="1669613">atof64</span><span class="op" id="1669619">(</span><span class="ident" id="1669620">s</span>&nbsp;<span class="builtintype" id="1669622">string</span><span class="op" id="1669628">)</span>&nbsp;<span class="op" id="1669630">(</span><span class="ident" id="1669631">f</span>&nbsp;<span class="builtintype" id="1669633">float64</span><span class="op" id="1669640">,</span>&nbsp;<span class="ident" id="1669642">err</span>&nbsp;<span class="builtintype" id="1669646">error</span><span class="op" id="1669651">)</span>&nbsp;<span class="op" id="1669653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1669656">if</span>&nbsp;<span class="ident" id="1669659">val</span><span class="op" id="1669662">,</span>&nbsp;<span class="ident" id="1669664">ok</span>&nbsp;<span class="op" id="1669667">:=</span>&nbsp;<span class="ident" id="1669670">special</span><span class="op" id="1669677">(</span><span class="ident" id="1669678">s</span><span class="op" id="1669679">)</span><span class="op" id="1669680">;</span>&nbsp;<span class="ident" id="1669682">ok</span>&nbsp;<span class="op" id="1669685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1669689">return</span>&nbsp;<span class="ident" id="1669696">val</span><span class="op" id="1669699">,</span>&nbsp;<span class="ident" id="1669701">nil</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1669706">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1669710">if</span>&nbsp;<span class="ident" id="1669713">optimize</span>&nbsp;<span class="op" id="1669722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1669726">//&nbsp;Parse&nbsp;mantissa&nbsp;and&nbsp;exponent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1669760">mantissa</span><span class="op" id="1669768">,</span>&nbsp;<span class="ident" id="1669770">exp</span><span class="op" id="1669773">,</span>&nbsp;<span class="ident" id="1669775">neg</span><span class="op" id="1669778">,</span>&nbsp;<span class="ident" id="1669780">trunc</span><span class="op" id="1669785">,</span>&nbsp;<span class="ident" id="1669787">ok</span>&nbsp;<span class="op" id="1669790">:=</span>&nbsp;<span class="ident" id="1669793">readFloat</span><span class="op" id="1669802">(</span><span class="ident" id="1669803">s</span><span class="op" id="1669804">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1669808">if</span>&nbsp;<span class="ident" id="1669811">ok</span>&nbsp;<span class="op" id="1669814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1669819">//&nbsp;Try&nbsp;pure&nbsp;floating-point&nbsp;arithmetic&nbsp;conversion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1669872">if</span>&nbsp;<span class="op" id="1669875">!</span><span class="ident" id="1669876">trunc</span>&nbsp;<span class="op" id="1669882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1669888">if</span>&nbsp;<span class="ident" id="1669891">f</span><span class="op" id="1669892">,</span>&nbsp;<span class="ident" id="1669894">ok</span>&nbsp;<span class="op" id="1669897">:=</span>&nbsp;<span class="ident" id="1669900">atof64exact</span><span class="op" id="1669911">(</span><span class="ident" id="1669912">mantissa</span><span class="op" id="1669920">,</span>&nbsp;<span class="ident" id="1669922">exp</span><span class="op" id="1669925">,</span>&nbsp;<span class="ident" id="1669927">neg</span><span class="op" id="1669930">)</span><span class="op" id="1669931">;</span>&nbsp;<span class="ident" id="1669933">ok</span>&nbsp;<span class="op" id="1669936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1669943">return</span>&nbsp;<span class="ident" id="1669950">f</span><span class="op" id="1669951">,</span>&nbsp;<span class="ident" id="1669953">nil</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1669961">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1669966">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1669971">//&nbsp;Try&nbsp;another&nbsp;fast&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1670000">ext</span>&nbsp;<span class="op" id="1670004">:=</span>&nbsp;<span class="builtinfunc" id="1670007">new</span><span class="op" id="1670010">(</span><span class="ident" id="1670011">extFloat</span><span class="op" id="1670019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1670024">if</span>&nbsp;<span class="ident" id="1670027">ok</span>&nbsp;<span class="op" id="1670030">:=</span>&nbsp;<span class="ident" id="1670033">ext</span><span class="op" id="1670036">.</span><span class="ident" id="1670037">AssignDecimal</span><span class="op" id="1670050">(</span><span class="ident" id="1670051">mantissa</span><span class="op" id="1670059">,</span>&nbsp;<span class="ident" id="1670061">exp</span><span class="op" id="1670064">,</span>&nbsp;<span class="ident" id="1670066">neg</span><span class="op" id="1670069">,</span>&nbsp;<span class="ident" id="1670071">trunc</span><span class="op" id="1670076">,</span>&nbsp;<span class="op" id="1670078">&amp;</span><span class="ident" id="1670079">float64info</span><span class="op" id="1670090">)</span><span class="op" id="1670091">;</span>&nbsp;<span class="ident" id="1670093">ok</span>&nbsp;<span class="op" id="1670096">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1670102">b</span><span class="op" id="1670103">,</span>&nbsp;<span class="ident" id="1670105">ovf</span>&nbsp;<span class="op" id="1670109">:=</span>&nbsp;<span class="ident" id="1670112">ext</span><span class="op" id="1670115">.</span><span class="ident" id="1670116">floatBits</span><span class="op" id="1670125">(</span><span class="op" id="1670126">&amp;</span><span class="ident" id="1670127">float64info</span><span class="op" id="1670138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1670144">f</span>&nbsp;<span class="op" id="1670146">=</span>&nbsp;<span class="ident" id="1670148">math</span><span class="op" id="1670152">.</span><span class="ident" id="1670153">Float64frombits</span><span class="op" id="1670168">(</span><span class="ident" id="1670169">b</span><span class="op" id="1670170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1670176">if</span>&nbsp;<span class="ident" id="1670179">ovf</span>&nbsp;<span class="op" id="1670183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1670190">err</span>&nbsp;<span class="op" id="1670194">=</span>&nbsp;<span class="ident" id="1670196">rangeError</span><span class="op" id="1670206">(</span><span class="ident" id="1670207">fnParseFloat</span><span class="op" id="1670219">,</span>&nbsp;<span class="ident" id="1670221">s</span><span class="op" id="1670222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1670228">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1670234">return</span>&nbsp;<span class="ident" id="1670241">f</span><span class="op" id="1670242">,</span>&nbsp;<span class="ident" id="1670244">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1670251">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1670255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1670258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1670261">var</span>&nbsp;<span class="ident" id="1670265">d</span>&nbsp;<span class="ident" id="1670267">decimal</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1670276">if</span>&nbsp;<span class="op" id="1670279">!</span><span class="ident" id="1670280">d</span><span class="op" id="1670281">.</span><span class="ident" id="1670282">set</span><span class="op" id="1670285">(</span><span class="ident" id="1670286">s</span><span class="op" id="1670287">)</span>&nbsp;<span class="op" id="1670289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1670293">return</span>&nbsp;<span class="num" id="1670300">0</span><span class="op" id="1670301">,</span>&nbsp;<span class="ident" id="1670303">syntaxError</span><span class="op" id="1670314">(</span><span class="ident" id="1670315">fnParseFloat</span><span class="op" id="1670327">,</span>&nbsp;<span class="ident" id="1670329">s</span><span class="op" id="1670330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1670333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1670336">b</span><span class="op" id="1670337">,</span>&nbsp;<span class="ident" id="1670339">ovf</span>&nbsp;<span class="op" id="1670343">:=</span>&nbsp;<span class="ident" id="1670346">d</span><span class="op" id="1670347">.</span><span class="ident" id="1670348">floatBits</span><span class="op" id="1670357">(</span><span class="op" id="1670358">&amp;</span><span class="ident" id="1670359">float64info</span><span class="op" id="1670370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1670373">f</span>&nbsp;<span class="op" id="1670375">=</span>&nbsp;<span class="ident" id="1670377">math</span><span class="op" id="1670381">.</span><span class="ident" id="1670382">Float64frombits</span><span class="op" id="1670397">(</span><span class="ident" id="1670398">b</span><span class="op" id="1670399">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1670402">if</span>&nbsp;<span class="ident" id="1670405">ovf</span>&nbsp;<span class="op" id="1670409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1670413">err</span>&nbsp;<span class="op" id="1670417">=</span>&nbsp;<span class="ident" id="1670419">rangeError</span><span class="op" id="1670429">(</span><span class="ident" id="1670430">fnParseFloat</span><span class="op" id="1670442">,</span>&nbsp;<span class="ident" id="1670444">s</span><span class="op" id="1670445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1670448">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1670451">return</span>&nbsp;<span class="ident" id="1670458">f</span><span class="op" id="1670459">,</span>&nbsp;<span class="ident" id="1670461">err</span><br>
<span class="lineno"></span><span class="op" id="1670465">}</span><br>
<span class="lineno">515</span><br>
<span class="lineno"></span><span class="comment" id="1670468">//&nbsp;ParseFloat&nbsp;converts&nbsp;the&nbsp;string&nbsp;s&nbsp;to&nbsp;a&nbsp;floating-point&nbsp;number</span><br>
<span class="lineno"></span><span class="comment" id="1670531">//&nbsp;with&nbsp;the&nbsp;precision&nbsp;specified&nbsp;by&nbsp;bitSize:&nbsp;32&nbsp;for&nbsp;float32,&nbsp;or&nbsp;64&nbsp;for&nbsp;float64.</span><br>
<span class="lineno"></span><span class="comment" id="1670610">//&nbsp;When&nbsp;bitSize=32,&nbsp;the&nbsp;result&nbsp;still&nbsp;has&nbsp;type&nbsp;float64,&nbsp;but&nbsp;it&nbsp;will&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="1670680">//&nbsp;convertible&nbsp;to&nbsp;float32&nbsp;without&nbsp;changing&nbsp;its&nbsp;value.</span><br>
<span class="lineno">520</span><span class="comment" id="1670734">//</span><br>
<span class="lineno"></span><span class="comment" id="1670737">//&nbsp;If&nbsp;s&nbsp;is&nbsp;well-formed&nbsp;and&nbsp;near&nbsp;a&nbsp;valid&nbsp;floating&nbsp;point&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="1670800">//&nbsp;ParseFloat&nbsp;returns&nbsp;the&nbsp;nearest&nbsp;floating&nbsp;point&nbsp;number&nbsp;rounded</span><br>
<span class="lineno"></span><span class="comment" id="1670864">//&nbsp;using&nbsp;IEEE754&nbsp;unbiased&nbsp;rounding.</span><br>
<span class="lineno"></span><span class="comment" id="1670900">//</span><br>
<span class="lineno">525</span><span class="comment" id="1670903">//&nbsp;The&nbsp;errors&nbsp;that&nbsp;ParseFloat&nbsp;returns&nbsp;have&nbsp;concrete&nbsp;type&nbsp;*NumError</span><br>
<span class="lineno"></span><span class="comment" id="1670970">//&nbsp;and&nbsp;include&nbsp;err.Num&nbsp;=&nbsp;s.</span><br>
<span class="lineno"></span><span class="comment" id="1670998">//</span><br>
<span class="lineno"></span><span class="comment" id="1671001">//&nbsp;If&nbsp;s&nbsp;is&nbsp;not&nbsp;syntactically&nbsp;well-formed,&nbsp;ParseFloat&nbsp;returns&nbsp;err.Err&nbsp;=&nbsp;ErrSyntax.</span><br>
<span class="lineno"></span><span class="comment" id="1671083">//</span><br>
<span class="lineno">530</span><span class="comment" id="1671086">//&nbsp;If&nbsp;s&nbsp;is&nbsp;syntactically&nbsp;well-formed&nbsp;but&nbsp;is&nbsp;more&nbsp;than&nbsp;1/2&nbsp;ULP</span><br>
<span class="lineno"></span><span class="comment" id="1671148">//&nbsp;away&nbsp;from&nbsp;the&nbsp;largest&nbsp;floating&nbsp;point&nbsp;number&nbsp;of&nbsp;the&nbsp;given&nbsp;size,</span><br>
<span class="lineno"></span><span class="comment" id="1671214">//&nbsp;ParseFloat&nbsp;returns&nbsp;f&nbsp;=&nbsp;Inf,&nbsp;err.Err&nbsp;=&nbsp;ErrRange.</span><br>
<span class="lineno"></span><span class="keyword" id="1671267">func</span>&nbsp;<span class="ident" id="1671272">ParseFloat</span><span class="op" id="1671282">(</span><span class="ident" id="1671283">s</span>&nbsp;<span class="builtintype" id="1671285">string</span><span class="op" id="1671291">,</span>&nbsp;<span class="ident" id="1671293">bitSize</span>&nbsp;<span class="builtintype" id="1671301">int</span><span class="op" id="1671304">)</span>&nbsp;<span class="op" id="1671306">(</span><span class="ident" id="1671307">f</span>&nbsp;<span class="builtintype" id="1671309">float64</span><span class="op" id="1671316">,</span>&nbsp;<span class="ident" id="1671318">err</span>&nbsp;<span class="builtintype" id="1671322">error</span><span class="op" id="1671327">)</span>&nbsp;<span class="op" id="1671329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1671332">if</span>&nbsp;<span class="ident" id="1671335">bitSize</span>&nbsp;<span class="op" id="1671343">==</span>&nbsp;<span class="num" id="1671346">32</span>&nbsp;<span class="op" id="1671349">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1671353">f1</span><span class="op" id="1671355">,</span>&nbsp;<span class="ident" id="1671357">err1</span>&nbsp;<span class="op" id="1671362">:=</span>&nbsp;<span class="ident" id="1671365">atof32</span><span class="op" id="1671371">(</span><span class="ident" id="1671372">s</span><span class="op" id="1671373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1671377">return</span>&nbsp;<span class="builtintype" id="1671384">float64</span><span class="op" id="1671391">(</span><span class="ident" id="1671392">f1</span><span class="op" id="1671394">)</span><span class="op" id="1671395">,</span>&nbsp;<span class="ident" id="1671397">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1671403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1671406">f1</span><span class="op" id="1671408">,</span>&nbsp;<span class="ident" id="1671410">err1</span>&nbsp;<span class="op" id="1671415">:=</span>&nbsp;<span class="ident" id="1671418">atof64</span><span class="op" id="1671424">(</span><span class="ident" id="1671425">s</span><span class="op" id="1671426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1671429">return</span>&nbsp;<span class="ident" id="1671436">f1</span><span class="op" id="1671438">,</span>&nbsp;<span class="ident" id="1671440">err1</span><br>
<span class="lineno">540</span><span class="op" id="1671445">}</span>
</div>
</body>
</html>
