<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1534479">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1534534">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1534588">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1534639">package</span>&nbsp;<span class="ident" id="1534647">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1534653">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspFloating-point&nbsp;sine&nbsp;and&nbsp;cosine.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="1534693">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno"></span><span class="comment" id="1534753">//&nbsp;below&nbsp;were&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/cmath/sin.c,</span><br>
<span class="lineno"></span><span class="comment" id="1534817">//&nbsp;available&nbsp;from&nbsp;http://www.netlib.org/cephes/cmath.tgz.</span><br>
<span class="lineno"></span><span class="comment" id="1534875">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="1534933">//</span><br>
<span class="lineno"></span><span class="comment" id="1534936">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sin.c</span><br>
<span class="lineno"></span><span class="comment" id="1534950">//</span><br>
<span class="lineno"></span><span class="comment" id="1534953">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Circular&nbsp;sine</span><br>
<span class="lineno"></span><span class="comment" id="1534975">//</span><br>
<span class="lineno">20</span><span class="comment" id="1534978">//&nbsp;SYNOPSIS:</span><br>
<span class="lineno"></span><span class="comment" id="1534991">//</span><br>
<span class="lineno"></span><span class="comment" id="1534994">//&nbsp;double&nbsp;x,&nbsp;y,&nbsp;sin();</span><br>
<span class="lineno"></span><span class="comment" id="1535017">//&nbsp;y&nbsp;=&nbsp;sin(&nbsp;x&nbsp;);</span><br>
<span class="lineno"></span><span class="comment" id="1535034">//</span><br>
<span class="lineno">25</span><span class="comment" id="1535037">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="1535053">//</span><br>
<span class="lineno"></span><span class="comment" id="1535056">//&nbsp;Range&nbsp;reduction&nbsp;is&nbsp;into&nbsp;intervals&nbsp;of&nbsp;pi/4.&nbsp;&nbsp;The&nbsp;reduction&nbsp;error&nbsp;is&nbsp;nearly</span><br>
<span class="lineno"></span><span class="comment" id="1535133">//&nbsp;eliminated&nbsp;by&nbsp;contriving&nbsp;an&nbsp;extended&nbsp;precision&nbsp;modular&nbsp;arithmetic.</span><br>
<span class="lineno"></span><span class="comment" id="1535203">//</span><br>
<span class="lineno">30</span><span class="comment" id="1535206">//&nbsp;Two&nbsp;polynomial&nbsp;approximating&nbsp;functions&nbsp;are&nbsp;employed.</span><br>
<span class="lineno"></span><span class="comment" id="1535262">//&nbsp;Between&nbsp;0&nbsp;and&nbsp;pi/4&nbsp;the&nbsp;sine&nbsp;is&nbsp;approximated&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="1535312">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;+&nbsp;&nbsp;x**3&nbsp;P(x**2).</span><br>
<span class="lineno"></span><span class="comment" id="1535340">//&nbsp;Between&nbsp;pi/4&nbsp;and&nbsp;pi/2&nbsp;the&nbsp;cosine&nbsp;is&nbsp;represented&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="1535394">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;-&nbsp;&nbsp;x**2&nbsp;Q(x**2).</span><br>
<span class="lineno">35</span><span class="comment" id="1535422">//</span><br>
<span class="lineno"></span><span class="comment" id="1535425">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="1535438">//</span><br>
<span class="lineno"></span><span class="comment" id="1535441">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="1535481">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">40</span><span class="comment" id="1535540">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;150000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.0e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.8e-18</span><br>
<span class="lineno"></span><span class="comment" id="1535601">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;-1.07e9,+1.07e9&nbsp;&nbsp;130000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.1e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.4e-17</span><br>
<span class="lineno"></span><span class="comment" id="1535662">//</span><br>
<span class="lineno"></span><span class="comment" id="1535665">//&nbsp;Partial&nbsp;loss&nbsp;of&nbsp;accuracy&nbsp;begins&nbsp;to&nbsp;occur&nbsp;at&nbsp;x&nbsp;=&nbsp;2**30&nbsp;=&nbsp;1.074e9.&nbsp;&nbsp;The&nbsp;loss</span><br>
<span class="lineno"></span><span class="comment" id="1535743">//&nbsp;is&nbsp;not&nbsp;gradual,&nbsp;but&nbsp;jumps&nbsp;suddenly&nbsp;to&nbsp;about&nbsp;1&nbsp;part&nbsp;in&nbsp;10e7.&nbsp;&nbsp;Results&nbsp;may</span><br>
<span class="lineno">45</span><span class="comment" id="1535819">//&nbsp;be&nbsp;meaningless&nbsp;for&nbsp;x&nbsp;&gt;&nbsp;2**49&nbsp;=&nbsp;5.6e14.</span><br>
<span class="lineno"></span><span class="comment" id="1535861">//</span><br>
<span class="lineno"></span><span class="comment" id="1535864">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cos.c</span><br>
<span class="lineno"></span><span class="comment" id="1535878">//</span><br>
<span class="lineno"></span><span class="comment" id="1535881">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Circular&nbsp;cosine</span><br>
<span class="lineno">50</span><span class="comment" id="1535905">//</span><br>
<span class="lineno"></span><span class="comment" id="1535908">//&nbsp;SYNOPSIS:</span><br>
<span class="lineno"></span><span class="comment" id="1535921">//</span><br>
<span class="lineno"></span><span class="comment" id="1535924">//&nbsp;double&nbsp;x,&nbsp;y,&nbsp;cos();</span><br>
<span class="lineno"></span><span class="comment" id="1535947">//&nbsp;y&nbsp;=&nbsp;cos(&nbsp;x&nbsp;);</span><br>
<span class="lineno">55</span><span class="comment" id="1535964">//</span><br>
<span class="lineno"></span><span class="comment" id="1535967">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="1535983">//</span><br>
<span class="lineno"></span><span class="comment" id="1535986">//&nbsp;Range&nbsp;reduction&nbsp;is&nbsp;into&nbsp;intervals&nbsp;of&nbsp;pi/4.&nbsp;&nbsp;The&nbsp;reduction&nbsp;error&nbsp;is&nbsp;nearly</span><br>
<span class="lineno"></span><span class="comment" id="1536063">//&nbsp;eliminated&nbsp;by&nbsp;contriving&nbsp;an&nbsp;extended&nbsp;precision&nbsp;modular&nbsp;arithmetic.</span><br>
<span class="lineno">60</span><span class="comment" id="1536133">//</span><br>
<span class="lineno"></span><span class="comment" id="1536136">//&nbsp;Two&nbsp;polynomial&nbsp;approximating&nbsp;functions&nbsp;are&nbsp;employed.</span><br>
<span class="lineno"></span><span class="comment" id="1536192">//&nbsp;Between&nbsp;0&nbsp;and&nbsp;pi/4&nbsp;the&nbsp;cosine&nbsp;is&nbsp;approximated&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="1536244">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;-&nbsp;&nbsp;x**2&nbsp;Q(x**2).</span><br>
<span class="lineno"></span><span class="comment" id="1536272">//&nbsp;Between&nbsp;pi/4&nbsp;and&nbsp;pi/2&nbsp;the&nbsp;sine&nbsp;is&nbsp;represented&nbsp;as</span><br>
<span class="lineno">65</span><span class="comment" id="1536324">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;+&nbsp;&nbsp;x**3&nbsp;P(x**2).</span><br>
<span class="lineno"></span><span class="comment" id="1536352">//</span><br>
<span class="lineno"></span><span class="comment" id="1536355">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="1536368">//</span><br>
<span class="lineno"></span><span class="comment" id="1536371">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno">70</span><span class="comment" id="1536411">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno"></span><span class="comment" id="1536470">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;-1.07e9,+1.07e9&nbsp;&nbsp;130000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.1e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.4e-17</span><br>
<span class="lineno"></span><span class="comment" id="1536531">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,+1.07e9&nbsp;&nbsp;&nbsp;17000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.0e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.2e-18</span><br>
<span class="lineno"></span><span class="comment" id="1536592">//</span><br>
<span class="lineno"></span><span class="comment" id="1536595">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno">75</span><span class="comment" id="1536643">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="1536707">//</span><br>
<span class="lineno"></span><span class="comment" id="1536710">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="1536771">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1536841">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno">80</span><span class="comment" id="1536916">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="1536983">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="1537056">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="1537128">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="1537142">//</span><br>
<span class="lineno">85</span><span class="comment" id="1537145">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1537211">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="1537277">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="1537290">//</span><br>
<span class="lineno"></span><span class="comment" id="1537293">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">90</span><span class="comment" id="1537317">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1537347">//&nbsp;sin&nbsp;coefficients</span><br>
<span class="lineno"></span><span class="keyword" id="1537367">var</span>&nbsp;<span class="ident" id="1537371">_sin</span>&nbsp;<span class="op" id="1537376">=</span>&nbsp;<span class="op" id="1537378">[</span><span class="op" id="1537379">...</span><span class="op" id="1537382">]</span><span class="builtintype" id="1537383">float64</span><span class="op" id="1537390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1537393">1.58962301576546568060E-10</span><span class="op" id="1537419">,</span>&nbsp;<span class="comment" id="1537421">//&nbsp;0x3de5d8fd1fd19ccd</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1537444">-</span><span class="num" id="1537445">2.50507477628578072866E-8</span><span class="op" id="1537470">,</span>&nbsp;<span class="comment" id="1537472">//&nbsp;0xbe5ae5e5a9291f5d</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1537495">2.75573136213857245213E-6</span><span class="op" id="1537520">,</span>&nbsp;&nbsp;<span class="comment" id="1537523">//&nbsp;0x3ec71de3567d48a1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1537546">-</span><span class="num" id="1537547">1.98412698295895385996E-4</span><span class="op" id="1537572">,</span>&nbsp;<span class="comment" id="1537574">//&nbsp;0xbf2a01a019bfdf03</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1537597">8.33333333332211858878E-3</span><span class="op" id="1537622">,</span>&nbsp;&nbsp;<span class="comment" id="1537625">//&nbsp;0x3f8111111110f7d0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1537648">-</span><span class="num" id="1537649">1.66666666666666307295E-1</span><span class="op" id="1537674">,</span>&nbsp;<span class="comment" id="1537676">//&nbsp;0xbfc5555555555548</span><br>
<span class="lineno">100</span><span class="op" id="1537698">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1537701">//&nbsp;cos&nbsp;coefficients</span><br>
<span class="lineno"></span><span class="keyword" id="1537721">var</span>&nbsp;<span class="ident" id="1537725">_cos</span>&nbsp;<span class="op" id="1537730">=</span>&nbsp;<span class="op" id="1537732">[</span><span class="op" id="1537733">...</span><span class="op" id="1537736">]</span><span class="builtintype" id="1537737">float64</span><span class="op" id="1537744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1537747">-</span><span class="num" id="1537748">1.13585365213876817300E-11</span><span class="op" id="1537774">,</span>&nbsp;<span class="comment" id="1537776">//&nbsp;0xbda8fa49a0861a9b</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1537799">2.08757008419747316778E-9</span><span class="op" id="1537824">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1537828">//&nbsp;0x3e21ee9d7b4e3f05</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1537851">-</span><span class="num" id="1537852">2.75573141792967388112E-7</span><span class="op" id="1537877">,</span>&nbsp;&nbsp;<span class="comment" id="1537880">//&nbsp;0xbe927e4f7eac4bc6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1537903">2.48015872888517045348E-5</span><span class="op" id="1537928">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1537932">//&nbsp;0x3efa01a019c844f5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1537955">-</span><span class="num" id="1537956">1.38888888888730564116E-3</span><span class="op" id="1537981">,</span>&nbsp;&nbsp;<span class="comment" id="1537984">//&nbsp;0xbf56c16c16c14f91</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1538007">4.16666666666665929218E-2</span><span class="op" id="1538032">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1538036">//&nbsp;0x3fa555555555554b</span><br>
<span class="lineno">110</span><span class="op" id="1538058">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1538061">//&nbsp;Cos&nbsp;returns&nbsp;the&nbsp;cosine&nbsp;of&nbsp;the&nbsp;radian&nbsp;argument&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="1538113">//</span><br>
<span class="lineno"></span><span class="comment" id="1538116">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">115</span><span class="comment" id="1538138">//&nbsp;&nbsp;&nbsp;&nbspCos(±Inf)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="1538158">//&nbsp;&nbsp;&nbsp;&nbspCos(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="1538176">func</span>&nbsp;<span class="ident" id="1538181">Cos</span><span class="op" id="1538184">(</span><span class="ident" id="1538185">x</span>&nbsp;<span class="builtintype" id="1538187">float64</span><span class="op" id="1538194">)</span>&nbsp;<span class="builtintype" id="1538196">float64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1538205">func</span>&nbsp;<span class="ident" id="1538210">cos</span><span class="op" id="1538213">(</span><span class="ident" id="1538214">x</span>&nbsp;<span class="builtintype" id="1538216">float64</span><span class="op" id="1538223">)</span>&nbsp;<span class="builtintype" id="1538225">float64</span>&nbsp;<span class="op" id="1538233">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1538236">const</span>&nbsp;<span class="op" id="1538242">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1538246">PI4A</span>&nbsp;<span class="op" id="1538251">=</span>&nbsp;<span class="num" id="1538253">7.85398125648498535156E-1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1538307">//&nbsp;0x3fe921fb40000000,&nbsp;Pi/4&nbsp;split&nbsp;into&nbsp;three&nbsp;parts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1538360">PI4B</span>&nbsp;<span class="op" id="1538365">=</span>&nbsp;<span class="num" id="1538367">3.77489470793079817668E-8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1538421">//&nbsp;0x3e64442d00000000,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1538446">PI4C</span>&nbsp;<span class="op" id="1538451">=</span>&nbsp;<span class="num" id="1538453">2.69515142907905952645E-15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1538507">//&nbsp;0x3ce8469898cc5170,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1538532">M4PI</span>&nbsp;<span class="op" id="1538537">=</span>&nbsp;<span class="num" id="1538539">1.273239544735162542821171882678754627704620361328125</span>&nbsp;<span class="comment" id="1538593">//&nbsp;4/pi</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1538602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1538605">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1538623">switch</span>&nbsp;<span class="op" id="1538630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1538633">case</span>&nbsp;<span class="ident" id="1538638"><a href="/math/bits.go.html#1427394">IsNaN</a></span><span class="op" id="1538643">(</span><span class="ident" id="1538644"><a href="/math/sin.go.html#1538214">x</a></span><span class="op" id="1538645">)</span>&nbsp;<span class="op" id="1538647">||</span>&nbsp;<span class="ident" id="1538650"><a href="/math/bits.go.html#1427892">IsInf</a></span><span class="op" id="1538655">(</span><span class="ident" id="1538656"><a href="/math/sin.go.html#1538214">x</a></span><span class="op" id="1538657">,</span>&nbsp;<span class="num" id="1538659">0</span><span class="op" id="1538660">)</span><span class="op" id="1538661">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1538665">return</span>&nbsp;<span class="ident" id="1538672"><a href="/math/bits.go.html#1427274">NaN</a></span><span class="op" id="1538675">(</span><span class="op" id="1538676">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1538679">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1538683">//&nbsp;make&nbsp;argument&nbsp;positive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1538710">sign</span>&nbsp;<span class="op" id="1538715">:=</span>&nbsp;<span class="ident" id="1538718">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1538725">if</span>&nbsp;<span class="ident" id="1538728"><a href="/math/sin.go.html#1538214">x</a></span>&nbsp;<span class="op" id="1538730">&lt;</span>&nbsp;<span class="num" id="1538732">0</span>&nbsp;<span class="op" id="1538734">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1538738"><a href="/math/sin.go.html#1538214">x</a></span>&nbsp;<span class="op" id="1538740">=</span>&nbsp;<span class="op" id="1538742">-</span><span class="ident" id="1538743"><a href="/math/sin.go.html#1538214">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1538746">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1538750">j</span>&nbsp;<span class="op" id="1538752">:=</span>&nbsp;<span class="ident" id="1538755">int64</span><span class="op" id="1538760">(</span><span class="ident" id="1538761"><a href="/math/sin.go.html#1538214">x</a></span>&nbsp;<span class="op" id="1538763">*</span>&nbsp;<span class="ident" id="1538765"><a href="/math/sin.go.html#1538532">M4PI</a></span><span class="op" id="1538769">)</span>&nbsp;<span class="comment" id="1538771">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;integer&nbsp;for&nbsp;tests&nbsp;on&nbsp;the&nbsp;phase&nbsp;angle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1538841">y</span>&nbsp;<span class="op" id="1538843">:=</span>&nbsp;<span class="builtintype" id="1538846">float64</span><span class="op" id="1538853">(</span><span class="ident" id="1538854"><a href="/math/sin.go.html#1538750">j</a></span><span class="op" id="1538855">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1538862">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;float</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1538902">//&nbsp;map&nbsp;zeros&nbsp;to&nbsp;origin</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1538926">if</span>&nbsp;<span class="ident" id="1538929"><a href="/math/sin.go.html#1538750">j</a></span><span class="op" id="1538930">&amp;</span><span class="num" id="1538931">1</span>&nbsp;<span class="op" id="1538933">==</span>&nbsp;<span class="num" id="1538936">1</span>&nbsp;<span class="op" id="1538938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1538942"><a href="/math/sin.go.html#1538750">j</a></span>&nbsp;<span class="op" id="1538944">+=</span>&nbsp;<span class="num" id="1538947">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1538951"><a href="/math/sin.go.html#1538841">y</a></span>&nbsp;<span class="op" id="1538953">+=</span>&nbsp;<span class="num" id="1538956">1</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1538959">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1538962"><a href="/math/sin.go.html#1538750">j</a></span>&nbsp;<span class="op" id="1538964">&amp;=</span>&nbsp;<span class="num" id="1538967">7</span>&nbsp;<span class="comment" id="1538969">//&nbsp;octant&nbsp;modulo&nbsp;2Pi&nbsp;radians&nbsp;(360&nbsp;degrees)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1539013">if</span>&nbsp;<span class="ident" id="1539016"><a href="/math/sin.go.html#1538750">j</a></span>&nbsp;<span class="op" id="1539018">&gt;</span>&nbsp;<span class="num" id="1539020">3</span>&nbsp;<span class="op" id="1539022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1539026"><a href="/math/sin.go.html#1538750">j</a></span>&nbsp;<span class="op" id="1539028">-=</span>&nbsp;<span class="num" id="1539031">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1539035"><a href="/math/sin.go.html#1538710">sign</a></span>&nbsp;<span class="op" id="1539040">=</span>&nbsp;<span class="op" id="1539042">!</span><span class="ident" id="1539043"><a href="/math/sin.go.html#1538710">sign</a></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1539049">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1539052">if</span>&nbsp;<span class="ident" id="1539055"><a href="/math/sin.go.html#1538750">j</a></span>&nbsp;<span class="op" id="1539057">&gt;</span>&nbsp;<span class="num" id="1539059">1</span>&nbsp;<span class="op" id="1539061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1539065"><a href="/math/sin.go.html#1538710">sign</a></span>&nbsp;<span class="op" id="1539070">=</span>&nbsp;<span class="op" id="1539072">!</span><span class="ident" id="1539073"><a href="/math/sin.go.html#1538710">sign</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1539079">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1539083">z</span>&nbsp;<span class="op" id="1539085">:=</span>&nbsp;<span class="op" id="1539088">(</span><span class="op" id="1539089">(</span><span class="ident" id="1539090"><a href="/math/sin.go.html#1538214">x</a></span>&nbsp;<span class="op" id="1539092">-</span>&nbsp;<span class="ident" id="1539094"><a href="/math/sin.go.html#1538841">y</a></span><span class="op" id="1539095">*</span><span class="ident" id="1539096"><a href="/math/sin.go.html#1538246">PI4A</a></span><span class="op" id="1539100">)</span>&nbsp;<span class="op" id="1539102">-</span>&nbsp;<span class="ident" id="1539104"><a href="/math/sin.go.html#1538841">y</a></span><span class="op" id="1539105">*</span><span class="ident" id="1539106"><a href="/math/sin.go.html#1538360">PI4B</a></span><span class="op" id="1539110">)</span>&nbsp;<span class="op" id="1539112">-</span>&nbsp;<span class="ident" id="1539114"><a href="/math/sin.go.html#1538841">y</a></span><span class="op" id="1539115">*</span><span class="ident" id="1539116"><a href="/math/sin.go.html#1538446">PI4C</a></span>&nbsp;<span class="comment" id="1539121">//&nbsp;Extended&nbsp;precision&nbsp;modular&nbsp;arithmetic</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1539163">zz</span>&nbsp;<span class="op" id="1539166">:=</span>&nbsp;<span class="ident" id="1539169"><a href="/math/sin.go.html#1539083">z</a></span>&nbsp;<span class="op" id="1539171">*</span>&nbsp;<span class="ident" id="1539173"><a href="/math/sin.go.html#1539083">z</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1539176">if</span>&nbsp;<span class="ident" id="1539179"><a href="/math/sin.go.html#1538750">j</a></span>&nbsp;<span class="op" id="1539181">==</span>&nbsp;<span class="num" id="1539184">1</span>&nbsp;<span class="op" id="1539186">||</span>&nbsp;<span class="ident" id="1539189"><a href="/math/sin.go.html#1538750">j</a></span>&nbsp;<span class="op" id="1539191">==</span>&nbsp;<span class="num" id="1539194">2</span>&nbsp;<span class="op" id="1539196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1539200"><a href="/math/sin.go.html#1538841">y</a></span>&nbsp;<span class="op" id="1539202">=</span>&nbsp;<span class="ident" id="1539204"><a href="/math/sin.go.html#1539083">z</a></span>&nbsp;<span class="op" id="1539206">+</span>&nbsp;<span class="ident" id="1539208"><a href="/math/sin.go.html#1539083">z</a></span><span class="op" id="1539209">*</span><span class="ident" id="1539210"><a href="/math/sin.go.html#1539163">zz</a></span><span class="op" id="1539212">*</span><span class="op" id="1539213">(</span><span class="op" id="1539214">(</span><span class="op" id="1539215">(</span><span class="op" id="1539216">(</span><span class="op" id="1539217">(</span><span class="op" id="1539218">(</span><span class="ident" id="1539219"><a href="/math/sin.go.html#1537371">_sin</a></span><span class="op" id="1539223">[</span><span class="num" id="1539224">0</span><span class="op" id="1539225">]</span><span class="op" id="1539226">*</span><span class="ident" id="1539227"><a href="/math/sin.go.html#1539163">zz</a></span><span class="op" id="1539229">)</span><span class="op" id="1539230">+</span><span class="ident" id="1539231"><a href="/math/sin.go.html#1537371">_sin</a></span><span class="op" id="1539235">[</span><span class="num" id="1539236">1</span><span class="op" id="1539237">]</span><span class="op" id="1539238">)</span><span class="op" id="1539239">*</span><span class="ident" id="1539240"><a href="/math/sin.go.html#1539163">zz</a></span><span class="op" id="1539242">+</span><span class="ident" id="1539243"><a href="/math/sin.go.html#1537371">_sin</a></span><span class="op" id="1539247">[</span><span class="num" id="1539248">2</span><span class="op" id="1539249">]</span><span class="op" id="1539250">)</span><span class="op" id="1539251">*</span><span class="ident" id="1539252"><a href="/math/sin.go.html#1539163">zz</a></span><span class="op" id="1539254">+</span><span class="ident" id="1539255"><a href="/math/sin.go.html#1537371">_sin</a></span><span class="op" id="1539259">[</span><span class="num" id="1539260">3</span><span class="op" id="1539261">]</span><span class="op" id="1539262">)</span><span class="op" id="1539263">*</span><span class="ident" id="1539264"><a href="/math/sin.go.html#1539163">zz</a></span><span class="op" id="1539266">+</span><span class="ident" id="1539267"><a href="/math/sin.go.html#1537371">_sin</a></span><span class="op" id="1539271">[</span><span class="num" id="1539272">4</span><span class="op" id="1539273">]</span><span class="op" id="1539274">)</span><span class="op" id="1539275">*</span><span class="ident" id="1539276"><a href="/math/sin.go.html#1539163">zz</a></span><span class="op" id="1539278">+</span><span class="ident" id="1539279"><a href="/math/sin.go.html#1537371">_sin</a></span><span class="op" id="1539283">[</span><span class="num" id="1539284">5</span><span class="op" id="1539285">]</span><span class="op" id="1539286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1539289">}</span>&nbsp;<span class="keyword" id="1539291">else</span>&nbsp;<span class="op" id="1539296">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1539300"><a href="/math/sin.go.html#1538841">y</a></span>&nbsp;<span class="op" id="1539302">=</span>&nbsp;<span class="num" id="1539304">1.0</span>&nbsp;<span class="op" id="1539308">-</span>&nbsp;<span class="num" id="1539310">0.5</span><span class="op" id="1539313">*</span><span class="ident" id="1539314"><a href="/math/sin.go.html#1539163">zz</a></span>&nbsp;<span class="op" id="1539317">+</span>&nbsp;<span class="ident" id="1539319"><a href="/math/sin.go.html#1539163">zz</a></span><span class="op" id="1539321">*</span><span class="ident" id="1539322"><a href="/math/sin.go.html#1539163">zz</a></span><span class="op" id="1539324">*</span><span class="op" id="1539325">(</span><span class="op" id="1539326">(</span><span class="op" id="1539327">(</span><span class="op" id="1539328">(</span><span class="op" id="1539329">(</span><span class="op" id="1539330">(</span><span class="ident" id="1539331"><a href="/math/sin.go.html#1537725">_cos</a></span><span class="op" id="1539335">[</span><span class="num" id="1539336">0</span><span class="op" id="1539337">]</span><span class="op" id="1539338">*</span><span class="ident" id="1539339"><a href="/math/sin.go.html#1539163">zz</a></span><span class="op" id="1539341">)</span><span class="op" id="1539342">+</span><span class="ident" id="1539343"><a href="/math/sin.go.html#1537725">_cos</a></span><span class="op" id="1539347">[</span><span class="num" id="1539348">1</span><span class="op" id="1539349">]</span><span class="op" id="1539350">)</span><span class="op" id="1539351">*</span><span class="ident" id="1539352"><a href="/math/sin.go.html#1539163">zz</a></span><span class="op" id="1539354">+</span><span class="ident" id="1539355"><a href="/math/sin.go.html#1537725">_cos</a></span><span class="op" id="1539359">[</span><span class="num" id="1539360">2</span><span class="op" id="1539361">]</span><span class="op" id="1539362">)</span><span class="op" id="1539363">*</span><span class="ident" id="1539364"><a href="/math/sin.go.html#1539163">zz</a></span><span class="op" id="1539366">+</span><span class="ident" id="1539367"><a href="/math/sin.go.html#1537725">_cos</a></span><span class="op" id="1539371">[</span><span class="num" id="1539372">3</span><span class="op" id="1539373">]</span><span class="op" id="1539374">)</span><span class="op" id="1539375">*</span><span class="ident" id="1539376"><a href="/math/sin.go.html#1539163">zz</a></span><span class="op" id="1539378">+</span><span class="ident" id="1539379"><a href="/math/sin.go.html#1537725">_cos</a></span><span class="op" id="1539383">[</span><span class="num" id="1539384">4</span><span class="op" id="1539385">]</span><span class="op" id="1539386">)</span><span class="op" id="1539387">*</span><span class="ident" id="1539388"><a href="/math/sin.go.html#1539163">zz</a></span><span class="op" id="1539390">+</span><span class="ident" id="1539391"><a href="/math/sin.go.html#1537725">_cos</a></span><span class="op" id="1539395">[</span><span class="num" id="1539396">5</span><span class="op" id="1539397">]</span><span class="op" id="1539398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1539401">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1539404">if</span>&nbsp;<span class="ident" id="1539407"><a href="/math/sin.go.html#1538710">sign</a></span>&nbsp;<span class="op" id="1539412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1539416"><a href="/math/sin.go.html#1538841">y</a></span>&nbsp;<span class="op" id="1539418">=</span>&nbsp;<span class="op" id="1539420">-</span><span class="ident" id="1539421"><a href="/math/sin.go.html#1538841">y</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1539424">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1539427">return</span>&nbsp;<span class="ident" id="1539434"><a href="/math/sin.go.html#1538841">y</a></span><br>
<span class="lineno"></span><span class="op" id="1539436">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1539439">//&nbsp;Sin&nbsp;returns&nbsp;the&nbsp;sine&nbsp;of&nbsp;the&nbsp;radian&nbsp;argument&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="1539489">//</span><br>
<span class="lineno">170</span><span class="comment" id="1539492">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="1539514">//&nbsp;&nbsp;&nbsp;&nbspSin(±0)&nbsp;=&nbsp;±0</span><br>
<span class="lineno"></span><span class="comment" id="1539532">//&nbsp;&nbsp;&nbsp;&nbspSin(±Inf)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="1539552">//&nbsp;&nbsp;&nbsp;&nbspSin(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="1539570">func</span>&nbsp;<span class="ident" id="1539575">Sin</span><span class="op" id="1539578">(</span><span class="ident" id="1539579">x</span>&nbsp;<span class="builtintype" id="1539581">float64</span><span class="op" id="1539588">)</span>&nbsp;<span class="builtintype" id="1539590">float64</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="1539599">func</span>&nbsp;<span class="ident" id="1539604">sin</span><span class="op" id="1539607">(</span><span class="ident" id="1539608">x</span>&nbsp;<span class="builtintype" id="1539610">float64</span><span class="op" id="1539617">)</span>&nbsp;<span class="builtintype" id="1539619">float64</span>&nbsp;<span class="op" id="1539627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1539630">const</span>&nbsp;<span class="op" id="1539636">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1539640">PI4A</span>&nbsp;<span class="op" id="1539645">=</span>&nbsp;<span class="num" id="1539647">7.85398125648498535156E-1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1539701">//&nbsp;0x3fe921fb40000000,&nbsp;Pi/4&nbsp;split&nbsp;into&nbsp;three&nbsp;parts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1539754">PI4B</span>&nbsp;<span class="op" id="1539759">=</span>&nbsp;<span class="num" id="1539761">3.77489470793079817668E-8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1539815">//&nbsp;0x3e64442d00000000,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1539840">PI4C</span>&nbsp;<span class="op" id="1539845">=</span>&nbsp;<span class="num" id="1539847">2.69515142907905952645E-15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1539901">//&nbsp;0x3ce8469898cc5170,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1539926">M4PI</span>&nbsp;<span class="op" id="1539931">=</span>&nbsp;<span class="num" id="1539933">1.273239544735162542821171882678754627704620361328125</span>&nbsp;<span class="comment" id="1539987">//&nbsp;4/pi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1539996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1539999">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1540017">switch</span>&nbsp;<span class="op" id="1540024">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1540027">case</span>&nbsp;<span class="ident" id="1540032"><a href="/math/sin.go.html#1539608">x</a></span>&nbsp;<span class="op" id="1540034">==</span>&nbsp;<span class="num" id="1540037">0</span>&nbsp;<span class="op" id="1540039">||</span>&nbsp;<span class="ident" id="1540042"><a href="/math/bits.go.html#1427394">IsNaN</a></span><span class="op" id="1540047">(</span><span class="ident" id="1540048"><a href="/math/sin.go.html#1539608">x</a></span><span class="op" id="1540049">)</span><span class="op" id="1540050">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1540054">return</span>&nbsp;<span class="ident" id="1540061"><a href="/math/sin.go.html#1539608">x</a></span>&nbsp;<span class="comment" id="1540063">//&nbsp;return&nbsp;±0&nbsp;||&nbsp;NaN()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1540087">case</span>&nbsp;<span class="ident" id="1540092"><a href="/math/bits.go.html#1427892">IsInf</a></span><span class="op" id="1540097">(</span><span class="ident" id="1540098"><a href="/math/sin.go.html#1539608">x</a></span><span class="op" id="1540099">,</span>&nbsp;<span class="num" id="1540101">0</span><span class="op" id="1540102">)</span><span class="op" id="1540103">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1540107">return</span>&nbsp;<span class="ident" id="1540114"><a href="/math/bits.go.html#1427274">NaN</a></span><span class="op" id="1540117">(</span><span class="op" id="1540118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1540121">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1540125">//&nbsp;make&nbsp;argument&nbsp;positive&nbsp;but&nbsp;save&nbsp;the&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1540170">sign</span>&nbsp;<span class="op" id="1540175">:=</span>&nbsp;<span class="ident" id="1540178">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1540185">if</span>&nbsp;<span class="ident" id="1540188"><a href="/math/sin.go.html#1539608">x</a></span>&nbsp;<span class="op" id="1540190">&lt;</span>&nbsp;<span class="num" id="1540192">0</span>&nbsp;<span class="op" id="1540194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1540198"><a href="/math/sin.go.html#1539608">x</a></span>&nbsp;<span class="op" id="1540200">=</span>&nbsp;<span class="op" id="1540202">-</span><span class="ident" id="1540203"><a href="/math/sin.go.html#1539608">x</a></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1540207"><a href="/math/sin.go.html#1540170">sign</a></span>&nbsp;<span class="op" id="1540212">=</span>&nbsp;<span class="ident" id="1540214">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1540220">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1540224">j</span>&nbsp;<span class="op" id="1540226">:=</span>&nbsp;<span class="ident" id="1540229">int64</span><span class="op" id="1540234">(</span><span class="ident" id="1540235"><a href="/math/sin.go.html#1539608">x</a></span>&nbsp;<span class="op" id="1540237">*</span>&nbsp;<span class="ident" id="1540239"><a href="/math/sin.go.html#1539926">M4PI</a></span><span class="op" id="1540243">)</span>&nbsp;<span class="comment" id="1540245">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;integer&nbsp;for&nbsp;tests&nbsp;on&nbsp;the&nbsp;phase&nbsp;angle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1540315">y</span>&nbsp;<span class="op" id="1540317">:=</span>&nbsp;<span class="builtintype" id="1540320">float64</span><span class="op" id="1540327">(</span><span class="ident" id="1540328"><a href="/math/sin.go.html#1540224">j</a></span><span class="op" id="1540329">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1540336">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;float</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1540376">//&nbsp;map&nbsp;zeros&nbsp;to&nbsp;origin</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1540400">if</span>&nbsp;<span class="ident" id="1540403"><a href="/math/sin.go.html#1540224">j</a></span><span class="op" id="1540404">&amp;</span><span class="num" id="1540405">1</span>&nbsp;<span class="op" id="1540407">==</span>&nbsp;<span class="num" id="1540410">1</span>&nbsp;<span class="op" id="1540412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1540416"><a href="/math/sin.go.html#1540224">j</a></span>&nbsp;<span class="op" id="1540418">+=</span>&nbsp;<span class="num" id="1540421">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1540425"><a href="/math/sin.go.html#1540315">y</a></span>&nbsp;<span class="op" id="1540427">+=</span>&nbsp;<span class="num" id="1540430">1</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1540433">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1540436"><a href="/math/sin.go.html#1540224">j</a></span>&nbsp;<span class="op" id="1540438">&amp;=</span>&nbsp;<span class="num" id="1540441">7</span>&nbsp;<span class="comment" id="1540443">//&nbsp;octant&nbsp;modulo&nbsp;2Pi&nbsp;radians&nbsp;(360&nbsp;degrees)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1540487">//&nbsp;reflect&nbsp;in&nbsp;x&nbsp;axis</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1540509">if</span>&nbsp;<span class="ident" id="1540512"><a href="/math/sin.go.html#1540224">j</a></span>&nbsp;<span class="op" id="1540514">&gt;</span>&nbsp;<span class="num" id="1540516">3</span>&nbsp;<span class="op" id="1540518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1540522"><a href="/math/sin.go.html#1540170">sign</a></span>&nbsp;<span class="op" id="1540527">=</span>&nbsp;<span class="op" id="1540529">!</span><span class="ident" id="1540530"><a href="/math/sin.go.html#1540170">sign</a></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1540537"><a href="/math/sin.go.html#1540224">j</a></span>&nbsp;<span class="op" id="1540539">-=</span>&nbsp;<span class="num" id="1540542">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1540545">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1540549">z</span>&nbsp;<span class="op" id="1540551">:=</span>&nbsp;<span class="op" id="1540554">(</span><span class="op" id="1540555">(</span><span class="ident" id="1540556"><a href="/math/sin.go.html#1539608">x</a></span>&nbsp;<span class="op" id="1540558">-</span>&nbsp;<span class="ident" id="1540560"><a href="/math/sin.go.html#1540315">y</a></span><span class="op" id="1540561">*</span><span class="ident" id="1540562"><a href="/math/sin.go.html#1539640">PI4A</a></span><span class="op" id="1540566">)</span>&nbsp;<span class="op" id="1540568">-</span>&nbsp;<span class="ident" id="1540570"><a href="/math/sin.go.html#1540315">y</a></span><span class="op" id="1540571">*</span><span class="ident" id="1540572"><a href="/math/sin.go.html#1539754">PI4B</a></span><span class="op" id="1540576">)</span>&nbsp;<span class="op" id="1540578">-</span>&nbsp;<span class="ident" id="1540580"><a href="/math/sin.go.html#1540315">y</a></span><span class="op" id="1540581">*</span><span class="ident" id="1540582"><a href="/math/sin.go.html#1539840">PI4C</a></span>&nbsp;<span class="comment" id="1540587">//&nbsp;Extended&nbsp;precision&nbsp;modular&nbsp;arithmetic</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1540629">zz</span>&nbsp;<span class="op" id="1540632">:=</span>&nbsp;<span class="ident" id="1540635"><a href="/math/sin.go.html#1540549">z</a></span>&nbsp;<span class="op" id="1540637">*</span>&nbsp;<span class="ident" id="1540639"><a href="/math/sin.go.html#1540549">z</a></span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1540642">if</span>&nbsp;<span class="ident" id="1540645"><a href="/math/sin.go.html#1540224">j</a></span>&nbsp;<span class="op" id="1540647">==</span>&nbsp;<span class="num" id="1540650">1</span>&nbsp;<span class="op" id="1540652">||</span>&nbsp;<span class="ident" id="1540655"><a href="/math/sin.go.html#1540224">j</a></span>&nbsp;<span class="op" id="1540657">==</span>&nbsp;<span class="num" id="1540660">2</span>&nbsp;<span class="op" id="1540662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1540666"><a href="/math/sin.go.html#1540315">y</a></span>&nbsp;<span class="op" id="1540668">=</span>&nbsp;<span class="num" id="1540670">1.0</span>&nbsp;<span class="op" id="1540674">-</span>&nbsp;<span class="num" id="1540676">0.5</span><span class="op" id="1540679">*</span><span class="ident" id="1540680"><a href="/math/sin.go.html#1540629">zz</a></span>&nbsp;<span class="op" id="1540683">+</span>&nbsp;<span class="ident" id="1540685"><a href="/math/sin.go.html#1540629">zz</a></span><span class="op" id="1540687">*</span><span class="ident" id="1540688"><a href="/math/sin.go.html#1540629">zz</a></span><span class="op" id="1540690">*</span><span class="op" id="1540691">(</span><span class="op" id="1540692">(</span><span class="op" id="1540693">(</span><span class="op" id="1540694">(</span><span class="op" id="1540695">(</span><span class="op" id="1540696">(</span><span class="ident" id="1540697"><a href="/math/sin.go.html#1537725">_cos</a></span><span class="op" id="1540701">[</span><span class="num" id="1540702">0</span><span class="op" id="1540703">]</span><span class="op" id="1540704">*</span><span class="ident" id="1540705"><a href="/math/sin.go.html#1540629">zz</a></span><span class="op" id="1540707">)</span><span class="op" id="1540708">+</span><span class="ident" id="1540709"><a href="/math/sin.go.html#1537725">_cos</a></span><span class="op" id="1540713">[</span><span class="num" id="1540714">1</span><span class="op" id="1540715">]</span><span class="op" id="1540716">)</span><span class="op" id="1540717">*</span><span class="ident" id="1540718"><a href="/math/sin.go.html#1540629">zz</a></span><span class="op" id="1540720">+</span><span class="ident" id="1540721"><a href="/math/sin.go.html#1537725">_cos</a></span><span class="op" id="1540725">[</span><span class="num" id="1540726">2</span><span class="op" id="1540727">]</span><span class="op" id="1540728">)</span><span class="op" id="1540729">*</span><span class="ident" id="1540730"><a href="/math/sin.go.html#1540629">zz</a></span><span class="op" id="1540732">+</span><span class="ident" id="1540733"><a href="/math/sin.go.html#1537725">_cos</a></span><span class="op" id="1540737">[</span><span class="num" id="1540738">3</span><span class="op" id="1540739">]</span><span class="op" id="1540740">)</span><span class="op" id="1540741">*</span><span class="ident" id="1540742"><a href="/math/sin.go.html#1540629">zz</a></span><span class="op" id="1540744">+</span><span class="ident" id="1540745"><a href="/math/sin.go.html#1537725">_cos</a></span><span class="op" id="1540749">[</span><span class="num" id="1540750">4</span><span class="op" id="1540751">]</span><span class="op" id="1540752">)</span><span class="op" id="1540753">*</span><span class="ident" id="1540754"><a href="/math/sin.go.html#1540629">zz</a></span><span class="op" id="1540756">+</span><span class="ident" id="1540757"><a href="/math/sin.go.html#1537725">_cos</a></span><span class="op" id="1540761">[</span><span class="num" id="1540762">5</span><span class="op" id="1540763">]</span><span class="op" id="1540764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1540767">}</span>&nbsp;<span class="keyword" id="1540769">else</span>&nbsp;<span class="op" id="1540774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1540778"><a href="/math/sin.go.html#1540315">y</a></span>&nbsp;<span class="op" id="1540780">=</span>&nbsp;<span class="ident" id="1540782"><a href="/math/sin.go.html#1540549">z</a></span>&nbsp;<span class="op" id="1540784">+</span>&nbsp;<span class="ident" id="1540786"><a href="/math/sin.go.html#1540549">z</a></span><span class="op" id="1540787">*</span><span class="ident" id="1540788"><a href="/math/sin.go.html#1540629">zz</a></span><span class="op" id="1540790">*</span><span class="op" id="1540791">(</span><span class="op" id="1540792">(</span><span class="op" id="1540793">(</span><span class="op" id="1540794">(</span><span class="op" id="1540795">(</span><span class="op" id="1540796">(</span><span class="ident" id="1540797"><a href="/math/sin.go.html#1537371">_sin</a></span><span class="op" id="1540801">[</span><span class="num" id="1540802">0</span><span class="op" id="1540803">]</span><span class="op" id="1540804">*</span><span class="ident" id="1540805"><a href="/math/sin.go.html#1540629">zz</a></span><span class="op" id="1540807">)</span><span class="op" id="1540808">+</span><span class="ident" id="1540809"><a href="/math/sin.go.html#1537371">_sin</a></span><span class="op" id="1540813">[</span><span class="num" id="1540814">1</span><span class="op" id="1540815">]</span><span class="op" id="1540816">)</span><span class="op" id="1540817">*</span><span class="ident" id="1540818"><a href="/math/sin.go.html#1540629">zz</a></span><span class="op" id="1540820">+</span><span class="ident" id="1540821"><a href="/math/sin.go.html#1537371">_sin</a></span><span class="op" id="1540825">[</span><span class="num" id="1540826">2</span><span class="op" id="1540827">]</span><span class="op" id="1540828">)</span><span class="op" id="1540829">*</span><span class="ident" id="1540830"><a href="/math/sin.go.html#1540629">zz</a></span><span class="op" id="1540832">+</span><span class="ident" id="1540833"><a href="/math/sin.go.html#1537371">_sin</a></span><span class="op" id="1540837">[</span><span class="num" id="1540838">3</span><span class="op" id="1540839">]</span><span class="op" id="1540840">)</span><span class="op" id="1540841">*</span><span class="ident" id="1540842"><a href="/math/sin.go.html#1540629">zz</a></span><span class="op" id="1540844">+</span><span class="ident" id="1540845"><a href="/math/sin.go.html#1537371">_sin</a></span><span class="op" id="1540849">[</span><span class="num" id="1540850">4</span><span class="op" id="1540851">]</span><span class="op" id="1540852">)</span><span class="op" id="1540853">*</span><span class="ident" id="1540854"><a href="/math/sin.go.html#1540629">zz</a></span><span class="op" id="1540856">+</span><span class="ident" id="1540857"><a href="/math/sin.go.html#1537371">_sin</a></span><span class="op" id="1540861">[</span><span class="num" id="1540862">5</span><span class="op" id="1540863">]</span><span class="op" id="1540864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1540867">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1540870">if</span>&nbsp;<span class="ident" id="1540873"><a href="/math/sin.go.html#1540170">sign</a></span>&nbsp;<span class="op" id="1540878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1540882"><a href="/math/sin.go.html#1540315">y</a></span>&nbsp;<span class="op" id="1540884">=</span>&nbsp;<span class="op" id="1540886">-</span><span class="ident" id="1540887"><a href="/math/sin.go.html#1540315">y</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1540890">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1540893">return</span>&nbsp;<span class="ident" id="1540900"><a href="/math/sin.go.html#1540315">y</a></span><br>
<span class="lineno"></span><span class="op" id="1540902">}</span>
</div>
</body>
</html>
