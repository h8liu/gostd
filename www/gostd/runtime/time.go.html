<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>runtime</h2>
<ul>
<li><a href="/gostd/runtime/alg.go.html">alg.go</a></li>
<li><a href="/gostd/runtime/append_test.go.html">append_test.go</a></li>
<li><a href="/gostd/runtime/arch_amd64.go.html">arch_amd64.go</a></li>
<li><a href="/gostd/runtime/atomic.go.html">atomic.go</a></li>
<li><a href="/gostd/runtime/cgocall.go.html">cgocall.go</a></li>
<li><a href="/gostd/runtime/cgocallback.go.html">cgocallback.go</a></li>
<li><a href="/gostd/runtime/chan.go.html">chan.go</a></li>
<li><a href="/gostd/runtime/chan_test.go.html">chan_test.go</a></li>
<li><a href="/gostd/runtime/closure_test.go.html">closure_test.go</a></li>
<li><a href="/gostd/runtime/compiler.go.html">compiler.go</a></li>
<li><a href="/gostd/runtime/complex.go.html">complex.go</a></li>
<li><a href="/gostd/runtime/complex_test.go.html">complex_test.go</a></li>
<li><a href="/gostd/runtime/cpuprof.go.html">cpuprof.go</a></li>
<li><a href="/gostd/runtime/crash_test.go.html">crash_test.go</a></li>
<li><a href="/gostd/runtime/debug.go.html">debug.go</a></li>
<li><a href="/gostd/runtime/env_posix.go.html">env_posix.go</a></li>
<li><a href="/gostd/runtime/error.go.html">error.go</a></li>
<li><a href="/gostd/runtime/export_futex_test.go.html">export_futex_test.go</a></li>
<li><a href="/gostd/runtime/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/runtime/extern.go.html">extern.go</a></li>
<li><a href="/gostd/runtime/futex_test.go.html">futex_test.go</a></li>
<li><a href="/gostd/runtime/gc_test.go.html">gc_test.go</a></li>
<li><a href="/gostd/runtime/gcinfo_test.go.html">gcinfo_test.go</a></li>
<li><a href="/gostd/runtime/hash_test.go.html">hash_test.go</a></li>
<li><a href="/gostd/runtime/hashmap.go.html">hashmap.go</a></li>
<li><a href="/gostd/runtime/hashmap_fast.go.html">hashmap_fast.go</a></li>
<li><a href="/gostd/runtime/iface.go.html">iface.go</a></li>
<li><a href="/gostd/runtime/iface_test.go.html">iface_test.go</a></li>
<li><a href="/gostd/runtime/lfstack_test.go.html">lfstack_test.go</a></li>
<li><a href="/gostd/runtime/lock_futex.go.html">lock_futex.go</a></li>
<li><a href="/gostd/runtime/malloc.go.html">malloc.go</a></li>
<li><a href="/gostd/runtime/malloc_test.go.html">malloc_test.go</a></li>
<li><a href="/gostd/runtime/map_test.go.html">map_test.go</a></li>
<li><a href="/gostd/runtime/mapspeed_test.go.html">mapspeed_test.go</a></li>
<li><a href="/gostd/runtime/mem.go.html">mem.go</a></li>
<li><a href="/gostd/runtime/memmove_linux_amd64_test.go.html">memmove_linux_amd64_test.go</a></li>
<li><a href="/gostd/runtime/memmove_test.go.html">memmove_test.go</a></li>
<li><a href="/gostd/runtime/mfinal_test.go.html">mfinal_test.go</a></li>
<li><a href="/gostd/runtime/mgc0.go.html">mgc0.go</a></li>
<li><a href="/gostd/runtime/mprof.go.html">mprof.go</a></li>
<li><a href="/gostd/runtime/netpoll.go.html">netpoll.go</a></li>
<li><a href="/gostd/runtime/netpoll_epoll.go.html">netpoll_epoll.go</a></li>
<li><a href="/gostd/runtime/norace_test.go.html">norace_test.go</a></li>
<li><a href="/gostd/runtime/os_linux.go.html">os_linux.go</a></li>
<li><a href="/gostd/runtime/panic.go.html">panic.go</a></li>
<li><a href="/gostd/runtime/parfor_test.go.html">parfor_test.go</a></li>
<li><a href="/gostd/runtime/print1.go.html">print1.go</a></li>
<li><a href="/gostd/runtime/proc.go.html">proc.go</a></li>
<li><a href="/gostd/runtime/proc_test.go.html">proc_test.go</a></li>
<li><a href="/gostd/runtime/race0.go.html">race0.go</a></li>
<li><a href="/gostd/runtime/rdebug.go.html">rdebug.go</a></li>
<li><a href="/gostd/runtime/rune.go.html">rune.go</a></li>
<li><a href="/gostd/runtime/runtime.go.html">runtime.go</a></li>
<li><a href="/gostd/runtime/runtime_linux_test.go.html">runtime_linux_test.go</a></li>
<li><a href="/gostd/runtime/runtime_test.go.html">runtime_test.go</a></li>
<li><a href="/gostd/runtime/runtime_unix_test.go.html">runtime_unix_test.go</a></li>
<li><a href="/gostd/runtime/select.go.html">select.go</a></li>
<li><a href="/gostd/runtime/sema.go.html">sema.go</a></li>
<li><a href="/gostd/runtime/signal_unix.go.html">signal_unix.go</a></li>
<li><a href="/gostd/runtime/sigpanic_unix.go.html">sigpanic_unix.go</a></li>
<li><a href="/gostd/runtime/sigqueue.go.html">sigqueue.go</a></li>
<li><a href="/gostd/runtime/slice.go.html">slice.go</a></li>
<li><a href="/gostd/runtime/softfloat64.go.html">softfloat64.go</a></li>
<li><a href="/gostd/runtime/softfloat64_test.go.html">softfloat64_test.go</a></li>
<li><a href="/gostd/runtime/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/runtime/stack.go.html">stack.go</a></li>
<li><a href="/gostd/runtime/stack_test.go.html">stack_test.go</a></li>
<li><a href="/gostd/runtime/string.go.html">string.go</a></li>
<li><a href="/gostd/runtime/string_test.go.html">string_test.go</a></li>
<li><a href="/gostd/runtime/stubs.go.html">stubs.go</a></li>
<li><a href="/gostd/runtime/symtab.go.html">symtab.go</a></li>
<li><a href="/gostd/runtime/symtab_test.go.html">symtab_test.go</a></li>
<li><a href="/gostd/runtime/time.go.html" class="current">time.go</a></li>
<li><a href="/gostd/runtime/traceback.go.html">traceback.go</a></li>
<li><a href="/gostd/runtime/typekind.go.html">typekind.go</a></li>
<li><a href="/gostd/runtime/zgoarch_amd64.go.html">zgoarch_amd64.go</a></li>
<li><a href="/gostd/runtime/zgoos_linux.go.html">zgoos_linux.go</a></li>
<li><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html">zruntime_defs_linux_amd64.go</a></li>
<li><a href="/gostd/runtime/zversion.go.html">zversion.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1721884">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1721939">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1721993">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1722044">//&nbsp;Time-related&nbsp;runtime&nbsp;and&nbsp;pieces&nbsp;of&nbsp;package&nbsp;time.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1722097">package</span>&nbsp;<span class="ident" id="1722105">runtime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1722114">import</span>&nbsp;<span class="string" id="1722121">&#34;unsafe&#34;</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="1722131">//&nbsp;Package&nbsp;time&nbsp;knows&nbsp;the&nbsp;layout&nbsp;of&nbsp;this&nbsp;structure.</span><br>
<span class="lineno"></span><span class="comment" id="1722183">//&nbsp;If&nbsp;this&nbsp;struct&nbsp;changes,&nbsp;adjust&nbsp;../time/sleep.go:/runtimeTimer.</span><br>
<span class="lineno"></span><span class="comment" id="1722249">//&nbsp;For&nbsp;GOOS=nacl,&nbsp;package&nbsp;syscall&nbsp;knows&nbsp;the&nbsp;layout&nbsp;of&nbsp;this&nbsp;structure.</span><br>
<span class="lineno"></span><span class="comment" id="1722319">//&nbsp;If&nbsp;this&nbsp;struct&nbsp;changes,&nbsp;adjust&nbsp;../syscall/net_nacl.go:/runtimeTimer.</span><br>
<span class="lineno">15</span><span class="keyword" id="1722391">type</span>&nbsp;<span class="ident" id="1722396">timer</span>&nbsp;<span class="keyword" id="1722402">struct</span>&nbsp;<span class="op" id="1722409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1722412">i</span>&nbsp;<span class="builtintype" id="1722414">int</span>&nbsp;<span class="comment" id="1722418">//&nbsp;heap&nbsp;index</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1722434">//&nbsp;Timer&nbsp;wakes&nbsp;up&nbsp;at&nbsp;when,&nbsp;and&nbsp;then&nbsp;at&nbsp;when+period,&nbsp;...&nbsp;(period&nbsp;&gt;&nbsp;0&nbsp;only)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1722509">//&nbsp;each&nbsp;time&nbsp;calling&nbsp;f(now,&nbsp;arg)&nbsp;in&nbsp;the&nbsp;timer&nbsp;goroutine,&nbsp;so&nbsp;f&nbsp;must&nbsp;be</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1722580">//&nbsp;a&nbsp;well-behaved&nbsp;function&nbsp;and&nbsp;not&nbsp;block.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1722623">when</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="1722630">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1722637">period</span>&nbsp;<span class="ident" id="1722644">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1722651">f</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1722658">func</span><span class="op" id="1722662">(</span><span class="keyword" id="1722663">interface</span><span class="op" id="1722672">{</span><span class="op" id="1722673">}</span><span class="op" id="1722674">,</span>&nbsp;<span class="builtintype" id="1722676">uintptr</span><span class="op" id="1722683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1722686">arg</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1722693">interface</span><span class="op" id="1722702">{</span><span class="op" id="1722703">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1722706">seq</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1722713">uintptr</span><br>
<span class="lineno"></span><span class="op" id="1722721">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1722724">var</span>&nbsp;<span class="ident" id="1722728">timers</span>&nbsp;<span class="keyword" id="1722735">struct</span>&nbsp;<span class="op" id="1722742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1722745">lock</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1722758">mutex</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1722765">gp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1722778">*</span><span class="ident" id="1722779">g</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1722782">created</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1722795">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1722801">sleeping</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1722814">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1722820">rescheduling</span>&nbsp;<span class="builtintype" id="1722833">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1722839">waitnote</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1722852">note</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1722858">t</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1722871">[</span><span class="op" id="1722872">]</span><span class="op" id="1722873">*</span><span class="ident" id="1722874">timer</span><br>
<span class="lineno"></span><span class="op" id="1722880">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1722883">//&nbsp;nacl&nbsp;fake&nbsp;time&nbsp;support&nbsp;-&nbsp;time&nbsp;in&nbsp;nanoseconds&nbsp;since&nbsp;1970</span><br>
<span class="lineno"></span><span class="keyword" id="1722942">var</span>&nbsp;<span class="ident" id="1722946">faketime</span>&nbsp;<span class="ident" id="1722955">int64</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="1722962">//&nbsp;Package&nbsp;time&nbsp;APIs.</span><br>
<span class="lineno"></span><span class="comment" id="1722984">//&nbsp;Godoc&nbsp;uses&nbsp;the&nbsp;comments&nbsp;in&nbsp;package&nbsp;time,&nbsp;not&nbsp;these.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1723040">//&nbsp;time.now&nbsp;is&nbsp;implemented&nbsp;in&nbsp;assembly.</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="comment" id="1723081">//&nbsp;Sleep&nbsp;puts&nbsp;the&nbsp;current&nbsp;goroutine&nbsp;to&nbsp;sleep&nbsp;for&nbsp;at&nbsp;least&nbsp;ns&nbsp;nanoseconds.</span><br>
<span class="lineno"></span><span class="keyword" id="1723155">func</span>&nbsp;<span class="ident" id="1723160">timeSleep</span><span class="op" id="1723169">(</span><span class="ident" id="1723170">ns</span>&nbsp;<span class="ident" id="1723173">int64</span><span class="op" id="1723178">)</span>&nbsp;<span class="op" id="1723180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1723183">if</span>&nbsp;<span class="ident" id="1723186">ns</span>&nbsp;<span class="op" id="1723189">&lt;=</span>&nbsp;<span class="num" id="1723192">0</span>&nbsp;<span class="op" id="1723194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1723198">return</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1723206">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1723210">t</span>&nbsp;<span class="op" id="1723212">:=</span>&nbsp;<span class="builtinfunc" id="1723215">new</span><span class="op" id="1723218">(</span><span class="ident" id="1723219">timer</span><span class="op" id="1723224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1723227">t</span><span class="op" id="1723228">.</span><span class="ident" id="1723229">when</span>&nbsp;<span class="op" id="1723234">=</span>&nbsp;<span class="ident" id="1723236">nanotime</span><span class="op" id="1723244">(</span><span class="op" id="1723245">)</span>&nbsp;<span class="op" id="1723247">+</span>&nbsp;<span class="ident" id="1723249">ns</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1723253">t</span><span class="op" id="1723254">.</span><span class="ident" id="1723255">f</span>&nbsp;<span class="op" id="1723257">=</span>&nbsp;<span class="ident" id="1723259">goroutineReady</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1723275">t</span><span class="op" id="1723276">.</span><span class="ident" id="1723277">arg</span>&nbsp;<span class="op" id="1723281">=</span>&nbsp;<span class="ident" id="1723283">getg</span><span class="op" id="1723287">(</span><span class="op" id="1723288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1723291">lock</span><span class="op" id="1723295">(</span><span class="op" id="1723296">&amp;</span><span class="ident" id="1723297">timers</span><span class="op" id="1723303">.</span><span class="ident" id="1723304">lock</span><span class="op" id="1723308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1723311">addtimerLocked</span><span class="op" id="1723325">(</span><span class="ident" id="1723326">t</span><span class="op" id="1723327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1723330">goparkunlock</span><span class="op" id="1723342">(</span><span class="op" id="1723343">&amp;</span><span class="ident" id="1723344">timers</span><span class="op" id="1723350">.</span><span class="ident" id="1723351">lock</span><span class="op" id="1723355">,</span>&nbsp;<span class="string" id="1723357">&#34;sleep&#34;</span><span class="op" id="1723364">)</span><br>
<span class="lineno"></span><span class="op" id="1723366">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="1723369">//&nbsp;startTimer&nbsp;adds&nbsp;t&nbsp;to&nbsp;the&nbsp;timer&nbsp;heap.</span><br>
<span class="lineno"></span><span class="keyword" id="1723409">func</span>&nbsp;<span class="ident" id="1723414">startTimer</span><span class="op" id="1723424">(</span><span class="ident" id="1723425">t</span>&nbsp;<span class="op" id="1723427">*</span><span class="ident" id="1723428">timer</span><span class="op" id="1723433">)</span>&nbsp;<span class="op" id="1723435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1723438">if</span>&nbsp;<span class="ident" id="1723441">raceenabled</span>&nbsp;<span class="op" id="1723453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1723457">racerelease</span><span class="op" id="1723468">(</span><span class="ident" id="1723469">unsafe</span><span class="op" id="1723475">.</span><span class="ident" id="1723476">Pointer</span><span class="op" id="1723483">(</span><span class="ident" id="1723484">t</span><span class="op" id="1723485">)</span><span class="op" id="1723486">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1723489">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1723492">addtimer</span><span class="op" id="1723500">(</span><span class="ident" id="1723501">t</span><span class="op" id="1723502">)</span><br>
<span class="lineno"></span><span class="op" id="1723504">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1723507">//&nbsp;stopTimer&nbsp;removes&nbsp;t&nbsp;from&nbsp;the&nbsp;timer&nbsp;heap&nbsp;if&nbsp;it&nbsp;is&nbsp;there.</span><br>
<span class="lineno">70</span><span class="comment" id="1723566">//&nbsp;It&nbsp;returns&nbsp;true&nbsp;if&nbsp;t&nbsp;was&nbsp;removed,&nbsp;false&nbsp;if&nbsp;t&nbsp;wasn&#39;t&nbsp;even&nbsp;there.</span><br>
<span class="lineno"></span><span class="keyword" id="1723633">func</span>&nbsp;<span class="ident" id="1723638">stopTimer</span><span class="op" id="1723647">(</span><span class="ident" id="1723648">t</span>&nbsp;<span class="op" id="1723650">*</span><span class="ident" id="1723651">timer</span><span class="op" id="1723656">)</span>&nbsp;<span class="builtintype" id="1723658">bool</span>&nbsp;<span class="op" id="1723663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1723666">return</span>&nbsp;<span class="ident" id="1723673">deltimer</span><span class="op" id="1723681">(</span><span class="ident" id="1723682">t</span><span class="op" id="1723683">)</span><br>
<span class="lineno"></span><span class="op" id="1723685">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="1723688">//&nbsp;Go&nbsp;runtime.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1723704">//&nbsp;Ready&nbsp;the&nbsp;goroutine&nbsp;arg.</span><br>
<span class="lineno"></span><span class="keyword" id="1723732">func</span>&nbsp;<span class="ident" id="1723737">goroutineReady</span><span class="op" id="1723751">(</span><span class="ident" id="1723752">arg</span>&nbsp;<span class="keyword" id="1723756">interface</span><span class="op" id="1723765">{</span><span class="op" id="1723766">}</span><span class="op" id="1723767">,</span>&nbsp;<span class="ident" id="1723769">seq</span>&nbsp;<span class="builtintype" id="1723773">uintptr</span><span class="op" id="1723780">)</span>&nbsp;<span class="op" id="1723782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1723785">goready</span><span class="op" id="1723792">(</span><span class="ident" id="1723793">arg</span><span class="op" id="1723796">.</span><span class="op" id="1723797">(</span><span class="op" id="1723798">*</span><span class="ident" id="1723799">g</span><span class="op" id="1723800">)</span><span class="op" id="1723801">)</span><br>
<span class="lineno">80</span><span class="op" id="1723803">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1723806">func</span>&nbsp;<span class="ident" id="1723811">addtimer</span><span class="op" id="1723819">(</span><span class="ident" id="1723820">t</span>&nbsp;<span class="op" id="1723822">*</span><span class="ident" id="1723823">timer</span><span class="op" id="1723828">)</span>&nbsp;<span class="op" id="1723830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1723833">lock</span><span class="op" id="1723837">(</span><span class="op" id="1723838">&amp;</span><span class="ident" id="1723839">timers</span><span class="op" id="1723845">.</span><span class="ident" id="1723846">lock</span><span class="op" id="1723850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1723853">addtimerLocked</span><span class="op" id="1723867">(</span><span class="ident" id="1723868">t</span><span class="op" id="1723869">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1723872">unlock</span><span class="op" id="1723878">(</span><span class="op" id="1723879">&amp;</span><span class="ident" id="1723880">timers</span><span class="op" id="1723886">.</span><span class="ident" id="1723887">lock</span><span class="op" id="1723891">)</span><br>
<span class="lineno"></span><span class="op" id="1723893">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1723896">//&nbsp;Add&nbsp;a&nbsp;timer&nbsp;to&nbsp;the&nbsp;heap&nbsp;and&nbsp;start&nbsp;or&nbsp;kick&nbsp;the&nbsp;timer&nbsp;proc.</span><br>
<span class="lineno"></span><span class="comment" id="1723957">//&nbsp;If&nbsp;the&nbsp;new&nbsp;timer&nbsp;is&nbsp;earlier&nbsp;than&nbsp;any&nbsp;of&nbsp;the&nbsp;others.</span><br>
<span class="lineno">90</span><span class="comment" id="1724012">//&nbsp;Timers&nbsp;are&nbsp;locked.</span><br>
<span class="lineno"></span><span class="keyword" id="1724034">func</span>&nbsp;<span class="ident" id="1724039">addtimerLocked</span><span class="op" id="1724053">(</span><span class="ident" id="1724054">t</span>&nbsp;<span class="op" id="1724056">*</span><span class="ident" id="1724057">timer</span><span class="op" id="1724062">)</span>&nbsp;<span class="op" id="1724064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1724067">//&nbsp;when&nbsp;must&nbsp;never&nbsp;be&nbsp;negative;&nbsp;otherwise&nbsp;timerproc&nbsp;will&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1724134">//&nbsp;during&nbsp;its&nbsp;delta&nbsp;calculation&nbsp;and&nbsp;never&nbsp;expire&nbsp;other&nbsp;runtime·timers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1724207">if</span>&nbsp;<span class="ident" id="1724210">t</span><span class="op" id="1724211">.</span><span class="ident" id="1724212">when</span>&nbsp;<span class="op" id="1724217">&lt;</span>&nbsp;<span class="num" id="1724219">0</span>&nbsp;<span class="op" id="1724221">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1724225">t</span><span class="op" id="1724226">.</span><span class="ident" id="1724227">when</span>&nbsp;<span class="op" id="1724232">=</span>&nbsp;<span class="num" id="1724234">1</span><span class="op" id="1724235">&lt;&lt;</span><span class="num" id="1724237">63</span>&nbsp;<span class="op" id="1724240">-</span>&nbsp;<span class="num" id="1724242">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1724245">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1724248">t</span><span class="op" id="1724249">.</span><span class="ident" id="1724250">i</span>&nbsp;<span class="op" id="1724252">=</span>&nbsp;<span class="builtinfunc" id="1724254">len</span><span class="op" id="1724257">(</span><span class="ident" id="1724258">timers</span><span class="op" id="1724264">.</span><span class="ident" id="1724265">t</span><span class="op" id="1724266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1724269">timers</span><span class="op" id="1724275">.</span><span class="ident" id="1724276">t</span>&nbsp;<span class="op" id="1724278">=</span>&nbsp;<span class="builtinfunc" id="1724280">append</span><span class="op" id="1724286">(</span><span class="ident" id="1724287">timers</span><span class="op" id="1724293">.</span><span class="ident" id="1724294">t</span><span class="op" id="1724295">,</span>&nbsp;<span class="ident" id="1724297">t</span><span class="op" id="1724298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1724301">siftupTimer</span><span class="op" id="1724312">(</span><span class="ident" id="1724313">t</span><span class="op" id="1724314">.</span><span class="ident" id="1724315">i</span><span class="op" id="1724316">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1724319">if</span>&nbsp;<span class="ident" id="1724322">t</span><span class="op" id="1724323">.</span><span class="ident" id="1724324">i</span>&nbsp;<span class="op" id="1724326">==</span>&nbsp;<span class="num" id="1724329">0</span>&nbsp;<span class="op" id="1724331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1724335">//&nbsp;siftup&nbsp;moved&nbsp;to&nbsp;top:&nbsp;new&nbsp;earliest&nbsp;deadline.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1724384">if</span>&nbsp;<span class="ident" id="1724387">timers</span><span class="op" id="1724393">.</span><span class="ident" id="1724394">sleeping</span>&nbsp;<span class="op" id="1724403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1724408">timers</span><span class="op" id="1724414">.</span><span class="ident" id="1724415">sleeping</span>&nbsp;<span class="op" id="1724424">=</span>&nbsp;<span class="builtintype" id="1724426">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1724435">notewakeup</span><span class="op" id="1724445">(</span><span class="op" id="1724446">&amp;</span><span class="ident" id="1724447">timers</span><span class="op" id="1724453">.</span><span class="ident" id="1724454">waitnote</span><span class="op" id="1724462">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1724466">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1724470">if</span>&nbsp;<span class="ident" id="1724473">timers</span><span class="op" id="1724479">.</span><span class="ident" id="1724480">rescheduling</span>&nbsp;<span class="op" id="1724493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1724498">timers</span><span class="op" id="1724504">.</span><span class="ident" id="1724505">rescheduling</span>&nbsp;<span class="op" id="1724518">=</span>&nbsp;<span class="builtintype" id="1724520">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1724529">goready</span><span class="op" id="1724536">(</span><span class="ident" id="1724537">timers</span><span class="op" id="1724543">.</span><span class="ident" id="1724544">gp</span><span class="op" id="1724546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1724550">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1724553">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1724556">if</span>&nbsp;<span class="op" id="1724559">!</span><span class="ident" id="1724560">timers</span><span class="op" id="1724566">.</span><span class="ident" id="1724567">created</span>&nbsp;<span class="op" id="1724575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1724579">timers</span><span class="op" id="1724585">.</span><span class="ident" id="1724586">created</span>&nbsp;<span class="op" id="1724594">=</span>&nbsp;<span class="builtintype" id="1724596">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1724603">go</span>&nbsp;<span class="ident" id="1724606">timerproc</span><span class="op" id="1724615">(</span><span class="op" id="1724616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1724619">}</span><br>
<span class="lineno">115</span><span class="op" id="1724621">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1724624">//&nbsp;Delete&nbsp;timer&nbsp;t&nbsp;from&nbsp;the&nbsp;heap.</span><br>
<span class="lineno"></span><span class="comment" id="1724657">//&nbsp;Do&nbsp;not&nbsp;need&nbsp;to&nbsp;update&nbsp;the&nbsp;timerproc:&nbsp;if&nbsp;it&nbsp;wakes&nbsp;up&nbsp;early,&nbsp;no&nbsp;big&nbsp;deal.</span><br>
<span class="lineno"></span><span class="keyword" id="1724732">func</span>&nbsp;<span class="ident" id="1724737">deltimer</span><span class="op" id="1724745">(</span><span class="ident" id="1724746">t</span>&nbsp;<span class="op" id="1724748">*</span><span class="ident" id="1724749">timer</span><span class="op" id="1724754">)</span>&nbsp;<span class="builtintype" id="1724756">bool</span>&nbsp;<span class="op" id="1724761">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1724764">//&nbsp;Dereference&nbsp;t&nbsp;so&nbsp;that&nbsp;any&nbsp;panic&nbsp;happens&nbsp;before&nbsp;the&nbsp;lock&nbsp;is&nbsp;held.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1724833">//&nbsp;Discard&nbsp;result,&nbsp;because&nbsp;t&nbsp;might&nbsp;be&nbsp;moving&nbsp;in&nbsp;the&nbsp;heap.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1724892">_</span>&nbsp;<span class="op" id="1724894">=</span>&nbsp;<span class="ident" id="1724896">t</span><span class="op" id="1724897">.</span><span class="ident" id="1724898">i</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1724902">lock</span><span class="op" id="1724906">(</span><span class="op" id="1724907">&amp;</span><span class="ident" id="1724908">timers</span><span class="op" id="1724914">.</span><span class="ident" id="1724915">lock</span><span class="op" id="1724919">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1724922">//&nbsp;t&nbsp;may&nbsp;not&nbsp;be&nbsp;registered&nbsp;anymore&nbsp;and&nbsp;may&nbsp;have</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1724971">//&nbsp;a&nbsp;bogus&nbsp;i&nbsp;(typically&nbsp;0,&nbsp;if&nbsp;generated&nbsp;by&nbsp;Go).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1725020">//&nbsp;Verify&nbsp;it&nbsp;before&nbsp;proceeding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1725053">i</span>&nbsp;<span class="op" id="1725055">:=</span>&nbsp;<span class="ident" id="1725058">t</span><span class="op" id="1725059">.</span><span class="ident" id="1725060">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1725063">last</span>&nbsp;<span class="op" id="1725068">:=</span>&nbsp;<span class="builtinfunc" id="1725071">len</span><span class="op" id="1725074">(</span><span class="ident" id="1725075">timers</span><span class="op" id="1725081">.</span><span class="ident" id="1725082">t</span><span class="op" id="1725083">)</span>&nbsp;<span class="op" id="1725085">-</span>&nbsp;<span class="num" id="1725087">1</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1725090">if</span>&nbsp;<span class="ident" id="1725093">i</span>&nbsp;<span class="op" id="1725095">&lt;</span>&nbsp;<span class="num" id="1725097">0</span>&nbsp;<span class="op" id="1725099">||</span>&nbsp;<span class="ident" id="1725102">i</span>&nbsp;<span class="op" id="1725104">&gt;</span>&nbsp;<span class="ident" id="1725106">last</span>&nbsp;<span class="op" id="1725111">||</span>&nbsp;<span class="ident" id="1725114">timers</span><span class="op" id="1725120">.</span><span class="ident" id="1725121">t</span><span class="op" id="1725122">[</span><span class="ident" id="1725123">i</span><span class="op" id="1725124">]</span>&nbsp;<span class="op" id="1725126">!=</span>&nbsp;<span class="ident" id="1725129">t</span>&nbsp;<span class="op" id="1725131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1725135">unlock</span><span class="op" id="1725141">(</span><span class="op" id="1725142">&amp;</span><span class="ident" id="1725143">timers</span><span class="op" id="1725149">.</span><span class="ident" id="1725150">lock</span><span class="op" id="1725154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1725158">return</span>&nbsp;<span class="builtintype" id="1725165">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1725172">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1725175">if</span>&nbsp;<span class="ident" id="1725178">i</span>&nbsp;<span class="op" id="1725180">!=</span>&nbsp;<span class="ident" id="1725183">last</span>&nbsp;<span class="op" id="1725188">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1725192">timers</span><span class="op" id="1725198">.</span><span class="ident" id="1725199">t</span><span class="op" id="1725200">[</span><span class="ident" id="1725201">i</span><span class="op" id="1725202">]</span>&nbsp;<span class="op" id="1725204">=</span>&nbsp;<span class="ident" id="1725206">timers</span><span class="op" id="1725212">.</span><span class="ident" id="1725213">t</span><span class="op" id="1725214">[</span><span class="ident" id="1725215">last</span><span class="op" id="1725219">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1725223">timers</span><span class="op" id="1725229">.</span><span class="ident" id="1725230">t</span><span class="op" id="1725231">[</span><span class="ident" id="1725232">i</span><span class="op" id="1725233">]</span><span class="op" id="1725234">.</span><span class="ident" id="1725235">i</span>&nbsp;<span class="op" id="1725237">=</span>&nbsp;<span class="ident" id="1725239">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1725242">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1725245">timers</span><span class="op" id="1725251">.</span><span class="ident" id="1725252">t</span><span class="op" id="1725253">[</span><span class="ident" id="1725254">last</span><span class="op" id="1725258">]</span>&nbsp;<span class="op" id="1725260">=</span>&nbsp;<span class="builtintype" id="1725262">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1725267">timers</span><span class="op" id="1725273">.</span><span class="ident" id="1725274">t</span>&nbsp;<span class="op" id="1725276">=</span>&nbsp;<span class="ident" id="1725278">timers</span><span class="op" id="1725284">.</span><span class="ident" id="1725285">t</span><span class="op" id="1725286">[</span><span class="op" id="1725287">:</span><span class="ident" id="1725288">last</span><span class="op" id="1725292">]</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1725295">if</span>&nbsp;<span class="ident" id="1725298">i</span>&nbsp;<span class="op" id="1725300">!=</span>&nbsp;<span class="ident" id="1725303">last</span>&nbsp;<span class="op" id="1725308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1725312">siftupTimer</span><span class="op" id="1725323">(</span><span class="ident" id="1725324">i</span><span class="op" id="1725325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1725329">siftdownTimer</span><span class="op" id="1725342">(</span><span class="ident" id="1725343">i</span><span class="op" id="1725344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1725347">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1725350">unlock</span><span class="op" id="1725356">(</span><span class="op" id="1725357">&amp;</span><span class="ident" id="1725358">timers</span><span class="op" id="1725364">.</span><span class="ident" id="1725365">lock</span><span class="op" id="1725369">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1725372">return</span>&nbsp;<span class="builtintype" id="1725379">true</span><br>
<span class="lineno"></span><span class="op" id="1725384">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1725387">//&nbsp;Timerproc&nbsp;runs&nbsp;the&nbsp;time-driven&nbsp;events.</span><br>
<span class="lineno"></span><span class="comment" id="1725429">//&nbsp;It&nbsp;sleeps&nbsp;until&nbsp;the&nbsp;next&nbsp;event&nbsp;in&nbsp;the&nbsp;timers&nbsp;heap.</span><br>
<span class="lineno">150</span><span class="comment" id="1725483">//&nbsp;If&nbsp;addtimer&nbsp;inserts&nbsp;a&nbsp;new&nbsp;earlier&nbsp;event,&nbsp;addtimer1&nbsp;wakes&nbsp;timerproc&nbsp;early.</span><br>
<span class="lineno"></span><span class="keyword" id="1725560">func</span>&nbsp;<span class="ident" id="1725565">timerproc</span><span class="op" id="1725574">(</span><span class="op" id="1725575">)</span>&nbsp;<span class="op" id="1725577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1725580">timers</span><span class="op" id="1725586">.</span><span class="ident" id="1725587">gp</span>&nbsp;<span class="op" id="1725590">=</span>&nbsp;<span class="ident" id="1725592">getg</span><span class="op" id="1725596">(</span><span class="op" id="1725597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1725600">timers</span><span class="op" id="1725606">.</span><span class="ident" id="1725607">gp</span><span class="op" id="1725609">.</span><span class="ident" id="1725610">issystem</span>&nbsp;<span class="op" id="1725619">=</span>&nbsp;<span class="builtintype" id="1725621">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1725627">for</span>&nbsp;<span class="op" id="1725631">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1725635">lock</span><span class="op" id="1725639">(</span><span class="op" id="1725640">&amp;</span><span class="ident" id="1725641">timers</span><span class="op" id="1725647">.</span><span class="ident" id="1725648">lock</span><span class="op" id="1725652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1725656">timers</span><span class="op" id="1725662">.</span><span class="ident" id="1725663">sleeping</span>&nbsp;<span class="op" id="1725672">=</span>&nbsp;<span class="builtintype" id="1725674">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1725682">now</span>&nbsp;<span class="op" id="1725686">:=</span>&nbsp;<span class="ident" id="1725689">nanotime</span><span class="op" id="1725697">(</span><span class="op" id="1725698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1725702">delta</span>&nbsp;<span class="op" id="1725708">:=</span>&nbsp;<span class="ident" id="1725711">int64</span><span class="op" id="1725716">(</span><span class="op" id="1725717">-</span><span class="num" id="1725718">1</span><span class="op" id="1725719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1725723">for</span>&nbsp;<span class="op" id="1725727">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1725732">if</span>&nbsp;<span class="builtinfunc" id="1725735">len</span><span class="op" id="1725738">(</span><span class="ident" id="1725739">timers</span><span class="op" id="1725745">.</span><span class="ident" id="1725746">t</span><span class="op" id="1725747">)</span>&nbsp;<span class="op" id="1725749">==</span>&nbsp;<span class="num" id="1725752">0</span>&nbsp;<span class="op" id="1725754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1725760">delta</span>&nbsp;<span class="op" id="1725766">=</span>&nbsp;<span class="op" id="1725768">-</span><span class="num" id="1725769">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1725775">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1725784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1725789">t</span>&nbsp;<span class="op" id="1725791">:=</span>&nbsp;<span class="ident" id="1725794">timers</span><span class="op" id="1725800">.</span><span class="ident" id="1725801">t</span><span class="op" id="1725802">[</span><span class="num" id="1725803">0</span><span class="op" id="1725804">]</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1725809">delta</span>&nbsp;<span class="op" id="1725815">=</span>&nbsp;<span class="ident" id="1725817">t</span><span class="op" id="1725818">.</span><span class="ident" id="1725819">when</span>&nbsp;<span class="op" id="1725824">-</span>&nbsp;<span class="ident" id="1725826">now</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1725833">if</span>&nbsp;<span class="ident" id="1725836">delta</span>&nbsp;<span class="op" id="1725842">&gt;</span>&nbsp;<span class="num" id="1725844">0</span>&nbsp;<span class="op" id="1725846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1725852">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1725861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1725866">if</span>&nbsp;<span class="ident" id="1725869">t</span><span class="op" id="1725870">.</span><span class="ident" id="1725871">period</span>&nbsp;<span class="op" id="1725878">&gt;</span>&nbsp;<span class="num" id="1725880">0</span>&nbsp;<span class="op" id="1725882">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1725888">//&nbsp;leave&nbsp;in&nbsp;heap&nbsp;but&nbsp;adjust&nbsp;next&nbsp;time&nbsp;to&nbsp;fire</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1725938">t</span><span class="op" id="1725939">.</span><span class="ident" id="1725940">when</span>&nbsp;<span class="op" id="1725945">+=</span>&nbsp;<span class="ident" id="1725948">t</span><span class="op" id="1725949">.</span><span class="ident" id="1725950">period</span>&nbsp;<span class="op" id="1725957">*</span>&nbsp;<span class="op" id="1725959">(</span><span class="num" id="1725960">1</span>&nbsp;<span class="op" id="1725962">+</span>&nbsp;<span class="op" id="1725964">-</span><span class="ident" id="1725965">delta</span><span class="op" id="1725970">/</span><span class="ident" id="1725971">t</span><span class="op" id="1725972">.</span><span class="ident" id="1725973">period</span><span class="op" id="1725979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1725985">siftdownTimer</span><span class="op" id="1725998">(</span><span class="num" id="1725999">0</span><span class="op" id="1726000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1726005">}</span>&nbsp;<span class="keyword" id="1726007">else</span>&nbsp;<span class="op" id="1726012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1726018">//&nbsp;remove&nbsp;from&nbsp;heap</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1726042">last</span>&nbsp;<span class="op" id="1726047">:=</span>&nbsp;<span class="builtinfunc" id="1726050">len</span><span class="op" id="1726053">(</span><span class="ident" id="1726054">timers</span><span class="op" id="1726060">.</span><span class="ident" id="1726061">t</span><span class="op" id="1726062">)</span>&nbsp;<span class="op" id="1726064">-</span>&nbsp;<span class="num" id="1726066">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1726072">if</span>&nbsp;<span class="ident" id="1726075">last</span>&nbsp;<span class="op" id="1726080">&gt;</span>&nbsp;<span class="num" id="1726082">0</span>&nbsp;<span class="op" id="1726084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1726091">timers</span><span class="op" id="1726097">.</span><span class="ident" id="1726098">t</span><span class="op" id="1726099">[</span><span class="num" id="1726100">0</span><span class="op" id="1726101">]</span>&nbsp;<span class="op" id="1726103">=</span>&nbsp;<span class="ident" id="1726105">timers</span><span class="op" id="1726111">.</span><span class="ident" id="1726112">t</span><span class="op" id="1726113">[</span><span class="ident" id="1726114">last</span><span class="op" id="1726118">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1726125">timers</span><span class="op" id="1726131">.</span><span class="ident" id="1726132">t</span><span class="op" id="1726133">[</span><span class="num" id="1726134">0</span><span class="op" id="1726135">]</span><span class="op" id="1726136">.</span><span class="ident" id="1726137">i</span>&nbsp;<span class="op" id="1726139">=</span>&nbsp;<span class="num" id="1726141">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1726147">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1726153">timers</span><span class="op" id="1726159">.</span><span class="ident" id="1726160">t</span><span class="op" id="1726161">[</span><span class="ident" id="1726162">last</span><span class="op" id="1726166">]</span>&nbsp;<span class="op" id="1726168">=</span>&nbsp;<span class="builtintype" id="1726170">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1726178">timers</span><span class="op" id="1726184">.</span><span class="ident" id="1726185">t</span>&nbsp;<span class="op" id="1726187">=</span>&nbsp;<span class="ident" id="1726189">timers</span><span class="op" id="1726195">.</span><span class="ident" id="1726196">t</span><span class="op" id="1726197">[</span><span class="op" id="1726198">:</span><span class="ident" id="1726199">last</span><span class="op" id="1726203">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1726209">if</span>&nbsp;<span class="ident" id="1726212">last</span>&nbsp;<span class="op" id="1726217">&gt;</span>&nbsp;<span class="num" id="1726219">0</span>&nbsp;<span class="op" id="1726221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1726228">siftdownTimer</span><span class="op" id="1726241">(</span><span class="num" id="1726242">0</span><span class="op" id="1726243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1726249">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1726255">t</span><span class="op" id="1726256">.</span><span class="ident" id="1726257">i</span>&nbsp;<span class="op" id="1726259">=</span>&nbsp;<span class="op" id="1726261">-</span><span class="num" id="1726262">1</span>&nbsp;<span class="comment" id="1726264">//&nbsp;mark&nbsp;as&nbsp;removed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1726286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1726291">f</span>&nbsp;<span class="op" id="1726293">:=</span>&nbsp;<span class="ident" id="1726296">t</span><span class="op" id="1726297">.</span><span class="ident" id="1726298">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1726303">arg</span>&nbsp;<span class="op" id="1726307">:=</span>&nbsp;<span class="ident" id="1726310">t</span><span class="op" id="1726311">.</span><span class="ident" id="1726312">arg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1726319">seq</span>&nbsp;<span class="op" id="1726323">:=</span>&nbsp;<span class="ident" id="1726326">t</span><span class="op" id="1726327">.</span><span class="ident" id="1726328">seq</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1726335">unlock</span><span class="op" id="1726341">(</span><span class="op" id="1726342">&amp;</span><span class="ident" id="1726343">timers</span><span class="op" id="1726349">.</span><span class="ident" id="1726350">lock</span><span class="op" id="1726354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1726359">if</span>&nbsp;<span class="ident" id="1726362">raceenabled</span>&nbsp;<span class="op" id="1726374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1726380">raceacquire</span><span class="op" id="1726391">(</span><span class="ident" id="1726392">unsafe</span><span class="op" id="1726398">.</span><span class="ident" id="1726399">Pointer</span><span class="op" id="1726406">(</span><span class="ident" id="1726407">t</span><span class="op" id="1726408">)</span><span class="op" id="1726409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1726414">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1726419">f</span><span class="op" id="1726420">(</span><span class="ident" id="1726421">arg</span><span class="op" id="1726424">,</span>&nbsp;<span class="ident" id="1726426">seq</span><span class="op" id="1726429">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1726434">lock</span><span class="op" id="1726438">(</span><span class="op" id="1726439">&amp;</span><span class="ident" id="1726440">timers</span><span class="op" id="1726446">.</span><span class="ident" id="1726447">lock</span><span class="op" id="1726451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1726455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1726459">if</span>&nbsp;<span class="ident" id="1726462">delta</span>&nbsp;<span class="op" id="1726468">&lt;</span>&nbsp;<span class="num" id="1726470">0</span>&nbsp;<span class="op" id="1726472">||</span>&nbsp;<span class="ident" id="1726475">faketime</span>&nbsp;<span class="op" id="1726484">&gt;</span>&nbsp;<span class="num" id="1726486">0</span>&nbsp;<span class="op" id="1726488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1726493">//&nbsp;No&nbsp;timers&nbsp;left&nbsp;-&nbsp;put&nbsp;goroutine&nbsp;to&nbsp;sleep.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1726540">timers</span><span class="op" id="1726546">.</span><span class="ident" id="1726547">rescheduling</span>&nbsp;<span class="op" id="1726560">=</span>&nbsp;<span class="builtintype" id="1726562">true</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1726570">goparkunlock</span><span class="op" id="1726582">(</span><span class="op" id="1726583">&amp;</span><span class="ident" id="1726584">timers</span><span class="op" id="1726590">.</span><span class="ident" id="1726591">lock</span><span class="op" id="1726595">,</span>&nbsp;<span class="string" id="1726597">&#34;timer&nbsp;goroutine&nbsp;(idle)&#34;</span><span class="op" id="1726621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1726626">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1726637">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1726641">//&nbsp;At&nbsp;least&nbsp;one&nbsp;timer&nbsp;pending.&nbsp;&nbsp;Sleep&nbsp;until&nbsp;then.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1726693">timers</span><span class="op" id="1726699">.</span><span class="ident" id="1726700">sleeping</span>&nbsp;<span class="op" id="1726709">=</span>&nbsp;<span class="builtintype" id="1726711">true</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1726718">noteclear</span><span class="op" id="1726727">(</span><span class="op" id="1726728">&amp;</span><span class="ident" id="1726729">timers</span><span class="op" id="1726735">.</span><span class="ident" id="1726736">waitnote</span><span class="op" id="1726744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1726748">unlock</span><span class="op" id="1726754">(</span><span class="op" id="1726755">&amp;</span><span class="ident" id="1726756">timers</span><span class="op" id="1726762">.</span><span class="ident" id="1726763">lock</span><span class="op" id="1726767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1726771">notetsleepg</span><span class="op" id="1726782">(</span><span class="op" id="1726783">&amp;</span><span class="ident" id="1726784">timers</span><span class="op" id="1726790">.</span><span class="ident" id="1726791">waitnote</span><span class="op" id="1726799">,</span>&nbsp;<span class="ident" id="1726801">delta</span><span class="op" id="1726806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1726809">}</span><br>
<span class="lineno"></span><span class="op" id="1726811">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="keyword" id="1726814">func</span>&nbsp;<span class="ident" id="1726819">timejump</span><span class="op" id="1726827">(</span><span class="op" id="1726828">)</span>&nbsp;<span class="op" id="1726830">*</span><span class="ident" id="1726831">g</span>&nbsp;<span class="op" id="1726833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1726836">if</span>&nbsp;<span class="ident" id="1726839">faketime</span>&nbsp;<span class="op" id="1726848">==</span>&nbsp;<span class="num" id="1726851">0</span>&nbsp;<span class="op" id="1726853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1726857">return</span>&nbsp;<span class="builtintype" id="1726864">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1726869">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1726873">lock</span><span class="op" id="1726877">(</span><span class="op" id="1726878">&amp;</span><span class="ident" id="1726879">timers</span><span class="op" id="1726885">.</span><span class="ident" id="1726886">lock</span><span class="op" id="1726890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1726893">if</span>&nbsp;<span class="op" id="1726896">!</span><span class="ident" id="1726897">timers</span><span class="op" id="1726903">.</span><span class="ident" id="1726904">created</span>&nbsp;<span class="op" id="1726912">||</span>&nbsp;<span class="builtinfunc" id="1726915">len</span><span class="op" id="1726918">(</span><span class="ident" id="1726919">timers</span><span class="op" id="1726925">.</span><span class="ident" id="1726926">t</span><span class="op" id="1726927">)</span>&nbsp;<span class="op" id="1726929">==</span>&nbsp;<span class="num" id="1726932">0</span>&nbsp;<span class="op" id="1726934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1726938">unlock</span><span class="op" id="1726944">(</span><span class="op" id="1726945">&amp;</span><span class="ident" id="1726946">timers</span><span class="op" id="1726952">.</span><span class="ident" id="1726953">lock</span><span class="op" id="1726957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1726961">return</span>&nbsp;<span class="builtintype" id="1726968">nil</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1726973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1726977">var</span>&nbsp;<span class="ident" id="1726981">gp</span>&nbsp;<span class="op" id="1726984">*</span><span class="ident" id="1726985">g</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1726988">if</span>&nbsp;<span class="ident" id="1726991">faketime</span>&nbsp;<span class="op" id="1727000">&lt;</span>&nbsp;<span class="ident" id="1727002">timers</span><span class="op" id="1727008">.</span><span class="ident" id="1727009">t</span><span class="op" id="1727010">[</span><span class="num" id="1727011">0</span><span class="op" id="1727012">]</span><span class="op" id="1727013">.</span><span class="ident" id="1727014">when</span>&nbsp;<span class="op" id="1727019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1727023">faketime</span>&nbsp;<span class="op" id="1727032">=</span>&nbsp;<span class="ident" id="1727034">timers</span><span class="op" id="1727040">.</span><span class="ident" id="1727041">t</span><span class="op" id="1727042">[</span><span class="num" id="1727043">0</span><span class="op" id="1727044">]</span><span class="op" id="1727045">.</span><span class="ident" id="1727046">when</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1727053">if</span>&nbsp;<span class="ident" id="1727056">timers</span><span class="op" id="1727062">.</span><span class="ident" id="1727063">rescheduling</span>&nbsp;<span class="op" id="1727076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1727081">timers</span><span class="op" id="1727087">.</span><span class="ident" id="1727088">rescheduling</span>&nbsp;<span class="op" id="1727101">=</span>&nbsp;<span class="builtintype" id="1727103">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1727112">gp</span>&nbsp;<span class="op" id="1727115">=</span>&nbsp;<span class="ident" id="1727117">timers</span><span class="op" id="1727123">.</span><span class="ident" id="1727124">gp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1727129">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1727132">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1727135">unlock</span><span class="op" id="1727141">(</span><span class="op" id="1727142">&amp;</span><span class="ident" id="1727143">timers</span><span class="op" id="1727149">.</span><span class="ident" id="1727150">lock</span><span class="op" id="1727154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1727157">return</span>&nbsp;<span class="ident" id="1727164">gp</span><br>
<span class="lineno"></span><span class="op" id="1727167">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1727170">//&nbsp;Heap&nbsp;maintenance&nbsp;algorithms.</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="keyword" id="1727203">func</span>&nbsp;<span class="ident" id="1727208">siftupTimer</span><span class="op" id="1727219">(</span><span class="ident" id="1727220">i</span>&nbsp;<span class="builtintype" id="1727222">int</span><span class="op" id="1727225">)</span>&nbsp;<span class="op" id="1727227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1727230">t</span>&nbsp;<span class="op" id="1727232">:=</span>&nbsp;<span class="ident" id="1727235">timers</span><span class="op" id="1727241">.</span><span class="ident" id="1727242">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1727245">when</span>&nbsp;<span class="op" id="1727250">:=</span>&nbsp;<span class="ident" id="1727253">t</span><span class="op" id="1727254">[</span><span class="ident" id="1727255">i</span><span class="op" id="1727256">]</span><span class="op" id="1727257">.</span><span class="ident" id="1727258">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1727264">tmp</span>&nbsp;<span class="op" id="1727268">:=</span>&nbsp;<span class="ident" id="1727271">t</span><span class="op" id="1727272">[</span><span class="ident" id="1727273">i</span><span class="op" id="1727274">]</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1727277">for</span>&nbsp;<span class="ident" id="1727281">i</span>&nbsp;<span class="op" id="1727283">&gt;</span>&nbsp;<span class="num" id="1727285">0</span>&nbsp;<span class="op" id="1727287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1727291">p</span>&nbsp;<span class="op" id="1727293">:=</span>&nbsp;<span class="op" id="1727296">(</span><span class="ident" id="1727297">i</span>&nbsp;<span class="op" id="1727299">-</span>&nbsp;<span class="num" id="1727301">1</span><span class="op" id="1727302">)</span>&nbsp;<span class="op" id="1727304">/</span>&nbsp;<span class="num" id="1727306">4</span>&nbsp;<span class="comment" id="1727308">//&nbsp;parent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1727320">if</span>&nbsp;<span class="ident" id="1727323">when</span>&nbsp;<span class="op" id="1727328">&gt;=</span>&nbsp;<span class="ident" id="1727331">t</span><span class="op" id="1727332">[</span><span class="ident" id="1727333">p</span><span class="op" id="1727334">]</span><span class="op" id="1727335">.</span><span class="ident" id="1727336">when</span>&nbsp;<span class="op" id="1727341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1727346">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1727354">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1727358">t</span><span class="op" id="1727359">[</span><span class="ident" id="1727360">i</span><span class="op" id="1727361">]</span>&nbsp;<span class="op" id="1727363">=</span>&nbsp;<span class="ident" id="1727365">t</span><span class="op" id="1727366">[</span><span class="ident" id="1727367">p</span><span class="op" id="1727368">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1727372">t</span><span class="op" id="1727373">[</span><span class="ident" id="1727374">i</span><span class="op" id="1727375">]</span><span class="op" id="1727376">.</span><span class="ident" id="1727377">i</span>&nbsp;<span class="op" id="1727379">=</span>&nbsp;<span class="ident" id="1727381">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1727385">t</span><span class="op" id="1727386">[</span><span class="ident" id="1727387">p</span><span class="op" id="1727388">]</span>&nbsp;<span class="op" id="1727390">=</span>&nbsp;<span class="ident" id="1727392">tmp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1727398">t</span><span class="op" id="1727399">[</span><span class="ident" id="1727400">p</span><span class="op" id="1727401">]</span><span class="op" id="1727402">.</span><span class="ident" id="1727403">i</span>&nbsp;<span class="op" id="1727405">=</span>&nbsp;<span class="ident" id="1727407">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1727411">i</span>&nbsp;<span class="op" id="1727413">=</span>&nbsp;<span class="ident" id="1727415">p</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1727418">}</span><br>
<span class="lineno"></span><span class="op" id="1727420">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1727423">func</span>&nbsp;<span class="ident" id="1727428">siftdownTimer</span><span class="op" id="1727441">(</span><span class="ident" id="1727442">i</span>&nbsp;<span class="builtintype" id="1727444">int</span><span class="op" id="1727447">)</span>&nbsp;<span class="op" id="1727449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1727452">t</span>&nbsp;<span class="op" id="1727454">:=</span>&nbsp;<span class="ident" id="1727457">timers</span><span class="op" id="1727463">.</span><span class="ident" id="1727464">t</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1727467">n</span>&nbsp;<span class="op" id="1727469">:=</span>&nbsp;<span class="builtinfunc" id="1727472">len</span><span class="op" id="1727475">(</span><span class="ident" id="1727476">t</span><span class="op" id="1727477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1727480">when</span>&nbsp;<span class="op" id="1727485">:=</span>&nbsp;<span class="ident" id="1727488">t</span><span class="op" id="1727489">[</span><span class="ident" id="1727490">i</span><span class="op" id="1727491">]</span><span class="op" id="1727492">.</span><span class="ident" id="1727493">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1727499">tmp</span>&nbsp;<span class="op" id="1727503">:=</span>&nbsp;<span class="ident" id="1727506">t</span><span class="op" id="1727507">[</span><span class="ident" id="1727508">i</span><span class="op" id="1727509">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1727512">for</span>&nbsp;<span class="op" id="1727516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1727520">c</span>&nbsp;<span class="op" id="1727522">:=</span>&nbsp;<span class="ident" id="1727525">i</span><span class="op" id="1727526">*</span><span class="num" id="1727527">4</span>&nbsp;<span class="op" id="1727529">+</span>&nbsp;<span class="num" id="1727531">1</span>&nbsp;<span class="comment" id="1727533">//&nbsp;left&nbsp;child</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1727549">c3</span>&nbsp;<span class="op" id="1727552">:=</span>&nbsp;<span class="ident" id="1727555">c</span>&nbsp;<span class="op" id="1727557">+</span>&nbsp;<span class="num" id="1727559">2</span>&nbsp;&nbsp;<span class="comment" id="1727562">//&nbsp;mid&nbsp;child</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1727577">if</span>&nbsp;<span class="ident" id="1727580">c</span>&nbsp;<span class="op" id="1727582">&gt;=</span>&nbsp;<span class="ident" id="1727585">n</span>&nbsp;<span class="op" id="1727587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1727592">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1727600">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1727604">w</span>&nbsp;<span class="op" id="1727606">:=</span>&nbsp;<span class="ident" id="1727609">t</span><span class="op" id="1727610">[</span><span class="ident" id="1727611">c</span><span class="op" id="1727612">]</span><span class="op" id="1727613">.</span><span class="ident" id="1727614">when</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1727621">if</span>&nbsp;<span class="ident" id="1727624">c</span><span class="op" id="1727625">+</span><span class="num" id="1727626">1</span>&nbsp;<span class="op" id="1727628">&lt;</span>&nbsp;<span class="ident" id="1727630">n</span>&nbsp;<span class="op" id="1727632">&amp;&amp;</span>&nbsp;<span class="ident" id="1727635">t</span><span class="op" id="1727636">[</span><span class="ident" id="1727637">c</span><span class="op" id="1727638">+</span><span class="num" id="1727639">1</span><span class="op" id="1727640">]</span><span class="op" id="1727641">.</span><span class="ident" id="1727642">when</span>&nbsp;<span class="op" id="1727647">&lt;</span>&nbsp;<span class="ident" id="1727649">w</span>&nbsp;<span class="op" id="1727651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1727656">w</span>&nbsp;<span class="op" id="1727658">=</span>&nbsp;<span class="ident" id="1727660">t</span><span class="op" id="1727661">[</span><span class="ident" id="1727662">c</span><span class="op" id="1727663">+</span><span class="num" id="1727664">1</span><span class="op" id="1727665">]</span><span class="op" id="1727666">.</span><span class="ident" id="1727667">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1727675">c</span><span class="op" id="1727676">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1727681">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1727685">if</span>&nbsp;<span class="ident" id="1727688">c3</span>&nbsp;<span class="op" id="1727691">&lt;</span>&nbsp;<span class="ident" id="1727693">n</span>&nbsp;<span class="op" id="1727695">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1727700">w3</span>&nbsp;<span class="op" id="1727703">:=</span>&nbsp;<span class="ident" id="1727706">t</span><span class="op" id="1727707">[</span><span class="ident" id="1727708">c3</span><span class="op" id="1727710">]</span><span class="op" id="1727711">.</span><span class="ident" id="1727712">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1727720">if</span>&nbsp;<span class="ident" id="1727723">c3</span><span class="op" id="1727725">+</span><span class="num" id="1727726">1</span>&nbsp;<span class="op" id="1727728">&lt;</span>&nbsp;<span class="ident" id="1727730">n</span>&nbsp;<span class="op" id="1727732">&amp;&amp;</span>&nbsp;<span class="ident" id="1727735">t</span><span class="op" id="1727736">[</span><span class="ident" id="1727737">c3</span><span class="op" id="1727739">+</span><span class="num" id="1727740">1</span><span class="op" id="1727741">]</span><span class="op" id="1727742">.</span><span class="ident" id="1727743">when</span>&nbsp;<span class="op" id="1727748">&lt;</span>&nbsp;<span class="ident" id="1727750">w3</span>&nbsp;<span class="op" id="1727753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1727759">w3</span>&nbsp;<span class="op" id="1727762">=</span>&nbsp;<span class="ident" id="1727764">t</span><span class="op" id="1727765">[</span><span class="ident" id="1727766">c3</span><span class="op" id="1727768">+</span><span class="num" id="1727769">1</span><span class="op" id="1727770">]</span><span class="op" id="1727771">.</span><span class="ident" id="1727772">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1727781">c3</span><span class="op" id="1727783">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1727789">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1727794">if</span>&nbsp;<span class="ident" id="1727797">w3</span>&nbsp;<span class="op" id="1727800">&lt;</span>&nbsp;<span class="ident" id="1727802">w</span>&nbsp;<span class="op" id="1727804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1727810">w</span>&nbsp;<span class="op" id="1727812">=</span>&nbsp;<span class="ident" id="1727814">w3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1727821">c</span>&nbsp;<span class="op" id="1727823">=</span>&nbsp;<span class="ident" id="1727825">c3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1727831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1727835">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1727839">if</span>&nbsp;<span class="ident" id="1727842">w</span>&nbsp;<span class="op" id="1727844">&gt;=</span>&nbsp;<span class="ident" id="1727847">when</span>&nbsp;<span class="op" id="1727852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1727857">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1727865">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1727869">t</span><span class="op" id="1727870">[</span><span class="ident" id="1727871">i</span><span class="op" id="1727872">]</span>&nbsp;<span class="op" id="1727874">=</span>&nbsp;<span class="ident" id="1727876">t</span><span class="op" id="1727877">[</span><span class="ident" id="1727878">c</span><span class="op" id="1727879">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1727883">t</span><span class="op" id="1727884">[</span><span class="ident" id="1727885">i</span><span class="op" id="1727886">]</span><span class="op" id="1727887">.</span><span class="ident" id="1727888">i</span>&nbsp;<span class="op" id="1727890">=</span>&nbsp;<span class="ident" id="1727892">i</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1727896">t</span><span class="op" id="1727897">[</span><span class="ident" id="1727898">c</span><span class="op" id="1727899">]</span>&nbsp;<span class="op" id="1727901">=</span>&nbsp;<span class="ident" id="1727903">tmp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1727909">t</span><span class="op" id="1727910">[</span><span class="ident" id="1727911">c</span><span class="op" id="1727912">]</span><span class="op" id="1727913">.</span><span class="ident" id="1727914">i</span>&nbsp;<span class="op" id="1727916">=</span>&nbsp;<span class="ident" id="1727918">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1727922">i</span>&nbsp;<span class="op" id="1727924">=</span>&nbsp;<span class="ident" id="1727926">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1727929">}</span><br>
<span class="lineno"></span><span class="op" id="1727931">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
