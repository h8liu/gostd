<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>index/suffixarray</h2>
<ul>
<li><a href="/gostd/index/suffixarray/qsufsort.go.html">qsufsort.go</a></li>
<li><a href="/gostd/index/suffixarray/suffixarray.go.html">suffixarray.go</a></li>
<li><a href="/gostd/index/suffixarray/suffixarray_test.go.html" class="current">suffixarray_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7396506">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7396561">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7396615">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7396666">package</span>&nbsp;<span class="ident" id="7396674">suffixarray</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7396687">import</span>&nbsp;<span class="op" id="7396694">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7396697">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7396706">&#34;math/rand&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7396719">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7396729">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7396737">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7396748">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7396758">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="7396761">type</span>&nbsp;<span class="ident" id="7396766">testCase</span>&nbsp;<span class="keyword" id="7396775">struct</span>&nbsp;<span class="op" id="7396782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7396785">name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7396794">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="7396803">//&nbsp;name&nbsp;of&nbsp;test&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7396825">source</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7396834">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="7396843">//&nbsp;source&nbsp;to&nbsp;index</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7396863">patterns</span>&nbsp;<span class="op" id="7396872">[</span><span class="op" id="7396873">]</span><span class="builtintype" id="7396874">string</span>&nbsp;<span class="comment" id="7396881">//&nbsp;patterns&nbsp;to&nbsp;lookup</span><br>
<span class="lineno">20</span><span class="op" id="7396903">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7396906">var</span>&nbsp;<span class="ident" id="7396910">testCases</span>&nbsp;<span class="op" id="7396920">=</span>&nbsp;<span class="op" id="7396922">[</span><span class="op" id="7396923">]</span><span class="ident" id="7396924">testCase</span><span class="op" id="7396932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7396935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7396939">&#34;empty&nbsp;string&#34;</span><span class="op" id="7396953">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7396957">&#34;&#34;</span><span class="op" id="7396959">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7396963">[</span><span class="op" id="7396964">]</span><span class="builtintype" id="7396965">string</span><span class="op" id="7396971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7396976">&#34;&#34;</span><span class="op" id="7396978">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7396983">&#34;foo&#34;</span><span class="op" id="7396988">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7396993">&#34;(foo)&#34;</span><span class="op" id="7397000">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397005">&#34;.*&#34;</span><span class="op" id="7397009">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397014">&#34;a*&#34;</span><span class="op" id="7397018">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7397022">}</span><span class="op" id="7397023">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7397026">}</span><span class="op" id="7397027">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7397031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397035">&#34;all&nbsp;a&#39;s&#34;</span><span class="op" id="7397044">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397048">&#34;aaaaaaaaaa&#34;</span><span class="op" id="7397060">,</span>&nbsp;<span class="comment" id="7397062">//&nbsp;10&nbsp;a&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7397074">[</span><span class="op" id="7397075">]</span><span class="builtintype" id="7397076">string</span><span class="op" id="7397082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397087">&#34;&#34;</span><span class="op" id="7397089">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397094">&#34;a&#34;</span><span class="op" id="7397097">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397102">&#34;aa&#34;</span><span class="op" id="7397106">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397111">&#34;aaa&#34;</span><span class="op" id="7397116">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397121">&#34;aaaa&#34;</span><span class="op" id="7397127">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397132">&#34;aaaaa&#34;</span><span class="op" id="7397139">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397144">&#34;aaaaaa&#34;</span><span class="op" id="7397152">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397157">&#34;aaaaaaa&#34;</span><span class="op" id="7397166">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397171">&#34;aaaaaaaa&#34;</span><span class="op" id="7397181">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397186">&#34;aaaaaaaaa&#34;</span><span class="op" id="7397197">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397202">&#34;aaaaaaaaaa&#34;</span><span class="op" id="7397214">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397219">&#34;aaaaaaaaaaa&#34;</span><span class="op" id="7397232">,</span>&nbsp;<span class="comment" id="7397234">//&nbsp;11&nbsp;a&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397247">&#34;.&#34;</span><span class="op" id="7397250">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397255">&#34;.*&#34;</span><span class="op" id="7397259">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397264">&#34;a+&#34;</span><span class="op" id="7397268">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397273">&#34;aa+&#34;</span><span class="op" id="7397278">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397283">&#34;aaaa[b]?&#34;</span><span class="op" id="7397293">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397298">&#34;aaa*&#34;</span><span class="op" id="7397304">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7397308">}</span><span class="op" id="7397309">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7397312">}</span><span class="op" id="7397313">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7397317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397321">&#34;abc&#34;</span><span class="op" id="7397326">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397330">&#34;abc&#34;</span><span class="op" id="7397335">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7397339">[</span><span class="op" id="7397340">]</span><span class="builtintype" id="7397341">string</span><span class="op" id="7397347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397352">&#34;a&#34;</span><span class="op" id="7397355">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397360">&#34;b&#34;</span><span class="op" id="7397363">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397368">&#34;c&#34;</span><span class="op" id="7397371">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397376">&#34;ab&#34;</span><span class="op" id="7397380">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397385">&#34;bc&#34;</span><span class="op" id="7397389">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397394">&#34;abc&#34;</span><span class="op" id="7397399">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397404">&#34;a.c&#34;</span><span class="op" id="7397409">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397414">&#34;a(b|c)&#34;</span><span class="op" id="7397422">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397427">&#34;abc?&#34;</span><span class="op" id="7397433">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7397437">}</span><span class="op" id="7397438">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7397441">}</span><span class="op" id="7397442">,</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7397446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397450">&#34;barbara*3&#34;</span><span class="op" id="7397461">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397465">&#34;barbarabarbarabarbara&#34;</span><span class="op" id="7397488">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7397492">[</span><span class="op" id="7397493">]</span><span class="builtintype" id="7397494">string</span><span class="op" id="7397500">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397505">&#34;a&#34;</span><span class="op" id="7397508">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397513">&#34;bar&#34;</span><span class="op" id="7397518">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397523">&#34;rab&#34;</span><span class="op" id="7397528">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397533">&#34;arab&#34;</span><span class="op" id="7397539">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397544">&#34;barbar&#34;</span><span class="op" id="7397552">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397557">&#34;bara?bar&#34;</span><span class="op" id="7397567">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7397571">}</span><span class="op" id="7397572">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7397575">}</span><span class="op" id="7397576">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7397580">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397584">&#34;typing&nbsp;drill&#34;</span><span class="op" id="7397598">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397602">&#34;Now&nbsp;is&nbsp;the&nbsp;time&nbsp;for&nbsp;all&nbsp;good&nbsp;men&nbsp;to&nbsp;come&nbsp;to&nbsp;the&nbsp;aid&nbsp;of&nbsp;their&nbsp;country.&#34;</span><span class="op" id="7397673">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7397677">[</span><span class="op" id="7397678">]</span><span class="builtintype" id="7397679">string</span><span class="op" id="7397685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397690">&#34;Now&#34;</span><span class="op" id="7397695">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397700">&#34;the&nbsp;time&#34;</span><span class="op" id="7397710">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397715">&#34;to&nbsp;come&nbsp;the&nbsp;aid&#34;</span><span class="op" id="7397732">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397737">&#34;is&nbsp;the&nbsp;time&nbsp;for&nbsp;all&nbsp;good&nbsp;men&nbsp;to&nbsp;come&nbsp;to&nbsp;the&nbsp;aid&nbsp;of&nbsp;their&#34;</span><span class="op" id="7397795">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397800">&#34;to&nbsp;(come|the)?&#34;</span><span class="op" id="7397816">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7397820">}</span><span class="op" id="7397821">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7397824">}</span><span class="op" id="7397825">,</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7397829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397833">&#34;godoc&nbsp;simulation&#34;</span><span class="op" id="7397851">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7397855">&#34;package&nbsp;main\n\nimport(\n&nbsp;&nbsp;&nbsp;&nbsp;\&#34;rand\&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="7397900">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7397904">[</span><span class="op" id="7397905">]</span><span class="builtintype" id="7397906">string</span><span class="op" id="7397912">{</span><span class="op" id="7397913">}</span><span class="op" id="7397914">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7397917">}</span><span class="op" id="7397918">,</span><br>
<span class="lineno"></span><span class="op" id="7397920">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7397923">//&nbsp;find&nbsp;all&nbsp;occurrences&nbsp;of&nbsp;s&nbsp;in&nbsp;source;&nbsp;report&nbsp;at&nbsp;most&nbsp;n&nbsp;occurrences</span><br>
<span class="lineno"></span><span class="keyword" id="7397992">func</span>&nbsp;<span class="ident" id="7397997">find</span><span class="op" id="7398001">(</span><span class="ident" id="7398002">src</span><span class="op" id="7398005">,</span>&nbsp;<span class="ident" id="7398007">s</span>&nbsp;<span class="builtintype" id="7398009">string</span><span class="op" id="7398015">,</span>&nbsp;<span class="ident" id="7398017">n</span>&nbsp;<span class="builtintype" id="7398019">int</span><span class="op" id="7398022">)</span>&nbsp;<span class="op" id="7398024">[</span><span class="op" id="7398025">]</span><span class="builtintype" id="7398026">int</span>&nbsp;<span class="op" id="7398030">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7398033">var</span>&nbsp;<span class="ident" id="7398037">res</span>&nbsp;<span class="op" id="7398041">[</span><span class="op" id="7398042">]</span><span class="builtintype" id="7398043">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7398048">if</span>&nbsp;<span class="ident" id="7398051">s</span>&nbsp;<span class="op" id="7398053">!=</span>&nbsp;<span class="string" id="7398056">&#34;&#34;</span>&nbsp;<span class="op" id="7398059">&amp;&amp;</span>&nbsp;<span class="ident" id="7398062">n</span>&nbsp;<span class="op" id="7398064">!=</span>&nbsp;<span class="num" id="7398067">0</span>&nbsp;<span class="op" id="7398069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7398073">//&nbsp;find&nbsp;at&nbsp;most&nbsp;n&nbsp;occurrences&nbsp;of&nbsp;s&nbsp;in&nbsp;src</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7398117">for</span>&nbsp;<span class="ident" id="7398121">i</span>&nbsp;<span class="op" id="7398123">:=</span>&nbsp;<span class="op" id="7398126">-</span><span class="num" id="7398127">1</span><span class="op" id="7398128">;</span>&nbsp;<span class="ident" id="7398130">n</span>&nbsp;<span class="op" id="7398132">&lt;</span>&nbsp;<span class="num" id="7398134">0</span>&nbsp;<span class="op" id="7398136">||</span>&nbsp;<span class="builtinfunc" id="7398139">len</span><span class="op" id="7398142">(</span><span class="ident" id="7398143">res</span><span class="op" id="7398146">)</span>&nbsp;<span class="op" id="7398148">&lt;</span>&nbsp;<span class="ident" id="7398150">n</span><span class="op" id="7398151">;</span>&nbsp;<span class="op" id="7398153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7398158">j</span>&nbsp;<span class="op" id="7398160">:=</span>&nbsp;<span class="ident" id="7398163">strings</span><span class="op" id="7398170">.</span><span class="ident" id="7398171">Index</span><span class="op" id="7398176">(</span><span class="ident" id="7398177">src</span><span class="op" id="7398180">[</span><span class="ident" id="7398181">i</span><span class="op" id="7398182">+</span><span class="num" id="7398183">1</span><span class="op" id="7398184">:</span><span class="op" id="7398185">]</span><span class="op" id="7398186">,</span>&nbsp;<span class="ident" id="7398188">s</span><span class="op" id="7398189">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7398194">if</span>&nbsp;<span class="ident" id="7398197">j</span>&nbsp;<span class="op" id="7398199">&lt;</span>&nbsp;<span class="num" id="7398201">0</span>&nbsp;<span class="op" id="7398203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7398209">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7398218">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7398223">i</span>&nbsp;<span class="op" id="7398225">+=</span>&nbsp;<span class="ident" id="7398228">j</span>&nbsp;<span class="op" id="7398230">+</span>&nbsp;<span class="num" id="7398232">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7398237">res</span>&nbsp;<span class="op" id="7398241">=</span>&nbsp;<span class="builtinfunc" id="7398243">append</span><span class="op" id="7398249">(</span><span class="ident" id="7398250">res</span><span class="op" id="7398253">,</span>&nbsp;<span class="ident" id="7398255">i</span><span class="op" id="7398256">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7398260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7398263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7398266">return</span>&nbsp;<span class="ident" id="7398273">res</span><br>
<span class="lineno"></span><span class="op" id="7398277">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="7398280">func</span>&nbsp;<span class="ident" id="7398285">testLookup</span><span class="op" id="7398295">(</span><span class="ident" id="7398296">t</span>&nbsp;<span class="op" id="7398298">*</span><span class="ident" id="7398299">testing</span><span class="op" id="7398306">.</span><span class="ident" id="7398307">T</span><span class="op" id="7398308">,</span>&nbsp;<span class="ident" id="7398310">tc</span>&nbsp;<span class="op" id="7398313">*</span><span class="ident" id="7398314">testCase</span><span class="op" id="7398322">,</span>&nbsp;<span class="ident" id="7398324">x</span>&nbsp;<span class="op" id="7398326">*</span><span class="ident" id="7398327">Index</span><span class="op" id="7398332">,</span>&nbsp;<span class="ident" id="7398334">s</span>&nbsp;<span class="builtintype" id="7398336">string</span><span class="op" id="7398342">,</span>&nbsp;<span class="ident" id="7398344">n</span>&nbsp;<span class="builtintype" id="7398346">int</span><span class="op" id="7398349">)</span>&nbsp;<span class="op" id="7398351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7398354">res</span>&nbsp;<span class="op" id="7398358">:=</span>&nbsp;<span class="ident" id="7398361">x</span><span class="op" id="7398362">.</span><span class="ident" id="7398363">Lookup</span><span class="op" id="7398369">(</span><span class="op" id="7398370">[</span><span class="op" id="7398371">]</span><span class="builtintype" id="7398372">byte</span><span class="op" id="7398376">(</span><span class="ident" id="7398377">s</span><span class="op" id="7398378">)</span><span class="op" id="7398379">,</span>&nbsp;<span class="ident" id="7398381">n</span><span class="op" id="7398382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7398385">exp</span>&nbsp;<span class="op" id="7398389">:=</span>&nbsp;<span class="ident" id="7398392">find</span><span class="op" id="7398396">(</span><span class="ident" id="7398397">tc</span><span class="op" id="7398399">.</span><span class="ident" id="7398400">source</span><span class="op" id="7398406">,</span>&nbsp;<span class="ident" id="7398408">s</span><span class="op" id="7398409">,</span>&nbsp;<span class="ident" id="7398411">n</span><span class="op" id="7398412">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7398416">//&nbsp;check&nbsp;that&nbsp;the&nbsp;lengths&nbsp;match</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7398449">if</span>&nbsp;<span class="builtinfunc" id="7398452">len</span><span class="op" id="7398455">(</span><span class="ident" id="7398456">res</span><span class="op" id="7398459">)</span>&nbsp;<span class="op" id="7398461">!=</span>&nbsp;<span class="builtinfunc" id="7398464">len</span><span class="op" id="7398467">(</span><span class="ident" id="7398468">exp</span><span class="op" id="7398471">)</span>&nbsp;<span class="op" id="7398473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7398477">t</span><span class="op" id="7398478">.</span><span class="ident" id="7398479">Errorf</span><span class="op" id="7398485">(</span><span class="string" id="7398486">&#34;test&nbsp;%q,&nbsp;lookup&nbsp;%q&nbsp;(n&nbsp;=&nbsp;%d):&nbsp;expected&nbsp;%d&nbsp;results;&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7398544">,</span>&nbsp;<span class="ident" id="7398546">tc</span><span class="op" id="7398548">.</span><span class="ident" id="7398549">name</span><span class="op" id="7398553">,</span>&nbsp;<span class="ident" id="7398555">s</span><span class="op" id="7398556">,</span>&nbsp;<span class="ident" id="7398558">n</span><span class="op" id="7398559">,</span>&nbsp;<span class="builtinfunc" id="7398561">len</span><span class="op" id="7398564">(</span><span class="ident" id="7398565">exp</span><span class="op" id="7398568">)</span><span class="op" id="7398569">,</span>&nbsp;<span class="builtinfunc" id="7398571">len</span><span class="op" id="7398574">(</span><span class="ident" id="7398575">res</span><span class="op" id="7398578">)</span><span class="op" id="7398579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7398582">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7398586">//&nbsp;if&nbsp;n&nbsp;&gt;=&nbsp;0&nbsp;the&nbsp;number&nbsp;of&nbsp;results&nbsp;is&nbsp;limited&nbsp;---&nbsp;unless&nbsp;n&nbsp;&gt;=&nbsp;all&nbsp;results,</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7398662">//&nbsp;we&nbsp;may&nbsp;obtain&nbsp;different&nbsp;positions&nbsp;from&nbsp;the&nbsp;Index&nbsp;and&nbsp;from&nbsp;find&nbsp;(because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7398738">//&nbsp;Index&nbsp;may&nbsp;not&nbsp;find&nbsp;the&nbsp;results&nbsp;in&nbsp;the&nbsp;same&nbsp;order&nbsp;as&nbsp;find)&nbsp;=&gt;&nbsp;in&nbsp;general</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7398814">//&nbsp;we&nbsp;cannot&nbsp;simply&nbsp;check&nbsp;that&nbsp;the&nbsp;res&nbsp;and&nbsp;exp&nbsp;lists&nbsp;are&nbsp;equal</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7398879">//&nbsp;check&nbsp;that&nbsp;each&nbsp;result&nbsp;is&nbsp;in&nbsp;fact&nbsp;a&nbsp;correct&nbsp;match&nbsp;and&nbsp;there&nbsp;are&nbsp;no&nbsp;duplicates</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7398961">sort</span><span class="op" id="7398965">.</span><span class="ident" id="7398966">Ints</span><span class="op" id="7398970">(</span><span class="ident" id="7398971">res</span><span class="op" id="7398974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7398977">for</span>&nbsp;<span class="ident" id="7398981">i</span><span class="op" id="7398982">,</span>&nbsp;<span class="ident" id="7398984">r</span>&nbsp;<span class="op" id="7398986">:=</span>&nbsp;<span class="keyword" id="7398989">range</span>&nbsp;<span class="ident" id="7398995">res</span>&nbsp;<span class="op" id="7398999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7399003">if</span>&nbsp;<span class="ident" id="7399006">r</span>&nbsp;<span class="op" id="7399008">&lt;</span>&nbsp;<span class="num" id="7399010">0</span>&nbsp;<span class="op" id="7399012">||</span>&nbsp;<span class="builtinfunc" id="7399015">len</span><span class="op" id="7399018">(</span><span class="ident" id="7399019">tc</span><span class="op" id="7399021">.</span><span class="ident" id="7399022">source</span><span class="op" id="7399028">)</span>&nbsp;<span class="op" id="7399030">&lt;=</span>&nbsp;<span class="ident" id="7399033">r</span>&nbsp;<span class="op" id="7399035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7399040">t</span><span class="op" id="7399041">.</span><span class="ident" id="7399042">Errorf</span><span class="op" id="7399048">(</span><span class="string" id="7399049">&#34;test&nbsp;%q,&nbsp;lookup&nbsp;%q,&nbsp;result&nbsp;%d&nbsp;(n&nbsp;=&nbsp;%d):&nbsp;index&nbsp;%d&nbsp;out&nbsp;of&nbsp;range&nbsp;[0,&nbsp;%d[&#34;</span><span class="op" id="7399120">,</span>&nbsp;<span class="ident" id="7399122">tc</span><span class="op" id="7399124">.</span><span class="ident" id="7399125">name</span><span class="op" id="7399129">,</span>&nbsp;<span class="ident" id="7399131">s</span><span class="op" id="7399132">,</span>&nbsp;<span class="ident" id="7399134">i</span><span class="op" id="7399135">,</span>&nbsp;<span class="ident" id="7399137">n</span><span class="op" id="7399138">,</span>&nbsp;<span class="ident" id="7399140">r</span><span class="op" id="7399141">,</span>&nbsp;<span class="builtinfunc" id="7399143">len</span><span class="op" id="7399146">(</span><span class="ident" id="7399147">tc</span><span class="op" id="7399149">.</span><span class="ident" id="7399150">source</span><span class="op" id="7399156">)</span><span class="op" id="7399157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7399161">}</span>&nbsp;<span class="keyword" id="7399163">else</span>&nbsp;<span class="keyword" id="7399168">if</span>&nbsp;<span class="op" id="7399171">!</span><span class="ident" id="7399172">strings</span><span class="op" id="7399179">.</span><span class="ident" id="7399180">HasPrefix</span><span class="op" id="7399189">(</span><span class="ident" id="7399190">tc</span><span class="op" id="7399192">.</span><span class="ident" id="7399193">source</span><span class="op" id="7399199">[</span><span class="ident" id="7399200">r</span><span class="op" id="7399201">:</span><span class="op" id="7399202">]</span><span class="op" id="7399203">,</span>&nbsp;<span class="ident" id="7399205">s</span><span class="op" id="7399206">)</span>&nbsp;<span class="op" id="7399208">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7399213">t</span><span class="op" id="7399214">.</span><span class="ident" id="7399215">Errorf</span><span class="op" id="7399221">(</span><span class="string" id="7399222">&#34;test&nbsp;%q,&nbsp;lookup&nbsp;%q,&nbsp;result&nbsp;%d&nbsp;(n&nbsp;=&nbsp;%d):&nbsp;index&nbsp;%d&nbsp;not&nbsp;a&nbsp;match&#34;</span><span class="op" id="7399284">,</span>&nbsp;<span class="ident" id="7399286">tc</span><span class="op" id="7399288">.</span><span class="ident" id="7399289">name</span><span class="op" id="7399293">,</span>&nbsp;<span class="ident" id="7399295">s</span><span class="op" id="7399296">,</span>&nbsp;<span class="ident" id="7399298">i</span><span class="op" id="7399299">,</span>&nbsp;<span class="ident" id="7399301">n</span><span class="op" id="7399302">,</span>&nbsp;<span class="ident" id="7399304">r</span><span class="op" id="7399305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7399309">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7399313">if</span>&nbsp;<span class="ident" id="7399316">i</span>&nbsp;<span class="op" id="7399318">&gt;</span>&nbsp;<span class="num" id="7399320">0</span>&nbsp;<span class="op" id="7399322">&amp;&amp;</span>&nbsp;<span class="ident" id="7399325">res</span><span class="op" id="7399328">[</span><span class="ident" id="7399329">i</span><span class="op" id="7399330">-</span><span class="num" id="7399331">1</span><span class="op" id="7399332">]</span>&nbsp;<span class="op" id="7399334">==</span>&nbsp;<span class="ident" id="7399337">r</span>&nbsp;<span class="op" id="7399339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7399344">t</span><span class="op" id="7399345">.</span><span class="ident" id="7399346">Errorf</span><span class="op" id="7399352">(</span><span class="string" id="7399353">&#34;test&nbsp;%q,&nbsp;lookup&nbsp;%q,&nbsp;result&nbsp;%d&nbsp;(n&nbsp;=&nbsp;%d):&nbsp;found&nbsp;duplicate&nbsp;index&nbsp;%d&#34;</span><span class="op" id="7399419">,</span>&nbsp;<span class="ident" id="7399421">tc</span><span class="op" id="7399423">.</span><span class="ident" id="7399424">name</span><span class="op" id="7399428">,</span>&nbsp;<span class="ident" id="7399430">s</span><span class="op" id="7399431">,</span>&nbsp;<span class="ident" id="7399433">i</span><span class="op" id="7399434">,</span>&nbsp;<span class="ident" id="7399436">n</span><span class="op" id="7399437">,</span>&nbsp;<span class="ident" id="7399439">r</span><span class="op" id="7399440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7399444">}</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7399447">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7399451">if</span>&nbsp;<span class="ident" id="7399454">n</span>&nbsp;<span class="op" id="7399456">&lt;</span>&nbsp;<span class="num" id="7399458">0</span>&nbsp;<span class="op" id="7399460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7399464">//&nbsp;all&nbsp;results&nbsp;computed&nbsp;-&nbsp;sorted&nbsp;res&nbsp;and&nbsp;exp&nbsp;must&nbsp;be&nbsp;equal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7399525">for</span>&nbsp;<span class="ident" id="7399529">i</span><span class="op" id="7399530">,</span>&nbsp;<span class="ident" id="7399532">r</span>&nbsp;<span class="op" id="7399534">:=</span>&nbsp;<span class="keyword" id="7399537">range</span>&nbsp;<span class="ident" id="7399543">res</span>&nbsp;<span class="op" id="7399547">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7399552">e</span>&nbsp;<span class="op" id="7399554">:=</span>&nbsp;<span class="ident" id="7399557">exp</span><span class="op" id="7399560">[</span><span class="ident" id="7399561">i</span><span class="op" id="7399562">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7399567">if</span>&nbsp;<span class="ident" id="7399570">r</span>&nbsp;<span class="op" id="7399572">!=</span>&nbsp;<span class="ident" id="7399575">e</span>&nbsp;<span class="op" id="7399577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7399583">t</span><span class="op" id="7399584">.</span><span class="ident" id="7399585">Errorf</span><span class="op" id="7399591">(</span><span class="string" id="7399592">&#34;test&nbsp;%q,&nbsp;lookup&nbsp;%q,&nbsp;result&nbsp;%d:&nbsp;expected&nbsp;index&nbsp;%d;&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7399650">,</span>&nbsp;<span class="ident" id="7399652">tc</span><span class="op" id="7399654">.</span><span class="ident" id="7399655">name</span><span class="op" id="7399659">,</span>&nbsp;<span class="ident" id="7399661">s</span><span class="op" id="7399662">,</span>&nbsp;<span class="ident" id="7399664">i</span><span class="op" id="7399665">,</span>&nbsp;<span class="ident" id="7399667">e</span><span class="op" id="7399668">,</span>&nbsp;<span class="ident" id="7399670">r</span><span class="op" id="7399671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7399676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7399680">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7399683">}</span><br>
<span class="lineno"></span><span class="op" id="7399685">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7399688">func</span>&nbsp;<span class="ident" id="7399693">testFindAllIndex</span><span class="op" id="7399709">(</span><span class="ident" id="7399710">t</span>&nbsp;<span class="op" id="7399712">*</span><span class="ident" id="7399713">testing</span><span class="op" id="7399720">.</span><span class="ident" id="7399721">T</span><span class="op" id="7399722">,</span>&nbsp;<span class="ident" id="7399724">tc</span>&nbsp;<span class="op" id="7399727">*</span><span class="ident" id="7399728">testCase</span><span class="op" id="7399736">,</span>&nbsp;<span class="ident" id="7399738">x</span>&nbsp;<span class="op" id="7399740">*</span><span class="ident" id="7399741">Index</span><span class="op" id="7399746">,</span>&nbsp;<span class="ident" id="7399748">rx</span>&nbsp;<span class="op" id="7399751">*</span><span class="ident" id="7399752">regexp</span><span class="op" id="7399758">.</span><span class="ident" id="7399759">Regexp</span><span class="op" id="7399765">,</span>&nbsp;<span class="ident" id="7399767">n</span>&nbsp;<span class="builtintype" id="7399769">int</span><span class="op" id="7399772">)</span>&nbsp;<span class="op" id="7399774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7399777">res</span>&nbsp;<span class="op" id="7399781">:=</span>&nbsp;<span class="ident" id="7399784">x</span><span class="op" id="7399785">.</span><span class="ident" id="7399786">FindAllIndex</span><span class="op" id="7399798">(</span><span class="ident" id="7399799">rx</span><span class="op" id="7399801">,</span>&nbsp;<span class="ident" id="7399803">n</span><span class="op" id="7399804">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7399807">exp</span>&nbsp;<span class="op" id="7399811">:=</span>&nbsp;<span class="ident" id="7399814">rx</span><span class="op" id="7399816">.</span><span class="ident" id="7399817">FindAllStringIndex</span><span class="op" id="7399835">(</span><span class="ident" id="7399836">tc</span><span class="op" id="7399838">.</span><span class="ident" id="7399839">source</span><span class="op" id="7399845">,</span>&nbsp;<span class="ident" id="7399847">n</span><span class="op" id="7399848">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7399852">//&nbsp;check&nbsp;that&nbsp;the&nbsp;lengths&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7399885">if</span>&nbsp;<span class="builtinfunc" id="7399888">len</span><span class="op" id="7399891">(</span><span class="ident" id="7399892">res</span><span class="op" id="7399895">)</span>&nbsp;<span class="op" id="7399897">!=</span>&nbsp;<span class="builtinfunc" id="7399900">len</span><span class="op" id="7399903">(</span><span class="ident" id="7399904">exp</span><span class="op" id="7399907">)</span>&nbsp;<span class="op" id="7399909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7399913">t</span><span class="op" id="7399914">.</span><span class="ident" id="7399915">Errorf</span><span class="op" id="7399921">(</span><span class="string" id="7399922">&#34;test&nbsp;%q,&nbsp;FindAllIndex&nbsp;%q&nbsp;(n&nbsp;=&nbsp;%d):&nbsp;expected&nbsp;%d&nbsp;results;&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7399986">,</span>&nbsp;<span class="ident" id="7399988">tc</span><span class="op" id="7399990">.</span><span class="ident" id="7399991">name</span><span class="op" id="7399995">,</span>&nbsp;<span class="ident" id="7399997">rx</span><span class="op" id="7399999">,</span>&nbsp;<span class="ident" id="7400001">n</span><span class="op" id="7400002">,</span>&nbsp;<span class="builtinfunc" id="7400004">len</span><span class="op" id="7400007">(</span><span class="ident" id="7400008">exp</span><span class="op" id="7400011">)</span><span class="op" id="7400012">,</span>&nbsp;<span class="builtinfunc" id="7400014">len</span><span class="op" id="7400017">(</span><span class="ident" id="7400018">res</span><span class="op" id="7400021">)</span><span class="op" id="7400022">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7400025">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7400029">//&nbsp;if&nbsp;n&nbsp;&gt;=&nbsp;0&nbsp;the&nbsp;number&nbsp;of&nbsp;results&nbsp;is&nbsp;limited&nbsp;---&nbsp;unless&nbsp;n&nbsp;&gt;=&nbsp;all&nbsp;results,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7400105">//&nbsp;we&nbsp;may&nbsp;obtain&nbsp;different&nbsp;positions&nbsp;from&nbsp;the&nbsp;Index&nbsp;and&nbsp;from&nbsp;regexp&nbsp;(because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7400183">//&nbsp;Index&nbsp;may&nbsp;not&nbsp;find&nbsp;the&nbsp;results&nbsp;in&nbsp;the&nbsp;same&nbsp;order&nbsp;as&nbsp;regexp)&nbsp;=&gt;&nbsp;in&nbsp;general</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7400261">//&nbsp;we&nbsp;cannot&nbsp;simply&nbsp;check&nbsp;that&nbsp;the&nbsp;res&nbsp;and&nbsp;exp&nbsp;lists&nbsp;are&nbsp;equal</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7400326">//&nbsp;check&nbsp;that&nbsp;each&nbsp;result&nbsp;is&nbsp;in&nbsp;fact&nbsp;a&nbsp;correct&nbsp;match&nbsp;and&nbsp;the&nbsp;result&nbsp;is&nbsp;sorted</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7400405">for</span>&nbsp;<span class="ident" id="7400409">i</span><span class="op" id="7400410">,</span>&nbsp;<span class="ident" id="7400412">r</span>&nbsp;<span class="op" id="7400414">:=</span>&nbsp;<span class="keyword" id="7400417">range</span>&nbsp;<span class="ident" id="7400423">res</span>&nbsp;<span class="op" id="7400427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7400431">if</span>&nbsp;<span class="ident" id="7400434">r</span><span class="op" id="7400435">[</span><span class="num" id="7400436">0</span><span class="op" id="7400437">]</span>&nbsp;<span class="op" id="7400439">&lt;</span>&nbsp;<span class="num" id="7400441">0</span>&nbsp;<span class="op" id="7400443">||</span>&nbsp;<span class="ident" id="7400446">r</span><span class="op" id="7400447">[</span><span class="num" id="7400448">0</span><span class="op" id="7400449">]</span>&nbsp;<span class="op" id="7400451">&gt;</span>&nbsp;<span class="ident" id="7400453">r</span><span class="op" id="7400454">[</span><span class="num" id="7400455">1</span><span class="op" id="7400456">]</span>&nbsp;<span class="op" id="7400458">||</span>&nbsp;<span class="builtinfunc" id="7400461">len</span><span class="op" id="7400464">(</span><span class="ident" id="7400465">tc</span><span class="op" id="7400467">.</span><span class="ident" id="7400468">source</span><span class="op" id="7400474">)</span>&nbsp;<span class="op" id="7400476">&lt;</span>&nbsp;<span class="ident" id="7400478">r</span><span class="op" id="7400479">[</span><span class="num" id="7400480">1</span><span class="op" id="7400481">]</span>&nbsp;<span class="op" id="7400483">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7400488">t</span><span class="op" id="7400489">.</span><span class="ident" id="7400490">Errorf</span><span class="op" id="7400496">(</span><span class="string" id="7400497">&#34;test&nbsp;%q,&nbsp;FindAllIndex&nbsp;%q,&nbsp;result&nbsp;%d&nbsp;(n&nbsp;==&nbsp;%d):&nbsp;illegal&nbsp;match&nbsp;[%d,&nbsp;%d]&#34;</span><span class="op" id="7400568">,</span>&nbsp;<span class="ident" id="7400570">tc</span><span class="op" id="7400572">.</span><span class="ident" id="7400573">name</span><span class="op" id="7400577">,</span>&nbsp;<span class="ident" id="7400579">rx</span><span class="op" id="7400581">,</span>&nbsp;<span class="ident" id="7400583">i</span><span class="op" id="7400584">,</span>&nbsp;<span class="ident" id="7400586">n</span><span class="op" id="7400587">,</span>&nbsp;<span class="ident" id="7400589">r</span><span class="op" id="7400590">[</span><span class="num" id="7400591">0</span><span class="op" id="7400592">]</span><span class="op" id="7400593">,</span>&nbsp;<span class="ident" id="7400595">r</span><span class="op" id="7400596">[</span><span class="num" id="7400597">1</span><span class="op" id="7400598">]</span><span class="op" id="7400599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7400603">}</span>&nbsp;<span class="keyword" id="7400605">else</span>&nbsp;<span class="keyword" id="7400610">if</span>&nbsp;<span class="op" id="7400613">!</span><span class="ident" id="7400614">rx</span><span class="op" id="7400616">.</span><span class="ident" id="7400617">MatchString</span><span class="op" id="7400628">(</span><span class="ident" id="7400629">tc</span><span class="op" id="7400631">.</span><span class="ident" id="7400632">source</span><span class="op" id="7400638">[</span><span class="ident" id="7400639">r</span><span class="op" id="7400640">[</span><span class="num" id="7400641">0</span><span class="op" id="7400642">]</span><span class="op" id="7400643">:</span><span class="ident" id="7400644">r</span><span class="op" id="7400645">[</span><span class="num" id="7400646">1</span><span class="op" id="7400647">]</span><span class="op" id="7400648">]</span><span class="op" id="7400649">)</span>&nbsp;<span class="op" id="7400651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7400656">t</span><span class="op" id="7400657">.</span><span class="ident" id="7400658">Errorf</span><span class="op" id="7400664">(</span><span class="string" id="7400665">&#34;test&nbsp;%q,&nbsp;FindAllIndex&nbsp;%q,&nbsp;result&nbsp;%d&nbsp;(n&nbsp;=&nbsp;%d):&nbsp;[%d,&nbsp;%d]&nbsp;not&nbsp;a&nbsp;match&#34;</span><span class="op" id="7400733">,</span>&nbsp;<span class="ident" id="7400735">tc</span><span class="op" id="7400737">.</span><span class="ident" id="7400738">name</span><span class="op" id="7400742">,</span>&nbsp;<span class="ident" id="7400744">rx</span><span class="op" id="7400746">,</span>&nbsp;<span class="ident" id="7400748">i</span><span class="op" id="7400749">,</span>&nbsp;<span class="ident" id="7400751">n</span><span class="op" id="7400752">,</span>&nbsp;<span class="ident" id="7400754">r</span><span class="op" id="7400755">[</span><span class="num" id="7400756">0</span><span class="op" id="7400757">]</span><span class="op" id="7400758">,</span>&nbsp;<span class="ident" id="7400760">r</span><span class="op" id="7400761">[</span><span class="num" id="7400762">1</span><span class="op" id="7400763">]</span><span class="op" id="7400764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7400768">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7400771">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7400775">if</span>&nbsp;<span class="ident" id="7400778">n</span>&nbsp;<span class="op" id="7400780">&lt;</span>&nbsp;<span class="num" id="7400782">0</span>&nbsp;<span class="op" id="7400784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7400788">//&nbsp;all&nbsp;results&nbsp;computed&nbsp;-&nbsp;sorted&nbsp;res&nbsp;and&nbsp;exp&nbsp;must&nbsp;be&nbsp;equal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7400849">for</span>&nbsp;<span class="ident" id="7400853">i</span><span class="op" id="7400854">,</span>&nbsp;<span class="ident" id="7400856">r</span>&nbsp;<span class="op" id="7400858">:=</span>&nbsp;<span class="keyword" id="7400861">range</span>&nbsp;<span class="ident" id="7400867">res</span>&nbsp;<span class="op" id="7400871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7400876">e</span>&nbsp;<span class="op" id="7400878">:=</span>&nbsp;<span class="ident" id="7400881">exp</span><span class="op" id="7400884">[</span><span class="ident" id="7400885">i</span><span class="op" id="7400886">]</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7400891">if</span>&nbsp;<span class="ident" id="7400894">r</span><span class="op" id="7400895">[</span><span class="num" id="7400896">0</span><span class="op" id="7400897">]</span>&nbsp;<span class="op" id="7400899">!=</span>&nbsp;<span class="ident" id="7400902">e</span><span class="op" id="7400903">[</span><span class="num" id="7400904">0</span><span class="op" id="7400905">]</span>&nbsp;<span class="op" id="7400907">||</span>&nbsp;<span class="ident" id="7400910">r</span><span class="op" id="7400911">[</span><span class="num" id="7400912">1</span><span class="op" id="7400913">]</span>&nbsp;<span class="op" id="7400915">!=</span>&nbsp;<span class="ident" id="7400918">e</span><span class="op" id="7400919">[</span><span class="num" id="7400920">1</span><span class="op" id="7400921">]</span>&nbsp;<span class="op" id="7400923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7400929">t</span><span class="op" id="7400930">.</span><span class="ident" id="7400931">Errorf</span><span class="op" id="7400937">(</span><span class="string" id="7400938">&#34;test&nbsp;%q,&nbsp;FindAllIndex&nbsp;%q,&nbsp;result&nbsp;%d:&nbsp;expected&nbsp;match&nbsp;[%d,&nbsp;%d];&nbsp;got&nbsp;[%d,&nbsp;%d]&#34;</span><span class="op" id="7401014">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7401021">tc</span><span class="op" id="7401023">.</span><span class="ident" id="7401024">name</span><span class="op" id="7401028">,</span>&nbsp;<span class="ident" id="7401030">rx</span><span class="op" id="7401032">,</span>&nbsp;<span class="ident" id="7401034">i</span><span class="op" id="7401035">,</span>&nbsp;<span class="ident" id="7401037">e</span><span class="op" id="7401038">[</span><span class="num" id="7401039">0</span><span class="op" id="7401040">]</span><span class="op" id="7401041">,</span>&nbsp;<span class="ident" id="7401043">e</span><span class="op" id="7401044">[</span><span class="num" id="7401045">1</span><span class="op" id="7401046">]</span><span class="op" id="7401047">,</span>&nbsp;<span class="ident" id="7401049">r</span><span class="op" id="7401050">[</span><span class="num" id="7401051">0</span><span class="op" id="7401052">]</span><span class="op" id="7401053">,</span>&nbsp;<span class="ident" id="7401055">r</span><span class="op" id="7401056">[</span><span class="num" id="7401057">1</span><span class="op" id="7401058">]</span><span class="op" id="7401059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7401064">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7401068">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7401071">}</span><br>
<span class="lineno"></span><span class="op" id="7401073">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7401076">func</span>&nbsp;<span class="ident" id="7401081">testLookups</span><span class="op" id="7401092">(</span><span class="ident" id="7401093">t</span>&nbsp;<span class="op" id="7401095">*</span><span class="ident" id="7401096">testing</span><span class="op" id="7401103">.</span><span class="ident" id="7401104">T</span><span class="op" id="7401105">,</span>&nbsp;<span class="ident" id="7401107">tc</span>&nbsp;<span class="op" id="7401110">*</span><span class="ident" id="7401111">testCase</span><span class="op" id="7401119">,</span>&nbsp;<span class="ident" id="7401121">x</span>&nbsp;<span class="op" id="7401123">*</span><span class="ident" id="7401124">Index</span><span class="op" id="7401129">,</span>&nbsp;<span class="ident" id="7401131">n</span>&nbsp;<span class="builtintype" id="7401133">int</span><span class="op" id="7401136">)</span>&nbsp;<span class="op" id="7401138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7401141">for</span>&nbsp;<span class="ident" id="7401145">_</span><span class="op" id="7401146">,</span>&nbsp;<span class="ident" id="7401148">pat</span>&nbsp;<span class="op" id="7401152">:=</span>&nbsp;<span class="keyword" id="7401155">range</span>&nbsp;<span class="ident" id="7401161">tc</span><span class="op" id="7401163">.</span><span class="ident" id="7401164">patterns</span>&nbsp;<span class="op" id="7401173">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7401177">testLookup</span><span class="op" id="7401187">(</span><span class="ident" id="7401188">t</span><span class="op" id="7401189">,</span>&nbsp;<span class="ident" id="7401191">tc</span><span class="op" id="7401193">,</span>&nbsp;<span class="ident" id="7401195">x</span><span class="op" id="7401196">,</span>&nbsp;<span class="ident" id="7401198">pat</span><span class="op" id="7401201">,</span>&nbsp;<span class="ident" id="7401203">n</span><span class="op" id="7401204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7401208">if</span>&nbsp;<span class="ident" id="7401211">rx</span><span class="op" id="7401213">,</span>&nbsp;<span class="ident" id="7401215">err</span>&nbsp;<span class="op" id="7401219">:=</span>&nbsp;<span class="ident" id="7401222">regexp</span><span class="op" id="7401228">.</span><span class="ident" id="7401229">Compile</span><span class="op" id="7401236">(</span><span class="ident" id="7401237">pat</span><span class="op" id="7401240">)</span><span class="op" id="7401241">;</span>&nbsp;<span class="ident" id="7401243">err</span>&nbsp;<span class="op" id="7401247">==</span>&nbsp;<span class="builtintype" id="7401250">nil</span>&nbsp;<span class="op" id="7401254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7401259">testFindAllIndex</span><span class="op" id="7401275">(</span><span class="ident" id="7401276">t</span><span class="op" id="7401277">,</span>&nbsp;<span class="ident" id="7401279">tc</span><span class="op" id="7401281">,</span>&nbsp;<span class="ident" id="7401283">x</span><span class="op" id="7401284">,</span>&nbsp;<span class="ident" id="7401286">rx</span><span class="op" id="7401288">,</span>&nbsp;<span class="ident" id="7401290">n</span><span class="op" id="7401291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7401295">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7401298">}</span><br>
<span class="lineno">205</span><span class="op" id="7401300">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7401303">//&nbsp;index&nbsp;is&nbsp;used&nbsp;to&nbsp;hide&nbsp;the&nbsp;sort.Interface</span><br>
<span class="lineno"></span><span class="keyword" id="7401347">type</span>&nbsp;<span class="ident" id="7401352">index</span>&nbsp;<span class="ident" id="7401358">Index</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span><span class="keyword" id="7401365">func</span>&nbsp;<span class="op" id="7401370">(</span><span class="ident" id="7401371">x</span>&nbsp;<span class="op" id="7401373">*</span><span class="ident" id="7401374">index</span><span class="op" id="7401379">)</span>&nbsp;<span class="ident" id="7401381">Len</span><span class="op" id="7401384">(</span><span class="op" id="7401385">)</span>&nbsp;<span class="builtintype" id="7401387">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7401401">{</span>&nbsp;<span class="keyword" id="7401403">return</span>&nbsp;<span class="builtinfunc" id="7401410">len</span><span class="op" id="7401413">(</span><span class="ident" id="7401414">x</span><span class="op" id="7401415">.</span><span class="ident" id="7401416">sa</span><span class="op" id="7401418">)</span>&nbsp;<span class="op" id="7401420">}</span><br>
<span class="lineno"></span><span class="keyword" id="7401422">func</span>&nbsp;<span class="op" id="7401427">(</span><span class="ident" id="7401428">x</span>&nbsp;<span class="op" id="7401430">*</span><span class="ident" id="7401431">index</span><span class="op" id="7401436">)</span>&nbsp;<span class="ident" id="7401438">Less</span><span class="op" id="7401442">(</span><span class="ident" id="7401443">i</span><span class="op" id="7401444">,</span>&nbsp;<span class="ident" id="7401446">j</span>&nbsp;<span class="builtintype" id="7401448">int</span><span class="op" id="7401451">)</span>&nbsp;<span class="builtintype" id="7401453">bool</span>&nbsp;<span class="op" id="7401458">{</span>&nbsp;<span class="keyword" id="7401460">return</span>&nbsp;<span class="ident" id="7401467">bytes</span><span class="op" id="7401472">.</span><span class="ident" id="7401473">Compare</span><span class="op" id="7401480">(</span><span class="ident" id="7401481">x</span><span class="op" id="7401482">.</span><span class="ident" id="7401483">at</span><span class="op" id="7401485">(</span><span class="ident" id="7401486">i</span><span class="op" id="7401487">)</span><span class="op" id="7401488">,</span>&nbsp;<span class="ident" id="7401490">x</span><span class="op" id="7401491">.</span><span class="ident" id="7401492">at</span><span class="op" id="7401494">(</span><span class="ident" id="7401495">j</span><span class="op" id="7401496">)</span><span class="op" id="7401497">)</span>&nbsp;<span class="op" id="7401499">&lt;</span>&nbsp;<span class="num" id="7401501">0</span>&nbsp;<span class="op" id="7401503">}</span><br>
<span class="lineno"></span><span class="keyword" id="7401505">func</span>&nbsp;<span class="op" id="7401510">(</span><span class="ident" id="7401511">x</span>&nbsp;<span class="op" id="7401513">*</span><span class="ident" id="7401514">index</span><span class="op" id="7401519">)</span>&nbsp;<span class="ident" id="7401521">Swap</span><span class="op" id="7401525">(</span><span class="ident" id="7401526">i</span><span class="op" id="7401527">,</span>&nbsp;<span class="ident" id="7401529">j</span>&nbsp;<span class="builtintype" id="7401531">int</span><span class="op" id="7401534">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7401541">{</span>&nbsp;<span class="ident" id="7401543">x</span><span class="op" id="7401544">.</span><span class="ident" id="7401545">sa</span><span class="op" id="7401547">[</span><span class="ident" id="7401548">i</span><span class="op" id="7401549">]</span><span class="op" id="7401550">,</span>&nbsp;<span class="ident" id="7401552">x</span><span class="op" id="7401553">.</span><span class="ident" id="7401554">sa</span><span class="op" id="7401556">[</span><span class="ident" id="7401557">j</span><span class="op" id="7401558">]</span>&nbsp;<span class="op" id="7401560">=</span>&nbsp;<span class="ident" id="7401562">x</span><span class="op" id="7401563">.</span><span class="ident" id="7401564">sa</span><span class="op" id="7401566">[</span><span class="ident" id="7401567">j</span><span class="op" id="7401568">]</span><span class="op" id="7401569">,</span>&nbsp;<span class="ident" id="7401571">x</span><span class="op" id="7401572">.</span><span class="ident" id="7401573">sa</span><span class="op" id="7401575">[</span><span class="ident" id="7401576">i</span><span class="op" id="7401577">]</span>&nbsp;<span class="op" id="7401579">}</span><br>
<span class="lineno"></span><span class="keyword" id="7401581">func</span>&nbsp;<span class="op" id="7401586">(</span><span class="ident" id="7401587">a</span>&nbsp;<span class="op" id="7401589">*</span><span class="ident" id="7401590">index</span><span class="op" id="7401595">)</span>&nbsp;<span class="ident" id="7401597">at</span><span class="op" id="7401599">(</span><span class="ident" id="7401600">i</span>&nbsp;<span class="builtintype" id="7401602">int</span><span class="op" id="7401605">)</span>&nbsp;<span class="op" id="7401607">[</span><span class="op" id="7401608">]</span><span class="builtintype" id="7401609">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7401617">{</span>&nbsp;<span class="keyword" id="7401619">return</span>&nbsp;<span class="ident" id="7401626">a</span><span class="op" id="7401627">.</span><span class="ident" id="7401628">data</span><span class="op" id="7401632">[</span><span class="ident" id="7401633">a</span><span class="op" id="7401634">.</span><span class="ident" id="7401635">sa</span><span class="op" id="7401637">[</span><span class="ident" id="7401638">i</span><span class="op" id="7401639">]</span><span class="op" id="7401640">:</span><span class="op" id="7401641">]</span>&nbsp;<span class="op" id="7401643">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="keyword" id="7401646">func</span>&nbsp;<span class="ident" id="7401651">testConstruction</span><span class="op" id="7401667">(</span><span class="ident" id="7401668">t</span>&nbsp;<span class="op" id="7401670">*</span><span class="ident" id="7401671">testing</span><span class="op" id="7401678">.</span><span class="ident" id="7401679">T</span><span class="op" id="7401680">,</span>&nbsp;<span class="ident" id="7401682">tc</span>&nbsp;<span class="op" id="7401685">*</span><span class="ident" id="7401686">testCase</span><span class="op" id="7401694">,</span>&nbsp;<span class="ident" id="7401696">x</span>&nbsp;<span class="op" id="7401698">*</span><span class="ident" id="7401699">Index</span><span class="op" id="7401704">)</span>&nbsp;<span class="op" id="7401706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7401709">if</span>&nbsp;<span class="op" id="7401712">!</span><span class="ident" id="7401713">sort</span><span class="op" id="7401717">.</span><span class="ident" id="7401718">IsSorted</span><span class="op" id="7401726">(</span><span class="op" id="7401727">(</span><span class="op" id="7401728">*</span><span class="ident" id="7401729">index</span><span class="op" id="7401734">)</span><span class="op" id="7401735">(</span><span class="ident" id="7401736">x</span><span class="op" id="7401737">)</span><span class="op" id="7401738">)</span>&nbsp;<span class="op" id="7401740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7401744">t</span><span class="op" id="7401745">.</span><span class="ident" id="7401746">Errorf</span><span class="op" id="7401752">(</span><span class="string" id="7401753">&#34;failed&nbsp;testConstruction&nbsp;%s&#34;</span><span class="op" id="7401781">,</span>&nbsp;<span class="ident" id="7401783">tc</span><span class="op" id="7401785">.</span><span class="ident" id="7401786">name</span><span class="op" id="7401790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7401793">}</span><br>
<span class="lineno"></span><span class="op" id="7401795">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="keyword" id="7401798">func</span>&nbsp;<span class="ident" id="7401803">equal</span><span class="op" id="7401808">(</span><span class="ident" id="7401809">x</span><span class="op" id="7401810">,</span>&nbsp;<span class="ident" id="7401812">y</span>&nbsp;<span class="op" id="7401814">*</span><span class="ident" id="7401815">Index</span><span class="op" id="7401820">)</span>&nbsp;<span class="builtintype" id="7401822">bool</span>&nbsp;<span class="op" id="7401827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7401830">if</span>&nbsp;<span class="op" id="7401833">!</span><span class="ident" id="7401834">bytes</span><span class="op" id="7401839">.</span><span class="ident" id="7401840">Equal</span><span class="op" id="7401845">(</span><span class="ident" id="7401846">x</span><span class="op" id="7401847">.</span><span class="ident" id="7401848">data</span><span class="op" id="7401852">,</span>&nbsp;<span class="ident" id="7401854">y</span><span class="op" id="7401855">.</span><span class="ident" id="7401856">data</span><span class="op" id="7401860">)</span>&nbsp;<span class="op" id="7401862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7401866">return</span>&nbsp;<span class="builtintype" id="7401873">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7401880">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7401883">for</span>&nbsp;<span class="ident" id="7401887">i</span><span class="op" id="7401888">,</span>&nbsp;<span class="ident" id="7401890">j</span>&nbsp;<span class="op" id="7401892">:=</span>&nbsp;<span class="keyword" id="7401895">range</span>&nbsp;<span class="ident" id="7401901">x</span><span class="op" id="7401902">.</span><span class="ident" id="7401903">sa</span>&nbsp;<span class="op" id="7401906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7401910">if</span>&nbsp;<span class="ident" id="7401913">j</span>&nbsp;<span class="op" id="7401915">!=</span>&nbsp;<span class="ident" id="7401918">y</span><span class="op" id="7401919">.</span><span class="ident" id="7401920">sa</span><span class="op" id="7401922">[</span><span class="ident" id="7401923">i</span><span class="op" id="7401924">]</span>&nbsp;<span class="op" id="7401926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7401931">return</span>&nbsp;<span class="builtintype" id="7401938">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7401946">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7401949">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7401952">return</span>&nbsp;<span class="builtintype" id="7401959">true</span><br>
<span class="lineno"></span><span class="op" id="7401964">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7401967">//&nbsp;returns&nbsp;the&nbsp;serialized&nbsp;index&nbsp;size</span><br>
<span class="lineno"></span><span class="keyword" id="7402004">func</span>&nbsp;<span class="ident" id="7402009">testSaveRestore</span><span class="op" id="7402024">(</span><span class="ident" id="7402025">t</span>&nbsp;<span class="op" id="7402027">*</span><span class="ident" id="7402028">testing</span><span class="op" id="7402035">.</span><span class="ident" id="7402036">T</span><span class="op" id="7402037">,</span>&nbsp;<span class="ident" id="7402039">tc</span>&nbsp;<span class="op" id="7402042">*</span><span class="ident" id="7402043">testCase</span><span class="op" id="7402051">,</span>&nbsp;<span class="ident" id="7402053">x</span>&nbsp;<span class="op" id="7402055">*</span><span class="ident" id="7402056">Index</span><span class="op" id="7402061">)</span>&nbsp;<span class="builtintype" id="7402063">int</span>&nbsp;<span class="op" id="7402067">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7402070">var</span>&nbsp;<span class="ident" id="7402074">buf</span>&nbsp;<span class="ident" id="7402078">bytes</span><span class="op" id="7402083">.</span><span class="ident" id="7402084">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7402092">if</span>&nbsp;<span class="ident" id="7402095">err</span>&nbsp;<span class="op" id="7402099">:=</span>&nbsp;<span class="ident" id="7402102">x</span><span class="op" id="7402103">.</span><span class="ident" id="7402104">Write</span><span class="op" id="7402109">(</span><span class="op" id="7402110">&amp;</span><span class="ident" id="7402111">buf</span><span class="op" id="7402114">)</span><span class="op" id="7402115">;</span>&nbsp;<span class="ident" id="7402117">err</span>&nbsp;<span class="op" id="7402121">!=</span>&nbsp;<span class="builtintype" id="7402124">nil</span>&nbsp;<span class="op" id="7402128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7402132">t</span><span class="op" id="7402133">.</span><span class="ident" id="7402134">Errorf</span><span class="op" id="7402140">(</span><span class="string" id="7402141">&#34;failed&nbsp;writing&nbsp;index&nbsp;%s&nbsp;(%s)&#34;</span><span class="op" id="7402171">,</span>&nbsp;<span class="ident" id="7402173">tc</span><span class="op" id="7402175">.</span><span class="ident" id="7402176">name</span><span class="op" id="7402180">,</span>&nbsp;<span class="ident" id="7402182">err</span><span class="op" id="7402185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7402188">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7402191">size</span>&nbsp;<span class="op" id="7402196">:=</span>&nbsp;<span class="ident" id="7402199">buf</span><span class="op" id="7402202">.</span><span class="ident" id="7402203">Len</span><span class="op" id="7402206">(</span><span class="op" id="7402207">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7402210">var</span>&nbsp;<span class="ident" id="7402214">y</span>&nbsp;<span class="ident" id="7402216">Index</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7402223">if</span>&nbsp;<span class="ident" id="7402226">err</span>&nbsp;<span class="op" id="7402230">:=</span>&nbsp;<span class="ident" id="7402233">y</span><span class="op" id="7402234">.</span><span class="ident" id="7402235">Read</span><span class="op" id="7402239">(</span><span class="op" id="7402240">&amp;</span><span class="ident" id="7402241">buf</span><span class="op" id="7402244">)</span><span class="op" id="7402245">;</span>&nbsp;<span class="ident" id="7402247">err</span>&nbsp;<span class="op" id="7402251">!=</span>&nbsp;<span class="builtintype" id="7402254">nil</span>&nbsp;<span class="op" id="7402258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7402262">t</span><span class="op" id="7402263">.</span><span class="ident" id="7402264">Errorf</span><span class="op" id="7402270">(</span><span class="string" id="7402271">&#34;failed&nbsp;reading&nbsp;index&nbsp;%s&nbsp;(%s)&#34;</span><span class="op" id="7402301">,</span>&nbsp;<span class="ident" id="7402303">tc</span><span class="op" id="7402305">.</span><span class="ident" id="7402306">name</span><span class="op" id="7402310">,</span>&nbsp;<span class="ident" id="7402312">err</span><span class="op" id="7402315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7402318">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7402321">if</span>&nbsp;<span class="op" id="7402324">!</span><span class="ident" id="7402325">equal</span><span class="op" id="7402330">(</span><span class="ident" id="7402331">x</span><span class="op" id="7402332">,</span>&nbsp;<span class="op" id="7402334">&amp;</span><span class="ident" id="7402335">y</span><span class="op" id="7402336">)</span>&nbsp;<span class="op" id="7402338">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7402342">t</span><span class="op" id="7402343">.</span><span class="ident" id="7402344">Errorf</span><span class="op" id="7402350">(</span><span class="string" id="7402351">&#34;restored&nbsp;index&nbsp;doesn&#39;t&nbsp;match&nbsp;saved&nbsp;index&nbsp;%s&#34;</span><span class="op" id="7402396">,</span>&nbsp;<span class="ident" id="7402398">tc</span><span class="op" id="7402400">.</span><span class="ident" id="7402401">name</span><span class="op" id="7402405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7402408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7402411">return</span>&nbsp;<span class="ident" id="7402418">size</span><br>
<span class="lineno"></span><span class="op" id="7402423">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="keyword" id="7402426">func</span>&nbsp;<span class="ident" id="7402431">TestIndex</span><span class="op" id="7402440">(</span><span class="ident" id="7402441">t</span>&nbsp;<span class="op" id="7402443">*</span><span class="ident" id="7402444">testing</span><span class="op" id="7402451">.</span><span class="ident" id="7402452">T</span><span class="op" id="7402453">)</span>&nbsp;<span class="op" id="7402455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7402458">for</span>&nbsp;<span class="ident" id="7402462">_</span><span class="op" id="7402463">,</span>&nbsp;<span class="ident" id="7402465">tc</span>&nbsp;<span class="op" id="7402468">:=</span>&nbsp;<span class="keyword" id="7402471">range</span>&nbsp;<span class="ident" id="7402477">testCases</span>&nbsp;<span class="op" id="7402487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7402491">x</span>&nbsp;<span class="op" id="7402493">:=</span>&nbsp;<span class="ident" id="7402496">New</span><span class="op" id="7402499">(</span><span class="op" id="7402500">[</span><span class="op" id="7402501">]</span><span class="builtintype" id="7402502">byte</span><span class="op" id="7402506">(</span><span class="ident" id="7402507">tc</span><span class="op" id="7402509">.</span><span class="ident" id="7402510">source</span><span class="op" id="7402516">)</span><span class="op" id="7402517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7402521">testConstruction</span><span class="op" id="7402537">(</span><span class="ident" id="7402538">t</span><span class="op" id="7402539">,</span>&nbsp;<span class="op" id="7402541">&amp;</span><span class="ident" id="7402542">tc</span><span class="op" id="7402544">,</span>&nbsp;<span class="ident" id="7402546">x</span><span class="op" id="7402547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7402551">testSaveRestore</span><span class="op" id="7402566">(</span><span class="ident" id="7402567">t</span><span class="op" id="7402568">,</span>&nbsp;<span class="op" id="7402570">&amp;</span><span class="ident" id="7402571">tc</span><span class="op" id="7402573">,</span>&nbsp;<span class="ident" id="7402575">x</span><span class="op" id="7402576">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7402580">testLookups</span><span class="op" id="7402591">(</span><span class="ident" id="7402592">t</span><span class="op" id="7402593">,</span>&nbsp;<span class="op" id="7402595">&amp;</span><span class="ident" id="7402596">tc</span><span class="op" id="7402598">,</span>&nbsp;<span class="ident" id="7402600">x</span><span class="op" id="7402601">,</span>&nbsp;<span class="num" id="7402603">0</span><span class="op" id="7402604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7402608">testLookups</span><span class="op" id="7402619">(</span><span class="ident" id="7402620">t</span><span class="op" id="7402621">,</span>&nbsp;<span class="op" id="7402623">&amp;</span><span class="ident" id="7402624">tc</span><span class="op" id="7402626">,</span>&nbsp;<span class="ident" id="7402628">x</span><span class="op" id="7402629">,</span>&nbsp;<span class="num" id="7402631">1</span><span class="op" id="7402632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7402636">testLookups</span><span class="op" id="7402647">(</span><span class="ident" id="7402648">t</span><span class="op" id="7402649">,</span>&nbsp;<span class="op" id="7402651">&amp;</span><span class="ident" id="7402652">tc</span><span class="op" id="7402654">,</span>&nbsp;<span class="ident" id="7402656">x</span><span class="op" id="7402657">,</span>&nbsp;<span class="num" id="7402659">10</span><span class="op" id="7402661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7402665">testLookups</span><span class="op" id="7402676">(</span><span class="ident" id="7402677">t</span><span class="op" id="7402678">,</span>&nbsp;<span class="op" id="7402680">&amp;</span><span class="ident" id="7402681">tc</span><span class="op" id="7402683">,</span>&nbsp;<span class="ident" id="7402685">x</span><span class="op" id="7402686">,</span>&nbsp;<span class="num" id="7402688">2e9</span><span class="op" id="7402691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7402695">testLookups</span><span class="op" id="7402706">(</span><span class="ident" id="7402707">t</span><span class="op" id="7402708">,</span>&nbsp;<span class="op" id="7402710">&amp;</span><span class="ident" id="7402711">tc</span><span class="op" id="7402713">,</span>&nbsp;<span class="ident" id="7402715">x</span><span class="op" id="7402716">,</span>&nbsp;<span class="op" id="7402718">-</span><span class="num" id="7402719">1</span><span class="op" id="7402720">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7402723">}</span><br>
<span class="lineno"></span><span class="op" id="7402725">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7402728">//&nbsp;Of&nbsp;all&nbsp;possible&nbsp;inputs,&nbsp;the&nbsp;random&nbsp;bytes&nbsp;have&nbsp;the&nbsp;least&nbsp;amount&nbsp;of&nbsp;substring</span><br>
<span class="lineno"></span><span class="comment" id="7402807">//&nbsp;repetition,&nbsp;and&nbsp;the&nbsp;repeated&nbsp;bytes&nbsp;have&nbsp;the&nbsp;most.&nbsp;For&nbsp;most&nbsp;algorithms,</span><br>
<span class="lineno">265</span><span class="comment" id="7402881">//&nbsp;the&nbsp;running&nbsp;time&nbsp;of&nbsp;every&nbsp;input&nbsp;will&nbsp;be&nbsp;between&nbsp;these&nbsp;two.</span><br>
<span class="lineno"></span><span class="keyword" id="7402943">func</span>&nbsp;<span class="ident" id="7402948">benchmarkNew</span><span class="op" id="7402960">(</span><span class="ident" id="7402961">b</span>&nbsp;<span class="op" id="7402963">*</span><span class="ident" id="7402964">testing</span><span class="op" id="7402971">.</span><span class="ident" id="7402972">B</span><span class="op" id="7402973">,</span>&nbsp;<span class="ident" id="7402975">random</span>&nbsp;<span class="builtintype" id="7402982">bool</span><span class="op" id="7402986">)</span>&nbsp;<span class="op" id="7402988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7402991">b</span><span class="op" id="7402992">.</span><span class="ident" id="7402993">StopTimer</span><span class="op" id="7403002">(</span><span class="op" id="7403003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7403006">data</span>&nbsp;<span class="op" id="7403011">:=</span>&nbsp;<span class="builtinfunc" id="7403014">make</span><span class="op" id="7403018">(</span><span class="op" id="7403019">[</span><span class="op" id="7403020">]</span><span class="builtintype" id="7403021">byte</span><span class="op" id="7403025">,</span>&nbsp;<span class="num" id="7403027">1e6</span><span class="op" id="7403030">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7403033">if</span>&nbsp;<span class="ident" id="7403036">random</span>&nbsp;<span class="op" id="7403043">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7403047">for</span>&nbsp;<span class="ident" id="7403051">i</span>&nbsp;<span class="op" id="7403053">:=</span>&nbsp;<span class="keyword" id="7403056">range</span>&nbsp;<span class="ident" id="7403062">data</span>&nbsp;<span class="op" id="7403067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7403072">data</span><span class="op" id="7403076">[</span><span class="ident" id="7403077">i</span><span class="op" id="7403078">]</span>&nbsp;<span class="op" id="7403080">=</span>&nbsp;<span class="builtintype" id="7403082">byte</span><span class="op" id="7403086">(</span><span class="ident" id="7403087">rand</span><span class="op" id="7403091">.</span><span class="ident" id="7403092">Intn</span><span class="op" id="7403096">(</span><span class="num" id="7403097">256</span><span class="op" id="7403100">)</span><span class="op" id="7403101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7403105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7403108">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7403111">b</span><span class="op" id="7403112">.</span><span class="ident" id="7403113">StartTimer</span><span class="op" id="7403123">(</span><span class="op" id="7403124">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7403127">for</span>&nbsp;<span class="ident" id="7403131">i</span>&nbsp;<span class="op" id="7403133">:=</span>&nbsp;<span class="num" id="7403136">0</span><span class="op" id="7403137">;</span>&nbsp;<span class="ident" id="7403139">i</span>&nbsp;<span class="op" id="7403141">&lt;</span>&nbsp;<span class="ident" id="7403143">b</span><span class="op" id="7403144">.</span><span class="ident" id="7403145">N</span><span class="op" id="7403146">;</span>&nbsp;<span class="ident" id="7403148">i</span><span class="op" id="7403149">++</span>&nbsp;<span class="op" id="7403152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7403156">New</span><span class="op" id="7403159">(</span><span class="ident" id="7403160">data</span><span class="op" id="7403164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7403167">}</span><br>
<span class="lineno"></span><span class="op" id="7403169">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span><span class="keyword" id="7403172">func</span>&nbsp;<span class="ident" id="7403177">BenchmarkNewIndexRandom</span><span class="op" id="7403200">(</span><span class="ident" id="7403201">b</span>&nbsp;<span class="op" id="7403203">*</span><span class="ident" id="7403204">testing</span><span class="op" id="7403211">.</span><span class="ident" id="7403212">B</span><span class="op" id="7403213">)</span>&nbsp;<span class="op" id="7403215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7403218">benchmarkNew</span><span class="op" id="7403230">(</span><span class="ident" id="7403231">b</span><span class="op" id="7403232">,</span>&nbsp;<span class="builtintype" id="7403234">true</span><span class="op" id="7403238">)</span><br>
<span class="lineno"></span><span class="op" id="7403240">}</span><br>
<span class="lineno"></span><span class="keyword" id="7403242">func</span>&nbsp;<span class="ident" id="7403247">BenchmarkNewIndexRepeat</span><span class="op" id="7403270">(</span><span class="ident" id="7403271">b</span>&nbsp;<span class="op" id="7403273">*</span><span class="ident" id="7403274">testing</span><span class="op" id="7403281">.</span><span class="ident" id="7403282">B</span><span class="op" id="7403283">)</span>&nbsp;<span class="op" id="7403285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7403288">benchmarkNew</span><span class="op" id="7403300">(</span><span class="ident" id="7403301">b</span><span class="op" id="7403302">,</span>&nbsp;<span class="builtintype" id="7403304">false</span><span class="op" id="7403309">)</span><br>
<span class="lineno">285</span><span class="op" id="7403311">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7403314">func</span>&nbsp;<span class="ident" id="7403319">BenchmarkSaveRestore</span><span class="op" id="7403339">(</span><span class="ident" id="7403340">b</span>&nbsp;<span class="op" id="7403342">*</span><span class="ident" id="7403343">testing</span><span class="op" id="7403350">.</span><span class="ident" id="7403351">B</span><span class="op" id="7403352">)</span>&nbsp;<span class="op" id="7403354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7403357">b</span><span class="op" id="7403358">.</span><span class="ident" id="7403359">StopTimer</span><span class="op" id="7403368">(</span><span class="op" id="7403369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7403372">r</span>&nbsp;<span class="op" id="7403374">:=</span>&nbsp;<span class="ident" id="7403377">rand</span><span class="op" id="7403381">.</span><span class="ident" id="7403382">New</span><span class="op" id="7403385">(</span><span class="ident" id="7403386">rand</span><span class="op" id="7403390">.</span><span class="ident" id="7403391">NewSource</span><span class="op" id="7403400">(</span><span class="num" id="7403401">0x5a77a1</span><span class="op" id="7403409">)</span><span class="op" id="7403410">)</span>&nbsp;<span class="comment" id="7403412">//&nbsp;guarantee&nbsp;always&nbsp;same&nbsp;sequence</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7403447">data</span>&nbsp;<span class="op" id="7403452">:=</span>&nbsp;<span class="builtinfunc" id="7403455">make</span><span class="op" id="7403459">(</span><span class="op" id="7403460">[</span><span class="op" id="7403461">]</span><span class="builtintype" id="7403462">byte</span><span class="op" id="7403466">,</span>&nbsp;<span class="num" id="7403468">1</span><span class="op" id="7403469">&lt;&lt;</span><span class="num" id="7403471">20</span><span class="op" id="7403473">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7403487">//&nbsp;1MB&nbsp;of&nbsp;data&nbsp;to&nbsp;index</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7403512">for</span>&nbsp;<span class="ident" id="7403516">i</span>&nbsp;<span class="op" id="7403518">:=</span>&nbsp;<span class="keyword" id="7403521">range</span>&nbsp;<span class="ident" id="7403527">data</span>&nbsp;<span class="op" id="7403532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7403536">data</span><span class="op" id="7403540">[</span><span class="ident" id="7403541">i</span><span class="op" id="7403542">]</span>&nbsp;<span class="op" id="7403544">=</span>&nbsp;<span class="builtintype" id="7403546">byte</span><span class="op" id="7403550">(</span><span class="ident" id="7403551">r</span><span class="op" id="7403552">.</span><span class="ident" id="7403553">Intn</span><span class="op" id="7403557">(</span><span class="num" id="7403558">256</span><span class="op" id="7403561">)</span><span class="op" id="7403562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7403565">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7403568">x</span>&nbsp;<span class="op" id="7403570">:=</span>&nbsp;<span class="ident" id="7403573">New</span><span class="op" id="7403576">(</span><span class="ident" id="7403577">data</span><span class="op" id="7403581">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7403584">size</span>&nbsp;<span class="op" id="7403589">:=</span>&nbsp;<span class="ident" id="7403592">testSaveRestore</span><span class="op" id="7403607">(</span><span class="builtintype" id="7403608">nil</span><span class="op" id="7403611">,</span>&nbsp;<span class="builtintype" id="7403613">nil</span><span class="op" id="7403616">,</span>&nbsp;<span class="ident" id="7403618">x</span><span class="op" id="7403619">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7403627">//&nbsp;verify&nbsp;correctness</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7403650">buf</span>&nbsp;<span class="op" id="7403654">:=</span>&nbsp;<span class="ident" id="7403657">bytes</span><span class="op" id="7403662">.</span><span class="ident" id="7403663">NewBuffer</span><span class="op" id="7403672">(</span><span class="builtinfunc" id="7403673">make</span><span class="op" id="7403677">(</span><span class="op" id="7403678">[</span><span class="op" id="7403679">]</span><span class="builtintype" id="7403680">byte</span><span class="op" id="7403684">,</span>&nbsp;<span class="ident" id="7403686">size</span><span class="op" id="7403690">)</span><span class="op" id="7403691">)</span>&nbsp;<span class="comment" id="7403693">//&nbsp;avoid&nbsp;growing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7403711">b</span><span class="op" id="7403712">.</span><span class="ident" id="7403713">SetBytes</span><span class="op" id="7403721">(</span><span class="ident" id="7403722">int64</span><span class="op" id="7403727">(</span><span class="ident" id="7403728">size</span><span class="op" id="7403732">)</span><span class="op" id="7403733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7403736">b</span><span class="op" id="7403737">.</span><span class="ident" id="7403738">StartTimer</span><span class="op" id="7403748">(</span><span class="op" id="7403749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7403752">for</span>&nbsp;<span class="ident" id="7403756">i</span>&nbsp;<span class="op" id="7403758">:=</span>&nbsp;<span class="num" id="7403761">0</span><span class="op" id="7403762">;</span>&nbsp;<span class="ident" id="7403764">i</span>&nbsp;<span class="op" id="7403766">&lt;</span>&nbsp;<span class="ident" id="7403768">b</span><span class="op" id="7403769">.</span><span class="ident" id="7403770">N</span><span class="op" id="7403771">;</span>&nbsp;<span class="ident" id="7403773">i</span><span class="op" id="7403774">++</span>&nbsp;<span class="op" id="7403777">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7403781">x</span><span class="op" id="7403782">.</span><span class="ident" id="7403783">Write</span><span class="op" id="7403788">(</span><span class="ident" id="7403789">buf</span><span class="op" id="7403792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7403796">var</span>&nbsp;<span class="ident" id="7403800">y</span>&nbsp;<span class="ident" id="7403802">Index</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7403810">y</span><span class="op" id="7403811">.</span><span class="ident" id="7403812">Read</span><span class="op" id="7403816">(</span><span class="ident" id="7403817">buf</span><span class="op" id="7403820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7403823">}</span><br>
<span class="lineno"></span><span class="op" id="7403825">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
