<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/elliptic</h2>
<ul>
<li><a href="/gostd/crypto/elliptic/elliptic.go.html">elliptic.go</a></li>
<li><a href="/gostd/crypto/elliptic/elliptic_test.go.html">elliptic_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224.go.html">p224.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224_test.go.html" class="current">p224_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p256.go.html">p256.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8372041">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8372097">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8372151">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8372202">package</span>&nbsp;<span class="ident" id="8372210">elliptic</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8372220">import</span>&nbsp;<span class="op" id="8372227">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8372230">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8372242">&#34;testing&#34;</span><br>
<span class="lineno">10</span><span class="op" id="8372252">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8372255">var</span>&nbsp;<span class="ident" id="8372259">toFromBigTests</span>&nbsp;<span class="op" id="8372274">=</span>&nbsp;<span class="op" id="8372276">[</span><span class="op" id="8372277">]</span><span class="builtintype" id="8372278">string</span><span class="op" id="8372284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8372287">&#34;0&#34;</span><span class="op" id="8372290">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8372293">&#34;1&#34;</span><span class="op" id="8372296">,</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8372299">&#34;23&#34;</span><span class="op" id="8372303">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8372306">&#34;b70e0cb46bb4bf7f321390b94a03c1d356c01122343280d6105c1d21&#34;</span><span class="op" id="8372364">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8372367">&#34;706a46d476dcb76798e6046d89474788d164c18032d268fd10704fa6&#34;</span><span class="op" id="8372425">,</span><br>
<span class="lineno"></span><span class="op" id="8372427">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="8372430">func</span>&nbsp;<span class="ident" id="8372435">p224AlternativeToBig</span><span class="op" id="8372455">(</span><span class="ident" id="8372456">in</span>&nbsp;<span class="op" id="8372459">*</span><span class="ident" id="8372460">p224FieldElement</span><span class="op" id="8372476">)</span>&nbsp;<span class="op" id="8372478">*</span><span class="ident" id="8372479">big</span><span class="op" id="8372482">.</span><span class="ident" id="8372483">Int</span>&nbsp;<span class="op" id="8372487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8372490">ret</span>&nbsp;<span class="op" id="8372494">:=</span>&nbsp;<span class="builtinfunc" id="8372497">new</span><span class="op" id="8372500">(</span><span class="ident" id="8372501">big</span><span class="op" id="8372504">.</span><span class="ident" id="8372505">Int</span><span class="op" id="8372508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8372511">tmp</span>&nbsp;<span class="op" id="8372515">:=</span>&nbsp;<span class="builtinfunc" id="8372518">new</span><span class="op" id="8372521">(</span><span class="ident" id="8372522">big</span><span class="op" id="8372525">.</span><span class="ident" id="8372526">Int</span><span class="op" id="8372529">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8372533">for</span>&nbsp;<span class="ident" id="8372537">i</span>&nbsp;<span class="op" id="8372539">:=</span>&nbsp;<span class="builtintype" id="8372542">uint</span><span class="op" id="8372546">(</span><span class="num" id="8372547">0</span><span class="op" id="8372548">)</span><span class="op" id="8372549">;</span>&nbsp;<span class="ident" id="8372551">i</span>&nbsp;<span class="op" id="8372553">&lt;</span>&nbsp;<span class="num" id="8372555">8</span><span class="op" id="8372556">;</span>&nbsp;<span class="ident" id="8372558">i</span><span class="op" id="8372559">++</span>&nbsp;<span class="op" id="8372562">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8372566">tmp</span><span class="op" id="8372569">.</span><span class="ident" id="8372570">SetInt64</span><span class="op" id="8372578">(</span><span class="ident" id="8372579">int64</span><span class="op" id="8372584">(</span><span class="ident" id="8372585">in</span><span class="op" id="8372587">[</span><span class="ident" id="8372588">i</span><span class="op" id="8372589">]</span><span class="op" id="8372590">)</span><span class="op" id="8372591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8372595">tmp</span><span class="op" id="8372598">.</span><span class="ident" id="8372599">Lsh</span><span class="op" id="8372602">(</span><span class="ident" id="8372603">tmp</span><span class="op" id="8372606">,</span>&nbsp;<span class="num" id="8372608">28</span><span class="op" id="8372610">*</span><span class="ident" id="8372611">i</span><span class="op" id="8372612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8372616">ret</span><span class="op" id="8372619">.</span><span class="ident" id="8372620">Add</span><span class="op" id="8372623">(</span><span class="ident" id="8372624">ret</span><span class="op" id="8372627">,</span>&nbsp;<span class="ident" id="8372629">tmp</span><span class="op" id="8372632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8372635">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8372638">ret</span><span class="op" id="8372641">.</span><span class="ident" id="8372642">Mod</span><span class="op" id="8372645">(</span><span class="ident" id="8372646">ret</span><span class="op" id="8372649">,</span>&nbsp;<span class="ident" id="8372651">p224</span><span class="op" id="8372655">.</span><span class="ident" id="8372656">P</span><span class="op" id="8372657">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8372660">return</span>&nbsp;<span class="ident" id="8372667">ret</span><br>
<span class="lineno"></span><span class="op" id="8372671">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8372674">func</span>&nbsp;<span class="ident" id="8372679">TestToFromBig</span><span class="op" id="8372692">(</span><span class="ident" id="8372693">t</span>&nbsp;<span class="op" id="8372695">*</span><span class="ident" id="8372696">testing</span><span class="op" id="8372703">.</span><span class="ident" id="8372704">T</span><span class="op" id="8372705">)</span>&nbsp;<span class="op" id="8372707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8372710">for</span>&nbsp;<span class="ident" id="8372714">i</span><span class="op" id="8372715">,</span>&nbsp;<span class="ident" id="8372717">test</span>&nbsp;<span class="op" id="8372722">:=</span>&nbsp;<span class="keyword" id="8372725">range</span>&nbsp;<span class="ident" id="8372731">toFromBigTests</span>&nbsp;<span class="op" id="8372746">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8372750">n</span><span class="op" id="8372751">,</span>&nbsp;<span class="ident" id="8372753">_</span>&nbsp;<span class="op" id="8372755">:=</span>&nbsp;<span class="builtinfunc" id="8372758">new</span><span class="op" id="8372761">(</span><span class="ident" id="8372762">big</span><span class="op" id="8372765">.</span><span class="ident" id="8372766">Int</span><span class="op" id="8372769">)</span><span class="op" id="8372770">.</span><span class="ident" id="8372771">SetString</span><span class="op" id="8372780">(</span><span class="ident" id="8372781">test</span><span class="op" id="8372785">,</span>&nbsp;<span class="num" id="8372787">16</span><span class="op" id="8372789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8372793">var</span>&nbsp;<span class="ident" id="8372797">x</span>&nbsp;<span class="ident" id="8372799">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8372818">p224FromBig</span><span class="op" id="8372829">(</span><span class="op" id="8372830">&amp;</span><span class="ident" id="8372831">x</span><span class="op" id="8372832">,</span>&nbsp;<span class="ident" id="8372834">n</span><span class="op" id="8372835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8372839">m</span>&nbsp;<span class="op" id="8372841">:=</span>&nbsp;<span class="ident" id="8372844">p224ToBig</span><span class="op" id="8372853">(</span><span class="op" id="8372854">&amp;</span><span class="ident" id="8372855">x</span><span class="op" id="8372856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8372860">if</span>&nbsp;<span class="ident" id="8372863">n</span><span class="op" id="8372864">.</span><span class="ident" id="8372865">Cmp</span><span class="op" id="8372868">(</span><span class="ident" id="8372869">m</span><span class="op" id="8372870">)</span>&nbsp;<span class="op" id="8372872">!=</span>&nbsp;<span class="num" id="8372875">0</span>&nbsp;<span class="op" id="8372877">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8372882">t</span><span class="op" id="8372883">.</span><span class="ident" id="8372884">Errorf</span><span class="op" id="8372890">(</span><span class="string" id="8372891">&#34;#%d:&nbsp;%x&nbsp;!=&nbsp;%x&#34;</span><span class="op" id="8372906">,</span>&nbsp;<span class="ident" id="8372908">i</span><span class="op" id="8372909">,</span>&nbsp;<span class="ident" id="8372911">n</span><span class="op" id="8372912">,</span>&nbsp;<span class="ident" id="8372914">m</span><span class="op" id="8372915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8372919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8372923">q</span>&nbsp;<span class="op" id="8372925">:=</span>&nbsp;<span class="ident" id="8372928">p224AlternativeToBig</span><span class="op" id="8372948">(</span><span class="op" id="8372949">&amp;</span><span class="ident" id="8372950">x</span><span class="op" id="8372951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8372955">if</span>&nbsp;<span class="ident" id="8372958">n</span><span class="op" id="8372959">.</span><span class="ident" id="8372960">Cmp</span><span class="op" id="8372963">(</span><span class="ident" id="8372964">q</span><span class="op" id="8372965">)</span>&nbsp;<span class="op" id="8372967">!=</span>&nbsp;<span class="num" id="8372970">0</span>&nbsp;<span class="op" id="8372972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8372977">t</span><span class="op" id="8372978">.</span><span class="ident" id="8372979">Errorf</span><span class="op" id="8372985">(</span><span class="string" id="8372986">&#34;#%d:&nbsp;%x&nbsp;!=&nbsp;%x&nbsp;(alternative)&#34;</span><span class="op" id="8373015">,</span>&nbsp;<span class="ident" id="8373017">i</span><span class="op" id="8373018">,</span>&nbsp;<span class="ident" id="8373020">n</span><span class="op" id="8373021">,</span>&nbsp;<span class="ident" id="8373023">m</span><span class="op" id="8373024">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8373028">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8373031">}</span><br>
<span class="lineno"></span><span class="op" id="8373033">}</span>
</div>
</body>
</html>
