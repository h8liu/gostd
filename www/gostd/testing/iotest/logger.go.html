<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>testing/iotest</h2>
<ul>
<li><a href="/gostd/testing/iotest/logger.go.html" class="current">logger.go</a></li>
<li><a href="/gostd/testing/iotest/reader.go.html">reader.go</a></li>
<li><a href="/gostd/testing/iotest/writer.go.html">writer.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5416932">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5416987">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5417041">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5417092">package</span>&nbsp;<span class="ident" id="5417100">iotest</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5417108">import</span>&nbsp;<span class="op" id="5417115">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5417118">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5417124">&#34;log&#34;</span><br>
<span class="lineno">10</span><span class="op" id="5417130">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5417133">type</span>&nbsp;<span class="ident" id="5417138">writeLogger</span>&nbsp;<span class="keyword" id="5417150">struct</span>&nbsp;<span class="op" id="5417157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5417160">prefix</span>&nbsp;<span class="builtintype" id="5417167">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5417175">w</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5417182">io</span><span class="op" id="5417184">.</span><span class="ident" id="5417185">Writer</span><br>
<span class="lineno">15</span><span class="op" id="5417192">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5417195">func</span>&nbsp;<span class="op" id="5417200">(</span><span class="ident" id="5417201">l</span>&nbsp;<span class="op" id="5417203">*</span><span class="ident" id="5417204">writeLogger</span><span class="op" id="5417215">)</span>&nbsp;<span class="ident" id="5417217">Write</span><span class="op" id="5417222">(</span><span class="ident" id="5417223">p</span>&nbsp;<span class="op" id="5417225">[</span><span class="op" id="5417226">]</span><span class="builtintype" id="5417227">byte</span><span class="op" id="5417231">)</span>&nbsp;<span class="op" id="5417233">(</span><span class="ident" id="5417234">n</span>&nbsp;<span class="builtintype" id="5417236">int</span><span class="op" id="5417239">,</span>&nbsp;<span class="ident" id="5417241">err</span>&nbsp;<span class="builtintype" id="5417245">error</span><span class="op" id="5417250">)</span>&nbsp;<span class="op" id="5417252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5417255">n</span><span class="op" id="5417256">,</span>&nbsp;<span class="ident" id="5417258">err</span>&nbsp;<span class="op" id="5417262">=</span>&nbsp;<span class="ident" id="5417264">l</span><span class="op" id="5417265">.</span><span class="ident" id="5417266">w</span><span class="op" id="5417267">.</span><span class="ident" id="5417268">Write</span><span class="op" id="5417273">(</span><span class="ident" id="5417274">p</span><span class="op" id="5417275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5417278">if</span>&nbsp;<span class="ident" id="5417281">err</span>&nbsp;<span class="op" id="5417285">!=</span>&nbsp;<span class="builtintype" id="5417288">nil</span>&nbsp;<span class="op" id="5417292">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5417296">log</span><span class="op" id="5417299">.</span><span class="ident" id="5417300">Printf</span><span class="op" id="5417306">(</span><span class="string" id="5417307">&#34;%s&nbsp;%x:&nbsp;%v&#34;</span><span class="op" id="5417318">,</span>&nbsp;<span class="ident" id="5417320">l</span><span class="op" id="5417321">.</span><span class="ident" id="5417322">prefix</span><span class="op" id="5417328">,</span>&nbsp;<span class="ident" id="5417330">p</span><span class="op" id="5417331">[</span><span class="num" id="5417332">0</span><span class="op" id="5417333">:</span><span class="ident" id="5417334">n</span><span class="op" id="5417335">]</span><span class="op" id="5417336">,</span>&nbsp;<span class="ident" id="5417338">err</span><span class="op" id="5417341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5417344">}</span>&nbsp;<span class="keyword" id="5417346">else</span>&nbsp;<span class="op" id="5417351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5417355">log</span><span class="op" id="5417358">.</span><span class="ident" id="5417359">Printf</span><span class="op" id="5417365">(</span><span class="string" id="5417366">&#34;%s&nbsp;%x&#34;</span><span class="op" id="5417373">,</span>&nbsp;<span class="ident" id="5417375">l</span><span class="op" id="5417376">.</span><span class="ident" id="5417377">prefix</span><span class="op" id="5417383">,</span>&nbsp;<span class="ident" id="5417385">p</span><span class="op" id="5417386">[</span><span class="num" id="5417387">0</span><span class="op" id="5417388">:</span><span class="ident" id="5417389">n</span><span class="op" id="5417390">]</span><span class="op" id="5417391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5417394">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5417397">return</span><br>
<span class="lineno">25</span><span class="op" id="5417404">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5417407">//&nbsp;NewWriteLogger&nbsp;returns&nbsp;a&nbsp;writer&nbsp;that&nbsp;behaves&nbsp;like&nbsp;w&nbsp;except</span><br>
<span class="lineno"></span><span class="comment" id="5417469">//&nbsp;that&nbsp;it&nbsp;logs&nbsp;(using&nbsp;log.Printf)&nbsp;each&nbsp;write&nbsp;to&nbsp;standard&nbsp;error,</span><br>
<span class="lineno"></span><span class="comment" id="5417534">//&nbsp;printing&nbsp;the&nbsp;prefix&nbsp;and&nbsp;the&nbsp;hexadecimal&nbsp;data&nbsp;written.</span><br>
<span class="lineno">30</span><span class="keyword" id="5417591">func</span>&nbsp;<span class="ident" id="5417596">NewWriteLogger</span><span class="op" id="5417610">(</span><span class="ident" id="5417611">prefix</span>&nbsp;<span class="builtintype" id="5417618">string</span><span class="op" id="5417624">,</span>&nbsp;<span class="ident" id="5417626">w</span>&nbsp;<span class="ident" id="5417628">io</span><span class="op" id="5417630">.</span><span class="ident" id="5417631">Writer</span><span class="op" id="5417637">)</span>&nbsp;<span class="ident" id="5417639">io</span><span class="op" id="5417641">.</span><span class="ident" id="5417642">Writer</span>&nbsp;<span class="op" id="5417649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5417652">return</span>&nbsp;<span class="op" id="5417659">&amp;</span><span class="ident" id="5417660">writeLogger</span><span class="op" id="5417671">{</span><span class="ident" id="5417672">prefix</span><span class="op" id="5417678">,</span>&nbsp;<span class="ident" id="5417680">w</span><span class="op" id="5417681">}</span><br>
<span class="lineno"></span><span class="op" id="5417683">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5417686">type</span>&nbsp;<span class="ident" id="5417691">readLogger</span>&nbsp;<span class="keyword" id="5417702">struct</span>&nbsp;<span class="op" id="5417709">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5417712">prefix</span>&nbsp;<span class="builtintype" id="5417719">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5417727">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5417734">io</span><span class="op" id="5417736">.</span><span class="ident" id="5417737">Reader</span><br>
<span class="lineno"></span><span class="op" id="5417744">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5417747">func</span>&nbsp;<span class="op" id="5417752">(</span><span class="ident" id="5417753">l</span>&nbsp;<span class="op" id="5417755">*</span><span class="ident" id="5417756">readLogger</span><span class="op" id="5417766">)</span>&nbsp;<span class="ident" id="5417768">Read</span><span class="op" id="5417772">(</span><span class="ident" id="5417773">p</span>&nbsp;<span class="op" id="5417775">[</span><span class="op" id="5417776">]</span><span class="builtintype" id="5417777">byte</span><span class="op" id="5417781">)</span>&nbsp;<span class="op" id="5417783">(</span><span class="ident" id="5417784">n</span>&nbsp;<span class="builtintype" id="5417786">int</span><span class="op" id="5417789">,</span>&nbsp;<span class="ident" id="5417791">err</span>&nbsp;<span class="builtintype" id="5417795">error</span><span class="op" id="5417800">)</span>&nbsp;<span class="op" id="5417802">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5417805">n</span><span class="op" id="5417806">,</span>&nbsp;<span class="ident" id="5417808">err</span>&nbsp;<span class="op" id="5417812">=</span>&nbsp;<span class="ident" id="5417814">l</span><span class="op" id="5417815">.</span><span class="ident" id="5417816">r</span><span class="op" id="5417817">.</span><span class="ident" id="5417818">Read</span><span class="op" id="5417822">(</span><span class="ident" id="5417823">p</span><span class="op" id="5417824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5417827">if</span>&nbsp;<span class="ident" id="5417830">err</span>&nbsp;<span class="op" id="5417834">!=</span>&nbsp;<span class="builtintype" id="5417837">nil</span>&nbsp;<span class="op" id="5417841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5417845">log</span><span class="op" id="5417848">.</span><span class="ident" id="5417849">Printf</span><span class="op" id="5417855">(</span><span class="string" id="5417856">&#34;%s&nbsp;%x:&nbsp;%v&#34;</span><span class="op" id="5417867">,</span>&nbsp;<span class="ident" id="5417869">l</span><span class="op" id="5417870">.</span><span class="ident" id="5417871">prefix</span><span class="op" id="5417877">,</span>&nbsp;<span class="ident" id="5417879">p</span><span class="op" id="5417880">[</span><span class="num" id="5417881">0</span><span class="op" id="5417882">:</span><span class="ident" id="5417883">n</span><span class="op" id="5417884">]</span><span class="op" id="5417885">,</span>&nbsp;<span class="ident" id="5417887">err</span><span class="op" id="5417890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5417893">}</span>&nbsp;<span class="keyword" id="5417895">else</span>&nbsp;<span class="op" id="5417900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5417904">log</span><span class="op" id="5417907">.</span><span class="ident" id="5417908">Printf</span><span class="op" id="5417914">(</span><span class="string" id="5417915">&#34;%s&nbsp;%x&#34;</span><span class="op" id="5417922">,</span>&nbsp;<span class="ident" id="5417924">l</span><span class="op" id="5417925">.</span><span class="ident" id="5417926">prefix</span><span class="op" id="5417932">,</span>&nbsp;<span class="ident" id="5417934">p</span><span class="op" id="5417935">[</span><span class="num" id="5417936">0</span><span class="op" id="5417937">:</span><span class="ident" id="5417938">n</span><span class="op" id="5417939">]</span><span class="op" id="5417940">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5417943">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5417946">return</span><br>
<span class="lineno"></span><span class="op" id="5417953">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5417956">//&nbsp;NewReadLogger&nbsp;returns&nbsp;a&nbsp;reader&nbsp;that&nbsp;behaves&nbsp;like&nbsp;r&nbsp;except</span><br>
<span class="lineno">50</span><span class="comment" id="5418017">//&nbsp;that&nbsp;it&nbsp;logs&nbsp;(using&nbsp;log.Print)&nbsp;each&nbsp;read&nbsp;to&nbsp;standard&nbsp;error,</span><br>
<span class="lineno"></span><span class="comment" id="5418080">//&nbsp;printing&nbsp;the&nbsp;prefix&nbsp;and&nbsp;the&nbsp;hexadecimal&nbsp;data&nbsp;written.</span><br>
<span class="lineno"></span><span class="keyword" id="5418137">func</span>&nbsp;<span class="ident" id="5418142">NewReadLogger</span><span class="op" id="5418155">(</span><span class="ident" id="5418156">prefix</span>&nbsp;<span class="builtintype" id="5418163">string</span><span class="op" id="5418169">,</span>&nbsp;<span class="ident" id="5418171">r</span>&nbsp;<span class="ident" id="5418173">io</span><span class="op" id="5418175">.</span><span class="ident" id="5418176">Reader</span><span class="op" id="5418182">)</span>&nbsp;<span class="ident" id="5418184">io</span><span class="op" id="5418186">.</span><span class="ident" id="5418187">Reader</span>&nbsp;<span class="op" id="5418194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5418197">return</span>&nbsp;<span class="op" id="5418204">&amp;</span><span class="ident" id="5418205">readLogger</span><span class="op" id="5418215">{</span><span class="ident" id="5418216">prefix</span><span class="op" id="5418222">,</span>&nbsp;<span class="ident" id="5418224">r</span><span class="op" id="5418225">}</span><br>
<span class="lineno"></span><span class="op" id="5418227">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
