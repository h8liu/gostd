<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3917557">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3917612">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3917666">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3917717">package</span>&nbsp;<span class="ident" id="3917725">des</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3917730">import</span>&nbsp;<span class="op" id="3917737">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3917740">&#34;crypto/cipher&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3917757">&#34;strconv&#34;</span><br>
<span class="lineno">10</span><span class="op" id="3917767">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3917770">//&nbsp;The&nbsp;DES&nbsp;block&nbsp;size&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="3917802">const</span>&nbsp;<span class="ident" id="3917808">BlockSize</span>&nbsp;<span class="op" id="3917818">=</span>&nbsp;<span class="num" id="3917820">8</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="3917823">type</span>&nbsp;<span class="ident" id="3917828">KeySizeError</span>&nbsp;<span class="builtintype" id="3917841">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3917846">func</span>&nbsp;<span class="op" id="3917851">(</span><span class="ident" id="3917852">k</span>&nbsp;<span class="ident" id="3917854">KeySizeError</span><span class="op" id="3917866">)</span>&nbsp;<span class="ident" id="3917868">Error</span><span class="op" id="3917873">(</span><span class="op" id="3917874">)</span>&nbsp;<span class="builtintype" id="3917876">string</span>&nbsp;<span class="op" id="3917883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3917886">return</span>&nbsp;<span class="string" id="3917893">&#34;crypto/des:&nbsp;invalid&nbsp;key&nbsp;size&nbsp;&#34;</span>&nbsp;<span class="op" id="3917925">+</span>&nbsp;<span class="ident" id="3917927">strconv</span><span class="op" id="3917934">.</span><span class="ident" id="3917935">Itoa</span><span class="op" id="3917939">(</span><span class="builtintype" id="3917940">int</span><span class="op" id="3917943">(</span><span class="ident" id="3917944">k</span><span class="op" id="3917945">)</span><span class="op" id="3917946">)</span><br>
<span class="lineno"></span><span class="op" id="3917948">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="3917951">//&nbsp;desCipher&nbsp;is&nbsp;an&nbsp;instance&nbsp;of&nbsp;DES&nbsp;encryption.</span><br>
<span class="lineno"></span><span class="keyword" id="3917998">type</span>&nbsp;<span class="ident" id="3918003">desCipher</span>&nbsp;<span class="keyword" id="3918013">struct</span>&nbsp;<span class="op" id="3918020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3918023">subkeys</span>&nbsp;<span class="op" id="3918031">[</span><span class="num" id="3918032">16</span><span class="op" id="3918034">]</span><span class="ident" id="3918035">uint64</span><br>
<span class="lineno"></span><span class="op" id="3918042">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="3918045">//&nbsp;NewCipher&nbsp;creates&nbsp;and&nbsp;returns&nbsp;a&nbsp;new&nbsp;cipher.Block.</span><br>
<span class="lineno"></span><span class="keyword" id="3918098">func</span>&nbsp;<span class="ident" id="3918103">NewCipher</span><span class="op" id="3918112">(</span><span class="ident" id="3918113">key</span>&nbsp;<span class="op" id="3918117">[</span><span class="op" id="3918118">]</span><span class="builtintype" id="3918119">byte</span><span class="op" id="3918123">)</span>&nbsp;<span class="op" id="3918125">(</span><span class="ident" id="3918126">cipher</span><span class="op" id="3918132">.</span><span class="ident" id="3918133">Block</span><span class="op" id="3918138">,</span>&nbsp;<span class="builtintype" id="3918140">error</span><span class="op" id="3918145">)</span>&nbsp;<span class="op" id="3918147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3918150">if</span>&nbsp;<span class="builtinfunc" id="3918153">len</span><span class="op" id="3918156">(</span><span class="ident" id="3918157">key</span><span class="op" id="3918160">)</span>&nbsp;<span class="op" id="3918162">!=</span>&nbsp;<span class="num" id="3918165">8</span>&nbsp;<span class="op" id="3918167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3918171">return</span>&nbsp;<span class="ident" id="3918178">nil</span><span class="op" id="3918181">,</span>&nbsp;<span class="ident" id="3918183">KeySizeError</span><span class="op" id="3918195">(</span><span class="builtinfunc" id="3918196">len</span><span class="op" id="3918199">(</span><span class="ident" id="3918200">key</span><span class="op" id="3918203">)</span><span class="op" id="3918204">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3918207">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3918211">c</span>&nbsp;<span class="op" id="3918213">:=</span>&nbsp;<span class="builtinfunc" id="3918216">new</span><span class="op" id="3918219">(</span><span class="ident" id="3918220">desCipher</span><span class="op" id="3918229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3918232">c</span><span class="op" id="3918233">.</span><span class="ident" id="3918234">generateSubkeys</span><span class="op" id="3918249">(</span><span class="ident" id="3918250">key</span><span class="op" id="3918253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3918256">return</span>&nbsp;<span class="ident" id="3918263">c</span><span class="op" id="3918264">,</span>&nbsp;<span class="ident" id="3918266">nil</span><br>
<span class="lineno">35</span><span class="op" id="3918270">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3918273">func</span>&nbsp;<span class="op" id="3918278">(</span><span class="ident" id="3918279">c</span>&nbsp;<span class="op" id="3918281">*</span><span class="ident" id="3918282">desCipher</span><span class="op" id="3918291">)</span>&nbsp;<span class="ident" id="3918293">BlockSize</span><span class="op" id="3918302">(</span><span class="op" id="3918303">)</span>&nbsp;<span class="builtintype" id="3918305">int</span>&nbsp;<span class="op" id="3918309">{</span>&nbsp;<span class="keyword" id="3918311">return</span>&nbsp;<span class="ident" id="3918318">BlockSize</span>&nbsp;<span class="op" id="3918328">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3918331">func</span>&nbsp;<span class="op" id="3918336">(</span><span class="ident" id="3918337">c</span>&nbsp;<span class="op" id="3918339">*</span><span class="ident" id="3918340">desCipher</span><span class="op" id="3918349">)</span>&nbsp;<span class="ident" id="3918351">Encrypt</span><span class="op" id="3918358">(</span><span class="ident" id="3918359">dst</span><span class="op" id="3918362">,</span>&nbsp;<span class="ident" id="3918364">src</span>&nbsp;<span class="op" id="3918368">[</span><span class="op" id="3918369">]</span><span class="builtintype" id="3918370">byte</span><span class="op" id="3918374">)</span>&nbsp;<span class="op" id="3918376">{</span>&nbsp;<span class="ident" id="3918378">encryptBlock</span><span class="op" id="3918390">(</span><span class="ident" id="3918391">c</span><span class="op" id="3918392">.</span><span class="ident" id="3918393">subkeys</span><span class="op" id="3918400">[</span><span class="op" id="3918401">:</span><span class="op" id="3918402">]</span><span class="op" id="3918403">,</span>&nbsp;<span class="ident" id="3918405">dst</span><span class="op" id="3918408">,</span>&nbsp;<span class="ident" id="3918410">src</span><span class="op" id="3918413">)</span>&nbsp;<span class="op" id="3918415">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="3918418">func</span>&nbsp;<span class="op" id="3918423">(</span><span class="ident" id="3918424">c</span>&nbsp;<span class="op" id="3918426">*</span><span class="ident" id="3918427">desCipher</span><span class="op" id="3918436">)</span>&nbsp;<span class="ident" id="3918438">Decrypt</span><span class="op" id="3918445">(</span><span class="ident" id="3918446">dst</span><span class="op" id="3918449">,</span>&nbsp;<span class="ident" id="3918451">src</span>&nbsp;<span class="op" id="3918455">[</span><span class="op" id="3918456">]</span><span class="builtintype" id="3918457">byte</span><span class="op" id="3918461">)</span>&nbsp;<span class="op" id="3918463">{</span>&nbsp;<span class="ident" id="3918465">decryptBlock</span><span class="op" id="3918477">(</span><span class="ident" id="3918478">c</span><span class="op" id="3918479">.</span><span class="ident" id="3918480">subkeys</span><span class="op" id="3918487">[</span><span class="op" id="3918488">:</span><span class="op" id="3918489">]</span><span class="op" id="3918490">,</span>&nbsp;<span class="ident" id="3918492">dst</span><span class="op" id="3918495">,</span>&nbsp;<span class="ident" id="3918497">src</span><span class="op" id="3918500">)</span>&nbsp;<span class="op" id="3918502">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3918505">//&nbsp;A&nbsp;tripleDESCipher&nbsp;is&nbsp;an&nbsp;instance&nbsp;of&nbsp;TripleDES&nbsp;encryption.</span><br>
<span class="lineno"></span><span class="keyword" id="3918566">type</span>&nbsp;<span class="ident" id="3918571">tripleDESCipher</span>&nbsp;<span class="keyword" id="3918587">struct</span>&nbsp;<span class="op" id="3918594">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3918597">cipher1</span><span class="op" id="3918604">,</span>&nbsp;<span class="ident" id="3918606">cipher2</span><span class="op" id="3918613">,</span>&nbsp;<span class="ident" id="3918615">cipher3</span>&nbsp;<span class="ident" id="3918623">desCipher</span><br>
<span class="lineno"></span><span class="op" id="3918633">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3918636">//&nbsp;NewTripleDESCipher&nbsp;creates&nbsp;and&nbsp;returns&nbsp;a&nbsp;new&nbsp;cipher.Block.</span><br>
<span class="lineno"></span><span class="keyword" id="3918698">func</span>&nbsp;<span class="ident" id="3918703">NewTripleDESCipher</span><span class="op" id="3918721">(</span><span class="ident" id="3918722">key</span>&nbsp;<span class="op" id="3918726">[</span><span class="op" id="3918727">]</span><span class="builtintype" id="3918728">byte</span><span class="op" id="3918732">)</span>&nbsp;<span class="op" id="3918734">(</span><span class="ident" id="3918735">cipher</span><span class="op" id="3918741">.</span><span class="ident" id="3918742">Block</span><span class="op" id="3918747">,</span>&nbsp;<span class="builtintype" id="3918749">error</span><span class="op" id="3918754">)</span>&nbsp;<span class="op" id="3918756">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3918759">if</span>&nbsp;<span class="builtinfunc" id="3918762">len</span><span class="op" id="3918765">(</span><span class="ident" id="3918766">key</span><span class="op" id="3918769">)</span>&nbsp;<span class="op" id="3918771">!=</span>&nbsp;<span class="num" id="3918774">24</span>&nbsp;<span class="op" id="3918777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3918781">return</span>&nbsp;<span class="ident" id="3918788">nil</span><span class="op" id="3918791">,</span>&nbsp;<span class="ident" id="3918793">KeySizeError</span><span class="op" id="3918805">(</span><span class="builtinfunc" id="3918806">len</span><span class="op" id="3918809">(</span><span class="ident" id="3918810">key</span><span class="op" id="3918813">)</span><span class="op" id="3918814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3918817">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3918821">c</span>&nbsp;<span class="op" id="3918823">:=</span>&nbsp;<span class="builtinfunc" id="3918826">new</span><span class="op" id="3918829">(</span><span class="ident" id="3918830">tripleDESCipher</span><span class="op" id="3918845">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3918848">c</span><span class="op" id="3918849">.</span><span class="ident" id="3918850">cipher1</span><span class="op" id="3918857">.</span><span class="ident" id="3918858">generateSubkeys</span><span class="op" id="3918873">(</span><span class="ident" id="3918874">key</span><span class="op" id="3918877">[</span><span class="op" id="3918878">:</span><span class="num" id="3918879">8</span><span class="op" id="3918880">]</span><span class="op" id="3918881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3918884">c</span><span class="op" id="3918885">.</span><span class="ident" id="3918886">cipher2</span><span class="op" id="3918893">.</span><span class="ident" id="3918894">generateSubkeys</span><span class="op" id="3918909">(</span><span class="ident" id="3918910">key</span><span class="op" id="3918913">[</span><span class="num" id="3918914">8</span><span class="op" id="3918915">:</span><span class="num" id="3918916">16</span><span class="op" id="3918918">]</span><span class="op" id="3918919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3918922">c</span><span class="op" id="3918923">.</span><span class="ident" id="3918924">cipher3</span><span class="op" id="3918931">.</span><span class="ident" id="3918932">generateSubkeys</span><span class="op" id="3918947">(</span><span class="ident" id="3918948">key</span><span class="op" id="3918951">[</span><span class="num" id="3918952">16</span><span class="op" id="3918954">:</span><span class="op" id="3918955">]</span><span class="op" id="3918956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3918959">return</span>&nbsp;<span class="ident" id="3918966">c</span><span class="op" id="3918967">,</span>&nbsp;<span class="ident" id="3918969">nil</span><br>
<span class="lineno"></span><span class="op" id="3918973">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="3918976">func</span>&nbsp;<span class="op" id="3918981">(</span><span class="ident" id="3918982">c</span>&nbsp;<span class="op" id="3918984">*</span><span class="ident" id="3918985">tripleDESCipher</span><span class="op" id="3919000">)</span>&nbsp;<span class="ident" id="3919002">BlockSize</span><span class="op" id="3919011">(</span><span class="op" id="3919012">)</span>&nbsp;<span class="builtintype" id="3919014">int</span>&nbsp;<span class="op" id="3919018">{</span>&nbsp;<span class="keyword" id="3919020">return</span>&nbsp;<span class="ident" id="3919027">BlockSize</span>&nbsp;<span class="op" id="3919037">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3919040">func</span>&nbsp;<span class="op" id="3919045">(</span><span class="ident" id="3919046">c</span>&nbsp;<span class="op" id="3919048">*</span><span class="ident" id="3919049">tripleDESCipher</span><span class="op" id="3919064">)</span>&nbsp;<span class="ident" id="3919066">Encrypt</span><span class="op" id="3919073">(</span><span class="ident" id="3919074">dst</span><span class="op" id="3919077">,</span>&nbsp;<span class="ident" id="3919079">src</span>&nbsp;<span class="op" id="3919083">[</span><span class="op" id="3919084">]</span><span class="builtintype" id="3919085">byte</span><span class="op" id="3919089">)</span>&nbsp;<span class="op" id="3919091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3919094">c</span><span class="op" id="3919095">.</span><span class="ident" id="3919096">cipher1</span><span class="op" id="3919103">.</span><span class="ident" id="3919104">Encrypt</span><span class="op" id="3919111">(</span><span class="ident" id="3919112">dst</span><span class="op" id="3919115">,</span>&nbsp;<span class="ident" id="3919117">src</span><span class="op" id="3919120">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3919123">c</span><span class="op" id="3919124">.</span><span class="ident" id="3919125">cipher2</span><span class="op" id="3919132">.</span><span class="ident" id="3919133">Decrypt</span><span class="op" id="3919140">(</span><span class="ident" id="3919141">dst</span><span class="op" id="3919144">,</span>&nbsp;<span class="ident" id="3919146">dst</span><span class="op" id="3919149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3919152">c</span><span class="op" id="3919153">.</span><span class="ident" id="3919154">cipher3</span><span class="op" id="3919161">.</span><span class="ident" id="3919162">Encrypt</span><span class="op" id="3919169">(</span><span class="ident" id="3919170">dst</span><span class="op" id="3919173">,</span>&nbsp;<span class="ident" id="3919175">dst</span><span class="op" id="3919178">)</span><br>
<span class="lineno"></span><span class="op" id="3919180">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3919183">func</span>&nbsp;<span class="op" id="3919188">(</span><span class="ident" id="3919189">c</span>&nbsp;<span class="op" id="3919191">*</span><span class="ident" id="3919192">tripleDESCipher</span><span class="op" id="3919207">)</span>&nbsp;<span class="ident" id="3919209">Decrypt</span><span class="op" id="3919216">(</span><span class="ident" id="3919217">dst</span><span class="op" id="3919220">,</span>&nbsp;<span class="ident" id="3919222">src</span>&nbsp;<span class="op" id="3919226">[</span><span class="op" id="3919227">]</span><span class="builtintype" id="3919228">byte</span><span class="op" id="3919232">)</span>&nbsp;<span class="op" id="3919234">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3919237">c</span><span class="op" id="3919238">.</span><span class="ident" id="3919239">cipher3</span><span class="op" id="3919246">.</span><span class="ident" id="3919247">Decrypt</span><span class="op" id="3919254">(</span><span class="ident" id="3919255">dst</span><span class="op" id="3919258">,</span>&nbsp;<span class="ident" id="3919260">src</span><span class="op" id="3919263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3919266">c</span><span class="op" id="3919267">.</span><span class="ident" id="3919268">cipher2</span><span class="op" id="3919275">.</span><span class="ident" id="3919276">Encrypt</span><span class="op" id="3919283">(</span><span class="ident" id="3919284">dst</span><span class="op" id="3919287">,</span>&nbsp;<span class="ident" id="3919289">dst</span><span class="op" id="3919292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3919295">c</span><span class="op" id="3919296">.</span><span class="ident" id="3919297">cipher1</span><span class="op" id="3919304">.</span><span class="ident" id="3919305">Decrypt</span><span class="op" id="3919312">(</span><span class="ident" id="3919313">dst</span><span class="op" id="3919316">,</span>&nbsp;<span class="ident" id="3919318">dst</span><span class="op" id="3919321">)</span><br>
<span class="lineno"></span><span class="op" id="3919323">}</span>
</div>
</body>
</html>
