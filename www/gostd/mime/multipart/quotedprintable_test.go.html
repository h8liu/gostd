<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>mime/multipart</h2>
<ul>
<li><a href="/gostd/mime/multipart/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/mime/multipart/formdata.go.html">formdata.go</a></li>
<li><a href="/gostd/mime/multipart/formdata_test.go.html">formdata_test.go</a></li>
<li><a href="/gostd/mime/multipart/multipart.go.html">multipart.go</a></li>
<li><a href="/gostd/mime/multipart/multipart_test.go.html">multipart_test.go</a></li>
<li><a href="/gostd/mime/multipart/quotedprintable.go.html">quotedprintable.go</a></li>
<li><a href="/gostd/mime/multipart/quotedprintable_test.go.html">quotedprintable_test.go</a></li>
<li><a href="/gostd/mime/multipart/writer.go.html">writer.go</a></li>
<li><a href="/gostd/mime/multipart/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7306929">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7306984">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7307038">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7307089">package</span>&nbsp;<span class="ident" id="7307097">multipart</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7307108">import</span>&nbsp;<span class="op" id="7307115">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7307118">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7307127">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7307136">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7307146">&#34;flag&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7307154">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7307161">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7307167">&#34;os/exec&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7307178">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7307188">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7307196">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7307207">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7307218">&#34;time&#34;</span><br>
<span class="lineno">20</span><span class="op" id="7307225">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7307228">func</span>&nbsp;<span class="ident" id="7307233">TestQuotedPrintable</span><span class="op" id="7307252">(</span><span class="ident" id="7307253">t</span>&nbsp;<span class="op" id="7307255">*</span><span class="ident" id="7307256">testing</span><span class="op" id="7307263">.</span><span class="ident" id="7307264">T</span><span class="op" id="7307265">)</span>&nbsp;<span class="op" id="7307267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7307270">tests</span>&nbsp;<span class="op" id="7307276">:=</span>&nbsp;<span class="op" id="7307279">[</span><span class="op" id="7307280">]</span><span class="keyword" id="7307281">struct</span>&nbsp;<span class="op" id="7307288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7307292">in</span><span class="op" id="7307294">,</span>&nbsp;<span class="ident" id="7307296">want</span>&nbsp;<span class="builtintype" id="7307301">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7307310">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7307319">interface</span><span class="op" id="7307328">{</span><span class="op" id="7307329">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7307332">}</span><span class="op" id="7307333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7307337">{</span><span class="ident" id="7307338">in</span><span class="op" id="7307340">:</span>&nbsp;<span class="string" id="7307342">&#34;&#34;</span><span class="op" id="7307344">,</span>&nbsp;<span class="ident" id="7307346">want</span><span class="op" id="7307350">:</span>&nbsp;<span class="string" id="7307352">&#34;&#34;</span><span class="op" id="7307354">}</span><span class="op" id="7307355">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7307359">{</span><span class="ident" id="7307360">in</span><span class="op" id="7307362">:</span>&nbsp;<span class="string" id="7307364">&#34;foo&nbsp;bar&#34;</span><span class="op" id="7307373">,</span>&nbsp;<span class="ident" id="7307375">want</span><span class="op" id="7307379">:</span>&nbsp;<span class="string" id="7307381">&#34;foo&nbsp;bar&#34;</span><span class="op" id="7307390">}</span><span class="op" id="7307391">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7307395">{</span><span class="ident" id="7307396">in</span><span class="op" id="7307398">:</span>&nbsp;<span class="string" id="7307400">&#34;foo&nbsp;bar=3D&#34;</span><span class="op" id="7307412">,</span>&nbsp;<span class="ident" id="7307414">want</span><span class="op" id="7307418">:</span>&nbsp;<span class="string" id="7307420">&#34;foo&nbsp;bar=&#34;</span><span class="op" id="7307430">}</span><span class="op" id="7307431">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7307435">{</span><span class="ident" id="7307436">in</span><span class="op" id="7307438">:</span>&nbsp;<span class="string" id="7307440">&#34;foo&nbsp;bar=\n&#34;</span><span class="op" id="7307452">,</span>&nbsp;<span class="ident" id="7307454">want</span><span class="op" id="7307458">:</span>&nbsp;<span class="string" id="7307460">&#34;foo&nbsp;bar&#34;</span><span class="op" id="7307469">}</span><span class="op" id="7307470">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7307474">{</span><span class="ident" id="7307475">in</span><span class="op" id="7307477">:</span>&nbsp;<span class="string" id="7307479">&#34;foo&nbsp;bar\n&#34;</span><span class="op" id="7307490">,</span>&nbsp;<span class="ident" id="7307492">want</span><span class="op" id="7307496">:</span>&nbsp;<span class="string" id="7307498">&#34;foo&nbsp;bar\n&#34;</span><span class="op" id="7307509">}</span><span class="op" id="7307510">,</span>&nbsp;<span class="comment" id="7307512">//&nbsp;somewhat&nbsp;lax.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7307531">{</span><span class="ident" id="7307532">in</span><span class="op" id="7307534">:</span>&nbsp;<span class="string" id="7307536">&#34;foo&nbsp;bar=0&#34;</span><span class="op" id="7307547">,</span>&nbsp;<span class="ident" id="7307549">want</span><span class="op" id="7307553">:</span>&nbsp;<span class="string" id="7307555">&#34;foo&nbsp;bar&#34;</span><span class="op" id="7307564">,</span>&nbsp;<span class="ident" id="7307566">err</span><span class="op" id="7307569">:</span>&nbsp;<span class="ident" id="7307571">io</span><span class="op" id="7307573">.</span><span class="ident" id="7307574">ErrUnexpectedEOF</span><span class="op" id="7307590">}</span><span class="op" id="7307591">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7307595">{</span><span class="ident" id="7307596">in</span><span class="op" id="7307598">:</span>&nbsp;<span class="string" id="7307600">&#34;foo&nbsp;bar=ab&#34;</span><span class="op" id="7307612">,</span>&nbsp;<span class="ident" id="7307614">want</span><span class="op" id="7307618">:</span>&nbsp;<span class="string" id="7307620">&#34;foo&nbsp;bar&#34;</span><span class="op" id="7307629">,</span>&nbsp;<span class="ident" id="7307631">err</span><span class="op" id="7307634">:</span>&nbsp;<span class="string" id="7307636">&#34;multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x61&#34;</span><span class="op" id="7307687">}</span><span class="op" id="7307688">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7307692">{</span><span class="ident" id="7307693">in</span><span class="op" id="7307695">:</span>&nbsp;<span class="string" id="7307697">&#34;foo&nbsp;bar=0D=0A&#34;</span><span class="op" id="7307712">,</span>&nbsp;<span class="ident" id="7307714">want</span><span class="op" id="7307718">:</span>&nbsp;<span class="string" id="7307720">&#34;foo&nbsp;bar\r\n&#34;</span><span class="op" id="7307733">}</span><span class="op" id="7307734">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7307738">{</span><span class="ident" id="7307739">in</span><span class="op" id="7307741">:</span>&nbsp;<span class="string" id="7307743">&#34;&nbsp;A&nbsp;B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;C&nbsp;&#34;</span><span class="op" id="7307764">,</span>&nbsp;<span class="ident" id="7307766">want</span><span class="op" id="7307770">:</span>&nbsp;<span class="string" id="7307772">&#34;&nbsp;A&nbsp;B\r\n&nbsp;C&#34;</span><span class="op" id="7307784">}</span><span class="op" id="7307785">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7307789">{</span><span class="ident" id="7307790">in</span><span class="op" id="7307792">:</span>&nbsp;<span class="string" id="7307794">&#34;&nbsp;A&nbsp;B&nbsp;=\r\n&nbsp;C&nbsp;&#34;</span><span class="op" id="7307809">,</span>&nbsp;<span class="ident" id="7307811">want</span><span class="op" id="7307815">:</span>&nbsp;<span class="string" id="7307817">&#34;&nbsp;A&nbsp;B&nbsp;&nbsp;C&#34;</span><span class="op" id="7307826">}</span><span class="op" id="7307827">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7307831">{</span><span class="ident" id="7307832">in</span><span class="op" id="7307834">:</span>&nbsp;<span class="string" id="7307836">&#34;&nbsp;A&nbsp;B&nbsp;=\n&nbsp;C&nbsp;&#34;</span><span class="op" id="7307849">,</span>&nbsp;<span class="ident" id="7307851">want</span><span class="op" id="7307855">:</span>&nbsp;<span class="string" id="7307857">&#34;&nbsp;A&nbsp;B&nbsp;&nbsp;C&#34;</span><span class="op" id="7307866">}</span><span class="op" id="7307867">,</span>&nbsp;<span class="comment" id="7307869">//&nbsp;lax.&nbsp;treating&nbsp;LF&nbsp;as&nbsp;CRLF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7307899">{</span><span class="ident" id="7307900">in</span><span class="op" id="7307902">:</span>&nbsp;<span class="string" id="7307904">&#34;foo=\nbar&#34;</span><span class="op" id="7307915">,</span>&nbsp;<span class="ident" id="7307917">want</span><span class="op" id="7307921">:</span>&nbsp;<span class="string" id="7307923">&#34;foobar&#34;</span><span class="op" id="7307931">}</span><span class="op" id="7307932">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7307936">{</span><span class="ident" id="7307937">in</span><span class="op" id="7307939">:</span>&nbsp;<span class="string" id="7307941">&#34;foo\x00bar&#34;</span><span class="op" id="7307953">,</span>&nbsp;<span class="ident" id="7307955">want</span><span class="op" id="7307959">:</span>&nbsp;<span class="string" id="7307961">&#34;foo&#34;</span><span class="op" id="7307966">,</span>&nbsp;<span class="ident" id="7307968">err</span><span class="op" id="7307971">:</span>&nbsp;<span class="string" id="7307973">&#34;multipart:&nbsp;invalid&nbsp;unescaped&nbsp;byte&nbsp;0x00&nbsp;in&nbsp;quoted-printable&nbsp;body&#34;</span><span class="op" id="7308038">}</span><span class="op" id="7308039">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7308043">{</span><span class="ident" id="7308044">in</span><span class="op" id="7308046">:</span>&nbsp;<span class="string" id="7308048">&#34;foo&nbsp;bar\xff&#34;</span><span class="op" id="7308061">,</span>&nbsp;<span class="ident" id="7308063">want</span><span class="op" id="7308067">:</span>&nbsp;<span class="string" id="7308069">&#34;foo&nbsp;bar&#34;</span><span class="op" id="7308078">,</span>&nbsp;<span class="ident" id="7308080">err</span><span class="op" id="7308083">:</span>&nbsp;<span class="string" id="7308085">&#34;multipart:&nbsp;invalid&nbsp;unescaped&nbsp;byte&nbsp;0xff&nbsp;in&nbsp;quoted-printable&nbsp;body&#34;</span><span class="op" id="7308150">}</span><span class="op" id="7308151">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7308156">//&nbsp;Equal&nbsp;sign.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7308173">{</span><span class="ident" id="7308174">in</span><span class="op" id="7308176">:</span>&nbsp;<span class="string" id="7308178">&#34;=3D30\n&#34;</span><span class="op" id="7308187">,</span>&nbsp;<span class="ident" id="7308189">want</span><span class="op" id="7308193">:</span>&nbsp;<span class="string" id="7308195">&#34;=30\n&#34;</span><span class="op" id="7308202">}</span><span class="op" id="7308203">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7308207">{</span><span class="ident" id="7308208">in</span><span class="op" id="7308210">:</span>&nbsp;<span class="string" id="7308212">&#34;=00=FF0=\n&#34;</span><span class="op" id="7308224">,</span>&nbsp;<span class="ident" id="7308226">want</span><span class="op" id="7308230">:</span>&nbsp;<span class="string" id="7308232">&#34;\x00\xff0&#34;</span><span class="op" id="7308243">}</span><span class="op" id="7308244">,</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7308249">//&nbsp;Trailing&nbsp;whitespace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7308274">{</span><span class="ident" id="7308275">in</span><span class="op" id="7308277">:</span>&nbsp;<span class="string" id="7308279">&#34;foo&nbsp;&nbsp;\n&#34;</span><span class="op" id="7308288">,</span>&nbsp;<span class="ident" id="7308290">want</span><span class="op" id="7308294">:</span>&nbsp;<span class="string" id="7308296">&#34;foo\n&#34;</span><span class="op" id="7308303">}</span><span class="op" id="7308304">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7308308">{</span><span class="ident" id="7308309">in</span><span class="op" id="7308311">:</span>&nbsp;<span class="string" id="7308313">&#34;foo&nbsp;&nbsp;\n\nfoo&nbsp;=\n\nfoo=20\n\n&#34;</span><span class="op" id="7308343">,</span>&nbsp;<span class="ident" id="7308345">want</span><span class="op" id="7308349">:</span>&nbsp;<span class="string" id="7308351">&#34;foo\n\nfoo&nbsp;\nfoo&nbsp;\n\n&#34;</span><span class="op" id="7308374">}</span><span class="op" id="7308375">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7308380">//&nbsp;Tests&nbsp;that&nbsp;we&nbsp;allow&nbsp;bare&nbsp;\n&nbsp;and&nbsp;\r&nbsp;through,&nbsp;despite&nbsp;it&nbsp;being&nbsp;strictly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7308455">//&nbsp;not&nbsp;permitted&nbsp;per&nbsp;RFC&nbsp;2045,&nbsp;Section&nbsp;6.7&nbsp;Page&nbsp;22&nbsp;bullet&nbsp;(4).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7308520">{</span><span class="ident" id="7308521">in</span><span class="op" id="7308523">:</span>&nbsp;<span class="string" id="7308525">&#34;foo\nbar&#34;</span><span class="op" id="7308535">,</span>&nbsp;<span class="ident" id="7308537">want</span><span class="op" id="7308541">:</span>&nbsp;<span class="string" id="7308543">&#34;foo\nbar&#34;</span><span class="op" id="7308553">}</span><span class="op" id="7308554">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7308558">{</span><span class="ident" id="7308559">in</span><span class="op" id="7308561">:</span>&nbsp;<span class="string" id="7308563">&#34;foo\rbar&#34;</span><span class="op" id="7308573">,</span>&nbsp;<span class="ident" id="7308575">want</span><span class="op" id="7308579">:</span>&nbsp;<span class="string" id="7308581">&#34;foo\rbar&#34;</span><span class="op" id="7308591">}</span><span class="op" id="7308592">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7308596">{</span><span class="ident" id="7308597">in</span><span class="op" id="7308599">:</span>&nbsp;<span class="string" id="7308601">&#34;foo\r\nbar&#34;</span><span class="op" id="7308613">,</span>&nbsp;<span class="ident" id="7308615">want</span><span class="op" id="7308619">:</span>&nbsp;<span class="string" id="7308621">&#34;foo\r\nbar&#34;</span><span class="op" id="7308633">}</span><span class="op" id="7308634">,</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7308639">//&nbsp;Different&nbsp;types&nbsp;of&nbsp;soft&nbsp;line-breaks.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7308681">{</span><span class="ident" id="7308682">in</span><span class="op" id="7308684">:</span>&nbsp;<span class="string" id="7308686">&#34;foo=\r\nbar&#34;</span><span class="op" id="7308699">,</span>&nbsp;<span class="ident" id="7308701">want</span><span class="op" id="7308705">:</span>&nbsp;<span class="string" id="7308707">&#34;foobar&#34;</span><span class="op" id="7308715">}</span><span class="op" id="7308716">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7308720">{</span><span class="ident" id="7308721">in</span><span class="op" id="7308723">:</span>&nbsp;<span class="string" id="7308725">&#34;foo=\nbar&#34;</span><span class="op" id="7308736">,</span>&nbsp;<span class="ident" id="7308738">want</span><span class="op" id="7308742">:</span>&nbsp;<span class="string" id="7308744">&#34;foobar&#34;</span><span class="op" id="7308752">}</span><span class="op" id="7308753">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7308757">{</span><span class="ident" id="7308758">in</span><span class="op" id="7308760">:</span>&nbsp;<span class="string" id="7308762">&#34;foo=\rbar&#34;</span><span class="op" id="7308773">,</span>&nbsp;<span class="ident" id="7308775">want</span><span class="op" id="7308779">:</span>&nbsp;<span class="string" id="7308781">&#34;foo&#34;</span><span class="op" id="7308786">,</span>&nbsp;<span class="ident" id="7308788">err</span><span class="op" id="7308791">:</span>&nbsp;<span class="string" id="7308793">&#34;multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x0d&#34;</span><span class="op" id="7308844">}</span><span class="op" id="7308845">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7308849">{</span><span class="ident" id="7308850">in</span><span class="op" id="7308852">:</span>&nbsp;<span class="string" id="7308854">&#34;foo=\r\r\r&nbsp;\nbar&#34;</span><span class="op" id="7308872">,</span>&nbsp;<span class="ident" id="7308874">want</span><span class="op" id="7308878">:</span>&nbsp;<span class="string" id="7308880">&#34;foo&#34;</span><span class="op" id="7308885">,</span>&nbsp;<span class="ident" id="7308887">err</span><span class="op" id="7308890">:</span>&nbsp;<span class="string" id="7308892">`multipart:&nbsp;invalid&nbsp;bytes&nbsp;after&nbsp;=:&nbsp;&#34;\r\r\r&nbsp;\n&#34;`</span><span class="op" id="7308939">}</span><span class="op" id="7308940">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7308945">//&nbsp;Example&nbsp;from&nbsp;RFC&nbsp;2045:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7308973">{</span><span class="ident" id="7308974">in</span><span class="op" id="7308976">:</span>&nbsp;<span class="string" id="7308978">&#34;Now&#39;s&nbsp;the&nbsp;time&nbsp;=\n&#34;</span>&nbsp;<span class="op" id="7308999">+</span>&nbsp;<span class="string" id="7309001">&#34;for&nbsp;all&nbsp;folk&nbsp;to&nbsp;come=\n&#34;</span>&nbsp;<span class="op" id="7309027">+</span>&nbsp;<span class="string" id="7309029">&#34;&nbsp;to&nbsp;the&nbsp;aid&nbsp;of&nbsp;their&nbsp;country.&#34;</span><span class="op" id="7309060">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7309065">want</span><span class="op" id="7309069">:</span>&nbsp;<span class="string" id="7309071">&#34;Now&#39;s&nbsp;the&nbsp;time&nbsp;for&nbsp;all&nbsp;folk&nbsp;to&nbsp;come&nbsp;to&nbsp;the&nbsp;aid&nbsp;of&nbsp;their&nbsp;country.&#34;</span><span class="op" id="7309137">}</span><span class="op" id="7309138">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7309141">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7309144">for</span>&nbsp;<span class="ident" id="7309148">_</span><span class="op" id="7309149">,</span>&nbsp;<span class="ident" id="7309151">tt</span>&nbsp;<span class="op" id="7309154">:=</span>&nbsp;<span class="keyword" id="7309157">range</span>&nbsp;<span class="ident" id="7309163">tests</span>&nbsp;<span class="op" id="7309169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7309173">var</span>&nbsp;<span class="ident" id="7309177">buf</span>&nbsp;<span class="ident" id="7309181">bytes</span><span class="op" id="7309186">.</span><span class="ident" id="7309187">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7309196">_</span><span class="op" id="7309197">,</span>&nbsp;<span class="ident" id="7309199">err</span>&nbsp;<span class="op" id="7309203">:=</span>&nbsp;<span class="ident" id="7309206">io</span><span class="op" id="7309208">.</span><span class="ident" id="7309209">Copy</span><span class="op" id="7309213">(</span><span class="op" id="7309214">&amp;</span><span class="ident" id="7309215">buf</span><span class="op" id="7309218">,</span>&nbsp;<span class="ident" id="7309220">newQuotedPrintableReader</span><span class="op" id="7309244">(</span><span class="ident" id="7309245">strings</span><span class="op" id="7309252">.</span><span class="ident" id="7309253">NewReader</span><span class="op" id="7309262">(</span><span class="ident" id="7309263">tt</span><span class="op" id="7309265">.</span><span class="ident" id="7309266">in</span><span class="op" id="7309268">)</span><span class="op" id="7309269">)</span><span class="op" id="7309270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7309274">if</span>&nbsp;<span class="ident" id="7309277">got</span>&nbsp;<span class="op" id="7309281">:=</span>&nbsp;<span class="ident" id="7309284">buf</span><span class="op" id="7309287">.</span><span class="ident" id="7309288">String</span><span class="op" id="7309294">(</span><span class="op" id="7309295">)</span><span class="op" id="7309296">;</span>&nbsp;<span class="ident" id="7309298">got</span>&nbsp;<span class="op" id="7309302">!=</span>&nbsp;<span class="ident" id="7309305">tt</span><span class="op" id="7309307">.</span><span class="ident" id="7309308">want</span>&nbsp;<span class="op" id="7309313">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7309318">t</span><span class="op" id="7309319">.</span><span class="ident" id="7309320">Errorf</span><span class="op" id="7309326">(</span><span class="string" id="7309327">&#34;for&nbsp;%q,&nbsp;got&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7309352">,</span>&nbsp;<span class="ident" id="7309354">tt</span><span class="op" id="7309356">.</span><span class="ident" id="7309357">in</span><span class="op" id="7309359">,</span>&nbsp;<span class="ident" id="7309361">got</span><span class="op" id="7309364">,</span>&nbsp;<span class="ident" id="7309366">tt</span><span class="op" id="7309368">.</span><span class="ident" id="7309369">want</span><span class="op" id="7309373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7309377">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7309381">switch</span>&nbsp;<span class="ident" id="7309388">verr</span>&nbsp;<span class="op" id="7309393">:=</span>&nbsp;<span class="ident" id="7309396">tt</span><span class="op" id="7309398">.</span><span class="ident" id="7309399">err</span><span class="op" id="7309402">.</span><span class="op" id="7309403">(</span><span class="keyword" id="7309404">type</span><span class="op" id="7309408">)</span>&nbsp;<span class="op" id="7309410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7309414">case</span>&nbsp;<span class="ident" id="7309419">nil</span><span class="op" id="7309422">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7309427">if</span>&nbsp;<span class="ident" id="7309430">err</span>&nbsp;<span class="op" id="7309434">!=</span>&nbsp;<span class="ident" id="7309437">nil</span>&nbsp;<span class="op" id="7309441">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7309447">t</span><span class="op" id="7309448">.</span><span class="ident" id="7309449">Errorf</span><span class="op" id="7309455">(</span><span class="string" id="7309456">&#34;for&nbsp;%q,&nbsp;got&nbsp;unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="7309490">,</span>&nbsp;<span class="ident" id="7309492">tt</span><span class="op" id="7309494">.</span><span class="ident" id="7309495">in</span><span class="op" id="7309497">,</span>&nbsp;<span class="ident" id="7309499">err</span><span class="op" id="7309502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7309507">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7309511">case</span>&nbsp;<span class="builtintype" id="7309516">string</span><span class="op" id="7309522">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7309527">if</span>&nbsp;<span class="ident" id="7309530">got</span>&nbsp;<span class="op" id="7309534">:=</span>&nbsp;<span class="ident" id="7309537">fmt</span><span class="op" id="7309540">.</span><span class="ident" id="7309541">Sprint</span><span class="op" id="7309547">(</span><span class="ident" id="7309548">err</span><span class="op" id="7309551">)</span><span class="op" id="7309552">;</span>&nbsp;<span class="ident" id="7309554">got</span>&nbsp;<span class="op" id="7309558">!=</span>&nbsp;<span class="ident" id="7309561">verr</span>&nbsp;<span class="op" id="7309566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7309572">t</span><span class="op" id="7309573">.</span><span class="ident" id="7309574">Errorf</span><span class="op" id="7309580">(</span><span class="string" id="7309581">&#34;for&nbsp;%q,&nbsp;got&nbsp;error&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7309612">,</span>&nbsp;<span class="ident" id="7309614">tt</span><span class="op" id="7309616">.</span><span class="ident" id="7309617">in</span><span class="op" id="7309619">,</span>&nbsp;<span class="ident" id="7309621">got</span><span class="op" id="7309624">,</span>&nbsp;<span class="ident" id="7309626">verr</span><span class="op" id="7309630">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7309635">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7309639">case</span>&nbsp;<span class="builtintype" id="7309644">error</span><span class="op" id="7309649">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7309654">if</span>&nbsp;<span class="ident" id="7309657">err</span>&nbsp;<span class="op" id="7309661">!=</span>&nbsp;<span class="ident" id="7309664">verr</span>&nbsp;<span class="op" id="7309669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7309675">t</span><span class="op" id="7309676">.</span><span class="ident" id="7309677">Errorf</span><span class="op" id="7309683">(</span><span class="string" id="7309684">&#34;for&nbsp;%q,&nbsp;got&nbsp;error&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7309715">,</span>&nbsp;<span class="ident" id="7309717">tt</span><span class="op" id="7309719">.</span><span class="ident" id="7309720">in</span><span class="op" id="7309722">,</span>&nbsp;<span class="ident" id="7309724">err</span><span class="op" id="7309727">,</span>&nbsp;<span class="ident" id="7309729">verr</span><span class="op" id="7309733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7309738">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7309742">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7309745">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="op" id="7309748">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="7309751">func</span>&nbsp;<span class="ident" id="7309756">everySequence</span><span class="op" id="7309769">(</span><span class="ident" id="7309770">base</span><span class="op" id="7309774">,</span>&nbsp;<span class="ident" id="7309776">alpha</span>&nbsp;<span class="builtintype" id="7309782">string</span><span class="op" id="7309788">,</span>&nbsp;<span class="ident" id="7309790">length</span>&nbsp;<span class="builtintype" id="7309797">int</span><span class="op" id="7309800">,</span>&nbsp;<span class="ident" id="7309802">fn</span>&nbsp;<span class="keyword" id="7309805">func</span><span class="op" id="7309809">(</span><span class="builtintype" id="7309810">string</span><span class="op" id="7309816">)</span><span class="op" id="7309817">)</span>&nbsp;<span class="op" id="7309819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7309822">if</span>&nbsp;<span class="builtinfunc" id="7309825">len</span><span class="op" id="7309828">(</span><span class="ident" id="7309829">base</span><span class="op" id="7309833">)</span>&nbsp;<span class="op" id="7309835">==</span>&nbsp;<span class="ident" id="7309838">length</span>&nbsp;<span class="op" id="7309845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7309849">fn</span><span class="op" id="7309851">(</span><span class="ident" id="7309852">base</span><span class="op" id="7309856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7309860">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7309868">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7309871">for</span>&nbsp;<span class="ident" id="7309875">i</span>&nbsp;<span class="op" id="7309877">:=</span>&nbsp;<span class="num" id="7309880">0</span><span class="op" id="7309881">;</span>&nbsp;<span class="ident" id="7309883">i</span>&nbsp;<span class="op" id="7309885">&lt;</span>&nbsp;<span class="builtinfunc" id="7309887">len</span><span class="op" id="7309890">(</span><span class="ident" id="7309891">alpha</span><span class="op" id="7309896">)</span><span class="op" id="7309897">;</span>&nbsp;<span class="ident" id="7309899">i</span><span class="op" id="7309900">++</span>&nbsp;<span class="op" id="7309903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7309907">everySequence</span><span class="op" id="7309920">(</span><span class="ident" id="7309921">base</span><span class="op" id="7309925">+</span><span class="ident" id="7309926">alpha</span><span class="op" id="7309931">[</span><span class="ident" id="7309932">i</span><span class="op" id="7309933">:</span><span class="ident" id="7309934">i</span><span class="op" id="7309935">+</span><span class="num" id="7309936">1</span><span class="op" id="7309937">]</span><span class="op" id="7309938">,</span>&nbsp;<span class="ident" id="7309940">alpha</span><span class="op" id="7309945">,</span>&nbsp;<span class="ident" id="7309947">length</span><span class="op" id="7309953">,</span>&nbsp;<span class="ident" id="7309955">fn</span><span class="op" id="7309957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7309960">}</span><br>
<span class="lineno"></span><span class="op" id="7309962">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="7309965">var</span>&nbsp;<span class="ident" id="7309969">useQprint</span>&nbsp;<span class="op" id="7309979">=</span>&nbsp;<span class="ident" id="7309981">flag</span><span class="op" id="7309985">.</span><span class="ident" id="7309986">Bool</span><span class="op" id="7309990">(</span><span class="string" id="7309991">&#34;qprint&#34;</span><span class="op" id="7309999">,</span>&nbsp;<span class="builtintype" id="7310001">false</span><span class="op" id="7310006">,</span>&nbsp;<span class="string" id="7310008">&#34;Compare&nbsp;against&nbsp;the&nbsp;&#39;qprint&#39;&nbsp;program.&#34;</span><span class="op" id="7310047">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7310050">var</span>&nbsp;<span class="ident" id="7310054">badSoftRx</span>&nbsp;<span class="op" id="7310064">=</span>&nbsp;<span class="ident" id="7310066">regexp</span><span class="op" id="7310072">.</span><span class="ident" id="7310073">MustCompile</span><span class="op" id="7310084">(</span><span class="string" id="7310085">`=([^\r\n]+?\n)|([^\r\n]+$)|(\r$)|(\r[^\n]+\n)|(&nbsp;\r\n)`</span><span class="op" id="7310140">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7310143">func</span>&nbsp;<span class="ident" id="7310148">TestQPExhaustive</span><span class="op" id="7310164">(</span><span class="ident" id="7310165">t</span>&nbsp;<span class="op" id="7310167">*</span><span class="ident" id="7310168">testing</span><span class="op" id="7310175">.</span><span class="ident" id="7310176">T</span><span class="op" id="7310177">)</span>&nbsp;<span class="op" id="7310179">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7310182">if</span>&nbsp;<span class="op" id="7310185">*</span><span class="ident" id="7310186">useQprint</span>&nbsp;<span class="op" id="7310196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7310200">_</span><span class="op" id="7310201">,</span>&nbsp;<span class="ident" id="7310203">err</span>&nbsp;<span class="op" id="7310207">:=</span>&nbsp;<span class="ident" id="7310210">exec</span><span class="op" id="7310214">.</span><span class="ident" id="7310215">LookPath</span><span class="op" id="7310223">(</span><span class="string" id="7310224">&#34;qprint&#34;</span><span class="op" id="7310232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7310236">if</span>&nbsp;<span class="ident" id="7310239">err</span>&nbsp;<span class="op" id="7310243">!=</span>&nbsp;<span class="ident" id="7310246">nil</span>&nbsp;<span class="op" id="7310250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7310255">t</span><span class="op" id="7310256">.</span><span class="ident" id="7310257">Fatalf</span><span class="op" id="7310263">(</span><span class="string" id="7310264">&#34;Error&nbsp;looking&nbsp;for&nbsp;qprint:&nbsp;%v&#34;</span><span class="op" id="7310294">,</span>&nbsp;<span class="ident" id="7310296">err</span><span class="op" id="7310299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7310303">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7310306">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7310310">var</span>&nbsp;<span class="ident" id="7310314">buf</span>&nbsp;<span class="ident" id="7310318">bytes</span><span class="op" id="7310323">.</span><span class="ident" id="7310324">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7310332">res</span>&nbsp;<span class="op" id="7310336">:=</span>&nbsp;<span class="builtinfunc" id="7310339">make</span><span class="op" id="7310343">(</span><span class="keyword" id="7310344">map</span><span class="op" id="7310347">[</span><span class="builtintype" id="7310348">string</span><span class="op" id="7310354">]</span><span class="builtintype" id="7310355">int</span><span class="op" id="7310358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7310361">everySequence</span><span class="op" id="7310374">(</span><span class="string" id="7310375">&#34;&#34;</span><span class="op" id="7310377">,</span>&nbsp;<span class="string" id="7310379">&#34;0A&nbsp;\r\n=&#34;</span><span class="op" id="7310389">,</span>&nbsp;<span class="num" id="7310391">6</span><span class="op" id="7310392">,</span>&nbsp;<span class="keyword" id="7310394">func</span><span class="op" id="7310398">(</span><span class="ident" id="7310399">s</span>&nbsp;<span class="builtintype" id="7310401">string</span><span class="op" id="7310407">)</span>&nbsp;<span class="op" id="7310409">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7310413">if</span>&nbsp;<span class="ident" id="7310416">strings</span><span class="op" id="7310423">.</span><span class="ident" id="7310424">HasSuffix</span><span class="op" id="7310433">(</span><span class="ident" id="7310434">s</span><span class="op" id="7310435">,</span>&nbsp;<span class="string" id="7310437">&#34;=&#34;</span><span class="op" id="7310440">)</span>&nbsp;<span class="op" id="7310442">||</span>&nbsp;<span class="ident" id="7310445">strings</span><span class="op" id="7310452">.</span><span class="ident" id="7310453">Contains</span><span class="op" id="7310461">(</span><span class="ident" id="7310462">s</span><span class="op" id="7310463">,</span>&nbsp;<span class="string" id="7310465">&#34;==&#34;</span><span class="op" id="7310469">)</span>&nbsp;<span class="op" id="7310471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7310476">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7310485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7310489">buf</span><span class="op" id="7310492">.</span><span class="ident" id="7310493">Reset</span><span class="op" id="7310498">(</span><span class="op" id="7310499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7310503">_</span><span class="op" id="7310504">,</span>&nbsp;<span class="ident" id="7310506">err</span>&nbsp;<span class="op" id="7310510">:=</span>&nbsp;<span class="ident" id="7310513">io</span><span class="op" id="7310515">.</span><span class="ident" id="7310516">Copy</span><span class="op" id="7310520">(</span><span class="op" id="7310521">&amp;</span><span class="ident" id="7310522">buf</span><span class="op" id="7310525">,</span>&nbsp;<span class="ident" id="7310527">newQuotedPrintableReader</span><span class="op" id="7310551">(</span><span class="ident" id="7310552">strings</span><span class="op" id="7310559">.</span><span class="ident" id="7310560">NewReader</span><span class="op" id="7310569">(</span><span class="ident" id="7310570">s</span><span class="op" id="7310571">)</span><span class="op" id="7310572">)</span><span class="op" id="7310573">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7310577">if</span>&nbsp;<span class="ident" id="7310580">err</span>&nbsp;<span class="op" id="7310584">!=</span>&nbsp;<span class="ident" id="7310587">nil</span>&nbsp;<span class="op" id="7310591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7310596">errStr</span>&nbsp;<span class="op" id="7310603">:=</span>&nbsp;<span class="ident" id="7310606">err</span><span class="op" id="7310609">.</span><span class="ident" id="7310610">Error</span><span class="op" id="7310615">(</span><span class="op" id="7310616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7310621">if</span>&nbsp;<span class="ident" id="7310624">strings</span><span class="op" id="7310631">.</span><span class="ident" id="7310632">Contains</span><span class="op" id="7310640">(</span><span class="ident" id="7310641">errStr</span><span class="op" id="7310647">,</span>&nbsp;<span class="string" id="7310649">&#34;invalid&nbsp;bytes&nbsp;after&nbsp;=:&#34;</span><span class="op" id="7310673">)</span>&nbsp;<span class="op" id="7310675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7310681">errStr</span>&nbsp;<span class="op" id="7310688">=</span>&nbsp;<span class="string" id="7310690">&#34;invalid&nbsp;bytes&nbsp;after&nbsp;=&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7310717">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7310722">res</span><span class="op" id="7310725">[</span><span class="ident" id="7310726">errStr</span><span class="op" id="7310732">]</span><span class="op" id="7310733">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7310739">if</span>&nbsp;<span class="ident" id="7310742">strings</span><span class="op" id="7310749">.</span><span class="ident" id="7310750">Contains</span><span class="op" id="7310758">(</span><span class="ident" id="7310759">errStr</span><span class="op" id="7310765">,</span>&nbsp;<span class="string" id="7310767">&#34;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;&#34;</span><span class="op" id="7310803">)</span>&nbsp;<span class="op" id="7310805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7310811">if</span>&nbsp;<span class="ident" id="7310814">strings</span><span class="op" id="7310821">.</span><span class="ident" id="7310822">HasSuffix</span><span class="op" id="7310831">(</span><span class="ident" id="7310832">errStr</span><span class="op" id="7310838">,</span>&nbsp;<span class="string" id="7310840">&#34;0x20&#34;</span><span class="op" id="7310846">)</span>&nbsp;<span class="op" id="7310848">&amp;&amp;</span>&nbsp;<span class="op" id="7310851">(</span><span class="ident" id="7310852">strings</span><span class="op" id="7310859">.</span><span class="ident" id="7310860">Contains</span><span class="op" id="7310868">(</span><span class="ident" id="7310869">s</span><span class="op" id="7310870">,</span>&nbsp;<span class="string" id="7310872">&#34;=0&nbsp;&#34;</span><span class="op" id="7310877">)</span>&nbsp;<span class="op" id="7310879">||</span>&nbsp;<span class="ident" id="7310882">strings</span><span class="op" id="7310889">.</span><span class="ident" id="7310890">Contains</span><span class="op" id="7310898">(</span><span class="ident" id="7310899">s</span><span class="op" id="7310900">,</span>&nbsp;<span class="string" id="7310902">&#34;=A&nbsp;&#34;</span><span class="op" id="7310907">)</span>&nbsp;<span class="op" id="7310909">||</span>&nbsp;<span class="ident" id="7310912">strings</span><span class="op" id="7310919">.</span><span class="ident" id="7310920">Contains</span><span class="op" id="7310928">(</span><span class="ident" id="7310929">s</span><span class="op" id="7310930">,</span>&nbsp;<span class="string" id="7310932">&#34;=&nbsp;&#34;</span><span class="op" id="7310936">)</span><span class="op" id="7310937">)</span>&nbsp;<span class="op" id="7310939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7310946">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7310957">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7310963">if</span>&nbsp;<span class="ident" id="7310966">strings</span><span class="op" id="7310973">.</span><span class="ident" id="7310974">HasSuffix</span><span class="op" id="7310983">(</span><span class="ident" id="7310984">errStr</span><span class="op" id="7310990">,</span>&nbsp;<span class="string" id="7310992">&#34;0x3d&#34;</span><span class="op" id="7310998">)</span>&nbsp;<span class="op" id="7311000">&amp;&amp;</span>&nbsp;<span class="op" id="7311003">(</span><span class="ident" id="7311004">strings</span><span class="op" id="7311011">.</span><span class="ident" id="7311012">Contains</span><span class="op" id="7311020">(</span><span class="ident" id="7311021">s</span><span class="op" id="7311022">,</span>&nbsp;<span class="string" id="7311024">&#34;=0=&#34;</span><span class="op" id="7311029">)</span>&nbsp;<span class="op" id="7311031">||</span>&nbsp;<span class="ident" id="7311034">strings</span><span class="op" id="7311041">.</span><span class="ident" id="7311042">Contains</span><span class="op" id="7311050">(</span><span class="ident" id="7311051">s</span><span class="op" id="7311052">,</span>&nbsp;<span class="string" id="7311054">&#34;=A=&#34;</span><span class="op" id="7311059">)</span><span class="op" id="7311060">)</span>&nbsp;<span class="op" id="7311062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7311069">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7311080">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7311086">if</span>&nbsp;<span class="ident" id="7311089">strings</span><span class="op" id="7311096">.</span><span class="ident" id="7311097">HasSuffix</span><span class="op" id="7311106">(</span><span class="ident" id="7311107">errStr</span><span class="op" id="7311113">,</span>&nbsp;<span class="string" id="7311115">&#34;0x0a&#34;</span><span class="op" id="7311121">)</span>&nbsp;<span class="op" id="7311123">||</span>&nbsp;<span class="ident" id="7311126">strings</span><span class="op" id="7311133">.</span><span class="ident" id="7311134">HasSuffix</span><span class="op" id="7311143">(</span><span class="ident" id="7311144">errStr</span><span class="op" id="7311150">,</span>&nbsp;<span class="string" id="7311152">&#34;0x0d&#34;</span><span class="op" id="7311158">)</span>&nbsp;<span class="op" id="7311160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7311167">//&nbsp;bunch&nbsp;of&nbsp;cases;&nbsp;since&nbsp;whitespace&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;line&nbsp;before&nbsp;\n&nbsp;is&nbsp;removed.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7311251">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7311262">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7311267">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7311272">if</span>&nbsp;<span class="ident" id="7311275">strings</span><span class="op" id="7311282">.</span><span class="ident" id="7311283">Contains</span><span class="op" id="7311291">(</span><span class="ident" id="7311292">errStr</span><span class="op" id="7311298">,</span>&nbsp;<span class="string" id="7311300">&#34;unexpected&nbsp;EOF&#34;</span><span class="op" id="7311316">)</span>&nbsp;<span class="op" id="7311318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7311324">return</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7311334">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7311339">if</span>&nbsp;<span class="ident" id="7311342">errStr</span>&nbsp;<span class="op" id="7311349">==</span>&nbsp;<span class="string" id="7311352">&#34;invalid&nbsp;bytes&nbsp;after&nbsp;=&#34;</span>&nbsp;<span class="op" id="7311376">&amp;&amp;</span>&nbsp;<span class="ident" id="7311379">badSoftRx</span><span class="op" id="7311388">.</span><span class="ident" id="7311389">MatchString</span><span class="op" id="7311400">(</span><span class="ident" id="7311401">s</span><span class="op" id="7311402">)</span>&nbsp;<span class="op" id="7311404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7311410">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7311420">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7311425">t</span><span class="op" id="7311426">.</span><span class="ident" id="7311427">Errorf</span><span class="op" id="7311433">(</span><span class="string" id="7311434">&#34;decode(%q)&nbsp;=&nbsp;%v&#34;</span><span class="op" id="7311451">,</span>&nbsp;<span class="ident" id="7311453">s</span><span class="op" id="7311454">,</span>&nbsp;<span class="ident" id="7311456">err</span><span class="op" id="7311459">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7311464">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7311473">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7311477">if</span>&nbsp;<span class="op" id="7311480">*</span><span class="ident" id="7311481">useQprint</span>&nbsp;<span class="op" id="7311491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7311496">cmd</span>&nbsp;<span class="op" id="7311500">:=</span>&nbsp;<span class="ident" id="7311503">exec</span><span class="op" id="7311507">.</span><span class="ident" id="7311508">Command</span><span class="op" id="7311515">(</span><span class="string" id="7311516">&#34;qprint&#34;</span><span class="op" id="7311524">,</span>&nbsp;<span class="string" id="7311526">&#34;-d&#34;</span><span class="op" id="7311530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7311535">cmd</span><span class="op" id="7311538">.</span><span class="ident" id="7311539">Stdin</span>&nbsp;<span class="op" id="7311545">=</span>&nbsp;<span class="ident" id="7311547">strings</span><span class="op" id="7311554">.</span><span class="ident" id="7311555">NewReader</span><span class="op" id="7311564">(</span><span class="ident" id="7311565">s</span><span class="op" id="7311566">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7311571">stderr</span><span class="op" id="7311577">,</span>&nbsp;<span class="ident" id="7311579">err</span>&nbsp;<span class="op" id="7311583">:=</span>&nbsp;<span class="ident" id="7311586">cmd</span><span class="op" id="7311589">.</span><span class="ident" id="7311590">StderrPipe</span><span class="op" id="7311600">(</span><span class="op" id="7311601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7311606">if</span>&nbsp;<span class="ident" id="7311609">err</span>&nbsp;<span class="op" id="7311613">!=</span>&nbsp;<span class="ident" id="7311616">nil</span>&nbsp;<span class="op" id="7311620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7311626">panic</span><span class="op" id="7311631">(</span><span class="ident" id="7311632">err</span><span class="op" id="7311635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7311640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7311645">qpres</span>&nbsp;<span class="op" id="7311651">:=</span>&nbsp;<span class="builtinfunc" id="7311654">make</span><span class="op" id="7311658">(</span><span class="keyword" id="7311659">chan</span>&nbsp;<span class="keyword" id="7311664">interface</span><span class="op" id="7311673">{</span><span class="op" id="7311674">}</span><span class="op" id="7311675">,</span>&nbsp;<span class="num" id="7311677">2</span><span class="op" id="7311678">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7311683">go</span>&nbsp;<span class="keyword" id="7311686">func</span><span class="op" id="7311690">(</span><span class="op" id="7311691">)</span>&nbsp;<span class="op" id="7311693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7311699">br</span>&nbsp;<span class="op" id="7311702">:=</span>&nbsp;<span class="ident" id="7311705">bufio</span><span class="op" id="7311710">.</span><span class="ident" id="7311711">NewReader</span><span class="op" id="7311720">(</span><span class="ident" id="7311721">stderr</span><span class="op" id="7311727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7311733">s</span><span class="op" id="7311734">,</span>&nbsp;<span class="ident" id="7311736">_</span>&nbsp;<span class="op" id="7311738">:=</span>&nbsp;<span class="ident" id="7311741">br</span><span class="op" id="7311743">.</span><span class="ident" id="7311744">ReadString</span><span class="op" id="7311754">(</span><span class="string" id="7311755">&#39;\n&#39;</span><span class="op" id="7311759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7311765">if</span>&nbsp;<span class="ident" id="7311768">s</span>&nbsp;<span class="op" id="7311770">!=</span>&nbsp;<span class="string" id="7311773">&#34;&#34;</span>&nbsp;<span class="op" id="7311776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7311783">qpres</span>&nbsp;<span class="op" id="7311789">&lt;-</span>&nbsp;<span class="ident" id="7311792">errors</span><span class="op" id="7311798">.</span><span class="ident" id="7311799">New</span><span class="op" id="7311802">(</span><span class="ident" id="7311803">s</span><span class="op" id="7311804">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7311811">if</span>&nbsp;<span class="ident" id="7311814">cmd</span><span class="op" id="7311817">.</span><span class="ident" id="7311818">Process</span>&nbsp;<span class="op" id="7311826">!=</span>&nbsp;<span class="ident" id="7311829">nil</span>&nbsp;<span class="op" id="7311833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7311841">//&nbsp;It&nbsp;can&nbsp;get&nbsp;stuck&nbsp;on&nbsp;invalid&nbsp;input,&nbsp;like:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7311891">//&nbsp;echo&nbsp;-n&nbsp;&#34;0000=&nbsp;&#34;&nbsp;|&nbsp;qprint&nbsp;-d</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7311929">cmd</span><span class="op" id="7311932">.</span><span class="ident" id="7311933">Process</span><span class="op" id="7311940">.</span><span class="ident" id="7311941">Kill</span><span class="op" id="7311945">(</span><span class="op" id="7311946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7311953">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7311959">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7311964">}</span><span class="op" id="7311965">(</span><span class="op" id="7311966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7311971">go</span>&nbsp;<span class="keyword" id="7311974">func</span><span class="op" id="7311978">(</span><span class="op" id="7311979">)</span>&nbsp;<span class="op" id="7311981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7311987">want</span><span class="op" id="7311991">,</span>&nbsp;<span class="ident" id="7311993">err</span>&nbsp;<span class="op" id="7311997">:=</span>&nbsp;<span class="ident" id="7312000">cmd</span><span class="op" id="7312003">.</span><span class="ident" id="7312004">Output</span><span class="op" id="7312010">(</span><span class="op" id="7312011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7312017">if</span>&nbsp;<span class="ident" id="7312020">err</span>&nbsp;<span class="op" id="7312024">==</span>&nbsp;<span class="ident" id="7312027">nil</span>&nbsp;<span class="op" id="7312031">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7312038">qpres</span>&nbsp;<span class="op" id="7312044">&lt;-</span>&nbsp;<span class="ident" id="7312047">want</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7312056">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7312061">}</span><span class="op" id="7312062">(</span><span class="op" id="7312063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7312068">select</span>&nbsp;<span class="op" id="7312075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7312080">case</span>&nbsp;<span class="ident" id="7312085">got</span>&nbsp;<span class="op" id="7312089">:=</span>&nbsp;<span class="op" id="7312092">&lt;-</span><span class="ident" id="7312094">qpres</span><span class="op" id="7312099">:</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7312105">if</span>&nbsp;<span class="ident" id="7312108">want</span><span class="op" id="7312112">,</span>&nbsp;<span class="ident" id="7312114">ok</span>&nbsp;<span class="op" id="7312117">:=</span>&nbsp;<span class="ident" id="7312120">got</span><span class="op" id="7312123">.</span><span class="op" id="7312124">(</span><span class="op" id="7312125">[</span><span class="op" id="7312126">]</span><span class="builtintype" id="7312127">byte</span><span class="op" id="7312131">)</span><span class="op" id="7312132">;</span>&nbsp;<span class="ident" id="7312134">ok</span>&nbsp;<span class="op" id="7312137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7312144">if</span>&nbsp;<span class="builtintype" id="7312147">string</span><span class="op" id="7312153">(</span><span class="ident" id="7312154">want</span><span class="op" id="7312158">)</span>&nbsp;<span class="op" id="7312160">!=</span>&nbsp;<span class="ident" id="7312163">buf</span><span class="op" id="7312166">.</span><span class="ident" id="7312167">String</span><span class="op" id="7312173">(</span><span class="op" id="7312174">)</span>&nbsp;<span class="op" id="7312176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7312184">t</span><span class="op" id="7312185">.</span><span class="ident" id="7312186">Errorf</span><span class="op" id="7312192">(</span><span class="string" id="7312193">&#34;go&nbsp;decode(%q)&nbsp;=&nbsp;%q;&nbsp;qprint&nbsp;=&nbsp;%q&#34;</span><span class="op" id="7312226">,</span>&nbsp;<span class="ident" id="7312228">s</span><span class="op" id="7312229">,</span>&nbsp;<span class="ident" id="7312231">want</span><span class="op" id="7312235">,</span>&nbsp;<span class="ident" id="7312237">buf</span><span class="op" id="7312240">.</span><span class="ident" id="7312241">String</span><span class="op" id="7312247">(</span><span class="op" id="7312248">)</span><span class="op" id="7312249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7312256">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7312262">}</span>&nbsp;<span class="keyword" id="7312264">else</span>&nbsp;<span class="op" id="7312269">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7312276">t</span><span class="op" id="7312277">.</span><span class="ident" id="7312278">Logf</span><span class="op" id="7312282">(</span><span class="string" id="7312283">&#34;qprint&nbsp;-d(%q)&nbsp;=&nbsp;%v&#34;</span><span class="op" id="7312303">,</span>&nbsp;<span class="ident" id="7312305">s</span><span class="op" id="7312306">,</span>&nbsp;<span class="ident" id="7312308">got</span><span class="op" id="7312311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7312317">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7312322">case</span>&nbsp;<span class="op" id="7312327">&lt;-</span><span class="ident" id="7312329">time</span><span class="op" id="7312333">.</span><span class="ident" id="7312334">After</span><span class="op" id="7312339">(</span><span class="num" id="7312340">5</span>&nbsp;<span class="op" id="7312342">*</span>&nbsp;<span class="ident" id="7312344">time</span><span class="op" id="7312348">.</span><span class="ident" id="7312349">Second</span><span class="op" id="7312355">)</span><span class="op" id="7312356">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7312362">t</span><span class="op" id="7312363">.</span><span class="ident" id="7312364">Logf</span><span class="op" id="7312368">(</span><span class="string" id="7312369">&#34;qprint&nbsp;timeout&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7312391">,</span>&nbsp;<span class="ident" id="7312393">s</span><span class="op" id="7312394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7312399">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7312403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7312407">res</span><span class="op" id="7312410">[</span><span class="string" id="7312411">&#34;OK&#34;</span><span class="op" id="7312415">]</span><span class="op" id="7312416">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7312420">}</span><span class="op" id="7312421">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7312424">var</span>&nbsp;<span class="ident" id="7312428">outcomes</span>&nbsp;<span class="op" id="7312437">[</span><span class="op" id="7312438">]</span><span class="builtintype" id="7312439">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7312447">for</span>&nbsp;<span class="ident" id="7312451">k</span><span class="op" id="7312452">,</span>&nbsp;<span class="ident" id="7312454">v</span>&nbsp;<span class="op" id="7312456">:=</span>&nbsp;<span class="keyword" id="7312459">range</span>&nbsp;<span class="ident" id="7312465">res</span>&nbsp;<span class="op" id="7312469">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7312473">outcomes</span>&nbsp;<span class="op" id="7312482">=</span>&nbsp;<span class="builtinfunc" id="7312484">append</span><span class="op" id="7312490">(</span><span class="ident" id="7312491">outcomes</span><span class="op" id="7312499">,</span>&nbsp;<span class="ident" id="7312501">fmt</span><span class="op" id="7312504">.</span><span class="ident" id="7312505">Sprintf</span><span class="op" id="7312512">(</span><span class="string" id="7312513">&#34;%v:&nbsp;%d&#34;</span><span class="op" id="7312521">,</span>&nbsp;<span class="ident" id="7312523">k</span><span class="op" id="7312524">,</span>&nbsp;<span class="ident" id="7312526">v</span><span class="op" id="7312527">)</span><span class="op" id="7312528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7312531">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7312534">sort</span><span class="op" id="7312538">.</span><span class="ident" id="7312539">Strings</span><span class="op" id="7312546">(</span><span class="ident" id="7312547">outcomes</span><span class="op" id="7312555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7312558">got</span>&nbsp;<span class="op" id="7312562">:=</span>&nbsp;<span class="ident" id="7312565">strings</span><span class="op" id="7312572">.</span><span class="ident" id="7312573">Join</span><span class="op" id="7312577">(</span><span class="ident" id="7312578">outcomes</span><span class="op" id="7312586">,</span>&nbsp;<span class="string" id="7312588">&#34;\n&#34;</span><span class="op" id="7312592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7312595">want</span>&nbsp;<span class="op" id="7312600">:=</span>&nbsp;<span class="string" id="7312603">`OK:&nbsp;21576<br>
<span class="lineno">195</span>invalid&nbsp;bytes&nbsp;after&nbsp;=:&nbsp;3397<br>
<span class="lineno"></span>multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x0a:&nbsp;1400<br>
<span class="lineno"></span>multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x0d:&nbsp;2700<br>
<span class="lineno"></span>multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x20:&nbsp;2490<br>
<span class="lineno"></span>multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x3d:&nbsp;440<br>
<span class="lineno">200</span>unexpected&nbsp;EOF:&nbsp;3122`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7312888">if</span>&nbsp;<span class="ident" id="7312891">got</span>&nbsp;<span class="op" id="7312895">!=</span>&nbsp;<span class="ident" id="7312898">want</span>&nbsp;<span class="op" id="7312903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7312907">t</span><span class="op" id="7312908">.</span><span class="ident" id="7312909">Errorf</span><span class="op" id="7312915">(</span><span class="string" id="7312916">&#34;Got:\n%s\nWant:\n%s&#34;</span><span class="op" id="7312937">,</span>&nbsp;<span class="ident" id="7312939">got</span><span class="op" id="7312942">,</span>&nbsp;<span class="ident" id="7312944">want</span><span class="op" id="7312948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7312951">}</span><br>
<span class="lineno"></span><span class="op" id="7312953">}</span>
</div>
</body>
</html>
