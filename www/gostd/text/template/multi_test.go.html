<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/template</h2>
<ul>
<li><a href="/gostd/text/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/text/template/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/text/template/examplefiles_test.go.html">examplefiles_test.go</a></li>
<li><a href="/gostd/text/template/examplefunc_test.go.html">examplefunc_test.go</a></li>
<li><a href="/gostd/text/template/exec.go.html">exec.go</a></li>
<li><a href="/gostd/text/template/exec_test.go.html">exec_test.go</a></li>
<li><a href="/gostd/text/template/funcs.go.html">funcs.go</a></li>
<li><a href="/gostd/text/template/helper.go.html">helper.go</a></li>
<li><a href="/gostd/text/template/multi_test.go.html" class="current">multi_test.go</a></li>
<li><a href="/gostd/text/template/template.go.html">template.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7724473">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7724528">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7724582">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7724633">package</span>&nbsp;<span class="ident" id="7724641">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7724651">//&nbsp;Tests&nbsp;for&nbsp;mulitple-template&nbsp;parsing&nbsp;and&nbsp;execution.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7724706">import</span>&nbsp;<span class="op" id="7724713">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7724716">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7724725">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7724732">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7724743">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7724754">&#34;text/template/parse&#34;</span><br>
<span class="lineno">15</span><span class="op" id="7724776">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7724779">const</span>&nbsp;<span class="op" id="7724785">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7724788">noError</span>&nbsp;&nbsp;<span class="op" id="7724797">=</span>&nbsp;<span class="builtintype" id="7724799">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7724805">hasError</span>&nbsp;<span class="op" id="7724814">=</span>&nbsp;<span class="builtintype" id="7724816">false</span><br>
<span class="lineno">20</span><span class="op" id="7724822">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7724825">type</span>&nbsp;<span class="ident" id="7724830">multiParseTest</span>&nbsp;<span class="keyword" id="7724845">struct</span>&nbsp;<span class="op" id="7724852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7724855">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7724863">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7724871">input</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7724879">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7724887">ok</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7724895">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7724901">names</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7724909">[</span><span class="op" id="7724910">]</span><span class="builtintype" id="7724911">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7724919">results</span>&nbsp;<span class="op" id="7724927">[</span><span class="op" id="7724928">]</span><span class="builtintype" id="7724929">string</span><br>
<span class="lineno"></span><span class="op" id="7724936">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="7724939">var</span>&nbsp;<span class="ident" id="7724943">multiParseTests</span>&nbsp;<span class="op" id="7724959">=</span>&nbsp;<span class="op" id="7724961">[</span><span class="op" id="7724962">]</span><span class="ident" id="7724963">multiParseTest</span><span class="op" id="7724977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7724980">{</span><span class="string" id="7724981">&#34;empty&#34;</span><span class="op" id="7724988">,</span>&nbsp;<span class="string" id="7724990">&#34;&#34;</span><span class="op" id="7724992">,</span>&nbsp;<span class="ident" id="7724994">noError</span><span class="op" id="7725001">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7725005">nil</span><span class="op" id="7725008">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7725012">nil</span><span class="op" id="7725015">}</span><span class="op" id="7725016">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7725019">{</span><span class="string" id="7725020">&#34;one&#34;</span><span class="op" id="7725025">,</span>&nbsp;<span class="string" id="7725027">`{{define&nbsp;&#34;foo&#34;}}&nbsp;FOO&nbsp;{{end}}`</span><span class="op" id="7725057">,</span>&nbsp;<span class="ident" id="7725059">noError</span><span class="op" id="7725066">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7725070">[</span><span class="op" id="7725071">]</span><span class="builtintype" id="7725072">string</span><span class="op" id="7725078">{</span><span class="string" id="7725079">&#34;foo&#34;</span><span class="op" id="7725084">}</span><span class="op" id="7725085">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7725089">[</span><span class="op" id="7725090">]</span><span class="builtintype" id="7725091">string</span><span class="op" id="7725097">{</span><span class="string" id="7725098">&#34;&nbsp;FOO&nbsp;&#34;</span><span class="op" id="7725105">}</span><span class="op" id="7725106">}</span><span class="op" id="7725107">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7725110">{</span><span class="string" id="7725111">&#34;two&#34;</span><span class="op" id="7725116">,</span>&nbsp;<span class="string" id="7725118">`{{define&nbsp;&#34;foo&#34;}}&nbsp;FOO&nbsp;{{end}}{{define&nbsp;&#34;bar&#34;}}&nbsp;BAR&nbsp;{{end}}`</span><span class="op" id="7725176">,</span>&nbsp;<span class="ident" id="7725178">noError</span><span class="op" id="7725185">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7725189">[</span><span class="op" id="7725190">]</span><span class="builtintype" id="7725191">string</span><span class="op" id="7725197">{</span><span class="string" id="7725198">&#34;foo&#34;</span><span class="op" id="7725203">,</span>&nbsp;<span class="string" id="7725205">&#34;bar&#34;</span><span class="op" id="7725210">}</span><span class="op" id="7725211">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7725215">[</span><span class="op" id="7725216">]</span><span class="builtintype" id="7725217">string</span><span class="op" id="7725223">{</span><span class="string" id="7725224">&#34;&nbsp;FOO&nbsp;&#34;</span><span class="op" id="7725231">,</span>&nbsp;<span class="string" id="7725233">&#34;&nbsp;BAR&nbsp;&#34;</span><span class="op" id="7725240">}</span><span class="op" id="7725241">}</span><span class="op" id="7725242">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7725245">//&nbsp;errors</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7725256">{</span><span class="string" id="7725257">&#34;missing&nbsp;end&#34;</span><span class="op" id="7725270">,</span>&nbsp;<span class="string" id="7725272">`{{define&nbsp;&#34;foo&#34;}}&nbsp;FOO&nbsp;`</span><span class="op" id="7725295">,</span>&nbsp;<span class="ident" id="7725297">hasError</span><span class="op" id="7725305">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7725309">nil</span><span class="op" id="7725312">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7725316">nil</span><span class="op" id="7725319">}</span><span class="op" id="7725320">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7725323">{</span><span class="string" id="7725324">&#34;malformed&nbsp;name&#34;</span><span class="op" id="7725340">,</span>&nbsp;<span class="string" id="7725342">`{{define&nbsp;&#34;foo}}&nbsp;FOO&nbsp;`</span><span class="op" id="7725364">,</span>&nbsp;<span class="ident" id="7725366">hasError</span><span class="op" id="7725374">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7725378">nil</span><span class="op" id="7725381">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7725385">nil</span><span class="op" id="7725388">}</span><span class="op" id="7725389">,</span><br>
<span class="lineno"></span><span class="op" id="7725391">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7725394">func</span>&nbsp;<span class="ident" id="7725399">TestMultiParse</span><span class="op" id="7725413">(</span><span class="ident" id="7725414">t</span>&nbsp;<span class="op" id="7725416">*</span><span class="ident" id="7725417">testing</span><span class="op" id="7725424">.</span><span class="ident" id="7725425">T</span><span class="op" id="7725426">)</span>&nbsp;<span class="op" id="7725428">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7725431">for</span>&nbsp;<span class="ident" id="7725435">_</span><span class="op" id="7725436">,</span>&nbsp;<span class="ident" id="7725438">test</span>&nbsp;<span class="op" id="7725443">:=</span>&nbsp;<span class="keyword" id="7725446">range</span>&nbsp;<span class="ident" id="7725452">multiParseTests</span>&nbsp;<span class="op" id="7725468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7725472">template</span><span class="op" id="7725480">,</span>&nbsp;<span class="ident" id="7725482">err</span>&nbsp;<span class="op" id="7725486">:=</span>&nbsp;<span class="ident" id="7725489">New</span><span class="op" id="7725492">(</span><span class="string" id="7725493">&#34;root&#34;</span><span class="op" id="7725499">)</span><span class="op" id="7725500">.</span><span class="ident" id="7725501">Parse</span><span class="op" id="7725506">(</span><span class="ident" id="7725507">test</span><span class="op" id="7725511">.</span><span class="ident" id="7725512">input</span><span class="op" id="7725517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7725521">switch</span>&nbsp;<span class="op" id="7725528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7725532">case</span>&nbsp;<span class="ident" id="7725537">err</span>&nbsp;<span class="op" id="7725541">==</span>&nbsp;<span class="ident" id="7725544">nil</span>&nbsp;<span class="op" id="7725548">&amp;&amp;</span>&nbsp;<span class="op" id="7725551">!</span><span class="ident" id="7725552">test</span><span class="op" id="7725556">.</span><span class="ident" id="7725557">ok</span><span class="op" id="7725559">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7725564">t</span><span class="op" id="7725565">.</span><span class="ident" id="7725566">Errorf</span><span class="op" id="7725572">(</span><span class="string" id="7725573">&#34;%q:&nbsp;expected&nbsp;error;&nbsp;got&nbsp;none&#34;</span><span class="op" id="7725603">,</span>&nbsp;<span class="ident" id="7725605">test</span><span class="op" id="7725609">.</span><span class="ident" id="7725610">name</span><span class="op" id="7725614">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7725619">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7725630">case</span>&nbsp;<span class="ident" id="7725635">err</span>&nbsp;<span class="op" id="7725639">!=</span>&nbsp;<span class="ident" id="7725642">nil</span>&nbsp;<span class="op" id="7725646">&amp;&amp;</span>&nbsp;<span class="ident" id="7725649">test</span><span class="op" id="7725653">.</span><span class="ident" id="7725654">ok</span><span class="op" id="7725656">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7725661">t</span><span class="op" id="7725662">.</span><span class="ident" id="7725663">Errorf</span><span class="op" id="7725669">(</span><span class="string" id="7725670">&#34;%q:&nbsp;unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="7725696">,</span>&nbsp;<span class="ident" id="7725698">test</span><span class="op" id="7725702">.</span><span class="ident" id="7725703">name</span><span class="op" id="7725707">,</span>&nbsp;<span class="ident" id="7725709">err</span><span class="op" id="7725712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7725717">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7725728">case</span>&nbsp;<span class="ident" id="7725733">err</span>&nbsp;<span class="op" id="7725737">!=</span>&nbsp;<span class="ident" id="7725740">nil</span>&nbsp;<span class="op" id="7725744">&amp;&amp;</span>&nbsp;<span class="op" id="7725747">!</span><span class="ident" id="7725748">test</span><span class="op" id="7725752">.</span><span class="ident" id="7725753">ok</span><span class="op" id="7725755">:</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7725760">//&nbsp;expected&nbsp;error,&nbsp;got&nbsp;one</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7725790">if</span>&nbsp;<span class="op" id="7725793">*</span><span class="ident" id="7725794">debug</span>&nbsp;<span class="op" id="7725800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7725806">fmt</span><span class="op" id="7725809">.</span><span class="ident" id="7725810">Printf</span><span class="op" id="7725816">(</span><span class="string" id="7725817">&#34;%s:&nbsp;%s\n\t%s\n&#34;</span><span class="op" id="7725833">,</span>&nbsp;<span class="ident" id="7725835">test</span><span class="op" id="7725839">.</span><span class="ident" id="7725840">name</span><span class="op" id="7725844">,</span>&nbsp;<span class="ident" id="7725846">test</span><span class="op" id="7725850">.</span><span class="ident" id="7725851">input</span><span class="op" id="7725856">,</span>&nbsp;<span class="ident" id="7725858">err</span><span class="op" id="7725861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7725866">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7725871">continue</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7725882">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7725886">if</span>&nbsp;<span class="ident" id="7725889">template</span>&nbsp;<span class="op" id="7725898">==</span>&nbsp;<span class="ident" id="7725901">nil</span>&nbsp;<span class="op" id="7725905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7725910">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7725921">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7725925">if</span>&nbsp;<span class="builtinfunc" id="7725928">len</span><span class="op" id="7725931">(</span><span class="ident" id="7725932">template</span><span class="op" id="7725940">.</span><span class="ident" id="7725941">tmpl</span><span class="op" id="7725945">)</span>&nbsp;<span class="op" id="7725947">!=</span>&nbsp;<span class="builtinfunc" id="7725950">len</span><span class="op" id="7725953">(</span><span class="ident" id="7725954">test</span><span class="op" id="7725958">.</span><span class="ident" id="7725959">names</span><span class="op" id="7725964">)</span><span class="op" id="7725965">+</span><span class="num" id="7725966">1</span>&nbsp;<span class="op" id="7725968">{</span>&nbsp;<span class="comment" id="7725970">//&nbsp;+1&nbsp;for&nbsp;root</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7725988">t</span><span class="op" id="7725989">.</span><span class="ident" id="7725990">Errorf</span><span class="op" id="7725996">(</span><span class="string" id="7725997">&#34;%s:&nbsp;wrong&nbsp;number&nbsp;of&nbsp;templates;&nbsp;wanted&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7726046">,</span>&nbsp;<span class="ident" id="7726048">test</span><span class="op" id="7726052">.</span><span class="ident" id="7726053">name</span><span class="op" id="7726057">,</span>&nbsp;<span class="builtinfunc" id="7726059">len</span><span class="op" id="7726062">(</span><span class="ident" id="7726063">test</span><span class="op" id="7726067">.</span><span class="ident" id="7726068">names</span><span class="op" id="7726073">)</span><span class="op" id="7726074">,</span>&nbsp;<span class="builtinfunc" id="7726076">len</span><span class="op" id="7726079">(</span><span class="ident" id="7726080">template</span><span class="op" id="7726088">.</span><span class="ident" id="7726089">tmpl</span><span class="op" id="7726093">)</span><span class="op" id="7726094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7726099">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7726110">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7726114">for</span>&nbsp;<span class="ident" id="7726118">i</span><span class="op" id="7726119">,</span>&nbsp;<span class="ident" id="7726121">name</span>&nbsp;<span class="op" id="7726126">:=</span>&nbsp;<span class="keyword" id="7726129">range</span>&nbsp;<span class="ident" id="7726135">test</span><span class="op" id="7726139">.</span><span class="ident" id="7726140">names</span>&nbsp;<span class="op" id="7726146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7726151">tmpl</span><span class="op" id="7726155">,</span>&nbsp;<span class="ident" id="7726157">ok</span>&nbsp;<span class="op" id="7726160">:=</span>&nbsp;<span class="ident" id="7726163">template</span><span class="op" id="7726171">.</span><span class="ident" id="7726172">tmpl</span><span class="op" id="7726176">[</span><span class="ident" id="7726177">name</span><span class="op" id="7726181">]</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7726186">if</span>&nbsp;<span class="op" id="7726189">!</span><span class="ident" id="7726190">ok</span>&nbsp;<span class="op" id="7726193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7726199">t</span><span class="op" id="7726200">.</span><span class="ident" id="7726201">Errorf</span><span class="op" id="7726207">(</span><span class="string" id="7726208">&#34;%s:&nbsp;can&#39;t&nbsp;find&nbsp;template&nbsp;%q&#34;</span><span class="op" id="7726236">,</span>&nbsp;<span class="ident" id="7726238">test</span><span class="op" id="7726242">.</span><span class="ident" id="7726243">name</span><span class="op" id="7726247">,</span>&nbsp;<span class="ident" id="7726249">name</span><span class="op" id="7726253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7726259">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7726271">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7726276">result</span>&nbsp;<span class="op" id="7726283">:=</span>&nbsp;<span class="ident" id="7726286">tmpl</span><span class="op" id="7726290">.</span><span class="ident" id="7726291">Root</span><span class="op" id="7726295">.</span><span class="ident" id="7726296">String</span><span class="op" id="7726302">(</span><span class="op" id="7726303">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7726308">if</span>&nbsp;<span class="ident" id="7726311">result</span>&nbsp;<span class="op" id="7726318">!=</span>&nbsp;<span class="ident" id="7726321">test</span><span class="op" id="7726325">.</span><span class="ident" id="7726326">results</span><span class="op" id="7726333">[</span><span class="ident" id="7726334">i</span><span class="op" id="7726335">]</span>&nbsp;<span class="op" id="7726337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7726343">t</span><span class="op" id="7726344">.</span><span class="ident" id="7726345">Errorf</span><span class="op" id="7726351">(</span><span class="string" id="7726352">&#34;%s=(%q):&nbsp;got\n\t%v\nexpected\n\t%v&#34;</span><span class="op" id="7726388">,</span>&nbsp;<span class="ident" id="7726390">test</span><span class="op" id="7726394">.</span><span class="ident" id="7726395">name</span><span class="op" id="7726399">,</span>&nbsp;<span class="ident" id="7726401">test</span><span class="op" id="7726405">.</span><span class="ident" id="7726406">input</span><span class="op" id="7726411">,</span>&nbsp;<span class="ident" id="7726413">result</span><span class="op" id="7726419">,</span>&nbsp;<span class="ident" id="7726421">test</span><span class="op" id="7726425">.</span><span class="ident" id="7726426">results</span><span class="op" id="7726433">[</span><span class="ident" id="7726434">i</span><span class="op" id="7726435">]</span><span class="op" id="7726436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7726441">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7726445">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7726448">}</span><br>
<span class="lineno">85</span><span class="op" id="7726450">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7726453">var</span>&nbsp;<span class="ident" id="7726457">multiExecTests</span>&nbsp;<span class="op" id="7726472">=</span>&nbsp;<span class="op" id="7726474">[</span><span class="op" id="7726475">]</span><span class="ident" id="7726476">execTest</span><span class="op" id="7726484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7726487">{</span><span class="string" id="7726488">&#34;empty&#34;</span><span class="op" id="7726495">,</span>&nbsp;<span class="string" id="7726497">&#34;&#34;</span><span class="op" id="7726499">,</span>&nbsp;<span class="string" id="7726501">&#34;&#34;</span><span class="op" id="7726503">,</span>&nbsp;<span class="ident" id="7726505">nil</span><span class="op" id="7726508">,</span>&nbsp;<span class="builtintype" id="7726510">true</span><span class="op" id="7726514">}</span><span class="op" id="7726515">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7726518">{</span><span class="string" id="7726519">&#34;text&#34;</span><span class="op" id="7726525">,</span>&nbsp;<span class="string" id="7726527">&#34;some&nbsp;text&#34;</span><span class="op" id="7726538">,</span>&nbsp;<span class="string" id="7726540">&#34;some&nbsp;text&#34;</span><span class="op" id="7726551">,</span>&nbsp;<span class="ident" id="7726553">nil</span><span class="op" id="7726556">,</span>&nbsp;<span class="builtintype" id="7726558">true</span><span class="op" id="7726562">}</span><span class="op" id="7726563">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7726566">{</span><span class="string" id="7726567">&#34;invoke&nbsp;x&#34;</span><span class="op" id="7726577">,</span>&nbsp;<span class="string" id="7726579">`{{template&nbsp;&#34;x&#34;&nbsp;.SI}}`</span><span class="op" id="7726601">,</span>&nbsp;<span class="string" id="7726603">&#34;TEXT&#34;</span><span class="op" id="7726609">,</span>&nbsp;<span class="ident" id="7726611">tVal</span><span class="op" id="7726615">,</span>&nbsp;<span class="builtintype" id="7726617">true</span><span class="op" id="7726621">}</span><span class="op" id="7726622">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7726625">{</span><span class="string" id="7726626">&#34;invoke&nbsp;x&nbsp;no&nbsp;args&#34;</span><span class="op" id="7726644">,</span>&nbsp;<span class="string" id="7726646">`{{template&nbsp;&#34;x&#34;}}`</span><span class="op" id="7726664">,</span>&nbsp;<span class="string" id="7726666">&#34;TEXT&#34;</span><span class="op" id="7726672">,</span>&nbsp;<span class="ident" id="7726674">tVal</span><span class="op" id="7726678">,</span>&nbsp;<span class="builtintype" id="7726680">true</span><span class="op" id="7726684">}</span><span class="op" id="7726685">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7726688">{</span><span class="string" id="7726689">&#34;invoke&nbsp;dot&nbsp;int&#34;</span><span class="op" id="7726705">,</span>&nbsp;<span class="string" id="7726707">`{{template&nbsp;&#34;dot&#34;&nbsp;.I}}`</span><span class="op" id="7726730">,</span>&nbsp;<span class="string" id="7726732">&#34;17&#34;</span><span class="op" id="7726736">,</span>&nbsp;<span class="ident" id="7726738">tVal</span><span class="op" id="7726742">,</span>&nbsp;<span class="builtintype" id="7726744">true</span><span class="op" id="7726748">}</span><span class="op" id="7726749">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7726752">{</span><span class="string" id="7726753">&#34;invoke&nbsp;dot&nbsp;[]int&#34;</span><span class="op" id="7726771">,</span>&nbsp;<span class="string" id="7726773">`{{template&nbsp;&#34;dot&#34;&nbsp;.SI}}`</span><span class="op" id="7726797">,</span>&nbsp;<span class="string" id="7726799">&#34;[3&nbsp;4&nbsp;5]&#34;</span><span class="op" id="7726808">,</span>&nbsp;<span class="ident" id="7726810">tVal</span><span class="op" id="7726814">,</span>&nbsp;<span class="builtintype" id="7726816">true</span><span class="op" id="7726820">}</span><span class="op" id="7726821">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7726824">{</span><span class="string" id="7726825">&#34;invoke&nbsp;dotV&#34;</span><span class="op" id="7726838">,</span>&nbsp;<span class="string" id="7726840">`{{template&nbsp;&#34;dotV&#34;&nbsp;.U}}`</span><span class="op" id="7726864">,</span>&nbsp;<span class="string" id="7726866">&#34;v&#34;</span><span class="op" id="7726869">,</span>&nbsp;<span class="ident" id="7726871">tVal</span><span class="op" id="7726875">,</span>&nbsp;<span class="builtintype" id="7726877">true</span><span class="op" id="7726881">}</span><span class="op" id="7726882">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7726885">{</span><span class="string" id="7726886">&#34;invoke&nbsp;nested&nbsp;int&#34;</span><span class="op" id="7726905">,</span>&nbsp;<span class="string" id="7726907">`{{template&nbsp;&#34;nested&#34;&nbsp;.I}}`</span><span class="op" id="7726933">,</span>&nbsp;<span class="string" id="7726935">&#34;17&#34;</span><span class="op" id="7726939">,</span>&nbsp;<span class="ident" id="7726941">tVal</span><span class="op" id="7726945">,</span>&nbsp;<span class="builtintype" id="7726947">true</span><span class="op" id="7726951">}</span><span class="op" id="7726952">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7726955">{</span><span class="string" id="7726956">&#34;variable&nbsp;declared&nbsp;by&nbsp;template&#34;</span><span class="op" id="7726987">,</span>&nbsp;<span class="string" id="7726989">`{{template&nbsp;&#34;nested&#34;&nbsp;$x:=.SI}},{{index&nbsp;$x&nbsp;1}}`</span><span class="op" id="7727035">,</span>&nbsp;<span class="string" id="7727037">&#34;[3&nbsp;4&nbsp;5],4&#34;</span><span class="op" id="7727048">,</span>&nbsp;<span class="ident" id="7727050">tVal</span><span class="op" id="7727054">,</span>&nbsp;<span class="builtintype" id="7727056">true</span><span class="op" id="7727060">}</span><span class="op" id="7727061">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7727065">//&nbsp;User-defined&nbsp;function:&nbsp;test&nbsp;argument&nbsp;evaluator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7727117">{</span><span class="string" id="7727118">&#34;testFunc&nbsp;literal&#34;</span><span class="op" id="7727136">,</span>&nbsp;<span class="string" id="7727138">`{{oneArg&nbsp;&#34;joe&#34;}}`</span><span class="op" id="7727156">,</span>&nbsp;<span class="string" id="7727158">&#34;oneArg=joe&#34;</span><span class="op" id="7727170">,</span>&nbsp;<span class="ident" id="7727172">tVal</span><span class="op" id="7727176">,</span>&nbsp;<span class="builtintype" id="7727178">true</span><span class="op" id="7727182">}</span><span class="op" id="7727183">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7727186">{</span><span class="string" id="7727187">&#34;testFunc&nbsp;.&#34;</span><span class="op" id="7727199">,</span>&nbsp;<span class="string" id="7727201">`{{oneArg&nbsp;.}}`</span><span class="op" id="7727215">,</span>&nbsp;<span class="string" id="7727217">&#34;oneArg=joe&#34;</span><span class="op" id="7727229">,</span>&nbsp;<span class="string" id="7727231">&#34;joe&#34;</span><span class="op" id="7727236">,</span>&nbsp;<span class="builtintype" id="7727238">true</span><span class="op" id="7727242">}</span><span class="op" id="7727243">,</span><br>
<span class="lineno"></span><span class="op" id="7727245">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7727248">//&nbsp;These&nbsp;strings&nbsp;are&nbsp;also&nbsp;in&nbsp;testdata/*.</span><br>
<span class="lineno"></span><span class="keyword" id="7727289">const</span>&nbsp;<span class="ident" id="7727295">multiText1</span>&nbsp;<span class="op" id="7727306">=</span>&nbsp;<span class="string" id="7727308">`<br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp{{define&nbsp;&#34;x&#34;}}TEXT{{end}}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp{{define&nbsp;&#34;dotV&#34;}}{{.V}}{{end}}<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7727372">const</span>&nbsp;<span class="ident" id="7727378">multiText2</span>&nbsp;<span class="op" id="7727389">=</span>&nbsp;<span class="string" id="7727391">`<br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp{{define&nbsp;&#34;dot&#34;}}{{.}}{{end}}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp{{define&nbsp;&#34;nested&#34;}}{{template&nbsp;&#34;dot&#34;&nbsp;.}}{{end}}<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7727474">func</span>&nbsp;<span class="ident" id="7727479">TestMultiExecute</span><span class="op" id="7727495">(</span><span class="ident" id="7727496">t</span>&nbsp;<span class="op" id="7727498">*</span><span class="ident" id="7727499">testing</span><span class="op" id="7727506">.</span><span class="ident" id="7727507">T</span><span class="op" id="7727508">)</span>&nbsp;<span class="op" id="7727510">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7727513">//&nbsp;Declare&nbsp;a&nbsp;couple&nbsp;of&nbsp;templates&nbsp;first.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7727554">template</span><span class="op" id="7727562">,</span>&nbsp;<span class="ident" id="7727564">err</span>&nbsp;<span class="op" id="7727568">:=</span>&nbsp;<span class="ident" id="7727571">New</span><span class="op" id="7727574">(</span><span class="string" id="7727575">&#34;root&#34;</span><span class="op" id="7727581">)</span><span class="op" id="7727582">.</span><span class="ident" id="7727583">Parse</span><span class="op" id="7727588">(</span><span class="ident" id="7727589">multiText1</span><span class="op" id="7727599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7727602">if</span>&nbsp;<span class="ident" id="7727605">err</span>&nbsp;<span class="op" id="7727609">!=</span>&nbsp;<span class="ident" id="7727612">nil</span>&nbsp;<span class="op" id="7727616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7727620">t</span><span class="op" id="7727621">.</span><span class="ident" id="7727622">Fatalf</span><span class="op" id="7727628">(</span><span class="string" id="7727629">&#34;parse&nbsp;error&nbsp;for&nbsp;1:&nbsp;%s&#34;</span><span class="op" id="7727652">,</span>&nbsp;<span class="ident" id="7727654">err</span><span class="op" id="7727657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7727660">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7727663">_</span><span class="op" id="7727664">,</span>&nbsp;<span class="ident" id="7727666">err</span>&nbsp;<span class="op" id="7727670">=</span>&nbsp;<span class="ident" id="7727672">template</span><span class="op" id="7727680">.</span><span class="ident" id="7727681">Parse</span><span class="op" id="7727686">(</span><span class="ident" id="7727687">multiText2</span><span class="op" id="7727697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7727700">if</span>&nbsp;<span class="ident" id="7727703">err</span>&nbsp;<span class="op" id="7727707">!=</span>&nbsp;<span class="ident" id="7727710">nil</span>&nbsp;<span class="op" id="7727714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7727718">t</span><span class="op" id="7727719">.</span><span class="ident" id="7727720">Fatalf</span><span class="op" id="7727726">(</span><span class="string" id="7727727">&#34;parse&nbsp;error&nbsp;for&nbsp;2:&nbsp;%s&#34;</span><span class="op" id="7727750">,</span>&nbsp;<span class="ident" id="7727752">err</span><span class="op" id="7727755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7727758">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7727761">testExecute</span><span class="op" id="7727772">(</span><span class="ident" id="7727773">multiExecTests</span><span class="op" id="7727787">,</span>&nbsp;<span class="ident" id="7727789">template</span><span class="op" id="7727797">,</span>&nbsp;<span class="ident" id="7727799">t</span><span class="op" id="7727800">)</span><br>
<span class="lineno">125</span><span class="op" id="7727802">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7727805">func</span>&nbsp;<span class="ident" id="7727810">TestParseFiles</span><span class="op" id="7727824">(</span><span class="ident" id="7727825">t</span>&nbsp;<span class="op" id="7727827">*</span><span class="ident" id="7727828">testing</span><span class="op" id="7727835">.</span><span class="ident" id="7727836">T</span><span class="op" id="7727837">)</span>&nbsp;<span class="op" id="7727839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7727842">_</span><span class="op" id="7727843">,</span>&nbsp;<span class="ident" id="7727845">err</span>&nbsp;<span class="op" id="7727849">:=</span>&nbsp;<span class="ident" id="7727852">ParseFiles</span><span class="op" id="7727862">(</span><span class="string" id="7727863">&#34;DOES&nbsp;NOT&nbsp;EXIST&#34;</span><span class="op" id="7727879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7727882">if</span>&nbsp;<span class="ident" id="7727885">err</span>&nbsp;<span class="op" id="7727889">==</span>&nbsp;<span class="ident" id="7727892">nil</span>&nbsp;<span class="op" id="7727896">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7727900">t</span><span class="op" id="7727901">.</span><span class="ident" id="7727902">Error</span><span class="op" id="7727907">(</span><span class="string" id="7727908">&#34;expected&nbsp;error&nbsp;for&nbsp;non-existent&nbsp;file;&nbsp;got&nbsp;none&#34;</span><span class="op" id="7727956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7727959">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7727962">template</span>&nbsp;<span class="op" id="7727971">:=</span>&nbsp;<span class="ident" id="7727974">New</span><span class="op" id="7727977">(</span><span class="string" id="7727978">&#34;root&#34;</span><span class="op" id="7727984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7727987">_</span><span class="op" id="7727988">,</span>&nbsp;<span class="ident" id="7727990">err</span>&nbsp;<span class="op" id="7727994">=</span>&nbsp;<span class="ident" id="7727996">template</span><span class="op" id="7728004">.</span><span class="ident" id="7728005">ParseFiles</span><span class="op" id="7728015">(</span><span class="string" id="7728016">&#34;testdata/file1.tmpl&#34;</span><span class="op" id="7728037">,</span>&nbsp;<span class="string" id="7728039">&#34;testdata/file2.tmpl&#34;</span><span class="op" id="7728060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7728063">if</span>&nbsp;<span class="ident" id="7728066">err</span>&nbsp;<span class="op" id="7728070">!=</span>&nbsp;<span class="ident" id="7728073">nil</span>&nbsp;<span class="op" id="7728077">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7728081">t</span><span class="op" id="7728082">.</span><span class="ident" id="7728083">Fatalf</span><span class="op" id="7728089">(</span><span class="string" id="7728090">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="7728115">,</span>&nbsp;<span class="ident" id="7728117">err</span><span class="op" id="7728120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7728123">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7728126">testExecute</span><span class="op" id="7728137">(</span><span class="ident" id="7728138">multiExecTests</span><span class="op" id="7728152">,</span>&nbsp;<span class="ident" id="7728154">template</span><span class="op" id="7728162">,</span>&nbsp;<span class="ident" id="7728164">t</span><span class="op" id="7728165">)</span><br>
<span class="lineno"></span><span class="op" id="7728167">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="keyword" id="7728170">func</span>&nbsp;<span class="ident" id="7728175">TestParseGlob</span><span class="op" id="7728188">(</span><span class="ident" id="7728189">t</span>&nbsp;<span class="op" id="7728191">*</span><span class="ident" id="7728192">testing</span><span class="op" id="7728199">.</span><span class="ident" id="7728200">T</span><span class="op" id="7728201">)</span>&nbsp;<span class="op" id="7728203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7728206">_</span><span class="op" id="7728207">,</span>&nbsp;<span class="ident" id="7728209">err</span>&nbsp;<span class="op" id="7728213">:=</span>&nbsp;<span class="ident" id="7728216">ParseGlob</span><span class="op" id="7728225">(</span><span class="string" id="7728226">&#34;DOES&nbsp;NOT&nbsp;EXIST&#34;</span><span class="op" id="7728242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7728245">if</span>&nbsp;<span class="ident" id="7728248">err</span>&nbsp;<span class="op" id="7728252">==</span>&nbsp;<span class="ident" id="7728255">nil</span>&nbsp;<span class="op" id="7728259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7728263">t</span><span class="op" id="7728264">.</span><span class="ident" id="7728265">Error</span><span class="op" id="7728270">(</span><span class="string" id="7728271">&#34;expected&nbsp;error&nbsp;for&nbsp;non-existent&nbsp;file;&nbsp;got&nbsp;none&#34;</span><span class="op" id="7728319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7728322">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7728325">_</span><span class="op" id="7728326">,</span>&nbsp;<span class="ident" id="7728328">err</span>&nbsp;<span class="op" id="7728332">=</span>&nbsp;<span class="ident" id="7728334">New</span><span class="op" id="7728337">(</span><span class="string" id="7728338">&#34;error&#34;</span><span class="op" id="7728345">)</span><span class="op" id="7728346">.</span><span class="ident" id="7728347">ParseGlob</span><span class="op" id="7728356">(</span><span class="string" id="7728357">&#34;[x&#34;</span><span class="op" id="7728361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7728364">if</span>&nbsp;<span class="ident" id="7728367">err</span>&nbsp;<span class="op" id="7728371">==</span>&nbsp;<span class="ident" id="7728374">nil</span>&nbsp;<span class="op" id="7728378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7728382">t</span><span class="op" id="7728383">.</span><span class="ident" id="7728384">Error</span><span class="op" id="7728389">(</span><span class="string" id="7728390">&#34;expected&nbsp;error&nbsp;for&nbsp;bad&nbsp;pattern;&nbsp;got&nbsp;none&#34;</span><span class="op" id="7728432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7728435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7728438">template</span>&nbsp;<span class="op" id="7728447">:=</span>&nbsp;<span class="ident" id="7728450">New</span><span class="op" id="7728453">(</span><span class="string" id="7728454">&#34;root&#34;</span><span class="op" id="7728460">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7728463">_</span><span class="op" id="7728464">,</span>&nbsp;<span class="ident" id="7728466">err</span>&nbsp;<span class="op" id="7728470">=</span>&nbsp;<span class="ident" id="7728472">template</span><span class="op" id="7728480">.</span><span class="ident" id="7728481">ParseGlob</span><span class="op" id="7728490">(</span><span class="string" id="7728491">&#34;testdata/file*.tmpl&#34;</span><span class="op" id="7728512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7728515">if</span>&nbsp;<span class="ident" id="7728518">err</span>&nbsp;<span class="op" id="7728522">!=</span>&nbsp;<span class="ident" id="7728525">nil</span>&nbsp;<span class="op" id="7728529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7728533">t</span><span class="op" id="7728534">.</span><span class="ident" id="7728535">Fatalf</span><span class="op" id="7728541">(</span><span class="string" id="7728542">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="7728567">,</span>&nbsp;<span class="ident" id="7728569">err</span><span class="op" id="7728572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7728575">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7728578">testExecute</span><span class="op" id="7728589">(</span><span class="ident" id="7728590">multiExecTests</span><span class="op" id="7728604">,</span>&nbsp;<span class="ident" id="7728606">template</span><span class="op" id="7728614">,</span>&nbsp;<span class="ident" id="7728616">t</span><span class="op" id="7728617">)</span><br>
<span class="lineno">155</span><span class="op" id="7728619">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7728622">//&nbsp;In&nbsp;these&nbsp;tests,&nbsp;actual&nbsp;content&nbsp;(not&nbsp;just&nbsp;template&nbsp;definitions)&nbsp;comes&nbsp;from&nbsp;the&nbsp;parsed&nbsp;files.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7728718">var</span>&nbsp;<span class="ident" id="7728722">templateFileExecTests</span>&nbsp;<span class="op" id="7728744">=</span>&nbsp;<span class="op" id="7728746">[</span><span class="op" id="7728747">]</span><span class="ident" id="7728748">execTest</span><span class="op" id="7728756">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7728759">{</span><span class="string" id="7728760">&#34;test&#34;</span><span class="op" id="7728766">,</span>&nbsp;<span class="string" id="7728768">`{{template&nbsp;&#34;tmpl1.tmpl&#34;}}{{template&nbsp;&#34;tmpl2.tmpl&#34;}}`</span><span class="op" id="7728820">,</span>&nbsp;<span class="string" id="7728822">&#34;template1\n\ny\ntemplate2\n\nx\n&#34;</span><span class="op" id="7728856">,</span>&nbsp;<span class="num" id="7728858">0</span><span class="op" id="7728859">,</span>&nbsp;<span class="builtintype" id="7728861">true</span><span class="op" id="7728865">}</span><span class="op" id="7728866">,</span><br>
<span class="lineno"></span><span class="op" id="7728868">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7728871">func</span>&nbsp;<span class="ident" id="7728876">TestParseFilesWithData</span><span class="op" id="7728898">(</span><span class="ident" id="7728899">t</span>&nbsp;<span class="op" id="7728901">*</span><span class="ident" id="7728902">testing</span><span class="op" id="7728909">.</span><span class="ident" id="7728910">T</span><span class="op" id="7728911">)</span>&nbsp;<span class="op" id="7728913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7728916">template</span><span class="op" id="7728924">,</span>&nbsp;<span class="ident" id="7728926">err</span>&nbsp;<span class="op" id="7728930">:=</span>&nbsp;<span class="ident" id="7728933">New</span><span class="op" id="7728936">(</span><span class="string" id="7728937">&#34;root&#34;</span><span class="op" id="7728943">)</span><span class="op" id="7728944">.</span><span class="ident" id="7728945">ParseFiles</span><span class="op" id="7728955">(</span><span class="string" id="7728956">&#34;testdata/tmpl1.tmpl&#34;</span><span class="op" id="7728977">,</span>&nbsp;<span class="string" id="7728979">&#34;testdata/tmpl2.tmpl&#34;</span><span class="op" id="7729000">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7729003">if</span>&nbsp;<span class="ident" id="7729006">err</span>&nbsp;<span class="op" id="7729010">!=</span>&nbsp;<span class="ident" id="7729013">nil</span>&nbsp;<span class="op" id="7729017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7729021">t</span><span class="op" id="7729022">.</span><span class="ident" id="7729023">Fatalf</span><span class="op" id="7729029">(</span><span class="string" id="7729030">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="7729055">,</span>&nbsp;<span class="ident" id="7729057">err</span><span class="op" id="7729060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7729063">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7729066">testExecute</span><span class="op" id="7729077">(</span><span class="ident" id="7729078">templateFileExecTests</span><span class="op" id="7729099">,</span>&nbsp;<span class="ident" id="7729101">template</span><span class="op" id="7729109">,</span>&nbsp;<span class="ident" id="7729111">t</span><span class="op" id="7729112">)</span><br>
<span class="lineno"></span><span class="op" id="7729114">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="7729117">func</span>&nbsp;<span class="ident" id="7729122">TestParseGlobWithData</span><span class="op" id="7729143">(</span><span class="ident" id="7729144">t</span>&nbsp;<span class="op" id="7729146">*</span><span class="ident" id="7729147">testing</span><span class="op" id="7729154">.</span><span class="ident" id="7729155">T</span><span class="op" id="7729156">)</span>&nbsp;<span class="op" id="7729158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7729161">template</span><span class="op" id="7729169">,</span>&nbsp;<span class="ident" id="7729171">err</span>&nbsp;<span class="op" id="7729175">:=</span>&nbsp;<span class="ident" id="7729178">New</span><span class="op" id="7729181">(</span><span class="string" id="7729182">&#34;root&#34;</span><span class="op" id="7729188">)</span><span class="op" id="7729189">.</span><span class="ident" id="7729190">ParseGlob</span><span class="op" id="7729199">(</span><span class="string" id="7729200">&#34;testdata/tmpl*.tmpl&#34;</span><span class="op" id="7729221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7729224">if</span>&nbsp;<span class="ident" id="7729227">err</span>&nbsp;<span class="op" id="7729231">!=</span>&nbsp;<span class="ident" id="7729234">nil</span>&nbsp;<span class="op" id="7729238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7729242">t</span><span class="op" id="7729243">.</span><span class="ident" id="7729244">Fatalf</span><span class="op" id="7729250">(</span><span class="string" id="7729251">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="7729276">,</span>&nbsp;<span class="ident" id="7729278">err</span><span class="op" id="7729281">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7729284">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7729287">testExecute</span><span class="op" id="7729298">(</span><span class="ident" id="7729299">templateFileExecTests</span><span class="op" id="7729320">,</span>&nbsp;<span class="ident" id="7729322">template</span><span class="op" id="7729330">,</span>&nbsp;<span class="ident" id="7729332">t</span><span class="op" id="7729333">)</span><br>
<span class="lineno"></span><span class="op" id="7729335">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7729338">const</span>&nbsp;<span class="op" id="7729344">(</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7729347">cloneText1</span>&nbsp;<span class="op" id="7729358">=</span>&nbsp;<span class="string" id="7729360">`{{define&nbsp;&#34;a&#34;}}{{template&nbsp;&#34;b&#34;}}{{template&nbsp;&#34;c&#34;}}{{end}}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7729417">cloneText2</span>&nbsp;<span class="op" id="7729428">=</span>&nbsp;<span class="string" id="7729430">`{{define&nbsp;&#34;b&#34;}}b{{end}}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7729456">cloneText3</span>&nbsp;<span class="op" id="7729467">=</span>&nbsp;<span class="string" id="7729469">`{{define&nbsp;&#34;c&#34;}}root{{end}}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7729498">cloneText4</span>&nbsp;<span class="op" id="7729509">=</span>&nbsp;<span class="string" id="7729511">`{{define&nbsp;&#34;c&#34;}}clone{{end}}`</span><br>
<span class="lineno"></span><span class="op" id="7729540">)</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="7729543">func</span>&nbsp;<span class="ident" id="7729548">TestClone</span><span class="op" id="7729557">(</span><span class="ident" id="7729558">t</span>&nbsp;<span class="op" id="7729560">*</span><span class="ident" id="7729561">testing</span><span class="op" id="7729568">.</span><span class="ident" id="7729569">T</span><span class="op" id="7729570">)</span>&nbsp;<span class="op" id="7729572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7729575">//&nbsp;Create&nbsp;some&nbsp;templates&nbsp;and&nbsp;clone&nbsp;the&nbsp;root.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7729621">root</span><span class="op" id="7729625">,</span>&nbsp;<span class="ident" id="7729627">err</span>&nbsp;<span class="op" id="7729631">:=</span>&nbsp;<span class="ident" id="7729634">New</span><span class="op" id="7729637">(</span><span class="string" id="7729638">&#34;root&#34;</span><span class="op" id="7729644">)</span><span class="op" id="7729645">.</span><span class="ident" id="7729646">Parse</span><span class="op" id="7729651">(</span><span class="ident" id="7729652">cloneText1</span><span class="op" id="7729662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7729665">if</span>&nbsp;<span class="ident" id="7729668">err</span>&nbsp;<span class="op" id="7729672">!=</span>&nbsp;<span class="ident" id="7729675">nil</span>&nbsp;<span class="op" id="7729679">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7729683">t</span><span class="op" id="7729684">.</span><span class="ident" id="7729685">Fatal</span><span class="op" id="7729690">(</span><span class="ident" id="7729691">err</span><span class="op" id="7729694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7729697">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7729700">_</span><span class="op" id="7729701">,</span>&nbsp;<span class="ident" id="7729703">err</span>&nbsp;<span class="op" id="7729707">=</span>&nbsp;<span class="ident" id="7729709">root</span><span class="op" id="7729713">.</span><span class="ident" id="7729714">Parse</span><span class="op" id="7729719">(</span><span class="ident" id="7729720">cloneText2</span><span class="op" id="7729730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7729733">if</span>&nbsp;<span class="ident" id="7729736">err</span>&nbsp;<span class="op" id="7729740">!=</span>&nbsp;<span class="ident" id="7729743">nil</span>&nbsp;<span class="op" id="7729747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7729751">t</span><span class="op" id="7729752">.</span><span class="ident" id="7729753">Fatal</span><span class="op" id="7729758">(</span><span class="ident" id="7729759">err</span><span class="op" id="7729762">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7729765">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7729768">clone</span>&nbsp;<span class="op" id="7729774">:=</span>&nbsp;<span class="ident" id="7729777">Must</span><span class="op" id="7729781">(</span><span class="ident" id="7729782">root</span><span class="op" id="7729786">.</span><span class="ident" id="7729787">Clone</span><span class="op" id="7729792">(</span><span class="op" id="7729793">)</span><span class="op" id="7729794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7729797">//&nbsp;Add&nbsp;variants&nbsp;to&nbsp;both.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7729823">_</span><span class="op" id="7729824">,</span>&nbsp;<span class="ident" id="7729826">err</span>&nbsp;<span class="op" id="7729830">=</span>&nbsp;<span class="ident" id="7729832">root</span><span class="op" id="7729836">.</span><span class="ident" id="7729837">Parse</span><span class="op" id="7729842">(</span><span class="ident" id="7729843">cloneText3</span><span class="op" id="7729853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7729856">if</span>&nbsp;<span class="ident" id="7729859">err</span>&nbsp;<span class="op" id="7729863">!=</span>&nbsp;<span class="ident" id="7729866">nil</span>&nbsp;<span class="op" id="7729870">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7729874">t</span><span class="op" id="7729875">.</span><span class="ident" id="7729876">Fatal</span><span class="op" id="7729881">(</span><span class="ident" id="7729882">err</span><span class="op" id="7729885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7729888">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7729891">_</span><span class="op" id="7729892">,</span>&nbsp;<span class="ident" id="7729894">err</span>&nbsp;<span class="op" id="7729898">=</span>&nbsp;<span class="ident" id="7729900">clone</span><span class="op" id="7729905">.</span><span class="ident" id="7729906">Parse</span><span class="op" id="7729911">(</span><span class="ident" id="7729912">cloneText4</span><span class="op" id="7729922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7729925">if</span>&nbsp;<span class="ident" id="7729928">err</span>&nbsp;<span class="op" id="7729932">!=</span>&nbsp;<span class="ident" id="7729935">nil</span>&nbsp;<span class="op" id="7729939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7729943">t</span><span class="op" id="7729944">.</span><span class="ident" id="7729945">Fatal</span><span class="op" id="7729950">(</span><span class="ident" id="7729951">err</span><span class="op" id="7729954">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7729957">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7729960">//&nbsp;Verify&nbsp;that&nbsp;the&nbsp;clone&nbsp;is&nbsp;self-consistent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7730006">for</span>&nbsp;<span class="ident" id="7730010">k</span><span class="op" id="7730011">,</span>&nbsp;<span class="ident" id="7730013">v</span>&nbsp;<span class="op" id="7730015">:=</span>&nbsp;<span class="keyword" id="7730018">range</span>&nbsp;<span class="ident" id="7730024">clone</span><span class="op" id="7730029">.</span><span class="ident" id="7730030">tmpl</span>&nbsp;<span class="op" id="7730035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7730039">if</span>&nbsp;<span class="ident" id="7730042">k</span>&nbsp;<span class="op" id="7730044">==</span>&nbsp;<span class="ident" id="7730047">clone</span><span class="op" id="7730052">.</span><span class="ident" id="7730053">name</span>&nbsp;<span class="op" id="7730058">&amp;&amp;</span>&nbsp;<span class="ident" id="7730061">v</span><span class="op" id="7730062">.</span><span class="ident" id="7730063">tmpl</span><span class="op" id="7730067">[</span><span class="ident" id="7730068">k</span><span class="op" id="7730069">]</span>&nbsp;<span class="op" id="7730071">!=</span>&nbsp;<span class="ident" id="7730074">clone</span>&nbsp;<span class="op" id="7730080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7730085">t</span><span class="op" id="7730086">.</span><span class="ident" id="7730087">Error</span><span class="op" id="7730092">(</span><span class="string" id="7730093">&#34;clone&nbsp;does&nbsp;not&nbsp;contain&nbsp;root&#34;</span><span class="op" id="7730122">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7730126">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7730130">if</span>&nbsp;<span class="ident" id="7730133">v</span>&nbsp;<span class="op" id="7730135">!=</span>&nbsp;<span class="ident" id="7730138">v</span><span class="op" id="7730139">.</span><span class="ident" id="7730140">tmpl</span><span class="op" id="7730144">[</span><span class="ident" id="7730145">v</span><span class="op" id="7730146">.</span><span class="ident" id="7730147">name</span><span class="op" id="7730151">]</span>&nbsp;<span class="op" id="7730153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7730158">t</span><span class="op" id="7730159">.</span><span class="ident" id="7730160">Errorf</span><span class="op" id="7730166">(</span><span class="string" id="7730167">&#34;clone&nbsp;does&nbsp;not&nbsp;contain&nbsp;self&nbsp;for&nbsp;%q&#34;</span><span class="op" id="7730203">,</span>&nbsp;<span class="ident" id="7730205">k</span><span class="op" id="7730206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7730210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7730213">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7730216">//&nbsp;Execute&nbsp;root.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7730234">var</span>&nbsp;<span class="ident" id="7730238">b</span>&nbsp;<span class="ident" id="7730240">bytes</span><span class="op" id="7730245">.</span><span class="ident" id="7730246">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7730254">err</span>&nbsp;<span class="op" id="7730258">=</span>&nbsp;<span class="ident" id="7730260">root</span><span class="op" id="7730264">.</span><span class="ident" id="7730265">ExecuteTemplate</span><span class="op" id="7730280">(</span><span class="op" id="7730281">&amp;</span><span class="ident" id="7730282">b</span><span class="op" id="7730283">,</span>&nbsp;<span class="string" id="7730285">&#34;a&#34;</span><span class="op" id="7730288">,</span>&nbsp;<span class="num" id="7730290">0</span><span class="op" id="7730291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7730294">if</span>&nbsp;<span class="ident" id="7730297">err</span>&nbsp;<span class="op" id="7730301">!=</span>&nbsp;<span class="ident" id="7730304">nil</span>&nbsp;<span class="op" id="7730308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7730312">t</span><span class="op" id="7730313">.</span><span class="ident" id="7730314">Fatal</span><span class="op" id="7730319">(</span><span class="ident" id="7730320">err</span><span class="op" id="7730323">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7730326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7730329">if</span>&nbsp;<span class="ident" id="7730332">b</span><span class="op" id="7730333">.</span><span class="ident" id="7730334">String</span><span class="op" id="7730340">(</span><span class="op" id="7730341">)</span>&nbsp;<span class="op" id="7730343">!=</span>&nbsp;<span class="string" id="7730346">&#34;broot&#34;</span>&nbsp;<span class="op" id="7730354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7730358">t</span><span class="op" id="7730359">.</span><span class="ident" id="7730360">Errorf</span><span class="op" id="7730366">(</span><span class="string" id="7730367">&#34;expected&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7730387">,</span>&nbsp;<span class="string" id="7730389">&#34;broot&#34;</span><span class="op" id="7730396">,</span>&nbsp;<span class="ident" id="7730398">b</span><span class="op" id="7730399">.</span><span class="ident" id="7730400">String</span><span class="op" id="7730406">(</span><span class="op" id="7730407">)</span><span class="op" id="7730408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7730411">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7730414">//&nbsp;Execute&nbsp;copy.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7730432">b</span><span class="op" id="7730433">.</span><span class="ident" id="7730434">Reset</span><span class="op" id="7730439">(</span><span class="op" id="7730440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7730443">err</span>&nbsp;<span class="op" id="7730447">=</span>&nbsp;<span class="ident" id="7730449">clone</span><span class="op" id="7730454">.</span><span class="ident" id="7730455">ExecuteTemplate</span><span class="op" id="7730470">(</span><span class="op" id="7730471">&amp;</span><span class="ident" id="7730472">b</span><span class="op" id="7730473">,</span>&nbsp;<span class="string" id="7730475">&#34;a&#34;</span><span class="op" id="7730478">,</span>&nbsp;<span class="num" id="7730480">0</span><span class="op" id="7730481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7730484">if</span>&nbsp;<span class="ident" id="7730487">err</span>&nbsp;<span class="op" id="7730491">!=</span>&nbsp;<span class="ident" id="7730494">nil</span>&nbsp;<span class="op" id="7730498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7730502">t</span><span class="op" id="7730503">.</span><span class="ident" id="7730504">Fatal</span><span class="op" id="7730509">(</span><span class="ident" id="7730510">err</span><span class="op" id="7730513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7730516">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7730519">if</span>&nbsp;<span class="ident" id="7730522">b</span><span class="op" id="7730523">.</span><span class="ident" id="7730524">String</span><span class="op" id="7730530">(</span><span class="op" id="7730531">)</span>&nbsp;<span class="op" id="7730533">!=</span>&nbsp;<span class="string" id="7730536">&#34;bclone&#34;</span>&nbsp;<span class="op" id="7730545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7730549">t</span><span class="op" id="7730550">.</span><span class="ident" id="7730551">Errorf</span><span class="op" id="7730557">(</span><span class="string" id="7730558">&#34;expected&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7730578">,</span>&nbsp;<span class="string" id="7730580">&#34;bclone&#34;</span><span class="op" id="7730588">,</span>&nbsp;<span class="ident" id="7730590">b</span><span class="op" id="7730591">.</span><span class="ident" id="7730592">String</span><span class="op" id="7730598">(</span><span class="op" id="7730599">)</span><span class="op" id="7730600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7730603">}</span><br>
<span class="lineno"></span><span class="op" id="7730605">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="7730608">func</span>&nbsp;<span class="ident" id="7730613">TestAddParseTree</span><span class="op" id="7730629">(</span><span class="ident" id="7730630">t</span>&nbsp;<span class="op" id="7730632">*</span><span class="ident" id="7730633">testing</span><span class="op" id="7730640">.</span><span class="ident" id="7730641">T</span><span class="op" id="7730642">)</span>&nbsp;<span class="op" id="7730644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7730647">//&nbsp;Create&nbsp;some&nbsp;templates.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7730674">root</span><span class="op" id="7730678">,</span>&nbsp;<span class="ident" id="7730680">err</span>&nbsp;<span class="op" id="7730684">:=</span>&nbsp;<span class="ident" id="7730687">New</span><span class="op" id="7730690">(</span><span class="string" id="7730691">&#34;root&#34;</span><span class="op" id="7730697">)</span><span class="op" id="7730698">.</span><span class="ident" id="7730699">Parse</span><span class="op" id="7730704">(</span><span class="ident" id="7730705">cloneText1</span><span class="op" id="7730715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7730718">if</span>&nbsp;<span class="ident" id="7730721">err</span>&nbsp;<span class="op" id="7730725">!=</span>&nbsp;<span class="ident" id="7730728">nil</span>&nbsp;<span class="op" id="7730732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7730736">t</span><span class="op" id="7730737">.</span><span class="ident" id="7730738">Fatal</span><span class="op" id="7730743">(</span><span class="ident" id="7730744">err</span><span class="op" id="7730747">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7730750">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7730753">_</span><span class="op" id="7730754">,</span>&nbsp;<span class="ident" id="7730756">err</span>&nbsp;<span class="op" id="7730760">=</span>&nbsp;<span class="ident" id="7730762">root</span><span class="op" id="7730766">.</span><span class="ident" id="7730767">Parse</span><span class="op" id="7730772">(</span><span class="ident" id="7730773">cloneText2</span><span class="op" id="7730783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7730786">if</span>&nbsp;<span class="ident" id="7730789">err</span>&nbsp;<span class="op" id="7730793">!=</span>&nbsp;<span class="ident" id="7730796">nil</span>&nbsp;<span class="op" id="7730800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7730804">t</span><span class="op" id="7730805">.</span><span class="ident" id="7730806">Fatal</span><span class="op" id="7730811">(</span><span class="ident" id="7730812">err</span><span class="op" id="7730815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7730818">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7730821">//&nbsp;Add&nbsp;a&nbsp;new&nbsp;parse&nbsp;tree.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7730847">tree</span><span class="op" id="7730851">,</span>&nbsp;<span class="ident" id="7730853">err</span>&nbsp;<span class="op" id="7730857">:=</span>&nbsp;<span class="ident" id="7730860">parse</span><span class="op" id="7730865">.</span><span class="ident" id="7730866">Parse</span><span class="op" id="7730871">(</span><span class="string" id="7730872">&#34;cloneText3&#34;</span><span class="op" id="7730884">,</span>&nbsp;<span class="ident" id="7730886">cloneText3</span><span class="op" id="7730896">,</span>&nbsp;<span class="string" id="7730898">&#34;&#34;</span><span class="op" id="7730900">,</span>&nbsp;<span class="string" id="7730902">&#34;&#34;</span><span class="op" id="7730904">,</span>&nbsp;<span class="ident" id="7730906">nil</span><span class="op" id="7730909">,</span>&nbsp;<span class="ident" id="7730911">builtins</span><span class="op" id="7730919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7730922">if</span>&nbsp;<span class="ident" id="7730925">err</span>&nbsp;<span class="op" id="7730929">!=</span>&nbsp;<span class="ident" id="7730932">nil</span>&nbsp;<span class="op" id="7730936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7730940">t</span><span class="op" id="7730941">.</span><span class="ident" id="7730942">Fatal</span><span class="op" id="7730947">(</span><span class="ident" id="7730948">err</span><span class="op" id="7730951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7730954">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7730957">added</span><span class="op" id="7730962">,</span>&nbsp;<span class="ident" id="7730964">err</span>&nbsp;<span class="op" id="7730968">:=</span>&nbsp;<span class="ident" id="7730971">root</span><span class="op" id="7730975">.</span><span class="ident" id="7730976">AddParseTree</span><span class="op" id="7730988">(</span><span class="string" id="7730989">&#34;c&#34;</span><span class="op" id="7730992">,</span>&nbsp;<span class="ident" id="7730994">tree</span><span class="op" id="7730998">[</span><span class="string" id="7730999">&#34;c&#34;</span><span class="op" id="7731002">]</span><span class="op" id="7731003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7731006">//&nbsp;Execute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7731019">var</span>&nbsp;<span class="ident" id="7731023">b</span>&nbsp;<span class="ident" id="7731025">bytes</span><span class="op" id="7731030">.</span><span class="ident" id="7731031">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7731039">err</span>&nbsp;<span class="op" id="7731043">=</span>&nbsp;<span class="ident" id="7731045">added</span><span class="op" id="7731050">.</span><span class="ident" id="7731051">ExecuteTemplate</span><span class="op" id="7731066">(</span><span class="op" id="7731067">&amp;</span><span class="ident" id="7731068">b</span><span class="op" id="7731069">,</span>&nbsp;<span class="string" id="7731071">&#34;a&#34;</span><span class="op" id="7731074">,</span>&nbsp;<span class="num" id="7731076">0</span><span class="op" id="7731077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7731080">if</span>&nbsp;<span class="ident" id="7731083">err</span>&nbsp;<span class="op" id="7731087">!=</span>&nbsp;<span class="ident" id="7731090">nil</span>&nbsp;<span class="op" id="7731094">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7731098">t</span><span class="op" id="7731099">.</span><span class="ident" id="7731100">Fatal</span><span class="op" id="7731105">(</span><span class="ident" id="7731106">err</span><span class="op" id="7731109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7731112">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7731115">if</span>&nbsp;<span class="ident" id="7731118">b</span><span class="op" id="7731119">.</span><span class="ident" id="7731120">String</span><span class="op" id="7731126">(</span><span class="op" id="7731127">)</span>&nbsp;<span class="op" id="7731129">!=</span>&nbsp;<span class="string" id="7731132">&#34;broot&#34;</span>&nbsp;<span class="op" id="7731140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7731144">t</span><span class="op" id="7731145">.</span><span class="ident" id="7731146">Errorf</span><span class="op" id="7731152">(</span><span class="string" id="7731153">&#34;expected&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7731173">,</span>&nbsp;<span class="string" id="7731175">&#34;broot&#34;</span><span class="op" id="7731182">,</span>&nbsp;<span class="ident" id="7731184">b</span><span class="op" id="7731185">.</span><span class="ident" id="7731186">String</span><span class="op" id="7731192">(</span><span class="op" id="7731193">)</span><span class="op" id="7731194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7731197">}</span><br>
<span class="lineno">260</span><span class="op" id="7731199">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7731202">//&nbsp;Issue&nbsp;7032</span><br>
<span class="lineno"></span><span class="keyword" id="7731216">func</span>&nbsp;<span class="ident" id="7731221">TestAddParseTreeToUnparsedTemplate</span><span class="op" id="7731255">(</span><span class="ident" id="7731256">t</span>&nbsp;<span class="op" id="7731258">*</span><span class="ident" id="7731259">testing</span><span class="op" id="7731266">.</span><span class="ident" id="7731267">T</span><span class="op" id="7731268">)</span>&nbsp;<span class="op" id="7731270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7731273">master</span>&nbsp;<span class="op" id="7731280">:=</span>&nbsp;<span class="string" id="7731283">&#34;{{define&nbsp;\&#34;master\&#34;}}{{end}}&#34;</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7731315">tmpl</span>&nbsp;<span class="op" id="7731320">:=</span>&nbsp;<span class="ident" id="7731323">New</span><span class="op" id="7731326">(</span><span class="string" id="7731327">&#34;master&#34;</span><span class="op" id="7731335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7731338">tree</span><span class="op" id="7731342">,</span>&nbsp;<span class="ident" id="7731344">err</span>&nbsp;<span class="op" id="7731348">:=</span>&nbsp;<span class="ident" id="7731351">parse</span><span class="op" id="7731356">.</span><span class="ident" id="7731357">Parse</span><span class="op" id="7731362">(</span><span class="string" id="7731363">&#34;master&#34;</span><span class="op" id="7731371">,</span>&nbsp;<span class="ident" id="7731373">master</span><span class="op" id="7731379">,</span>&nbsp;<span class="string" id="7731381">&#34;&#34;</span><span class="op" id="7731383">,</span>&nbsp;<span class="string" id="7731385">&#34;&#34;</span><span class="op" id="7731387">,</span>&nbsp;<span class="ident" id="7731389">nil</span><span class="op" id="7731392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7731395">if</span>&nbsp;<span class="ident" id="7731398">err</span>&nbsp;<span class="op" id="7731402">!=</span>&nbsp;<span class="ident" id="7731405">nil</span>&nbsp;<span class="op" id="7731409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7731413">t</span><span class="op" id="7731414">.</span><span class="ident" id="7731415">Fatalf</span><span class="op" id="7731421">(</span><span class="string" id="7731422">&#34;unexpected&nbsp;parse&nbsp;err:&nbsp;%v&#34;</span><span class="op" id="7731448">,</span>&nbsp;<span class="ident" id="7731450">err</span><span class="op" id="7731453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7731456">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7731459">masterTree</span>&nbsp;<span class="op" id="7731470">:=</span>&nbsp;<span class="ident" id="7731473">tree</span><span class="op" id="7731477">[</span><span class="string" id="7731478">&#34;master&#34;</span><span class="op" id="7731486">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7731489">tmpl</span><span class="op" id="7731493">.</span><span class="ident" id="7731494">AddParseTree</span><span class="op" id="7731506">(</span><span class="string" id="7731507">&#34;master&#34;</span><span class="op" id="7731515">,</span>&nbsp;<span class="ident" id="7731517">masterTree</span><span class="op" id="7731527">)</span>&nbsp;<span class="comment" id="7731529">//&nbsp;used&nbsp;to&nbsp;panic</span><br>
<span class="lineno"></span><span class="op" id="7731546">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7731549">func</span>&nbsp;<span class="ident" id="7731554">TestRedefinition</span><span class="op" id="7731570">(</span><span class="ident" id="7731571">t</span>&nbsp;<span class="op" id="7731573">*</span><span class="ident" id="7731574">testing</span><span class="op" id="7731581">.</span><span class="ident" id="7731582">T</span><span class="op" id="7731583">)</span>&nbsp;<span class="op" id="7731585">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7731588">var</span>&nbsp;<span class="ident" id="7731592">tmpl</span>&nbsp;<span class="op" id="7731597">*</span><span class="ident" id="7731598">Template</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7731608">var</span>&nbsp;<span class="ident" id="7731612">err</span>&nbsp;<span class="builtintype" id="7731616">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7731623">if</span>&nbsp;<span class="ident" id="7731626">tmpl</span><span class="op" id="7731630">,</span>&nbsp;<span class="ident" id="7731632">err</span>&nbsp;<span class="op" id="7731636">=</span>&nbsp;<span class="ident" id="7731638">New</span><span class="op" id="7731641">(</span><span class="string" id="7731642">&#34;tmpl1&#34;</span><span class="op" id="7731649">)</span><span class="op" id="7731650">.</span><span class="ident" id="7731651">Parse</span><span class="op" id="7731656">(</span><span class="string" id="7731657">`{{define&nbsp;&#34;test&#34;}}foo{{end}}`</span><span class="op" id="7731686">)</span><span class="op" id="7731687">;</span>&nbsp;<span class="ident" id="7731689">err</span>&nbsp;<span class="op" id="7731693">!=</span>&nbsp;<span class="ident" id="7731696">nil</span>&nbsp;<span class="op" id="7731700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7731704">t</span><span class="op" id="7731705">.</span><span class="ident" id="7731706">Fatalf</span><span class="op" id="7731712">(</span><span class="string" id="7731713">&#34;parse&nbsp;1:&nbsp;%v&#34;</span><span class="op" id="7731726">,</span>&nbsp;<span class="ident" id="7731728">err</span><span class="op" id="7731731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7731734">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7731737">if</span>&nbsp;<span class="ident" id="7731740">_</span><span class="op" id="7731741">,</span>&nbsp;<span class="ident" id="7731743">err</span>&nbsp;<span class="op" id="7731747">=</span>&nbsp;<span class="ident" id="7731749">tmpl</span><span class="op" id="7731753">.</span><span class="ident" id="7731754">Parse</span><span class="op" id="7731759">(</span><span class="string" id="7731760">`{{define&nbsp;&#34;test&#34;}}bar{{end}}`</span><span class="op" id="7731789">)</span><span class="op" id="7731790">;</span>&nbsp;<span class="ident" id="7731792">err</span>&nbsp;<span class="op" id="7731796">==</span>&nbsp;<span class="ident" id="7731799">nil</span>&nbsp;<span class="op" id="7731803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7731807">t</span><span class="op" id="7731808">.</span><span class="ident" id="7731809">Fatal</span><span class="op" id="7731814">(</span><span class="string" id="7731815">&#34;expected&nbsp;error&#34;</span><span class="op" id="7731831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7731834">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7731837">if</span>&nbsp;<span class="op" id="7731840">!</span><span class="ident" id="7731841">strings</span><span class="op" id="7731848">.</span><span class="ident" id="7731849">Contains</span><span class="op" id="7731857">(</span><span class="ident" id="7731858">err</span><span class="op" id="7731861">.</span><span class="ident" id="7731862">Error</span><span class="op" id="7731867">(</span><span class="op" id="7731868">)</span><span class="op" id="7731869">,</span>&nbsp;<span class="string" id="7731871">&#34;redefinition&#34;</span><span class="op" id="7731885">)</span>&nbsp;<span class="op" id="7731887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7731891">t</span><span class="op" id="7731892">.</span><span class="ident" id="7731893">Fatalf</span><span class="op" id="7731899">(</span><span class="string" id="7731900">&#34;expected&nbsp;redefinition&nbsp;error;&nbsp;got&nbsp;%v&#34;</span><span class="op" id="7731937">,</span>&nbsp;<span class="ident" id="7731939">err</span><span class="op" id="7731942">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7731945">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7731948">if</span>&nbsp;<span class="ident" id="7731951">_</span><span class="op" id="7731952">,</span>&nbsp;<span class="ident" id="7731954">err</span>&nbsp;<span class="op" id="7731958">=</span>&nbsp;<span class="ident" id="7731960">tmpl</span><span class="op" id="7731964">.</span><span class="ident" id="7731965">New</span><span class="op" id="7731968">(</span><span class="string" id="7731969">&#34;tmpl2&#34;</span><span class="op" id="7731976">)</span><span class="op" id="7731977">.</span><span class="ident" id="7731978">Parse</span><span class="op" id="7731983">(</span><span class="string" id="7731984">`{{define&nbsp;&#34;test&#34;}}bar{{end}}`</span><span class="op" id="7732013">)</span><span class="op" id="7732014">;</span>&nbsp;<span class="ident" id="7732016">err</span>&nbsp;<span class="op" id="7732020">==</span>&nbsp;<span class="ident" id="7732023">nil</span>&nbsp;<span class="op" id="7732027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7732031">t</span><span class="op" id="7732032">.</span><span class="ident" id="7732033">Fatal</span><span class="op" id="7732038">(</span><span class="string" id="7732039">&#34;expected&nbsp;error&#34;</span><span class="op" id="7732055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7732058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7732061">if</span>&nbsp;<span class="op" id="7732064">!</span><span class="ident" id="7732065">strings</span><span class="op" id="7732072">.</span><span class="ident" id="7732073">Contains</span><span class="op" id="7732081">(</span><span class="ident" id="7732082">err</span><span class="op" id="7732085">.</span><span class="ident" id="7732086">Error</span><span class="op" id="7732091">(</span><span class="op" id="7732092">)</span><span class="op" id="7732093">,</span>&nbsp;<span class="string" id="7732095">&#34;redefinition&#34;</span><span class="op" id="7732109">)</span>&nbsp;<span class="op" id="7732111">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7732115">t</span><span class="op" id="7732116">.</span><span class="ident" id="7732117">Fatalf</span><span class="op" id="7732123">(</span><span class="string" id="7732124">&#34;expected&nbsp;redefinition&nbsp;error;&nbsp;got&nbsp;%v&#34;</span><span class="op" id="7732161">,</span>&nbsp;<span class="ident" id="7732163">err</span><span class="op" id="7732166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7732169">}</span><br>
<span class="lineno"></span><span class="op" id="7732171">}</span>
</div>
</body>
</html>
