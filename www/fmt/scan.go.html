<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1929991">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1930046">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1930100">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1930151">package</span>&nbsp;<span class="ident" id="1930159">fmt</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1930164">import</span>&nbsp;<span class="op" id="1930171">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1930174">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1930184">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1930190">&#34;math&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1930198">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1930204">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1930215">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1930226">&#34;sync&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1930234">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="1930249">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1930252">//&nbsp;runeUnreader&nbsp;is&nbsp;the&nbsp;interface&nbsp;to&nbsp;something&nbsp;that&nbsp;can&nbsp;unread&nbsp;runes.</span><br>
<span class="lineno"></span><span class="comment" id="1930321">//&nbsp;If&nbsp;the&nbsp;object&nbsp;provided&nbsp;to&nbsp;Scan&nbsp;does&nbsp;not&nbsp;satisfy&nbsp;this&nbsp;interface,</span><br>
<span class="lineno">20</span><span class="comment" id="1930388">//&nbsp;a&nbsp;local&nbsp;buffer&nbsp;will&nbsp;be&nbsp;used&nbsp;to&nbsp;back&nbsp;up&nbsp;the&nbsp;input,&nbsp;but&nbsp;its&nbsp;contents</span><br>
<span class="lineno"></span><span class="comment" id="1930458">//&nbsp;will&nbsp;be&nbsp;lost&nbsp;when&nbsp;Scan&nbsp;returns.</span><br>
<span class="lineno"></span><span class="keyword" id="1930493">type</span>&nbsp;<span class="ident" id="1930498">runeUnreader</span>&nbsp;<span class="keyword" id="1930511">interface</span>&nbsp;<span class="op" id="1930521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1930524">UnreadRune</span><span class="op" id="1930534">(</span><span class="op" id="1930535">)</span>&nbsp;<span class="builtintype" id="1930537">error</span><br>
<span class="lineno"></span><span class="op" id="1930543">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="1930546">//&nbsp;ScanState&nbsp;represents&nbsp;the&nbsp;scanner&nbsp;state&nbsp;passed&nbsp;to&nbsp;custom&nbsp;scanners.</span><br>
<span class="lineno"></span><span class="comment" id="1930615">//&nbsp;Scanners&nbsp;may&nbsp;do&nbsp;rune-at-a-time&nbsp;scanning&nbsp;or&nbsp;ask&nbsp;the&nbsp;ScanState</span><br>
<span class="lineno"></span><span class="comment" id="1930679">//&nbsp;to&nbsp;discover&nbsp;the&nbsp;next&nbsp;space-delimited&nbsp;token.</span><br>
<span class="lineno"></span><span class="keyword" id="1930726">type</span>&nbsp;<span class="ident" id="1930731">ScanState</span>&nbsp;<span class="keyword" id="1930741">interface</span>&nbsp;<span class="op" id="1930751">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1930754">//&nbsp;ReadRune&nbsp;reads&nbsp;the&nbsp;next&nbsp;rune&nbsp;(Unicode&nbsp;code&nbsp;point)&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1930824">//&nbsp;If&nbsp;invoked&nbsp;during&nbsp;Scanln,&nbsp;Fscanln,&nbsp;or&nbsp;Sscanln,&nbsp;ReadRune()&nbsp;will</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1930891">//&nbsp;return&nbsp;EOF&nbsp;after&nbsp;returning&nbsp;the&nbsp;first&nbsp;&#39;\n&#39;&nbsp;or&nbsp;when&nbsp;reading&nbsp;beyond</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1930960">//&nbsp;the&nbsp;specified&nbsp;width.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1930985">ReadRune</span><span class="op" id="1930993">(</span><span class="op" id="1930994">)</span>&nbsp;<span class="op" id="1930996">(</span><span class="ident" id="1930997">r</span>&nbsp;<span class="builtintype" id="1930999">rune</span><span class="op" id="1931003">,</span>&nbsp;<span class="ident" id="1931005">size</span>&nbsp;<span class="builtintype" id="1931010">int</span><span class="op" id="1931013">,</span>&nbsp;<span class="ident" id="1931015">err</span>&nbsp;<span class="builtintype" id="1931019">error</span><span class="op" id="1931024">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1931027">//&nbsp;UnreadRune&nbsp;causes&nbsp;the&nbsp;next&nbsp;call&nbsp;to&nbsp;ReadRune&nbsp;to&nbsp;return&nbsp;the&nbsp;same&nbsp;rune.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931100">UnreadRune</span><span class="op" id="1931110">(</span><span class="op" id="1931111">)</span>&nbsp;<span class="builtintype" id="1931113">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1931120">//&nbsp;SkipSpace&nbsp;skips&nbsp;space&nbsp;in&nbsp;the&nbsp;input.&nbsp;Newlines&nbsp;are&nbsp;treated&nbsp;as&nbsp;space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1931190">//&nbsp;unless&nbsp;the&nbsp;scan&nbsp;operation&nbsp;is&nbsp;Scanln,&nbsp;Fscanln&nbsp;or&nbsp;Sscanln,&nbsp;in&nbsp;which&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1931265">//&nbsp;a&nbsp;newline&nbsp;is&nbsp;treated&nbsp;as&nbsp;EOF.</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931298">SkipSpace</span><span class="op" id="1931307">(</span><span class="op" id="1931308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1931311">//&nbsp;Token&nbsp;skips&nbsp;space&nbsp;in&nbsp;the&nbsp;input&nbsp;if&nbsp;skipSpace&nbsp;is&nbsp;true,&nbsp;then&nbsp;returns&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1931385">//&nbsp;run&nbsp;of&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;c&nbsp;satisfying&nbsp;f(c).&nbsp;&nbsp;If&nbsp;f&nbsp;is&nbsp;nil,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1931449">//&nbsp;!unicode.IsSpace(c)&nbsp;is&nbsp;used;&nbsp;that&nbsp;is,&nbsp;the&nbsp;token&nbsp;will&nbsp;hold&nbsp;non-space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1931521">//&nbsp;characters.&nbsp;&nbsp;Newlines&nbsp;are&nbsp;treated&nbsp;as&nbsp;space&nbsp;unless&nbsp;the&nbsp;scan&nbsp;operation</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1931594">//&nbsp;is&nbsp;Scanln,&nbsp;Fscanln&nbsp;or&nbsp;Sscanln,&nbsp;in&nbsp;which&nbsp;case&nbsp;a&nbsp;newline&nbsp;is&nbsp;treated&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1931667">//&nbsp;EOF.&nbsp;&nbsp;The&nbsp;returned&nbsp;slice&nbsp;points&nbsp;to&nbsp;shared&nbsp;data&nbsp;that&nbsp;may&nbsp;be&nbsp;overwritten</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1931742">//&nbsp;by&nbsp;the&nbsp;next&nbsp;call&nbsp;to&nbsp;Token,&nbsp;a&nbsp;call&nbsp;to&nbsp;a&nbsp;Scan&nbsp;function&nbsp;using&nbsp;the&nbsp;ScanState</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1931819">//&nbsp;as&nbsp;input,&nbsp;or&nbsp;when&nbsp;the&nbsp;calling&nbsp;Scan&nbsp;method&nbsp;returns.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931874">Token</span><span class="op" id="1931879">(</span><span class="ident" id="1931880">skipSpace</span>&nbsp;<span class="builtintype" id="1931890">bool</span><span class="op" id="1931894">,</span>&nbsp;<span class="ident" id="1931896">f</span>&nbsp;<span class="keyword" id="1931898">func</span><span class="op" id="1931902">(</span><span class="builtintype" id="1931903">rune</span><span class="op" id="1931907">)</span>&nbsp;<span class="builtintype" id="1931909">bool</span><span class="op" id="1931913">)</span>&nbsp;<span class="op" id="1931915">(</span><span class="ident" id="1931916">token</span>&nbsp;<span class="op" id="1931922">[</span><span class="op" id="1931923">]</span><span class="builtintype" id="1931924">byte</span><span class="op" id="1931928">,</span>&nbsp;<span class="ident" id="1931930">err</span>&nbsp;<span class="builtintype" id="1931934">error</span><span class="op" id="1931939">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1931942">//&nbsp;Width&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;width&nbsp;option&nbsp;and&nbsp;whether&nbsp;it&nbsp;has&nbsp;been&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1932019">//&nbsp;The&nbsp;unit&nbsp;is&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932056">Width</span><span class="op" id="1932061">(</span><span class="op" id="1932062">)</span>&nbsp;<span class="op" id="1932064">(</span><span class="ident" id="1932065">wid</span>&nbsp;<span class="builtintype" id="1932069">int</span><span class="op" id="1932072">,</span>&nbsp;<span class="ident" id="1932074">ok</span>&nbsp;<span class="builtintype" id="1932077">bool</span><span class="op" id="1932081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1932084">//&nbsp;Because&nbsp;ReadRune&nbsp;is&nbsp;implemented&nbsp;by&nbsp;the&nbsp;interface,&nbsp;Read&nbsp;should&nbsp;never&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1932159">//&nbsp;called&nbsp;by&nbsp;the&nbsp;scanning&nbsp;routines&nbsp;and&nbsp;a&nbsp;valid&nbsp;implementation&nbsp;of</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1932225">//&nbsp;ScanState&nbsp;may&nbsp;choose&nbsp;always&nbsp;to&nbsp;return&nbsp;an&nbsp;error&nbsp;from&nbsp;Read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932287">Read</span><span class="op" id="1932291">(</span><span class="ident" id="1932292">buf</span>&nbsp;<span class="op" id="1932296">[</span><span class="op" id="1932297">]</span><span class="builtintype" id="1932298">byte</span><span class="op" id="1932302">)</span>&nbsp;<span class="op" id="1932304">(</span><span class="ident" id="1932305">n</span>&nbsp;<span class="builtintype" id="1932307">int</span><span class="op" id="1932310">,</span>&nbsp;<span class="ident" id="1932312">err</span>&nbsp;<span class="builtintype" id="1932316">error</span><span class="op" id="1932321">)</span><br>
<span class="lineno"></span><span class="op" id="1932323">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1932326">//&nbsp;Scanner&nbsp;is&nbsp;implemented&nbsp;by&nbsp;any&nbsp;value&nbsp;that&nbsp;has&nbsp;a&nbsp;Scan&nbsp;method,&nbsp;which&nbsp;scans</span><br>
<span class="lineno">60</span><span class="comment" id="1932401">//&nbsp;the&nbsp;input&nbsp;for&nbsp;the&nbsp;representation&nbsp;of&nbsp;a&nbsp;value&nbsp;and&nbsp;stores&nbsp;the&nbsp;result&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1932477">//&nbsp;receiver,&nbsp;which&nbsp;must&nbsp;be&nbsp;a&nbsp;pointer&nbsp;to&nbsp;be&nbsp;useful.&nbsp;&nbsp;The&nbsp;Scan&nbsp;method&nbsp;is&nbsp;called</span><br>
<span class="lineno"></span><span class="comment" id="1932555">//&nbsp;for&nbsp;any&nbsp;argument&nbsp;to&nbsp;Scan,&nbsp;Scanf,&nbsp;or&nbsp;Scanln&nbsp;that&nbsp;implements&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="1932621">type</span>&nbsp;<span class="ident" id="1932626">Scanner</span>&nbsp;<span class="keyword" id="1932634">interface</span>&nbsp;<span class="op" id="1932644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932647">Scan</span><span class="op" id="1932651">(</span><span class="ident" id="1932652">state</span>&nbsp;<span class="ident" id="1932658">ScanState</span><span class="op" id="1932667">,</span>&nbsp;<span class="ident" id="1932669">verb</span>&nbsp;<span class="builtintype" id="1932674">rune</span><span class="op" id="1932678">)</span>&nbsp;<span class="builtintype" id="1932680">error</span><br>
<span class="lineno">65</span><span class="op" id="1932686">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1932689">//&nbsp;Scan&nbsp;scans&nbsp;text&nbsp;read&nbsp;from&nbsp;standard&nbsp;input,&nbsp;storing&nbsp;successive</span><br>
<span class="lineno"></span><span class="comment" id="1932753">//&nbsp;space-separated&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments.&nbsp;&nbsp;Newlines&nbsp;count</span><br>
<span class="lineno"></span><span class="comment" id="1932822">//&nbsp;as&nbsp;space.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;scanned.</span><br>
<span class="lineno">70</span><span class="comment" id="1932889">//&nbsp;If&nbsp;that&nbsp;is&nbsp;less&nbsp;than&nbsp;the&nbsp;number&nbsp;of&nbsp;arguments,&nbsp;err&nbsp;will&nbsp;report&nbsp;why.</span><br>
<span class="lineno"></span><span class="keyword" id="1932959">func</span>&nbsp;<span class="ident" id="1932964">Scan</span><span class="op" id="1932968">(</span><span class="ident" id="1932969">a</span>&nbsp;<span class="op" id="1932971">...</span><span class="keyword" id="1932974">interface</span><span class="op" id="1932983">{</span><span class="op" id="1932984">}</span><span class="op" id="1932985">)</span>&nbsp;<span class="op" id="1932987">(</span><span class="ident" id="1932988">n</span>&nbsp;<span class="builtintype" id="1932990">int</span><span class="op" id="1932993">,</span>&nbsp;<span class="ident" id="1932995">err</span>&nbsp;<span class="builtintype" id="1932999">error</span><span class="op" id="1933004">)</span>&nbsp;<span class="op" id="1933006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1933009">return</span>&nbsp;<span class="ident" id="1933016">Fscan</span><span class="op" id="1933021">(</span><span class="ident" id="1933022">os</span><span class="op" id="1933024">.</span><span class="ident" id="1933025">Stdin</span><span class="op" id="1933030">,</span>&nbsp;<span class="ident" id="1933032">a</span><span class="op" id="1933033">...</span><span class="op" id="1933036">)</span><br>
<span class="lineno"></span><span class="op" id="1933038">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="1933041">//&nbsp;Scanln&nbsp;is&nbsp;similar&nbsp;to&nbsp;Scan,&nbsp;but&nbsp;stops&nbsp;scanning&nbsp;at&nbsp;a&nbsp;newline&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1933107">//&nbsp;after&nbsp;the&nbsp;final&nbsp;item&nbsp;there&nbsp;must&nbsp;be&nbsp;a&nbsp;newline&nbsp;or&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="keyword" id="1933163">func</span>&nbsp;<span class="ident" id="1933168">Scanln</span><span class="op" id="1933174">(</span><span class="ident" id="1933175">a</span>&nbsp;<span class="op" id="1933177">...</span><span class="keyword" id="1933180">interface</span><span class="op" id="1933189">{</span><span class="op" id="1933190">}</span><span class="op" id="1933191">)</span>&nbsp;<span class="op" id="1933193">(</span><span class="ident" id="1933194">n</span>&nbsp;<span class="builtintype" id="1933196">int</span><span class="op" id="1933199">,</span>&nbsp;<span class="ident" id="1933201">err</span>&nbsp;<span class="builtintype" id="1933205">error</span><span class="op" id="1933210">)</span>&nbsp;<span class="op" id="1933212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1933215">return</span>&nbsp;<span class="ident" id="1933222">Fscanln</span><span class="op" id="1933229">(</span><span class="ident" id="1933230">os</span><span class="op" id="1933232">.</span><span class="ident" id="1933233">Stdin</span><span class="op" id="1933238">,</span>&nbsp;<span class="ident" id="1933240">a</span><span class="op" id="1933241">...</span><span class="op" id="1933244">)</span><br>
<span class="lineno"></span><span class="op" id="1933246">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="1933249">//&nbsp;Scanf&nbsp;scans&nbsp;text&nbsp;read&nbsp;from&nbsp;standard&nbsp;input,&nbsp;storing&nbsp;successive</span><br>
<span class="lineno"></span><span class="comment" id="1933314">//&nbsp;space-separated&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments&nbsp;as&nbsp;determined&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="1933383">//&nbsp;the&nbsp;format.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;scanned.</span><br>
<span class="lineno"></span><span class="keyword" id="1933452">func</span>&nbsp;<span class="ident" id="1933457">Scanf</span><span class="op" id="1933462">(</span><span class="ident" id="1933463">format</span>&nbsp;<span class="builtintype" id="1933470">string</span><span class="op" id="1933476">,</span>&nbsp;<span class="ident" id="1933478">a</span>&nbsp;<span class="op" id="1933480">...</span><span class="keyword" id="1933483">interface</span><span class="op" id="1933492">{</span><span class="op" id="1933493">}</span><span class="op" id="1933494">)</span>&nbsp;<span class="op" id="1933496">(</span><span class="ident" id="1933497">n</span>&nbsp;<span class="builtintype" id="1933499">int</span><span class="op" id="1933502">,</span>&nbsp;<span class="ident" id="1933504">err</span>&nbsp;<span class="builtintype" id="1933508">error</span><span class="op" id="1933513">)</span>&nbsp;<span class="op" id="1933515">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1933518">return</span>&nbsp;<span class="ident" id="1933525">Fscanf</span><span class="op" id="1933531">(</span><span class="ident" id="1933532">os</span><span class="op" id="1933534">.</span><span class="ident" id="1933535">Stdin</span><span class="op" id="1933540">,</span>&nbsp;<span class="ident" id="1933542">format</span><span class="op" id="1933548">,</span>&nbsp;<span class="ident" id="1933550">a</span><span class="op" id="1933551">...</span><span class="op" id="1933554">)</span><br>
<span class="lineno"></span><span class="op" id="1933556">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1933559">type</span>&nbsp;<span class="ident" id="1933564">stringReader</span>&nbsp;<span class="builtintype" id="1933577">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="1933585">func</span>&nbsp;<span class="op" id="1933590">(</span><span class="ident" id="1933591">r</span>&nbsp;<span class="op" id="1933593">*</span><span class="ident" id="1933594">stringReader</span><span class="op" id="1933606">)</span>&nbsp;<span class="ident" id="1933608">Read</span><span class="op" id="1933612">(</span><span class="ident" id="1933613">b</span>&nbsp;<span class="op" id="1933615">[</span><span class="op" id="1933616">]</span><span class="builtintype" id="1933617">byte</span><span class="op" id="1933621">)</span>&nbsp;<span class="op" id="1933623">(</span><span class="ident" id="1933624">n</span>&nbsp;<span class="builtintype" id="1933626">int</span><span class="op" id="1933629">,</span>&nbsp;<span class="ident" id="1933631">err</span>&nbsp;<span class="builtintype" id="1933635">error</span><span class="op" id="1933640">)</span>&nbsp;<span class="op" id="1933642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1933645">n</span>&nbsp;<span class="op" id="1933647">=</span>&nbsp;<span class="builtinfunc" id="1933649">copy</span><span class="op" id="1933653">(</span><span class="ident" id="1933654">b</span><span class="op" id="1933655">,</span>&nbsp;<span class="op" id="1933657">*</span><span class="ident" id="1933658">r</span><span class="op" id="1933659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1933662">*</span><span class="ident" id="1933663">r</span>&nbsp;<span class="op" id="1933665">=</span>&nbsp;<span class="op" id="1933667">(</span><span class="op" id="1933668">*</span><span class="ident" id="1933669">r</span><span class="op" id="1933670">)</span><span class="op" id="1933671">[</span><span class="ident" id="1933672">n</span><span class="op" id="1933673">:</span><span class="op" id="1933674">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1933677">if</span>&nbsp;<span class="ident" id="1933680">n</span>&nbsp;<span class="op" id="1933682">==</span>&nbsp;<span class="num" id="1933685">0</span>&nbsp;<span class="op" id="1933687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1933691">err</span>&nbsp;<span class="op" id="1933695">=</span>&nbsp;<span class="ident" id="1933697">io</span><span class="op" id="1933699">.</span><span class="ident" id="1933700">EOF</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1933705">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1933708">return</span><br>
<span class="lineno"></span><span class="op" id="1933715">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1933718">//&nbsp;Sscan&nbsp;scans&nbsp;the&nbsp;argument&nbsp;string,&nbsp;storing&nbsp;successive&nbsp;space-separated</span><br>
<span class="lineno">100</span><span class="comment" id="1933789">//&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments.&nbsp;&nbsp;Newlines&nbsp;count&nbsp;as&nbsp;space.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="1933856">//&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;scanned.&nbsp;&nbsp;If&nbsp;that&nbsp;is&nbsp;less</span><br>
<span class="lineno"></span><span class="comment" id="1933926">//&nbsp;than&nbsp;the&nbsp;number&nbsp;of&nbsp;arguments,&nbsp;err&nbsp;will&nbsp;report&nbsp;why.</span><br>
<span class="lineno"></span><span class="keyword" id="1933980">func</span>&nbsp;<span class="ident" id="1933985">Sscan</span><span class="op" id="1933990">(</span><span class="ident" id="1933991">str</span>&nbsp;<span class="builtintype" id="1933995">string</span><span class="op" id="1934001">,</span>&nbsp;<span class="ident" id="1934003">a</span>&nbsp;<span class="op" id="1934005">...</span><span class="keyword" id="1934008">interface</span><span class="op" id="1934017">{</span><span class="op" id="1934018">}</span><span class="op" id="1934019">)</span>&nbsp;<span class="op" id="1934021">(</span><span class="ident" id="1934022">n</span>&nbsp;<span class="builtintype" id="1934024">int</span><span class="op" id="1934027">,</span>&nbsp;<span class="ident" id="1934029">err</span>&nbsp;<span class="builtintype" id="1934033">error</span><span class="op" id="1934038">)</span>&nbsp;<span class="op" id="1934040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1934043">return</span>&nbsp;<span class="ident" id="1934050">Fscan</span><span class="op" id="1934055">(</span><span class="op" id="1934056">(</span><span class="op" id="1934057">*</span><span class="ident" id="1934058">stringReader</span><span class="op" id="1934070">)</span><span class="op" id="1934071">(</span><span class="op" id="1934072">&amp;</span><span class="ident" id="1934073">str</span><span class="op" id="1934076">)</span><span class="op" id="1934077">,</span>&nbsp;<span class="ident" id="1934079">a</span><span class="op" id="1934080">...</span><span class="op" id="1934083">)</span><br>
<span class="lineno">105</span><span class="op" id="1934085">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1934088">//&nbsp;Sscanln&nbsp;is&nbsp;similar&nbsp;to&nbsp;Sscan,&nbsp;but&nbsp;stops&nbsp;scanning&nbsp;at&nbsp;a&nbsp;newline&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1934156">//&nbsp;after&nbsp;the&nbsp;final&nbsp;item&nbsp;there&nbsp;must&nbsp;be&nbsp;a&nbsp;newline&nbsp;or&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="keyword" id="1934212">func</span>&nbsp;<span class="ident" id="1934217">Sscanln</span><span class="op" id="1934224">(</span><span class="ident" id="1934225">str</span>&nbsp;<span class="builtintype" id="1934229">string</span><span class="op" id="1934235">,</span>&nbsp;<span class="ident" id="1934237">a</span>&nbsp;<span class="op" id="1934239">...</span><span class="keyword" id="1934242">interface</span><span class="op" id="1934251">{</span><span class="op" id="1934252">}</span><span class="op" id="1934253">)</span>&nbsp;<span class="op" id="1934255">(</span><span class="ident" id="1934256">n</span>&nbsp;<span class="builtintype" id="1934258">int</span><span class="op" id="1934261">,</span>&nbsp;<span class="ident" id="1934263">err</span>&nbsp;<span class="builtintype" id="1934267">error</span><span class="op" id="1934272">)</span>&nbsp;<span class="op" id="1934274">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1934277">return</span>&nbsp;<span class="ident" id="1934284">Fscanln</span><span class="op" id="1934291">(</span><span class="op" id="1934292">(</span><span class="op" id="1934293">*</span><span class="ident" id="1934294">stringReader</span><span class="op" id="1934306">)</span><span class="op" id="1934307">(</span><span class="op" id="1934308">&amp;</span><span class="ident" id="1934309">str</span><span class="op" id="1934312">)</span><span class="op" id="1934313">,</span>&nbsp;<span class="ident" id="1934315">a</span><span class="op" id="1934316">...</span><span class="op" id="1934319">)</span><br>
<span class="lineno"></span><span class="op" id="1934321">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1934324">//&nbsp;Sscanf&nbsp;scans&nbsp;the&nbsp;argument&nbsp;string,&nbsp;storing&nbsp;successive&nbsp;space-separated</span><br>
<span class="lineno"></span><span class="comment" id="1934396">//&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments&nbsp;as&nbsp;determined&nbsp;by&nbsp;the&nbsp;format.&nbsp;&nbsp;It</span><br>
<span class="lineno">115</span><span class="comment" id="1934465">//&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;parsed.</span><br>
<span class="lineno"></span><span class="keyword" id="1934517">func</span>&nbsp;<span class="ident" id="1934522">Sscanf</span><span class="op" id="1934528">(</span><span class="ident" id="1934529">str</span>&nbsp;<span class="builtintype" id="1934533">string</span><span class="op" id="1934539">,</span>&nbsp;<span class="ident" id="1934541">format</span>&nbsp;<span class="builtintype" id="1934548">string</span><span class="op" id="1934554">,</span>&nbsp;<span class="ident" id="1934556">a</span>&nbsp;<span class="op" id="1934558">...</span><span class="keyword" id="1934561">interface</span><span class="op" id="1934570">{</span><span class="op" id="1934571">}</span><span class="op" id="1934572">)</span>&nbsp;<span class="op" id="1934574">(</span><span class="ident" id="1934575">n</span>&nbsp;<span class="builtintype" id="1934577">int</span><span class="op" id="1934580">,</span>&nbsp;<span class="ident" id="1934582">err</span>&nbsp;<span class="builtintype" id="1934586">error</span><span class="op" id="1934591">)</span>&nbsp;<span class="op" id="1934593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1934596">return</span>&nbsp;<span class="ident" id="1934603">Fscanf</span><span class="op" id="1934609">(</span><span class="op" id="1934610">(</span><span class="op" id="1934611">*</span><span class="ident" id="1934612">stringReader</span><span class="op" id="1934624">)</span><span class="op" id="1934625">(</span><span class="op" id="1934626">&amp;</span><span class="ident" id="1934627">str</span><span class="op" id="1934630">)</span><span class="op" id="1934631">,</span>&nbsp;<span class="ident" id="1934633">format</span><span class="op" id="1934639">,</span>&nbsp;<span class="ident" id="1934641">a</span><span class="op" id="1934642">...</span><span class="op" id="1934645">)</span><br>
<span class="lineno"></span><span class="op" id="1934647">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="1934650">//&nbsp;Fscan&nbsp;scans&nbsp;text&nbsp;read&nbsp;from&nbsp;r,&nbsp;storing&nbsp;successive&nbsp;space-separated</span><br>
<span class="lineno"></span><span class="comment" id="1934718">//&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments.&nbsp;&nbsp;Newlines&nbsp;count&nbsp;as&nbsp;space.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="1934785">//&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;scanned.&nbsp;&nbsp;If&nbsp;that&nbsp;is&nbsp;less</span><br>
<span class="lineno"></span><span class="comment" id="1934855">//&nbsp;than&nbsp;the&nbsp;number&nbsp;of&nbsp;arguments,&nbsp;err&nbsp;will&nbsp;report&nbsp;why.</span><br>
<span class="lineno"></span><span class="keyword" id="1934909">func</span>&nbsp;<span class="ident" id="1934914">Fscan</span><span class="op" id="1934919">(</span><span class="ident" id="1934920">r</span>&nbsp;<span class="ident" id="1934922">io</span><span class="op" id="1934924">.</span><span class="ident" id="1934925">Reader</span><span class="op" id="1934931">,</span>&nbsp;<span class="ident" id="1934933">a</span>&nbsp;<span class="op" id="1934935">...</span><span class="keyword" id="1934938">interface</span><span class="op" id="1934947">{</span><span class="op" id="1934948">}</span><span class="op" id="1934949">)</span>&nbsp;<span class="op" id="1934951">(</span><span class="ident" id="1934952">n</span>&nbsp;<span class="builtintype" id="1934954">int</span><span class="op" id="1934957">,</span>&nbsp;<span class="ident" id="1934959">err</span>&nbsp;<span class="builtintype" id="1934963">error</span><span class="op" id="1934968">)</span>&nbsp;<span class="op" id="1934970">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1934973">s</span><span class="op" id="1934974">,</span>&nbsp;<span class="ident" id="1934976">old</span>&nbsp;<span class="op" id="1934980">:=</span>&nbsp;<span class="ident" id="1934983">newScanState</span><span class="op" id="1934995">(</span><span class="ident" id="1934996">r</span><span class="op" id="1934997">,</span>&nbsp;<span class="ident" id="1934999">true</span><span class="op" id="1935003">,</span>&nbsp;<span class="ident" id="1935005">false</span><span class="op" id="1935010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1935013">n</span><span class="op" id="1935014">,</span>&nbsp;<span class="ident" id="1935016">err</span>&nbsp;<span class="op" id="1935020">=</span>&nbsp;<span class="ident" id="1935022">s</span><span class="op" id="1935023">.</span><span class="ident" id="1935024">doScan</span><span class="op" id="1935030">(</span><span class="ident" id="1935031">a</span><span class="op" id="1935032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1935035">s</span><span class="op" id="1935036">.</span><span class="ident" id="1935037">free</span><span class="op" id="1935041">(</span><span class="ident" id="1935042">old</span><span class="op" id="1935045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1935048">return</span><br>
<span class="lineno"></span><span class="op" id="1935055">}</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span><span class="comment" id="1935058">//&nbsp;Fscanln&nbsp;is&nbsp;similar&nbsp;to&nbsp;Fscan,&nbsp;but&nbsp;stops&nbsp;scanning&nbsp;at&nbsp;a&nbsp;newline&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1935126">//&nbsp;after&nbsp;the&nbsp;final&nbsp;item&nbsp;there&nbsp;must&nbsp;be&nbsp;a&nbsp;newline&nbsp;or&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="keyword" id="1935182">func</span>&nbsp;<span class="ident" id="1935187">Fscanln</span><span class="op" id="1935194">(</span><span class="ident" id="1935195">r</span>&nbsp;<span class="ident" id="1935197">io</span><span class="op" id="1935199">.</span><span class="ident" id="1935200">Reader</span><span class="op" id="1935206">,</span>&nbsp;<span class="ident" id="1935208">a</span>&nbsp;<span class="op" id="1935210">...</span><span class="keyword" id="1935213">interface</span><span class="op" id="1935222">{</span><span class="op" id="1935223">}</span><span class="op" id="1935224">)</span>&nbsp;<span class="op" id="1935226">(</span><span class="ident" id="1935227">n</span>&nbsp;<span class="builtintype" id="1935229">int</span><span class="op" id="1935232">,</span>&nbsp;<span class="ident" id="1935234">err</span>&nbsp;<span class="builtintype" id="1935238">error</span><span class="op" id="1935243">)</span>&nbsp;<span class="op" id="1935245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1935248">s</span><span class="op" id="1935249">,</span>&nbsp;<span class="ident" id="1935251">old</span>&nbsp;<span class="op" id="1935255">:=</span>&nbsp;<span class="ident" id="1935258">newScanState</span><span class="op" id="1935270">(</span><span class="ident" id="1935271">r</span><span class="op" id="1935272">,</span>&nbsp;<span class="ident" id="1935274">false</span><span class="op" id="1935279">,</span>&nbsp;<span class="ident" id="1935281">true</span><span class="op" id="1935285">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1935288">n</span><span class="op" id="1935289">,</span>&nbsp;<span class="ident" id="1935291">err</span>&nbsp;<span class="op" id="1935295">=</span>&nbsp;<span class="ident" id="1935297">s</span><span class="op" id="1935298">.</span><span class="ident" id="1935299">doScan</span><span class="op" id="1935305">(</span><span class="ident" id="1935306">a</span><span class="op" id="1935307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1935310">s</span><span class="op" id="1935311">.</span><span class="ident" id="1935312">free</span><span class="op" id="1935316">(</span><span class="ident" id="1935317">old</span><span class="op" id="1935320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1935323">return</span><br>
<span class="lineno"></span><span class="op" id="1935330">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="comment" id="1935333">//&nbsp;Fscanf&nbsp;scans&nbsp;text&nbsp;read&nbsp;from&nbsp;r,&nbsp;storing&nbsp;successive&nbsp;space-separated</span><br>
<span class="lineno"></span><span class="comment" id="1935402">//&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments&nbsp;as&nbsp;determined&nbsp;by&nbsp;the&nbsp;format.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="1935471">//&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;parsed.</span><br>
<span class="lineno"></span><span class="keyword" id="1935523">func</span>&nbsp;<span class="ident" id="1935528">Fscanf</span><span class="op" id="1935534">(</span><span class="ident" id="1935535">r</span>&nbsp;<span class="ident" id="1935537">io</span><span class="op" id="1935539">.</span><span class="ident" id="1935540">Reader</span><span class="op" id="1935546">,</span>&nbsp;<span class="ident" id="1935548">format</span>&nbsp;<span class="builtintype" id="1935555">string</span><span class="op" id="1935561">,</span>&nbsp;<span class="ident" id="1935563">a</span>&nbsp;<span class="op" id="1935565">...</span><span class="keyword" id="1935568">interface</span><span class="op" id="1935577">{</span><span class="op" id="1935578">}</span><span class="op" id="1935579">)</span>&nbsp;<span class="op" id="1935581">(</span><span class="ident" id="1935582">n</span>&nbsp;<span class="builtintype" id="1935584">int</span><span class="op" id="1935587">,</span>&nbsp;<span class="ident" id="1935589">err</span>&nbsp;<span class="builtintype" id="1935593">error</span><span class="op" id="1935598">)</span>&nbsp;<span class="op" id="1935600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1935603">s</span><span class="op" id="1935604">,</span>&nbsp;<span class="ident" id="1935606">old</span>&nbsp;<span class="op" id="1935610">:=</span>&nbsp;<span class="ident" id="1935613">newScanState</span><span class="op" id="1935625">(</span><span class="ident" id="1935626">r</span><span class="op" id="1935627">,</span>&nbsp;<span class="ident" id="1935629">false</span><span class="op" id="1935634">,</span>&nbsp;<span class="ident" id="1935636">false</span><span class="op" id="1935641">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1935644">n</span><span class="op" id="1935645">,</span>&nbsp;<span class="ident" id="1935647">err</span>&nbsp;<span class="op" id="1935651">=</span>&nbsp;<span class="ident" id="1935653">s</span><span class="op" id="1935654">.</span><span class="ident" id="1935655">doScanf</span><span class="op" id="1935662">(</span><span class="ident" id="1935663">format</span><span class="op" id="1935669">,</span>&nbsp;<span class="ident" id="1935671">a</span><span class="op" id="1935672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1935675">s</span><span class="op" id="1935676">.</span><span class="ident" id="1935677">free</span><span class="op" id="1935681">(</span><span class="ident" id="1935682">old</span><span class="op" id="1935685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1935688">return</span><br>
<span class="lineno"></span><span class="op" id="1935695">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="comment" id="1935698">//&nbsp;scanError&nbsp;represents&nbsp;an&nbsp;error&nbsp;generated&nbsp;by&nbsp;the&nbsp;scanning&nbsp;software.</span><br>
<span class="lineno"></span><span class="comment" id="1935767">//&nbsp;It&#39;s&nbsp;used&nbsp;as&nbsp;a&nbsp;unique&nbsp;signature&nbsp;to&nbsp;identify&nbsp;such&nbsp;errors&nbsp;when&nbsp;recovering.</span><br>
<span class="lineno"></span><span class="keyword" id="1935843">type</span>&nbsp;<span class="ident" id="1935848">scanError</span>&nbsp;<span class="keyword" id="1935858">struct</span>&nbsp;<span class="op" id="1935865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1935868">err</span>&nbsp;<span class="builtintype" id="1935872">error</span><br>
<span class="lineno"></span><span class="op" id="1935878">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="keyword" id="1935881">const</span>&nbsp;<span class="ident" id="1935887">eof</span>&nbsp;<span class="op" id="1935891">=</span>&nbsp;<span class="op" id="1935893">-</span><span class="num" id="1935894">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1935897">//&nbsp;ss&nbsp;is&nbsp;the&nbsp;internal&nbsp;implementation&nbsp;of&nbsp;ScanState.</span><br>
<span class="lineno"></span><span class="keyword" id="1935948">type</span>&nbsp;<span class="ident" id="1935953">ss</span>&nbsp;<span class="keyword" id="1935956">struct</span>&nbsp;<span class="op" id="1935963">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1935966">rr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1935975">io</span><span class="op" id="1935977">.</span><span class="ident" id="1935978">RuneReader</span>&nbsp;<span class="comment" id="1935989">//&nbsp;where&nbsp;to&nbsp;read&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1936013">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1936022">buffer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1936036">//&nbsp;token&nbsp;accumulator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1936058">peekRune</span>&nbsp;<span class="builtintype" id="1936067">rune</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1936081">//&nbsp;one-rune&nbsp;lookahead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1936104">prevRune</span>&nbsp;<span class="builtintype" id="1936113">rune</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1936127">//&nbsp;last&nbsp;rune&nbsp;returned&nbsp;by&nbsp;ReadRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1936162">count</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1936171">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1936185">//&nbsp;runes&nbsp;consumed&nbsp;so&nbsp;far.</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1936212">atEOF</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1936221">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1936235">//&nbsp;already&nbsp;read&nbsp;EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1936256">ssave</span><br>
<span class="lineno"></span><span class="op" id="1936262">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1936265">//&nbsp;ssave&nbsp;holds&nbsp;the&nbsp;parts&nbsp;of&nbsp;ss&nbsp;that&nbsp;need&nbsp;to&nbsp;be</span><br>
<span class="lineno">170</span><span class="comment" id="1936312">//&nbsp;saved&nbsp;and&nbsp;restored&nbsp;on&nbsp;recursive&nbsp;scans.</span><br>
<span class="lineno"></span><span class="keyword" id="1936354">type</span>&nbsp;<span class="ident" id="1936359">ssave</span>&nbsp;<span class="keyword" id="1936365">struct</span>&nbsp;<span class="op" id="1936372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1936375">validSave</span>&nbsp;<span class="builtintype" id="1936385">bool</span>&nbsp;<span class="comment" id="1936390">//&nbsp;is&nbsp;or&nbsp;was&nbsp;a&nbsp;part&nbsp;of&nbsp;an&nbsp;actual&nbsp;ss.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1936428">nlIsEnd</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1936438">bool</span>&nbsp;<span class="comment" id="1936443">//&nbsp;whether&nbsp;newline&nbsp;terminates&nbsp;scan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1936479">nlIsSpace</span>&nbsp;<span class="builtintype" id="1936489">bool</span>&nbsp;<span class="comment" id="1936494">//&nbsp;whether&nbsp;newline&nbsp;counts&nbsp;as&nbsp;white&nbsp;space</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1936536">argLimit</span>&nbsp;&nbsp;<span class="builtintype" id="1936546">int</span>&nbsp;&nbsp;<span class="comment" id="1936551">//&nbsp;max&nbsp;value&nbsp;of&nbsp;ss.count&nbsp;for&nbsp;this&nbsp;arg;&nbsp;argLimit&nbsp;&lt;=&nbsp;limit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1936609">limit</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1936619">int</span>&nbsp;&nbsp;<span class="comment" id="1936624">//&nbsp;max&nbsp;value&nbsp;of&nbsp;ss.count.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1936651">maxWid</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1936661">int</span>&nbsp;&nbsp;<span class="comment" id="1936666">//&nbsp;width&nbsp;of&nbsp;this&nbsp;arg.</span><br>
<span class="lineno"></span><span class="op" id="1936688">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="comment" id="1936691">//&nbsp;The&nbsp;Read&nbsp;method&nbsp;is&nbsp;only&nbsp;in&nbsp;ScanState&nbsp;so&nbsp;that&nbsp;ScanState</span><br>
<span class="lineno"></span><span class="comment" id="1936749">//&nbsp;satisfies&nbsp;io.Reader.&nbsp;It&nbsp;will&nbsp;never&nbsp;be&nbsp;called&nbsp;when&nbsp;used&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="1936810">//&nbsp;intended,&nbsp;so&nbsp;there&nbsp;is&nbsp;no&nbsp;need&nbsp;to&nbsp;make&nbsp;it&nbsp;actually&nbsp;work.</span><br>
<span class="lineno"></span><span class="keyword" id="1936869">func</span>&nbsp;<span class="op" id="1936874">(</span><span class="ident" id="1936875">s</span>&nbsp;<span class="op" id="1936877">*</span><span class="ident" id="1936878">ss</span><span class="op" id="1936880">)</span>&nbsp;<span class="ident" id="1936882">Read</span><span class="op" id="1936886">(</span><span class="ident" id="1936887">buf</span>&nbsp;<span class="op" id="1936891">[</span><span class="op" id="1936892">]</span><span class="builtintype" id="1936893">byte</span><span class="op" id="1936897">)</span>&nbsp;<span class="op" id="1936899">(</span><span class="ident" id="1936900">n</span>&nbsp;<span class="builtintype" id="1936902">int</span><span class="op" id="1936905">,</span>&nbsp;<span class="ident" id="1936907">err</span>&nbsp;<span class="builtintype" id="1936911">error</span><span class="op" id="1936916">)</span>&nbsp;<span class="op" id="1936918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1936921">return</span>&nbsp;<span class="num" id="1936928">0</span><span class="op" id="1936929">,</span>&nbsp;<span class="ident" id="1936931">errors</span><span class="op" id="1936937">.</span><span class="ident" id="1936938">New</span><span class="op" id="1936941">(</span><span class="string" id="1936942">&#34;ScanState&#39;s&nbsp;Read&nbsp;should&nbsp;not&nbsp;be&nbsp;called.&nbsp;Use&nbsp;ReadRune&#34;</span><span class="op" id="1936995">)</span><br>
<span class="lineno">185</span><span class="op" id="1936997">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1937000">func</span>&nbsp;<span class="op" id="1937005">(</span><span class="ident" id="1937006">s</span>&nbsp;<span class="op" id="1937008">*</span><span class="ident" id="1937009">ss</span><span class="op" id="1937011">)</span>&nbsp;<span class="ident" id="1937013">ReadRune</span><span class="op" id="1937021">(</span><span class="op" id="1937022">)</span>&nbsp;<span class="op" id="1937024">(</span><span class="ident" id="1937025">r</span>&nbsp;<span class="builtintype" id="1937027">rune</span><span class="op" id="1937031">,</span>&nbsp;<span class="ident" id="1937033">size</span>&nbsp;<span class="builtintype" id="1937038">int</span><span class="op" id="1937041">,</span>&nbsp;<span class="ident" id="1937043">err</span>&nbsp;<span class="builtintype" id="1937047">error</span><span class="op" id="1937052">)</span>&nbsp;<span class="op" id="1937054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1937057">if</span>&nbsp;<span class="ident" id="1937060">s</span><span class="op" id="1937061">.</span><span class="ident" id="1937062">peekRune</span>&nbsp;<span class="op" id="1937071">&gt;=</span>&nbsp;<span class="num" id="1937074">0</span>&nbsp;<span class="op" id="1937076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1937080">s</span><span class="op" id="1937081">.</span><span class="ident" id="1937082">count</span><span class="op" id="1937087">++</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1937092">r</span>&nbsp;<span class="op" id="1937094">=</span>&nbsp;<span class="ident" id="1937096">s</span><span class="op" id="1937097">.</span><span class="ident" id="1937098">peekRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1937109">size</span>&nbsp;<span class="op" id="1937114">=</span>&nbsp;<span class="ident" id="1937116">utf8</span><span class="op" id="1937120">.</span><span class="ident" id="1937121">RuneLen</span><span class="op" id="1937128">(</span><span class="ident" id="1937129">r</span><span class="op" id="1937130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1937134">s</span><span class="op" id="1937135">.</span><span class="ident" id="1937136">prevRune</span>&nbsp;<span class="op" id="1937145">=</span>&nbsp;<span class="ident" id="1937147">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1937151">s</span><span class="op" id="1937152">.</span><span class="ident" id="1937153">peekRune</span>&nbsp;<span class="op" id="1937162">=</span>&nbsp;<span class="op" id="1937164">-</span><span class="num" id="1937165">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1937169">return</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1937177">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1937180">if</span>&nbsp;<span class="ident" id="1937183">s</span><span class="op" id="1937184">.</span><span class="ident" id="1937185">atEOF</span>&nbsp;<span class="op" id="1937191">||</span>&nbsp;<span class="ident" id="1937194">s</span><span class="op" id="1937195">.</span><span class="ident" id="1937196">nlIsEnd</span>&nbsp;<span class="op" id="1937204">&amp;&amp;</span>&nbsp;<span class="ident" id="1937207">s</span><span class="op" id="1937208">.</span><span class="ident" id="1937209">prevRune</span>&nbsp;<span class="op" id="1937218">==</span>&nbsp;<span class="string" id="1937221">&#39;\n&#39;</span>&nbsp;<span class="op" id="1937226">||</span>&nbsp;<span class="ident" id="1937229">s</span><span class="op" id="1937230">.</span><span class="ident" id="1937231">count</span>&nbsp;<span class="op" id="1937237">&gt;=</span>&nbsp;<span class="ident" id="1937240">s</span><span class="op" id="1937241">.</span><span class="ident" id="1937242">argLimit</span>&nbsp;<span class="op" id="1937251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1937255">err</span>&nbsp;<span class="op" id="1937259">=</span>&nbsp;<span class="ident" id="1937261">io</span><span class="op" id="1937263">.</span><span class="ident" id="1937264">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1937270">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1937278">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1937282">r</span><span class="op" id="1937283">,</span>&nbsp;<span class="ident" id="1937285">size</span><span class="op" id="1937289">,</span>&nbsp;<span class="ident" id="1937291">err</span>&nbsp;<span class="op" id="1937295">=</span>&nbsp;<span class="ident" id="1937297">s</span><span class="op" id="1937298">.</span><span class="ident" id="1937299">rr</span><span class="op" id="1937301">.</span><span class="ident" id="1937302">ReadRune</span><span class="op" id="1937310">(</span><span class="op" id="1937311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1937314">if</span>&nbsp;<span class="ident" id="1937317">err</span>&nbsp;<span class="op" id="1937321">==</span>&nbsp;<span class="ident" id="1937324">nil</span>&nbsp;<span class="op" id="1937328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1937332">s</span><span class="op" id="1937333">.</span><span class="ident" id="1937334">count</span><span class="op" id="1937339">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1937344">s</span><span class="op" id="1937345">.</span><span class="ident" id="1937346">prevRune</span>&nbsp;<span class="op" id="1937355">=</span>&nbsp;<span class="ident" id="1937357">r</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1937360">}</span>&nbsp;<span class="keyword" id="1937362">else</span>&nbsp;<span class="keyword" id="1937367">if</span>&nbsp;<span class="ident" id="1937370">err</span>&nbsp;<span class="op" id="1937374">==</span>&nbsp;<span class="ident" id="1937377">io</span><span class="op" id="1937379">.</span><span class="ident" id="1937380">EOF</span>&nbsp;<span class="op" id="1937384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1937388">s</span><span class="op" id="1937389">.</span><span class="ident" id="1937390">atEOF</span>&nbsp;<span class="op" id="1937396">=</span>&nbsp;<span class="ident" id="1937398">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1937404">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1937407">return</span><br>
<span class="lineno"></span><span class="op" id="1937414">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="keyword" id="1937417">func</span>&nbsp;<span class="op" id="1937422">(</span><span class="ident" id="1937423">s</span>&nbsp;<span class="op" id="1937425">*</span><span class="ident" id="1937426">ss</span><span class="op" id="1937428">)</span>&nbsp;<span class="ident" id="1937430">Width</span><span class="op" id="1937435">(</span><span class="op" id="1937436">)</span>&nbsp;<span class="op" id="1937438">(</span><span class="ident" id="1937439">wid</span>&nbsp;<span class="builtintype" id="1937443">int</span><span class="op" id="1937446">,</span>&nbsp;<span class="ident" id="1937448">ok</span>&nbsp;<span class="builtintype" id="1937451">bool</span><span class="op" id="1937455">)</span>&nbsp;<span class="op" id="1937457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1937460">if</span>&nbsp;<span class="ident" id="1937463">s</span><span class="op" id="1937464">.</span><span class="ident" id="1937465">maxWid</span>&nbsp;<span class="op" id="1937472">==</span>&nbsp;<span class="ident" id="1937475">hugeWid</span>&nbsp;<span class="op" id="1937483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1937487">return</span>&nbsp;<span class="num" id="1937494">0</span><span class="op" id="1937495">,</span>&nbsp;<span class="ident" id="1937497">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1937504">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1937507">return</span>&nbsp;<span class="ident" id="1937514">s</span><span class="op" id="1937515">.</span><span class="ident" id="1937516">maxWid</span><span class="op" id="1937522">,</span>&nbsp;<span class="ident" id="1937524">true</span><br>
<span class="lineno"></span><span class="op" id="1937529">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1937532">//&nbsp;The&nbsp;public&nbsp;method&nbsp;returns&nbsp;an&nbsp;error;&nbsp;this&nbsp;private&nbsp;one&nbsp;panics.</span><br>
<span class="lineno"></span><span class="comment" id="1937596">//&nbsp;If&nbsp;getRune&nbsp;reaches&nbsp;EOF,&nbsp;the&nbsp;return&nbsp;value&nbsp;is&nbsp;EOF&nbsp;(-1).</span><br>
<span class="lineno">220</span><span class="keyword" id="1937653">func</span>&nbsp;<span class="op" id="1937658">(</span><span class="ident" id="1937659">s</span>&nbsp;<span class="op" id="1937661">*</span><span class="ident" id="1937662">ss</span><span class="op" id="1937664">)</span>&nbsp;<span class="ident" id="1937666">getRune</span><span class="op" id="1937673">(</span><span class="op" id="1937674">)</span>&nbsp;<span class="op" id="1937676">(</span><span class="ident" id="1937677">r</span>&nbsp;<span class="builtintype" id="1937679">rune</span><span class="op" id="1937683">)</span>&nbsp;<span class="op" id="1937685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1937688">r</span><span class="op" id="1937689">,</span>&nbsp;<span class="ident" id="1937691">_</span><span class="op" id="1937692">,</span>&nbsp;<span class="ident" id="1937694">err</span>&nbsp;<span class="op" id="1937698">:=</span>&nbsp;<span class="ident" id="1937701">s</span><span class="op" id="1937702">.</span><span class="ident" id="1937703">ReadRune</span><span class="op" id="1937711">(</span><span class="op" id="1937712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1937715">if</span>&nbsp;<span class="ident" id="1937718">err</span>&nbsp;<span class="op" id="1937722">!=</span>&nbsp;<span class="ident" id="1937725">nil</span>&nbsp;<span class="op" id="1937729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1937733">if</span>&nbsp;<span class="ident" id="1937736">err</span>&nbsp;<span class="op" id="1937740">==</span>&nbsp;<span class="ident" id="1937743">io</span><span class="op" id="1937745">.</span><span class="ident" id="1937746">EOF</span>&nbsp;<span class="op" id="1937750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1937755">return</span>&nbsp;<span class="ident" id="1937762">eof</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1937768">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1937772">s</span><span class="op" id="1937773">.</span><span class="builtintype" id="1937774">error</span><span class="op" id="1937779">(</span><span class="ident" id="1937780">err</span><span class="op" id="1937783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1937786">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1937789">return</span><br>
<span class="lineno"></span><span class="op" id="1937796">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="comment" id="1937799">//&nbsp;mustReadRune&nbsp;turns&nbsp;io.EOF&nbsp;into&nbsp;a&nbsp;panic(io.ErrUnexpectedEOF).</span><br>
<span class="lineno"></span><span class="comment" id="1937863">//&nbsp;It&nbsp;is&nbsp;called&nbsp;in&nbsp;cases&nbsp;such&nbsp;as&nbsp;string&nbsp;scanning&nbsp;where&nbsp;an&nbsp;EOF&nbsp;is&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="1937930">//&nbsp;syntax&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="1937947">func</span>&nbsp;<span class="op" id="1937952">(</span><span class="ident" id="1937953">s</span>&nbsp;<span class="op" id="1937955">*</span><span class="ident" id="1937956">ss</span><span class="op" id="1937958">)</span>&nbsp;<span class="ident" id="1937960">mustReadRune</span><span class="op" id="1937972">(</span><span class="op" id="1937973">)</span>&nbsp;<span class="op" id="1937975">(</span><span class="ident" id="1937976">r</span>&nbsp;<span class="builtintype" id="1937978">rune</span><span class="op" id="1937982">)</span>&nbsp;<span class="op" id="1937984">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1937987">r</span>&nbsp;<span class="op" id="1937989">=</span>&nbsp;<span class="ident" id="1937991">s</span><span class="op" id="1937992">.</span><span class="ident" id="1937993">getRune</span><span class="op" id="1938000">(</span><span class="op" id="1938001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1938004">if</span>&nbsp;<span class="ident" id="1938007">r</span>&nbsp;<span class="op" id="1938009">==</span>&nbsp;<span class="ident" id="1938012">eof</span>&nbsp;<span class="op" id="1938016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1938020">s</span><span class="op" id="1938021">.</span><span class="builtintype" id="1938022">error</span><span class="op" id="1938027">(</span><span class="ident" id="1938028">io</span><span class="op" id="1938030">.</span><span class="ident" id="1938031">ErrUnexpectedEOF</span><span class="op" id="1938047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1938050">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1938053">return</span><br>
<span class="lineno">240</span><span class="op" id="1938060">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1938063">func</span>&nbsp;<span class="op" id="1938068">(</span><span class="ident" id="1938069">s</span>&nbsp;<span class="op" id="1938071">*</span><span class="ident" id="1938072">ss</span><span class="op" id="1938074">)</span>&nbsp;<span class="ident" id="1938076">UnreadRune</span><span class="op" id="1938086">(</span><span class="op" id="1938087">)</span>&nbsp;<span class="builtintype" id="1938089">error</span>&nbsp;<span class="op" id="1938095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1938098">if</span>&nbsp;<span class="ident" id="1938101">u</span><span class="op" id="1938102">,</span>&nbsp;<span class="ident" id="1938104">ok</span>&nbsp;<span class="op" id="1938107">:=</span>&nbsp;<span class="ident" id="1938110">s</span><span class="op" id="1938111">.</span><span class="ident" id="1938112">rr</span><span class="op" id="1938114">.</span><span class="op" id="1938115">(</span><span class="ident" id="1938116">runeUnreader</span><span class="op" id="1938128">)</span><span class="op" id="1938129">;</span>&nbsp;<span class="ident" id="1938131">ok</span>&nbsp;<span class="op" id="1938134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1938138">u</span><span class="op" id="1938139">.</span><span class="ident" id="1938140">UnreadRune</span><span class="op" id="1938150">(</span><span class="op" id="1938151">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1938154">}</span>&nbsp;<span class="keyword" id="1938156">else</span>&nbsp;<span class="op" id="1938161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1938165">s</span><span class="op" id="1938166">.</span><span class="ident" id="1938167">peekRune</span>&nbsp;<span class="op" id="1938176">=</span>&nbsp;<span class="ident" id="1938178">s</span><span class="op" id="1938179">.</span><span class="ident" id="1938180">prevRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1938190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1938193">s</span><span class="op" id="1938194">.</span><span class="ident" id="1938195">prevRune</span>&nbsp;<span class="op" id="1938204">=</span>&nbsp;<span class="op" id="1938206">-</span><span class="num" id="1938207">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1938210">s</span><span class="op" id="1938211">.</span><span class="ident" id="1938212">count</span><span class="op" id="1938217">--</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1938221">return</span>&nbsp;<span class="ident" id="1938228">nil</span><br>
<span class="lineno"></span><span class="op" id="1938232">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1938235">func</span>&nbsp;<span class="op" id="1938240">(</span><span class="ident" id="1938241">s</span>&nbsp;<span class="op" id="1938243">*</span><span class="ident" id="1938244">ss</span><span class="op" id="1938246">)</span>&nbsp;<span class="builtintype" id="1938248">error</span><span class="op" id="1938253">(</span><span class="ident" id="1938254">err</span>&nbsp;<span class="builtintype" id="1938258">error</span><span class="op" id="1938263">)</span>&nbsp;<span class="op" id="1938265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1938268">panic</span><span class="op" id="1938273">(</span><span class="ident" id="1938274">scanError</span><span class="op" id="1938283">{</span><span class="ident" id="1938284">err</span><span class="op" id="1938287">}</span><span class="op" id="1938288">)</span><br>
<span class="lineno">255</span><span class="op" id="1938290">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1938293">func</span>&nbsp;<span class="op" id="1938298">(</span><span class="ident" id="1938299">s</span>&nbsp;<span class="op" id="1938301">*</span><span class="ident" id="1938302">ss</span><span class="op" id="1938304">)</span>&nbsp;<span class="ident" id="1938306">errorString</span><span class="op" id="1938317">(</span><span class="ident" id="1938318">err</span>&nbsp;<span class="builtintype" id="1938322">string</span><span class="op" id="1938328">)</span>&nbsp;<span class="op" id="1938330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1938333">panic</span><span class="op" id="1938338">(</span><span class="ident" id="1938339">scanError</span><span class="op" id="1938348">{</span><span class="ident" id="1938349">errors</span><span class="op" id="1938355">.</span><span class="ident" id="1938356">New</span><span class="op" id="1938359">(</span><span class="ident" id="1938360">err</span><span class="op" id="1938363">)</span><span class="op" id="1938364">}</span><span class="op" id="1938365">)</span><br>
<span class="lineno"></span><span class="op" id="1938367">}</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="keyword" id="1938370">func</span>&nbsp;<span class="op" id="1938375">(</span><span class="ident" id="1938376">s</span>&nbsp;<span class="op" id="1938378">*</span><span class="ident" id="1938379">ss</span><span class="op" id="1938381">)</span>&nbsp;<span class="ident" id="1938383">Token</span><span class="op" id="1938388">(</span><span class="ident" id="1938389">skipSpace</span>&nbsp;<span class="builtintype" id="1938399">bool</span><span class="op" id="1938403">,</span>&nbsp;<span class="ident" id="1938405">f</span>&nbsp;<span class="keyword" id="1938407">func</span><span class="op" id="1938411">(</span><span class="builtintype" id="1938412">rune</span><span class="op" id="1938416">)</span>&nbsp;<span class="builtintype" id="1938418">bool</span><span class="op" id="1938422">)</span>&nbsp;<span class="op" id="1938424">(</span><span class="ident" id="1938425">tok</span>&nbsp;<span class="op" id="1938429">[</span><span class="op" id="1938430">]</span><span class="builtintype" id="1938431">byte</span><span class="op" id="1938435">,</span>&nbsp;<span class="ident" id="1938437">err</span>&nbsp;<span class="builtintype" id="1938441">error</span><span class="op" id="1938446">)</span>&nbsp;<span class="op" id="1938448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1938451">defer</span>&nbsp;<span class="keyword" id="1938457">func</span><span class="op" id="1938461">(</span><span class="op" id="1938462">)</span>&nbsp;<span class="op" id="1938464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1938468">if</span>&nbsp;<span class="ident" id="1938471">e</span>&nbsp;<span class="op" id="1938473">:=</span>&nbsp;<span class="builtinfunc" id="1938476">recover</span><span class="op" id="1938483">(</span><span class="op" id="1938484">)</span><span class="op" id="1938485">;</span>&nbsp;<span class="ident" id="1938487">e</span>&nbsp;<span class="op" id="1938489">!=</span>&nbsp;<span class="ident" id="1938492">nil</span>&nbsp;<span class="op" id="1938496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1938501">if</span>&nbsp;<span class="ident" id="1938504">se</span><span class="op" id="1938506">,</span>&nbsp;<span class="ident" id="1938508">ok</span>&nbsp;<span class="op" id="1938511">:=</span>&nbsp;<span class="ident" id="1938514">e</span><span class="op" id="1938515">.</span><span class="op" id="1938516">(</span><span class="ident" id="1938517">scanError</span><span class="op" id="1938526">)</span><span class="op" id="1938527">;</span>&nbsp;<span class="ident" id="1938529">ok</span>&nbsp;<span class="op" id="1938532">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1938538">err</span>&nbsp;<span class="op" id="1938542">=</span>&nbsp;<span class="ident" id="1938544">se</span><span class="op" id="1938546">.</span><span class="ident" id="1938547">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1938554">}</span>&nbsp;<span class="keyword" id="1938556">else</span>&nbsp;<span class="op" id="1938561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1938567">panic</span><span class="op" id="1938572">(</span><span class="ident" id="1938573">e</span><span class="op" id="1938574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1938579">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1938583">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1938586">}</span><span class="op" id="1938587">(</span><span class="op" id="1938588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1938591">if</span>&nbsp;<span class="ident" id="1938594">f</span>&nbsp;<span class="op" id="1938596">==</span>&nbsp;<span class="ident" id="1938599">nil</span>&nbsp;<span class="op" id="1938603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1938607">f</span>&nbsp;<span class="op" id="1938609">=</span>&nbsp;<span class="ident" id="1938611">notSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1938621">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1938624">s</span><span class="op" id="1938625">.</span><span class="ident" id="1938626">buf</span>&nbsp;<span class="op" id="1938630">=</span>&nbsp;<span class="ident" id="1938632">s</span><span class="op" id="1938633">.</span><span class="ident" id="1938634">buf</span><span class="op" id="1938637">[</span><span class="op" id="1938638">:</span><span class="num" id="1938639">0</span><span class="op" id="1938640">]</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1938643">tok</span>&nbsp;<span class="op" id="1938647">=</span>&nbsp;<span class="ident" id="1938649">s</span><span class="op" id="1938650">.</span><span class="ident" id="1938651">token</span><span class="op" id="1938656">(</span><span class="ident" id="1938657">skipSpace</span><span class="op" id="1938666">,</span>&nbsp;<span class="ident" id="1938668">f</span><span class="op" id="1938669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1938672">return</span><br>
<span class="lineno"></span><span class="op" id="1938679">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1938682">//&nbsp;space&nbsp;is&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;unicode.White_Space&nbsp;ranges,</span><br>
<span class="lineno">280</span><span class="comment" id="1938736">//&nbsp;to&nbsp;avoid&nbsp;depending&nbsp;on&nbsp;package&nbsp;unicode.</span><br>
<span class="lineno"></span><span class="keyword" id="1938778">var</span>&nbsp;<span class="ident" id="1938782">space</span>&nbsp;<span class="op" id="1938788">=</span>&nbsp;<span class="op" id="1938790">[</span><span class="op" id="1938791">]</span><span class="op" id="1938792">[</span><span class="num" id="1938793">2</span><span class="op" id="1938794">]</span><span class="builtintype" id="1938795">uint16</span><span class="op" id="1938801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1938804">{</span><span class="num" id="1938805">0x0009</span><span class="op" id="1938811">,</span>&nbsp;<span class="num" id="1938813">0x000d</span><span class="op" id="1938819">}</span><span class="op" id="1938820">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1938823">{</span><span class="num" id="1938824">0x0020</span><span class="op" id="1938830">,</span>&nbsp;<span class="num" id="1938832">0x0020</span><span class="op" id="1938838">}</span><span class="op" id="1938839">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1938842">{</span><span class="num" id="1938843">0x0085</span><span class="op" id="1938849">,</span>&nbsp;<span class="num" id="1938851">0x0085</span><span class="op" id="1938857">}</span><span class="op" id="1938858">,</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1938861">{</span><span class="num" id="1938862">0x00a0</span><span class="op" id="1938868">,</span>&nbsp;<span class="num" id="1938870">0x00a0</span><span class="op" id="1938876">}</span><span class="op" id="1938877">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1938880">{</span><span class="num" id="1938881">0x1680</span><span class="op" id="1938887">,</span>&nbsp;<span class="num" id="1938889">0x1680</span><span class="op" id="1938895">}</span><span class="op" id="1938896">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1938899">{</span><span class="num" id="1938900">0x2000</span><span class="op" id="1938906">,</span>&nbsp;<span class="num" id="1938908">0x200a</span><span class="op" id="1938914">}</span><span class="op" id="1938915">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1938918">{</span><span class="num" id="1938919">0x2028</span><span class="op" id="1938925">,</span>&nbsp;<span class="num" id="1938927">0x2029</span><span class="op" id="1938933">}</span><span class="op" id="1938934">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1938937">{</span><span class="num" id="1938938">0x202f</span><span class="op" id="1938944">,</span>&nbsp;<span class="num" id="1938946">0x202f</span><span class="op" id="1938952">}</span><span class="op" id="1938953">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1938956">{</span><span class="num" id="1938957">0x205f</span><span class="op" id="1938963">,</span>&nbsp;<span class="num" id="1938965">0x205f</span><span class="op" id="1938971">}</span><span class="op" id="1938972">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1938975">{</span><span class="num" id="1938976">0x3000</span><span class="op" id="1938982">,</span>&nbsp;<span class="num" id="1938984">0x3000</span><span class="op" id="1938990">}</span><span class="op" id="1938991">,</span><br>
<span class="lineno"></span><span class="op" id="1938993">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1938996">func</span>&nbsp;<span class="ident" id="1939001">isSpace</span><span class="op" id="1939008">(</span><span class="ident" id="1939009">r</span>&nbsp;<span class="builtintype" id="1939011">rune</span><span class="op" id="1939015">)</span>&nbsp;<span class="builtintype" id="1939017">bool</span>&nbsp;<span class="op" id="1939022">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1939025">if</span>&nbsp;<span class="ident" id="1939028">r</span>&nbsp;<span class="op" id="1939030">&gt;=</span>&nbsp;<span class="num" id="1939033">1</span><span class="op" id="1939034">&lt;&lt;</span><span class="num" id="1939036">16</span>&nbsp;<span class="op" id="1939039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1939043">return</span>&nbsp;<span class="ident" id="1939050">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1939057">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1939060">rx</span>&nbsp;<span class="op" id="1939063">:=</span>&nbsp;<span class="builtintype" id="1939066">uint16</span><span class="op" id="1939072">(</span><span class="ident" id="1939073">r</span><span class="op" id="1939074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1939077">for</span>&nbsp;<span class="ident" id="1939081">_</span><span class="op" id="1939082">,</span>&nbsp;<span class="ident" id="1939084">rng</span>&nbsp;<span class="op" id="1939088">:=</span>&nbsp;<span class="keyword" id="1939091">range</span>&nbsp;<span class="ident" id="1939097">space</span>&nbsp;<span class="op" id="1939103">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1939107">if</span>&nbsp;<span class="ident" id="1939110">rx</span>&nbsp;<span class="op" id="1939113">&lt;</span>&nbsp;<span class="ident" id="1939115">rng</span><span class="op" id="1939118">[</span><span class="num" id="1939119">0</span><span class="op" id="1939120">]</span>&nbsp;<span class="op" id="1939122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1939127">return</span>&nbsp;<span class="ident" id="1939134">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1939142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1939146">if</span>&nbsp;<span class="ident" id="1939149">rx</span>&nbsp;<span class="op" id="1939152">&lt;=</span>&nbsp;<span class="ident" id="1939155">rng</span><span class="op" id="1939158">[</span><span class="num" id="1939159">1</span><span class="op" id="1939160">]</span>&nbsp;<span class="op" id="1939162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1939167">return</span>&nbsp;<span class="ident" id="1939174">true</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1939181">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1939184">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1939187">return</span>&nbsp;<span class="ident" id="1939194">false</span><br>
<span class="lineno"></span><span class="op" id="1939200">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="1939203">//&nbsp;notSpace&nbsp;is&nbsp;the&nbsp;default&nbsp;scanning&nbsp;function&nbsp;used&nbsp;in&nbsp;Token.</span><br>
<span class="lineno"></span><span class="keyword" id="1939263">func</span>&nbsp;<span class="ident" id="1939268">notSpace</span><span class="op" id="1939276">(</span><span class="ident" id="1939277">r</span>&nbsp;<span class="builtintype" id="1939279">rune</span><span class="op" id="1939283">)</span>&nbsp;<span class="builtintype" id="1939285">bool</span>&nbsp;<span class="op" id="1939290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1939293">return</span>&nbsp;<span class="op" id="1939300">!</span><span class="ident" id="1939301">isSpace</span><span class="op" id="1939308">(</span><span class="ident" id="1939309">r</span><span class="op" id="1939310">)</span><br>
<span class="lineno"></span><span class="op" id="1939312">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">315</span><span class="comment" id="1939315">//&nbsp;SkipSpace&nbsp;provides&nbsp;Scan&nbsp;methods&nbsp;the&nbsp;ability&nbsp;to&nbsp;skip&nbsp;space&nbsp;and&nbsp;newline</span><br>
<span class="lineno"></span><span class="comment" id="1939388">//&nbsp;characters&nbsp;in&nbsp;keeping&nbsp;with&nbsp;the&nbsp;current&nbsp;scanning&nbsp;mode&nbsp;set&nbsp;by&nbsp;format&nbsp;strings</span><br>
<span class="lineno"></span><span class="comment" id="1939466">//&nbsp;and&nbsp;Scan/Scanln.</span><br>
<span class="lineno"></span><span class="keyword" id="1939486">func</span>&nbsp;<span class="op" id="1939491">(</span><span class="ident" id="1939492">s</span>&nbsp;<span class="op" id="1939494">*</span><span class="ident" id="1939495">ss</span><span class="op" id="1939497">)</span>&nbsp;<span class="ident" id="1939499">SkipSpace</span><span class="op" id="1939508">(</span><span class="op" id="1939509">)</span>&nbsp;<span class="op" id="1939511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1939514">s</span><span class="op" id="1939515">.</span><span class="ident" id="1939516">skipSpace</span><span class="op" id="1939525">(</span><span class="ident" id="1939526">false</span><span class="op" id="1939531">)</span><br>
<span class="lineno">320</span><span class="op" id="1939533">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1939536">//&nbsp;readRune&nbsp;is&nbsp;a&nbsp;structure&nbsp;to&nbsp;enable&nbsp;reading&nbsp;UTF-8&nbsp;encoded&nbsp;code&nbsp;points</span><br>
<span class="lineno"></span><span class="comment" id="1939607">//&nbsp;from&nbsp;an&nbsp;io.Reader.&nbsp;&nbsp;It&nbsp;is&nbsp;used&nbsp;if&nbsp;the&nbsp;Reader&nbsp;given&nbsp;to&nbsp;the&nbsp;scanner&nbsp;does</span><br>
<span class="lineno"></span><span class="comment" id="1939681">//&nbsp;not&nbsp;already&nbsp;implement&nbsp;io.RuneReader.</span><br>
<span class="lineno">325</span><span class="keyword" id="1939721">type</span>&nbsp;<span class="ident" id="1939726">readRune</span>&nbsp;<span class="keyword" id="1939735">struct</span>&nbsp;<span class="op" id="1939742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1939745">reader</span>&nbsp;&nbsp;<span class="ident" id="1939753">io</span><span class="op" id="1939755">.</span><span class="ident" id="1939756">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1939764">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1939772">[</span><span class="ident" id="1939773">utf8</span><span class="op" id="1939777">.</span><span class="ident" id="1939778">UTFMax</span><span class="op" id="1939784">]</span><span class="builtintype" id="1939785">byte</span>&nbsp;<span class="comment" id="1939790">//&nbsp;used&nbsp;only&nbsp;inside&nbsp;ReadRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1939820">pending</span>&nbsp;<span class="builtintype" id="1939828">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1939846">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;in&nbsp;pendBuf;&nbsp;only&nbsp;&gt;0&nbsp;for&nbsp;bad&nbsp;UTF-8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1939900">pendBuf</span>&nbsp;<span class="op" id="1939908">[</span><span class="ident" id="1939909">utf8</span><span class="op" id="1939913">.</span><span class="ident" id="1939914">UTFMax</span><span class="op" id="1939920">]</span><span class="builtintype" id="1939921">byte</span>&nbsp;<span class="comment" id="1939926">//&nbsp;bytes&nbsp;left&nbsp;over</span><br>
<span class="lineno">330</span><span class="op" id="1939945">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1939948">//&nbsp;readByte&nbsp;returns&nbsp;the&nbsp;next&nbsp;byte&nbsp;from&nbsp;the&nbsp;input,&nbsp;which&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="1940011">//&nbsp;left&nbsp;over&nbsp;from&nbsp;a&nbsp;previous&nbsp;read&nbsp;if&nbsp;the&nbsp;UTF-8&nbsp;was&nbsp;ill-formed.</span><br>
<span class="lineno"></span><span class="keyword" id="1940074">func</span>&nbsp;<span class="op" id="1940079">(</span><span class="ident" id="1940080">r</span>&nbsp;<span class="op" id="1940082">*</span><span class="ident" id="1940083">readRune</span><span class="op" id="1940091">)</span>&nbsp;<span class="ident" id="1940093">readByte</span><span class="op" id="1940101">(</span><span class="op" id="1940102">)</span>&nbsp;<span class="op" id="1940104">(</span><span class="ident" id="1940105">b</span>&nbsp;<span class="builtintype" id="1940107">byte</span><span class="op" id="1940111">,</span>&nbsp;<span class="ident" id="1940113">err</span>&nbsp;<span class="builtintype" id="1940117">error</span><span class="op" id="1940122">)</span>&nbsp;<span class="op" id="1940124">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1940127">if</span>&nbsp;<span class="ident" id="1940130">r</span><span class="op" id="1940131">.</span><span class="ident" id="1940132">pending</span>&nbsp;<span class="op" id="1940140">&gt;</span>&nbsp;<span class="num" id="1940142">0</span>&nbsp;<span class="op" id="1940144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1940148">b</span>&nbsp;<span class="op" id="1940150">=</span>&nbsp;<span class="ident" id="1940152">r</span><span class="op" id="1940153">.</span><span class="ident" id="1940154">pendBuf</span><span class="op" id="1940161">[</span><span class="num" id="1940162">0</span><span class="op" id="1940163">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1940167">copy</span><span class="op" id="1940171">(</span><span class="ident" id="1940172">r</span><span class="op" id="1940173">.</span><span class="ident" id="1940174">pendBuf</span><span class="op" id="1940181">[</span><span class="num" id="1940182">0</span><span class="op" id="1940183">:</span><span class="op" id="1940184">]</span><span class="op" id="1940185">,</span>&nbsp;<span class="ident" id="1940187">r</span><span class="op" id="1940188">.</span><span class="ident" id="1940189">pendBuf</span><span class="op" id="1940196">[</span><span class="num" id="1940197">1</span><span class="op" id="1940198">:</span><span class="op" id="1940199">]</span><span class="op" id="1940200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1940204">r</span><span class="op" id="1940205">.</span><span class="ident" id="1940206">pending</span><span class="op" id="1940213">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1940218">return</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1940226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1940229">n</span><span class="op" id="1940230">,</span>&nbsp;<span class="ident" id="1940232">err</span>&nbsp;<span class="op" id="1940236">:=</span>&nbsp;<span class="ident" id="1940239">io</span><span class="op" id="1940241">.</span><span class="ident" id="1940242">ReadFull</span><span class="op" id="1940250">(</span><span class="ident" id="1940251">r</span><span class="op" id="1940252">.</span><span class="ident" id="1940253">reader</span><span class="op" id="1940259">,</span>&nbsp;<span class="ident" id="1940261">r</span><span class="op" id="1940262">.</span><span class="ident" id="1940263">pendBuf</span><span class="op" id="1940270">[</span><span class="num" id="1940271">0</span><span class="op" id="1940272">:</span><span class="num" id="1940273">1</span><span class="op" id="1940274">]</span><span class="op" id="1940275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1940278">if</span>&nbsp;<span class="ident" id="1940281">n</span>&nbsp;<span class="op" id="1940283">!=</span>&nbsp;<span class="num" id="1940286">1</span>&nbsp;<span class="op" id="1940288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1940292">return</span>&nbsp;<span class="num" id="1940299">0</span><span class="op" id="1940300">,</span>&nbsp;<span class="ident" id="1940302">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1940307">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1940310">return</span>&nbsp;<span class="ident" id="1940317">r</span><span class="op" id="1940318">.</span><span class="ident" id="1940319">pendBuf</span><span class="op" id="1940326">[</span><span class="num" id="1940327">0</span><span class="op" id="1940328">]</span><span class="op" id="1940329">,</span>&nbsp;<span class="ident" id="1940331">err</span><br>
<span class="lineno"></span><span class="op" id="1940335">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1940338">//&nbsp;unread&nbsp;saves&nbsp;the&nbsp;bytes&nbsp;for&nbsp;the&nbsp;next&nbsp;read.</span><br>
<span class="lineno"></span><span class="keyword" id="1940383">func</span>&nbsp;<span class="op" id="1940388">(</span><span class="ident" id="1940389">r</span>&nbsp;<span class="op" id="1940391">*</span><span class="ident" id="1940392">readRune</span><span class="op" id="1940400">)</span>&nbsp;<span class="ident" id="1940402">unread</span><span class="op" id="1940408">(</span><span class="ident" id="1940409">buf</span>&nbsp;<span class="op" id="1940413">[</span><span class="op" id="1940414">]</span><span class="builtintype" id="1940415">byte</span><span class="op" id="1940419">)</span>&nbsp;<span class="op" id="1940421">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1940424">copy</span><span class="op" id="1940428">(</span><span class="ident" id="1940429">r</span><span class="op" id="1940430">.</span><span class="ident" id="1940431">pendBuf</span><span class="op" id="1940438">[</span><span class="ident" id="1940439">r</span><span class="op" id="1940440">.</span><span class="ident" id="1940441">pending</span><span class="op" id="1940448">:</span><span class="op" id="1940449">]</span><span class="op" id="1940450">,</span>&nbsp;<span class="ident" id="1940452">buf</span><span class="op" id="1940455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1940458">r</span><span class="op" id="1940459">.</span><span class="ident" id="1940460">pending</span>&nbsp;<span class="op" id="1940468">+=</span>&nbsp;<span class="builtinfunc" id="1940471">len</span><span class="op" id="1940474">(</span><span class="ident" id="1940475">buf</span><span class="op" id="1940478">)</span><br>
<span class="lineno"></span><span class="op" id="1940480">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1940483">//&nbsp;ReadRune&nbsp;returns&nbsp;the&nbsp;next&nbsp;UTF-8&nbsp;encoded&nbsp;code&nbsp;point&nbsp;from&nbsp;the</span><br>
<span class="lineno">355</span><span class="comment" id="1940546">//&nbsp;io.Reader&nbsp;inside&nbsp;r.</span><br>
<span class="lineno"></span><span class="keyword" id="1940569">func</span>&nbsp;<span class="op" id="1940574">(</span><span class="ident" id="1940575">r</span>&nbsp;<span class="op" id="1940577">*</span><span class="ident" id="1940578">readRune</span><span class="op" id="1940586">)</span>&nbsp;<span class="ident" id="1940588">ReadRune</span><span class="op" id="1940596">(</span><span class="op" id="1940597">)</span>&nbsp;<span class="op" id="1940599">(</span><span class="ident" id="1940600">rr</span>&nbsp;<span class="builtintype" id="1940603">rune</span><span class="op" id="1940607">,</span>&nbsp;<span class="ident" id="1940609">size</span>&nbsp;<span class="builtintype" id="1940614">int</span><span class="op" id="1940617">,</span>&nbsp;<span class="ident" id="1940619">err</span>&nbsp;<span class="builtintype" id="1940623">error</span><span class="op" id="1940628">)</span>&nbsp;<span class="op" id="1940630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1940633">r</span><span class="op" id="1940634">.</span><span class="ident" id="1940635">buf</span><span class="op" id="1940638">[</span><span class="num" id="1940639">0</span><span class="op" id="1940640">]</span><span class="op" id="1940641">,</span>&nbsp;<span class="ident" id="1940643">err</span>&nbsp;<span class="op" id="1940647">=</span>&nbsp;<span class="ident" id="1940649">r</span><span class="op" id="1940650">.</span><span class="ident" id="1940651">readByte</span><span class="op" id="1940659">(</span><span class="op" id="1940660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1940663">if</span>&nbsp;<span class="ident" id="1940666">err</span>&nbsp;<span class="op" id="1940670">!=</span>&nbsp;<span class="ident" id="1940673">nil</span>&nbsp;<span class="op" id="1940677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1940681">return</span>&nbsp;<span class="num" id="1940688">0</span><span class="op" id="1940689">,</span>&nbsp;<span class="num" id="1940691">0</span><span class="op" id="1940692">,</span>&nbsp;<span class="ident" id="1940694">err</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1940699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1940702">if</span>&nbsp;<span class="ident" id="1940705">r</span><span class="op" id="1940706">.</span><span class="ident" id="1940707">buf</span><span class="op" id="1940710">[</span><span class="num" id="1940711">0</span><span class="op" id="1940712">]</span>&nbsp;<span class="op" id="1940714">&lt;</span>&nbsp;<span class="ident" id="1940716">utf8</span><span class="op" id="1940720">.</span><span class="ident" id="1940721">RuneSelf</span>&nbsp;<span class="op" id="1940730">{</span>&nbsp;<span class="comment" id="1940732">//&nbsp;fast&nbsp;check&nbsp;for&nbsp;common&nbsp;ASCII&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1940770">rr</span>&nbsp;<span class="op" id="1940773">=</span>&nbsp;<span class="builtintype" id="1940775">rune</span><span class="op" id="1940779">(</span><span class="ident" id="1940780">r</span><span class="op" id="1940781">.</span><span class="ident" id="1940782">buf</span><span class="op" id="1940785">[</span><span class="num" id="1940786">0</span><span class="op" id="1940787">]</span><span class="op" id="1940788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1940792">size</span>&nbsp;<span class="op" id="1940797">=</span>&nbsp;<span class="num" id="1940799">1</span>&nbsp;<span class="comment" id="1940801">//&nbsp;Known&nbsp;to&nbsp;be&nbsp;1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1940821">return</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1940829">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1940832">var</span>&nbsp;<span class="ident" id="1940836">n</span>&nbsp;<span class="builtintype" id="1940838">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1940843">for</span>&nbsp;<span class="ident" id="1940847">n</span>&nbsp;<span class="op" id="1940849">=</span>&nbsp;<span class="num" id="1940851">1</span><span class="op" id="1940852">;</span>&nbsp;<span class="op" id="1940854">!</span><span class="ident" id="1940855">utf8</span><span class="op" id="1940859">.</span><span class="ident" id="1940860">FullRune</span><span class="op" id="1940868">(</span><span class="ident" id="1940869">r</span><span class="op" id="1940870">.</span><span class="ident" id="1940871">buf</span><span class="op" id="1940874">[</span><span class="num" id="1940875">0</span><span class="op" id="1940876">:</span><span class="ident" id="1940877">n</span><span class="op" id="1940878">]</span><span class="op" id="1940879">)</span><span class="op" id="1940880">;</span>&nbsp;<span class="ident" id="1940882">n</span><span class="op" id="1940883">++</span>&nbsp;<span class="op" id="1940886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1940890">r</span><span class="op" id="1940891">.</span><span class="ident" id="1940892">buf</span><span class="op" id="1940895">[</span><span class="ident" id="1940896">n</span><span class="op" id="1940897">]</span><span class="op" id="1940898">,</span>&nbsp;<span class="ident" id="1940900">err</span>&nbsp;<span class="op" id="1940904">=</span>&nbsp;<span class="ident" id="1940906">r</span><span class="op" id="1940907">.</span><span class="ident" id="1940908">readByte</span><span class="op" id="1940916">(</span><span class="op" id="1940917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1940921">if</span>&nbsp;<span class="ident" id="1940924">err</span>&nbsp;<span class="op" id="1940928">!=</span>&nbsp;<span class="ident" id="1940931">nil</span>&nbsp;<span class="op" id="1940935">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1940940">if</span>&nbsp;<span class="ident" id="1940943">err</span>&nbsp;<span class="op" id="1940947">==</span>&nbsp;<span class="ident" id="1940950">io</span><span class="op" id="1940952">.</span><span class="ident" id="1940953">EOF</span>&nbsp;<span class="op" id="1940957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1940963">err</span>&nbsp;<span class="op" id="1940967">=</span>&nbsp;<span class="ident" id="1940969">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1940977">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1940986">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1940991">return</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1941000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1941003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1941006">rr</span><span class="op" id="1941008">,</span>&nbsp;<span class="ident" id="1941010">size</span>&nbsp;<span class="op" id="1941015">=</span>&nbsp;<span class="ident" id="1941017">utf8</span><span class="op" id="1941021">.</span><span class="ident" id="1941022">DecodeRune</span><span class="op" id="1941032">(</span><span class="ident" id="1941033">r</span><span class="op" id="1941034">.</span><span class="ident" id="1941035">buf</span><span class="op" id="1941038">[</span><span class="num" id="1941039">0</span><span class="op" id="1941040">:</span><span class="ident" id="1941041">n</span><span class="op" id="1941042">]</span><span class="op" id="1941043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1941046">if</span>&nbsp;<span class="ident" id="1941049">size</span>&nbsp;<span class="op" id="1941054">&lt;</span>&nbsp;<span class="ident" id="1941056">n</span>&nbsp;<span class="op" id="1941058">{</span>&nbsp;<span class="comment" id="1941060">//&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1941074">r</span><span class="op" id="1941075">.</span><span class="ident" id="1941076">unread</span><span class="op" id="1941082">(</span><span class="ident" id="1941083">r</span><span class="op" id="1941084">.</span><span class="ident" id="1941085">buf</span><span class="op" id="1941088">[</span><span class="ident" id="1941089">size</span><span class="op" id="1941093">:</span><span class="ident" id="1941094">n</span><span class="op" id="1941095">]</span><span class="op" id="1941096">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1941099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1941102">return</span><br>
<span class="lineno"></span><span class="op" id="1941109">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1941112">var</span>&nbsp;<span class="ident" id="1941116">ssFree</span>&nbsp;<span class="op" id="1941123">=</span>&nbsp;<span class="ident" id="1941125">sync</span><span class="op" id="1941129">.</span><span class="ident" id="1941130">Pool</span><span class="op" id="1941134">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1941137">New</span><span class="op" id="1941140">:</span>&nbsp;<span class="keyword" id="1941142">func</span><span class="op" id="1941146">(</span><span class="op" id="1941147">)</span>&nbsp;<span class="keyword" id="1941149">interface</span><span class="op" id="1941158">{</span><span class="op" id="1941159">}</span>&nbsp;<span class="op" id="1941161">{</span>&nbsp;<span class="keyword" id="1941163">return</span>&nbsp;<span class="builtinfunc" id="1941170">new</span><span class="op" id="1941173">(</span><span class="ident" id="1941174">ss</span><span class="op" id="1941176">)</span>&nbsp;<span class="op" id="1941178">}</span><span class="op" id="1941179">,</span><br>
<span class="lineno"></span><span class="op" id="1941181">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1941184">//&nbsp;newScanState&nbsp;allocates&nbsp;a&nbsp;new&nbsp;ss&nbsp;struct&nbsp;or&nbsp;grab&nbsp;a&nbsp;cached&nbsp;one.</span><br>
<span class="lineno"></span><span class="keyword" id="1941248">func</span>&nbsp;<span class="ident" id="1941253">newScanState</span><span class="op" id="1941265">(</span><span class="ident" id="1941266">r</span>&nbsp;<span class="ident" id="1941268">io</span><span class="op" id="1941270">.</span><span class="ident" id="1941271">Reader</span><span class="op" id="1941277">,</span>&nbsp;<span class="ident" id="1941279">nlIsSpace</span><span class="op" id="1941288">,</span>&nbsp;<span class="ident" id="1941290">nlIsEnd</span>&nbsp;<span class="builtintype" id="1941298">bool</span><span class="op" id="1941302">)</span>&nbsp;<span class="op" id="1941304">(</span><span class="ident" id="1941305">s</span>&nbsp;<span class="op" id="1941307">*</span><span class="ident" id="1941308">ss</span><span class="op" id="1941310">,</span>&nbsp;<span class="ident" id="1941312">old</span>&nbsp;<span class="ident" id="1941316">ssave</span><span class="op" id="1941321">)</span>&nbsp;<span class="op" id="1941323">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1941326">//&nbsp;If&nbsp;the&nbsp;reader&nbsp;is&nbsp;a&nbsp;*ss,&nbsp;then&nbsp;we&#39;ve&nbsp;got&nbsp;a&nbsp;recursive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1941381">//&nbsp;call&nbsp;to&nbsp;Scan,&nbsp;so&nbsp;re-use&nbsp;the&nbsp;scan&nbsp;state.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1941425">s</span><span class="op" id="1941426">,</span>&nbsp;<span class="ident" id="1941428">ok</span>&nbsp;<span class="op" id="1941431">:=</span>&nbsp;<span class="ident" id="1941434">r</span><span class="op" id="1941435">.</span><span class="op" id="1941436">(</span><span class="op" id="1941437">*</span><span class="ident" id="1941438">ss</span><span class="op" id="1941440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1941443">if</span>&nbsp;<span class="ident" id="1941446">ok</span>&nbsp;<span class="op" id="1941449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1941453">old</span>&nbsp;<span class="op" id="1941457">=</span>&nbsp;<span class="ident" id="1941459">s</span><span class="op" id="1941460">.</span><span class="ident" id="1941461">ssave</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1941469">s</span><span class="op" id="1941470">.</span><span class="ident" id="1941471">limit</span>&nbsp;<span class="op" id="1941477">=</span>&nbsp;<span class="ident" id="1941479">s</span><span class="op" id="1941480">.</span><span class="ident" id="1941481">argLimit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1941492">s</span><span class="op" id="1941493">.</span><span class="ident" id="1941494">nlIsEnd</span>&nbsp;<span class="op" id="1941502">=</span>&nbsp;<span class="ident" id="1941504">nlIsEnd</span>&nbsp;<span class="op" id="1941512">||</span>&nbsp;<span class="ident" id="1941515">s</span><span class="op" id="1941516">.</span><span class="ident" id="1941517">nlIsEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1941527">s</span><span class="op" id="1941528">.</span><span class="ident" id="1941529">nlIsSpace</span>&nbsp;<span class="op" id="1941539">=</span>&nbsp;<span class="ident" id="1941541">nlIsSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1941553">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1941561">}</span><br>
<span class="lineno">400</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1941565">s</span>&nbsp;<span class="op" id="1941567">=</span>&nbsp;<span class="ident" id="1941569">ssFree</span><span class="op" id="1941575">.</span><span class="ident" id="1941576">Get</span><span class="op" id="1941579">(</span><span class="op" id="1941580">)</span><span class="op" id="1941581">.</span><span class="op" id="1941582">(</span><span class="op" id="1941583">*</span><span class="ident" id="1941584">ss</span><span class="op" id="1941586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1941589">if</span>&nbsp;<span class="ident" id="1941592">rr</span><span class="op" id="1941594">,</span>&nbsp;<span class="ident" id="1941596">ok</span>&nbsp;<span class="op" id="1941599">:=</span>&nbsp;<span class="ident" id="1941602">r</span><span class="op" id="1941603">.</span><span class="op" id="1941604">(</span><span class="ident" id="1941605">io</span><span class="op" id="1941607">.</span><span class="ident" id="1941608">RuneReader</span><span class="op" id="1941618">)</span><span class="op" id="1941619">;</span>&nbsp;<span class="ident" id="1941621">ok</span>&nbsp;<span class="op" id="1941624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1941628">s</span><span class="op" id="1941629">.</span><span class="ident" id="1941630">rr</span>&nbsp;<span class="op" id="1941633">=</span>&nbsp;<span class="ident" id="1941635">rr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1941639">}</span>&nbsp;<span class="keyword" id="1941641">else</span>&nbsp;<span class="op" id="1941646">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1941650">s</span><span class="op" id="1941651">.</span><span class="ident" id="1941652">rr</span>&nbsp;<span class="op" id="1941655">=</span>&nbsp;<span class="op" id="1941657">&amp;</span><span class="ident" id="1941658">readRune</span><span class="op" id="1941666">{</span><span class="ident" id="1941667">reader</span><span class="op" id="1941673">:</span>&nbsp;<span class="ident" id="1941675">r</span><span class="op" id="1941676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1941679">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1941682">s</span><span class="op" id="1941683">.</span><span class="ident" id="1941684">nlIsSpace</span>&nbsp;<span class="op" id="1941694">=</span>&nbsp;<span class="ident" id="1941696">nlIsSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1941707">s</span><span class="op" id="1941708">.</span><span class="ident" id="1941709">nlIsEnd</span>&nbsp;<span class="op" id="1941717">=</span>&nbsp;<span class="ident" id="1941719">nlIsEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1941728">s</span><span class="op" id="1941729">.</span><span class="ident" id="1941730">prevRune</span>&nbsp;<span class="op" id="1941739">=</span>&nbsp;<span class="op" id="1941741">-</span><span class="num" id="1941742">1</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1941745">s</span><span class="op" id="1941746">.</span><span class="ident" id="1941747">peekRune</span>&nbsp;<span class="op" id="1941756">=</span>&nbsp;<span class="op" id="1941758">-</span><span class="num" id="1941759">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1941762">s</span><span class="op" id="1941763">.</span><span class="ident" id="1941764">atEOF</span>&nbsp;<span class="op" id="1941770">=</span>&nbsp;<span class="ident" id="1941772">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1941779">s</span><span class="op" id="1941780">.</span><span class="ident" id="1941781">limit</span>&nbsp;<span class="op" id="1941787">=</span>&nbsp;<span class="ident" id="1941789">hugeWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1941798">s</span><span class="op" id="1941799">.</span><span class="ident" id="1941800">argLimit</span>&nbsp;<span class="op" id="1941809">=</span>&nbsp;<span class="ident" id="1941811">hugeWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1941820">s</span><span class="op" id="1941821">.</span><span class="ident" id="1941822">maxWid</span>&nbsp;<span class="op" id="1941829">=</span>&nbsp;<span class="ident" id="1941831">hugeWid</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1941840">s</span><span class="op" id="1941841">.</span><span class="ident" id="1941842">validSave</span>&nbsp;<span class="op" id="1941852">=</span>&nbsp;<span class="ident" id="1941854">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1941860">s</span><span class="op" id="1941861">.</span><span class="ident" id="1941862">count</span>&nbsp;<span class="op" id="1941868">=</span>&nbsp;<span class="num" id="1941870">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1941873">return</span><br>
<span class="lineno"></span><span class="op" id="1941880">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span><span class="comment" id="1941883">//&nbsp;free&nbsp;saves&nbsp;used&nbsp;ss&nbsp;structs&nbsp;in&nbsp;ssFree;&nbsp;avoid&nbsp;an&nbsp;allocation&nbsp;per&nbsp;invocation.</span><br>
<span class="lineno"></span><span class="keyword" id="1941960">func</span>&nbsp;<span class="op" id="1941965">(</span><span class="ident" id="1941966">s</span>&nbsp;<span class="op" id="1941968">*</span><span class="ident" id="1941969">ss</span><span class="op" id="1941971">)</span>&nbsp;<span class="ident" id="1941973">free</span><span class="op" id="1941977">(</span><span class="ident" id="1941978">old</span>&nbsp;<span class="ident" id="1941982">ssave</span><span class="op" id="1941987">)</span>&nbsp;<span class="op" id="1941989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1941992">//&nbsp;If&nbsp;it&nbsp;was&nbsp;used&nbsp;recursively,&nbsp;just&nbsp;restore&nbsp;the&nbsp;old&nbsp;state.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1942052">if</span>&nbsp;<span class="ident" id="1942055">old</span><span class="op" id="1942058">.</span><span class="ident" id="1942059">validSave</span>&nbsp;<span class="op" id="1942069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1942073">s</span><span class="op" id="1942074">.</span><span class="ident" id="1942075">ssave</span>&nbsp;<span class="op" id="1942081">=</span>&nbsp;<span class="ident" id="1942083">old</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1942089">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1942097">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1942100">//&nbsp;Don&#39;t&nbsp;hold&nbsp;on&nbsp;to&nbsp;ss&nbsp;structs&nbsp;with&nbsp;large&nbsp;buffers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1942152">if</span>&nbsp;<span class="builtinfunc" id="1942155">cap</span><span class="op" id="1942158">(</span><span class="ident" id="1942159">s</span><span class="op" id="1942160">.</span><span class="ident" id="1942161">buf</span><span class="op" id="1942164">)</span>&nbsp;<span class="op" id="1942166">&gt;</span>&nbsp;<span class="num" id="1942168">1024</span>&nbsp;<span class="op" id="1942173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1942177">return</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1942185">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1942188">s</span><span class="op" id="1942189">.</span><span class="ident" id="1942190">buf</span>&nbsp;<span class="op" id="1942194">=</span>&nbsp;<span class="ident" id="1942196">s</span><span class="op" id="1942197">.</span><span class="ident" id="1942198">buf</span><span class="op" id="1942201">[</span><span class="op" id="1942202">:</span><span class="num" id="1942203">0</span><span class="op" id="1942204">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1942207">s</span><span class="op" id="1942208">.</span><span class="ident" id="1942209">rr</span>&nbsp;<span class="op" id="1942212">=</span>&nbsp;<span class="ident" id="1942214">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1942219">ssFree</span><span class="op" id="1942225">.</span><span class="ident" id="1942226">Put</span><span class="op" id="1942229">(</span><span class="ident" id="1942230">s</span><span class="op" id="1942231">)</span><br>
<span class="lineno"></span><span class="op" id="1942233">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="comment" id="1942236">//&nbsp;skipSpace&nbsp;skips&nbsp;spaces&nbsp;and&nbsp;maybe&nbsp;newlines.</span><br>
<span class="lineno"></span><span class="keyword" id="1942282">func</span>&nbsp;<span class="op" id="1942287">(</span><span class="ident" id="1942288">s</span>&nbsp;<span class="op" id="1942290">*</span><span class="ident" id="1942291">ss</span><span class="op" id="1942293">)</span>&nbsp;<span class="ident" id="1942295">skipSpace</span><span class="op" id="1942304">(</span><span class="ident" id="1942305">stopAtNewline</span>&nbsp;<span class="builtintype" id="1942319">bool</span><span class="op" id="1942323">)</span>&nbsp;<span class="op" id="1942325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1942328">for</span>&nbsp;<span class="op" id="1942332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1942336">r</span>&nbsp;<span class="op" id="1942338">:=</span>&nbsp;<span class="ident" id="1942341">s</span><span class="op" id="1942342">.</span><span class="ident" id="1942343">getRune</span><span class="op" id="1942350">(</span><span class="op" id="1942351">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1942355">if</span>&nbsp;<span class="ident" id="1942358">r</span>&nbsp;<span class="op" id="1942360">==</span>&nbsp;<span class="ident" id="1942363">eof</span>&nbsp;<span class="op" id="1942367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1942372">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1942381">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1942385">if</span>&nbsp;<span class="ident" id="1942388">r</span>&nbsp;<span class="op" id="1942390">==</span>&nbsp;<span class="string" id="1942393">&#39;\r&#39;</span>&nbsp;<span class="op" id="1942398">&amp;&amp;</span>&nbsp;<span class="ident" id="1942401">s</span><span class="op" id="1942402">.</span><span class="ident" id="1942403">peek</span><span class="op" id="1942407">(</span><span class="string" id="1942408">&#34;\n&#34;</span><span class="op" id="1942412">)</span>&nbsp;<span class="op" id="1942414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1942419">continue</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1942430">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1942434">if</span>&nbsp;<span class="ident" id="1942437">r</span>&nbsp;<span class="op" id="1942439">==</span>&nbsp;<span class="string" id="1942442">&#39;\n&#39;</span>&nbsp;<span class="op" id="1942447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1942452">if</span>&nbsp;<span class="ident" id="1942455">stopAtNewline</span>&nbsp;<span class="op" id="1942469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1942475">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1942484">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1942489">if</span>&nbsp;<span class="ident" id="1942492">s</span><span class="op" id="1942493">.</span><span class="ident" id="1942494">nlIsSpace</span>&nbsp;<span class="op" id="1942504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1942510">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1942522">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1942527">s</span><span class="op" id="1942528">.</span><span class="ident" id="1942529">errorString</span><span class="op" id="1942540">(</span><span class="string" id="1942541">&#34;unexpected&nbsp;newline&#34;</span><span class="op" id="1942561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1942566">return</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1942575">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1942579">if</span>&nbsp;<span class="op" id="1942582">!</span><span class="ident" id="1942583">isSpace</span><span class="op" id="1942590">(</span><span class="ident" id="1942591">r</span><span class="op" id="1942592">)</span>&nbsp;<span class="op" id="1942594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1942599">s</span><span class="op" id="1942600">.</span><span class="ident" id="1942601">UnreadRune</span><span class="op" id="1942611">(</span><span class="op" id="1942612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1942617">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1942625">}</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1942628">}</span><br>
<span class="lineno"></span><span class="op" id="1942630">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1942633">//&nbsp;token&nbsp;returns&nbsp;the&nbsp;next&nbsp;space-delimited&nbsp;string&nbsp;from&nbsp;the&nbsp;input.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="1942702">//&nbsp;skips&nbsp;white&nbsp;space.&nbsp;&nbsp;For&nbsp;Scanln,&nbsp;it&nbsp;stops&nbsp;at&nbsp;newlines.&nbsp;&nbsp;For&nbsp;Scan,</span><br>
<span class="lineno">465</span><span class="comment" id="1942770">//&nbsp;newlines&nbsp;are&nbsp;treated&nbsp;as&nbsp;spaces.</span><br>
<span class="lineno"></span><span class="keyword" id="1942805">func</span>&nbsp;<span class="op" id="1942810">(</span><span class="ident" id="1942811">s</span>&nbsp;<span class="op" id="1942813">*</span><span class="ident" id="1942814">ss</span><span class="op" id="1942816">)</span>&nbsp;<span class="ident" id="1942818">token</span><span class="op" id="1942823">(</span><span class="ident" id="1942824">skipSpace</span>&nbsp;<span class="builtintype" id="1942834">bool</span><span class="op" id="1942838">,</span>&nbsp;<span class="ident" id="1942840">f</span>&nbsp;<span class="keyword" id="1942842">func</span><span class="op" id="1942846">(</span><span class="builtintype" id="1942847">rune</span><span class="op" id="1942851">)</span>&nbsp;<span class="builtintype" id="1942853">bool</span><span class="op" id="1942857">)</span>&nbsp;<span class="op" id="1942859">[</span><span class="op" id="1942860">]</span><span class="builtintype" id="1942861">byte</span>&nbsp;<span class="op" id="1942866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1942869">if</span>&nbsp;<span class="ident" id="1942872">skipSpace</span>&nbsp;<span class="op" id="1942882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1942886">s</span><span class="op" id="1942887">.</span><span class="ident" id="1942888">skipSpace</span><span class="op" id="1942897">(</span><span class="ident" id="1942898">false</span><span class="op" id="1942903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1942906">}</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1942909">//&nbsp;read&nbsp;until&nbsp;white&nbsp;space&nbsp;or&nbsp;newline</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1942947">for</span>&nbsp;<span class="op" id="1942951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1942955">r</span>&nbsp;<span class="op" id="1942957">:=</span>&nbsp;<span class="ident" id="1942960">s</span><span class="op" id="1942961">.</span><span class="ident" id="1942962">getRune</span><span class="op" id="1942969">(</span><span class="op" id="1942970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1942974">if</span>&nbsp;<span class="ident" id="1942977">r</span>&nbsp;<span class="op" id="1942979">==</span>&nbsp;<span class="ident" id="1942982">eof</span>&nbsp;<span class="op" id="1942986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1942991">break</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1942999">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1943003">if</span>&nbsp;<span class="op" id="1943006">!</span><span class="ident" id="1943007">f</span><span class="op" id="1943008">(</span><span class="ident" id="1943009">r</span><span class="op" id="1943010">)</span>&nbsp;<span class="op" id="1943012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1943017">s</span><span class="op" id="1943018">.</span><span class="ident" id="1943019">UnreadRune</span><span class="op" id="1943029">(</span><span class="op" id="1943030">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1943035">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1943043">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1943047">s</span><span class="op" id="1943048">.</span><span class="ident" id="1943049">buf</span><span class="op" id="1943052">.</span><span class="ident" id="1943053">WriteRune</span><span class="op" id="1943062">(</span><span class="ident" id="1943063">r</span><span class="op" id="1943064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1943067">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1943070">return</span>&nbsp;<span class="ident" id="1943077">s</span><span class="op" id="1943078">.</span><span class="ident" id="1943079">buf</span><br>
<span class="lineno"></span><span class="op" id="1943083">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span><span class="keyword" id="1943086">var</span>&nbsp;<span class="ident" id="1943090">complexError</span>&nbsp;<span class="op" id="1943103">=</span>&nbsp;<span class="ident" id="1943105">errors</span><span class="op" id="1943111">.</span><span class="ident" id="1943112">New</span><span class="op" id="1943115">(</span><span class="string" id="1943116">&#34;syntax&nbsp;error&nbsp;scanning&nbsp;complex&nbsp;number&#34;</span><span class="op" id="1943154">)</span><br>
<span class="lineno"></span><span class="keyword" id="1943156">var</span>&nbsp;<span class="ident" id="1943160">boolError</span>&nbsp;<span class="op" id="1943170">=</span>&nbsp;<span class="ident" id="1943172">errors</span><span class="op" id="1943178">.</span><span class="ident" id="1943179">New</span><span class="op" id="1943182">(</span><span class="string" id="1943183">&#34;syntax&nbsp;error&nbsp;scanning&nbsp;boolean&#34;</span><span class="op" id="1943214">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1943217">func</span>&nbsp;<span class="ident" id="1943222">indexRune</span><span class="op" id="1943231">(</span><span class="ident" id="1943232">s</span>&nbsp;<span class="builtintype" id="1943234">string</span><span class="op" id="1943240">,</span>&nbsp;<span class="ident" id="1943242">r</span>&nbsp;<span class="builtintype" id="1943244">rune</span><span class="op" id="1943248">)</span>&nbsp;<span class="builtintype" id="1943250">int</span>&nbsp;<span class="op" id="1943254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1943257">for</span>&nbsp;<span class="ident" id="1943261">i</span><span class="op" id="1943262">,</span>&nbsp;<span class="ident" id="1943264">c</span>&nbsp;<span class="op" id="1943266">:=</span>&nbsp;<span class="keyword" id="1943269">range</span>&nbsp;<span class="ident" id="1943275">s</span>&nbsp;<span class="op" id="1943277">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1943281">if</span>&nbsp;<span class="ident" id="1943284">c</span>&nbsp;<span class="op" id="1943286">==</span>&nbsp;<span class="ident" id="1943289">r</span>&nbsp;<span class="op" id="1943291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1943296">return</span>&nbsp;<span class="ident" id="1943303">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1943307">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1943310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1943313">return</span>&nbsp;<span class="op" id="1943320">-</span><span class="num" id="1943321">1</span><br>
<span class="lineno">495</span><span class="op" id="1943323">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1943326">//&nbsp;consume&nbsp;reads&nbsp;the&nbsp;next&nbsp;rune&nbsp;in&nbsp;the&nbsp;input&nbsp;and&nbsp;reports&nbsp;whether&nbsp;it&nbsp;is&nbsp;in&nbsp;the&nbsp;ok&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="1943414">//&nbsp;If&nbsp;accept&nbsp;is&nbsp;true,&nbsp;it&nbsp;puts&nbsp;the&nbsp;character&nbsp;into&nbsp;the&nbsp;input&nbsp;token.</span><br>
<span class="lineno"></span><span class="keyword" id="1943480">func</span>&nbsp;<span class="op" id="1943485">(</span><span class="ident" id="1943486">s</span>&nbsp;<span class="op" id="1943488">*</span><span class="ident" id="1943489">ss</span><span class="op" id="1943491">)</span>&nbsp;<span class="ident" id="1943493">consume</span><span class="op" id="1943500">(</span><span class="ident" id="1943501">ok</span>&nbsp;<span class="builtintype" id="1943504">string</span><span class="op" id="1943510">,</span>&nbsp;<span class="ident" id="1943512">accept</span>&nbsp;<span class="builtintype" id="1943519">bool</span><span class="op" id="1943523">)</span>&nbsp;<span class="builtintype" id="1943525">bool</span>&nbsp;<span class="op" id="1943530">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1943533">r</span>&nbsp;<span class="op" id="1943535">:=</span>&nbsp;<span class="ident" id="1943538">s</span><span class="op" id="1943539">.</span><span class="ident" id="1943540">getRune</span><span class="op" id="1943547">(</span><span class="op" id="1943548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1943551">if</span>&nbsp;<span class="ident" id="1943554">r</span>&nbsp;<span class="op" id="1943556">==</span>&nbsp;<span class="ident" id="1943559">eof</span>&nbsp;<span class="op" id="1943563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1943567">return</span>&nbsp;<span class="ident" id="1943574">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1943581">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1943584">if</span>&nbsp;<span class="ident" id="1943587">indexRune</span><span class="op" id="1943596">(</span><span class="ident" id="1943597">ok</span><span class="op" id="1943599">,</span>&nbsp;<span class="ident" id="1943601">r</span><span class="op" id="1943602">)</span>&nbsp;<span class="op" id="1943604">&gt;=</span>&nbsp;<span class="num" id="1943607">0</span>&nbsp;<span class="op" id="1943609">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1943613">if</span>&nbsp;<span class="ident" id="1943616">accept</span>&nbsp;<span class="op" id="1943623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1943628">s</span><span class="op" id="1943629">.</span><span class="ident" id="1943630">buf</span><span class="op" id="1943633">.</span><span class="ident" id="1943634">WriteRune</span><span class="op" id="1943643">(</span><span class="ident" id="1943644">r</span><span class="op" id="1943645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1943649">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1943653">return</span>&nbsp;<span class="ident" id="1943660">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1943666">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1943669">if</span>&nbsp;<span class="ident" id="1943672">r</span>&nbsp;<span class="op" id="1943674">!=</span>&nbsp;<span class="ident" id="1943677">eof</span>&nbsp;<span class="op" id="1943681">&amp;&amp;</span>&nbsp;<span class="ident" id="1943684">accept</span>&nbsp;<span class="op" id="1943691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1943695">s</span><span class="op" id="1943696">.</span><span class="ident" id="1943697">UnreadRune</span><span class="op" id="1943707">(</span><span class="op" id="1943708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1943711">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1943714">return</span>&nbsp;<span class="ident" id="1943721">false</span><br>
<span class="lineno"></span><span class="op" id="1943727">}</span><br>
<span class="lineno">515</span><br>
<span class="lineno"></span><span class="comment" id="1943730">//&nbsp;peek&nbsp;reports&nbsp;whether&nbsp;the&nbsp;next&nbsp;character&nbsp;is&nbsp;in&nbsp;the&nbsp;ok&nbsp;string,&nbsp;without&nbsp;consuming&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="1943816">func</span>&nbsp;<span class="op" id="1943821">(</span><span class="ident" id="1943822">s</span>&nbsp;<span class="op" id="1943824">*</span><span class="ident" id="1943825">ss</span><span class="op" id="1943827">)</span>&nbsp;<span class="ident" id="1943829">peek</span><span class="op" id="1943833">(</span><span class="ident" id="1943834">ok</span>&nbsp;<span class="builtintype" id="1943837">string</span><span class="op" id="1943843">)</span>&nbsp;<span class="builtintype" id="1943845">bool</span>&nbsp;<span class="op" id="1943850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1943853">r</span>&nbsp;<span class="op" id="1943855">:=</span>&nbsp;<span class="ident" id="1943858">s</span><span class="op" id="1943859">.</span><span class="ident" id="1943860">getRune</span><span class="op" id="1943867">(</span><span class="op" id="1943868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1943871">if</span>&nbsp;<span class="ident" id="1943874">r</span>&nbsp;<span class="op" id="1943876">!=</span>&nbsp;<span class="ident" id="1943879">eof</span>&nbsp;<span class="op" id="1943883">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1943887">s</span><span class="op" id="1943888">.</span><span class="ident" id="1943889">UnreadRune</span><span class="op" id="1943899">(</span><span class="op" id="1943900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1943903">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1943906">return</span>&nbsp;<span class="ident" id="1943913">indexRune</span><span class="op" id="1943922">(</span><span class="ident" id="1943923">ok</span><span class="op" id="1943925">,</span>&nbsp;<span class="ident" id="1943927">r</span><span class="op" id="1943928">)</span>&nbsp;<span class="op" id="1943930">&gt;=</span>&nbsp;<span class="num" id="1943933">0</span><br>
<span class="lineno"></span><span class="op" id="1943935">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span><span class="keyword" id="1943938">func</span>&nbsp;<span class="op" id="1943943">(</span><span class="ident" id="1943944">s</span>&nbsp;<span class="op" id="1943946">*</span><span class="ident" id="1943947">ss</span><span class="op" id="1943949">)</span>&nbsp;<span class="ident" id="1943951">notEOF</span><span class="op" id="1943957">(</span><span class="op" id="1943958">)</span>&nbsp;<span class="op" id="1943960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1943963">//&nbsp;Guarantee&nbsp;there&nbsp;is&nbsp;data&nbsp;to&nbsp;be&nbsp;read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1944003">if</span>&nbsp;<span class="ident" id="1944006">r</span>&nbsp;<span class="op" id="1944008">:=</span>&nbsp;<span class="ident" id="1944011">s</span><span class="op" id="1944012">.</span><span class="ident" id="1944013">getRune</span><span class="op" id="1944020">(</span><span class="op" id="1944021">)</span><span class="op" id="1944022">;</span>&nbsp;<span class="ident" id="1944024">r</span>&nbsp;<span class="op" id="1944026">==</span>&nbsp;<span class="ident" id="1944029">eof</span>&nbsp;<span class="op" id="1944033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1944037">panic</span><span class="op" id="1944042">(</span><span class="ident" id="1944043">io</span><span class="op" id="1944045">.</span><span class="ident" id="1944046">EOF</span><span class="op" id="1944049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1944052">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1944055">s</span><span class="op" id="1944056">.</span><span class="ident" id="1944057">UnreadRune</span><span class="op" id="1944067">(</span><span class="op" id="1944068">)</span><br>
<span class="lineno"></span><span class="op" id="1944070">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1944073">//&nbsp;accept&nbsp;checks&nbsp;the&nbsp;next&nbsp;rune&nbsp;in&nbsp;the&nbsp;input.&nbsp;&nbsp;If&nbsp;it&#39;s&nbsp;a&nbsp;byte&nbsp;(sic)&nbsp;in&nbsp;the&nbsp;string,&nbsp;it&nbsp;puts&nbsp;it&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1944173">//&nbsp;buffer&nbsp;and&nbsp;returns&nbsp;true.&nbsp;Otherwise&nbsp;it&nbsp;return&nbsp;false.</span><br>
<span class="lineno">535</span><span class="keyword" id="1944228">func</span>&nbsp;<span class="op" id="1944233">(</span><span class="ident" id="1944234">s</span>&nbsp;<span class="op" id="1944236">*</span><span class="ident" id="1944237">ss</span><span class="op" id="1944239">)</span>&nbsp;<span class="ident" id="1944241">accept</span><span class="op" id="1944247">(</span><span class="ident" id="1944248">ok</span>&nbsp;<span class="builtintype" id="1944251">string</span><span class="op" id="1944257">)</span>&nbsp;<span class="builtintype" id="1944259">bool</span>&nbsp;<span class="op" id="1944264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1944267">return</span>&nbsp;<span class="ident" id="1944274">s</span><span class="op" id="1944275">.</span><span class="ident" id="1944276">consume</span><span class="op" id="1944283">(</span><span class="ident" id="1944284">ok</span><span class="op" id="1944286">,</span>&nbsp;<span class="ident" id="1944288">true</span><span class="op" id="1944292">)</span><br>
<span class="lineno"></span><span class="op" id="1944294">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1944297">//&nbsp;okVerb&nbsp;verifies&nbsp;that&nbsp;the&nbsp;verb&nbsp;is&nbsp;present&nbsp;in&nbsp;the&nbsp;list,&nbsp;setting&nbsp;s.err&nbsp;appropriately&nbsp;if&nbsp;not.</span><br>
<span class="lineno">540</span><span class="keyword" id="1944390">func</span>&nbsp;<span class="op" id="1944395">(</span><span class="ident" id="1944396">s</span>&nbsp;<span class="op" id="1944398">*</span><span class="ident" id="1944399">ss</span><span class="op" id="1944401">)</span>&nbsp;<span class="ident" id="1944403">okVerb</span><span class="op" id="1944409">(</span><span class="ident" id="1944410">verb</span>&nbsp;<span class="builtintype" id="1944415">rune</span><span class="op" id="1944419">,</span>&nbsp;<span class="ident" id="1944421">okVerbs</span><span class="op" id="1944428">,</span>&nbsp;<span class="ident" id="1944430">typ</span>&nbsp;<span class="builtintype" id="1944434">string</span><span class="op" id="1944440">)</span>&nbsp;<span class="builtintype" id="1944442">bool</span>&nbsp;<span class="op" id="1944447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1944450">for</span>&nbsp;<span class="ident" id="1944454">_</span><span class="op" id="1944455">,</span>&nbsp;<span class="ident" id="1944457">v</span>&nbsp;<span class="op" id="1944459">:=</span>&nbsp;<span class="keyword" id="1944462">range</span>&nbsp;<span class="ident" id="1944468">okVerbs</span>&nbsp;<span class="op" id="1944476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1944480">if</span>&nbsp;<span class="ident" id="1944483">v</span>&nbsp;<span class="op" id="1944485">==</span>&nbsp;<span class="ident" id="1944488">verb</span>&nbsp;<span class="op" id="1944493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1944498">return</span>&nbsp;<span class="ident" id="1944505">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1944512">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1944515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1944518">s</span><span class="op" id="1944519">.</span><span class="ident" id="1944520">errorString</span><span class="op" id="1944531">(</span><span class="string" id="1944532">&#34;bad&nbsp;verb&nbsp;%&#34;</span>&nbsp;<span class="op" id="1944545">+</span>&nbsp;<span class="builtintype" id="1944547">string</span><span class="op" id="1944553">(</span><span class="ident" id="1944554">verb</span><span class="op" id="1944558">)</span>&nbsp;<span class="op" id="1944560">+</span>&nbsp;<span class="string" id="1944562">&#34;&nbsp;for&nbsp;&#34;</span>&nbsp;<span class="op" id="1944570">+</span>&nbsp;<span class="ident" id="1944572">typ</span><span class="op" id="1944575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1944578">return</span>&nbsp;<span class="ident" id="1944585">false</span><br>
<span class="lineno"></span><span class="op" id="1944591">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">550</span><span class="comment" id="1944594">//&nbsp;scanBool&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;boolean&nbsp;represented&nbsp;by&nbsp;the&nbsp;next&nbsp;token.</span><br>
<span class="lineno"></span><span class="keyword" id="1944670">func</span>&nbsp;<span class="op" id="1944675">(</span><span class="ident" id="1944676">s</span>&nbsp;<span class="op" id="1944678">*</span><span class="ident" id="1944679">ss</span><span class="op" id="1944681">)</span>&nbsp;<span class="ident" id="1944683">scanBool</span><span class="op" id="1944691">(</span><span class="ident" id="1944692">verb</span>&nbsp;<span class="builtintype" id="1944697">rune</span><span class="op" id="1944701">)</span>&nbsp;<span class="builtintype" id="1944703">bool</span>&nbsp;<span class="op" id="1944708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1944711">s</span><span class="op" id="1944712">.</span><span class="ident" id="1944713">skipSpace</span><span class="op" id="1944722">(</span><span class="ident" id="1944723">false</span><span class="op" id="1944728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1944731">s</span><span class="op" id="1944732">.</span><span class="ident" id="1944733">notEOF</span><span class="op" id="1944739">(</span><span class="op" id="1944740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1944743">if</span>&nbsp;<span class="op" id="1944746">!</span><span class="ident" id="1944747">s</span><span class="op" id="1944748">.</span><span class="ident" id="1944749">okVerb</span><span class="op" id="1944755">(</span><span class="ident" id="1944756">verb</span><span class="op" id="1944760">,</span>&nbsp;<span class="string" id="1944762">&#34;tv&#34;</span><span class="op" id="1944766">,</span>&nbsp;<span class="string" id="1944768">&#34;boolean&#34;</span><span class="op" id="1944777">)</span>&nbsp;<span class="op" id="1944779">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1944783">return</span>&nbsp;<span class="ident" id="1944790">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1944797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1944800">//&nbsp;Syntax-checking&nbsp;a&nbsp;boolean&nbsp;is&nbsp;annoying.&nbsp;&nbsp;We&#39;re&nbsp;not&nbsp;fastidious&nbsp;about&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1944877">switch</span>&nbsp;<span class="ident" id="1944884">s</span><span class="op" id="1944885">.</span><span class="ident" id="1944886">getRune</span><span class="op" id="1944893">(</span><span class="op" id="1944894">)</span>&nbsp;<span class="op" id="1944896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1944899">case</span>&nbsp;<span class="string" id="1944904">&#39;0&#39;</span><span class="op" id="1944907">:</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1944911">return</span>&nbsp;<span class="ident" id="1944918">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1944925">case</span>&nbsp;<span class="string" id="1944930">&#39;1&#39;</span><span class="op" id="1944933">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1944937">return</span>&nbsp;<span class="ident" id="1944944">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1944950">case</span>&nbsp;<span class="string" id="1944955">&#39;t&#39;</span><span class="op" id="1944958">,</span>&nbsp;<span class="string" id="1944960">&#39;T&#39;</span><span class="op" id="1944963">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1944967">if</span>&nbsp;<span class="ident" id="1944970">s</span><span class="op" id="1944971">.</span><span class="ident" id="1944972">accept</span><span class="op" id="1944978">(</span><span class="string" id="1944979">&#34;rR&#34;</span><span class="op" id="1944983">)</span>&nbsp;<span class="op" id="1944985">&amp;&amp;</span>&nbsp;<span class="op" id="1944988">(</span><span class="op" id="1944989">!</span><span class="ident" id="1944990">s</span><span class="op" id="1944991">.</span><span class="ident" id="1944992">accept</span><span class="op" id="1944998">(</span><span class="string" id="1944999">&#34;uU&#34;</span><span class="op" id="1945003">)</span>&nbsp;<span class="op" id="1945005">||</span>&nbsp;<span class="op" id="1945008">!</span><span class="ident" id="1945009">s</span><span class="op" id="1945010">.</span><span class="ident" id="1945011">accept</span><span class="op" id="1945017">(</span><span class="string" id="1945018">&#34;eE&#34;</span><span class="op" id="1945022">)</span><span class="op" id="1945023">)</span>&nbsp;<span class="op" id="1945025">{</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1945030">s</span><span class="op" id="1945031">.</span><span class="builtintype" id="1945032">error</span><span class="op" id="1945037">(</span><span class="ident" id="1945038">boolError</span><span class="op" id="1945047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1945051">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1945055">return</span>&nbsp;<span class="ident" id="1945062">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1945068">case</span>&nbsp;<span class="string" id="1945073">&#39;f&#39;</span><span class="op" id="1945076">,</span>&nbsp;<span class="string" id="1945078">&#39;F&#39;</span><span class="op" id="1945081">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1945085">if</span>&nbsp;<span class="ident" id="1945088">s</span><span class="op" id="1945089">.</span><span class="ident" id="1945090">accept</span><span class="op" id="1945096">(</span><span class="string" id="1945097">&#34;aA&#34;</span><span class="op" id="1945101">)</span>&nbsp;<span class="op" id="1945103">&amp;&amp;</span>&nbsp;<span class="op" id="1945106">(</span><span class="op" id="1945107">!</span><span class="ident" id="1945108">s</span><span class="op" id="1945109">.</span><span class="ident" id="1945110">accept</span><span class="op" id="1945116">(</span><span class="string" id="1945117">&#34;lL&#34;</span><span class="op" id="1945121">)</span>&nbsp;<span class="op" id="1945123">||</span>&nbsp;<span class="op" id="1945126">!</span><span class="ident" id="1945127">s</span><span class="op" id="1945128">.</span><span class="ident" id="1945129">accept</span><span class="op" id="1945135">(</span><span class="string" id="1945136">&#34;sS&#34;</span><span class="op" id="1945140">)</span>&nbsp;<span class="op" id="1945142">||</span>&nbsp;<span class="op" id="1945145">!</span><span class="ident" id="1945146">s</span><span class="op" id="1945147">.</span><span class="ident" id="1945148">accept</span><span class="op" id="1945154">(</span><span class="string" id="1945155">&#34;eE&#34;</span><span class="op" id="1945159">)</span><span class="op" id="1945160">)</span>&nbsp;<span class="op" id="1945162">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1945167">s</span><span class="op" id="1945168">.</span><span class="builtintype" id="1945169">error</span><span class="op" id="1945174">(</span><span class="ident" id="1945175">boolError</span><span class="op" id="1945184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1945188">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1945192">return</span>&nbsp;<span class="ident" id="1945199">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1945206">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1945209">return</span>&nbsp;<span class="ident" id="1945216">false</span><br>
<span class="lineno">575</span><span class="op" id="1945222">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1945225">//&nbsp;Numerical&nbsp;elements</span><br>
<span class="lineno"></span><span class="keyword" id="1945247">const</span>&nbsp;<span class="op" id="1945253">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1945256">binaryDigits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1945274">=</span>&nbsp;<span class="string" id="1945276">&#34;01&#34;</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1945282">octalDigits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1945300">=</span>&nbsp;<span class="string" id="1945302">&#34;01234567&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1945314">decimalDigits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1945332">=</span>&nbsp;<span class="string" id="1945334">&#34;0123456789&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1945348">hexadecimalDigits</span>&nbsp;<span class="op" id="1945366">=</span>&nbsp;<span class="string" id="1945368">&#34;0123456789aAbBcCdDeEfF&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1945394">sign</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1945412">=</span>&nbsp;<span class="string" id="1945414">&#34;+-&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1945420">period</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1945438">=</span>&nbsp;<span class="string" id="1945440">&#34;.&#34;</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1945445">exponent</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1945463">=</span>&nbsp;<span class="string" id="1945465">&#34;eEp&#34;</span><br>
<span class="lineno"></span><span class="op" id="1945471">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1945474">//&nbsp;getBase&nbsp;returns&nbsp;the&nbsp;numeric&nbsp;base&nbsp;represented&nbsp;by&nbsp;the&nbsp;verb&nbsp;and&nbsp;its&nbsp;digit&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="1945556">func</span>&nbsp;<span class="op" id="1945561">(</span><span class="ident" id="1945562">s</span>&nbsp;<span class="op" id="1945564">*</span><span class="ident" id="1945565">ss</span><span class="op" id="1945567">)</span>&nbsp;<span class="ident" id="1945569">getBase</span><span class="op" id="1945576">(</span><span class="ident" id="1945577">verb</span>&nbsp;<span class="builtintype" id="1945582">rune</span><span class="op" id="1945586">)</span>&nbsp;<span class="op" id="1945588">(</span><span class="ident" id="1945589">base</span>&nbsp;<span class="builtintype" id="1945594">int</span><span class="op" id="1945597">,</span>&nbsp;<span class="ident" id="1945599">digits</span>&nbsp;<span class="builtintype" id="1945606">string</span><span class="op" id="1945612">)</span>&nbsp;<span class="op" id="1945614">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1945617">s</span><span class="op" id="1945618">.</span><span class="ident" id="1945619">okVerb</span><span class="op" id="1945625">(</span><span class="ident" id="1945626">verb</span><span class="op" id="1945630">,</span>&nbsp;<span class="string" id="1945632">&#34;bdoUxXv&#34;</span><span class="op" id="1945641">,</span>&nbsp;<span class="string" id="1945643">&#34;integer&#34;</span><span class="op" id="1945652">)</span>&nbsp;<span class="comment" id="1945654">//&nbsp;sets&nbsp;s.err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1945669">base</span>&nbsp;<span class="op" id="1945674">=</span>&nbsp;<span class="num" id="1945676">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1945680">digits</span>&nbsp;<span class="op" id="1945687">=</span>&nbsp;<span class="ident" id="1945689">decimalDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1945704">switch</span>&nbsp;<span class="ident" id="1945711">verb</span>&nbsp;<span class="op" id="1945716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1945719">case</span>&nbsp;<span class="string" id="1945724">&#39;b&#39;</span><span class="op" id="1945727">:</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1945731">base</span>&nbsp;<span class="op" id="1945736">=</span>&nbsp;<span class="num" id="1945738">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1945742">digits</span>&nbsp;<span class="op" id="1945749">=</span>&nbsp;<span class="ident" id="1945751">binaryDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1945765">case</span>&nbsp;<span class="string" id="1945770">&#39;o&#39;</span><span class="op" id="1945773">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1945777">base</span>&nbsp;<span class="op" id="1945782">=</span>&nbsp;<span class="num" id="1945784">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1945788">digits</span>&nbsp;<span class="op" id="1945795">=</span>&nbsp;<span class="ident" id="1945797">octalDigits</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1945810">case</span>&nbsp;<span class="string" id="1945815">&#39;x&#39;</span><span class="op" id="1945818">,</span>&nbsp;<span class="string" id="1945820">&#39;X&#39;</span><span class="op" id="1945823">,</span>&nbsp;<span class="string" id="1945825">&#39;U&#39;</span><span class="op" id="1945828">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1945832">base</span>&nbsp;<span class="op" id="1945837">=</span>&nbsp;<span class="num" id="1945839">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1945844">digits</span>&nbsp;<span class="op" id="1945851">=</span>&nbsp;<span class="ident" id="1945853">hexadecimalDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1945872">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1945875">return</span><br>
<span class="lineno">605</span><span class="op" id="1945882">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1945885">//&nbsp;scanNumber&nbsp;returns&nbsp;the&nbsp;numerical&nbsp;string&nbsp;with&nbsp;specified&nbsp;digits&nbsp;starting&nbsp;here.</span><br>
<span class="lineno"></span><span class="keyword" id="1945965">func</span>&nbsp;<span class="op" id="1945970">(</span><span class="ident" id="1945971">s</span>&nbsp;<span class="op" id="1945973">*</span><span class="ident" id="1945974">ss</span><span class="op" id="1945976">)</span>&nbsp;<span class="ident" id="1945978">scanNumber</span><span class="op" id="1945988">(</span><span class="ident" id="1945989">digits</span>&nbsp;<span class="builtintype" id="1945996">string</span><span class="op" id="1946002">,</span>&nbsp;<span class="ident" id="1946004">haveDigits</span>&nbsp;<span class="builtintype" id="1946015">bool</span><span class="op" id="1946019">)</span>&nbsp;<span class="builtintype" id="1946021">string</span>&nbsp;<span class="op" id="1946028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1946031">if</span>&nbsp;<span class="op" id="1946034">!</span><span class="ident" id="1946035">haveDigits</span>&nbsp;<span class="op" id="1946046">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1946050">s</span><span class="op" id="1946051">.</span><span class="ident" id="1946052">notEOF</span><span class="op" id="1946058">(</span><span class="op" id="1946059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1946063">if</span>&nbsp;<span class="op" id="1946066">!</span><span class="ident" id="1946067">s</span><span class="op" id="1946068">.</span><span class="ident" id="1946069">accept</span><span class="op" id="1946075">(</span><span class="ident" id="1946076">digits</span><span class="op" id="1946082">)</span>&nbsp;<span class="op" id="1946084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1946089">s</span><span class="op" id="1946090">.</span><span class="ident" id="1946091">errorString</span><span class="op" id="1946102">(</span><span class="string" id="1946103">&#34;expected&nbsp;integer&#34;</span><span class="op" id="1946121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1946125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1946128">}</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1946131">for</span>&nbsp;<span class="ident" id="1946135">s</span><span class="op" id="1946136">.</span><span class="ident" id="1946137">accept</span><span class="op" id="1946143">(</span><span class="ident" id="1946144">digits</span><span class="op" id="1946150">)</span>&nbsp;<span class="op" id="1946152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1946155">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1946158">return</span>&nbsp;<span class="builtintype" id="1946165">string</span><span class="op" id="1946171">(</span><span class="ident" id="1946172">s</span><span class="op" id="1946173">.</span><span class="ident" id="1946174">buf</span><span class="op" id="1946177">)</span><br>
<span class="lineno"></span><span class="op" id="1946179">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">620</span><span class="comment" id="1946182">//&nbsp;scanRune&nbsp;returns&nbsp;the&nbsp;next&nbsp;rune&nbsp;value&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="keyword" id="1946236">func</span>&nbsp;<span class="op" id="1946241">(</span><span class="ident" id="1946242">s</span>&nbsp;<span class="op" id="1946244">*</span><span class="ident" id="1946245">ss</span><span class="op" id="1946247">)</span>&nbsp;<span class="ident" id="1946249">scanRune</span><span class="op" id="1946257">(</span><span class="ident" id="1946258">bitSize</span>&nbsp;<span class="builtintype" id="1946266">int</span><span class="op" id="1946269">)</span>&nbsp;<span class="ident" id="1946271">int64</span>&nbsp;<span class="op" id="1946277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1946280">s</span><span class="op" id="1946281">.</span><span class="ident" id="1946282">notEOF</span><span class="op" id="1946288">(</span><span class="op" id="1946289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1946292">r</span>&nbsp;<span class="op" id="1946294">:=</span>&nbsp;<span class="ident" id="1946297">int64</span><span class="op" id="1946302">(</span><span class="ident" id="1946303">s</span><span class="op" id="1946304">.</span><span class="ident" id="1946305">getRune</span><span class="op" id="1946312">(</span><span class="op" id="1946313">)</span><span class="op" id="1946314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1946317">n</span>&nbsp;<span class="op" id="1946319">:=</span>&nbsp;<span class="builtintype" id="1946322">uint</span><span class="op" id="1946326">(</span><span class="ident" id="1946327">bitSize</span><span class="op" id="1946334">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1946337">x</span>&nbsp;<span class="op" id="1946339">:=</span>&nbsp;<span class="op" id="1946342">(</span><span class="ident" id="1946343">r</span>&nbsp;<span class="op" id="1946345">&lt;&lt;</span>&nbsp;<span class="op" id="1946348">(</span><span class="num" id="1946349">64</span>&nbsp;<span class="op" id="1946352">-</span>&nbsp;<span class="ident" id="1946354">n</span><span class="op" id="1946355">)</span><span class="op" id="1946356">)</span>&nbsp;<span class="op" id="1946358">&gt;&gt;</span>&nbsp;<span class="op" id="1946361">(</span><span class="num" id="1946362">64</span>&nbsp;<span class="op" id="1946365">-</span>&nbsp;<span class="ident" id="1946367">n</span><span class="op" id="1946368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1946371">if</span>&nbsp;<span class="ident" id="1946374">x</span>&nbsp;<span class="op" id="1946376">!=</span>&nbsp;<span class="ident" id="1946379">r</span>&nbsp;<span class="op" id="1946381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1946385">s</span><span class="op" id="1946386">.</span><span class="ident" id="1946387">errorString</span><span class="op" id="1946398">(</span><span class="string" id="1946399">&#34;overflow&nbsp;on&nbsp;character&nbsp;value&nbsp;&#34;</span>&nbsp;<span class="op" id="1946430">+</span>&nbsp;<span class="builtintype" id="1946432">string</span><span class="op" id="1946438">(</span><span class="ident" id="1946439">r</span><span class="op" id="1946440">)</span><span class="op" id="1946441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1946444">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1946447">return</span>&nbsp;<span class="ident" id="1946454">r</span><br>
<span class="lineno">630</span><span class="op" id="1946456">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1946459">//&nbsp;scanBasePrefix&nbsp;reports&nbsp;whether&nbsp;the&nbsp;integer&nbsp;begins&nbsp;with&nbsp;a&nbsp;0&nbsp;or&nbsp;0x,</span><br>
<span class="lineno"></span><span class="comment" id="1946528">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;base,&nbsp;digit&nbsp;string,&nbsp;and&nbsp;whether&nbsp;a&nbsp;zero&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span><span class="comment" id="1946597">//&nbsp;It&nbsp;is&nbsp;called&nbsp;only&nbsp;if&nbsp;the&nbsp;verb&nbsp;is&nbsp;%v.</span><br>
<span class="lineno">635</span><span class="keyword" id="1946637">func</span>&nbsp;<span class="op" id="1946642">(</span><span class="ident" id="1946643">s</span>&nbsp;<span class="op" id="1946645">*</span><span class="ident" id="1946646">ss</span><span class="op" id="1946648">)</span>&nbsp;<span class="ident" id="1946650">scanBasePrefix</span><span class="op" id="1946664">(</span><span class="op" id="1946665">)</span>&nbsp;<span class="op" id="1946667">(</span><span class="ident" id="1946668">base</span>&nbsp;<span class="builtintype" id="1946673">int</span><span class="op" id="1946676">,</span>&nbsp;<span class="ident" id="1946678">digits</span>&nbsp;<span class="builtintype" id="1946685">string</span><span class="op" id="1946691">,</span>&nbsp;<span class="ident" id="1946693">found</span>&nbsp;<span class="builtintype" id="1946699">bool</span><span class="op" id="1946703">)</span>&nbsp;<span class="op" id="1946705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1946708">if</span>&nbsp;<span class="op" id="1946711">!</span><span class="ident" id="1946712">s</span><span class="op" id="1946713">.</span><span class="ident" id="1946714">peek</span><span class="op" id="1946718">(</span><span class="string" id="1946719">&#34;0&#34;</span><span class="op" id="1946722">)</span>&nbsp;<span class="op" id="1946724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1946728">return</span>&nbsp;<span class="num" id="1946735">10</span><span class="op" id="1946737">,</span>&nbsp;<span class="ident" id="1946739">decimalDigits</span><span class="op" id="1946752">,</span>&nbsp;<span class="ident" id="1946754">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1946761">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1946764">s</span><span class="op" id="1946765">.</span><span class="ident" id="1946766">accept</span><span class="op" id="1946772">(</span><span class="string" id="1946773">&#34;0&#34;</span><span class="op" id="1946776">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1946779">found</span>&nbsp;<span class="op" id="1946785">=</span>&nbsp;<span class="ident" id="1946787">true</span>&nbsp;<span class="comment" id="1946792">//&nbsp;We&#39;ve&nbsp;put&nbsp;a&nbsp;digit&nbsp;into&nbsp;the&nbsp;token&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1946837">//&nbsp;Special&nbsp;cases&nbsp;for&nbsp;&#39;0&#39;&nbsp;&amp;&amp;&nbsp;&#39;0x&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1946871">base</span><span class="op" id="1946875">,</span>&nbsp;<span class="ident" id="1946877">digits</span>&nbsp;<span class="op" id="1946884">=</span>&nbsp;<span class="num" id="1946886">8</span><span class="op" id="1946887">,</span>&nbsp;<span class="ident" id="1946889">octalDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1946902">if</span>&nbsp;<span class="ident" id="1946905">s</span><span class="op" id="1946906">.</span><span class="ident" id="1946907">peek</span><span class="op" id="1946911">(</span><span class="string" id="1946912">&#34;xX&#34;</span><span class="op" id="1946916">)</span>&nbsp;<span class="op" id="1946918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1946922">s</span><span class="op" id="1946923">.</span><span class="ident" id="1946924">consume</span><span class="op" id="1946931">(</span><span class="string" id="1946932">&#34;xX&#34;</span><span class="op" id="1946936">,</span>&nbsp;<span class="ident" id="1946938">false</span><span class="op" id="1946943">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1946947">base</span><span class="op" id="1946951">,</span>&nbsp;<span class="ident" id="1946953">digits</span>&nbsp;<span class="op" id="1946960">=</span>&nbsp;<span class="num" id="1946962">16</span><span class="op" id="1946964">,</span>&nbsp;<span class="ident" id="1946966">hexadecimalDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1946985">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1946988">return</span><br>
<span class="lineno"></span><span class="op" id="1946995">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">650</span><span class="comment" id="1946998">//&nbsp;scanInt&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;integer&nbsp;represented&nbsp;by&nbsp;the&nbsp;next</span><br>
<span class="lineno"></span><span class="comment" id="1947066">//&nbsp;token,&nbsp;checking&nbsp;for&nbsp;overflow.&nbsp;&nbsp;Any&nbsp;error&nbsp;is&nbsp;stored&nbsp;in&nbsp;s.err.</span><br>
<span class="lineno"></span><span class="keyword" id="1947130">func</span>&nbsp;<span class="op" id="1947135">(</span><span class="ident" id="1947136">s</span>&nbsp;<span class="op" id="1947138">*</span><span class="ident" id="1947139">ss</span><span class="op" id="1947141">)</span>&nbsp;<span class="ident" id="1947143">scanInt</span><span class="op" id="1947150">(</span><span class="ident" id="1947151">verb</span>&nbsp;<span class="builtintype" id="1947156">rune</span><span class="op" id="1947160">,</span>&nbsp;<span class="ident" id="1947162">bitSize</span>&nbsp;<span class="builtintype" id="1947170">int</span><span class="op" id="1947173">)</span>&nbsp;<span class="ident" id="1947175">int64</span>&nbsp;<span class="op" id="1947181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1947184">if</span>&nbsp;<span class="ident" id="1947187">verb</span>&nbsp;<span class="op" id="1947192">==</span>&nbsp;<span class="string" id="1947195">&#39;c&#39;</span>&nbsp;<span class="op" id="1947199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1947203">return</span>&nbsp;<span class="ident" id="1947210">s</span><span class="op" id="1947211">.</span><span class="ident" id="1947212">scanRune</span><span class="op" id="1947220">(</span><span class="ident" id="1947221">bitSize</span><span class="op" id="1947228">)</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1947231">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1947234">s</span><span class="op" id="1947235">.</span><span class="ident" id="1947236">skipSpace</span><span class="op" id="1947245">(</span><span class="ident" id="1947246">false</span><span class="op" id="1947251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1947254">s</span><span class="op" id="1947255">.</span><span class="ident" id="1947256">notEOF</span><span class="op" id="1947262">(</span><span class="op" id="1947263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1947266">base</span><span class="op" id="1947270">,</span>&nbsp;<span class="ident" id="1947272">digits</span>&nbsp;<span class="op" id="1947279">:=</span>&nbsp;<span class="ident" id="1947282">s</span><span class="op" id="1947283">.</span><span class="ident" id="1947284">getBase</span><span class="op" id="1947291">(</span><span class="ident" id="1947292">verb</span><span class="op" id="1947296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1947299">haveDigits</span>&nbsp;<span class="op" id="1947310">:=</span>&nbsp;<span class="ident" id="1947313">false</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1947320">if</span>&nbsp;<span class="ident" id="1947323">verb</span>&nbsp;<span class="op" id="1947328">==</span>&nbsp;<span class="string" id="1947331">&#39;U&#39;</span>&nbsp;<span class="op" id="1947335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1947339">if</span>&nbsp;<span class="op" id="1947342">!</span><span class="ident" id="1947343">s</span><span class="op" id="1947344">.</span><span class="ident" id="1947345">consume</span><span class="op" id="1947352">(</span><span class="string" id="1947353">&#34;U&#34;</span><span class="op" id="1947356">,</span>&nbsp;<span class="ident" id="1947358">false</span><span class="op" id="1947363">)</span>&nbsp;<span class="op" id="1947365">||</span>&nbsp;<span class="op" id="1947368">!</span><span class="ident" id="1947369">s</span><span class="op" id="1947370">.</span><span class="ident" id="1947371">consume</span><span class="op" id="1947378">(</span><span class="string" id="1947379">&#34;+&#34;</span><span class="op" id="1947382">,</span>&nbsp;<span class="ident" id="1947384">false</span><span class="op" id="1947389">)</span>&nbsp;<span class="op" id="1947391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1947396">s</span><span class="op" id="1947397">.</span><span class="ident" id="1947398">errorString</span><span class="op" id="1947409">(</span><span class="string" id="1947410">&#34;bad&nbsp;unicode&nbsp;format&nbsp;&#34;</span><span class="op" id="1947431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1947435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1947438">}</span>&nbsp;<span class="keyword" id="1947440">else</span>&nbsp;<span class="op" id="1947445">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1947449">s</span><span class="op" id="1947450">.</span><span class="ident" id="1947451">accept</span><span class="op" id="1947457">(</span><span class="ident" id="1947458">sign</span><span class="op" id="1947462">)</span>&nbsp;<span class="comment" id="1947464">//&nbsp;If&nbsp;there&#39;s&nbsp;a&nbsp;sign,&nbsp;it&nbsp;will&nbsp;be&nbsp;left&nbsp;in&nbsp;the&nbsp;token&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1947525">if</span>&nbsp;<span class="ident" id="1947528">verb</span>&nbsp;<span class="op" id="1947533">==</span>&nbsp;<span class="string" id="1947536">&#39;v&#39;</span>&nbsp;<span class="op" id="1947540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1947545">base</span><span class="op" id="1947549">,</span>&nbsp;<span class="ident" id="1947551">digits</span><span class="op" id="1947557">,</span>&nbsp;<span class="ident" id="1947559">haveDigits</span>&nbsp;<span class="op" id="1947570">=</span>&nbsp;<span class="ident" id="1947572">s</span><span class="op" id="1947573">.</span><span class="ident" id="1947574">scanBasePrefix</span><span class="op" id="1947588">(</span><span class="op" id="1947589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1947593">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1947596">}</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1947599">tok</span>&nbsp;<span class="op" id="1947603">:=</span>&nbsp;<span class="ident" id="1947606">s</span><span class="op" id="1947607">.</span><span class="ident" id="1947608">scanNumber</span><span class="op" id="1947618">(</span><span class="ident" id="1947619">digits</span><span class="op" id="1947625">,</span>&nbsp;<span class="ident" id="1947627">haveDigits</span><span class="op" id="1947637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1947640">i</span><span class="op" id="1947641">,</span>&nbsp;<span class="ident" id="1947643">err</span>&nbsp;<span class="op" id="1947647">:=</span>&nbsp;<span class="ident" id="1947650">strconv</span><span class="op" id="1947657">.</span><span class="ident" id="1947658">ParseInt</span><span class="op" id="1947666">(</span><span class="ident" id="1947667">tok</span><span class="op" id="1947670">,</span>&nbsp;<span class="ident" id="1947672">base</span><span class="op" id="1947676">,</span>&nbsp;<span class="num" id="1947678">64</span><span class="op" id="1947680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1947683">if</span>&nbsp;<span class="ident" id="1947686">err</span>&nbsp;<span class="op" id="1947690">!=</span>&nbsp;<span class="ident" id="1947693">nil</span>&nbsp;<span class="op" id="1947697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1947701">s</span><span class="op" id="1947702">.</span><span class="builtintype" id="1947703">error</span><span class="op" id="1947708">(</span><span class="ident" id="1947709">err</span><span class="op" id="1947712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1947715">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1947718">n</span>&nbsp;<span class="op" id="1947720">:=</span>&nbsp;<span class="builtintype" id="1947723">uint</span><span class="op" id="1947727">(</span><span class="ident" id="1947728">bitSize</span><span class="op" id="1947735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1947738">x</span>&nbsp;<span class="op" id="1947740">:=</span>&nbsp;<span class="op" id="1947743">(</span><span class="ident" id="1947744">i</span>&nbsp;<span class="op" id="1947746">&lt;&lt;</span>&nbsp;<span class="op" id="1947749">(</span><span class="num" id="1947750">64</span>&nbsp;<span class="op" id="1947753">-</span>&nbsp;<span class="ident" id="1947755">n</span><span class="op" id="1947756">)</span><span class="op" id="1947757">)</span>&nbsp;<span class="op" id="1947759">&gt;&gt;</span>&nbsp;<span class="op" id="1947762">(</span><span class="num" id="1947763">64</span>&nbsp;<span class="op" id="1947766">-</span>&nbsp;<span class="ident" id="1947768">n</span><span class="op" id="1947769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1947772">if</span>&nbsp;<span class="ident" id="1947775">x</span>&nbsp;<span class="op" id="1947777">!=</span>&nbsp;<span class="ident" id="1947780">i</span>&nbsp;<span class="op" id="1947782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1947786">s</span><span class="op" id="1947787">.</span><span class="ident" id="1947788">errorString</span><span class="op" id="1947799">(</span><span class="string" id="1947800">&#34;integer&nbsp;overflow&nbsp;on&nbsp;token&nbsp;&#34;</span>&nbsp;<span class="op" id="1947829">+</span>&nbsp;<span class="ident" id="1947831">tok</span><span class="op" id="1947834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1947837">}</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1947840">return</span>&nbsp;<span class="ident" id="1947847">i</span><br>
<span class="lineno"></span><span class="op" id="1947849">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1947852">//&nbsp;scanUint&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;unsigned&nbsp;integer&nbsp;represented</span><br>
<span class="lineno"></span><span class="comment" id="1947918">//&nbsp;by&nbsp;the&nbsp;next&nbsp;token,&nbsp;checking&nbsp;for&nbsp;overflow.&nbsp;&nbsp;Any&nbsp;error&nbsp;is&nbsp;stored&nbsp;in&nbsp;s.err.</span><br>
<span class="lineno">685</span><span class="keyword" id="1947994">func</span>&nbsp;<span class="op" id="1947999">(</span><span class="ident" id="1948000">s</span>&nbsp;<span class="op" id="1948002">*</span><span class="ident" id="1948003">ss</span><span class="op" id="1948005">)</span>&nbsp;<span class="ident" id="1948007">scanUint</span><span class="op" id="1948015">(</span><span class="ident" id="1948016">verb</span>&nbsp;<span class="builtintype" id="1948021">rune</span><span class="op" id="1948025">,</span>&nbsp;<span class="ident" id="1948027">bitSize</span>&nbsp;<span class="builtintype" id="1948035">int</span><span class="op" id="1948038">)</span>&nbsp;<span class="ident" id="1948040">uint64</span>&nbsp;<span class="op" id="1948047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1948050">if</span>&nbsp;<span class="ident" id="1948053">verb</span>&nbsp;<span class="op" id="1948058">==</span>&nbsp;<span class="string" id="1948061">&#39;c&#39;</span>&nbsp;<span class="op" id="1948065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1948069">return</span>&nbsp;<span class="ident" id="1948076">uint64</span><span class="op" id="1948082">(</span><span class="ident" id="1948083">s</span><span class="op" id="1948084">.</span><span class="ident" id="1948085">scanRune</span><span class="op" id="1948093">(</span><span class="ident" id="1948094">bitSize</span><span class="op" id="1948101">)</span><span class="op" id="1948102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1948105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1948108">s</span><span class="op" id="1948109">.</span><span class="ident" id="1948110">skipSpace</span><span class="op" id="1948119">(</span><span class="ident" id="1948120">false</span><span class="op" id="1948125">)</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1948128">s</span><span class="op" id="1948129">.</span><span class="ident" id="1948130">notEOF</span><span class="op" id="1948136">(</span><span class="op" id="1948137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1948140">base</span><span class="op" id="1948144">,</span>&nbsp;<span class="ident" id="1948146">digits</span>&nbsp;<span class="op" id="1948153">:=</span>&nbsp;<span class="ident" id="1948156">s</span><span class="op" id="1948157">.</span><span class="ident" id="1948158">getBase</span><span class="op" id="1948165">(</span><span class="ident" id="1948166">verb</span><span class="op" id="1948170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1948173">haveDigits</span>&nbsp;<span class="op" id="1948184">:=</span>&nbsp;<span class="ident" id="1948187">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1948194">if</span>&nbsp;<span class="ident" id="1948197">verb</span>&nbsp;<span class="op" id="1948202">==</span>&nbsp;<span class="string" id="1948205">&#39;U&#39;</span>&nbsp;<span class="op" id="1948209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1948213">if</span>&nbsp;<span class="op" id="1948216">!</span><span class="ident" id="1948217">s</span><span class="op" id="1948218">.</span><span class="ident" id="1948219">consume</span><span class="op" id="1948226">(</span><span class="string" id="1948227">&#34;U&#34;</span><span class="op" id="1948230">,</span>&nbsp;<span class="ident" id="1948232">false</span><span class="op" id="1948237">)</span>&nbsp;<span class="op" id="1948239">||</span>&nbsp;<span class="op" id="1948242">!</span><span class="ident" id="1948243">s</span><span class="op" id="1948244">.</span><span class="ident" id="1948245">consume</span><span class="op" id="1948252">(</span><span class="string" id="1948253">&#34;+&#34;</span><span class="op" id="1948256">,</span>&nbsp;<span class="ident" id="1948258">false</span><span class="op" id="1948263">)</span>&nbsp;<span class="op" id="1948265">{</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1948270">s</span><span class="op" id="1948271">.</span><span class="ident" id="1948272">errorString</span><span class="op" id="1948283">(</span><span class="string" id="1948284">&#34;bad&nbsp;unicode&nbsp;format&nbsp;&#34;</span><span class="op" id="1948305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1948309">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1948312">}</span>&nbsp;<span class="keyword" id="1948314">else</span>&nbsp;<span class="keyword" id="1948319">if</span>&nbsp;<span class="ident" id="1948322">verb</span>&nbsp;<span class="op" id="1948327">==</span>&nbsp;<span class="string" id="1948330">&#39;v&#39;</span>&nbsp;<span class="op" id="1948334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1948338">base</span><span class="op" id="1948342">,</span>&nbsp;<span class="ident" id="1948344">digits</span><span class="op" id="1948350">,</span>&nbsp;<span class="ident" id="1948352">haveDigits</span>&nbsp;<span class="op" id="1948363">=</span>&nbsp;<span class="ident" id="1948365">s</span><span class="op" id="1948366">.</span><span class="ident" id="1948367">scanBasePrefix</span><span class="op" id="1948381">(</span><span class="op" id="1948382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1948385">}</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1948388">tok</span>&nbsp;<span class="op" id="1948392">:=</span>&nbsp;<span class="ident" id="1948395">s</span><span class="op" id="1948396">.</span><span class="ident" id="1948397">scanNumber</span><span class="op" id="1948407">(</span><span class="ident" id="1948408">digits</span><span class="op" id="1948414">,</span>&nbsp;<span class="ident" id="1948416">haveDigits</span><span class="op" id="1948426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1948429">i</span><span class="op" id="1948430">,</span>&nbsp;<span class="ident" id="1948432">err</span>&nbsp;<span class="op" id="1948436">:=</span>&nbsp;<span class="ident" id="1948439">strconv</span><span class="op" id="1948446">.</span><span class="ident" id="1948447">ParseUint</span><span class="op" id="1948456">(</span><span class="ident" id="1948457">tok</span><span class="op" id="1948460">,</span>&nbsp;<span class="ident" id="1948462">base</span><span class="op" id="1948466">,</span>&nbsp;<span class="num" id="1948468">64</span><span class="op" id="1948470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1948473">if</span>&nbsp;<span class="ident" id="1948476">err</span>&nbsp;<span class="op" id="1948480">!=</span>&nbsp;<span class="ident" id="1948483">nil</span>&nbsp;<span class="op" id="1948487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1948491">s</span><span class="op" id="1948492">.</span><span class="builtintype" id="1948493">error</span><span class="op" id="1948498">(</span><span class="ident" id="1948499">err</span><span class="op" id="1948502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1948505">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1948508">n</span>&nbsp;<span class="op" id="1948510">:=</span>&nbsp;<span class="builtintype" id="1948513">uint</span><span class="op" id="1948517">(</span><span class="ident" id="1948518">bitSize</span><span class="op" id="1948525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1948528">x</span>&nbsp;<span class="op" id="1948530">:=</span>&nbsp;<span class="op" id="1948533">(</span><span class="ident" id="1948534">i</span>&nbsp;<span class="op" id="1948536">&lt;&lt;</span>&nbsp;<span class="op" id="1948539">(</span><span class="num" id="1948540">64</span>&nbsp;<span class="op" id="1948543">-</span>&nbsp;<span class="ident" id="1948545">n</span><span class="op" id="1948546">)</span><span class="op" id="1948547">)</span>&nbsp;<span class="op" id="1948549">&gt;&gt;</span>&nbsp;<span class="op" id="1948552">(</span><span class="num" id="1948553">64</span>&nbsp;<span class="op" id="1948556">-</span>&nbsp;<span class="ident" id="1948558">n</span><span class="op" id="1948559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1948562">if</span>&nbsp;<span class="ident" id="1948565">x</span>&nbsp;<span class="op" id="1948567">!=</span>&nbsp;<span class="ident" id="1948570">i</span>&nbsp;<span class="op" id="1948572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1948576">s</span><span class="op" id="1948577">.</span><span class="ident" id="1948578">errorString</span><span class="op" id="1948589">(</span><span class="string" id="1948590">&#34;unsigned&nbsp;integer&nbsp;overflow&nbsp;on&nbsp;token&nbsp;&#34;</span>&nbsp;<span class="op" id="1948628">+</span>&nbsp;<span class="ident" id="1948630">tok</span><span class="op" id="1948633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1948636">}</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1948639">return</span>&nbsp;<span class="ident" id="1948646">i</span><br>
<span class="lineno"></span><span class="op" id="1948648">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1948651">//&nbsp;floatToken&nbsp;returns&nbsp;the&nbsp;floating-point&nbsp;number&nbsp;starting&nbsp;here,&nbsp;no&nbsp;longer&nbsp;than&nbsp;swid</span><br>
<span class="lineno"></span><span class="comment" id="1948734">//&nbsp;if&nbsp;the&nbsp;width&nbsp;is&nbsp;specified.&nbsp;It&#39;s&nbsp;not&nbsp;rigorous&nbsp;about&nbsp;syntax&nbsp;because&nbsp;it&nbsp;doesn&#39;t&nbsp;check&nbsp;that</span><br>
<span class="lineno">715</span><span class="comment" id="1948825">//&nbsp;we&nbsp;have&nbsp;at&nbsp;least&nbsp;some&nbsp;digits,&nbsp;but&nbsp;Atof&nbsp;will&nbsp;do&nbsp;that.</span><br>
<span class="lineno"></span><span class="keyword" id="1948881">func</span>&nbsp;<span class="op" id="1948886">(</span><span class="ident" id="1948887">s</span>&nbsp;<span class="op" id="1948889">*</span><span class="ident" id="1948890">ss</span><span class="op" id="1948892">)</span>&nbsp;<span class="ident" id="1948894">floatToken</span><span class="op" id="1948904">(</span><span class="op" id="1948905">)</span>&nbsp;<span class="builtintype" id="1948907">string</span>&nbsp;<span class="op" id="1948914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1948917">s</span><span class="op" id="1948918">.</span><span class="ident" id="1948919">buf</span>&nbsp;<span class="op" id="1948923">=</span>&nbsp;<span class="ident" id="1948925">s</span><span class="op" id="1948926">.</span><span class="ident" id="1948927">buf</span><span class="op" id="1948930">[</span><span class="op" id="1948931">:</span><span class="num" id="1948932">0</span><span class="op" id="1948933">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1948936">//&nbsp;NaN?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1948945">if</span>&nbsp;<span class="ident" id="1948948">s</span><span class="op" id="1948949">.</span><span class="ident" id="1948950">accept</span><span class="op" id="1948956">(</span><span class="string" id="1948957">&#34;nN&#34;</span><span class="op" id="1948961">)</span>&nbsp;<span class="op" id="1948963">&amp;&amp;</span>&nbsp;<span class="ident" id="1948966">s</span><span class="op" id="1948967">.</span><span class="ident" id="1948968">accept</span><span class="op" id="1948974">(</span><span class="string" id="1948975">&#34;aA&#34;</span><span class="op" id="1948979">)</span>&nbsp;<span class="op" id="1948981">&amp;&amp;</span>&nbsp;<span class="ident" id="1948984">s</span><span class="op" id="1948985">.</span><span class="ident" id="1948986">accept</span><span class="op" id="1948992">(</span><span class="string" id="1948993">&#34;nN&#34;</span><span class="op" id="1948997">)</span>&nbsp;<span class="op" id="1948999">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1949003">return</span>&nbsp;<span class="builtintype" id="1949010">string</span><span class="op" id="1949016">(</span><span class="ident" id="1949017">s</span><span class="op" id="1949018">.</span><span class="ident" id="1949019">buf</span><span class="op" id="1949022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1949025">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1949028">//&nbsp;leading&nbsp;sign?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1949046">s</span><span class="op" id="1949047">.</span><span class="ident" id="1949048">accept</span><span class="op" id="1949054">(</span><span class="ident" id="1949055">sign</span><span class="op" id="1949059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1949062">//&nbsp;Inf?</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1949071">if</span>&nbsp;<span class="ident" id="1949074">s</span><span class="op" id="1949075">.</span><span class="ident" id="1949076">accept</span><span class="op" id="1949082">(</span><span class="string" id="1949083">&#34;iI&#34;</span><span class="op" id="1949087">)</span>&nbsp;<span class="op" id="1949089">&amp;&amp;</span>&nbsp;<span class="ident" id="1949092">s</span><span class="op" id="1949093">.</span><span class="ident" id="1949094">accept</span><span class="op" id="1949100">(</span><span class="string" id="1949101">&#34;nN&#34;</span><span class="op" id="1949105">)</span>&nbsp;<span class="op" id="1949107">&amp;&amp;</span>&nbsp;<span class="ident" id="1949110">s</span><span class="op" id="1949111">.</span><span class="ident" id="1949112">accept</span><span class="op" id="1949118">(</span><span class="string" id="1949119">&#34;fF&#34;</span><span class="op" id="1949123">)</span>&nbsp;<span class="op" id="1949125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1949129">return</span>&nbsp;<span class="builtintype" id="1949136">string</span><span class="op" id="1949142">(</span><span class="ident" id="1949143">s</span><span class="op" id="1949144">.</span><span class="ident" id="1949145">buf</span><span class="op" id="1949148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1949151">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1949154">//&nbsp;digits?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1949166">for</span>&nbsp;<span class="ident" id="1949170">s</span><span class="op" id="1949171">.</span><span class="ident" id="1949172">accept</span><span class="op" id="1949178">(</span><span class="ident" id="1949179">decimalDigits</span><span class="op" id="1949192">)</span>&nbsp;<span class="op" id="1949194">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1949197">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1949200">//&nbsp;decimal&nbsp;point?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1949219">if</span>&nbsp;<span class="ident" id="1949222">s</span><span class="op" id="1949223">.</span><span class="ident" id="1949224">accept</span><span class="op" id="1949230">(</span><span class="ident" id="1949231">period</span><span class="op" id="1949237">)</span>&nbsp;<span class="op" id="1949239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1949243">//&nbsp;fraction?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1949258">for</span>&nbsp;<span class="ident" id="1949262">s</span><span class="op" id="1949263">.</span><span class="ident" id="1949264">accept</span><span class="op" id="1949270">(</span><span class="ident" id="1949271">decimalDigits</span><span class="op" id="1949284">)</span>&nbsp;<span class="op" id="1949286">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1949290">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1949293">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1949296">//&nbsp;exponent?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1949310">if</span>&nbsp;<span class="ident" id="1949313">s</span><span class="op" id="1949314">.</span><span class="ident" id="1949315">accept</span><span class="op" id="1949321">(</span><span class="ident" id="1949322">exponent</span><span class="op" id="1949330">)</span>&nbsp;<span class="op" id="1949332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1949336">//&nbsp;leading&nbsp;sign?</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1949355">s</span><span class="op" id="1949356">.</span><span class="ident" id="1949357">accept</span><span class="op" id="1949363">(</span><span class="ident" id="1949364">sign</span><span class="op" id="1949368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1949372">//&nbsp;digits?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1949385">for</span>&nbsp;<span class="ident" id="1949389">s</span><span class="op" id="1949390">.</span><span class="ident" id="1949391">accept</span><span class="op" id="1949397">(</span><span class="ident" id="1949398">decimalDigits</span><span class="op" id="1949411">)</span>&nbsp;<span class="op" id="1949413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1949417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1949420">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1949423">return</span>&nbsp;<span class="builtintype" id="1949430">string</span><span class="op" id="1949436">(</span><span class="ident" id="1949437">s</span><span class="op" id="1949438">.</span><span class="ident" id="1949439">buf</span><span class="op" id="1949442">)</span><br>
<span class="lineno"></span><span class="op" id="1949444">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1949447">//&nbsp;complexTokens&nbsp;returns&nbsp;the&nbsp;real&nbsp;and&nbsp;imaginary&nbsp;parts&nbsp;of&nbsp;the&nbsp;complex&nbsp;number&nbsp;starting&nbsp;here.</span><br>
<span class="lineno"></span><span class="comment" id="1949538">//&nbsp;The&nbsp;number&nbsp;might&nbsp;be&nbsp;parenthesized&nbsp;and&nbsp;has&nbsp;the&nbsp;format&nbsp;(N+Ni)&nbsp;where&nbsp;N&nbsp;is&nbsp;a&nbsp;floating-point</span><br>
<span class="lineno">750</span><span class="comment" id="1949629">//&nbsp;number&nbsp;and&nbsp;there&nbsp;are&nbsp;no&nbsp;spaces&nbsp;within.</span><br>
<span class="lineno"></span><span class="keyword" id="1949671">func</span>&nbsp;<span class="op" id="1949676">(</span><span class="ident" id="1949677">s</span>&nbsp;<span class="op" id="1949679">*</span><span class="ident" id="1949680">ss</span><span class="op" id="1949682">)</span>&nbsp;<span class="ident" id="1949684">complexTokens</span><span class="op" id="1949697">(</span><span class="op" id="1949698">)</span>&nbsp;<span class="op" id="1949700">(</span><span class="builtinfunc" id="1949701">real</span><span class="op" id="1949705">,</span>&nbsp;<span class="builtinfunc" id="1949707">imag</span>&nbsp;<span class="builtintype" id="1949712">string</span><span class="op" id="1949718">)</span>&nbsp;<span class="op" id="1949720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1949723">//&nbsp;TODO:&nbsp;accept&nbsp;N&nbsp;and&nbsp;Ni&nbsp;independently?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1949764">parens</span>&nbsp;<span class="op" id="1949771">:=</span>&nbsp;<span class="ident" id="1949774">s</span><span class="op" id="1949775">.</span><span class="ident" id="1949776">accept</span><span class="op" id="1949782">(</span><span class="string" id="1949783">&#34;(&#34;</span><span class="op" id="1949786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1949789">real</span>&nbsp;<span class="op" id="1949794">=</span>&nbsp;<span class="ident" id="1949796">s</span><span class="op" id="1949797">.</span><span class="ident" id="1949798">floatToken</span><span class="op" id="1949808">(</span><span class="op" id="1949809">)</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1949812">s</span><span class="op" id="1949813">.</span><span class="ident" id="1949814">buf</span>&nbsp;<span class="op" id="1949818">=</span>&nbsp;<span class="ident" id="1949820">s</span><span class="op" id="1949821">.</span><span class="ident" id="1949822">buf</span><span class="op" id="1949825">[</span><span class="op" id="1949826">:</span><span class="num" id="1949827">0</span><span class="op" id="1949828">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1949831">//&nbsp;Must&nbsp;now&nbsp;have&nbsp;a&nbsp;sign.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1949857">if</span>&nbsp;<span class="op" id="1949860">!</span><span class="ident" id="1949861">s</span><span class="op" id="1949862">.</span><span class="ident" id="1949863">accept</span><span class="op" id="1949869">(</span><span class="string" id="1949870">&#34;+-&#34;</span><span class="op" id="1949874">)</span>&nbsp;<span class="op" id="1949876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1949880">s</span><span class="op" id="1949881">.</span><span class="builtintype" id="1949882">error</span><span class="op" id="1949887">(</span><span class="ident" id="1949888">complexError</span><span class="op" id="1949900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1949903">}</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1949906">//&nbsp;Sign&nbsp;is&nbsp;now&nbsp;in&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1949932">imagSign</span>&nbsp;<span class="op" id="1949941">:=</span>&nbsp;<span class="builtintype" id="1949944">string</span><span class="op" id="1949950">(</span><span class="ident" id="1949951">s</span><span class="op" id="1949952">.</span><span class="ident" id="1949953">buf</span><span class="op" id="1949956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1949959">imag</span>&nbsp;<span class="op" id="1949964">=</span>&nbsp;<span class="ident" id="1949966">s</span><span class="op" id="1949967">.</span><span class="ident" id="1949968">floatToken</span><span class="op" id="1949978">(</span><span class="op" id="1949979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1949982">if</span>&nbsp;<span class="op" id="1949985">!</span><span class="ident" id="1949986">s</span><span class="op" id="1949987">.</span><span class="ident" id="1949988">accept</span><span class="op" id="1949994">(</span><span class="string" id="1949995">&#34;i&#34;</span><span class="op" id="1949998">)</span>&nbsp;<span class="op" id="1950000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1950004">s</span><span class="op" id="1950005">.</span><span class="builtintype" id="1950006">error</span><span class="op" id="1950011">(</span><span class="ident" id="1950012">complexError</span><span class="op" id="1950024">)</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1950027">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1950030">if</span>&nbsp;<span class="ident" id="1950033">parens</span>&nbsp;<span class="op" id="1950040">&amp;&amp;</span>&nbsp;<span class="op" id="1950043">!</span><span class="ident" id="1950044">s</span><span class="op" id="1950045">.</span><span class="ident" id="1950046">accept</span><span class="op" id="1950052">(</span><span class="string" id="1950053">&#34;)&#34;</span><span class="op" id="1950056">)</span>&nbsp;<span class="op" id="1950058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1950062">s</span><span class="op" id="1950063">.</span><span class="builtintype" id="1950064">error</span><span class="op" id="1950069">(</span><span class="ident" id="1950070">complexError</span><span class="op" id="1950082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1950085">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1950088">return</span>&nbsp;<span class="builtinfunc" id="1950095">real</span><span class="op" id="1950099">,</span>&nbsp;<span class="ident" id="1950101">imagSign</span>&nbsp;<span class="op" id="1950110">+</span>&nbsp;<span class="builtinfunc" id="1950112">imag</span><br>
<span class="lineno">770</span><span class="op" id="1950117">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1950120">//&nbsp;convertFloat&nbsp;converts&nbsp;the&nbsp;string&nbsp;to&nbsp;a&nbsp;float64value.</span><br>
<span class="lineno"></span><span class="keyword" id="1950175">func</span>&nbsp;<span class="op" id="1950180">(</span><span class="ident" id="1950181">s</span>&nbsp;<span class="op" id="1950183">*</span><span class="ident" id="1950184">ss</span><span class="op" id="1950186">)</span>&nbsp;<span class="ident" id="1950188">convertFloat</span><span class="op" id="1950200">(</span><span class="ident" id="1950201">str</span>&nbsp;<span class="builtintype" id="1950205">string</span><span class="op" id="1950211">,</span>&nbsp;<span class="ident" id="1950213">n</span>&nbsp;<span class="builtintype" id="1950215">int</span><span class="op" id="1950218">)</span>&nbsp;<span class="builtintype" id="1950220">float64</span>&nbsp;<span class="op" id="1950228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1950231">if</span>&nbsp;<span class="ident" id="1950234">p</span>&nbsp;<span class="op" id="1950236">:=</span>&nbsp;<span class="ident" id="1950239">indexRune</span><span class="op" id="1950248">(</span><span class="ident" id="1950249">str</span><span class="op" id="1950252">,</span>&nbsp;<span class="string" id="1950254">&#39;p&#39;</span><span class="op" id="1950257">)</span><span class="op" id="1950258">;</span>&nbsp;<span class="ident" id="1950260">p</span>&nbsp;<span class="op" id="1950262">&gt;=</span>&nbsp;<span class="num" id="1950265">0</span>&nbsp;<span class="op" id="1950267">{</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1950271">//&nbsp;Atof&nbsp;doesn&#39;t&nbsp;handle&nbsp;power-of-2&nbsp;exponents,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1950318">//&nbsp;but&nbsp;they&#39;re&nbsp;easy&nbsp;to&nbsp;evaluate.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1950353">f</span><span class="op" id="1950354">,</span>&nbsp;<span class="ident" id="1950356">err</span>&nbsp;<span class="op" id="1950360">:=</span>&nbsp;<span class="ident" id="1950363">strconv</span><span class="op" id="1950370">.</span><span class="ident" id="1950371">ParseFloat</span><span class="op" id="1950381">(</span><span class="ident" id="1950382">str</span><span class="op" id="1950385">[</span><span class="op" id="1950386">:</span><span class="ident" id="1950387">p</span><span class="op" id="1950388">]</span><span class="op" id="1950389">,</span>&nbsp;<span class="ident" id="1950391">n</span><span class="op" id="1950392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1950396">if</span>&nbsp;<span class="ident" id="1950399">err</span>&nbsp;<span class="op" id="1950403">!=</span>&nbsp;<span class="ident" id="1950406">nil</span>&nbsp;<span class="op" id="1950410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1950415">//&nbsp;Put&nbsp;full&nbsp;string&nbsp;into&nbsp;error.</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1950449">if</span>&nbsp;<span class="ident" id="1950452">e</span><span class="op" id="1950453">,</span>&nbsp;<span class="ident" id="1950455">ok</span>&nbsp;<span class="op" id="1950458">:=</span>&nbsp;<span class="ident" id="1950461">err</span><span class="op" id="1950464">.</span><span class="op" id="1950465">(</span><span class="op" id="1950466">*</span><span class="ident" id="1950467">strconv</span><span class="op" id="1950474">.</span><span class="ident" id="1950475">NumError</span><span class="op" id="1950483">)</span><span class="op" id="1950484">;</span>&nbsp;<span class="ident" id="1950486">ok</span>&nbsp;<span class="op" id="1950489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1950495">e</span><span class="op" id="1950496">.</span><span class="ident" id="1950497">Num</span>&nbsp;<span class="op" id="1950501">=</span>&nbsp;<span class="ident" id="1950503">str</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1950510">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1950515">s</span><span class="op" id="1950516">.</span><span class="builtintype" id="1950517">error</span><span class="op" id="1950522">(</span><span class="ident" id="1950523">err</span><span class="op" id="1950526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1950530">}</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1950534">m</span><span class="op" id="1950535">,</span>&nbsp;<span class="ident" id="1950537">err</span>&nbsp;<span class="op" id="1950541">:=</span>&nbsp;<span class="ident" id="1950544">strconv</span><span class="op" id="1950551">.</span><span class="ident" id="1950552">Atoi</span><span class="op" id="1950556">(</span><span class="ident" id="1950557">str</span><span class="op" id="1950560">[</span><span class="ident" id="1950561">p</span><span class="op" id="1950562">+</span><span class="num" id="1950563">1</span><span class="op" id="1950564">:</span><span class="op" id="1950565">]</span><span class="op" id="1950566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1950570">if</span>&nbsp;<span class="ident" id="1950573">err</span>&nbsp;<span class="op" id="1950577">!=</span>&nbsp;<span class="ident" id="1950580">nil</span>&nbsp;<span class="op" id="1950584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1950589">//&nbsp;Put&nbsp;full&nbsp;string&nbsp;into&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1950623">if</span>&nbsp;<span class="ident" id="1950626">e</span><span class="op" id="1950627">,</span>&nbsp;<span class="ident" id="1950629">ok</span>&nbsp;<span class="op" id="1950632">:=</span>&nbsp;<span class="ident" id="1950635">err</span><span class="op" id="1950638">.</span><span class="op" id="1950639">(</span><span class="op" id="1950640">*</span><span class="ident" id="1950641">strconv</span><span class="op" id="1950648">.</span><span class="ident" id="1950649">NumError</span><span class="op" id="1950657">)</span><span class="op" id="1950658">;</span>&nbsp;<span class="ident" id="1950660">ok</span>&nbsp;<span class="op" id="1950663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1950669">e</span><span class="op" id="1950670">.</span><span class="ident" id="1950671">Num</span>&nbsp;<span class="op" id="1950675">=</span>&nbsp;<span class="ident" id="1950677">str</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1950684">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1950689">s</span><span class="op" id="1950690">.</span><span class="builtintype" id="1950691">error</span><span class="op" id="1950696">(</span><span class="ident" id="1950697">err</span><span class="op" id="1950700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1950704">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1950708">return</span>&nbsp;<span class="ident" id="1950715">math</span><span class="op" id="1950719">.</span><span class="ident" id="1950720">Ldexp</span><span class="op" id="1950725">(</span><span class="ident" id="1950726">f</span><span class="op" id="1950727">,</span>&nbsp;<span class="ident" id="1950729">m</span><span class="op" id="1950730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1950733">}</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1950736">f</span><span class="op" id="1950737">,</span>&nbsp;<span class="ident" id="1950739">err</span>&nbsp;<span class="op" id="1950743">:=</span>&nbsp;<span class="ident" id="1950746">strconv</span><span class="op" id="1950753">.</span><span class="ident" id="1950754">ParseFloat</span><span class="op" id="1950764">(</span><span class="ident" id="1950765">str</span><span class="op" id="1950768">,</span>&nbsp;<span class="ident" id="1950770">n</span><span class="op" id="1950771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1950774">if</span>&nbsp;<span class="ident" id="1950777">err</span>&nbsp;<span class="op" id="1950781">!=</span>&nbsp;<span class="ident" id="1950784">nil</span>&nbsp;<span class="op" id="1950788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1950792">s</span><span class="op" id="1950793">.</span><span class="builtintype" id="1950794">error</span><span class="op" id="1950799">(</span><span class="ident" id="1950800">err</span><span class="op" id="1950803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1950806">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1950809">return</span>&nbsp;<span class="ident" id="1950816">f</span><br>
<span class="lineno">800</span><span class="op" id="1950818">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1950821">//&nbsp;convertComplex&nbsp;converts&nbsp;the&nbsp;next&nbsp;token&nbsp;to&nbsp;a&nbsp;complex128&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="1950886">//&nbsp;The&nbsp;atof&nbsp;argument&nbsp;is&nbsp;a&nbsp;type-specific&nbsp;reader&nbsp;for&nbsp;the&nbsp;underlying&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="1950958">//&nbsp;If&nbsp;we&#39;re&nbsp;reading&nbsp;complex64,&nbsp;atof&nbsp;will&nbsp;parse&nbsp;float32s&nbsp;and&nbsp;convert&nbsp;them</span><br>
<span class="lineno">805</span><span class="comment" id="1951031">//&nbsp;to&nbsp;float64&#39;s&nbsp;to&nbsp;avoid&nbsp;reproducing&nbsp;this&nbsp;code&nbsp;for&nbsp;each&nbsp;complex&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="1951101">func</span>&nbsp;<span class="op" id="1951106">(</span><span class="ident" id="1951107">s</span>&nbsp;<span class="op" id="1951109">*</span><span class="ident" id="1951110">ss</span><span class="op" id="1951112">)</span>&nbsp;<span class="ident" id="1951114">scanComplex</span><span class="op" id="1951125">(</span><span class="ident" id="1951126">verb</span>&nbsp;<span class="builtintype" id="1951131">rune</span><span class="op" id="1951135">,</span>&nbsp;<span class="ident" id="1951137">n</span>&nbsp;<span class="builtintype" id="1951139">int</span><span class="op" id="1951142">)</span>&nbsp;<span class="builtintype" id="1951144">complex128</span>&nbsp;<span class="op" id="1951155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1951158">if</span>&nbsp;<span class="op" id="1951161">!</span><span class="ident" id="1951162">s</span><span class="op" id="1951163">.</span><span class="ident" id="1951164">okVerb</span><span class="op" id="1951170">(</span><span class="ident" id="1951171">verb</span><span class="op" id="1951175">,</span>&nbsp;<span class="ident" id="1951177">floatVerbs</span><span class="op" id="1951187">,</span>&nbsp;<span class="string" id="1951189">&#34;complex&#34;</span><span class="op" id="1951198">)</span>&nbsp;<span class="op" id="1951200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1951204">return</span>&nbsp;<span class="num" id="1951211">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1951214">}</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1951217">s</span><span class="op" id="1951218">.</span><span class="ident" id="1951219">skipSpace</span><span class="op" id="1951228">(</span><span class="ident" id="1951229">false</span><span class="op" id="1951234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1951237">s</span><span class="op" id="1951238">.</span><span class="ident" id="1951239">notEOF</span><span class="op" id="1951245">(</span><span class="op" id="1951246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1951249">sreal</span><span class="op" id="1951254">,</span>&nbsp;<span class="ident" id="1951256">simag</span>&nbsp;<span class="op" id="1951262">:=</span>&nbsp;<span class="ident" id="1951265">s</span><span class="op" id="1951266">.</span><span class="ident" id="1951267">complexTokens</span><span class="op" id="1951280">(</span><span class="op" id="1951281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1951284">real</span>&nbsp;<span class="op" id="1951289">:=</span>&nbsp;<span class="ident" id="1951292">s</span><span class="op" id="1951293">.</span><span class="ident" id="1951294">convertFloat</span><span class="op" id="1951306">(</span><span class="ident" id="1951307">sreal</span><span class="op" id="1951312">,</span>&nbsp;<span class="ident" id="1951314">n</span><span class="op" id="1951315">/</span><span class="num" id="1951316">2</span><span class="op" id="1951317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1951320">imag</span>&nbsp;<span class="op" id="1951325">:=</span>&nbsp;<span class="ident" id="1951328">s</span><span class="op" id="1951329">.</span><span class="ident" id="1951330">convertFloat</span><span class="op" id="1951342">(</span><span class="ident" id="1951343">simag</span><span class="op" id="1951348">,</span>&nbsp;<span class="ident" id="1951350">n</span><span class="op" id="1951351">/</span><span class="num" id="1951352">2</span><span class="op" id="1951353">)</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1951356">return</span>&nbsp;<span class="builtinfunc" id="1951363">complex</span><span class="op" id="1951370">(</span><span class="builtinfunc" id="1951371">real</span><span class="op" id="1951375">,</span>&nbsp;<span class="builtinfunc" id="1951377">imag</span><span class="op" id="1951381">)</span><br>
<span class="lineno"></span><span class="op" id="1951383">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1951386">//&nbsp;convertString&nbsp;returns&nbsp;the&nbsp;string&nbsp;represented&nbsp;by&nbsp;the&nbsp;next&nbsp;input&nbsp;characters.</span><br>
<span class="lineno"></span><span class="comment" id="1951464">//&nbsp;The&nbsp;format&nbsp;of&nbsp;the&nbsp;input&nbsp;is&nbsp;determined&nbsp;by&nbsp;the&nbsp;verb.</span><br>
<span class="lineno">820</span><span class="keyword" id="1951518">func</span>&nbsp;<span class="op" id="1951523">(</span><span class="ident" id="1951524">s</span>&nbsp;<span class="op" id="1951526">*</span><span class="ident" id="1951527">ss</span><span class="op" id="1951529">)</span>&nbsp;<span class="ident" id="1951531">convertString</span><span class="op" id="1951544">(</span><span class="ident" id="1951545">verb</span>&nbsp;<span class="builtintype" id="1951550">rune</span><span class="op" id="1951554">)</span>&nbsp;<span class="op" id="1951556">(</span><span class="ident" id="1951557">str</span>&nbsp;<span class="builtintype" id="1951561">string</span><span class="op" id="1951567">)</span>&nbsp;<span class="op" id="1951569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1951572">if</span>&nbsp;<span class="op" id="1951575">!</span><span class="ident" id="1951576">s</span><span class="op" id="1951577">.</span><span class="ident" id="1951578">okVerb</span><span class="op" id="1951584">(</span><span class="ident" id="1951585">verb</span><span class="op" id="1951589">,</span>&nbsp;<span class="string" id="1951591">&#34;svqx&#34;</span><span class="op" id="1951597">,</span>&nbsp;<span class="string" id="1951599">&#34;string&#34;</span><span class="op" id="1951607">)</span>&nbsp;<span class="op" id="1951609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1951613">return</span>&nbsp;<span class="string" id="1951620">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1951624">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1951627">s</span><span class="op" id="1951628">.</span><span class="ident" id="1951629">skipSpace</span><span class="op" id="1951638">(</span><span class="ident" id="1951639">false</span><span class="op" id="1951644">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1951647">s</span><span class="op" id="1951648">.</span><span class="ident" id="1951649">notEOF</span><span class="op" id="1951655">(</span><span class="op" id="1951656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1951659">switch</span>&nbsp;<span class="ident" id="1951666">verb</span>&nbsp;<span class="op" id="1951671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1951674">case</span>&nbsp;<span class="string" id="1951679">&#39;q&#39;</span><span class="op" id="1951682">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1951686">str</span>&nbsp;<span class="op" id="1951690">=</span>&nbsp;<span class="ident" id="1951692">s</span><span class="op" id="1951693">.</span><span class="ident" id="1951694">quotedString</span><span class="op" id="1951706">(</span><span class="op" id="1951707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1951710">case</span>&nbsp;<span class="string" id="1951715">&#39;x&#39;</span><span class="op" id="1951718">:</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1951722">str</span>&nbsp;<span class="op" id="1951726">=</span>&nbsp;<span class="ident" id="1951728">s</span><span class="op" id="1951729">.</span><span class="ident" id="1951730">hexString</span><span class="op" id="1951739">(</span><span class="op" id="1951740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1951743">default</span><span class="op" id="1951750">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1951754">str</span>&nbsp;<span class="op" id="1951758">=</span>&nbsp;<span class="builtintype" id="1951760">string</span><span class="op" id="1951766">(</span><span class="ident" id="1951767">s</span><span class="op" id="1951768">.</span><span class="ident" id="1951769">token</span><span class="op" id="1951774">(</span><span class="ident" id="1951775">true</span><span class="op" id="1951779">,</span>&nbsp;<span class="ident" id="1951781">notSpace</span><span class="op" id="1951789">)</span><span class="op" id="1951790">)</span>&nbsp;<span class="comment" id="1951792">//&nbsp;%s&nbsp;and&nbsp;%v&nbsp;just&nbsp;return&nbsp;the&nbsp;next&nbsp;word</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1951832">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1951835">return</span><br>
<span class="lineno">835</span><span class="op" id="1951842">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1951845">//&nbsp;quotedString&nbsp;returns&nbsp;the&nbsp;double-&nbsp;or&nbsp;back-quoted&nbsp;string&nbsp;represented&nbsp;by&nbsp;the&nbsp;next&nbsp;input&nbsp;characters.</span><br>
<span class="lineno"></span><span class="keyword" id="1951945">func</span>&nbsp;<span class="op" id="1951950">(</span><span class="ident" id="1951951">s</span>&nbsp;<span class="op" id="1951953">*</span><span class="ident" id="1951954">ss</span><span class="op" id="1951956">)</span>&nbsp;<span class="ident" id="1951958">quotedString</span><span class="op" id="1951970">(</span><span class="op" id="1951971">)</span>&nbsp;<span class="builtintype" id="1951973">string</span>&nbsp;<span class="op" id="1951980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1951983">s</span><span class="op" id="1951984">.</span><span class="ident" id="1951985">notEOF</span><span class="op" id="1951991">(</span><span class="op" id="1951992">)</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1951995">quote</span>&nbsp;<span class="op" id="1952001">:=</span>&nbsp;<span class="ident" id="1952004">s</span><span class="op" id="1952005">.</span><span class="ident" id="1952006">getRune</span><span class="op" id="1952013">(</span><span class="op" id="1952014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1952017">switch</span>&nbsp;<span class="ident" id="1952024">quote</span>&nbsp;<span class="op" id="1952030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1952033">case</span>&nbsp;<span class="string" id="1952038">&#39;`&#39;</span><span class="op" id="1952041">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1952045">//&nbsp;Back-quoted:&nbsp;Anything&nbsp;goes&nbsp;until&nbsp;EOF&nbsp;or&nbsp;back&nbsp;quote.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1952102">for</span>&nbsp;<span class="op" id="1952106">{</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1952111">r</span>&nbsp;<span class="op" id="1952113">:=</span>&nbsp;<span class="ident" id="1952116">s</span><span class="op" id="1952117">.</span><span class="ident" id="1952118">mustReadRune</span><span class="op" id="1952130">(</span><span class="op" id="1952131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1952136">if</span>&nbsp;<span class="ident" id="1952139">r</span>&nbsp;<span class="op" id="1952141">==</span>&nbsp;<span class="ident" id="1952144">quote</span>&nbsp;<span class="op" id="1952150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1952156">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1952165">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1952170">s</span><span class="op" id="1952171">.</span><span class="ident" id="1952172">buf</span><span class="op" id="1952175">.</span><span class="ident" id="1952176">WriteRune</span><span class="op" id="1952185">(</span><span class="ident" id="1952186">r</span><span class="op" id="1952187">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1952191">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1952195">return</span>&nbsp;<span class="builtintype" id="1952202">string</span><span class="op" id="1952208">(</span><span class="ident" id="1952209">s</span><span class="op" id="1952210">.</span><span class="ident" id="1952211">buf</span><span class="op" id="1952214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1952217">case</span>&nbsp;<span class="string" id="1952222">&#39;&#34;&#39;</span><span class="op" id="1952225">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1952229">//&nbsp;Double-quoted:&nbsp;Include&nbsp;the&nbsp;quotes&nbsp;and&nbsp;let&nbsp;strconv.Unquote&nbsp;do&nbsp;the&nbsp;backslash&nbsp;escapes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1952318">s</span><span class="op" id="1952319">.</span><span class="ident" id="1952320">buf</span><span class="op" id="1952323">.</span><span class="ident" id="1952324">WriteRune</span><span class="op" id="1952333">(</span><span class="ident" id="1952334">quote</span><span class="op" id="1952339">)</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1952343">for</span>&nbsp;<span class="op" id="1952347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1952352">r</span>&nbsp;<span class="op" id="1952354">:=</span>&nbsp;<span class="ident" id="1952357">s</span><span class="op" id="1952358">.</span><span class="ident" id="1952359">mustReadRune</span><span class="op" id="1952371">(</span><span class="op" id="1952372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1952377">s</span><span class="op" id="1952378">.</span><span class="ident" id="1952379">buf</span><span class="op" id="1952382">.</span><span class="ident" id="1952383">WriteRune</span><span class="op" id="1952392">(</span><span class="ident" id="1952393">r</span><span class="op" id="1952394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1952399">if</span>&nbsp;<span class="ident" id="1952402">r</span>&nbsp;<span class="op" id="1952404">==</span>&nbsp;<span class="string" id="1952407">&#39;\\&#39;</span>&nbsp;<span class="op" id="1952412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1952418">//&nbsp;In&nbsp;a&nbsp;legal&nbsp;backslash&nbsp;escape,&nbsp;no&nbsp;matter&nbsp;how&nbsp;long,&nbsp;only&nbsp;the&nbsp;character</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1952493">//&nbsp;immediately&nbsp;after&nbsp;the&nbsp;escape&nbsp;can&nbsp;itself&nbsp;be&nbsp;a&nbsp;backslash&nbsp;or&nbsp;quote.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1952565">//&nbsp;Thus&nbsp;we&nbsp;only&nbsp;need&nbsp;to&nbsp;protect&nbsp;the&nbsp;first&nbsp;character&nbsp;after&nbsp;the&nbsp;backslash.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1952642">s</span><span class="op" id="1952643">.</span><span class="ident" id="1952644">buf</span><span class="op" id="1952647">.</span><span class="ident" id="1952648">WriteRune</span><span class="op" id="1952657">(</span><span class="ident" id="1952658">s</span><span class="op" id="1952659">.</span><span class="ident" id="1952660">mustReadRune</span><span class="op" id="1952672">(</span><span class="op" id="1952673">)</span><span class="op" id="1952674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1952679">}</span>&nbsp;<span class="keyword" id="1952681">else</span>&nbsp;<span class="keyword" id="1952686">if</span>&nbsp;<span class="ident" id="1952689">r</span>&nbsp;<span class="op" id="1952691">==</span>&nbsp;<span class="string" id="1952694">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="1952698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1952704">break</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1952713">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1952717">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1952721">result</span><span class="op" id="1952727">,</span>&nbsp;<span class="ident" id="1952729">err</span>&nbsp;<span class="op" id="1952733">:=</span>&nbsp;<span class="ident" id="1952736">strconv</span><span class="op" id="1952743">.</span><span class="ident" id="1952744">Unquote</span><span class="op" id="1952751">(</span><span class="builtintype" id="1952752">string</span><span class="op" id="1952758">(</span><span class="ident" id="1952759">s</span><span class="op" id="1952760">.</span><span class="ident" id="1952761">buf</span><span class="op" id="1952764">)</span><span class="op" id="1952765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1952769">if</span>&nbsp;<span class="ident" id="1952772">err</span>&nbsp;<span class="op" id="1952776">!=</span>&nbsp;<span class="ident" id="1952779">nil</span>&nbsp;<span class="op" id="1952783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1952788">s</span><span class="op" id="1952789">.</span><span class="builtintype" id="1952790">error</span><span class="op" id="1952795">(</span><span class="ident" id="1952796">err</span><span class="op" id="1952799">)</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1952803">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1952807">return</span>&nbsp;<span class="ident" id="1952814">result</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1952822">default</span><span class="op" id="1952829">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1952833">s</span><span class="op" id="1952834">.</span><span class="ident" id="1952835">errorString</span><span class="op" id="1952846">(</span><span class="string" id="1952847">&#34;expected&nbsp;quoted&nbsp;string&#34;</span><span class="op" id="1952871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1952874">}</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1952877">return</span>&nbsp;<span class="string" id="1952884">&#34;&#34;</span><br>
<span class="lineno"></span><span class="op" id="1952887">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1952890">//&nbsp;hexDigit&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;hexadecimal&nbsp;digit</span><br>
<span class="lineno"></span><span class="keyword" id="1952945">func</span>&nbsp;<span class="op" id="1952950">(</span><span class="ident" id="1952951">s</span>&nbsp;<span class="op" id="1952953">*</span><span class="ident" id="1952954">ss</span><span class="op" id="1952956">)</span>&nbsp;<span class="ident" id="1952958">hexDigit</span><span class="op" id="1952966">(</span><span class="ident" id="1952967">d</span>&nbsp;<span class="builtintype" id="1952969">rune</span><span class="op" id="1952973">)</span>&nbsp;<span class="builtintype" id="1952975">int</span>&nbsp;<span class="op" id="1952979">{</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1952982">digit</span>&nbsp;<span class="op" id="1952988">:=</span>&nbsp;<span class="builtintype" id="1952991">int</span><span class="op" id="1952994">(</span><span class="ident" id="1952995">d</span><span class="op" id="1952996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1952999">switch</span>&nbsp;<span class="ident" id="1953006">digit</span>&nbsp;<span class="op" id="1953012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1953015">case</span>&nbsp;<span class="string" id="1953020">&#39;0&#39;</span><span class="op" id="1953023">,</span>&nbsp;<span class="string" id="1953025">&#39;1&#39;</span><span class="op" id="1953028">,</span>&nbsp;<span class="string" id="1953030">&#39;2&#39;</span><span class="op" id="1953033">,</span>&nbsp;<span class="string" id="1953035">&#39;3&#39;</span><span class="op" id="1953038">,</span>&nbsp;<span class="string" id="1953040">&#39;4&#39;</span><span class="op" id="1953043">,</span>&nbsp;<span class="string" id="1953045">&#39;5&#39;</span><span class="op" id="1953048">,</span>&nbsp;<span class="string" id="1953050">&#39;6&#39;</span><span class="op" id="1953053">,</span>&nbsp;<span class="string" id="1953055">&#39;7&#39;</span><span class="op" id="1953058">,</span>&nbsp;<span class="string" id="1953060">&#39;8&#39;</span><span class="op" id="1953063">,</span>&nbsp;<span class="string" id="1953065">&#39;9&#39;</span><span class="op" id="1953068">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1953072">return</span>&nbsp;<span class="ident" id="1953079">digit</span>&nbsp;<span class="op" id="1953085">-</span>&nbsp;<span class="string" id="1953087">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1953092">case</span>&nbsp;<span class="string" id="1953097">&#39;a&#39;</span><span class="op" id="1953100">,</span>&nbsp;<span class="string" id="1953102">&#39;b&#39;</span><span class="op" id="1953105">,</span>&nbsp;<span class="string" id="1953107">&#39;c&#39;</span><span class="op" id="1953110">,</span>&nbsp;<span class="string" id="1953112">&#39;d&#39;</span><span class="op" id="1953115">,</span>&nbsp;<span class="string" id="1953117">&#39;e&#39;</span><span class="op" id="1953120">,</span>&nbsp;<span class="string" id="1953122">&#39;f&#39;</span><span class="op" id="1953125">:</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1953129">return</span>&nbsp;<span class="num" id="1953136">10</span>&nbsp;<span class="op" id="1953139">+</span>&nbsp;<span class="ident" id="1953141">digit</span>&nbsp;<span class="op" id="1953147">-</span>&nbsp;<span class="string" id="1953149">&#39;a&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1953154">case</span>&nbsp;<span class="string" id="1953159">&#39;A&#39;</span><span class="op" id="1953162">,</span>&nbsp;<span class="string" id="1953164">&#39;B&#39;</span><span class="op" id="1953167">,</span>&nbsp;<span class="string" id="1953169">&#39;C&#39;</span><span class="op" id="1953172">,</span>&nbsp;<span class="string" id="1953174">&#39;D&#39;</span><span class="op" id="1953177">,</span>&nbsp;<span class="string" id="1953179">&#39;E&#39;</span><span class="op" id="1953182">,</span>&nbsp;<span class="string" id="1953184">&#39;F&#39;</span><span class="op" id="1953187">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1953191">return</span>&nbsp;<span class="num" id="1953198">10</span>&nbsp;<span class="op" id="1953201">+</span>&nbsp;<span class="ident" id="1953203">digit</span>&nbsp;<span class="op" id="1953209">-</span>&nbsp;<span class="string" id="1953211">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1953216">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1953219">s</span><span class="op" id="1953220">.</span><span class="ident" id="1953221">errorString</span><span class="op" id="1953232">(</span><span class="string" id="1953233">&#34;illegal&nbsp;hex&nbsp;digit&#34;</span><span class="op" id="1953252">)</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1953255">return</span>&nbsp;<span class="num" id="1953262">0</span><br>
<span class="lineno"></span><span class="op" id="1953264">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1953267">//&nbsp;hexByte&nbsp;returns&nbsp;the&nbsp;next&nbsp;hex-encoded&nbsp;(two-character)&nbsp;byte&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="1953344">//&nbsp;There&nbsp;must&nbsp;be&nbsp;either&nbsp;two&nbsp;hexadecimal&nbsp;digits&nbsp;or&nbsp;a&nbsp;space&nbsp;character&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno">895</span><span class="keyword" id="1953426">func</span>&nbsp;<span class="op" id="1953431">(</span><span class="ident" id="1953432">s</span>&nbsp;<span class="op" id="1953434">*</span><span class="ident" id="1953435">ss</span><span class="op" id="1953437">)</span>&nbsp;<span class="ident" id="1953439">hexByte</span><span class="op" id="1953446">(</span><span class="op" id="1953447">)</span>&nbsp;<span class="op" id="1953449">(</span><span class="ident" id="1953450">b</span>&nbsp;<span class="builtintype" id="1953452">byte</span><span class="op" id="1953456">,</span>&nbsp;<span class="ident" id="1953458">ok</span>&nbsp;<span class="builtintype" id="1953461">bool</span><span class="op" id="1953465">)</span>&nbsp;<span class="op" id="1953467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1953470">rune1</span>&nbsp;<span class="op" id="1953476">:=</span>&nbsp;<span class="ident" id="1953479">s</span><span class="op" id="1953480">.</span><span class="ident" id="1953481">getRune</span><span class="op" id="1953488">(</span><span class="op" id="1953489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1953492">if</span>&nbsp;<span class="ident" id="1953495">rune1</span>&nbsp;<span class="op" id="1953501">==</span>&nbsp;<span class="ident" id="1953504">eof</span>&nbsp;<span class="op" id="1953508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1953512">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1953520">}</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1953523">if</span>&nbsp;<span class="ident" id="1953526">isSpace</span><span class="op" id="1953533">(</span><span class="ident" id="1953534">rune1</span><span class="op" id="1953539">)</span>&nbsp;<span class="op" id="1953541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1953545">s</span><span class="op" id="1953546">.</span><span class="ident" id="1953547">UnreadRune</span><span class="op" id="1953557">(</span><span class="op" id="1953558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1953562">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1953570">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1953573">rune2</span>&nbsp;<span class="op" id="1953579">:=</span>&nbsp;<span class="ident" id="1953582">s</span><span class="op" id="1953583">.</span><span class="ident" id="1953584">mustReadRune</span><span class="op" id="1953596">(</span><span class="op" id="1953597">)</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1953600">return</span>&nbsp;<span class="builtintype" id="1953607">byte</span><span class="op" id="1953611">(</span><span class="ident" id="1953612">s</span><span class="op" id="1953613">.</span><span class="ident" id="1953614">hexDigit</span><span class="op" id="1953622">(</span><span class="ident" id="1953623">rune1</span><span class="op" id="1953628">)</span><span class="op" id="1953629">&lt;&lt;</span><span class="num" id="1953631">4</span>&nbsp;<span class="op" id="1953633">|</span>&nbsp;<span class="ident" id="1953635">s</span><span class="op" id="1953636">.</span><span class="ident" id="1953637">hexDigit</span><span class="op" id="1953645">(</span><span class="ident" id="1953646">rune2</span><span class="op" id="1953651">)</span><span class="op" id="1953652">)</span><span class="op" id="1953653">,</span>&nbsp;<span class="ident" id="1953655">true</span><br>
<span class="lineno"></span><span class="op" id="1953660">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1953663">//&nbsp;hexString&nbsp;returns&nbsp;the&nbsp;space-delimited&nbsp;hexpair-encoded&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="1953728">func</span>&nbsp;<span class="op" id="1953733">(</span><span class="ident" id="1953734">s</span>&nbsp;<span class="op" id="1953736">*</span><span class="ident" id="1953737">ss</span><span class="op" id="1953739">)</span>&nbsp;<span class="ident" id="1953741">hexString</span><span class="op" id="1953750">(</span><span class="op" id="1953751">)</span>&nbsp;<span class="builtintype" id="1953753">string</span>&nbsp;<span class="op" id="1953760">{</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1953763">s</span><span class="op" id="1953764">.</span><span class="ident" id="1953765">notEOF</span><span class="op" id="1953771">(</span><span class="op" id="1953772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1953775">for</span>&nbsp;<span class="op" id="1953779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1953783">b</span><span class="op" id="1953784">,</span>&nbsp;<span class="ident" id="1953786">ok</span>&nbsp;<span class="op" id="1953789">:=</span>&nbsp;<span class="ident" id="1953792">s</span><span class="op" id="1953793">.</span><span class="ident" id="1953794">hexByte</span><span class="op" id="1953801">(</span><span class="op" id="1953802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1953806">if</span>&nbsp;<span class="op" id="1953809">!</span><span class="ident" id="1953810">ok</span>&nbsp;<span class="op" id="1953813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1953818">break</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1953826">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1953830">s</span><span class="op" id="1953831">.</span><span class="ident" id="1953832">buf</span><span class="op" id="1953835">.</span><span class="ident" id="1953836">WriteByte</span><span class="op" id="1953845">(</span><span class="ident" id="1953846">b</span><span class="op" id="1953847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1953850">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1953853">if</span>&nbsp;<span class="builtinfunc" id="1953856">len</span><span class="op" id="1953859">(</span><span class="ident" id="1953860">s</span><span class="op" id="1953861">.</span><span class="ident" id="1953862">buf</span><span class="op" id="1953865">)</span>&nbsp;<span class="op" id="1953867">==</span>&nbsp;<span class="num" id="1953870">0</span>&nbsp;<span class="op" id="1953872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1953876">s</span><span class="op" id="1953877">.</span><span class="ident" id="1953878">errorString</span><span class="op" id="1953889">(</span><span class="string" id="1953890">&#34;no&nbsp;hex&nbsp;data&nbsp;for&nbsp;%x&nbsp;string&#34;</span><span class="op" id="1953917">)</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1953921">return</span>&nbsp;<span class="string" id="1953928">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1953932">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1953935">return</span>&nbsp;<span class="builtintype" id="1953942">string</span><span class="op" id="1953948">(</span><span class="ident" id="1953949">s</span><span class="op" id="1953950">.</span><span class="ident" id="1953951">buf</span><span class="op" id="1953954">)</span><br>
<span class="lineno"></span><span class="op" id="1953956">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">925</span><span class="keyword" id="1953959">const</span>&nbsp;<span class="ident" id="1953965">floatVerbs</span>&nbsp;<span class="op" id="1953976">=</span>&nbsp;<span class="string" id="1953978">&#34;beEfFgGv&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1953990">const</span>&nbsp;<span class="ident" id="1953996">hugeWid</span>&nbsp;<span class="op" id="1954004">=</span>&nbsp;<span class="num" id="1954006">1</span>&nbsp;<span class="op" id="1954008">&lt;&lt;</span>&nbsp;<span class="num" id="1954011">30</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1954015">//&nbsp;scanOne&nbsp;scans&nbsp;a&nbsp;single&nbsp;value,&nbsp;deriving&nbsp;the&nbsp;scanner&nbsp;from&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;argument.</span><br>
<span class="lineno">930</span><span class="keyword" id="1954100">func</span>&nbsp;<span class="op" id="1954105">(</span><span class="ident" id="1954106">s</span>&nbsp;<span class="op" id="1954108">*</span><span class="ident" id="1954109">ss</span><span class="op" id="1954111">)</span>&nbsp;<span class="ident" id="1954113">scanOne</span><span class="op" id="1954120">(</span><span class="ident" id="1954121">verb</span>&nbsp;<span class="builtintype" id="1954126">rune</span><span class="op" id="1954130">,</span>&nbsp;<span class="ident" id="1954132">arg</span>&nbsp;<span class="keyword" id="1954136">interface</span><span class="op" id="1954145">{</span><span class="op" id="1954146">}</span><span class="op" id="1954147">)</span>&nbsp;<span class="op" id="1954149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1954152">s</span><span class="op" id="1954153">.</span><span class="ident" id="1954154">buf</span>&nbsp;<span class="op" id="1954158">=</span>&nbsp;<span class="ident" id="1954160">s</span><span class="op" id="1954161">.</span><span class="ident" id="1954162">buf</span><span class="op" id="1954165">[</span><span class="op" id="1954166">:</span><span class="num" id="1954167">0</span><span class="op" id="1954168">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1954171">var</span>&nbsp;<span class="ident" id="1954175">err</span>&nbsp;<span class="builtintype" id="1954179">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1954186">//&nbsp;If&nbsp;the&nbsp;parameter&nbsp;has&nbsp;its&nbsp;own&nbsp;Scan&nbsp;method,&nbsp;use&nbsp;that.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1954242">if</span>&nbsp;<span class="ident" id="1954245">v</span><span class="op" id="1954246">,</span>&nbsp;<span class="ident" id="1954248">ok</span>&nbsp;<span class="op" id="1954251">:=</span>&nbsp;<span class="ident" id="1954254">arg</span><span class="op" id="1954257">.</span><span class="op" id="1954258">(</span><span class="ident" id="1954259">Scanner</span><span class="op" id="1954266">)</span><span class="op" id="1954267">;</span>&nbsp;<span class="ident" id="1954269">ok</span>&nbsp;<span class="op" id="1954272">{</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1954276">err</span>&nbsp;<span class="op" id="1954280">=</span>&nbsp;<span class="ident" id="1954282">v</span><span class="op" id="1954283">.</span><span class="ident" id="1954284">Scan</span><span class="op" id="1954288">(</span><span class="ident" id="1954289">s</span><span class="op" id="1954290">,</span>&nbsp;<span class="ident" id="1954292">verb</span><span class="op" id="1954296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1954300">if</span>&nbsp;<span class="ident" id="1954303">err</span>&nbsp;<span class="op" id="1954307">!=</span>&nbsp;<span class="ident" id="1954310">nil</span>&nbsp;<span class="op" id="1954314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1954319">if</span>&nbsp;<span class="ident" id="1954322">err</span>&nbsp;<span class="op" id="1954326">==</span>&nbsp;<span class="ident" id="1954329">io</span><span class="op" id="1954331">.</span><span class="ident" id="1954332">EOF</span>&nbsp;<span class="op" id="1954336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1954342">err</span>&nbsp;<span class="op" id="1954346">=</span>&nbsp;<span class="ident" id="1954348">io</span><span class="op" id="1954350">.</span><span class="ident" id="1954351">ErrUnexpectedEOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1954371">}</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1954376">s</span><span class="op" id="1954377">.</span><span class="builtintype" id="1954378">error</span><span class="op" id="1954383">(</span><span class="ident" id="1954384">err</span><span class="op" id="1954387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1954391">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1954395">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1954403">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1954407">switch</span>&nbsp;<span class="ident" id="1954414">v</span>&nbsp;<span class="op" id="1954416">:=</span>&nbsp;<span class="ident" id="1954419">arg</span><span class="op" id="1954422">.</span><span class="op" id="1954423">(</span><span class="keyword" id="1954424">type</span><span class="op" id="1954428">)</span>&nbsp;<span class="op" id="1954430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1954433">case</span>&nbsp;<span class="op" id="1954438">*</span><span class="builtintype" id="1954439">bool</span><span class="op" id="1954443">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1954447">*</span><span class="ident" id="1954448">v</span>&nbsp;<span class="op" id="1954450">=</span>&nbsp;<span class="ident" id="1954452">s</span><span class="op" id="1954453">.</span><span class="ident" id="1954454">scanBool</span><span class="op" id="1954462">(</span><span class="ident" id="1954463">verb</span><span class="op" id="1954467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1954470">case</span>&nbsp;<span class="op" id="1954475">*</span><span class="builtintype" id="1954476">complex64</span><span class="op" id="1954485">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1954489">*</span><span class="ident" id="1954490">v</span>&nbsp;<span class="op" id="1954492">=</span>&nbsp;<span class="builtintype" id="1954494">complex64</span><span class="op" id="1954503">(</span><span class="ident" id="1954504">s</span><span class="op" id="1954505">.</span><span class="ident" id="1954506">scanComplex</span><span class="op" id="1954517">(</span><span class="ident" id="1954518">verb</span><span class="op" id="1954522">,</span>&nbsp;<span class="num" id="1954524">64</span><span class="op" id="1954526">)</span><span class="op" id="1954527">)</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1954530">case</span>&nbsp;<span class="op" id="1954535">*</span><span class="builtintype" id="1954536">complex128</span><span class="op" id="1954546">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1954550">*</span><span class="ident" id="1954551">v</span>&nbsp;<span class="op" id="1954553">=</span>&nbsp;<span class="ident" id="1954555">s</span><span class="op" id="1954556">.</span><span class="ident" id="1954557">scanComplex</span><span class="op" id="1954568">(</span><span class="ident" id="1954569">verb</span><span class="op" id="1954573">,</span>&nbsp;<span class="num" id="1954575">128</span><span class="op" id="1954578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1954581">case</span>&nbsp;<span class="op" id="1954586">*</span><span class="builtintype" id="1954587">int</span><span class="op" id="1954590">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1954594">*</span><span class="ident" id="1954595">v</span>&nbsp;<span class="op" id="1954597">=</span>&nbsp;<span class="builtintype" id="1954599">int</span><span class="op" id="1954602">(</span><span class="ident" id="1954603">s</span><span class="op" id="1954604">.</span><span class="ident" id="1954605">scanInt</span><span class="op" id="1954612">(</span><span class="ident" id="1954613">verb</span><span class="op" id="1954617">,</span>&nbsp;<span class="ident" id="1954619">intBits</span><span class="op" id="1954626">)</span><span class="op" id="1954627">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1954630">case</span>&nbsp;<span class="op" id="1954635">*</span><span class="builtintype" id="1954636">int8</span><span class="op" id="1954640">:</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1954644">*</span><span class="ident" id="1954645">v</span>&nbsp;<span class="op" id="1954647">=</span>&nbsp;<span class="builtintype" id="1954649">int8</span><span class="op" id="1954653">(</span><span class="ident" id="1954654">s</span><span class="op" id="1954655">.</span><span class="ident" id="1954656">scanInt</span><span class="op" id="1954663">(</span><span class="ident" id="1954664">verb</span><span class="op" id="1954668">,</span>&nbsp;<span class="num" id="1954670">8</span><span class="op" id="1954671">)</span><span class="op" id="1954672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1954675">case</span>&nbsp;<span class="op" id="1954680">*</span><span class="builtintype" id="1954681">int16</span><span class="op" id="1954686">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1954690">*</span><span class="ident" id="1954691">v</span>&nbsp;<span class="op" id="1954693">=</span>&nbsp;<span class="builtintype" id="1954695">int16</span><span class="op" id="1954700">(</span><span class="ident" id="1954701">s</span><span class="op" id="1954702">.</span><span class="ident" id="1954703">scanInt</span><span class="op" id="1954710">(</span><span class="ident" id="1954711">verb</span><span class="op" id="1954715">,</span>&nbsp;<span class="num" id="1954717">16</span><span class="op" id="1954719">)</span><span class="op" id="1954720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1954723">case</span>&nbsp;<span class="op" id="1954728">*</span><span class="builtintype" id="1954729">int32</span><span class="op" id="1954734">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1954738">*</span><span class="ident" id="1954739">v</span>&nbsp;<span class="op" id="1954741">=</span>&nbsp;<span class="builtintype" id="1954743">int32</span><span class="op" id="1954748">(</span><span class="ident" id="1954749">s</span><span class="op" id="1954750">.</span><span class="ident" id="1954751">scanInt</span><span class="op" id="1954758">(</span><span class="ident" id="1954759">verb</span><span class="op" id="1954763">,</span>&nbsp;<span class="num" id="1954765">32</span><span class="op" id="1954767">)</span><span class="op" id="1954768">)</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1954771">case</span>&nbsp;<span class="op" id="1954776">*</span><span class="ident" id="1954777">int64</span><span class="op" id="1954782">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1954786">*</span><span class="ident" id="1954787">v</span>&nbsp;<span class="op" id="1954789">=</span>&nbsp;<span class="ident" id="1954791">s</span><span class="op" id="1954792">.</span><span class="ident" id="1954793">scanInt</span><span class="op" id="1954800">(</span><span class="ident" id="1954801">verb</span><span class="op" id="1954805">,</span>&nbsp;<span class="num" id="1954807">64</span><span class="op" id="1954809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1954812">case</span>&nbsp;<span class="op" id="1954817">*</span><span class="builtintype" id="1954818">uint</span><span class="op" id="1954822">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1954826">*</span><span class="ident" id="1954827">v</span>&nbsp;<span class="op" id="1954829">=</span>&nbsp;<span class="builtintype" id="1954831">uint</span><span class="op" id="1954835">(</span><span class="ident" id="1954836">s</span><span class="op" id="1954837">.</span><span class="ident" id="1954838">scanUint</span><span class="op" id="1954846">(</span><span class="ident" id="1954847">verb</span><span class="op" id="1954851">,</span>&nbsp;<span class="ident" id="1954853">intBits</span><span class="op" id="1954860">)</span><span class="op" id="1954861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1954864">case</span>&nbsp;<span class="op" id="1954869">*</span><span class="builtintype" id="1954870">uint8</span><span class="op" id="1954875">:</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1954879">*</span><span class="ident" id="1954880">v</span>&nbsp;<span class="op" id="1954882">=</span>&nbsp;<span class="builtintype" id="1954884">uint8</span><span class="op" id="1954889">(</span><span class="ident" id="1954890">s</span><span class="op" id="1954891">.</span><span class="ident" id="1954892">scanUint</span><span class="op" id="1954900">(</span><span class="ident" id="1954901">verb</span><span class="op" id="1954905">,</span>&nbsp;<span class="num" id="1954907">8</span><span class="op" id="1954908">)</span><span class="op" id="1954909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1954912">case</span>&nbsp;<span class="op" id="1954917">*</span><span class="builtintype" id="1954918">uint16</span><span class="op" id="1954924">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1954928">*</span><span class="ident" id="1954929">v</span>&nbsp;<span class="op" id="1954931">=</span>&nbsp;<span class="builtintype" id="1954933">uint16</span><span class="op" id="1954939">(</span><span class="ident" id="1954940">s</span><span class="op" id="1954941">.</span><span class="ident" id="1954942">scanUint</span><span class="op" id="1954950">(</span><span class="ident" id="1954951">verb</span><span class="op" id="1954955">,</span>&nbsp;<span class="num" id="1954957">16</span><span class="op" id="1954959">)</span><span class="op" id="1954960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1954963">case</span>&nbsp;<span class="op" id="1954968">*</span><span class="builtintype" id="1954969">uint32</span><span class="op" id="1954975">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1954979">*</span><span class="ident" id="1954980">v</span>&nbsp;<span class="op" id="1954982">=</span>&nbsp;<span class="builtintype" id="1954984">uint32</span><span class="op" id="1954990">(</span><span class="ident" id="1954991">s</span><span class="op" id="1954992">.</span><span class="ident" id="1954993">scanUint</span><span class="op" id="1955001">(</span><span class="ident" id="1955002">verb</span><span class="op" id="1955006">,</span>&nbsp;<span class="num" id="1955008">32</span><span class="op" id="1955010">)</span><span class="op" id="1955011">)</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1955014">case</span>&nbsp;<span class="op" id="1955019">*</span><span class="ident" id="1955020">uint64</span><span class="op" id="1955026">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1955030">*</span><span class="ident" id="1955031">v</span>&nbsp;<span class="op" id="1955033">=</span>&nbsp;<span class="ident" id="1955035">s</span><span class="op" id="1955036">.</span><span class="ident" id="1955037">scanUint</span><span class="op" id="1955045">(</span><span class="ident" id="1955046">verb</span><span class="op" id="1955050">,</span>&nbsp;<span class="num" id="1955052">64</span><span class="op" id="1955054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1955057">case</span>&nbsp;<span class="op" id="1955062">*</span><span class="builtintype" id="1955063">uintptr</span><span class="op" id="1955070">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1955074">*</span><span class="ident" id="1955075">v</span>&nbsp;<span class="op" id="1955077">=</span>&nbsp;<span class="builtintype" id="1955079">uintptr</span><span class="op" id="1955086">(</span><span class="ident" id="1955087">s</span><span class="op" id="1955088">.</span><span class="ident" id="1955089">scanUint</span><span class="op" id="1955097">(</span><span class="ident" id="1955098">verb</span><span class="op" id="1955102">,</span>&nbsp;<span class="ident" id="1955104">uintptrBits</span><span class="op" id="1955115">)</span><span class="op" id="1955116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1955119">//&nbsp;Floats&nbsp;are&nbsp;tricky&nbsp;because&nbsp;you&nbsp;want&nbsp;to&nbsp;scan&nbsp;in&nbsp;the&nbsp;precision&nbsp;of&nbsp;the&nbsp;result,&nbsp;not</span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1955202">//&nbsp;scan&nbsp;in&nbsp;high&nbsp;precision&nbsp;and&nbsp;convert,&nbsp;in&nbsp;order&nbsp;to&nbsp;preserve&nbsp;the&nbsp;correct&nbsp;error&nbsp;condition.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1955292">case</span>&nbsp;<span class="op" id="1955297">*</span><span class="builtintype" id="1955298">float32</span><span class="op" id="1955305">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1955309">if</span>&nbsp;<span class="ident" id="1955312">s</span><span class="op" id="1955313">.</span><span class="ident" id="1955314">okVerb</span><span class="op" id="1955320">(</span><span class="ident" id="1955321">verb</span><span class="op" id="1955325">,</span>&nbsp;<span class="ident" id="1955327">floatVerbs</span><span class="op" id="1955337">,</span>&nbsp;<span class="string" id="1955339">&#34;float32&#34;</span><span class="op" id="1955348">)</span>&nbsp;<span class="op" id="1955350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1955355">s</span><span class="op" id="1955356">.</span><span class="ident" id="1955357">skipSpace</span><span class="op" id="1955366">(</span><span class="ident" id="1955367">false</span><span class="op" id="1955372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1955377">s</span><span class="op" id="1955378">.</span><span class="ident" id="1955379">notEOF</span><span class="op" id="1955385">(</span><span class="op" id="1955386">)</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1955391">*</span><span class="ident" id="1955392">v</span>&nbsp;<span class="op" id="1955394">=</span>&nbsp;<span class="builtintype" id="1955396">float32</span><span class="op" id="1955403">(</span><span class="ident" id="1955404">s</span><span class="op" id="1955405">.</span><span class="ident" id="1955406">convertFloat</span><span class="op" id="1955418">(</span><span class="ident" id="1955419">s</span><span class="op" id="1955420">.</span><span class="ident" id="1955421">floatToken</span><span class="op" id="1955431">(</span><span class="op" id="1955432">)</span><span class="op" id="1955433">,</span>&nbsp;<span class="num" id="1955435">32</span><span class="op" id="1955437">)</span><span class="op" id="1955438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1955442">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1955445">case</span>&nbsp;<span class="op" id="1955450">*</span><span class="builtintype" id="1955451">float64</span><span class="op" id="1955458">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1955462">if</span>&nbsp;<span class="ident" id="1955465">s</span><span class="op" id="1955466">.</span><span class="ident" id="1955467">okVerb</span><span class="op" id="1955473">(</span><span class="ident" id="1955474">verb</span><span class="op" id="1955478">,</span>&nbsp;<span class="ident" id="1955480">floatVerbs</span><span class="op" id="1955490">,</span>&nbsp;<span class="string" id="1955492">&#34;float64&#34;</span><span class="op" id="1955501">)</span>&nbsp;<span class="op" id="1955503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1955508">s</span><span class="op" id="1955509">.</span><span class="ident" id="1955510">skipSpace</span><span class="op" id="1955519">(</span><span class="ident" id="1955520">false</span><span class="op" id="1955525">)</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1955530">s</span><span class="op" id="1955531">.</span><span class="ident" id="1955532">notEOF</span><span class="op" id="1955538">(</span><span class="op" id="1955539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1955544">*</span><span class="ident" id="1955545">v</span>&nbsp;<span class="op" id="1955547">=</span>&nbsp;<span class="ident" id="1955549">s</span><span class="op" id="1955550">.</span><span class="ident" id="1955551">convertFloat</span><span class="op" id="1955563">(</span><span class="ident" id="1955564">s</span><span class="op" id="1955565">.</span><span class="ident" id="1955566">floatToken</span><span class="op" id="1955576">(</span><span class="op" id="1955577">)</span><span class="op" id="1955578">,</span>&nbsp;<span class="num" id="1955580">64</span><span class="op" id="1955582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1955586">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1955589">case</span>&nbsp;<span class="op" id="1955594">*</span><span class="builtintype" id="1955595">string</span><span class="op" id="1955601">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1955605">*</span><span class="ident" id="1955606">v</span>&nbsp;<span class="op" id="1955608">=</span>&nbsp;<span class="ident" id="1955610">s</span><span class="op" id="1955611">.</span><span class="ident" id="1955612">convertString</span><span class="op" id="1955625">(</span><span class="ident" id="1955626">verb</span><span class="op" id="1955630">)</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1955633">case</span>&nbsp;<span class="op" id="1955638">*</span><span class="op" id="1955639">[</span><span class="op" id="1955640">]</span><span class="builtintype" id="1955641">byte</span><span class="op" id="1955645">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1955649">//&nbsp;We&nbsp;scan&nbsp;to&nbsp;string&nbsp;and&nbsp;convert&nbsp;so&nbsp;we&nbsp;get&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1955714">//&nbsp;If&nbsp;we&nbsp;scanned&nbsp;to&nbsp;bytes,&nbsp;the&nbsp;slice&nbsp;would&nbsp;point&nbsp;at&nbsp;the&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1955780">*</span><span class="ident" id="1955781">v</span>&nbsp;<span class="op" id="1955783">=</span>&nbsp;<span class="op" id="1955785">[</span><span class="op" id="1955786">]</span><span class="builtintype" id="1955787">byte</span><span class="op" id="1955791">(</span><span class="ident" id="1955792">s</span><span class="op" id="1955793">.</span><span class="ident" id="1955794">convertString</span><span class="op" id="1955807">(</span><span class="ident" id="1955808">verb</span><span class="op" id="1955812">)</span><span class="op" id="1955813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1955816">default</span><span class="op" id="1955823">:</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1955827">val</span>&nbsp;<span class="op" id="1955831">:=</span>&nbsp;<span class="ident" id="1955834">reflect</span><span class="op" id="1955841">.</span><span class="ident" id="1955842">ValueOf</span><span class="op" id="1955849">(</span><span class="ident" id="1955850">v</span><span class="op" id="1955851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1955855">ptr</span>&nbsp;<span class="op" id="1955859">:=</span>&nbsp;<span class="ident" id="1955862">val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1955868">if</span>&nbsp;<span class="ident" id="1955871">ptr</span><span class="op" id="1955874">.</span><span class="ident" id="1955875">Kind</span><span class="op" id="1955879">(</span><span class="op" id="1955880">)</span>&nbsp;<span class="op" id="1955882">!=</span>&nbsp;<span class="ident" id="1955885">reflect</span><span class="op" id="1955892">.</span><span class="ident" id="1955893">Ptr</span>&nbsp;<span class="op" id="1955897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1955902">s</span><span class="op" id="1955903">.</span><span class="ident" id="1955904">errorString</span><span class="op" id="1955915">(</span><span class="string" id="1955916">&#34;type&nbsp;not&nbsp;a&nbsp;pointer:&nbsp;&#34;</span>&nbsp;<span class="op" id="1955939">+</span>&nbsp;<span class="ident" id="1955941">val</span><span class="op" id="1955944">.</span><span class="ident" id="1955945">Type</span><span class="op" id="1955949">(</span><span class="op" id="1955950">)</span><span class="op" id="1955951">.</span><span class="ident" id="1955952">String</span><span class="op" id="1955958">(</span><span class="op" id="1955959">)</span><span class="op" id="1955960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1955965">return</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1955974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1955978">switch</span>&nbsp;<span class="ident" id="1955985">v</span>&nbsp;<span class="op" id="1955987">:=</span>&nbsp;<span class="ident" id="1955990">ptr</span><span class="op" id="1955993">.</span><span class="ident" id="1955994">Elem</span><span class="op" id="1955998">(</span><span class="op" id="1955999">)</span><span class="op" id="1956000">;</span>&nbsp;<span class="ident" id="1956002">v</span><span class="op" id="1956003">.</span><span class="ident" id="1956004">Kind</span><span class="op" id="1956008">(</span><span class="op" id="1956009">)</span>&nbsp;<span class="op" id="1956011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1956015">case</span>&nbsp;<span class="ident" id="1956020">reflect</span><span class="op" id="1956027">.</span><span class="ident" id="1956028">Bool</span><span class="op" id="1956032">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1956037">v</span><span class="op" id="1956038">.</span><span class="ident" id="1956039">SetBool</span><span class="op" id="1956046">(</span><span class="ident" id="1956047">s</span><span class="op" id="1956048">.</span><span class="ident" id="1956049">scanBool</span><span class="op" id="1956057">(</span><span class="ident" id="1956058">verb</span><span class="op" id="1956062">)</span><span class="op" id="1956063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1956067">case</span>&nbsp;<span class="ident" id="1956072">reflect</span><span class="op" id="1956079">.</span><span class="ident" id="1956080">Int</span><span class="op" id="1956083">,</span>&nbsp;<span class="ident" id="1956085">reflect</span><span class="op" id="1956092">.</span><span class="ident" id="1956093">Int8</span><span class="op" id="1956097">,</span>&nbsp;<span class="ident" id="1956099">reflect</span><span class="op" id="1956106">.</span><span class="ident" id="1956107">Int16</span><span class="op" id="1956112">,</span>&nbsp;<span class="ident" id="1956114">reflect</span><span class="op" id="1956121">.</span><span class="ident" id="1956122">Int32</span><span class="op" id="1956127">,</span>&nbsp;<span class="ident" id="1956129">reflect</span><span class="op" id="1956136">.</span><span class="ident" id="1956137">Int64</span><span class="op" id="1956142">:</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1956147">v</span><span class="op" id="1956148">.</span><span class="ident" id="1956149">SetInt</span><span class="op" id="1956155">(</span><span class="ident" id="1956156">s</span><span class="op" id="1956157">.</span><span class="ident" id="1956158">scanInt</span><span class="op" id="1956165">(</span><span class="ident" id="1956166">verb</span><span class="op" id="1956170">,</span>&nbsp;<span class="ident" id="1956172">v</span><span class="op" id="1956173">.</span><span class="ident" id="1956174">Type</span><span class="op" id="1956178">(</span><span class="op" id="1956179">)</span><span class="op" id="1956180">.</span><span class="ident" id="1956181">Bits</span><span class="op" id="1956185">(</span><span class="op" id="1956186">)</span><span class="op" id="1956187">)</span><span class="op" id="1956188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1956192">case</span>&nbsp;<span class="ident" id="1956197">reflect</span><span class="op" id="1956204">.</span><span class="ident" id="1956205">Uint</span><span class="op" id="1956209">,</span>&nbsp;<span class="ident" id="1956211">reflect</span><span class="op" id="1956218">.</span><span class="ident" id="1956219">Uint8</span><span class="op" id="1956224">,</span>&nbsp;<span class="ident" id="1956226">reflect</span><span class="op" id="1956233">.</span><span class="ident" id="1956234">Uint16</span><span class="op" id="1956240">,</span>&nbsp;<span class="ident" id="1956242">reflect</span><span class="op" id="1956249">.</span><span class="ident" id="1956250">Uint32</span><span class="op" id="1956256">,</span>&nbsp;<span class="ident" id="1956258">reflect</span><span class="op" id="1956265">.</span><span class="ident" id="1956266">Uint64</span><span class="op" id="1956272">,</span>&nbsp;<span class="ident" id="1956274">reflect</span><span class="op" id="1956281">.</span><span class="ident" id="1956282">Uintptr</span><span class="op" id="1956289">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1956294">v</span><span class="op" id="1956295">.</span><span class="ident" id="1956296">SetUint</span><span class="op" id="1956303">(</span><span class="ident" id="1956304">s</span><span class="op" id="1956305">.</span><span class="ident" id="1956306">scanUint</span><span class="op" id="1956314">(</span><span class="ident" id="1956315">verb</span><span class="op" id="1956319">,</span>&nbsp;<span class="ident" id="1956321">v</span><span class="op" id="1956322">.</span><span class="ident" id="1956323">Type</span><span class="op" id="1956327">(</span><span class="op" id="1956328">)</span><span class="op" id="1956329">.</span><span class="ident" id="1956330">Bits</span><span class="op" id="1956334">(</span><span class="op" id="1956335">)</span><span class="op" id="1956336">)</span><span class="op" id="1956337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1956341">case</span>&nbsp;<span class="ident" id="1956346">reflect</span><span class="op" id="1956353">.</span><span class="ident" id="1956354">String</span><span class="op" id="1956360">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1956365">v</span><span class="op" id="1956366">.</span><span class="ident" id="1956367">SetString</span><span class="op" id="1956376">(</span><span class="ident" id="1956377">s</span><span class="op" id="1956378">.</span><span class="ident" id="1956379">convertString</span><span class="op" id="1956392">(</span><span class="ident" id="1956393">verb</span><span class="op" id="1956397">)</span><span class="op" id="1956398">)</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1956402">case</span>&nbsp;<span class="ident" id="1956407">reflect</span><span class="op" id="1956414">.</span><span class="ident" id="1956415">Slice</span><span class="op" id="1956420">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1956425">//&nbsp;For&nbsp;now,&nbsp;can&nbsp;only&nbsp;handle&nbsp;(renamed)&nbsp;[]byte.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1956474">typ</span>&nbsp;<span class="op" id="1956478">:=</span>&nbsp;<span class="ident" id="1956481">v</span><span class="op" id="1956482">.</span><span class="ident" id="1956483">Type</span><span class="op" id="1956487">(</span><span class="op" id="1956488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1956493">if</span>&nbsp;<span class="ident" id="1956496">typ</span><span class="op" id="1956499">.</span><span class="ident" id="1956500">Elem</span><span class="op" id="1956504">(</span><span class="op" id="1956505">)</span><span class="op" id="1956506">.</span><span class="ident" id="1956507">Kind</span><span class="op" id="1956511">(</span><span class="op" id="1956512">)</span>&nbsp;<span class="op" id="1956514">!=</span>&nbsp;<span class="ident" id="1956517">reflect</span><span class="op" id="1956524">.</span><span class="ident" id="1956525">Uint8</span>&nbsp;<span class="op" id="1956531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1956537">s</span><span class="op" id="1956538">.</span><span class="ident" id="1956539">errorString</span><span class="op" id="1956550">(</span><span class="string" id="1956551">&#34;can&#39;t&nbsp;scan&nbsp;type:&nbsp;&#34;</span>&nbsp;<span class="op" id="1956571">+</span>&nbsp;<span class="ident" id="1956573">val</span><span class="op" id="1956576">.</span><span class="ident" id="1956577">Type</span><span class="op" id="1956581">(</span><span class="op" id="1956582">)</span><span class="op" id="1956583">.</span><span class="ident" id="1956584">String</span><span class="op" id="1956590">(</span><span class="op" id="1956591">)</span><span class="op" id="1956592">)</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1956597">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1956602">str</span>&nbsp;<span class="op" id="1956606">:=</span>&nbsp;<span class="ident" id="1956609">s</span><span class="op" id="1956610">.</span><span class="ident" id="1956611">convertString</span><span class="op" id="1956624">(</span><span class="ident" id="1956625">verb</span><span class="op" id="1956629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1956634">v</span><span class="op" id="1956635">.</span><span class="ident" id="1956636">Set</span><span class="op" id="1956639">(</span><span class="ident" id="1956640">reflect</span><span class="op" id="1956647">.</span><span class="ident" id="1956648">MakeSlice</span><span class="op" id="1956657">(</span><span class="ident" id="1956658">typ</span><span class="op" id="1956661">,</span>&nbsp;<span class="builtinfunc" id="1956663">len</span><span class="op" id="1956666">(</span><span class="ident" id="1956667">str</span><span class="op" id="1956670">)</span><span class="op" id="1956671">,</span>&nbsp;<span class="builtinfunc" id="1956673">len</span><span class="op" id="1956676">(</span><span class="ident" id="1956677">str</span><span class="op" id="1956680">)</span><span class="op" id="1956681">)</span><span class="op" id="1956682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1956687">for</span>&nbsp;<span class="ident" id="1956691">i</span>&nbsp;<span class="op" id="1956693">:=</span>&nbsp;<span class="num" id="1956696">0</span><span class="op" id="1956697">;</span>&nbsp;<span class="ident" id="1956699">i</span>&nbsp;<span class="op" id="1956701">&lt;</span>&nbsp;<span class="builtinfunc" id="1956703">len</span><span class="op" id="1956706">(</span><span class="ident" id="1956707">str</span><span class="op" id="1956710">)</span><span class="op" id="1956711">;</span>&nbsp;<span class="ident" id="1956713">i</span><span class="op" id="1956714">++</span>&nbsp;<span class="op" id="1956717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1956723">v</span><span class="op" id="1956724">.</span><span class="ident" id="1956725">Index</span><span class="op" id="1956730">(</span><span class="ident" id="1956731">i</span><span class="op" id="1956732">)</span><span class="op" id="1956733">.</span><span class="ident" id="1956734">SetUint</span><span class="op" id="1956741">(</span><span class="ident" id="1956742">uint64</span><span class="op" id="1956748">(</span><span class="ident" id="1956749">str</span><span class="op" id="1956752">[</span><span class="ident" id="1956753">i</span><span class="op" id="1956754">]</span><span class="op" id="1956755">)</span><span class="op" id="1956756">)</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1956761">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1956765">case</span>&nbsp;<span class="ident" id="1956770">reflect</span><span class="op" id="1956777">.</span><span class="ident" id="1956778">Float32</span><span class="op" id="1956785">,</span>&nbsp;<span class="ident" id="1956787">reflect</span><span class="op" id="1956794">.</span><span class="ident" id="1956795">Float64</span><span class="op" id="1956802">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1956807">s</span><span class="op" id="1956808">.</span><span class="ident" id="1956809">skipSpace</span><span class="op" id="1956818">(</span><span class="ident" id="1956819">false</span><span class="op" id="1956824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1956829">s</span><span class="op" id="1956830">.</span><span class="ident" id="1956831">notEOF</span><span class="op" id="1956837">(</span><span class="op" id="1956838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1956843">v</span><span class="op" id="1956844">.</span><span class="ident" id="1956845">SetFloat</span><span class="op" id="1956853">(</span><span class="ident" id="1956854">s</span><span class="op" id="1956855">.</span><span class="ident" id="1956856">convertFloat</span><span class="op" id="1956868">(</span><span class="ident" id="1956869">s</span><span class="op" id="1956870">.</span><span class="ident" id="1956871">floatToken</span><span class="op" id="1956881">(</span><span class="op" id="1956882">)</span><span class="op" id="1956883">,</span>&nbsp;<span class="ident" id="1956885">v</span><span class="op" id="1956886">.</span><span class="ident" id="1956887">Type</span><span class="op" id="1956891">(</span><span class="op" id="1956892">)</span><span class="op" id="1956893">.</span><span class="ident" id="1956894">Bits</span><span class="op" id="1956898">(</span><span class="op" id="1956899">)</span><span class="op" id="1956900">)</span><span class="op" id="1956901">)</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1956905">case</span>&nbsp;<span class="ident" id="1956910">reflect</span><span class="op" id="1956917">.</span><span class="ident" id="1956918">Complex64</span><span class="op" id="1956927">,</span>&nbsp;<span class="ident" id="1956929">reflect</span><span class="op" id="1956936">.</span><span class="ident" id="1956937">Complex128</span><span class="op" id="1956947">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1956952">v</span><span class="op" id="1956953">.</span><span class="ident" id="1956954">SetComplex</span><span class="op" id="1956964">(</span><span class="ident" id="1956965">s</span><span class="op" id="1956966">.</span><span class="ident" id="1956967">scanComplex</span><span class="op" id="1956978">(</span><span class="ident" id="1956979">verb</span><span class="op" id="1956983">,</span>&nbsp;<span class="ident" id="1956985">v</span><span class="op" id="1956986">.</span><span class="ident" id="1956987">Type</span><span class="op" id="1956991">(</span><span class="op" id="1956992">)</span><span class="op" id="1956993">.</span><span class="ident" id="1956994">Bits</span><span class="op" id="1956998">(</span><span class="op" id="1956999">)</span><span class="op" id="1957000">)</span><span class="op" id="1957001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1957005">default</span><span class="op" id="1957012">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1957017">s</span><span class="op" id="1957018">.</span><span class="ident" id="1957019">errorString</span><span class="op" id="1957030">(</span><span class="string" id="1957031">&#34;can&#39;t&nbsp;scan&nbsp;type:&nbsp;&#34;</span>&nbsp;<span class="op" id="1957051">+</span>&nbsp;<span class="ident" id="1957053">val</span><span class="op" id="1957056">.</span><span class="ident" id="1957057">Type</span><span class="op" id="1957061">(</span><span class="op" id="1957062">)</span><span class="op" id="1957063">.</span><span class="ident" id="1957064">String</span><span class="op" id="1957070">(</span><span class="op" id="1957071">)</span><span class="op" id="1957072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1957076">}</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1957079">}</span><br>
<span class="lineno"></span><span class="op" id="1957081">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1957084">//&nbsp;errorHandler&nbsp;turns&nbsp;local&nbsp;panics&nbsp;into&nbsp;error&nbsp;returns.</span><br>
<span class="lineno"></span><span class="keyword" id="1957139">func</span>&nbsp;<span class="ident" id="1957144">errorHandler</span><span class="op" id="1957156">(</span><span class="ident" id="1957157">errp</span>&nbsp;<span class="op" id="1957162">*</span><span class="builtintype" id="1957163">error</span><span class="op" id="1957168">)</span>&nbsp;<span class="op" id="1957170">{</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1957173">if</span>&nbsp;<span class="ident" id="1957176">e</span>&nbsp;<span class="op" id="1957178">:=</span>&nbsp;<span class="builtinfunc" id="1957181">recover</span><span class="op" id="1957188">(</span><span class="op" id="1957189">)</span><span class="op" id="1957190">;</span>&nbsp;<span class="ident" id="1957192">e</span>&nbsp;<span class="op" id="1957194">!=</span>&nbsp;<span class="ident" id="1957197">nil</span>&nbsp;<span class="op" id="1957201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1957205">if</span>&nbsp;<span class="ident" id="1957208">se</span><span class="op" id="1957210">,</span>&nbsp;<span class="ident" id="1957212">ok</span>&nbsp;<span class="op" id="1957215">:=</span>&nbsp;<span class="ident" id="1957218">e</span><span class="op" id="1957219">.</span><span class="op" id="1957220">(</span><span class="ident" id="1957221">scanError</span><span class="op" id="1957230">)</span><span class="op" id="1957231">;</span>&nbsp;<span class="ident" id="1957233">ok</span>&nbsp;<span class="op" id="1957236">{</span>&nbsp;<span class="comment" id="1957238">//&nbsp;catch&nbsp;local&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1957262">*</span><span class="ident" id="1957263">errp</span>&nbsp;<span class="op" id="1957268">=</span>&nbsp;<span class="ident" id="1957270">se</span><span class="op" id="1957272">.</span><span class="ident" id="1957273">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1957279">}</span>&nbsp;<span class="keyword" id="1957281">else</span>&nbsp;<span class="keyword" id="1957286">if</span>&nbsp;<span class="ident" id="1957289">eof</span><span class="op" id="1957292">,</span>&nbsp;<span class="ident" id="1957294">ok</span>&nbsp;<span class="op" id="1957297">:=</span>&nbsp;<span class="ident" id="1957300">e</span><span class="op" id="1957301">.</span><span class="op" id="1957302">(</span><span class="builtintype" id="1957303">error</span><span class="op" id="1957308">)</span><span class="op" id="1957309">;</span>&nbsp;<span class="ident" id="1957311">ok</span>&nbsp;<span class="op" id="1957314">&amp;&amp;</span>&nbsp;<span class="ident" id="1957317">eof</span>&nbsp;<span class="op" id="1957321">==</span>&nbsp;<span class="ident" id="1957324">io</span><span class="op" id="1957326">.</span><span class="ident" id="1957327">EOF</span>&nbsp;<span class="op" id="1957331">{</span>&nbsp;<span class="comment" id="1957333">//&nbsp;out&nbsp;of&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1957352">*</span><span class="ident" id="1957353">errp</span>&nbsp;<span class="op" id="1957358">=</span>&nbsp;<span class="ident" id="1957360">eof</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1957366">}</span>&nbsp;<span class="keyword" id="1957368">else</span>&nbsp;<span class="op" id="1957373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1957378">panic</span><span class="op" id="1957383">(</span><span class="ident" id="1957384">e</span><span class="op" id="1957385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1957389">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1957392">}</span><br>
<span class="lineno"></span><span class="op" id="1957394">}</span><br>
<span class="lineno">1045</span><br>
<span class="lineno"></span><span class="comment" id="1957397">//&nbsp;doScan&nbsp;does&nbsp;the&nbsp;real&nbsp;work&nbsp;for&nbsp;scanning&nbsp;without&nbsp;a&nbsp;format&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="1957464">func</span>&nbsp;<span class="op" id="1957469">(</span><span class="ident" id="1957470">s</span>&nbsp;<span class="op" id="1957472">*</span><span class="ident" id="1957473">ss</span><span class="op" id="1957475">)</span>&nbsp;<span class="ident" id="1957477">doScan</span><span class="op" id="1957483">(</span><span class="ident" id="1957484">a</span>&nbsp;<span class="op" id="1957486">[</span><span class="op" id="1957487">]</span><span class="keyword" id="1957488">interface</span><span class="op" id="1957497">{</span><span class="op" id="1957498">}</span><span class="op" id="1957499">)</span>&nbsp;<span class="op" id="1957501">(</span><span class="ident" id="1957502">numProcessed</span>&nbsp;<span class="builtintype" id="1957515">int</span><span class="op" id="1957518">,</span>&nbsp;<span class="ident" id="1957520">err</span>&nbsp;<span class="builtintype" id="1957524">error</span><span class="op" id="1957529">)</span>&nbsp;<span class="op" id="1957531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1957534">defer</span>&nbsp;<span class="ident" id="1957540">errorHandler</span><span class="op" id="1957552">(</span><span class="op" id="1957553">&amp;</span><span class="ident" id="1957554">err</span><span class="op" id="1957557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1957560">for</span>&nbsp;<span class="ident" id="1957564">_</span><span class="op" id="1957565">,</span>&nbsp;<span class="ident" id="1957567">arg</span>&nbsp;<span class="op" id="1957571">:=</span>&nbsp;<span class="keyword" id="1957574">range</span>&nbsp;<span class="ident" id="1957580">a</span>&nbsp;<span class="op" id="1957582">{</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1957586">s</span><span class="op" id="1957587">.</span><span class="ident" id="1957588">scanOne</span><span class="op" id="1957595">(</span><span class="string" id="1957596">&#39;v&#39;</span><span class="op" id="1957599">,</span>&nbsp;<span class="ident" id="1957601">arg</span><span class="op" id="1957604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1957608">numProcessed</span><span class="op" id="1957620">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1957624">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1957627">//&nbsp;Check&nbsp;for&nbsp;newline&nbsp;if&nbsp;required.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1957662">if</span>&nbsp;<span class="op" id="1957665">!</span><span class="ident" id="1957666">s</span><span class="op" id="1957667">.</span><span class="ident" id="1957668">nlIsSpace</span>&nbsp;<span class="op" id="1957678">{</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1957682">for</span>&nbsp;<span class="op" id="1957686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1957691">r</span>&nbsp;<span class="op" id="1957693">:=</span>&nbsp;<span class="ident" id="1957696">s</span><span class="op" id="1957697">.</span><span class="ident" id="1957698">getRune</span><span class="op" id="1957705">(</span><span class="op" id="1957706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1957711">if</span>&nbsp;<span class="ident" id="1957714">r</span>&nbsp;<span class="op" id="1957716">==</span>&nbsp;<span class="string" id="1957719">&#39;\n&#39;</span>&nbsp;<span class="op" id="1957724">||</span>&nbsp;<span class="ident" id="1957727">r</span>&nbsp;<span class="op" id="1957729">==</span>&nbsp;<span class="ident" id="1957732">eof</span>&nbsp;<span class="op" id="1957736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1957742">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1957751">}</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1957756">if</span>&nbsp;<span class="op" id="1957759">!</span><span class="ident" id="1957760">isSpace</span><span class="op" id="1957767">(</span><span class="ident" id="1957768">r</span><span class="op" id="1957769">)</span>&nbsp;<span class="op" id="1957771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1957777">s</span><span class="op" id="1957778">.</span><span class="ident" id="1957779">errorString</span><span class="op" id="1957790">(</span><span class="string" id="1957791">&#34;expected&nbsp;newline&#34;</span><span class="op" id="1957809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1957815">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1957824">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1957828">}</span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1957831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1957834">return</span><br>
<span class="lineno"></span><span class="op" id="1957841">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1957844">//&nbsp;advance&nbsp;determines&nbsp;whether&nbsp;the&nbsp;next&nbsp;characters&nbsp;in&nbsp;the&nbsp;input&nbsp;match</span><br>
<span class="lineno">1070</span><span class="comment" id="1957913">//&nbsp;those&nbsp;of&nbsp;the&nbsp;format.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;(sic)&nbsp;consumed</span><br>
<span class="lineno"></span><span class="comment" id="1957984">//&nbsp;in&nbsp;the&nbsp;format.&nbsp;Newlines&nbsp;included,&nbsp;all&nbsp;runs&nbsp;of&nbsp;space&nbsp;characters&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="1958053">//&nbsp;either&nbsp;input&nbsp;or&nbsp;format&nbsp;behave&nbsp;as&nbsp;a&nbsp;single&nbsp;space.&nbsp;This&nbsp;routine&nbsp;also</span><br>
<span class="lineno"></span><span class="comment" id="1958123">//&nbsp;handles&nbsp;the&nbsp;%%&nbsp;case.&nbsp;&nbsp;If&nbsp;the&nbsp;return&nbsp;value&nbsp;is&nbsp;zero,&nbsp;either&nbsp;format</span><br>
<span class="lineno"></span><span class="comment" id="1958191">//&nbsp;starts&nbsp;with&nbsp;a&nbsp;%&nbsp;(with&nbsp;no&nbsp;following&nbsp;%)&nbsp;or&nbsp;the&nbsp;input&nbsp;is&nbsp;empty.</span><br>
<span class="lineno">1075</span><span class="comment" id="1958255">//&nbsp;If&nbsp;it&nbsp;is&nbsp;negative,&nbsp;the&nbsp;input&nbsp;did&nbsp;not&nbsp;match&nbsp;the&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="1958313">func</span>&nbsp;<span class="op" id="1958318">(</span><span class="ident" id="1958319">s</span>&nbsp;<span class="op" id="1958321">*</span><span class="ident" id="1958322">ss</span><span class="op" id="1958324">)</span>&nbsp;<span class="ident" id="1958326">advance</span><span class="op" id="1958333">(</span><span class="ident" id="1958334">format</span>&nbsp;<span class="builtintype" id="1958341">string</span><span class="op" id="1958347">)</span>&nbsp;<span class="op" id="1958349">(</span><span class="ident" id="1958350">i</span>&nbsp;<span class="builtintype" id="1958352">int</span><span class="op" id="1958355">)</span>&nbsp;<span class="op" id="1958357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1958360">for</span>&nbsp;<span class="ident" id="1958364">i</span>&nbsp;<span class="op" id="1958366">&lt;</span>&nbsp;<span class="builtinfunc" id="1958368">len</span><span class="op" id="1958371">(</span><span class="ident" id="1958372">format</span><span class="op" id="1958378">)</span>&nbsp;<span class="op" id="1958380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1958384">fmtc</span><span class="op" id="1958388">,</span>&nbsp;<span class="ident" id="1958390">w</span>&nbsp;<span class="op" id="1958392">:=</span>&nbsp;<span class="ident" id="1958395">utf8</span><span class="op" id="1958399">.</span><span class="ident" id="1958400">DecodeRuneInString</span><span class="op" id="1958418">(</span><span class="ident" id="1958419">format</span><span class="op" id="1958425">[</span><span class="ident" id="1958426">i</span><span class="op" id="1958427">:</span><span class="op" id="1958428">]</span><span class="op" id="1958429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1958433">if</span>&nbsp;<span class="ident" id="1958436">fmtc</span>&nbsp;<span class="op" id="1958441">==</span>&nbsp;<span class="string" id="1958444">&#39;%&#39;</span>&nbsp;<span class="op" id="1958448">{</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1958453">//&nbsp;%%&nbsp;acts&nbsp;like&nbsp;a&nbsp;real&nbsp;percent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1958487">nextc</span><span class="op" id="1958492">,</span>&nbsp;<span class="ident" id="1958494">_</span>&nbsp;<span class="op" id="1958496">:=</span>&nbsp;<span class="ident" id="1958499">utf8</span><span class="op" id="1958503">.</span><span class="ident" id="1958504">DecodeRuneInString</span><span class="op" id="1958522">(</span><span class="ident" id="1958523">format</span><span class="op" id="1958529">[</span><span class="ident" id="1958530">i</span><span class="op" id="1958531">+</span><span class="ident" id="1958532">w</span><span class="op" id="1958533">:</span><span class="op" id="1958534">]</span><span class="op" id="1958535">)</span>&nbsp;<span class="comment" id="1958537">//&nbsp;will&nbsp;not&nbsp;match&nbsp;%&nbsp;if&nbsp;string&nbsp;is&nbsp;empty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1958579">if</span>&nbsp;<span class="ident" id="1958582">nextc</span>&nbsp;<span class="op" id="1958588">!=</span>&nbsp;<span class="string" id="1958591">&#39;%&#39;</span>&nbsp;<span class="op" id="1958595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1958601">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1958611">}</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1958616">i</span>&nbsp;<span class="op" id="1958618">+=</span>&nbsp;<span class="ident" id="1958621">w</span>&nbsp;<span class="comment" id="1958623">//&nbsp;skip&nbsp;the&nbsp;first&nbsp;%</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1958645">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1958649">sawSpace</span>&nbsp;<span class="op" id="1958658">:=</span>&nbsp;<span class="ident" id="1958661">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1958669">for</span>&nbsp;<span class="ident" id="1958673">isSpace</span><span class="op" id="1958680">(</span><span class="ident" id="1958681">fmtc</span><span class="op" id="1958685">)</span>&nbsp;<span class="op" id="1958687">&amp;&amp;</span>&nbsp;<span class="ident" id="1958690">i</span>&nbsp;<span class="op" id="1958692">&lt;</span>&nbsp;<span class="builtinfunc" id="1958694">len</span><span class="op" id="1958697">(</span><span class="ident" id="1958698">format</span><span class="op" id="1958704">)</span>&nbsp;<span class="op" id="1958706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1958711">sawSpace</span>&nbsp;<span class="op" id="1958720">=</span>&nbsp;<span class="ident" id="1958722">true</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1958730">i</span>&nbsp;<span class="op" id="1958732">+=</span>&nbsp;<span class="ident" id="1958735">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1958740">fmtc</span><span class="op" id="1958744">,</span>&nbsp;<span class="ident" id="1958746">w</span>&nbsp;<span class="op" id="1958748">=</span>&nbsp;<span class="ident" id="1958750">utf8</span><span class="op" id="1958754">.</span><span class="ident" id="1958755">DecodeRuneInString</span><span class="op" id="1958773">(</span><span class="ident" id="1958774">format</span><span class="op" id="1958780">[</span><span class="ident" id="1958781">i</span><span class="op" id="1958782">:</span><span class="op" id="1958783">]</span><span class="op" id="1958784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1958788">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1958792">if</span>&nbsp;<span class="ident" id="1958795">sawSpace</span>&nbsp;<span class="op" id="1958804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1958809">//&nbsp;There&nbsp;was&nbsp;space&nbsp;in&nbsp;the&nbsp;format,&nbsp;so&nbsp;there&nbsp;should&nbsp;be&nbsp;space&nbsp;(EOF)</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1958877">//&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1958897">inputc</span>&nbsp;<span class="op" id="1958904">:=</span>&nbsp;<span class="ident" id="1958907">s</span><span class="op" id="1958908">.</span><span class="ident" id="1958909">getRune</span><span class="op" id="1958916">(</span><span class="op" id="1958917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1958922">if</span>&nbsp;<span class="ident" id="1958925">inputc</span>&nbsp;<span class="op" id="1958932">==</span>&nbsp;<span class="ident" id="1958935">eof</span>&nbsp;<span class="op" id="1958939">||</span>&nbsp;<span class="ident" id="1958942">inputc</span>&nbsp;<span class="op" id="1958949">==</span>&nbsp;<span class="string" id="1958952">&#39;\n&#39;</span>&nbsp;<span class="op" id="1958957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1958963">//&nbsp;If&nbsp;we&#39;ve&nbsp;reached&nbsp;a&nbsp;newline,&nbsp;stop&nbsp;now;&nbsp;don&#39;t&nbsp;read&nbsp;ahead.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1959026">return</span><br>
<span class="lineno">1100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1959036">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1959041">if</span>&nbsp;<span class="op" id="1959044">!</span><span class="ident" id="1959045">isSpace</span><span class="op" id="1959052">(</span><span class="ident" id="1959053">inputc</span><span class="op" id="1959059">)</span>&nbsp;<span class="op" id="1959061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1959067">//&nbsp;Space&nbsp;in&nbsp;format&nbsp;but&nbsp;not&nbsp;in&nbsp;input:&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1959114">s</span><span class="op" id="1959115">.</span><span class="ident" id="1959116">errorString</span><span class="op" id="1959127">(</span><span class="string" id="1959128">&#34;expected&nbsp;space&nbsp;in&nbsp;input&nbsp;to&nbsp;match&nbsp;format&#34;</span><span class="op" id="1959169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1959174">}</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1959179">s</span><span class="op" id="1959180">.</span><span class="ident" id="1959181">skipSpace</span><span class="op" id="1959190">(</span><span class="ident" id="1959191">true</span><span class="op" id="1959195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1959200">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1959211">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1959215">inputc</span>&nbsp;<span class="op" id="1959222">:=</span>&nbsp;<span class="ident" id="1959225">s</span><span class="op" id="1959226">.</span><span class="ident" id="1959227">mustReadRune</span><span class="op" id="1959239">(</span><span class="op" id="1959240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1959244">if</span>&nbsp;<span class="ident" id="1959247">fmtc</span>&nbsp;<span class="op" id="1959252">!=</span>&nbsp;<span class="ident" id="1959255">inputc</span>&nbsp;<span class="op" id="1959262">{</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1959267">s</span><span class="op" id="1959268">.</span><span class="ident" id="1959269">UnreadRune</span><span class="op" id="1959279">(</span><span class="op" id="1959280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1959285">return</span>&nbsp;<span class="op" id="1959292">-</span><span class="num" id="1959293">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1959297">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1959301">i</span>&nbsp;<span class="op" id="1959303">+=</span>&nbsp;<span class="ident" id="1959306">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1959309">}</span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1959312">return</span><br>
<span class="lineno"></span><span class="op" id="1959319">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1959322">//&nbsp;doScanf&nbsp;does&nbsp;the&nbsp;real&nbsp;work&nbsp;when&nbsp;scanning&nbsp;with&nbsp;a&nbsp;format&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="1959388">//&nbsp;&nbsp;At&nbsp;the&nbsp;moment,&nbsp;it&nbsp;handles&nbsp;only&nbsp;pointers&nbsp;to&nbsp;basic&nbsp;types.</span><br>
<span class="lineno">1120</span><span class="keyword" id="1959448">func</span>&nbsp;<span class="op" id="1959453">(</span><span class="ident" id="1959454">s</span>&nbsp;<span class="op" id="1959456">*</span><span class="ident" id="1959457">ss</span><span class="op" id="1959459">)</span>&nbsp;<span class="ident" id="1959461">doScanf</span><span class="op" id="1959468">(</span><span class="ident" id="1959469">format</span>&nbsp;<span class="builtintype" id="1959476">string</span><span class="op" id="1959482">,</span>&nbsp;<span class="ident" id="1959484">a</span>&nbsp;<span class="op" id="1959486">[</span><span class="op" id="1959487">]</span><span class="keyword" id="1959488">interface</span><span class="op" id="1959497">{</span><span class="op" id="1959498">}</span><span class="op" id="1959499">)</span>&nbsp;<span class="op" id="1959501">(</span><span class="ident" id="1959502">numProcessed</span>&nbsp;<span class="builtintype" id="1959515">int</span><span class="op" id="1959518">,</span>&nbsp;<span class="ident" id="1959520">err</span>&nbsp;<span class="builtintype" id="1959524">error</span><span class="op" id="1959529">)</span>&nbsp;<span class="op" id="1959531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1959534">defer</span>&nbsp;<span class="ident" id="1959540">errorHandler</span><span class="op" id="1959552">(</span><span class="op" id="1959553">&amp;</span><span class="ident" id="1959554">err</span><span class="op" id="1959557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1959560">end</span>&nbsp;<span class="op" id="1959564">:=</span>&nbsp;<span class="builtinfunc" id="1959567">len</span><span class="op" id="1959570">(</span><span class="ident" id="1959571">format</span><span class="op" id="1959577">)</span>&nbsp;<span class="op" id="1959579">-</span>&nbsp;<span class="num" id="1959581">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1959584">//&nbsp;We&nbsp;process&nbsp;one&nbsp;item&nbsp;per&nbsp;non-trivial&nbsp;format</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1959631">for</span>&nbsp;<span class="ident" id="1959635">i</span>&nbsp;<span class="op" id="1959637">:=</span>&nbsp;<span class="num" id="1959640">0</span><span class="op" id="1959641">;</span>&nbsp;<span class="ident" id="1959643">i</span>&nbsp;<span class="op" id="1959645">&lt;=</span>&nbsp;<span class="ident" id="1959648">end</span><span class="op" id="1959651">;</span>&nbsp;<span class="op" id="1959653">{</span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1959657">w</span>&nbsp;<span class="op" id="1959659">:=</span>&nbsp;<span class="ident" id="1959662">s</span><span class="op" id="1959663">.</span><span class="ident" id="1959664">advance</span><span class="op" id="1959671">(</span><span class="ident" id="1959672">format</span><span class="op" id="1959678">[</span><span class="ident" id="1959679">i</span><span class="op" id="1959680">:</span><span class="op" id="1959681">]</span><span class="op" id="1959682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1959686">if</span>&nbsp;<span class="ident" id="1959689">w</span>&nbsp;<span class="op" id="1959691">&gt;</span>&nbsp;<span class="num" id="1959693">0</span>&nbsp;<span class="op" id="1959695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1959700">i</span>&nbsp;<span class="op" id="1959702">+=</span>&nbsp;<span class="ident" id="1959705">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1959710">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1959721">}</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1959725">//&nbsp;Either&nbsp;we&nbsp;failed&nbsp;to&nbsp;advance,&nbsp;we&nbsp;have&nbsp;a&nbsp;percent&nbsp;character,&nbsp;or&nbsp;we&nbsp;ran&nbsp;out&nbsp;of&nbsp;input.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1959812">if</span>&nbsp;<span class="ident" id="1959815">format</span><span class="op" id="1959821">[</span><span class="ident" id="1959822">i</span><span class="op" id="1959823">]</span>&nbsp;<span class="op" id="1959825">!=</span>&nbsp;<span class="string" id="1959828">&#39;%&#39;</span>&nbsp;<span class="op" id="1959832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1959837">//&nbsp;Can&#39;t&nbsp;advance&nbsp;format.&nbsp;&nbsp;Why&nbsp;not?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1959875">if</span>&nbsp;<span class="ident" id="1959878">w</span>&nbsp;<span class="op" id="1959880">&lt;</span>&nbsp;<span class="num" id="1959882">0</span>&nbsp;<span class="op" id="1959884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1959890">s</span><span class="op" id="1959891">.</span><span class="ident" id="1959892">errorString</span><span class="op" id="1959903">(</span><span class="string" id="1959904">&#34;input&nbsp;does&nbsp;not&nbsp;match&nbsp;format&#34;</span><span class="op" id="1959933">)</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1959938">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1959943">//&nbsp;Otherwise&nbsp;at&nbsp;EOF;&nbsp;&#34;too&nbsp;many&nbsp;operands&#34;&nbsp;error&nbsp;handled&nbsp;below</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1960007">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1960015">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1960019">i</span><span class="op" id="1960020">++</span>&nbsp;<span class="comment" id="1960023">//&nbsp;%&nbsp;is&nbsp;one&nbsp;byte</span><br>
<span class="lineno">1140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1960043">//&nbsp;do&nbsp;we&nbsp;have&nbsp;20&nbsp;(width)?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1960071">var</span>&nbsp;<span class="ident" id="1960075">widPresent</span>&nbsp;<span class="builtintype" id="1960086">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1960093">s</span><span class="op" id="1960094">.</span><span class="ident" id="1960095">maxWid</span><span class="op" id="1960101">,</span>&nbsp;<span class="ident" id="1960103">widPresent</span><span class="op" id="1960113">,</span>&nbsp;<span class="ident" id="1960115">i</span>&nbsp;<span class="op" id="1960117">=</span>&nbsp;<span class="ident" id="1960119">parsenum</span><span class="op" id="1960127">(</span><span class="ident" id="1960128">format</span><span class="op" id="1960134">,</span>&nbsp;<span class="ident" id="1960136">i</span><span class="op" id="1960137">,</span>&nbsp;<span class="ident" id="1960139">end</span><span class="op" id="1960142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1960146">if</span>&nbsp;<span class="op" id="1960149">!</span><span class="ident" id="1960150">widPresent</span>&nbsp;<span class="op" id="1960161">{</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1960166">s</span><span class="op" id="1960167">.</span><span class="ident" id="1960168">maxWid</span>&nbsp;<span class="op" id="1960175">=</span>&nbsp;<span class="ident" id="1960177">hugeWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1960187">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1960191">s</span><span class="op" id="1960192">.</span><span class="ident" id="1960193">argLimit</span>&nbsp;<span class="op" id="1960202">=</span>&nbsp;<span class="ident" id="1960204">s</span><span class="op" id="1960205">.</span><span class="ident" id="1960206">limit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1960214">if</span>&nbsp;<span class="ident" id="1960217">f</span>&nbsp;<span class="op" id="1960219">:=</span>&nbsp;<span class="ident" id="1960222">s</span><span class="op" id="1960223">.</span><span class="ident" id="1960224">count</span>&nbsp;<span class="op" id="1960230">+</span>&nbsp;<span class="ident" id="1960232">s</span><span class="op" id="1960233">.</span><span class="ident" id="1960234">maxWid</span><span class="op" id="1960240">;</span>&nbsp;<span class="ident" id="1960242">f</span>&nbsp;<span class="op" id="1960244">&lt;</span>&nbsp;<span class="ident" id="1960246">s</span><span class="op" id="1960247">.</span><span class="ident" id="1960248">argLimit</span>&nbsp;<span class="op" id="1960257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1960262">s</span><span class="op" id="1960263">.</span><span class="ident" id="1960264">argLimit</span>&nbsp;<span class="op" id="1960273">=</span>&nbsp;<span class="ident" id="1960275">f</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1960279">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1960284">c</span><span class="op" id="1960285">,</span>&nbsp;<span class="ident" id="1960287">w</span>&nbsp;<span class="op" id="1960289">:=</span>&nbsp;<span class="ident" id="1960292">utf8</span><span class="op" id="1960296">.</span><span class="ident" id="1960297">DecodeRuneInString</span><span class="op" id="1960315">(</span><span class="ident" id="1960316">format</span><span class="op" id="1960322">[</span><span class="ident" id="1960323">i</span><span class="op" id="1960324">:</span><span class="op" id="1960325">]</span><span class="op" id="1960326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1960330">i</span>&nbsp;<span class="op" id="1960332">+=</span>&nbsp;<span class="ident" id="1960335">w</span><br>
<span class="lineno"></span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1960340">if</span>&nbsp;<span class="ident" id="1960343">numProcessed</span>&nbsp;<span class="op" id="1960356">&gt;=</span>&nbsp;<span class="builtinfunc" id="1960359">len</span><span class="op" id="1960362">(</span><span class="ident" id="1960363">a</span><span class="op" id="1960364">)</span>&nbsp;<span class="op" id="1960366">{</span>&nbsp;<span class="comment" id="1960368">//&nbsp;out&nbsp;of&nbsp;operands</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1960390">s</span><span class="op" id="1960391">.</span><span class="ident" id="1960392">errorString</span><span class="op" id="1960403">(</span><span class="string" id="1960404">&#34;too&nbsp;few&nbsp;operands&nbsp;for&nbsp;format&nbsp;%&#34;</span>&nbsp;<span class="op" id="1960436">+</span>&nbsp;<span class="ident" id="1960438">format</span><span class="op" id="1960444">[</span><span class="ident" id="1960445">i</span><span class="op" id="1960446">-</span><span class="ident" id="1960447">w</span><span class="op" id="1960448">:</span><span class="op" id="1960449">]</span><span class="op" id="1960450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1960455">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1960463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1960467">arg</span>&nbsp;<span class="op" id="1960471">:=</span>&nbsp;<span class="ident" id="1960474">a</span><span class="op" id="1960475">[</span><span class="ident" id="1960476">numProcessed</span><span class="op" id="1960488">]</span><br>
<span class="lineno">1160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1960493">s</span><span class="op" id="1960494">.</span><span class="ident" id="1960495">scanOne</span><span class="op" id="1960502">(</span><span class="ident" id="1960503">c</span><span class="op" id="1960504">,</span>&nbsp;<span class="ident" id="1960506">arg</span><span class="op" id="1960509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1960513">numProcessed</span><span class="op" id="1960525">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1960530">s</span><span class="op" id="1960531">.</span><span class="ident" id="1960532">argLimit</span>&nbsp;<span class="op" id="1960541">=</span>&nbsp;<span class="ident" id="1960543">s</span><span class="op" id="1960544">.</span><span class="ident" id="1960545">limit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1960552">}</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1960555">if</span>&nbsp;<span class="ident" id="1960558">numProcessed</span>&nbsp;<span class="op" id="1960571">&lt;</span>&nbsp;<span class="builtinfunc" id="1960573">len</span><span class="op" id="1960576">(</span><span class="ident" id="1960577">a</span><span class="op" id="1960578">)</span>&nbsp;<span class="op" id="1960580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1960584">s</span><span class="op" id="1960585">.</span><span class="ident" id="1960586">errorString</span><span class="op" id="1960597">(</span><span class="string" id="1960598">&#34;too&nbsp;many&nbsp;operands&#34;</span><span class="op" id="1960617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1960620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1960623">return</span><br>
<span class="lineno"></span><span class="op" id="1960630">}</span>
</div>
</body>
</html>
