<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>io/ioutil</h2>
<ul>
<li><a href="/gostd/io/ioutil/ioutil.go.html">ioutil.go</a></li>
<li><a href="/gostd/io/ioutil/ioutil_test.go.html">ioutil_test.go</a></li>
<li><a href="/gostd/io/ioutil/tempfile.go.html">tempfile.go</a></li>
<li><a href="/gostd/io/ioutil/tempfile_test.go.html">tempfile_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6891244">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6891299">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6891353">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6891404">package</span>&nbsp;<span class="ident" id="6891412">ioutil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6891420">import</span>&nbsp;<span class="op" id="6891427">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6891430">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6891436">&#34;path/filepath&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6891453">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6891463">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6891473">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6891476">func</span>&nbsp;<span class="ident" id="6891481">TestTempFile</span><span class="op" id="6891493">(</span><span class="ident" id="6891494">t</span>&nbsp;<span class="op" id="6891496">*</span><span class="ident" id="6891497">testing</span><span class="op" id="6891504">.</span><span class="ident" id="6891505">T</span><span class="op" id="6891506">)</span>&nbsp;<span class="op" id="6891508">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6891511">f</span><span class="op" id="6891512">,</span>&nbsp;<span class="ident" id="6891514">err</span>&nbsp;<span class="op" id="6891518">:=</span>&nbsp;<span class="ident" id="6891521">TempFile</span><span class="op" id="6891529">(</span><span class="string" id="6891530">&#34;/_not_exists_&#34;</span><span class="op" id="6891545">,</span>&nbsp;<span class="string" id="6891547">&#34;foo&#34;</span><span class="op" id="6891552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6891555">if</span>&nbsp;<span class="ident" id="6891558">f</span>&nbsp;<span class="op" id="6891560">!=</span>&nbsp;<span class="ident" id="6891563">nil</span>&nbsp;<span class="op" id="6891567">||</span>&nbsp;<span class="ident" id="6891570">err</span>&nbsp;<span class="op" id="6891574">==</span>&nbsp;<span class="ident" id="6891577">nil</span>&nbsp;<span class="op" id="6891581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6891585">t</span><span class="op" id="6891586">.</span><span class="ident" id="6891587">Errorf</span><span class="op" id="6891593">(</span><span class="string" id="6891594">&#34;TempFile(`/_not_exists_`,&nbsp;`foo`)&nbsp;=&nbsp;%v,&nbsp;%v&#34;</span><span class="op" id="6891637">,</span>&nbsp;<span class="ident" id="6891639">f</span><span class="op" id="6891640">,</span>&nbsp;<span class="ident" id="6891642">err</span><span class="op" id="6891645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6891648">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6891652">dir</span>&nbsp;<span class="op" id="6891656">:=</span>&nbsp;<span class="ident" id="6891659">os</span><span class="op" id="6891661">.</span><span class="ident" id="6891662">TempDir</span><span class="op" id="6891669">(</span><span class="op" id="6891670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6891673">f</span><span class="op" id="6891674">,</span>&nbsp;<span class="ident" id="6891676">err</span>&nbsp;<span class="op" id="6891680">=</span>&nbsp;<span class="ident" id="6891682">TempFile</span><span class="op" id="6891690">(</span><span class="ident" id="6891691">dir</span><span class="op" id="6891694">,</span>&nbsp;<span class="string" id="6891696">&#34;ioutil_test&#34;</span><span class="op" id="6891709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6891712">if</span>&nbsp;<span class="ident" id="6891715">f</span>&nbsp;<span class="op" id="6891717">==</span>&nbsp;<span class="ident" id="6891720">nil</span>&nbsp;<span class="op" id="6891724">||</span>&nbsp;<span class="ident" id="6891727">err</span>&nbsp;<span class="op" id="6891731">!=</span>&nbsp;<span class="ident" id="6891734">nil</span>&nbsp;<span class="op" id="6891738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6891742">t</span><span class="op" id="6891743">.</span><span class="ident" id="6891744">Errorf</span><span class="op" id="6891750">(</span><span class="string" id="6891751">&#34;TempFile(dir,&nbsp;`ioutil_test`)&nbsp;=&nbsp;%v,&nbsp;%v&#34;</span><span class="op" id="6891790">,</span>&nbsp;<span class="ident" id="6891792">f</span><span class="op" id="6891793">,</span>&nbsp;<span class="ident" id="6891795">err</span><span class="op" id="6891798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6891801">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6891804">if</span>&nbsp;<span class="ident" id="6891807">f</span>&nbsp;<span class="op" id="6891809">!=</span>&nbsp;<span class="ident" id="6891812">nil</span>&nbsp;<span class="op" id="6891816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6891820">f</span><span class="op" id="6891821">.</span><span class="ident" id="6891822">Close</span><span class="op" id="6891827">(</span><span class="op" id="6891828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6891832">os</span><span class="op" id="6891834">.</span><span class="ident" id="6891835">Remove</span><span class="op" id="6891841">(</span><span class="ident" id="6891842">f</span><span class="op" id="6891843">.</span><span class="ident" id="6891844">Name</span><span class="op" id="6891848">(</span><span class="op" id="6891849">)</span><span class="op" id="6891850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6891854">re</span>&nbsp;<span class="op" id="6891857">:=</span>&nbsp;<span class="ident" id="6891860">regexp</span><span class="op" id="6891866">.</span><span class="ident" id="6891867">MustCompile</span><span class="op" id="6891878">(</span><span class="string" id="6891879">&#34;^&#34;</span>&nbsp;<span class="op" id="6891883">+</span>&nbsp;<span class="ident" id="6891885">regexp</span><span class="op" id="6891891">.</span><span class="ident" id="6891892">QuoteMeta</span><span class="op" id="6891901">(</span><span class="ident" id="6891902">filepath</span><span class="op" id="6891910">.</span><span class="ident" id="6891911">Join</span><span class="op" id="6891915">(</span><span class="ident" id="6891916">dir</span><span class="op" id="6891919">,</span>&nbsp;<span class="string" id="6891921">&#34;ioutil_test&#34;</span><span class="op" id="6891934">)</span><span class="op" id="6891935">)</span>&nbsp;<span class="op" id="6891937">+</span>&nbsp;<span class="string" id="6891939">&#34;[0-9]+$&#34;</span><span class="op" id="6891948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6891952">if</span>&nbsp;<span class="op" id="6891955">!</span><span class="ident" id="6891956">re</span><span class="op" id="6891958">.</span><span class="ident" id="6891959">MatchString</span><span class="op" id="6891970">(</span><span class="ident" id="6891971">f</span><span class="op" id="6891972">.</span><span class="ident" id="6891973">Name</span><span class="op" id="6891977">(</span><span class="op" id="6891978">)</span><span class="op" id="6891979">)</span>&nbsp;<span class="op" id="6891981">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6891986">t</span><span class="op" id="6891987">.</span><span class="ident" id="6891988">Errorf</span><span class="op" id="6891994">(</span><span class="string" id="6891995">&#34;TempFile(`&#34;</span><span class="op" id="6892007">+</span><span class="ident" id="6892008">dir</span><span class="op" id="6892011">+</span><span class="string" id="6892012">&#34;`,&nbsp;`ioutil_test`)&nbsp;created&nbsp;bad&nbsp;name&nbsp;%s&#34;</span><span class="op" id="6892051">,</span>&nbsp;<span class="ident" id="6892053">f</span><span class="op" id="6892054">.</span><span class="ident" id="6892055">Name</span><span class="op" id="6892059">(</span><span class="op" id="6892060">)</span><span class="op" id="6892061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6892065">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6892068">}</span><br>
<span class="lineno"></span><span class="op" id="6892070">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="6892073">func</span>&nbsp;<span class="ident" id="6892078">TestTempDir</span><span class="op" id="6892089">(</span><span class="ident" id="6892090">t</span>&nbsp;<span class="op" id="6892092">*</span><span class="ident" id="6892093">testing</span><span class="op" id="6892100">.</span><span class="ident" id="6892101">T</span><span class="op" id="6892102">)</span>&nbsp;<span class="op" id="6892104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6892107">name</span><span class="op" id="6892111">,</span>&nbsp;<span class="ident" id="6892113">err</span>&nbsp;<span class="op" id="6892117">:=</span>&nbsp;<span class="ident" id="6892120">TempDir</span><span class="op" id="6892127">(</span><span class="string" id="6892128">&#34;/_not_exists_&#34;</span><span class="op" id="6892143">,</span>&nbsp;<span class="string" id="6892145">&#34;foo&#34;</span><span class="op" id="6892150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6892153">if</span>&nbsp;<span class="ident" id="6892156">name</span>&nbsp;<span class="op" id="6892161">!=</span>&nbsp;<span class="string" id="6892164">&#34;&#34;</span>&nbsp;<span class="op" id="6892167">||</span>&nbsp;<span class="ident" id="6892170">err</span>&nbsp;<span class="op" id="6892174">==</span>&nbsp;<span class="ident" id="6892177">nil</span>&nbsp;<span class="op" id="6892181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6892185">t</span><span class="op" id="6892186">.</span><span class="ident" id="6892187">Errorf</span><span class="op" id="6892193">(</span><span class="string" id="6892194">&#34;TempDir(`/_not_exists_`,&nbsp;`foo`)&nbsp;=&nbsp;%v,&nbsp;%v&#34;</span><span class="op" id="6892236">,</span>&nbsp;<span class="ident" id="6892238">name</span><span class="op" id="6892242">,</span>&nbsp;<span class="ident" id="6892244">err</span><span class="op" id="6892247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6892250">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6892254">dir</span>&nbsp;<span class="op" id="6892258">:=</span>&nbsp;<span class="ident" id="6892261">os</span><span class="op" id="6892263">.</span><span class="ident" id="6892264">TempDir</span><span class="op" id="6892271">(</span><span class="op" id="6892272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6892275">name</span><span class="op" id="6892279">,</span>&nbsp;<span class="ident" id="6892281">err</span>&nbsp;<span class="op" id="6892285">=</span>&nbsp;<span class="ident" id="6892287">TempDir</span><span class="op" id="6892294">(</span><span class="ident" id="6892295">dir</span><span class="op" id="6892298">,</span>&nbsp;<span class="string" id="6892300">&#34;ioutil_test&#34;</span><span class="op" id="6892313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6892316">if</span>&nbsp;<span class="ident" id="6892319">name</span>&nbsp;<span class="op" id="6892324">==</span>&nbsp;<span class="string" id="6892327">&#34;&#34;</span>&nbsp;<span class="op" id="6892330">||</span>&nbsp;<span class="ident" id="6892333">err</span>&nbsp;<span class="op" id="6892337">!=</span>&nbsp;<span class="ident" id="6892340">nil</span>&nbsp;<span class="op" id="6892344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6892348">t</span><span class="op" id="6892349">.</span><span class="ident" id="6892350">Errorf</span><span class="op" id="6892356">(</span><span class="string" id="6892357">&#34;TempDir(dir,&nbsp;`ioutil_test`)&nbsp;=&nbsp;%v,&nbsp;%v&#34;</span><span class="op" id="6892395">,</span>&nbsp;<span class="ident" id="6892397">name</span><span class="op" id="6892401">,</span>&nbsp;<span class="ident" id="6892403">err</span><span class="op" id="6892406">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6892409">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6892412">if</span>&nbsp;<span class="ident" id="6892415">name</span>&nbsp;<span class="op" id="6892420">!=</span>&nbsp;<span class="string" id="6892423">&#34;&#34;</span>&nbsp;<span class="op" id="6892426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6892430">os</span><span class="op" id="6892432">.</span><span class="ident" id="6892433">Remove</span><span class="op" id="6892439">(</span><span class="ident" id="6892440">name</span><span class="op" id="6892444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6892448">re</span>&nbsp;<span class="op" id="6892451">:=</span>&nbsp;<span class="ident" id="6892454">regexp</span><span class="op" id="6892460">.</span><span class="ident" id="6892461">MustCompile</span><span class="op" id="6892472">(</span><span class="string" id="6892473">&#34;^&#34;</span>&nbsp;<span class="op" id="6892477">+</span>&nbsp;<span class="ident" id="6892479">regexp</span><span class="op" id="6892485">.</span><span class="ident" id="6892486">QuoteMeta</span><span class="op" id="6892495">(</span><span class="ident" id="6892496">filepath</span><span class="op" id="6892504">.</span><span class="ident" id="6892505">Join</span><span class="op" id="6892509">(</span><span class="ident" id="6892510">dir</span><span class="op" id="6892513">,</span>&nbsp;<span class="string" id="6892515">&#34;ioutil_test&#34;</span><span class="op" id="6892528">)</span><span class="op" id="6892529">)</span>&nbsp;<span class="op" id="6892531">+</span>&nbsp;<span class="string" id="6892533">&#34;[0-9]+$&#34;</span><span class="op" id="6892542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6892546">if</span>&nbsp;<span class="op" id="6892549">!</span><span class="ident" id="6892550">re</span><span class="op" id="6892552">.</span><span class="ident" id="6892553">MatchString</span><span class="op" id="6892564">(</span><span class="ident" id="6892565">name</span><span class="op" id="6892569">)</span>&nbsp;<span class="op" id="6892571">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6892576">t</span><span class="op" id="6892577">.</span><span class="ident" id="6892578">Errorf</span><span class="op" id="6892584">(</span><span class="string" id="6892585">&#34;TempDir(`&#34;</span><span class="op" id="6892596">+</span><span class="ident" id="6892597">dir</span><span class="op" id="6892600">+</span><span class="string" id="6892601">&#34;`,&nbsp;`ioutil_test`)&nbsp;created&nbsp;bad&nbsp;name&nbsp;%s&#34;</span><span class="op" id="6892640">,</span>&nbsp;<span class="ident" id="6892642">name</span><span class="op" id="6892646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6892650">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6892653">}</span><br>
<span class="lineno"></span><span class="op" id="6892655">}</span>
</div>
</body>
</html>
