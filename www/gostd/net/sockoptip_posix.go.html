<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3115870">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3115926">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3115980">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3116031">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;windows</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3116096">package</span>&nbsp;<span class="ident" id="3116104">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3116109">import</span>&nbsp;<span class="op" id="3116116">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3116119">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3116125">&#34;syscall&#34;</span><br>
<span class="lineno"></span><span class="op" id="3116135">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3116138">func</span>&nbsp;<span class="ident" id="3116143">joinIPv4Group</span><span class="op" id="3116156">(</span><span class="ident" id="3116157">fd</span>&nbsp;<span class="op" id="3116160">*</span><span class="ident" id="3116161">netFD</span><span class="op" id="3116166">,</span>&nbsp;<span class="ident" id="3116168">ifi</span>&nbsp;<span class="op" id="3116172">*</span><span class="ident" id="3116173">Interface</span><span class="op" id="3116182">,</span>&nbsp;<span class="ident" id="3116184">ip</span>&nbsp;<span class="ident" id="3116187">IP</span><span class="op" id="3116189">)</span>&nbsp;<span class="builtintype" id="3116191">error</span>&nbsp;<span class="op" id="3116197">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3116200">mreq</span>&nbsp;<span class="op" id="3116205">:=</span>&nbsp;<span class="op" id="3116208">&amp;</span><span class="ident" id="3116209">syscall</span><span class="op" id="3116216">.</span><span class="ident" id="3116217">IPMreq</span><span class="op" id="3116223">{</span><span class="ident" id="3116224">Multiaddr</span><span class="op" id="3116233">:</span>&nbsp;<span class="op" id="3116235">[</span><span class="num" id="3116236">4</span><span class="op" id="3116237">]</span><span class="builtintype" id="3116238">byte</span><span class="op" id="3116242">{</span><span class="ident" id="3116243">ip</span><span class="op" id="3116245">[</span><span class="num" id="3116246">0</span><span class="op" id="3116247">]</span><span class="op" id="3116248">,</span>&nbsp;<span class="ident" id="3116250">ip</span><span class="op" id="3116252">[</span><span class="num" id="3116253">1</span><span class="op" id="3116254">]</span><span class="op" id="3116255">,</span>&nbsp;<span class="ident" id="3116257">ip</span><span class="op" id="3116259">[</span><span class="num" id="3116260">2</span><span class="op" id="3116261">]</span><span class="op" id="3116262">,</span>&nbsp;<span class="ident" id="3116264">ip</span><span class="op" id="3116266">[</span><span class="num" id="3116267">3</span><span class="op" id="3116268">]</span><span class="op" id="3116269">}</span><span class="op" id="3116270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3116273">if</span>&nbsp;<span class="ident" id="3116276">err</span>&nbsp;<span class="op" id="3116280">:=</span>&nbsp;<span class="ident" id="3116283">setIPv4MreqToInterface</span><span class="op" id="3116305">(</span><span class="ident" id="3116306">mreq</span><span class="op" id="3116310">,</span>&nbsp;<span class="ident" id="3116312">ifi</span><span class="op" id="3116315">)</span><span class="op" id="3116316">;</span>&nbsp;<span class="ident" id="3116318">err</span>&nbsp;<span class="op" id="3116322">!=</span>&nbsp;<span class="ident" id="3116325">nil</span>&nbsp;<span class="op" id="3116329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3116333">return</span>&nbsp;<span class="ident" id="3116340">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3116345">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3116348">if</span>&nbsp;<span class="ident" id="3116351">err</span>&nbsp;<span class="op" id="3116355">:=</span>&nbsp;<span class="ident" id="3116358">fd</span><span class="op" id="3116360">.</span><span class="ident" id="3116361">incref</span><span class="op" id="3116367">(</span><span class="op" id="3116368">)</span><span class="op" id="3116369">;</span>&nbsp;<span class="ident" id="3116371">err</span>&nbsp;<span class="op" id="3116375">!=</span>&nbsp;<span class="ident" id="3116378">nil</span>&nbsp;<span class="op" id="3116382">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3116386">return</span>&nbsp;<span class="ident" id="3116393">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3116398">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3116401">defer</span>&nbsp;<span class="ident" id="3116407">fd</span><span class="op" id="3116409">.</span><span class="ident" id="3116410">decref</span><span class="op" id="3116416">(</span><span class="op" id="3116417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3116420">return</span>&nbsp;<span class="ident" id="3116427">os</span><span class="op" id="3116429">.</span><span class="ident" id="3116430">NewSyscallError</span><span class="op" id="3116445">(</span><span class="string" id="3116446">&#34;setsockopt&#34;</span><span class="op" id="3116458">,</span>&nbsp;<span class="ident" id="3116460">syscall</span><span class="op" id="3116467">.</span><span class="ident" id="3116468">SetsockoptIPMreq</span><span class="op" id="3116484">(</span><span class="ident" id="3116485">fd</span><span class="op" id="3116487">.</span><span class="ident" id="3116488">sysfd</span><span class="op" id="3116493">,</span>&nbsp;<span class="ident" id="3116495">syscall</span><span class="op" id="3116502">.</span><span class="ident" id="3116503">IPPROTO_IP</span><span class="op" id="3116513">,</span>&nbsp;<span class="ident" id="3116515">syscall</span><span class="op" id="3116522">.</span><span class="ident" id="3116523">IP_ADD_MEMBERSHIP</span><span class="op" id="3116540">,</span>&nbsp;<span class="ident" id="3116542">mreq</span><span class="op" id="3116546">)</span><span class="op" id="3116547">)</span><br>
<span class="lineno"></span><span class="op" id="3116549">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="3116552">func</span>&nbsp;<span class="ident" id="3116557">setIPv6MulticastInterface</span><span class="op" id="3116582">(</span><span class="ident" id="3116583">fd</span>&nbsp;<span class="op" id="3116586">*</span><span class="ident" id="3116587">netFD</span><span class="op" id="3116592">,</span>&nbsp;<span class="ident" id="3116594">ifi</span>&nbsp;<span class="op" id="3116598">*</span><span class="ident" id="3116599">Interface</span><span class="op" id="3116608">)</span>&nbsp;<span class="builtintype" id="3116610">error</span>&nbsp;<span class="op" id="3116616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3116619">var</span>&nbsp;<span class="ident" id="3116623">v</span>&nbsp;<span class="builtintype" id="3116625">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3116630">if</span>&nbsp;<span class="ident" id="3116633">ifi</span>&nbsp;<span class="op" id="3116637">!=</span>&nbsp;<span class="ident" id="3116640">nil</span>&nbsp;<span class="op" id="3116644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3116648">v</span>&nbsp;<span class="op" id="3116650">=</span>&nbsp;<span class="ident" id="3116652">ifi</span><span class="op" id="3116655">.</span><span class="ident" id="3116656">Index</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3116663">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3116666">if</span>&nbsp;<span class="ident" id="3116669">err</span>&nbsp;<span class="op" id="3116673">:=</span>&nbsp;<span class="ident" id="3116676">fd</span><span class="op" id="3116678">.</span><span class="ident" id="3116679">incref</span><span class="op" id="3116685">(</span><span class="op" id="3116686">)</span><span class="op" id="3116687">;</span>&nbsp;<span class="ident" id="3116689">err</span>&nbsp;<span class="op" id="3116693">!=</span>&nbsp;<span class="ident" id="3116696">nil</span>&nbsp;<span class="op" id="3116700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3116704">return</span>&nbsp;<span class="ident" id="3116711">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3116716">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3116719">defer</span>&nbsp;<span class="ident" id="3116725">fd</span><span class="op" id="3116727">.</span><span class="ident" id="3116728">decref</span><span class="op" id="3116734">(</span><span class="op" id="3116735">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3116738">return</span>&nbsp;<span class="ident" id="3116745">os</span><span class="op" id="3116747">.</span><span class="ident" id="3116748">NewSyscallError</span><span class="op" id="3116763">(</span><span class="string" id="3116764">&#34;setsockopt&#34;</span><span class="op" id="3116776">,</span>&nbsp;<span class="ident" id="3116778">syscall</span><span class="op" id="3116785">.</span><span class="ident" id="3116786">SetsockoptInt</span><span class="op" id="3116799">(</span><span class="ident" id="3116800">fd</span><span class="op" id="3116802">.</span><span class="ident" id="3116803">sysfd</span><span class="op" id="3116808">,</span>&nbsp;<span class="ident" id="3116810">syscall</span><span class="op" id="3116817">.</span><span class="ident" id="3116818">IPPROTO_IPV6</span><span class="op" id="3116830">,</span>&nbsp;<span class="ident" id="3116832">syscall</span><span class="op" id="3116839">.</span><span class="ident" id="3116840">IPV6_MULTICAST_IF</span><span class="op" id="3116857">,</span>&nbsp;<span class="ident" id="3116859">v</span><span class="op" id="3116860">)</span><span class="op" id="3116861">)</span><br>
<span class="lineno"></span><span class="op" id="3116863">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3116866">func</span>&nbsp;<span class="ident" id="3116871">setIPv6MulticastLoopback</span><span class="op" id="3116895">(</span><span class="ident" id="3116896">fd</span>&nbsp;<span class="op" id="3116899">*</span><span class="ident" id="3116900">netFD</span><span class="op" id="3116905">,</span>&nbsp;<span class="ident" id="3116907">v</span>&nbsp;<span class="builtintype" id="3116909">bool</span><span class="op" id="3116913">)</span>&nbsp;<span class="builtintype" id="3116915">error</span>&nbsp;<span class="op" id="3116921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3116924">if</span>&nbsp;<span class="ident" id="3116927">err</span>&nbsp;<span class="op" id="3116931">:=</span>&nbsp;<span class="ident" id="3116934">fd</span><span class="op" id="3116936">.</span><span class="ident" id="3116937">incref</span><span class="op" id="3116943">(</span><span class="op" id="3116944">)</span><span class="op" id="3116945">;</span>&nbsp;<span class="ident" id="3116947">err</span>&nbsp;<span class="op" id="3116951">!=</span>&nbsp;<span class="ident" id="3116954">nil</span>&nbsp;<span class="op" id="3116958">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3116962">return</span>&nbsp;<span class="ident" id="3116969">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3116974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3116977">defer</span>&nbsp;<span class="ident" id="3116983">fd</span><span class="op" id="3116985">.</span><span class="ident" id="3116986">decref</span><span class="op" id="3116992">(</span><span class="op" id="3116993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3116996">return</span>&nbsp;<span class="ident" id="3117003">os</span><span class="op" id="3117005">.</span><span class="ident" id="3117006">NewSyscallError</span><span class="op" id="3117021">(</span><span class="string" id="3117022">&#34;setsockopt&#34;</span><span class="op" id="3117034">,</span>&nbsp;<span class="ident" id="3117036">syscall</span><span class="op" id="3117043">.</span><span class="ident" id="3117044">SetsockoptInt</span><span class="op" id="3117057">(</span><span class="ident" id="3117058">fd</span><span class="op" id="3117060">.</span><span class="ident" id="3117061">sysfd</span><span class="op" id="3117066">,</span>&nbsp;<span class="ident" id="3117068">syscall</span><span class="op" id="3117075">.</span><span class="ident" id="3117076">IPPROTO_IPV6</span><span class="op" id="3117088">,</span>&nbsp;<span class="ident" id="3117090">syscall</span><span class="op" id="3117097">.</span><span class="ident" id="3117098">IPV6_MULTICAST_LOOP</span><span class="op" id="3117117">,</span>&nbsp;<span class="ident" id="3117119">boolint</span><span class="op" id="3117126">(</span><span class="ident" id="3117127">v</span><span class="op" id="3117128">)</span><span class="op" id="3117129">)</span><span class="op" id="3117130">)</span><br>
<span class="lineno"></span><span class="op" id="3117132">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="3117135">func</span>&nbsp;<span class="ident" id="3117140">joinIPv6Group</span><span class="op" id="3117153">(</span><span class="ident" id="3117154">fd</span>&nbsp;<span class="op" id="3117157">*</span><span class="ident" id="3117158">netFD</span><span class="op" id="3117163">,</span>&nbsp;<span class="ident" id="3117165">ifi</span>&nbsp;<span class="op" id="3117169">*</span><span class="ident" id="3117170">Interface</span><span class="op" id="3117179">,</span>&nbsp;<span class="ident" id="3117181">ip</span>&nbsp;<span class="ident" id="3117184">IP</span><span class="op" id="3117186">)</span>&nbsp;<span class="builtintype" id="3117188">error</span>&nbsp;<span class="op" id="3117194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3117197">mreq</span>&nbsp;<span class="op" id="3117202">:=</span>&nbsp;<span class="op" id="3117205">&amp;</span><span class="ident" id="3117206">syscall</span><span class="op" id="3117213">.</span><span class="ident" id="3117214">IPv6Mreq</span><span class="op" id="3117222">{</span><span class="op" id="3117223">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3117226">copy</span><span class="op" id="3117230">(</span><span class="ident" id="3117231">mreq</span><span class="op" id="3117235">.</span><span class="ident" id="3117236">Multiaddr</span><span class="op" id="3117245">[</span><span class="op" id="3117246">:</span><span class="op" id="3117247">]</span><span class="op" id="3117248">,</span>&nbsp;<span class="ident" id="3117250">ip</span><span class="op" id="3117252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3117255">if</span>&nbsp;<span class="ident" id="3117258">ifi</span>&nbsp;<span class="op" id="3117262">!=</span>&nbsp;<span class="ident" id="3117265">nil</span>&nbsp;<span class="op" id="3117269">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3117273">mreq</span><span class="op" id="3117277">.</span><span class="ident" id="3117278">Interface</span>&nbsp;<span class="op" id="3117288">=</span>&nbsp;<span class="builtintype" id="3117290">uint32</span><span class="op" id="3117296">(</span><span class="ident" id="3117297">ifi</span><span class="op" id="3117300">.</span><span class="ident" id="3117301">Index</span><span class="op" id="3117306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3117309">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3117312">if</span>&nbsp;<span class="ident" id="3117315">err</span>&nbsp;<span class="op" id="3117319">:=</span>&nbsp;<span class="ident" id="3117322">fd</span><span class="op" id="3117324">.</span><span class="ident" id="3117325">incref</span><span class="op" id="3117331">(</span><span class="op" id="3117332">)</span><span class="op" id="3117333">;</span>&nbsp;<span class="ident" id="3117335">err</span>&nbsp;<span class="op" id="3117339">!=</span>&nbsp;<span class="ident" id="3117342">nil</span>&nbsp;<span class="op" id="3117346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3117350">return</span>&nbsp;<span class="ident" id="3117357">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3117362">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3117365">defer</span>&nbsp;<span class="ident" id="3117371">fd</span><span class="op" id="3117373">.</span><span class="ident" id="3117374">decref</span><span class="op" id="3117380">(</span><span class="op" id="3117381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3117384">return</span>&nbsp;<span class="ident" id="3117391">os</span><span class="op" id="3117393">.</span><span class="ident" id="3117394">NewSyscallError</span><span class="op" id="3117409">(</span><span class="string" id="3117410">&#34;setsockopt&#34;</span><span class="op" id="3117422">,</span>&nbsp;<span class="ident" id="3117424">syscall</span><span class="op" id="3117431">.</span><span class="ident" id="3117432">SetsockoptIPv6Mreq</span><span class="op" id="3117450">(</span><span class="ident" id="3117451">fd</span><span class="op" id="3117453">.</span><span class="ident" id="3117454">sysfd</span><span class="op" id="3117459">,</span>&nbsp;<span class="ident" id="3117461">syscall</span><span class="op" id="3117468">.</span><span class="ident" id="3117469">IPPROTO_IPV6</span><span class="op" id="3117481">,</span>&nbsp;<span class="ident" id="3117483">syscall</span><span class="op" id="3117490">.</span><span class="ident" id="3117491">IPV6_JOIN_GROUP</span><span class="op" id="3117506">,</span>&nbsp;<span class="ident" id="3117508">mreq</span><span class="op" id="3117512">)</span><span class="op" id="3117513">)</span><br>
<span class="lineno"></span><span class="op" id="3117515">}</span>
</div>
</body>
</html>
