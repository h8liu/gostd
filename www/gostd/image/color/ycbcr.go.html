<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>image/color</h2>
<ul>
<li><a href="/gostd/image/color/color.go.html">color.go</a></li>
<li><a href="/gostd/image/color/ycbcr.go.html">ycbcr.go</a></li>
<li><a href="/gostd/image/color/ycbcr_test.go.html">ycbcr_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4091644">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4091699">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4091753">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4091804">package</span>&nbsp;<span class="ident" id="4091812">color</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4091819">//&nbsp;RGBToYCbCr&nbsp;converts&nbsp;an&nbsp;RGB&nbsp;triple&nbsp;to&nbsp;a&nbsp;Y&#39;CbCr&nbsp;triple.</span><br>
<span class="lineno"></span><span class="keyword" id="4091876">func</span>&nbsp;<span class="ident" id="4091881">RGBToYCbCr</span><span class="op" id="4091891">(</span><span class="ident" id="4091892">r</span><span class="op" id="4091893">,</span>&nbsp;<span class="ident" id="4091895">g</span><span class="op" id="4091896">,</span>&nbsp;<span class="ident" id="4091898">b</span>&nbsp;<span class="builtintype" id="4091900">uint8</span><span class="op" id="4091905">)</span>&nbsp;<span class="op" id="4091907">(</span><span class="builtintype" id="4091908">uint8</span><span class="op" id="4091913">,</span>&nbsp;<span class="builtintype" id="4091915">uint8</span><span class="op" id="4091920">,</span>&nbsp;<span class="builtintype" id="4091922">uint8</span><span class="op" id="4091927">)</span>&nbsp;<span class="op" id="4091929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4091932">//&nbsp;The&nbsp;JFIF&nbsp;specification&nbsp;says:</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4091965">//&nbsp;&nbsp;&nbsp;&nbspY&#39;&nbsp;=&nbsp;&nbsp;0.2990*R&nbsp;+&nbsp;0.5870*G&nbsp;+&nbsp;0.1140*B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4092006">//&nbsp;&nbsp;&nbsp;&nbspCb&nbsp;=&nbsp;-0.1687*R&nbsp;-&nbsp;0.3313*G&nbsp;+&nbsp;0.5000*B&nbsp;+&nbsp;128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4092053">//&nbsp;&nbsp;&nbsp;&nbspCr&nbsp;=&nbsp;&nbsp;0.5000*R&nbsp;-&nbsp;0.4187*G&nbsp;-&nbsp;0.0813*B&nbsp;+&nbsp;128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4092100">//&nbsp;http://www.w3.org/Graphics/JPEG/jfif3.pdf&nbsp;says&nbsp;Y&nbsp;but&nbsp;means&nbsp;Y&#39;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092167">r1</span>&nbsp;<span class="op" id="4092170">:=</span>&nbsp;<span class="builtintype" id="4092173">int</span><span class="op" id="4092176">(</span><span class="ident" id="4092177">r</span><span class="op" id="4092178">)</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092181">g1</span>&nbsp;<span class="op" id="4092184">:=</span>&nbsp;<span class="builtintype" id="4092187">int</span><span class="op" id="4092190">(</span><span class="ident" id="4092191">g</span><span class="op" id="4092192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092195">b1</span>&nbsp;<span class="op" id="4092198">:=</span>&nbsp;<span class="builtintype" id="4092201">int</span><span class="op" id="4092204">(</span><span class="ident" id="4092205">b</span><span class="op" id="4092206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092209">yy</span>&nbsp;<span class="op" id="4092212">:=</span>&nbsp;<span class="op" id="4092215">(</span><span class="num" id="4092216">19595</span><span class="op" id="4092221">*</span><span class="ident" id="4092222">r1</span>&nbsp;<span class="op" id="4092225">+</span>&nbsp;<span class="num" id="4092227">38470</span><span class="op" id="4092232">*</span><span class="ident" id="4092233">g1</span>&nbsp;<span class="op" id="4092236">+</span>&nbsp;<span class="num" id="4092238">7471</span><span class="op" id="4092242">*</span><span class="ident" id="4092243">b1</span>&nbsp;<span class="op" id="4092246">+</span>&nbsp;<span class="num" id="4092248">1</span><span class="op" id="4092249">&lt;&lt;</span><span class="num" id="4092251">15</span><span class="op" id="4092253">)</span>&nbsp;<span class="op" id="4092255">&gt;&gt;</span>&nbsp;<span class="num" id="4092258">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092262">cb</span>&nbsp;<span class="op" id="4092265">:=</span>&nbsp;<span class="op" id="4092268">(</span><span class="op" id="4092269">-</span><span class="num" id="4092270">11056</span><span class="op" id="4092275">*</span><span class="ident" id="4092276">r1</span>&nbsp;<span class="op" id="4092279">-</span>&nbsp;<span class="num" id="4092281">21712</span><span class="op" id="4092286">*</span><span class="ident" id="4092287">g1</span>&nbsp;<span class="op" id="4092290">+</span>&nbsp;<span class="num" id="4092292">32768</span><span class="op" id="4092297">*</span><span class="ident" id="4092298">b1</span>&nbsp;<span class="op" id="4092301">+</span>&nbsp;<span class="num" id="4092303">257</span><span class="op" id="4092306">&lt;&lt;</span><span class="num" id="4092308">15</span><span class="op" id="4092310">)</span>&nbsp;<span class="op" id="4092312">&gt;&gt;</span>&nbsp;<span class="num" id="4092315">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092319">cr</span>&nbsp;<span class="op" id="4092322">:=</span>&nbsp;<span class="op" id="4092325">(</span><span class="num" id="4092326">32768</span><span class="op" id="4092331">*</span><span class="ident" id="4092332">r1</span>&nbsp;<span class="op" id="4092335">-</span>&nbsp;<span class="num" id="4092337">27440</span><span class="op" id="4092342">*</span><span class="ident" id="4092343">g1</span>&nbsp;<span class="op" id="4092346">-</span>&nbsp;<span class="num" id="4092348">5328</span><span class="op" id="4092352">*</span><span class="ident" id="4092353">b1</span>&nbsp;<span class="op" id="4092356">+</span>&nbsp;<span class="num" id="4092358">257</span><span class="op" id="4092361">&lt;&lt;</span><span class="num" id="4092363">15</span><span class="op" id="4092365">)</span>&nbsp;<span class="op" id="4092367">&gt;&gt;</span>&nbsp;<span class="num" id="4092370">16</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4092374">if</span>&nbsp;<span class="ident" id="4092377">yy</span>&nbsp;<span class="op" id="4092380">&lt;</span>&nbsp;<span class="num" id="4092382">0</span>&nbsp;<span class="op" id="4092384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092388">yy</span>&nbsp;<span class="op" id="4092391">=</span>&nbsp;<span class="num" id="4092393">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4092396">}</span>&nbsp;<span class="keyword" id="4092398">else</span>&nbsp;<span class="keyword" id="4092403">if</span>&nbsp;<span class="ident" id="4092406">yy</span>&nbsp;<span class="op" id="4092409">&gt;</span>&nbsp;<span class="num" id="4092411">255</span>&nbsp;<span class="op" id="4092415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092419">yy</span>&nbsp;<span class="op" id="4092422">=</span>&nbsp;<span class="num" id="4092424">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4092429">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4092432">if</span>&nbsp;<span class="ident" id="4092435">cb</span>&nbsp;<span class="op" id="4092438">&lt;</span>&nbsp;<span class="num" id="4092440">0</span>&nbsp;<span class="op" id="4092442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092446">cb</span>&nbsp;<span class="op" id="4092449">=</span>&nbsp;<span class="num" id="4092451">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4092454">}</span>&nbsp;<span class="keyword" id="4092456">else</span>&nbsp;<span class="keyword" id="4092461">if</span>&nbsp;<span class="ident" id="4092464">cb</span>&nbsp;<span class="op" id="4092467">&gt;</span>&nbsp;<span class="num" id="4092469">255</span>&nbsp;<span class="op" id="4092473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092477">cb</span>&nbsp;<span class="op" id="4092480">=</span>&nbsp;<span class="num" id="4092482">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4092487">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4092490">if</span>&nbsp;<span class="ident" id="4092493">cr</span>&nbsp;<span class="op" id="4092496">&lt;</span>&nbsp;<span class="num" id="4092498">0</span>&nbsp;<span class="op" id="4092500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092504">cr</span>&nbsp;<span class="op" id="4092507">=</span>&nbsp;<span class="num" id="4092509">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4092512">}</span>&nbsp;<span class="keyword" id="4092514">else</span>&nbsp;<span class="keyword" id="4092519">if</span>&nbsp;<span class="ident" id="4092522">cr</span>&nbsp;<span class="op" id="4092525">&gt;</span>&nbsp;<span class="num" id="4092527">255</span>&nbsp;<span class="op" id="4092531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092535">cr</span>&nbsp;<span class="op" id="4092538">=</span>&nbsp;<span class="num" id="4092540">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4092545">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4092548">return</span>&nbsp;<span class="builtintype" id="4092555">uint8</span><span class="op" id="4092560">(</span><span class="ident" id="4092561">yy</span><span class="op" id="4092563">)</span><span class="op" id="4092564">,</span>&nbsp;<span class="builtintype" id="4092566">uint8</span><span class="op" id="4092571">(</span><span class="ident" id="4092572">cb</span><span class="op" id="4092574">)</span><span class="op" id="4092575">,</span>&nbsp;<span class="builtintype" id="4092577">uint8</span><span class="op" id="4092582">(</span><span class="ident" id="4092583">cr</span><span class="op" id="4092585">)</span><br>
<span class="lineno"></span><span class="op" id="4092587">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4092590">//&nbsp;YCbCrToRGB&nbsp;converts&nbsp;a&nbsp;Y&#39;CbCr&nbsp;triple&nbsp;to&nbsp;an&nbsp;RGB&nbsp;triple.</span><br>
<span class="lineno"></span><span class="keyword" id="4092647">func</span>&nbsp;<span class="ident" id="4092652">YCbCrToRGB</span><span class="op" id="4092662">(</span><span class="ident" id="4092663">y</span><span class="op" id="4092664">,</span>&nbsp;<span class="ident" id="4092666">cb</span><span class="op" id="4092668">,</span>&nbsp;<span class="ident" id="4092670">cr</span>&nbsp;<span class="builtintype" id="4092673">uint8</span><span class="op" id="4092678">)</span>&nbsp;<span class="op" id="4092680">(</span><span class="builtintype" id="4092681">uint8</span><span class="op" id="4092686">,</span>&nbsp;<span class="builtintype" id="4092688">uint8</span><span class="op" id="4092693">,</span>&nbsp;<span class="builtintype" id="4092695">uint8</span><span class="op" id="4092700">)</span>&nbsp;<span class="op" id="4092702">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4092705">//&nbsp;The&nbsp;JFIF&nbsp;specification&nbsp;says:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4092738">//&nbsp;&nbsp;&nbsp;&nbspR&nbsp;=&nbsp;Y&#39;&nbsp;+&nbsp;1.40200*(Cr-128)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4092768">//&nbsp;&nbsp;&nbsp;&nbspG&nbsp;=&nbsp;Y&#39;&nbsp;-&nbsp;0.34414*(Cb-128)&nbsp;-&nbsp;0.71414*(Cr-128)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4092817">//&nbsp;&nbsp;&nbsp;&nbspB&nbsp;=&nbsp;Y&#39;&nbsp;+&nbsp;1.77200*(Cb-128)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4092847">//&nbsp;http://www.w3.org/Graphics/JPEG/jfif3.pdf&nbsp;says&nbsp;Y&nbsp;but&nbsp;means&nbsp;Y&#39;.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092914">yy1</span>&nbsp;<span class="op" id="4092918">:=</span>&nbsp;<span class="builtintype" id="4092921">int</span><span class="op" id="4092924">(</span><span class="ident" id="4092925">y</span><span class="op" id="4092926">)</span><span class="op" id="4092927">&lt;&lt;</span><span class="num" id="4092929">16</span>&nbsp;<span class="op" id="4092932">+</span>&nbsp;<span class="num" id="4092934">1</span><span class="op" id="4092935">&lt;&lt;</span><span class="num" id="4092937">15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092941">cb1</span>&nbsp;<span class="op" id="4092945">:=</span>&nbsp;<span class="builtintype" id="4092948">int</span><span class="op" id="4092951">(</span><span class="ident" id="4092952">cb</span><span class="op" id="4092954">)</span>&nbsp;<span class="op" id="4092956">-</span>&nbsp;<span class="num" id="4092958">128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092963">cr1</span>&nbsp;<span class="op" id="4092967">:=</span>&nbsp;<span class="builtintype" id="4092970">int</span><span class="op" id="4092973">(</span><span class="ident" id="4092974">cr</span><span class="op" id="4092976">)</span>&nbsp;<span class="op" id="4092978">-</span>&nbsp;<span class="num" id="4092980">128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092985">r</span>&nbsp;<span class="op" id="4092987">:=</span>&nbsp;<span class="op" id="4092990">(</span><span class="ident" id="4092991">yy1</span>&nbsp;<span class="op" id="4092995">+</span>&nbsp;<span class="num" id="4092997">91881</span><span class="op" id="4093002">*</span><span class="ident" id="4093003">cr1</span><span class="op" id="4093006">)</span>&nbsp;<span class="op" id="4093008">&gt;&gt;</span>&nbsp;<span class="num" id="4093011">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093015">g</span>&nbsp;<span class="op" id="4093017">:=</span>&nbsp;<span class="op" id="4093020">(</span><span class="ident" id="4093021">yy1</span>&nbsp;<span class="op" id="4093025">-</span>&nbsp;<span class="num" id="4093027">22554</span><span class="op" id="4093032">*</span><span class="ident" id="4093033">cb1</span>&nbsp;<span class="op" id="4093037">-</span>&nbsp;<span class="num" id="4093039">46802</span><span class="op" id="4093044">*</span><span class="ident" id="4093045">cr1</span><span class="op" id="4093048">)</span>&nbsp;<span class="op" id="4093050">&gt;&gt;</span>&nbsp;<span class="num" id="4093053">16</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093057">b</span>&nbsp;<span class="op" id="4093059">:=</span>&nbsp;<span class="op" id="4093062">(</span><span class="ident" id="4093063">yy1</span>&nbsp;<span class="op" id="4093067">+</span>&nbsp;<span class="num" id="4093069">116130</span><span class="op" id="4093075">*</span><span class="ident" id="4093076">cb1</span><span class="op" id="4093079">)</span>&nbsp;<span class="op" id="4093081">&gt;&gt;</span>&nbsp;<span class="num" id="4093084">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4093088">if</span>&nbsp;<span class="ident" id="4093091">r</span>&nbsp;<span class="op" id="4093093">&lt;</span>&nbsp;<span class="num" id="4093095">0</span>&nbsp;<span class="op" id="4093097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093101">r</span>&nbsp;<span class="op" id="4093103">=</span>&nbsp;<span class="num" id="4093105">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4093108">}</span>&nbsp;<span class="keyword" id="4093110">else</span>&nbsp;<span class="keyword" id="4093115">if</span>&nbsp;<span class="ident" id="4093118">r</span>&nbsp;<span class="op" id="4093120">&gt;</span>&nbsp;<span class="num" id="4093122">255</span>&nbsp;<span class="op" id="4093126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093130">r</span>&nbsp;<span class="op" id="4093132">=</span>&nbsp;<span class="num" id="4093134">255</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4093139">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4093142">if</span>&nbsp;<span class="ident" id="4093145">g</span>&nbsp;<span class="op" id="4093147">&lt;</span>&nbsp;<span class="num" id="4093149">0</span>&nbsp;<span class="op" id="4093151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093155">g</span>&nbsp;<span class="op" id="4093157">=</span>&nbsp;<span class="num" id="4093159">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4093162">}</span>&nbsp;<span class="keyword" id="4093164">else</span>&nbsp;<span class="keyword" id="4093169">if</span>&nbsp;<span class="ident" id="4093172">g</span>&nbsp;<span class="op" id="4093174">&gt;</span>&nbsp;<span class="num" id="4093176">255</span>&nbsp;<span class="op" id="4093180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093184">g</span>&nbsp;<span class="op" id="4093186">=</span>&nbsp;<span class="num" id="4093188">255</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4093193">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4093196">if</span>&nbsp;<span class="ident" id="4093199">b</span>&nbsp;<span class="op" id="4093201">&lt;</span>&nbsp;<span class="num" id="4093203">0</span>&nbsp;<span class="op" id="4093205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093209">b</span>&nbsp;<span class="op" id="4093211">=</span>&nbsp;<span class="num" id="4093213">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4093216">}</span>&nbsp;<span class="keyword" id="4093218">else</span>&nbsp;<span class="keyword" id="4093223">if</span>&nbsp;<span class="ident" id="4093226">b</span>&nbsp;<span class="op" id="4093228">&gt;</span>&nbsp;<span class="num" id="4093230">255</span>&nbsp;<span class="op" id="4093234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093238">b</span>&nbsp;<span class="op" id="4093240">=</span>&nbsp;<span class="num" id="4093242">255</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4093247">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4093250">return</span>&nbsp;<span class="builtintype" id="4093257">uint8</span><span class="op" id="4093262">(</span><span class="ident" id="4093263">r</span><span class="op" id="4093264">)</span><span class="op" id="4093265">,</span>&nbsp;<span class="builtintype" id="4093267">uint8</span><span class="op" id="4093272">(</span><span class="ident" id="4093273">g</span><span class="op" id="4093274">)</span><span class="op" id="4093275">,</span>&nbsp;<span class="builtintype" id="4093277">uint8</span><span class="op" id="4093282">(</span><span class="ident" id="4093283">b</span><span class="op" id="4093284">)</span><br>
<span class="lineno"></span><span class="op" id="4093286">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4093289">//&nbsp;YCbCr&nbsp;represents&nbsp;a&nbsp;fully&nbsp;opaque&nbsp;24-bit&nbsp;Y&#39;CbCr&nbsp;color,&nbsp;having&nbsp;8&nbsp;bits&nbsp;each&nbsp;for</span><br>
<span class="lineno">70</span><span class="comment" id="4093368">//&nbsp;one&nbsp;luma&nbsp;and&nbsp;two&nbsp;chroma&nbsp;components.</span><br>
<span class="lineno"></span><span class="comment" id="4093407">//</span><br>
<span class="lineno"></span><span class="comment" id="4093410">//&nbsp;JPEG,&nbsp;VP8,&nbsp;the&nbsp;MPEG&nbsp;family&nbsp;and&nbsp;other&nbsp;codecs&nbsp;use&nbsp;this&nbsp;color&nbsp;model.&nbsp;Such</span><br>
<span class="lineno"></span><span class="comment" id="4093484">//&nbsp;codecs&nbsp;often&nbsp;use&nbsp;the&nbsp;terms&nbsp;YUV&nbsp;and&nbsp;Y&#39;CbCr&nbsp;interchangeably,&nbsp;but&nbsp;strictly</span><br>
<span class="lineno"></span><span class="comment" id="4093559">//&nbsp;speaking,&nbsp;the&nbsp;term&nbsp;YUV&nbsp;applies&nbsp;only&nbsp;to&nbsp;analog&nbsp;video&nbsp;signals,&nbsp;and&nbsp;Y&#39;&nbsp;(luma)</span><br>
<span class="lineno">75</span><span class="comment" id="4093637">//&nbsp;is&nbsp;Y&nbsp;(luminance)&nbsp;after&nbsp;applying&nbsp;gamma&nbsp;correction.</span><br>
<span class="lineno"></span><span class="comment" id="4093690">//</span><br>
<span class="lineno"></span><span class="comment" id="4093693">//&nbsp;Conversion&nbsp;between&nbsp;RGB&nbsp;and&nbsp;Y&#39;CbCr&nbsp;is&nbsp;lossy&nbsp;and&nbsp;there&nbsp;are&nbsp;multiple,&nbsp;slightly</span><br>
<span class="lineno"></span><span class="comment" id="4093772">//&nbsp;different&nbsp;formulae&nbsp;for&nbsp;converting&nbsp;between&nbsp;the&nbsp;two.&nbsp;This&nbsp;package&nbsp;follows</span><br>
<span class="lineno"></span><span class="comment" id="4093847">//&nbsp;the&nbsp;JFIF&nbsp;specification&nbsp;at&nbsp;http://www.w3.org/Graphics/JPEG/jfif3.pdf.</span><br>
<span class="lineno">80</span><span class="keyword" id="4093919">type</span>&nbsp;<span class="ident" id="4093924">YCbCr</span>&nbsp;<span class="keyword" id="4093930">struct</span>&nbsp;<span class="op" id="4093937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093940">Y</span><span class="op" id="4093941">,</span>&nbsp;<span class="ident" id="4093943">Cb</span><span class="op" id="4093945">,</span>&nbsp;<span class="ident" id="4093947">Cr</span>&nbsp;<span class="builtintype" id="4093950">uint8</span><br>
<span class="lineno"></span><span class="op" id="4093956">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4093959">func</span>&nbsp;<span class="op" id="4093964">(</span><span class="ident" id="4093965">c</span>&nbsp;<span class="ident" id="4093967">YCbCr</span><span class="op" id="4093972">)</span>&nbsp;<span class="ident" id="4093974">RGBA</span><span class="op" id="4093978">(</span><span class="op" id="4093979">)</span>&nbsp;<span class="op" id="4093981">(</span><span class="builtintype" id="4093982">uint32</span><span class="op" id="4093988">,</span>&nbsp;<span class="builtintype" id="4093990">uint32</span><span class="op" id="4093996">,</span>&nbsp;<span class="builtintype" id="4093998">uint32</span><span class="op" id="4094004">,</span>&nbsp;<span class="builtintype" id="4094006">uint32</span><span class="op" id="4094012">)</span>&nbsp;<span class="op" id="4094014">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094017">r</span><span class="op" id="4094018">,</span>&nbsp;<span class="ident" id="4094020">g</span><span class="op" id="4094021">,</span>&nbsp;<span class="ident" id="4094023">b</span>&nbsp;<span class="op" id="4094025">:=</span>&nbsp;<span class="ident" id="4094028">YCbCrToRGB</span><span class="op" id="4094038">(</span><span class="ident" id="4094039">c</span><span class="op" id="4094040">.</span><span class="ident" id="4094041">Y</span><span class="op" id="4094042">,</span>&nbsp;<span class="ident" id="4094044">c</span><span class="op" id="4094045">.</span><span class="ident" id="4094046">Cb</span><span class="op" id="4094048">,</span>&nbsp;<span class="ident" id="4094050">c</span><span class="op" id="4094051">.</span><span class="ident" id="4094052">Cr</span><span class="op" id="4094054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4094057">return</span>&nbsp;<span class="builtintype" id="4094064">uint32</span><span class="op" id="4094070">(</span><span class="ident" id="4094071">r</span><span class="op" id="4094072">)</span>&nbsp;<span class="op" id="4094074">*</span>&nbsp;<span class="num" id="4094076">0x101</span><span class="op" id="4094081">,</span>&nbsp;<span class="builtintype" id="4094083">uint32</span><span class="op" id="4094089">(</span><span class="ident" id="4094090">g</span><span class="op" id="4094091">)</span>&nbsp;<span class="op" id="4094093">*</span>&nbsp;<span class="num" id="4094095">0x101</span><span class="op" id="4094100">,</span>&nbsp;<span class="builtintype" id="4094102">uint32</span><span class="op" id="4094108">(</span><span class="ident" id="4094109">b</span><span class="op" id="4094110">)</span>&nbsp;<span class="op" id="4094112">*</span>&nbsp;<span class="num" id="4094114">0x101</span><span class="op" id="4094119">,</span>&nbsp;<span class="num" id="4094121">0xffff</span><br>
<span class="lineno"></span><span class="op" id="4094128">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4094131">//&nbsp;YCbCrModel&nbsp;is&nbsp;the&nbsp;Model&nbsp;for&nbsp;Y&#39;CbCr&nbsp;colors.</span><br>
<span class="lineno">90</span><span class="keyword" id="4094177">var</span>&nbsp;<span class="ident" id="4094181">YCbCrModel</span>&nbsp;<span class="ident" id="4094192">Model</span>&nbsp;<span class="op" id="4094198">=</span>&nbsp;<span class="ident" id="4094200">ModelFunc</span><span class="op" id="4094209">(</span><span class="ident" id="4094210">yCbCrModel</span><span class="op" id="4094220">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4094223">func</span>&nbsp;<span class="ident" id="4094228">yCbCrModel</span><span class="op" id="4094238">(</span><span class="ident" id="4094239">c</span>&nbsp;<span class="ident" id="4094241">Color</span><span class="op" id="4094246">)</span>&nbsp;<span class="ident" id="4094248">Color</span>&nbsp;<span class="op" id="4094254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4094257">if</span>&nbsp;<span class="ident" id="4094260">_</span><span class="op" id="4094261">,</span>&nbsp;<span class="ident" id="4094263">ok</span>&nbsp;<span class="op" id="4094266">:=</span>&nbsp;<span class="ident" id="4094269">c</span><span class="op" id="4094270">.</span><span class="op" id="4094271">(</span><span class="ident" id="4094272">YCbCr</span><span class="op" id="4094277">)</span><span class="op" id="4094278">;</span>&nbsp;<span class="ident" id="4094280">ok</span>&nbsp;<span class="op" id="4094283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4094287">return</span>&nbsp;<span class="ident" id="4094294">c</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4094297">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094300">r</span><span class="op" id="4094301">,</span>&nbsp;<span class="ident" id="4094303">g</span><span class="op" id="4094304">,</span>&nbsp;<span class="ident" id="4094306">b</span><span class="op" id="4094307">,</span>&nbsp;<span class="ident" id="4094309">_</span>&nbsp;<span class="op" id="4094311">:=</span>&nbsp;<span class="ident" id="4094314">c</span><span class="op" id="4094315">.</span><span class="ident" id="4094316">RGBA</span><span class="op" id="4094320">(</span><span class="op" id="4094321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094324">y</span><span class="op" id="4094325">,</span>&nbsp;<span class="ident" id="4094327">u</span><span class="op" id="4094328">,</span>&nbsp;<span class="ident" id="4094330">v</span>&nbsp;<span class="op" id="4094332">:=</span>&nbsp;<span class="ident" id="4094335">RGBToYCbCr</span><span class="op" id="4094345">(</span><span class="builtintype" id="4094346">uint8</span><span class="op" id="4094351">(</span><span class="ident" id="4094352">r</span><span class="op" id="4094353">&gt;&gt;</span><span class="num" id="4094355">8</span><span class="op" id="4094356">)</span><span class="op" id="4094357">,</span>&nbsp;<span class="builtintype" id="4094359">uint8</span><span class="op" id="4094364">(</span><span class="ident" id="4094365">g</span><span class="op" id="4094366">&gt;&gt;</span><span class="num" id="4094368">8</span><span class="op" id="4094369">)</span><span class="op" id="4094370">,</span>&nbsp;<span class="builtintype" id="4094372">uint8</span><span class="op" id="4094377">(</span><span class="ident" id="4094378">b</span><span class="op" id="4094379">&gt;&gt;</span><span class="num" id="4094381">8</span><span class="op" id="4094382">)</span><span class="op" id="4094383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4094386">return</span>&nbsp;<span class="ident" id="4094393">YCbCr</span><span class="op" id="4094398">{</span><span class="ident" id="4094399">y</span><span class="op" id="4094400">,</span>&nbsp;<span class="ident" id="4094402">u</span><span class="op" id="4094403">,</span>&nbsp;<span class="ident" id="4094405">v</span><span class="op" id="4094406">}</span><br>
<span class="lineno"></span><span class="op" id="4094408">}</span>
</div>
</body>
</html>
