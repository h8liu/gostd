<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html" class="current">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3962553">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3962609">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3962663">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3962714">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3962779">package</span>&nbsp;<span class="ident" id="3962787">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3962792">import</span>&nbsp;<span class="op" id="3962799">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3962802">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3962812">&#34;sync&#34;</span><br>
<span class="lineno"></span><span class="op" id="3962819">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3962822">var</span>&nbsp;<span class="ident" id="3962826">onceReadProtocols</span>&nbsp;<span class="ident" id="3962844">sync</span><span class="op" id="3962848">.</span><span class="ident" id="3962849">Once</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="3962855">//&nbsp;readProtocols&nbsp;loads&nbsp;contents&nbsp;of&nbsp;/etc/protocols&nbsp;into&nbsp;protocols&nbsp;map</span><br>
<span class="lineno"></span><span class="comment" id="3962924">//&nbsp;for&nbsp;quick&nbsp;access.</span><br>
<span class="lineno"></span><span class="keyword" id="3962945">func</span>&nbsp;<span class="ident" id="3962950">readProtocols</span><span class="op" id="3962963">(</span><span class="op" id="3962964">)</span>&nbsp;<span class="op" id="3962966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3962969">if</span>&nbsp;<span class="ident" id="3962972">file</span><span class="op" id="3962976">,</span>&nbsp;<span class="ident" id="3962978">err</span>&nbsp;<span class="op" id="3962982">:=</span>&nbsp;<span class="ident" id="3962985">open</span><span class="op" id="3962989">(</span><span class="string" id="3962990">&#34;/etc/protocols&#34;</span><span class="op" id="3963006">)</span><span class="op" id="3963007">;</span>&nbsp;<span class="ident" id="3963009">err</span>&nbsp;<span class="op" id="3963013">==</span>&nbsp;<span class="builtintype" id="3963016">nil</span>&nbsp;<span class="op" id="3963020">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3963024">for</span>&nbsp;<span class="ident" id="3963028">line</span><span class="op" id="3963032">,</span>&nbsp;<span class="ident" id="3963034">ok</span>&nbsp;<span class="op" id="3963037">:=</span>&nbsp;<span class="ident" id="3963040">file</span><span class="op" id="3963044">.</span><span class="ident" id="3963045">readLine</span><span class="op" id="3963053">(</span><span class="op" id="3963054">)</span><span class="op" id="3963055">;</span>&nbsp;<span class="ident" id="3963057">ok</span><span class="op" id="3963059">;</span>&nbsp;<span class="ident" id="3963061">line</span><span class="op" id="3963065">,</span>&nbsp;<span class="ident" id="3963067">ok</span>&nbsp;<span class="op" id="3963070">=</span>&nbsp;<span class="ident" id="3963072">file</span><span class="op" id="3963076">.</span><span class="ident" id="3963077">readLine</span><span class="op" id="3963085">(</span><span class="op" id="3963086">)</span>&nbsp;<span class="op" id="3963088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3963093">//&nbsp;tcp&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;&nbsp;TCP&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;transmission&nbsp;control&nbsp;protocol</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3963149">if</span>&nbsp;<span class="ident" id="3963152">i</span>&nbsp;<span class="op" id="3963154">:=</span>&nbsp;<span class="ident" id="3963157">byteIndex</span><span class="op" id="3963166">(</span><span class="ident" id="3963167">line</span><span class="op" id="3963171">,</span>&nbsp;<span class="string" id="3963173">&#39;#&#39;</span><span class="op" id="3963176">)</span><span class="op" id="3963177">;</span>&nbsp;<span class="ident" id="3963179">i</span>&nbsp;<span class="op" id="3963181">&gt;=</span>&nbsp;<span class="num" id="3963184">0</span>&nbsp;<span class="op" id="3963186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3963192">line</span>&nbsp;<span class="op" id="3963197">=</span>&nbsp;<span class="ident" id="3963199">line</span><span class="op" id="3963203">[</span><span class="num" id="3963204">0</span><span class="op" id="3963205">:</span><span class="ident" id="3963206">i</span><span class="op" id="3963207">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3963212">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3963217">f</span>&nbsp;<span class="op" id="3963219">:=</span>&nbsp;<span class="ident" id="3963222">getFields</span><span class="op" id="3963231">(</span><span class="ident" id="3963232">line</span><span class="op" id="3963236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3963241">if</span>&nbsp;<span class="builtinfunc" id="3963244">len</span><span class="op" id="3963247">(</span><span class="ident" id="3963248">f</span><span class="op" id="3963249">)</span>&nbsp;<span class="op" id="3963251">&lt;</span>&nbsp;<span class="num" id="3963253">2</span>&nbsp;<span class="op" id="3963255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3963261">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3963273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3963278">if</span>&nbsp;<span class="ident" id="3963281">proto</span><span class="op" id="3963286">,</span>&nbsp;<span class="ident" id="3963288">_</span><span class="op" id="3963289">,</span>&nbsp;<span class="ident" id="3963291">ok</span>&nbsp;<span class="op" id="3963294">:=</span>&nbsp;<span class="ident" id="3963297">dtoi</span><span class="op" id="3963301">(</span><span class="ident" id="3963302">f</span><span class="op" id="3963303">[</span><span class="num" id="3963304">1</span><span class="op" id="3963305">]</span><span class="op" id="3963306">,</span>&nbsp;<span class="num" id="3963308">0</span><span class="op" id="3963309">)</span><span class="op" id="3963310">;</span>&nbsp;<span class="ident" id="3963312">ok</span>&nbsp;<span class="op" id="3963315">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3963321">if</span>&nbsp;<span class="ident" id="3963324">_</span><span class="op" id="3963325">,</span>&nbsp;<span class="ident" id="3963327">ok</span>&nbsp;<span class="op" id="3963330">:=</span>&nbsp;<span class="ident" id="3963333">protocols</span><span class="op" id="3963342">[</span><span class="ident" id="3963343">f</span><span class="op" id="3963344">[</span><span class="num" id="3963345">0</span><span class="op" id="3963346">]</span><span class="op" id="3963347">]</span><span class="op" id="3963348">;</span>&nbsp;<span class="op" id="3963350">!</span><span class="ident" id="3963351">ok</span>&nbsp;<span class="op" id="3963354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3963361">protocols</span><span class="op" id="3963370">[</span><span class="ident" id="3963371">f</span><span class="op" id="3963372">[</span><span class="num" id="3963373">0</span><span class="op" id="3963374">]</span><span class="op" id="3963375">]</span>&nbsp;<span class="op" id="3963377">=</span>&nbsp;<span class="ident" id="3963379">proto</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3963389">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3963395">for</span>&nbsp;<span class="ident" id="3963399">_</span><span class="op" id="3963400">,</span>&nbsp;<span class="ident" id="3963402">alias</span>&nbsp;<span class="op" id="3963408">:=</span>&nbsp;<span class="keyword" id="3963411">range</span>&nbsp;<span class="ident" id="3963417">f</span><span class="op" id="3963418">[</span><span class="num" id="3963419">2</span><span class="op" id="3963420">:</span><span class="op" id="3963421">]</span>&nbsp;<span class="op" id="3963423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3963430">if</span>&nbsp;<span class="ident" id="3963433">_</span><span class="op" id="3963434">,</span>&nbsp;<span class="ident" id="3963436">ok</span>&nbsp;<span class="op" id="3963439">:=</span>&nbsp;<span class="ident" id="3963442">protocols</span><span class="op" id="3963451">[</span><span class="ident" id="3963452">alias</span><span class="op" id="3963457">]</span><span class="op" id="3963458">;</span>&nbsp;<span class="op" id="3963460">!</span><span class="ident" id="3963461">ok</span>&nbsp;<span class="op" id="3963464">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3963472">protocols</span><span class="op" id="3963481">[</span><span class="ident" id="3963482">alias</span><span class="op" id="3963487">]</span>&nbsp;<span class="op" id="3963489">=</span>&nbsp;<span class="ident" id="3963491">proto</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3963502">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3963508">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3963513">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3963517">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3963521">file</span><span class="op" id="3963525">.</span><span class="builtinfunc" id="3963526">close</span><span class="op" id="3963531">(</span><span class="op" id="3963532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3963535">}</span><br>
<span class="lineno"></span><span class="op" id="3963537">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3963540">//&nbsp;lookupProtocol&nbsp;looks&nbsp;up&nbsp;IP&nbsp;protocol&nbsp;name&nbsp;in&nbsp;/etc/protocols&nbsp;and</span><br>
<span class="lineno">45</span><span class="comment" id="3963606">//&nbsp;returns&nbsp;correspondent&nbsp;protocol&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="3963648">func</span>&nbsp;<span class="ident" id="3963653">lookupProtocol</span><span class="op" id="3963667">(</span><span class="ident" id="3963668">name</span>&nbsp;<span class="builtintype" id="3963673">string</span><span class="op" id="3963679">)</span>&nbsp;<span class="op" id="3963681">(</span><span class="ident" id="3963682">proto</span>&nbsp;<span class="builtintype" id="3963688">int</span><span class="op" id="3963691">,</span>&nbsp;<span class="ident" id="3963693">err</span>&nbsp;<span class="builtintype" id="3963697">error</span><span class="op" id="3963702">)</span>&nbsp;<span class="op" id="3963704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3963707">onceReadProtocols</span><span class="op" id="3963724">.</span><span class="ident" id="3963725">Do</span><span class="op" id="3963727">(</span><span class="ident" id="3963728">readProtocols</span><span class="op" id="3963741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3963744">proto</span><span class="op" id="3963749">,</span>&nbsp;<span class="ident" id="3963751">found</span>&nbsp;<span class="op" id="3963757">:=</span>&nbsp;<span class="ident" id="3963760">protocols</span><span class="op" id="3963769">[</span><span class="ident" id="3963770">name</span><span class="op" id="3963774">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3963777">if</span>&nbsp;<span class="op" id="3963780">!</span><span class="ident" id="3963781">found</span>&nbsp;<span class="op" id="3963787">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3963791">return</span>&nbsp;<span class="num" id="3963798">0</span><span class="op" id="3963799">,</span>&nbsp;<span class="ident" id="3963801">errors</span><span class="op" id="3963807">.</span><span class="ident" id="3963808">New</span><span class="op" id="3963811">(</span><span class="string" id="3963812">&#34;unknown&nbsp;IP&nbsp;protocol&nbsp;specified:&nbsp;&#34;</span>&nbsp;<span class="op" id="3963846">+</span>&nbsp;<span class="ident" id="3963848">name</span><span class="op" id="3963852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3963855">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3963858">return</span><br>
<span class="lineno"></span><span class="op" id="3963865">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="3963868">func</span>&nbsp;<span class="ident" id="3963873">lookupHost</span><span class="op" id="3963883">(</span><span class="ident" id="3963884">host</span>&nbsp;<span class="builtintype" id="3963889">string</span><span class="op" id="3963895">)</span>&nbsp;<span class="op" id="3963897">(</span><span class="ident" id="3963898">addrs</span>&nbsp;<span class="op" id="3963904">[</span><span class="op" id="3963905">]</span><span class="builtintype" id="3963906">string</span><span class="op" id="3963912">,</span>&nbsp;<span class="ident" id="3963914">err</span>&nbsp;<span class="builtintype" id="3963918">error</span><span class="op" id="3963923">)</span>&nbsp;<span class="op" id="3963925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3963928">addrs</span><span class="op" id="3963933">,</span>&nbsp;<span class="ident" id="3963935">err</span><span class="op" id="3963938">,</span>&nbsp;<span class="ident" id="3963940">ok</span>&nbsp;<span class="op" id="3963943">:=</span>&nbsp;<span class="ident" id="3963946">cgoLookupHost</span><span class="op" id="3963959">(</span><span class="ident" id="3963960">host</span><span class="op" id="3963964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3963967">if</span>&nbsp;<span class="op" id="3963970">!</span><span class="ident" id="3963971">ok</span>&nbsp;<span class="op" id="3963974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3963978">addrs</span><span class="op" id="3963983">,</span>&nbsp;<span class="ident" id="3963985">err</span>&nbsp;<span class="op" id="3963989">=</span>&nbsp;<span class="ident" id="3963991">goLookupHost</span><span class="op" id="3964003">(</span><span class="ident" id="3964004">host</span><span class="op" id="3964008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3964011">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3964014">return</span><br>
<span class="lineno"></span><span class="op" id="3964021">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3964024">func</span>&nbsp;<span class="ident" id="3964029">lookupIP</span><span class="op" id="3964037">(</span><span class="ident" id="3964038">host</span>&nbsp;<span class="builtintype" id="3964043">string</span><span class="op" id="3964049">)</span>&nbsp;<span class="op" id="3964051">(</span><span class="ident" id="3964052">addrs</span>&nbsp;<span class="op" id="3964058">[</span><span class="op" id="3964059">]</span><span class="ident" id="3964060">IP</span><span class="op" id="3964062">,</span>&nbsp;<span class="ident" id="3964064">err</span>&nbsp;<span class="builtintype" id="3964068">error</span><span class="op" id="3964073">)</span>&nbsp;<span class="op" id="3964075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3964078">addrs</span><span class="op" id="3964083">,</span>&nbsp;<span class="ident" id="3964085">err</span><span class="op" id="3964088">,</span>&nbsp;<span class="ident" id="3964090">ok</span>&nbsp;<span class="op" id="3964093">:=</span>&nbsp;<span class="ident" id="3964096">cgoLookupIP</span><span class="op" id="3964107">(</span><span class="ident" id="3964108">host</span><span class="op" id="3964112">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3964115">if</span>&nbsp;<span class="op" id="3964118">!</span><span class="ident" id="3964119">ok</span>&nbsp;<span class="op" id="3964122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3964126">addrs</span><span class="op" id="3964131">,</span>&nbsp;<span class="ident" id="3964133">err</span>&nbsp;<span class="op" id="3964137">=</span>&nbsp;<span class="ident" id="3964139">goLookupIP</span><span class="op" id="3964149">(</span><span class="ident" id="3964150">host</span><span class="op" id="3964154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3964157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3964160">return</span><br>
<span class="lineno"></span><span class="op" id="3964167">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="3964170">func</span>&nbsp;<span class="ident" id="3964175">lookupPort</span><span class="op" id="3964185">(</span><span class="ident" id="3964186">network</span><span class="op" id="3964193">,</span>&nbsp;<span class="ident" id="3964195">service</span>&nbsp;<span class="builtintype" id="3964203">string</span><span class="op" id="3964209">)</span>&nbsp;<span class="op" id="3964211">(</span><span class="ident" id="3964212">port</span>&nbsp;<span class="builtintype" id="3964217">int</span><span class="op" id="3964220">,</span>&nbsp;<span class="ident" id="3964222">err</span>&nbsp;<span class="builtintype" id="3964226">error</span><span class="op" id="3964231">)</span>&nbsp;<span class="op" id="3964233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3964236">port</span><span class="op" id="3964240">,</span>&nbsp;<span class="ident" id="3964242">err</span><span class="op" id="3964245">,</span>&nbsp;<span class="ident" id="3964247">ok</span>&nbsp;<span class="op" id="3964250">:=</span>&nbsp;<span class="ident" id="3964253">cgoLookupPort</span><span class="op" id="3964266">(</span><span class="ident" id="3964267">network</span><span class="op" id="3964274">,</span>&nbsp;<span class="ident" id="3964276">service</span><span class="op" id="3964283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3964286">if</span>&nbsp;<span class="op" id="3964289">!</span><span class="ident" id="3964290">ok</span>&nbsp;<span class="op" id="3964293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3964297">port</span><span class="op" id="3964301">,</span>&nbsp;<span class="ident" id="3964303">err</span>&nbsp;<span class="op" id="3964307">=</span>&nbsp;<span class="ident" id="3964309">goLookupPort</span><span class="op" id="3964321">(</span><span class="ident" id="3964322">network</span><span class="op" id="3964329">,</span>&nbsp;<span class="ident" id="3964331">service</span><span class="op" id="3964338">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3964341">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3964344">return</span><br>
<span class="lineno"></span><span class="op" id="3964351">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3964354">func</span>&nbsp;<span class="ident" id="3964359">lookupCNAME</span><span class="op" id="3964370">(</span><span class="ident" id="3964371">name</span>&nbsp;<span class="builtintype" id="3964376">string</span><span class="op" id="3964382">)</span>&nbsp;<span class="op" id="3964384">(</span><span class="ident" id="3964385">cname</span>&nbsp;<span class="builtintype" id="3964391">string</span><span class="op" id="3964397">,</span>&nbsp;<span class="ident" id="3964399">err</span>&nbsp;<span class="builtintype" id="3964403">error</span><span class="op" id="3964408">)</span>&nbsp;<span class="op" id="3964410">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3964413">cname</span><span class="op" id="3964418">,</span>&nbsp;<span class="ident" id="3964420">err</span><span class="op" id="3964423">,</span>&nbsp;<span class="ident" id="3964425">ok</span>&nbsp;<span class="op" id="3964428">:=</span>&nbsp;<span class="ident" id="3964431">cgoLookupCNAME</span><span class="op" id="3964445">(</span><span class="ident" id="3964446">name</span><span class="op" id="3964450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3964453">if</span>&nbsp;<span class="op" id="3964456">!</span><span class="ident" id="3964457">ok</span>&nbsp;<span class="op" id="3964460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3964464">cname</span><span class="op" id="3964469">,</span>&nbsp;<span class="ident" id="3964471">err</span>&nbsp;<span class="op" id="3964475">=</span>&nbsp;<span class="ident" id="3964477">goLookupCNAME</span><span class="op" id="3964490">(</span><span class="ident" id="3964491">name</span><span class="op" id="3964495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3964498">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3964501">return</span><br>
<span class="lineno">85</span><span class="op" id="3964508">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3964511">func</span>&nbsp;<span class="ident" id="3964516">lookupSRV</span><span class="op" id="3964525">(</span><span class="ident" id="3964526">service</span><span class="op" id="3964533">,</span>&nbsp;<span class="ident" id="3964535">proto</span><span class="op" id="3964540">,</span>&nbsp;<span class="ident" id="3964542">name</span>&nbsp;<span class="builtintype" id="3964547">string</span><span class="op" id="3964553">)</span>&nbsp;<span class="op" id="3964555">(</span><span class="ident" id="3964556">cname</span>&nbsp;<span class="builtintype" id="3964562">string</span><span class="op" id="3964568">,</span>&nbsp;<span class="ident" id="3964570">addrs</span>&nbsp;<span class="op" id="3964576">[</span><span class="op" id="3964577">]</span><span class="op" id="3964578">*</span><span class="ident" id="3964579">SRV</span><span class="op" id="3964582">,</span>&nbsp;<span class="ident" id="3964584">err</span>&nbsp;<span class="builtintype" id="3964588">error</span><span class="op" id="3964593">)</span>&nbsp;<span class="op" id="3964595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3964598">var</span>&nbsp;<span class="ident" id="3964602">target</span>&nbsp;<span class="builtintype" id="3964609">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3964617">if</span>&nbsp;<span class="ident" id="3964620">service</span>&nbsp;<span class="op" id="3964628">==</span>&nbsp;<span class="string" id="3964631">&#34;&#34;</span>&nbsp;<span class="op" id="3964634">&amp;&amp;</span>&nbsp;<span class="ident" id="3964637">proto</span>&nbsp;<span class="op" id="3964643">==</span>&nbsp;<span class="string" id="3964646">&#34;&#34;</span>&nbsp;<span class="op" id="3964649">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3964653">target</span>&nbsp;<span class="op" id="3964660">=</span>&nbsp;<span class="ident" id="3964662">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3964668">}</span>&nbsp;<span class="keyword" id="3964670">else</span>&nbsp;<span class="op" id="3964675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3964679">target</span>&nbsp;<span class="op" id="3964686">=</span>&nbsp;<span class="string" id="3964688">&#34;_&#34;</span>&nbsp;<span class="op" id="3964692">+</span>&nbsp;<span class="ident" id="3964694">service</span>&nbsp;<span class="op" id="3964702">+</span>&nbsp;<span class="string" id="3964704">&#34;._&#34;</span>&nbsp;<span class="op" id="3964709">+</span>&nbsp;<span class="ident" id="3964711">proto</span>&nbsp;<span class="op" id="3964717">+</span>&nbsp;<span class="string" id="3964719">&#34;.&#34;</span>&nbsp;<span class="op" id="3964723">+</span>&nbsp;<span class="ident" id="3964725">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3964731">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3964734">var</span>&nbsp;<span class="ident" id="3964738">records</span>&nbsp;<span class="op" id="3964746">[</span><span class="op" id="3964747">]</span><span class="ident" id="3964748">dnsRR</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3964755">cname</span><span class="op" id="3964760">,</span>&nbsp;<span class="ident" id="3964762">records</span><span class="op" id="3964769">,</span>&nbsp;<span class="ident" id="3964771">err</span>&nbsp;<span class="op" id="3964775">=</span>&nbsp;<span class="ident" id="3964777">lookup</span><span class="op" id="3964783">(</span><span class="ident" id="3964784">target</span><span class="op" id="3964790">,</span>&nbsp;<span class="ident" id="3964792">dnsTypeSRV</span><span class="op" id="3964802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3964805">if</span>&nbsp;<span class="ident" id="3964808">err</span>&nbsp;<span class="op" id="3964812">!=</span>&nbsp;<span class="builtintype" id="3964815">nil</span>&nbsp;<span class="op" id="3964819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3964823">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3964831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3964834">addrs</span>&nbsp;<span class="op" id="3964840">=</span>&nbsp;<span class="builtinfunc" id="3964842">make</span><span class="op" id="3964846">(</span><span class="op" id="3964847">[</span><span class="op" id="3964848">]</span><span class="op" id="3964849">*</span><span class="ident" id="3964850">SRV</span><span class="op" id="3964853">,</span>&nbsp;<span class="builtinfunc" id="3964855">len</span><span class="op" id="3964858">(</span><span class="ident" id="3964859">records</span><span class="op" id="3964866">)</span><span class="op" id="3964867">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3964870">for</span>&nbsp;<span class="ident" id="3964874">i</span><span class="op" id="3964875">,</span>&nbsp;<span class="ident" id="3964877">rr</span>&nbsp;<span class="op" id="3964880">:=</span>&nbsp;<span class="keyword" id="3964883">range</span>&nbsp;<span class="ident" id="3964889">records</span>&nbsp;<span class="op" id="3964897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3964901">r</span>&nbsp;<span class="op" id="3964903">:=</span>&nbsp;<span class="ident" id="3964906">rr</span><span class="op" id="3964908">.</span><span class="op" id="3964909">(</span><span class="op" id="3964910">*</span><span class="ident" id="3964911">dnsRR_SRV</span><span class="op" id="3964920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3964924">addrs</span><span class="op" id="3964929">[</span><span class="ident" id="3964930">i</span><span class="op" id="3964931">]</span>&nbsp;<span class="op" id="3964933">=</span>&nbsp;<span class="op" id="3964935">&amp;</span><span class="ident" id="3964936">SRV</span><span class="op" id="3964939">{</span><span class="ident" id="3964940">r</span><span class="op" id="3964941">.</span><span class="ident" id="3964942">Target</span><span class="op" id="3964948">,</span>&nbsp;<span class="ident" id="3964950">r</span><span class="op" id="3964951">.</span><span class="ident" id="3964952">Port</span><span class="op" id="3964956">,</span>&nbsp;<span class="ident" id="3964958">r</span><span class="op" id="3964959">.</span><span class="ident" id="3964960">Priority</span><span class="op" id="3964968">,</span>&nbsp;<span class="ident" id="3964970">r</span><span class="op" id="3964971">.</span><span class="ident" id="3964972">Weight</span><span class="op" id="3964978">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3964981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3964984">byPriorityWeight</span><span class="op" id="3965000">(</span><span class="ident" id="3965001">addrs</span><span class="op" id="3965006">)</span><span class="op" id="3965007">.</span><span class="ident" id="3965008">sort</span><span class="op" id="3965012">(</span><span class="op" id="3965013">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3965016">return</span><br>
<span class="lineno"></span><span class="op" id="3965023">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3965026">func</span>&nbsp;<span class="ident" id="3965031">lookupMX</span><span class="op" id="3965039">(</span><span class="ident" id="3965040">name</span>&nbsp;<span class="builtintype" id="3965045">string</span><span class="op" id="3965051">)</span>&nbsp;<span class="op" id="3965053">(</span><span class="ident" id="3965054">mx</span>&nbsp;<span class="op" id="3965057">[</span><span class="op" id="3965058">]</span><span class="op" id="3965059">*</span><span class="ident" id="3965060">MX</span><span class="op" id="3965062">,</span>&nbsp;<span class="ident" id="3965064">err</span>&nbsp;<span class="builtintype" id="3965068">error</span><span class="op" id="3965073">)</span>&nbsp;<span class="op" id="3965075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3965078">_</span><span class="op" id="3965079">,</span>&nbsp;<span class="ident" id="3965081">records</span><span class="op" id="3965088">,</span>&nbsp;<span class="ident" id="3965090">err</span>&nbsp;<span class="op" id="3965094">:=</span>&nbsp;<span class="ident" id="3965097">lookup</span><span class="op" id="3965103">(</span><span class="ident" id="3965104">name</span><span class="op" id="3965108">,</span>&nbsp;<span class="ident" id="3965110">dnsTypeMX</span><span class="op" id="3965119">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3965122">if</span>&nbsp;<span class="ident" id="3965125">err</span>&nbsp;<span class="op" id="3965129">!=</span>&nbsp;<span class="builtintype" id="3965132">nil</span>&nbsp;<span class="op" id="3965136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3965140">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3965148">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3965151">mx</span>&nbsp;<span class="op" id="3965154">=</span>&nbsp;<span class="builtinfunc" id="3965156">make</span><span class="op" id="3965160">(</span><span class="op" id="3965161">[</span><span class="op" id="3965162">]</span><span class="op" id="3965163">*</span><span class="ident" id="3965164">MX</span><span class="op" id="3965166">,</span>&nbsp;<span class="builtinfunc" id="3965168">len</span><span class="op" id="3965171">(</span><span class="ident" id="3965172">records</span><span class="op" id="3965179">)</span><span class="op" id="3965180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3965183">for</span>&nbsp;<span class="ident" id="3965187">i</span><span class="op" id="3965188">,</span>&nbsp;<span class="ident" id="3965190">rr</span>&nbsp;<span class="op" id="3965193">:=</span>&nbsp;<span class="keyword" id="3965196">range</span>&nbsp;<span class="ident" id="3965202">records</span>&nbsp;<span class="op" id="3965210">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3965214">r</span>&nbsp;<span class="op" id="3965216">:=</span>&nbsp;<span class="ident" id="3965219">rr</span><span class="op" id="3965221">.</span><span class="op" id="3965222">(</span><span class="op" id="3965223">*</span><span class="ident" id="3965224">dnsRR_MX</span><span class="op" id="3965232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3965236">mx</span><span class="op" id="3965238">[</span><span class="ident" id="3965239">i</span><span class="op" id="3965240">]</span>&nbsp;<span class="op" id="3965242">=</span>&nbsp;<span class="op" id="3965244">&amp;</span><span class="ident" id="3965245">MX</span><span class="op" id="3965247">{</span><span class="ident" id="3965248">r</span><span class="op" id="3965249">.</span><span class="ident" id="3965250">Mx</span><span class="op" id="3965252">,</span>&nbsp;<span class="ident" id="3965254">r</span><span class="op" id="3965255">.</span><span class="ident" id="3965256">Pref</span><span class="op" id="3965260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3965263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3965266">byPref</span><span class="op" id="3965272">(</span><span class="ident" id="3965273">mx</span><span class="op" id="3965275">)</span><span class="op" id="3965276">.</span><span class="ident" id="3965277">sort</span><span class="op" id="3965281">(</span><span class="op" id="3965282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3965285">return</span><br>
<span class="lineno">120</span><span class="op" id="3965292">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3965295">func</span>&nbsp;<span class="ident" id="3965300">lookupNS</span><span class="op" id="3965308">(</span><span class="ident" id="3965309">name</span>&nbsp;<span class="builtintype" id="3965314">string</span><span class="op" id="3965320">)</span>&nbsp;<span class="op" id="3965322">(</span><span class="ident" id="3965323">ns</span>&nbsp;<span class="op" id="3965326">[</span><span class="op" id="3965327">]</span><span class="op" id="3965328">*</span><span class="ident" id="3965329">NS</span><span class="op" id="3965331">,</span>&nbsp;<span class="ident" id="3965333">err</span>&nbsp;<span class="builtintype" id="3965337">error</span><span class="op" id="3965342">)</span>&nbsp;<span class="op" id="3965344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3965347">_</span><span class="op" id="3965348">,</span>&nbsp;<span class="ident" id="3965350">records</span><span class="op" id="3965357">,</span>&nbsp;<span class="ident" id="3965359">err</span>&nbsp;<span class="op" id="3965363">:=</span>&nbsp;<span class="ident" id="3965366">lookup</span><span class="op" id="3965372">(</span><span class="ident" id="3965373">name</span><span class="op" id="3965377">,</span>&nbsp;<span class="ident" id="3965379">dnsTypeNS</span><span class="op" id="3965388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3965391">if</span>&nbsp;<span class="ident" id="3965394">err</span>&nbsp;<span class="op" id="3965398">!=</span>&nbsp;<span class="builtintype" id="3965401">nil</span>&nbsp;<span class="op" id="3965405">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3965409">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3965417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3965420">ns</span>&nbsp;<span class="op" id="3965423">=</span>&nbsp;<span class="builtinfunc" id="3965425">make</span><span class="op" id="3965429">(</span><span class="op" id="3965430">[</span><span class="op" id="3965431">]</span><span class="op" id="3965432">*</span><span class="ident" id="3965433">NS</span><span class="op" id="3965435">,</span>&nbsp;<span class="builtinfunc" id="3965437">len</span><span class="op" id="3965440">(</span><span class="ident" id="3965441">records</span><span class="op" id="3965448">)</span><span class="op" id="3965449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3965452">for</span>&nbsp;<span class="ident" id="3965456">i</span><span class="op" id="3965457">,</span>&nbsp;<span class="ident" id="3965459">r</span>&nbsp;<span class="op" id="3965461">:=</span>&nbsp;<span class="keyword" id="3965464">range</span>&nbsp;<span class="ident" id="3965470">records</span>&nbsp;<span class="op" id="3965478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3965482">r</span>&nbsp;<span class="op" id="3965484">:=</span>&nbsp;<span class="ident" id="3965487">r</span><span class="op" id="3965488">.</span><span class="op" id="3965489">(</span><span class="op" id="3965490">*</span><span class="ident" id="3965491">dnsRR_NS</span><span class="op" id="3965499">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3965503">ns</span><span class="op" id="3965505">[</span><span class="ident" id="3965506">i</span><span class="op" id="3965507">]</span>&nbsp;<span class="op" id="3965509">=</span>&nbsp;<span class="op" id="3965511">&amp;</span><span class="ident" id="3965512">NS</span><span class="op" id="3965514">{</span><span class="ident" id="3965515">r</span><span class="op" id="3965516">.</span><span class="ident" id="3965517">Ns</span><span class="op" id="3965519">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3965522">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3965525">return</span><br>
<span class="lineno"></span><span class="op" id="3965532">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="keyword" id="3965535">func</span>&nbsp;<span class="ident" id="3965540">lookupTXT</span><span class="op" id="3965549">(</span><span class="ident" id="3965550">name</span>&nbsp;<span class="builtintype" id="3965555">string</span><span class="op" id="3965561">)</span>&nbsp;<span class="op" id="3965563">(</span><span class="ident" id="3965564">txt</span>&nbsp;<span class="op" id="3965568">[</span><span class="op" id="3965569">]</span><span class="builtintype" id="3965570">string</span><span class="op" id="3965576">,</span>&nbsp;<span class="ident" id="3965578">err</span>&nbsp;<span class="builtintype" id="3965582">error</span><span class="op" id="3965587">)</span>&nbsp;<span class="op" id="3965589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3965592">_</span><span class="op" id="3965593">,</span>&nbsp;<span class="ident" id="3965595">records</span><span class="op" id="3965602">,</span>&nbsp;<span class="ident" id="3965604">err</span>&nbsp;<span class="op" id="3965608">:=</span>&nbsp;<span class="ident" id="3965611">lookup</span><span class="op" id="3965617">(</span><span class="ident" id="3965618">name</span><span class="op" id="3965622">,</span>&nbsp;<span class="ident" id="3965624">dnsTypeTXT</span><span class="op" id="3965634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3965637">if</span>&nbsp;<span class="ident" id="3965640">err</span>&nbsp;<span class="op" id="3965644">!=</span>&nbsp;<span class="builtintype" id="3965647">nil</span>&nbsp;<span class="op" id="3965651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3965655">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3965663">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3965666">txt</span>&nbsp;<span class="op" id="3965670">=</span>&nbsp;<span class="builtinfunc" id="3965672">make</span><span class="op" id="3965676">(</span><span class="op" id="3965677">[</span><span class="op" id="3965678">]</span><span class="builtintype" id="3965679">string</span><span class="op" id="3965685">,</span>&nbsp;<span class="builtinfunc" id="3965687">len</span><span class="op" id="3965690">(</span><span class="ident" id="3965691">records</span><span class="op" id="3965698">)</span><span class="op" id="3965699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3965702">for</span>&nbsp;<span class="ident" id="3965706">i</span><span class="op" id="3965707">,</span>&nbsp;<span class="ident" id="3965709">r</span>&nbsp;<span class="op" id="3965711">:=</span>&nbsp;<span class="keyword" id="3965714">range</span>&nbsp;<span class="ident" id="3965720">records</span>&nbsp;<span class="op" id="3965728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3965732">txt</span><span class="op" id="3965735">[</span><span class="ident" id="3965736">i</span><span class="op" id="3965737">]</span>&nbsp;<span class="op" id="3965739">=</span>&nbsp;<span class="ident" id="3965741">r</span><span class="op" id="3965742">.</span><span class="op" id="3965743">(</span><span class="op" id="3965744">*</span><span class="ident" id="3965745">dnsRR_TXT</span><span class="op" id="3965754">)</span><span class="op" id="3965755">.</span><span class="ident" id="3965756">Txt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3965761">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3965764">return</span><br>
<span class="lineno">145</span><span class="op" id="3965771">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3965774">func</span>&nbsp;<span class="ident" id="3965779">lookupAddr</span><span class="op" id="3965789">(</span><span class="ident" id="3965790">addr</span>&nbsp;<span class="builtintype" id="3965795">string</span><span class="op" id="3965801">)</span>&nbsp;<span class="op" id="3965803">(</span><span class="ident" id="3965804">name</span>&nbsp;<span class="op" id="3965809">[</span><span class="op" id="3965810">]</span><span class="builtintype" id="3965811">string</span><span class="op" id="3965817">,</span>&nbsp;<span class="ident" id="3965819">err</span>&nbsp;<span class="builtintype" id="3965823">error</span><span class="op" id="3965828">)</span>&nbsp;<span class="op" id="3965830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3965833">name</span>&nbsp;<span class="op" id="3965838">=</span>&nbsp;<span class="ident" id="3965840">lookupStaticAddr</span><span class="op" id="3965856">(</span><span class="ident" id="3965857">addr</span><span class="op" id="3965861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3965864">if</span>&nbsp;<span class="builtinfunc" id="3965867">len</span><span class="op" id="3965870">(</span><span class="ident" id="3965871">name</span><span class="op" id="3965875">)</span>&nbsp;<span class="op" id="3965877">&gt;</span>&nbsp;<span class="num" id="3965879">0</span>&nbsp;<span class="op" id="3965881">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3965885">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3965893">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3965896">var</span>&nbsp;<span class="ident" id="3965900">arpa</span>&nbsp;<span class="builtintype" id="3965905">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3965913">arpa</span><span class="op" id="3965917">,</span>&nbsp;<span class="ident" id="3965919">err</span>&nbsp;<span class="op" id="3965923">=</span>&nbsp;<span class="ident" id="3965925">reverseaddr</span><span class="op" id="3965936">(</span><span class="ident" id="3965937">addr</span><span class="op" id="3965941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3965944">if</span>&nbsp;<span class="ident" id="3965947">err</span>&nbsp;<span class="op" id="3965951">!=</span>&nbsp;<span class="builtintype" id="3965954">nil</span>&nbsp;<span class="op" id="3965958">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3965962">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3965970">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3965973">var</span>&nbsp;<span class="ident" id="3965977">records</span>&nbsp;<span class="op" id="3965985">[</span><span class="op" id="3965986">]</span><span class="ident" id="3965987">dnsRR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3965994">_</span><span class="op" id="3965995">,</span>&nbsp;<span class="ident" id="3965997">records</span><span class="op" id="3966004">,</span>&nbsp;<span class="ident" id="3966006">err</span>&nbsp;<span class="op" id="3966010">=</span>&nbsp;<span class="ident" id="3966012">lookup</span><span class="op" id="3966018">(</span><span class="ident" id="3966019">arpa</span><span class="op" id="3966023">,</span>&nbsp;<span class="ident" id="3966025">dnsTypePTR</span><span class="op" id="3966035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3966038">if</span>&nbsp;<span class="ident" id="3966041">err</span>&nbsp;<span class="op" id="3966045">!=</span>&nbsp;<span class="builtintype" id="3966048">nil</span>&nbsp;<span class="op" id="3966052">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3966056">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3966064">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3966067">name</span>&nbsp;<span class="op" id="3966072">=</span>&nbsp;<span class="builtinfunc" id="3966074">make</span><span class="op" id="3966078">(</span><span class="op" id="3966079">[</span><span class="op" id="3966080">]</span><span class="builtintype" id="3966081">string</span><span class="op" id="3966087">,</span>&nbsp;<span class="builtinfunc" id="3966089">len</span><span class="op" id="3966092">(</span><span class="ident" id="3966093">records</span><span class="op" id="3966100">)</span><span class="op" id="3966101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3966104">for</span>&nbsp;<span class="ident" id="3966108">i</span>&nbsp;<span class="op" id="3966110">:=</span>&nbsp;<span class="keyword" id="3966113">range</span>&nbsp;<span class="ident" id="3966119">records</span>&nbsp;<span class="op" id="3966127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3966131">r</span>&nbsp;<span class="op" id="3966133">:=</span>&nbsp;<span class="ident" id="3966136">records</span><span class="op" id="3966143">[</span><span class="ident" id="3966144">i</span><span class="op" id="3966145">]</span><span class="op" id="3966146">.</span><span class="op" id="3966147">(</span><span class="op" id="3966148">*</span><span class="ident" id="3966149">dnsRR_PTR</span><span class="op" id="3966158">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3966162">name</span><span class="op" id="3966166">[</span><span class="ident" id="3966167">i</span><span class="op" id="3966168">]</span>&nbsp;<span class="op" id="3966170">=</span>&nbsp;<span class="ident" id="3966172">r</span><span class="op" id="3966173">.</span><span class="ident" id="3966174">Ptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3966179">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3966182">return</span><br>
<span class="lineno"></span><span class="op" id="3966189">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
