<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html" class="current">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7580167">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7580222">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7580276">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7580327">package</span>&nbsp;<span class="ident" id="7580335">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7580340">import</span>&nbsp;<span class="op" id="7580347">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7580350">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7580357">&#34;os&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7580363">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7580374">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7580384">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7580387">var</span>&nbsp;<span class="ident" id="7580391">ipv4MulticastListenerTests</span>&nbsp;<span class="op" id="7580418">=</span>&nbsp;<span class="op" id="7580420">[</span><span class="op" id="7580421">]</span><span class="keyword" id="7580422">struct</span>&nbsp;<span class="op" id="7580429">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7580432">net</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7580438">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7580446">gaddr</span>&nbsp;<span class="op" id="7580452">*</span><span class="ident" id="7580453">UDPAddr</span>&nbsp;<span class="comment" id="7580461">//&nbsp;see&nbsp;RFC&nbsp;4727</span><br>
<span class="lineno"></span><span class="op" id="7580477">}</span><span class="op" id="7580478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7580481">{</span><span class="string" id="7580482">&#34;udp&#34;</span><span class="op" id="7580487">,</span>&nbsp;<span class="op" id="7580489">&amp;</span><span class="ident" id="7580490">UDPAddr</span><span class="op" id="7580497">{</span><span class="ident" id="7580498">IP</span><span class="op" id="7580500">:</span>&nbsp;<span class="ident" id="7580502">IPv4</span><span class="op" id="7580506">(</span><span class="num" id="7580507">224</span><span class="op" id="7580510">,</span>&nbsp;<span class="num" id="7580512">0</span><span class="op" id="7580513">,</span>&nbsp;<span class="num" id="7580515">0</span><span class="op" id="7580516">,</span>&nbsp;<span class="num" id="7580518">254</span><span class="op" id="7580521">)</span><span class="op" id="7580522">,</span>&nbsp;<span class="ident" id="7580524">Port</span><span class="op" id="7580528">:</span>&nbsp;<span class="num" id="7580530">12345</span><span class="op" id="7580535">}</span><span class="op" id="7580536">}</span><span class="op" id="7580537">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7580541">{</span><span class="string" id="7580542">&#34;udp4&#34;</span><span class="op" id="7580548">,</span>&nbsp;<span class="op" id="7580550">&amp;</span><span class="ident" id="7580551">UDPAddr</span><span class="op" id="7580558">{</span><span class="ident" id="7580559">IP</span><span class="op" id="7580561">:</span>&nbsp;<span class="ident" id="7580563">IPv4</span><span class="op" id="7580567">(</span><span class="num" id="7580568">224</span><span class="op" id="7580571">,</span>&nbsp;<span class="num" id="7580573">0</span><span class="op" id="7580574">,</span>&nbsp;<span class="num" id="7580576">0</span><span class="op" id="7580577">,</span>&nbsp;<span class="num" id="7580579">254</span><span class="op" id="7580582">)</span><span class="op" id="7580583">,</span>&nbsp;<span class="ident" id="7580585">Port</span><span class="op" id="7580589">:</span>&nbsp;<span class="num" id="7580591">12345</span><span class="op" id="7580596">}</span><span class="op" id="7580597">}</span><span class="op" id="7580598">,</span><br>
<span class="lineno"></span><span class="op" id="7580600">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7580603">//&nbsp;TestIPv4MulticastListener&nbsp;tests&nbsp;both&nbsp;single&nbsp;and&nbsp;double&nbsp;listen&nbsp;to&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="7580673">//&nbsp;test&nbsp;listener&nbsp;with&nbsp;same&nbsp;address&nbsp;family,&nbsp;same&nbsp;group&nbsp;address&nbsp;and&nbsp;same</span><br>
<span class="lineno">25</span><span class="comment" id="7580744">//&nbsp;port.</span><br>
<span class="lineno"></span><span class="keyword" id="7580753">func</span>&nbsp;<span class="ident" id="7580758">TestIPv4MulticastListener</span><span class="op" id="7580783">(</span><span class="ident" id="7580784">t</span>&nbsp;<span class="op" id="7580786">*</span><span class="ident" id="7580787">testing</span><span class="op" id="7580794">.</span><span class="ident" id="7580795">T</span><span class="op" id="7580796">)</span>&nbsp;<span class="op" id="7580798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7580801">switch</span>&nbsp;<span class="ident" id="7580808">runtime</span><span class="op" id="7580815">.</span><span class="ident" id="7580816">GOOS</span>&nbsp;<span class="op" id="7580821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7580824">case</span>&nbsp;<span class="string" id="7580829">&#34;android&#34;</span><span class="op" id="7580838">,</span>&nbsp;<span class="string" id="7580840">&#34;nacl&#34;</span><span class="op" id="7580846">,</span>&nbsp;<span class="string" id="7580848">&#34;plan9&#34;</span><span class="op" id="7580855">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7580859">t</span><span class="op" id="7580860">.</span><span class="ident" id="7580861">Skipf</span><span class="op" id="7580866">(</span><span class="string" id="7580867">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7580888">,</span>&nbsp;<span class="ident" id="7580890">runtime</span><span class="op" id="7580897">.</span><span class="ident" id="7580898">GOOS</span><span class="op" id="7580902">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7580905">case</span>&nbsp;<span class="string" id="7580910">&#34;solaris&#34;</span><span class="op" id="7580919">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7580923">t</span><span class="op" id="7580924">.</span><span class="ident" id="7580925">Skipf</span><span class="op" id="7580930">(</span><span class="string" id="7580931">&#34;skipping&nbsp;test&nbsp;on&nbsp;solaris,&nbsp;see&nbsp;issue&nbsp;7399&#34;</span><span class="op" id="7580973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7580976">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7580980">closer</span>&nbsp;<span class="op" id="7580987">:=</span>&nbsp;<span class="keyword" id="7580990">func</span><span class="op" id="7580994">(</span><span class="ident" id="7580995">cs</span>&nbsp;<span class="op" id="7580998">[</span><span class="op" id="7580999">]</span><span class="op" id="7581000">*</span><span class="ident" id="7581001">UDPConn</span><span class="op" id="7581008">)</span>&nbsp;<span class="op" id="7581010">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7581014">for</span>&nbsp;<span class="ident" id="7581018">_</span><span class="op" id="7581019">,</span>&nbsp;<span class="ident" id="7581021">c</span>&nbsp;<span class="op" id="7581023">:=</span>&nbsp;<span class="keyword" id="7581026">range</span>&nbsp;<span class="ident" id="7581032">cs</span>&nbsp;<span class="op" id="7581035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7581040">if</span>&nbsp;<span class="ident" id="7581043">c</span>&nbsp;<span class="op" id="7581045">!=</span>&nbsp;<span class="ident" id="7581048">nil</span>&nbsp;<span class="op" id="7581052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7581058">c</span><span class="op" id="7581059">.</span><span class="ident" id="7581060">Close</span><span class="op" id="7581065">(</span><span class="op" id="7581066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7581071">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7581075">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7581078">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7581082">for</span>&nbsp;<span class="ident" id="7581086">_</span><span class="op" id="7581087">,</span>&nbsp;<span class="ident" id="7581089">ifi</span>&nbsp;<span class="op" id="7581093">:=</span>&nbsp;<span class="keyword" id="7581096">range</span>&nbsp;<span class="op" id="7581102">[</span><span class="op" id="7581103">]</span><span class="op" id="7581104">*</span><span class="ident" id="7581105">Interface</span><span class="op" id="7581114">{</span><span class="ident" id="7581115">loopbackInterface</span><span class="op" id="7581132">(</span><span class="op" id="7581133">)</span><span class="op" id="7581134">,</span>&nbsp;<span class="ident" id="7581136">nil</span><span class="op" id="7581139">}</span>&nbsp;<span class="op" id="7581141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7581145">//&nbsp;Note&nbsp;that&nbsp;multicast&nbsp;interface&nbsp;assignment&nbsp;by&nbsp;system</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7581201">//&nbsp;is&nbsp;not&nbsp;recommended&nbsp;because&nbsp;it&nbsp;usually&nbsp;relies&nbsp;on</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7581254">//&nbsp;routing&nbsp;stuff&nbsp;for&nbsp;finding&nbsp;out&nbsp;an&nbsp;appropriate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7581304">//&nbsp;nexthop&nbsp;containing&nbsp;both&nbsp;network&nbsp;and&nbsp;link&nbsp;layer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7581356">//&nbsp;adjacencies.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7581374">if</span>&nbsp;<span class="ident" id="7581377">ifi</span>&nbsp;<span class="op" id="7581381">==</span>&nbsp;<span class="ident" id="7581384">nil</span>&nbsp;<span class="op" id="7581388">&amp;&amp;</span>&nbsp;<span class="op" id="7581391">!</span><span class="op" id="7581392">*</span><span class="ident" id="7581393">testExternal</span>&nbsp;<span class="op" id="7581406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7581411">continue</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7581422">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7581426">for</span>&nbsp;<span class="ident" id="7581430">_</span><span class="op" id="7581431">,</span>&nbsp;<span class="ident" id="7581433">tt</span>&nbsp;<span class="op" id="7581436">:=</span>&nbsp;<span class="keyword" id="7581439">range</span>&nbsp;<span class="ident" id="7581445">ipv4MulticastListenerTests</span>&nbsp;<span class="op" id="7581472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7581477">var</span>&nbsp;<span class="ident" id="7581481">err</span>&nbsp;<span class="builtintype" id="7581485">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7581494">cs</span>&nbsp;<span class="op" id="7581497">:=</span>&nbsp;<span class="builtinfunc" id="7581500">make</span><span class="op" id="7581504">(</span><span class="op" id="7581505">[</span><span class="op" id="7581506">]</span><span class="op" id="7581507">*</span><span class="ident" id="7581508">UDPConn</span><span class="op" id="7581515">,</span>&nbsp;<span class="num" id="7581517">2</span><span class="op" id="7581518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7581523">if</span>&nbsp;<span class="ident" id="7581526">cs</span><span class="op" id="7581528">[</span><span class="num" id="7581529">0</span><span class="op" id="7581530">]</span><span class="op" id="7581531">,</span>&nbsp;<span class="ident" id="7581533">err</span>&nbsp;<span class="op" id="7581537">=</span>&nbsp;<span class="ident" id="7581539">ListenMulticastUDP</span><span class="op" id="7581557">(</span><span class="ident" id="7581558">tt</span><span class="op" id="7581560">.</span><span class="ident" id="7581561">net</span><span class="op" id="7581564">,</span>&nbsp;<span class="ident" id="7581566">ifi</span><span class="op" id="7581569">,</span>&nbsp;<span class="ident" id="7581571">tt</span><span class="op" id="7581573">.</span><span class="ident" id="7581574">gaddr</span><span class="op" id="7581579">)</span><span class="op" id="7581580">;</span>&nbsp;<span class="ident" id="7581582">err</span>&nbsp;<span class="op" id="7581586">!=</span>&nbsp;<span class="ident" id="7581589">nil</span>&nbsp;<span class="op" id="7581593">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7581599">t</span><span class="op" id="7581600">.</span><span class="ident" id="7581601">Fatalf</span><span class="op" id="7581607">(</span><span class="string" id="7581608">&#34;First&nbsp;ListenMulticastUDP&nbsp;on&nbsp;%v&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7581651">,</span>&nbsp;<span class="ident" id="7581653">ifi</span><span class="op" id="7581656">,</span>&nbsp;<span class="ident" id="7581658">err</span><span class="op" id="7581661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7581666">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7581671">if</span>&nbsp;<span class="ident" id="7581674">err</span>&nbsp;<span class="op" id="7581678">:=</span>&nbsp;<span class="ident" id="7581681">checkMulticastListener</span><span class="op" id="7581703">(</span><span class="ident" id="7581704">cs</span><span class="op" id="7581706">[</span><span class="num" id="7581707">0</span><span class="op" id="7581708">]</span><span class="op" id="7581709">,</span>&nbsp;<span class="ident" id="7581711">tt</span><span class="op" id="7581713">.</span><span class="ident" id="7581714">gaddr</span><span class="op" id="7581719">.</span><span class="ident" id="7581720">IP</span><span class="op" id="7581722">)</span><span class="op" id="7581723">;</span>&nbsp;<span class="ident" id="7581725">err</span>&nbsp;<span class="op" id="7581729">!=</span>&nbsp;<span class="ident" id="7581732">nil</span>&nbsp;<span class="op" id="7581736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7581742">closer</span><span class="op" id="7581748">(</span><span class="ident" id="7581749">cs</span><span class="op" id="7581751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7581757">t</span><span class="op" id="7581758">.</span><span class="ident" id="7581759">Fatal</span><span class="op" id="7581764">(</span><span class="ident" id="7581765">err</span><span class="op" id="7581768">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7581773">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7581778">if</span>&nbsp;<span class="ident" id="7581781">cs</span><span class="op" id="7581783">[</span><span class="num" id="7581784">1</span><span class="op" id="7581785">]</span><span class="op" id="7581786">,</span>&nbsp;<span class="ident" id="7581788">err</span>&nbsp;<span class="op" id="7581792">=</span>&nbsp;<span class="ident" id="7581794">ListenMulticastUDP</span><span class="op" id="7581812">(</span><span class="ident" id="7581813">tt</span><span class="op" id="7581815">.</span><span class="ident" id="7581816">net</span><span class="op" id="7581819">,</span>&nbsp;<span class="ident" id="7581821">ifi</span><span class="op" id="7581824">,</span>&nbsp;<span class="ident" id="7581826">tt</span><span class="op" id="7581828">.</span><span class="ident" id="7581829">gaddr</span><span class="op" id="7581834">)</span><span class="op" id="7581835">;</span>&nbsp;<span class="ident" id="7581837">err</span>&nbsp;<span class="op" id="7581841">!=</span>&nbsp;<span class="ident" id="7581844">nil</span>&nbsp;<span class="op" id="7581848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7581854">closer</span><span class="op" id="7581860">(</span><span class="ident" id="7581861">cs</span><span class="op" id="7581863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7581869">t</span><span class="op" id="7581870">.</span><span class="ident" id="7581871">Fatalf</span><span class="op" id="7581877">(</span><span class="string" id="7581878">&#34;Second&nbsp;ListenMulticastUDP&nbsp;on&nbsp;%v&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7581922">,</span>&nbsp;<span class="ident" id="7581924">ifi</span><span class="op" id="7581927">,</span>&nbsp;<span class="ident" id="7581929">err</span><span class="op" id="7581932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7581937">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7581942">if</span>&nbsp;<span class="ident" id="7581945">err</span>&nbsp;<span class="op" id="7581949">:=</span>&nbsp;<span class="ident" id="7581952">checkMulticastListener</span><span class="op" id="7581974">(</span><span class="ident" id="7581975">cs</span><span class="op" id="7581977">[</span><span class="num" id="7581978">1</span><span class="op" id="7581979">]</span><span class="op" id="7581980">,</span>&nbsp;<span class="ident" id="7581982">tt</span><span class="op" id="7581984">.</span><span class="ident" id="7581985">gaddr</span><span class="op" id="7581990">.</span><span class="ident" id="7581991">IP</span><span class="op" id="7581993">)</span><span class="op" id="7581994">;</span>&nbsp;<span class="ident" id="7581996">err</span>&nbsp;<span class="op" id="7582000">!=</span>&nbsp;<span class="ident" id="7582003">nil</span>&nbsp;<span class="op" id="7582007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7582013">closer</span><span class="op" id="7582019">(</span><span class="ident" id="7582020">cs</span><span class="op" id="7582022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7582028">t</span><span class="op" id="7582029">.</span><span class="ident" id="7582030">Fatal</span><span class="op" id="7582035">(</span><span class="ident" id="7582036">err</span><span class="op" id="7582039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7582044">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7582049">closer</span><span class="op" id="7582055">(</span><span class="ident" id="7582056">cs</span><span class="op" id="7582058">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7582062">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7582065">}</span><br>
<span class="lineno"></span><span class="op" id="7582067">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7582070">var</span>&nbsp;<span class="ident" id="7582074">ipv6MulticastListenerTests</span>&nbsp;<span class="op" id="7582101">=</span>&nbsp;<span class="op" id="7582103">[</span><span class="op" id="7582104">]</span><span class="keyword" id="7582105">struct</span>&nbsp;<span class="op" id="7582112">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7582115">net</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7582121">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7582129">gaddr</span>&nbsp;<span class="op" id="7582135">*</span><span class="ident" id="7582136">UDPAddr</span>&nbsp;<span class="comment" id="7582144">//&nbsp;see&nbsp;RFC&nbsp;4727</span><br>
<span class="lineno"></span><span class="op" id="7582160">}</span><span class="op" id="7582161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7582164">{</span><span class="string" id="7582165">&#34;udp&#34;</span><span class="op" id="7582170">,</span>&nbsp;<span class="op" id="7582172">&amp;</span><span class="ident" id="7582173">UDPAddr</span><span class="op" id="7582180">{</span><span class="ident" id="7582181">IP</span><span class="op" id="7582183">:</span>&nbsp;<span class="ident" id="7582185">ParseIP</span><span class="op" id="7582192">(</span><span class="string" id="7582193">&#34;ff01::114&#34;</span><span class="op" id="7582204">)</span><span class="op" id="7582205">,</span>&nbsp;<span class="ident" id="7582207">Port</span><span class="op" id="7582211">:</span>&nbsp;<span class="num" id="7582213">12345</span><span class="op" id="7582218">}</span><span class="op" id="7582219">}</span><span class="op" id="7582220">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7582223">{</span><span class="string" id="7582224">&#34;udp&#34;</span><span class="op" id="7582229">,</span>&nbsp;<span class="op" id="7582231">&amp;</span><span class="ident" id="7582232">UDPAddr</span><span class="op" id="7582239">{</span><span class="ident" id="7582240">IP</span><span class="op" id="7582242">:</span>&nbsp;<span class="ident" id="7582244">ParseIP</span><span class="op" id="7582251">(</span><span class="string" id="7582252">&#34;ff02::114&#34;</span><span class="op" id="7582263">)</span><span class="op" id="7582264">,</span>&nbsp;<span class="ident" id="7582266">Port</span><span class="op" id="7582270">:</span>&nbsp;<span class="num" id="7582272">12345</span><span class="op" id="7582277">}</span><span class="op" id="7582278">}</span><span class="op" id="7582279">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7582282">{</span><span class="string" id="7582283">&#34;udp&#34;</span><span class="op" id="7582288">,</span>&nbsp;<span class="op" id="7582290">&amp;</span><span class="ident" id="7582291">UDPAddr</span><span class="op" id="7582298">{</span><span class="ident" id="7582299">IP</span><span class="op" id="7582301">:</span>&nbsp;<span class="ident" id="7582303">ParseIP</span><span class="op" id="7582310">(</span><span class="string" id="7582311">&#34;ff04::114&#34;</span><span class="op" id="7582322">)</span><span class="op" id="7582323">,</span>&nbsp;<span class="ident" id="7582325">Port</span><span class="op" id="7582329">:</span>&nbsp;<span class="num" id="7582331">12345</span><span class="op" id="7582336">}</span><span class="op" id="7582337">}</span><span class="op" id="7582338">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7582341">{</span><span class="string" id="7582342">&#34;udp&#34;</span><span class="op" id="7582347">,</span>&nbsp;<span class="op" id="7582349">&amp;</span><span class="ident" id="7582350">UDPAddr</span><span class="op" id="7582357">{</span><span class="ident" id="7582358">IP</span><span class="op" id="7582360">:</span>&nbsp;<span class="ident" id="7582362">ParseIP</span><span class="op" id="7582369">(</span><span class="string" id="7582370">&#34;ff05::114&#34;</span><span class="op" id="7582381">)</span><span class="op" id="7582382">,</span>&nbsp;<span class="ident" id="7582384">Port</span><span class="op" id="7582388">:</span>&nbsp;<span class="num" id="7582390">12345</span><span class="op" id="7582395">}</span><span class="op" id="7582396">}</span><span class="op" id="7582397">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7582400">{</span><span class="string" id="7582401">&#34;udp&#34;</span><span class="op" id="7582406">,</span>&nbsp;<span class="op" id="7582408">&amp;</span><span class="ident" id="7582409">UDPAddr</span><span class="op" id="7582416">{</span><span class="ident" id="7582417">IP</span><span class="op" id="7582419">:</span>&nbsp;<span class="ident" id="7582421">ParseIP</span><span class="op" id="7582428">(</span><span class="string" id="7582429">&#34;ff08::114&#34;</span><span class="op" id="7582440">)</span><span class="op" id="7582441">,</span>&nbsp;<span class="ident" id="7582443">Port</span><span class="op" id="7582447">:</span>&nbsp;<span class="num" id="7582449">12345</span><span class="op" id="7582454">}</span><span class="op" id="7582455">}</span><span class="op" id="7582456">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7582459">{</span><span class="string" id="7582460">&#34;udp&#34;</span><span class="op" id="7582465">,</span>&nbsp;<span class="op" id="7582467">&amp;</span><span class="ident" id="7582468">UDPAddr</span><span class="op" id="7582475">{</span><span class="ident" id="7582476">IP</span><span class="op" id="7582478">:</span>&nbsp;<span class="ident" id="7582480">ParseIP</span><span class="op" id="7582487">(</span><span class="string" id="7582488">&#34;ff0e::114&#34;</span><span class="op" id="7582499">)</span><span class="op" id="7582500">,</span>&nbsp;<span class="ident" id="7582502">Port</span><span class="op" id="7582506">:</span>&nbsp;<span class="num" id="7582508">12345</span><span class="op" id="7582513">}</span><span class="op" id="7582514">}</span><span class="op" id="7582515">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7582519">{</span><span class="string" id="7582520">&#34;udp6&#34;</span><span class="op" id="7582526">,</span>&nbsp;<span class="op" id="7582528">&amp;</span><span class="ident" id="7582529">UDPAddr</span><span class="op" id="7582536">{</span><span class="ident" id="7582537">IP</span><span class="op" id="7582539">:</span>&nbsp;<span class="ident" id="7582541">ParseIP</span><span class="op" id="7582548">(</span><span class="string" id="7582549">&#34;ff01::114&#34;</span><span class="op" id="7582560">)</span><span class="op" id="7582561">,</span>&nbsp;<span class="ident" id="7582563">Port</span><span class="op" id="7582567">:</span>&nbsp;<span class="num" id="7582569">12345</span><span class="op" id="7582574">}</span><span class="op" id="7582575">}</span><span class="op" id="7582576">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7582579">{</span><span class="string" id="7582580">&#34;udp6&#34;</span><span class="op" id="7582586">,</span>&nbsp;<span class="op" id="7582588">&amp;</span><span class="ident" id="7582589">UDPAddr</span><span class="op" id="7582596">{</span><span class="ident" id="7582597">IP</span><span class="op" id="7582599">:</span>&nbsp;<span class="ident" id="7582601">ParseIP</span><span class="op" id="7582608">(</span><span class="string" id="7582609">&#34;ff02::114&#34;</span><span class="op" id="7582620">)</span><span class="op" id="7582621">,</span>&nbsp;<span class="ident" id="7582623">Port</span><span class="op" id="7582627">:</span>&nbsp;<span class="num" id="7582629">12345</span><span class="op" id="7582634">}</span><span class="op" id="7582635">}</span><span class="op" id="7582636">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7582639">{</span><span class="string" id="7582640">&#34;udp6&#34;</span><span class="op" id="7582646">,</span>&nbsp;<span class="op" id="7582648">&amp;</span><span class="ident" id="7582649">UDPAddr</span><span class="op" id="7582656">{</span><span class="ident" id="7582657">IP</span><span class="op" id="7582659">:</span>&nbsp;<span class="ident" id="7582661">ParseIP</span><span class="op" id="7582668">(</span><span class="string" id="7582669">&#34;ff04::114&#34;</span><span class="op" id="7582680">)</span><span class="op" id="7582681">,</span>&nbsp;<span class="ident" id="7582683">Port</span><span class="op" id="7582687">:</span>&nbsp;<span class="num" id="7582689">12345</span><span class="op" id="7582694">}</span><span class="op" id="7582695">}</span><span class="op" id="7582696">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7582699">{</span><span class="string" id="7582700">&#34;udp6&#34;</span><span class="op" id="7582706">,</span>&nbsp;<span class="op" id="7582708">&amp;</span><span class="ident" id="7582709">UDPAddr</span><span class="op" id="7582716">{</span><span class="ident" id="7582717">IP</span><span class="op" id="7582719">:</span>&nbsp;<span class="ident" id="7582721">ParseIP</span><span class="op" id="7582728">(</span><span class="string" id="7582729">&#34;ff05::114&#34;</span><span class="op" id="7582740">)</span><span class="op" id="7582741">,</span>&nbsp;<span class="ident" id="7582743">Port</span><span class="op" id="7582747">:</span>&nbsp;<span class="num" id="7582749">12345</span><span class="op" id="7582754">}</span><span class="op" id="7582755">}</span><span class="op" id="7582756">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7582759">{</span><span class="string" id="7582760">&#34;udp6&#34;</span><span class="op" id="7582766">,</span>&nbsp;<span class="op" id="7582768">&amp;</span><span class="ident" id="7582769">UDPAddr</span><span class="op" id="7582776">{</span><span class="ident" id="7582777">IP</span><span class="op" id="7582779">:</span>&nbsp;<span class="ident" id="7582781">ParseIP</span><span class="op" id="7582788">(</span><span class="string" id="7582789">&#34;ff08::114&#34;</span><span class="op" id="7582800">)</span><span class="op" id="7582801">,</span>&nbsp;<span class="ident" id="7582803">Port</span><span class="op" id="7582807">:</span>&nbsp;<span class="num" id="7582809">12345</span><span class="op" id="7582814">}</span><span class="op" id="7582815">}</span><span class="op" id="7582816">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7582819">{</span><span class="string" id="7582820">&#34;udp6&#34;</span><span class="op" id="7582826">,</span>&nbsp;<span class="op" id="7582828">&amp;</span><span class="ident" id="7582829">UDPAddr</span><span class="op" id="7582836">{</span><span class="ident" id="7582837">IP</span><span class="op" id="7582839">:</span>&nbsp;<span class="ident" id="7582841">ParseIP</span><span class="op" id="7582848">(</span><span class="string" id="7582849">&#34;ff0e::114&#34;</span><span class="op" id="7582860">)</span><span class="op" id="7582861">,</span>&nbsp;<span class="ident" id="7582863">Port</span><span class="op" id="7582867">:</span>&nbsp;<span class="num" id="7582869">12345</span><span class="op" id="7582874">}</span><span class="op" id="7582875">}</span><span class="op" id="7582876">,</span><br>
<span class="lineno"></span><span class="op" id="7582878">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7582881">//&nbsp;TestIPv6MulticastListener&nbsp;tests&nbsp;both&nbsp;single&nbsp;and&nbsp;double&nbsp;listen&nbsp;to&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="7582951">//&nbsp;test&nbsp;listener&nbsp;with&nbsp;same&nbsp;address&nbsp;family,&nbsp;same&nbsp;group&nbsp;address&nbsp;and&nbsp;same</span><br>
<span class="lineno">95</span><span class="comment" id="7583022">//&nbsp;port.</span><br>
<span class="lineno"></span><span class="keyword" id="7583031">func</span>&nbsp;<span class="ident" id="7583036">TestIPv6MulticastListener</span><span class="op" id="7583061">(</span><span class="ident" id="7583062">t</span>&nbsp;<span class="op" id="7583064">*</span><span class="ident" id="7583065">testing</span><span class="op" id="7583072">.</span><span class="ident" id="7583073">T</span><span class="op" id="7583074">)</span>&nbsp;<span class="op" id="7583076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7583079">switch</span>&nbsp;<span class="ident" id="7583086">runtime</span><span class="op" id="7583093">.</span><span class="ident" id="7583094">GOOS</span>&nbsp;<span class="op" id="7583099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7583102">case</span>&nbsp;<span class="string" id="7583107">&#34;plan9&#34;</span><span class="op" id="7583114">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7583118">t</span><span class="op" id="7583119">.</span><span class="ident" id="7583120">Skipf</span><span class="op" id="7583125">(</span><span class="string" id="7583126">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7583147">,</span>&nbsp;<span class="ident" id="7583149">runtime</span><span class="op" id="7583156">.</span><span class="ident" id="7583157">GOOS</span><span class="op" id="7583161">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7583164">case</span>&nbsp;<span class="string" id="7583169">&#34;solaris&#34;</span><span class="op" id="7583178">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7583182">t</span><span class="op" id="7583183">.</span><span class="ident" id="7583184">Skipf</span><span class="op" id="7583189">(</span><span class="string" id="7583190">&#34;skipping&nbsp;test&nbsp;on&nbsp;solaris,&nbsp;see&nbsp;issue&nbsp;7399&#34;</span><span class="op" id="7583232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7583235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7583238">if</span>&nbsp;<span class="op" id="7583241">!</span><span class="ident" id="7583242">supportsIPv6</span>&nbsp;<span class="op" id="7583255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7583259">t</span><span class="op" id="7583260">.</span><span class="ident" id="7583261">Skip</span><span class="op" id="7583265">(</span><span class="string" id="7583266">&#34;ipv6&nbsp;is&nbsp;not&nbsp;supported&#34;</span><span class="op" id="7583289">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7583292">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7583295">if</span>&nbsp;<span class="ident" id="7583298">os</span><span class="op" id="7583300">.</span><span class="ident" id="7583301">Getuid</span><span class="op" id="7583307">(</span><span class="op" id="7583308">)</span>&nbsp;<span class="op" id="7583310">!=</span>&nbsp;<span class="num" id="7583313">0</span>&nbsp;<span class="op" id="7583315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7583319">t</span><span class="op" id="7583320">.</span><span class="ident" id="7583321">Skip</span><span class="op" id="7583325">(</span><span class="string" id="7583326">&#34;skipping&nbsp;test;&nbsp;must&nbsp;be&nbsp;root&#34;</span><span class="op" id="7583355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7583358">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7583362">closer</span>&nbsp;<span class="op" id="7583369">:=</span>&nbsp;<span class="keyword" id="7583372">func</span><span class="op" id="7583376">(</span><span class="ident" id="7583377">cs</span>&nbsp;<span class="op" id="7583380">[</span><span class="op" id="7583381">]</span><span class="op" id="7583382">*</span><span class="ident" id="7583383">UDPConn</span><span class="op" id="7583390">)</span>&nbsp;<span class="op" id="7583392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7583396">for</span>&nbsp;<span class="ident" id="7583400">_</span><span class="op" id="7583401">,</span>&nbsp;<span class="ident" id="7583403">c</span>&nbsp;<span class="op" id="7583405">:=</span>&nbsp;<span class="keyword" id="7583408">range</span>&nbsp;<span class="ident" id="7583414">cs</span>&nbsp;<span class="op" id="7583417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7583422">if</span>&nbsp;<span class="ident" id="7583425">c</span>&nbsp;<span class="op" id="7583427">!=</span>&nbsp;<span class="ident" id="7583430">nil</span>&nbsp;<span class="op" id="7583434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7583440">c</span><span class="op" id="7583441">.</span><span class="ident" id="7583442">Close</span><span class="op" id="7583447">(</span><span class="op" id="7583448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7583453">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7583457">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7583460">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7583464">for</span>&nbsp;<span class="ident" id="7583468">_</span><span class="op" id="7583469">,</span>&nbsp;<span class="ident" id="7583471">ifi</span>&nbsp;<span class="op" id="7583475">:=</span>&nbsp;<span class="keyword" id="7583478">range</span>&nbsp;<span class="op" id="7583484">[</span><span class="op" id="7583485">]</span><span class="op" id="7583486">*</span><span class="ident" id="7583487">Interface</span><span class="op" id="7583496">{</span><span class="ident" id="7583497">loopbackInterface</span><span class="op" id="7583514">(</span><span class="op" id="7583515">)</span><span class="op" id="7583516">,</span>&nbsp;<span class="ident" id="7583518">nil</span><span class="op" id="7583521">}</span>&nbsp;<span class="op" id="7583523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7583527">//&nbsp;Note&nbsp;that&nbsp;multicast&nbsp;interface&nbsp;assignment&nbsp;by&nbsp;system</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7583583">//&nbsp;is&nbsp;not&nbsp;recommended&nbsp;because&nbsp;it&nbsp;usually&nbsp;relies&nbsp;on</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7583636">//&nbsp;routing&nbsp;stuff&nbsp;for&nbsp;finding&nbsp;out&nbsp;an&nbsp;appropriate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7583686">//&nbsp;nexthop&nbsp;containing&nbsp;both&nbsp;network&nbsp;and&nbsp;link&nbsp;layer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7583738">//&nbsp;adjacencies.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7583756">if</span>&nbsp;<span class="ident" id="7583759">ifi</span>&nbsp;<span class="op" id="7583763">==</span>&nbsp;<span class="ident" id="7583766">nil</span>&nbsp;<span class="op" id="7583770">&amp;&amp;</span>&nbsp;<span class="op" id="7583773">(</span><span class="op" id="7583774">!</span><span class="op" id="7583775">*</span><span class="ident" id="7583776">testExternal</span>&nbsp;<span class="op" id="7583789">||</span>&nbsp;<span class="op" id="7583792">!</span><span class="op" id="7583793">*</span><span class="ident" id="7583794">testIPv6</span><span class="op" id="7583802">)</span>&nbsp;<span class="op" id="7583804">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7583809">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7583820">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7583824">for</span>&nbsp;<span class="ident" id="7583828">_</span><span class="op" id="7583829">,</span>&nbsp;<span class="ident" id="7583831">tt</span>&nbsp;<span class="op" id="7583834">:=</span>&nbsp;<span class="keyword" id="7583837">range</span>&nbsp;<span class="ident" id="7583843">ipv6MulticastListenerTests</span>&nbsp;<span class="op" id="7583870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7583875">var</span>&nbsp;<span class="ident" id="7583879">err</span>&nbsp;<span class="builtintype" id="7583883">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7583892">cs</span>&nbsp;<span class="op" id="7583895">:=</span>&nbsp;<span class="builtinfunc" id="7583898">make</span><span class="op" id="7583902">(</span><span class="op" id="7583903">[</span><span class="op" id="7583904">]</span><span class="op" id="7583905">*</span><span class="ident" id="7583906">UDPConn</span><span class="op" id="7583913">,</span>&nbsp;<span class="num" id="7583915">2</span><span class="op" id="7583916">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7583921">if</span>&nbsp;<span class="ident" id="7583924">cs</span><span class="op" id="7583926">[</span><span class="num" id="7583927">0</span><span class="op" id="7583928">]</span><span class="op" id="7583929">,</span>&nbsp;<span class="ident" id="7583931">err</span>&nbsp;<span class="op" id="7583935">=</span>&nbsp;<span class="ident" id="7583937">ListenMulticastUDP</span><span class="op" id="7583955">(</span><span class="ident" id="7583956">tt</span><span class="op" id="7583958">.</span><span class="ident" id="7583959">net</span><span class="op" id="7583962">,</span>&nbsp;<span class="ident" id="7583964">ifi</span><span class="op" id="7583967">,</span>&nbsp;<span class="ident" id="7583969">tt</span><span class="op" id="7583971">.</span><span class="ident" id="7583972">gaddr</span><span class="op" id="7583977">)</span><span class="op" id="7583978">;</span>&nbsp;<span class="ident" id="7583980">err</span>&nbsp;<span class="op" id="7583984">!=</span>&nbsp;<span class="ident" id="7583987">nil</span>&nbsp;<span class="op" id="7583991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7583997">t</span><span class="op" id="7583998">.</span><span class="ident" id="7583999">Fatalf</span><span class="op" id="7584005">(</span><span class="string" id="7584006">&#34;First&nbsp;ListenMulticastUDP&nbsp;on&nbsp;%v&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7584049">,</span>&nbsp;<span class="ident" id="7584051">ifi</span><span class="op" id="7584054">,</span>&nbsp;<span class="ident" id="7584056">err</span><span class="op" id="7584059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7584064">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7584069">if</span>&nbsp;<span class="ident" id="7584072">err</span>&nbsp;<span class="op" id="7584076">:=</span>&nbsp;<span class="ident" id="7584079">checkMulticastListener</span><span class="op" id="7584101">(</span><span class="ident" id="7584102">cs</span><span class="op" id="7584104">[</span><span class="num" id="7584105">0</span><span class="op" id="7584106">]</span><span class="op" id="7584107">,</span>&nbsp;<span class="ident" id="7584109">tt</span><span class="op" id="7584111">.</span><span class="ident" id="7584112">gaddr</span><span class="op" id="7584117">.</span><span class="ident" id="7584118">IP</span><span class="op" id="7584120">)</span><span class="op" id="7584121">;</span>&nbsp;<span class="ident" id="7584123">err</span>&nbsp;<span class="op" id="7584127">!=</span>&nbsp;<span class="ident" id="7584130">nil</span>&nbsp;<span class="op" id="7584134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7584140">closer</span><span class="op" id="7584146">(</span><span class="ident" id="7584147">cs</span><span class="op" id="7584149">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7584155">t</span><span class="op" id="7584156">.</span><span class="ident" id="7584157">Fatal</span><span class="op" id="7584162">(</span><span class="ident" id="7584163">err</span><span class="op" id="7584166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7584171">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7584176">if</span>&nbsp;<span class="ident" id="7584179">cs</span><span class="op" id="7584181">[</span><span class="num" id="7584182">1</span><span class="op" id="7584183">]</span><span class="op" id="7584184">,</span>&nbsp;<span class="ident" id="7584186">err</span>&nbsp;<span class="op" id="7584190">=</span>&nbsp;<span class="ident" id="7584192">ListenMulticastUDP</span><span class="op" id="7584210">(</span><span class="ident" id="7584211">tt</span><span class="op" id="7584213">.</span><span class="ident" id="7584214">net</span><span class="op" id="7584217">,</span>&nbsp;<span class="ident" id="7584219">ifi</span><span class="op" id="7584222">,</span>&nbsp;<span class="ident" id="7584224">tt</span><span class="op" id="7584226">.</span><span class="ident" id="7584227">gaddr</span><span class="op" id="7584232">)</span><span class="op" id="7584233">;</span>&nbsp;<span class="ident" id="7584235">err</span>&nbsp;<span class="op" id="7584239">!=</span>&nbsp;<span class="ident" id="7584242">nil</span>&nbsp;<span class="op" id="7584246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7584252">closer</span><span class="op" id="7584258">(</span><span class="ident" id="7584259">cs</span><span class="op" id="7584261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7584267">t</span><span class="op" id="7584268">.</span><span class="ident" id="7584269">Fatalf</span><span class="op" id="7584275">(</span><span class="string" id="7584276">&#34;Second&nbsp;ListenMulticastUDP&nbsp;on&nbsp;%v&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7584320">,</span>&nbsp;<span class="ident" id="7584322">ifi</span><span class="op" id="7584325">,</span>&nbsp;<span class="ident" id="7584327">err</span><span class="op" id="7584330">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7584335">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7584340">if</span>&nbsp;<span class="ident" id="7584343">err</span>&nbsp;<span class="op" id="7584347">:=</span>&nbsp;<span class="ident" id="7584350">checkMulticastListener</span><span class="op" id="7584372">(</span><span class="ident" id="7584373">cs</span><span class="op" id="7584375">[</span><span class="num" id="7584376">1</span><span class="op" id="7584377">]</span><span class="op" id="7584378">,</span>&nbsp;<span class="ident" id="7584380">tt</span><span class="op" id="7584382">.</span><span class="ident" id="7584383">gaddr</span><span class="op" id="7584388">.</span><span class="ident" id="7584389">IP</span><span class="op" id="7584391">)</span><span class="op" id="7584392">;</span>&nbsp;<span class="ident" id="7584394">err</span>&nbsp;<span class="op" id="7584398">!=</span>&nbsp;<span class="ident" id="7584401">nil</span>&nbsp;<span class="op" id="7584405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7584411">closer</span><span class="op" id="7584417">(</span><span class="ident" id="7584418">cs</span><span class="op" id="7584420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7584426">t</span><span class="op" id="7584427">.</span><span class="ident" id="7584428">Fatal</span><span class="op" id="7584433">(</span><span class="ident" id="7584434">err</span><span class="op" id="7584437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7584442">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7584447">closer</span><span class="op" id="7584453">(</span><span class="ident" id="7584454">cs</span><span class="op" id="7584456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7584460">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7584463">}</span><br>
<span class="lineno"></span><span class="op" id="7584465">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="keyword" id="7584468">func</span>&nbsp;<span class="ident" id="7584473">checkMulticastListener</span><span class="op" id="7584495">(</span><span class="ident" id="7584496">c</span>&nbsp;<span class="op" id="7584498">*</span><span class="ident" id="7584499">UDPConn</span><span class="op" id="7584506">,</span>&nbsp;<span class="ident" id="7584508">ip</span>&nbsp;<span class="ident" id="7584511">IP</span><span class="op" id="7584513">)</span>&nbsp;<span class="builtintype" id="7584515">error</span>&nbsp;<span class="op" id="7584521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7584524">if</span>&nbsp;<span class="ident" id="7584527">ok</span><span class="op" id="7584529">,</span>&nbsp;<span class="ident" id="7584531">err</span>&nbsp;<span class="op" id="7584535">:=</span>&nbsp;<span class="ident" id="7584538">multicastRIBContains</span><span class="op" id="7584558">(</span><span class="ident" id="7584559">ip</span><span class="op" id="7584561">)</span><span class="op" id="7584562">;</span>&nbsp;<span class="ident" id="7584564">err</span>&nbsp;<span class="op" id="7584568">!=</span>&nbsp;<span class="ident" id="7584571">nil</span>&nbsp;<span class="op" id="7584575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7584579">return</span>&nbsp;<span class="ident" id="7584586">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7584591">}</span>&nbsp;<span class="keyword" id="7584593">else</span>&nbsp;<span class="keyword" id="7584598">if</span>&nbsp;<span class="op" id="7584601">!</span><span class="ident" id="7584602">ok</span>&nbsp;<span class="op" id="7584605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7584609">return</span>&nbsp;<span class="ident" id="7584616">fmt</span><span class="op" id="7584619">.</span><span class="ident" id="7584620">Errorf</span><span class="op" id="7584626">(</span><span class="string" id="7584627">&#34;%q&nbsp;not&nbsp;found&nbsp;in&nbsp;multicast&nbsp;RIB&#34;</span><span class="op" id="7584658">,</span>&nbsp;<span class="ident" id="7584660">ip</span><span class="op" id="7584662">.</span><span class="ident" id="7584663">String</span><span class="op" id="7584669">(</span><span class="op" id="7584670">)</span><span class="op" id="7584671">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7584674">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7584677">la</span>&nbsp;<span class="op" id="7584680">:=</span>&nbsp;<span class="ident" id="7584683">c</span><span class="op" id="7584684">.</span><span class="ident" id="7584685">LocalAddr</span><span class="op" id="7584694">(</span><span class="op" id="7584695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7584698">if</span>&nbsp;<span class="ident" id="7584701">la</span><span class="op" id="7584703">,</span>&nbsp;<span class="ident" id="7584705">ok</span>&nbsp;<span class="op" id="7584708">:=</span>&nbsp;<span class="ident" id="7584711">la</span><span class="op" id="7584713">.</span><span class="op" id="7584714">(</span><span class="op" id="7584715">*</span><span class="ident" id="7584716">UDPAddr</span><span class="op" id="7584723">)</span><span class="op" id="7584724">;</span>&nbsp;<span class="op" id="7584726">!</span><span class="ident" id="7584727">ok</span>&nbsp;<span class="op" id="7584730">||</span>&nbsp;<span class="ident" id="7584733">la</span><span class="op" id="7584735">.</span><span class="ident" id="7584736">Port</span>&nbsp;<span class="op" id="7584741">==</span>&nbsp;<span class="num" id="7584744">0</span>&nbsp;<span class="op" id="7584746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7584750">return</span>&nbsp;<span class="ident" id="7584757">fmt</span><span class="op" id="7584760">.</span><span class="ident" id="7584761">Errorf</span><span class="op" id="7584767">(</span><span class="string" id="7584768">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;non-zero&nbsp;port&nbsp;number&#34;</span><span class="op" id="7584829">,</span>&nbsp;<span class="ident" id="7584831">la</span><span class="op" id="7584833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7584836">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7584839">return</span>&nbsp;<span class="ident" id="7584846">nil</span><br>
<span class="lineno"></span><span class="op" id="7584850">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7584853">func</span>&nbsp;<span class="ident" id="7584858">multicastRIBContains</span><span class="op" id="7584878">(</span><span class="ident" id="7584879">ip</span>&nbsp;<span class="ident" id="7584882">IP</span><span class="op" id="7584884">)</span>&nbsp;<span class="op" id="7584886">(</span><span class="builtintype" id="7584887">bool</span><span class="op" id="7584891">,</span>&nbsp;<span class="builtintype" id="7584893">error</span><span class="op" id="7584898">)</span>&nbsp;<span class="op" id="7584900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7584903">switch</span>&nbsp;<span class="ident" id="7584910">runtime</span><span class="op" id="7584917">.</span><span class="ident" id="7584918">GOOS</span>&nbsp;<span class="op" id="7584923">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7584926">case</span>&nbsp;<span class="string" id="7584931">&#34;dragonfly&#34;</span><span class="op" id="7584942">,</span>&nbsp;<span class="string" id="7584944">&#34;netbsd&#34;</span><span class="op" id="7584952">,</span>&nbsp;<span class="string" id="7584954">&#34;openbsd&#34;</span><span class="op" id="7584963">,</span>&nbsp;<span class="string" id="7584965">&#34;plan9&#34;</span><span class="op" id="7584972">,</span>&nbsp;<span class="string" id="7584974">&#34;solaris&#34;</span><span class="op" id="7584983">,</span>&nbsp;<span class="string" id="7584985">&#34;windows&#34;</span><span class="op" id="7584994">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7584998">return</span>&nbsp;<span class="builtintype" id="7585005">true</span><span class="op" id="7585009">,</span>&nbsp;<span class="ident" id="7585011">nil</span>&nbsp;<span class="comment" id="7585015">//&nbsp;not&nbsp;implemented&nbsp;yet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7585039">case</span>&nbsp;<span class="string" id="7585044">&#34;linux&#34;</span><span class="op" id="7585051">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7585055">if</span>&nbsp;<span class="ident" id="7585058">runtime</span><span class="op" id="7585065">.</span><span class="ident" id="7585066">GOARCH</span>&nbsp;<span class="op" id="7585073">==</span>&nbsp;<span class="string" id="7585076">&#34;arm&#34;</span>&nbsp;<span class="op" id="7585082">||</span>&nbsp;<span class="ident" id="7585085">runtime</span><span class="op" id="7585092">.</span><span class="ident" id="7585093">GOARCH</span>&nbsp;<span class="op" id="7585100">==</span>&nbsp;<span class="string" id="7585103">&#34;alpha&#34;</span>&nbsp;<span class="op" id="7585111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7585116">return</span>&nbsp;<span class="builtintype" id="7585123">true</span><span class="op" id="7585127">,</span>&nbsp;<span class="ident" id="7585129">nil</span>&nbsp;<span class="comment" id="7585133">//&nbsp;not&nbsp;implemented&nbsp;yet</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7585158">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7585161">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7585164">ift</span><span class="op" id="7585167">,</span>&nbsp;<span class="ident" id="7585169">err</span>&nbsp;<span class="op" id="7585173">:=</span>&nbsp;<span class="ident" id="7585176">Interfaces</span><span class="op" id="7585186">(</span><span class="op" id="7585187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7585190">if</span>&nbsp;<span class="ident" id="7585193">err</span>&nbsp;<span class="op" id="7585197">!=</span>&nbsp;<span class="ident" id="7585200">nil</span>&nbsp;<span class="op" id="7585204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7585208">return</span>&nbsp;<span class="builtintype" id="7585215">false</span><span class="op" id="7585220">,</span>&nbsp;<span class="ident" id="7585222">err</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7585227">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7585230">for</span>&nbsp;<span class="ident" id="7585234">_</span><span class="op" id="7585235">,</span>&nbsp;<span class="ident" id="7585237">ifi</span>&nbsp;<span class="op" id="7585241">:=</span>&nbsp;<span class="keyword" id="7585244">range</span>&nbsp;<span class="ident" id="7585250">ift</span>&nbsp;<span class="op" id="7585254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7585258">ifmat</span><span class="op" id="7585263">,</span>&nbsp;<span class="ident" id="7585265">err</span>&nbsp;<span class="op" id="7585269">:=</span>&nbsp;<span class="ident" id="7585272">ifi</span><span class="op" id="7585275">.</span><span class="ident" id="7585276">MulticastAddrs</span><span class="op" id="7585290">(</span><span class="op" id="7585291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7585295">if</span>&nbsp;<span class="ident" id="7585298">err</span>&nbsp;<span class="op" id="7585302">!=</span>&nbsp;<span class="ident" id="7585305">nil</span>&nbsp;<span class="op" id="7585309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7585314">return</span>&nbsp;<span class="builtintype" id="7585321">false</span><span class="op" id="7585326">,</span>&nbsp;<span class="ident" id="7585328">err</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7585334">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7585338">for</span>&nbsp;<span class="ident" id="7585342">_</span><span class="op" id="7585343">,</span>&nbsp;<span class="ident" id="7585345">ifma</span>&nbsp;<span class="op" id="7585350">:=</span>&nbsp;<span class="keyword" id="7585353">range</span>&nbsp;<span class="ident" id="7585359">ifmat</span>&nbsp;<span class="op" id="7585365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7585370">if</span>&nbsp;<span class="ident" id="7585373">ifma</span><span class="op" id="7585377">.</span><span class="op" id="7585378">(</span><span class="op" id="7585379">*</span><span class="ident" id="7585380">IPAddr</span><span class="op" id="7585386">)</span><span class="op" id="7585387">.</span><span class="ident" id="7585388">IP</span><span class="op" id="7585390">.</span><span class="ident" id="7585391">Equal</span><span class="op" id="7585396">(</span><span class="ident" id="7585397">ip</span><span class="op" id="7585399">)</span>&nbsp;<span class="op" id="7585401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7585407">return</span>&nbsp;<span class="builtintype" id="7585414">true</span><span class="op" id="7585418">,</span>&nbsp;<span class="ident" id="7585420">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7585427">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7585431">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7585434">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7585437">return</span>&nbsp;<span class="builtintype" id="7585444">false</span><span class="op" id="7585449">,</span>&nbsp;<span class="ident" id="7585451">nil</span><br>
<span class="lineno"></span><span class="op" id="7585455">}</span>
</div>
</body>
</html>
