<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/elliptic</h2>
<ul>
<li><a href="/gostd/crypto/elliptic/elliptic.go.html">elliptic.go</a></li>
<li><a href="/gostd/crypto/elliptic/elliptic_test.go.html">elliptic_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224.go.html">p224.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224_test.go.html">p224_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p256.go.html">p256.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4905805">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4905861">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4905915">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4905966">package</span>&nbsp;<span class="ident" id="4905974">elliptic</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4905984">//&nbsp;This&nbsp;is&nbsp;a&nbsp;constant-time,&nbsp;32-bit&nbsp;implementation&nbsp;of&nbsp;P224.&nbsp;See&nbsp;FIPS&nbsp;186-3,</span><br>
<span class="lineno"></span><span class="comment" id="4906059">//&nbsp;section&nbsp;D.2.2.</span><br>
<span class="lineno"></span><span class="comment" id="4906077">//</span><br>
<span class="lineno">10</span><span class="comment" id="4906080">//&nbsp;See&nbsp;http://www.imperialviolet.org/2010/12/04/ecc.html&nbsp;([1])&nbsp;for&nbsp;background.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4906160">import</span>&nbsp;<span class="op" id="4906167">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4906170">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="4906181">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="4906184">var</span>&nbsp;<span class="ident" id="4906188">p224</span>&nbsp;<span class="ident" id="4906193">p224Curve</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4906204">type</span>&nbsp;<span class="ident" id="4906209">p224Curve</span>&nbsp;<span class="keyword" id="4906219">struct</span>&nbsp;<span class="op" id="4906226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4906229">*</span><span class="ident" id="4906230">CurveParams</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4906243">gx</span><span class="op" id="4906245">,</span>&nbsp;<span class="ident" id="4906247">gy</span><span class="op" id="4906249">,</span>&nbsp;<span class="ident" id="4906251">b</span>&nbsp;<span class="ident" id="4906253">p224FieldElement</span><br>
<span class="lineno"></span><span class="op" id="4906270">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4906273">func</span>&nbsp;<span class="ident" id="4906278">initP224</span><span class="op" id="4906286">(</span><span class="op" id="4906287">)</span>&nbsp;<span class="op" id="4906289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4906292">//&nbsp;See&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.2</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4906326">p224</span><span class="op" id="4906330">.</span><span class="ident" id="4906331">CurveParams</span>&nbsp;<span class="op" id="4906343">=</span>&nbsp;<span class="builtinfunc" id="4906345">new</span><span class="op" id="4906348">(</span><span class="ident" id="4906349">CurveParams</span><span class="op" id="4906360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4906363">p224</span><span class="op" id="4906367">.</span><span class="ident" id="4906368">P</span><span class="op" id="4906369">,</span>&nbsp;<span class="ident" id="4906371">_</span>&nbsp;<span class="op" id="4906373">=</span>&nbsp;<span class="builtinfunc" id="4906375">new</span><span class="op" id="4906378">(</span><span class="ident" id="4906379">big</span><span class="op" id="4906382">.</span><span class="ident" id="4906383">Int</span><span class="op" id="4906386">)</span><span class="op" id="4906387">.</span><span class="ident" id="4906388">SetString</span><span class="op" id="4906397">(</span><span class="string" id="4906398">&#34;26959946667150639794667015087019630673557916260026308143510066298881&#34;</span><span class="op" id="4906468">,</span>&nbsp;<span class="num" id="4906470">10</span><span class="op" id="4906472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4906475">p224</span><span class="op" id="4906479">.</span><span class="ident" id="4906480">N</span><span class="op" id="4906481">,</span>&nbsp;<span class="ident" id="4906483">_</span>&nbsp;<span class="op" id="4906485">=</span>&nbsp;<span class="builtinfunc" id="4906487">new</span><span class="op" id="4906490">(</span><span class="ident" id="4906491">big</span><span class="op" id="4906494">.</span><span class="ident" id="4906495">Int</span><span class="op" id="4906498">)</span><span class="op" id="4906499">.</span><span class="ident" id="4906500">SetString</span><span class="op" id="4906509">(</span><span class="string" id="4906510">&#34;26959946667150639794667015087019625940457807714424391721682722368061&#34;</span><span class="op" id="4906580">,</span>&nbsp;<span class="num" id="4906582">10</span><span class="op" id="4906584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4906587">p224</span><span class="op" id="4906591">.</span><span class="ident" id="4906592">B</span><span class="op" id="4906593">,</span>&nbsp;<span class="ident" id="4906595">_</span>&nbsp;<span class="op" id="4906597">=</span>&nbsp;<span class="builtinfunc" id="4906599">new</span><span class="op" id="4906602">(</span><span class="ident" id="4906603">big</span><span class="op" id="4906606">.</span><span class="ident" id="4906607">Int</span><span class="op" id="4906610">)</span><span class="op" id="4906611">.</span><span class="ident" id="4906612">SetString</span><span class="op" id="4906621">(</span><span class="string" id="4906622">&#34;b4050a850c04b3abf54132565044b0b7d7bfd8ba270b39432355ffb4&#34;</span><span class="op" id="4906680">,</span>&nbsp;<span class="num" id="4906682">16</span><span class="op" id="4906684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4906687">p224</span><span class="op" id="4906691">.</span><span class="ident" id="4906692">Gx</span><span class="op" id="4906694">,</span>&nbsp;<span class="ident" id="4906696">_</span>&nbsp;<span class="op" id="4906698">=</span>&nbsp;<span class="builtinfunc" id="4906700">new</span><span class="op" id="4906703">(</span><span class="ident" id="4906704">big</span><span class="op" id="4906707">.</span><span class="ident" id="4906708">Int</span><span class="op" id="4906711">)</span><span class="op" id="4906712">.</span><span class="ident" id="4906713">SetString</span><span class="op" id="4906722">(</span><span class="string" id="4906723">&#34;b70e0cbd6bb4bf7f321390b94a03c1d356c21122343280d6115c1d21&#34;</span><span class="op" id="4906781">,</span>&nbsp;<span class="num" id="4906783">16</span><span class="op" id="4906785">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4906788">p224</span><span class="op" id="4906792">.</span><span class="ident" id="4906793">Gy</span><span class="op" id="4906795">,</span>&nbsp;<span class="ident" id="4906797">_</span>&nbsp;<span class="op" id="4906799">=</span>&nbsp;<span class="builtinfunc" id="4906801">new</span><span class="op" id="4906804">(</span><span class="ident" id="4906805">big</span><span class="op" id="4906808">.</span><span class="ident" id="4906809">Int</span><span class="op" id="4906812">)</span><span class="op" id="4906813">.</span><span class="ident" id="4906814">SetString</span><span class="op" id="4906823">(</span><span class="string" id="4906824">&#34;bd376388b5f723fb4c22dfe6cd4375a05a07476444d5819985007e34&#34;</span><span class="op" id="4906882">,</span>&nbsp;<span class="num" id="4906884">16</span><span class="op" id="4906886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4906889">p224</span><span class="op" id="4906893">.</span><span class="ident" id="4906894">BitSize</span>&nbsp;<span class="op" id="4906902">=</span>&nbsp;<span class="num" id="4906904">224</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4906910">p224FromBig</span><span class="op" id="4906921">(</span><span class="op" id="4906922">&amp;</span><span class="ident" id="4906923">p224</span><span class="op" id="4906927">.</span><span class="ident" id="4906928">gx</span><span class="op" id="4906930">,</span>&nbsp;<span class="ident" id="4906932">p224</span><span class="op" id="4906936">.</span><span class="ident" id="4906937">Gx</span><span class="op" id="4906939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4906942">p224FromBig</span><span class="op" id="4906953">(</span><span class="op" id="4906954">&amp;</span><span class="ident" id="4906955">p224</span><span class="op" id="4906959">.</span><span class="ident" id="4906960">gy</span><span class="op" id="4906962">,</span>&nbsp;<span class="ident" id="4906964">p224</span><span class="op" id="4906968">.</span><span class="ident" id="4906969">Gy</span><span class="op" id="4906971">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4906974">p224FromBig</span><span class="op" id="4906985">(</span><span class="op" id="4906986">&amp;</span><span class="ident" id="4906987">p224</span><span class="op" id="4906991">.</span><span class="ident" id="4906992">b</span><span class="op" id="4906993">,</span>&nbsp;<span class="ident" id="4906995">p224</span><span class="op" id="4906999">.</span><span class="ident" id="4907000">B</span><span class="op" id="4907001">)</span><br>
<span class="lineno"></span><span class="op" id="4907003">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4907006">//&nbsp;P224&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-224&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.2)</span><br>
<span class="lineno"></span><span class="keyword" id="4907085">func</span>&nbsp;<span class="ident" id="4907090">P224</span><span class="op" id="4907094">(</span><span class="op" id="4907095">)</span>&nbsp;<span class="ident" id="4907097">Curve</span>&nbsp;<span class="op" id="4907103">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4907106">initonce</span><span class="op" id="4907114">.</span><span class="ident" id="4907115">Do</span><span class="op" id="4907117">(</span><span class="ident" id="4907118">initAll</span><span class="op" id="4907125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4907128">return</span>&nbsp;<span class="ident" id="4907135">p224</span><br>
<span class="lineno"></span><span class="op" id="4907140">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4907143">func</span>&nbsp;<span class="op" id="4907148">(</span><span class="ident" id="4907149">curve</span>&nbsp;<span class="ident" id="4907155">p224Curve</span><span class="op" id="4907164">)</span>&nbsp;<span class="ident" id="4907166">Params</span><span class="op" id="4907172">(</span><span class="op" id="4907173">)</span>&nbsp;<span class="op" id="4907175">*</span><span class="ident" id="4907176">CurveParams</span>&nbsp;<span class="op" id="4907188">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4907191">return</span>&nbsp;<span class="ident" id="4907198">curve</span><span class="op" id="4907203">.</span><span class="ident" id="4907204">CurveParams</span><br>
<span class="lineno"></span><span class="op" id="4907216">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4907219">func</span>&nbsp;<span class="op" id="4907224">(</span><span class="ident" id="4907225">curve</span>&nbsp;<span class="ident" id="4907231">p224Curve</span><span class="op" id="4907240">)</span>&nbsp;<span class="ident" id="4907242">IsOnCurve</span><span class="op" id="4907251">(</span><span class="ident" id="4907252">bigX</span><span class="op" id="4907256">,</span>&nbsp;<span class="ident" id="4907258">bigY</span>&nbsp;<span class="op" id="4907263">*</span><span class="ident" id="4907264">big</span><span class="op" id="4907267">.</span><span class="ident" id="4907268">Int</span><span class="op" id="4907271">)</span>&nbsp;<span class="builtintype" id="4907273">bool</span>&nbsp;<span class="op" id="4907278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4907281">var</span>&nbsp;<span class="ident" id="4907285">x</span><span class="op" id="4907286">,</span>&nbsp;<span class="ident" id="4907288">y</span>&nbsp;<span class="ident" id="4907290">p224FieldElement</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4907308">p224FromBig</span><span class="op" id="4907319">(</span><span class="op" id="4907320">&amp;</span><span class="ident" id="4907321">x</span><span class="op" id="4907322">,</span>&nbsp;<span class="ident" id="4907324">bigX</span><span class="op" id="4907328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4907331">p224FromBig</span><span class="op" id="4907342">(</span><span class="op" id="4907343">&amp;</span><span class="ident" id="4907344">y</span><span class="op" id="4907345">,</span>&nbsp;<span class="ident" id="4907347">bigY</span><span class="op" id="4907351">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4907355">//&nbsp;y²&nbsp;=&nbsp;x³&nbsp;-&nbsp;3x&nbsp;+&nbsp;b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4907378">var</span>&nbsp;<span class="ident" id="4907382">tmp</span>&nbsp;<span class="ident" id="4907386">p224LargeFieldElement</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4907409">var</span>&nbsp;<span class="ident" id="4907413">x3</span>&nbsp;<span class="ident" id="4907416">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4907434">p224Square</span><span class="op" id="4907444">(</span><span class="op" id="4907445">&amp;</span><span class="ident" id="4907446">x3</span><span class="op" id="4907448">,</span>&nbsp;<span class="op" id="4907450">&amp;</span><span class="ident" id="4907451">x</span><span class="op" id="4907452">,</span>&nbsp;<span class="op" id="4907454">&amp;</span><span class="ident" id="4907455">tmp</span><span class="op" id="4907458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4907461">p224Mul</span><span class="op" id="4907468">(</span><span class="op" id="4907469">&amp;</span><span class="ident" id="4907470">x3</span><span class="op" id="4907472">,</span>&nbsp;<span class="op" id="4907474">&amp;</span><span class="ident" id="4907475">x3</span><span class="op" id="4907477">,</span>&nbsp;<span class="op" id="4907479">&amp;</span><span class="ident" id="4907480">x</span><span class="op" id="4907481">,</span>&nbsp;<span class="op" id="4907483">&amp;</span><span class="ident" id="4907484">tmp</span><span class="op" id="4907487">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4907491">for</span>&nbsp;<span class="ident" id="4907495">i</span>&nbsp;<span class="op" id="4907497">:=</span>&nbsp;<span class="num" id="4907500">0</span><span class="op" id="4907501">;</span>&nbsp;<span class="ident" id="4907503">i</span>&nbsp;<span class="op" id="4907505">&lt;</span>&nbsp;<span class="num" id="4907507">8</span><span class="op" id="4907508">;</span>&nbsp;<span class="ident" id="4907510">i</span><span class="op" id="4907511">++</span>&nbsp;<span class="op" id="4907514">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4907518">x</span><span class="op" id="4907519">[</span><span class="ident" id="4907520">i</span><span class="op" id="4907521">]</span>&nbsp;<span class="op" id="4907523">*=</span>&nbsp;<span class="num" id="4907526">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4907529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4907532">p224Sub</span><span class="op" id="4907539">(</span><span class="op" id="4907540">&amp;</span><span class="ident" id="4907541">x3</span><span class="op" id="4907543">,</span>&nbsp;<span class="op" id="4907545">&amp;</span><span class="ident" id="4907546">x3</span><span class="op" id="4907548">,</span>&nbsp;<span class="op" id="4907550">&amp;</span><span class="ident" id="4907551">x</span><span class="op" id="4907552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4907555">p224Reduce</span><span class="op" id="4907565">(</span><span class="op" id="4907566">&amp;</span><span class="ident" id="4907567">x3</span><span class="op" id="4907569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4907572">p224Add</span><span class="op" id="4907579">(</span><span class="op" id="4907580">&amp;</span><span class="ident" id="4907581">x3</span><span class="op" id="4907583">,</span>&nbsp;<span class="op" id="4907585">&amp;</span><span class="ident" id="4907586">x3</span><span class="op" id="4907588">,</span>&nbsp;<span class="op" id="4907590">&amp;</span><span class="ident" id="4907591">curve</span><span class="op" id="4907596">.</span><span class="ident" id="4907597">b</span><span class="op" id="4907598">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4907601">p224Contract</span><span class="op" id="4907613">(</span><span class="op" id="4907614">&amp;</span><span class="ident" id="4907615">x3</span><span class="op" id="4907617">,</span>&nbsp;<span class="op" id="4907619">&amp;</span><span class="ident" id="4907620">x3</span><span class="op" id="4907622">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4907626">p224Square</span><span class="op" id="4907636">(</span><span class="op" id="4907637">&amp;</span><span class="ident" id="4907638">y</span><span class="op" id="4907639">,</span>&nbsp;<span class="op" id="4907641">&amp;</span><span class="ident" id="4907642">y</span><span class="op" id="4907643">,</span>&nbsp;<span class="op" id="4907645">&amp;</span><span class="ident" id="4907646">tmp</span><span class="op" id="4907649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4907652">p224Contract</span><span class="op" id="4907664">(</span><span class="op" id="4907665">&amp;</span><span class="ident" id="4907666">y</span><span class="op" id="4907667">,</span>&nbsp;<span class="op" id="4907669">&amp;</span><span class="ident" id="4907670">y</span><span class="op" id="4907671">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4907675">for</span>&nbsp;<span class="ident" id="4907679">i</span>&nbsp;<span class="op" id="4907681">:=</span>&nbsp;<span class="num" id="4907684">0</span><span class="op" id="4907685">;</span>&nbsp;<span class="ident" id="4907687">i</span>&nbsp;<span class="op" id="4907689">&lt;</span>&nbsp;<span class="num" id="4907691">8</span><span class="op" id="4907692">;</span>&nbsp;<span class="ident" id="4907694">i</span><span class="op" id="4907695">++</span>&nbsp;<span class="op" id="4907698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4907702">if</span>&nbsp;<span class="ident" id="4907705">y</span><span class="op" id="4907706">[</span><span class="ident" id="4907707">i</span><span class="op" id="4907708">]</span>&nbsp;<span class="op" id="4907710">!=</span>&nbsp;<span class="ident" id="4907713">x3</span><span class="op" id="4907715">[</span><span class="ident" id="4907716">i</span><span class="op" id="4907717">]</span>&nbsp;<span class="op" id="4907719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4907724">return</span>&nbsp;<span class="builtintype" id="4907731">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4907739">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4907742">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4907745">return</span>&nbsp;<span class="builtintype" id="4907752">true</span><br>
<span class="lineno"></span><span class="op" id="4907757">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4907760">func</span>&nbsp;<span class="op" id="4907765">(</span><span class="ident" id="4907766">p224Curve</span><span class="op" id="4907775">)</span>&nbsp;<span class="ident" id="4907777">Add</span><span class="op" id="4907780">(</span><span class="ident" id="4907781">bigX1</span><span class="op" id="4907786">,</span>&nbsp;<span class="ident" id="4907788">bigY1</span><span class="op" id="4907793">,</span>&nbsp;<span class="ident" id="4907795">bigX2</span><span class="op" id="4907800">,</span>&nbsp;<span class="ident" id="4907802">bigY2</span>&nbsp;<span class="op" id="4907808">*</span><span class="ident" id="4907809">big</span><span class="op" id="4907812">.</span><span class="ident" id="4907813">Int</span><span class="op" id="4907816">)</span>&nbsp;<span class="op" id="4907818">(</span><span class="ident" id="4907819">x</span><span class="op" id="4907820">,</span>&nbsp;<span class="ident" id="4907822">y</span>&nbsp;<span class="op" id="4907824">*</span><span class="ident" id="4907825">big</span><span class="op" id="4907828">.</span><span class="ident" id="4907829">Int</span><span class="op" id="4907832">)</span>&nbsp;<span class="op" id="4907834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4907837">var</span>&nbsp;<span class="ident" id="4907841">x1</span><span class="op" id="4907843">,</span>&nbsp;<span class="ident" id="4907845">y1</span><span class="op" id="4907847">,</span>&nbsp;<span class="ident" id="4907849">z1</span><span class="op" id="4907851">,</span>&nbsp;<span class="ident" id="4907853">x2</span><span class="op" id="4907855">,</span>&nbsp;<span class="ident" id="4907857">y2</span><span class="op" id="4907859">,</span>&nbsp;<span class="ident" id="4907861">z2</span><span class="op" id="4907863">,</span>&nbsp;<span class="ident" id="4907865">x3</span><span class="op" id="4907867">,</span>&nbsp;<span class="ident" id="4907869">y3</span><span class="op" id="4907871">,</span>&nbsp;<span class="ident" id="4907873">z3</span>&nbsp;<span class="ident" id="4907876">p224FieldElement</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4907895">p224FromBig</span><span class="op" id="4907906">(</span><span class="op" id="4907907">&amp;</span><span class="ident" id="4907908">x1</span><span class="op" id="4907910">,</span>&nbsp;<span class="ident" id="4907912">bigX1</span><span class="op" id="4907917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4907920">p224FromBig</span><span class="op" id="4907931">(</span><span class="op" id="4907932">&amp;</span><span class="ident" id="4907933">y1</span><span class="op" id="4907935">,</span>&nbsp;<span class="ident" id="4907937">bigY1</span><span class="op" id="4907942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4907945">if</span>&nbsp;<span class="ident" id="4907948">bigX1</span><span class="op" id="4907953">.</span><span class="ident" id="4907954">Sign</span><span class="op" id="4907958">(</span><span class="op" id="4907959">)</span>&nbsp;<span class="op" id="4907961">!=</span>&nbsp;<span class="num" id="4907964">0</span>&nbsp;<span class="op" id="4907966">||</span>&nbsp;<span class="ident" id="4907969">bigY1</span><span class="op" id="4907974">.</span><span class="ident" id="4907975">Sign</span><span class="op" id="4907979">(</span><span class="op" id="4907980">)</span>&nbsp;<span class="op" id="4907982">!=</span>&nbsp;<span class="num" id="4907985">0</span>&nbsp;<span class="op" id="4907987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4907991">z1</span><span class="op" id="4907993">[</span><span class="num" id="4907994">0</span><span class="op" id="4907995">]</span>&nbsp;<span class="op" id="4907997">=</span>&nbsp;<span class="num" id="4907999">1</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4908002">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4908005">p224FromBig</span><span class="op" id="4908016">(</span><span class="op" id="4908017">&amp;</span><span class="ident" id="4908018">x2</span><span class="op" id="4908020">,</span>&nbsp;<span class="ident" id="4908022">bigX2</span><span class="op" id="4908027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4908030">p224FromBig</span><span class="op" id="4908041">(</span><span class="op" id="4908042">&amp;</span><span class="ident" id="4908043">y2</span><span class="op" id="4908045">,</span>&nbsp;<span class="ident" id="4908047">bigY2</span><span class="op" id="4908052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4908055">if</span>&nbsp;<span class="ident" id="4908058">bigX2</span><span class="op" id="4908063">.</span><span class="ident" id="4908064">Sign</span><span class="op" id="4908068">(</span><span class="op" id="4908069">)</span>&nbsp;<span class="op" id="4908071">!=</span>&nbsp;<span class="num" id="4908074">0</span>&nbsp;<span class="op" id="4908076">||</span>&nbsp;<span class="ident" id="4908079">bigY2</span><span class="op" id="4908084">.</span><span class="ident" id="4908085">Sign</span><span class="op" id="4908089">(</span><span class="op" id="4908090">)</span>&nbsp;<span class="op" id="4908092">!=</span>&nbsp;<span class="num" id="4908095">0</span>&nbsp;<span class="op" id="4908097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4908101">z2</span><span class="op" id="4908103">[</span><span class="num" id="4908104">0</span><span class="op" id="4908105">]</span>&nbsp;<span class="op" id="4908107">=</span>&nbsp;<span class="num" id="4908109">1</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4908112">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4908116">p224AddJacobian</span><span class="op" id="4908131">(</span><span class="op" id="4908132">&amp;</span><span class="ident" id="4908133">x3</span><span class="op" id="4908135">,</span>&nbsp;<span class="op" id="4908137">&amp;</span><span class="ident" id="4908138">y3</span><span class="op" id="4908140">,</span>&nbsp;<span class="op" id="4908142">&amp;</span><span class="ident" id="4908143">z3</span><span class="op" id="4908145">,</span>&nbsp;<span class="op" id="4908147">&amp;</span><span class="ident" id="4908148">x1</span><span class="op" id="4908150">,</span>&nbsp;<span class="op" id="4908152">&amp;</span><span class="ident" id="4908153">y1</span><span class="op" id="4908155">,</span>&nbsp;<span class="op" id="4908157">&amp;</span><span class="ident" id="4908158">z1</span><span class="op" id="4908160">,</span>&nbsp;<span class="op" id="4908162">&amp;</span><span class="ident" id="4908163">x2</span><span class="op" id="4908165">,</span>&nbsp;<span class="op" id="4908167">&amp;</span><span class="ident" id="4908168">y2</span><span class="op" id="4908170">,</span>&nbsp;<span class="op" id="4908172">&amp;</span><span class="ident" id="4908173">z2</span><span class="op" id="4908175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4908178">return</span>&nbsp;<span class="ident" id="4908185">p224ToAffine</span><span class="op" id="4908197">(</span><span class="op" id="4908198">&amp;</span><span class="ident" id="4908199">x3</span><span class="op" id="4908201">,</span>&nbsp;<span class="op" id="4908203">&amp;</span><span class="ident" id="4908204">y3</span><span class="op" id="4908206">,</span>&nbsp;<span class="op" id="4908208">&amp;</span><span class="ident" id="4908209">z3</span><span class="op" id="4908211">)</span><br>
<span class="lineno"></span><span class="op" id="4908213">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="4908216">func</span>&nbsp;<span class="op" id="4908221">(</span><span class="ident" id="4908222">p224Curve</span><span class="op" id="4908231">)</span>&nbsp;<span class="ident" id="4908233">Double</span><span class="op" id="4908239">(</span><span class="ident" id="4908240">bigX1</span><span class="op" id="4908245">,</span>&nbsp;<span class="ident" id="4908247">bigY1</span>&nbsp;<span class="op" id="4908253">*</span><span class="ident" id="4908254">big</span><span class="op" id="4908257">.</span><span class="ident" id="4908258">Int</span><span class="op" id="4908261">)</span>&nbsp;<span class="op" id="4908263">(</span><span class="ident" id="4908264">x</span><span class="op" id="4908265">,</span>&nbsp;<span class="ident" id="4908267">y</span>&nbsp;<span class="op" id="4908269">*</span><span class="ident" id="4908270">big</span><span class="op" id="4908273">.</span><span class="ident" id="4908274">Int</span><span class="op" id="4908277">)</span>&nbsp;<span class="op" id="4908279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4908282">var</span>&nbsp;<span class="ident" id="4908286">x1</span><span class="op" id="4908288">,</span>&nbsp;<span class="ident" id="4908290">y1</span><span class="op" id="4908292">,</span>&nbsp;<span class="ident" id="4908294">z1</span><span class="op" id="4908296">,</span>&nbsp;<span class="ident" id="4908298">x2</span><span class="op" id="4908300">,</span>&nbsp;<span class="ident" id="4908302">y2</span><span class="op" id="4908304">,</span>&nbsp;<span class="ident" id="4908306">z2</span>&nbsp;<span class="ident" id="4908309">p224FieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4908328">p224FromBig</span><span class="op" id="4908339">(</span><span class="op" id="4908340">&amp;</span><span class="ident" id="4908341">x1</span><span class="op" id="4908343">,</span>&nbsp;<span class="ident" id="4908345">bigX1</span><span class="op" id="4908350">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4908353">p224FromBig</span><span class="op" id="4908364">(</span><span class="op" id="4908365">&amp;</span><span class="ident" id="4908366">y1</span><span class="op" id="4908368">,</span>&nbsp;<span class="ident" id="4908370">bigY1</span><span class="op" id="4908375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4908378">z1</span><span class="op" id="4908380">[</span><span class="num" id="4908381">0</span><span class="op" id="4908382">]</span>&nbsp;<span class="op" id="4908384">=</span>&nbsp;<span class="num" id="4908386">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4908390">p224DoubleJacobian</span><span class="op" id="4908408">(</span><span class="op" id="4908409">&amp;</span><span class="ident" id="4908410">x2</span><span class="op" id="4908412">,</span>&nbsp;<span class="op" id="4908414">&amp;</span><span class="ident" id="4908415">y2</span><span class="op" id="4908417">,</span>&nbsp;<span class="op" id="4908419">&amp;</span><span class="ident" id="4908420">z2</span><span class="op" id="4908422">,</span>&nbsp;<span class="op" id="4908424">&amp;</span><span class="ident" id="4908425">x1</span><span class="op" id="4908427">,</span>&nbsp;<span class="op" id="4908429">&amp;</span><span class="ident" id="4908430">y1</span><span class="op" id="4908432">,</span>&nbsp;<span class="op" id="4908434">&amp;</span><span class="ident" id="4908435">z1</span><span class="op" id="4908437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4908440">return</span>&nbsp;<span class="ident" id="4908447">p224ToAffine</span><span class="op" id="4908459">(</span><span class="op" id="4908460">&amp;</span><span class="ident" id="4908461">x2</span><span class="op" id="4908463">,</span>&nbsp;<span class="op" id="4908465">&amp;</span><span class="ident" id="4908466">y2</span><span class="op" id="4908468">,</span>&nbsp;<span class="op" id="4908470">&amp;</span><span class="ident" id="4908471">z2</span><span class="op" id="4908473">)</span><br>
<span class="lineno">105</span><span class="op" id="4908475">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4908478">func</span>&nbsp;<span class="op" id="4908483">(</span><span class="ident" id="4908484">p224Curve</span><span class="op" id="4908493">)</span>&nbsp;<span class="ident" id="4908495">ScalarMult</span><span class="op" id="4908505">(</span><span class="ident" id="4908506">bigX1</span><span class="op" id="4908511">,</span>&nbsp;<span class="ident" id="4908513">bigY1</span>&nbsp;<span class="op" id="4908519">*</span><span class="ident" id="4908520">big</span><span class="op" id="4908523">.</span><span class="ident" id="4908524">Int</span><span class="op" id="4908527">,</span>&nbsp;<span class="ident" id="4908529">scalar</span>&nbsp;<span class="op" id="4908536">[</span><span class="op" id="4908537">]</span><span class="builtintype" id="4908538">byte</span><span class="op" id="4908542">)</span>&nbsp;<span class="op" id="4908544">(</span><span class="ident" id="4908545">x</span><span class="op" id="4908546">,</span>&nbsp;<span class="ident" id="4908548">y</span>&nbsp;<span class="op" id="4908550">*</span><span class="ident" id="4908551">big</span><span class="op" id="4908554">.</span><span class="ident" id="4908555">Int</span><span class="op" id="4908558">)</span>&nbsp;<span class="op" id="4908560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4908563">var</span>&nbsp;<span class="ident" id="4908567">x1</span><span class="op" id="4908569">,</span>&nbsp;<span class="ident" id="4908571">y1</span><span class="op" id="4908573">,</span>&nbsp;<span class="ident" id="4908575">z1</span><span class="op" id="4908577">,</span>&nbsp;<span class="ident" id="4908579">x2</span><span class="op" id="4908581">,</span>&nbsp;<span class="ident" id="4908583">y2</span><span class="op" id="4908585">,</span>&nbsp;<span class="ident" id="4908587">z2</span>&nbsp;<span class="ident" id="4908590">p224FieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4908609">p224FromBig</span><span class="op" id="4908620">(</span><span class="op" id="4908621">&amp;</span><span class="ident" id="4908622">x1</span><span class="op" id="4908624">,</span>&nbsp;<span class="ident" id="4908626">bigX1</span><span class="op" id="4908631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4908634">p224FromBig</span><span class="op" id="4908645">(</span><span class="op" id="4908646">&amp;</span><span class="ident" id="4908647">y1</span><span class="op" id="4908649">,</span>&nbsp;<span class="ident" id="4908651">bigY1</span><span class="op" id="4908656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4908659">z1</span><span class="op" id="4908661">[</span><span class="num" id="4908662">0</span><span class="op" id="4908663">]</span>&nbsp;<span class="op" id="4908665">=</span>&nbsp;<span class="num" id="4908667">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4908671">p224ScalarMult</span><span class="op" id="4908685">(</span><span class="op" id="4908686">&amp;</span><span class="ident" id="4908687">x2</span><span class="op" id="4908689">,</span>&nbsp;<span class="op" id="4908691">&amp;</span><span class="ident" id="4908692">y2</span><span class="op" id="4908694">,</span>&nbsp;<span class="op" id="4908696">&amp;</span><span class="ident" id="4908697">z2</span><span class="op" id="4908699">,</span>&nbsp;<span class="op" id="4908701">&amp;</span><span class="ident" id="4908702">x1</span><span class="op" id="4908704">,</span>&nbsp;<span class="op" id="4908706">&amp;</span><span class="ident" id="4908707">y1</span><span class="op" id="4908709">,</span>&nbsp;<span class="op" id="4908711">&amp;</span><span class="ident" id="4908712">z1</span><span class="op" id="4908714">,</span>&nbsp;<span class="ident" id="4908716">scalar</span><span class="op" id="4908722">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4908725">return</span>&nbsp;<span class="ident" id="4908732">p224ToAffine</span><span class="op" id="4908744">(</span><span class="op" id="4908745">&amp;</span><span class="ident" id="4908746">x2</span><span class="op" id="4908748">,</span>&nbsp;<span class="op" id="4908750">&amp;</span><span class="ident" id="4908751">y2</span><span class="op" id="4908753">,</span>&nbsp;<span class="op" id="4908755">&amp;</span><span class="ident" id="4908756">z2</span><span class="op" id="4908758">)</span><br>
<span class="lineno"></span><span class="op" id="4908760">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4908763">func</span>&nbsp;<span class="op" id="4908768">(</span><span class="ident" id="4908769">curve</span>&nbsp;<span class="ident" id="4908775">p224Curve</span><span class="op" id="4908784">)</span>&nbsp;<span class="ident" id="4908786">ScalarBaseMult</span><span class="op" id="4908800">(</span><span class="ident" id="4908801">scalar</span>&nbsp;<span class="op" id="4908808">[</span><span class="op" id="4908809">]</span><span class="builtintype" id="4908810">byte</span><span class="op" id="4908814">)</span>&nbsp;<span class="op" id="4908816">(</span><span class="ident" id="4908817">x</span><span class="op" id="4908818">,</span>&nbsp;<span class="ident" id="4908820">y</span>&nbsp;<span class="op" id="4908822">*</span><span class="ident" id="4908823">big</span><span class="op" id="4908826">.</span><span class="ident" id="4908827">Int</span><span class="op" id="4908830">)</span>&nbsp;<span class="op" id="4908832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4908835">var</span>&nbsp;<span class="ident" id="4908839">z1</span><span class="op" id="4908841">,</span>&nbsp;<span class="ident" id="4908843">x2</span><span class="op" id="4908845">,</span>&nbsp;<span class="ident" id="4908847">y2</span><span class="op" id="4908849">,</span>&nbsp;<span class="ident" id="4908851">z2</span>&nbsp;<span class="ident" id="4908854">p224FieldElement</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4908873">z1</span><span class="op" id="4908875">[</span><span class="num" id="4908876">0</span><span class="op" id="4908877">]</span>&nbsp;<span class="op" id="4908879">=</span>&nbsp;<span class="num" id="4908881">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4908884">p224ScalarMult</span><span class="op" id="4908898">(</span><span class="op" id="4908899">&amp;</span><span class="ident" id="4908900">x2</span><span class="op" id="4908902">,</span>&nbsp;<span class="op" id="4908904">&amp;</span><span class="ident" id="4908905">y2</span><span class="op" id="4908907">,</span>&nbsp;<span class="op" id="4908909">&amp;</span><span class="ident" id="4908910">z2</span><span class="op" id="4908912">,</span>&nbsp;<span class="op" id="4908914">&amp;</span><span class="ident" id="4908915">curve</span><span class="op" id="4908920">.</span><span class="ident" id="4908921">gx</span><span class="op" id="4908923">,</span>&nbsp;<span class="op" id="4908925">&amp;</span><span class="ident" id="4908926">curve</span><span class="op" id="4908931">.</span><span class="ident" id="4908932">gy</span><span class="op" id="4908934">,</span>&nbsp;<span class="op" id="4908936">&amp;</span><span class="ident" id="4908937">z1</span><span class="op" id="4908939">,</span>&nbsp;<span class="ident" id="4908941">scalar</span><span class="op" id="4908947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4908950">return</span>&nbsp;<span class="ident" id="4908957">p224ToAffine</span><span class="op" id="4908969">(</span><span class="op" id="4908970">&amp;</span><span class="ident" id="4908971">x2</span><span class="op" id="4908973">,</span>&nbsp;<span class="op" id="4908975">&amp;</span><span class="ident" id="4908976">y2</span><span class="op" id="4908978">,</span>&nbsp;<span class="op" id="4908980">&amp;</span><span class="ident" id="4908981">z2</span><span class="op" id="4908983">)</span><br>
<span class="lineno"></span><span class="op" id="4908985">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="4908988">//&nbsp;Field&nbsp;element&nbsp;functions.</span><br>
<span class="lineno"></span><span class="comment" id="4909016">//</span><br>
<span class="lineno"></span><span class="comment" id="4909019">//&nbsp;The&nbsp;field&nbsp;that&nbsp;we&#39;re&nbsp;dealing&nbsp;with&nbsp;is&nbsp;ℤ/pℤ&nbsp;where&nbsp;p&nbsp;=&nbsp;2**224&nbsp;-&nbsp;2**96&nbsp;+&nbsp;1.</span><br>
<span class="lineno"></span><span class="comment" id="4909098">//</span><br>
<span class="lineno">130</span><span class="comment" id="4909101">//&nbsp;Field&nbsp;elements&nbsp;are&nbsp;represented&nbsp;by&nbsp;a&nbsp;FieldElement,&nbsp;which&nbsp;is&nbsp;a&nbsp;typedef&nbsp;to&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="4909179">//&nbsp;array&nbsp;of&nbsp;8&nbsp;uint32&#39;s.&nbsp;The&nbsp;value&nbsp;of&nbsp;a&nbsp;FieldElement,&nbsp;a,&nbsp;is:</span><br>
<span class="lineno"></span><span class="comment" id="4909239">//&nbsp;&nbsp;&nbsp;a[0]&nbsp;+&nbsp;2**28·a[1]&nbsp;+&nbsp;2**56·a[1]&nbsp;+&nbsp;...&nbsp;+&nbsp;2**196·a[7]</span><br>
<span class="lineno"></span><span class="comment" id="4909298">//</span><br>
<span class="lineno"></span><span class="comment" id="4909301">//&nbsp;Using&nbsp;28-bit&nbsp;limbs&nbsp;means&nbsp;that&nbsp;there&#39;s&nbsp;only&nbsp;4&nbsp;bits&nbsp;of&nbsp;headroom,&nbsp;which&nbsp;is&nbsp;less</span><br>
<span class="lineno">135</span><span class="comment" id="4909381">//&nbsp;than&nbsp;we&nbsp;would&nbsp;really&nbsp;like.&nbsp;But&nbsp;it&nbsp;has&nbsp;the&nbsp;useful&nbsp;feature&nbsp;that&nbsp;we&nbsp;hit&nbsp;2**224</span><br>
<span class="lineno"></span><span class="comment" id="4909460">//&nbsp;exactly,&nbsp;making&nbsp;the&nbsp;reflections&nbsp;during&nbsp;a&nbsp;reduce&nbsp;much&nbsp;nicer.</span><br>
<span class="lineno"></span><span class="keyword" id="4909523">type</span>&nbsp;<span class="ident" id="4909528">p224FieldElement</span>&nbsp;<span class="op" id="4909545">[</span><span class="num" id="4909546">8</span><span class="op" id="4909547">]</span><span class="builtintype" id="4909548">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4909556">//&nbsp;p224P&nbsp;is&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;field,&nbsp;represented&nbsp;as&nbsp;a&nbsp;p224FieldElement.</span><br>
<span class="lineno">140</span><span class="keyword" id="4909627">var</span>&nbsp;<span class="ident" id="4909631">p224P</span>&nbsp;<span class="op" id="4909637">=</span>&nbsp;<span class="op" id="4909639">[</span><span class="num" id="4909640">8</span><span class="op" id="4909641">]</span><span class="builtintype" id="4909642">uint32</span><span class="op" id="4909648">{</span><span class="num" id="4909649">1</span><span class="op" id="4909650">,</span>&nbsp;<span class="num" id="4909652">0</span><span class="op" id="4909653">,</span>&nbsp;<span class="num" id="4909655">0</span><span class="op" id="4909656">,</span>&nbsp;<span class="num" id="4909658">0xffff000</span><span class="op" id="4909667">,</span>&nbsp;<span class="num" id="4909669">0xfffffff</span><span class="op" id="4909678">,</span>&nbsp;<span class="num" id="4909680">0xfffffff</span><span class="op" id="4909689">,</span>&nbsp;<span class="num" id="4909691">0xfffffff</span><span class="op" id="4909700">,</span>&nbsp;<span class="num" id="4909702">0xfffffff</span><span class="op" id="4909711">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4909714">//&nbsp;p224IsZero&nbsp;returns&nbsp;1&nbsp;if&nbsp;a&nbsp;==&nbsp;0&nbsp;mod&nbsp;p&nbsp;and&nbsp;0&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="comment" id="4909771">//</span><br>
<span class="lineno"></span><span class="comment" id="4909774">//&nbsp;a[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">145</span><span class="keyword" id="4909790">func</span>&nbsp;<span class="ident" id="4909795">p224IsZero</span><span class="op" id="4909805">(</span><span class="ident" id="4909806">a</span>&nbsp;<span class="op" id="4909808">*</span><span class="ident" id="4909809">p224FieldElement</span><span class="op" id="4909825">)</span>&nbsp;<span class="builtintype" id="4909827">uint32</span>&nbsp;<span class="op" id="4909834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4909837">//&nbsp;Since&nbsp;a&nbsp;p224FieldElement&nbsp;contains&nbsp;224&nbsp;bits&nbsp;there&nbsp;are&nbsp;two&nbsp;possible</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4909907">//&nbsp;representations&nbsp;of&nbsp;0:&nbsp;0&nbsp;and&nbsp;p.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4909942">var</span>&nbsp;<span class="ident" id="4909946">minimal</span>&nbsp;<span class="ident" id="4909954">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4909972">p224Contract</span><span class="op" id="4909984">(</span><span class="op" id="4909985">&amp;</span><span class="ident" id="4909986">minimal</span><span class="op" id="4909993">,</span>&nbsp;<span class="ident" id="4909995">a</span><span class="op" id="4909996">)</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4910000">var</span>&nbsp;<span class="ident" id="4910004">isZero</span><span class="op" id="4910010">,</span>&nbsp;<span class="ident" id="4910012">isP</span>&nbsp;<span class="builtintype" id="4910016">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4910024">for</span>&nbsp;<span class="ident" id="4910028">i</span><span class="op" id="4910029">,</span>&nbsp;<span class="ident" id="4910031">v</span>&nbsp;<span class="op" id="4910033">:=</span>&nbsp;<span class="keyword" id="4910036">range</span>&nbsp;<span class="ident" id="4910042">minimal</span>&nbsp;<span class="op" id="4910050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4910054">isZero</span>&nbsp;<span class="op" id="4910061">|=</span>&nbsp;<span class="ident" id="4910064">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4910068">isP</span>&nbsp;<span class="op" id="4910072">|=</span>&nbsp;<span class="ident" id="4910075">v</span>&nbsp;<span class="op" id="4910077">-</span>&nbsp;<span class="ident" id="4910079">p224P</span><span class="op" id="4910084">[</span><span class="ident" id="4910085">i</span><span class="op" id="4910086">]</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4910089">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4910093">//&nbsp;If&nbsp;either&nbsp;isZero&nbsp;or&nbsp;isP&nbsp;is&nbsp;0,&nbsp;then&nbsp;we&nbsp;should&nbsp;return&nbsp;1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4910152">isZero</span>&nbsp;<span class="op" id="4910159">|=</span>&nbsp;<span class="ident" id="4910162">isZero</span>&nbsp;<span class="op" id="4910169">&gt;&gt;</span>&nbsp;<span class="num" id="4910172">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4910176">isZero</span>&nbsp;<span class="op" id="4910183">|=</span>&nbsp;<span class="ident" id="4910186">isZero</span>&nbsp;<span class="op" id="4910193">&gt;&gt;</span>&nbsp;<span class="num" id="4910196">8</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4910199">isZero</span>&nbsp;<span class="op" id="4910206">|=</span>&nbsp;<span class="ident" id="4910209">isZero</span>&nbsp;<span class="op" id="4910216">&gt;&gt;</span>&nbsp;<span class="num" id="4910219">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4910222">isZero</span>&nbsp;<span class="op" id="4910229">|=</span>&nbsp;<span class="ident" id="4910232">isZero</span>&nbsp;<span class="op" id="4910239">&gt;&gt;</span>&nbsp;<span class="num" id="4910242">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4910245">isZero</span>&nbsp;<span class="op" id="4910252">|=</span>&nbsp;<span class="ident" id="4910255">isZero</span>&nbsp;<span class="op" id="4910262">&gt;&gt;</span>&nbsp;<span class="num" id="4910265">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4910269">isP</span>&nbsp;<span class="op" id="4910273">|=</span>&nbsp;<span class="ident" id="4910276">isP</span>&nbsp;<span class="op" id="4910280">&gt;&gt;</span>&nbsp;<span class="num" id="4910283">16</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4910287">isP</span>&nbsp;<span class="op" id="4910291">|=</span>&nbsp;<span class="ident" id="4910294">isP</span>&nbsp;<span class="op" id="4910298">&gt;&gt;</span>&nbsp;<span class="num" id="4910301">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4910304">isP</span>&nbsp;<span class="op" id="4910308">|=</span>&nbsp;<span class="ident" id="4910311">isP</span>&nbsp;<span class="op" id="4910315">&gt;&gt;</span>&nbsp;<span class="num" id="4910318">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4910321">isP</span>&nbsp;<span class="op" id="4910325">|=</span>&nbsp;<span class="ident" id="4910328">isP</span>&nbsp;<span class="op" id="4910332">&gt;&gt;</span>&nbsp;<span class="num" id="4910335">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4910338">isP</span>&nbsp;<span class="op" id="4910342">|=</span>&nbsp;<span class="ident" id="4910345">isP</span>&nbsp;<span class="op" id="4910349">&gt;&gt;</span>&nbsp;<span class="num" id="4910352">1</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4910356">//&nbsp;For&nbsp;isZero&nbsp;and&nbsp;isP,&nbsp;the&nbsp;LSB&nbsp;is&nbsp;0&nbsp;iff&nbsp;all&nbsp;the&nbsp;bits&nbsp;are&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4910420">result</span>&nbsp;<span class="op" id="4910427">:=</span>&nbsp;<span class="ident" id="4910430">isZero</span>&nbsp;<span class="op" id="4910437">&amp;</span>&nbsp;<span class="ident" id="4910439">isP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4910444">result</span>&nbsp;<span class="op" id="4910451">=</span>&nbsp;<span class="op" id="4910453">(</span><span class="op" id="4910454">^</span><span class="ident" id="4910455">result</span><span class="op" id="4910461">)</span>&nbsp;<span class="op" id="4910463">&amp;</span>&nbsp;<span class="num" id="4910465">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4910469">return</span>&nbsp;<span class="ident" id="4910476">result</span><br>
<span class="lineno">175</span><span class="op" id="4910483">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4910486">//&nbsp;p224Add&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a+b</span><br>
<span class="lineno"></span><span class="comment" id="4910517">//</span><br>
<span class="lineno"></span><span class="comment" id="4910520">//&nbsp;a[i]&nbsp;+&nbsp;b[i]&nbsp;&lt;&nbsp;2**32</span><br>
<span class="lineno">180</span><span class="keyword" id="4910543">func</span>&nbsp;<span class="ident" id="4910548">p224Add</span><span class="op" id="4910555">(</span><span class="ident" id="4910556">out</span><span class="op" id="4910559">,</span>&nbsp;<span class="ident" id="4910561">a</span><span class="op" id="4910562">,</span>&nbsp;<span class="ident" id="4910564">b</span>&nbsp;<span class="op" id="4910566">*</span><span class="ident" id="4910567">p224FieldElement</span><span class="op" id="4910583">)</span>&nbsp;<span class="op" id="4910585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4910588">for</span>&nbsp;<span class="ident" id="4910592">i</span>&nbsp;<span class="op" id="4910594">:=</span>&nbsp;<span class="num" id="4910597">0</span><span class="op" id="4910598">;</span>&nbsp;<span class="ident" id="4910600">i</span>&nbsp;<span class="op" id="4910602">&lt;</span>&nbsp;<span class="num" id="4910604">8</span><span class="op" id="4910605">;</span>&nbsp;<span class="ident" id="4910607">i</span><span class="op" id="4910608">++</span>&nbsp;<span class="op" id="4910611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4910615">out</span><span class="op" id="4910618">[</span><span class="ident" id="4910619">i</span><span class="op" id="4910620">]</span>&nbsp;<span class="op" id="4910622">=</span>&nbsp;<span class="ident" id="4910624">a</span><span class="op" id="4910625">[</span><span class="ident" id="4910626">i</span><span class="op" id="4910627">]</span>&nbsp;<span class="op" id="4910629">+</span>&nbsp;<span class="ident" id="4910631">b</span><span class="op" id="4910632">[</span><span class="ident" id="4910633">i</span><span class="op" id="4910634">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4910637">}</span><br>
<span class="lineno"></span><span class="op" id="4910639">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="4910642">const</span>&nbsp;<span class="ident" id="4910648">two31p3</span>&nbsp;<span class="op" id="4910656">=</span>&nbsp;<span class="num" id="4910658">1</span><span class="op" id="4910659">&lt;&lt;</span><span class="num" id="4910661">31</span>&nbsp;<span class="op" id="4910664">+</span>&nbsp;<span class="num" id="4910666">1</span><span class="op" id="4910667">&lt;&lt;</span><span class="num" id="4910669">3</span><br>
<span class="lineno"></span><span class="keyword" id="4910671">const</span>&nbsp;<span class="ident" id="4910677">two31m3</span>&nbsp;<span class="op" id="4910685">=</span>&nbsp;<span class="num" id="4910687">1</span><span class="op" id="4910688">&lt;&lt;</span><span class="num" id="4910690">31</span>&nbsp;<span class="op" id="4910693">-</span>&nbsp;<span class="num" id="4910695">1</span><span class="op" id="4910696">&lt;&lt;</span><span class="num" id="4910698">3</span><br>
<span class="lineno"></span><span class="keyword" id="4910700">const</span>&nbsp;<span class="ident" id="4910706">two31m15m3</span>&nbsp;<span class="op" id="4910717">=</span>&nbsp;<span class="num" id="4910719">1</span><span class="op" id="4910720">&lt;&lt;</span><span class="num" id="4910722">31</span>&nbsp;<span class="op" id="4910725">-</span>&nbsp;<span class="num" id="4910727">1</span><span class="op" id="4910728">&lt;&lt;</span><span class="num" id="4910730">15</span>&nbsp;<span class="op" id="4910733">-</span>&nbsp;<span class="num" id="4910735">1</span><span class="op" id="4910736">&lt;&lt;</span><span class="num" id="4910738">3</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="comment" id="4910741">//&nbsp;p224ZeroModP31&nbsp;is&nbsp;0&nbsp;mod&nbsp;p&nbsp;where&nbsp;bit&nbsp;31&nbsp;is&nbsp;set&nbsp;in&nbsp;all&nbsp;limbs&nbsp;so&nbsp;that&nbsp;we&nbsp;can</span><br>
<span class="lineno"></span><span class="comment" id="4910818">//&nbsp;subtract&nbsp;smaller&nbsp;amounts&nbsp;without&nbsp;underflow.&nbsp;See&nbsp;the&nbsp;section&nbsp;&#34;Subtraction&#34;&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4910898">//&nbsp;[1]&nbsp;for&nbsp;reasoning.</span><br>
<span class="lineno"></span><span class="keyword" id="4910920">var</span>&nbsp;<span class="ident" id="4910924">p224ZeroModP31</span>&nbsp;<span class="op" id="4910939">=</span>&nbsp;<span class="op" id="4910941">[</span><span class="op" id="4910942">]</span><span class="builtintype" id="4910943">uint32</span><span class="op" id="4910949">{</span><span class="ident" id="4910950">two31p3</span><span class="op" id="4910957">,</span>&nbsp;<span class="ident" id="4910959">two31m3</span><span class="op" id="4910966">,</span>&nbsp;<span class="ident" id="4910968">two31m3</span><span class="op" id="4910975">,</span>&nbsp;<span class="ident" id="4910977">two31m15m3</span><span class="op" id="4910987">,</span>&nbsp;<span class="ident" id="4910989">two31m3</span><span class="op" id="4910996">,</span>&nbsp;<span class="ident" id="4910998">two31m3</span><span class="op" id="4911005">,</span>&nbsp;<span class="ident" id="4911007">two31m3</span><span class="op" id="4911014">,</span>&nbsp;<span class="ident" id="4911016">two31m3</span><span class="op" id="4911023">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span><span class="comment" id="4911026">//&nbsp;p224Sub&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a-b</span><br>
<span class="lineno"></span><span class="comment" id="4911057">//</span><br>
<span class="lineno"></span><span class="comment" id="4911060">//&nbsp;a[i],&nbsp;b[i]&nbsp;&lt;&nbsp;2**30</span><br>
<span class="lineno"></span><span class="comment" id="4911082">//&nbsp;out[i]&nbsp;&lt;&nbsp;2**32</span><br>
<span class="lineno"></span><span class="keyword" id="4911100">func</span>&nbsp;<span class="ident" id="4911105">p224Sub</span><span class="op" id="4911112">(</span><span class="ident" id="4911113">out</span><span class="op" id="4911116">,</span>&nbsp;<span class="ident" id="4911118">a</span><span class="op" id="4911119">,</span>&nbsp;<span class="ident" id="4911121">b</span>&nbsp;<span class="op" id="4911123">*</span><span class="ident" id="4911124">p224FieldElement</span><span class="op" id="4911140">)</span>&nbsp;<span class="op" id="4911142">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4911145">for</span>&nbsp;<span class="ident" id="4911149">i</span>&nbsp;<span class="op" id="4911151">:=</span>&nbsp;<span class="num" id="4911154">0</span><span class="op" id="4911155">;</span>&nbsp;<span class="ident" id="4911157">i</span>&nbsp;<span class="op" id="4911159">&lt;</span>&nbsp;<span class="num" id="4911161">8</span><span class="op" id="4911162">;</span>&nbsp;<span class="ident" id="4911164">i</span><span class="op" id="4911165">++</span>&nbsp;<span class="op" id="4911168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4911172">out</span><span class="op" id="4911175">[</span><span class="ident" id="4911176">i</span><span class="op" id="4911177">]</span>&nbsp;<span class="op" id="4911179">=</span>&nbsp;<span class="ident" id="4911181">a</span><span class="op" id="4911182">[</span><span class="ident" id="4911183">i</span><span class="op" id="4911184">]</span>&nbsp;<span class="op" id="4911186">+</span>&nbsp;<span class="ident" id="4911188">p224ZeroModP31</span><span class="op" id="4911202">[</span><span class="ident" id="4911203">i</span><span class="op" id="4911204">]</span>&nbsp;<span class="op" id="4911206">-</span>&nbsp;<span class="ident" id="4911208">b</span><span class="op" id="4911209">[</span><span class="ident" id="4911210">i</span><span class="op" id="4911211">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4911214">}</span><br>
<span class="lineno"></span><span class="op" id="4911216">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="comment" id="4911219">//&nbsp;LargeFieldElement&nbsp;also&nbsp;represents&nbsp;an&nbsp;element&nbsp;of&nbsp;the&nbsp;field.&nbsp;The&nbsp;limbs&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="4911295">//&nbsp;still&nbsp;spaced&nbsp;28-bits&nbsp;apart&nbsp;and&nbsp;in&nbsp;little-endian&nbsp;order.&nbsp;So&nbsp;the&nbsp;limbs&nbsp;are&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="4911373">//&nbsp;0,&nbsp;28,&nbsp;56,&nbsp;...,&nbsp;392&nbsp;bits,&nbsp;each&nbsp;64-bits&nbsp;wide.</span><br>
<span class="lineno"></span><span class="keyword" id="4911421">type</span>&nbsp;<span class="ident" id="4911426">p224LargeFieldElement</span>&nbsp;<span class="op" id="4911448">[</span><span class="num" id="4911449">15</span><span class="op" id="4911451">]</span><span class="ident" id="4911452">uint64</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span><span class="keyword" id="4911460">const</span>&nbsp;<span class="ident" id="4911466">two63p35</span>&nbsp;<span class="op" id="4911475">=</span>&nbsp;<span class="num" id="4911477">1</span><span class="op" id="4911478">&lt;&lt;</span><span class="num" id="4911480">63</span>&nbsp;<span class="op" id="4911483">+</span>&nbsp;<span class="num" id="4911485">1</span><span class="op" id="4911486">&lt;&lt;</span><span class="num" id="4911488">35</span><br>
<span class="lineno"></span><span class="keyword" id="4911491">const</span>&nbsp;<span class="ident" id="4911497">two63m35</span>&nbsp;<span class="op" id="4911506">=</span>&nbsp;<span class="num" id="4911508">1</span><span class="op" id="4911509">&lt;&lt;</span><span class="num" id="4911511">63</span>&nbsp;<span class="op" id="4911514">-</span>&nbsp;<span class="num" id="4911516">1</span><span class="op" id="4911517">&lt;&lt;</span><span class="num" id="4911519">35</span><br>
<span class="lineno"></span><span class="keyword" id="4911522">const</span>&nbsp;<span class="ident" id="4911528">two63m35m19</span>&nbsp;<span class="op" id="4911540">=</span>&nbsp;<span class="num" id="4911542">1</span><span class="op" id="4911543">&lt;&lt;</span><span class="num" id="4911545">63</span>&nbsp;<span class="op" id="4911548">-</span>&nbsp;<span class="num" id="4911550">1</span><span class="op" id="4911551">&lt;&lt;</span><span class="num" id="4911553">35</span>&nbsp;<span class="op" id="4911556">-</span>&nbsp;<span class="num" id="4911558">1</span><span class="op" id="4911559">&lt;&lt;</span><span class="num" id="4911561">19</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4911565">//&nbsp;p224ZeroModP63&nbsp;is&nbsp;0&nbsp;mod&nbsp;p&nbsp;where&nbsp;bit&nbsp;63&nbsp;is&nbsp;set&nbsp;in&nbsp;all&nbsp;limbs.&nbsp;See&nbsp;the&nbsp;section</span><br>
<span class="lineno">215</span><span class="comment" id="4911644">//&nbsp;&#34;Subtraction&#34;&nbsp;in&nbsp;[1]&nbsp;for&nbsp;why.</span><br>
<span class="lineno"></span><span class="keyword" id="4911677">var</span>&nbsp;<span class="ident" id="4911681">p224ZeroModP63</span>&nbsp;<span class="op" id="4911696">=</span>&nbsp;<span class="op" id="4911698">[</span><span class="num" id="4911699">8</span><span class="op" id="4911700">]</span><span class="ident" id="4911701">uint64</span><span class="op" id="4911707">{</span><span class="ident" id="4911708">two63p35</span><span class="op" id="4911716">,</span>&nbsp;<span class="ident" id="4911718">two63m35</span><span class="op" id="4911726">,</span>&nbsp;<span class="ident" id="4911728">two63m35</span><span class="op" id="4911736">,</span>&nbsp;<span class="ident" id="4911738">two63m35</span><span class="op" id="4911746">,</span>&nbsp;<span class="ident" id="4911748">two63m35m19</span><span class="op" id="4911759">,</span>&nbsp;<span class="ident" id="4911761">two63m35</span><span class="op" id="4911769">,</span>&nbsp;<span class="ident" id="4911771">two63m35</span><span class="op" id="4911779">,</span>&nbsp;<span class="ident" id="4911781">two63m35</span><span class="op" id="4911789">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4911792">const</span>&nbsp;<span class="ident" id="4911798">bottom12Bits</span>&nbsp;<span class="op" id="4911811">=</span>&nbsp;<span class="num" id="4911813">0xfff</span><br>
<span class="lineno"></span><span class="keyword" id="4911819">const</span>&nbsp;<span class="ident" id="4911825">bottom28Bits</span>&nbsp;<span class="op" id="4911838">=</span>&nbsp;<span class="num" id="4911840">0xfffffff</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="comment" id="4911851">//&nbsp;p224Mul&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a*b</span><br>
<span class="lineno"></span><span class="comment" id="4911882">//</span><br>
<span class="lineno"></span><span class="comment" id="4911885">//&nbsp;a[i]&nbsp;&lt;&nbsp;2**29,&nbsp;b[i]&nbsp;&lt;&nbsp;2**30&nbsp;(or&nbsp;vice&nbsp;versa)</span><br>
<span class="lineno"></span><span class="comment" id="4911931">//&nbsp;out[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">225</span><span class="keyword" id="4911949">func</span>&nbsp;<span class="ident" id="4911954">p224Mul</span><span class="op" id="4911961">(</span><span class="ident" id="4911962">out</span><span class="op" id="4911965">,</span>&nbsp;<span class="ident" id="4911967">a</span><span class="op" id="4911968">,</span>&nbsp;<span class="ident" id="4911970">b</span>&nbsp;<span class="op" id="4911972">*</span><span class="ident" id="4911973">p224FieldElement</span><span class="op" id="4911989">,</span>&nbsp;<span class="ident" id="4911991">tmp</span>&nbsp;<span class="op" id="4911995">*</span><span class="ident" id="4911996">p224LargeFieldElement</span><span class="op" id="4912017">)</span>&nbsp;<span class="op" id="4912019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4912022">for</span>&nbsp;<span class="ident" id="4912026">i</span>&nbsp;<span class="op" id="4912028">:=</span>&nbsp;<span class="num" id="4912031">0</span><span class="op" id="4912032">;</span>&nbsp;<span class="ident" id="4912034">i</span>&nbsp;<span class="op" id="4912036">&lt;</span>&nbsp;<span class="num" id="4912038">15</span><span class="op" id="4912040">;</span>&nbsp;<span class="ident" id="4912042">i</span><span class="op" id="4912043">++</span>&nbsp;<span class="op" id="4912046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4912050">tmp</span><span class="op" id="4912053">[</span><span class="ident" id="4912054">i</span><span class="op" id="4912055">]</span>&nbsp;<span class="op" id="4912057">=</span>&nbsp;<span class="num" id="4912059">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4912062">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4912066">for</span>&nbsp;<span class="ident" id="4912070">i</span>&nbsp;<span class="op" id="4912072">:=</span>&nbsp;<span class="num" id="4912075">0</span><span class="op" id="4912076">;</span>&nbsp;<span class="ident" id="4912078">i</span>&nbsp;<span class="op" id="4912080">&lt;</span>&nbsp;<span class="num" id="4912082">8</span><span class="op" id="4912083">;</span>&nbsp;<span class="ident" id="4912085">i</span><span class="op" id="4912086">++</span>&nbsp;<span class="op" id="4912089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4912093">for</span>&nbsp;<span class="ident" id="4912097">j</span>&nbsp;<span class="op" id="4912099">:=</span>&nbsp;<span class="num" id="4912102">0</span><span class="op" id="4912103">;</span>&nbsp;<span class="ident" id="4912105">j</span>&nbsp;<span class="op" id="4912107">&lt;</span>&nbsp;<span class="num" id="4912109">8</span><span class="op" id="4912110">;</span>&nbsp;<span class="ident" id="4912112">j</span><span class="op" id="4912113">++</span>&nbsp;<span class="op" id="4912116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4912121">tmp</span><span class="op" id="4912124">[</span><span class="ident" id="4912125">i</span><span class="op" id="4912126">+</span><span class="ident" id="4912127">j</span><span class="op" id="4912128">]</span>&nbsp;<span class="op" id="4912130">+=</span>&nbsp;<span class="ident" id="4912133">uint64</span><span class="op" id="4912139">(</span><span class="ident" id="4912140">a</span><span class="op" id="4912141">[</span><span class="ident" id="4912142">i</span><span class="op" id="4912143">]</span><span class="op" id="4912144">)</span>&nbsp;<span class="op" id="4912146">*</span>&nbsp;<span class="ident" id="4912148">uint64</span><span class="op" id="4912154">(</span><span class="ident" id="4912155">b</span><span class="op" id="4912156">[</span><span class="ident" id="4912157">j</span><span class="op" id="4912158">]</span><span class="op" id="4912159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4912163">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4912166">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4912170">p224ReduceLarge</span><span class="op" id="4912185">(</span><span class="ident" id="4912186">out</span><span class="op" id="4912189">,</span>&nbsp;<span class="ident" id="4912191">tmp</span><span class="op" id="4912194">)</span><br>
<span class="lineno"></span><span class="op" id="4912196">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4912199">//&nbsp;Square&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a*a</span><br>
<span class="lineno">240</span><span class="comment" id="4912229">//</span><br>
<span class="lineno"></span><span class="comment" id="4912232">//&nbsp;a[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span><span class="comment" id="4912248">//&nbsp;out[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span><span class="keyword" id="4912266">func</span>&nbsp;<span class="ident" id="4912271">p224Square</span><span class="op" id="4912281">(</span><span class="ident" id="4912282">out</span><span class="op" id="4912285">,</span>&nbsp;<span class="ident" id="4912287">a</span>&nbsp;<span class="op" id="4912289">*</span><span class="ident" id="4912290">p224FieldElement</span><span class="op" id="4912306">,</span>&nbsp;<span class="ident" id="4912308">tmp</span>&nbsp;<span class="op" id="4912312">*</span><span class="ident" id="4912313">p224LargeFieldElement</span><span class="op" id="4912334">)</span>&nbsp;<span class="op" id="4912336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4912339">for</span>&nbsp;<span class="ident" id="4912343">i</span>&nbsp;<span class="op" id="4912345">:=</span>&nbsp;<span class="num" id="4912348">0</span><span class="op" id="4912349">;</span>&nbsp;<span class="ident" id="4912351">i</span>&nbsp;<span class="op" id="4912353">&lt;</span>&nbsp;<span class="num" id="4912355">15</span><span class="op" id="4912357">;</span>&nbsp;<span class="ident" id="4912359">i</span><span class="op" id="4912360">++</span>&nbsp;<span class="op" id="4912363">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4912367">tmp</span><span class="op" id="4912370">[</span><span class="ident" id="4912371">i</span><span class="op" id="4912372">]</span>&nbsp;<span class="op" id="4912374">=</span>&nbsp;<span class="num" id="4912376">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4912379">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4912383">for</span>&nbsp;<span class="ident" id="4912387">i</span>&nbsp;<span class="op" id="4912389">:=</span>&nbsp;<span class="num" id="4912392">0</span><span class="op" id="4912393">;</span>&nbsp;<span class="ident" id="4912395">i</span>&nbsp;<span class="op" id="4912397">&lt;</span>&nbsp;<span class="num" id="4912399">8</span><span class="op" id="4912400">;</span>&nbsp;<span class="ident" id="4912402">i</span><span class="op" id="4912403">++</span>&nbsp;<span class="op" id="4912406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4912410">for</span>&nbsp;<span class="ident" id="4912414">j</span>&nbsp;<span class="op" id="4912416">:=</span>&nbsp;<span class="num" id="4912419">0</span><span class="op" id="4912420">;</span>&nbsp;<span class="ident" id="4912422">j</span>&nbsp;<span class="op" id="4912424">&lt;=</span>&nbsp;<span class="ident" id="4912427">i</span><span class="op" id="4912428">;</span>&nbsp;<span class="ident" id="4912430">j</span><span class="op" id="4912431">++</span>&nbsp;<span class="op" id="4912434">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4912439">r</span>&nbsp;<span class="op" id="4912441">:=</span>&nbsp;<span class="ident" id="4912444">uint64</span><span class="op" id="4912450">(</span><span class="ident" id="4912451">a</span><span class="op" id="4912452">[</span><span class="ident" id="4912453">i</span><span class="op" id="4912454">]</span><span class="op" id="4912455">)</span>&nbsp;<span class="op" id="4912457">*</span>&nbsp;<span class="ident" id="4912459">uint64</span><span class="op" id="4912465">(</span><span class="ident" id="4912466">a</span><span class="op" id="4912467">[</span><span class="ident" id="4912468">j</span><span class="op" id="4912469">]</span><span class="op" id="4912470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4912475">if</span>&nbsp;<span class="ident" id="4912478">i</span>&nbsp;<span class="op" id="4912480">==</span>&nbsp;<span class="ident" id="4912483">j</span>&nbsp;<span class="op" id="4912485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4912491">tmp</span><span class="op" id="4912494">[</span><span class="ident" id="4912495">i</span><span class="op" id="4912496">+</span><span class="ident" id="4912497">j</span><span class="op" id="4912498">]</span>&nbsp;<span class="op" id="4912500">+=</span>&nbsp;<span class="ident" id="4912503">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4912508">}</span>&nbsp;<span class="keyword" id="4912510">else</span>&nbsp;<span class="op" id="4912515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4912521">tmp</span><span class="op" id="4912524">[</span><span class="ident" id="4912525">i</span><span class="op" id="4912526">+</span><span class="ident" id="4912527">j</span><span class="op" id="4912528">]</span>&nbsp;<span class="op" id="4912530">+=</span>&nbsp;<span class="ident" id="4912533">r</span>&nbsp;<span class="op" id="4912535">&lt;&lt;</span>&nbsp;<span class="num" id="4912538">1</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4912543">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4912547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4912550">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4912554">p224ReduceLarge</span><span class="op" id="4912569">(</span><span class="ident" id="4912570">out</span><span class="op" id="4912573">,</span>&nbsp;<span class="ident" id="4912575">tmp</span><span class="op" id="4912578">)</span><br>
<span class="lineno">260</span><span class="op" id="4912580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4912583">//&nbsp;ReduceLarge&nbsp;converts&nbsp;a&nbsp;p224LargeFieldElement&nbsp;to&nbsp;a&nbsp;p224FieldElement.</span><br>
<span class="lineno"></span><span class="comment" id="4912654">//</span><br>
<span class="lineno"></span><span class="comment" id="4912657">//&nbsp;in[i]&nbsp;&lt;&nbsp;2**62</span><br>
<span class="lineno">265</span><span class="keyword" id="4912674">func</span>&nbsp;<span class="ident" id="4912679">p224ReduceLarge</span><span class="op" id="4912694">(</span><span class="ident" id="4912695">out</span>&nbsp;<span class="op" id="4912699">*</span><span class="ident" id="4912700">p224FieldElement</span><span class="op" id="4912716">,</span>&nbsp;<span class="ident" id="4912718">in</span>&nbsp;<span class="op" id="4912721">*</span><span class="ident" id="4912722">p224LargeFieldElement</span><span class="op" id="4912743">)</span>&nbsp;<span class="op" id="4912745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4912748">for</span>&nbsp;<span class="ident" id="4912752">i</span>&nbsp;<span class="op" id="4912754">:=</span>&nbsp;<span class="num" id="4912757">0</span><span class="op" id="4912758">;</span>&nbsp;<span class="ident" id="4912760">i</span>&nbsp;<span class="op" id="4912762">&lt;</span>&nbsp;<span class="num" id="4912764">8</span><span class="op" id="4912765">;</span>&nbsp;<span class="ident" id="4912767">i</span><span class="op" id="4912768">++</span>&nbsp;<span class="op" id="4912771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4912775">in</span><span class="op" id="4912777">[</span><span class="ident" id="4912778">i</span><span class="op" id="4912779">]</span>&nbsp;<span class="op" id="4912781">+=</span>&nbsp;<span class="ident" id="4912784">p224ZeroModP63</span><span class="op" id="4912798">[</span><span class="ident" id="4912799">i</span><span class="op" id="4912800">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4912803">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4912807">//&nbsp;Eliminate&nbsp;the&nbsp;coefficients&nbsp;at&nbsp;2**224&nbsp;and&nbsp;greater.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4912861">for</span>&nbsp;<span class="ident" id="4912865">i</span>&nbsp;<span class="op" id="4912867">:=</span>&nbsp;<span class="num" id="4912870">14</span><span class="op" id="4912872">;</span>&nbsp;<span class="ident" id="4912874">i</span>&nbsp;<span class="op" id="4912876">&gt;=</span>&nbsp;<span class="num" id="4912879">8</span><span class="op" id="4912880">;</span>&nbsp;<span class="ident" id="4912882">i</span><span class="op" id="4912883">--</span>&nbsp;<span class="op" id="4912886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4912890">in</span><span class="op" id="4912892">[</span><span class="ident" id="4912893">i</span><span class="op" id="4912894">-</span><span class="num" id="4912895">8</span><span class="op" id="4912896">]</span>&nbsp;<span class="op" id="4912898">-=</span>&nbsp;<span class="ident" id="4912901">in</span><span class="op" id="4912903">[</span><span class="ident" id="4912904">i</span><span class="op" id="4912905">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4912909">in</span><span class="op" id="4912911">[</span><span class="ident" id="4912912">i</span><span class="op" id="4912913">-</span><span class="num" id="4912914">5</span><span class="op" id="4912915">]</span>&nbsp;<span class="op" id="4912917">+=</span>&nbsp;<span class="op" id="4912920">(</span><span class="ident" id="4912921">in</span><span class="op" id="4912923">[</span><span class="ident" id="4912924">i</span><span class="op" id="4912925">]</span>&nbsp;<span class="op" id="4912927">&amp;</span>&nbsp;<span class="num" id="4912929">0xffff</span><span class="op" id="4912935">)</span>&nbsp;<span class="op" id="4912937">&lt;&lt;</span>&nbsp;<span class="num" id="4912940">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4912945">in</span><span class="op" id="4912947">[</span><span class="ident" id="4912948">i</span><span class="op" id="4912949">-</span><span class="num" id="4912950">4</span><span class="op" id="4912951">]</span>&nbsp;<span class="op" id="4912953">+=</span>&nbsp;<span class="ident" id="4912956">in</span><span class="op" id="4912958">[</span><span class="ident" id="4912959">i</span><span class="op" id="4912960">]</span>&nbsp;<span class="op" id="4912962">&gt;&gt;</span>&nbsp;<span class="num" id="4912965">16</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4912969">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4912972">in</span><span class="op" id="4912974">[</span><span class="num" id="4912975">8</span><span class="op" id="4912976">]</span>&nbsp;<span class="op" id="4912978">=</span>&nbsp;<span class="num" id="4912980">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4912983">//&nbsp;in[0..8]&nbsp;&lt;&nbsp;2**64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4913005">//&nbsp;As&nbsp;the&nbsp;values&nbsp;become&nbsp;small&nbsp;enough,&nbsp;we&nbsp;start&nbsp;to&nbsp;store&nbsp;them&nbsp;in&nbsp;|out|</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4913076">//&nbsp;and&nbsp;use&nbsp;32-bit&nbsp;operations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4913107">for</span>&nbsp;<span class="ident" id="4913111">i</span>&nbsp;<span class="op" id="4913113">:=</span>&nbsp;<span class="num" id="4913116">1</span><span class="op" id="4913117">;</span>&nbsp;<span class="ident" id="4913119">i</span>&nbsp;<span class="op" id="4913121">&lt;</span>&nbsp;<span class="num" id="4913123">8</span><span class="op" id="4913124">;</span>&nbsp;<span class="ident" id="4913126">i</span><span class="op" id="4913127">++</span>&nbsp;<span class="op" id="4913130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4913134">in</span><span class="op" id="4913136">[</span><span class="ident" id="4913137">i</span><span class="op" id="4913138">+</span><span class="num" id="4913139">1</span><span class="op" id="4913140">]</span>&nbsp;<span class="op" id="4913142">+=</span>&nbsp;<span class="ident" id="4913145">in</span><span class="op" id="4913147">[</span><span class="ident" id="4913148">i</span><span class="op" id="4913149">]</span>&nbsp;<span class="op" id="4913151">&gt;&gt;</span>&nbsp;<span class="num" id="4913154">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4913159">out</span><span class="op" id="4913162">[</span><span class="ident" id="4913163">i</span><span class="op" id="4913164">]</span>&nbsp;<span class="op" id="4913166">=</span>&nbsp;<span class="builtintype" id="4913168">uint32</span><span class="op" id="4913174">(</span><span class="ident" id="4913175">in</span><span class="op" id="4913177">[</span><span class="ident" id="4913178">i</span><span class="op" id="4913179">]</span>&nbsp;<span class="op" id="4913181">&amp;</span>&nbsp;<span class="ident" id="4913183">bottom28Bits</span><span class="op" id="4913195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4913198">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4913201">in</span><span class="op" id="4913203">[</span><span class="num" id="4913204">0</span><span class="op" id="4913205">]</span>&nbsp;<span class="op" id="4913207">-=</span>&nbsp;<span class="ident" id="4913210">in</span><span class="op" id="4913212">[</span><span class="num" id="4913213">8</span><span class="op" id="4913214">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4913217">out</span><span class="op" id="4913220">[</span><span class="num" id="4913221">3</span><span class="op" id="4913222">]</span>&nbsp;<span class="op" id="4913224">+=</span>&nbsp;<span class="builtintype" id="4913227">uint32</span><span class="op" id="4913233">(</span><span class="ident" id="4913234">in</span><span class="op" id="4913236">[</span><span class="num" id="4913237">8</span><span class="op" id="4913238">]</span><span class="op" id="4913239">&amp;</span><span class="num" id="4913240">0xffff</span><span class="op" id="4913246">)</span>&nbsp;<span class="op" id="4913248">&lt;&lt;</span>&nbsp;<span class="num" id="4913251">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4913255">out</span><span class="op" id="4913258">[</span><span class="num" id="4913259">4</span><span class="op" id="4913260">]</span>&nbsp;<span class="op" id="4913262">+=</span>&nbsp;<span class="builtintype" id="4913265">uint32</span><span class="op" id="4913271">(</span><span class="ident" id="4913272">in</span><span class="op" id="4913274">[</span><span class="num" id="4913275">8</span><span class="op" id="4913276">]</span>&nbsp;<span class="op" id="4913278">&gt;&gt;</span>&nbsp;<span class="num" id="4913281">16</span><span class="op" id="4913283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4913286">//&nbsp;in[0]&nbsp;&lt;&nbsp;2**64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4913304">//&nbsp;out[3]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4913323">//&nbsp;out[4]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4913342">//&nbsp;out[1,2,5..7]&nbsp;&lt;&nbsp;2**28</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4913369">out</span><span class="op" id="4913372">[</span><span class="num" id="4913373">0</span><span class="op" id="4913374">]</span>&nbsp;<span class="op" id="4913376">=</span>&nbsp;<span class="builtintype" id="4913378">uint32</span><span class="op" id="4913384">(</span><span class="ident" id="4913385">in</span><span class="op" id="4913387">[</span><span class="num" id="4913388">0</span><span class="op" id="4913389">]</span>&nbsp;<span class="op" id="4913391">&amp;</span>&nbsp;<span class="ident" id="4913393">bottom28Bits</span><span class="op" id="4913405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4913408">out</span><span class="op" id="4913411">[</span><span class="num" id="4913412">1</span><span class="op" id="4913413">]</span>&nbsp;<span class="op" id="4913415">+=</span>&nbsp;<span class="builtintype" id="4913418">uint32</span><span class="op" id="4913424">(</span><span class="op" id="4913425">(</span><span class="ident" id="4913426">in</span><span class="op" id="4913428">[</span><span class="num" id="4913429">0</span><span class="op" id="4913430">]</span>&nbsp;<span class="op" id="4913432">&gt;&gt;</span>&nbsp;<span class="num" id="4913435">28</span><span class="op" id="4913437">)</span>&nbsp;<span class="op" id="4913439">&amp;</span>&nbsp;<span class="ident" id="4913441">bottom28Bits</span><span class="op" id="4913453">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4913456">out</span><span class="op" id="4913459">[</span><span class="num" id="4913460">2</span><span class="op" id="4913461">]</span>&nbsp;<span class="op" id="4913463">+=</span>&nbsp;<span class="builtintype" id="4913466">uint32</span><span class="op" id="4913472">(</span><span class="ident" id="4913473">in</span><span class="op" id="4913475">[</span><span class="num" id="4913476">0</span><span class="op" id="4913477">]</span>&nbsp;<span class="op" id="4913479">&gt;&gt;</span>&nbsp;<span class="num" id="4913482">56</span><span class="op" id="4913484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4913487">//&nbsp;out[0]&nbsp;&lt;&nbsp;2**28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4913506">//&nbsp;out[1..4]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4913528">//&nbsp;out[5..7]&nbsp;&lt;&nbsp;2**28</span><br>
<span class="lineno"></span><span class="op" id="4913549">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="4913552">//&nbsp;Reduce&nbsp;reduces&nbsp;the&nbsp;coefficients&nbsp;of&nbsp;a&nbsp;to&nbsp;smaller&nbsp;bounds.</span><br>
<span class="lineno"></span><span class="comment" id="4913611">//</span><br>
<span class="lineno"></span><span class="comment" id="4913614">//&nbsp;On&nbsp;entry:&nbsp;a[i]&nbsp;&lt;&nbsp;2**31&nbsp;+&nbsp;2**30</span><br>
<span class="lineno"></span><span class="comment" id="4913648">//&nbsp;On&nbsp;exit:&nbsp;a[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">305</span><span class="keyword" id="4913673">func</span>&nbsp;<span class="ident" id="4913678">p224Reduce</span><span class="op" id="4913688">(</span><span class="ident" id="4913689">a</span>&nbsp;<span class="op" id="4913691">*</span><span class="ident" id="4913692">p224FieldElement</span><span class="op" id="4913708">)</span>&nbsp;<span class="op" id="4913710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4913713">for</span>&nbsp;<span class="ident" id="4913717">i</span>&nbsp;<span class="op" id="4913719">:=</span>&nbsp;<span class="num" id="4913722">0</span><span class="op" id="4913723">;</span>&nbsp;<span class="ident" id="4913725">i</span>&nbsp;<span class="op" id="4913727">&lt;</span>&nbsp;<span class="num" id="4913729">7</span><span class="op" id="4913730">;</span>&nbsp;<span class="ident" id="4913732">i</span><span class="op" id="4913733">++</span>&nbsp;<span class="op" id="4913736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4913740">a</span><span class="op" id="4913741">[</span><span class="ident" id="4913742">i</span><span class="op" id="4913743">+</span><span class="num" id="4913744">1</span><span class="op" id="4913745">]</span>&nbsp;<span class="op" id="4913747">+=</span>&nbsp;<span class="ident" id="4913750">a</span><span class="op" id="4913751">[</span><span class="ident" id="4913752">i</span><span class="op" id="4913753">]</span>&nbsp;<span class="op" id="4913755">&gt;&gt;</span>&nbsp;<span class="num" id="4913758">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4913763">a</span><span class="op" id="4913764">[</span><span class="ident" id="4913765">i</span><span class="op" id="4913766">]</span>&nbsp;<span class="op" id="4913768">&amp;=</span>&nbsp;<span class="ident" id="4913771">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4913785">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4913788">top</span>&nbsp;<span class="op" id="4913792">:=</span>&nbsp;<span class="ident" id="4913795">a</span><span class="op" id="4913796">[</span><span class="num" id="4913797">7</span><span class="op" id="4913798">]</span>&nbsp;<span class="op" id="4913800">&gt;&gt;</span>&nbsp;<span class="num" id="4913803">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4913807">a</span><span class="op" id="4913808">[</span><span class="num" id="4913809">7</span><span class="op" id="4913810">]</span>&nbsp;<span class="op" id="4913812">&amp;=</span>&nbsp;<span class="ident" id="4913815">bottom28Bits</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4913830">//&nbsp;top&nbsp;&lt;&nbsp;2**4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4913845">mask</span>&nbsp;<span class="op" id="4913850">:=</span>&nbsp;<span class="ident" id="4913853">top</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4913858">mask</span>&nbsp;<span class="op" id="4913863">|=</span>&nbsp;<span class="ident" id="4913866">mask</span>&nbsp;<span class="op" id="4913871">&gt;&gt;</span>&nbsp;<span class="num" id="4913874">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4913877">mask</span>&nbsp;<span class="op" id="4913882">|=</span>&nbsp;<span class="ident" id="4913885">mask</span>&nbsp;<span class="op" id="4913890">&gt;&gt;</span>&nbsp;<span class="num" id="4913893">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4913896">mask</span>&nbsp;<span class="op" id="4913901">&lt;&lt;=</span>&nbsp;<span class="num" id="4913905">31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4913909">mask</span>&nbsp;<span class="op" id="4913914">=</span>&nbsp;<span class="builtintype" id="4913916">uint32</span><span class="op" id="4913922">(</span><span class="builtintype" id="4913923">int32</span><span class="op" id="4913928">(</span><span class="ident" id="4913929">mask</span><span class="op" id="4913933">)</span>&nbsp;<span class="op" id="4913935">&gt;&gt;</span>&nbsp;<span class="num" id="4913938">31</span><span class="op" id="4913940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4913943">//&nbsp;Mask&nbsp;is&nbsp;all&nbsp;ones&nbsp;if&nbsp;top&nbsp;!=&nbsp;0,&nbsp;all&nbsp;zero&nbsp;otherwise</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4913997">a</span><span class="op" id="4913998">[</span><span class="num" id="4913999">0</span><span class="op" id="4914000">]</span>&nbsp;<span class="op" id="4914002">-=</span>&nbsp;<span class="ident" id="4914005">top</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4914010">a</span><span class="op" id="4914011">[</span><span class="num" id="4914012">3</span><span class="op" id="4914013">]</span>&nbsp;<span class="op" id="4914015">+=</span>&nbsp;<span class="ident" id="4914018">top</span>&nbsp;<span class="op" id="4914022">&lt;&lt;</span>&nbsp;<span class="num" id="4914025">12</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4914030">//&nbsp;We&nbsp;may&nbsp;have&nbsp;just&nbsp;made&nbsp;a[0]&nbsp;negative&nbsp;but,&nbsp;if&nbsp;we&nbsp;did,&nbsp;then&nbsp;we&nbsp;must</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4914099">//&nbsp;have&nbsp;added&nbsp;something&nbsp;to&nbsp;a[3],&nbsp;this&nbsp;it&#39;s&nbsp;&gt;&nbsp;2**12.&nbsp;Therefore&nbsp;we&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4914169">//&nbsp;carry&nbsp;down&nbsp;to&nbsp;a[0].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4914193">a</span><span class="op" id="4914194">[</span><span class="num" id="4914195">3</span><span class="op" id="4914196">]</span>&nbsp;<span class="op" id="4914198">-=</span>&nbsp;<span class="num" id="4914201">1</span>&nbsp;<span class="op" id="4914203">&amp;</span>&nbsp;<span class="ident" id="4914205">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4914211">a</span><span class="op" id="4914212">[</span><span class="num" id="4914213">2</span><span class="op" id="4914214">]</span>&nbsp;<span class="op" id="4914216">+=</span>&nbsp;<span class="ident" id="4914219">mask</span>&nbsp;<span class="op" id="4914224">&amp;</span>&nbsp;<span class="op" id="4914226">(</span><span class="num" id="4914227">1</span><span class="op" id="4914228">&lt;&lt;</span><span class="num" id="4914230">28</span>&nbsp;<span class="op" id="4914233">-</span>&nbsp;<span class="num" id="4914235">1</span><span class="op" id="4914236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4914239">a</span><span class="op" id="4914240">[</span><span class="num" id="4914241">1</span><span class="op" id="4914242">]</span>&nbsp;<span class="op" id="4914244">+=</span>&nbsp;<span class="ident" id="4914247">mask</span>&nbsp;<span class="op" id="4914252">&amp;</span>&nbsp;<span class="op" id="4914254">(</span><span class="num" id="4914255">1</span><span class="op" id="4914256">&lt;&lt;</span><span class="num" id="4914258">28</span>&nbsp;<span class="op" id="4914261">-</span>&nbsp;<span class="num" id="4914263">1</span><span class="op" id="4914264">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4914267">a</span><span class="op" id="4914268">[</span><span class="num" id="4914269">0</span><span class="op" id="4914270">]</span>&nbsp;<span class="op" id="4914272">+=</span>&nbsp;<span class="ident" id="4914275">mask</span>&nbsp;<span class="op" id="4914280">&amp;</span>&nbsp;<span class="op" id="4914282">(</span><span class="num" id="4914283">1</span>&nbsp;<span class="op" id="4914285">&lt;&lt;</span>&nbsp;<span class="num" id="4914288">28</span><span class="op" id="4914290">)</span><br>
<span class="lineno"></span><span class="op" id="4914292">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4914295">//&nbsp;p224Invert&nbsp;calculates&nbsp;*out&nbsp;=&nbsp;in**-1&nbsp;by&nbsp;computing&nbsp;in**(2**224&nbsp;-&nbsp;2**96&nbsp;-&nbsp;1),</span><br>
<span class="lineno"></span><span class="comment" id="4914373">//&nbsp;i.e.&nbsp;Fermat&#39;s&nbsp;little&nbsp;theorem.</span><br>
<span class="lineno">335</span><span class="keyword" id="4914406">func</span>&nbsp;<span class="ident" id="4914411">p224Invert</span><span class="op" id="4914421">(</span><span class="ident" id="4914422">out</span><span class="op" id="4914425">,</span>&nbsp;<span class="ident" id="4914427">in</span>&nbsp;<span class="op" id="4914430">*</span><span class="ident" id="4914431">p224FieldElement</span><span class="op" id="4914447">)</span>&nbsp;<span class="op" id="4914449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4914452">var</span>&nbsp;<span class="ident" id="4914456">f1</span><span class="op" id="4914458">,</span>&nbsp;<span class="ident" id="4914460">f2</span><span class="op" id="4914462">,</span>&nbsp;<span class="ident" id="4914464">f3</span><span class="op" id="4914466">,</span>&nbsp;<span class="ident" id="4914468">f4</span>&nbsp;<span class="ident" id="4914471">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4914489">var</span>&nbsp;<span class="ident" id="4914493">c</span>&nbsp;<span class="ident" id="4914495">p224LargeFieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4914519">p224Square</span><span class="op" id="4914529">(</span><span class="op" id="4914530">&amp;</span><span class="ident" id="4914531">f1</span><span class="op" id="4914533">,</span>&nbsp;<span class="ident" id="4914535">in</span><span class="op" id="4914537">,</span>&nbsp;<span class="op" id="4914539">&amp;</span><span class="ident" id="4914540">c</span><span class="op" id="4914541">)</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4914546">//&nbsp;2</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4914552">p224Mul</span><span class="op" id="4914559">(</span><span class="op" id="4914560">&amp;</span><span class="ident" id="4914561">f1</span><span class="op" id="4914563">,</span>&nbsp;<span class="op" id="4914565">&amp;</span><span class="ident" id="4914566">f1</span><span class="op" id="4914568">,</span>&nbsp;<span class="ident" id="4914570">in</span><span class="op" id="4914572">,</span>&nbsp;<span class="op" id="4914574">&amp;</span><span class="ident" id="4914575">c</span><span class="op" id="4914576">)</span>&nbsp;&nbsp;<span class="comment" id="4914579">//&nbsp;2**2&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4914592">p224Square</span><span class="op" id="4914602">(</span><span class="op" id="4914603">&amp;</span><span class="ident" id="4914604">f1</span><span class="op" id="4914606">,</span>&nbsp;<span class="op" id="4914608">&amp;</span><span class="ident" id="4914609">f1</span><span class="op" id="4914611">,</span>&nbsp;<span class="op" id="4914613">&amp;</span><span class="ident" id="4914614">c</span><span class="op" id="4914615">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4914619">//&nbsp;2**3&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4914632">p224Mul</span><span class="op" id="4914639">(</span><span class="op" id="4914640">&amp;</span><span class="ident" id="4914641">f1</span><span class="op" id="4914643">,</span>&nbsp;<span class="op" id="4914645">&amp;</span><span class="ident" id="4914646">f1</span><span class="op" id="4914648">,</span>&nbsp;<span class="ident" id="4914650">in</span><span class="op" id="4914652">,</span>&nbsp;<span class="op" id="4914654">&amp;</span><span class="ident" id="4914655">c</span><span class="op" id="4914656">)</span>&nbsp;&nbsp;<span class="comment" id="4914659">//&nbsp;2**3&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4914672">p224Square</span><span class="op" id="4914682">(</span><span class="op" id="4914683">&amp;</span><span class="ident" id="4914684">f2</span><span class="op" id="4914686">,</span>&nbsp;<span class="op" id="4914688">&amp;</span><span class="ident" id="4914689">f1</span><span class="op" id="4914691">,</span>&nbsp;<span class="op" id="4914693">&amp;</span><span class="ident" id="4914694">c</span><span class="op" id="4914695">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4914699">//&nbsp;2**4&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4914712">p224Square</span><span class="op" id="4914722">(</span><span class="op" id="4914723">&amp;</span><span class="ident" id="4914724">f2</span><span class="op" id="4914726">,</span>&nbsp;<span class="op" id="4914728">&amp;</span><span class="ident" id="4914729">f2</span><span class="op" id="4914731">,</span>&nbsp;<span class="op" id="4914733">&amp;</span><span class="ident" id="4914734">c</span><span class="op" id="4914735">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4914739">//&nbsp;2**5&nbsp;-&nbsp;4</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4914752">p224Square</span><span class="op" id="4914762">(</span><span class="op" id="4914763">&amp;</span><span class="ident" id="4914764">f2</span><span class="op" id="4914766">,</span>&nbsp;<span class="op" id="4914768">&amp;</span><span class="ident" id="4914769">f2</span><span class="op" id="4914771">,</span>&nbsp;<span class="op" id="4914773">&amp;</span><span class="ident" id="4914774">c</span><span class="op" id="4914775">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4914779">//&nbsp;2**6&nbsp;-&nbsp;8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4914792">p224Mul</span><span class="op" id="4914799">(</span><span class="op" id="4914800">&amp;</span><span class="ident" id="4914801">f1</span><span class="op" id="4914803">,</span>&nbsp;<span class="op" id="4914805">&amp;</span><span class="ident" id="4914806">f1</span><span class="op" id="4914808">,</span>&nbsp;<span class="op" id="4914810">&amp;</span><span class="ident" id="4914811">f2</span><span class="op" id="4914813">,</span>&nbsp;<span class="op" id="4914815">&amp;</span><span class="ident" id="4914816">c</span><span class="op" id="4914817">)</span>&nbsp;<span class="comment" id="4914819">//&nbsp;2**6&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4914832">p224Square</span><span class="op" id="4914842">(</span><span class="op" id="4914843">&amp;</span><span class="ident" id="4914844">f2</span><span class="op" id="4914846">,</span>&nbsp;<span class="op" id="4914848">&amp;</span><span class="ident" id="4914849">f1</span><span class="op" id="4914851">,</span>&nbsp;<span class="op" id="4914853">&amp;</span><span class="ident" id="4914854">c</span><span class="op" id="4914855">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4914859">//&nbsp;2**7&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4914872">for</span>&nbsp;<span class="ident" id="4914876">i</span>&nbsp;<span class="op" id="4914878">:=</span>&nbsp;<span class="num" id="4914881">0</span><span class="op" id="4914882">;</span>&nbsp;<span class="ident" id="4914884">i</span>&nbsp;<span class="op" id="4914886">&lt;</span>&nbsp;<span class="num" id="4914888">5</span><span class="op" id="4914889">;</span>&nbsp;<span class="ident" id="4914891">i</span><span class="op" id="4914892">++</span>&nbsp;<span class="op" id="4914895">{</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4914899">//&nbsp;2**12&nbsp;-&nbsp;2**6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4914917">p224Square</span><span class="op" id="4914927">(</span><span class="op" id="4914928">&amp;</span><span class="ident" id="4914929">f2</span><span class="op" id="4914931">,</span>&nbsp;<span class="op" id="4914933">&amp;</span><span class="ident" id="4914934">f2</span><span class="op" id="4914936">,</span>&nbsp;<span class="op" id="4914938">&amp;</span><span class="ident" id="4914939">c</span><span class="op" id="4914940">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4914943">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4914946">p224Mul</span><span class="op" id="4914953">(</span><span class="op" id="4914954">&amp;</span><span class="ident" id="4914955">f2</span><span class="op" id="4914957">,</span>&nbsp;<span class="op" id="4914959">&amp;</span><span class="ident" id="4914960">f2</span><span class="op" id="4914962">,</span>&nbsp;<span class="op" id="4914964">&amp;</span><span class="ident" id="4914965">f1</span><span class="op" id="4914967">,</span>&nbsp;<span class="op" id="4914969">&amp;</span><span class="ident" id="4914970">c</span><span class="op" id="4914971">)</span>&nbsp;<span class="comment" id="4914973">//&nbsp;2**12&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4914987">p224Square</span><span class="op" id="4914997">(</span><span class="op" id="4914998">&amp;</span><span class="ident" id="4914999">f3</span><span class="op" id="4915001">,</span>&nbsp;<span class="op" id="4915003">&amp;</span><span class="ident" id="4915004">f2</span><span class="op" id="4915006">,</span>&nbsp;<span class="op" id="4915008">&amp;</span><span class="ident" id="4915009">c</span><span class="op" id="4915010">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4915014">//&nbsp;2**13&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4915028">for</span>&nbsp;<span class="ident" id="4915032">i</span>&nbsp;<span class="op" id="4915034">:=</span>&nbsp;<span class="num" id="4915037">0</span><span class="op" id="4915038">;</span>&nbsp;<span class="ident" id="4915040">i</span>&nbsp;<span class="op" id="4915042">&lt;</span>&nbsp;<span class="num" id="4915044">11</span><span class="op" id="4915046">;</span>&nbsp;<span class="ident" id="4915048">i</span><span class="op" id="4915049">++</span>&nbsp;<span class="op" id="4915052">{</span>&nbsp;&nbsp;<span class="comment" id="4915055">//&nbsp;2**24&nbsp;-&nbsp;2**12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4915074">p224Square</span><span class="op" id="4915084">(</span><span class="op" id="4915085">&amp;</span><span class="ident" id="4915086">f3</span><span class="op" id="4915088">,</span>&nbsp;<span class="op" id="4915090">&amp;</span><span class="ident" id="4915091">f3</span><span class="op" id="4915093">,</span>&nbsp;<span class="op" id="4915095">&amp;</span><span class="ident" id="4915096">c</span><span class="op" id="4915097">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4915100">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4915103">p224Mul</span><span class="op" id="4915110">(</span><span class="op" id="4915111">&amp;</span><span class="ident" id="4915112">f2</span><span class="op" id="4915114">,</span>&nbsp;<span class="op" id="4915116">&amp;</span><span class="ident" id="4915117">f3</span><span class="op" id="4915119">,</span>&nbsp;<span class="op" id="4915121">&amp;</span><span class="ident" id="4915122">f2</span><span class="op" id="4915124">,</span>&nbsp;<span class="op" id="4915126">&amp;</span><span class="ident" id="4915127">c</span><span class="op" id="4915128">)</span>&nbsp;<span class="comment" id="4915130">//&nbsp;2**24&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4915144">p224Square</span><span class="op" id="4915154">(</span><span class="op" id="4915155">&amp;</span><span class="ident" id="4915156">f3</span><span class="op" id="4915158">,</span>&nbsp;<span class="op" id="4915160">&amp;</span><span class="ident" id="4915161">f2</span><span class="op" id="4915163">,</span>&nbsp;<span class="op" id="4915165">&amp;</span><span class="ident" id="4915166">c</span><span class="op" id="4915167">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4915171">//&nbsp;2**25&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4915185">for</span>&nbsp;<span class="ident" id="4915189">i</span>&nbsp;<span class="op" id="4915191">:=</span>&nbsp;<span class="num" id="4915194">0</span><span class="op" id="4915195">;</span>&nbsp;<span class="ident" id="4915197">i</span>&nbsp;<span class="op" id="4915199">&lt;</span>&nbsp;<span class="num" id="4915201">23</span><span class="op" id="4915203">;</span>&nbsp;<span class="ident" id="4915205">i</span><span class="op" id="4915206">++</span>&nbsp;<span class="op" id="4915209">{</span>&nbsp;&nbsp;<span class="comment" id="4915212">//&nbsp;2**48&nbsp;-&nbsp;2**24</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4915231">p224Square</span><span class="op" id="4915241">(</span><span class="op" id="4915242">&amp;</span><span class="ident" id="4915243">f3</span><span class="op" id="4915245">,</span>&nbsp;<span class="op" id="4915247">&amp;</span><span class="ident" id="4915248">f3</span><span class="op" id="4915250">,</span>&nbsp;<span class="op" id="4915252">&amp;</span><span class="ident" id="4915253">c</span><span class="op" id="4915254">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4915257">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4915260">p224Mul</span><span class="op" id="4915267">(</span><span class="op" id="4915268">&amp;</span><span class="ident" id="4915269">f3</span><span class="op" id="4915271">,</span>&nbsp;<span class="op" id="4915273">&amp;</span><span class="ident" id="4915274">f3</span><span class="op" id="4915276">,</span>&nbsp;<span class="op" id="4915278">&amp;</span><span class="ident" id="4915279">f2</span><span class="op" id="4915281">,</span>&nbsp;<span class="op" id="4915283">&amp;</span><span class="ident" id="4915284">c</span><span class="op" id="4915285">)</span>&nbsp;<span class="comment" id="4915287">//&nbsp;2**48&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4915301">p224Square</span><span class="op" id="4915311">(</span><span class="op" id="4915312">&amp;</span><span class="ident" id="4915313">f4</span><span class="op" id="4915315">,</span>&nbsp;<span class="op" id="4915317">&amp;</span><span class="ident" id="4915318">f3</span><span class="op" id="4915320">,</span>&nbsp;<span class="op" id="4915322">&amp;</span><span class="ident" id="4915323">c</span><span class="op" id="4915324">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4915328">//&nbsp;2**49&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4915342">for</span>&nbsp;<span class="ident" id="4915346">i</span>&nbsp;<span class="op" id="4915348">:=</span>&nbsp;<span class="num" id="4915351">0</span><span class="op" id="4915352">;</span>&nbsp;<span class="ident" id="4915354">i</span>&nbsp;<span class="op" id="4915356">&lt;</span>&nbsp;<span class="num" id="4915358">47</span><span class="op" id="4915360">;</span>&nbsp;<span class="ident" id="4915362">i</span><span class="op" id="4915363">++</span>&nbsp;<span class="op" id="4915366">{</span>&nbsp;&nbsp;<span class="comment" id="4915369">//&nbsp;2**96&nbsp;-&nbsp;2**48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4915388">p224Square</span><span class="op" id="4915398">(</span><span class="op" id="4915399">&amp;</span><span class="ident" id="4915400">f4</span><span class="op" id="4915402">,</span>&nbsp;<span class="op" id="4915404">&amp;</span><span class="ident" id="4915405">f4</span><span class="op" id="4915407">,</span>&nbsp;<span class="op" id="4915409">&amp;</span><span class="ident" id="4915410">c</span><span class="op" id="4915411">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4915414">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4915417">p224Mul</span><span class="op" id="4915424">(</span><span class="op" id="4915425">&amp;</span><span class="ident" id="4915426">f3</span><span class="op" id="4915428">,</span>&nbsp;<span class="op" id="4915430">&amp;</span><span class="ident" id="4915431">f3</span><span class="op" id="4915433">,</span>&nbsp;<span class="op" id="4915435">&amp;</span><span class="ident" id="4915436">f4</span><span class="op" id="4915438">,</span>&nbsp;<span class="op" id="4915440">&amp;</span><span class="ident" id="4915441">c</span><span class="op" id="4915442">)</span>&nbsp;<span class="comment" id="4915444">//&nbsp;2**96&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4915458">p224Square</span><span class="op" id="4915468">(</span><span class="op" id="4915469">&amp;</span><span class="ident" id="4915470">f4</span><span class="op" id="4915472">,</span>&nbsp;<span class="op" id="4915474">&amp;</span><span class="ident" id="4915475">f3</span><span class="op" id="4915477">,</span>&nbsp;<span class="op" id="4915479">&amp;</span><span class="ident" id="4915480">c</span><span class="op" id="4915481">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4915485">//&nbsp;2**97&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4915499">for</span>&nbsp;<span class="ident" id="4915503">i</span>&nbsp;<span class="op" id="4915505">:=</span>&nbsp;<span class="num" id="4915508">0</span><span class="op" id="4915509">;</span>&nbsp;<span class="ident" id="4915511">i</span>&nbsp;<span class="op" id="4915513">&lt;</span>&nbsp;<span class="num" id="4915515">23</span><span class="op" id="4915517">;</span>&nbsp;<span class="ident" id="4915519">i</span><span class="op" id="4915520">++</span>&nbsp;<span class="op" id="4915523">{</span>&nbsp;&nbsp;<span class="comment" id="4915526">//&nbsp;2**120&nbsp;-&nbsp;2**24</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4915546">p224Square</span><span class="op" id="4915556">(</span><span class="op" id="4915557">&amp;</span><span class="ident" id="4915558">f4</span><span class="op" id="4915560">,</span>&nbsp;<span class="op" id="4915562">&amp;</span><span class="ident" id="4915563">f4</span><span class="op" id="4915565">,</span>&nbsp;<span class="op" id="4915567">&amp;</span><span class="ident" id="4915568">c</span><span class="op" id="4915569">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4915572">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4915575">p224Mul</span><span class="op" id="4915582">(</span><span class="op" id="4915583">&amp;</span><span class="ident" id="4915584">f2</span><span class="op" id="4915586">,</span>&nbsp;<span class="op" id="4915588">&amp;</span><span class="ident" id="4915589">f4</span><span class="op" id="4915591">,</span>&nbsp;<span class="op" id="4915593">&amp;</span><span class="ident" id="4915594">f2</span><span class="op" id="4915596">,</span>&nbsp;<span class="op" id="4915598">&amp;</span><span class="ident" id="4915599">c</span><span class="op" id="4915600">)</span>&nbsp;<span class="comment" id="4915602">//&nbsp;2**120&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4915617">for</span>&nbsp;<span class="ident" id="4915621">i</span>&nbsp;<span class="op" id="4915623">:=</span>&nbsp;<span class="num" id="4915626">0</span><span class="op" id="4915627">;</span>&nbsp;<span class="ident" id="4915629">i</span>&nbsp;<span class="op" id="4915631">&lt;</span>&nbsp;<span class="num" id="4915633">6</span><span class="op" id="4915634">;</span>&nbsp;<span class="ident" id="4915636">i</span><span class="op" id="4915637">++</span>&nbsp;<span class="op" id="4915640">{</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4915644">//&nbsp;2**126&nbsp;-&nbsp;2**6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4915663">p224Square</span><span class="op" id="4915673">(</span><span class="op" id="4915674">&amp;</span><span class="ident" id="4915675">f2</span><span class="op" id="4915677">,</span>&nbsp;<span class="op" id="4915679">&amp;</span><span class="ident" id="4915680">f2</span><span class="op" id="4915682">,</span>&nbsp;<span class="op" id="4915684">&amp;</span><span class="ident" id="4915685">c</span><span class="op" id="4915686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4915689">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4915692">p224Mul</span><span class="op" id="4915699">(</span><span class="op" id="4915700">&amp;</span><span class="ident" id="4915701">f1</span><span class="op" id="4915703">,</span>&nbsp;<span class="op" id="4915705">&amp;</span><span class="ident" id="4915706">f1</span><span class="op" id="4915708">,</span>&nbsp;<span class="op" id="4915710">&amp;</span><span class="ident" id="4915711">f2</span><span class="op" id="4915713">,</span>&nbsp;<span class="op" id="4915715">&amp;</span><span class="ident" id="4915716">c</span><span class="op" id="4915717">)</span>&nbsp;<span class="comment" id="4915719">//&nbsp;2**126&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4915734">p224Square</span><span class="op" id="4915744">(</span><span class="op" id="4915745">&amp;</span><span class="ident" id="4915746">f1</span><span class="op" id="4915748">,</span>&nbsp;<span class="op" id="4915750">&amp;</span><span class="ident" id="4915751">f1</span><span class="op" id="4915753">,</span>&nbsp;<span class="op" id="4915755">&amp;</span><span class="ident" id="4915756">c</span><span class="op" id="4915757">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4915761">//&nbsp;2**127&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4915776">p224Mul</span><span class="op" id="4915783">(</span><span class="op" id="4915784">&amp;</span><span class="ident" id="4915785">f1</span><span class="op" id="4915787">,</span>&nbsp;<span class="op" id="4915789">&amp;</span><span class="ident" id="4915790">f1</span><span class="op" id="4915792">,</span>&nbsp;<span class="ident" id="4915794">in</span><span class="op" id="4915796">,</span>&nbsp;<span class="op" id="4915798">&amp;</span><span class="ident" id="4915799">c</span><span class="op" id="4915800">)</span>&nbsp;&nbsp;<span class="comment" id="4915803">//&nbsp;2**127&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4915818">for</span>&nbsp;<span class="ident" id="4915822">i</span>&nbsp;<span class="op" id="4915824">:=</span>&nbsp;<span class="num" id="4915827">0</span><span class="op" id="4915828">;</span>&nbsp;<span class="ident" id="4915830">i</span>&nbsp;<span class="op" id="4915832">&lt;</span>&nbsp;<span class="num" id="4915834">97</span><span class="op" id="4915836">;</span>&nbsp;<span class="ident" id="4915838">i</span><span class="op" id="4915839">++</span>&nbsp;<span class="op" id="4915842">{</span>&nbsp;&nbsp;<span class="comment" id="4915845">//&nbsp;2**224&nbsp;-&nbsp;2**97</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4915865">p224Square</span><span class="op" id="4915875">(</span><span class="op" id="4915876">&amp;</span><span class="ident" id="4915877">f1</span><span class="op" id="4915879">,</span>&nbsp;<span class="op" id="4915881">&amp;</span><span class="ident" id="4915882">f1</span><span class="op" id="4915884">,</span>&nbsp;<span class="op" id="4915886">&amp;</span><span class="ident" id="4915887">c</span><span class="op" id="4915888">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4915891">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4915894">p224Mul</span><span class="op" id="4915901">(</span><span class="ident" id="4915902">out</span><span class="op" id="4915905">,</span>&nbsp;<span class="op" id="4915907">&amp;</span><span class="ident" id="4915908">f1</span><span class="op" id="4915910">,</span>&nbsp;<span class="op" id="4915912">&amp;</span><span class="ident" id="4915913">f3</span><span class="op" id="4915915">,</span>&nbsp;<span class="op" id="4915917">&amp;</span><span class="ident" id="4915918">c</span><span class="op" id="4915919">)</span>&nbsp;<span class="comment" id="4915921">//&nbsp;2**224&nbsp;-&nbsp;2**96&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span><span class="op" id="4915943">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4915946">//&nbsp;p224Contract&nbsp;converts&nbsp;a&nbsp;FieldElement&nbsp;to&nbsp;its&nbsp;unique,&nbsp;minimal&nbsp;form.</span><br>
<span class="lineno">385</span><span class="comment" id="4916015">//</span><br>
<span class="lineno"></span><span class="comment" id="4916018">//&nbsp;On&nbsp;entry,&nbsp;in[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span><span class="comment" id="4916045">//&nbsp;On&nbsp;exit,&nbsp;in[i]&nbsp;&lt;&nbsp;2**28</span><br>
<span class="lineno"></span><span class="keyword" id="4916071">func</span>&nbsp;<span class="ident" id="4916076">p224Contract</span><span class="op" id="4916088">(</span><span class="ident" id="4916089">out</span><span class="op" id="4916092">,</span>&nbsp;<span class="ident" id="4916094">in</span>&nbsp;<span class="op" id="4916097">*</span><span class="ident" id="4916098">p224FieldElement</span><span class="op" id="4916114">)</span>&nbsp;<span class="op" id="4916116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4916119">copy</span><span class="op" id="4916123">(</span><span class="ident" id="4916124">out</span><span class="op" id="4916127">[</span><span class="op" id="4916128">:</span><span class="op" id="4916129">]</span><span class="op" id="4916130">,</span>&nbsp;<span class="ident" id="4916132">in</span><span class="op" id="4916134">[</span><span class="op" id="4916135">:</span><span class="op" id="4916136">]</span><span class="op" id="4916137">)</span><br>
<span class="lineno">390</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4916141">for</span>&nbsp;<span class="ident" id="4916145">i</span>&nbsp;<span class="op" id="4916147">:=</span>&nbsp;<span class="num" id="4916150">0</span><span class="op" id="4916151">;</span>&nbsp;<span class="ident" id="4916153">i</span>&nbsp;<span class="op" id="4916155">&lt;</span>&nbsp;<span class="num" id="4916157">7</span><span class="op" id="4916158">;</span>&nbsp;<span class="ident" id="4916160">i</span><span class="op" id="4916161">++</span>&nbsp;<span class="op" id="4916164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4916168">out</span><span class="op" id="4916171">[</span><span class="ident" id="4916172">i</span><span class="op" id="4916173">+</span><span class="num" id="4916174">1</span><span class="op" id="4916175">]</span>&nbsp;<span class="op" id="4916177">+=</span>&nbsp;<span class="ident" id="4916180">out</span><span class="op" id="4916183">[</span><span class="ident" id="4916184">i</span><span class="op" id="4916185">]</span>&nbsp;<span class="op" id="4916187">&gt;&gt;</span>&nbsp;<span class="num" id="4916190">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4916195">out</span><span class="op" id="4916198">[</span><span class="ident" id="4916199">i</span><span class="op" id="4916200">]</span>&nbsp;<span class="op" id="4916202">&amp;=</span>&nbsp;<span class="ident" id="4916205">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4916219">}</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4916222">top</span>&nbsp;<span class="op" id="4916226">:=</span>&nbsp;<span class="ident" id="4916229">out</span><span class="op" id="4916232">[</span><span class="num" id="4916233">7</span><span class="op" id="4916234">]</span>&nbsp;<span class="op" id="4916236">&gt;&gt;</span>&nbsp;<span class="num" id="4916239">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4916243">out</span><span class="op" id="4916246">[</span><span class="num" id="4916247">7</span><span class="op" id="4916248">]</span>&nbsp;<span class="op" id="4916250">&amp;=</span>&nbsp;<span class="ident" id="4916253">bottom28Bits</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4916268">out</span><span class="op" id="4916271">[</span><span class="num" id="4916272">0</span><span class="op" id="4916273">]</span>&nbsp;<span class="op" id="4916275">-=</span>&nbsp;<span class="ident" id="4916278">top</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4916283">out</span><span class="op" id="4916286">[</span><span class="num" id="4916287">3</span><span class="op" id="4916288">]</span>&nbsp;<span class="op" id="4916290">+=</span>&nbsp;<span class="ident" id="4916293">top</span>&nbsp;<span class="op" id="4916297">&lt;&lt;</span>&nbsp;<span class="num" id="4916300">12</span><br>
<span class="lineno">400</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4916305">//&nbsp;We&nbsp;may&nbsp;just&nbsp;have&nbsp;made&nbsp;out[i]&nbsp;negative.&nbsp;So&nbsp;we&nbsp;carry&nbsp;down.&nbsp;If&nbsp;we&nbsp;made</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4916377">//&nbsp;out[0]&nbsp;negative&nbsp;then&nbsp;we&nbsp;know&nbsp;that&nbsp;out[3]&nbsp;is&nbsp;sufficiently&nbsp;positive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4916447">//&nbsp;because&nbsp;we&nbsp;just&nbsp;added&nbsp;to&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4916480">for</span>&nbsp;<span class="ident" id="4916484">i</span>&nbsp;<span class="op" id="4916486">:=</span>&nbsp;<span class="num" id="4916489">0</span><span class="op" id="4916490">;</span>&nbsp;<span class="ident" id="4916492">i</span>&nbsp;<span class="op" id="4916494">&lt;</span>&nbsp;<span class="num" id="4916496">3</span><span class="op" id="4916497">;</span>&nbsp;<span class="ident" id="4916499">i</span><span class="op" id="4916500">++</span>&nbsp;<span class="op" id="4916503">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4916507">mask</span>&nbsp;<span class="op" id="4916512">:=</span>&nbsp;<span class="builtintype" id="4916515">uint32</span><span class="op" id="4916521">(</span><span class="builtintype" id="4916522">int32</span><span class="op" id="4916527">(</span><span class="ident" id="4916528">out</span><span class="op" id="4916531">[</span><span class="ident" id="4916532">i</span><span class="op" id="4916533">]</span><span class="op" id="4916534">)</span>&nbsp;<span class="op" id="4916536">&gt;&gt;</span>&nbsp;<span class="num" id="4916539">31</span><span class="op" id="4916541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4916545">out</span><span class="op" id="4916548">[</span><span class="ident" id="4916549">i</span><span class="op" id="4916550">]</span>&nbsp;<span class="op" id="4916552">+=</span>&nbsp;<span class="op" id="4916555">(</span><span class="num" id="4916556">1</span>&nbsp;<span class="op" id="4916558">&lt;&lt;</span>&nbsp;<span class="num" id="4916561">28</span><span class="op" id="4916563">)</span>&nbsp;<span class="op" id="4916565">&amp;</span>&nbsp;<span class="ident" id="4916567">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4916574">out</span><span class="op" id="4916577">[</span><span class="ident" id="4916578">i</span><span class="op" id="4916579">+</span><span class="num" id="4916580">1</span><span class="op" id="4916581">]</span>&nbsp;<span class="op" id="4916583">-=</span>&nbsp;<span class="num" id="4916586">1</span>&nbsp;<span class="op" id="4916588">&amp;</span>&nbsp;<span class="ident" id="4916590">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4916596">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4916600">//&nbsp;We&nbsp;might&nbsp;have&nbsp;pushed&nbsp;out[3]&nbsp;over&nbsp;2**28&nbsp;so&nbsp;we&nbsp;perform&nbsp;another,&nbsp;partial,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4916675">//&nbsp;carry&nbsp;chain.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4916692">for</span>&nbsp;<span class="ident" id="4916696">i</span>&nbsp;<span class="op" id="4916698">:=</span>&nbsp;<span class="num" id="4916701">3</span><span class="op" id="4916702">;</span>&nbsp;<span class="ident" id="4916704">i</span>&nbsp;<span class="op" id="4916706">&lt;</span>&nbsp;<span class="num" id="4916708">7</span><span class="op" id="4916709">;</span>&nbsp;<span class="ident" id="4916711">i</span><span class="op" id="4916712">++</span>&nbsp;<span class="op" id="4916715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4916719">out</span><span class="op" id="4916722">[</span><span class="ident" id="4916723">i</span><span class="op" id="4916724">+</span><span class="num" id="4916725">1</span><span class="op" id="4916726">]</span>&nbsp;<span class="op" id="4916728">+=</span>&nbsp;<span class="ident" id="4916731">out</span><span class="op" id="4916734">[</span><span class="ident" id="4916735">i</span><span class="op" id="4916736">]</span>&nbsp;<span class="op" id="4916738">&gt;&gt;</span>&nbsp;<span class="num" id="4916741">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4916746">out</span><span class="op" id="4916749">[</span><span class="ident" id="4916750">i</span><span class="op" id="4916751">]</span>&nbsp;<span class="op" id="4916753">&amp;=</span>&nbsp;<span class="ident" id="4916756">bottom28Bits</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4916770">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4916773">top</span>&nbsp;<span class="op" id="4916777">=</span>&nbsp;<span class="ident" id="4916779">out</span><span class="op" id="4916782">[</span><span class="num" id="4916783">7</span><span class="op" id="4916784">]</span>&nbsp;<span class="op" id="4916786">&gt;&gt;</span>&nbsp;<span class="num" id="4916789">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4916793">out</span><span class="op" id="4916796">[</span><span class="num" id="4916797">7</span><span class="op" id="4916798">]</span>&nbsp;<span class="op" id="4916800">&amp;=</span>&nbsp;<span class="ident" id="4916803">bottom28Bits</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4916818">//&nbsp;Eliminate&nbsp;top&nbsp;while&nbsp;maintaining&nbsp;the&nbsp;same&nbsp;value&nbsp;mod&nbsp;p.</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4916876">out</span><span class="op" id="4916879">[</span><span class="num" id="4916880">0</span><span class="op" id="4916881">]</span>&nbsp;<span class="op" id="4916883">-=</span>&nbsp;<span class="ident" id="4916886">top</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4916891">out</span><span class="op" id="4916894">[</span><span class="num" id="4916895">3</span><span class="op" id="4916896">]</span>&nbsp;<span class="op" id="4916898">+=</span>&nbsp;<span class="ident" id="4916901">top</span>&nbsp;<span class="op" id="4916905">&lt;&lt;</span>&nbsp;<span class="num" id="4916908">12</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4916913">//&nbsp;There&nbsp;are&nbsp;two&nbsp;cases&nbsp;to&nbsp;consider&nbsp;for&nbsp;out[3]:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4916961">//&nbsp;&nbsp;&nbsp;1)&nbsp;The&nbsp;first&nbsp;time&nbsp;that&nbsp;we&nbsp;eliminated&nbsp;top,&nbsp;we&nbsp;didn&#39;t&nbsp;push&nbsp;out[3]&nbsp;over</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4917036">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2**28.&nbsp;In&nbsp;this&nbsp;case,&nbsp;the&nbsp;partial&nbsp;carry&nbsp;chain&nbsp;didn&#39;t&nbsp;change&nbsp;any&nbsp;values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4917115">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;top&nbsp;is&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4917141">//&nbsp;&nbsp;&nbsp;2)&nbsp;We&nbsp;did&nbsp;push&nbsp;out[3]&nbsp;over&nbsp;2**28&nbsp;the&nbsp;first&nbsp;time&nbsp;that&nbsp;we&nbsp;eliminated&nbsp;top.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4917219">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;first&nbsp;value&nbsp;of&nbsp;top&nbsp;was&nbsp;in&nbsp;[0..16),&nbsp;therefore,&nbsp;prior&nbsp;to&nbsp;eliminating</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4917299">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;first&nbsp;top,&nbsp;0xfff1000&nbsp;&lt;=&nbsp;out[3]&nbsp;&lt;=&nbsp;0xfffffff.&nbsp;Therefore,&nbsp;after</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4917374">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;overflowing&nbsp;and&nbsp;being&nbsp;reduced&nbsp;by&nbsp;the&nbsp;second&nbsp;carry&nbsp;chain,&nbsp;out[3]&nbsp;&lt;=</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4917450">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0xf000.&nbsp;Thus&nbsp;it&nbsp;cannot&nbsp;have&nbsp;overflowed&nbsp;when&nbsp;we&nbsp;eliminated&nbsp;top&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4917529">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;second&nbsp;time.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4917552">//&nbsp;Again,&nbsp;we&nbsp;may&nbsp;just&nbsp;have&nbsp;made&nbsp;out[0]&nbsp;negative,&nbsp;so&nbsp;do&nbsp;the&nbsp;same&nbsp;carry&nbsp;down.</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4917629">//&nbsp;As&nbsp;before,&nbsp;if&nbsp;we&nbsp;made&nbsp;out[0]&nbsp;negative&nbsp;then&nbsp;we&nbsp;know&nbsp;that&nbsp;out[3]&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4917699">//&nbsp;sufficiently&nbsp;positive.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4917726">for</span>&nbsp;<span class="ident" id="4917730">i</span>&nbsp;<span class="op" id="4917732">:=</span>&nbsp;<span class="num" id="4917735">0</span><span class="op" id="4917736">;</span>&nbsp;<span class="ident" id="4917738">i</span>&nbsp;<span class="op" id="4917740">&lt;</span>&nbsp;<span class="num" id="4917742">3</span><span class="op" id="4917743">;</span>&nbsp;<span class="ident" id="4917745">i</span><span class="op" id="4917746">++</span>&nbsp;<span class="op" id="4917749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4917753">mask</span>&nbsp;<span class="op" id="4917758">:=</span>&nbsp;<span class="builtintype" id="4917761">uint32</span><span class="op" id="4917767">(</span><span class="builtintype" id="4917768">int32</span><span class="op" id="4917773">(</span><span class="ident" id="4917774">out</span><span class="op" id="4917777">[</span><span class="ident" id="4917778">i</span><span class="op" id="4917779">]</span><span class="op" id="4917780">)</span>&nbsp;<span class="op" id="4917782">&gt;&gt;</span>&nbsp;<span class="num" id="4917785">31</span><span class="op" id="4917787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4917791">out</span><span class="op" id="4917794">[</span><span class="ident" id="4917795">i</span><span class="op" id="4917796">]</span>&nbsp;<span class="op" id="4917798">+=</span>&nbsp;<span class="op" id="4917801">(</span><span class="num" id="4917802">1</span>&nbsp;<span class="op" id="4917804">&lt;&lt;</span>&nbsp;<span class="num" id="4917807">28</span><span class="op" id="4917809">)</span>&nbsp;<span class="op" id="4917811">&amp;</span>&nbsp;<span class="ident" id="4917813">mask</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4917820">out</span><span class="op" id="4917823">[</span><span class="ident" id="4917824">i</span><span class="op" id="4917825">+</span><span class="num" id="4917826">1</span><span class="op" id="4917827">]</span>&nbsp;<span class="op" id="4917829">-=</span>&nbsp;<span class="num" id="4917832">1</span>&nbsp;<span class="op" id="4917834">&amp;</span>&nbsp;<span class="ident" id="4917836">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4917842">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4917846">//&nbsp;Now&nbsp;we&nbsp;see&nbsp;if&nbsp;the&nbsp;value&nbsp;is&nbsp;&gt;=&nbsp;p&nbsp;and,&nbsp;if&nbsp;so,&nbsp;subtract&nbsp;p.</span><br>
<span class="lineno"></span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4917907">//&nbsp;First&nbsp;we&nbsp;build&nbsp;a&nbsp;mask&nbsp;from&nbsp;the&nbsp;top&nbsp;four&nbsp;limbs,&nbsp;which&nbsp;must&nbsp;all&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4917976">//&nbsp;equal&nbsp;to&nbsp;bottom28Bits&nbsp;if&nbsp;the&nbsp;whole&nbsp;value&nbsp;is&nbsp;&gt;=&nbsp;p.&nbsp;If&nbsp;top4AllOnes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4918045">//&nbsp;ends&nbsp;up&nbsp;with&nbsp;any&nbsp;zero&nbsp;bits&nbsp;in&nbsp;the&nbsp;bottom&nbsp;28&nbsp;bits,&nbsp;then&nbsp;this&nbsp;wasn&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4918116">//&nbsp;true.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4918126">top4AllOnes</span>&nbsp;<span class="op" id="4918138">:=</span>&nbsp;<span class="builtintype" id="4918141">uint32</span><span class="op" id="4918147">(</span><span class="num" id="4918148">0xffffffff</span><span class="op" id="4918158">)</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4918161">for</span>&nbsp;<span class="ident" id="4918165">i</span>&nbsp;<span class="op" id="4918167">:=</span>&nbsp;<span class="num" id="4918170">4</span><span class="op" id="4918171">;</span>&nbsp;<span class="ident" id="4918173">i</span>&nbsp;<span class="op" id="4918175">&lt;</span>&nbsp;<span class="num" id="4918177">8</span><span class="op" id="4918178">;</span>&nbsp;<span class="ident" id="4918180">i</span><span class="op" id="4918181">++</span>&nbsp;<span class="op" id="4918184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4918188">top4AllOnes</span>&nbsp;<span class="op" id="4918200">&amp;=</span>&nbsp;<span class="ident" id="4918203">out</span><span class="op" id="4918206">[</span><span class="ident" id="4918207">i</span><span class="op" id="4918208">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4918211">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4918214">top4AllOnes</span>&nbsp;<span class="op" id="4918226">|=</span>&nbsp;<span class="num" id="4918229">0xf0000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4918241">//&nbsp;Now&nbsp;we&nbsp;replicate&nbsp;any&nbsp;zero&nbsp;bits&nbsp;to&nbsp;all&nbsp;the&nbsp;bits&nbsp;in&nbsp;top4AllOnes.</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4918308">top4AllOnes</span>&nbsp;<span class="op" id="4918320">&amp;=</span>&nbsp;<span class="ident" id="4918323">top4AllOnes</span>&nbsp;<span class="op" id="4918335">&gt;&gt;</span>&nbsp;<span class="num" id="4918338">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4918342">top4AllOnes</span>&nbsp;<span class="op" id="4918354">&amp;=</span>&nbsp;<span class="ident" id="4918357">top4AllOnes</span>&nbsp;<span class="op" id="4918369">&gt;&gt;</span>&nbsp;<span class="num" id="4918372">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4918375">top4AllOnes</span>&nbsp;<span class="op" id="4918387">&amp;=</span>&nbsp;<span class="ident" id="4918390">top4AllOnes</span>&nbsp;<span class="op" id="4918402">&gt;&gt;</span>&nbsp;<span class="num" id="4918405">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4918408">top4AllOnes</span>&nbsp;<span class="op" id="4918420">&amp;=</span>&nbsp;<span class="ident" id="4918423">top4AllOnes</span>&nbsp;<span class="op" id="4918435">&gt;&gt;</span>&nbsp;<span class="num" id="4918438">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4918441">top4AllOnes</span>&nbsp;<span class="op" id="4918453">&amp;=</span>&nbsp;<span class="ident" id="4918456">top4AllOnes</span>&nbsp;<span class="op" id="4918468">&gt;&gt;</span>&nbsp;<span class="num" id="4918471">1</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4918474">top4AllOnes</span>&nbsp;<span class="op" id="4918486">=</span>&nbsp;<span class="builtintype" id="4918488">uint32</span><span class="op" id="4918494">(</span><span class="builtintype" id="4918495">int32</span><span class="op" id="4918500">(</span><span class="ident" id="4918501">top4AllOnes</span><span class="op" id="4918512">&lt;&lt;</span><span class="num" id="4918514">31</span><span class="op" id="4918516">)</span>&nbsp;<span class="op" id="4918518">&gt;&gt;</span>&nbsp;<span class="num" id="4918521">31</span><span class="op" id="4918523">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4918527">//&nbsp;Now&nbsp;we&nbsp;test&nbsp;whether&nbsp;the&nbsp;bottom&nbsp;three&nbsp;limbs&nbsp;are&nbsp;non-zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4918588">bottom3NonZero</span>&nbsp;<span class="op" id="4918603">:=</span>&nbsp;<span class="ident" id="4918606">out</span><span class="op" id="4918609">[</span><span class="num" id="4918610">0</span><span class="op" id="4918611">]</span>&nbsp;<span class="op" id="4918613">|</span>&nbsp;<span class="ident" id="4918615">out</span><span class="op" id="4918618">[</span><span class="num" id="4918619">1</span><span class="op" id="4918620">]</span>&nbsp;<span class="op" id="4918622">|</span>&nbsp;<span class="ident" id="4918624">out</span><span class="op" id="4918627">[</span><span class="num" id="4918628">2</span><span class="op" id="4918629">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4918632">bottom3NonZero</span>&nbsp;<span class="op" id="4918647">|=</span>&nbsp;<span class="ident" id="4918650">bottom3NonZero</span>&nbsp;<span class="op" id="4918665">&gt;&gt;</span>&nbsp;<span class="num" id="4918668">16</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4918672">bottom3NonZero</span>&nbsp;<span class="op" id="4918687">|=</span>&nbsp;<span class="ident" id="4918690">bottom3NonZero</span>&nbsp;<span class="op" id="4918705">&gt;&gt;</span>&nbsp;<span class="num" id="4918708">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4918711">bottom3NonZero</span>&nbsp;<span class="op" id="4918726">|=</span>&nbsp;<span class="ident" id="4918729">bottom3NonZero</span>&nbsp;<span class="op" id="4918744">&gt;&gt;</span>&nbsp;<span class="num" id="4918747">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4918750">bottom3NonZero</span>&nbsp;<span class="op" id="4918765">|=</span>&nbsp;<span class="ident" id="4918768">bottom3NonZero</span>&nbsp;<span class="op" id="4918783">&gt;&gt;</span>&nbsp;<span class="num" id="4918786">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4918789">bottom3NonZero</span>&nbsp;<span class="op" id="4918804">|=</span>&nbsp;<span class="ident" id="4918807">bottom3NonZero</span>&nbsp;<span class="op" id="4918822">&gt;&gt;</span>&nbsp;<span class="num" id="4918825">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4918828">bottom3NonZero</span>&nbsp;<span class="op" id="4918843">=</span>&nbsp;<span class="builtintype" id="4918845">uint32</span><span class="op" id="4918851">(</span><span class="builtintype" id="4918852">int32</span><span class="op" id="4918857">(</span><span class="ident" id="4918858">bottom3NonZero</span><span class="op" id="4918872">&lt;&lt;</span><span class="num" id="4918874">31</span><span class="op" id="4918876">)</span>&nbsp;<span class="op" id="4918878">&gt;&gt;</span>&nbsp;<span class="num" id="4918881">31</span><span class="op" id="4918883">)</span><br>
<span class="lineno">470</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4918887">//&nbsp;Everything&nbsp;depends&nbsp;on&nbsp;the&nbsp;value&nbsp;of&nbsp;out[3].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4918934">//&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;it&#39;s&nbsp;&gt;&nbsp;0xffff000&nbsp;and&nbsp;top4AllOnes&nbsp;!=&nbsp;0&nbsp;then&nbsp;the&nbsp;whole&nbsp;value&nbsp;is&nbsp;&gt;=&nbsp;p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4919011">//&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;it&#39;s&nbsp;=&nbsp;0xffff000&nbsp;and&nbsp;top4AllOnes&nbsp;!=&nbsp;0&nbsp;and&nbsp;bottom3NonZero&nbsp;!=&nbsp;0,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4919084">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;the&nbsp;whole&nbsp;value&nbsp;is&nbsp;&gt;=&nbsp;p</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4919122">//&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;it&#39;s&nbsp;&lt;&nbsp;0xffff000,&nbsp;then&nbsp;the&nbsp;whole&nbsp;value&nbsp;is&nbsp;&lt;&nbsp;p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4919178">n</span>&nbsp;<span class="op" id="4919180">:=</span>&nbsp;<span class="ident" id="4919183">out</span><span class="op" id="4919186">[</span><span class="num" id="4919187">3</span><span class="op" id="4919188">]</span>&nbsp;<span class="op" id="4919190">-</span>&nbsp;<span class="num" id="4919192">0xffff000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4919203">out3Equal</span>&nbsp;<span class="op" id="4919213">:=</span>&nbsp;<span class="ident" id="4919216">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4919219">out3Equal</span>&nbsp;<span class="op" id="4919229">|=</span>&nbsp;<span class="ident" id="4919232">out3Equal</span>&nbsp;<span class="op" id="4919242">&gt;&gt;</span>&nbsp;<span class="num" id="4919245">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4919249">out3Equal</span>&nbsp;<span class="op" id="4919259">|=</span>&nbsp;<span class="ident" id="4919262">out3Equal</span>&nbsp;<span class="op" id="4919272">&gt;&gt;</span>&nbsp;<span class="num" id="4919275">8</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4919278">out3Equal</span>&nbsp;<span class="op" id="4919288">|=</span>&nbsp;<span class="ident" id="4919291">out3Equal</span>&nbsp;<span class="op" id="4919301">&gt;&gt;</span>&nbsp;<span class="num" id="4919304">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4919307">out3Equal</span>&nbsp;<span class="op" id="4919317">|=</span>&nbsp;<span class="ident" id="4919320">out3Equal</span>&nbsp;<span class="op" id="4919330">&gt;&gt;</span>&nbsp;<span class="num" id="4919333">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4919336">out3Equal</span>&nbsp;<span class="op" id="4919346">|=</span>&nbsp;<span class="ident" id="4919349">out3Equal</span>&nbsp;<span class="op" id="4919359">&gt;&gt;</span>&nbsp;<span class="num" id="4919362">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4919365">out3Equal</span>&nbsp;<span class="op" id="4919375">=</span>&nbsp;<span class="op" id="4919377">^</span><span class="builtintype" id="4919378">uint32</span><span class="op" id="4919384">(</span><span class="builtintype" id="4919385">int32</span><span class="op" id="4919390">(</span><span class="ident" id="4919391">out3Equal</span><span class="op" id="4919400">&lt;&lt;</span><span class="num" id="4919402">31</span><span class="op" id="4919404">)</span>&nbsp;<span class="op" id="4919406">&gt;&gt;</span>&nbsp;<span class="num" id="4919409">31</span><span class="op" id="4919411">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4919415">//&nbsp;If&nbsp;out[3]&nbsp;&gt;&nbsp;0xffff000&nbsp;then&nbsp;n&#39;s&nbsp;MSB&nbsp;will&nbsp;be&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4919468">out3GT</span>&nbsp;<span class="op" id="4919475">:=</span>&nbsp;<span class="op" id="4919478">^</span><span class="builtintype" id="4919479">uint32</span><span class="op" id="4919485">(</span><span class="builtintype" id="4919486">int32</span><span class="op" id="4919491">(</span><span class="ident" id="4919492">n</span><span class="op" id="4919493">)</span>&nbsp;<span class="op" id="4919495">&gt;&gt;</span>&nbsp;<span class="num" id="4919498">31</span><span class="op" id="4919500">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4919504">mask</span>&nbsp;<span class="op" id="4919509">:=</span>&nbsp;<span class="ident" id="4919512">top4AllOnes</span>&nbsp;<span class="op" id="4919524">&amp;</span>&nbsp;<span class="op" id="4919526">(</span><span class="op" id="4919527">(</span><span class="ident" id="4919528">out3Equal</span>&nbsp;<span class="op" id="4919538">&amp;</span>&nbsp;<span class="ident" id="4919540">bottom3NonZero</span><span class="op" id="4919554">)</span>&nbsp;<span class="op" id="4919556">|</span>&nbsp;<span class="ident" id="4919558">out3GT</span><span class="op" id="4919564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4919567">out</span><span class="op" id="4919570">[</span><span class="num" id="4919571">0</span><span class="op" id="4919572">]</span>&nbsp;<span class="op" id="4919574">-=</span>&nbsp;<span class="num" id="4919577">1</span>&nbsp;<span class="op" id="4919579">&amp;</span>&nbsp;<span class="ident" id="4919581">mask</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4919587">out</span><span class="op" id="4919590">[</span><span class="num" id="4919591">3</span><span class="op" id="4919592">]</span>&nbsp;<span class="op" id="4919594">-=</span>&nbsp;<span class="num" id="4919597">0xffff000</span>&nbsp;<span class="op" id="4919607">&amp;</span>&nbsp;<span class="ident" id="4919609">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4919615">out</span><span class="op" id="4919618">[</span><span class="num" id="4919619">4</span><span class="op" id="4919620">]</span>&nbsp;<span class="op" id="4919622">-=</span>&nbsp;<span class="num" id="4919625">0xfffffff</span>&nbsp;<span class="op" id="4919635">&amp;</span>&nbsp;<span class="ident" id="4919637">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4919643">out</span><span class="op" id="4919646">[</span><span class="num" id="4919647">5</span><span class="op" id="4919648">]</span>&nbsp;<span class="op" id="4919650">-=</span>&nbsp;<span class="num" id="4919653">0xfffffff</span>&nbsp;<span class="op" id="4919663">&amp;</span>&nbsp;<span class="ident" id="4919665">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4919671">out</span><span class="op" id="4919674">[</span><span class="num" id="4919675">6</span><span class="op" id="4919676">]</span>&nbsp;<span class="op" id="4919678">-=</span>&nbsp;<span class="num" id="4919681">0xfffffff</span>&nbsp;<span class="op" id="4919691">&amp;</span>&nbsp;<span class="ident" id="4919693">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4919699">out</span><span class="op" id="4919702">[</span><span class="num" id="4919703">7</span><span class="op" id="4919704">]</span>&nbsp;<span class="op" id="4919706">-=</span>&nbsp;<span class="num" id="4919709">0xfffffff</span>&nbsp;<span class="op" id="4919719">&amp;</span>&nbsp;<span class="ident" id="4919721">mask</span><br>
<span class="lineno">495</span><span class="op" id="4919726">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4919729">//&nbsp;Group&nbsp;element&nbsp;functions.</span><br>
<span class="lineno"></span><span class="comment" id="4919757">//</span><br>
<span class="lineno"></span><span class="comment" id="4919760">//&nbsp;These&nbsp;functions&nbsp;deal&nbsp;with&nbsp;group&nbsp;elements.&nbsp;The&nbsp;group&nbsp;is&nbsp;an&nbsp;elliptic&nbsp;curve</span><br>
<span class="lineno">500</span><span class="comment" id="4919836">//&nbsp;group&nbsp;with&nbsp;a&nbsp;=&nbsp;-3&nbsp;defined&nbsp;in&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.2.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4919896">//&nbsp;p224AddJacobian&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a+b&nbsp;where&nbsp;a&nbsp;!=&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="4919949">func</span>&nbsp;<span class="ident" id="4919954">p224AddJacobian</span><span class="op" id="4919969">(</span><span class="ident" id="4919970">x3</span><span class="op" id="4919972">,</span>&nbsp;<span class="ident" id="4919974">y3</span><span class="op" id="4919976">,</span>&nbsp;<span class="ident" id="4919978">z3</span><span class="op" id="4919980">,</span>&nbsp;<span class="ident" id="4919982">x1</span><span class="op" id="4919984">,</span>&nbsp;<span class="ident" id="4919986">y1</span><span class="op" id="4919988">,</span>&nbsp;<span class="ident" id="4919990">z1</span><span class="op" id="4919992">,</span>&nbsp;<span class="ident" id="4919994">x2</span><span class="op" id="4919996">,</span>&nbsp;<span class="ident" id="4919998">y2</span><span class="op" id="4920000">,</span>&nbsp;<span class="ident" id="4920002">z2</span>&nbsp;<span class="op" id="4920005">*</span><span class="ident" id="4920006">p224FieldElement</span><span class="op" id="4920022">)</span>&nbsp;<span class="op" id="4920024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4920027">//&nbsp;See&nbsp;http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-3.html#addition-p224Add-2007-bl</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4920121">var</span>&nbsp;<span class="ident" id="4920125">z1z1</span><span class="op" id="4920129">,</span>&nbsp;<span class="ident" id="4920131">z2z2</span><span class="op" id="4920135">,</span>&nbsp;<span class="ident" id="4920137">u1</span><span class="op" id="4920139">,</span>&nbsp;<span class="ident" id="4920141">u2</span><span class="op" id="4920143">,</span>&nbsp;<span class="ident" id="4920145">s1</span><span class="op" id="4920147">,</span>&nbsp;<span class="ident" id="4920149">s2</span><span class="op" id="4920151">,</span>&nbsp;<span class="ident" id="4920153">h</span><span class="op" id="4920154">,</span>&nbsp;<span class="ident" id="4920156">i</span><span class="op" id="4920157">,</span>&nbsp;<span class="ident" id="4920159">j</span><span class="op" id="4920160">,</span>&nbsp;<span class="ident" id="4920162">r</span><span class="op" id="4920163">,</span>&nbsp;<span class="ident" id="4920165">v</span>&nbsp;<span class="ident" id="4920167">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4920185">var</span>&nbsp;<span class="ident" id="4920189">c</span>&nbsp;<span class="ident" id="4920191">p224LargeFieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4920215">z1IsZero</span>&nbsp;<span class="op" id="4920224">:=</span>&nbsp;<span class="ident" id="4920227">p224IsZero</span><span class="op" id="4920237">(</span><span class="ident" id="4920238">z1</span><span class="op" id="4920240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4920243">z2IsZero</span>&nbsp;<span class="op" id="4920252">:=</span>&nbsp;<span class="ident" id="4920255">p224IsZero</span><span class="op" id="4920265">(</span><span class="ident" id="4920266">z2</span><span class="op" id="4920268">)</span><br>
<span class="lineno">510</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4920272">//&nbsp;Z1Z1&nbsp;=&nbsp;Z1²</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4920288">p224Square</span><span class="op" id="4920298">(</span><span class="op" id="4920299">&amp;</span><span class="ident" id="4920300">z1z1</span><span class="op" id="4920304">,</span>&nbsp;<span class="ident" id="4920306">z1</span><span class="op" id="4920308">,</span>&nbsp;<span class="op" id="4920310">&amp;</span><span class="ident" id="4920311">c</span><span class="op" id="4920312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4920315">//&nbsp;Z2Z2&nbsp;=&nbsp;Z2²</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4920331">p224Square</span><span class="op" id="4920341">(</span><span class="op" id="4920342">&amp;</span><span class="ident" id="4920343">z2z2</span><span class="op" id="4920347">,</span>&nbsp;<span class="ident" id="4920349">z2</span><span class="op" id="4920351">,</span>&nbsp;<span class="op" id="4920353">&amp;</span><span class="ident" id="4920354">c</span><span class="op" id="4920355">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4920358">//&nbsp;U1&nbsp;=&nbsp;X1*Z2Z2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4920375">p224Mul</span><span class="op" id="4920382">(</span><span class="op" id="4920383">&amp;</span><span class="ident" id="4920384">u1</span><span class="op" id="4920386">,</span>&nbsp;<span class="ident" id="4920388">x1</span><span class="op" id="4920390">,</span>&nbsp;<span class="op" id="4920392">&amp;</span><span class="ident" id="4920393">z2z2</span><span class="op" id="4920397">,</span>&nbsp;<span class="op" id="4920399">&amp;</span><span class="ident" id="4920400">c</span><span class="op" id="4920401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4920404">//&nbsp;U2&nbsp;=&nbsp;X2*Z1Z1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4920421">p224Mul</span><span class="op" id="4920428">(</span><span class="op" id="4920429">&amp;</span><span class="ident" id="4920430">u2</span><span class="op" id="4920432">,</span>&nbsp;<span class="ident" id="4920434">x2</span><span class="op" id="4920436">,</span>&nbsp;<span class="op" id="4920438">&amp;</span><span class="ident" id="4920439">z1z1</span><span class="op" id="4920443">,</span>&nbsp;<span class="op" id="4920445">&amp;</span><span class="ident" id="4920446">c</span><span class="op" id="4920447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4920450">//&nbsp;S1&nbsp;=&nbsp;Y1*Z2*Z2Z2</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4920470">p224Mul</span><span class="op" id="4920477">(</span><span class="op" id="4920478">&amp;</span><span class="ident" id="4920479">s1</span><span class="op" id="4920481">,</span>&nbsp;<span class="ident" id="4920483">z2</span><span class="op" id="4920485">,</span>&nbsp;<span class="op" id="4920487">&amp;</span><span class="ident" id="4920488">z2z2</span><span class="op" id="4920492">,</span>&nbsp;<span class="op" id="4920494">&amp;</span><span class="ident" id="4920495">c</span><span class="op" id="4920496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4920499">p224Mul</span><span class="op" id="4920506">(</span><span class="op" id="4920507">&amp;</span><span class="ident" id="4920508">s1</span><span class="op" id="4920510">,</span>&nbsp;<span class="ident" id="4920512">y1</span><span class="op" id="4920514">,</span>&nbsp;<span class="op" id="4920516">&amp;</span><span class="ident" id="4920517">s1</span><span class="op" id="4920519">,</span>&nbsp;<span class="op" id="4920521">&amp;</span><span class="ident" id="4920522">c</span><span class="op" id="4920523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4920526">//&nbsp;S2&nbsp;=&nbsp;Y2*Z1*Z1Z1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4920546">p224Mul</span><span class="op" id="4920553">(</span><span class="op" id="4920554">&amp;</span><span class="ident" id="4920555">s2</span><span class="op" id="4920557">,</span>&nbsp;<span class="ident" id="4920559">z1</span><span class="op" id="4920561">,</span>&nbsp;<span class="op" id="4920563">&amp;</span><span class="ident" id="4920564">z1z1</span><span class="op" id="4920568">,</span>&nbsp;<span class="op" id="4920570">&amp;</span><span class="ident" id="4920571">c</span><span class="op" id="4920572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4920575">p224Mul</span><span class="op" id="4920582">(</span><span class="op" id="4920583">&amp;</span><span class="ident" id="4920584">s2</span><span class="op" id="4920586">,</span>&nbsp;<span class="ident" id="4920588">y2</span><span class="op" id="4920590">,</span>&nbsp;<span class="op" id="4920592">&amp;</span><span class="ident" id="4920593">s2</span><span class="op" id="4920595">,</span>&nbsp;<span class="op" id="4920597">&amp;</span><span class="ident" id="4920598">c</span><span class="op" id="4920599">)</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4920602">//&nbsp;H&nbsp;=&nbsp;U2-U1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4920616">p224Sub</span><span class="op" id="4920623">(</span><span class="op" id="4920624">&amp;</span><span class="ident" id="4920625">h</span><span class="op" id="4920626">,</span>&nbsp;<span class="op" id="4920628">&amp;</span><span class="ident" id="4920629">u2</span><span class="op" id="4920631">,</span>&nbsp;<span class="op" id="4920633">&amp;</span><span class="ident" id="4920634">u1</span><span class="op" id="4920636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4920639">p224Reduce</span><span class="op" id="4920649">(</span><span class="op" id="4920650">&amp;</span><span class="ident" id="4920651">h</span><span class="op" id="4920652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4920655">xEqual</span>&nbsp;<span class="op" id="4920662">:=</span>&nbsp;<span class="ident" id="4920665">p224IsZero</span><span class="op" id="4920675">(</span><span class="op" id="4920676">&amp;</span><span class="ident" id="4920677">h</span><span class="op" id="4920678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4920681">//&nbsp;I&nbsp;=&nbsp;(2*H)²</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4920697">for</span>&nbsp;<span class="ident" id="4920701">j</span>&nbsp;<span class="op" id="4920703">:=</span>&nbsp;<span class="num" id="4920706">0</span><span class="op" id="4920707">;</span>&nbsp;<span class="ident" id="4920709">j</span>&nbsp;<span class="op" id="4920711">&lt;</span>&nbsp;<span class="num" id="4920713">8</span><span class="op" id="4920714">;</span>&nbsp;<span class="ident" id="4920716">j</span><span class="op" id="4920717">++</span>&nbsp;<span class="op" id="4920720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4920724">i</span><span class="op" id="4920725">[</span><span class="ident" id="4920726">j</span><span class="op" id="4920727">]</span>&nbsp;<span class="op" id="4920729">=</span>&nbsp;<span class="ident" id="4920731">h</span><span class="op" id="4920732">[</span><span class="ident" id="4920733">j</span><span class="op" id="4920734">]</span>&nbsp;<span class="op" id="4920736">&lt;&lt;</span>&nbsp;<span class="num" id="4920739">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4920742">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4920745">p224Reduce</span><span class="op" id="4920755">(</span><span class="op" id="4920756">&amp;</span><span class="ident" id="4920757">i</span><span class="op" id="4920758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4920761">p224Square</span><span class="op" id="4920771">(</span><span class="op" id="4920772">&amp;</span><span class="ident" id="4920773">i</span><span class="op" id="4920774">,</span>&nbsp;<span class="op" id="4920776">&amp;</span><span class="ident" id="4920777">i</span><span class="op" id="4920778">,</span>&nbsp;<span class="op" id="4920780">&amp;</span><span class="ident" id="4920781">c</span><span class="op" id="4920782">)</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4920785">//&nbsp;J&nbsp;=&nbsp;H*I</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4920797">p224Mul</span><span class="op" id="4920804">(</span><span class="op" id="4920805">&amp;</span><span class="ident" id="4920806">j</span><span class="op" id="4920807">,</span>&nbsp;<span class="op" id="4920809">&amp;</span><span class="ident" id="4920810">h</span><span class="op" id="4920811">,</span>&nbsp;<span class="op" id="4920813">&amp;</span><span class="ident" id="4920814">i</span><span class="op" id="4920815">,</span>&nbsp;<span class="op" id="4920817">&amp;</span><span class="ident" id="4920818">c</span><span class="op" id="4920819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4920822">//&nbsp;r&nbsp;=&nbsp;2*(S2-S1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4920840">p224Sub</span><span class="op" id="4920847">(</span><span class="op" id="4920848">&amp;</span><span class="ident" id="4920849">r</span><span class="op" id="4920850">,</span>&nbsp;<span class="op" id="4920852">&amp;</span><span class="ident" id="4920853">s2</span><span class="op" id="4920855">,</span>&nbsp;<span class="op" id="4920857">&amp;</span><span class="ident" id="4920858">s1</span><span class="op" id="4920860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4920863">p224Reduce</span><span class="op" id="4920873">(</span><span class="op" id="4920874">&amp;</span><span class="ident" id="4920875">r</span><span class="op" id="4920876">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4920879">yEqual</span>&nbsp;<span class="op" id="4920886">:=</span>&nbsp;<span class="ident" id="4920889">p224IsZero</span><span class="op" id="4920899">(</span><span class="op" id="4920900">&amp;</span><span class="ident" id="4920901">r</span><span class="op" id="4920902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4920905">if</span>&nbsp;<span class="ident" id="4920908">xEqual</span>&nbsp;<span class="op" id="4920915">==</span>&nbsp;<span class="num" id="4920918">1</span>&nbsp;<span class="op" id="4920920">&amp;&amp;</span>&nbsp;<span class="ident" id="4920923">yEqual</span>&nbsp;<span class="op" id="4920930">==</span>&nbsp;<span class="num" id="4920933">1</span>&nbsp;<span class="op" id="4920935">&amp;&amp;</span>&nbsp;<span class="ident" id="4920938">z1IsZero</span>&nbsp;<span class="op" id="4920947">==</span>&nbsp;<span class="num" id="4920950">0</span>&nbsp;<span class="op" id="4920952">&amp;&amp;</span>&nbsp;<span class="ident" id="4920955">z2IsZero</span>&nbsp;<span class="op" id="4920964">==</span>&nbsp;<span class="num" id="4920967">0</span>&nbsp;<span class="op" id="4920969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4920973">p224DoubleJacobian</span><span class="op" id="4920991">(</span><span class="ident" id="4920992">x3</span><span class="op" id="4920994">,</span>&nbsp;<span class="ident" id="4920996">y3</span><span class="op" id="4920998">,</span>&nbsp;<span class="ident" id="4921000">z3</span><span class="op" id="4921002">,</span>&nbsp;<span class="ident" id="4921004">x1</span><span class="op" id="4921006">,</span>&nbsp;<span class="ident" id="4921008">y1</span><span class="op" id="4921010">,</span>&nbsp;<span class="ident" id="4921012">z1</span><span class="op" id="4921014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4921018">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4921026">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4921029">for</span>&nbsp;<span class="ident" id="4921033">i</span>&nbsp;<span class="op" id="4921035">:=</span>&nbsp;<span class="num" id="4921038">0</span><span class="op" id="4921039">;</span>&nbsp;<span class="ident" id="4921041">i</span>&nbsp;<span class="op" id="4921043">&lt;</span>&nbsp;<span class="num" id="4921045">8</span><span class="op" id="4921046">;</span>&nbsp;<span class="ident" id="4921048">i</span><span class="op" id="4921049">++</span>&nbsp;<span class="op" id="4921052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921056">r</span><span class="op" id="4921057">[</span><span class="ident" id="4921058">i</span><span class="op" id="4921059">]</span>&nbsp;<span class="op" id="4921061">&lt;&lt;=</span>&nbsp;<span class="num" id="4921065">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4921068">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921071">p224Reduce</span><span class="op" id="4921081">(</span><span class="op" id="4921082">&amp;</span><span class="ident" id="4921083">r</span><span class="op" id="4921084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4921087">//&nbsp;V&nbsp;=&nbsp;U1*I</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921100">p224Mul</span><span class="op" id="4921107">(</span><span class="op" id="4921108">&amp;</span><span class="ident" id="4921109">v</span><span class="op" id="4921110">,</span>&nbsp;<span class="op" id="4921112">&amp;</span><span class="ident" id="4921113">u1</span><span class="op" id="4921115">,</span>&nbsp;<span class="op" id="4921117">&amp;</span><span class="ident" id="4921118">i</span><span class="op" id="4921119">,</span>&nbsp;<span class="op" id="4921121">&amp;</span><span class="ident" id="4921122">c</span><span class="op" id="4921123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4921126">//&nbsp;Z3&nbsp;=&nbsp;((Z1+Z2)²-Z1Z1-Z2Z2)*H</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921159">p224Add</span><span class="op" id="4921166">(</span><span class="op" id="4921167">&amp;</span><span class="ident" id="4921168">z1z1</span><span class="op" id="4921172">,</span>&nbsp;<span class="op" id="4921174">&amp;</span><span class="ident" id="4921175">z1z1</span><span class="op" id="4921179">,</span>&nbsp;<span class="op" id="4921181">&amp;</span><span class="ident" id="4921182">z2z2</span><span class="op" id="4921186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921189">p224Add</span><span class="op" id="4921196">(</span><span class="op" id="4921197">&amp;</span><span class="ident" id="4921198">z2z2</span><span class="op" id="4921202">,</span>&nbsp;<span class="ident" id="4921204">z1</span><span class="op" id="4921206">,</span>&nbsp;<span class="ident" id="4921208">z2</span><span class="op" id="4921210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921213">p224Reduce</span><span class="op" id="4921223">(</span><span class="op" id="4921224">&amp;</span><span class="ident" id="4921225">z2z2</span><span class="op" id="4921229">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921232">p224Square</span><span class="op" id="4921242">(</span><span class="op" id="4921243">&amp;</span><span class="ident" id="4921244">z2z2</span><span class="op" id="4921248">,</span>&nbsp;<span class="op" id="4921250">&amp;</span><span class="ident" id="4921251">z2z2</span><span class="op" id="4921255">,</span>&nbsp;<span class="op" id="4921257">&amp;</span><span class="ident" id="4921258">c</span><span class="op" id="4921259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921262">p224Sub</span><span class="op" id="4921269">(</span><span class="ident" id="4921270">z3</span><span class="op" id="4921272">,</span>&nbsp;<span class="op" id="4921274">&amp;</span><span class="ident" id="4921275">z2z2</span><span class="op" id="4921279">,</span>&nbsp;<span class="op" id="4921281">&amp;</span><span class="ident" id="4921282">z1z1</span><span class="op" id="4921286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921289">p224Reduce</span><span class="op" id="4921299">(</span><span class="ident" id="4921300">z3</span><span class="op" id="4921302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921305">p224Mul</span><span class="op" id="4921312">(</span><span class="ident" id="4921313">z3</span><span class="op" id="4921315">,</span>&nbsp;<span class="ident" id="4921317">z3</span><span class="op" id="4921319">,</span>&nbsp;<span class="op" id="4921321">&amp;</span><span class="ident" id="4921322">h</span><span class="op" id="4921323">,</span>&nbsp;<span class="op" id="4921325">&amp;</span><span class="ident" id="4921326">c</span><span class="op" id="4921327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4921330">//&nbsp;X3&nbsp;=&nbsp;r²-J-2*V</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4921349">for</span>&nbsp;<span class="ident" id="4921353">i</span>&nbsp;<span class="op" id="4921355">:=</span>&nbsp;<span class="num" id="4921358">0</span><span class="op" id="4921359">;</span>&nbsp;<span class="ident" id="4921361">i</span>&nbsp;<span class="op" id="4921363">&lt;</span>&nbsp;<span class="num" id="4921365">8</span><span class="op" id="4921366">;</span>&nbsp;<span class="ident" id="4921368">i</span><span class="op" id="4921369">++</span>&nbsp;<span class="op" id="4921372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921376">z1z1</span><span class="op" id="4921380">[</span><span class="ident" id="4921381">i</span><span class="op" id="4921382">]</span>&nbsp;<span class="op" id="4921384">=</span>&nbsp;<span class="ident" id="4921386">v</span><span class="op" id="4921387">[</span><span class="ident" id="4921388">i</span><span class="op" id="4921389">]</span>&nbsp;<span class="op" id="4921391">&lt;&lt;</span>&nbsp;<span class="num" id="4921394">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4921397">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921400">p224Add</span><span class="op" id="4921407">(</span><span class="op" id="4921408">&amp;</span><span class="ident" id="4921409">z1z1</span><span class="op" id="4921413">,</span>&nbsp;<span class="op" id="4921415">&amp;</span><span class="ident" id="4921416">j</span><span class="op" id="4921417">,</span>&nbsp;<span class="op" id="4921419">&amp;</span><span class="ident" id="4921420">z1z1</span><span class="op" id="4921424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921427">p224Reduce</span><span class="op" id="4921437">(</span><span class="op" id="4921438">&amp;</span><span class="ident" id="4921439">z1z1</span><span class="op" id="4921443">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921446">p224Square</span><span class="op" id="4921456">(</span><span class="ident" id="4921457">x3</span><span class="op" id="4921459">,</span>&nbsp;<span class="op" id="4921461">&amp;</span><span class="ident" id="4921462">r</span><span class="op" id="4921463">,</span>&nbsp;<span class="op" id="4921465">&amp;</span><span class="ident" id="4921466">c</span><span class="op" id="4921467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921470">p224Sub</span><span class="op" id="4921477">(</span><span class="ident" id="4921478">x3</span><span class="op" id="4921480">,</span>&nbsp;<span class="ident" id="4921482">x3</span><span class="op" id="4921484">,</span>&nbsp;<span class="op" id="4921486">&amp;</span><span class="ident" id="4921487">z1z1</span><span class="op" id="4921491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921494">p224Reduce</span><span class="op" id="4921504">(</span><span class="ident" id="4921505">x3</span><span class="op" id="4921507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4921510">//&nbsp;Y3&nbsp;=&nbsp;r*(V-X3)-2*S1*J</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4921535">for</span>&nbsp;<span class="ident" id="4921539">i</span>&nbsp;<span class="op" id="4921541">:=</span>&nbsp;<span class="num" id="4921544">0</span><span class="op" id="4921545">;</span>&nbsp;<span class="ident" id="4921547">i</span>&nbsp;<span class="op" id="4921549">&lt;</span>&nbsp;<span class="num" id="4921551">8</span><span class="op" id="4921552">;</span>&nbsp;<span class="ident" id="4921554">i</span><span class="op" id="4921555">++</span>&nbsp;<span class="op" id="4921558">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921562">s1</span><span class="op" id="4921564">[</span><span class="ident" id="4921565">i</span><span class="op" id="4921566">]</span>&nbsp;<span class="op" id="4921568">&lt;&lt;=</span>&nbsp;<span class="num" id="4921572">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4921575">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921578">p224Mul</span><span class="op" id="4921585">(</span><span class="op" id="4921586">&amp;</span><span class="ident" id="4921587">s1</span><span class="op" id="4921589">,</span>&nbsp;<span class="op" id="4921591">&amp;</span><span class="ident" id="4921592">s1</span><span class="op" id="4921594">,</span>&nbsp;<span class="op" id="4921596">&amp;</span><span class="ident" id="4921597">j</span><span class="op" id="4921598">,</span>&nbsp;<span class="op" id="4921600">&amp;</span><span class="ident" id="4921601">c</span><span class="op" id="4921602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921605">p224Sub</span><span class="op" id="4921612">(</span><span class="op" id="4921613">&amp;</span><span class="ident" id="4921614">z1z1</span><span class="op" id="4921618">,</span>&nbsp;<span class="op" id="4921620">&amp;</span><span class="ident" id="4921621">v</span><span class="op" id="4921622">,</span>&nbsp;<span class="ident" id="4921624">x3</span><span class="op" id="4921626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921629">p224Reduce</span><span class="op" id="4921639">(</span><span class="op" id="4921640">&amp;</span><span class="ident" id="4921641">z1z1</span><span class="op" id="4921645">)</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921648">p224Mul</span><span class="op" id="4921655">(</span><span class="op" id="4921656">&amp;</span><span class="ident" id="4921657">z1z1</span><span class="op" id="4921661">,</span>&nbsp;<span class="op" id="4921663">&amp;</span><span class="ident" id="4921664">z1z1</span><span class="op" id="4921668">,</span>&nbsp;<span class="op" id="4921670">&amp;</span><span class="ident" id="4921671">r</span><span class="op" id="4921672">,</span>&nbsp;<span class="op" id="4921674">&amp;</span><span class="ident" id="4921675">c</span><span class="op" id="4921676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921679">p224Sub</span><span class="op" id="4921686">(</span><span class="ident" id="4921687">y3</span><span class="op" id="4921689">,</span>&nbsp;<span class="op" id="4921691">&amp;</span><span class="ident" id="4921692">z1z1</span><span class="op" id="4921696">,</span>&nbsp;<span class="op" id="4921698">&amp;</span><span class="ident" id="4921699">s1</span><span class="op" id="4921701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921704">p224Reduce</span><span class="op" id="4921714">(</span><span class="ident" id="4921715">y3</span><span class="op" id="4921717">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921721">p224CopyConditional</span><span class="op" id="4921740">(</span><span class="ident" id="4921741">x3</span><span class="op" id="4921743">,</span>&nbsp;<span class="ident" id="4921745">x2</span><span class="op" id="4921747">,</span>&nbsp;<span class="ident" id="4921749">z1IsZero</span><span class="op" id="4921757">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921760">p224CopyConditional</span><span class="op" id="4921779">(</span><span class="ident" id="4921780">x3</span><span class="op" id="4921782">,</span>&nbsp;<span class="ident" id="4921784">x1</span><span class="op" id="4921786">,</span>&nbsp;<span class="ident" id="4921788">z2IsZero</span><span class="op" id="4921796">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921799">p224CopyConditional</span><span class="op" id="4921818">(</span><span class="ident" id="4921819">y3</span><span class="op" id="4921821">,</span>&nbsp;<span class="ident" id="4921823">y2</span><span class="op" id="4921825">,</span>&nbsp;<span class="ident" id="4921827">z1IsZero</span><span class="op" id="4921835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921838">p224CopyConditional</span><span class="op" id="4921857">(</span><span class="ident" id="4921858">y3</span><span class="op" id="4921860">,</span>&nbsp;<span class="ident" id="4921862">y1</span><span class="op" id="4921864">,</span>&nbsp;<span class="ident" id="4921866">z2IsZero</span><span class="op" id="4921874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921877">p224CopyConditional</span><span class="op" id="4921896">(</span><span class="ident" id="4921897">z3</span><span class="op" id="4921899">,</span>&nbsp;<span class="ident" id="4921901">z2</span><span class="op" id="4921903">,</span>&nbsp;<span class="ident" id="4921905">z1IsZero</span><span class="op" id="4921913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921916">p224CopyConditional</span><span class="op" id="4921935">(</span><span class="ident" id="4921936">z3</span><span class="op" id="4921938">,</span>&nbsp;<span class="ident" id="4921940">z1</span><span class="op" id="4921942">,</span>&nbsp;<span class="ident" id="4921944">z2IsZero</span><span class="op" id="4921952">)</span><br>
<span class="lineno">585</span><span class="op" id="4921954">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4921957">//&nbsp;p224DoubleJacobian&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a+a.</span><br>
<span class="lineno"></span><span class="keyword" id="4922000">func</span>&nbsp;<span class="ident" id="4922005">p224DoubleJacobian</span><span class="op" id="4922023">(</span><span class="ident" id="4922024">x3</span><span class="op" id="4922026">,</span>&nbsp;<span class="ident" id="4922028">y3</span><span class="op" id="4922030">,</span>&nbsp;<span class="ident" id="4922032">z3</span><span class="op" id="4922034">,</span>&nbsp;<span class="ident" id="4922036">x1</span><span class="op" id="4922038">,</span>&nbsp;<span class="ident" id="4922040">y1</span><span class="op" id="4922042">,</span>&nbsp;<span class="ident" id="4922044">z1</span>&nbsp;<span class="op" id="4922047">*</span><span class="ident" id="4922048">p224FieldElement</span><span class="op" id="4922064">)</span>&nbsp;<span class="op" id="4922066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4922069">var</span>&nbsp;<span class="ident" id="4922073">delta</span><span class="op" id="4922078">,</span>&nbsp;<span class="ident" id="4922080">gamma</span><span class="op" id="4922085">,</span>&nbsp;<span class="ident" id="4922087">beta</span><span class="op" id="4922091">,</span>&nbsp;<span class="ident" id="4922093">alpha</span><span class="op" id="4922098">,</span>&nbsp;<span class="ident" id="4922100">t</span>&nbsp;<span class="ident" id="4922102">p224FieldElement</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4922120">var</span>&nbsp;<span class="ident" id="4922124">c</span>&nbsp;<span class="ident" id="4922126">p224LargeFieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4922150">p224Square</span><span class="op" id="4922160">(</span><span class="op" id="4922161">&amp;</span><span class="ident" id="4922162">delta</span><span class="op" id="4922167">,</span>&nbsp;<span class="ident" id="4922169">z1</span><span class="op" id="4922171">,</span>&nbsp;<span class="op" id="4922173">&amp;</span><span class="ident" id="4922174">c</span><span class="op" id="4922175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4922178">p224Square</span><span class="op" id="4922188">(</span><span class="op" id="4922189">&amp;</span><span class="ident" id="4922190">gamma</span><span class="op" id="4922195">,</span>&nbsp;<span class="ident" id="4922197">y1</span><span class="op" id="4922199">,</span>&nbsp;<span class="op" id="4922201">&amp;</span><span class="ident" id="4922202">c</span><span class="op" id="4922203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4922206">p224Mul</span><span class="op" id="4922213">(</span><span class="op" id="4922214">&amp;</span><span class="ident" id="4922215">beta</span><span class="op" id="4922219">,</span>&nbsp;<span class="ident" id="4922221">x1</span><span class="op" id="4922223">,</span>&nbsp;<span class="op" id="4922225">&amp;</span><span class="ident" id="4922226">gamma</span><span class="op" id="4922231">,</span>&nbsp;<span class="op" id="4922233">&amp;</span><span class="ident" id="4922234">c</span><span class="op" id="4922235">)</span><br>
<span class="lineno">595</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4922239">//&nbsp;alpha&nbsp;=&nbsp;3*(X1-delta)*(X1+delta)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4922275">p224Add</span><span class="op" id="4922282">(</span><span class="op" id="4922283">&amp;</span><span class="ident" id="4922284">t</span><span class="op" id="4922285">,</span>&nbsp;<span class="ident" id="4922287">x1</span><span class="op" id="4922289">,</span>&nbsp;<span class="op" id="4922291">&amp;</span><span class="ident" id="4922292">delta</span><span class="op" id="4922297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4922300">for</span>&nbsp;<span class="ident" id="4922304">i</span>&nbsp;<span class="op" id="4922306">:=</span>&nbsp;<span class="num" id="4922309">0</span><span class="op" id="4922310">;</span>&nbsp;<span class="ident" id="4922312">i</span>&nbsp;<span class="op" id="4922314">&lt;</span>&nbsp;<span class="num" id="4922316">8</span><span class="op" id="4922317">;</span>&nbsp;<span class="ident" id="4922319">i</span><span class="op" id="4922320">++</span>&nbsp;<span class="op" id="4922323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4922327">t</span><span class="op" id="4922328">[</span><span class="ident" id="4922329">i</span><span class="op" id="4922330">]</span>&nbsp;<span class="op" id="4922332">+=</span>&nbsp;<span class="ident" id="4922335">t</span><span class="op" id="4922336">[</span><span class="ident" id="4922337">i</span><span class="op" id="4922338">]</span>&nbsp;<span class="op" id="4922340">&lt;&lt;</span>&nbsp;<span class="num" id="4922343">1</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4922346">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4922349">p224Reduce</span><span class="op" id="4922359">(</span><span class="op" id="4922360">&amp;</span><span class="ident" id="4922361">t</span><span class="op" id="4922362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4922365">p224Sub</span><span class="op" id="4922372">(</span><span class="op" id="4922373">&amp;</span><span class="ident" id="4922374">alpha</span><span class="op" id="4922379">,</span>&nbsp;<span class="ident" id="4922381">x1</span><span class="op" id="4922383">,</span>&nbsp;<span class="op" id="4922385">&amp;</span><span class="ident" id="4922386">delta</span><span class="op" id="4922391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4922394">p224Reduce</span><span class="op" id="4922404">(</span><span class="op" id="4922405">&amp;</span><span class="ident" id="4922406">alpha</span><span class="op" id="4922411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4922414">p224Mul</span><span class="op" id="4922421">(</span><span class="op" id="4922422">&amp;</span><span class="ident" id="4922423">alpha</span><span class="op" id="4922428">,</span>&nbsp;<span class="op" id="4922430">&amp;</span><span class="ident" id="4922431">alpha</span><span class="op" id="4922436">,</span>&nbsp;<span class="op" id="4922438">&amp;</span><span class="ident" id="4922439">t</span><span class="op" id="4922440">,</span>&nbsp;<span class="op" id="4922442">&amp;</span><span class="ident" id="4922443">c</span><span class="op" id="4922444">)</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4922448">//&nbsp;Z3&nbsp;=&nbsp;(Y1+Z1)²-gamma-delta</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4922479">p224Add</span><span class="op" id="4922486">(</span><span class="ident" id="4922487">z3</span><span class="op" id="4922489">,</span>&nbsp;<span class="ident" id="4922491">y1</span><span class="op" id="4922493">,</span>&nbsp;<span class="ident" id="4922495">z1</span><span class="op" id="4922497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4922500">p224Reduce</span><span class="op" id="4922510">(</span><span class="ident" id="4922511">z3</span><span class="op" id="4922513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4922516">p224Square</span><span class="op" id="4922526">(</span><span class="ident" id="4922527">z3</span><span class="op" id="4922529">,</span>&nbsp;<span class="ident" id="4922531">z3</span><span class="op" id="4922533">,</span>&nbsp;<span class="op" id="4922535">&amp;</span><span class="ident" id="4922536">c</span><span class="op" id="4922537">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4922540">p224Sub</span><span class="op" id="4922547">(</span><span class="ident" id="4922548">z3</span><span class="op" id="4922550">,</span>&nbsp;<span class="ident" id="4922552">z3</span><span class="op" id="4922554">,</span>&nbsp;<span class="op" id="4922556">&amp;</span><span class="ident" id="4922557">gamma</span><span class="op" id="4922562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4922565">p224Reduce</span><span class="op" id="4922575">(</span><span class="ident" id="4922576">z3</span><span class="op" id="4922578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4922581">p224Sub</span><span class="op" id="4922588">(</span><span class="ident" id="4922589">z3</span><span class="op" id="4922591">,</span>&nbsp;<span class="ident" id="4922593">z3</span><span class="op" id="4922595">,</span>&nbsp;<span class="op" id="4922597">&amp;</span><span class="ident" id="4922598">delta</span><span class="op" id="4922603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4922606">p224Reduce</span><span class="op" id="4922616">(</span><span class="ident" id="4922617">z3</span><span class="op" id="4922619">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4922623">//&nbsp;X3&nbsp;=&nbsp;alpha²-8*beta</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4922647">for</span>&nbsp;<span class="ident" id="4922651">i</span>&nbsp;<span class="op" id="4922653">:=</span>&nbsp;<span class="num" id="4922656">0</span><span class="op" id="4922657">;</span>&nbsp;<span class="ident" id="4922659">i</span>&nbsp;<span class="op" id="4922661">&lt;</span>&nbsp;<span class="num" id="4922663">8</span><span class="op" id="4922664">;</span>&nbsp;<span class="ident" id="4922666">i</span><span class="op" id="4922667">++</span>&nbsp;<span class="op" id="4922670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4922674">delta</span><span class="op" id="4922679">[</span><span class="ident" id="4922680">i</span><span class="op" id="4922681">]</span>&nbsp;<span class="op" id="4922683">=</span>&nbsp;<span class="ident" id="4922685">beta</span><span class="op" id="4922689">[</span><span class="ident" id="4922690">i</span><span class="op" id="4922691">]</span>&nbsp;<span class="op" id="4922693">&lt;&lt;</span>&nbsp;<span class="num" id="4922696">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4922699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4922702">p224Reduce</span><span class="op" id="4922712">(</span><span class="op" id="4922713">&amp;</span><span class="ident" id="4922714">delta</span><span class="op" id="4922719">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4922722">p224Square</span><span class="op" id="4922732">(</span><span class="ident" id="4922733">x3</span><span class="op" id="4922735">,</span>&nbsp;<span class="op" id="4922737">&amp;</span><span class="ident" id="4922738">alpha</span><span class="op" id="4922743">,</span>&nbsp;<span class="op" id="4922745">&amp;</span><span class="ident" id="4922746">c</span><span class="op" id="4922747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4922750">p224Sub</span><span class="op" id="4922757">(</span><span class="ident" id="4922758">x3</span><span class="op" id="4922760">,</span>&nbsp;<span class="ident" id="4922762">x3</span><span class="op" id="4922764">,</span>&nbsp;<span class="op" id="4922766">&amp;</span><span class="ident" id="4922767">delta</span><span class="op" id="4922772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4922775">p224Reduce</span><span class="op" id="4922785">(</span><span class="ident" id="4922786">x3</span><span class="op" id="4922788">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4922792">//&nbsp;Y3&nbsp;=&nbsp;alpha*(4*beta-X3)-8*gamma²</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4922829">for</span>&nbsp;<span class="ident" id="4922833">i</span>&nbsp;<span class="op" id="4922835">:=</span>&nbsp;<span class="num" id="4922838">0</span><span class="op" id="4922839">;</span>&nbsp;<span class="ident" id="4922841">i</span>&nbsp;<span class="op" id="4922843">&lt;</span>&nbsp;<span class="num" id="4922845">8</span><span class="op" id="4922846">;</span>&nbsp;<span class="ident" id="4922848">i</span><span class="op" id="4922849">++</span>&nbsp;<span class="op" id="4922852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4922856">beta</span><span class="op" id="4922860">[</span><span class="ident" id="4922861">i</span><span class="op" id="4922862">]</span>&nbsp;<span class="op" id="4922864">&lt;&lt;=</span>&nbsp;<span class="num" id="4922868">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4922871">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4922874">p224Sub</span><span class="op" id="4922881">(</span><span class="op" id="4922882">&amp;</span><span class="ident" id="4922883">beta</span><span class="op" id="4922887">,</span>&nbsp;<span class="op" id="4922889">&amp;</span><span class="ident" id="4922890">beta</span><span class="op" id="4922894">,</span>&nbsp;<span class="ident" id="4922896">x3</span><span class="op" id="4922898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4922901">p224Reduce</span><span class="op" id="4922911">(</span><span class="op" id="4922912">&amp;</span><span class="ident" id="4922913">beta</span><span class="op" id="4922917">)</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4922920">p224Square</span><span class="op" id="4922930">(</span><span class="op" id="4922931">&amp;</span><span class="ident" id="4922932">gamma</span><span class="op" id="4922937">,</span>&nbsp;<span class="op" id="4922939">&amp;</span><span class="ident" id="4922940">gamma</span><span class="op" id="4922945">,</span>&nbsp;<span class="op" id="4922947">&amp;</span><span class="ident" id="4922948">c</span><span class="op" id="4922949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4922952">for</span>&nbsp;<span class="ident" id="4922956">i</span>&nbsp;<span class="op" id="4922958">:=</span>&nbsp;<span class="num" id="4922961">0</span><span class="op" id="4922962">;</span>&nbsp;<span class="ident" id="4922964">i</span>&nbsp;<span class="op" id="4922966">&lt;</span>&nbsp;<span class="num" id="4922968">8</span><span class="op" id="4922969">;</span>&nbsp;<span class="ident" id="4922971">i</span><span class="op" id="4922972">++</span>&nbsp;<span class="op" id="4922975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4922979">gamma</span><span class="op" id="4922984">[</span><span class="ident" id="4922985">i</span><span class="op" id="4922986">]</span>&nbsp;<span class="op" id="4922988">&lt;&lt;=</span>&nbsp;<span class="num" id="4922992">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4922995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4922998">p224Reduce</span><span class="op" id="4923008">(</span><span class="op" id="4923009">&amp;</span><span class="ident" id="4923010">gamma</span><span class="op" id="4923015">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4923018">p224Mul</span><span class="op" id="4923025">(</span><span class="ident" id="4923026">y3</span><span class="op" id="4923028">,</span>&nbsp;<span class="op" id="4923030">&amp;</span><span class="ident" id="4923031">alpha</span><span class="op" id="4923036">,</span>&nbsp;<span class="op" id="4923038">&amp;</span><span class="ident" id="4923039">beta</span><span class="op" id="4923043">,</span>&nbsp;<span class="op" id="4923045">&amp;</span><span class="ident" id="4923046">c</span><span class="op" id="4923047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4923050">p224Sub</span><span class="op" id="4923057">(</span><span class="ident" id="4923058">y3</span><span class="op" id="4923060">,</span>&nbsp;<span class="ident" id="4923062">y3</span><span class="op" id="4923064">,</span>&nbsp;<span class="op" id="4923066">&amp;</span><span class="ident" id="4923067">gamma</span><span class="op" id="4923072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4923075">p224Reduce</span><span class="op" id="4923085">(</span><span class="ident" id="4923086">y3</span><span class="op" id="4923088">)</span><br>
<span class="lineno"></span><span class="op" id="4923090">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">640</span><span class="comment" id="4923093">//&nbsp;p224CopyConditional&nbsp;sets&nbsp;*out&nbsp;=&nbsp;*in&nbsp;iff&nbsp;the&nbsp;least-significant-bit&nbsp;of&nbsp;control</span><br>
<span class="lineno"></span><span class="comment" id="4923173">//&nbsp;is&nbsp;true,&nbsp;and&nbsp;it&nbsp;runs&nbsp;in&nbsp;constant&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="4923215">func</span>&nbsp;<span class="ident" id="4923220">p224CopyConditional</span><span class="op" id="4923239">(</span><span class="ident" id="4923240">out</span><span class="op" id="4923243">,</span>&nbsp;<span class="ident" id="4923245">in</span>&nbsp;<span class="op" id="4923248">*</span><span class="ident" id="4923249">p224FieldElement</span><span class="op" id="4923265">,</span>&nbsp;<span class="ident" id="4923267">control</span>&nbsp;<span class="builtintype" id="4923275">uint32</span><span class="op" id="4923281">)</span>&nbsp;<span class="op" id="4923283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4923286">control</span>&nbsp;<span class="op" id="4923294">&lt;&lt;=</span>&nbsp;<span class="num" id="4923298">31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4923302">control</span>&nbsp;<span class="op" id="4923310">=</span>&nbsp;<span class="builtintype" id="4923312">uint32</span><span class="op" id="4923318">(</span><span class="builtintype" id="4923319">int32</span><span class="op" id="4923324">(</span><span class="ident" id="4923325">control</span><span class="op" id="4923332">)</span>&nbsp;<span class="op" id="4923334">&gt;&gt;</span>&nbsp;<span class="num" id="4923337">31</span><span class="op" id="4923339">)</span><br>
<span class="lineno">645</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4923343">for</span>&nbsp;<span class="ident" id="4923347">i</span>&nbsp;<span class="op" id="4923349">:=</span>&nbsp;<span class="num" id="4923352">0</span><span class="op" id="4923353">;</span>&nbsp;<span class="ident" id="4923355">i</span>&nbsp;<span class="op" id="4923357">&lt;</span>&nbsp;<span class="num" id="4923359">8</span><span class="op" id="4923360">;</span>&nbsp;<span class="ident" id="4923362">i</span><span class="op" id="4923363">++</span>&nbsp;<span class="op" id="4923366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4923370">out</span><span class="op" id="4923373">[</span><span class="ident" id="4923374">i</span><span class="op" id="4923375">]</span>&nbsp;<span class="op" id="4923377">^=</span>&nbsp;<span class="op" id="4923380">(</span><span class="ident" id="4923381">out</span><span class="op" id="4923384">[</span><span class="ident" id="4923385">i</span><span class="op" id="4923386">]</span>&nbsp;<span class="op" id="4923388">^</span>&nbsp;<span class="ident" id="4923390">in</span><span class="op" id="4923392">[</span><span class="ident" id="4923393">i</span><span class="op" id="4923394">]</span><span class="op" id="4923395">)</span>&nbsp;<span class="op" id="4923397">&amp;</span>&nbsp;<span class="ident" id="4923399">control</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4923408">}</span><br>
<span class="lineno"></span><span class="op" id="4923410">}</span><br>
<span class="lineno">650</span><br>
<span class="lineno"></span><span class="keyword" id="4923413">func</span>&nbsp;<span class="ident" id="4923418">p224ScalarMult</span><span class="op" id="4923432">(</span><span class="ident" id="4923433">outX</span><span class="op" id="4923437">,</span>&nbsp;<span class="ident" id="4923439">outY</span><span class="op" id="4923443">,</span>&nbsp;<span class="ident" id="4923445">outZ</span><span class="op" id="4923449">,</span>&nbsp;<span class="ident" id="4923451">inX</span><span class="op" id="4923454">,</span>&nbsp;<span class="ident" id="4923456">inY</span><span class="op" id="4923459">,</span>&nbsp;<span class="ident" id="4923461">inZ</span>&nbsp;<span class="op" id="4923465">*</span><span class="ident" id="4923466">p224FieldElement</span><span class="op" id="4923482">,</span>&nbsp;<span class="ident" id="4923484">scalar</span>&nbsp;<span class="op" id="4923491">[</span><span class="op" id="4923492">]</span><span class="builtintype" id="4923493">byte</span><span class="op" id="4923497">)</span>&nbsp;<span class="op" id="4923499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4923502">var</span>&nbsp;<span class="ident" id="4923506">xx</span><span class="op" id="4923508">,</span>&nbsp;<span class="ident" id="4923510">yy</span><span class="op" id="4923512">,</span>&nbsp;<span class="ident" id="4923514">zz</span>&nbsp;<span class="ident" id="4923517">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4923535">for</span>&nbsp;<span class="ident" id="4923539">i</span>&nbsp;<span class="op" id="4923541">:=</span>&nbsp;<span class="num" id="4923544">0</span><span class="op" id="4923545">;</span>&nbsp;<span class="ident" id="4923547">i</span>&nbsp;<span class="op" id="4923549">&lt;</span>&nbsp;<span class="num" id="4923551">8</span><span class="op" id="4923552">;</span>&nbsp;<span class="ident" id="4923554">i</span><span class="op" id="4923555">++</span>&nbsp;<span class="op" id="4923558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4923562">outX</span><span class="op" id="4923566">[</span><span class="ident" id="4923567">i</span><span class="op" id="4923568">]</span>&nbsp;<span class="op" id="4923570">=</span>&nbsp;<span class="num" id="4923572">0</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4923576">outY</span><span class="op" id="4923580">[</span><span class="ident" id="4923581">i</span><span class="op" id="4923582">]</span>&nbsp;<span class="op" id="4923584">=</span>&nbsp;<span class="num" id="4923586">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4923590">outZ</span><span class="op" id="4923594">[</span><span class="ident" id="4923595">i</span><span class="op" id="4923596">]</span>&nbsp;<span class="op" id="4923598">=</span>&nbsp;<span class="num" id="4923600">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4923603">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4923607">for</span>&nbsp;<span class="ident" id="4923611">_</span><span class="op" id="4923612">,</span>&nbsp;<span class="builtintype" id="4923614">byte</span>&nbsp;<span class="op" id="4923619">:=</span>&nbsp;<span class="keyword" id="4923622">range</span>&nbsp;<span class="ident" id="4923628">scalar</span>&nbsp;<span class="op" id="4923635">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4923639">for</span>&nbsp;<span class="ident" id="4923643">bitNum</span>&nbsp;<span class="op" id="4923650">:=</span>&nbsp;<span class="builtintype" id="4923653">uint</span><span class="op" id="4923657">(</span><span class="num" id="4923658">0</span><span class="op" id="4923659">)</span><span class="op" id="4923660">;</span>&nbsp;<span class="ident" id="4923662">bitNum</span>&nbsp;<span class="op" id="4923669">&lt;</span>&nbsp;<span class="num" id="4923671">8</span><span class="op" id="4923672">;</span>&nbsp;<span class="ident" id="4923674">bitNum</span><span class="op" id="4923680">++</span>&nbsp;<span class="op" id="4923683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4923688">p224DoubleJacobian</span><span class="op" id="4923706">(</span><span class="ident" id="4923707">outX</span><span class="op" id="4923711">,</span>&nbsp;<span class="ident" id="4923713">outY</span><span class="op" id="4923717">,</span>&nbsp;<span class="ident" id="4923719">outZ</span><span class="op" id="4923723">,</span>&nbsp;<span class="ident" id="4923725">outX</span><span class="op" id="4923729">,</span>&nbsp;<span class="ident" id="4923731">outY</span><span class="op" id="4923735">,</span>&nbsp;<span class="ident" id="4923737">outZ</span><span class="op" id="4923741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4923746">bit</span>&nbsp;<span class="op" id="4923750">:=</span>&nbsp;<span class="builtintype" id="4923753">uint32</span><span class="op" id="4923759">(</span><span class="op" id="4923760">(</span><span class="builtintype" id="4923761">byte</span>&nbsp;<span class="op" id="4923766">&gt;&gt;</span>&nbsp;<span class="op" id="4923769">(</span><span class="num" id="4923770">7</span>&nbsp;<span class="op" id="4923772">-</span>&nbsp;<span class="ident" id="4923774">bitNum</span><span class="op" id="4923780">)</span><span class="op" id="4923781">)</span>&nbsp;<span class="op" id="4923783">&amp;</span>&nbsp;<span class="num" id="4923785">1</span><span class="op" id="4923786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4923791">p224AddJacobian</span><span class="op" id="4923806">(</span><span class="op" id="4923807">&amp;</span><span class="ident" id="4923808">xx</span><span class="op" id="4923810">,</span>&nbsp;<span class="op" id="4923812">&amp;</span><span class="ident" id="4923813">yy</span><span class="op" id="4923815">,</span>&nbsp;<span class="op" id="4923817">&amp;</span><span class="ident" id="4923818">zz</span><span class="op" id="4923820">,</span>&nbsp;<span class="ident" id="4923822">inX</span><span class="op" id="4923825">,</span>&nbsp;<span class="ident" id="4923827">inY</span><span class="op" id="4923830">,</span>&nbsp;<span class="ident" id="4923832">inZ</span><span class="op" id="4923835">,</span>&nbsp;<span class="ident" id="4923837">outX</span><span class="op" id="4923841">,</span>&nbsp;<span class="ident" id="4923843">outY</span><span class="op" id="4923847">,</span>&nbsp;<span class="ident" id="4923849">outZ</span><span class="op" id="4923853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4923858">p224CopyConditional</span><span class="op" id="4923877">(</span><span class="ident" id="4923878">outX</span><span class="op" id="4923882">,</span>&nbsp;<span class="op" id="4923884">&amp;</span><span class="ident" id="4923885">xx</span><span class="op" id="4923887">,</span>&nbsp;<span class="ident" id="4923889">bit</span><span class="op" id="4923892">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4923897">p224CopyConditional</span><span class="op" id="4923916">(</span><span class="ident" id="4923917">outY</span><span class="op" id="4923921">,</span>&nbsp;<span class="op" id="4923923">&amp;</span><span class="ident" id="4923924">yy</span><span class="op" id="4923926">,</span>&nbsp;<span class="ident" id="4923928">bit</span><span class="op" id="4923931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4923936">p224CopyConditional</span><span class="op" id="4923955">(</span><span class="ident" id="4923956">outZ</span><span class="op" id="4923960">,</span>&nbsp;<span class="op" id="4923962">&amp;</span><span class="ident" id="4923963">zz</span><span class="op" id="4923965">,</span>&nbsp;<span class="ident" id="4923967">bit</span><span class="op" id="4923970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4923974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4923977">}</span><br>
<span class="lineno"></span><span class="op" id="4923979">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span><span class="comment" id="4923982">//&nbsp;p224ToAffine&nbsp;converts&nbsp;from&nbsp;Jacobian&nbsp;to&nbsp;affine&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="4924037">func</span>&nbsp;<span class="ident" id="4924042">p224ToAffine</span><span class="op" id="4924054">(</span><span class="ident" id="4924055">x</span><span class="op" id="4924056">,</span>&nbsp;<span class="ident" id="4924058">y</span><span class="op" id="4924059">,</span>&nbsp;<span class="ident" id="4924061">z</span>&nbsp;<span class="op" id="4924063">*</span><span class="ident" id="4924064">p224FieldElement</span><span class="op" id="4924080">)</span>&nbsp;<span class="op" id="4924082">(</span><span class="op" id="4924083">*</span><span class="ident" id="4924084">big</span><span class="op" id="4924087">.</span><span class="ident" id="4924088">Int</span><span class="op" id="4924091">,</span>&nbsp;<span class="op" id="4924093">*</span><span class="ident" id="4924094">big</span><span class="op" id="4924097">.</span><span class="ident" id="4924098">Int</span><span class="op" id="4924101">)</span>&nbsp;<span class="op" id="4924103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4924106">var</span>&nbsp;<span class="ident" id="4924110">zinv</span><span class="op" id="4924114">,</span>&nbsp;<span class="ident" id="4924116">zinvsq</span><span class="op" id="4924122">,</span>&nbsp;<span class="ident" id="4924124">outx</span><span class="op" id="4924128">,</span>&nbsp;<span class="ident" id="4924130">outy</span>&nbsp;<span class="ident" id="4924135">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4924153">var</span>&nbsp;<span class="ident" id="4924157">tmp</span>&nbsp;<span class="ident" id="4924161">p224LargeFieldElement</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4924185">if</span>&nbsp;<span class="ident" id="4924188">isPointAtInfinity</span>&nbsp;<span class="op" id="4924206">:=</span>&nbsp;<span class="ident" id="4924209">p224IsZero</span><span class="op" id="4924219">(</span><span class="ident" id="4924220">z</span><span class="op" id="4924221">)</span><span class="op" id="4924222">;</span>&nbsp;<span class="ident" id="4924224">isPointAtInfinity</span>&nbsp;<span class="op" id="4924242">==</span>&nbsp;<span class="num" id="4924245">1</span>&nbsp;<span class="op" id="4924247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4924251">return</span>&nbsp;<span class="builtinfunc" id="4924258">new</span><span class="op" id="4924261">(</span><span class="ident" id="4924262">big</span><span class="op" id="4924265">.</span><span class="ident" id="4924266">Int</span><span class="op" id="4924269">)</span><span class="op" id="4924270">,</span>&nbsp;<span class="builtinfunc" id="4924272">new</span><span class="op" id="4924275">(</span><span class="ident" id="4924276">big</span><span class="op" id="4924279">.</span><span class="ident" id="4924280">Int</span><span class="op" id="4924283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4924286">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4924290">p224Invert</span><span class="op" id="4924300">(</span><span class="op" id="4924301">&amp;</span><span class="ident" id="4924302">zinv</span><span class="op" id="4924306">,</span>&nbsp;<span class="ident" id="4924308">z</span><span class="op" id="4924309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4924312">p224Square</span><span class="op" id="4924322">(</span><span class="op" id="4924323">&amp;</span><span class="ident" id="4924324">zinvsq</span><span class="op" id="4924330">,</span>&nbsp;<span class="op" id="4924332">&amp;</span><span class="ident" id="4924333">zinv</span><span class="op" id="4924337">,</span>&nbsp;<span class="op" id="4924339">&amp;</span><span class="ident" id="4924340">tmp</span><span class="op" id="4924343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4924346">p224Mul</span><span class="op" id="4924353">(</span><span class="ident" id="4924354">x</span><span class="op" id="4924355">,</span>&nbsp;<span class="ident" id="4924357">x</span><span class="op" id="4924358">,</span>&nbsp;<span class="op" id="4924360">&amp;</span><span class="ident" id="4924361">zinvsq</span><span class="op" id="4924367">,</span>&nbsp;<span class="op" id="4924369">&amp;</span><span class="ident" id="4924370">tmp</span><span class="op" id="4924373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4924376">p224Mul</span><span class="op" id="4924383">(</span><span class="op" id="4924384">&amp;</span><span class="ident" id="4924385">zinvsq</span><span class="op" id="4924391">,</span>&nbsp;<span class="op" id="4924393">&amp;</span><span class="ident" id="4924394">zinvsq</span><span class="op" id="4924400">,</span>&nbsp;<span class="op" id="4924402">&amp;</span><span class="ident" id="4924403">zinv</span><span class="op" id="4924407">,</span>&nbsp;<span class="op" id="4924409">&amp;</span><span class="ident" id="4924410">tmp</span><span class="op" id="4924413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4924416">p224Mul</span><span class="op" id="4924423">(</span><span class="ident" id="4924424">y</span><span class="op" id="4924425">,</span>&nbsp;<span class="ident" id="4924427">y</span><span class="op" id="4924428">,</span>&nbsp;<span class="op" id="4924430">&amp;</span><span class="ident" id="4924431">zinvsq</span><span class="op" id="4924437">,</span>&nbsp;<span class="op" id="4924439">&amp;</span><span class="ident" id="4924440">tmp</span><span class="op" id="4924443">)</span><br>
<span class="lineno">685</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4924447">p224Contract</span><span class="op" id="4924459">(</span><span class="op" id="4924460">&amp;</span><span class="ident" id="4924461">outx</span><span class="op" id="4924465">,</span>&nbsp;<span class="ident" id="4924467">x</span><span class="op" id="4924468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4924471">p224Contract</span><span class="op" id="4924483">(</span><span class="op" id="4924484">&amp;</span><span class="ident" id="4924485">outy</span><span class="op" id="4924489">,</span>&nbsp;<span class="ident" id="4924491">y</span><span class="op" id="4924492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4924495">return</span>&nbsp;<span class="ident" id="4924502">p224ToBig</span><span class="op" id="4924511">(</span><span class="op" id="4924512">&amp;</span><span class="ident" id="4924513">outx</span><span class="op" id="4924517">)</span><span class="op" id="4924518">,</span>&nbsp;<span class="ident" id="4924520">p224ToBig</span><span class="op" id="4924529">(</span><span class="op" id="4924530">&amp;</span><span class="ident" id="4924531">outy</span><span class="op" id="4924535">)</span><br>
<span class="lineno"></span><span class="op" id="4924537">}</span><br>
<span class="lineno">690</span><br>
<span class="lineno"></span><span class="comment" id="4924540">//&nbsp;get28BitsFromEnd&nbsp;returns&nbsp;the&nbsp;least-significant&nbsp;28&nbsp;bits&nbsp;from&nbsp;buf&gt;&gt;shift,</span><br>
<span class="lineno"></span><span class="comment" id="4924615">//&nbsp;where&nbsp;buf&nbsp;is&nbsp;interpreted&nbsp;as&nbsp;a&nbsp;big-endian&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="4924667">func</span>&nbsp;<span class="ident" id="4924672">get28BitsFromEnd</span><span class="op" id="4924688">(</span><span class="ident" id="4924689">buf</span>&nbsp;<span class="op" id="4924693">[</span><span class="op" id="4924694">]</span><span class="builtintype" id="4924695">byte</span><span class="op" id="4924699">,</span>&nbsp;<span class="ident" id="4924701">shift</span>&nbsp;<span class="builtintype" id="4924707">uint</span><span class="op" id="4924711">)</span>&nbsp;<span class="op" id="4924713">(</span><span class="builtintype" id="4924714">uint32</span><span class="op" id="4924720">,</span>&nbsp;<span class="op" id="4924722">[</span><span class="op" id="4924723">]</span><span class="builtintype" id="4924724">byte</span><span class="op" id="4924728">)</span>&nbsp;<span class="op" id="4924730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4924733">var</span>&nbsp;<span class="ident" id="4924737">ret</span>&nbsp;<span class="builtintype" id="4924741">uint32</span><br>
<span class="lineno">695</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4924750">for</span>&nbsp;<span class="ident" id="4924754">i</span>&nbsp;<span class="op" id="4924756">:=</span>&nbsp;<span class="builtintype" id="4924759">uint</span><span class="op" id="4924763">(</span><span class="num" id="4924764">0</span><span class="op" id="4924765">)</span><span class="op" id="4924766">;</span>&nbsp;<span class="ident" id="4924768">i</span>&nbsp;<span class="op" id="4924770">&lt;</span>&nbsp;<span class="num" id="4924772">4</span><span class="op" id="4924773">;</span>&nbsp;<span class="ident" id="4924775">i</span><span class="op" id="4924776">++</span>&nbsp;<span class="op" id="4924779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4924783">var</span>&nbsp;<span class="ident" id="4924787">b</span>&nbsp;<span class="builtintype" id="4924789">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4924796">if</span>&nbsp;<span class="ident" id="4924799">l</span>&nbsp;<span class="op" id="4924801">:=</span>&nbsp;<span class="builtinfunc" id="4924804">len</span><span class="op" id="4924807">(</span><span class="ident" id="4924808">buf</span><span class="op" id="4924811">)</span><span class="op" id="4924812">;</span>&nbsp;<span class="ident" id="4924814">l</span>&nbsp;<span class="op" id="4924816">&gt;</span>&nbsp;<span class="num" id="4924818">0</span>&nbsp;<span class="op" id="4924820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4924825">b</span>&nbsp;<span class="op" id="4924827">=</span>&nbsp;<span class="ident" id="4924829">buf</span><span class="op" id="4924832">[</span><span class="ident" id="4924833">l</span><span class="op" id="4924834">-</span><span class="num" id="4924835">1</span><span class="op" id="4924836">]</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4924841">//&nbsp;We&nbsp;don&#39;t&nbsp;remove&nbsp;the&nbsp;byte&nbsp;if&nbsp;we&#39;re&nbsp;about&nbsp;to&nbsp;return&nbsp;and&nbsp;we&#39;re&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4924911">//&nbsp;reading&nbsp;all&nbsp;of&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4924936">if</span>&nbsp;<span class="ident" id="4924939">i</span>&nbsp;<span class="op" id="4924941">!=</span>&nbsp;<span class="num" id="4924944">3</span>&nbsp;<span class="op" id="4924946">||</span>&nbsp;<span class="ident" id="4924949">shift</span>&nbsp;<span class="op" id="4924955">==</span>&nbsp;<span class="num" id="4924958">4</span>&nbsp;<span class="op" id="4924960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4924966">buf</span>&nbsp;<span class="op" id="4924970">=</span>&nbsp;<span class="ident" id="4924972">buf</span><span class="op" id="4924975">[</span><span class="op" id="4924976">:</span><span class="ident" id="4924977">l</span><span class="op" id="4924978">-</span><span class="num" id="4924979">1</span><span class="op" id="4924980">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4924985">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4924989">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4924993">ret</span>&nbsp;<span class="op" id="4924997">|=</span>&nbsp;<span class="builtintype" id="4925000">uint32</span><span class="op" id="4925006">(</span><span class="ident" id="4925007">b</span><span class="op" id="4925008">)</span>&nbsp;<span class="op" id="4925010">&lt;&lt;</span>&nbsp;<span class="op" id="4925013">(</span><span class="num" id="4925014">8</span>&nbsp;<span class="op" id="4925016">*</span>&nbsp;<span class="ident" id="4925018">i</span><span class="op" id="4925019">)</span>&nbsp;<span class="op" id="4925021">&gt;&gt;</span>&nbsp;<span class="ident" id="4925024">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4925031">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4925034">ret</span>&nbsp;<span class="op" id="4925038">&amp;=</span>&nbsp;<span class="ident" id="4925041">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4925055">return</span>&nbsp;<span class="ident" id="4925062">ret</span><span class="op" id="4925065">,</span>&nbsp;<span class="ident" id="4925067">buf</span><br>
<span class="lineno">710</span><span class="op" id="4925071">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4925074">//&nbsp;p224FromBig&nbsp;sets&nbsp;*out&nbsp;=&nbsp;*in.</span><br>
<span class="lineno"></span><span class="keyword" id="4925106">func</span>&nbsp;<span class="ident" id="4925111">p224FromBig</span><span class="op" id="4925122">(</span><span class="ident" id="4925123">out</span>&nbsp;<span class="op" id="4925127">*</span><span class="ident" id="4925128">p224FieldElement</span><span class="op" id="4925144">,</span>&nbsp;<span class="ident" id="4925146">in</span>&nbsp;<span class="op" id="4925149">*</span><span class="ident" id="4925150">big</span><span class="op" id="4925153">.</span><span class="ident" id="4925154">Int</span><span class="op" id="4925157">)</span>&nbsp;<span class="op" id="4925159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4925162">bytes</span>&nbsp;<span class="op" id="4925168">:=</span>&nbsp;<span class="ident" id="4925171">in</span><span class="op" id="4925173">.</span><span class="ident" id="4925174">Bytes</span><span class="op" id="4925179">(</span><span class="op" id="4925180">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4925183">out</span><span class="op" id="4925186">[</span><span class="num" id="4925187">0</span><span class="op" id="4925188">]</span><span class="op" id="4925189">,</span>&nbsp;<span class="ident" id="4925191">bytes</span>&nbsp;<span class="op" id="4925197">=</span>&nbsp;<span class="ident" id="4925199">get28BitsFromEnd</span><span class="op" id="4925215">(</span><span class="ident" id="4925216">bytes</span><span class="op" id="4925221">,</span>&nbsp;<span class="num" id="4925223">0</span><span class="op" id="4925224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4925227">out</span><span class="op" id="4925230">[</span><span class="num" id="4925231">1</span><span class="op" id="4925232">]</span><span class="op" id="4925233">,</span>&nbsp;<span class="ident" id="4925235">bytes</span>&nbsp;<span class="op" id="4925241">=</span>&nbsp;<span class="ident" id="4925243">get28BitsFromEnd</span><span class="op" id="4925259">(</span><span class="ident" id="4925260">bytes</span><span class="op" id="4925265">,</span>&nbsp;<span class="num" id="4925267">4</span><span class="op" id="4925268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4925271">out</span><span class="op" id="4925274">[</span><span class="num" id="4925275">2</span><span class="op" id="4925276">]</span><span class="op" id="4925277">,</span>&nbsp;<span class="ident" id="4925279">bytes</span>&nbsp;<span class="op" id="4925285">=</span>&nbsp;<span class="ident" id="4925287">get28BitsFromEnd</span><span class="op" id="4925303">(</span><span class="ident" id="4925304">bytes</span><span class="op" id="4925309">,</span>&nbsp;<span class="num" id="4925311">0</span><span class="op" id="4925312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4925315">out</span><span class="op" id="4925318">[</span><span class="num" id="4925319">3</span><span class="op" id="4925320">]</span><span class="op" id="4925321">,</span>&nbsp;<span class="ident" id="4925323">bytes</span>&nbsp;<span class="op" id="4925329">=</span>&nbsp;<span class="ident" id="4925331">get28BitsFromEnd</span><span class="op" id="4925347">(</span><span class="ident" id="4925348">bytes</span><span class="op" id="4925353">,</span>&nbsp;<span class="num" id="4925355">4</span><span class="op" id="4925356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4925359">out</span><span class="op" id="4925362">[</span><span class="num" id="4925363">4</span><span class="op" id="4925364">]</span><span class="op" id="4925365">,</span>&nbsp;<span class="ident" id="4925367">bytes</span>&nbsp;<span class="op" id="4925373">=</span>&nbsp;<span class="ident" id="4925375">get28BitsFromEnd</span><span class="op" id="4925391">(</span><span class="ident" id="4925392">bytes</span><span class="op" id="4925397">,</span>&nbsp;<span class="num" id="4925399">0</span><span class="op" id="4925400">)</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4925403">out</span><span class="op" id="4925406">[</span><span class="num" id="4925407">5</span><span class="op" id="4925408">]</span><span class="op" id="4925409">,</span>&nbsp;<span class="ident" id="4925411">bytes</span>&nbsp;<span class="op" id="4925417">=</span>&nbsp;<span class="ident" id="4925419">get28BitsFromEnd</span><span class="op" id="4925435">(</span><span class="ident" id="4925436">bytes</span><span class="op" id="4925441">,</span>&nbsp;<span class="num" id="4925443">4</span><span class="op" id="4925444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4925447">out</span><span class="op" id="4925450">[</span><span class="num" id="4925451">6</span><span class="op" id="4925452">]</span><span class="op" id="4925453">,</span>&nbsp;<span class="ident" id="4925455">bytes</span>&nbsp;<span class="op" id="4925461">=</span>&nbsp;<span class="ident" id="4925463">get28BitsFromEnd</span><span class="op" id="4925479">(</span><span class="ident" id="4925480">bytes</span><span class="op" id="4925485">,</span>&nbsp;<span class="num" id="4925487">0</span><span class="op" id="4925488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4925491">out</span><span class="op" id="4925494">[</span><span class="num" id="4925495">7</span><span class="op" id="4925496">]</span><span class="op" id="4925497">,</span>&nbsp;<span class="ident" id="4925499">bytes</span>&nbsp;<span class="op" id="4925505">=</span>&nbsp;<span class="ident" id="4925507">get28BitsFromEnd</span><span class="op" id="4925523">(</span><span class="ident" id="4925524">bytes</span><span class="op" id="4925529">,</span>&nbsp;<span class="num" id="4925531">4</span><span class="op" id="4925532">)</span><br>
<span class="lineno"></span><span class="op" id="4925534">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">725</span><span class="comment" id="4925537">//&nbsp;p224ToBig&nbsp;returns&nbsp;in&nbsp;as&nbsp;a&nbsp;big.Int.</span><br>
<span class="lineno"></span><span class="keyword" id="4925575">func</span>&nbsp;<span class="ident" id="4925580">p224ToBig</span><span class="op" id="4925589">(</span><span class="ident" id="4925590">in</span>&nbsp;<span class="op" id="4925593">*</span><span class="ident" id="4925594">p224FieldElement</span><span class="op" id="4925610">)</span>&nbsp;<span class="op" id="4925612">*</span><span class="ident" id="4925613">big</span><span class="op" id="4925616">.</span><span class="ident" id="4925617">Int</span>&nbsp;<span class="op" id="4925621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4925624">var</span>&nbsp;<span class="ident" id="4925628">buf</span>&nbsp;<span class="op" id="4925632">[</span><span class="num" id="4925633">28</span><span class="op" id="4925635">]</span><span class="builtintype" id="4925636">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4925642">buf</span><span class="op" id="4925645">[</span><span class="num" id="4925646">27</span><span class="op" id="4925648">]</span>&nbsp;<span class="op" id="4925650">=</span>&nbsp;<span class="builtintype" id="4925652">byte</span><span class="op" id="4925656">(</span><span class="ident" id="4925657">in</span><span class="op" id="4925659">[</span><span class="num" id="4925660">0</span><span class="op" id="4925661">]</span><span class="op" id="4925662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4925665">buf</span><span class="op" id="4925668">[</span><span class="num" id="4925669">26</span><span class="op" id="4925671">]</span>&nbsp;<span class="op" id="4925673">=</span>&nbsp;<span class="builtintype" id="4925675">byte</span><span class="op" id="4925679">(</span><span class="ident" id="4925680">in</span><span class="op" id="4925682">[</span><span class="num" id="4925683">0</span><span class="op" id="4925684">]</span>&nbsp;<span class="op" id="4925686">&gt;&gt;</span>&nbsp;<span class="num" id="4925689">8</span><span class="op" id="4925690">)</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4925693">buf</span><span class="op" id="4925696">[</span><span class="num" id="4925697">25</span><span class="op" id="4925699">]</span>&nbsp;<span class="op" id="4925701">=</span>&nbsp;<span class="builtintype" id="4925703">byte</span><span class="op" id="4925707">(</span><span class="ident" id="4925708">in</span><span class="op" id="4925710">[</span><span class="num" id="4925711">0</span><span class="op" id="4925712">]</span>&nbsp;<span class="op" id="4925714">&gt;&gt;</span>&nbsp;<span class="num" id="4925717">16</span><span class="op" id="4925719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4925722">buf</span><span class="op" id="4925725">[</span><span class="num" id="4925726">24</span><span class="op" id="4925728">]</span>&nbsp;<span class="op" id="4925730">=</span>&nbsp;<span class="builtintype" id="4925732">byte</span><span class="op" id="4925736">(</span><span class="op" id="4925737">(</span><span class="op" id="4925738">(</span><span class="ident" id="4925739">in</span><span class="op" id="4925741">[</span><span class="num" id="4925742">0</span><span class="op" id="4925743">]</span>&nbsp;<span class="op" id="4925745">&gt;&gt;</span>&nbsp;<span class="num" id="4925748">24</span><span class="op" id="4925750">)</span>&nbsp;<span class="op" id="4925752">&amp;</span>&nbsp;<span class="num" id="4925754">0x0f</span><span class="op" id="4925758">)</span>&nbsp;<span class="op" id="4925760">|</span>&nbsp;<span class="op" id="4925762">(</span><span class="ident" id="4925763">in</span><span class="op" id="4925765">[</span><span class="num" id="4925766">1</span><span class="op" id="4925767">]</span><span class="op" id="4925768">&lt;&lt;</span><span class="num" id="4925770">4</span><span class="op" id="4925771">)</span><span class="op" id="4925772">&amp;</span><span class="num" id="4925773">0xf0</span><span class="op" id="4925777">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4925781">buf</span><span class="op" id="4925784">[</span><span class="num" id="4925785">23</span><span class="op" id="4925787">]</span>&nbsp;<span class="op" id="4925789">=</span>&nbsp;<span class="builtintype" id="4925791">byte</span><span class="op" id="4925795">(</span><span class="ident" id="4925796">in</span><span class="op" id="4925798">[</span><span class="num" id="4925799">1</span><span class="op" id="4925800">]</span>&nbsp;<span class="op" id="4925802">&gt;&gt;</span>&nbsp;<span class="num" id="4925805">4</span><span class="op" id="4925806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4925809">buf</span><span class="op" id="4925812">[</span><span class="num" id="4925813">22</span><span class="op" id="4925815">]</span>&nbsp;<span class="op" id="4925817">=</span>&nbsp;<span class="builtintype" id="4925819">byte</span><span class="op" id="4925823">(</span><span class="ident" id="4925824">in</span><span class="op" id="4925826">[</span><span class="num" id="4925827">1</span><span class="op" id="4925828">]</span>&nbsp;<span class="op" id="4925830">&gt;&gt;</span>&nbsp;<span class="num" id="4925833">12</span><span class="op" id="4925835">)</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4925838">buf</span><span class="op" id="4925841">[</span><span class="num" id="4925842">21</span><span class="op" id="4925844">]</span>&nbsp;<span class="op" id="4925846">=</span>&nbsp;<span class="builtintype" id="4925848">byte</span><span class="op" id="4925852">(</span><span class="ident" id="4925853">in</span><span class="op" id="4925855">[</span><span class="num" id="4925856">1</span><span class="op" id="4925857">]</span>&nbsp;<span class="op" id="4925859">&gt;&gt;</span>&nbsp;<span class="num" id="4925862">20</span><span class="op" id="4925864">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4925868">buf</span><span class="op" id="4925871">[</span><span class="num" id="4925872">20</span><span class="op" id="4925874">]</span>&nbsp;<span class="op" id="4925876">=</span>&nbsp;<span class="builtintype" id="4925878">byte</span><span class="op" id="4925882">(</span><span class="ident" id="4925883">in</span><span class="op" id="4925885">[</span><span class="num" id="4925886">2</span><span class="op" id="4925887">]</span><span class="op" id="4925888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4925891">buf</span><span class="op" id="4925894">[</span><span class="num" id="4925895">19</span><span class="op" id="4925897">]</span>&nbsp;<span class="op" id="4925899">=</span>&nbsp;<span class="builtintype" id="4925901">byte</span><span class="op" id="4925905">(</span><span class="ident" id="4925906">in</span><span class="op" id="4925908">[</span><span class="num" id="4925909">2</span><span class="op" id="4925910">]</span>&nbsp;<span class="op" id="4925912">&gt;&gt;</span>&nbsp;<span class="num" id="4925915">8</span><span class="op" id="4925916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4925919">buf</span><span class="op" id="4925922">[</span><span class="num" id="4925923">18</span><span class="op" id="4925925">]</span>&nbsp;<span class="op" id="4925927">=</span>&nbsp;<span class="builtintype" id="4925929">byte</span><span class="op" id="4925933">(</span><span class="ident" id="4925934">in</span><span class="op" id="4925936">[</span><span class="num" id="4925937">2</span><span class="op" id="4925938">]</span>&nbsp;<span class="op" id="4925940">&gt;&gt;</span>&nbsp;<span class="num" id="4925943">16</span><span class="op" id="4925945">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4925948">buf</span><span class="op" id="4925951">[</span><span class="num" id="4925952">17</span><span class="op" id="4925954">]</span>&nbsp;<span class="op" id="4925956">=</span>&nbsp;<span class="builtintype" id="4925958">byte</span><span class="op" id="4925962">(</span><span class="op" id="4925963">(</span><span class="op" id="4925964">(</span><span class="ident" id="4925965">in</span><span class="op" id="4925967">[</span><span class="num" id="4925968">2</span><span class="op" id="4925969">]</span>&nbsp;<span class="op" id="4925971">&gt;&gt;</span>&nbsp;<span class="num" id="4925974">24</span><span class="op" id="4925976">)</span>&nbsp;<span class="op" id="4925978">&amp;</span>&nbsp;<span class="num" id="4925980">0x0f</span><span class="op" id="4925984">)</span>&nbsp;<span class="op" id="4925986">|</span>&nbsp;<span class="op" id="4925988">(</span><span class="ident" id="4925989">in</span><span class="op" id="4925991">[</span><span class="num" id="4925992">3</span><span class="op" id="4925993">]</span><span class="op" id="4925994">&lt;&lt;</span><span class="num" id="4925996">4</span><span class="op" id="4925997">)</span><span class="op" id="4925998">&amp;</span><span class="num" id="4925999">0xf0</span><span class="op" id="4926003">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4926007">buf</span><span class="op" id="4926010">[</span><span class="num" id="4926011">16</span><span class="op" id="4926013">]</span>&nbsp;<span class="op" id="4926015">=</span>&nbsp;<span class="builtintype" id="4926017">byte</span><span class="op" id="4926021">(</span><span class="ident" id="4926022">in</span><span class="op" id="4926024">[</span><span class="num" id="4926025">3</span><span class="op" id="4926026">]</span>&nbsp;<span class="op" id="4926028">&gt;&gt;</span>&nbsp;<span class="num" id="4926031">4</span><span class="op" id="4926032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4926035">buf</span><span class="op" id="4926038">[</span><span class="num" id="4926039">15</span><span class="op" id="4926041">]</span>&nbsp;<span class="op" id="4926043">=</span>&nbsp;<span class="builtintype" id="4926045">byte</span><span class="op" id="4926049">(</span><span class="ident" id="4926050">in</span><span class="op" id="4926052">[</span><span class="num" id="4926053">3</span><span class="op" id="4926054">]</span>&nbsp;<span class="op" id="4926056">&gt;&gt;</span>&nbsp;<span class="num" id="4926059">12</span><span class="op" id="4926061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4926064">buf</span><span class="op" id="4926067">[</span><span class="num" id="4926068">14</span><span class="op" id="4926070">]</span>&nbsp;<span class="op" id="4926072">=</span>&nbsp;<span class="builtintype" id="4926074">byte</span><span class="op" id="4926078">(</span><span class="ident" id="4926079">in</span><span class="op" id="4926081">[</span><span class="num" id="4926082">3</span><span class="op" id="4926083">]</span>&nbsp;<span class="op" id="4926085">&gt;&gt;</span>&nbsp;<span class="num" id="4926088">20</span><span class="op" id="4926090">)</span><br>
<span class="lineno">745</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4926094">buf</span><span class="op" id="4926097">[</span><span class="num" id="4926098">13</span><span class="op" id="4926100">]</span>&nbsp;<span class="op" id="4926102">=</span>&nbsp;<span class="builtintype" id="4926104">byte</span><span class="op" id="4926108">(</span><span class="ident" id="4926109">in</span><span class="op" id="4926111">[</span><span class="num" id="4926112">4</span><span class="op" id="4926113">]</span><span class="op" id="4926114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4926117">buf</span><span class="op" id="4926120">[</span><span class="num" id="4926121">12</span><span class="op" id="4926123">]</span>&nbsp;<span class="op" id="4926125">=</span>&nbsp;<span class="builtintype" id="4926127">byte</span><span class="op" id="4926131">(</span><span class="ident" id="4926132">in</span><span class="op" id="4926134">[</span><span class="num" id="4926135">4</span><span class="op" id="4926136">]</span>&nbsp;<span class="op" id="4926138">&gt;&gt;</span>&nbsp;<span class="num" id="4926141">8</span><span class="op" id="4926142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4926145">buf</span><span class="op" id="4926148">[</span><span class="num" id="4926149">11</span><span class="op" id="4926151">]</span>&nbsp;<span class="op" id="4926153">=</span>&nbsp;<span class="builtintype" id="4926155">byte</span><span class="op" id="4926159">(</span><span class="ident" id="4926160">in</span><span class="op" id="4926162">[</span><span class="num" id="4926163">4</span><span class="op" id="4926164">]</span>&nbsp;<span class="op" id="4926166">&gt;&gt;</span>&nbsp;<span class="num" id="4926169">16</span><span class="op" id="4926171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4926174">buf</span><span class="op" id="4926177">[</span><span class="num" id="4926178">10</span><span class="op" id="4926180">]</span>&nbsp;<span class="op" id="4926182">=</span>&nbsp;<span class="builtintype" id="4926184">byte</span><span class="op" id="4926188">(</span><span class="op" id="4926189">(</span><span class="op" id="4926190">(</span><span class="ident" id="4926191">in</span><span class="op" id="4926193">[</span><span class="num" id="4926194">4</span><span class="op" id="4926195">]</span>&nbsp;<span class="op" id="4926197">&gt;&gt;</span>&nbsp;<span class="num" id="4926200">24</span><span class="op" id="4926202">)</span>&nbsp;<span class="op" id="4926204">&amp;</span>&nbsp;<span class="num" id="4926206">0x0f</span><span class="op" id="4926210">)</span>&nbsp;<span class="op" id="4926212">|</span>&nbsp;<span class="op" id="4926214">(</span><span class="ident" id="4926215">in</span><span class="op" id="4926217">[</span><span class="num" id="4926218">5</span><span class="op" id="4926219">]</span><span class="op" id="4926220">&lt;&lt;</span><span class="num" id="4926222">4</span><span class="op" id="4926223">)</span><span class="op" id="4926224">&amp;</span><span class="num" id="4926225">0xf0</span><span class="op" id="4926229">)</span><br>
<span class="lineno">750</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4926233">buf</span><span class="op" id="4926236">[</span><span class="num" id="4926237">9</span><span class="op" id="4926238">]</span>&nbsp;<span class="op" id="4926240">=</span>&nbsp;<span class="builtintype" id="4926242">byte</span><span class="op" id="4926246">(</span><span class="ident" id="4926247">in</span><span class="op" id="4926249">[</span><span class="num" id="4926250">5</span><span class="op" id="4926251">]</span>&nbsp;<span class="op" id="4926253">&gt;&gt;</span>&nbsp;<span class="num" id="4926256">4</span><span class="op" id="4926257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4926260">buf</span><span class="op" id="4926263">[</span><span class="num" id="4926264">8</span><span class="op" id="4926265">]</span>&nbsp;<span class="op" id="4926267">=</span>&nbsp;<span class="builtintype" id="4926269">byte</span><span class="op" id="4926273">(</span><span class="ident" id="4926274">in</span><span class="op" id="4926276">[</span><span class="num" id="4926277">5</span><span class="op" id="4926278">]</span>&nbsp;<span class="op" id="4926280">&gt;&gt;</span>&nbsp;<span class="num" id="4926283">12</span><span class="op" id="4926285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4926288">buf</span><span class="op" id="4926291">[</span><span class="num" id="4926292">7</span><span class="op" id="4926293">]</span>&nbsp;<span class="op" id="4926295">=</span>&nbsp;<span class="builtintype" id="4926297">byte</span><span class="op" id="4926301">(</span><span class="ident" id="4926302">in</span><span class="op" id="4926304">[</span><span class="num" id="4926305">5</span><span class="op" id="4926306">]</span>&nbsp;<span class="op" id="4926308">&gt;&gt;</span>&nbsp;<span class="num" id="4926311">20</span><span class="op" id="4926313">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4926317">buf</span><span class="op" id="4926320">[</span><span class="num" id="4926321">6</span><span class="op" id="4926322">]</span>&nbsp;<span class="op" id="4926324">=</span>&nbsp;<span class="builtintype" id="4926326">byte</span><span class="op" id="4926330">(</span><span class="ident" id="4926331">in</span><span class="op" id="4926333">[</span><span class="num" id="4926334">6</span><span class="op" id="4926335">]</span><span class="op" id="4926336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4926339">buf</span><span class="op" id="4926342">[</span><span class="num" id="4926343">5</span><span class="op" id="4926344">]</span>&nbsp;<span class="op" id="4926346">=</span>&nbsp;<span class="builtintype" id="4926348">byte</span><span class="op" id="4926352">(</span><span class="ident" id="4926353">in</span><span class="op" id="4926355">[</span><span class="num" id="4926356">6</span><span class="op" id="4926357">]</span>&nbsp;<span class="op" id="4926359">&gt;&gt;</span>&nbsp;<span class="num" id="4926362">8</span><span class="op" id="4926363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4926366">buf</span><span class="op" id="4926369">[</span><span class="num" id="4926370">4</span><span class="op" id="4926371">]</span>&nbsp;<span class="op" id="4926373">=</span>&nbsp;<span class="builtintype" id="4926375">byte</span><span class="op" id="4926379">(</span><span class="ident" id="4926380">in</span><span class="op" id="4926382">[</span><span class="num" id="4926383">6</span><span class="op" id="4926384">]</span>&nbsp;<span class="op" id="4926386">&gt;&gt;</span>&nbsp;<span class="num" id="4926389">16</span><span class="op" id="4926391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4926394">buf</span><span class="op" id="4926397">[</span><span class="num" id="4926398">3</span><span class="op" id="4926399">]</span>&nbsp;<span class="op" id="4926401">=</span>&nbsp;<span class="builtintype" id="4926403">byte</span><span class="op" id="4926407">(</span><span class="op" id="4926408">(</span><span class="op" id="4926409">(</span><span class="ident" id="4926410">in</span><span class="op" id="4926412">[</span><span class="num" id="4926413">6</span><span class="op" id="4926414">]</span>&nbsp;<span class="op" id="4926416">&gt;&gt;</span>&nbsp;<span class="num" id="4926419">24</span><span class="op" id="4926421">)</span>&nbsp;<span class="op" id="4926423">&amp;</span>&nbsp;<span class="num" id="4926425">0x0f</span><span class="op" id="4926429">)</span>&nbsp;<span class="op" id="4926431">|</span>&nbsp;<span class="op" id="4926433">(</span><span class="ident" id="4926434">in</span><span class="op" id="4926436">[</span><span class="num" id="4926437">7</span><span class="op" id="4926438">]</span><span class="op" id="4926439">&lt;&lt;</span><span class="num" id="4926441">4</span><span class="op" id="4926442">)</span><span class="op" id="4926443">&amp;</span><span class="num" id="4926444">0xf0</span><span class="op" id="4926448">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4926452">buf</span><span class="op" id="4926455">[</span><span class="num" id="4926456">2</span><span class="op" id="4926457">]</span>&nbsp;<span class="op" id="4926459">=</span>&nbsp;<span class="builtintype" id="4926461">byte</span><span class="op" id="4926465">(</span><span class="ident" id="4926466">in</span><span class="op" id="4926468">[</span><span class="num" id="4926469">7</span><span class="op" id="4926470">]</span>&nbsp;<span class="op" id="4926472">&gt;&gt;</span>&nbsp;<span class="num" id="4926475">4</span><span class="op" id="4926476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4926479">buf</span><span class="op" id="4926482">[</span><span class="num" id="4926483">1</span><span class="op" id="4926484">]</span>&nbsp;<span class="op" id="4926486">=</span>&nbsp;<span class="builtintype" id="4926488">byte</span><span class="op" id="4926492">(</span><span class="ident" id="4926493">in</span><span class="op" id="4926495">[</span><span class="num" id="4926496">7</span><span class="op" id="4926497">]</span>&nbsp;<span class="op" id="4926499">&gt;&gt;</span>&nbsp;<span class="num" id="4926502">12</span><span class="op" id="4926504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4926507">buf</span><span class="op" id="4926510">[</span><span class="num" id="4926511">0</span><span class="op" id="4926512">]</span>&nbsp;<span class="op" id="4926514">=</span>&nbsp;<span class="builtintype" id="4926516">byte</span><span class="op" id="4926520">(</span><span class="ident" id="4926521">in</span><span class="op" id="4926523">[</span><span class="num" id="4926524">7</span><span class="op" id="4926525">]</span>&nbsp;<span class="op" id="4926527">&gt;&gt;</span>&nbsp;<span class="num" id="4926530">20</span><span class="op" id="4926532">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4926536">return</span>&nbsp;<span class="builtinfunc" id="4926543">new</span><span class="op" id="4926546">(</span><span class="ident" id="4926547">big</span><span class="op" id="4926550">.</span><span class="ident" id="4926551">Int</span><span class="op" id="4926554">)</span><span class="op" id="4926555">.</span><span class="ident" id="4926556">SetBytes</span><span class="op" id="4926564">(</span><span class="ident" id="4926565">buf</span><span class="op" id="4926568">[</span><span class="op" id="4926569">:</span><span class="op" id="4926570">]</span><span class="op" id="4926571">)</span><br>
<span class="lineno">765</span><span class="op" id="4926573">}</span>
</div>
</body>
</html>
