<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math/cmplx</h2>
<ul>
<li><a href="/gostd/math/cmplx/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/cmplx/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/cmplx/cmath_test.go.html">cmath_test.go</a></li>
<li><a href="/gostd/math/cmplx/conj.go.html">conj.go</a></li>
<li><a href="/gostd/math/cmplx/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/cmplx/isinf.go.html">isinf.go</a></li>
<li><a href="/gostd/math/cmplx/isnan.go.html">isnan.go</a></li>
<li><a href="/gostd/math/cmplx/log.go.html">log.go</a></li>
<li><a href="/gostd/math/cmplx/phase.go.html">phase.go</a></li>
<li><a href="/gostd/math/cmplx/polar.go.html">polar.go</a></li>
<li><a href="/gostd/math/cmplx/pow.go.html" class="current">pow.go</a></li>
<li><a href="/gostd/math/cmplx/rect.go.html">rect.go</a></li>
<li><a href="/gostd/math/cmplx/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/cmplx/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/cmplx/tan.go.html">tan.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6069197">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6069252">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6069306">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6069357">package</span>&nbsp;<span class="ident" id="6069365">cmplx</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6069372">import</span>&nbsp;<span class="string" id="6069379">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6069387">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno">10</span><span class="comment" id="6069447">//&nbsp;below&nbsp;are&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/c9x-complex/clog.c.</span><br>
<span class="lineno"></span><span class="comment" id="6069517">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno"></span><span class="comment" id="6069575">//</span><br>
<span class="lineno"></span><span class="comment" id="6069578">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno"></span><span class="comment" id="6069626">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">15</span><span class="comment" id="6069690">//</span><br>
<span class="lineno"></span><span class="comment" id="6069693">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="6069754">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="6069824">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno"></span><span class="comment" id="6069899">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno">20</span><span class="comment" id="6069966">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="6070039">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="6070111">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="6070125">//</span><br>
<span class="lineno"></span><span class="comment" id="6070128">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno">25</span><span class="comment" id="6070194">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="6070260">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="6070273">//</span><br>
<span class="lineno"></span><span class="comment" id="6070276">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="6070300">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="6070330">//&nbsp;Complex&nbsp;power&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="6070356">//</span><br>
<span class="lineno"></span><span class="comment" id="6070359">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="6070375">//</span><br>
<span class="lineno">35</span><span class="comment" id="6070378">//&nbsp;Raises&nbsp;complex&nbsp;A&nbsp;to&nbsp;the&nbsp;complex&nbsp;Zth&nbsp;power.</span><br>
<span class="lineno"></span><span class="comment" id="6070424">//&nbsp;Definition&nbsp;is&nbsp;per&nbsp;AMS55&nbsp;#&nbsp;4.2.8,</span><br>
<span class="lineno"></span><span class="comment" id="6070460">//&nbsp;analytically&nbsp;equivalent&nbsp;to&nbsp;cpow(a,z)&nbsp;=&nbsp;cexp(z&nbsp;clog(a)).</span><br>
<span class="lineno"></span><span class="comment" id="6070519">//</span><br>
<span class="lineno"></span><span class="comment" id="6070522">//&nbsp;ACCURACY:</span><br>
<span class="lineno">40</span><span class="comment" id="6070535">//</span><br>
<span class="lineno"></span><span class="comment" id="6070538">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="6070578">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno"></span><span class="comment" id="6070636">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9.4e-15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.5e-15</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="6070697">//&nbsp;Pow&nbsp;returns&nbsp;x**y,&nbsp;the&nbsp;base-x&nbsp;exponential&nbsp;of&nbsp;y.</span><br>
<span class="lineno"></span><span class="comment" id="6070747">//&nbsp;For&nbsp;generalized&nbsp;compatibility&nbsp;with&nbsp;math.Pow:</span><br>
<span class="lineno"></span><span class="comment" id="6070795">//&nbsp;&nbsp;&nbsp;&nbsp;Pow(0,&nbsp;Â±0)&nbsp;returns&nbsp;1+0i</span><br>
<span class="lineno"></span><span class="comment" id="6070823">//&nbsp;&nbsp;&nbsp;&nbsp;Pow(0,&nbsp;c)&nbsp;for&nbsp;real(c)&lt;0&nbsp;returns&nbsp;Inf+0i&nbsp;if&nbsp;imag(c)&nbsp;is&nbsp;zero,&nbsp;otherwise&nbsp;Inf+Inf&nbsp;i.</span><br>
<span class="lineno"></span><span class="keyword" id="6070906">func</span>&nbsp;<span class="ident" id="6070911">Pow</span><span class="op" id="6070914">(</span><span class="ident" id="6070915">x</span><span class="op" id="6070916">,</span>&nbsp;<span class="ident" id="6070918">y</span>&nbsp;<span class="builtintype" id="6070920">complex128</span><span class="op" id="6070930">)</span>&nbsp;<span class="builtintype" id="6070932">complex128</span>&nbsp;<span class="op" id="6070943">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6070946">if</span>&nbsp;<span class="ident" id="6070949">x</span>&nbsp;<span class="op" id="6070951">==</span>&nbsp;<span class="num" id="6070954">0</span>&nbsp;<span class="op" id="6070956">{</span>&nbsp;<span class="comment" id="6070958">//&nbsp;Guaranteed&nbsp;also&nbsp;true&nbsp;for&nbsp;x&nbsp;==&nbsp;-0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6070997">r</span><span class="op" id="6070998">,</span>&nbsp;<span class="ident" id="6071000">i</span>&nbsp;<span class="op" id="6071002">:=</span>&nbsp;<span class="builtinfunc" id="6071005">real</span><span class="op" id="6071009">(</span><span class="ident" id="6071010">y</span><span class="op" id="6071011">)</span><span class="op" id="6071012">,</span>&nbsp;<span class="builtinfunc" id="6071014">imag</span><span class="op" id="6071018">(</span><span class="ident" id="6071019">y</span><span class="op" id="6071020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6071024">switch</span>&nbsp;<span class="op" id="6071031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6071035">case</span>&nbsp;<span class="ident" id="6071040">r</span>&nbsp;<span class="op" id="6071042">==</span>&nbsp;<span class="num" id="6071045">0</span><span class="op" id="6071046">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6071051">return</span>&nbsp;<span class="num" id="6071058">1</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6071062">case</span>&nbsp;<span class="ident" id="6071067">r</span>&nbsp;<span class="op" id="6071069">&lt;</span>&nbsp;<span class="num" id="6071071">0</span><span class="op" id="6071072">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6071077">if</span>&nbsp;<span class="ident" id="6071080">i</span>&nbsp;<span class="op" id="6071082">==</span>&nbsp;<span class="num" id="6071085">0</span>&nbsp;<span class="op" id="6071087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6071093">return</span>&nbsp;<span class="builtinfunc" id="6071100">complex</span><span class="op" id="6071107">(</span><span class="ident" id="6071108">math</span><span class="op" id="6071112">.</span><span class="ident" id="6071113">Inf</span><span class="op" id="6071116">(</span><span class="num" id="6071117">1</span><span class="op" id="6071118">)</span><span class="op" id="6071119">,</span>&nbsp;<span class="num" id="6071121">0</span><span class="op" id="6071122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6071127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6071132">return</span>&nbsp;<span class="ident" id="6071139">Inf</span><span class="op" id="6071142">(</span><span class="op" id="6071143">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6071147">case</span>&nbsp;<span class="ident" id="6071152">r</span>&nbsp;<span class="op" id="6071154">&gt;</span>&nbsp;<span class="num" id="6071156">0</span><span class="op" id="6071157">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6071162">return</span>&nbsp;<span class="num" id="6071169">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6071173">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="6071177">panic</span><span class="op" id="6071182">(</span><span class="string" id="6071183">&#34;not&nbsp;reached&#34;</span><span class="op" id="6071196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6071199">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6071202">modulus</span>&nbsp;<span class="op" id="6071210">:=</span>&nbsp;<span class="ident" id="6071213">Abs</span><span class="op" id="6071216">(</span><span class="ident" id="6071217">x</span><span class="op" id="6071218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6071221">if</span>&nbsp;<span class="ident" id="6071224">modulus</span>&nbsp;<span class="op" id="6071232">==</span>&nbsp;<span class="num" id="6071235">0</span>&nbsp;<span class="op" id="6071237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6071241">return</span>&nbsp;<span class="builtinfunc" id="6071248">complex</span><span class="op" id="6071255">(</span><span class="num" id="6071256">0</span><span class="op" id="6071257">,</span>&nbsp;<span class="num" id="6071259">0</span><span class="op" id="6071260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6071263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6071266">r</span>&nbsp;<span class="op" id="6071268">:=</span>&nbsp;<span class="ident" id="6071271">math</span><span class="op" id="6071275">.</span><span class="ident" id="6071276">Pow</span><span class="op" id="6071279">(</span><span class="ident" id="6071280">modulus</span><span class="op" id="6071287">,</span>&nbsp;<span class="builtinfunc" id="6071289">real</span><span class="op" id="6071293">(</span><span class="ident" id="6071294">y</span><span class="op" id="6071295">)</span><span class="op" id="6071296">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6071299">arg</span>&nbsp;<span class="op" id="6071303">:=</span>&nbsp;<span class="ident" id="6071306">Phase</span><span class="op" id="6071311">(</span><span class="ident" id="6071312">x</span><span class="op" id="6071313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6071316">theta</span>&nbsp;<span class="op" id="6071322">:=</span>&nbsp;<span class="builtinfunc" id="6071325">real</span><span class="op" id="6071329">(</span><span class="ident" id="6071330">y</span><span class="op" id="6071331">)</span>&nbsp;<span class="op" id="6071333">*</span>&nbsp;<span class="ident" id="6071335">arg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6071340">if</span>&nbsp;<span class="builtinfunc" id="6071343">imag</span><span class="op" id="6071347">(</span><span class="ident" id="6071348">y</span><span class="op" id="6071349">)</span>&nbsp;<span class="op" id="6071351">!=</span>&nbsp;<span class="num" id="6071354">0</span>&nbsp;<span class="op" id="6071356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6071360">r</span>&nbsp;<span class="op" id="6071362">*=</span>&nbsp;<span class="ident" id="6071365">math</span><span class="op" id="6071369">.</span><span class="ident" id="6071370">Exp</span><span class="op" id="6071373">(</span><span class="op" id="6071374">-</span><span class="builtinfunc" id="6071375">imag</span><span class="op" id="6071379">(</span><span class="ident" id="6071380">y</span><span class="op" id="6071381">)</span>&nbsp;<span class="op" id="6071383">*</span>&nbsp;<span class="ident" id="6071385">arg</span><span class="op" id="6071388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6071392">theta</span>&nbsp;<span class="op" id="6071398">+=</span>&nbsp;<span class="builtinfunc" id="6071401">imag</span><span class="op" id="6071405">(</span><span class="ident" id="6071406">y</span><span class="op" id="6071407">)</span>&nbsp;<span class="op" id="6071409">*</span>&nbsp;<span class="ident" id="6071411">math</span><span class="op" id="6071415">.</span><span class="ident" id="6071416">Log</span><span class="op" id="6071419">(</span><span class="ident" id="6071420">modulus</span><span class="op" id="6071427">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6071430">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6071433">s</span><span class="op" id="6071434">,</span>&nbsp;<span class="ident" id="6071436">c</span>&nbsp;<span class="op" id="6071438">:=</span>&nbsp;<span class="ident" id="6071441">math</span><span class="op" id="6071445">.</span><span class="ident" id="6071446">Sincos</span><span class="op" id="6071452">(</span><span class="ident" id="6071453">theta</span><span class="op" id="6071458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6071461">return</span>&nbsp;<span class="builtinfunc" id="6071468">complex</span><span class="op" id="6071475">(</span><span class="ident" id="6071476">r</span><span class="op" id="6071477">*</span><span class="ident" id="6071478">c</span><span class="op" id="6071479">,</span>&nbsp;<span class="ident" id="6071481">r</span><span class="op" id="6071482">*</span><span class="ident" id="6071483">s</span><span class="op" id="6071484">)</span><br>
<span class="lineno"></span><span class="op" id="6071486">}</span>
</div>
</body>
</html>
