<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html" class="current">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2126940">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2126995">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2127049">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2127100">package</span>&nbsp;<span class="ident" id="2127108">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2127114">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;Floating-point&nbsp;logarithm&nbsp;of&nbsp;the&nbsp;Gamma&nbsp;function.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2127170">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code&nbsp;and&nbsp;the&nbsp;long&nbsp;comment&nbsp;below&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="2127224">//&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/e_lgamma_r.c&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2127281">//&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="2127336">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="2127366">//</span><br>
<span class="lineno"></span><span class="comment" id="2127369">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2127425">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2127494">//</span><br>
<span class="lineno"></span><span class="comment" id="2127497">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno">20</span><span class="comment" id="2127556">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2127612">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="2127669">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="2127686">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2127742">//</span><br>
<span class="lineno">25</span><span class="comment" id="2127745">//&nbsp;__ieee754_lgamma_r(x,&nbsp;signgamp)</span><br>
<span class="lineno"></span><span class="comment" id="2127780">//&nbsp;Reentrant&nbsp;version&nbsp;of&nbsp;the&nbsp;logarithm&nbsp;of&nbsp;the&nbsp;Gamma&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="2127840">//&nbsp;with&nbsp;user&nbsp;provided&nbsp;pointer&nbsp;for&nbsp;the&nbsp;sign&nbsp;of&nbsp;Gamma(x).</span><br>
<span class="lineno"></span><span class="comment" id="2127896">//</span><br>
<span class="lineno"></span><span class="comment" id="2127899">//&nbsp;Method:</span><br>
<span class="lineno">30</span><span class="comment" id="2127910">//&nbsp;&nbsp;&nbsp;1.&nbsp;Argument&nbsp;Reduction&nbsp;for&nbsp;0&nbsp;&lt;&nbsp;x&nbsp;&lt;=&nbsp;8</span><br>
<span class="lineno"></span><span class="comment" id="2127952">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Since&nbsp;gamma(1+s)=s*gamma(s),&nbsp;for&nbsp;x&nbsp;in&nbsp;[0,8],&nbsp;we&nbsp;may</span><br>
<span class="lineno"></span><span class="comment" id="2128012">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reduce&nbsp;x&nbsp;to&nbsp;a&nbsp;number&nbsp;in&nbsp;[1.5,2.5]&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2128057">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(1+s)&nbsp;=&nbsp;log(s)&nbsp;+&nbsp;lgamma(s)</span><br>
<span class="lineno"></span><span class="comment" id="2128106">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;example,</span><br>
<span class="lineno">35</span><span class="comment" id="2128127">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(7.3)&nbsp;=&nbsp;log(6.3)&nbsp;+&nbsp;lgamma(6.3)</span><br>
<span class="lineno"></span><span class="comment" id="2128180">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;log(6.3*5.3)&nbsp;+&nbsp;lgamma(5.3)</span><br>
<span class="lineno"></span><span class="comment" id="2128237">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;log(6.3*5.3*4.3*3.3*2.3)&nbsp;+&nbsp;lgamma(2.3)</span><br>
<span class="lineno"></span><span class="comment" id="2128306">//&nbsp;&nbsp;&nbsp;2.&nbsp;Polynomial&nbsp;approximation&nbsp;of&nbsp;lgamma&nbsp;around&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="2128360">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minimum&nbsp;(ymin=1.461632144968362245)&nbsp;to&nbsp;maintain&nbsp;monotonicity.</span><br>
<span class="lineno">40</span><span class="comment" id="2128430">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;On&nbsp;[ymin-0.23,&nbsp;ymin+0.27]&nbsp;(i.e.,&nbsp;[1.23164,1.73163]),&nbsp;use</span><br>
<span class="lineno"></span><span class="comment" id="2128495">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;z&nbsp;=&nbsp;x-ymin;</span><br>
<span class="lineno"></span><span class="comment" id="2128527">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;=&nbsp;-1.214862905358496078218&nbsp;+&nbsp;z**2*poly(z)</span><br>
<span class="lineno"></span><span class="comment" id="2128595">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;poly(z)&nbsp;is&nbsp;a&nbsp;14&nbsp;degree&nbsp;polynomial.</span><br>
<span class="lineno"></span><span class="comment" id="2128646">//&nbsp;&nbsp;&nbsp;2.&nbsp;Rational&nbsp;approximation&nbsp;in&nbsp;the&nbsp;primary&nbsp;interval&nbsp;[2,3]</span><br>
<span class="lineno">45</span><span class="comment" id="2128707">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;use&nbsp;the&nbsp;following&nbsp;approximation:</span><br>
<span class="lineno"></span><span class="comment" id="2128751">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s&nbsp;=&nbsp;x-2.0;</span><br>
<span class="lineno"></span><span class="comment" id="2128778">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;=&nbsp;0.5*s&nbsp;+&nbsp;s*P(s)/Q(s)</span><br>
<span class="lineno"></span><span class="comment" id="2128826">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;accuracy</span><br>
<span class="lineno"></span><span class="comment" id="2128848">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|P/Q&nbsp;-&nbsp;(lgamma(x)-0.5s)|&nbsp;&lt;&nbsp;2**-61.71</span><br>
<span class="lineno">50</span><span class="comment" id="2128901">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Our&nbsp;algorithms&nbsp;are&nbsp;based&nbsp;on&nbsp;the&nbsp;following&nbsp;observation</span><br>
<span class="lineno"></span><span class="comment" id="2128963">//</span><br>
<span class="lineno"></span><span class="comment" id="2128966">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zeta(2)-1&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;zeta(3)-1&nbsp;&nbsp;&nbsp;&nbsp;3</span><br>
<span class="lineno"></span><span class="comment" id="2129030">//&nbsp;lgamma(2+s)&nbsp;=&nbsp;s*(1-Euler)&nbsp;+&nbsp;---------&nbsp;*&nbsp;s&nbsp;&nbsp;-&nbsp;&nbsp;---------&nbsp;*&nbsp;s&nbsp;&nbsp;+&nbsp;...</span><br>
<span class="lineno"></span><span class="comment" id="2129100">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3</span><br>
<span class="lineno">55</span><span class="comment" id="2129155">//</span><br>
<span class="lineno"></span><span class="comment" id="2129158">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;Euler&nbsp;=&nbsp;0.5772156649...&nbsp;is&nbsp;the&nbsp;Euler&nbsp;constant,&nbsp;which</span><br>
<span class="lineno"></span><span class="comment" id="2129225">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;very&nbsp;close&nbsp;to&nbsp;0.5.</span><br>
<span class="lineno"></span><span class="comment" id="2129255">//</span><br>
<span class="lineno"></span><span class="comment" id="2129258">//&nbsp;&nbsp;&nbsp;3.&nbsp;For&nbsp;x&gt;=8,&nbsp;we&nbsp;have</span><br>
<span class="lineno">60</span><span class="comment" id="2129284">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)~(x-0.5)log(x)-x+0.5*log(2pi)+1/(12x)-1/(360x**3)+....</span><br>
<span class="lineno"></span><span class="comment" id="2129356">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(better&nbsp;formula:</span><br>
<span class="lineno"></span><span class="comment" id="2129381">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)~(x-0.5)*(log(x)-1)-.5*(log(2pi)-1)&nbsp;+&nbsp;...)</span><br>
<span class="lineno"></span><span class="comment" id="2129444">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;z&nbsp;=&nbsp;1/x,&nbsp;then&nbsp;we&nbsp;approximation</span><br>
<span class="lineno"></span><span class="comment" id="2129487">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f(z)&nbsp;=&nbsp;lgamma(x)&nbsp;-&nbsp;(x-0.5)(log(x)-1)</span><br>
<span class="lineno">65</span><span class="comment" id="2129540">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2129551">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;11</span><br>
<span class="lineno"></span><span class="comment" id="2129612">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;=&nbsp;w0&nbsp;+&nbsp;w1*z&nbsp;+&nbsp;w2*z&nbsp;&nbsp;+&nbsp;w3*z&nbsp;&nbsp;+&nbsp;...&nbsp;+&nbsp;w6*z</span><br>
<span class="lineno"></span><span class="comment" id="2129671">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="2129685">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|w&nbsp;-&nbsp;f(z)|&nbsp;&lt;&nbsp;2**-58.74</span><br>
<span class="lineno">70</span><span class="comment" id="2129724">//</span><br>
<span class="lineno"></span><span class="comment" id="2129727">//&nbsp;&nbsp;&nbsp;4.&nbsp;For&nbsp;negative&nbsp;x,&nbsp;since&nbsp;(G&nbsp;is&nbsp;gamma&nbsp;function)</span><br>
<span class="lineno"></span><span class="comment" id="2129779">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-x*G(-x)*G(x)&nbsp;=&nbsp;pi/sin(pi*x),</span><br>
<span class="lineno"></span><span class="comment" id="2129825">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;we&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="2129841">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G(x)&nbsp;=&nbsp;pi/(sin(pi*x)*(-x)*G(-x))</span><br>
<span class="lineno">75</span><span class="comment" id="2129890">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;since&nbsp;G(-x)&nbsp;is&nbsp;positive,&nbsp;sign(G(x))&nbsp;=&nbsp;sign(sin(pi*x))&nbsp;for&nbsp;x&lt;0</span><br>
<span class="lineno"></span><span class="comment" id="2129960">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hence,&nbsp;for&nbsp;x&lt;0,&nbsp;signgam&nbsp;=&nbsp;sign(sin(pi*x))&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2130014">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;=&nbsp;log(|Gamma(x)|)</span><br>
<span class="lineno"></span><span class="comment" id="2130058">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;log(pi/(|x*sin(pi*x)|))&nbsp;-&nbsp;lgamma(-x);</span><br>
<span class="lineno"></span><span class="comment" id="2130124">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note:&nbsp;one&nbsp;should&nbsp;avoid&nbsp;computing&nbsp;pi*(-x)&nbsp;directly&nbsp;in&nbsp;the</span><br>
<span class="lineno">80</span><span class="comment" id="2130189">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;computation&nbsp;of&nbsp;sin(pi*(-x)).</span><br>
<span class="lineno"></span><span class="comment" id="2130232">//</span><br>
<span class="lineno"></span><span class="comment" id="2130235">//&nbsp;&nbsp;&nbsp;5.&nbsp;Special&nbsp;Cases</span><br>
<span class="lineno"></span><span class="comment" id="2130257">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(2+s)&nbsp;~&nbsp;s*(1-Euler)&nbsp;for&nbsp;tiny&nbsp;s</span><br>
<span class="lineno"></span><span class="comment" id="2130310">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(1)=lgamma(2)=0</span><br>
<span class="lineno">85</span><span class="comment" id="2130348">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;~&nbsp;-log(x)&nbsp;for&nbsp;tiny&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="2130395">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(0)&nbsp;=&nbsp;lgamma(inf)&nbsp;=&nbsp;inf</span><br>
<span class="lineno"></span><span class="comment" id="2130441">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(-integer)&nbsp;=&nbsp;+-inf</span><br>
<span class="lineno"></span><span class="comment" id="2130482">//</span><br>
<span class="lineno"></span><span class="comment" id="2130485">//</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="2130489">var</span>&nbsp;<span class="ident" id="2130493">_lgamA</span>&nbsp;<span class="op" id="2130500">=</span>&nbsp;<span class="op" id="2130502">[</span><span class="op" id="2130503">...</span><span class="op" id="2130506">]</span><span class="builtintype" id="2130507">float64</span><span class="op" id="2130514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2130517">7.72156649015328655494e-02</span><span class="op" id="2130543">,</span>&nbsp;<span class="comment" id="2130545">//&nbsp;0x3FB3C467E37DB0C8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2130568">3.22467033424113591611e-01</span><span class="op" id="2130594">,</span>&nbsp;<span class="comment" id="2130596">//&nbsp;0x3FD4A34CC4A60FAD</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2130619">6.73523010531292681824e-02</span><span class="op" id="2130645">,</span>&nbsp;<span class="comment" id="2130647">//&nbsp;0x3FB13E001A5562A7</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2130670">2.05808084325167332806e-02</span><span class="op" id="2130696">,</span>&nbsp;<span class="comment" id="2130698">//&nbsp;0x3F951322AC92547B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2130721">7.38555086081402883957e-03</span><span class="op" id="2130747">,</span>&nbsp;<span class="comment" id="2130749">//&nbsp;0x3F7E404FB68FEFE8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2130772">2.89051383673415629091e-03</span><span class="op" id="2130798">,</span>&nbsp;<span class="comment" id="2130800">//&nbsp;0x3F67ADD8CCB7926B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2130823">1.19270763183362067845e-03</span><span class="op" id="2130849">,</span>&nbsp;<span class="comment" id="2130851">//&nbsp;0x3F538A94116F3F5D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2130874">5.10069792153511336608e-04</span><span class="op" id="2130900">,</span>&nbsp;<span class="comment" id="2130902">//&nbsp;0x3F40B6C689B99C00</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2130925">2.20862790713908385557e-04</span><span class="op" id="2130951">,</span>&nbsp;<span class="comment" id="2130953">//&nbsp;0x3F2CF2ECED10E54D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2130976">1.08011567247583939954e-04</span><span class="op" id="2131002">,</span>&nbsp;<span class="comment" id="2131004">//&nbsp;0x3F1C5088987DFB07</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2131027">2.52144565451257326939e-05</span><span class="op" id="2131053">,</span>&nbsp;<span class="comment" id="2131055">//&nbsp;0x3EFA7074428CFA52</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2131078">4.48640949618915160150e-05</span><span class="op" id="2131104">,</span>&nbsp;<span class="comment" id="2131106">//&nbsp;0x3F07858E90A45837</span><br>
<span class="lineno"></span><span class="op" id="2131128">}</span><br>
<span class="lineno">105</span><span class="keyword" id="2131130">var</span>&nbsp;<span class="ident" id="2131134">_lgamR</span>&nbsp;<span class="op" id="2131141">=</span>&nbsp;<span class="op" id="2131143">[</span><span class="op" id="2131144">...</span><span class="op" id="2131147">]</span><span class="builtintype" id="2131148">float64</span><span class="op" id="2131155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2131158">1.0</span><span class="op" id="2131161">,</span>&nbsp;<span class="comment" id="2131163">//&nbsp;placeholder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2131179">1.39200533467621045958e+00</span><span class="op" id="2131205">,</span>&nbsp;<span class="comment" id="2131207">//&nbsp;0x3FF645A762C4AB74</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2131230">7.21935547567138069525e-01</span><span class="op" id="2131256">,</span>&nbsp;<span class="comment" id="2131258">//&nbsp;0x3FE71A1893D3DCDC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2131281">1.71933865632803078993e-01</span><span class="op" id="2131307">,</span>&nbsp;<span class="comment" id="2131309">//&nbsp;0x3FC601EDCCFBDF27</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2131332">1.86459191715652901344e-02</span><span class="op" id="2131358">,</span>&nbsp;<span class="comment" id="2131360">//&nbsp;0x3F9317EA742ED475</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2131383">7.77942496381893596434e-04</span><span class="op" id="2131409">,</span>&nbsp;<span class="comment" id="2131411">//&nbsp;0x3F497DDACA41A95B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2131434">7.32668430744625636189e-06</span><span class="op" id="2131460">,</span>&nbsp;<span class="comment" id="2131462">//&nbsp;0x3EDEBAF7A5B38140</span><br>
<span class="lineno"></span><span class="op" id="2131484">}</span><br>
<span class="lineno"></span><span class="keyword" id="2131486">var</span>&nbsp;<span class="ident" id="2131490">_lgamS</span>&nbsp;<span class="op" id="2131497">=</span>&nbsp;<span class="op" id="2131499">[</span><span class="op" id="2131500">...</span><span class="op" id="2131503">]</span><span class="builtintype" id="2131504">float64</span><span class="op" id="2131511">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2131514">-</span><span class="num" id="2131515">7.72156649015328655494e-02</span><span class="op" id="2131541">,</span>&nbsp;<span class="comment" id="2131543">//&nbsp;0xBFB3C467E37DB0C8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2131566">2.14982415960608852501e-01</span><span class="op" id="2131592">,</span>&nbsp;&nbsp;<span class="comment" id="2131595">//&nbsp;0x3FCB848B36E20878</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2131618">3.25778796408930981787e-01</span><span class="op" id="2131644">,</span>&nbsp;&nbsp;<span class="comment" id="2131647">//&nbsp;0x3FD4D98F4F139F59</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2131670">1.46350472652464452805e-01</span><span class="op" id="2131696">,</span>&nbsp;&nbsp;<span class="comment" id="2131699">//&nbsp;0x3FC2BB9CBEE5F2F7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2131722">2.66422703033638609560e-02</span><span class="op" id="2131748">,</span>&nbsp;&nbsp;<span class="comment" id="2131751">//&nbsp;0x3F9B481C7E939961</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2131774">1.84028451407337715652e-03</span><span class="op" id="2131800">,</span>&nbsp;&nbsp;<span class="comment" id="2131803">//&nbsp;0x3F5E26B67368F239</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2131826">3.19475326584100867617e-05</span><span class="op" id="2131852">,</span>&nbsp;&nbsp;<span class="comment" id="2131855">//&nbsp;0x3F00BFECDD17E945</span><br>
<span class="lineno"></span><span class="op" id="2131877">}</span><br>
<span class="lineno"></span><span class="keyword" id="2131879">var</span>&nbsp;<span class="ident" id="2131883">_lgamT</span>&nbsp;<span class="op" id="2131890">=</span>&nbsp;<span class="op" id="2131892">[</span><span class="op" id="2131893">...</span><span class="op" id="2131896">]</span><span class="builtintype" id="2131897">float64</span><span class="op" id="2131904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2131907">4.83836122723810047042e-01</span><span class="op" id="2131933">,</span>&nbsp;&nbsp;<span class="comment" id="2131936">//&nbsp;0x3FDEF72BC8EE38A2</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2131959">-</span><span class="num" id="2131960">1.47587722994593911752e-01</span><span class="op" id="2131986">,</span>&nbsp;<span class="comment" id="2131988">//&nbsp;0xBFC2E4278DC6C509</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2132011">6.46249402391333854778e-02</span><span class="op" id="2132037">,</span>&nbsp;&nbsp;<span class="comment" id="2132040">//&nbsp;0x3FB08B4294D5419B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2132063">-</span><span class="num" id="2132064">3.27885410759859649565e-02</span><span class="op" id="2132090">,</span>&nbsp;<span class="comment" id="2132092">//&nbsp;0xBFA0C9A8DF35B713</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2132115">1.79706750811820387126e-02</span><span class="op" id="2132141">,</span>&nbsp;&nbsp;<span class="comment" id="2132144">//&nbsp;0x3F9266E7970AF9EC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2132167">-</span><span class="num" id="2132168">1.03142241298341437450e-02</span><span class="op" id="2132194">,</span>&nbsp;<span class="comment" id="2132196">//&nbsp;0xBF851F9FBA91EC6A</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2132219">6.10053870246291332635e-03</span><span class="op" id="2132245">,</span>&nbsp;&nbsp;<span class="comment" id="2132248">//&nbsp;0x3F78FCE0E370E344</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2132271">-</span><span class="num" id="2132272">3.68452016781138256760e-03</span><span class="op" id="2132298">,</span>&nbsp;<span class="comment" id="2132300">//&nbsp;0xBF6E2EFFB3E914D7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2132323">2.25964780900612472250e-03</span><span class="op" id="2132349">,</span>&nbsp;&nbsp;<span class="comment" id="2132352">//&nbsp;0x3F6282D32E15C915</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2132375">-</span><span class="num" id="2132376">1.40346469989232843813e-03</span><span class="op" id="2132402">,</span>&nbsp;<span class="comment" id="2132404">//&nbsp;0xBF56FE8EBF2D1AF1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2132427">8.81081882437654011382e-04</span><span class="op" id="2132453">,</span>&nbsp;&nbsp;<span class="comment" id="2132456">//&nbsp;0x3F4CDF0CEF61A8E9</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2132479">-</span><span class="num" id="2132480">5.38595305356740546715e-04</span><span class="op" id="2132506">,</span>&nbsp;<span class="comment" id="2132508">//&nbsp;0xBF41A6109C73E0EC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2132531">3.15632070903625950361e-04</span><span class="op" id="2132557">,</span>&nbsp;&nbsp;<span class="comment" id="2132560">//&nbsp;0x3F34AF6D6C0EBBF7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2132583">-</span><span class="num" id="2132584">3.12754168375120860518e-04</span><span class="op" id="2132610">,</span>&nbsp;<span class="comment" id="2132612">//&nbsp;0xBF347F24ECC38C38</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2132635">3.35529192635519073543e-04</span><span class="op" id="2132661">,</span>&nbsp;&nbsp;<span class="comment" id="2132664">//&nbsp;0x3F35FD3EE8C2D3F4</span><br>
<span class="lineno"></span><span class="op" id="2132686">}</span><br>
<span class="lineno">140</span><span class="keyword" id="2132688">var</span>&nbsp;<span class="ident" id="2132692">_lgamU</span>&nbsp;<span class="op" id="2132699">=</span>&nbsp;<span class="op" id="2132701">[</span><span class="op" id="2132702">...</span><span class="op" id="2132705">]</span><span class="builtintype" id="2132706">float64</span><span class="op" id="2132713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2132716">-</span><span class="num" id="2132717">7.72156649015328655494e-02</span><span class="op" id="2132743">,</span>&nbsp;<span class="comment" id="2132745">//&nbsp;0xBFB3C467E37DB0C8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2132768">6.32827064025093366517e-01</span><span class="op" id="2132794">,</span>&nbsp;&nbsp;<span class="comment" id="2132797">//&nbsp;0x3FE4401E8B005DFF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2132820">1.45492250137234768737e+00</span><span class="op" id="2132846">,</span>&nbsp;&nbsp;<span class="comment" id="2132849">//&nbsp;0x3FF7475CD119BD6F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2132872">9.77717527963372745603e-01</span><span class="op" id="2132898">,</span>&nbsp;&nbsp;<span class="comment" id="2132901">//&nbsp;0x3FEF497644EA8450</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2132924">2.28963728064692451092e-01</span><span class="op" id="2132950">,</span>&nbsp;&nbsp;<span class="comment" id="2132953">//&nbsp;0x3FCD4EAEF6010924</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2132976">1.33810918536787660377e-02</span><span class="op" id="2133002">,</span>&nbsp;&nbsp;<span class="comment" id="2133005">//&nbsp;0x3F8B678BBF2BAB09</span><br>
<span class="lineno"></span><span class="op" id="2133027">}</span><br>
<span class="lineno"></span><span class="keyword" id="2133029">var</span>&nbsp;<span class="ident" id="2133033">_lgamV</span>&nbsp;<span class="op" id="2133040">=</span>&nbsp;<span class="op" id="2133042">[</span><span class="op" id="2133043">...</span><span class="op" id="2133046">]</span><span class="builtintype" id="2133047">float64</span><span class="op" id="2133054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2133057">1.0</span><span class="op" id="2133060">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2133063">2.45597793713041134822e+00</span><span class="op" id="2133089">,</span>&nbsp;<span class="comment" id="2133091">//&nbsp;0x4003A5D7C2BD619C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2133114">2.12848976379893395361e+00</span><span class="op" id="2133140">,</span>&nbsp;<span class="comment" id="2133142">//&nbsp;0x40010725A42B18F5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2133165">7.69285150456672783825e-01</span><span class="op" id="2133191">,</span>&nbsp;<span class="comment" id="2133193">//&nbsp;0x3FE89DFBE45050AF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2133216">1.04222645593369134254e-01</span><span class="op" id="2133242">,</span>&nbsp;<span class="comment" id="2133244">//&nbsp;0x3FBAAE55D6537C88</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2133267">3.21709242282423911810e-03</span><span class="op" id="2133293">,</span>&nbsp;<span class="comment" id="2133295">//&nbsp;0x3F6A5ABB57D0CF61</span><br>
<span class="lineno">155</span><span class="op" id="2133317">}</span><br>
<span class="lineno"></span><span class="keyword" id="2133319">var</span>&nbsp;<span class="ident" id="2133323">_lgamW</span>&nbsp;<span class="op" id="2133330">=</span>&nbsp;<span class="op" id="2133332">[</span><span class="op" id="2133333">...</span><span class="op" id="2133336">]</span><span class="builtintype" id="2133337">float64</span><span class="op" id="2133344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2133347">4.18938533204672725052e-01</span><span class="op" id="2133373">,</span>&nbsp;&nbsp;<span class="comment" id="2133376">//&nbsp;0x3FDACFE390C97D69</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2133399">8.33333333333329678849e-02</span><span class="op" id="2133425">,</span>&nbsp;&nbsp;<span class="comment" id="2133428">//&nbsp;0x3FB555555555553B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2133451">-</span><span class="num" id="2133452">2.77777777728775536470e-03</span><span class="op" id="2133478">,</span>&nbsp;<span class="comment" id="2133480">//&nbsp;0xBF66C16C16B02E5C</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2133503">7.93650558643019558500e-04</span><span class="op" id="2133529">,</span>&nbsp;&nbsp;<span class="comment" id="2133532">//&nbsp;0x3F4A019F98CF38B6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2133555">-</span><span class="num" id="2133556">5.95187557450339963135e-04</span><span class="op" id="2133582">,</span>&nbsp;<span class="comment" id="2133584">//&nbsp;0xBF4380CB8C0FE741</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2133607">8.36339918996282139126e-04</span><span class="op" id="2133633">,</span>&nbsp;&nbsp;<span class="comment" id="2133636">//&nbsp;0x3F4B67BA4CDAD5D1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2133659">-</span><span class="num" id="2133660">1.63092934096575273989e-03</span><span class="op" id="2133686">,</span>&nbsp;<span class="comment" id="2133688">//&nbsp;0xBF5AB89D0B9E43E4</span><br>
<span class="lineno"></span><span class="op" id="2133710">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="comment" id="2133713">//&nbsp;Lgamma&nbsp;returns&nbsp;the&nbsp;natural&nbsp;logarithm&nbsp;and&nbsp;sign&nbsp;(-1&nbsp;or&nbsp;+1)&nbsp;of&nbsp;Gamma(x).</span><br>
<span class="lineno"></span><span class="comment" id="2133786">//</span><br>
<span class="lineno"></span><span class="comment" id="2133789">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2133811">//&nbsp;&nbsp;&nbsp;&nbsp;Lgamma(+Inf)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno">170</span><span class="comment" id="2133834">//&nbsp;&nbsp;&nbsp;&nbsp;Lgamma(0)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2133854">//&nbsp;&nbsp;&nbsp;&nbsp;Lgamma(-integer)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2133881">//&nbsp;&nbsp;&nbsp;&nbsp;Lgamma(-Inf)&nbsp;=&nbsp;-Inf</span><br>
<span class="lineno"></span><span class="comment" id="2133904">//&nbsp;&nbsp;&nbsp;&nbsp;Lgamma(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2133925">func</span>&nbsp;<span class="ident" id="2133930">Lgamma</span><span class="op" id="2133936">(</span><span class="ident" id="2133937">x</span>&nbsp;<span class="builtintype" id="2133939">float64</span><span class="op" id="2133946">)</span>&nbsp;<span class="op" id="2133948">(</span><span class="ident" id="2133949">lgamma</span>&nbsp;<span class="builtintype" id="2133956">float64</span><span class="op" id="2133963">,</span>&nbsp;<span class="ident" id="2133965">sign</span>&nbsp;<span class="builtintype" id="2133970">int</span><span class="op" id="2133973">)</span>&nbsp;<span class="op" id="2133975">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2133978">const</span>&nbsp;<span class="op" id="2133984">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2133988">Ymin</span>&nbsp;&nbsp;<span class="op" id="2133994">=</span>&nbsp;<span class="num" id="2133996">1.461632144968362245</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2134019">Two52</span>&nbsp;<span class="op" id="2134025">=</span>&nbsp;<span class="num" id="2134027">1</span>&nbsp;<span class="op" id="2134029">&lt;&lt;</span>&nbsp;<span class="num" id="2134032">52</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2134055">//&nbsp;0x4330000000000000&nbsp;~4.5036e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2134091">Two53</span>&nbsp;<span class="op" id="2134097">=</span>&nbsp;<span class="num" id="2134099">1</span>&nbsp;<span class="op" id="2134101">&lt;&lt;</span>&nbsp;<span class="num" id="2134104">53</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2134127">//&nbsp;0x4340000000000000&nbsp;~9.0072e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2134163">Two58</span>&nbsp;<span class="op" id="2134169">=</span>&nbsp;<span class="num" id="2134171">1</span>&nbsp;<span class="op" id="2134173">&lt;&lt;</span>&nbsp;<span class="num" id="2134176">58</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2134199">//&nbsp;0x4390000000000000&nbsp;~2.8823e+17</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2134235">Tiny</span>&nbsp;&nbsp;<span class="op" id="2134241">=</span>&nbsp;<span class="num" id="2134243">1.0</span>&nbsp;<span class="op" id="2134247">/</span>&nbsp;<span class="op" id="2134249">(</span><span class="num" id="2134250">1</span>&nbsp;<span class="op" id="2134252">&lt;&lt;</span>&nbsp;<span class="num" id="2134255">70</span><span class="op" id="2134257">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2134271">//&nbsp;0x3b90000000000000&nbsp;~8.47033e-22</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2134308">Tc</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2134314">=</span>&nbsp;<span class="num" id="2134316">1.46163214496836224576e+00</span>&nbsp;&nbsp;<span class="comment" id="2134344">//&nbsp;0x3FF762D86356BE3F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2134368">Tf</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2134374">=</span>&nbsp;<span class="op" id="2134376">-</span><span class="num" id="2134377">1.21486290535849611461e-01</span>&nbsp;<span class="comment" id="2134404">//&nbsp;0xBFBF19B9BCC38A42</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2134428">//&nbsp;Tt&nbsp;=&nbsp;-(tail&nbsp;of&nbsp;Tf)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2134452">Tt</span>&nbsp;<span class="op" id="2134455">=</span>&nbsp;<span class="op" id="2134457">-</span><span class="num" id="2134458">3.63867699703950536541e-18</span>&nbsp;<span class="comment" id="2134485">//&nbsp;0xBC50C7CAA48A971F</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2134508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2134511">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2134529">sign</span>&nbsp;<span class="op" id="2134534">=</span>&nbsp;<span class="num" id="2134536">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2134539">switch</span>&nbsp;<span class="op" id="2134546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2134549">case</span>&nbsp;<span class="ident" id="2134554">IsNaN</span><span class="op" id="2134559">(</span><span class="ident" id="2134560">x</span><span class="op" id="2134561">)</span><span class="op" id="2134562">:</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2134566">lgamma</span>&nbsp;<span class="op" id="2134573">=</span>&nbsp;<span class="ident" id="2134575">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2134579">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2134587">case</span>&nbsp;<span class="ident" id="2134592">IsInf</span><span class="op" id="2134597">(</span><span class="ident" id="2134598">x</span><span class="op" id="2134599">,</span>&nbsp;<span class="num" id="2134601">0</span><span class="op" id="2134602">)</span><span class="op" id="2134603">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2134607">lgamma</span>&nbsp;<span class="op" id="2134614">=</span>&nbsp;<span class="ident" id="2134616">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2134620">return</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2134628">case</span>&nbsp;<span class="ident" id="2134633">x</span>&nbsp;<span class="op" id="2134635">==</span>&nbsp;<span class="num" id="2134638">0</span><span class="op" id="2134639">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2134643">lgamma</span>&nbsp;<span class="op" id="2134650">=</span>&nbsp;<span class="ident" id="2134652">Inf</span><span class="op" id="2134655">(</span><span class="num" id="2134656">1</span><span class="op" id="2134657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2134661">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2134669">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2134673">neg</span>&nbsp;<span class="op" id="2134677">:=</span>&nbsp;<span class="builtintype" id="2134680">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2134687">if</span>&nbsp;<span class="ident" id="2134690">x</span>&nbsp;<span class="op" id="2134692">&lt;</span>&nbsp;<span class="num" id="2134694">0</span>&nbsp;<span class="op" id="2134696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2134700">x</span>&nbsp;<span class="op" id="2134702">=</span>&nbsp;<span class="op" id="2134704">-</span><span class="ident" id="2134705">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2134709">neg</span>&nbsp;<span class="op" id="2134713">=</span>&nbsp;<span class="builtintype" id="2134715">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2134721">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2134725">if</span>&nbsp;<span class="ident" id="2134728">x</span>&nbsp;<span class="op" id="2134730">&lt;</span>&nbsp;<span class="ident" id="2134732">Tiny</span>&nbsp;<span class="op" id="2134737">{</span>&nbsp;<span class="comment" id="2134739">//&nbsp;if&nbsp;|x|&nbsp;&lt;&nbsp;2**-70,&nbsp;return&nbsp;-log(|x|)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2134778">if</span>&nbsp;<span class="ident" id="2134781">neg</span>&nbsp;<span class="op" id="2134785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2134790">sign</span>&nbsp;<span class="op" id="2134795">=</span>&nbsp;<span class="op" id="2134797">-</span><span class="num" id="2134798">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2134802">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2134806">lgamma</span>&nbsp;<span class="op" id="2134813">=</span>&nbsp;<span class="op" id="2134815">-</span><span class="ident" id="2134816">Log</span><span class="op" id="2134819">(</span><span class="ident" id="2134820">x</span><span class="op" id="2134821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2134825">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2134833">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2134836">var</span>&nbsp;<span class="ident" id="2134840">nadj</span>&nbsp;<span class="builtintype" id="2134845">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2134854">if</span>&nbsp;<span class="ident" id="2134857">neg</span>&nbsp;<span class="op" id="2134861">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2134865">if</span>&nbsp;<span class="ident" id="2134868">x</span>&nbsp;<span class="op" id="2134870">&gt;=</span>&nbsp;<span class="ident" id="2134873">Two52</span>&nbsp;<span class="op" id="2134879">{</span>&nbsp;<span class="comment" id="2134881">//&nbsp;|x|&nbsp;&gt;=&nbsp;2**52,&nbsp;must&nbsp;be&nbsp;-integer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2134918">lgamma</span>&nbsp;<span class="op" id="2134925">=</span>&nbsp;<span class="ident" id="2134927">Inf</span><span class="op" id="2134930">(</span><span class="num" id="2134931">1</span><span class="op" id="2134932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2134937">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2134946">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2134950">t</span>&nbsp;<span class="op" id="2134952">:=</span>&nbsp;<span class="ident" id="2134955">sinPi</span><span class="op" id="2134960">(</span><span class="ident" id="2134961">x</span><span class="op" id="2134962">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2134966">if</span>&nbsp;<span class="ident" id="2134969">t</span>&nbsp;<span class="op" id="2134971">==</span>&nbsp;<span class="num" id="2134974">0</span>&nbsp;<span class="op" id="2134976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2134981">lgamma</span>&nbsp;<span class="op" id="2134988">=</span>&nbsp;<span class="ident" id="2134990">Inf</span><span class="op" id="2134993">(</span><span class="num" id="2134994">1</span><span class="op" id="2134995">)</span>&nbsp;<span class="comment" id="2134997">//&nbsp;-integer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2135012">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2135021">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2135025">nadj</span>&nbsp;<span class="op" id="2135030">=</span>&nbsp;<span class="ident" id="2135032">Log</span><span class="op" id="2135035">(</span><span class="ident" id="2135036">Pi</span>&nbsp;<span class="op" id="2135039">/</span>&nbsp;<span class="ident" id="2135041">Abs</span><span class="op" id="2135044">(</span><span class="ident" id="2135045">t</span><span class="op" id="2135046">*</span><span class="ident" id="2135047">x</span><span class="op" id="2135048">)</span><span class="op" id="2135049">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2135053">if</span>&nbsp;<span class="ident" id="2135056">t</span>&nbsp;<span class="op" id="2135058">&lt;</span>&nbsp;<span class="num" id="2135060">0</span>&nbsp;<span class="op" id="2135062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2135067">sign</span>&nbsp;<span class="op" id="2135072">=</span>&nbsp;<span class="op" id="2135074">-</span><span class="num" id="2135075">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2135079">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2135082">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2135086">switch</span>&nbsp;<span class="op" id="2135093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2135096">case</span>&nbsp;<span class="ident" id="2135101">x</span>&nbsp;<span class="op" id="2135103">==</span>&nbsp;<span class="num" id="2135106">1</span>&nbsp;<span class="op" id="2135108">||</span>&nbsp;<span class="ident" id="2135111">x</span>&nbsp;<span class="op" id="2135113">==</span>&nbsp;<span class="num" id="2135116">2</span><span class="op" id="2135117">:</span>&nbsp;<span class="comment" id="2135119">//&nbsp;purge&nbsp;off&nbsp;1&nbsp;and&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2135142">lgamma</span>&nbsp;<span class="op" id="2135149">=</span>&nbsp;<span class="num" id="2135151">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2135155">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2135163">case</span>&nbsp;<span class="ident" id="2135168">x</span>&nbsp;<span class="op" id="2135170">&lt;</span>&nbsp;<span class="num" id="2135172">2</span><span class="op" id="2135173">:</span>&nbsp;<span class="comment" id="2135175">//&nbsp;use&nbsp;lgamma(x)&nbsp;=&nbsp;lgamma(x+1)&nbsp;-&nbsp;log(x)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2135217">var</span>&nbsp;<span class="ident" id="2135221">y</span>&nbsp;<span class="builtintype" id="2135223">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2135233">var</span>&nbsp;<span class="ident" id="2135237">i</span>&nbsp;<span class="builtintype" id="2135239">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2135245">if</span>&nbsp;<span class="ident" id="2135248">x</span>&nbsp;<span class="op" id="2135250">&lt;=</span>&nbsp;<span class="num" id="2135253">0.9</span>&nbsp;<span class="op" id="2135257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2135262">lgamma</span>&nbsp;<span class="op" id="2135269">=</span>&nbsp;<span class="op" id="2135271">-</span><span class="ident" id="2135272">Log</span><span class="op" id="2135275">(</span><span class="ident" id="2135276">x</span><span class="op" id="2135277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2135282">switch</span>&nbsp;<span class="op" id="2135289">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2135294">case</span>&nbsp;<span class="ident" id="2135299">x</span>&nbsp;<span class="op" id="2135301">&gt;=</span>&nbsp;<span class="op" id="2135304">(</span><span class="ident" id="2135305">Ymin</span>&nbsp;<span class="op" id="2135310">-</span>&nbsp;<span class="num" id="2135312">1</span>&nbsp;<span class="op" id="2135314">+</span>&nbsp;<span class="num" id="2135316">0.27</span><span class="op" id="2135320">)</span><span class="op" id="2135321">:</span>&nbsp;<span class="comment" id="2135323">//&nbsp;0.7316&nbsp;&lt;=&nbsp;x&nbsp;&lt;=&nbsp;&nbsp;0.9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2135350">y</span>&nbsp;<span class="op" id="2135352">=</span>&nbsp;<span class="num" id="2135354">1</span>&nbsp;<span class="op" id="2135356">-</span>&nbsp;<span class="ident" id="2135358">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2135364">i</span>&nbsp;<span class="op" id="2135366">=</span>&nbsp;<span class="num" id="2135368">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2135373">case</span>&nbsp;<span class="ident" id="2135378">x</span>&nbsp;<span class="op" id="2135380">&gt;=</span>&nbsp;<span class="op" id="2135383">(</span><span class="ident" id="2135384">Ymin</span>&nbsp;<span class="op" id="2135389">-</span>&nbsp;<span class="num" id="2135391">1</span>&nbsp;<span class="op" id="2135393">-</span>&nbsp;<span class="num" id="2135395">0.27</span><span class="op" id="2135399">)</span><span class="op" id="2135400">:</span>&nbsp;<span class="comment" id="2135402">//&nbsp;0.2316&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;0.7316</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2135430">y</span>&nbsp;<span class="op" id="2135432">=</span>&nbsp;<span class="ident" id="2135434">x</span>&nbsp;<span class="op" id="2135436">-</span>&nbsp;<span class="op" id="2135438">(</span><span class="ident" id="2135439">Tc</span>&nbsp;<span class="op" id="2135442">-</span>&nbsp;<span class="num" id="2135444">1</span><span class="op" id="2135445">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2135451">i</span>&nbsp;<span class="op" id="2135453">=</span>&nbsp;<span class="num" id="2135455">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2135460">default</span><span class="op" id="2135467">:</span>&nbsp;<span class="comment" id="2135469">//&nbsp;0&nbsp;&lt;&nbsp;x&nbsp;&lt;&nbsp;0.2316</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2135491">y</span>&nbsp;<span class="op" id="2135493">=</span>&nbsp;<span class="ident" id="2135495">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2135501">i</span>&nbsp;<span class="op" id="2135503">=</span>&nbsp;<span class="num" id="2135505">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2135510">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2135514">}</span>&nbsp;<span class="keyword" id="2135516">else</span>&nbsp;<span class="op" id="2135521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2135526">lgamma</span>&nbsp;<span class="op" id="2135533">=</span>&nbsp;<span class="num" id="2135535">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2135540">switch</span>&nbsp;<span class="op" id="2135547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2135552">case</span>&nbsp;<span class="ident" id="2135557">x</span>&nbsp;<span class="op" id="2135559">&gt;=</span>&nbsp;<span class="op" id="2135562">(</span><span class="ident" id="2135563">Ymin</span>&nbsp;<span class="op" id="2135568">+</span>&nbsp;<span class="num" id="2135570">0.27</span><span class="op" id="2135574">)</span><span class="op" id="2135575">:</span>&nbsp;<span class="comment" id="2135577">//&nbsp;1.7316&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2135600">y</span>&nbsp;<span class="op" id="2135602">=</span>&nbsp;<span class="num" id="2135604">2</span>&nbsp;<span class="op" id="2135606">-</span>&nbsp;<span class="ident" id="2135608">x</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2135614">i</span>&nbsp;<span class="op" id="2135616">=</span>&nbsp;<span class="num" id="2135618">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2135623">case</span>&nbsp;<span class="ident" id="2135628">x</span>&nbsp;<span class="op" id="2135630">&gt;=</span>&nbsp;<span class="op" id="2135633">(</span><span class="ident" id="2135634">Ymin</span>&nbsp;<span class="op" id="2135639">-</span>&nbsp;<span class="num" id="2135641">0.27</span><span class="op" id="2135645">)</span><span class="op" id="2135646">:</span>&nbsp;<span class="comment" id="2135648">//&nbsp;1.2316&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;1.7316</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2135676">y</span>&nbsp;<span class="op" id="2135678">=</span>&nbsp;<span class="ident" id="2135680">x</span>&nbsp;<span class="op" id="2135682">-</span>&nbsp;<span class="ident" id="2135684">Tc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2135691">i</span>&nbsp;<span class="op" id="2135693">=</span>&nbsp;<span class="num" id="2135695">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2135700">default</span><span class="op" id="2135707">:</span>&nbsp;<span class="comment" id="2135709">//&nbsp;0.9&nbsp;&lt;&nbsp;x&nbsp;&lt;&nbsp;1.2316</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2135733">y</span>&nbsp;<span class="op" id="2135735">=</span>&nbsp;<span class="ident" id="2135737">x</span>&nbsp;<span class="op" id="2135739">-</span>&nbsp;<span class="num" id="2135741">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2135747">i</span>&nbsp;<span class="op" id="2135749">=</span>&nbsp;<span class="num" id="2135751">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2135756">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2135760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2135764">switch</span>&nbsp;<span class="ident" id="2135771">i</span>&nbsp;<span class="op" id="2135773">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2135777">case</span>&nbsp;<span class="num" id="2135782">0</span><span class="op" id="2135783">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2135788">z</span>&nbsp;<span class="op" id="2135790">:=</span>&nbsp;<span class="ident" id="2135793">y</span>&nbsp;<span class="op" id="2135795">*</span>&nbsp;<span class="ident" id="2135797">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2135802">p1</span>&nbsp;<span class="op" id="2135805">:=</span>&nbsp;<span class="ident" id="2135808">_lgamA</span><span class="op" id="2135814">[</span><span class="num" id="2135815">0</span><span class="op" id="2135816">]</span>&nbsp;<span class="op" id="2135818">+</span>&nbsp;<span class="ident" id="2135820">z</span><span class="op" id="2135821">*</span><span class="op" id="2135822">(</span><span class="ident" id="2135823">_lgamA</span><span class="op" id="2135829">[</span><span class="num" id="2135830">2</span><span class="op" id="2135831">]</span><span class="op" id="2135832">+</span><span class="ident" id="2135833">z</span><span class="op" id="2135834">*</span><span class="op" id="2135835">(</span><span class="ident" id="2135836">_lgamA</span><span class="op" id="2135842">[</span><span class="num" id="2135843">4</span><span class="op" id="2135844">]</span><span class="op" id="2135845">+</span><span class="ident" id="2135846">z</span><span class="op" id="2135847">*</span><span class="op" id="2135848">(</span><span class="ident" id="2135849">_lgamA</span><span class="op" id="2135855">[</span><span class="num" id="2135856">6</span><span class="op" id="2135857">]</span><span class="op" id="2135858">+</span><span class="ident" id="2135859">z</span><span class="op" id="2135860">*</span><span class="op" id="2135861">(</span><span class="ident" id="2135862">_lgamA</span><span class="op" id="2135868">[</span><span class="num" id="2135869">8</span><span class="op" id="2135870">]</span><span class="op" id="2135871">+</span><span class="ident" id="2135872">z</span><span class="op" id="2135873">*</span><span class="ident" id="2135874">_lgamA</span><span class="op" id="2135880">[</span><span class="num" id="2135881">10</span><span class="op" id="2135883">]</span><span class="op" id="2135884">)</span><span class="op" id="2135885">)</span><span class="op" id="2135886">)</span><span class="op" id="2135887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2135892">p2</span>&nbsp;<span class="op" id="2135895">:=</span>&nbsp;<span class="ident" id="2135898">z</span>&nbsp;<span class="op" id="2135900">*</span>&nbsp;<span class="op" id="2135902">(</span><span class="ident" id="2135903">_lgamA</span><span class="op" id="2135909">[</span><span class="num" id="2135910">1</span><span class="op" id="2135911">]</span>&nbsp;<span class="op" id="2135913">+</span>&nbsp;<span class="ident" id="2135915">z</span><span class="op" id="2135916">*</span><span class="op" id="2135917">(</span><span class="op" id="2135918">+</span><span class="ident" id="2135919">_lgamA</span><span class="op" id="2135925">[</span><span class="num" id="2135926">3</span><span class="op" id="2135927">]</span><span class="op" id="2135928">+</span><span class="ident" id="2135929">z</span><span class="op" id="2135930">*</span><span class="op" id="2135931">(</span><span class="ident" id="2135932">_lgamA</span><span class="op" id="2135938">[</span><span class="num" id="2135939">5</span><span class="op" id="2135940">]</span><span class="op" id="2135941">+</span><span class="ident" id="2135942">z</span><span class="op" id="2135943">*</span><span class="op" id="2135944">(</span><span class="ident" id="2135945">_lgamA</span><span class="op" id="2135951">[</span><span class="num" id="2135952">7</span><span class="op" id="2135953">]</span><span class="op" id="2135954">+</span><span class="ident" id="2135955">z</span><span class="op" id="2135956">*</span><span class="op" id="2135957">(</span><span class="ident" id="2135958">_lgamA</span><span class="op" id="2135964">[</span><span class="num" id="2135965">9</span><span class="op" id="2135966">]</span><span class="op" id="2135967">+</span><span class="ident" id="2135968">z</span><span class="op" id="2135969">*</span><span class="ident" id="2135970">_lgamA</span><span class="op" id="2135976">[</span><span class="num" id="2135977">11</span><span class="op" id="2135979">]</span><span class="op" id="2135980">)</span><span class="op" id="2135981">)</span><span class="op" id="2135982">)</span><span class="op" id="2135983">)</span><span class="op" id="2135984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2135989">p</span>&nbsp;<span class="op" id="2135991">:=</span>&nbsp;<span class="ident" id="2135994">y</span><span class="op" id="2135995">*</span><span class="ident" id="2135996">p1</span>&nbsp;<span class="op" id="2135999">+</span>&nbsp;<span class="ident" id="2136001">p2</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2136007">lgamma</span>&nbsp;<span class="op" id="2136014">+=</span>&nbsp;<span class="op" id="2136017">(</span><span class="ident" id="2136018">p</span>&nbsp;<span class="op" id="2136020">-</span>&nbsp;<span class="num" id="2136022">0.5</span><span class="op" id="2136025">*</span><span class="ident" id="2136026">y</span><span class="op" id="2136027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2136031">case</span>&nbsp;<span class="num" id="2136036">1</span><span class="op" id="2136037">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2136042">z</span>&nbsp;<span class="op" id="2136044">:=</span>&nbsp;<span class="ident" id="2136047">y</span>&nbsp;<span class="op" id="2136049">*</span>&nbsp;<span class="ident" id="2136051">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2136056">w</span>&nbsp;<span class="op" id="2136058">:=</span>&nbsp;<span class="ident" id="2136061">z</span>&nbsp;<span class="op" id="2136063">*</span>&nbsp;<span class="ident" id="2136065">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2136070">p1</span>&nbsp;<span class="op" id="2136073">:=</span>&nbsp;<span class="ident" id="2136076">_lgamT</span><span class="op" id="2136082">[</span><span class="num" id="2136083">0</span><span class="op" id="2136084">]</span>&nbsp;<span class="op" id="2136086">+</span>&nbsp;<span class="ident" id="2136088">w</span><span class="op" id="2136089">*</span><span class="op" id="2136090">(</span><span class="ident" id="2136091">_lgamT</span><span class="op" id="2136097">[</span><span class="num" id="2136098">3</span><span class="op" id="2136099">]</span><span class="op" id="2136100">+</span><span class="ident" id="2136101">w</span><span class="op" id="2136102">*</span><span class="op" id="2136103">(</span><span class="ident" id="2136104">_lgamT</span><span class="op" id="2136110">[</span><span class="num" id="2136111">6</span><span class="op" id="2136112">]</span><span class="op" id="2136113">+</span><span class="ident" id="2136114">w</span><span class="op" id="2136115">*</span><span class="op" id="2136116">(</span><span class="ident" id="2136117">_lgamT</span><span class="op" id="2136123">[</span><span class="num" id="2136124">9</span><span class="op" id="2136125">]</span><span class="op" id="2136126">+</span><span class="ident" id="2136127">w</span><span class="op" id="2136128">*</span><span class="ident" id="2136129">_lgamT</span><span class="op" id="2136135">[</span><span class="num" id="2136136">12</span><span class="op" id="2136138">]</span><span class="op" id="2136139">)</span><span class="op" id="2136140">)</span><span class="op" id="2136141">)</span>&nbsp;<span class="comment" id="2136143">//&nbsp;parallel&nbsp;comp</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2136163">p2</span>&nbsp;<span class="op" id="2136166">:=</span>&nbsp;<span class="ident" id="2136169">_lgamT</span><span class="op" id="2136175">[</span><span class="num" id="2136176">1</span><span class="op" id="2136177">]</span>&nbsp;<span class="op" id="2136179">+</span>&nbsp;<span class="ident" id="2136181">w</span><span class="op" id="2136182">*</span><span class="op" id="2136183">(</span><span class="ident" id="2136184">_lgamT</span><span class="op" id="2136190">[</span><span class="num" id="2136191">4</span><span class="op" id="2136192">]</span><span class="op" id="2136193">+</span><span class="ident" id="2136194">w</span><span class="op" id="2136195">*</span><span class="op" id="2136196">(</span><span class="ident" id="2136197">_lgamT</span><span class="op" id="2136203">[</span><span class="num" id="2136204">7</span><span class="op" id="2136205">]</span><span class="op" id="2136206">+</span><span class="ident" id="2136207">w</span><span class="op" id="2136208">*</span><span class="op" id="2136209">(</span><span class="ident" id="2136210">_lgamT</span><span class="op" id="2136216">[</span><span class="num" id="2136217">10</span><span class="op" id="2136219">]</span><span class="op" id="2136220">+</span><span class="ident" id="2136221">w</span><span class="op" id="2136222">*</span><span class="ident" id="2136223">_lgamT</span><span class="op" id="2136229">[</span><span class="num" id="2136230">13</span><span class="op" id="2136232">]</span><span class="op" id="2136233">)</span><span class="op" id="2136234">)</span><span class="op" id="2136235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2136240">p3</span>&nbsp;<span class="op" id="2136243">:=</span>&nbsp;<span class="ident" id="2136246">_lgamT</span><span class="op" id="2136252">[</span><span class="num" id="2136253">2</span><span class="op" id="2136254">]</span>&nbsp;<span class="op" id="2136256">+</span>&nbsp;<span class="ident" id="2136258">w</span><span class="op" id="2136259">*</span><span class="op" id="2136260">(</span><span class="ident" id="2136261">_lgamT</span><span class="op" id="2136267">[</span><span class="num" id="2136268">5</span><span class="op" id="2136269">]</span><span class="op" id="2136270">+</span><span class="ident" id="2136271">w</span><span class="op" id="2136272">*</span><span class="op" id="2136273">(</span><span class="ident" id="2136274">_lgamT</span><span class="op" id="2136280">[</span><span class="num" id="2136281">8</span><span class="op" id="2136282">]</span><span class="op" id="2136283">+</span><span class="ident" id="2136284">w</span><span class="op" id="2136285">*</span><span class="op" id="2136286">(</span><span class="ident" id="2136287">_lgamT</span><span class="op" id="2136293">[</span><span class="num" id="2136294">11</span><span class="op" id="2136296">]</span><span class="op" id="2136297">+</span><span class="ident" id="2136298">w</span><span class="op" id="2136299">*</span><span class="ident" id="2136300">_lgamT</span><span class="op" id="2136306">[</span><span class="num" id="2136307">14</span><span class="op" id="2136309">]</span><span class="op" id="2136310">)</span><span class="op" id="2136311">)</span><span class="op" id="2136312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2136317">p</span>&nbsp;<span class="op" id="2136319">:=</span>&nbsp;<span class="ident" id="2136322">z</span><span class="op" id="2136323">*</span><span class="ident" id="2136324">p1</span>&nbsp;<span class="op" id="2136327">-</span>&nbsp;<span class="op" id="2136329">(</span><span class="ident" id="2136330">Tt</span>&nbsp;<span class="op" id="2136333">-</span>&nbsp;<span class="ident" id="2136335">w</span><span class="op" id="2136336">*</span><span class="op" id="2136337">(</span><span class="ident" id="2136338">p2</span><span class="op" id="2136340">+</span><span class="ident" id="2136341">y</span><span class="op" id="2136342">*</span><span class="ident" id="2136343">p3</span><span class="op" id="2136345">)</span><span class="op" id="2136346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2136351">lgamma</span>&nbsp;<span class="op" id="2136358">+=</span>&nbsp;<span class="op" id="2136361">(</span><span class="ident" id="2136362">Tf</span>&nbsp;<span class="op" id="2136365">+</span>&nbsp;<span class="ident" id="2136367">p</span><span class="op" id="2136368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2136372">case</span>&nbsp;<span class="num" id="2136377">2</span><span class="op" id="2136378">:</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2136383">p1</span>&nbsp;<span class="op" id="2136386">:=</span>&nbsp;<span class="ident" id="2136389">y</span>&nbsp;<span class="op" id="2136391">*</span>&nbsp;<span class="op" id="2136393">(</span><span class="ident" id="2136394">_lgamU</span><span class="op" id="2136400">[</span><span class="num" id="2136401">0</span><span class="op" id="2136402">]</span>&nbsp;<span class="op" id="2136404">+</span>&nbsp;<span class="ident" id="2136406">y</span><span class="op" id="2136407">*</span><span class="op" id="2136408">(</span><span class="ident" id="2136409">_lgamU</span><span class="op" id="2136415">[</span><span class="num" id="2136416">1</span><span class="op" id="2136417">]</span><span class="op" id="2136418">+</span><span class="ident" id="2136419">y</span><span class="op" id="2136420">*</span><span class="op" id="2136421">(</span><span class="ident" id="2136422">_lgamU</span><span class="op" id="2136428">[</span><span class="num" id="2136429">2</span><span class="op" id="2136430">]</span><span class="op" id="2136431">+</span><span class="ident" id="2136432">y</span><span class="op" id="2136433">*</span><span class="op" id="2136434">(</span><span class="ident" id="2136435">_lgamU</span><span class="op" id="2136441">[</span><span class="num" id="2136442">3</span><span class="op" id="2136443">]</span><span class="op" id="2136444">+</span><span class="ident" id="2136445">y</span><span class="op" id="2136446">*</span><span class="op" id="2136447">(</span><span class="ident" id="2136448">_lgamU</span><span class="op" id="2136454">[</span><span class="num" id="2136455">4</span><span class="op" id="2136456">]</span><span class="op" id="2136457">+</span><span class="ident" id="2136458">y</span><span class="op" id="2136459">*</span><span class="ident" id="2136460">_lgamU</span><span class="op" id="2136466">[</span><span class="num" id="2136467">5</span><span class="op" id="2136468">]</span><span class="op" id="2136469">)</span><span class="op" id="2136470">)</span><span class="op" id="2136471">)</span><span class="op" id="2136472">)</span><span class="op" id="2136473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2136478">p2</span>&nbsp;<span class="op" id="2136481">:=</span>&nbsp;<span class="num" id="2136484">1</span>&nbsp;<span class="op" id="2136486">+</span>&nbsp;<span class="ident" id="2136488">y</span><span class="op" id="2136489">*</span><span class="op" id="2136490">(</span><span class="ident" id="2136491">_lgamV</span><span class="op" id="2136497">[</span><span class="num" id="2136498">1</span><span class="op" id="2136499">]</span><span class="op" id="2136500">+</span><span class="ident" id="2136501">y</span><span class="op" id="2136502">*</span><span class="op" id="2136503">(</span><span class="ident" id="2136504">_lgamV</span><span class="op" id="2136510">[</span><span class="num" id="2136511">2</span><span class="op" id="2136512">]</span><span class="op" id="2136513">+</span><span class="ident" id="2136514">y</span><span class="op" id="2136515">*</span><span class="op" id="2136516">(</span><span class="ident" id="2136517">_lgamV</span><span class="op" id="2136523">[</span><span class="num" id="2136524">3</span><span class="op" id="2136525">]</span><span class="op" id="2136526">+</span><span class="ident" id="2136527">y</span><span class="op" id="2136528">*</span><span class="op" id="2136529">(</span><span class="ident" id="2136530">_lgamV</span><span class="op" id="2136536">[</span><span class="num" id="2136537">4</span><span class="op" id="2136538">]</span><span class="op" id="2136539">+</span><span class="ident" id="2136540">y</span><span class="op" id="2136541">*</span><span class="ident" id="2136542">_lgamV</span><span class="op" id="2136548">[</span><span class="num" id="2136549">5</span><span class="op" id="2136550">]</span><span class="op" id="2136551">)</span><span class="op" id="2136552">)</span><span class="op" id="2136553">)</span><span class="op" id="2136554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2136559">lgamma</span>&nbsp;<span class="op" id="2136566">+=</span>&nbsp;<span class="op" id="2136569">(</span><span class="op" id="2136570">-</span><span class="num" id="2136571">0.5</span><span class="op" id="2136574">*</span><span class="ident" id="2136575">y</span>&nbsp;<span class="op" id="2136577">+</span>&nbsp;<span class="ident" id="2136579">p1</span><span class="op" id="2136581">/</span><span class="ident" id="2136582">p2</span><span class="op" id="2136584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2136588">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2136591">case</span>&nbsp;<span class="ident" id="2136596">x</span>&nbsp;<span class="op" id="2136598">&lt;</span>&nbsp;<span class="num" id="2136600">8</span><span class="op" id="2136601">:</span>&nbsp;<span class="comment" id="2136603">//&nbsp;2&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;8</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2136619">i</span>&nbsp;<span class="op" id="2136621">:=</span>&nbsp;<span class="builtintype" id="2136624">int</span><span class="op" id="2136627">(</span><span class="ident" id="2136628">x</span><span class="op" id="2136629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2136633">y</span>&nbsp;<span class="op" id="2136635">:=</span>&nbsp;<span class="ident" id="2136638">x</span>&nbsp;<span class="op" id="2136640">-</span>&nbsp;<span class="builtintype" id="2136642">float64</span><span class="op" id="2136649">(</span><span class="ident" id="2136650">i</span><span class="op" id="2136651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2136655">p</span>&nbsp;<span class="op" id="2136657">:=</span>&nbsp;<span class="ident" id="2136660">y</span>&nbsp;<span class="op" id="2136662">*</span>&nbsp;<span class="op" id="2136664">(</span><span class="ident" id="2136665">_lgamS</span><span class="op" id="2136671">[</span><span class="num" id="2136672">0</span><span class="op" id="2136673">]</span>&nbsp;<span class="op" id="2136675">+</span>&nbsp;<span class="ident" id="2136677">y</span><span class="op" id="2136678">*</span><span class="op" id="2136679">(</span><span class="ident" id="2136680">_lgamS</span><span class="op" id="2136686">[</span><span class="num" id="2136687">1</span><span class="op" id="2136688">]</span><span class="op" id="2136689">+</span><span class="ident" id="2136690">y</span><span class="op" id="2136691">*</span><span class="op" id="2136692">(</span><span class="ident" id="2136693">_lgamS</span><span class="op" id="2136699">[</span><span class="num" id="2136700">2</span><span class="op" id="2136701">]</span><span class="op" id="2136702">+</span><span class="ident" id="2136703">y</span><span class="op" id="2136704">*</span><span class="op" id="2136705">(</span><span class="ident" id="2136706">_lgamS</span><span class="op" id="2136712">[</span><span class="num" id="2136713">3</span><span class="op" id="2136714">]</span><span class="op" id="2136715">+</span><span class="ident" id="2136716">y</span><span class="op" id="2136717">*</span><span class="op" id="2136718">(</span><span class="ident" id="2136719">_lgamS</span><span class="op" id="2136725">[</span><span class="num" id="2136726">4</span><span class="op" id="2136727">]</span><span class="op" id="2136728">+</span><span class="ident" id="2136729">y</span><span class="op" id="2136730">*</span><span class="op" id="2136731">(</span><span class="ident" id="2136732">_lgamS</span><span class="op" id="2136738">[</span><span class="num" id="2136739">5</span><span class="op" id="2136740">]</span><span class="op" id="2136741">+</span><span class="ident" id="2136742">y</span><span class="op" id="2136743">*</span><span class="ident" id="2136744">_lgamS</span><span class="op" id="2136750">[</span><span class="num" id="2136751">6</span><span class="op" id="2136752">]</span><span class="op" id="2136753">)</span><span class="op" id="2136754">)</span><span class="op" id="2136755">)</span><span class="op" id="2136756">)</span><span class="op" id="2136757">)</span><span class="op" id="2136758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2136762">q</span>&nbsp;<span class="op" id="2136764">:=</span>&nbsp;<span class="num" id="2136767">1</span>&nbsp;<span class="op" id="2136769">+</span>&nbsp;<span class="ident" id="2136771">y</span><span class="op" id="2136772">*</span><span class="op" id="2136773">(</span><span class="ident" id="2136774">_lgamR</span><span class="op" id="2136780">[</span><span class="num" id="2136781">1</span><span class="op" id="2136782">]</span><span class="op" id="2136783">+</span><span class="ident" id="2136784">y</span><span class="op" id="2136785">*</span><span class="op" id="2136786">(</span><span class="ident" id="2136787">_lgamR</span><span class="op" id="2136793">[</span><span class="num" id="2136794">2</span><span class="op" id="2136795">]</span><span class="op" id="2136796">+</span><span class="ident" id="2136797">y</span><span class="op" id="2136798">*</span><span class="op" id="2136799">(</span><span class="ident" id="2136800">_lgamR</span><span class="op" id="2136806">[</span><span class="num" id="2136807">3</span><span class="op" id="2136808">]</span><span class="op" id="2136809">+</span><span class="ident" id="2136810">y</span><span class="op" id="2136811">*</span><span class="op" id="2136812">(</span><span class="ident" id="2136813">_lgamR</span><span class="op" id="2136819">[</span><span class="num" id="2136820">4</span><span class="op" id="2136821">]</span><span class="op" id="2136822">+</span><span class="ident" id="2136823">y</span><span class="op" id="2136824">*</span><span class="op" id="2136825">(</span><span class="ident" id="2136826">_lgamR</span><span class="op" id="2136832">[</span><span class="num" id="2136833">5</span><span class="op" id="2136834">]</span><span class="op" id="2136835">+</span><span class="ident" id="2136836">y</span><span class="op" id="2136837">*</span><span class="ident" id="2136838">_lgamR</span><span class="op" id="2136844">[</span><span class="num" id="2136845">6</span><span class="op" id="2136846">]</span><span class="op" id="2136847">)</span><span class="op" id="2136848">)</span><span class="op" id="2136849">)</span><span class="op" id="2136850">)</span><span class="op" id="2136851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2136855">lgamma</span>&nbsp;<span class="op" id="2136862">=</span>&nbsp;<span class="num" id="2136864">0.5</span><span class="op" id="2136867">*</span><span class="ident" id="2136868">y</span>&nbsp;<span class="op" id="2136870">+</span>&nbsp;<span class="ident" id="2136872">p</span><span class="op" id="2136873">/</span><span class="ident" id="2136874">q</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2136878">z</span>&nbsp;<span class="op" id="2136880">:=</span>&nbsp;<span class="num" id="2136883">1.0</span>&nbsp;<span class="comment" id="2136887">//&nbsp;Lgamma(1+s)&nbsp;=&nbsp;Log(s)&nbsp;+&nbsp;Lgamma(s)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2136925">switch</span>&nbsp;<span class="ident" id="2136932">i</span>&nbsp;<span class="op" id="2136934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2136938">case</span>&nbsp;<span class="num" id="2136943">7</span><span class="op" id="2136944">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2136949">z</span>&nbsp;<span class="op" id="2136951">*=</span>&nbsp;<span class="op" id="2136954">(</span><span class="ident" id="2136955">y</span>&nbsp;<span class="op" id="2136957">+</span>&nbsp;<span class="num" id="2136959">6</span><span class="op" id="2136960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2136965">fallthrough</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2136979">case</span>&nbsp;<span class="num" id="2136984">6</span><span class="op" id="2136985">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2136990">z</span>&nbsp;<span class="op" id="2136992">*=</span>&nbsp;<span class="op" id="2136995">(</span><span class="ident" id="2136996">y</span>&nbsp;<span class="op" id="2136998">+</span>&nbsp;<span class="num" id="2137000">5</span><span class="op" id="2137001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2137006">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2137020">case</span>&nbsp;<span class="num" id="2137025">5</span><span class="op" id="2137026">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2137031">z</span>&nbsp;<span class="op" id="2137033">*=</span>&nbsp;<span class="op" id="2137036">(</span><span class="ident" id="2137037">y</span>&nbsp;<span class="op" id="2137039">+</span>&nbsp;<span class="num" id="2137041">4</span><span class="op" id="2137042">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2137047">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2137061">case</span>&nbsp;<span class="num" id="2137066">4</span><span class="op" id="2137067">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2137072">z</span>&nbsp;<span class="op" id="2137074">*=</span>&nbsp;<span class="op" id="2137077">(</span><span class="ident" id="2137078">y</span>&nbsp;<span class="op" id="2137080">+</span>&nbsp;<span class="num" id="2137082">3</span><span class="op" id="2137083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2137088">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2137102">case</span>&nbsp;<span class="num" id="2137107">3</span><span class="op" id="2137108">:</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2137113">z</span>&nbsp;<span class="op" id="2137115">*=</span>&nbsp;<span class="op" id="2137118">(</span><span class="ident" id="2137119">y</span>&nbsp;<span class="op" id="2137121">+</span>&nbsp;<span class="num" id="2137123">2</span><span class="op" id="2137124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2137129">lgamma</span>&nbsp;<span class="op" id="2137136">+=</span>&nbsp;<span class="ident" id="2137139">Log</span><span class="op" id="2137142">(</span><span class="ident" id="2137143">z</span><span class="op" id="2137144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2137148">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2137151">case</span>&nbsp;<span class="ident" id="2137156">x</span>&nbsp;<span class="op" id="2137158">&lt;</span>&nbsp;<span class="ident" id="2137160">Two58</span><span class="op" id="2137165">:</span>&nbsp;<span class="comment" id="2137167">//&nbsp;8&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;2**58</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2137187">t</span>&nbsp;<span class="op" id="2137189">:=</span>&nbsp;<span class="ident" id="2137192">Log</span><span class="op" id="2137195">(</span><span class="ident" id="2137196">x</span><span class="op" id="2137197">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2137201">z</span>&nbsp;<span class="op" id="2137203">:=</span>&nbsp;<span class="num" id="2137206">1</span>&nbsp;<span class="op" id="2137208">/</span>&nbsp;<span class="ident" id="2137210">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2137214">y</span>&nbsp;<span class="op" id="2137216">:=</span>&nbsp;<span class="ident" id="2137219">z</span>&nbsp;<span class="op" id="2137221">*</span>&nbsp;<span class="ident" id="2137223">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2137227">w</span>&nbsp;<span class="op" id="2137229">:=</span>&nbsp;<span class="ident" id="2137232">_lgamW</span><span class="op" id="2137238">[</span><span class="num" id="2137239">0</span><span class="op" id="2137240">]</span>&nbsp;<span class="op" id="2137242">+</span>&nbsp;<span class="ident" id="2137244">z</span><span class="op" id="2137245">*</span><span class="op" id="2137246">(</span><span class="ident" id="2137247">_lgamW</span><span class="op" id="2137253">[</span><span class="num" id="2137254">1</span><span class="op" id="2137255">]</span><span class="op" id="2137256">+</span><span class="ident" id="2137257">y</span><span class="op" id="2137258">*</span><span class="op" id="2137259">(</span><span class="ident" id="2137260">_lgamW</span><span class="op" id="2137266">[</span><span class="num" id="2137267">2</span><span class="op" id="2137268">]</span><span class="op" id="2137269">+</span><span class="ident" id="2137270">y</span><span class="op" id="2137271">*</span><span class="op" id="2137272">(</span><span class="ident" id="2137273">_lgamW</span><span class="op" id="2137279">[</span><span class="num" id="2137280">3</span><span class="op" id="2137281">]</span><span class="op" id="2137282">+</span><span class="ident" id="2137283">y</span><span class="op" id="2137284">*</span><span class="op" id="2137285">(</span><span class="ident" id="2137286">_lgamW</span><span class="op" id="2137292">[</span><span class="num" id="2137293">4</span><span class="op" id="2137294">]</span><span class="op" id="2137295">+</span><span class="ident" id="2137296">y</span><span class="op" id="2137297">*</span><span class="op" id="2137298">(</span><span class="ident" id="2137299">_lgamW</span><span class="op" id="2137305">[</span><span class="num" id="2137306">5</span><span class="op" id="2137307">]</span><span class="op" id="2137308">+</span><span class="ident" id="2137309">y</span><span class="op" id="2137310">*</span><span class="ident" id="2137311">_lgamW</span><span class="op" id="2137317">[</span><span class="num" id="2137318">6</span><span class="op" id="2137319">]</span><span class="op" id="2137320">)</span><span class="op" id="2137321">)</span><span class="op" id="2137322">)</span><span class="op" id="2137323">)</span><span class="op" id="2137324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2137328">lgamma</span>&nbsp;<span class="op" id="2137335">=</span>&nbsp;<span class="op" id="2137337">(</span><span class="ident" id="2137338">x</span><span class="op" id="2137339">-</span><span class="num" id="2137340">0.5</span><span class="op" id="2137343">)</span><span class="op" id="2137344">*</span><span class="op" id="2137345">(</span><span class="ident" id="2137346">t</span><span class="op" id="2137347">-</span><span class="num" id="2137348">1</span><span class="op" id="2137349">)</span>&nbsp;<span class="op" id="2137351">+</span>&nbsp;<span class="ident" id="2137353">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2137356">default</span><span class="op" id="2137363">:</span>&nbsp;<span class="comment" id="2137365">//&nbsp;2**58&nbsp;&lt;=&nbsp;x&nbsp;&lt;=&nbsp;Inf</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2137388">lgamma</span>&nbsp;<span class="op" id="2137395">=</span>&nbsp;<span class="ident" id="2137397">x</span>&nbsp;<span class="op" id="2137399">*</span>&nbsp;<span class="op" id="2137401">(</span><span class="ident" id="2137402">Log</span><span class="op" id="2137405">(</span><span class="ident" id="2137406">x</span><span class="op" id="2137407">)</span>&nbsp;<span class="op" id="2137409">-</span>&nbsp;<span class="num" id="2137411">1</span><span class="op" id="2137412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2137415">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2137418">if</span>&nbsp;<span class="ident" id="2137421">neg</span>&nbsp;<span class="op" id="2137425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2137429">lgamma</span>&nbsp;<span class="op" id="2137436">=</span>&nbsp;<span class="ident" id="2137438">nadj</span>&nbsp;<span class="op" id="2137443">-</span>&nbsp;<span class="ident" id="2137445">lgamma</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2137453">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2137456">return</span><br>
<span class="lineno"></span><span class="op" id="2137463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2137466">//&nbsp;sinPi(x)&nbsp;is&nbsp;a&nbsp;helper&nbsp;function&nbsp;for&nbsp;negative&nbsp;x</span><br>
<span class="lineno"></span><span class="keyword" id="2137514">func</span>&nbsp;<span class="ident" id="2137519">sinPi</span><span class="op" id="2137524">(</span><span class="ident" id="2137525">x</span>&nbsp;<span class="builtintype" id="2137527">float64</span><span class="op" id="2137534">)</span>&nbsp;<span class="builtintype" id="2137536">float64</span>&nbsp;<span class="op" id="2137544">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2137547">const</span>&nbsp;<span class="op" id="2137553">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2137557">Two52</span>&nbsp;<span class="op" id="2137563">=</span>&nbsp;<span class="num" id="2137565">1</span>&nbsp;<span class="op" id="2137567">&lt;&lt;</span>&nbsp;<span class="num" id="2137570">52</span>&nbsp;<span class="comment" id="2137573">//&nbsp;0x4330000000000000&nbsp;~4.5036e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2137609">Two53</span>&nbsp;<span class="op" id="2137615">=</span>&nbsp;<span class="num" id="2137617">1</span>&nbsp;<span class="op" id="2137619">&lt;&lt;</span>&nbsp;<span class="num" id="2137622">53</span>&nbsp;<span class="comment" id="2137625">//&nbsp;0x4340000000000000&nbsp;~9.0072e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2137660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2137663">if</span>&nbsp;<span class="ident" id="2137666">x</span>&nbsp;<span class="op" id="2137668">&lt;</span>&nbsp;<span class="num" id="2137670">0.25</span>&nbsp;<span class="op" id="2137675">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2137679">return</span>&nbsp;<span class="op" id="2137686">-</span><span class="ident" id="2137687">Sin</span><span class="op" id="2137690">(</span><span class="ident" id="2137691">Pi</span>&nbsp;<span class="op" id="2137694">*</span>&nbsp;<span class="ident" id="2137696">x</span><span class="op" id="2137697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2137700">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2137704">//&nbsp;argument&nbsp;reduction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2137727">z</span>&nbsp;<span class="op" id="2137729">:=</span>&nbsp;<span class="ident" id="2137732">Floor</span><span class="op" id="2137737">(</span><span class="ident" id="2137738">x</span><span class="op" id="2137739">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2137742">var</span>&nbsp;<span class="ident" id="2137746">n</span>&nbsp;<span class="builtintype" id="2137748">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2137753">if</span>&nbsp;<span class="ident" id="2137756">z</span>&nbsp;<span class="op" id="2137758">!=</span>&nbsp;<span class="ident" id="2137761">x</span>&nbsp;<span class="op" id="2137763">{</span>&nbsp;<span class="comment" id="2137765">//&nbsp;inexact</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2137778">x</span>&nbsp;<span class="op" id="2137780">=</span>&nbsp;<span class="ident" id="2137782">Mod</span><span class="op" id="2137785">(</span><span class="ident" id="2137786">x</span><span class="op" id="2137787">,</span>&nbsp;<span class="num" id="2137789">2</span><span class="op" id="2137790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2137794">n</span>&nbsp;<span class="op" id="2137796">=</span>&nbsp;<span class="builtintype" id="2137798">int</span><span class="op" id="2137801">(</span><span class="ident" id="2137802">x</span>&nbsp;<span class="op" id="2137804">*</span>&nbsp;<span class="num" id="2137806">4</span><span class="op" id="2137807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2137810">}</span>&nbsp;<span class="keyword" id="2137812">else</span>&nbsp;<span class="op" id="2137817">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2137821">if</span>&nbsp;<span class="ident" id="2137824">x</span>&nbsp;<span class="op" id="2137826">&gt;=</span>&nbsp;<span class="ident" id="2137829">Two53</span>&nbsp;<span class="op" id="2137835">{</span>&nbsp;<span class="comment" id="2137837">//&nbsp;x&nbsp;must&nbsp;be&nbsp;even</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2137858">x</span>&nbsp;<span class="op" id="2137860">=</span>&nbsp;<span class="num" id="2137862">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2137867">n</span>&nbsp;<span class="op" id="2137869">=</span>&nbsp;<span class="num" id="2137871">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2137875">}</span>&nbsp;<span class="keyword" id="2137877">else</span>&nbsp;<span class="op" id="2137882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2137887">if</span>&nbsp;<span class="ident" id="2137890">x</span>&nbsp;<span class="op" id="2137892">&lt;</span>&nbsp;<span class="ident" id="2137894">Two52</span>&nbsp;<span class="op" id="2137900">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2137906">z</span>&nbsp;<span class="op" id="2137908">=</span>&nbsp;<span class="ident" id="2137910">x</span>&nbsp;<span class="op" id="2137912">+</span>&nbsp;<span class="ident" id="2137914">Two52</span>&nbsp;<span class="comment" id="2137920">//&nbsp;exact</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2137932">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2137937">n</span>&nbsp;<span class="op" id="2137939">=</span>&nbsp;<span class="builtintype" id="2137941">int</span><span class="op" id="2137944">(</span><span class="num" id="2137945">1</span>&nbsp;<span class="op" id="2137947">&amp;</span>&nbsp;<span class="ident" id="2137949">Float64bits</span><span class="op" id="2137960">(</span><span class="ident" id="2137961">z</span><span class="op" id="2137962">)</span><span class="op" id="2137963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2137968">x</span>&nbsp;<span class="op" id="2137970">=</span>&nbsp;<span class="builtintype" id="2137972">float64</span><span class="op" id="2137979">(</span><span class="ident" id="2137980">n</span><span class="op" id="2137981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2137986">n</span>&nbsp;<span class="op" id="2137988">&lt;&lt;=</span>&nbsp;<span class="num" id="2137992">2</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2137996">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2137999">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2138002">switch</span>&nbsp;<span class="ident" id="2138009">n</span>&nbsp;<span class="op" id="2138011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2138014">case</span>&nbsp;<span class="num" id="2138019">0</span><span class="op" id="2138020">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2138024">x</span>&nbsp;<span class="op" id="2138026">=</span>&nbsp;<span class="ident" id="2138028">Sin</span><span class="op" id="2138031">(</span><span class="ident" id="2138032">Pi</span>&nbsp;<span class="op" id="2138035">*</span>&nbsp;<span class="ident" id="2138037">x</span><span class="op" id="2138038">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2138041">case</span>&nbsp;<span class="num" id="2138046">1</span><span class="op" id="2138047">,</span>&nbsp;<span class="num" id="2138049">2</span><span class="op" id="2138050">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2138054">x</span>&nbsp;<span class="op" id="2138056">=</span>&nbsp;<span class="ident" id="2138058">Cos</span><span class="op" id="2138061">(</span><span class="ident" id="2138062">Pi</span>&nbsp;<span class="op" id="2138065">*</span>&nbsp;<span class="op" id="2138067">(</span><span class="num" id="2138068">0.5</span>&nbsp;<span class="op" id="2138072">-</span>&nbsp;<span class="ident" id="2138074">x</span><span class="op" id="2138075">)</span><span class="op" id="2138076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2138079">case</span>&nbsp;<span class="num" id="2138084">3</span><span class="op" id="2138085">,</span>&nbsp;<span class="num" id="2138087">4</span><span class="op" id="2138088">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2138092">x</span>&nbsp;<span class="op" id="2138094">=</span>&nbsp;<span class="ident" id="2138096">Sin</span><span class="op" id="2138099">(</span><span class="ident" id="2138100">Pi</span>&nbsp;<span class="op" id="2138103">*</span>&nbsp;<span class="op" id="2138105">(</span><span class="num" id="2138106">1</span>&nbsp;<span class="op" id="2138108">-</span>&nbsp;<span class="ident" id="2138110">x</span><span class="op" id="2138111">)</span><span class="op" id="2138112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2138115">case</span>&nbsp;<span class="num" id="2138120">5</span><span class="op" id="2138121">,</span>&nbsp;<span class="num" id="2138123">6</span><span class="op" id="2138124">:</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2138128">x</span>&nbsp;<span class="op" id="2138130">=</span>&nbsp;<span class="op" id="2138132">-</span><span class="ident" id="2138133">Cos</span><span class="op" id="2138136">(</span><span class="ident" id="2138137">Pi</span>&nbsp;<span class="op" id="2138140">*</span>&nbsp;<span class="op" id="2138142">(</span><span class="ident" id="2138143">x</span>&nbsp;<span class="op" id="2138145">-</span>&nbsp;<span class="num" id="2138147">1.5</span><span class="op" id="2138150">)</span><span class="op" id="2138151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2138154">default</span><span class="op" id="2138161">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2138165">x</span>&nbsp;<span class="op" id="2138167">=</span>&nbsp;<span class="ident" id="2138169">Sin</span><span class="op" id="2138172">(</span><span class="ident" id="2138173">Pi</span>&nbsp;<span class="op" id="2138176">*</span>&nbsp;<span class="op" id="2138178">(</span><span class="ident" id="2138179">x</span>&nbsp;<span class="op" id="2138181">-</span>&nbsp;<span class="num" id="2138183">2</span><span class="op" id="2138184">)</span><span class="op" id="2138185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2138188">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2138191">return</span>&nbsp;<span class="op" id="2138198">-</span><span class="ident" id="2138199">x</span><br>
<span class="lineno">365</span><span class="op" id="2138201">}</span>
</div>
</body>
</html>
