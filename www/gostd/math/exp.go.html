<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html" class="current">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2229563">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2229618">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2229672">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2229723">package</span>&nbsp;<span class="ident" id="2229731">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2229737">//&nbsp;Exp&nbsp;returns&nbsp;e**x,&nbsp;the&nbsp;base-e&nbsp;exponential&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2229787">//</span><br>
<span class="lineno"></span><span class="comment" id="2229790">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">10</span><span class="comment" id="2229812">//&nbsp;&nbsp;&nbsp;&nbsp;Exp(+Inf)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2229832">//&nbsp;&nbsp;&nbsp;&nbsp;Exp(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2229850">//&nbsp;Very&nbsp;large&nbsp;values&nbsp;overflow&nbsp;to&nbsp;0&nbsp;or&nbsp;+Inf.</span><br>
<span class="lineno"></span><span class="comment" id="2229894">//&nbsp;Very&nbsp;small&nbsp;values&nbsp;underflow&nbsp;to&nbsp;1.</span><br>
<span class="lineno"></span><span class="keyword" id="2229931">func</span>&nbsp;<span class="ident" id="2229936">Exp</span><span class="op" id="2229939">(</span><span class="ident" id="2229940">x</span>&nbsp;<span class="builtintype" id="2229942">float64</span><span class="op" id="2229949">)</span>&nbsp;<span class="builtintype" id="2229951">float64</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="2229960">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno"></span><span class="comment" id="2230020">//&nbsp;below&nbsp;are&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/e_exp.c</span><br>
<span class="lineno"></span><span class="comment" id="2230078">//&nbsp;and&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="2230137">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">20</span><span class="comment" id="2230167">//</span><br>
<span class="lineno"></span><span class="comment" id="2230170">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2230226">//&nbsp;Copyright&nbsp;(C)&nbsp;2004&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2230295">//</span><br>
<span class="lineno"></span><span class="comment" id="2230298">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno">25</span><span class="comment" id="2230354">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="2230411">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="2230428">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2230484">//</span><br>
<span class="lineno"></span><span class="comment" id="2230487">//</span><br>
<span class="lineno">30</span><span class="comment" id="2230490">//&nbsp;exp(x)</span><br>
<span class="lineno"></span><span class="comment" id="2230500">//&nbsp;Returns&nbsp;the&nbsp;exponential&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2230533">//</span><br>
<span class="lineno"></span><span class="comment" id="2230536">//&nbsp;Method</span><br>
<span class="lineno"></span><span class="comment" id="2230546">//&nbsp;&nbsp;&nbsp;1.&nbsp;Argument&nbsp;reduction:</span><br>
<span class="lineno">35</span><span class="comment" id="2230574">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reduce&nbsp;x&nbsp;to&nbsp;an&nbsp;r&nbsp;so&nbsp;that&nbsp;|r|&nbsp;&lt;=&nbsp;0.5*ln2&nbsp;~&nbsp;0.34658.</span><br>
<span class="lineno"></span><span class="comment" id="2230633">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Given&nbsp;x,&nbsp;find&nbsp;r&nbsp;and&nbsp;integer&nbsp;k&nbsp;such&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2230681">//</span><br>
<span class="lineno"></span><span class="comment" id="2230684">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;=&nbsp;k*ln2&nbsp;+&nbsp;r,&nbsp;&nbsp;|r|&nbsp;&lt;=&nbsp;0.5*ln2.</span><br>
<span class="lineno"></span><span class="comment" id="2230733">//</span><br>
<span class="lineno">40</span><span class="comment" id="2230736">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Here&nbsp;r&nbsp;will&nbsp;be&nbsp;represented&nbsp;as&nbsp;r&nbsp;=&nbsp;hi-lo&nbsp;for&nbsp;better</span><br>
<span class="lineno"></span><span class="comment" id="2230795">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accuracy.</span><br>
<span class="lineno"></span><span class="comment" id="2230813">//</span><br>
<span class="lineno"></span><span class="comment" id="2230816">//&nbsp;&nbsp;&nbsp;2.&nbsp;Approximation&nbsp;of&nbsp;exp(r)&nbsp;by&nbsp;a&nbsp;special&nbsp;rational&nbsp;function&nbsp;on</span><br>
<span class="lineno"></span><span class="comment" id="2230882">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;interval&nbsp;[0,0.34658]:</span><br>
<span class="lineno">45</span><span class="comment" id="2230916">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Write</span><br>
<span class="lineno"></span><span class="comment" id="2230930">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R(r**2)&nbsp;=&nbsp;r*(exp(r)+1)/(exp(r)-1)&nbsp;=&nbsp;2&nbsp;+&nbsp;r*r/6&nbsp;-&nbsp;r**4/360&nbsp;+&nbsp;...</span><br>
<span class="lineno"></span><span class="comment" id="2231005">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;use&nbsp;a&nbsp;special&nbsp;Remes&nbsp;algorithm&nbsp;on&nbsp;[0,0.34658]&nbsp;to&nbsp;generate</span><br>
<span class="lineno"></span><span class="comment" id="2231073">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;polynomial&nbsp;of&nbsp;degree&nbsp;5&nbsp;to&nbsp;approximate&nbsp;R.&nbsp;The&nbsp;maximum&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="2231142">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of&nbsp;this&nbsp;polynomial&nbsp;approximation&nbsp;is&nbsp;bounded&nbsp;by&nbsp;2**-59.&nbsp;In</span><br>
<span class="lineno">50</span><span class="comment" id="2231208">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;other&nbsp;words,</span><br>
<span class="lineno"></span><span class="comment" id="2231229">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R(z)&nbsp;~&nbsp;2.0&nbsp;+&nbsp;P1*z&nbsp;+&nbsp;P2*z**2&nbsp;+&nbsp;P3*z**3&nbsp;+&nbsp;P4*z**4&nbsp;+&nbsp;P5*z**5</span><br>
<span class="lineno"></span><span class="comment" id="2231299">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(where&nbsp;z=r*r,&nbsp;and&nbsp;the&nbsp;values&nbsp;of&nbsp;P1&nbsp;to&nbsp;P5&nbsp;are&nbsp;listed&nbsp;below)</span><br>
<span class="lineno"></span><span class="comment" id="2231366">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2231378">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-59</span><br>
<span class="lineno">55</span><span class="comment" id="2231430">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2.0+P1*z+...+P5*z&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;R(z)&nbsp;|&nbsp;&lt;=&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="2231479">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br>
<span class="lineno"></span><span class="comment" id="2231523">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;computation&nbsp;of&nbsp;exp(r)&nbsp;thus&nbsp;becomes</span><br>
<span class="lineno"></span><span class="comment" id="2231570">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2*r</span><br>
<span class="lineno"></span><span class="comment" id="2231605">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(r)&nbsp;=&nbsp;1&nbsp;+&nbsp;-------</span><br>
<span class="lineno">60</span><span class="comment" id="2231642">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R&nbsp;-&nbsp;r</span><br>
<span class="lineno"></span><span class="comment" id="2231678">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r*R1(r)</span><br>
<span class="lineno"></span><span class="comment" id="2231721">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1&nbsp;+&nbsp;r&nbsp;+&nbsp;-----------&nbsp;(for&nbsp;better&nbsp;accuracy)</span><br>
<span class="lineno"></span><span class="comment" id="2231788">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;-&nbsp;R1(r)</span><br>
<span class="lineno"></span><span class="comment" id="2231832">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno">65</span><span class="comment" id="2231846">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10</span><br>
<span class="lineno"></span><span class="comment" id="2231904">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R1(r)&nbsp;=&nbsp;r&nbsp;-&nbsp;(P1*r&nbsp;&nbsp;+&nbsp;P2*r&nbsp;&nbsp;+&nbsp;...&nbsp;+&nbsp;P5*r&nbsp;&nbsp;&nbsp;).</span><br>
<span class="lineno"></span><span class="comment" id="2231965">//</span><br>
<span class="lineno"></span><span class="comment" id="2231968">//&nbsp;&nbsp;&nbsp;3.&nbsp;Scale&nbsp;back&nbsp;to&nbsp;obtain&nbsp;exp(x):</span><br>
<span class="lineno"></span><span class="comment" id="2232005">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;From&nbsp;step&nbsp;1,&nbsp;we&nbsp;have</span><br>
<span class="lineno">70</span><span class="comment" id="2232034">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(x)&nbsp;=&nbsp;2**k&nbsp;*&nbsp;exp(r)</span><br>
<span class="lineno"></span><span class="comment" id="2232068">//</span><br>
<span class="lineno"></span><span class="comment" id="2232071">//&nbsp;Special&nbsp;cases:</span><br>
<span class="lineno"></span><span class="comment" id="2232089">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(INF)&nbsp;is&nbsp;INF,&nbsp;exp(NaN)&nbsp;is&nbsp;NaN;</span><br>
<span class="lineno"></span><span class="comment" id="2232131">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-INF)&nbsp;is&nbsp;0,&nbsp;and</span><br>
<span class="lineno">75</span><span class="comment" id="2232159">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;finite&nbsp;argument,&nbsp;only&nbsp;exp(0)=1&nbsp;is&nbsp;exact.</span><br>
<span class="lineno"></span><span class="comment" id="2232212">//</span><br>
<span class="lineno"></span><span class="comment" id="2232215">//&nbsp;Accuracy:</span><br>
<span class="lineno"></span><span class="comment" id="2232228">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;according&nbsp;to&nbsp;an&nbsp;error&nbsp;analysis,&nbsp;the&nbsp;error&nbsp;is&nbsp;always&nbsp;less&nbsp;than</span><br>
<span class="lineno"></span><span class="comment" id="2232298">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;ulp&nbsp;(unit&nbsp;in&nbsp;the&nbsp;last&nbsp;place).</span><br>
<span class="lineno">80</span><span class="comment" id="2232338">//</span><br>
<span class="lineno"></span><span class="comment" id="2232341">//&nbsp;Misc.&nbsp;info.</span><br>
<span class="lineno"></span><span class="comment" id="2232356">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;IEEE&nbsp;double</span><br>
<span class="lineno"></span><span class="comment" id="2232380">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;&nbsp;7.09782712893383973096e+02&nbsp;then&nbsp;exp(x)&nbsp;overflow</span><br>
<span class="lineno"></span><span class="comment" id="2232448">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;-7.45133219101941108420e+02&nbsp;then&nbsp;exp(x)&nbsp;underflow</span><br>
<span class="lineno">85</span><span class="comment" id="2232517">//</span><br>
<span class="lineno"></span><span class="comment" id="2232520">//&nbsp;Constants:</span><br>
<span class="lineno"></span><span class="comment" id="2232534">//&nbsp;The&nbsp;hexadecimal&nbsp;values&nbsp;are&nbsp;the&nbsp;intended&nbsp;ones&nbsp;for&nbsp;the&nbsp;following</span><br>
<span class="lineno"></span><span class="comment" id="2232600">//&nbsp;constants.&nbsp;The&nbsp;decimal&nbsp;values&nbsp;may&nbsp;be&nbsp;used,&nbsp;provided&nbsp;that&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2232664">//&nbsp;compiler&nbsp;will&nbsp;convert&nbsp;from&nbsp;decimal&nbsp;to&nbsp;binary&nbsp;accurately&nbsp;enough</span><br>
<span class="lineno">90</span><span class="comment" id="2232730">//&nbsp;to&nbsp;produce&nbsp;the&nbsp;hexadecimal&nbsp;values&nbsp;shown.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2232775">func</span>&nbsp;<span class="ident" id="2232780">exp</span><span class="op" id="2232783">(</span><span class="ident" id="2232784">x</span>&nbsp;<span class="builtintype" id="2232786">float64</span><span class="op" id="2232793">)</span>&nbsp;<span class="builtintype" id="2232795">float64</span>&nbsp;<span class="op" id="2232803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2232806">const</span>&nbsp;<span class="op" id="2232812">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2232816">Ln2Hi</span>&nbsp;<span class="op" id="2232822">=</span>&nbsp;<span class="num" id="2232824">6.93147180369123816490e-01</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2232853">Ln2Lo</span>&nbsp;<span class="op" id="2232859">=</span>&nbsp;<span class="num" id="2232861">1.90821492927058770002e-10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2232890">Log2e</span>&nbsp;<span class="op" id="2232896">=</span>&nbsp;<span class="num" id="2232898">1.44269504088896338700e+00</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2232928">Overflow</span>&nbsp;&nbsp;<span class="op" id="2232938">=</span>&nbsp;<span class="num" id="2232940">7.09782712893383973096e+02</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2232969">Underflow</span>&nbsp;<span class="op" id="2232979">=</span>&nbsp;<span class="op" id="2232981">-</span><span class="num" id="2232982">7.45133219101941108420e+02</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2233011">NearZero</span>&nbsp;&nbsp;<span class="op" id="2233021">=</span>&nbsp;<span class="num" id="2233023">1.0</span>&nbsp;<span class="op" id="2233027">/</span>&nbsp;<span class="op" id="2233029">(</span><span class="num" id="2233030">1</span>&nbsp;<span class="op" id="2233032">&lt;&lt;</span>&nbsp;<span class="num" id="2233035">28</span><span class="op" id="2233037">)</span>&nbsp;<span class="comment" id="2233039">//&nbsp;2**-28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2233050">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2233054">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2233072">switch</span>&nbsp;<span class="op" id="2233079">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2233082">case</span>&nbsp;<span class="ident" id="2233087"><a href="/gostd/math/bits.go.html#2211423">IsNaN</a></span><span class="op" id="2233092">(</span><span class="ident" id="2233093"><a href="/gostd/math/exp.go.html#2232784">x</a></span><span class="op" id="2233094">)</span>&nbsp;<span class="op" id="2233096">||</span>&nbsp;<span class="ident" id="2233099"><a href="/gostd/math/bits.go.html#2211921">IsInf</a></span><span class="op" id="2233104">(</span><span class="ident" id="2233105"><a href="/gostd/math/exp.go.html#2232784">x</a></span><span class="op" id="2233106">,</span>&nbsp;<span class="num" id="2233108">1</span><span class="op" id="2233109">)</span><span class="op" id="2233110">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2233114">return</span>&nbsp;<span class="ident" id="2233121"><a href="/gostd/math/exp.go.html#2232784">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2233124">case</span>&nbsp;<span class="ident" id="2233129"><a href="/gostd/math/bits.go.html#2211921">IsInf</a></span><span class="op" id="2233134">(</span><span class="ident" id="2233135"><a href="/gostd/math/exp.go.html#2232784">x</a></span><span class="op" id="2233136">,</span>&nbsp;<span class="op" id="2233138">-</span><span class="num" id="2233139">1</span><span class="op" id="2233140">)</span><span class="op" id="2233141">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2233145">return</span>&nbsp;<span class="num" id="2233152">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2233155">case</span>&nbsp;<span class="ident" id="2233160"><a href="/gostd/math/exp.go.html#2232784">x</a></span>&nbsp;<span class="op" id="2233162">&gt;</span>&nbsp;<span class="ident" id="2233164"><a href="/gostd/math/exp.go.html#2232928">Overflow</a></span><span class="op" id="2233172">:</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2233176">return</span>&nbsp;<span class="ident" id="2233183"><a href="/gostd/math/bits.go.html#2211123">Inf</a></span><span class="op" id="2233186">(</span><span class="num" id="2233187">1</span><span class="op" id="2233188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2233191">case</span>&nbsp;<span class="ident" id="2233196"><a href="/gostd/math/exp.go.html#2232784">x</a></span>&nbsp;<span class="op" id="2233198">&lt;</span>&nbsp;<span class="ident" id="2233200"><a href="/gostd/math/exp.go.html#2232969">Underflow</a></span><span class="op" id="2233209">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2233213">return</span>&nbsp;<span class="num" id="2233220">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2233223">case</span>&nbsp;<span class="op" id="2233228">-</span><span class="ident" id="2233229"><a href="/gostd/math/exp.go.html#2233011">NearZero</a></span>&nbsp;<span class="op" id="2233238">&lt;</span>&nbsp;<span class="ident" id="2233240"><a href="/gostd/math/exp.go.html#2232784">x</a></span>&nbsp;<span class="op" id="2233242">&amp;&amp;</span>&nbsp;<span class="ident" id="2233245"><a href="/gostd/math/exp.go.html#2232784">x</a></span>&nbsp;<span class="op" id="2233247">&lt;</span>&nbsp;<span class="ident" id="2233249"><a href="/gostd/math/exp.go.html#2233011">NearZero</a></span><span class="op" id="2233257">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2233261">return</span>&nbsp;<span class="num" id="2233268">1</span>&nbsp;<span class="op" id="2233270">+</span>&nbsp;<span class="ident" id="2233272"><a href="/gostd/math/exp.go.html#2232784">x</a></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2233275">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2233279">//&nbsp;reduce;&nbsp;computed&nbsp;as&nbsp;r&nbsp;=&nbsp;hi&nbsp;-&nbsp;lo&nbsp;for&nbsp;extra&nbsp;precision.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2233336">var</span>&nbsp;<span class="ident" id="2233340">k</span>&nbsp;<span class="builtintype" id="2233342">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2233347">switch</span>&nbsp;<span class="op" id="2233354">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2233357">case</span>&nbsp;<span class="ident" id="2233362"><a href="/gostd/math/exp.go.html#2232784">x</a></span>&nbsp;<span class="op" id="2233364">&lt;</span>&nbsp;<span class="num" id="2233366">0</span><span class="op" id="2233367">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2233371"><a href="/gostd/math/exp.go.html#2233340">k</a></span>&nbsp;<span class="op" id="2233373">=</span>&nbsp;<span class="builtintype" id="2233375">int</span><span class="op" id="2233378">(</span><span class="ident" id="2233379"><a href="/gostd/math/exp.go.html#2232890">Log2e</a></span><span class="op" id="2233384">*</span><span class="ident" id="2233385"><a href="/gostd/math/exp.go.html#2232784">x</a></span>&nbsp;<span class="op" id="2233387">-</span>&nbsp;<span class="num" id="2233389">0.5</span><span class="op" id="2233392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2233395">case</span>&nbsp;<span class="ident" id="2233400"><a href="/gostd/math/exp.go.html#2232784">x</a></span>&nbsp;<span class="op" id="2233402">&gt;</span>&nbsp;<span class="num" id="2233404">0</span><span class="op" id="2233405">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2233409"><a href="/gostd/math/exp.go.html#2233340">k</a></span>&nbsp;<span class="op" id="2233411">=</span>&nbsp;<span class="builtintype" id="2233413">int</span><span class="op" id="2233416">(</span><span class="ident" id="2233417"><a href="/gostd/math/exp.go.html#2232890">Log2e</a></span><span class="op" id="2233422">*</span><span class="ident" id="2233423"><a href="/gostd/math/exp.go.html#2232784">x</a></span>&nbsp;<span class="op" id="2233425">+</span>&nbsp;<span class="num" id="2233427">0.5</span><span class="op" id="2233430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2233433">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2233436">hi</span>&nbsp;<span class="op" id="2233439">:=</span>&nbsp;<span class="ident" id="2233442"><a href="/gostd/math/exp.go.html#2232784">x</a></span>&nbsp;<span class="op" id="2233444">-</span>&nbsp;<span class="builtintype" id="2233446">float64</span><span class="op" id="2233453">(</span><span class="ident" id="2233454"><a href="/gostd/math/exp.go.html#2233340">k</a></span><span class="op" id="2233455">)</span><span class="op" id="2233456">*</span><span class="ident" id="2233457"><a href="/gostd/math/exp.go.html#2232816">Ln2Hi</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2233464">lo</span>&nbsp;<span class="op" id="2233467">:=</span>&nbsp;<span class="builtintype" id="2233470">float64</span><span class="op" id="2233477">(</span><span class="ident" id="2233478"><a href="/gostd/math/exp.go.html#2233340">k</a></span><span class="op" id="2233479">)</span>&nbsp;<span class="op" id="2233481">*</span>&nbsp;<span class="ident" id="2233483"><a href="/gostd/math/exp.go.html#2232853">Ln2Lo</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2233491">//&nbsp;compute</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2233503">return</span>&nbsp;<span class="ident" id="2233510"><a href="/gostd/math/exp.go.html#2234383">expmulti</a></span><span class="op" id="2233518">(</span><span class="ident" id="2233519"><a href="/gostd/math/exp.go.html#2233436">hi</a></span><span class="op" id="2233521">,</span>&nbsp;<span class="ident" id="2233523"><a href="/gostd/math/exp.go.html#2233464">lo</a></span><span class="op" id="2233525">,</span>&nbsp;<span class="ident" id="2233527"><a href="/gostd/math/exp.go.html#2233340">k</a></span><span class="op" id="2233528">)</span><br>
<span class="lineno">130</span><span class="op" id="2233530">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2233533">//&nbsp;Exp2&nbsp;returns&nbsp;2**x,&nbsp;the&nbsp;base-2&nbsp;exponential&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2233584">//</span><br>
<span class="lineno"></span><span class="comment" id="2233587">//&nbsp;Special&nbsp;cases&nbsp;are&nbsp;the&nbsp;same&nbsp;as&nbsp;Exp.</span><br>
<span class="lineno">135</span><span class="keyword" id="2233625">func</span>&nbsp;<span class="ident" id="2233630">Exp2</span><span class="op" id="2233634">(</span><span class="ident" id="2233635">x</span>&nbsp;<span class="builtintype" id="2233637">float64</span><span class="op" id="2233644">)</span>&nbsp;<span class="builtintype" id="2233646">float64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2233655">func</span>&nbsp;<span class="ident" id="2233660">exp2</span><span class="op" id="2233664">(</span><span class="ident" id="2233665">x</span>&nbsp;<span class="builtintype" id="2233667">float64</span><span class="op" id="2233674">)</span>&nbsp;<span class="builtintype" id="2233676">float64</span>&nbsp;<span class="op" id="2233684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2233687">const</span>&nbsp;<span class="op" id="2233693">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2233697">Ln2Hi</span>&nbsp;<span class="op" id="2233703">=</span>&nbsp;<span class="num" id="2233705">6.93147180369123816490e-01</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2233734">Ln2Lo</span>&nbsp;<span class="op" id="2233740">=</span>&nbsp;<span class="num" id="2233742">1.90821492927058770002e-10</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2233772">Overflow</span>&nbsp;&nbsp;<span class="op" id="2233782">=</span>&nbsp;<span class="num" id="2233784">1.0239999999999999e+03</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2233809">Underflow</span>&nbsp;<span class="op" id="2233819">=</span>&nbsp;<span class="op" id="2233821">-</span><span class="num" id="2233822">1.0740e+03</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2233834">)</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2233838">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2233856">switch</span>&nbsp;<span class="op" id="2233863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2233866">case</span>&nbsp;<span class="ident" id="2233871"><a href="/gostd/math/bits.go.html#2211423">IsNaN</a></span><span class="op" id="2233876">(</span><span class="ident" id="2233877"><a href="/gostd/math/exp.go.html#2233665">x</a></span><span class="op" id="2233878">)</span>&nbsp;<span class="op" id="2233880">||</span>&nbsp;<span class="ident" id="2233883"><a href="/gostd/math/bits.go.html#2211921">IsInf</a></span><span class="op" id="2233888">(</span><span class="ident" id="2233889"><a href="/gostd/math/exp.go.html#2233665">x</a></span><span class="op" id="2233890">,</span>&nbsp;<span class="num" id="2233892">1</span><span class="op" id="2233893">)</span><span class="op" id="2233894">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2233898">return</span>&nbsp;<span class="ident" id="2233905"><a href="/gostd/math/exp.go.html#2233665">x</a></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2233908">case</span>&nbsp;<span class="ident" id="2233913"><a href="/gostd/math/bits.go.html#2211921">IsInf</a></span><span class="op" id="2233918">(</span><span class="ident" id="2233919"><a href="/gostd/math/exp.go.html#2233665">x</a></span><span class="op" id="2233920">,</span>&nbsp;<span class="op" id="2233922">-</span><span class="num" id="2233923">1</span><span class="op" id="2233924">)</span><span class="op" id="2233925">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2233929">return</span>&nbsp;<span class="num" id="2233936">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2233939">case</span>&nbsp;<span class="ident" id="2233944"><a href="/gostd/math/exp.go.html#2233665">x</a></span>&nbsp;<span class="op" id="2233946">&gt;</span>&nbsp;<span class="ident" id="2233948"><a href="/gostd/math/exp.go.html#2233772">Overflow</a></span><span class="op" id="2233956">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2233960">return</span>&nbsp;<span class="ident" id="2233967"><a href="/gostd/math/bits.go.html#2211123">Inf</a></span><span class="op" id="2233970">(</span><span class="num" id="2233971">1</span><span class="op" id="2233972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2233975">case</span>&nbsp;<span class="ident" id="2233980"><a href="/gostd/math/exp.go.html#2233665">x</a></span>&nbsp;<span class="op" id="2233982">&lt;</span>&nbsp;<span class="ident" id="2233984"><a href="/gostd/math/exp.go.html#2233809">Underflow</a></span><span class="op" id="2233993">:</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2233997">return</span>&nbsp;<span class="num" id="2234004">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2234007">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2234011">//&nbsp;argument&nbsp;reduction;&nbsp;x&nbsp;=&nbsp;r×lg(e)&nbsp;+&nbsp;k&nbsp;with&nbsp;|r|&nbsp;≤&nbsp;ln(2)/2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2234074">//&nbsp;computed&nbsp;as&nbsp;r&nbsp;=&nbsp;hi&nbsp;-&nbsp;lo&nbsp;for&nbsp;extra&nbsp;precision.</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2234123">var</span>&nbsp;<span class="ident" id="2234127">k</span>&nbsp;<span class="builtintype" id="2234129">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2234134">switch</span>&nbsp;<span class="op" id="2234141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2234144">case</span>&nbsp;<span class="ident" id="2234149"><a href="/gostd/math/exp.go.html#2233665">x</a></span>&nbsp;<span class="op" id="2234151">&gt;</span>&nbsp;<span class="num" id="2234153">0</span><span class="op" id="2234154">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2234158"><a href="/gostd/math/exp.go.html#2234127">k</a></span>&nbsp;<span class="op" id="2234160">=</span>&nbsp;<span class="builtintype" id="2234162">int</span><span class="op" id="2234165">(</span><span class="ident" id="2234166"><a href="/gostd/math/exp.go.html#2233665">x</a></span>&nbsp;<span class="op" id="2234168">+</span>&nbsp;<span class="num" id="2234170">0.5</span><span class="op" id="2234173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2234176">case</span>&nbsp;<span class="ident" id="2234181"><a href="/gostd/math/exp.go.html#2233665">x</a></span>&nbsp;<span class="op" id="2234183">&lt;</span>&nbsp;<span class="num" id="2234185">0</span><span class="op" id="2234186">:</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2234190"><a href="/gostd/math/exp.go.html#2234127">k</a></span>&nbsp;<span class="op" id="2234192">=</span>&nbsp;<span class="builtintype" id="2234194">int</span><span class="op" id="2234197">(</span><span class="ident" id="2234198"><a href="/gostd/math/exp.go.html#2233665">x</a></span>&nbsp;<span class="op" id="2234200">-</span>&nbsp;<span class="num" id="2234202">0.5</span><span class="op" id="2234205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2234208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2234211">t</span>&nbsp;<span class="op" id="2234213">:=</span>&nbsp;<span class="ident" id="2234216"><a href="/gostd/math/exp.go.html#2233665">x</a></span>&nbsp;<span class="op" id="2234218">-</span>&nbsp;<span class="builtintype" id="2234220">float64</span><span class="op" id="2234227">(</span><span class="ident" id="2234228"><a href="/gostd/math/exp.go.html#2234127">k</a></span><span class="op" id="2234229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2234232">hi</span>&nbsp;<span class="op" id="2234235">:=</span>&nbsp;<span class="ident" id="2234238"><a href="/gostd/math/exp.go.html#2234211">t</a></span>&nbsp;<span class="op" id="2234240">*</span>&nbsp;<span class="ident" id="2234242"><a href="/gostd/math/exp.go.html#2233697">Ln2Hi</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2234249">lo</span>&nbsp;<span class="op" id="2234252">:=</span>&nbsp;<span class="op" id="2234255">-</span><span class="ident" id="2234256"><a href="/gostd/math/exp.go.html#2234211">t</a></span>&nbsp;<span class="op" id="2234258">*</span>&nbsp;<span class="ident" id="2234260"><a href="/gostd/math/exp.go.html#2233734">Ln2Lo</a></span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2234268">//&nbsp;compute</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2234280">return</span>&nbsp;<span class="ident" id="2234287"><a href="/gostd/math/exp.go.html#2234383">expmulti</a></span><span class="op" id="2234295">(</span><span class="ident" id="2234296"><a href="/gostd/math/exp.go.html#2234232">hi</a></span><span class="op" id="2234298">,</span>&nbsp;<span class="ident" id="2234300"><a href="/gostd/math/exp.go.html#2234249">lo</a></span><span class="op" id="2234302">,</span>&nbsp;<span class="ident" id="2234304"><a href="/gostd/math/exp.go.html#2234127">k</a></span><span class="op" id="2234305">)</span><br>
<span class="lineno"></span><span class="op" id="2234307">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="comment" id="2234310">//&nbsp;exp1&nbsp;returns&nbsp;e**r&nbsp;×&nbsp;2**k&nbsp;where&nbsp;r&nbsp;=&nbsp;hi&nbsp;-&nbsp;lo&nbsp;and&nbsp;|r|&nbsp;≤&nbsp;ln(2)/2.</span><br>
<span class="lineno"></span><span class="keyword" id="2234378">func</span>&nbsp;<span class="ident" id="2234383">expmulti</span><span class="op" id="2234391">(</span><span class="ident" id="2234392">hi</span><span class="op" id="2234394">,</span>&nbsp;<span class="ident" id="2234396">lo</span>&nbsp;<span class="builtintype" id="2234399">float64</span><span class="op" id="2234406">,</span>&nbsp;<span class="ident" id="2234408">k</span>&nbsp;<span class="builtintype" id="2234410">int</span><span class="op" id="2234413">)</span>&nbsp;<span class="builtintype" id="2234415">float64</span>&nbsp;<span class="op" id="2234423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2234426">const</span>&nbsp;<span class="op" id="2234432">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2234436">P1</span>&nbsp;<span class="op" id="2234439">=</span>&nbsp;<span class="num" id="2234441">1.66666666666666019037e-01</span>&nbsp;&nbsp;<span class="comment" id="2234469">/*&nbsp;0x3FC55555;&nbsp;0x5555553E&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2234500">P2</span>&nbsp;<span class="op" id="2234503">=</span>&nbsp;<span class="op" id="2234505">-</span><span class="num" id="2234506">2.77777777770155933842e-03</span>&nbsp;<span class="comment" id="2234533">/*&nbsp;0xBF66C16C;&nbsp;0x16BEBD93&nbsp;*/</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2234564">P3</span>&nbsp;<span class="op" id="2234567">=</span>&nbsp;<span class="num" id="2234569">6.61375632143793436117e-05</span>&nbsp;&nbsp;<span class="comment" id="2234597">/*&nbsp;0x3F11566A;&nbsp;0xAF25DE2C&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2234628">P4</span>&nbsp;<span class="op" id="2234631">=</span>&nbsp;<span class="op" id="2234633">-</span><span class="num" id="2234634">1.65339022054652515390e-06</span>&nbsp;<span class="comment" id="2234661">/*&nbsp;0xBEBBBD41;&nbsp;0xC5D26BF1&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2234692">P5</span>&nbsp;<span class="op" id="2234695">=</span>&nbsp;<span class="num" id="2234697">4.13813679705723846039e-08</span>&nbsp;&nbsp;<span class="comment" id="2234725">/*&nbsp;0x3E663769;&nbsp;0x72BEA4D0&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2234755">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2234759">r</span>&nbsp;<span class="op" id="2234761">:=</span>&nbsp;<span class="ident" id="2234764"><a href="/gostd/math/exp.go.html#2234392">hi</a></span>&nbsp;<span class="op" id="2234767">-</span>&nbsp;<span class="ident" id="2234769"><a href="/gostd/math/exp.go.html#2234396">lo</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2234773">t</span>&nbsp;<span class="op" id="2234775">:=</span>&nbsp;<span class="ident" id="2234778"><a href="/gostd/math/exp.go.html#2234759">r</a></span>&nbsp;<span class="op" id="2234780">*</span>&nbsp;<span class="ident" id="2234782"><a href="/gostd/math/exp.go.html#2234759">r</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2234785">c</span>&nbsp;<span class="op" id="2234787">:=</span>&nbsp;<span class="ident" id="2234790"><a href="/gostd/math/exp.go.html#2234759">r</a></span>&nbsp;<span class="op" id="2234792">-</span>&nbsp;<span class="ident" id="2234794"><a href="/gostd/math/exp.go.html#2234773">t</a></span><span class="op" id="2234795">*</span><span class="op" id="2234796">(</span><span class="ident" id="2234797"><a href="/gostd/math/exp.go.html#2234436">P1</a></span><span class="op" id="2234799">+</span><span class="ident" id="2234800"><a href="/gostd/math/exp.go.html#2234773">t</a></span><span class="op" id="2234801">*</span><span class="op" id="2234802">(</span><span class="ident" id="2234803"><a href="/gostd/math/exp.go.html#2234500">P2</a></span><span class="op" id="2234805">+</span><span class="ident" id="2234806"><a href="/gostd/math/exp.go.html#2234773">t</a></span><span class="op" id="2234807">*</span><span class="op" id="2234808">(</span><span class="ident" id="2234809"><a href="/gostd/math/exp.go.html#2234564">P3</a></span><span class="op" id="2234811">+</span><span class="ident" id="2234812"><a href="/gostd/math/exp.go.html#2234773">t</a></span><span class="op" id="2234813">*</span><span class="op" id="2234814">(</span><span class="ident" id="2234815"><a href="/gostd/math/exp.go.html#2234628">P4</a></span><span class="op" id="2234817">+</span><span class="ident" id="2234818"><a href="/gostd/math/exp.go.html#2234773">t</a></span><span class="op" id="2234819">*</span><span class="ident" id="2234820"><a href="/gostd/math/exp.go.html#2234692">P5</a></span><span class="op" id="2234822">)</span><span class="op" id="2234823">)</span><span class="op" id="2234824">)</span><span class="op" id="2234825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2234828">y</span>&nbsp;<span class="op" id="2234830">:=</span>&nbsp;<span class="num" id="2234833">1</span>&nbsp;<span class="op" id="2234835">-</span>&nbsp;<span class="op" id="2234837">(</span><span class="op" id="2234838">(</span><span class="ident" id="2234839"><a href="/gostd/math/exp.go.html#2234396">lo</a></span>&nbsp;<span class="op" id="2234842">-</span>&nbsp;<span class="op" id="2234844">(</span><span class="ident" id="2234845"><a href="/gostd/math/exp.go.html#2234759">r</a></span><span class="op" id="2234846">*</span><span class="ident" id="2234847"><a href="/gostd/math/exp.go.html#2234785">c</a></span><span class="op" id="2234848">)</span><span class="op" id="2234849">/</span><span class="op" id="2234850">(</span><span class="num" id="2234851">2</span><span class="op" id="2234852">-</span><span class="ident" id="2234853"><a href="/gostd/math/exp.go.html#2234785">c</a></span><span class="op" id="2234854">)</span><span class="op" id="2234855">)</span>&nbsp;<span class="op" id="2234857">-</span>&nbsp;<span class="ident" id="2234859"><a href="/gostd/math/exp.go.html#2234392">hi</a></span><span class="op" id="2234861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2234864">//&nbsp;TODO(rsc):&nbsp;make&nbsp;sure&nbsp;Ldexp&nbsp;can&nbsp;handle&nbsp;boundary&nbsp;k</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2234917">return</span>&nbsp;<span class="ident" id="2234924"><a href="/gostd/math/ldexp.go.html#2285999">Ldexp</a></span><span class="op" id="2234929">(</span><span class="ident" id="2234930"><a href="/gostd/math/exp.go.html#2234828">y</a></span><span class="op" id="2234931">,</span>&nbsp;<span class="ident" id="2234933"><a href="/gostd/math/exp.go.html#2234408">k</a></span><span class="op" id="2234934">)</span><br>
<span class="lineno"></span><span class="op" id="2234936">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
