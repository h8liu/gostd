<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>os</h2>
<ul>
<li><a href="/gostd/os/dir_unix.go.html">dir_unix.go</a></li>
<li><a href="/gostd/os/doc.go.html">doc.go</a></li>
<li><a href="/gostd/os/env.go.html">env.go</a></li>
<li><a href="/gostd/os/env_test.go.html">env_test.go</a></li>
<li><a href="/gostd/os/env_unix_test.go.html">env_unix_test.go</a></li>
<li><a href="/gostd/os/error.go.html">error.go</a></li>
<li><a href="/gostd/os/error_test.go.html">error_test.go</a></li>
<li><a href="/gostd/os/error_unix.go.html">error_unix.go</a></li>
<li><a href="/gostd/os/exec.go.html">exec.go</a></li>
<li><a href="/gostd/os/exec_posix.go.html">exec_posix.go</a></li>
<li><a href="/gostd/os/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/os/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/os/file.go.html">file.go</a></li>
<li><a href="/gostd/os/file_posix.go.html">file_posix.go</a></li>
<li><a href="/gostd/os/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/os/getwd.go.html">getwd.go</a></li>
<li><a href="/gostd/os/os_test.go.html">os_test.go</a></li>
<li><a href="/gostd/os/os_unix_test.go.html">os_unix_test.go</a></li>
<li><a href="/gostd/os/path.go.html">path.go</a></li>
<li><a href="/gostd/os/path_test.go.html">path_test.go</a></li>
<li><a href="/gostd/os/path_unix.go.html">path_unix.go</a></li>
<li><a href="/gostd/os/pipe_linux.go.html" class="current">pipe_linux.go</a></li>
<li><a href="/gostd/os/proc.go.html">proc.go</a></li>
<li><a href="/gostd/os/stat_linux.go.html">stat_linux.go</a></li>
<li><a href="/gostd/os/sys_linux.go.html">sys_linux.go</a></li>
<li><a href="/gostd/os/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/os/types.go.html">types.go</a></li>
<li><a href="/gostd/os/types_notwin.go.html">types_notwin.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2361109">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2361164">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2361218">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2361269">package</span>&nbsp;<span class="ident" id="2361277">os</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2361281">import</span>&nbsp;<span class="string" id="2361288">&#34;syscall&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2361299">//&nbsp;Pipe&nbsp;returns&nbsp;a&nbsp;connected&nbsp;pair&nbsp;of&nbsp;Files;&nbsp;reads&nbsp;from&nbsp;r&nbsp;return&nbsp;bytes&nbsp;written&nbsp;to&nbsp;w.</span><br>
<span class="lineno">10</span><span class="comment" id="2361382">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;files&nbsp;and&nbsp;an&nbsp;error,&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span><span class="keyword" id="2361428">func</span>&nbsp;<span class="ident" id="2361433">Pipe</span><span class="op" id="2361437">(</span><span class="op" id="2361438">)</span>&nbsp;<span class="op" id="2361440">(</span><span class="ident" id="2361441">r</span>&nbsp;<span class="op" id="2361443">*</span><span class="ident" id="2361444">File</span><span class="op" id="2361448">,</span>&nbsp;<span class="ident" id="2361450">w</span>&nbsp;<span class="op" id="2361452">*</span><span class="ident" id="2361453">File</span><span class="op" id="2361457">,</span>&nbsp;<span class="ident" id="2361459">err</span>&nbsp;<span class="builtintype" id="2361463">error</span><span class="op" id="2361468">)</span>&nbsp;<span class="op" id="2361470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2361473">var</span>&nbsp;<span class="ident" id="2361477">p</span>&nbsp;<span class="op" id="2361479">[</span><span class="num" id="2361480">2</span><span class="op" id="2361481">]</span><span class="builtintype" id="2361482">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2361488">e</span>&nbsp;<span class="op" id="2361490">:=</span>&nbsp;<span class="ident" id="2361493">syscall</span><span class="op" id="2361500">.</span><span class="ident" id="2361501">Pipe2</span><span class="op" id="2361506">(</span><span class="ident" id="2361507">p</span><span class="op" id="2361508">[</span><span class="num" id="2361509">0</span><span class="op" id="2361510">:</span><span class="op" id="2361511">]</span><span class="op" id="2361512">,</span>&nbsp;<span class="ident" id="2361514">syscall</span><span class="op" id="2361521">.</span><span class="ident" id="2361522">O_CLOEXEC</span><span class="op" id="2361531">)</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2361534">//&nbsp;pipe2&nbsp;was&nbsp;added&nbsp;in&nbsp;2.6.27&nbsp;and&nbsp;our&nbsp;minimum&nbsp;requirement&nbsp;is&nbsp;2.6.23,&nbsp;so&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2361609">//&nbsp;might&nbsp;not&nbsp;be&nbsp;implemented.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2361639">if</span>&nbsp;<span class="ident" id="2361642">e</span>&nbsp;<span class="op" id="2361644">==</span>&nbsp;<span class="ident" id="2361647">syscall</span><span class="op" id="2361654">.</span><span class="ident" id="2361655">ENOSYS</span>&nbsp;<span class="op" id="2361662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2361666">//&nbsp;See&nbsp;../syscall/exec.go&nbsp;for&nbsp;description&nbsp;of&nbsp;lock.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2361719">syscall</span><span class="op" id="2361726">.</span><span class="ident" id="2361727">ForkLock</span><span class="op" id="2361735">.</span><span class="ident" id="2361736">RLock</span><span class="op" id="2361741">(</span><span class="op" id="2361742">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2361746">e</span>&nbsp;<span class="op" id="2361748">=</span>&nbsp;<span class="ident" id="2361750">syscall</span><span class="op" id="2361757">.</span><span class="ident" id="2361758">Pipe</span><span class="op" id="2361762">(</span><span class="ident" id="2361763">p</span><span class="op" id="2361764">[</span><span class="num" id="2361765">0</span><span class="op" id="2361766">:</span><span class="op" id="2361767">]</span><span class="op" id="2361768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2361772">if</span>&nbsp;<span class="ident" id="2361775">e</span>&nbsp;<span class="op" id="2361777">!=</span>&nbsp;<span class="builtintype" id="2361780">nil</span>&nbsp;<span class="op" id="2361784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2361789">syscall</span><span class="op" id="2361796">.</span><span class="ident" id="2361797">ForkLock</span><span class="op" id="2361805">.</span><span class="ident" id="2361806">RUnlock</span><span class="op" id="2361813">(</span><span class="op" id="2361814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2361819">return</span>&nbsp;<span class="builtintype" id="2361826">nil</span><span class="op" id="2361829">,</span>&nbsp;<span class="builtintype" id="2361831">nil</span><span class="op" id="2361834">,</span>&nbsp;<span class="ident" id="2361836">NewSyscallError</span><span class="op" id="2361851">(</span><span class="string" id="2361852">&#34;pipe&#34;</span><span class="op" id="2361858">,</span>&nbsp;<span class="ident" id="2361860">e</span><span class="op" id="2361861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2361865">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2361869">syscall</span><span class="op" id="2361876">.</span><span class="ident" id="2361877">CloseOnExec</span><span class="op" id="2361888">(</span><span class="ident" id="2361889">p</span><span class="op" id="2361890">[</span><span class="num" id="2361891">0</span><span class="op" id="2361892">]</span><span class="op" id="2361893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2361897">syscall</span><span class="op" id="2361904">.</span><span class="ident" id="2361905">CloseOnExec</span><span class="op" id="2361916">(</span><span class="ident" id="2361917">p</span><span class="op" id="2361918">[</span><span class="num" id="2361919">1</span><span class="op" id="2361920">]</span><span class="op" id="2361921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2361925">syscall</span><span class="op" id="2361932">.</span><span class="ident" id="2361933">ForkLock</span><span class="op" id="2361941">.</span><span class="ident" id="2361942">RUnlock</span><span class="op" id="2361949">(</span><span class="op" id="2361950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2361953">}</span>&nbsp;<span class="keyword" id="2361955">else</span>&nbsp;<span class="keyword" id="2361960">if</span>&nbsp;<span class="ident" id="2361963">e</span>&nbsp;<span class="op" id="2361965">!=</span>&nbsp;<span class="builtintype" id="2361968">nil</span>&nbsp;<span class="op" id="2361972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2361976">return</span>&nbsp;<span class="builtintype" id="2361983">nil</span><span class="op" id="2361986">,</span>&nbsp;<span class="builtintype" id="2361988">nil</span><span class="op" id="2361991">,</span>&nbsp;<span class="ident" id="2361993">NewSyscallError</span><span class="op" id="2362008">(</span><span class="string" id="2362009">&#34;pipe2&#34;</span><span class="op" id="2362016">,</span>&nbsp;<span class="ident" id="2362018">e</span><span class="op" id="2362019">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2362022">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2362026">return</span>&nbsp;<span class="ident" id="2362033">NewFile</span><span class="op" id="2362040">(</span><span class="builtintype" id="2362041">uintptr</span><span class="op" id="2362048">(</span><span class="ident" id="2362049">p</span><span class="op" id="2362050">[</span><span class="num" id="2362051">0</span><span class="op" id="2362052">]</span><span class="op" id="2362053">)</span><span class="op" id="2362054">,</span>&nbsp;<span class="string" id="2362056">&#34;|0&#34;</span><span class="op" id="2362060">)</span><span class="op" id="2362061">,</span>&nbsp;<span class="ident" id="2362063">NewFile</span><span class="op" id="2362070">(</span><span class="builtintype" id="2362071">uintptr</span><span class="op" id="2362078">(</span><span class="ident" id="2362079">p</span><span class="op" id="2362080">[</span><span class="num" id="2362081">1</span><span class="op" id="2362082">]</span><span class="op" id="2362083">)</span><span class="op" id="2362084">,</span>&nbsp;<span class="string" id="2362086">&#34;|1&#34;</span><span class="op" id="2362090">)</span><span class="op" id="2362091">,</span>&nbsp;<span class="builtintype" id="2362093">nil</span><br>
<span class="lineno"></span><span class="op" id="2362097">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
