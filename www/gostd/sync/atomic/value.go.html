<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1801825">//&nbsp;Copyright&nbsp;2014&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1801880">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1801934">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1801985">package</span>&nbsp;<span class="ident" id="1801993">atomic</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1802001">import</span>&nbsp;<span class="op" id="1802008">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1802011">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="1802020">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="1802023">//&nbsp;A&nbsp;Value&nbsp;provides&nbsp;an&nbsp;atomic&nbsp;load&nbsp;and&nbsp;store&nbsp;of&nbsp;a&nbsp;consistently&nbsp;typed&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="1802099">//&nbsp;Values&nbsp;can&nbsp;be&nbsp;created&nbsp;as&nbsp;part&nbsp;of&nbsp;other&nbsp;data&nbsp;structures.</span><br>
<span class="lineno"></span><span class="comment" id="1802158">//&nbsp;The&nbsp;zero&nbsp;value&nbsp;for&nbsp;a&nbsp;Value&nbsp;returns&nbsp;nil&nbsp;from&nbsp;Load.</span><br>
<span class="lineno"></span><span class="comment" id="1802211">//&nbsp;Once&nbsp;Store&nbsp;has&nbsp;been&nbsp;called,&nbsp;a&nbsp;Value&nbsp;must&nbsp;not&nbsp;be&nbsp;copied.</span><br>
<span class="lineno">15</span><span class="keyword" id="1802270">type</span>&nbsp;<span class="ident" id="1802275">Value</span>&nbsp;<span class="keyword" id="1802281">struct</span>&nbsp;<span class="op" id="1802288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1802291">v</span>&nbsp;<span class="keyword" id="1802293">interface</span><span class="op" id="1802302">{</span><span class="op" id="1802303">}</span><br>
<span class="lineno"></span><span class="op" id="1802305">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1802308">//&nbsp;ifaceWords&nbsp;is&nbsp;interface{}&nbsp;internal&nbsp;representation.</span><br>
<span class="lineno">20</span><span class="keyword" id="1802362">type</span>&nbsp;<span class="ident" id="1802367">ifaceWords</span>&nbsp;<span class="keyword" id="1802378">struct</span>&nbsp;<span class="op" id="1802385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1802388">typ</span>&nbsp;&nbsp;<span class="ident" id="1802393">unsafe</span><span class="op" id="1802399">.</span><span class="ident" id="1802400">Pointer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1802409">data</span>&nbsp;<span class="ident" id="1802414">unsafe</span><span class="op" id="1802420">.</span><span class="ident" id="1802421">Pointer</span><br>
<span class="lineno"></span><span class="op" id="1802429">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="1802432">//&nbsp;Load&nbsp;returns&nbsp;the&nbsp;value&nbsp;set&nbsp;by&nbsp;the&nbsp;most&nbsp;recent&nbsp;Store.</span><br>
<span class="lineno"></span><span class="comment" id="1802488">//&nbsp;It&nbsp;returns&nbsp;nil&nbsp;if&nbsp;there&nbsp;has&nbsp;been&nbsp;no&nbsp;call&nbsp;to&nbsp;Store&nbsp;for&nbsp;this&nbsp;Value.</span><br>
<span class="lineno"></span><span class="keyword" id="1802557">func</span>&nbsp;<span class="op" id="1802562">(</span><span class="ident" id="1802563">v</span>&nbsp;<span class="op" id="1802565">*</span><span class="ident" id="1802566">Value</span><span class="op" id="1802571">)</span>&nbsp;<span class="ident" id="1802573">Load</span><span class="op" id="1802577">(</span><span class="op" id="1802578">)</span>&nbsp;<span class="op" id="1802580">(</span><span class="ident" id="1802581">x</span>&nbsp;<span class="keyword" id="1802583">interface</span><span class="op" id="1802592">{</span><span class="op" id="1802593">}</span><span class="op" id="1802594">)</span>&nbsp;<span class="op" id="1802596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1802599">vp</span>&nbsp;<span class="op" id="1802602">:=</span>&nbsp;<span class="op" id="1802605">(</span><span class="op" id="1802606">*</span><span class="ident" id="1802607">ifaceWords</span><span class="op" id="1802617">)</span><span class="op" id="1802618">(</span><span class="ident" id="1802619">unsafe</span><span class="op" id="1802625">.</span><span class="ident" id="1802626">Pointer</span><span class="op" id="1802633">(</span><span class="ident" id="1802634">v</span><span class="op" id="1802635">)</span><span class="op" id="1802636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1802639">typ</span>&nbsp;<span class="op" id="1802643">:=</span>&nbsp;<span class="ident" id="1802646">LoadPointer</span><span class="op" id="1802657">(</span><span class="op" id="1802658">&amp;</span><span class="ident" id="1802659">vp</span><span class="op" id="1802661">.</span><span class="ident" id="1802662">typ</span><span class="op" id="1802665">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1802668">if</span>&nbsp;<span class="ident" id="1802671">typ</span>&nbsp;<span class="op" id="1802675">==</span>&nbsp;<span class="ident" id="1802678">nil</span>&nbsp;<span class="op" id="1802682">||</span>&nbsp;<span class="builtintype" id="1802685">uintptr</span><span class="op" id="1802692">(</span><span class="ident" id="1802693">typ</span><span class="op" id="1802696">)</span>&nbsp;<span class="op" id="1802698">==</span>&nbsp;<span class="op" id="1802701">^</span><span class="builtintype" id="1802702">uintptr</span><span class="op" id="1802709">(</span><span class="num" id="1802710">0</span><span class="op" id="1802711">)</span>&nbsp;<span class="op" id="1802713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1802717">//&nbsp;First&nbsp;store&nbsp;not&nbsp;yet&nbsp;completed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1802753">return</span>&nbsp;<span class="ident" id="1802760">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1802765">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1802768">data</span>&nbsp;<span class="op" id="1802773">:=</span>&nbsp;<span class="ident" id="1802776">LoadPointer</span><span class="op" id="1802787">(</span><span class="op" id="1802788">&amp;</span><span class="ident" id="1802789">vp</span><span class="op" id="1802791">.</span><span class="ident" id="1802792">data</span><span class="op" id="1802796">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1802799">xp</span>&nbsp;<span class="op" id="1802802">:=</span>&nbsp;<span class="op" id="1802805">(</span><span class="op" id="1802806">*</span><span class="ident" id="1802807">ifaceWords</span><span class="op" id="1802817">)</span><span class="op" id="1802818">(</span><span class="ident" id="1802819">unsafe</span><span class="op" id="1802825">.</span><span class="ident" id="1802826">Pointer</span><span class="op" id="1802833">(</span><span class="op" id="1802834">&amp;</span><span class="ident" id="1802835">x</span><span class="op" id="1802836">)</span><span class="op" id="1802837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1802840">xp</span><span class="op" id="1802842">.</span><span class="ident" id="1802843">typ</span>&nbsp;<span class="op" id="1802847">=</span>&nbsp;<span class="ident" id="1802849">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1802854">xp</span><span class="op" id="1802856">.</span><span class="ident" id="1802857">data</span>&nbsp;<span class="op" id="1802862">=</span>&nbsp;<span class="ident" id="1802864">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1802870">return</span><br>
<span class="lineno"></span><span class="op" id="1802877">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="1802880">//&nbsp;Store&nbsp;sets&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;Value&nbsp;to&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="1802923">//&nbsp;All&nbsp;calls&nbsp;to&nbsp;Store&nbsp;for&nbsp;a&nbsp;given&nbsp;Value&nbsp;must&nbsp;use&nbsp;values&nbsp;of&nbsp;the&nbsp;same&nbsp;concrete&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="1803006">//&nbsp;Store&nbsp;of&nbsp;an&nbsp;inconsistent&nbsp;type&nbsp;panics,&nbsp;as&nbsp;does&nbsp;Store(nil).</span><br>
<span class="lineno"></span><span class="keyword" id="1803067">func</span>&nbsp;<span class="op" id="1803072">(</span><span class="ident" id="1803073">v</span>&nbsp;<span class="op" id="1803075">*</span><span class="ident" id="1803076">Value</span><span class="op" id="1803081">)</span>&nbsp;<span class="ident" id="1803083">Store</span><span class="op" id="1803088">(</span><span class="ident" id="1803089">x</span>&nbsp;<span class="keyword" id="1803091">interface</span><span class="op" id="1803100">{</span><span class="op" id="1803101">}</span><span class="op" id="1803102">)</span>&nbsp;<span class="op" id="1803104">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1803107">if</span>&nbsp;<span class="ident" id="1803110">x</span>&nbsp;<span class="op" id="1803112">==</span>&nbsp;<span class="ident" id="1803115">nil</span>&nbsp;<span class="op" id="1803119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1803123">panic</span><span class="op" id="1803128">(</span><span class="string" id="1803129">&#34;sync/atomic:&nbsp;store&nbsp;of&nbsp;nil&nbsp;value&nbsp;into&nbsp;Value&#34;</span><span class="op" id="1803173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1803176">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1803179">vp</span>&nbsp;<span class="op" id="1803182">:=</span>&nbsp;<span class="op" id="1803185">(</span><span class="op" id="1803186">*</span><span class="ident" id="1803187">ifaceWords</span><span class="op" id="1803197">)</span><span class="op" id="1803198">(</span><span class="ident" id="1803199">unsafe</span><span class="op" id="1803205">.</span><span class="ident" id="1803206">Pointer</span><span class="op" id="1803213">(</span><span class="ident" id="1803214">v</span><span class="op" id="1803215">)</span><span class="op" id="1803216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1803219">xp</span>&nbsp;<span class="op" id="1803222">:=</span>&nbsp;<span class="op" id="1803225">(</span><span class="op" id="1803226">*</span><span class="ident" id="1803227">ifaceWords</span><span class="op" id="1803237">)</span><span class="op" id="1803238">(</span><span class="ident" id="1803239">unsafe</span><span class="op" id="1803245">.</span><span class="ident" id="1803246">Pointer</span><span class="op" id="1803253">(</span><span class="op" id="1803254">&amp;</span><span class="ident" id="1803255">x</span><span class="op" id="1803256">)</span><span class="op" id="1803257">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1803260">for</span>&nbsp;<span class="op" id="1803264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1803268">typ</span>&nbsp;<span class="op" id="1803272">:=</span>&nbsp;<span class="ident" id="1803275">LoadPointer</span><span class="op" id="1803286">(</span><span class="op" id="1803287">&amp;</span><span class="ident" id="1803288">vp</span><span class="op" id="1803290">.</span><span class="ident" id="1803291">typ</span><span class="op" id="1803294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1803298">if</span>&nbsp;<span class="ident" id="1803301">typ</span>&nbsp;<span class="op" id="1803305">==</span>&nbsp;<span class="ident" id="1803308">nil</span>&nbsp;<span class="op" id="1803312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1803317">//&nbsp;Attempt&nbsp;to&nbsp;start&nbsp;first&nbsp;store.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1803353">//&nbsp;Disable&nbsp;preemption&nbsp;so&nbsp;that&nbsp;other&nbsp;goroutines&nbsp;can&nbsp;use</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1803411">//&nbsp;active&nbsp;spin&nbsp;wait&nbsp;to&nbsp;wait&nbsp;for&nbsp;completion;&nbsp;and&nbsp;so&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1803470">//&nbsp;GC&nbsp;does&nbsp;not&nbsp;see&nbsp;the&nbsp;fake&nbsp;type&nbsp;accidentally.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1803520">runtime_procPin</span><span class="op" id="1803535">(</span><span class="op" id="1803536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1803541">if</span>&nbsp;<span class="op" id="1803544">!</span><span class="ident" id="1803545">CompareAndSwapPointer</span><span class="op" id="1803566">(</span><span class="op" id="1803567">&amp;</span><span class="ident" id="1803568">vp</span><span class="op" id="1803570">.</span><span class="ident" id="1803571">typ</span><span class="op" id="1803574">,</span>&nbsp;<span class="ident" id="1803576">nil</span><span class="op" id="1803579">,</span>&nbsp;<span class="ident" id="1803581">unsafe</span><span class="op" id="1803587">.</span><span class="ident" id="1803588">Pointer</span><span class="op" id="1803595">(</span><span class="op" id="1803596">^</span><span class="builtintype" id="1803597">uintptr</span><span class="op" id="1803604">(</span><span class="num" id="1803605">0</span><span class="op" id="1803606">)</span><span class="op" id="1803607">)</span><span class="op" id="1803608">)</span>&nbsp;<span class="op" id="1803610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1803616">runtime_procUnpin</span><span class="op" id="1803633">(</span><span class="op" id="1803634">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1803640">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1803652">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1803657">//&nbsp;Complete&nbsp;first&nbsp;store.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1803685">StorePointer</span><span class="op" id="1803697">(</span><span class="op" id="1803698">&amp;</span><span class="ident" id="1803699">vp</span><span class="op" id="1803701">.</span><span class="ident" id="1803702">data</span><span class="op" id="1803706">,</span>&nbsp;<span class="ident" id="1803708">xp</span><span class="op" id="1803710">.</span><span class="ident" id="1803711">data</span><span class="op" id="1803715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1803720">StorePointer</span><span class="op" id="1803732">(</span><span class="op" id="1803733">&amp;</span><span class="ident" id="1803734">vp</span><span class="op" id="1803736">.</span><span class="ident" id="1803737">typ</span><span class="op" id="1803740">,</span>&nbsp;<span class="ident" id="1803742">xp</span><span class="op" id="1803744">.</span><span class="ident" id="1803745">typ</span><span class="op" id="1803748">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1803753">runtime_procUnpin</span><span class="op" id="1803770">(</span><span class="op" id="1803771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1803776">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1803785">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1803789">if</span>&nbsp;<span class="builtintype" id="1803792">uintptr</span><span class="op" id="1803799">(</span><span class="ident" id="1803800">typ</span><span class="op" id="1803803">)</span>&nbsp;<span class="op" id="1803805">==</span>&nbsp;<span class="op" id="1803808">^</span><span class="builtintype" id="1803809">uintptr</span><span class="op" id="1803816">(</span><span class="num" id="1803817">0</span><span class="op" id="1803818">)</span>&nbsp;<span class="op" id="1803820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1803825">//&nbsp;First&nbsp;store&nbsp;in&nbsp;progress.&nbsp;Wait.</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1803862">//&nbsp;Since&nbsp;we&nbsp;disable&nbsp;preemption&nbsp;around&nbsp;the&nbsp;first&nbsp;store,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1803920">//&nbsp;we&nbsp;can&nbsp;wait&nbsp;with&nbsp;active&nbsp;spinning.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1803960">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1803971">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1803975">//&nbsp;First&nbsp;store&nbsp;completed.&nbsp;Check&nbsp;type&nbsp;and&nbsp;overwrite&nbsp;data.</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1804034">if</span>&nbsp;<span class="ident" id="1804037">typ</span>&nbsp;<span class="op" id="1804041">!=</span>&nbsp;<span class="ident" id="1804044">xp</span><span class="op" id="1804046">.</span><span class="ident" id="1804047">typ</span>&nbsp;<span class="op" id="1804051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1804056">panic</span><span class="op" id="1804061">(</span><span class="string" id="1804062">&#34;sync/atomic:&nbsp;store&nbsp;of&nbsp;inconsistently&nbsp;typed&nbsp;value&nbsp;into&nbsp;Value&#34;</span><span class="op" id="1804123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1804127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1804131">StorePointer</span><span class="op" id="1804143">(</span><span class="op" id="1804144">&amp;</span><span class="ident" id="1804145">vp</span><span class="op" id="1804147">.</span><span class="ident" id="1804148">data</span><span class="op" id="1804152">,</span>&nbsp;<span class="ident" id="1804154">xp</span><span class="op" id="1804156">.</span><span class="ident" id="1804157">data</span><span class="op" id="1804161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1804165">return</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1804173">}</span><br>
<span class="lineno"></span><span class="op" id="1804175">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1804178">//&nbsp;Disable/enable&nbsp;preemption,&nbsp;implemented&nbsp;in&nbsp;runtime.</span><br>
<span class="lineno"></span><span class="keyword" id="1804232">func</span>&nbsp;<span class="ident" id="1804237">runtime_procPin</span><span class="op" id="1804252">(</span><span class="op" id="1804253">)</span><br>
<span class="lineno">85</span><span class="keyword" id="1804255">func</span>&nbsp;<span class="ident" id="1804260">runtime_procUnpin</span><span class="op" id="1804277">(</span><span class="op" id="1804278">)</span>
</div>
</body>
</html>
