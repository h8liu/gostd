<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/xml</h2>
<ul>
<li><a href="/gostd/encoding/xml/atom_test.go.html">atom_test.go</a></li>
<li><a href="/gostd/encoding/xml/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/encoding/xml/marshal.go.html">marshal.go</a></li>
<li><a href="/gostd/encoding/xml/marshal_test.go.html">marshal_test.go</a></li>
<li><a href="/gostd/encoding/xml/read.go.html">read.go</a></li>
<li><a href="/gostd/encoding/xml/read_test.go.html">read_test.go</a></li>
<li><a href="/gostd/encoding/xml/typeinfo.go.html">typeinfo.go</a></li>
<li><a href="/gostd/encoding/xml/xml.go.html">xml.go</a></li>
<li><a href="/gostd/encoding/xml/xml_test.go.html">xml_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7456365">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7456421">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7456475">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7456526">package</span>&nbsp;<span class="ident" id="7456534">xml</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7456539">import</span>&nbsp;<span class="op" id="7456546">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7456549">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7456558">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7456565">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7456571">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7456582">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7456593">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7456604">&#34;unicode/utf8&#34;</span><br>
<span class="lineno">15</span><span class="op" id="7456619">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7456622">const</span>&nbsp;<span class="ident" id="7456628">testInput</span>&nbsp;<span class="op" id="7456638">=</span>&nbsp;<span class="string" id="7456640">`<br>
<span class="lineno"></span>&lt;?xml&nbsp;version=&#34;1.0&#34;&nbsp;encoding=&#34;UTF-8&#34;?&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&#34;-//W3C//DTD&nbsp;XHTML&nbsp;1.0&nbsp;Transitional//EN&#34;<br>
<span class="lineno">20</span>&nbsp;&nbsp;&#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#34;&gt;<br>
<span class="lineno"></span>&lt;body&nbsp;xmlns:foo=&#34;ns1&#34;&nbsp;xmlns=&#34;ns2&#34;&nbsp;xmlns:tag=&#34;ns3&#34;&nbsp;`</span>&nbsp;<span class="op" id="7456857">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7456860">&#34;\r\n\t&#34;</span>&nbsp;<span class="op" id="7456869">+</span>&nbsp;<span class="string" id="7456871">`&nbsp;&nbsp;&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;hello&nbsp;lang=&#34;en&#34;&gt;World&nbsp;&amp;lt;&amp;gt;&amp;apos;&amp;quot;&nbsp;&amp;#x767d;&amp;#40300;翔&lt;/hello&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;query&gt;&amp;何;&nbsp;&amp;is-it;&lt;/query&gt;<br>
<span class="lineno">25</span>&nbsp;&nbsp;&lt;goodbye&nbsp;/&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;outer&nbsp;foo:attr=&#34;value&#34;&nbsp;xmlns:tag=&#34;ns4&#34;&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;inner/&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;/outer&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;tag:name&gt;<br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;![CDATA[Some&nbsp;text&nbsp;here.]]&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;/tag:name&gt;<br>
<span class="lineno"></span>&lt;/body&gt;&lt;!--&nbsp;missing&nbsp;final&nbsp;newline&nbsp;--&gt;`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7457161">var</span>&nbsp;<span class="ident" id="7457165">testEntity</span>&nbsp;<span class="op" id="7457176">=</span>&nbsp;<span class="keyword" id="7457178">map</span><span class="op" id="7457181">[</span><span class="builtintype" id="7457182">string</span><span class="op" id="7457188">]</span><span class="builtintype" id="7457189">string</span><span class="op" id="7457195">{</span><span class="string" id="7457196">&#34;何&#34;</span><span class="op" id="7457201">:</span>&nbsp;<span class="string" id="7457203">&#34;What&#34;</span><span class="op" id="7457209">,</span>&nbsp;<span class="string" id="7457211">&#34;is-it&#34;</span><span class="op" id="7457218">:</span>&nbsp;<span class="string" id="7457220">&#34;is&nbsp;it?&#34;</span><span class="op" id="7457228">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="7457231">var</span>&nbsp;<span class="ident" id="7457235">rawTokens</span>&nbsp;<span class="op" id="7457245">=</span>&nbsp;<span class="op" id="7457247">[</span><span class="op" id="7457248">]</span><span class="ident" id="7457249">Token</span><span class="op" id="7457254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7457257">CharData</span><span class="op" id="7457265">(</span><span class="string" id="7457266">&#34;\n&#34;</span><span class="op" id="7457270">)</span><span class="op" id="7457271">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7457274">ProcInst</span><span class="op" id="7457282">{</span><span class="string" id="7457283">&#34;xml&#34;</span><span class="op" id="7457288">,</span>&nbsp;<span class="op" id="7457290">[</span><span class="op" id="7457291">]</span><span class="builtintype" id="7457292">byte</span><span class="op" id="7457296">(</span><span class="string" id="7457297">`version=&#34;1.0&#34;&nbsp;encoding=&#34;UTF-8&#34;`</span><span class="op" id="7457329">)</span><span class="op" id="7457330">}</span><span class="op" id="7457331">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7457334">CharData</span><span class="op" id="7457342">(</span><span class="string" id="7457343">&#34;\n&#34;</span><span class="op" id="7457347">)</span><span class="op" id="7457348">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7457351">Directive</span><span class="op" id="7457360">(</span><span class="string" id="7457361">`DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&#34;-//W3C//DTD&nbsp;XHTML&nbsp;1.0&nbsp;Transitional//EN&#34;<br>
<span class="lineno"></span>&nbsp;&nbsp;&#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#34;`</span><span class="op" id="7457483">)</span><span class="op" id="7457484">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7457487">CharData</span><span class="op" id="7457495">(</span><span class="string" id="7457496">&#34;\n&#34;</span><span class="op" id="7457500">)</span><span class="op" id="7457501">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7457504">StartElement</span><span class="op" id="7457516">{</span><span class="ident" id="7457517">Name</span><span class="op" id="7457521">{</span><span class="string" id="7457522">&#34;&#34;</span><span class="op" id="7457524">,</span>&nbsp;<span class="string" id="7457526">&#34;body&#34;</span><span class="op" id="7457532">}</span><span class="op" id="7457533">,</span>&nbsp;<span class="op" id="7457535">[</span><span class="op" id="7457536">]</span><span class="ident" id="7457537">Attr</span><span class="op" id="7457541">{</span><span class="op" id="7457542">{</span><span class="ident" id="7457543">Name</span><span class="op" id="7457547">{</span><span class="string" id="7457548">&#34;xmlns&#34;</span><span class="op" id="7457555">,</span>&nbsp;<span class="string" id="7457557">&#34;foo&#34;</span><span class="op" id="7457562">}</span><span class="op" id="7457563">,</span>&nbsp;<span class="string" id="7457565">&#34;ns1&#34;</span><span class="op" id="7457570">}</span><span class="op" id="7457571">,</span>&nbsp;<span class="op" id="7457573">{</span><span class="ident" id="7457574">Name</span><span class="op" id="7457578">{</span><span class="string" id="7457579">&#34;&#34;</span><span class="op" id="7457581">,</span>&nbsp;<span class="string" id="7457583">&#34;xmlns&#34;</span><span class="op" id="7457590">}</span><span class="op" id="7457591">,</span>&nbsp;<span class="string" id="7457593">&#34;ns2&#34;</span><span class="op" id="7457598">}</span><span class="op" id="7457599">,</span>&nbsp;<span class="op" id="7457601">{</span><span class="ident" id="7457602">Name</span><span class="op" id="7457606">{</span><span class="string" id="7457607">&#34;xmlns&#34;</span><span class="op" id="7457614">,</span>&nbsp;<span class="string" id="7457616">&#34;tag&#34;</span><span class="op" id="7457621">}</span><span class="op" id="7457622">,</span>&nbsp;<span class="string" id="7457624">&#34;ns3&#34;</span><span class="op" id="7457629">}</span><span class="op" id="7457630">}</span><span class="op" id="7457631">}</span><span class="op" id="7457632">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7457635">CharData</span><span class="op" id="7457643">(</span><span class="string" id="7457644">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7457650">)</span><span class="op" id="7457651">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7457654">StartElement</span><span class="op" id="7457666">{</span><span class="ident" id="7457667">Name</span><span class="op" id="7457671">{</span><span class="string" id="7457672">&#34;&#34;</span><span class="op" id="7457674">,</span>&nbsp;<span class="string" id="7457676">&#34;hello&#34;</span><span class="op" id="7457683">}</span><span class="op" id="7457684">,</span>&nbsp;<span class="op" id="7457686">[</span><span class="op" id="7457687">]</span><span class="ident" id="7457688">Attr</span><span class="op" id="7457692">{</span><span class="op" id="7457693">{</span><span class="ident" id="7457694">Name</span><span class="op" id="7457698">{</span><span class="string" id="7457699">&#34;&#34;</span><span class="op" id="7457701">,</span>&nbsp;<span class="string" id="7457703">&#34;lang&#34;</span><span class="op" id="7457709">}</span><span class="op" id="7457710">,</span>&nbsp;<span class="string" id="7457712">&#34;en&#34;</span><span class="op" id="7457716">}</span><span class="op" id="7457717">}</span><span class="op" id="7457718">}</span><span class="op" id="7457719">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7457722">CharData</span><span class="op" id="7457730">(</span><span class="string" id="7457731">&#34;World&nbsp;&lt;&gt;&#39;\&#34;&nbsp;白鵬翔&#34;</span><span class="op" id="7457754">)</span><span class="op" id="7457755">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7457758">EndElement</span><span class="op" id="7457768">{</span><span class="ident" id="7457769">Name</span><span class="op" id="7457773">{</span><span class="string" id="7457774">&#34;&#34;</span><span class="op" id="7457776">,</span>&nbsp;<span class="string" id="7457778">&#34;hello&#34;</span><span class="op" id="7457785">}</span><span class="op" id="7457786">}</span><span class="op" id="7457787">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7457790">CharData</span><span class="op" id="7457798">(</span><span class="string" id="7457799">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7457805">)</span><span class="op" id="7457806">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7457809">StartElement</span><span class="op" id="7457821">{</span><span class="ident" id="7457822">Name</span><span class="op" id="7457826">{</span><span class="string" id="7457827">&#34;&#34;</span><span class="op" id="7457829">,</span>&nbsp;<span class="string" id="7457831">&#34;query&#34;</span><span class="op" id="7457838">}</span><span class="op" id="7457839">,</span>&nbsp;<span class="op" id="7457841">[</span><span class="op" id="7457842">]</span><span class="ident" id="7457843">Attr</span><span class="op" id="7457847">{</span><span class="op" id="7457848">}</span><span class="op" id="7457849">}</span><span class="op" id="7457850">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7457853">CharData</span><span class="op" id="7457861">(</span><span class="string" id="7457862">&#34;What&nbsp;is&nbsp;it?&#34;</span><span class="op" id="7457875">)</span><span class="op" id="7457876">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7457879">EndElement</span><span class="op" id="7457889">{</span><span class="ident" id="7457890">Name</span><span class="op" id="7457894">{</span><span class="string" id="7457895">&#34;&#34;</span><span class="op" id="7457897">,</span>&nbsp;<span class="string" id="7457899">&#34;query&#34;</span><span class="op" id="7457906">}</span><span class="op" id="7457907">}</span><span class="op" id="7457908">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7457911">CharData</span><span class="op" id="7457919">(</span><span class="string" id="7457920">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7457926">)</span><span class="op" id="7457927">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7457930">StartElement</span><span class="op" id="7457942">{</span><span class="ident" id="7457943">Name</span><span class="op" id="7457947">{</span><span class="string" id="7457948">&#34;&#34;</span><span class="op" id="7457950">,</span>&nbsp;<span class="string" id="7457952">&#34;goodbye&#34;</span><span class="op" id="7457961">}</span><span class="op" id="7457962">,</span>&nbsp;<span class="op" id="7457964">[</span><span class="op" id="7457965">]</span><span class="ident" id="7457966">Attr</span><span class="op" id="7457970">{</span><span class="op" id="7457971">}</span><span class="op" id="7457972">}</span><span class="op" id="7457973">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7457976">EndElement</span><span class="op" id="7457986">{</span><span class="ident" id="7457987">Name</span><span class="op" id="7457991">{</span><span class="string" id="7457992">&#34;&#34;</span><span class="op" id="7457994">,</span>&nbsp;<span class="string" id="7457996">&#34;goodbye&#34;</span><span class="op" id="7458005">}</span><span class="op" id="7458006">}</span><span class="op" id="7458007">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7458010">CharData</span><span class="op" id="7458018">(</span><span class="string" id="7458019">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7458025">)</span><span class="op" id="7458026">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7458029">StartElement</span><span class="op" id="7458041">{</span><span class="ident" id="7458042">Name</span><span class="op" id="7458046">{</span><span class="string" id="7458047">&#34;&#34;</span><span class="op" id="7458049">,</span>&nbsp;<span class="string" id="7458051">&#34;outer&#34;</span><span class="op" id="7458058">}</span><span class="op" id="7458059">,</span>&nbsp;<span class="op" id="7458061">[</span><span class="op" id="7458062">]</span><span class="ident" id="7458063">Attr</span><span class="op" id="7458067">{</span><span class="op" id="7458068">{</span><span class="ident" id="7458069">Name</span><span class="op" id="7458073">{</span><span class="string" id="7458074">&#34;foo&#34;</span><span class="op" id="7458079">,</span>&nbsp;<span class="string" id="7458081">&#34;attr&#34;</span><span class="op" id="7458087">}</span><span class="op" id="7458088">,</span>&nbsp;<span class="string" id="7458090">&#34;value&#34;</span><span class="op" id="7458097">}</span><span class="op" id="7458098">,</span>&nbsp;<span class="op" id="7458100">{</span><span class="ident" id="7458101">Name</span><span class="op" id="7458105">{</span><span class="string" id="7458106">&#34;xmlns&#34;</span><span class="op" id="7458113">,</span>&nbsp;<span class="string" id="7458115">&#34;tag&#34;</span><span class="op" id="7458120">}</span><span class="op" id="7458121">,</span>&nbsp;<span class="string" id="7458123">&#34;ns4&#34;</span><span class="op" id="7458128">}</span><span class="op" id="7458129">}</span><span class="op" id="7458130">}</span><span class="op" id="7458131">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7458134">CharData</span><span class="op" id="7458142">(</span><span class="string" id="7458143">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="7458151">)</span><span class="op" id="7458152">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7458155">StartElement</span><span class="op" id="7458167">{</span><span class="ident" id="7458168">Name</span><span class="op" id="7458172">{</span><span class="string" id="7458173">&#34;&#34;</span><span class="op" id="7458175">,</span>&nbsp;<span class="string" id="7458177">&#34;inner&#34;</span><span class="op" id="7458184">}</span><span class="op" id="7458185">,</span>&nbsp;<span class="op" id="7458187">[</span><span class="op" id="7458188">]</span><span class="ident" id="7458189">Attr</span><span class="op" id="7458193">{</span><span class="op" id="7458194">}</span><span class="op" id="7458195">}</span><span class="op" id="7458196">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7458199">EndElement</span><span class="op" id="7458209">{</span><span class="ident" id="7458210">Name</span><span class="op" id="7458214">{</span><span class="string" id="7458215">&#34;&#34;</span><span class="op" id="7458217">,</span>&nbsp;<span class="string" id="7458219">&#34;inner&#34;</span><span class="op" id="7458226">}</span><span class="op" id="7458227">}</span><span class="op" id="7458228">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7458231">CharData</span><span class="op" id="7458239">(</span><span class="string" id="7458240">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7458246">)</span><span class="op" id="7458247">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7458250">EndElement</span><span class="op" id="7458260">{</span><span class="ident" id="7458261">Name</span><span class="op" id="7458265">{</span><span class="string" id="7458266">&#34;&#34;</span><span class="op" id="7458268">,</span>&nbsp;<span class="string" id="7458270">&#34;outer&#34;</span><span class="op" id="7458277">}</span><span class="op" id="7458278">}</span><span class="op" id="7458279">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7458282">CharData</span><span class="op" id="7458290">(</span><span class="string" id="7458291">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7458297">)</span><span class="op" id="7458298">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7458301">StartElement</span><span class="op" id="7458313">{</span><span class="ident" id="7458314">Name</span><span class="op" id="7458318">{</span><span class="string" id="7458319">&#34;tag&#34;</span><span class="op" id="7458324">,</span>&nbsp;<span class="string" id="7458326">&#34;name&#34;</span><span class="op" id="7458332">}</span><span class="op" id="7458333">,</span>&nbsp;<span class="op" id="7458335">[</span><span class="op" id="7458336">]</span><span class="ident" id="7458337">Attr</span><span class="op" id="7458341">{</span><span class="op" id="7458342">}</span><span class="op" id="7458343">}</span><span class="op" id="7458344">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7458347">CharData</span><span class="op" id="7458355">(</span><span class="string" id="7458356">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="7458364">)</span><span class="op" id="7458365">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7458368">CharData</span><span class="op" id="7458376">(</span><span class="string" id="7458377">&#34;Some&nbsp;text&nbsp;here.&#34;</span><span class="op" id="7458394">)</span><span class="op" id="7458395">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7458398">CharData</span><span class="op" id="7458406">(</span><span class="string" id="7458407">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7458413">)</span><span class="op" id="7458414">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7458417">EndElement</span><span class="op" id="7458427">{</span><span class="ident" id="7458428">Name</span><span class="op" id="7458432">{</span><span class="string" id="7458433">&#34;tag&#34;</span><span class="op" id="7458438">,</span>&nbsp;<span class="string" id="7458440">&#34;name&#34;</span><span class="op" id="7458446">}</span><span class="op" id="7458447">}</span><span class="op" id="7458448">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7458451">CharData</span><span class="op" id="7458459">(</span><span class="string" id="7458460">&#34;\n&#34;</span><span class="op" id="7458464">)</span><span class="op" id="7458465">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7458468">EndElement</span><span class="op" id="7458478">{</span><span class="ident" id="7458479">Name</span><span class="op" id="7458483">{</span><span class="string" id="7458484">&#34;&#34;</span><span class="op" id="7458486">,</span>&nbsp;<span class="string" id="7458488">&#34;body&#34;</span><span class="op" id="7458494">}</span><span class="op" id="7458495">}</span><span class="op" id="7458496">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7458499">Comment</span><span class="op" id="7458506">(</span><span class="string" id="7458507">&#34;&nbsp;missing&nbsp;final&nbsp;newline&nbsp;&#34;</span><span class="op" id="7458532">)</span><span class="op" id="7458533">,</span><br>
<span class="lineno"></span><span class="op" id="7458535">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7458538">var</span>&nbsp;<span class="ident" id="7458542">cookedTokens</span>&nbsp;<span class="op" id="7458555">=</span>&nbsp;<span class="op" id="7458557">[</span><span class="op" id="7458558">]</span><span class="ident" id="7458559">Token</span><span class="op" id="7458564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7458567">CharData</span><span class="op" id="7458575">(</span><span class="string" id="7458576">&#34;\n&#34;</span><span class="op" id="7458580">)</span><span class="op" id="7458581">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7458584">ProcInst</span><span class="op" id="7458592">{</span><span class="string" id="7458593">&#34;xml&#34;</span><span class="op" id="7458598">,</span>&nbsp;<span class="op" id="7458600">[</span><span class="op" id="7458601">]</span><span class="builtintype" id="7458602">byte</span><span class="op" id="7458606">(</span><span class="string" id="7458607">`version=&#34;1.0&#34;&nbsp;encoding=&#34;UTF-8&#34;`</span><span class="op" id="7458639">)</span><span class="op" id="7458640">}</span><span class="op" id="7458641">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7458644">CharData</span><span class="op" id="7458652">(</span><span class="string" id="7458653">&#34;\n&#34;</span><span class="op" id="7458657">)</span><span class="op" id="7458658">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7458661">Directive</span><span class="op" id="7458670">(</span><span class="string" id="7458671">`DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&#34;-//W3C//DTD&nbsp;XHTML&nbsp;1.0&nbsp;Transitional//EN&#34;<br>
<span class="lineno"></span>&nbsp;&nbsp;&#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#34;`</span><span class="op" id="7458793">)</span><span class="op" id="7458794">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7458797">CharData</span><span class="op" id="7458805">(</span><span class="string" id="7458806">&#34;\n&#34;</span><span class="op" id="7458810">)</span><span class="op" id="7458811">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7458814">StartElement</span><span class="op" id="7458826">{</span><span class="ident" id="7458827">Name</span><span class="op" id="7458831">{</span><span class="string" id="7458832">&#34;ns2&#34;</span><span class="op" id="7458837">,</span>&nbsp;<span class="string" id="7458839">&#34;body&#34;</span><span class="op" id="7458845">}</span><span class="op" id="7458846">,</span>&nbsp;<span class="op" id="7458848">[</span><span class="op" id="7458849">]</span><span class="ident" id="7458850">Attr</span><span class="op" id="7458854">{</span><span class="op" id="7458855">{</span><span class="ident" id="7458856">Name</span><span class="op" id="7458860">{</span><span class="string" id="7458861">&#34;xmlns&#34;</span><span class="op" id="7458868">,</span>&nbsp;<span class="string" id="7458870">&#34;foo&#34;</span><span class="op" id="7458875">}</span><span class="op" id="7458876">,</span>&nbsp;<span class="string" id="7458878">&#34;ns1&#34;</span><span class="op" id="7458883">}</span><span class="op" id="7458884">,</span>&nbsp;<span class="op" id="7458886">{</span><span class="ident" id="7458887">Name</span><span class="op" id="7458891">{</span><span class="string" id="7458892">&#34;&#34;</span><span class="op" id="7458894">,</span>&nbsp;<span class="string" id="7458896">&#34;xmlns&#34;</span><span class="op" id="7458903">}</span><span class="op" id="7458904">,</span>&nbsp;<span class="string" id="7458906">&#34;ns2&#34;</span><span class="op" id="7458911">}</span><span class="op" id="7458912">,</span>&nbsp;<span class="op" id="7458914">{</span><span class="ident" id="7458915">Name</span><span class="op" id="7458919">{</span><span class="string" id="7458920">&#34;xmlns&#34;</span><span class="op" id="7458927">,</span>&nbsp;<span class="string" id="7458929">&#34;tag&#34;</span><span class="op" id="7458934">}</span><span class="op" id="7458935">,</span>&nbsp;<span class="string" id="7458937">&#34;ns3&#34;</span><span class="op" id="7458942">}</span><span class="op" id="7458943">}</span><span class="op" id="7458944">}</span><span class="op" id="7458945">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7458948">CharData</span><span class="op" id="7458956">(</span><span class="string" id="7458957">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7458963">)</span><span class="op" id="7458964">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7458967">StartElement</span><span class="op" id="7458979">{</span><span class="ident" id="7458980">Name</span><span class="op" id="7458984">{</span><span class="string" id="7458985">&#34;ns2&#34;</span><span class="op" id="7458990">,</span>&nbsp;<span class="string" id="7458992">&#34;hello&#34;</span><span class="op" id="7458999">}</span><span class="op" id="7459000">,</span>&nbsp;<span class="op" id="7459002">[</span><span class="op" id="7459003">]</span><span class="ident" id="7459004">Attr</span><span class="op" id="7459008">{</span><span class="op" id="7459009">{</span><span class="ident" id="7459010">Name</span><span class="op" id="7459014">{</span><span class="string" id="7459015">&#34;&#34;</span><span class="op" id="7459017">,</span>&nbsp;<span class="string" id="7459019">&#34;lang&#34;</span><span class="op" id="7459025">}</span><span class="op" id="7459026">,</span>&nbsp;<span class="string" id="7459028">&#34;en&#34;</span><span class="op" id="7459032">}</span><span class="op" id="7459033">}</span><span class="op" id="7459034">}</span><span class="op" id="7459035">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7459038">CharData</span><span class="op" id="7459046">(</span><span class="string" id="7459047">&#34;World&nbsp;&lt;&gt;&#39;\&#34;&nbsp;白鵬翔&#34;</span><span class="op" id="7459070">)</span><span class="op" id="7459071">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7459074">EndElement</span><span class="op" id="7459084">{</span><span class="ident" id="7459085">Name</span><span class="op" id="7459089">{</span><span class="string" id="7459090">&#34;ns2&#34;</span><span class="op" id="7459095">,</span>&nbsp;<span class="string" id="7459097">&#34;hello&#34;</span><span class="op" id="7459104">}</span><span class="op" id="7459105">}</span><span class="op" id="7459106">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7459109">CharData</span><span class="op" id="7459117">(</span><span class="string" id="7459118">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7459124">)</span><span class="op" id="7459125">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7459128">StartElement</span><span class="op" id="7459140">{</span><span class="ident" id="7459141">Name</span><span class="op" id="7459145">{</span><span class="string" id="7459146">&#34;ns2&#34;</span><span class="op" id="7459151">,</span>&nbsp;<span class="string" id="7459153">&#34;query&#34;</span><span class="op" id="7459160">}</span><span class="op" id="7459161">,</span>&nbsp;<span class="op" id="7459163">[</span><span class="op" id="7459164">]</span><span class="ident" id="7459165">Attr</span><span class="op" id="7459169">{</span><span class="op" id="7459170">}</span><span class="op" id="7459171">}</span><span class="op" id="7459172">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7459175">CharData</span><span class="op" id="7459183">(</span><span class="string" id="7459184">&#34;What&nbsp;is&nbsp;it?&#34;</span><span class="op" id="7459197">)</span><span class="op" id="7459198">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7459201">EndElement</span><span class="op" id="7459211">{</span><span class="ident" id="7459212">Name</span><span class="op" id="7459216">{</span><span class="string" id="7459217">&#34;ns2&#34;</span><span class="op" id="7459222">,</span>&nbsp;<span class="string" id="7459224">&#34;query&#34;</span><span class="op" id="7459231">}</span><span class="op" id="7459232">}</span><span class="op" id="7459233">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7459236">CharData</span><span class="op" id="7459244">(</span><span class="string" id="7459245">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7459251">)</span><span class="op" id="7459252">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7459255">StartElement</span><span class="op" id="7459267">{</span><span class="ident" id="7459268">Name</span><span class="op" id="7459272">{</span><span class="string" id="7459273">&#34;ns2&#34;</span><span class="op" id="7459278">,</span>&nbsp;<span class="string" id="7459280">&#34;goodbye&#34;</span><span class="op" id="7459289">}</span><span class="op" id="7459290">,</span>&nbsp;<span class="op" id="7459292">[</span><span class="op" id="7459293">]</span><span class="ident" id="7459294">Attr</span><span class="op" id="7459298">{</span><span class="op" id="7459299">}</span><span class="op" id="7459300">}</span><span class="op" id="7459301">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7459304">EndElement</span><span class="op" id="7459314">{</span><span class="ident" id="7459315">Name</span><span class="op" id="7459319">{</span><span class="string" id="7459320">&#34;ns2&#34;</span><span class="op" id="7459325">,</span>&nbsp;<span class="string" id="7459327">&#34;goodbye&#34;</span><span class="op" id="7459336">}</span><span class="op" id="7459337">}</span><span class="op" id="7459338">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7459341">CharData</span><span class="op" id="7459349">(</span><span class="string" id="7459350">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7459356">)</span><span class="op" id="7459357">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7459360">StartElement</span><span class="op" id="7459372">{</span><span class="ident" id="7459373">Name</span><span class="op" id="7459377">{</span><span class="string" id="7459378">&#34;ns2&#34;</span><span class="op" id="7459383">,</span>&nbsp;<span class="string" id="7459385">&#34;outer&#34;</span><span class="op" id="7459392">}</span><span class="op" id="7459393">,</span>&nbsp;<span class="op" id="7459395">[</span><span class="op" id="7459396">]</span><span class="ident" id="7459397">Attr</span><span class="op" id="7459401">{</span><span class="op" id="7459402">{</span><span class="ident" id="7459403">Name</span><span class="op" id="7459407">{</span><span class="string" id="7459408">&#34;ns1&#34;</span><span class="op" id="7459413">,</span>&nbsp;<span class="string" id="7459415">&#34;attr&#34;</span><span class="op" id="7459421">}</span><span class="op" id="7459422">,</span>&nbsp;<span class="string" id="7459424">&#34;value&#34;</span><span class="op" id="7459431">}</span><span class="op" id="7459432">,</span>&nbsp;<span class="op" id="7459434">{</span><span class="ident" id="7459435">Name</span><span class="op" id="7459439">{</span><span class="string" id="7459440">&#34;xmlns&#34;</span><span class="op" id="7459447">,</span>&nbsp;<span class="string" id="7459449">&#34;tag&#34;</span><span class="op" id="7459454">}</span><span class="op" id="7459455">,</span>&nbsp;<span class="string" id="7459457">&#34;ns4&#34;</span><span class="op" id="7459462">}</span><span class="op" id="7459463">}</span><span class="op" id="7459464">}</span><span class="op" id="7459465">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7459468">CharData</span><span class="op" id="7459476">(</span><span class="string" id="7459477">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="7459485">)</span><span class="op" id="7459486">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7459489">StartElement</span><span class="op" id="7459501">{</span><span class="ident" id="7459502">Name</span><span class="op" id="7459506">{</span><span class="string" id="7459507">&#34;ns2&#34;</span><span class="op" id="7459512">,</span>&nbsp;<span class="string" id="7459514">&#34;inner&#34;</span><span class="op" id="7459521">}</span><span class="op" id="7459522">,</span>&nbsp;<span class="op" id="7459524">[</span><span class="op" id="7459525">]</span><span class="ident" id="7459526">Attr</span><span class="op" id="7459530">{</span><span class="op" id="7459531">}</span><span class="op" id="7459532">}</span><span class="op" id="7459533">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7459536">EndElement</span><span class="op" id="7459546">{</span><span class="ident" id="7459547">Name</span><span class="op" id="7459551">{</span><span class="string" id="7459552">&#34;ns2&#34;</span><span class="op" id="7459557">,</span>&nbsp;<span class="string" id="7459559">&#34;inner&#34;</span><span class="op" id="7459566">}</span><span class="op" id="7459567">}</span><span class="op" id="7459568">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7459571">CharData</span><span class="op" id="7459579">(</span><span class="string" id="7459580">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7459586">)</span><span class="op" id="7459587">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7459590">EndElement</span><span class="op" id="7459600">{</span><span class="ident" id="7459601">Name</span><span class="op" id="7459605">{</span><span class="string" id="7459606">&#34;ns2&#34;</span><span class="op" id="7459611">,</span>&nbsp;<span class="string" id="7459613">&#34;outer&#34;</span><span class="op" id="7459620">}</span><span class="op" id="7459621">}</span><span class="op" id="7459622">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7459625">CharData</span><span class="op" id="7459633">(</span><span class="string" id="7459634">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7459640">)</span><span class="op" id="7459641">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7459644">StartElement</span><span class="op" id="7459656">{</span><span class="ident" id="7459657">Name</span><span class="op" id="7459661">{</span><span class="string" id="7459662">&#34;ns3&#34;</span><span class="op" id="7459667">,</span>&nbsp;<span class="string" id="7459669">&#34;name&#34;</span><span class="op" id="7459675">}</span><span class="op" id="7459676">,</span>&nbsp;<span class="op" id="7459678">[</span><span class="op" id="7459679">]</span><span class="ident" id="7459680">Attr</span><span class="op" id="7459684">{</span><span class="op" id="7459685">}</span><span class="op" id="7459686">}</span><span class="op" id="7459687">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7459690">CharData</span><span class="op" id="7459698">(</span><span class="string" id="7459699">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="7459707">)</span><span class="op" id="7459708">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7459711">CharData</span><span class="op" id="7459719">(</span><span class="string" id="7459720">&#34;Some&nbsp;text&nbsp;here.&#34;</span><span class="op" id="7459737">)</span><span class="op" id="7459738">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7459741">CharData</span><span class="op" id="7459749">(</span><span class="string" id="7459750">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7459756">)</span><span class="op" id="7459757">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7459760">EndElement</span><span class="op" id="7459770">{</span><span class="ident" id="7459771">Name</span><span class="op" id="7459775">{</span><span class="string" id="7459776">&#34;ns3&#34;</span><span class="op" id="7459781">,</span>&nbsp;<span class="string" id="7459783">&#34;name&#34;</span><span class="op" id="7459789">}</span><span class="op" id="7459790">}</span><span class="op" id="7459791">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7459794">CharData</span><span class="op" id="7459802">(</span><span class="string" id="7459803">&#34;\n&#34;</span><span class="op" id="7459807">)</span><span class="op" id="7459808">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7459811">EndElement</span><span class="op" id="7459821">{</span><span class="ident" id="7459822">Name</span><span class="op" id="7459826">{</span><span class="string" id="7459827">&#34;ns2&#34;</span><span class="op" id="7459832">,</span>&nbsp;<span class="string" id="7459834">&#34;body&#34;</span><span class="op" id="7459840">}</span><span class="op" id="7459841">}</span><span class="op" id="7459842">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7459845">Comment</span><span class="op" id="7459852">(</span><span class="string" id="7459853">&#34;&nbsp;missing&nbsp;final&nbsp;newline&nbsp;&#34;</span><span class="op" id="7459878">)</span><span class="op" id="7459879">,</span><br>
<span class="lineno"></span><span class="op" id="7459881">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="keyword" id="7459884">const</span>&nbsp;<span class="ident" id="7459890">testInputAltEncoding</span>&nbsp;<span class="op" id="7459911">=</span>&nbsp;<span class="string" id="7459913">`<br>
<span class="lineno"></span>&lt;?xml&nbsp;version=&#34;1.0&#34;&nbsp;encoding=&#34;x-testing-uppercase&#34;?&gt;<br>
<span class="lineno"></span>&lt;TAG&gt;VALUE&lt;/TAG&gt;`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7459987">var</span>&nbsp;<span class="ident" id="7459991">rawTokensAltEncoding</span>&nbsp;<span class="op" id="7460012">=</span>&nbsp;<span class="op" id="7460014">[</span><span class="op" id="7460015">]</span><span class="ident" id="7460016">Token</span><span class="op" id="7460021">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7460024">CharData</span><span class="op" id="7460032">(</span><span class="string" id="7460033">&#34;\n&#34;</span><span class="op" id="7460037">)</span><span class="op" id="7460038">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7460041">ProcInst</span><span class="op" id="7460049">{</span><span class="string" id="7460050">&#34;xml&#34;</span><span class="op" id="7460055">,</span>&nbsp;<span class="op" id="7460057">[</span><span class="op" id="7460058">]</span><span class="builtintype" id="7460059">byte</span><span class="op" id="7460063">(</span><span class="string" id="7460064">`version=&#34;1.0&#34;&nbsp;encoding=&#34;x-testing-uppercase&#34;`</span><span class="op" id="7460110">)</span><span class="op" id="7460111">}</span><span class="op" id="7460112">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7460115">CharData</span><span class="op" id="7460123">(</span><span class="string" id="7460124">&#34;\n&#34;</span><span class="op" id="7460128">)</span><span class="op" id="7460129">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7460132">StartElement</span><span class="op" id="7460144">{</span><span class="ident" id="7460145">Name</span><span class="op" id="7460149">{</span><span class="string" id="7460150">&#34;&#34;</span><span class="op" id="7460152">,</span>&nbsp;<span class="string" id="7460154">&#34;tag&#34;</span><span class="op" id="7460159">}</span><span class="op" id="7460160">,</span>&nbsp;<span class="op" id="7460162">[</span><span class="op" id="7460163">]</span><span class="ident" id="7460164">Attr</span><span class="op" id="7460168">{</span><span class="op" id="7460169">}</span><span class="op" id="7460170">}</span><span class="op" id="7460171">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7460174">CharData</span><span class="op" id="7460182">(</span><span class="string" id="7460183">&#34;value&#34;</span><span class="op" id="7460190">)</span><span class="op" id="7460191">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7460194">EndElement</span><span class="op" id="7460204">{</span><span class="ident" id="7460205">Name</span><span class="op" id="7460209">{</span><span class="string" id="7460210">&#34;&#34;</span><span class="op" id="7460212">,</span>&nbsp;<span class="string" id="7460214">&#34;tag&#34;</span><span class="op" id="7460219">}</span><span class="op" id="7460220">}</span><span class="op" id="7460221">,</span><br>
<span class="lineno"></span><span class="op" id="7460223">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7460226">var</span>&nbsp;<span class="ident" id="7460230">xmlInput</span>&nbsp;<span class="op" id="7460239">=</span>&nbsp;<span class="op" id="7460241">[</span><span class="op" id="7460242">]</span><span class="builtintype" id="7460243">string</span><span class="op" id="7460249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7460252">//&nbsp;unexpected&nbsp;EOF&nbsp;cases</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7460277">&#34;&lt;&#34;</span><span class="op" id="7460280">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7460283">&#34;&lt;t&#34;</span><span class="op" id="7460287">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7460290">&#34;&lt;t&nbsp;&#34;</span><span class="op" id="7460295">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7460298">&#34;&lt;t/&#34;</span><span class="op" id="7460303">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7460306">&#34;&lt;!&#34;</span><span class="op" id="7460310">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7460313">&#34;&lt;!-&#34;</span><span class="op" id="7460318">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7460321">&#34;&lt;!--&#34;</span><span class="op" id="7460327">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7460330">&#34;&lt;!--c-&#34;</span><span class="op" id="7460338">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7460341">&#34;&lt;!--c--&#34;</span><span class="op" id="7460350">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7460353">&#34;&lt;!d&#34;</span><span class="op" id="7460358">,</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7460361">&#34;&lt;t&gt;&lt;/&#34;</span><span class="op" id="7460368">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7460371">&#34;&lt;t&gt;&lt;/t&#34;</span><span class="op" id="7460379">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7460382">&#34;&lt;?&#34;</span><span class="op" id="7460386">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7460389">&#34;&lt;?p&#34;</span><span class="op" id="7460394">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7460397">&#34;&lt;t&nbsp;a&#34;</span><span class="op" id="7460403">,</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7460406">&#34;&lt;t&nbsp;a=&#34;</span><span class="op" id="7460413">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7460416">&#34;&lt;t&nbsp;a=&#39;&#34;</span><span class="op" id="7460424">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7460427">&#34;&lt;t&nbsp;a=&#39;&#39;&#34;</span><span class="op" id="7460436">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7460439">&#34;&lt;t/&gt;&lt;![&#34;</span><span class="op" id="7460448">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7460451">&#34;&lt;t/&gt;&lt;![C&#34;</span><span class="op" id="7460461">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7460464">&#34;&lt;t/&gt;&lt;![CDATA[d&#34;</span><span class="op" id="7460480">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7460483">&#34;&lt;t/&gt;&lt;![CDATA[d]&#34;</span><span class="op" id="7460500">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7460503">&#34;&lt;t/&gt;&lt;![CDATA[d]]&#34;</span><span class="op" id="7460521">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7460525">//&nbsp;other&nbsp;Syntax&nbsp;errors</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7460549">&#34;&lt;&gt;&#34;</span><span class="op" id="7460553">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7460556">&#34;&lt;t/a&#34;</span><span class="op" id="7460562">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7460565">&#34;&lt;0&nbsp;/&gt;&#34;</span><span class="op" id="7460572">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7460575">&#34;&lt;?0&nbsp;&gt;&#34;</span><span class="op" id="7460582">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7460585">//&nbsp;&nbsp;&nbsp;&nbsp&#34;&lt;!0&nbsp;&gt;&#34;,&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;let&nbsp;the&nbsp;Token()&nbsp;caller&nbsp;handle</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7460631">&#34;&lt;/0&gt;&#34;</span><span class="op" id="7460637">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7460640">&#34;&lt;t&nbsp;0=&#39;&#39;&gt;&#34;</span><span class="op" id="7460650">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7460653">&#34;&lt;t&nbsp;a=&#39;&amp;&#39;&gt;&#34;</span><span class="op" id="7460664">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7460667">&#34;&lt;t&nbsp;a=&#39;&lt;&#39;&gt;&#34;</span><span class="op" id="7460678">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7460681">&#34;&lt;t&gt;&amp;nbspc;&lt;/t&gt;&#34;</span><span class="op" id="7460697">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7460700">&#34;&lt;t&nbsp;a&gt;&#34;</span><span class="op" id="7460707">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7460710">&#34;&lt;t&nbsp;a=&gt;&#34;</span><span class="op" id="7460718">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7460721">&#34;&lt;t&nbsp;a=v&gt;&#34;</span><span class="op" id="7460730">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7460733">//&nbsp;&nbsp;&nbsp;&nbsp&#34;&lt;![CDATA[d]]&gt;&#34;,&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;let&nbsp;the&nbsp;Token()&nbsp;caller&nbsp;handle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7460787">&#34;&lt;t&gt;&lt;/e&gt;&#34;</span><span class="op" id="7460796">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7460799">&#34;&lt;t&gt;&lt;/&gt;&#34;</span><span class="op" id="7460807">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7460810">&#34;&lt;t&gt;&lt;/t!&#34;</span><span class="op" id="7460819">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7460822">&#34;&lt;t&gt;cdata]]&gt;&lt;/t&gt;&#34;</span><span class="op" id="7460839">,</span><br>
<span class="lineno"></span><span class="op" id="7460841">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="keyword" id="7460844">func</span>&nbsp;<span class="ident" id="7460849">TestRawToken</span><span class="op" id="7460861">(</span><span class="ident" id="7460862">t</span>&nbsp;<span class="op" id="7460864">*</span><span class="ident" id="7460865">testing</span><span class="op" id="7460872">.</span><span class="ident" id="7460873">T</span><span class="op" id="7460874">)</span>&nbsp;<span class="op" id="7460876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7460879">d</span>&nbsp;<span class="op" id="7460881">:=</span>&nbsp;<span class="ident" id="7460884">NewDecoder</span><span class="op" id="7460894">(</span><span class="ident" id="7460895">strings</span><span class="op" id="7460902">.</span><span class="ident" id="7460903">NewReader</span><span class="op" id="7460912">(</span><span class="ident" id="7460913">testInput</span><span class="op" id="7460922">)</span><span class="op" id="7460923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7460926">d</span><span class="op" id="7460927">.</span><span class="ident" id="7460928">Entity</span>&nbsp;<span class="op" id="7460935">=</span>&nbsp;<span class="ident" id="7460937">testEntity</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7460949">testRawToken</span><span class="op" id="7460961">(</span><span class="ident" id="7460962">t</span><span class="op" id="7460963">,</span>&nbsp;<span class="ident" id="7460965">d</span><span class="op" id="7460966">,</span>&nbsp;<span class="ident" id="7460968">testInput</span><span class="op" id="7460977">,</span>&nbsp;<span class="ident" id="7460979">rawTokens</span><span class="op" id="7460988">)</span><br>
<span class="lineno"></span><span class="op" id="7460990">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="7460993">const</span>&nbsp;<span class="ident" id="7460999">nonStrictInput</span>&nbsp;<span class="op" id="7461014">=</span>&nbsp;<span class="string" id="7461016">`<br>
<span class="lineno"></span>&lt;tag&gt;non&amp;entity&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;unknown;entity&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;#123&lt;/tag&gt;<br>
<span class="lineno">180</span>&lt;tag&gt;&amp;#zzz;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;なまえ3;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;lt-gt;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;0a;&lt;/tag&gt;<br>
<span class="lineno">185</span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7461178">var</span>&nbsp;<span class="ident" id="7461182">nonStringEntity</span>&nbsp;<span class="op" id="7461198">=</span>&nbsp;<span class="keyword" id="7461200">map</span><span class="op" id="7461203">[</span><span class="builtintype" id="7461204">string</span><span class="op" id="7461210">]</span><span class="builtintype" id="7461211">string</span><span class="op" id="7461217">{</span><span class="string" id="7461218">&#34;&#34;</span><span class="op" id="7461220">:</span>&nbsp;<span class="string" id="7461222">&#34;oops!&#34;</span><span class="op" id="7461229">,</span>&nbsp;<span class="string" id="7461231">&#34;0a&#34;</span><span class="op" id="7461235">:</span>&nbsp;<span class="string" id="7461237">&#34;oops!&#34;</span><span class="op" id="7461244">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7461247">var</span>&nbsp;<span class="ident" id="7461251">nonStrictTokens</span>&nbsp;<span class="op" id="7461267">=</span>&nbsp;<span class="op" id="7461269">[</span><span class="op" id="7461270">]</span><span class="ident" id="7461271">Token</span><span class="op" id="7461276">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7461279">CharData</span><span class="op" id="7461287">(</span><span class="string" id="7461288">&#34;\n&#34;</span><span class="op" id="7461292">)</span><span class="op" id="7461293">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7461296">StartElement</span><span class="op" id="7461308">{</span><span class="ident" id="7461309">Name</span><span class="op" id="7461313">{</span><span class="string" id="7461314">&#34;&#34;</span><span class="op" id="7461316">,</span>&nbsp;<span class="string" id="7461318">&#34;tag&#34;</span><span class="op" id="7461323">}</span><span class="op" id="7461324">,</span>&nbsp;<span class="op" id="7461326">[</span><span class="op" id="7461327">]</span><span class="ident" id="7461328">Attr</span><span class="op" id="7461332">{</span><span class="op" id="7461333">}</span><span class="op" id="7461334">}</span><span class="op" id="7461335">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7461338">CharData</span><span class="op" id="7461346">(</span><span class="string" id="7461347">&#34;non&amp;entity&#34;</span><span class="op" id="7461359">)</span><span class="op" id="7461360">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7461363">EndElement</span><span class="op" id="7461373">{</span><span class="ident" id="7461374">Name</span><span class="op" id="7461378">{</span><span class="string" id="7461379">&#34;&#34;</span><span class="op" id="7461381">,</span>&nbsp;<span class="string" id="7461383">&#34;tag&#34;</span><span class="op" id="7461388">}</span><span class="op" id="7461389">}</span><span class="op" id="7461390">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7461393">CharData</span><span class="op" id="7461401">(</span><span class="string" id="7461402">&#34;\n&#34;</span><span class="op" id="7461406">)</span><span class="op" id="7461407">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7461410">StartElement</span><span class="op" id="7461422">{</span><span class="ident" id="7461423">Name</span><span class="op" id="7461427">{</span><span class="string" id="7461428">&#34;&#34;</span><span class="op" id="7461430">,</span>&nbsp;<span class="string" id="7461432">&#34;tag&#34;</span><span class="op" id="7461437">}</span><span class="op" id="7461438">,</span>&nbsp;<span class="op" id="7461440">[</span><span class="op" id="7461441">]</span><span class="ident" id="7461442">Attr</span><span class="op" id="7461446">{</span><span class="op" id="7461447">}</span><span class="op" id="7461448">}</span><span class="op" id="7461449">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7461452">CharData</span><span class="op" id="7461460">(</span><span class="string" id="7461461">&#34;&amp;unknown;entity&#34;</span><span class="op" id="7461478">)</span><span class="op" id="7461479">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7461482">EndElement</span><span class="op" id="7461492">{</span><span class="ident" id="7461493">Name</span><span class="op" id="7461497">{</span><span class="string" id="7461498">&#34;&#34;</span><span class="op" id="7461500">,</span>&nbsp;<span class="string" id="7461502">&#34;tag&#34;</span><span class="op" id="7461507">}</span><span class="op" id="7461508">}</span><span class="op" id="7461509">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7461512">CharData</span><span class="op" id="7461520">(</span><span class="string" id="7461521">&#34;\n&#34;</span><span class="op" id="7461525">)</span><span class="op" id="7461526">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7461529">StartElement</span><span class="op" id="7461541">{</span><span class="ident" id="7461542">Name</span><span class="op" id="7461546">{</span><span class="string" id="7461547">&#34;&#34;</span><span class="op" id="7461549">,</span>&nbsp;<span class="string" id="7461551">&#34;tag&#34;</span><span class="op" id="7461556">}</span><span class="op" id="7461557">,</span>&nbsp;<span class="op" id="7461559">[</span><span class="op" id="7461560">]</span><span class="ident" id="7461561">Attr</span><span class="op" id="7461565">{</span><span class="op" id="7461566">}</span><span class="op" id="7461567">}</span><span class="op" id="7461568">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7461571">CharData</span><span class="op" id="7461579">(</span><span class="string" id="7461580">&#34;&amp;#123&#34;</span><span class="op" id="7461587">)</span><span class="op" id="7461588">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7461591">EndElement</span><span class="op" id="7461601">{</span><span class="ident" id="7461602">Name</span><span class="op" id="7461606">{</span><span class="string" id="7461607">&#34;&#34;</span><span class="op" id="7461609">,</span>&nbsp;<span class="string" id="7461611">&#34;tag&#34;</span><span class="op" id="7461616">}</span><span class="op" id="7461617">}</span><span class="op" id="7461618">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7461621">CharData</span><span class="op" id="7461629">(</span><span class="string" id="7461630">&#34;\n&#34;</span><span class="op" id="7461634">)</span><span class="op" id="7461635">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7461638">StartElement</span><span class="op" id="7461650">{</span><span class="ident" id="7461651">Name</span><span class="op" id="7461655">{</span><span class="string" id="7461656">&#34;&#34;</span><span class="op" id="7461658">,</span>&nbsp;<span class="string" id="7461660">&#34;tag&#34;</span><span class="op" id="7461665">}</span><span class="op" id="7461666">,</span>&nbsp;<span class="op" id="7461668">[</span><span class="op" id="7461669">]</span><span class="ident" id="7461670">Attr</span><span class="op" id="7461674">{</span><span class="op" id="7461675">}</span><span class="op" id="7461676">}</span><span class="op" id="7461677">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7461680">CharData</span><span class="op" id="7461688">(</span><span class="string" id="7461689">&#34;&amp;#zzz;&#34;</span><span class="op" id="7461697">)</span><span class="op" id="7461698">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7461701">EndElement</span><span class="op" id="7461711">{</span><span class="ident" id="7461712">Name</span><span class="op" id="7461716">{</span><span class="string" id="7461717">&#34;&#34;</span><span class="op" id="7461719">,</span>&nbsp;<span class="string" id="7461721">&#34;tag&#34;</span><span class="op" id="7461726">}</span><span class="op" id="7461727">}</span><span class="op" id="7461728">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7461731">CharData</span><span class="op" id="7461739">(</span><span class="string" id="7461740">&#34;\n&#34;</span><span class="op" id="7461744">)</span><span class="op" id="7461745">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7461748">StartElement</span><span class="op" id="7461760">{</span><span class="ident" id="7461761">Name</span><span class="op" id="7461765">{</span><span class="string" id="7461766">&#34;&#34;</span><span class="op" id="7461768">,</span>&nbsp;<span class="string" id="7461770">&#34;tag&#34;</span><span class="op" id="7461775">}</span><span class="op" id="7461776">,</span>&nbsp;<span class="op" id="7461778">[</span><span class="op" id="7461779">]</span><span class="ident" id="7461780">Attr</span><span class="op" id="7461784">{</span><span class="op" id="7461785">}</span><span class="op" id="7461786">}</span><span class="op" id="7461787">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7461790">CharData</span><span class="op" id="7461798">(</span><span class="string" id="7461799">&#34;&amp;なまえ3;&#34;</span><span class="op" id="7461813">)</span><span class="op" id="7461814">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7461817">EndElement</span><span class="op" id="7461827">{</span><span class="ident" id="7461828">Name</span><span class="op" id="7461832">{</span><span class="string" id="7461833">&#34;&#34;</span><span class="op" id="7461835">,</span>&nbsp;<span class="string" id="7461837">&#34;tag&#34;</span><span class="op" id="7461842">}</span><span class="op" id="7461843">}</span><span class="op" id="7461844">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7461847">CharData</span><span class="op" id="7461855">(</span><span class="string" id="7461856">&#34;\n&#34;</span><span class="op" id="7461860">)</span><span class="op" id="7461861">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7461864">StartElement</span><span class="op" id="7461876">{</span><span class="ident" id="7461877">Name</span><span class="op" id="7461881">{</span><span class="string" id="7461882">&#34;&#34;</span><span class="op" id="7461884">,</span>&nbsp;<span class="string" id="7461886">&#34;tag&#34;</span><span class="op" id="7461891">}</span><span class="op" id="7461892">,</span>&nbsp;<span class="op" id="7461894">[</span><span class="op" id="7461895">]</span><span class="ident" id="7461896">Attr</span><span class="op" id="7461900">{</span><span class="op" id="7461901">}</span><span class="op" id="7461902">}</span><span class="op" id="7461903">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7461906">CharData</span><span class="op" id="7461914">(</span><span class="string" id="7461915">&#34;&amp;lt-gt;&#34;</span><span class="op" id="7461924">)</span><span class="op" id="7461925">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7461928">EndElement</span><span class="op" id="7461938">{</span><span class="ident" id="7461939">Name</span><span class="op" id="7461943">{</span><span class="string" id="7461944">&#34;&#34;</span><span class="op" id="7461946">,</span>&nbsp;<span class="string" id="7461948">&#34;tag&#34;</span><span class="op" id="7461953">}</span><span class="op" id="7461954">}</span><span class="op" id="7461955">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7461958">CharData</span><span class="op" id="7461966">(</span><span class="string" id="7461967">&#34;\n&#34;</span><span class="op" id="7461971">)</span><span class="op" id="7461972">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7461975">StartElement</span><span class="op" id="7461987">{</span><span class="ident" id="7461988">Name</span><span class="op" id="7461992">{</span><span class="string" id="7461993">&#34;&#34;</span><span class="op" id="7461995">,</span>&nbsp;<span class="string" id="7461997">&#34;tag&#34;</span><span class="op" id="7462002">}</span><span class="op" id="7462003">,</span>&nbsp;<span class="op" id="7462005">[</span><span class="op" id="7462006">]</span><span class="ident" id="7462007">Attr</span><span class="op" id="7462011">{</span><span class="op" id="7462012">}</span><span class="op" id="7462013">}</span><span class="op" id="7462014">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7462017">CharData</span><span class="op" id="7462025">(</span><span class="string" id="7462026">&#34;&amp;;&#34;</span><span class="op" id="7462030">)</span><span class="op" id="7462031">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7462034">EndElement</span><span class="op" id="7462044">{</span><span class="ident" id="7462045">Name</span><span class="op" id="7462049">{</span><span class="string" id="7462050">&#34;&#34;</span><span class="op" id="7462052">,</span>&nbsp;<span class="string" id="7462054">&#34;tag&#34;</span><span class="op" id="7462059">}</span><span class="op" id="7462060">}</span><span class="op" id="7462061">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7462064">CharData</span><span class="op" id="7462072">(</span><span class="string" id="7462073">&#34;\n&#34;</span><span class="op" id="7462077">)</span><span class="op" id="7462078">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7462081">StartElement</span><span class="op" id="7462093">{</span><span class="ident" id="7462094">Name</span><span class="op" id="7462098">{</span><span class="string" id="7462099">&#34;&#34;</span><span class="op" id="7462101">,</span>&nbsp;<span class="string" id="7462103">&#34;tag&#34;</span><span class="op" id="7462108">}</span><span class="op" id="7462109">,</span>&nbsp;<span class="op" id="7462111">[</span><span class="op" id="7462112">]</span><span class="ident" id="7462113">Attr</span><span class="op" id="7462117">{</span><span class="op" id="7462118">}</span><span class="op" id="7462119">}</span><span class="op" id="7462120">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7462123">CharData</span><span class="op" id="7462131">(</span><span class="string" id="7462132">&#34;&amp;0a;&#34;</span><span class="op" id="7462138">)</span><span class="op" id="7462139">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7462142">EndElement</span><span class="op" id="7462152">{</span><span class="ident" id="7462153">Name</span><span class="op" id="7462157">{</span><span class="string" id="7462158">&#34;&#34;</span><span class="op" id="7462160">,</span>&nbsp;<span class="string" id="7462162">&#34;tag&#34;</span><span class="op" id="7462167">}</span><span class="op" id="7462168">}</span><span class="op" id="7462169">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7462172">CharData</span><span class="op" id="7462180">(</span><span class="string" id="7462181">&#34;\n&#34;</span><span class="op" id="7462185">)</span><span class="op" id="7462186">,</span><br>
<span class="lineno"></span><span class="op" id="7462188">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span><span class="keyword" id="7462191">func</span>&nbsp;<span class="ident" id="7462196">TestNonStrictRawToken</span><span class="op" id="7462217">(</span><span class="ident" id="7462218">t</span>&nbsp;<span class="op" id="7462220">*</span><span class="ident" id="7462221">testing</span><span class="op" id="7462228">.</span><span class="ident" id="7462229">T</span><span class="op" id="7462230">)</span>&nbsp;<span class="op" id="7462232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7462235">d</span>&nbsp;<span class="op" id="7462237">:=</span>&nbsp;<span class="ident" id="7462240">NewDecoder</span><span class="op" id="7462250">(</span><span class="ident" id="7462251">strings</span><span class="op" id="7462258">.</span><span class="ident" id="7462259">NewReader</span><span class="op" id="7462268">(</span><span class="ident" id="7462269">nonStrictInput</span><span class="op" id="7462283">)</span><span class="op" id="7462284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7462287">d</span><span class="op" id="7462288">.</span><span class="ident" id="7462289">Strict</span>&nbsp;<span class="op" id="7462296">=</span>&nbsp;<span class="builtintype" id="7462298">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7462305">testRawToken</span><span class="op" id="7462317">(</span><span class="ident" id="7462318">t</span><span class="op" id="7462319">,</span>&nbsp;<span class="ident" id="7462321">d</span><span class="op" id="7462322">,</span>&nbsp;<span class="ident" id="7462324">nonStrictInput</span><span class="op" id="7462338">,</span>&nbsp;<span class="ident" id="7462340">nonStrictTokens</span><span class="op" id="7462355">)</span><br>
<span class="lineno"></span><span class="op" id="7462357">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="7462360">type</span>&nbsp;<span class="ident" id="7462365">downCaser</span>&nbsp;<span class="keyword" id="7462375">struct</span>&nbsp;<span class="op" id="7462382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7462385">t</span>&nbsp;<span class="op" id="7462387">*</span><span class="ident" id="7462388">testing</span><span class="op" id="7462395">.</span><span class="ident" id="7462396">T</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7462399">r</span>&nbsp;<span class="ident" id="7462401">io</span><span class="op" id="7462403">.</span><span class="ident" id="7462404">ByteReader</span><br>
<span class="lineno"></span><span class="op" id="7462415">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="keyword" id="7462418">func</span>&nbsp;<span class="op" id="7462423">(</span><span class="ident" id="7462424">d</span>&nbsp;<span class="op" id="7462426">*</span><span class="ident" id="7462427">downCaser</span><span class="op" id="7462436">)</span>&nbsp;<span class="ident" id="7462438">ReadByte</span><span class="op" id="7462446">(</span><span class="op" id="7462447">)</span>&nbsp;<span class="op" id="7462449">(</span><span class="ident" id="7462450">c</span>&nbsp;<span class="builtintype" id="7462452">byte</span><span class="op" id="7462456">,</span>&nbsp;<span class="ident" id="7462458">err</span>&nbsp;<span class="builtintype" id="7462462">error</span><span class="op" id="7462467">)</span>&nbsp;<span class="op" id="7462469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7462472">c</span><span class="op" id="7462473">,</span>&nbsp;<span class="ident" id="7462475">err</span>&nbsp;<span class="op" id="7462479">=</span>&nbsp;<span class="ident" id="7462481">d</span><span class="op" id="7462482">.</span><span class="ident" id="7462483">r</span><span class="op" id="7462484">.</span><span class="ident" id="7462485">ReadByte</span><span class="op" id="7462493">(</span><span class="op" id="7462494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7462497">if</span>&nbsp;<span class="ident" id="7462500">c</span>&nbsp;<span class="op" id="7462502">&gt;=</span>&nbsp;<span class="string" id="7462505">&#39;A&#39;</span>&nbsp;<span class="op" id="7462509">&amp;&amp;</span>&nbsp;<span class="ident" id="7462512">c</span>&nbsp;<span class="op" id="7462514">&lt;=</span>&nbsp;<span class="string" id="7462517">&#39;Z&#39;</span>&nbsp;<span class="op" id="7462521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7462525">c</span>&nbsp;<span class="op" id="7462527">+=</span>&nbsp;<span class="string" id="7462530">&#39;a&#39;</span>&nbsp;<span class="op" id="7462534">-</span>&nbsp;<span class="string" id="7462536">&#39;A&#39;</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7462541">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7462544">return</span><br>
<span class="lineno"></span><span class="op" id="7462551">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7462554">func</span>&nbsp;<span class="op" id="7462559">(</span><span class="ident" id="7462560">d</span>&nbsp;<span class="op" id="7462562">*</span><span class="ident" id="7462563">downCaser</span><span class="op" id="7462572">)</span>&nbsp;<span class="ident" id="7462574">Read</span><span class="op" id="7462578">(</span><span class="ident" id="7462579">p</span>&nbsp;<span class="op" id="7462581">[</span><span class="op" id="7462582">]</span><span class="builtintype" id="7462583">byte</span><span class="op" id="7462587">)</span>&nbsp;<span class="op" id="7462589">(</span><span class="builtintype" id="7462590">int</span><span class="op" id="7462593">,</span>&nbsp;<span class="builtintype" id="7462595">error</span><span class="op" id="7462600">)</span>&nbsp;<span class="op" id="7462602">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7462605">d</span><span class="op" id="7462606">.</span><span class="ident" id="7462607">t</span><span class="op" id="7462608">.</span><span class="ident" id="7462609">Fatalf</span><span class="op" id="7462615">(</span><span class="string" id="7462616">&#34;unexpected&nbsp;Read&nbsp;call&nbsp;on&nbsp;downCaser&nbsp;reader&#34;</span><span class="op" id="7462658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7462661">panic</span><span class="op" id="7462666">(</span><span class="string" id="7462667">&#34;unreachable&#34;</span><span class="op" id="7462680">)</span><br>
<span class="lineno"></span><span class="op" id="7462682">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7462685">func</span>&nbsp;<span class="ident" id="7462690">TestRawTokenAltEncoding</span><span class="op" id="7462713">(</span><span class="ident" id="7462714">t</span>&nbsp;<span class="op" id="7462716">*</span><span class="ident" id="7462717">testing</span><span class="op" id="7462724">.</span><span class="ident" id="7462725">T</span><span class="op" id="7462726">)</span>&nbsp;<span class="op" id="7462728">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7462731">d</span>&nbsp;<span class="op" id="7462733">:=</span>&nbsp;<span class="ident" id="7462736">NewDecoder</span><span class="op" id="7462746">(</span><span class="ident" id="7462747">strings</span><span class="op" id="7462754">.</span><span class="ident" id="7462755">NewReader</span><span class="op" id="7462764">(</span><span class="ident" id="7462765">testInputAltEncoding</span><span class="op" id="7462785">)</span><span class="op" id="7462786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7462789">d</span><span class="op" id="7462790">.</span><span class="ident" id="7462791">CharsetReader</span>&nbsp;<span class="op" id="7462805">=</span>&nbsp;<span class="keyword" id="7462807">func</span><span class="op" id="7462811">(</span><span class="ident" id="7462812">charset</span>&nbsp;<span class="builtintype" id="7462820">string</span><span class="op" id="7462826">,</span>&nbsp;<span class="ident" id="7462828">input</span>&nbsp;<span class="ident" id="7462834">io</span><span class="op" id="7462836">.</span><span class="ident" id="7462837">Reader</span><span class="op" id="7462843">)</span>&nbsp;<span class="op" id="7462845">(</span><span class="ident" id="7462846">io</span><span class="op" id="7462848">.</span><span class="ident" id="7462849">Reader</span><span class="op" id="7462855">,</span>&nbsp;<span class="builtintype" id="7462857">error</span><span class="op" id="7462862">)</span>&nbsp;<span class="op" id="7462864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7462868">if</span>&nbsp;<span class="ident" id="7462871">charset</span>&nbsp;<span class="op" id="7462879">!=</span>&nbsp;<span class="string" id="7462882">&#34;x-testing-uppercase&#34;</span>&nbsp;<span class="op" id="7462904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7462909">t</span><span class="op" id="7462910">.</span><span class="ident" id="7462911">Fatalf</span><span class="op" id="7462917">(</span><span class="string" id="7462918">&#34;unexpected&nbsp;charset&nbsp;%q&#34;</span><span class="op" id="7462941">,</span>&nbsp;<span class="ident" id="7462943">charset</span><span class="op" id="7462950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7462954">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7462958">return</span>&nbsp;<span class="op" id="7462965">&amp;</span><span class="ident" id="7462966">downCaser</span><span class="op" id="7462975">{</span><span class="ident" id="7462976">t</span><span class="op" id="7462977">,</span>&nbsp;<span class="ident" id="7462979">input</span><span class="op" id="7462984">.</span><span class="op" id="7462985">(</span><span class="ident" id="7462986">io</span><span class="op" id="7462988">.</span><span class="ident" id="7462989">ByteReader</span><span class="op" id="7462999">)</span><span class="op" id="7463000">}</span><span class="op" id="7463001">,</span>&nbsp;<span class="ident" id="7463003">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7463008">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7463011">testRawToken</span><span class="op" id="7463023">(</span><span class="ident" id="7463024">t</span><span class="op" id="7463025">,</span>&nbsp;<span class="ident" id="7463027">d</span><span class="op" id="7463028">,</span>&nbsp;<span class="ident" id="7463030">testInputAltEncoding</span><span class="op" id="7463050">,</span>&nbsp;<span class="ident" id="7463052">rawTokensAltEncoding</span><span class="op" id="7463072">)</span><br>
<span class="lineno"></span><span class="op" id="7463074">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="keyword" id="7463077">func</span>&nbsp;<span class="ident" id="7463082">TestRawTokenAltEncodingNoConverter</span><span class="op" id="7463116">(</span><span class="ident" id="7463117">t</span>&nbsp;<span class="op" id="7463119">*</span><span class="ident" id="7463120">testing</span><span class="op" id="7463127">.</span><span class="ident" id="7463128">T</span><span class="op" id="7463129">)</span>&nbsp;<span class="op" id="7463131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7463134">d</span>&nbsp;<span class="op" id="7463136">:=</span>&nbsp;<span class="ident" id="7463139">NewDecoder</span><span class="op" id="7463149">(</span><span class="ident" id="7463150">strings</span><span class="op" id="7463157">.</span><span class="ident" id="7463158">NewReader</span><span class="op" id="7463167">(</span><span class="ident" id="7463168">testInputAltEncoding</span><span class="op" id="7463188">)</span><span class="op" id="7463189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7463192">token</span><span class="op" id="7463197">,</span>&nbsp;<span class="ident" id="7463199">err</span>&nbsp;<span class="op" id="7463203">:=</span>&nbsp;<span class="ident" id="7463206">d</span><span class="op" id="7463207">.</span><span class="ident" id="7463208">RawToken</span><span class="op" id="7463216">(</span><span class="op" id="7463217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7463220">if</span>&nbsp;<span class="ident" id="7463223">token</span>&nbsp;<span class="op" id="7463229">==</span>&nbsp;<span class="ident" id="7463232">nil</span>&nbsp;<span class="op" id="7463236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7463240">t</span><span class="op" id="7463241">.</span><span class="ident" id="7463242">Fatalf</span><span class="op" id="7463248">(</span><span class="string" id="7463249">&#34;expected&nbsp;a&nbsp;token&nbsp;on&nbsp;first&nbsp;RawToken&nbsp;call&#34;</span><span class="op" id="7463290">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7463293">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7463296">if</span>&nbsp;<span class="ident" id="7463299">err</span>&nbsp;<span class="op" id="7463303">!=</span>&nbsp;<span class="ident" id="7463306">nil</span>&nbsp;<span class="op" id="7463310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7463314">t</span><span class="op" id="7463315">.</span><span class="ident" id="7463316">Fatal</span><span class="op" id="7463321">(</span><span class="ident" id="7463322">err</span><span class="op" id="7463325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7463328">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7463331">token</span><span class="op" id="7463336">,</span>&nbsp;<span class="ident" id="7463338">err</span>&nbsp;<span class="op" id="7463342">=</span>&nbsp;<span class="ident" id="7463344">d</span><span class="op" id="7463345">.</span><span class="ident" id="7463346">RawToken</span><span class="op" id="7463354">(</span><span class="op" id="7463355">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7463358">if</span>&nbsp;<span class="ident" id="7463361">token</span>&nbsp;<span class="op" id="7463367">!=</span>&nbsp;<span class="ident" id="7463370">nil</span>&nbsp;<span class="op" id="7463374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7463378">t</span><span class="op" id="7463379">.</span><span class="ident" id="7463380">Errorf</span><span class="op" id="7463386">(</span><span class="string" id="7463387">&#34;expected&nbsp;a&nbsp;nil&nbsp;token;&nbsp;got&nbsp;%#v&#34;</span><span class="op" id="7463418">,</span>&nbsp;<span class="ident" id="7463420">token</span><span class="op" id="7463425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7463428">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7463431">if</span>&nbsp;<span class="ident" id="7463434">err</span>&nbsp;<span class="op" id="7463438">==</span>&nbsp;<span class="ident" id="7463441">nil</span>&nbsp;<span class="op" id="7463445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7463449">t</span><span class="op" id="7463450">.</span><span class="ident" id="7463451">Fatalf</span><span class="op" id="7463457">(</span><span class="string" id="7463458">&#34;expected&nbsp;an&nbsp;error&nbsp;on&nbsp;second&nbsp;RawToken&nbsp;call&#34;</span><span class="op" id="7463501">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7463504">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7463507">const</span>&nbsp;<span class="ident" id="7463513">encoding</span>&nbsp;<span class="op" id="7463522">=</span>&nbsp;<span class="string" id="7463524">&#34;x-testing-uppercase&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7463547">if</span>&nbsp;<span class="op" id="7463550">!</span><span class="ident" id="7463551">strings</span><span class="op" id="7463558">.</span><span class="ident" id="7463559">Contains</span><span class="op" id="7463567">(</span><span class="ident" id="7463568">err</span><span class="op" id="7463571">.</span><span class="ident" id="7463572">Error</span><span class="op" id="7463577">(</span><span class="op" id="7463578">)</span><span class="op" id="7463579">,</span>&nbsp;<span class="ident" id="7463581">encoding</span><span class="op" id="7463589">)</span>&nbsp;<span class="op" id="7463591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7463595">t</span><span class="op" id="7463596">.</span><span class="ident" id="7463597">Errorf</span><span class="op" id="7463603">(</span><span class="string" id="7463604">&#34;expected&nbsp;error&nbsp;to&nbsp;contain&nbsp;%q;&nbsp;got&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="7463649">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7463654">encoding</span><span class="op" id="7463662">,</span>&nbsp;<span class="ident" id="7463664">err</span><span class="op" id="7463667">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7463670">}</span><br>
<span class="lineno"></span><span class="op" id="7463672">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7463675">func</span>&nbsp;<span class="ident" id="7463680">testRawToken</span><span class="op" id="7463692">(</span><span class="ident" id="7463693">t</span>&nbsp;<span class="op" id="7463695">*</span><span class="ident" id="7463696">testing</span><span class="op" id="7463703">.</span><span class="ident" id="7463704">T</span><span class="op" id="7463705">,</span>&nbsp;<span class="ident" id="7463707">d</span>&nbsp;<span class="op" id="7463709">*</span><span class="ident" id="7463710">Decoder</span><span class="op" id="7463717">,</span>&nbsp;<span class="ident" id="7463719">raw</span>&nbsp;<span class="builtintype" id="7463723">string</span><span class="op" id="7463729">,</span>&nbsp;<span class="ident" id="7463731">rawTokens</span>&nbsp;<span class="op" id="7463741">[</span><span class="op" id="7463742">]</span><span class="ident" id="7463743">Token</span><span class="op" id="7463748">)</span>&nbsp;<span class="op" id="7463750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7463753">lastEnd</span>&nbsp;<span class="op" id="7463761">:=</span>&nbsp;<span class="ident" id="7463764">int64</span><span class="op" id="7463769">(</span><span class="num" id="7463770">0</span><span class="op" id="7463771">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7463774">for</span>&nbsp;<span class="ident" id="7463778">i</span><span class="op" id="7463779">,</span>&nbsp;<span class="ident" id="7463781">want</span>&nbsp;<span class="op" id="7463786">:=</span>&nbsp;<span class="keyword" id="7463789">range</span>&nbsp;<span class="ident" id="7463795">rawTokens</span>&nbsp;<span class="op" id="7463805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7463809">start</span>&nbsp;<span class="op" id="7463815">:=</span>&nbsp;<span class="ident" id="7463818">d</span><span class="op" id="7463819">.</span><span class="ident" id="7463820">InputOffset</span><span class="op" id="7463831">(</span><span class="op" id="7463832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7463836">have</span><span class="op" id="7463840">,</span>&nbsp;<span class="ident" id="7463842">err</span>&nbsp;<span class="op" id="7463846">:=</span>&nbsp;<span class="ident" id="7463849">d</span><span class="op" id="7463850">.</span><span class="ident" id="7463851">RawToken</span><span class="op" id="7463859">(</span><span class="op" id="7463860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7463864">end</span>&nbsp;<span class="op" id="7463868">:=</span>&nbsp;<span class="ident" id="7463871">d</span><span class="op" id="7463872">.</span><span class="ident" id="7463873">InputOffset</span><span class="op" id="7463884">(</span><span class="op" id="7463885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7463889">if</span>&nbsp;<span class="ident" id="7463892">err</span>&nbsp;<span class="op" id="7463896">!=</span>&nbsp;<span class="ident" id="7463899">nil</span>&nbsp;<span class="op" id="7463903">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7463908">t</span><span class="op" id="7463909">.</span><span class="ident" id="7463910">Fatalf</span><span class="op" id="7463916">(</span><span class="string" id="7463917">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="7463949">,</span>&nbsp;<span class="ident" id="7463951">i</span><span class="op" id="7463952">,</span>&nbsp;<span class="ident" id="7463954">err</span><span class="op" id="7463957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7463961">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7463965">if</span>&nbsp;<span class="op" id="7463968">!</span><span class="ident" id="7463969">reflect</span><span class="op" id="7463976">.</span><span class="ident" id="7463977">DeepEqual</span><span class="op" id="7463986">(</span><span class="ident" id="7463987">have</span><span class="op" id="7463991">,</span>&nbsp;<span class="ident" id="7463993">want</span><span class="op" id="7463997">)</span>&nbsp;<span class="op" id="7463999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7464004">var</span>&nbsp;<span class="ident" id="7464008">shave</span><span class="op" id="7464013">,</span>&nbsp;<span class="ident" id="7464015">swant</span>&nbsp;<span class="builtintype" id="7464021">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7464031">if</span>&nbsp;<span class="ident" id="7464034">_</span><span class="op" id="7464035">,</span>&nbsp;<span class="ident" id="7464037">ok</span>&nbsp;<span class="op" id="7464040">:=</span>&nbsp;<span class="ident" id="7464043">have</span><span class="op" id="7464047">.</span><span class="op" id="7464048">(</span><span class="ident" id="7464049">CharData</span><span class="op" id="7464057">)</span><span class="op" id="7464058">;</span>&nbsp;<span class="ident" id="7464060">ok</span>&nbsp;<span class="op" id="7464063">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7464069">shave</span>&nbsp;<span class="op" id="7464075">=</span>&nbsp;<span class="ident" id="7464077">fmt</span><span class="op" id="7464080">.</span><span class="ident" id="7464081">Sprintf</span><span class="op" id="7464088">(</span><span class="string" id="7464089">&#34;CharData(%q)&#34;</span><span class="op" id="7464103">,</span>&nbsp;<span class="ident" id="7464105">have</span><span class="op" id="7464109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7464114">}</span>&nbsp;<span class="keyword" id="7464116">else</span>&nbsp;<span class="op" id="7464121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7464127">shave</span>&nbsp;<span class="op" id="7464133">=</span>&nbsp;<span class="ident" id="7464135">fmt</span><span class="op" id="7464138">.</span><span class="ident" id="7464139">Sprintf</span><span class="op" id="7464146">(</span><span class="string" id="7464147">&#34;%#v&#34;</span><span class="op" id="7464152">,</span>&nbsp;<span class="ident" id="7464154">have</span><span class="op" id="7464158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7464163">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7464168">if</span>&nbsp;<span class="ident" id="7464171">_</span><span class="op" id="7464172">,</span>&nbsp;<span class="ident" id="7464174">ok</span>&nbsp;<span class="op" id="7464177">:=</span>&nbsp;<span class="ident" id="7464180">want</span><span class="op" id="7464184">.</span><span class="op" id="7464185">(</span><span class="ident" id="7464186">CharData</span><span class="op" id="7464194">)</span><span class="op" id="7464195">;</span>&nbsp;<span class="ident" id="7464197">ok</span>&nbsp;<span class="op" id="7464200">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7464206">swant</span>&nbsp;<span class="op" id="7464212">=</span>&nbsp;<span class="ident" id="7464214">fmt</span><span class="op" id="7464217">.</span><span class="ident" id="7464218">Sprintf</span><span class="op" id="7464225">(</span><span class="string" id="7464226">&#34;CharData(%q)&#34;</span><span class="op" id="7464240">,</span>&nbsp;<span class="ident" id="7464242">want</span><span class="op" id="7464246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7464251">}</span>&nbsp;<span class="keyword" id="7464253">else</span>&nbsp;<span class="op" id="7464258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7464264">swant</span>&nbsp;<span class="op" id="7464270">=</span>&nbsp;<span class="ident" id="7464272">fmt</span><span class="op" id="7464275">.</span><span class="ident" id="7464276">Sprintf</span><span class="op" id="7464283">(</span><span class="string" id="7464284">&#34;%#v&#34;</span><span class="op" id="7464289">,</span>&nbsp;<span class="ident" id="7464291">want</span><span class="op" id="7464295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7464300">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7464305">t</span><span class="op" id="7464306">.</span><span class="ident" id="7464307">Errorf</span><span class="op" id="7464313">(</span><span class="string" id="7464314">&#34;token&nbsp;%d&nbsp;=&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7464338">,</span>&nbsp;<span class="ident" id="7464340">i</span><span class="op" id="7464341">,</span>&nbsp;<span class="ident" id="7464343">shave</span><span class="op" id="7464348">,</span>&nbsp;<span class="ident" id="7464350">swant</span><span class="op" id="7464355">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7464359">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7464364">//&nbsp;Check&nbsp;that&nbsp;InputOffset&nbsp;returned&nbsp;actual&nbsp;token.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7464415">switch</span>&nbsp;<span class="op" id="7464422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7464426">case</span>&nbsp;<span class="ident" id="7464431">start</span>&nbsp;<span class="op" id="7464437">&lt;</span>&nbsp;<span class="ident" id="7464439">lastEnd</span><span class="op" id="7464446">:</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7464451">t</span><span class="op" id="7464452">.</span><span class="ident" id="7464453">Errorf</span><span class="op" id="7464459">(</span><span class="string" id="7464460">&#34;token&nbsp;%d:&nbsp;position&nbsp;[%d,%d)&nbsp;for&nbsp;%T&nbsp;is&nbsp;before&nbsp;previous&nbsp;token&#34;</span><span class="op" id="7464520">,</span>&nbsp;<span class="ident" id="7464522">i</span><span class="op" id="7464523">,</span>&nbsp;<span class="ident" id="7464525">start</span><span class="op" id="7464530">,</span>&nbsp;<span class="ident" id="7464532">end</span><span class="op" id="7464535">,</span>&nbsp;<span class="ident" id="7464537">have</span><span class="op" id="7464541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7464545">case</span>&nbsp;<span class="ident" id="7464550">start</span>&nbsp;<span class="op" id="7464556">&gt;=</span>&nbsp;<span class="ident" id="7464559">end</span><span class="op" id="7464562">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7464567">//&nbsp;Special&nbsp;case:&nbsp;EndElement&nbsp;can&nbsp;be&nbsp;synthesized.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7464618">if</span>&nbsp;<span class="ident" id="7464621">start</span>&nbsp;<span class="op" id="7464627">==</span>&nbsp;<span class="ident" id="7464630">end</span>&nbsp;<span class="op" id="7464634">&amp;&amp;</span>&nbsp;<span class="ident" id="7464637">end</span>&nbsp;<span class="op" id="7464641">==</span>&nbsp;<span class="ident" id="7464644">lastEnd</span>&nbsp;<span class="op" id="7464652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7464658">break</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7464667">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7464672">t</span><span class="op" id="7464673">.</span><span class="ident" id="7464674">Errorf</span><span class="op" id="7464680">(</span><span class="string" id="7464681">&#34;token&nbsp;%d:&nbsp;position&nbsp;[%d,%d)&nbsp;for&nbsp;%T&nbsp;is&nbsp;empty&#34;</span><span class="op" id="7464725">,</span>&nbsp;<span class="ident" id="7464727">i</span><span class="op" id="7464728">,</span>&nbsp;<span class="ident" id="7464730">start</span><span class="op" id="7464735">,</span>&nbsp;<span class="ident" id="7464737">end</span><span class="op" id="7464740">,</span>&nbsp;<span class="ident" id="7464742">have</span><span class="op" id="7464746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7464750">case</span>&nbsp;<span class="ident" id="7464755">end</span>&nbsp;<span class="op" id="7464759">&gt;</span>&nbsp;<span class="ident" id="7464761">int64</span><span class="op" id="7464766">(</span><span class="builtinfunc" id="7464767">len</span><span class="op" id="7464770">(</span><span class="ident" id="7464771">raw</span><span class="op" id="7464774">)</span><span class="op" id="7464775">)</span><span class="op" id="7464776">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7464781">t</span><span class="op" id="7464782">.</span><span class="ident" id="7464783">Errorf</span><span class="op" id="7464789">(</span><span class="string" id="7464790">&#34;token&nbsp;%d:&nbsp;position&nbsp;[%d,%d)&nbsp;for&nbsp;%T&nbsp;extends&nbsp;beyond&nbsp;input&#34;</span><span class="op" id="7464846">,</span>&nbsp;<span class="ident" id="7464848">i</span><span class="op" id="7464849">,</span>&nbsp;<span class="ident" id="7464851">start</span><span class="op" id="7464856">,</span>&nbsp;<span class="ident" id="7464858">end</span><span class="op" id="7464861">,</span>&nbsp;<span class="ident" id="7464863">have</span><span class="op" id="7464867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7464871">default</span><span class="op" id="7464878">:</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7464883">text</span>&nbsp;<span class="op" id="7464888">:=</span>&nbsp;<span class="ident" id="7464891">raw</span><span class="op" id="7464894">[</span><span class="ident" id="7464895">start</span><span class="op" id="7464900">:</span><span class="ident" id="7464901">end</span><span class="op" id="7464904">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7464909">if</span>&nbsp;<span class="ident" id="7464912">strings</span><span class="op" id="7464919">.</span><span class="ident" id="7464920">ContainsAny</span><span class="op" id="7464931">(</span><span class="ident" id="7464932">text</span><span class="op" id="7464936">,</span>&nbsp;<span class="string" id="7464938">&#34;&lt;&gt;&#34;</span><span class="op" id="7464942">)</span>&nbsp;<span class="op" id="7464944">&amp;&amp;</span>&nbsp;<span class="op" id="7464947">(</span><span class="op" id="7464948">!</span><span class="ident" id="7464949">strings</span><span class="op" id="7464956">.</span><span class="ident" id="7464957">HasPrefix</span><span class="op" id="7464966">(</span><span class="ident" id="7464967">text</span><span class="op" id="7464971">,</span>&nbsp;<span class="string" id="7464973">&#34;&lt;&#34;</span><span class="op" id="7464976">)</span>&nbsp;<span class="op" id="7464978">||</span>&nbsp;<span class="op" id="7464981">!</span><span class="ident" id="7464982">strings</span><span class="op" id="7464989">.</span><span class="ident" id="7464990">HasSuffix</span><span class="op" id="7464999">(</span><span class="ident" id="7465000">text</span><span class="op" id="7465004">,</span>&nbsp;<span class="string" id="7465006">&#34;&gt;&#34;</span><span class="op" id="7465009">)</span><span class="op" id="7465010">)</span>&nbsp;<span class="op" id="7465012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7465018">t</span><span class="op" id="7465019">.</span><span class="ident" id="7465020">Errorf</span><span class="op" id="7465026">(</span><span class="string" id="7465027">&#34;token&nbsp;%d:&nbsp;misaligned&nbsp;raw&nbsp;token&nbsp;%#q&nbsp;for&nbsp;%T&#34;</span><span class="op" id="7465070">,</span>&nbsp;<span class="ident" id="7465072">i</span><span class="op" id="7465073">,</span>&nbsp;<span class="ident" id="7465075">text</span><span class="op" id="7465079">,</span>&nbsp;<span class="ident" id="7465081">have</span><span class="op" id="7465085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7465090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7465094">}</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7465098">lastEnd</span>&nbsp;<span class="op" id="7465106">=</span>&nbsp;<span class="ident" id="7465108">end</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7465113">}</span><br>
<span class="lineno"></span><span class="op" id="7465115">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7465118">//&nbsp;Ensure&nbsp;that&nbsp;directives&nbsp;(specifically&nbsp;!DOCTYPE)&nbsp;include&nbsp;the&nbsp;complete</span><br>
<span class="lineno">330</span><span class="comment" id="7465189">//&nbsp;text&nbsp;of&nbsp;any&nbsp;nested&nbsp;directives,&nbsp;noting&nbsp;that&nbsp;&lt;&nbsp;and&nbsp;&gt;&nbsp;do&nbsp;not&nbsp;change</span><br>
<span class="lineno"></span><span class="comment" id="7465257">//&nbsp;nesting&nbsp;depth&nbsp;if&nbsp;they&nbsp;are&nbsp;in&nbsp;single&nbsp;or&nbsp;double&nbsp;quotes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7465315">var</span>&nbsp;<span class="ident" id="7465319">nestedDirectivesInput</span>&nbsp;<span class="op" id="7465341">=</span>&nbsp;<span class="string" id="7465343">`<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]&gt;<br>
<span class="lineno">335</span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&gt;&#34;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&lt;&#34;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&gt;&#39;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&lt;&#39;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&#34;&gt;&#39;&gt;]&gt;<br>
<span class="lineno">340</span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&#39;&lt;&#34;&gt;]&gt;<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7465609">var</span>&nbsp;<span class="ident" id="7465613">nestedDirectivesTokens</span>&nbsp;<span class="op" id="7465636">=</span>&nbsp;<span class="op" id="7465638">[</span><span class="op" id="7465639">]</span><span class="ident" id="7465640">Token</span><span class="op" id="7465645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7465648">CharData</span><span class="op" id="7465656">(</span><span class="string" id="7465657">&#34;\n&#34;</span><span class="op" id="7465661">)</span><span class="op" id="7465662">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7465665">Directive</span><span class="op" id="7465674">(</span><span class="string" id="7465675">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]`</span><span class="op" id="7465746">)</span><span class="op" id="7465747">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7465750">CharData</span><span class="op" id="7465758">(</span><span class="string" id="7465759">&#34;\n&#34;</span><span class="op" id="7465763">)</span><span class="op" id="7465764">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7465767">Directive</span><span class="op" id="7465776">(</span><span class="string" id="7465777">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&gt;&#34;&gt;]`</span><span class="op" id="7465806">)</span><span class="op" id="7465807">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7465810">CharData</span><span class="op" id="7465818">(</span><span class="string" id="7465819">&#34;\n&#34;</span><span class="op" id="7465823">)</span><span class="op" id="7465824">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7465827">Directive</span><span class="op" id="7465836">(</span><span class="string" id="7465837">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&lt;&#34;&gt;]`</span><span class="op" id="7465866">)</span><span class="op" id="7465867">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7465870">CharData</span><span class="op" id="7465878">(</span><span class="string" id="7465879">&#34;\n&#34;</span><span class="op" id="7465883">)</span><span class="op" id="7465884">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7465887">Directive</span><span class="op" id="7465896">(</span><span class="string" id="7465897">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&gt;&#39;&gt;]`</span><span class="op" id="7465926">)</span><span class="op" id="7465927">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7465930">CharData</span><span class="op" id="7465938">(</span><span class="string" id="7465939">&#34;\n&#34;</span><span class="op" id="7465943">)</span><span class="op" id="7465944">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7465947">Directive</span><span class="op" id="7465956">(</span><span class="string" id="7465957">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&lt;&#39;&gt;]`</span><span class="op" id="7465986">)</span><span class="op" id="7465987">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7465990">CharData</span><span class="op" id="7465998">(</span><span class="string" id="7465999">&#34;\n&#34;</span><span class="op" id="7466003">)</span><span class="op" id="7466004">,</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7466007">Directive</span><span class="op" id="7466016">(</span><span class="string" id="7466017">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&#34;&gt;&#39;&gt;]`</span><span class="op" id="7466047">)</span><span class="op" id="7466048">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7466051">CharData</span><span class="op" id="7466059">(</span><span class="string" id="7466060">&#34;\n&#34;</span><span class="op" id="7466064">)</span><span class="op" id="7466065">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7466068">Directive</span><span class="op" id="7466077">(</span><span class="string" id="7466078">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&#39;&lt;&#34;&gt;]`</span><span class="op" id="7466108">)</span><span class="op" id="7466109">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7466112">CharData</span><span class="op" id="7466120">(</span><span class="string" id="7466121">&#34;\n&#34;</span><span class="op" id="7466125">)</span><span class="op" id="7466126">,</span><br>
<span class="lineno"></span><span class="op" id="7466128">}</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span><span class="keyword" id="7466131">func</span>&nbsp;<span class="ident" id="7466136">TestNestedDirectives</span><span class="op" id="7466156">(</span><span class="ident" id="7466157">t</span>&nbsp;<span class="op" id="7466159">*</span><span class="ident" id="7466160">testing</span><span class="op" id="7466167">.</span><span class="ident" id="7466168">T</span><span class="op" id="7466169">)</span>&nbsp;<span class="op" id="7466171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7466174">d</span>&nbsp;<span class="op" id="7466176">:=</span>&nbsp;<span class="ident" id="7466179">NewDecoder</span><span class="op" id="7466189">(</span><span class="ident" id="7466190">strings</span><span class="op" id="7466197">.</span><span class="ident" id="7466198">NewReader</span><span class="op" id="7466207">(</span><span class="ident" id="7466208">nestedDirectivesInput</span><span class="op" id="7466229">)</span><span class="op" id="7466230">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7466234">for</span>&nbsp;<span class="ident" id="7466238">i</span><span class="op" id="7466239">,</span>&nbsp;<span class="ident" id="7466241">want</span>&nbsp;<span class="op" id="7466246">:=</span>&nbsp;<span class="keyword" id="7466249">range</span>&nbsp;<span class="ident" id="7466255">nestedDirectivesTokens</span>&nbsp;<span class="op" id="7466278">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7466282">have</span><span class="op" id="7466286">,</span>&nbsp;<span class="ident" id="7466288">err</span>&nbsp;<span class="op" id="7466292">:=</span>&nbsp;<span class="ident" id="7466295">d</span><span class="op" id="7466296">.</span><span class="ident" id="7466297">Token</span><span class="op" id="7466302">(</span><span class="op" id="7466303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7466307">if</span>&nbsp;<span class="ident" id="7466310">err</span>&nbsp;<span class="op" id="7466314">!=</span>&nbsp;<span class="ident" id="7466317">nil</span>&nbsp;<span class="op" id="7466321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7466326">t</span><span class="op" id="7466327">.</span><span class="ident" id="7466328">Fatalf</span><span class="op" id="7466334">(</span><span class="string" id="7466335">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="7466367">,</span>&nbsp;<span class="ident" id="7466369">i</span><span class="op" id="7466370">,</span>&nbsp;<span class="ident" id="7466372">err</span><span class="op" id="7466375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7466379">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7466383">if</span>&nbsp;<span class="op" id="7466386">!</span><span class="ident" id="7466387">reflect</span><span class="op" id="7466394">.</span><span class="ident" id="7466395">DeepEqual</span><span class="op" id="7466404">(</span><span class="ident" id="7466405">have</span><span class="op" id="7466409">,</span>&nbsp;<span class="ident" id="7466411">want</span><span class="op" id="7466415">)</span>&nbsp;<span class="op" id="7466417">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7466422">t</span><span class="op" id="7466423">.</span><span class="ident" id="7466424">Errorf</span><span class="op" id="7466430">(</span><span class="string" id="7466431">&#34;token&nbsp;%d&nbsp;=&nbsp;%#v&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="7466456">,</span>&nbsp;<span class="ident" id="7466458">i</span><span class="op" id="7466459">,</span>&nbsp;<span class="ident" id="7466461">have</span><span class="op" id="7466465">,</span>&nbsp;<span class="ident" id="7466467">want</span><span class="op" id="7466471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7466475">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7466478">}</span><br>
<span class="lineno"></span><span class="op" id="7466480">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span><span class="keyword" id="7466483">func</span>&nbsp;<span class="ident" id="7466488">TestToken</span><span class="op" id="7466497">(</span><span class="ident" id="7466498">t</span>&nbsp;<span class="op" id="7466500">*</span><span class="ident" id="7466501">testing</span><span class="op" id="7466508">.</span><span class="ident" id="7466509">T</span><span class="op" id="7466510">)</span>&nbsp;<span class="op" id="7466512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7466515">d</span>&nbsp;<span class="op" id="7466517">:=</span>&nbsp;<span class="ident" id="7466520">NewDecoder</span><span class="op" id="7466530">(</span><span class="ident" id="7466531">strings</span><span class="op" id="7466538">.</span><span class="ident" id="7466539">NewReader</span><span class="op" id="7466548">(</span><span class="ident" id="7466549">testInput</span><span class="op" id="7466558">)</span><span class="op" id="7466559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7466562">d</span><span class="op" id="7466563">.</span><span class="ident" id="7466564">Entity</span>&nbsp;<span class="op" id="7466571">=</span>&nbsp;<span class="ident" id="7466573">testEntity</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7466586">for</span>&nbsp;<span class="ident" id="7466590">i</span><span class="op" id="7466591">,</span>&nbsp;<span class="ident" id="7466593">want</span>&nbsp;<span class="op" id="7466598">:=</span>&nbsp;<span class="keyword" id="7466601">range</span>&nbsp;<span class="ident" id="7466607">cookedTokens</span>&nbsp;<span class="op" id="7466620">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7466624">have</span><span class="op" id="7466628">,</span>&nbsp;<span class="ident" id="7466630">err</span>&nbsp;<span class="op" id="7466634">:=</span>&nbsp;<span class="ident" id="7466637">d</span><span class="op" id="7466638">.</span><span class="ident" id="7466639">Token</span><span class="op" id="7466644">(</span><span class="op" id="7466645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7466649">if</span>&nbsp;<span class="ident" id="7466652">err</span>&nbsp;<span class="op" id="7466656">!=</span>&nbsp;<span class="ident" id="7466659">nil</span>&nbsp;<span class="op" id="7466663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7466668">t</span><span class="op" id="7466669">.</span><span class="ident" id="7466670">Fatalf</span><span class="op" id="7466676">(</span><span class="string" id="7466677">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="7466709">,</span>&nbsp;<span class="ident" id="7466711">i</span><span class="op" id="7466712">,</span>&nbsp;<span class="ident" id="7466714">err</span><span class="op" id="7466717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7466721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7466725">if</span>&nbsp;<span class="op" id="7466728">!</span><span class="ident" id="7466729">reflect</span><span class="op" id="7466736">.</span><span class="ident" id="7466737">DeepEqual</span><span class="op" id="7466746">(</span><span class="ident" id="7466747">have</span><span class="op" id="7466751">,</span>&nbsp;<span class="ident" id="7466753">want</span><span class="op" id="7466757">)</span>&nbsp;<span class="op" id="7466759">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7466764">t</span><span class="op" id="7466765">.</span><span class="ident" id="7466766">Errorf</span><span class="op" id="7466772">(</span><span class="string" id="7466773">&#34;token&nbsp;%d&nbsp;=&nbsp;%#v&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="7466798">,</span>&nbsp;<span class="ident" id="7466800">i</span><span class="op" id="7466801">,</span>&nbsp;<span class="ident" id="7466803">have</span><span class="op" id="7466807">,</span>&nbsp;<span class="ident" id="7466809">want</span><span class="op" id="7466813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7466817">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7466820">}</span><br>
<span class="lineno"></span><span class="op" id="7466822">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span><span class="keyword" id="7466825">func</span>&nbsp;<span class="ident" id="7466830">TestSyntax</span><span class="op" id="7466840">(</span><span class="ident" id="7466841">t</span>&nbsp;<span class="op" id="7466843">*</span><span class="ident" id="7466844">testing</span><span class="op" id="7466851">.</span><span class="ident" id="7466852">T</span><span class="op" id="7466853">)</span>&nbsp;<span class="op" id="7466855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7466858">for</span>&nbsp;<span class="ident" id="7466862">i</span>&nbsp;<span class="op" id="7466864">:=</span>&nbsp;<span class="keyword" id="7466867">range</span>&nbsp;<span class="ident" id="7466873">xmlInput</span>&nbsp;<span class="op" id="7466882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7466886">d</span>&nbsp;<span class="op" id="7466888">:=</span>&nbsp;<span class="ident" id="7466891">NewDecoder</span><span class="op" id="7466901">(</span><span class="ident" id="7466902">strings</span><span class="op" id="7466909">.</span><span class="ident" id="7466910">NewReader</span><span class="op" id="7466919">(</span><span class="ident" id="7466920">xmlInput</span><span class="op" id="7466928">[</span><span class="ident" id="7466929">i</span><span class="op" id="7466930">]</span><span class="op" id="7466931">)</span><span class="op" id="7466932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7466936">var</span>&nbsp;<span class="ident" id="7466940">err</span>&nbsp;<span class="builtintype" id="7466944">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7466952">for</span>&nbsp;<span class="ident" id="7466956">_</span><span class="op" id="7466957">,</span>&nbsp;<span class="ident" id="7466959">err</span>&nbsp;<span class="op" id="7466963">=</span>&nbsp;<span class="ident" id="7466965">d</span><span class="op" id="7466966">.</span><span class="ident" id="7466967">Token</span><span class="op" id="7466972">(</span><span class="op" id="7466973">)</span><span class="op" id="7466974">;</span>&nbsp;<span class="ident" id="7466976">err</span>&nbsp;<span class="op" id="7466980">==</span>&nbsp;<span class="ident" id="7466983">nil</span><span class="op" id="7466986">;</span>&nbsp;<span class="ident" id="7466988">_</span><span class="op" id="7466989">,</span>&nbsp;<span class="ident" id="7466991">err</span>&nbsp;<span class="op" id="7466995">=</span>&nbsp;<span class="ident" id="7466997">d</span><span class="op" id="7466998">.</span><span class="ident" id="7466999">Token</span><span class="op" id="7467004">(</span><span class="op" id="7467005">)</span>&nbsp;<span class="op" id="7467007">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7467011">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7467015">if</span>&nbsp;<span class="ident" id="7467018">_</span><span class="op" id="7467019">,</span>&nbsp;<span class="ident" id="7467021">ok</span>&nbsp;<span class="op" id="7467024">:=</span>&nbsp;<span class="ident" id="7467027">err</span><span class="op" id="7467030">.</span><span class="op" id="7467031">(</span><span class="op" id="7467032">*</span><span class="ident" id="7467033">SyntaxError</span><span class="op" id="7467044">)</span><span class="op" id="7467045">;</span>&nbsp;<span class="op" id="7467047">!</span><span class="ident" id="7467048">ok</span>&nbsp;<span class="op" id="7467051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7467056">t</span><span class="op" id="7467057">.</span><span class="ident" id="7467058">Fatalf</span><span class="op" id="7467064">(</span><span class="string" id="7467065">`xmlInput&nbsp;&#34;%s&#34;:&nbsp;expected&nbsp;SyntaxError&nbsp;not&nbsp;received`</span><span class="op" id="7467115">,</span>&nbsp;<span class="ident" id="7467117">xmlInput</span><span class="op" id="7467125">[</span><span class="ident" id="7467126">i</span><span class="op" id="7467127">]</span><span class="op" id="7467128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7467132">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7467135">}</span><br>
<span class="lineno">400</span><span class="op" id="7467137">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7467140">type</span>&nbsp;<span class="ident" id="7467145">allScalars</span>&nbsp;<span class="keyword" id="7467156">struct</span>&nbsp;<span class="op" id="7467163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7467166">True1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7467176">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7467182">True2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7467192">bool</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7467198">False1</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7467208">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7467214">False2</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7467224">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7467230">Int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7467240">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7467245">Int8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7467255">int8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7467261">Int16</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7467271">int16</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7467278">Int32</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7467288">int32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7467295">Int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7467305">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7467312">Uint</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7467322">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7467327">Uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7467337">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7467344">Uint16</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7467354">uint16</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7467362">Uint32</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7467372">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7467380">Uint64</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7467390">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7467398">Uintptr</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7467408">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7467417">Float32</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7467427">float32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7467436">Float64</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7467446">float64</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7467455">String</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7467465">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7467473">PtrString</span>&nbsp;<span class="op" id="7467483">*</span><span class="builtintype" id="7467484">string</span><br>
<span class="lineno"></span><span class="op" id="7467491">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7467494">var</span>&nbsp;<span class="ident" id="7467498">all</span>&nbsp;<span class="op" id="7467502">=</span>&nbsp;<span class="ident" id="7467504">allScalars</span><span class="op" id="7467514">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7467517">True1</span><span class="op" id="7467522">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7467528">true</span><span class="op" id="7467532">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7467535">True2</span><span class="op" id="7467540">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7467546">true</span><span class="op" id="7467550">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7467553">False1</span><span class="op" id="7467559">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7467564">false</span><span class="op" id="7467569">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7467572">False2</span><span class="op" id="7467578">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7467583">false</span><span class="op" id="7467588">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7467591">Int</span><span class="op" id="7467594">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7467602">1</span><span class="op" id="7467603">,</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7467606">Int8</span><span class="op" id="7467610">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7467617">-</span><span class="num" id="7467618">2</span><span class="op" id="7467619">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7467622">Int16</span><span class="op" id="7467627">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7467633">3</span><span class="op" id="7467634">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7467637">Int32</span><span class="op" id="7467642">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7467648">-</span><span class="num" id="7467649">4</span><span class="op" id="7467650">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7467653">Int64</span><span class="op" id="7467658">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7467664">5</span><span class="op" id="7467665">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7467668">Uint</span><span class="op" id="7467672">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7467679">6</span><span class="op" id="7467680">,</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7467683">Uint8</span><span class="op" id="7467688">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7467694">7</span><span class="op" id="7467695">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7467698">Uint16</span><span class="op" id="7467704">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7467709">8</span><span class="op" id="7467710">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7467713">Uint32</span><span class="op" id="7467719">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7467724">9</span><span class="op" id="7467725">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7467728">Uint64</span><span class="op" id="7467734">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7467739">10</span><span class="op" id="7467741">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7467744">Uintptr</span><span class="op" id="7467751">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="7467755">11</span><span class="op" id="7467757">,</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7467760">Float32</span><span class="op" id="7467767">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="7467771">13.0</span><span class="op" id="7467775">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7467778">Float64</span><span class="op" id="7467785">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="7467789">14.0</span><span class="op" id="7467793">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7467796">String</span><span class="op" id="7467802">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7467807">&#34;15&#34;</span><span class="op" id="7467811">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7467814">PtrString</span><span class="op" id="7467823">:</span>&nbsp;<span class="op" id="7467825">&amp;</span><span class="ident" id="7467826">sixteen</span><span class="op" id="7467833">,</span><br>
<span class="lineno"></span><span class="op" id="7467835">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span><span class="keyword" id="7467838">var</span>&nbsp;<span class="ident" id="7467842">sixteen</span>&nbsp;<span class="op" id="7467850">=</span>&nbsp;<span class="string" id="7467852">&#34;16&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7467858">const</span>&nbsp;<span class="ident" id="7467864">testScalarsInput</span>&nbsp;<span class="op" id="7467881">=</span>&nbsp;<span class="string" id="7467883">`&lt;allscalars&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;True1&gt;true&lt;/True1&gt;<br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&lt;True2&gt;1&lt;/True2&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;False1&gt;false&lt;/False1&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;False2&gt;0&lt;/False2&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Int&gt;1&lt;/Int&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Int8&gt;-2&lt;/Int8&gt;<br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Int16&gt;3&lt;/Int16&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Int32&gt;-4&lt;/Int32&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Int64&gt;5&lt;/Int64&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uint&gt;6&lt;/Uint&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uint8&gt;7&lt;/Uint8&gt;<br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uint16&gt;8&lt;/Uint16&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uint32&gt;9&lt;/Uint32&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uint64&gt;10&lt;/Uint64&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uintptr&gt;11&lt;/Uintptr&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Float&gt;12.0&lt;/Float&gt;<br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Float32&gt;13.0&lt;/Float32&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Float64&gt;14.0&lt;/Float64&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;String&gt;15&lt;/String&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;PtrString&gt;16&lt;/PtrString&gt;<br>
<span class="lineno"></span>&lt;/allscalars&gt;`</span><br>
<span class="lineno">470</span><br>
<span class="lineno"></span><span class="keyword" id="7468319">func</span>&nbsp;<span class="ident" id="7468324">TestAllScalars</span><span class="op" id="7468338">(</span><span class="ident" id="7468339">t</span>&nbsp;<span class="op" id="7468341">*</span><span class="ident" id="7468342">testing</span><span class="op" id="7468349">.</span><span class="ident" id="7468350">T</span><span class="op" id="7468351">)</span>&nbsp;<span class="op" id="7468353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7468356">var</span>&nbsp;<span class="ident" id="7468360">a</span>&nbsp;<span class="ident" id="7468362">allScalars</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7468374">err</span>&nbsp;<span class="op" id="7468378">:=</span>&nbsp;<span class="ident" id="7468381">Unmarshal</span><span class="op" id="7468390">(</span><span class="op" id="7468391">[</span><span class="op" id="7468392">]</span><span class="builtintype" id="7468393">byte</span><span class="op" id="7468397">(</span><span class="ident" id="7468398">testScalarsInput</span><span class="op" id="7468414">)</span><span class="op" id="7468415">,</span>&nbsp;<span class="op" id="7468417">&amp;</span><span class="ident" id="7468418">a</span><span class="op" id="7468419">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7468423">if</span>&nbsp;<span class="ident" id="7468426">err</span>&nbsp;<span class="op" id="7468430">!=</span>&nbsp;<span class="ident" id="7468433">nil</span>&nbsp;<span class="op" id="7468437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7468441">t</span><span class="op" id="7468442">.</span><span class="ident" id="7468443">Fatal</span><span class="op" id="7468448">(</span><span class="ident" id="7468449">err</span><span class="op" id="7468452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7468455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7468458">if</span>&nbsp;<span class="op" id="7468461">!</span><span class="ident" id="7468462">reflect</span><span class="op" id="7468469">.</span><span class="ident" id="7468470">DeepEqual</span><span class="op" id="7468479">(</span><span class="ident" id="7468480">a</span><span class="op" id="7468481">,</span>&nbsp;<span class="ident" id="7468483">all</span><span class="op" id="7468486">)</span>&nbsp;<span class="op" id="7468488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7468492">t</span><span class="op" id="7468493">.</span><span class="ident" id="7468494">Errorf</span><span class="op" id="7468500">(</span><span class="string" id="7468501">&#34;have&nbsp;%+v&nbsp;want&nbsp;%+v&#34;</span><span class="op" id="7468520">,</span>&nbsp;<span class="ident" id="7468522">a</span><span class="op" id="7468523">,</span>&nbsp;<span class="ident" id="7468525">all</span><span class="op" id="7468528">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7468531">}</span><br>
<span class="lineno"></span><span class="op" id="7468533">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7468536">type</span>&nbsp;<span class="ident" id="7468541">item</span>&nbsp;<span class="keyword" id="7468546">struct</span>&nbsp;<span class="op" id="7468553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7468556">Field_a</span>&nbsp;<span class="builtintype" id="7468564">string</span><br>
<span class="lineno">485</span><span class="op" id="7468571">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7468574">func</span>&nbsp;<span class="ident" id="7468579">TestIssue569</span><span class="op" id="7468591">(</span><span class="ident" id="7468592">t</span>&nbsp;<span class="op" id="7468594">*</span><span class="ident" id="7468595">testing</span><span class="op" id="7468602">.</span><span class="ident" id="7468603">T</span><span class="op" id="7468604">)</span>&nbsp;<span class="op" id="7468606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7468609">data</span>&nbsp;<span class="op" id="7468614">:=</span>&nbsp;<span class="string" id="7468617">`&lt;item&gt;&lt;Field_a&gt;abcd&lt;/Field_a&gt;&lt;/item&gt;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7468657">var</span>&nbsp;<span class="ident" id="7468661">i</span>&nbsp;<span class="ident" id="7468663">item</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7468669">err</span>&nbsp;<span class="op" id="7468673">:=</span>&nbsp;<span class="ident" id="7468676">Unmarshal</span><span class="op" id="7468685">(</span><span class="op" id="7468686">[</span><span class="op" id="7468687">]</span><span class="builtintype" id="7468688">byte</span><span class="op" id="7468692">(</span><span class="ident" id="7468693">data</span><span class="op" id="7468697">)</span><span class="op" id="7468698">,</span>&nbsp;<span class="op" id="7468700">&amp;</span><span class="ident" id="7468701">i</span><span class="op" id="7468702">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7468706">if</span>&nbsp;<span class="ident" id="7468709">err</span>&nbsp;<span class="op" id="7468713">!=</span>&nbsp;<span class="ident" id="7468716">nil</span>&nbsp;<span class="op" id="7468720">||</span>&nbsp;<span class="ident" id="7468723">i</span><span class="op" id="7468724">.</span><span class="ident" id="7468725">Field_a</span>&nbsp;<span class="op" id="7468733">!=</span>&nbsp;<span class="string" id="7468736">&#34;abcd&#34;</span>&nbsp;<span class="op" id="7468743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7468747">t</span><span class="op" id="7468748">.</span><span class="ident" id="7468749">Fatal</span><span class="op" id="7468754">(</span><span class="string" id="7468755">&#34;Expecting&nbsp;abcd&#34;</span><span class="op" id="7468771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7468774">}</span><br>
<span class="lineno">495</span><span class="op" id="7468776">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7468779">func</span>&nbsp;<span class="ident" id="7468784">TestUnquotedAttrs</span><span class="op" id="7468801">(</span><span class="ident" id="7468802">t</span>&nbsp;<span class="op" id="7468804">*</span><span class="ident" id="7468805">testing</span><span class="op" id="7468812">.</span><span class="ident" id="7468813">T</span><span class="op" id="7468814">)</span>&nbsp;<span class="op" id="7468816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7468819">data</span>&nbsp;<span class="op" id="7468824">:=</span>&nbsp;<span class="string" id="7468827">&#34;&lt;tag&nbsp;attr=azAZ09:-_\t&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7468853">d</span>&nbsp;<span class="op" id="7468855">:=</span>&nbsp;<span class="ident" id="7468858">NewDecoder</span><span class="op" id="7468868">(</span><span class="ident" id="7468869">strings</span><span class="op" id="7468876">.</span><span class="ident" id="7468877">NewReader</span><span class="op" id="7468886">(</span><span class="ident" id="7468887">data</span><span class="op" id="7468891">)</span><span class="op" id="7468892">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7468895">d</span><span class="op" id="7468896">.</span><span class="ident" id="7468897">Strict</span>&nbsp;<span class="op" id="7468904">=</span>&nbsp;<span class="builtintype" id="7468906">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7468913">token</span><span class="op" id="7468918">,</span>&nbsp;<span class="ident" id="7468920">err</span>&nbsp;<span class="op" id="7468924">:=</span>&nbsp;<span class="ident" id="7468927">d</span><span class="op" id="7468928">.</span><span class="ident" id="7468929">Token</span><span class="op" id="7468934">(</span><span class="op" id="7468935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7468938">if</span>&nbsp;<span class="ident" id="7468941">_</span><span class="op" id="7468942">,</span>&nbsp;<span class="ident" id="7468944">ok</span>&nbsp;<span class="op" id="7468947">:=</span>&nbsp;<span class="ident" id="7468950">err</span><span class="op" id="7468953">.</span><span class="op" id="7468954">(</span><span class="op" id="7468955">*</span><span class="ident" id="7468956">SyntaxError</span><span class="op" id="7468967">)</span><span class="op" id="7468968">;</span>&nbsp;<span class="ident" id="7468970">ok</span>&nbsp;<span class="op" id="7468973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7468977">t</span><span class="op" id="7468978">.</span><span class="ident" id="7468979">Errorf</span><span class="op" id="7468985">(</span><span class="string" id="7468986">&#34;Unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="7469008">,</span>&nbsp;<span class="ident" id="7469010">err</span><span class="op" id="7469013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7469016">}</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7469019">if</span>&nbsp;<span class="ident" id="7469022">token</span><span class="op" id="7469027">.</span><span class="op" id="7469028">(</span><span class="ident" id="7469029">StartElement</span><span class="op" id="7469041">)</span><span class="op" id="7469042">.</span><span class="ident" id="7469043">Name</span><span class="op" id="7469047">.</span><span class="ident" id="7469048">Local</span>&nbsp;<span class="op" id="7469054">!=</span>&nbsp;<span class="string" id="7469057">&#34;tag&#34;</span>&nbsp;<span class="op" id="7469063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7469067">t</span><span class="op" id="7469068">.</span><span class="ident" id="7469069">Errorf</span><span class="op" id="7469075">(</span><span class="string" id="7469076">&#34;Unexpected&nbsp;tag&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="7469101">,</span>&nbsp;<span class="ident" id="7469103">token</span><span class="op" id="7469108">.</span><span class="op" id="7469109">(</span><span class="ident" id="7469110">StartElement</span><span class="op" id="7469122">)</span><span class="op" id="7469123">.</span><span class="ident" id="7469124">Name</span><span class="op" id="7469128">.</span><span class="ident" id="7469129">Local</span><span class="op" id="7469134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7469137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7469140">attr</span>&nbsp;<span class="op" id="7469145">:=</span>&nbsp;<span class="ident" id="7469148">token</span><span class="op" id="7469153">.</span><span class="op" id="7469154">(</span><span class="ident" id="7469155">StartElement</span><span class="op" id="7469167">)</span><span class="op" id="7469168">.</span><span class="ident" id="7469169">Attr</span><span class="op" id="7469173">[</span><span class="num" id="7469174">0</span><span class="op" id="7469175">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7469178">if</span>&nbsp;<span class="ident" id="7469181">attr</span><span class="op" id="7469185">.</span><span class="ident" id="7469186">Value</span>&nbsp;<span class="op" id="7469192">!=</span>&nbsp;<span class="string" id="7469195">&#34;azAZ09:-_&#34;</span>&nbsp;<span class="op" id="7469207">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7469211">t</span><span class="op" id="7469212">.</span><span class="ident" id="7469213">Errorf</span><span class="op" id="7469219">(</span><span class="string" id="7469220">&#34;Unexpected&nbsp;attribute&nbsp;value:&nbsp;%v&#34;</span><span class="op" id="7469252">,</span>&nbsp;<span class="ident" id="7469254">attr</span><span class="op" id="7469258">.</span><span class="ident" id="7469259">Value</span><span class="op" id="7469264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7469267">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7469270">if</span>&nbsp;<span class="ident" id="7469273">attr</span><span class="op" id="7469277">.</span><span class="ident" id="7469278">Name</span><span class="op" id="7469282">.</span><span class="ident" id="7469283">Local</span>&nbsp;<span class="op" id="7469289">!=</span>&nbsp;<span class="string" id="7469292">&#34;attr&#34;</span>&nbsp;<span class="op" id="7469299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7469303">t</span><span class="op" id="7469304">.</span><span class="ident" id="7469305">Errorf</span><span class="op" id="7469311">(</span><span class="string" id="7469312">&#34;Unexpected&nbsp;attribute&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="7469343">,</span>&nbsp;<span class="ident" id="7469345">attr</span><span class="op" id="7469349">.</span><span class="ident" id="7469350">Name</span><span class="op" id="7469354">.</span><span class="ident" id="7469355">Local</span><span class="op" id="7469360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7469363">}</span><br>
<span class="lineno">515</span><span class="op" id="7469365">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7469368">func</span>&nbsp;<span class="ident" id="7469373">TestValuelessAttrs</span><span class="op" id="7469391">(</span><span class="ident" id="7469392">t</span>&nbsp;<span class="op" id="7469394">*</span><span class="ident" id="7469395">testing</span><span class="op" id="7469402">.</span><span class="ident" id="7469403">T</span><span class="op" id="7469404">)</span>&nbsp;<span class="op" id="7469406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7469409">tests</span>&nbsp;<span class="op" id="7469415">:=</span>&nbsp;<span class="op" id="7469418">[</span><span class="op" id="7469419">]</span><span class="op" id="7469420">[</span><span class="num" id="7469421">3</span><span class="op" id="7469422">]</span><span class="builtintype" id="7469423">string</span><span class="op" id="7469429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7469433">{</span><span class="string" id="7469434">&#34;&lt;p&nbsp;nowrap&gt;&#34;</span><span class="op" id="7469446">,</span>&nbsp;<span class="string" id="7469448">&#34;p&#34;</span><span class="op" id="7469451">,</span>&nbsp;<span class="string" id="7469453">&#34;nowrap&#34;</span><span class="op" id="7469461">}</span><span class="op" id="7469462">,</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7469466">{</span><span class="string" id="7469467">&#34;&lt;p&nbsp;nowrap&nbsp;&gt;&#34;</span><span class="op" id="7469480">,</span>&nbsp;<span class="string" id="7469482">&#34;p&#34;</span><span class="op" id="7469485">,</span>&nbsp;<span class="string" id="7469487">&#34;nowrap&#34;</span><span class="op" id="7469495">}</span><span class="op" id="7469496">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7469500">{</span><span class="string" id="7469501">&#34;&lt;input&nbsp;checked/&gt;&#34;</span><span class="op" id="7469519">,</span>&nbsp;<span class="string" id="7469521">&#34;input&#34;</span><span class="op" id="7469528">,</span>&nbsp;<span class="string" id="7469530">&#34;checked&#34;</span><span class="op" id="7469539">}</span><span class="op" id="7469540">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7469544">{</span><span class="string" id="7469545">&#34;&lt;input&nbsp;checked&nbsp;/&gt;&#34;</span><span class="op" id="7469564">,</span>&nbsp;<span class="string" id="7469566">&#34;input&#34;</span><span class="op" id="7469573">,</span>&nbsp;<span class="string" id="7469575">&#34;checked&#34;</span><span class="op" id="7469584">}</span><span class="op" id="7469585">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7469588">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7469591">for</span>&nbsp;<span class="ident" id="7469595">_</span><span class="op" id="7469596">,</span>&nbsp;<span class="ident" id="7469598">test</span>&nbsp;<span class="op" id="7469603">:=</span>&nbsp;<span class="keyword" id="7469606">range</span>&nbsp;<span class="ident" id="7469612">tests</span>&nbsp;<span class="op" id="7469618">{</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7469622">d</span>&nbsp;<span class="op" id="7469624">:=</span>&nbsp;<span class="ident" id="7469627">NewDecoder</span><span class="op" id="7469637">(</span><span class="ident" id="7469638">strings</span><span class="op" id="7469645">.</span><span class="ident" id="7469646">NewReader</span><span class="op" id="7469655">(</span><span class="ident" id="7469656">test</span><span class="op" id="7469660">[</span><span class="num" id="7469661">0</span><span class="op" id="7469662">]</span><span class="op" id="7469663">)</span><span class="op" id="7469664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7469668">d</span><span class="op" id="7469669">.</span><span class="ident" id="7469670">Strict</span>&nbsp;<span class="op" id="7469677">=</span>&nbsp;<span class="builtintype" id="7469679">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7469687">token</span><span class="op" id="7469692">,</span>&nbsp;<span class="ident" id="7469694">err</span>&nbsp;<span class="op" id="7469698">:=</span>&nbsp;<span class="ident" id="7469701">d</span><span class="op" id="7469702">.</span><span class="ident" id="7469703">Token</span><span class="op" id="7469708">(</span><span class="op" id="7469709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7469713">if</span>&nbsp;<span class="ident" id="7469716">_</span><span class="op" id="7469717">,</span>&nbsp;<span class="ident" id="7469719">ok</span>&nbsp;<span class="op" id="7469722">:=</span>&nbsp;<span class="ident" id="7469725">err</span><span class="op" id="7469728">.</span><span class="op" id="7469729">(</span><span class="op" id="7469730">*</span><span class="ident" id="7469731">SyntaxError</span><span class="op" id="7469742">)</span><span class="op" id="7469743">;</span>&nbsp;<span class="ident" id="7469745">ok</span>&nbsp;<span class="op" id="7469748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7469753">t</span><span class="op" id="7469754">.</span><span class="ident" id="7469755">Errorf</span><span class="op" id="7469761">(</span><span class="string" id="7469762">&#34;Unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="7469784">,</span>&nbsp;<span class="ident" id="7469786">err</span><span class="op" id="7469789">)</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7469793">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7469797">if</span>&nbsp;<span class="ident" id="7469800">token</span><span class="op" id="7469805">.</span><span class="op" id="7469806">(</span><span class="ident" id="7469807">StartElement</span><span class="op" id="7469819">)</span><span class="op" id="7469820">.</span><span class="ident" id="7469821">Name</span><span class="op" id="7469825">.</span><span class="ident" id="7469826">Local</span>&nbsp;<span class="op" id="7469832">!=</span>&nbsp;<span class="ident" id="7469835">test</span><span class="op" id="7469839">[</span><span class="num" id="7469840">1</span><span class="op" id="7469841">]</span>&nbsp;<span class="op" id="7469843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7469848">t</span><span class="op" id="7469849">.</span><span class="ident" id="7469850">Errorf</span><span class="op" id="7469856">(</span><span class="string" id="7469857">&#34;Unexpected&nbsp;tag&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="7469882">,</span>&nbsp;<span class="ident" id="7469884">token</span><span class="op" id="7469889">.</span><span class="op" id="7469890">(</span><span class="ident" id="7469891">StartElement</span><span class="op" id="7469903">)</span><span class="op" id="7469904">.</span><span class="ident" id="7469905">Name</span><span class="op" id="7469909">.</span><span class="ident" id="7469910">Local</span><span class="op" id="7469915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7469919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7469923">attr</span>&nbsp;<span class="op" id="7469928">:=</span>&nbsp;<span class="ident" id="7469931">token</span><span class="op" id="7469936">.</span><span class="op" id="7469937">(</span><span class="ident" id="7469938">StartElement</span><span class="op" id="7469950">)</span><span class="op" id="7469951">.</span><span class="ident" id="7469952">Attr</span><span class="op" id="7469956">[</span><span class="num" id="7469957">0</span><span class="op" id="7469958">]</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7469962">if</span>&nbsp;<span class="ident" id="7469965">attr</span><span class="op" id="7469969">.</span><span class="ident" id="7469970">Value</span>&nbsp;<span class="op" id="7469976">!=</span>&nbsp;<span class="ident" id="7469979">test</span><span class="op" id="7469983">[</span><span class="num" id="7469984">2</span><span class="op" id="7469985">]</span>&nbsp;<span class="op" id="7469987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7469992">t</span><span class="op" id="7469993">.</span><span class="ident" id="7469994">Errorf</span><span class="op" id="7470000">(</span><span class="string" id="7470001">&#34;Unexpected&nbsp;attribute&nbsp;value:&nbsp;%v&#34;</span><span class="op" id="7470033">,</span>&nbsp;<span class="ident" id="7470035">attr</span><span class="op" id="7470039">.</span><span class="ident" id="7470040">Value</span><span class="op" id="7470045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7470049">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7470053">if</span>&nbsp;<span class="ident" id="7470056">attr</span><span class="op" id="7470060">.</span><span class="ident" id="7470061">Name</span><span class="op" id="7470065">.</span><span class="ident" id="7470066">Local</span>&nbsp;<span class="op" id="7470072">!=</span>&nbsp;<span class="ident" id="7470075">test</span><span class="op" id="7470079">[</span><span class="num" id="7470080">2</span><span class="op" id="7470081">]</span>&nbsp;<span class="op" id="7470083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7470088">t</span><span class="op" id="7470089">.</span><span class="ident" id="7470090">Errorf</span><span class="op" id="7470096">(</span><span class="string" id="7470097">&#34;Unexpected&nbsp;attribute&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="7470128">,</span>&nbsp;<span class="ident" id="7470130">attr</span><span class="op" id="7470134">.</span><span class="ident" id="7470135">Name</span><span class="op" id="7470139">.</span><span class="ident" id="7470140">Local</span><span class="op" id="7470145">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7470149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7470152">}</span><br>
<span class="lineno"></span><span class="op" id="7470154">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7470157">func</span>&nbsp;<span class="ident" id="7470162">TestCopyTokenCharData</span><span class="op" id="7470183">(</span><span class="ident" id="7470184">t</span>&nbsp;<span class="op" id="7470186">*</span><span class="ident" id="7470187">testing</span><span class="op" id="7470194">.</span><span class="ident" id="7470195">T</span><span class="op" id="7470196">)</span>&nbsp;<span class="op" id="7470198">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7470201">data</span>&nbsp;<span class="op" id="7470206">:=</span>&nbsp;<span class="op" id="7470209">[</span><span class="op" id="7470210">]</span><span class="builtintype" id="7470211">byte</span><span class="op" id="7470215">(</span><span class="string" id="7470216">&#34;same&nbsp;data&#34;</span><span class="op" id="7470227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7470230">var</span>&nbsp;<span class="ident" id="7470234">tok1</span>&nbsp;<span class="ident" id="7470239">Token</span>&nbsp;<span class="op" id="7470245">=</span>&nbsp;<span class="ident" id="7470247">CharData</span><span class="op" id="7470255">(</span><span class="ident" id="7470256">data</span><span class="op" id="7470260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7470263">tok2</span>&nbsp;<span class="op" id="7470268">:=</span>&nbsp;<span class="ident" id="7470271">CopyToken</span><span class="op" id="7470280">(</span><span class="ident" id="7470281">tok1</span><span class="op" id="7470285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7470288">if</span>&nbsp;<span class="op" id="7470291">!</span><span class="ident" id="7470292">reflect</span><span class="op" id="7470299">.</span><span class="ident" id="7470300">DeepEqual</span><span class="op" id="7470309">(</span><span class="ident" id="7470310">tok1</span><span class="op" id="7470314">,</span>&nbsp;<span class="ident" id="7470316">tok2</span><span class="op" id="7470320">)</span>&nbsp;<span class="op" id="7470322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7470326">t</span><span class="op" id="7470327">.</span><span class="ident" id="7470328">Error</span><span class="op" id="7470333">(</span><span class="string" id="7470334">&#34;CopyToken(CharData)&nbsp;!=&nbsp;CharData&#34;</span><span class="op" id="7470367">)</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7470370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7470373">data</span><span class="op" id="7470377">[</span><span class="num" id="7470378">1</span><span class="op" id="7470379">]</span>&nbsp;<span class="op" id="7470381">=</span>&nbsp;<span class="string" id="7470383">&#39;o&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7470388">if</span>&nbsp;<span class="ident" id="7470391">reflect</span><span class="op" id="7470398">.</span><span class="ident" id="7470399">DeepEqual</span><span class="op" id="7470408">(</span><span class="ident" id="7470409">tok1</span><span class="op" id="7470413">,</span>&nbsp;<span class="ident" id="7470415">tok2</span><span class="op" id="7470419">)</span>&nbsp;<span class="op" id="7470421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7470425">t</span><span class="op" id="7470426">.</span><span class="ident" id="7470427">Error</span><span class="op" id="7470432">(</span><span class="string" id="7470433">&#34;CopyToken(CharData)&nbsp;uses&nbsp;same&nbsp;buffer.&#34;</span><span class="op" id="7470472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7470475">}</span><br>
<span class="lineno">555</span><span class="op" id="7470477">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7470480">func</span>&nbsp;<span class="ident" id="7470485">TestCopyTokenStartElement</span><span class="op" id="7470510">(</span><span class="ident" id="7470511">t</span>&nbsp;<span class="op" id="7470513">*</span><span class="ident" id="7470514">testing</span><span class="op" id="7470521">.</span><span class="ident" id="7470522">T</span><span class="op" id="7470523">)</span>&nbsp;<span class="op" id="7470525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7470528">elt</span>&nbsp;<span class="op" id="7470532">:=</span>&nbsp;<span class="ident" id="7470535">StartElement</span><span class="op" id="7470547">{</span><span class="ident" id="7470548">Name</span><span class="op" id="7470552">{</span><span class="string" id="7470553">&#34;&#34;</span><span class="op" id="7470555">,</span>&nbsp;<span class="string" id="7470557">&#34;hello&#34;</span><span class="op" id="7470564">}</span><span class="op" id="7470565">,</span>&nbsp;<span class="op" id="7470567">[</span><span class="op" id="7470568">]</span><span class="ident" id="7470569">Attr</span><span class="op" id="7470573">{</span><span class="op" id="7470574">{</span><span class="ident" id="7470575">Name</span><span class="op" id="7470579">{</span><span class="string" id="7470580">&#34;&#34;</span><span class="op" id="7470582">,</span>&nbsp;<span class="string" id="7470584">&#34;lang&#34;</span><span class="op" id="7470590">}</span><span class="op" id="7470591">,</span>&nbsp;<span class="string" id="7470593">&#34;en&#34;</span><span class="op" id="7470597">}</span><span class="op" id="7470598">}</span><span class="op" id="7470599">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7470602">var</span>&nbsp;<span class="ident" id="7470606">tok1</span>&nbsp;<span class="ident" id="7470611">Token</span>&nbsp;<span class="op" id="7470617">=</span>&nbsp;<span class="ident" id="7470619">elt</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7470624">tok2</span>&nbsp;<span class="op" id="7470629">:=</span>&nbsp;<span class="ident" id="7470632">CopyToken</span><span class="op" id="7470641">(</span><span class="ident" id="7470642">tok1</span><span class="op" id="7470646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7470649">if</span>&nbsp;<span class="ident" id="7470652">tok1</span><span class="op" id="7470656">.</span><span class="op" id="7470657">(</span><span class="ident" id="7470658">StartElement</span><span class="op" id="7470670">)</span><span class="op" id="7470671">.</span><span class="ident" id="7470672">Attr</span><span class="op" id="7470676">[</span><span class="num" id="7470677">0</span><span class="op" id="7470678">]</span><span class="op" id="7470679">.</span><span class="ident" id="7470680">Value</span>&nbsp;<span class="op" id="7470686">!=</span>&nbsp;<span class="string" id="7470689">&#34;en&#34;</span>&nbsp;<span class="op" id="7470694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7470698">t</span><span class="op" id="7470699">.</span><span class="ident" id="7470700">Error</span><span class="op" id="7470705">(</span><span class="string" id="7470706">&#34;CopyToken&nbsp;overwrote&nbsp;Attr[0]&#34;</span><span class="op" id="7470735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7470738">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7470741">if</span>&nbsp;<span class="op" id="7470744">!</span><span class="ident" id="7470745">reflect</span><span class="op" id="7470752">.</span><span class="ident" id="7470753">DeepEqual</span><span class="op" id="7470762">(</span><span class="ident" id="7470763">tok1</span><span class="op" id="7470767">,</span>&nbsp;<span class="ident" id="7470769">tok2</span><span class="op" id="7470773">)</span>&nbsp;<span class="op" id="7470775">{</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7470779">t</span><span class="op" id="7470780">.</span><span class="ident" id="7470781">Error</span><span class="op" id="7470786">(</span><span class="string" id="7470787">&#34;CopyToken(StartElement)&nbsp;!=&nbsp;StartElement&#34;</span><span class="op" id="7470828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7470831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7470834">tok1</span><span class="op" id="7470838">.</span><span class="op" id="7470839">(</span><span class="ident" id="7470840">StartElement</span><span class="op" id="7470852">)</span><span class="op" id="7470853">.</span><span class="ident" id="7470854">Attr</span><span class="op" id="7470858">[</span><span class="num" id="7470859">0</span><span class="op" id="7470860">]</span>&nbsp;<span class="op" id="7470862">=</span>&nbsp;<span class="ident" id="7470864">Attr</span><span class="op" id="7470868">{</span><span class="ident" id="7470869">Name</span><span class="op" id="7470873">{</span><span class="string" id="7470874">&#34;&#34;</span><span class="op" id="7470876">,</span>&nbsp;<span class="string" id="7470878">&#34;lang&#34;</span><span class="op" id="7470884">}</span><span class="op" id="7470885">,</span>&nbsp;<span class="string" id="7470887">&#34;de&#34;</span><span class="op" id="7470891">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7470894">if</span>&nbsp;<span class="ident" id="7470897">reflect</span><span class="op" id="7470904">.</span><span class="ident" id="7470905">DeepEqual</span><span class="op" id="7470914">(</span><span class="ident" id="7470915">tok1</span><span class="op" id="7470919">,</span>&nbsp;<span class="ident" id="7470921">tok2</span><span class="op" id="7470925">)</span>&nbsp;<span class="op" id="7470927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7470931">t</span><span class="op" id="7470932">.</span><span class="ident" id="7470933">Error</span><span class="op" id="7470938">(</span><span class="string" id="7470939">&#34;CopyToken(CharData)&nbsp;uses&nbsp;same&nbsp;buffer.&#34;</span><span class="op" id="7470978">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7470981">}</span><br>
<span class="lineno"></span><span class="op" id="7470983">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7470986">func</span>&nbsp;<span class="ident" id="7470991">TestSyntaxErrorLineNum</span><span class="op" id="7471013">(</span><span class="ident" id="7471014">t</span>&nbsp;<span class="op" id="7471016">*</span><span class="ident" id="7471017">testing</span><span class="op" id="7471024">.</span><span class="ident" id="7471025">T</span><span class="op" id="7471026">)</span>&nbsp;<span class="op" id="7471028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7471031">testInput</span>&nbsp;<span class="op" id="7471041">:=</span>&nbsp;<span class="string" id="7471044">&#34;&lt;P&gt;Foo&lt;P&gt;\n\n&lt;P&gt;Bar&lt;/&gt;\n&#34;</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7471072">d</span>&nbsp;<span class="op" id="7471074">:=</span>&nbsp;<span class="ident" id="7471077">NewDecoder</span><span class="op" id="7471087">(</span><span class="ident" id="7471088">strings</span><span class="op" id="7471095">.</span><span class="ident" id="7471096">NewReader</span><span class="op" id="7471105">(</span><span class="ident" id="7471106">testInput</span><span class="op" id="7471115">)</span><span class="op" id="7471116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7471119">var</span>&nbsp;<span class="ident" id="7471123">err</span>&nbsp;<span class="builtintype" id="7471127">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7471134">for</span>&nbsp;<span class="ident" id="7471138">_</span><span class="op" id="7471139">,</span>&nbsp;<span class="ident" id="7471141">err</span>&nbsp;<span class="op" id="7471145">=</span>&nbsp;<span class="ident" id="7471147">d</span><span class="op" id="7471148">.</span><span class="ident" id="7471149">Token</span><span class="op" id="7471154">(</span><span class="op" id="7471155">)</span><span class="op" id="7471156">;</span>&nbsp;<span class="ident" id="7471158">err</span>&nbsp;<span class="op" id="7471162">==</span>&nbsp;<span class="ident" id="7471165">nil</span><span class="op" id="7471168">;</span>&nbsp;<span class="ident" id="7471170">_</span><span class="op" id="7471171">,</span>&nbsp;<span class="ident" id="7471173">err</span>&nbsp;<span class="op" id="7471177">=</span>&nbsp;<span class="ident" id="7471179">d</span><span class="op" id="7471180">.</span><span class="ident" id="7471181">Token</span><span class="op" id="7471186">(</span><span class="op" id="7471187">)</span>&nbsp;<span class="op" id="7471189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7471192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7471195">synerr</span><span class="op" id="7471201">,</span>&nbsp;<span class="ident" id="7471203">ok</span>&nbsp;<span class="op" id="7471206">:=</span>&nbsp;<span class="ident" id="7471209">err</span><span class="op" id="7471212">.</span><span class="op" id="7471213">(</span><span class="op" id="7471214">*</span><span class="ident" id="7471215">SyntaxError</span><span class="op" id="7471226">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7471229">if</span>&nbsp;<span class="op" id="7471232">!</span><span class="ident" id="7471233">ok</span>&nbsp;<span class="op" id="7471236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7471240">t</span><span class="op" id="7471241">.</span><span class="ident" id="7471242">Error</span><span class="op" id="7471247">(</span><span class="string" id="7471248">&#34;Expected&nbsp;SyntaxError.&#34;</span><span class="op" id="7471271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7471274">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7471277">if</span>&nbsp;<span class="ident" id="7471280">synerr</span><span class="op" id="7471286">.</span><span class="ident" id="7471287">Line</span>&nbsp;<span class="op" id="7471292">!=</span>&nbsp;<span class="num" id="7471295">3</span>&nbsp;<span class="op" id="7471297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7471301">t</span><span class="op" id="7471302">.</span><span class="ident" id="7471303">Error</span><span class="op" id="7471308">(</span><span class="string" id="7471309">&#34;SyntaxError&nbsp;didn&#39;t&nbsp;have&nbsp;correct&nbsp;line&nbsp;number.&#34;</span><span class="op" id="7471355">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7471358">}</span><br>
<span class="lineno"></span><span class="op" id="7471360">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7471363">func</span>&nbsp;<span class="ident" id="7471368">TestTrailingRawToken</span><span class="op" id="7471388">(</span><span class="ident" id="7471389">t</span>&nbsp;<span class="op" id="7471391">*</span><span class="ident" id="7471392">testing</span><span class="op" id="7471399">.</span><span class="ident" id="7471400">T</span><span class="op" id="7471401">)</span>&nbsp;<span class="op" id="7471403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7471406">input</span>&nbsp;<span class="op" id="7471412">:=</span>&nbsp;<span class="string" id="7471415">`&lt;FOO&gt;&lt;/FOO&gt;&nbsp;&nbsp;`</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7471432">d</span>&nbsp;<span class="op" id="7471434">:=</span>&nbsp;<span class="ident" id="7471437">NewDecoder</span><span class="op" id="7471447">(</span><span class="ident" id="7471448">strings</span><span class="op" id="7471455">.</span><span class="ident" id="7471456">NewReader</span><span class="op" id="7471465">(</span><span class="ident" id="7471466">input</span><span class="op" id="7471471">)</span><span class="op" id="7471472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7471475">var</span>&nbsp;<span class="ident" id="7471479">err</span>&nbsp;<span class="builtintype" id="7471483">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7471490">for</span>&nbsp;<span class="ident" id="7471494">_</span><span class="op" id="7471495">,</span>&nbsp;<span class="ident" id="7471497">err</span>&nbsp;<span class="op" id="7471501">=</span>&nbsp;<span class="ident" id="7471503">d</span><span class="op" id="7471504">.</span><span class="ident" id="7471505">RawToken</span><span class="op" id="7471513">(</span><span class="op" id="7471514">)</span><span class="op" id="7471515">;</span>&nbsp;<span class="ident" id="7471517">err</span>&nbsp;<span class="op" id="7471521">==</span>&nbsp;<span class="ident" id="7471524">nil</span><span class="op" id="7471527">;</span>&nbsp;<span class="ident" id="7471529">_</span><span class="op" id="7471530">,</span>&nbsp;<span class="ident" id="7471532">err</span>&nbsp;<span class="op" id="7471536">=</span>&nbsp;<span class="ident" id="7471538">d</span><span class="op" id="7471539">.</span><span class="ident" id="7471540">RawToken</span><span class="op" id="7471548">(</span><span class="op" id="7471549">)</span>&nbsp;<span class="op" id="7471551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7471554">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7471557">if</span>&nbsp;<span class="ident" id="7471560">err</span>&nbsp;<span class="op" id="7471564">!=</span>&nbsp;<span class="ident" id="7471567">io</span><span class="op" id="7471569">.</span><span class="ident" id="7471570">EOF</span>&nbsp;<span class="op" id="7471574">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7471578">t</span><span class="op" id="7471579">.</span><span class="ident" id="7471580">Fatalf</span><span class="op" id="7471586">(</span><span class="string" id="7471587">&#34;d.RawToken()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;io.EOF&#34;</span><span class="op" id="7471625">,</span>&nbsp;<span class="ident" id="7471627">err</span><span class="op" id="7471630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7471633">}</span><br>
<span class="lineno"></span><span class="op" id="7471635">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7471638">func</span>&nbsp;<span class="ident" id="7471643">TestTrailingToken</span><span class="op" id="7471660">(</span><span class="ident" id="7471661">t</span>&nbsp;<span class="op" id="7471663">*</span><span class="ident" id="7471664">testing</span><span class="op" id="7471671">.</span><span class="ident" id="7471672">T</span><span class="op" id="7471673">)</span>&nbsp;<span class="op" id="7471675">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7471678">input</span>&nbsp;<span class="op" id="7471684">:=</span>&nbsp;<span class="string" id="7471687">`&lt;FOO&gt;&lt;/FOO&gt;&nbsp;&nbsp;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7471704">d</span>&nbsp;<span class="op" id="7471706">:=</span>&nbsp;<span class="ident" id="7471709">NewDecoder</span><span class="op" id="7471719">(</span><span class="ident" id="7471720">strings</span><span class="op" id="7471727">.</span><span class="ident" id="7471728">NewReader</span><span class="op" id="7471737">(</span><span class="ident" id="7471738">input</span><span class="op" id="7471743">)</span><span class="op" id="7471744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7471747">var</span>&nbsp;<span class="ident" id="7471751">err</span>&nbsp;<span class="builtintype" id="7471755">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7471762">for</span>&nbsp;<span class="ident" id="7471766">_</span><span class="op" id="7471767">,</span>&nbsp;<span class="ident" id="7471769">err</span>&nbsp;<span class="op" id="7471773">=</span>&nbsp;<span class="ident" id="7471775">d</span><span class="op" id="7471776">.</span><span class="ident" id="7471777">Token</span><span class="op" id="7471782">(</span><span class="op" id="7471783">)</span><span class="op" id="7471784">;</span>&nbsp;<span class="ident" id="7471786">err</span>&nbsp;<span class="op" id="7471790">==</span>&nbsp;<span class="ident" id="7471793">nil</span><span class="op" id="7471796">;</span>&nbsp;<span class="ident" id="7471798">_</span><span class="op" id="7471799">,</span>&nbsp;<span class="ident" id="7471801">err</span>&nbsp;<span class="op" id="7471805">=</span>&nbsp;<span class="ident" id="7471807">d</span><span class="op" id="7471808">.</span><span class="ident" id="7471809">Token</span><span class="op" id="7471814">(</span><span class="op" id="7471815">)</span>&nbsp;<span class="op" id="7471817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7471820">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7471823">if</span>&nbsp;<span class="ident" id="7471826">err</span>&nbsp;<span class="op" id="7471830">!=</span>&nbsp;<span class="ident" id="7471833">io</span><span class="op" id="7471835">.</span><span class="ident" id="7471836">EOF</span>&nbsp;<span class="op" id="7471840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7471844">t</span><span class="op" id="7471845">.</span><span class="ident" id="7471846">Fatalf</span><span class="op" id="7471852">(</span><span class="string" id="7471853">&#34;d.Token()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;io.EOF&#34;</span><span class="op" id="7471888">,</span>&nbsp;<span class="ident" id="7471890">err</span><span class="op" id="7471893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7471896">}</span><br>
<span class="lineno"></span><span class="op" id="7471898">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">610</span><span class="keyword" id="7471901">func</span>&nbsp;<span class="ident" id="7471906">TestEntityInsideCDATA</span><span class="op" id="7471927">(</span><span class="ident" id="7471928">t</span>&nbsp;<span class="op" id="7471930">*</span><span class="ident" id="7471931">testing</span><span class="op" id="7471938">.</span><span class="ident" id="7471939">T</span><span class="op" id="7471940">)</span>&nbsp;<span class="op" id="7471942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7471945">input</span>&nbsp;<span class="op" id="7471951">:=</span>&nbsp;<span class="string" id="7471954">`&lt;test&gt;&lt;![CDATA[&nbsp;&amp;val=foo&nbsp;]]&gt;&lt;/test&gt;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7471993">d</span>&nbsp;<span class="op" id="7471995">:=</span>&nbsp;<span class="ident" id="7471998">NewDecoder</span><span class="op" id="7472008">(</span><span class="ident" id="7472009">strings</span><span class="op" id="7472016">.</span><span class="ident" id="7472017">NewReader</span><span class="op" id="7472026">(</span><span class="ident" id="7472027">input</span><span class="op" id="7472032">)</span><span class="op" id="7472033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7472036">var</span>&nbsp;<span class="ident" id="7472040">err</span>&nbsp;<span class="builtintype" id="7472044">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7472051">for</span>&nbsp;<span class="ident" id="7472055">_</span><span class="op" id="7472056">,</span>&nbsp;<span class="ident" id="7472058">err</span>&nbsp;<span class="op" id="7472062">=</span>&nbsp;<span class="ident" id="7472064">d</span><span class="op" id="7472065">.</span><span class="ident" id="7472066">Token</span><span class="op" id="7472071">(</span><span class="op" id="7472072">)</span><span class="op" id="7472073">;</span>&nbsp;<span class="ident" id="7472075">err</span>&nbsp;<span class="op" id="7472079">==</span>&nbsp;<span class="ident" id="7472082">nil</span><span class="op" id="7472085">;</span>&nbsp;<span class="ident" id="7472087">_</span><span class="op" id="7472088">,</span>&nbsp;<span class="ident" id="7472090">err</span>&nbsp;<span class="op" id="7472094">=</span>&nbsp;<span class="ident" id="7472096">d</span><span class="op" id="7472097">.</span><span class="ident" id="7472098">Token</span><span class="op" id="7472103">(</span><span class="op" id="7472104">)</span>&nbsp;<span class="op" id="7472106">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7472109">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7472112">if</span>&nbsp;<span class="ident" id="7472115">err</span>&nbsp;<span class="op" id="7472119">!=</span>&nbsp;<span class="ident" id="7472122">io</span><span class="op" id="7472124">.</span><span class="ident" id="7472125">EOF</span>&nbsp;<span class="op" id="7472129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7472133">t</span><span class="op" id="7472134">.</span><span class="ident" id="7472135">Fatalf</span><span class="op" id="7472141">(</span><span class="string" id="7472142">&#34;d.Token()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;io.EOF&#34;</span><span class="op" id="7472177">,</span>&nbsp;<span class="ident" id="7472179">err</span><span class="op" id="7472182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7472185">}</span><br>
<span class="lineno"></span><span class="op" id="7472187">}</span><br>
<span class="lineno">620</span><br>
<span class="lineno"></span><span class="keyword" id="7472190">var</span>&nbsp;<span class="ident" id="7472194">characterTests</span>&nbsp;<span class="op" id="7472209">=</span>&nbsp;<span class="op" id="7472211">[</span><span class="op" id="7472212">]</span><span class="keyword" id="7472213">struct</span>&nbsp;<span class="op" id="7472220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7472223">in</span>&nbsp;&nbsp;<span class="builtintype" id="7472227">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7472235">err</span>&nbsp;<span class="builtintype" id="7472239">string</span><br>
<span class="lineno"></span><span class="op" id="7472246">}</span><span class="op" id="7472247">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7472250">{</span><span class="string" id="7472251">&#34;\x12&lt;doc/&gt;&#34;</span><span class="op" id="7472263">,</span>&nbsp;<span class="string" id="7472265">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+0012&#34;</span><span class="op" id="7472296">}</span><span class="op" id="7472297">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7472300">{</span><span class="string" id="7472301">&#34;&lt;?xml&nbsp;version=\&#34;1.0\&#34;?&gt;\x0b&lt;doc/&gt;&#34;</span><span class="op" id="7472336">,</span>&nbsp;<span class="string" id="7472338">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+000B&#34;</span><span class="op" id="7472369">}</span><span class="op" id="7472370">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7472373">{</span><span class="string" id="7472374">&#34;\xef\xbf\xbe&lt;doc/&gt;&#34;</span><span class="op" id="7472394">,</span>&nbsp;<span class="string" id="7472396">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+FFFE&#34;</span><span class="op" id="7472427">}</span><span class="op" id="7472428">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7472431">{</span><span class="string" id="7472432">&#34;&lt;?xml&nbsp;version=\&#34;1.0\&#34;?&gt;&lt;doc&gt;\r\n&lt;hiya/&gt;\x07&lt;toots/&gt;&lt;/doc&gt;&#34;</span><span class="op" id="7472491">,</span>&nbsp;<span class="string" id="7472493">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+0007&#34;</span><span class="op" id="7472524">}</span><span class="op" id="7472525">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7472528">{</span><span class="string" id="7472529">&#34;&lt;?xml&nbsp;version=\&#34;1.0\&#34;?&gt;&lt;doc&nbsp;\x12=&#39;value&#39;&gt;what&#39;s&nbsp;up&lt;/doc&gt;&#34;</span><span class="op" id="7472587">,</span>&nbsp;<span class="string" id="7472589">&#34;expected&nbsp;attribute&nbsp;name&nbsp;in&nbsp;element&#34;</span><span class="op" id="7472625">}</span><span class="op" id="7472626">,</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7472629">{</span><span class="string" id="7472630">&#34;&lt;doc&gt;&amp;abc\x01;&lt;/doc&gt;&#34;</span><span class="op" id="7472652">,</span>&nbsp;<span class="string" id="7472654">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;abc&nbsp;(no&nbsp;semicolon)&#34;</span><span class="op" id="7472700">}</span><span class="op" id="7472701">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7472704">{</span><span class="string" id="7472705">&#34;&lt;doc&gt;&amp;\x01;&lt;/doc&gt;&#34;</span><span class="op" id="7472724">,</span>&nbsp;<span class="string" id="7472726">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;&nbsp;(no&nbsp;semicolon)&#34;</span><span class="op" id="7472769">}</span><span class="op" id="7472770">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7472773">{</span><span class="string" id="7472774">&#34;&lt;doc&gt;&amp;\xef\xbf\xbe;&lt;/doc&gt;&#34;</span><span class="op" id="7472801">,</span>&nbsp;<span class="string" id="7472803">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;\uFFFE;&#34;</span><span class="op" id="7472838">}</span><span class="op" id="7472839">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7472842">{</span><span class="string" id="7472843">&#34;&lt;doc&gt;&amp;hello;&lt;/doc&gt;&#34;</span><span class="op" id="7472863">,</span>&nbsp;<span class="string" id="7472865">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;hello;&#34;</span><span class="op" id="7472899">}</span><span class="op" id="7472900">,</span><br>
<span class="lineno"></span><span class="op" id="7472902">}</span><br>
<span class="lineno">635</span><br>
<span class="lineno"></span><span class="keyword" id="7472905">func</span>&nbsp;<span class="ident" id="7472910">TestDisallowedCharacters</span><span class="op" id="7472934">(</span><span class="ident" id="7472935">t</span>&nbsp;<span class="op" id="7472937">*</span><span class="ident" id="7472938">testing</span><span class="op" id="7472945">.</span><span class="ident" id="7472946">T</span><span class="op" id="7472947">)</span>&nbsp;<span class="op" id="7472949">{</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7472953">for</span>&nbsp;<span class="ident" id="7472957">i</span><span class="op" id="7472958">,</span>&nbsp;<span class="ident" id="7472960">tt</span>&nbsp;<span class="op" id="7472963">:=</span>&nbsp;<span class="keyword" id="7472966">range</span>&nbsp;<span class="ident" id="7472972">characterTests</span>&nbsp;<span class="op" id="7472987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7472991">d</span>&nbsp;<span class="op" id="7472993">:=</span>&nbsp;<span class="ident" id="7472996">NewDecoder</span><span class="op" id="7473006">(</span><span class="ident" id="7473007">strings</span><span class="op" id="7473014">.</span><span class="ident" id="7473015">NewReader</span><span class="op" id="7473024">(</span><span class="ident" id="7473025">tt</span><span class="op" id="7473027">.</span><span class="ident" id="7473028">in</span><span class="op" id="7473030">)</span><span class="op" id="7473031">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7473035">var</span>&nbsp;<span class="ident" id="7473039">err</span>&nbsp;<span class="builtintype" id="7473043">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7473052">for</span>&nbsp;<span class="ident" id="7473056">err</span>&nbsp;<span class="op" id="7473060">==</span>&nbsp;<span class="ident" id="7473063">nil</span>&nbsp;<span class="op" id="7473067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7473072">_</span><span class="op" id="7473073">,</span>&nbsp;<span class="ident" id="7473075">err</span>&nbsp;<span class="op" id="7473079">=</span>&nbsp;<span class="ident" id="7473081">d</span><span class="op" id="7473082">.</span><span class="ident" id="7473083">Token</span><span class="op" id="7473088">(</span><span class="op" id="7473089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7473093">}</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7473097">synerr</span><span class="op" id="7473103">,</span>&nbsp;<span class="ident" id="7473105">ok</span>&nbsp;<span class="op" id="7473108">:=</span>&nbsp;<span class="ident" id="7473111">err</span><span class="op" id="7473114">.</span><span class="op" id="7473115">(</span><span class="op" id="7473116">*</span><span class="ident" id="7473117">SyntaxError</span><span class="op" id="7473128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7473132">if</span>&nbsp;<span class="op" id="7473135">!</span><span class="ident" id="7473136">ok</span>&nbsp;<span class="op" id="7473139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7473144">t</span><span class="op" id="7473145">.</span><span class="ident" id="7473146">Fatalf</span><span class="op" id="7473152">(</span><span class="string" id="7473153">&#34;input&nbsp;%d&nbsp;d.Token()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;*SyntaxError&#34;</span><span class="op" id="7473203">,</span>&nbsp;<span class="ident" id="7473205">i</span><span class="op" id="7473206">,</span>&nbsp;<span class="ident" id="7473208">err</span><span class="op" id="7473211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7473215">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7473219">if</span>&nbsp;<span class="ident" id="7473222">synerr</span><span class="op" id="7473228">.</span><span class="ident" id="7473229">Msg</span>&nbsp;<span class="op" id="7473233">!=</span>&nbsp;<span class="ident" id="7473236">tt</span><span class="op" id="7473238">.</span><span class="ident" id="7473239">err</span>&nbsp;<span class="op" id="7473243">{</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7473248">t</span><span class="op" id="7473249">.</span><span class="ident" id="7473250">Fatalf</span><span class="op" id="7473256">(</span><span class="string" id="7473257">&#34;input&nbsp;%d&nbsp;synerr.Msg&nbsp;wrong:&nbsp;want&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7473301">,</span>&nbsp;<span class="ident" id="7473303">i</span><span class="op" id="7473304">,</span>&nbsp;<span class="ident" id="7473306">tt</span><span class="op" id="7473308">.</span><span class="ident" id="7473309">err</span><span class="op" id="7473312">,</span>&nbsp;<span class="ident" id="7473314">synerr</span><span class="op" id="7473320">.</span><span class="ident" id="7473321">Msg</span><span class="op" id="7473324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7473328">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7473331">}</span><br>
<span class="lineno"></span><span class="op" id="7473333">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">655</span><span class="keyword" id="7473336">type</span>&nbsp;<span class="ident" id="7473341">procInstEncodingTest</span>&nbsp;<span class="keyword" id="7473362">struct</span>&nbsp;<span class="op" id="7473369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7473372">expect</span><span class="op" id="7473378">,</span>&nbsp;<span class="ident" id="7473380">got</span>&nbsp;<span class="builtintype" id="7473384">string</span><br>
<span class="lineno"></span><span class="op" id="7473391">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7473394">var</span>&nbsp;<span class="ident" id="7473398">procInstTests</span>&nbsp;<span class="op" id="7473412">=</span>&nbsp;<span class="op" id="7473414">[</span><span class="op" id="7473415">]</span><span class="keyword" id="7473416">struct</span>&nbsp;<span class="op" id="7473423">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7473426">input</span><span class="op" id="7473431">,</span>&nbsp;<span class="ident" id="7473433">expect</span>&nbsp;<span class="builtintype" id="7473440">string</span><br>
<span class="lineno"></span><span class="op" id="7473447">}</span><span class="op" id="7473448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7473451">{</span><span class="string" id="7473452">`version=&#34;1.0&#34;&nbsp;encoding=&#34;utf-8&#34;`</span><span class="op" id="7473484">,</span>&nbsp;<span class="string" id="7473486">&#34;utf-8&#34;</span><span class="op" id="7473493">}</span><span class="op" id="7473494">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7473497">{</span><span class="string" id="7473498">`version=&#34;1.0&#34;&nbsp;encoding=&#39;utf-8&#39;`</span><span class="op" id="7473530">,</span>&nbsp;<span class="string" id="7473532">&#34;utf-8&#34;</span><span class="op" id="7473539">}</span><span class="op" id="7473540">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7473543">{</span><span class="string" id="7473544">`version=&#34;1.0&#34;&nbsp;encoding=&#39;utf-8&#39;&nbsp;`</span><span class="op" id="7473577">,</span>&nbsp;<span class="string" id="7473579">&#34;utf-8&#34;</span><span class="op" id="7473586">}</span><span class="op" id="7473587">,</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7473590">{</span><span class="string" id="7473591">`version=&#34;1.0&#34;&nbsp;encoding=utf-8`</span><span class="op" id="7473621">,</span>&nbsp;<span class="string" id="7473623">&#34;&#34;</span><span class="op" id="7473625">}</span><span class="op" id="7473626">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7473629">{</span><span class="string" id="7473630">`encoding=&#34;FOO&#34;&nbsp;`</span><span class="op" id="7473647">,</span>&nbsp;<span class="string" id="7473649">&#34;FOO&#34;</span><span class="op" id="7473654">}</span><span class="op" id="7473655">,</span><br>
<span class="lineno"></span><span class="op" id="7473657">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7473660">func</span>&nbsp;<span class="ident" id="7473665">TestProcInstEncoding</span><span class="op" id="7473685">(</span><span class="ident" id="7473686">t</span>&nbsp;<span class="op" id="7473688">*</span><span class="ident" id="7473689">testing</span><span class="op" id="7473696">.</span><span class="ident" id="7473697">T</span><span class="op" id="7473698">)</span>&nbsp;<span class="op" id="7473700">{</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7473703">for</span>&nbsp;<span class="ident" id="7473707">_</span><span class="op" id="7473708">,</span>&nbsp;<span class="ident" id="7473710">test</span>&nbsp;<span class="op" id="7473715">:=</span>&nbsp;<span class="keyword" id="7473718">range</span>&nbsp;<span class="ident" id="7473724">procInstTests</span>&nbsp;<span class="op" id="7473738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7473742">got</span>&nbsp;<span class="op" id="7473746">:=</span>&nbsp;<span class="ident" id="7473749">procInstEncoding</span><span class="op" id="7473765">(</span><span class="ident" id="7473766">test</span><span class="op" id="7473770">.</span><span class="ident" id="7473771">input</span><span class="op" id="7473776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7473780">if</span>&nbsp;<span class="ident" id="7473783">got</span>&nbsp;<span class="op" id="7473787">!=</span>&nbsp;<span class="ident" id="7473790">test</span><span class="op" id="7473794">.</span><span class="ident" id="7473795">expect</span>&nbsp;<span class="op" id="7473802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7473807">t</span><span class="op" id="7473808">.</span><span class="ident" id="7473809">Errorf</span><span class="op" id="7473815">(</span><span class="string" id="7473816">&#34;procInstEncoding(%q)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7473852">,</span>&nbsp;<span class="ident" id="7473854">test</span><span class="op" id="7473858">.</span><span class="ident" id="7473859">input</span><span class="op" id="7473864">,</span>&nbsp;<span class="ident" id="7473866">got</span><span class="op" id="7473869">,</span>&nbsp;<span class="ident" id="7473871">test</span><span class="op" id="7473875">.</span><span class="ident" id="7473876">expect</span><span class="op" id="7473882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7473886">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7473889">}</span><br>
<span class="lineno"></span><span class="op" id="7473891">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7473894">//&nbsp;Ensure&nbsp;that&nbsp;directives&nbsp;with&nbsp;comments&nbsp;include&nbsp;the&nbsp;complete</span><br>
<span class="lineno"></span><span class="comment" id="7473955">//&nbsp;text&nbsp;of&nbsp;any&nbsp;nested&nbsp;directives.</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="7473990">var</span>&nbsp;<span class="ident" id="7473994">directivesWithCommentsInput</span>&nbsp;<span class="op" id="7474022">=</span>&nbsp;<span class="string" id="7474024">`<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!--&nbsp;a&nbsp;comment&nbsp;--&gt;&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;&lt;!--&nbsp;a&nbsp;comment--&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;&lt;!-&gt;&nbsp;&lt;!&gt;&nbsp;&lt;!----&gt;&nbsp;&lt;!--&gt;--&gt;&nbsp;&lt;!---&gt;--&gt;&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;&lt;!--&nbsp;a&nbsp;comment--&gt;]&gt;<br>
<span class="lineno">685</span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7474260">var</span>&nbsp;<span class="ident" id="7474264">directivesWithCommentsTokens</span>&nbsp;<span class="op" id="7474293">=</span>&nbsp;<span class="op" id="7474295">[</span><span class="op" id="7474296">]</span><span class="ident" id="7474297">Token</span><span class="op" id="7474302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7474305">CharData</span><span class="op" id="7474313">(</span><span class="string" id="7474314">&#34;\n&#34;</span><span class="op" id="7474318">)</span><span class="op" id="7474319">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7474322">Directive</span><span class="op" id="7474331">(</span><span class="string" id="7474332">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]`</span><span class="op" id="7474403">)</span><span class="op" id="7474404">,</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7474407">CharData</span><span class="op" id="7474415">(</span><span class="string" id="7474416">&#34;\n&#34;</span><span class="op" id="7474420">)</span><span class="op" id="7474421">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7474424">Directive</span><span class="op" id="7474433">(</span><span class="string" id="7474434">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;]`</span><span class="op" id="7474467">)</span><span class="op" id="7474468">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7474471">CharData</span><span class="op" id="7474479">(</span><span class="string" id="7474480">&#34;\n&#34;</span><span class="op" id="7474484">)</span><span class="op" id="7474485">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7474488">Directive</span><span class="op" id="7474497">(</span><span class="string" id="7474498">`DOCTYPE&nbsp;&lt;!-&gt;&nbsp;&lt;!&gt;&nbsp;&nbsp;&nbsp;&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;]`</span><span class="op" id="7474543">)</span><span class="op" id="7474544">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7474547">CharData</span><span class="op" id="7474555">(</span><span class="string" id="7474556">&#34;\n&#34;</span><span class="op" id="7474560">)</span><span class="op" id="7474561">,</span><br>
<span class="lineno">695</span><span class="op" id="7474563">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7474566">func</span>&nbsp;<span class="ident" id="7474571">TestDirectivesWithComments</span><span class="op" id="7474597">(</span><span class="ident" id="7474598">t</span>&nbsp;<span class="op" id="7474600">*</span><span class="ident" id="7474601">testing</span><span class="op" id="7474608">.</span><span class="ident" id="7474609">T</span><span class="op" id="7474610">)</span>&nbsp;<span class="op" id="7474612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7474615">d</span>&nbsp;<span class="op" id="7474617">:=</span>&nbsp;<span class="ident" id="7474620">NewDecoder</span><span class="op" id="7474630">(</span><span class="ident" id="7474631">strings</span><span class="op" id="7474638">.</span><span class="ident" id="7474639">NewReader</span><span class="op" id="7474648">(</span><span class="ident" id="7474649">directivesWithCommentsInput</span><span class="op" id="7474676">)</span><span class="op" id="7474677">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7474681">for</span>&nbsp;<span class="ident" id="7474685">i</span><span class="op" id="7474686">,</span>&nbsp;<span class="ident" id="7474688">want</span>&nbsp;<span class="op" id="7474693">:=</span>&nbsp;<span class="keyword" id="7474696">range</span>&nbsp;<span class="ident" id="7474702">directivesWithCommentsTokens</span>&nbsp;<span class="op" id="7474731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7474735">have</span><span class="op" id="7474739">,</span>&nbsp;<span class="ident" id="7474741">err</span>&nbsp;<span class="op" id="7474745">:=</span>&nbsp;<span class="ident" id="7474748">d</span><span class="op" id="7474749">.</span><span class="ident" id="7474750">Token</span><span class="op" id="7474755">(</span><span class="op" id="7474756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7474760">if</span>&nbsp;<span class="ident" id="7474763">err</span>&nbsp;<span class="op" id="7474767">!=</span>&nbsp;<span class="ident" id="7474770">nil</span>&nbsp;<span class="op" id="7474774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7474779">t</span><span class="op" id="7474780">.</span><span class="ident" id="7474781">Fatalf</span><span class="op" id="7474787">(</span><span class="string" id="7474788">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="7474820">,</span>&nbsp;<span class="ident" id="7474822">i</span><span class="op" id="7474823">,</span>&nbsp;<span class="ident" id="7474825">err</span><span class="op" id="7474828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7474832">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7474836">if</span>&nbsp;<span class="op" id="7474839">!</span><span class="ident" id="7474840">reflect</span><span class="op" id="7474847">.</span><span class="ident" id="7474848">DeepEqual</span><span class="op" id="7474857">(</span><span class="ident" id="7474858">have</span><span class="op" id="7474862">,</span>&nbsp;<span class="ident" id="7474864">want</span><span class="op" id="7474868">)</span>&nbsp;<span class="op" id="7474870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7474875">t</span><span class="op" id="7474876">.</span><span class="ident" id="7474877">Errorf</span><span class="op" id="7474883">(</span><span class="string" id="7474884">&#34;token&nbsp;%d&nbsp;=&nbsp;%#v&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="7474909">,</span>&nbsp;<span class="ident" id="7474911">i</span><span class="op" id="7474912">,</span>&nbsp;<span class="ident" id="7474914">have</span><span class="op" id="7474918">,</span>&nbsp;<span class="ident" id="7474920">want</span><span class="op" id="7474924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7474928">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7474931">}</span><br>
<span class="lineno"></span><span class="op" id="7474933">}</span><br>
<span class="lineno">710</span><br>
<span class="lineno"></span><span class="comment" id="7474936">//&nbsp;Writer&nbsp;whose&nbsp;Write&nbsp;method&nbsp;always&nbsp;returns&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="7474990">type</span>&nbsp;<span class="ident" id="7474995">errWriter</span>&nbsp;<span class="keyword" id="7475005">struct</span><span class="op" id="7475011">{</span><span class="op" id="7475012">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7475015">func</span>&nbsp;<span class="op" id="7475020">(</span><span class="ident" id="7475021">errWriter</span><span class="op" id="7475030">)</span>&nbsp;<span class="ident" id="7475032">Write</span><span class="op" id="7475037">(</span><span class="ident" id="7475038">p</span>&nbsp;<span class="op" id="7475040">[</span><span class="op" id="7475041">]</span><span class="builtintype" id="7475042">byte</span><span class="op" id="7475046">)</span>&nbsp;<span class="op" id="7475048">(</span><span class="ident" id="7475049">n</span>&nbsp;<span class="builtintype" id="7475051">int</span><span class="op" id="7475054">,</span>&nbsp;<span class="ident" id="7475056">err</span>&nbsp;<span class="builtintype" id="7475060">error</span><span class="op" id="7475065">)</span>&nbsp;<span class="op" id="7475067">{</span>&nbsp;<span class="keyword" id="7475069">return</span>&nbsp;<span class="num" id="7475076">0</span><span class="op" id="7475077">,</span>&nbsp;<span class="ident" id="7475079">fmt</span><span class="op" id="7475082">.</span><span class="ident" id="7475083">Errorf</span><span class="op" id="7475089">(</span><span class="string" id="7475090">&#34;unwritable&#34;</span><span class="op" id="7475102">)</span>&nbsp;<span class="op" id="7475104">}</span><br>
<span class="lineno">715</span><br>
<span class="lineno"></span><span class="keyword" id="7475107">func</span>&nbsp;<span class="ident" id="7475112">TestEscapeTextIOErrors</span><span class="op" id="7475134">(</span><span class="ident" id="7475135">t</span>&nbsp;<span class="op" id="7475137">*</span><span class="ident" id="7475138">testing</span><span class="op" id="7475145">.</span><span class="ident" id="7475146">T</span><span class="op" id="7475147">)</span>&nbsp;<span class="op" id="7475149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7475152">expectErr</span>&nbsp;<span class="op" id="7475162">:=</span>&nbsp;<span class="string" id="7475165">&#34;unwritable&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7475179">err</span>&nbsp;<span class="op" id="7475183">:=</span>&nbsp;<span class="ident" id="7475186">EscapeText</span><span class="op" id="7475196">(</span><span class="ident" id="7475197">errWriter</span><span class="op" id="7475206">{</span><span class="op" id="7475207">}</span><span class="op" id="7475208">,</span>&nbsp;<span class="op" id="7475210">[</span><span class="op" id="7475211">]</span><span class="builtintype" id="7475212">byte</span><span class="op" id="7475216">{</span><span class="string" id="7475217">&#39;A&#39;</span><span class="op" id="7475220">}</span><span class="op" id="7475221">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7475225">if</span>&nbsp;<span class="ident" id="7475228">err</span>&nbsp;<span class="op" id="7475232">==</span>&nbsp;<span class="ident" id="7475235">nil</span>&nbsp;<span class="op" id="7475239">||</span>&nbsp;<span class="ident" id="7475242">err</span><span class="op" id="7475245">.</span><span class="ident" id="7475246">Error</span><span class="op" id="7475251">(</span><span class="op" id="7475252">)</span>&nbsp;<span class="op" id="7475254">!=</span>&nbsp;<span class="ident" id="7475257">expectErr</span>&nbsp;<span class="op" id="7475267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7475271">t</span><span class="op" id="7475272">.</span><span class="ident" id="7475273">Errorf</span><span class="op" id="7475279">(</span><span class="string" id="7475280">&#34;have&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7475298">,</span>&nbsp;<span class="ident" id="7475300">err</span><span class="op" id="7475303">,</span>&nbsp;<span class="ident" id="7475305">expectErr</span><span class="op" id="7475314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7475317">}</span><br>
<span class="lineno"></span><span class="op" id="7475319">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">725</span><span class="keyword" id="7475322">func</span>&nbsp;<span class="ident" id="7475327">TestEscapeTextInvalidChar</span><span class="op" id="7475352">(</span><span class="ident" id="7475353">t</span>&nbsp;<span class="op" id="7475355">*</span><span class="ident" id="7475356">testing</span><span class="op" id="7475363">.</span><span class="ident" id="7475364">T</span><span class="op" id="7475365">)</span>&nbsp;<span class="op" id="7475367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7475370">input</span>&nbsp;<span class="op" id="7475376">:=</span>&nbsp;<span class="op" id="7475379">[</span><span class="op" id="7475380">]</span><span class="builtintype" id="7475381">byte</span><span class="op" id="7475385">(</span><span class="string" id="7475386">&#34;A&nbsp;\x00&nbsp;terminated&nbsp;string.&#34;</span><span class="op" id="7475413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7475416">expected</span>&nbsp;<span class="op" id="7475425">:=</span>&nbsp;<span class="string" id="7475428">&#34;A&nbsp;\uFFFD&nbsp;terminated&nbsp;string.&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7475460">buff</span>&nbsp;<span class="op" id="7475465">:=</span>&nbsp;<span class="builtinfunc" id="7475468">new</span><span class="op" id="7475471">(</span><span class="ident" id="7475472">bytes</span><span class="op" id="7475477">.</span><span class="ident" id="7475478">Buffer</span><span class="op" id="7475484">)</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7475487">if</span>&nbsp;<span class="ident" id="7475490">err</span>&nbsp;<span class="op" id="7475494">:=</span>&nbsp;<span class="ident" id="7475497">EscapeText</span><span class="op" id="7475507">(</span><span class="ident" id="7475508">buff</span><span class="op" id="7475512">,</span>&nbsp;<span class="ident" id="7475514">input</span><span class="op" id="7475519">)</span><span class="op" id="7475520">;</span>&nbsp;<span class="ident" id="7475522">err</span>&nbsp;<span class="op" id="7475526">!=</span>&nbsp;<span class="ident" id="7475529">nil</span>&nbsp;<span class="op" id="7475533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7475537">t</span><span class="op" id="7475538">.</span><span class="ident" id="7475539">Fatalf</span><span class="op" id="7475545">(</span><span class="string" id="7475546">&#34;have&nbsp;%v,&nbsp;want&nbsp;nil&#34;</span><span class="op" id="7475565">,</span>&nbsp;<span class="ident" id="7475567">err</span><span class="op" id="7475570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7475573">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7475576">text</span>&nbsp;<span class="op" id="7475581">:=</span>&nbsp;<span class="ident" id="7475584">buff</span><span class="op" id="7475588">.</span><span class="ident" id="7475589">String</span><span class="op" id="7475595">(</span><span class="op" id="7475596">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7475600">if</span>&nbsp;<span class="ident" id="7475603">text</span>&nbsp;<span class="op" id="7475608">!=</span>&nbsp;<span class="ident" id="7475611">expected</span>&nbsp;<span class="op" id="7475620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7475624">t</span><span class="op" id="7475625">.</span><span class="ident" id="7475626">Errorf</span><span class="op" id="7475632">(</span><span class="string" id="7475633">&#34;have&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7475651">,</span>&nbsp;<span class="ident" id="7475653">text</span><span class="op" id="7475657">,</span>&nbsp;<span class="ident" id="7475659">expected</span><span class="op" id="7475667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7475670">}</span><br>
<span class="lineno"></span><span class="op" id="7475672">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">740</span><span class="keyword" id="7475675">func</span>&nbsp;<span class="ident" id="7475680">TestIssue5880</span><span class="op" id="7475693">(</span><span class="ident" id="7475694">t</span>&nbsp;<span class="op" id="7475696">*</span><span class="ident" id="7475697">testing</span><span class="op" id="7475704">.</span><span class="ident" id="7475705">T</span><span class="op" id="7475706">)</span>&nbsp;<span class="op" id="7475708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7475711">type</span>&nbsp;<span class="ident" id="7475716">T</span>&nbsp;<span class="op" id="7475718">[</span><span class="op" id="7475719">]</span><span class="builtintype" id="7475720">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7475726">data</span><span class="op" id="7475730">,</span>&nbsp;<span class="ident" id="7475732">err</span>&nbsp;<span class="op" id="7475736">:=</span>&nbsp;<span class="ident" id="7475739">Marshal</span><span class="op" id="7475746">(</span><span class="ident" id="7475747">T</span><span class="op" id="7475748">{</span><span class="num" id="7475749">192</span><span class="op" id="7475752">,</span>&nbsp;<span class="num" id="7475754">168</span><span class="op" id="7475757">,</span>&nbsp;<span class="num" id="7475759">0</span><span class="op" id="7475760">,</span>&nbsp;<span class="num" id="7475762">1</span><span class="op" id="7475763">}</span><span class="op" id="7475764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7475767">if</span>&nbsp;<span class="ident" id="7475770">err</span>&nbsp;<span class="op" id="7475774">!=</span>&nbsp;<span class="ident" id="7475777">nil</span>&nbsp;<span class="op" id="7475781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7475785">t</span><span class="op" id="7475786">.</span><span class="ident" id="7475787">Errorf</span><span class="op" id="7475793">(</span><span class="string" id="7475794">&#34;Marshal&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="7475813">,</span>&nbsp;<span class="ident" id="7475815">err</span><span class="op" id="7475818">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7475821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7475824">if</span>&nbsp;<span class="op" id="7475827">!</span><span class="ident" id="7475828">utf8</span><span class="op" id="7475832">.</span><span class="ident" id="7475833">Valid</span><span class="op" id="7475838">(</span><span class="ident" id="7475839">data</span><span class="op" id="7475843">)</span>&nbsp;<span class="op" id="7475845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7475849">t</span><span class="op" id="7475850">.</span><span class="ident" id="7475851">Errorf</span><span class="op" id="7475857">(</span><span class="string" id="7475858">&#34;Marshal&nbsp;generated&nbsp;invalid&nbsp;UTF-8:&nbsp;%x&#34;</span><span class="op" id="7475895">,</span>&nbsp;<span class="ident" id="7475897">data</span><span class="op" id="7475901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7475904">}</span><br>
<span class="lineno"></span><span class="op" id="7475906">}</span>
</div>
</body>
</html>
