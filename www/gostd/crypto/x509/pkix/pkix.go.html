<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509/pkix</h2>
<ul>
<li><a href="/gostd/crypto/x509/pkix/pkix.go.html">pkix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3907131">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3907186">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3907240">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3907291">//&nbsp;Package&nbsp;pkix&nbsp;contains&nbsp;shared,&nbsp;low&nbsp;level&nbsp;structures&nbsp;used&nbsp;for&nbsp;ASN.1&nbsp;parsing</span><br>
<span class="lineno"></span><span class="comment" id="3907368">//&nbsp;and&nbsp;serialization&nbsp;of&nbsp;X.509&nbsp;certificates,&nbsp;CRL&nbsp;and&nbsp;OCSP.</span><br>
<span class="lineno"></span><span class="keyword" id="3907426">package</span>&nbsp;<span class="ident" id="3907434">pkix</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3907440">import</span>&nbsp;<span class="op" id="3907447">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3907450">&#34;encoding/asn1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3907467">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3907479">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="3907486">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="3907489">//&nbsp;AlgorithmIdentifier&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno"></span><span class="comment" id="3907569">//&nbsp;5280,&nbsp;section&nbsp;4.1.1.2.</span><br>
<span class="lineno"></span><span class="keyword" id="3907595">type</span>&nbsp;<span class="ident" id="3907600">AlgorithmIdentifier</span>&nbsp;<span class="keyword" id="3907620">struct</span>&nbsp;<span class="op" id="3907627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3907630">Algorithm</span>&nbsp;&nbsp;<span class="ident" id="3907641">asn1</span><span class="op" id="3907645">.</span><span class="ident" id="3907646">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3907664">Parameters</span>&nbsp;<span class="ident" id="3907675">asn1</span><span class="op" id="3907679">.</span><span class="ident" id="3907680">RawValue</span>&nbsp;<span class="string" id="3907689">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">20</span><span class="op" id="3907707">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3907710">type</span>&nbsp;<span class="ident" id="3907715">RDNSequence</span>&nbsp;<span class="op" id="3907727">[</span><span class="op" id="3907728">]</span><span class="ident" id="3907729">RelativeDistinguishedNameSET</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3907759">type</span>&nbsp;<span class="ident" id="3907764">RelativeDistinguishedNameSET</span>&nbsp;<span class="op" id="3907793">[</span><span class="op" id="3907794">]</span><span class="ident" id="3907795">AttributeTypeAndValue</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="3907818">//&nbsp;AttributeTypeAndValue&nbsp;mirrors&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3907891">//&nbsp;http://tools.ietf.org/html/rfc5280#section-4.1.2.4</span><br>
<span class="lineno"></span><span class="keyword" id="3907945">type</span>&nbsp;<span class="ident" id="3907950">AttributeTypeAndValue</span>&nbsp;<span class="keyword" id="3907972">struct</span>&nbsp;<span class="op" id="3907979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3907982">Type</span>&nbsp;&nbsp;<span class="ident" id="3907988">asn1</span><span class="op" id="3907992">.</span><span class="ident" id="3907993">ObjectIdentifier</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3908011">Value</span>&nbsp;<span class="keyword" id="3908017">interface</span><span class="op" id="3908026">{</span><span class="op" id="3908027">}</span><br>
<span class="lineno"></span><span class="op" id="3908029">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3908032">//&nbsp;AttributeTypeAndValueSET&nbsp;represents&nbsp;a&nbsp;set&nbsp;of&nbsp;ASN.1&nbsp;sequences&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3908099">//&nbsp;AttributeTypeAndValue&nbsp;sequences&nbsp;from&nbsp;RFC&nbsp;2986&nbsp;(PKCS&nbsp;#10).</span><br>
<span class="lineno">35</span><span class="keyword" id="3908160">type</span>&nbsp;<span class="ident" id="3908165">AttributeTypeAndValueSET</span>&nbsp;<span class="keyword" id="3908190">struct</span>&nbsp;<span class="op" id="3908197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3908200">Type</span>&nbsp;&nbsp;<span class="ident" id="3908206">asn1</span><span class="op" id="3908210">.</span><span class="ident" id="3908211">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3908229">Value</span>&nbsp;<span class="op" id="3908235">[</span><span class="op" id="3908236">]</span><span class="op" id="3908237">[</span><span class="op" id="3908238">]</span><span class="ident" id="3908239">AttributeTypeAndValue</span>&nbsp;<span class="string" id="3908261">`asn1:&#34;set&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3908274">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="3908277">//&nbsp;Extension&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno"></span><span class="comment" id="3908347">//&nbsp;5280,&nbsp;section&nbsp;4.2.</span><br>
<span class="lineno"></span><span class="keyword" id="3908369">type</span>&nbsp;<span class="ident" id="3908374">Extension</span>&nbsp;<span class="keyword" id="3908384">struct</span>&nbsp;<span class="op" id="3908391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3908394">Id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3908403">asn1</span><span class="op" id="3908407">.</span><span class="ident" id="3908408">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3908426">Critical</span>&nbsp;<span class="builtintype" id="3908435">bool</span>&nbsp;<span class="string" id="3908440">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3908459">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3908468">[</span><span class="op" id="3908469">]</span><span class="builtintype" id="3908470">byte</span><br>
<span class="lineno"></span><span class="op" id="3908475">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3908478">//&nbsp;Name&nbsp;represents&nbsp;an&nbsp;X.509&nbsp;distinguished&nbsp;name.&nbsp;This&nbsp;only&nbsp;includes&nbsp;the&nbsp;common</span><br>
<span class="lineno"></span><span class="comment" id="3908556">//&nbsp;elements&nbsp;of&nbsp;a&nbsp;DN.&nbsp;&nbsp;Additional&nbsp;elements&nbsp;in&nbsp;the&nbsp;name&nbsp;are&nbsp;ignored.</span><br>
<span class="lineno">50</span><span class="keyword" id="3908623">type</span>&nbsp;<span class="ident" id="3908628">Name</span>&nbsp;<span class="keyword" id="3908633">struct</span>&nbsp;<span class="op" id="3908640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3908643">Country</span><span class="op" id="3908650">,</span>&nbsp;<span class="ident" id="3908652">Organization</span><span class="op" id="3908664">,</span>&nbsp;<span class="ident" id="3908666">OrganizationalUnit</span>&nbsp;<span class="op" id="3908685">[</span><span class="op" id="3908686">]</span><span class="builtintype" id="3908687">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3908695">Locality</span><span class="op" id="3908703">,</span>&nbsp;<span class="ident" id="3908705">Province</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3908737">[</span><span class="op" id="3908738">]</span><span class="builtintype" id="3908739">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3908747">StreetAddress</span><span class="op" id="3908760">,</span>&nbsp;<span class="ident" id="3908762">PostalCode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3908789">[</span><span class="op" id="3908790">]</span><span class="builtintype" id="3908791">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3908799">SerialNumber</span><span class="op" id="3908811">,</span>&nbsp;<span class="ident" id="3908813">CommonName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3908841">string</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3908850">Names</span>&nbsp;<span class="op" id="3908856">[</span><span class="op" id="3908857">]</span><span class="ident" id="3908858">AttributeTypeAndValue</span><br>
<span class="lineno"></span><span class="op" id="3908880">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3908883">func</span>&nbsp;<span class="op" id="3908888">(</span><span class="ident" id="3908889">n</span>&nbsp;<span class="op" id="3908891">*</span><span class="ident" id="3908892">Name</span><span class="op" id="3908896">)</span>&nbsp;<span class="ident" id="3908898">FillFromRDNSequence</span><span class="op" id="3908917">(</span><span class="ident" id="3908918">rdns</span>&nbsp;<span class="op" id="3908923">*</span><span class="ident" id="3908924">RDNSequence</span><span class="op" id="3908935">)</span>&nbsp;<span class="op" id="3908937">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3908940">for</span>&nbsp;<span class="ident" id="3908944">_</span><span class="op" id="3908945">,</span>&nbsp;<span class="ident" id="3908947">rdn</span>&nbsp;<span class="op" id="3908951">:=</span>&nbsp;<span class="keyword" id="3908954">range</span>&nbsp;<span class="op" id="3908960">*</span><span class="ident" id="3908961">rdns</span>&nbsp;<span class="op" id="3908966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3908970">if</span>&nbsp;<span class="builtinfunc" id="3908973">len</span><span class="op" id="3908976">(</span><span class="ident" id="3908977">rdn</span><span class="op" id="3908980">)</span>&nbsp;<span class="op" id="3908982">==</span>&nbsp;<span class="num" id="3908985">0</span>&nbsp;<span class="op" id="3908987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3908992">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3909003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3909007">atv</span>&nbsp;<span class="op" id="3909011">:=</span>&nbsp;<span class="ident" id="3909014">rdn</span><span class="op" id="3909017">[</span><span class="num" id="3909018">0</span><span class="op" id="3909019">]</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3909023">n</span><span class="op" id="3909024">.</span><span class="ident" id="3909025">Names</span>&nbsp;<span class="op" id="3909031">=</span>&nbsp;<span class="builtinfunc" id="3909033">append</span><span class="op" id="3909039">(</span><span class="ident" id="3909040">n</span><span class="op" id="3909041">.</span><span class="ident" id="3909042">Names</span><span class="op" id="3909047">,</span>&nbsp;<span class="ident" id="3909049">atv</span><span class="op" id="3909052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3909056">value</span><span class="op" id="3909061">,</span>&nbsp;<span class="ident" id="3909063">ok</span>&nbsp;<span class="op" id="3909066">:=</span>&nbsp;<span class="ident" id="3909069">atv</span><span class="op" id="3909072">.</span><span class="ident" id="3909073">Value</span><span class="op" id="3909078">.</span><span class="op" id="3909079">(</span><span class="builtintype" id="3909080">string</span><span class="op" id="3909086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3909090">if</span>&nbsp;<span class="op" id="3909093">!</span><span class="ident" id="3909094">ok</span>&nbsp;<span class="op" id="3909097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3909102">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3909113">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3909118">t</span>&nbsp;<span class="op" id="3909120">:=</span>&nbsp;<span class="ident" id="3909123">atv</span><span class="op" id="3909126">.</span><span class="ident" id="3909127">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3909134">if</span>&nbsp;<span class="builtinfunc" id="3909137">len</span><span class="op" id="3909140">(</span><span class="ident" id="3909141">t</span><span class="op" id="3909142">)</span>&nbsp;<span class="op" id="3909144">==</span>&nbsp;<span class="num" id="3909147">4</span>&nbsp;<span class="op" id="3909149">&amp;&amp;</span>&nbsp;<span class="ident" id="3909152">t</span><span class="op" id="3909153">[</span><span class="num" id="3909154">0</span><span class="op" id="3909155">]</span>&nbsp;<span class="op" id="3909157">==</span>&nbsp;<span class="num" id="3909160">2</span>&nbsp;<span class="op" id="3909162">&amp;&amp;</span>&nbsp;<span class="ident" id="3909165">t</span><span class="op" id="3909166">[</span><span class="num" id="3909167">1</span><span class="op" id="3909168">]</span>&nbsp;<span class="op" id="3909170">==</span>&nbsp;<span class="num" id="3909173">5</span>&nbsp;<span class="op" id="3909175">&amp;&amp;</span>&nbsp;<span class="ident" id="3909178">t</span><span class="op" id="3909179">[</span><span class="num" id="3909180">2</span><span class="op" id="3909181">]</span>&nbsp;<span class="op" id="3909183">==</span>&nbsp;<span class="num" id="3909186">4</span>&nbsp;<span class="op" id="3909188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3909193">switch</span>&nbsp;<span class="ident" id="3909200">t</span><span class="op" id="3909201">[</span><span class="num" id="3909202">3</span><span class="op" id="3909203">]</span>&nbsp;<span class="op" id="3909205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3909210">case</span>&nbsp;<span class="num" id="3909215">3</span><span class="op" id="3909216">:</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3909222">n</span><span class="op" id="3909223">.</span><span class="ident" id="3909224">CommonName</span>&nbsp;<span class="op" id="3909235">=</span>&nbsp;<span class="ident" id="3909237">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3909246">case</span>&nbsp;<span class="num" id="3909251">5</span><span class="op" id="3909252">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3909258">n</span><span class="op" id="3909259">.</span><span class="ident" id="3909260">SerialNumber</span>&nbsp;<span class="op" id="3909273">=</span>&nbsp;<span class="ident" id="3909275">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3909284">case</span>&nbsp;<span class="num" id="3909289">6</span><span class="op" id="3909290">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3909296">n</span><span class="op" id="3909297">.</span><span class="ident" id="3909298">Country</span>&nbsp;<span class="op" id="3909306">=</span>&nbsp;<span class="builtinfunc" id="3909308">append</span><span class="op" id="3909314">(</span><span class="ident" id="3909315">n</span><span class="op" id="3909316">.</span><span class="ident" id="3909317">Country</span><span class="op" id="3909324">,</span>&nbsp;<span class="ident" id="3909326">value</span><span class="op" id="3909331">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3909336">case</span>&nbsp;<span class="num" id="3909341">7</span><span class="op" id="3909342">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3909348">n</span><span class="op" id="3909349">.</span><span class="ident" id="3909350">Locality</span>&nbsp;<span class="op" id="3909359">=</span>&nbsp;<span class="builtinfunc" id="3909361">append</span><span class="op" id="3909367">(</span><span class="ident" id="3909368">n</span><span class="op" id="3909369">.</span><span class="ident" id="3909370">Locality</span><span class="op" id="3909378">,</span>&nbsp;<span class="ident" id="3909380">value</span><span class="op" id="3909385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3909390">case</span>&nbsp;<span class="num" id="3909395">8</span><span class="op" id="3909396">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3909402">n</span><span class="op" id="3909403">.</span><span class="ident" id="3909404">Province</span>&nbsp;<span class="op" id="3909413">=</span>&nbsp;<span class="builtinfunc" id="3909415">append</span><span class="op" id="3909421">(</span><span class="ident" id="3909422">n</span><span class="op" id="3909423">.</span><span class="ident" id="3909424">Province</span><span class="op" id="3909432">,</span>&nbsp;<span class="ident" id="3909434">value</span><span class="op" id="3909439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3909444">case</span>&nbsp;<span class="num" id="3909449">9</span><span class="op" id="3909450">:</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3909456">n</span><span class="op" id="3909457">.</span><span class="ident" id="3909458">StreetAddress</span>&nbsp;<span class="op" id="3909472">=</span>&nbsp;<span class="builtinfunc" id="3909474">append</span><span class="op" id="3909480">(</span><span class="ident" id="3909481">n</span><span class="op" id="3909482">.</span><span class="ident" id="3909483">StreetAddress</span><span class="op" id="3909496">,</span>&nbsp;<span class="ident" id="3909498">value</span><span class="op" id="3909503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3909508">case</span>&nbsp;<span class="num" id="3909513">10</span><span class="op" id="3909515">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3909521">n</span><span class="op" id="3909522">.</span><span class="ident" id="3909523">Organization</span>&nbsp;<span class="op" id="3909536">=</span>&nbsp;<span class="builtinfunc" id="3909538">append</span><span class="op" id="3909544">(</span><span class="ident" id="3909545">n</span><span class="op" id="3909546">.</span><span class="ident" id="3909547">Organization</span><span class="op" id="3909559">,</span>&nbsp;<span class="ident" id="3909561">value</span><span class="op" id="3909566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3909571">case</span>&nbsp;<span class="num" id="3909576">11</span><span class="op" id="3909578">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3909584">n</span><span class="op" id="3909585">.</span><span class="ident" id="3909586">OrganizationalUnit</span>&nbsp;<span class="op" id="3909605">=</span>&nbsp;<span class="builtinfunc" id="3909607">append</span><span class="op" id="3909613">(</span><span class="ident" id="3909614">n</span><span class="op" id="3909615">.</span><span class="ident" id="3909616">OrganizationalUnit</span><span class="op" id="3909634">,</span>&nbsp;<span class="ident" id="3909636">value</span><span class="op" id="3909641">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3909646">case</span>&nbsp;<span class="num" id="3909651">17</span><span class="op" id="3909653">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3909659">n</span><span class="op" id="3909660">.</span><span class="ident" id="3909661">PostalCode</span>&nbsp;<span class="op" id="3909672">=</span>&nbsp;<span class="builtinfunc" id="3909674">append</span><span class="op" id="3909680">(</span><span class="ident" id="3909681">n</span><span class="op" id="3909682">.</span><span class="ident" id="3909683">PostalCode</span><span class="op" id="3909693">,</span>&nbsp;<span class="ident" id="3909695">value</span><span class="op" id="3909700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3909705">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3909709">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3909712">}</span><br>
<span class="lineno">95</span><span class="op" id="3909714">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3909717">var</span>&nbsp;<span class="op" id="3909721">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3909724">oidCountry</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3909746">=</span>&nbsp;<span class="op" id="3909748">[</span><span class="op" id="3909749">]</span><span class="builtintype" id="3909750">int</span><span class="op" id="3909753">{</span><span class="num" id="3909754">2</span><span class="op" id="3909755">,</span>&nbsp;<span class="num" id="3909757">5</span><span class="op" id="3909758">,</span>&nbsp;<span class="num" id="3909760">4</span><span class="op" id="3909761">,</span>&nbsp;<span class="num" id="3909763">6</span><span class="op" id="3909764">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3909767">oidOrganization</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3909789">=</span>&nbsp;<span class="op" id="3909791">[</span><span class="op" id="3909792">]</span><span class="builtintype" id="3909793">int</span><span class="op" id="3909796">{</span><span class="num" id="3909797">2</span><span class="op" id="3909798">,</span>&nbsp;<span class="num" id="3909800">5</span><span class="op" id="3909801">,</span>&nbsp;<span class="num" id="3909803">4</span><span class="op" id="3909804">,</span>&nbsp;<span class="num" id="3909806">10</span><span class="op" id="3909808">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3909811">oidOrganizationalUnit</span>&nbsp;<span class="op" id="3909833">=</span>&nbsp;<span class="op" id="3909835">[</span><span class="op" id="3909836">]</span><span class="builtintype" id="3909837">int</span><span class="op" id="3909840">{</span><span class="num" id="3909841">2</span><span class="op" id="3909842">,</span>&nbsp;<span class="num" id="3909844">5</span><span class="op" id="3909845">,</span>&nbsp;<span class="num" id="3909847">4</span><span class="op" id="3909848">,</span>&nbsp;<span class="num" id="3909850">11</span><span class="op" id="3909852">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3909855">oidCommonName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3909877">=</span>&nbsp;<span class="op" id="3909879">[</span><span class="op" id="3909880">]</span><span class="builtintype" id="3909881">int</span><span class="op" id="3909884">{</span><span class="num" id="3909885">2</span><span class="op" id="3909886">,</span>&nbsp;<span class="num" id="3909888">5</span><span class="op" id="3909889">,</span>&nbsp;<span class="num" id="3909891">4</span><span class="op" id="3909892">,</span>&nbsp;<span class="num" id="3909894">3</span><span class="op" id="3909895">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3909898">oidSerialNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3909920">=</span>&nbsp;<span class="op" id="3909922">[</span><span class="op" id="3909923">]</span><span class="builtintype" id="3909924">int</span><span class="op" id="3909927">{</span><span class="num" id="3909928">2</span><span class="op" id="3909929">,</span>&nbsp;<span class="num" id="3909931">5</span><span class="op" id="3909932">,</span>&nbsp;<span class="num" id="3909934">4</span><span class="op" id="3909935">,</span>&nbsp;<span class="num" id="3909937">5</span><span class="op" id="3909938">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3909941">oidLocality</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3909963">=</span>&nbsp;<span class="op" id="3909965">[</span><span class="op" id="3909966">]</span><span class="builtintype" id="3909967">int</span><span class="op" id="3909970">{</span><span class="num" id="3909971">2</span><span class="op" id="3909972">,</span>&nbsp;<span class="num" id="3909974">5</span><span class="op" id="3909975">,</span>&nbsp;<span class="num" id="3909977">4</span><span class="op" id="3909978">,</span>&nbsp;<span class="num" id="3909980">7</span><span class="op" id="3909981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3909984">oidProvince</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3910006">=</span>&nbsp;<span class="op" id="3910008">[</span><span class="op" id="3910009">]</span><span class="builtintype" id="3910010">int</span><span class="op" id="3910013">{</span><span class="num" id="3910014">2</span><span class="op" id="3910015">,</span>&nbsp;<span class="num" id="3910017">5</span><span class="op" id="3910018">,</span>&nbsp;<span class="num" id="3910020">4</span><span class="op" id="3910021">,</span>&nbsp;<span class="num" id="3910023">8</span><span class="op" id="3910024">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3910027">oidStreetAddress</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3910049">=</span>&nbsp;<span class="op" id="3910051">[</span><span class="op" id="3910052">]</span><span class="builtintype" id="3910053">int</span><span class="op" id="3910056">{</span><span class="num" id="3910057">2</span><span class="op" id="3910058">,</span>&nbsp;<span class="num" id="3910060">5</span><span class="op" id="3910061">,</span>&nbsp;<span class="num" id="3910063">4</span><span class="op" id="3910064">,</span>&nbsp;<span class="num" id="3910066">9</span><span class="op" id="3910067">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3910070">oidPostalCode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3910092">=</span>&nbsp;<span class="op" id="3910094">[</span><span class="op" id="3910095">]</span><span class="builtintype" id="3910096">int</span><span class="op" id="3910099">{</span><span class="num" id="3910100">2</span><span class="op" id="3910101">,</span>&nbsp;<span class="num" id="3910103">5</span><span class="op" id="3910104">,</span>&nbsp;<span class="num" id="3910106">4</span><span class="op" id="3910107">,</span>&nbsp;<span class="num" id="3910109">17</span><span class="op" id="3910111">}</span><br>
<span class="lineno"></span><span class="op" id="3910113">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3910116">//&nbsp;appendRDNs&nbsp;appends&nbsp;a&nbsp;relativeDistinguishedNameSET&nbsp;to&nbsp;the&nbsp;given&nbsp;RDNSequence</span><br>
<span class="lineno">110</span><span class="comment" id="3910194">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;new&nbsp;value.&nbsp;The&nbsp;relativeDistinguishedNameSET&nbsp;contains&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="3910269">//&nbsp;attributeTypeAndValue&nbsp;for&nbsp;each&nbsp;of&nbsp;the&nbsp;given&nbsp;values.&nbsp;See&nbsp;RFC&nbsp;5280,&nbsp;A.1,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3910347">//&nbsp;search&nbsp;for&nbsp;AttributeTypeAndValue.</span><br>
<span class="lineno"></span><span class="keyword" id="3910384">func</span>&nbsp;<span class="ident" id="3910389">appendRDNs</span><span class="op" id="3910399">(</span><span class="ident" id="3910400">in</span>&nbsp;<span class="ident" id="3910403">RDNSequence</span><span class="op" id="3910414">,</span>&nbsp;<span class="ident" id="3910416">values</span>&nbsp;<span class="op" id="3910423">[</span><span class="op" id="3910424">]</span><span class="builtintype" id="3910425">string</span><span class="op" id="3910431">,</span>&nbsp;<span class="ident" id="3910433">oid</span>&nbsp;<span class="ident" id="3910437">asn1</span><span class="op" id="3910441">.</span><span class="ident" id="3910442">ObjectIdentifier</span><span class="op" id="3910458">)</span>&nbsp;<span class="ident" id="3910460">RDNSequence</span>&nbsp;<span class="op" id="3910472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3910475">if</span>&nbsp;<span class="builtinfunc" id="3910478">len</span><span class="op" id="3910481">(</span><span class="ident" id="3910482">values</span><span class="op" id="3910488">)</span>&nbsp;<span class="op" id="3910490">==</span>&nbsp;<span class="num" id="3910493">0</span>&nbsp;<span class="op" id="3910495">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3910499">return</span>&nbsp;<span class="ident" id="3910506">in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3910510">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3910514">s</span>&nbsp;<span class="op" id="3910516">:=</span>&nbsp;<span class="builtinfunc" id="3910519">make</span><span class="op" id="3910523">(</span><span class="op" id="3910524">[</span><span class="op" id="3910525">]</span><span class="ident" id="3910526">AttributeTypeAndValue</span><span class="op" id="3910547">,</span>&nbsp;<span class="builtinfunc" id="3910549">len</span><span class="op" id="3910552">(</span><span class="ident" id="3910553">values</span><span class="op" id="3910559">)</span><span class="op" id="3910560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3910563">for</span>&nbsp;<span class="ident" id="3910567">i</span><span class="op" id="3910568">,</span>&nbsp;<span class="ident" id="3910570">value</span>&nbsp;<span class="op" id="3910576">:=</span>&nbsp;<span class="keyword" id="3910579">range</span>&nbsp;<span class="ident" id="3910585">values</span>&nbsp;<span class="op" id="3910592">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3910596">s</span><span class="op" id="3910597">[</span><span class="ident" id="3910598">i</span><span class="op" id="3910599">]</span><span class="op" id="3910600">.</span><span class="ident" id="3910601">Type</span>&nbsp;<span class="op" id="3910606">=</span>&nbsp;<span class="ident" id="3910608">oid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3910614">s</span><span class="op" id="3910615">[</span><span class="ident" id="3910616">i</span><span class="op" id="3910617">]</span><span class="op" id="3910618">.</span><span class="ident" id="3910619">Value</span>&nbsp;<span class="op" id="3910625">=</span>&nbsp;<span class="ident" id="3910627">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3910634">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3910638">return</span>&nbsp;<span class="builtinfunc" id="3910645">append</span><span class="op" id="3910651">(</span><span class="ident" id="3910652">in</span><span class="op" id="3910654">,</span>&nbsp;<span class="ident" id="3910656">s</span><span class="op" id="3910657">)</span><br>
<span class="lineno">125</span><span class="op" id="3910659">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3910662">func</span>&nbsp;<span class="op" id="3910667">(</span><span class="ident" id="3910668">n</span>&nbsp;<span class="ident" id="3910670">Name</span><span class="op" id="3910674">)</span>&nbsp;<span class="ident" id="3910676">ToRDNSequence</span><span class="op" id="3910689">(</span><span class="op" id="3910690">)</span>&nbsp;<span class="op" id="3910692">(</span><span class="ident" id="3910693">ret</span>&nbsp;<span class="ident" id="3910697">RDNSequence</span><span class="op" id="3910708">)</span>&nbsp;<span class="op" id="3910710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3910713">ret</span>&nbsp;<span class="op" id="3910717">=</span>&nbsp;<span class="ident" id="3910719">appendRDNs</span><span class="op" id="3910729">(</span><span class="ident" id="3910730">ret</span><span class="op" id="3910733">,</span>&nbsp;<span class="ident" id="3910735">n</span><span class="op" id="3910736">.</span><span class="ident" id="3910737">Country</span><span class="op" id="3910744">,</span>&nbsp;<span class="ident" id="3910746">oidCountry</span><span class="op" id="3910756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3910759">ret</span>&nbsp;<span class="op" id="3910763">=</span>&nbsp;<span class="ident" id="3910765">appendRDNs</span><span class="op" id="3910775">(</span><span class="ident" id="3910776">ret</span><span class="op" id="3910779">,</span>&nbsp;<span class="ident" id="3910781">n</span><span class="op" id="3910782">.</span><span class="ident" id="3910783">Organization</span><span class="op" id="3910795">,</span>&nbsp;<span class="ident" id="3910797">oidOrganization</span><span class="op" id="3910812">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3910815">ret</span>&nbsp;<span class="op" id="3910819">=</span>&nbsp;<span class="ident" id="3910821">appendRDNs</span><span class="op" id="3910831">(</span><span class="ident" id="3910832">ret</span><span class="op" id="3910835">,</span>&nbsp;<span class="ident" id="3910837">n</span><span class="op" id="3910838">.</span><span class="ident" id="3910839">OrganizationalUnit</span><span class="op" id="3910857">,</span>&nbsp;<span class="ident" id="3910859">oidOrganizationalUnit</span><span class="op" id="3910880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3910883">ret</span>&nbsp;<span class="op" id="3910887">=</span>&nbsp;<span class="ident" id="3910889">appendRDNs</span><span class="op" id="3910899">(</span><span class="ident" id="3910900">ret</span><span class="op" id="3910903">,</span>&nbsp;<span class="ident" id="3910905">n</span><span class="op" id="3910906">.</span><span class="ident" id="3910907">Locality</span><span class="op" id="3910915">,</span>&nbsp;<span class="ident" id="3910917">oidLocality</span><span class="op" id="3910928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3910931">ret</span>&nbsp;<span class="op" id="3910935">=</span>&nbsp;<span class="ident" id="3910937">appendRDNs</span><span class="op" id="3910947">(</span><span class="ident" id="3910948">ret</span><span class="op" id="3910951">,</span>&nbsp;<span class="ident" id="3910953">n</span><span class="op" id="3910954">.</span><span class="ident" id="3910955">Province</span><span class="op" id="3910963">,</span>&nbsp;<span class="ident" id="3910965">oidProvince</span><span class="op" id="3910976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3910979">ret</span>&nbsp;<span class="op" id="3910983">=</span>&nbsp;<span class="ident" id="3910985">appendRDNs</span><span class="op" id="3910995">(</span><span class="ident" id="3910996">ret</span><span class="op" id="3910999">,</span>&nbsp;<span class="ident" id="3911001">n</span><span class="op" id="3911002">.</span><span class="ident" id="3911003">StreetAddress</span><span class="op" id="3911016">,</span>&nbsp;<span class="ident" id="3911018">oidStreetAddress</span><span class="op" id="3911034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3911037">ret</span>&nbsp;<span class="op" id="3911041">=</span>&nbsp;<span class="ident" id="3911043">appendRDNs</span><span class="op" id="3911053">(</span><span class="ident" id="3911054">ret</span><span class="op" id="3911057">,</span>&nbsp;<span class="ident" id="3911059">n</span><span class="op" id="3911060">.</span><span class="ident" id="3911061">PostalCode</span><span class="op" id="3911071">,</span>&nbsp;<span class="ident" id="3911073">oidPostalCode</span><span class="op" id="3911086">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3911089">if</span>&nbsp;<span class="builtinfunc" id="3911092">len</span><span class="op" id="3911095">(</span><span class="ident" id="3911096">n</span><span class="op" id="3911097">.</span><span class="ident" id="3911098">CommonName</span><span class="op" id="3911108">)</span>&nbsp;<span class="op" id="3911110">&gt;</span>&nbsp;<span class="num" id="3911112">0</span>&nbsp;<span class="op" id="3911114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3911118">ret</span>&nbsp;<span class="op" id="3911122">=</span>&nbsp;<span class="ident" id="3911124">appendRDNs</span><span class="op" id="3911134">(</span><span class="ident" id="3911135">ret</span><span class="op" id="3911138">,</span>&nbsp;<span class="op" id="3911140">[</span><span class="op" id="3911141">]</span><span class="builtintype" id="3911142">string</span><span class="op" id="3911148">{</span><span class="ident" id="3911149">n</span><span class="op" id="3911150">.</span><span class="ident" id="3911151">CommonName</span><span class="op" id="3911161">}</span><span class="op" id="3911162">,</span>&nbsp;<span class="ident" id="3911164">oidCommonName</span><span class="op" id="3911177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3911180">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3911183">if</span>&nbsp;<span class="builtinfunc" id="3911186">len</span><span class="op" id="3911189">(</span><span class="ident" id="3911190">n</span><span class="op" id="3911191">.</span><span class="ident" id="3911192">SerialNumber</span><span class="op" id="3911204">)</span>&nbsp;<span class="op" id="3911206">&gt;</span>&nbsp;<span class="num" id="3911208">0</span>&nbsp;<span class="op" id="3911210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3911214">ret</span>&nbsp;<span class="op" id="3911218">=</span>&nbsp;<span class="ident" id="3911220">appendRDNs</span><span class="op" id="3911230">(</span><span class="ident" id="3911231">ret</span><span class="op" id="3911234">,</span>&nbsp;<span class="op" id="3911236">[</span><span class="op" id="3911237">]</span><span class="builtintype" id="3911238">string</span><span class="op" id="3911244">{</span><span class="ident" id="3911245">n</span><span class="op" id="3911246">.</span><span class="ident" id="3911247">SerialNumber</span><span class="op" id="3911259">}</span><span class="op" id="3911260">,</span>&nbsp;<span class="ident" id="3911262">oidSerialNumber</span><span class="op" id="3911277">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3911280">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3911284">return</span>&nbsp;<span class="ident" id="3911291">ret</span><br>
<span class="lineno"></span><span class="op" id="3911295">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span><span class="comment" id="3911298">//&nbsp;CertificateList&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno"></span><span class="comment" id="3911374">//&nbsp;5280,&nbsp;section&nbsp;5.1.&nbsp;Use&nbsp;Certificate.CheckCRLSignature&nbsp;to&nbsp;verify&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3911444">//&nbsp;signature.</span><br>
<span class="lineno"></span><span class="keyword" id="3911458">type</span>&nbsp;<span class="ident" id="3911463">CertificateList</span>&nbsp;<span class="keyword" id="3911479">struct</span>&nbsp;<span class="op" id="3911486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3911489">TBSCertList</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3911508">TBSCertificateList</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3911528">SignatureAlgorithm</span>&nbsp;<span class="ident" id="3911547">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3911568">SignatureValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3911587">asn1</span><span class="op" id="3911591">.</span><span class="ident" id="3911592">BitString</span><br>
<span class="lineno"></span><span class="op" id="3911602">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3911605">//&nbsp;HasExpired&nbsp;reports&nbsp;whether&nbsp;now&nbsp;is&nbsp;past&nbsp;the&nbsp;expiry&nbsp;time&nbsp;of&nbsp;certList.</span><br>
<span class="lineno">155</span><span class="keyword" id="3911676">func</span>&nbsp;<span class="op" id="3911681">(</span><span class="ident" id="3911682">certList</span>&nbsp;<span class="op" id="3911691">*</span><span class="ident" id="3911692">CertificateList</span><span class="op" id="3911707">)</span>&nbsp;<span class="ident" id="3911709">HasExpired</span><span class="op" id="3911719">(</span><span class="ident" id="3911720">now</span>&nbsp;<span class="ident" id="3911724">time</span><span class="op" id="3911728">.</span><span class="ident" id="3911729">Time</span><span class="op" id="3911733">)</span>&nbsp;<span class="builtintype" id="3911735">bool</span>&nbsp;<span class="op" id="3911740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3911743">return</span>&nbsp;<span class="ident" id="3911750">now</span><span class="op" id="3911753">.</span><span class="ident" id="3911754">After</span><span class="op" id="3911759">(</span><span class="ident" id="3911760">certList</span><span class="op" id="3911768">.</span><span class="ident" id="3911769">TBSCertList</span><span class="op" id="3911780">.</span><span class="ident" id="3911781">NextUpdate</span><span class="op" id="3911791">)</span><br>
<span class="lineno"></span><span class="op" id="3911793">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3911796">//&nbsp;TBSCertificateList&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno">160</span><span class="comment" id="3911875">//&nbsp;5280,&nbsp;section&nbsp;5.1.</span><br>
<span class="lineno"></span><span class="keyword" id="3911897">type</span>&nbsp;<span class="ident" id="3911902">TBSCertificateList</span>&nbsp;<span class="keyword" id="3911921">struct</span>&nbsp;<span class="op" id="3911928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3911931">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3911951">asn1</span><span class="op" id="3911955">.</span><span class="ident" id="3911956">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3911968">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3911988">int</span>&nbsp;<span class="string" id="3911992">`asn1:&#34;optional,default:2&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3912021">Signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3912041">AlgorithmIdentifier</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3912062">Issuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3912082">RDNSequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3912095">ThisUpdate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3912115">time</span><span class="op" id="3912119">.</span><span class="ident" id="3912120">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3912126">NextUpdate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3912146">time</span><span class="op" id="3912150">.</span><span class="ident" id="3912151">Time</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3912167">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3912186">RevokedCertificates</span>&nbsp;<span class="op" id="3912206">[</span><span class="op" id="3912207">]</span><span class="ident" id="3912208">RevokedCertificate</span>&nbsp;<span class="string" id="3912227">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3912246">Extensions</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3912266">[</span><span class="op" id="3912267">]</span><span class="ident" id="3912268">Extension</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3912287">`asn1:&#34;tag:0,optional,explicit&#34;`</span><br>
<span class="lineno">170</span><span class="op" id="3912320">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3912323">//&nbsp;RevokedCertificate&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno"></span><span class="comment" id="3912402">//&nbsp;5280,&nbsp;section&nbsp;5.1.</span><br>
<span class="lineno"></span><span class="keyword" id="3912424">type</span>&nbsp;<span class="ident" id="3912429">RevokedCertificate</span>&nbsp;<span class="keyword" id="3912448">struct</span>&nbsp;<span class="op" id="3912455">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3912458">SerialNumber</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3912473">*</span><span class="ident" id="3912474">big</span><span class="op" id="3912477">.</span><span class="ident" id="3912478">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3912483">RevocationTime</span>&nbsp;<span class="ident" id="3912498">time</span><span class="op" id="3912502">.</span><span class="ident" id="3912503">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3912509">Extensions</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3912524">[</span><span class="op" id="3912525">]</span><span class="ident" id="3912526">Extension</span>&nbsp;<span class="string" id="3912536">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3912554">}</span>
</div>
</body>
</html>
