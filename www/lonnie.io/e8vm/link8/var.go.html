<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="keyword" id="5854180">package</span>&nbsp;<span class="ident" id="5854188">link8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5854195">import</span>&nbsp;<span class="op" id="5854202">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5854205">&#34;bytes&#34;</span><br>
<span class="lineno">5</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5854214">&#34;math&#34;</span><br>
<span class="lineno"></span><span class="op" id="5854221">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5854224">//&nbsp;Var&nbsp;reprsents&nbsp;a&nbsp;variable&nbsp;object</span><br>
<span class="lineno"></span><span class="keyword" id="5854259">type</span>&nbsp;<span class="ident" id="5854264">Var</span>&nbsp;<span class="keyword" id="5854268">struct</span>&nbsp;<span class="op" id="5854275">{</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5854278">align</span>&nbsp;<span class="builtintype" id="5854284">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5854292">buf</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5854298">*</span><span class="ident" id="5854299">bytes</span><span class="op" id="5854304">.</span><span class="ident" id="5854305">Buffer</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5854314">addr</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5854321">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5854329">prePad</span>&nbsp;<span class="builtintype" id="5854336">uint32</span><br>
<span class="lineno">15</span><span class="op" id="5854343">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5854346">//&nbsp;NewVar&nbsp;creates&nbsp;a&nbsp;new&nbsp;relocatable&nbsp;data&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="5854396">func</span>&nbsp;<span class="ident" id="5854401">NewVar</span><span class="op" id="5854407">(</span><span class="ident" id="5854408">align</span>&nbsp;<span class="builtintype" id="5854414">uint32</span><span class="op" id="5854420">)</span>&nbsp;<span class="op" id="5854422">*</span><span class="ident" id="5854423">Var</span>&nbsp;<span class="op" id="5854427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5854430">ret</span>&nbsp;<span class="op" id="5854434">:=</span>&nbsp;<span class="builtinfunc" id="5854437">new</span><span class="op" id="5854440">(</span><span class="ident" id="5854441">Var</span><span class="op" id="5854444">)</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5854448">if</span>&nbsp;<span class="ident" id="5854451">align</span>&nbsp;<span class="op" id="5854457">==</span>&nbsp;<span class="num" id="5854460">0</span>&nbsp;<span class="op" id="5854462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5854466">align</span>&nbsp;<span class="op" id="5854472">=</span>&nbsp;<span class="num" id="5854474">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5854477">}</span>&nbsp;<span class="keyword" id="5854479">else</span>&nbsp;<span class="keyword" id="5854484">if</span>&nbsp;<span class="ident" id="5854487">align</span>&nbsp;<span class="op" id="5854493">!=</span>&nbsp;<span class="num" id="5854496">1</span>&nbsp;<span class="op" id="5854498">&amp;&amp;</span>&nbsp;<span class="ident" id="5854501">align</span>&nbsp;<span class="op" id="5854507">!=</span>&nbsp;<span class="num" id="5854510">4</span>&nbsp;<span class="op" id="5854512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5854516">panic</span><span class="op" id="5854521">(</span><span class="string" id="5854522">&#34;invalid&nbsp;align&#34;</span><span class="op" id="5854537">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5854540">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5854544">ret</span><span class="op" id="5854547">.</span><span class="ident" id="5854548">align</span>&nbsp;<span class="op" id="5854554">=</span>&nbsp;<span class="ident" id="5854556">align</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5854563">ret</span><span class="op" id="5854566">.</span><span class="ident" id="5854567">buf</span>&nbsp;<span class="op" id="5854571">=</span>&nbsp;<span class="builtinfunc" id="5854573">new</span><span class="op" id="5854576">(</span><span class="ident" id="5854577">bytes</span><span class="op" id="5854582">.</span><span class="ident" id="5854583">Buffer</span><span class="op" id="5854589">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5854593">return</span>&nbsp;<span class="ident" id="5854600">ret</span><br>
<span class="lineno"></span><span class="op" id="5854604">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5854607">//&nbsp;Write&nbsp;appends&nbsp;bytes&nbsp;to&nbsp;this&nbsp;data&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="5854652">func</span>&nbsp;<span class="op" id="5854657">(</span><span class="ident" id="5854658">v</span>&nbsp;<span class="op" id="5854660">*</span><span class="ident" id="5854661">Var</span><span class="op" id="5854664">)</span>&nbsp;<span class="ident" id="5854666">Write</span><span class="op" id="5854671">(</span><span class="ident" id="5854672">buf</span>&nbsp;<span class="op" id="5854676">[</span><span class="op" id="5854677">]</span><span class="builtintype" id="5854678">byte</span><span class="op" id="5854682">)</span>&nbsp;<span class="op" id="5854684">(</span><span class="builtintype" id="5854685">int</span><span class="op" id="5854688">,</span>&nbsp;<span class="builtintype" id="5854690">error</span><span class="op" id="5854695">)</span>&nbsp;<span class="op" id="5854697">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5854700">return</span>&nbsp;<span class="ident" id="5854707">v</span><span class="op" id="5854708">.</span><span class="ident" id="5854709">buf</span><span class="op" id="5854712">.</span><span class="ident" id="5854713">Write</span><span class="op" id="5854718">(</span><span class="ident" id="5854719">buf</span><span class="op" id="5854722">)</span><br>
<span class="lineno"></span><span class="op" id="5854724">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5854727">//&nbsp;Pad&nbsp;pads&nbsp;n&nbsp;bytes&nbsp;into&nbsp;this&nbsp;data&nbsp;section</span><br>
<span class="lineno"></span><span class="keyword" id="5854770">func</span>&nbsp;<span class="op" id="5854775">(</span><span class="ident" id="5854776">v</span>&nbsp;<span class="op" id="5854778">*</span><span class="ident" id="5854779">Var</span><span class="op" id="5854782">)</span>&nbsp;<span class="ident" id="5854784">Pad</span><span class="op" id="5854787">(</span><span class="ident" id="5854788">n</span>&nbsp;<span class="builtintype" id="5854790">uint32</span><span class="op" id="5854796">)</span>&nbsp;<span class="op" id="5854798">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5854801">v</span><span class="op" id="5854802">.</span><span class="ident" id="5854803">buf</span><span class="op" id="5854806">.</span><span class="ident" id="5854807">Write</span><span class="op" id="5854812">(</span><span class="builtinfunc" id="5854813">make</span><span class="op" id="5854817">(</span><span class="op" id="5854818">[</span><span class="op" id="5854819">]</span><span class="builtintype" id="5854820">byte</span><span class="op" id="5854824">,</span>&nbsp;<span class="ident" id="5854826">n</span><span class="op" id="5854827">)</span><span class="op" id="5854828">)</span><br>
<span class="lineno"></span><span class="op" id="5854830">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5854833">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;current&nbsp;size&nbsp;of&nbsp;the&nbsp;section</span><br>
<span class="lineno"></span><span class="keyword" id="5854881">func</span>&nbsp;<span class="op" id="5854886">(</span><span class="ident" id="5854887">v</span>&nbsp;<span class="op" id="5854889">*</span><span class="ident" id="5854890">Var</span><span class="op" id="5854893">)</span>&nbsp;<span class="ident" id="5854895">Size</span><span class="op" id="5854899">(</span><span class="op" id="5854900">)</span>&nbsp;<span class="builtintype" id="5854902">uint32</span>&nbsp;<span class="op" id="5854909">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5854912">return</span>&nbsp;<span class="builtintype" id="5854919">uint32</span><span class="op" id="5854925">(</span><span class="ident" id="5854926">v</span><span class="op" id="5854927">.</span><span class="ident" id="5854928">buf</span><span class="op" id="5854931">.</span><span class="ident" id="5854932">Len</span><span class="op" id="5854935">(</span><span class="op" id="5854936">)</span><span class="op" id="5854937">)</span><br>
<span class="lineno"></span><span class="op" id="5854939">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5854942">//&nbsp;TooLarge&nbsp;checks&nbsp;if&nbsp;the&nbsp;size&nbsp;is&nbsp;larger&nbsp;than&nbsp;2GB</span><br>
<span class="lineno"></span><span class="keyword" id="5854992">func</span>&nbsp;<span class="op" id="5854997">(</span><span class="ident" id="5854998">v</span>&nbsp;<span class="op" id="5855000">*</span><span class="ident" id="5855001">Var</span><span class="op" id="5855004">)</span>&nbsp;<span class="ident" id="5855006">TooLarge</span><span class="op" id="5855014">(</span><span class="op" id="5855015">)</span>&nbsp;<span class="builtintype" id="5855017">bool</span>&nbsp;<span class="op" id="5855022">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5855025">return</span>&nbsp;<span class="ident" id="5855032">v</span><span class="op" id="5855033">.</span><span class="ident" id="5855034">buf</span><span class="op" id="5855037">.</span><span class="ident" id="5855038">Len</span><span class="op" id="5855041">(</span><span class="op" id="5855042">)</span>&nbsp;<span class="op" id="5855044">&gt;</span>&nbsp;<span class="ident" id="5855046">math</span><span class="op" id="5855050">.</span><span class="ident" id="5855051">MaxInt32</span><br>
<span class="lineno"></span><span class="op" id="5855060">}</span>
</div>
</body>
</html>
