<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>fmt</h2>
<ul>
<li><a href="/gostd/fmt/doc.go.html">doc.go</a></li>
<li><a href="/gostd/fmt/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/fmt/fmt_test.go.html">fmt_test.go</a></li>
<li><a href="/gostd/fmt/format.go.html">format.go</a></li>
<li><a href="/gostd/fmt/print.go.html">print.go</a></li>
<li><a href="/gostd/fmt/scan.go.html" class="current">scan.go</a></li>
<li><a href="/gostd/fmt/scan_test.go.html">scan_test.go</a></li>
<li><a href="/gostd/fmt/stringer_test.go.html">stringer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2058462">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2058517">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2058571">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2058622">package</span>&nbsp;<span class="ident" id="2058630">fmt</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2058635">import</span>&nbsp;<span class="op" id="2058642">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2058645">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2058655">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2058661">&#34;math&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2058669">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2058675">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2058686">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2058697">&#34;sync&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2058705">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="2058720">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2058723">//&nbsp;runeUnreader&nbsp;is&nbsp;the&nbsp;interface&nbsp;to&nbsp;something&nbsp;that&nbsp;can&nbsp;unread&nbsp;runes.</span><br>
<span class="lineno"></span><span class="comment" id="2058792">//&nbsp;If&nbsp;the&nbsp;object&nbsp;provided&nbsp;to&nbsp;Scan&nbsp;does&nbsp;not&nbsp;satisfy&nbsp;this&nbsp;interface,</span><br>
<span class="lineno">20</span><span class="comment" id="2058859">//&nbsp;a&nbsp;local&nbsp;buffer&nbsp;will&nbsp;be&nbsp;used&nbsp;to&nbsp;back&nbsp;up&nbsp;the&nbsp;input,&nbsp;but&nbsp;its&nbsp;contents</span><br>
<span class="lineno"></span><span class="comment" id="2058929">//&nbsp;will&nbsp;be&nbsp;lost&nbsp;when&nbsp;Scan&nbsp;returns.</span><br>
<span class="lineno"></span><span class="keyword" id="2058964">type</span>&nbsp;<span class="ident" id="2058969">runeUnreader</span>&nbsp;<span class="keyword" id="2058982">interface</span>&nbsp;<span class="op" id="2058992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2058995">UnreadRune</span><span class="op" id="2059005">(</span><span class="op" id="2059006">)</span>&nbsp;<span class="builtintype" id="2059008">error</span><br>
<span class="lineno"></span><span class="op" id="2059014">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="2059017">//&nbsp;ScanState&nbsp;represents&nbsp;the&nbsp;scanner&nbsp;state&nbsp;passed&nbsp;to&nbsp;custom&nbsp;scanners.</span><br>
<span class="lineno"></span><span class="comment" id="2059086">//&nbsp;Scanners&nbsp;may&nbsp;do&nbsp;rune-at-a-time&nbsp;scanning&nbsp;or&nbsp;ask&nbsp;the&nbsp;ScanState</span><br>
<span class="lineno"></span><span class="comment" id="2059150">//&nbsp;to&nbsp;discover&nbsp;the&nbsp;next&nbsp;space-delimited&nbsp;token.</span><br>
<span class="lineno"></span><span class="keyword" id="2059197">type</span>&nbsp;<span class="ident" id="2059202">ScanState</span>&nbsp;<span class="keyword" id="2059212">interface</span>&nbsp;<span class="op" id="2059222">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2059225">//&nbsp;ReadRune&nbsp;reads&nbsp;the&nbsp;next&nbsp;rune&nbsp;(Unicode&nbsp;code&nbsp;point)&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2059295">//&nbsp;If&nbsp;invoked&nbsp;during&nbsp;Scanln,&nbsp;Fscanln,&nbsp;or&nbsp;Sscanln,&nbsp;ReadRune()&nbsp;will</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2059362">//&nbsp;return&nbsp;EOF&nbsp;after&nbsp;returning&nbsp;the&nbsp;first&nbsp;&#39;\n&#39;&nbsp;or&nbsp;when&nbsp;reading&nbsp;beyond</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2059431">//&nbsp;the&nbsp;specified&nbsp;width.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2059456">ReadRune</span><span class="op" id="2059464">(</span><span class="op" id="2059465">)</span>&nbsp;<span class="op" id="2059467">(</span><span class="ident" id="2059468">r</span>&nbsp;<span class="builtintype" id="2059470">rune</span><span class="op" id="2059474">,</span>&nbsp;<span class="ident" id="2059476">size</span>&nbsp;<span class="builtintype" id="2059481">int</span><span class="op" id="2059484">,</span>&nbsp;<span class="ident" id="2059486">err</span>&nbsp;<span class="builtintype" id="2059490">error</span><span class="op" id="2059495">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2059498">//&nbsp;UnreadRune&nbsp;causes&nbsp;the&nbsp;next&nbsp;call&nbsp;to&nbsp;ReadRune&nbsp;to&nbsp;return&nbsp;the&nbsp;same&nbsp;rune.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2059571">UnreadRune</span><span class="op" id="2059581">(</span><span class="op" id="2059582">)</span>&nbsp;<span class="builtintype" id="2059584">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2059591">//&nbsp;SkipSpace&nbsp;skips&nbsp;space&nbsp;in&nbsp;the&nbsp;input.&nbsp;Newlines&nbsp;are&nbsp;treated&nbsp;as&nbsp;space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2059661">//&nbsp;unless&nbsp;the&nbsp;scan&nbsp;operation&nbsp;is&nbsp;Scanln,&nbsp;Fscanln&nbsp;or&nbsp;Sscanln,&nbsp;in&nbsp;which&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2059736">//&nbsp;a&nbsp;newline&nbsp;is&nbsp;treated&nbsp;as&nbsp;EOF.</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2059769">SkipSpace</span><span class="op" id="2059778">(</span><span class="op" id="2059779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2059782">//&nbsp;Token&nbsp;skips&nbsp;space&nbsp;in&nbsp;the&nbsp;input&nbsp;if&nbsp;skipSpace&nbsp;is&nbsp;true,&nbsp;then&nbsp;returns&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2059856">//&nbsp;run&nbsp;of&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;c&nbsp;satisfying&nbsp;f(c).&nbsp;&nbsp;If&nbsp;f&nbsp;is&nbsp;nil,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2059920">//&nbsp;!unicode.IsSpace(c)&nbsp;is&nbsp;used;&nbsp;that&nbsp;is,&nbsp;the&nbsp;token&nbsp;will&nbsp;hold&nbsp;non-space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2059992">//&nbsp;characters.&nbsp;&nbsp;Newlines&nbsp;are&nbsp;treated&nbsp;as&nbsp;space&nbsp;unless&nbsp;the&nbsp;scan&nbsp;operation</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2060065">//&nbsp;is&nbsp;Scanln,&nbsp;Fscanln&nbsp;or&nbsp;Sscanln,&nbsp;in&nbsp;which&nbsp;case&nbsp;a&nbsp;newline&nbsp;is&nbsp;treated&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2060138">//&nbsp;EOF.&nbsp;&nbsp;The&nbsp;returned&nbsp;slice&nbsp;points&nbsp;to&nbsp;shared&nbsp;data&nbsp;that&nbsp;may&nbsp;be&nbsp;overwritten</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2060213">//&nbsp;by&nbsp;the&nbsp;next&nbsp;call&nbsp;to&nbsp;Token,&nbsp;a&nbsp;call&nbsp;to&nbsp;a&nbsp;Scan&nbsp;function&nbsp;using&nbsp;the&nbsp;ScanState</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2060290">//&nbsp;as&nbsp;input,&nbsp;or&nbsp;when&nbsp;the&nbsp;calling&nbsp;Scan&nbsp;method&nbsp;returns.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2060345">Token</span><span class="op" id="2060350">(</span><span class="ident" id="2060351">skipSpace</span>&nbsp;<span class="builtintype" id="2060361">bool</span><span class="op" id="2060365">,</span>&nbsp;<span class="ident" id="2060367">f</span>&nbsp;<span class="keyword" id="2060369">func</span><span class="op" id="2060373">(</span><span class="builtintype" id="2060374">rune</span><span class="op" id="2060378">)</span>&nbsp;<span class="builtintype" id="2060380">bool</span><span class="op" id="2060384">)</span>&nbsp;<span class="op" id="2060386">(</span><span class="ident" id="2060387">token</span>&nbsp;<span class="op" id="2060393">[</span><span class="op" id="2060394">]</span><span class="builtintype" id="2060395">byte</span><span class="op" id="2060399">,</span>&nbsp;<span class="ident" id="2060401">err</span>&nbsp;<span class="builtintype" id="2060405">error</span><span class="op" id="2060410">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2060413">//&nbsp;Width&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;width&nbsp;option&nbsp;and&nbsp;whether&nbsp;it&nbsp;has&nbsp;been&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2060490">//&nbsp;The&nbsp;unit&nbsp;is&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2060527">Width</span><span class="op" id="2060532">(</span><span class="op" id="2060533">)</span>&nbsp;<span class="op" id="2060535">(</span><span class="ident" id="2060536">wid</span>&nbsp;<span class="builtintype" id="2060540">int</span><span class="op" id="2060543">,</span>&nbsp;<span class="ident" id="2060545">ok</span>&nbsp;<span class="builtintype" id="2060548">bool</span><span class="op" id="2060552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2060555">//&nbsp;Because&nbsp;ReadRune&nbsp;is&nbsp;implemented&nbsp;by&nbsp;the&nbsp;interface,&nbsp;Read&nbsp;should&nbsp;never&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2060630">//&nbsp;called&nbsp;by&nbsp;the&nbsp;scanning&nbsp;routines&nbsp;and&nbsp;a&nbsp;valid&nbsp;implementation&nbsp;of</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2060696">//&nbsp;ScanState&nbsp;may&nbsp;choose&nbsp;always&nbsp;to&nbsp;return&nbsp;an&nbsp;error&nbsp;from&nbsp;Read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2060758">Read</span><span class="op" id="2060762">(</span><span class="ident" id="2060763">buf</span>&nbsp;<span class="op" id="2060767">[</span><span class="op" id="2060768">]</span><span class="builtintype" id="2060769">byte</span><span class="op" id="2060773">)</span>&nbsp;<span class="op" id="2060775">(</span><span class="ident" id="2060776">n</span>&nbsp;<span class="builtintype" id="2060778">int</span><span class="op" id="2060781">,</span>&nbsp;<span class="ident" id="2060783">err</span>&nbsp;<span class="builtintype" id="2060787">error</span><span class="op" id="2060792">)</span><br>
<span class="lineno"></span><span class="op" id="2060794">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2060797">//&nbsp;Scanner&nbsp;is&nbsp;implemented&nbsp;by&nbsp;any&nbsp;value&nbsp;that&nbsp;has&nbsp;a&nbsp;Scan&nbsp;method,&nbsp;which&nbsp;scans</span><br>
<span class="lineno">60</span><span class="comment" id="2060872">//&nbsp;the&nbsp;input&nbsp;for&nbsp;the&nbsp;representation&nbsp;of&nbsp;a&nbsp;value&nbsp;and&nbsp;stores&nbsp;the&nbsp;result&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2060948">//&nbsp;receiver,&nbsp;which&nbsp;must&nbsp;be&nbsp;a&nbsp;pointer&nbsp;to&nbsp;be&nbsp;useful.&nbsp;&nbsp;The&nbsp;Scan&nbsp;method&nbsp;is&nbsp;called</span><br>
<span class="lineno"></span><span class="comment" id="2061026">//&nbsp;for&nbsp;any&nbsp;argument&nbsp;to&nbsp;Scan,&nbsp;Scanf,&nbsp;or&nbsp;Scanln&nbsp;that&nbsp;implements&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="2061092">type</span>&nbsp;<span class="ident" id="2061097">Scanner</span>&nbsp;<span class="keyword" id="2061105">interface</span>&nbsp;<span class="op" id="2061115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2061118">Scan</span><span class="op" id="2061122">(</span><span class="ident" id="2061123">state</span>&nbsp;<span class="ident" id="2061129">ScanState</span><span class="op" id="2061138">,</span>&nbsp;<span class="ident" id="2061140">verb</span>&nbsp;<span class="builtintype" id="2061145">rune</span><span class="op" id="2061149">)</span>&nbsp;<span class="builtintype" id="2061151">error</span><br>
<span class="lineno">65</span><span class="op" id="2061157">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2061160">//&nbsp;Scan&nbsp;scans&nbsp;text&nbsp;read&nbsp;from&nbsp;standard&nbsp;input,&nbsp;storing&nbsp;successive</span><br>
<span class="lineno"></span><span class="comment" id="2061224">//&nbsp;space-separated&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments.&nbsp;&nbsp;Newlines&nbsp;count</span><br>
<span class="lineno"></span><span class="comment" id="2061293">//&nbsp;as&nbsp;space.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;scanned.</span><br>
<span class="lineno">70</span><span class="comment" id="2061360">//&nbsp;If&nbsp;that&nbsp;is&nbsp;less&nbsp;than&nbsp;the&nbsp;number&nbsp;of&nbsp;arguments,&nbsp;err&nbsp;will&nbsp;report&nbsp;why.</span><br>
<span class="lineno"></span><span class="keyword" id="2061430">func</span>&nbsp;<span class="ident" id="2061435">Scan</span><span class="op" id="2061439">(</span><span class="ident" id="2061440">a</span>&nbsp;<span class="op" id="2061442">...</span><span class="keyword" id="2061445">interface</span><span class="op" id="2061454">{</span><span class="op" id="2061455">}</span><span class="op" id="2061456">)</span>&nbsp;<span class="op" id="2061458">(</span><span class="ident" id="2061459">n</span>&nbsp;<span class="builtintype" id="2061461">int</span><span class="op" id="2061464">,</span>&nbsp;<span class="ident" id="2061466">err</span>&nbsp;<span class="builtintype" id="2061470">error</span><span class="op" id="2061475">)</span>&nbsp;<span class="op" id="2061477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2061480">return</span>&nbsp;<span class="ident" id="2061487">Fscan</span><span class="op" id="2061492">(</span><span class="ident" id="2061493">os</span><span class="op" id="2061495">.</span><span class="ident" id="2061496">Stdin</span><span class="op" id="2061501">,</span>&nbsp;<span class="ident" id="2061503">a</span><span class="op" id="2061504">...</span><span class="op" id="2061507">)</span><br>
<span class="lineno"></span><span class="op" id="2061509">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="2061512">//&nbsp;Scanln&nbsp;is&nbsp;similar&nbsp;to&nbsp;Scan,&nbsp;but&nbsp;stops&nbsp;scanning&nbsp;at&nbsp;a&nbsp;newline&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2061578">//&nbsp;after&nbsp;the&nbsp;final&nbsp;item&nbsp;there&nbsp;must&nbsp;be&nbsp;a&nbsp;newline&nbsp;or&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="keyword" id="2061634">func</span>&nbsp;<span class="ident" id="2061639">Scanln</span><span class="op" id="2061645">(</span><span class="ident" id="2061646">a</span>&nbsp;<span class="op" id="2061648">...</span><span class="keyword" id="2061651">interface</span><span class="op" id="2061660">{</span><span class="op" id="2061661">}</span><span class="op" id="2061662">)</span>&nbsp;<span class="op" id="2061664">(</span><span class="ident" id="2061665">n</span>&nbsp;<span class="builtintype" id="2061667">int</span><span class="op" id="2061670">,</span>&nbsp;<span class="ident" id="2061672">err</span>&nbsp;<span class="builtintype" id="2061676">error</span><span class="op" id="2061681">)</span>&nbsp;<span class="op" id="2061683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2061686">return</span>&nbsp;<span class="ident" id="2061693">Fscanln</span><span class="op" id="2061700">(</span><span class="ident" id="2061701">os</span><span class="op" id="2061703">.</span><span class="ident" id="2061704">Stdin</span><span class="op" id="2061709">,</span>&nbsp;<span class="ident" id="2061711">a</span><span class="op" id="2061712">...</span><span class="op" id="2061715">)</span><br>
<span class="lineno"></span><span class="op" id="2061717">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="2061720">//&nbsp;Scanf&nbsp;scans&nbsp;text&nbsp;read&nbsp;from&nbsp;standard&nbsp;input,&nbsp;storing&nbsp;successive</span><br>
<span class="lineno"></span><span class="comment" id="2061785">//&nbsp;space-separated&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments&nbsp;as&nbsp;determined&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2061854">//&nbsp;the&nbsp;format.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;scanned.</span><br>
<span class="lineno"></span><span class="keyword" id="2061923">func</span>&nbsp;<span class="ident" id="2061928">Scanf</span><span class="op" id="2061933">(</span><span class="ident" id="2061934">format</span>&nbsp;<span class="builtintype" id="2061941">string</span><span class="op" id="2061947">,</span>&nbsp;<span class="ident" id="2061949">a</span>&nbsp;<span class="op" id="2061951">...</span><span class="keyword" id="2061954">interface</span><span class="op" id="2061963">{</span><span class="op" id="2061964">}</span><span class="op" id="2061965">)</span>&nbsp;<span class="op" id="2061967">(</span><span class="ident" id="2061968">n</span>&nbsp;<span class="builtintype" id="2061970">int</span><span class="op" id="2061973">,</span>&nbsp;<span class="ident" id="2061975">err</span>&nbsp;<span class="builtintype" id="2061979">error</span><span class="op" id="2061984">)</span>&nbsp;<span class="op" id="2061986">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2061989">return</span>&nbsp;<span class="ident" id="2061996">Fscanf</span><span class="op" id="2062002">(</span><span class="ident" id="2062003">os</span><span class="op" id="2062005">.</span><span class="ident" id="2062006">Stdin</span><span class="op" id="2062011">,</span>&nbsp;<span class="ident" id="2062013">format</span><span class="op" id="2062019">,</span>&nbsp;<span class="ident" id="2062021">a</span><span class="op" id="2062022">...</span><span class="op" id="2062025">)</span><br>
<span class="lineno"></span><span class="op" id="2062027">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2062030">type</span>&nbsp;<span class="ident" id="2062035">stringReader</span>&nbsp;<span class="builtintype" id="2062048">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="2062056">func</span>&nbsp;<span class="op" id="2062061">(</span><span class="ident" id="2062062">r</span>&nbsp;<span class="op" id="2062064">*</span><span class="ident" id="2062065">stringReader</span><span class="op" id="2062077">)</span>&nbsp;<span class="ident" id="2062079">Read</span><span class="op" id="2062083">(</span><span class="ident" id="2062084">b</span>&nbsp;<span class="op" id="2062086">[</span><span class="op" id="2062087">]</span><span class="builtintype" id="2062088">byte</span><span class="op" id="2062092">)</span>&nbsp;<span class="op" id="2062094">(</span><span class="ident" id="2062095">n</span>&nbsp;<span class="builtintype" id="2062097">int</span><span class="op" id="2062100">,</span>&nbsp;<span class="ident" id="2062102">err</span>&nbsp;<span class="builtintype" id="2062106">error</span><span class="op" id="2062111">)</span>&nbsp;<span class="op" id="2062113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2062116">n</span>&nbsp;<span class="op" id="2062118">=</span>&nbsp;<span class="builtinfunc" id="2062120">copy</span><span class="op" id="2062124">(</span><span class="ident" id="2062125">b</span><span class="op" id="2062126">,</span>&nbsp;<span class="op" id="2062128">*</span><span class="ident" id="2062129">r</span><span class="op" id="2062130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2062133">*</span><span class="ident" id="2062134">r</span>&nbsp;<span class="op" id="2062136">=</span>&nbsp;<span class="op" id="2062138">(</span><span class="op" id="2062139">*</span><span class="ident" id="2062140">r</span><span class="op" id="2062141">)</span><span class="op" id="2062142">[</span><span class="ident" id="2062143">n</span><span class="op" id="2062144">:</span><span class="op" id="2062145">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2062148">if</span>&nbsp;<span class="ident" id="2062151">n</span>&nbsp;<span class="op" id="2062153">==</span>&nbsp;<span class="num" id="2062156">0</span>&nbsp;<span class="op" id="2062158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2062162">err</span>&nbsp;<span class="op" id="2062166">=</span>&nbsp;<span class="ident" id="2062168">io</span><span class="op" id="2062170">.</span><span class="ident" id="2062171">EOF</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2062176">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2062179">return</span><br>
<span class="lineno"></span><span class="op" id="2062186">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2062189">//&nbsp;Sscan&nbsp;scans&nbsp;the&nbsp;argument&nbsp;string,&nbsp;storing&nbsp;successive&nbsp;space-separated</span><br>
<span class="lineno">100</span><span class="comment" id="2062260">//&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments.&nbsp;&nbsp;Newlines&nbsp;count&nbsp;as&nbsp;space.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="2062327">//&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;scanned.&nbsp;&nbsp;If&nbsp;that&nbsp;is&nbsp;less</span><br>
<span class="lineno"></span><span class="comment" id="2062397">//&nbsp;than&nbsp;the&nbsp;number&nbsp;of&nbsp;arguments,&nbsp;err&nbsp;will&nbsp;report&nbsp;why.</span><br>
<span class="lineno"></span><span class="keyword" id="2062451">func</span>&nbsp;<span class="ident" id="2062456">Sscan</span><span class="op" id="2062461">(</span><span class="ident" id="2062462">str</span>&nbsp;<span class="builtintype" id="2062466">string</span><span class="op" id="2062472">,</span>&nbsp;<span class="ident" id="2062474">a</span>&nbsp;<span class="op" id="2062476">...</span><span class="keyword" id="2062479">interface</span><span class="op" id="2062488">{</span><span class="op" id="2062489">}</span><span class="op" id="2062490">)</span>&nbsp;<span class="op" id="2062492">(</span><span class="ident" id="2062493">n</span>&nbsp;<span class="builtintype" id="2062495">int</span><span class="op" id="2062498">,</span>&nbsp;<span class="ident" id="2062500">err</span>&nbsp;<span class="builtintype" id="2062504">error</span><span class="op" id="2062509">)</span>&nbsp;<span class="op" id="2062511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2062514">return</span>&nbsp;<span class="ident" id="2062521">Fscan</span><span class="op" id="2062526">(</span><span class="op" id="2062527">(</span><span class="op" id="2062528">*</span><span class="ident" id="2062529">stringReader</span><span class="op" id="2062541">)</span><span class="op" id="2062542">(</span><span class="op" id="2062543">&amp;</span><span class="ident" id="2062544">str</span><span class="op" id="2062547">)</span><span class="op" id="2062548">,</span>&nbsp;<span class="ident" id="2062550">a</span><span class="op" id="2062551">...</span><span class="op" id="2062554">)</span><br>
<span class="lineno">105</span><span class="op" id="2062556">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2062559">//&nbsp;Sscanln&nbsp;is&nbsp;similar&nbsp;to&nbsp;Sscan,&nbsp;but&nbsp;stops&nbsp;scanning&nbsp;at&nbsp;a&nbsp;newline&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2062627">//&nbsp;after&nbsp;the&nbsp;final&nbsp;item&nbsp;there&nbsp;must&nbsp;be&nbsp;a&nbsp;newline&nbsp;or&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="keyword" id="2062683">func</span>&nbsp;<span class="ident" id="2062688">Sscanln</span><span class="op" id="2062695">(</span><span class="ident" id="2062696">str</span>&nbsp;<span class="builtintype" id="2062700">string</span><span class="op" id="2062706">,</span>&nbsp;<span class="ident" id="2062708">a</span>&nbsp;<span class="op" id="2062710">...</span><span class="keyword" id="2062713">interface</span><span class="op" id="2062722">{</span><span class="op" id="2062723">}</span><span class="op" id="2062724">)</span>&nbsp;<span class="op" id="2062726">(</span><span class="ident" id="2062727">n</span>&nbsp;<span class="builtintype" id="2062729">int</span><span class="op" id="2062732">,</span>&nbsp;<span class="ident" id="2062734">err</span>&nbsp;<span class="builtintype" id="2062738">error</span><span class="op" id="2062743">)</span>&nbsp;<span class="op" id="2062745">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2062748">return</span>&nbsp;<span class="ident" id="2062755">Fscanln</span><span class="op" id="2062762">(</span><span class="op" id="2062763">(</span><span class="op" id="2062764">*</span><span class="ident" id="2062765">stringReader</span><span class="op" id="2062777">)</span><span class="op" id="2062778">(</span><span class="op" id="2062779">&amp;</span><span class="ident" id="2062780">str</span><span class="op" id="2062783">)</span><span class="op" id="2062784">,</span>&nbsp;<span class="ident" id="2062786">a</span><span class="op" id="2062787">...</span><span class="op" id="2062790">)</span><br>
<span class="lineno"></span><span class="op" id="2062792">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2062795">//&nbsp;Sscanf&nbsp;scans&nbsp;the&nbsp;argument&nbsp;string,&nbsp;storing&nbsp;successive&nbsp;space-separated</span><br>
<span class="lineno"></span><span class="comment" id="2062867">//&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments&nbsp;as&nbsp;determined&nbsp;by&nbsp;the&nbsp;format.&nbsp;&nbsp;It</span><br>
<span class="lineno">115</span><span class="comment" id="2062936">//&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;parsed.</span><br>
<span class="lineno"></span><span class="keyword" id="2062988">func</span>&nbsp;<span class="ident" id="2062993">Sscanf</span><span class="op" id="2062999">(</span><span class="ident" id="2063000">str</span>&nbsp;<span class="builtintype" id="2063004">string</span><span class="op" id="2063010">,</span>&nbsp;<span class="ident" id="2063012">format</span>&nbsp;<span class="builtintype" id="2063019">string</span><span class="op" id="2063025">,</span>&nbsp;<span class="ident" id="2063027">a</span>&nbsp;<span class="op" id="2063029">...</span><span class="keyword" id="2063032">interface</span><span class="op" id="2063041">{</span><span class="op" id="2063042">}</span><span class="op" id="2063043">)</span>&nbsp;<span class="op" id="2063045">(</span><span class="ident" id="2063046">n</span>&nbsp;<span class="builtintype" id="2063048">int</span><span class="op" id="2063051">,</span>&nbsp;<span class="ident" id="2063053">err</span>&nbsp;<span class="builtintype" id="2063057">error</span><span class="op" id="2063062">)</span>&nbsp;<span class="op" id="2063064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2063067">return</span>&nbsp;<span class="ident" id="2063074">Fscanf</span><span class="op" id="2063080">(</span><span class="op" id="2063081">(</span><span class="op" id="2063082">*</span><span class="ident" id="2063083">stringReader</span><span class="op" id="2063095">)</span><span class="op" id="2063096">(</span><span class="op" id="2063097">&amp;</span><span class="ident" id="2063098">str</span><span class="op" id="2063101">)</span><span class="op" id="2063102">,</span>&nbsp;<span class="ident" id="2063104">format</span><span class="op" id="2063110">,</span>&nbsp;<span class="ident" id="2063112">a</span><span class="op" id="2063113">...</span><span class="op" id="2063116">)</span><br>
<span class="lineno"></span><span class="op" id="2063118">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="2063121">//&nbsp;Fscan&nbsp;scans&nbsp;text&nbsp;read&nbsp;from&nbsp;r,&nbsp;storing&nbsp;successive&nbsp;space-separated</span><br>
<span class="lineno"></span><span class="comment" id="2063189">//&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments.&nbsp;&nbsp;Newlines&nbsp;count&nbsp;as&nbsp;space.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="2063256">//&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;scanned.&nbsp;&nbsp;If&nbsp;that&nbsp;is&nbsp;less</span><br>
<span class="lineno"></span><span class="comment" id="2063326">//&nbsp;than&nbsp;the&nbsp;number&nbsp;of&nbsp;arguments,&nbsp;err&nbsp;will&nbsp;report&nbsp;why.</span><br>
<span class="lineno"></span><span class="keyword" id="2063380">func</span>&nbsp;<span class="ident" id="2063385">Fscan</span><span class="op" id="2063390">(</span><span class="ident" id="2063391">r</span>&nbsp;<span class="ident" id="2063393">io</span><span class="op" id="2063395">.</span><span class="ident" id="2063396">Reader</span><span class="op" id="2063402">,</span>&nbsp;<span class="ident" id="2063404">a</span>&nbsp;<span class="op" id="2063406">...</span><span class="keyword" id="2063409">interface</span><span class="op" id="2063418">{</span><span class="op" id="2063419">}</span><span class="op" id="2063420">)</span>&nbsp;<span class="op" id="2063422">(</span><span class="ident" id="2063423">n</span>&nbsp;<span class="builtintype" id="2063425">int</span><span class="op" id="2063428">,</span>&nbsp;<span class="ident" id="2063430">err</span>&nbsp;<span class="builtintype" id="2063434">error</span><span class="op" id="2063439">)</span>&nbsp;<span class="op" id="2063441">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2063444">s</span><span class="op" id="2063445">,</span>&nbsp;<span class="ident" id="2063447">old</span>&nbsp;<span class="op" id="2063451">:=</span>&nbsp;<span class="ident" id="2063454">newScanState</span><span class="op" id="2063466">(</span><span class="ident" id="2063467">r</span><span class="op" id="2063468">,</span>&nbsp;<span class="builtintype" id="2063470">true</span><span class="op" id="2063474">,</span>&nbsp;<span class="builtintype" id="2063476">false</span><span class="op" id="2063481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2063484">n</span><span class="op" id="2063485">,</span>&nbsp;<span class="ident" id="2063487">err</span>&nbsp;<span class="op" id="2063491">=</span>&nbsp;<span class="ident" id="2063493">s</span><span class="op" id="2063494">.</span><span class="ident" id="2063495">doScan</span><span class="op" id="2063501">(</span><span class="ident" id="2063502">a</span><span class="op" id="2063503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2063506">s</span><span class="op" id="2063507">.</span><span class="ident" id="2063508">free</span><span class="op" id="2063512">(</span><span class="ident" id="2063513">old</span><span class="op" id="2063516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2063519">return</span><br>
<span class="lineno"></span><span class="op" id="2063526">}</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span><span class="comment" id="2063529">//&nbsp;Fscanln&nbsp;is&nbsp;similar&nbsp;to&nbsp;Fscan,&nbsp;but&nbsp;stops&nbsp;scanning&nbsp;at&nbsp;a&nbsp;newline&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2063597">//&nbsp;after&nbsp;the&nbsp;final&nbsp;item&nbsp;there&nbsp;must&nbsp;be&nbsp;a&nbsp;newline&nbsp;or&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="keyword" id="2063653">func</span>&nbsp;<span class="ident" id="2063658">Fscanln</span><span class="op" id="2063665">(</span><span class="ident" id="2063666">r</span>&nbsp;<span class="ident" id="2063668">io</span><span class="op" id="2063670">.</span><span class="ident" id="2063671">Reader</span><span class="op" id="2063677">,</span>&nbsp;<span class="ident" id="2063679">a</span>&nbsp;<span class="op" id="2063681">...</span><span class="keyword" id="2063684">interface</span><span class="op" id="2063693">{</span><span class="op" id="2063694">}</span><span class="op" id="2063695">)</span>&nbsp;<span class="op" id="2063697">(</span><span class="ident" id="2063698">n</span>&nbsp;<span class="builtintype" id="2063700">int</span><span class="op" id="2063703">,</span>&nbsp;<span class="ident" id="2063705">err</span>&nbsp;<span class="builtintype" id="2063709">error</span><span class="op" id="2063714">)</span>&nbsp;<span class="op" id="2063716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2063719">s</span><span class="op" id="2063720">,</span>&nbsp;<span class="ident" id="2063722">old</span>&nbsp;<span class="op" id="2063726">:=</span>&nbsp;<span class="ident" id="2063729">newScanState</span><span class="op" id="2063741">(</span><span class="ident" id="2063742">r</span><span class="op" id="2063743">,</span>&nbsp;<span class="builtintype" id="2063745">false</span><span class="op" id="2063750">,</span>&nbsp;<span class="builtintype" id="2063752">true</span><span class="op" id="2063756">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2063759">n</span><span class="op" id="2063760">,</span>&nbsp;<span class="ident" id="2063762">err</span>&nbsp;<span class="op" id="2063766">=</span>&nbsp;<span class="ident" id="2063768">s</span><span class="op" id="2063769">.</span><span class="ident" id="2063770">doScan</span><span class="op" id="2063776">(</span><span class="ident" id="2063777">a</span><span class="op" id="2063778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2063781">s</span><span class="op" id="2063782">.</span><span class="ident" id="2063783">free</span><span class="op" id="2063787">(</span><span class="ident" id="2063788">old</span><span class="op" id="2063791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2063794">return</span><br>
<span class="lineno"></span><span class="op" id="2063801">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="comment" id="2063804">//&nbsp;Fscanf&nbsp;scans&nbsp;text&nbsp;read&nbsp;from&nbsp;r,&nbsp;storing&nbsp;successive&nbsp;space-separated</span><br>
<span class="lineno"></span><span class="comment" id="2063873">//&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments&nbsp;as&nbsp;determined&nbsp;by&nbsp;the&nbsp;format.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="2063942">//&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;parsed.</span><br>
<span class="lineno"></span><span class="keyword" id="2063994">func</span>&nbsp;<span class="ident" id="2063999">Fscanf</span><span class="op" id="2064005">(</span><span class="ident" id="2064006">r</span>&nbsp;<span class="ident" id="2064008">io</span><span class="op" id="2064010">.</span><span class="ident" id="2064011">Reader</span><span class="op" id="2064017">,</span>&nbsp;<span class="ident" id="2064019">format</span>&nbsp;<span class="builtintype" id="2064026">string</span><span class="op" id="2064032">,</span>&nbsp;<span class="ident" id="2064034">a</span>&nbsp;<span class="op" id="2064036">...</span><span class="keyword" id="2064039">interface</span><span class="op" id="2064048">{</span><span class="op" id="2064049">}</span><span class="op" id="2064050">)</span>&nbsp;<span class="op" id="2064052">(</span><span class="ident" id="2064053">n</span>&nbsp;<span class="builtintype" id="2064055">int</span><span class="op" id="2064058">,</span>&nbsp;<span class="ident" id="2064060">err</span>&nbsp;<span class="builtintype" id="2064064">error</span><span class="op" id="2064069">)</span>&nbsp;<span class="op" id="2064071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2064074">s</span><span class="op" id="2064075">,</span>&nbsp;<span class="ident" id="2064077">old</span>&nbsp;<span class="op" id="2064081">:=</span>&nbsp;<span class="ident" id="2064084">newScanState</span><span class="op" id="2064096">(</span><span class="ident" id="2064097">r</span><span class="op" id="2064098">,</span>&nbsp;<span class="builtintype" id="2064100">false</span><span class="op" id="2064105">,</span>&nbsp;<span class="builtintype" id="2064107">false</span><span class="op" id="2064112">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2064115">n</span><span class="op" id="2064116">,</span>&nbsp;<span class="ident" id="2064118">err</span>&nbsp;<span class="op" id="2064122">=</span>&nbsp;<span class="ident" id="2064124">s</span><span class="op" id="2064125">.</span><span class="ident" id="2064126">doScanf</span><span class="op" id="2064133">(</span><span class="ident" id="2064134">format</span><span class="op" id="2064140">,</span>&nbsp;<span class="ident" id="2064142">a</span><span class="op" id="2064143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2064146">s</span><span class="op" id="2064147">.</span><span class="ident" id="2064148">free</span><span class="op" id="2064152">(</span><span class="ident" id="2064153">old</span><span class="op" id="2064156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2064159">return</span><br>
<span class="lineno"></span><span class="op" id="2064166">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="comment" id="2064169">//&nbsp;scanError&nbsp;represents&nbsp;an&nbsp;error&nbsp;generated&nbsp;by&nbsp;the&nbsp;scanning&nbsp;software.</span><br>
<span class="lineno"></span><span class="comment" id="2064238">//&nbsp;It&#39;s&nbsp;used&nbsp;as&nbsp;a&nbsp;unique&nbsp;signature&nbsp;to&nbsp;identify&nbsp;such&nbsp;errors&nbsp;when&nbsp;recovering.</span><br>
<span class="lineno"></span><span class="keyword" id="2064314">type</span>&nbsp;<span class="ident" id="2064319">scanError</span>&nbsp;<span class="keyword" id="2064329">struct</span>&nbsp;<span class="op" id="2064336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2064339">err</span>&nbsp;<span class="builtintype" id="2064343">error</span><br>
<span class="lineno"></span><span class="op" id="2064349">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="keyword" id="2064352">const</span>&nbsp;<span class="ident" id="2064358">eof</span>&nbsp;<span class="op" id="2064362">=</span>&nbsp;<span class="op" id="2064364">-</span><span class="num" id="2064365">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2064368">//&nbsp;ss&nbsp;is&nbsp;the&nbsp;internal&nbsp;implementation&nbsp;of&nbsp;ScanState.</span><br>
<span class="lineno"></span><span class="keyword" id="2064419">type</span>&nbsp;<span class="ident" id="2064424">ss</span>&nbsp;<span class="keyword" id="2064427">struct</span>&nbsp;<span class="op" id="2064434">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2064437">rr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2064446">io</span><span class="op" id="2064448">.</span><span class="ident" id="2064449">RuneReader</span>&nbsp;<span class="comment" id="2064460">//&nbsp;where&nbsp;to&nbsp;read&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2064484">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2064493">buffer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2064507">//&nbsp;token&nbsp;accumulator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2064529">peekRune</span>&nbsp;<span class="builtintype" id="2064538">rune</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2064552">//&nbsp;one-rune&nbsp;lookahead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2064575">prevRune</span>&nbsp;<span class="builtintype" id="2064584">rune</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2064598">//&nbsp;last&nbsp;rune&nbsp;returned&nbsp;by&nbsp;ReadRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2064633">count</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2064642">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2064656">//&nbsp;runes&nbsp;consumed&nbsp;so&nbsp;far.</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2064683">atEOF</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2064692">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2064706">//&nbsp;already&nbsp;read&nbsp;EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2064727">ssave</span><br>
<span class="lineno"></span><span class="op" id="2064733">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2064736">//&nbsp;ssave&nbsp;holds&nbsp;the&nbsp;parts&nbsp;of&nbsp;ss&nbsp;that&nbsp;need&nbsp;to&nbsp;be</span><br>
<span class="lineno">170</span><span class="comment" id="2064783">//&nbsp;saved&nbsp;and&nbsp;restored&nbsp;on&nbsp;recursive&nbsp;scans.</span><br>
<span class="lineno"></span><span class="keyword" id="2064825">type</span>&nbsp;<span class="ident" id="2064830">ssave</span>&nbsp;<span class="keyword" id="2064836">struct</span>&nbsp;<span class="op" id="2064843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2064846">validSave</span>&nbsp;<span class="builtintype" id="2064856">bool</span>&nbsp;<span class="comment" id="2064861">//&nbsp;is&nbsp;or&nbsp;was&nbsp;a&nbsp;part&nbsp;of&nbsp;an&nbsp;actual&nbsp;ss.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2064899">nlIsEnd</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2064909">bool</span>&nbsp;<span class="comment" id="2064914">//&nbsp;whether&nbsp;newline&nbsp;terminates&nbsp;scan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2064950">nlIsSpace</span>&nbsp;<span class="builtintype" id="2064960">bool</span>&nbsp;<span class="comment" id="2064965">//&nbsp;whether&nbsp;newline&nbsp;counts&nbsp;as&nbsp;white&nbsp;space</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2065007">argLimit</span>&nbsp;&nbsp;<span class="builtintype" id="2065017">int</span>&nbsp;&nbsp;<span class="comment" id="2065022">//&nbsp;max&nbsp;value&nbsp;of&nbsp;ss.count&nbsp;for&nbsp;this&nbsp;arg;&nbsp;argLimit&nbsp;&lt;=&nbsp;limit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2065080">limit</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2065090">int</span>&nbsp;&nbsp;<span class="comment" id="2065095">//&nbsp;max&nbsp;value&nbsp;of&nbsp;ss.count.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2065122">maxWid</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2065132">int</span>&nbsp;&nbsp;<span class="comment" id="2065137">//&nbsp;width&nbsp;of&nbsp;this&nbsp;arg.</span><br>
<span class="lineno"></span><span class="op" id="2065159">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="comment" id="2065162">//&nbsp;The&nbsp;Read&nbsp;method&nbsp;is&nbsp;only&nbsp;in&nbsp;ScanState&nbsp;so&nbsp;that&nbsp;ScanState</span><br>
<span class="lineno"></span><span class="comment" id="2065220">//&nbsp;satisfies&nbsp;io.Reader.&nbsp;It&nbsp;will&nbsp;never&nbsp;be&nbsp;called&nbsp;when&nbsp;used&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="2065281">//&nbsp;intended,&nbsp;so&nbsp;there&nbsp;is&nbsp;no&nbsp;need&nbsp;to&nbsp;make&nbsp;it&nbsp;actually&nbsp;work.</span><br>
<span class="lineno"></span><span class="keyword" id="2065340">func</span>&nbsp;<span class="op" id="2065345">(</span><span class="ident" id="2065346">s</span>&nbsp;<span class="op" id="2065348">*</span><span class="ident" id="2065349">ss</span><span class="op" id="2065351">)</span>&nbsp;<span class="ident" id="2065353">Read</span><span class="op" id="2065357">(</span><span class="ident" id="2065358">buf</span>&nbsp;<span class="op" id="2065362">[</span><span class="op" id="2065363">]</span><span class="builtintype" id="2065364">byte</span><span class="op" id="2065368">)</span>&nbsp;<span class="op" id="2065370">(</span><span class="ident" id="2065371">n</span>&nbsp;<span class="builtintype" id="2065373">int</span><span class="op" id="2065376">,</span>&nbsp;<span class="ident" id="2065378">err</span>&nbsp;<span class="builtintype" id="2065382">error</span><span class="op" id="2065387">)</span>&nbsp;<span class="op" id="2065389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2065392">return</span>&nbsp;<span class="num" id="2065399">0</span><span class="op" id="2065400">,</span>&nbsp;<span class="ident" id="2065402">errors</span><span class="op" id="2065408">.</span><span class="ident" id="2065409">New</span><span class="op" id="2065412">(</span><span class="string" id="2065413">&#34;ScanState&#39;s&nbsp;Read&nbsp;should&nbsp;not&nbsp;be&nbsp;called.&nbsp;Use&nbsp;ReadRune&#34;</span><span class="op" id="2065466">)</span><br>
<span class="lineno">185</span><span class="op" id="2065468">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2065471">func</span>&nbsp;<span class="op" id="2065476">(</span><span class="ident" id="2065477">s</span>&nbsp;<span class="op" id="2065479">*</span><span class="ident" id="2065480">ss</span><span class="op" id="2065482">)</span>&nbsp;<span class="ident" id="2065484">ReadRune</span><span class="op" id="2065492">(</span><span class="op" id="2065493">)</span>&nbsp;<span class="op" id="2065495">(</span><span class="ident" id="2065496">r</span>&nbsp;<span class="builtintype" id="2065498">rune</span><span class="op" id="2065502">,</span>&nbsp;<span class="ident" id="2065504">size</span>&nbsp;<span class="builtintype" id="2065509">int</span><span class="op" id="2065512">,</span>&nbsp;<span class="ident" id="2065514">err</span>&nbsp;<span class="builtintype" id="2065518">error</span><span class="op" id="2065523">)</span>&nbsp;<span class="op" id="2065525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2065528">if</span>&nbsp;<span class="ident" id="2065531">s</span><span class="op" id="2065532">.</span><span class="ident" id="2065533">peekRune</span>&nbsp;<span class="op" id="2065542">&gt;=</span>&nbsp;<span class="num" id="2065545">0</span>&nbsp;<span class="op" id="2065547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2065551">s</span><span class="op" id="2065552">.</span><span class="ident" id="2065553">count</span><span class="op" id="2065558">++</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2065563">r</span>&nbsp;<span class="op" id="2065565">=</span>&nbsp;<span class="ident" id="2065567">s</span><span class="op" id="2065568">.</span><span class="ident" id="2065569">peekRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2065580">size</span>&nbsp;<span class="op" id="2065585">=</span>&nbsp;<span class="ident" id="2065587">utf8</span><span class="op" id="2065591">.</span><span class="ident" id="2065592">RuneLen</span><span class="op" id="2065599">(</span><span class="ident" id="2065600">r</span><span class="op" id="2065601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2065605">s</span><span class="op" id="2065606">.</span><span class="ident" id="2065607">prevRune</span>&nbsp;<span class="op" id="2065616">=</span>&nbsp;<span class="ident" id="2065618">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2065622">s</span><span class="op" id="2065623">.</span><span class="ident" id="2065624">peekRune</span>&nbsp;<span class="op" id="2065633">=</span>&nbsp;<span class="op" id="2065635">-</span><span class="num" id="2065636">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2065640">return</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2065648">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2065651">if</span>&nbsp;<span class="ident" id="2065654">s</span><span class="op" id="2065655">.</span><span class="ident" id="2065656">atEOF</span>&nbsp;<span class="op" id="2065662">||</span>&nbsp;<span class="ident" id="2065665">s</span><span class="op" id="2065666">.</span><span class="ident" id="2065667">nlIsEnd</span>&nbsp;<span class="op" id="2065675">&amp;&amp;</span>&nbsp;<span class="ident" id="2065678">s</span><span class="op" id="2065679">.</span><span class="ident" id="2065680">prevRune</span>&nbsp;<span class="op" id="2065689">==</span>&nbsp;<span class="string" id="2065692">&#39;\n&#39;</span>&nbsp;<span class="op" id="2065697">||</span>&nbsp;<span class="ident" id="2065700">s</span><span class="op" id="2065701">.</span><span class="ident" id="2065702">count</span>&nbsp;<span class="op" id="2065708">&gt;=</span>&nbsp;<span class="ident" id="2065711">s</span><span class="op" id="2065712">.</span><span class="ident" id="2065713">argLimit</span>&nbsp;<span class="op" id="2065722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2065726">err</span>&nbsp;<span class="op" id="2065730">=</span>&nbsp;<span class="ident" id="2065732">io</span><span class="op" id="2065734">.</span><span class="ident" id="2065735">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2065741">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2065749">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2065753">r</span><span class="op" id="2065754">,</span>&nbsp;<span class="ident" id="2065756">size</span><span class="op" id="2065760">,</span>&nbsp;<span class="ident" id="2065762">err</span>&nbsp;<span class="op" id="2065766">=</span>&nbsp;<span class="ident" id="2065768">s</span><span class="op" id="2065769">.</span><span class="ident" id="2065770">rr</span><span class="op" id="2065772">.</span><span class="ident" id="2065773">ReadRune</span><span class="op" id="2065781">(</span><span class="op" id="2065782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2065785">if</span>&nbsp;<span class="ident" id="2065788">err</span>&nbsp;<span class="op" id="2065792">==</span>&nbsp;<span class="ident" id="2065795">nil</span>&nbsp;<span class="op" id="2065799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2065803">s</span><span class="op" id="2065804">.</span><span class="ident" id="2065805">count</span><span class="op" id="2065810">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2065815">s</span><span class="op" id="2065816">.</span><span class="ident" id="2065817">prevRune</span>&nbsp;<span class="op" id="2065826">=</span>&nbsp;<span class="ident" id="2065828">r</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2065831">}</span>&nbsp;<span class="keyword" id="2065833">else</span>&nbsp;<span class="keyword" id="2065838">if</span>&nbsp;<span class="ident" id="2065841">err</span>&nbsp;<span class="op" id="2065845">==</span>&nbsp;<span class="ident" id="2065848">io</span><span class="op" id="2065850">.</span><span class="ident" id="2065851">EOF</span>&nbsp;<span class="op" id="2065855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2065859">s</span><span class="op" id="2065860">.</span><span class="ident" id="2065861">atEOF</span>&nbsp;<span class="op" id="2065867">=</span>&nbsp;<span class="builtintype" id="2065869">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2065875">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2065878">return</span><br>
<span class="lineno"></span><span class="op" id="2065885">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="keyword" id="2065888">func</span>&nbsp;<span class="op" id="2065893">(</span><span class="ident" id="2065894">s</span>&nbsp;<span class="op" id="2065896">*</span><span class="ident" id="2065897">ss</span><span class="op" id="2065899">)</span>&nbsp;<span class="ident" id="2065901">Width</span><span class="op" id="2065906">(</span><span class="op" id="2065907">)</span>&nbsp;<span class="op" id="2065909">(</span><span class="ident" id="2065910">wid</span>&nbsp;<span class="builtintype" id="2065914">int</span><span class="op" id="2065917">,</span>&nbsp;<span class="ident" id="2065919">ok</span>&nbsp;<span class="builtintype" id="2065922">bool</span><span class="op" id="2065926">)</span>&nbsp;<span class="op" id="2065928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2065931">if</span>&nbsp;<span class="ident" id="2065934">s</span><span class="op" id="2065935">.</span><span class="ident" id="2065936">maxWid</span>&nbsp;<span class="op" id="2065943">==</span>&nbsp;<span class="ident" id="2065946">hugeWid</span>&nbsp;<span class="op" id="2065954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2065958">return</span>&nbsp;<span class="num" id="2065965">0</span><span class="op" id="2065966">,</span>&nbsp;<span class="builtintype" id="2065968">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2065975">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2065978">return</span>&nbsp;<span class="ident" id="2065985">s</span><span class="op" id="2065986">.</span><span class="ident" id="2065987">maxWid</span><span class="op" id="2065993">,</span>&nbsp;<span class="builtintype" id="2065995">true</span><br>
<span class="lineno"></span><span class="op" id="2066000">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2066003">//&nbsp;The&nbsp;public&nbsp;method&nbsp;returns&nbsp;an&nbsp;error;&nbsp;this&nbsp;private&nbsp;one&nbsp;panics.</span><br>
<span class="lineno"></span><span class="comment" id="2066067">//&nbsp;If&nbsp;getRune&nbsp;reaches&nbsp;EOF,&nbsp;the&nbsp;return&nbsp;value&nbsp;is&nbsp;EOF&nbsp;(-1).</span><br>
<span class="lineno">220</span><span class="keyword" id="2066124">func</span>&nbsp;<span class="op" id="2066129">(</span><span class="ident" id="2066130">s</span>&nbsp;<span class="op" id="2066132">*</span><span class="ident" id="2066133">ss</span><span class="op" id="2066135">)</span>&nbsp;<span class="ident" id="2066137">getRune</span><span class="op" id="2066144">(</span><span class="op" id="2066145">)</span>&nbsp;<span class="op" id="2066147">(</span><span class="ident" id="2066148">r</span>&nbsp;<span class="builtintype" id="2066150">rune</span><span class="op" id="2066154">)</span>&nbsp;<span class="op" id="2066156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2066159">r</span><span class="op" id="2066160">,</span>&nbsp;<span class="ident" id="2066162">_</span><span class="op" id="2066163">,</span>&nbsp;<span class="ident" id="2066165">err</span>&nbsp;<span class="op" id="2066169">:=</span>&nbsp;<span class="ident" id="2066172">s</span><span class="op" id="2066173">.</span><span class="ident" id="2066174">ReadRune</span><span class="op" id="2066182">(</span><span class="op" id="2066183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2066186">if</span>&nbsp;<span class="ident" id="2066189">err</span>&nbsp;<span class="op" id="2066193">!=</span>&nbsp;<span class="ident" id="2066196">nil</span>&nbsp;<span class="op" id="2066200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2066204">if</span>&nbsp;<span class="ident" id="2066207">err</span>&nbsp;<span class="op" id="2066211">==</span>&nbsp;<span class="ident" id="2066214">io</span><span class="op" id="2066216">.</span><span class="ident" id="2066217">EOF</span>&nbsp;<span class="op" id="2066221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2066226">return</span>&nbsp;<span class="ident" id="2066233">eof</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2066239">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2066243">s</span><span class="op" id="2066244">.</span><span class="builtintype" id="2066245">error</span><span class="op" id="2066250">(</span><span class="ident" id="2066251">err</span><span class="op" id="2066254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2066257">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2066260">return</span><br>
<span class="lineno"></span><span class="op" id="2066267">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="comment" id="2066270">//&nbsp;mustReadRune&nbsp;turns&nbsp;io.EOF&nbsp;into&nbsp;a&nbsp;panic(io.ErrUnexpectedEOF).</span><br>
<span class="lineno"></span><span class="comment" id="2066334">//&nbsp;It&nbsp;is&nbsp;called&nbsp;in&nbsp;cases&nbsp;such&nbsp;as&nbsp;string&nbsp;scanning&nbsp;where&nbsp;an&nbsp;EOF&nbsp;is&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="2066401">//&nbsp;syntax&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="2066418">func</span>&nbsp;<span class="op" id="2066423">(</span><span class="ident" id="2066424">s</span>&nbsp;<span class="op" id="2066426">*</span><span class="ident" id="2066427">ss</span><span class="op" id="2066429">)</span>&nbsp;<span class="ident" id="2066431">mustReadRune</span><span class="op" id="2066443">(</span><span class="op" id="2066444">)</span>&nbsp;<span class="op" id="2066446">(</span><span class="ident" id="2066447">r</span>&nbsp;<span class="builtintype" id="2066449">rune</span><span class="op" id="2066453">)</span>&nbsp;<span class="op" id="2066455">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2066458">r</span>&nbsp;<span class="op" id="2066460">=</span>&nbsp;<span class="ident" id="2066462">s</span><span class="op" id="2066463">.</span><span class="ident" id="2066464">getRune</span><span class="op" id="2066471">(</span><span class="op" id="2066472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2066475">if</span>&nbsp;<span class="ident" id="2066478">r</span>&nbsp;<span class="op" id="2066480">==</span>&nbsp;<span class="ident" id="2066483">eof</span>&nbsp;<span class="op" id="2066487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2066491">s</span><span class="op" id="2066492">.</span><span class="builtintype" id="2066493">error</span><span class="op" id="2066498">(</span><span class="ident" id="2066499">io</span><span class="op" id="2066501">.</span><span class="ident" id="2066502">ErrUnexpectedEOF</span><span class="op" id="2066518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2066521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2066524">return</span><br>
<span class="lineno">240</span><span class="op" id="2066531">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2066534">func</span>&nbsp;<span class="op" id="2066539">(</span><span class="ident" id="2066540">s</span>&nbsp;<span class="op" id="2066542">*</span><span class="ident" id="2066543">ss</span><span class="op" id="2066545">)</span>&nbsp;<span class="ident" id="2066547">UnreadRune</span><span class="op" id="2066557">(</span><span class="op" id="2066558">)</span>&nbsp;<span class="builtintype" id="2066560">error</span>&nbsp;<span class="op" id="2066566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2066569">if</span>&nbsp;<span class="ident" id="2066572">u</span><span class="op" id="2066573">,</span>&nbsp;<span class="ident" id="2066575">ok</span>&nbsp;<span class="op" id="2066578">:=</span>&nbsp;<span class="ident" id="2066581">s</span><span class="op" id="2066582">.</span><span class="ident" id="2066583">rr</span><span class="op" id="2066585">.</span><span class="op" id="2066586">(</span><span class="ident" id="2066587">runeUnreader</span><span class="op" id="2066599">)</span><span class="op" id="2066600">;</span>&nbsp;<span class="ident" id="2066602">ok</span>&nbsp;<span class="op" id="2066605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2066609">u</span><span class="op" id="2066610">.</span><span class="ident" id="2066611">UnreadRune</span><span class="op" id="2066621">(</span><span class="op" id="2066622">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2066625">}</span>&nbsp;<span class="keyword" id="2066627">else</span>&nbsp;<span class="op" id="2066632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2066636">s</span><span class="op" id="2066637">.</span><span class="ident" id="2066638">peekRune</span>&nbsp;<span class="op" id="2066647">=</span>&nbsp;<span class="ident" id="2066649">s</span><span class="op" id="2066650">.</span><span class="ident" id="2066651">prevRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2066661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2066664">s</span><span class="op" id="2066665">.</span><span class="ident" id="2066666">prevRune</span>&nbsp;<span class="op" id="2066675">=</span>&nbsp;<span class="op" id="2066677">-</span><span class="num" id="2066678">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2066681">s</span><span class="op" id="2066682">.</span><span class="ident" id="2066683">count</span><span class="op" id="2066688">--</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2066692">return</span>&nbsp;<span class="ident" id="2066699">nil</span><br>
<span class="lineno"></span><span class="op" id="2066703">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2066706">func</span>&nbsp;<span class="op" id="2066711">(</span><span class="ident" id="2066712">s</span>&nbsp;<span class="op" id="2066714">*</span><span class="ident" id="2066715">ss</span><span class="op" id="2066717">)</span>&nbsp;<span class="builtintype" id="2066719">error</span><span class="op" id="2066724">(</span><span class="ident" id="2066725">err</span>&nbsp;<span class="builtintype" id="2066729">error</span><span class="op" id="2066734">)</span>&nbsp;<span class="op" id="2066736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2066739">panic</span><span class="op" id="2066744">(</span><span class="ident" id="2066745">scanError</span><span class="op" id="2066754">{</span><span class="ident" id="2066755">err</span><span class="op" id="2066758">}</span><span class="op" id="2066759">)</span><br>
<span class="lineno">255</span><span class="op" id="2066761">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2066764">func</span>&nbsp;<span class="op" id="2066769">(</span><span class="ident" id="2066770">s</span>&nbsp;<span class="op" id="2066772">*</span><span class="ident" id="2066773">ss</span><span class="op" id="2066775">)</span>&nbsp;<span class="ident" id="2066777">errorString</span><span class="op" id="2066788">(</span><span class="ident" id="2066789">err</span>&nbsp;<span class="builtintype" id="2066793">string</span><span class="op" id="2066799">)</span>&nbsp;<span class="op" id="2066801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2066804">panic</span><span class="op" id="2066809">(</span><span class="ident" id="2066810">scanError</span><span class="op" id="2066819">{</span><span class="ident" id="2066820">errors</span><span class="op" id="2066826">.</span><span class="ident" id="2066827">New</span><span class="op" id="2066830">(</span><span class="ident" id="2066831">err</span><span class="op" id="2066834">)</span><span class="op" id="2066835">}</span><span class="op" id="2066836">)</span><br>
<span class="lineno"></span><span class="op" id="2066838">}</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="keyword" id="2066841">func</span>&nbsp;<span class="op" id="2066846">(</span><span class="ident" id="2066847">s</span>&nbsp;<span class="op" id="2066849">*</span><span class="ident" id="2066850">ss</span><span class="op" id="2066852">)</span>&nbsp;<span class="ident" id="2066854">Token</span><span class="op" id="2066859">(</span><span class="ident" id="2066860">skipSpace</span>&nbsp;<span class="builtintype" id="2066870">bool</span><span class="op" id="2066874">,</span>&nbsp;<span class="ident" id="2066876">f</span>&nbsp;<span class="keyword" id="2066878">func</span><span class="op" id="2066882">(</span><span class="builtintype" id="2066883">rune</span><span class="op" id="2066887">)</span>&nbsp;<span class="builtintype" id="2066889">bool</span><span class="op" id="2066893">)</span>&nbsp;<span class="op" id="2066895">(</span><span class="ident" id="2066896">tok</span>&nbsp;<span class="op" id="2066900">[</span><span class="op" id="2066901">]</span><span class="builtintype" id="2066902">byte</span><span class="op" id="2066906">,</span>&nbsp;<span class="ident" id="2066908">err</span>&nbsp;<span class="builtintype" id="2066912">error</span><span class="op" id="2066917">)</span>&nbsp;<span class="op" id="2066919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2066922">defer</span>&nbsp;<span class="keyword" id="2066928">func</span><span class="op" id="2066932">(</span><span class="op" id="2066933">)</span>&nbsp;<span class="op" id="2066935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2066939">if</span>&nbsp;<span class="ident" id="2066942">e</span>&nbsp;<span class="op" id="2066944">:=</span>&nbsp;<span class="builtinfunc" id="2066947">recover</span><span class="op" id="2066954">(</span><span class="op" id="2066955">)</span><span class="op" id="2066956">;</span>&nbsp;<span class="ident" id="2066958">e</span>&nbsp;<span class="op" id="2066960">!=</span>&nbsp;<span class="ident" id="2066963">nil</span>&nbsp;<span class="op" id="2066967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2066972">if</span>&nbsp;<span class="ident" id="2066975">se</span><span class="op" id="2066977">,</span>&nbsp;<span class="ident" id="2066979">ok</span>&nbsp;<span class="op" id="2066982">:=</span>&nbsp;<span class="ident" id="2066985">e</span><span class="op" id="2066986">.</span><span class="op" id="2066987">(</span><span class="ident" id="2066988">scanError</span><span class="op" id="2066997">)</span><span class="op" id="2066998">;</span>&nbsp;<span class="ident" id="2067000">ok</span>&nbsp;<span class="op" id="2067003">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2067009">err</span>&nbsp;<span class="op" id="2067013">=</span>&nbsp;<span class="ident" id="2067015">se</span><span class="op" id="2067017">.</span><span class="ident" id="2067018">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2067025">}</span>&nbsp;<span class="keyword" id="2067027">else</span>&nbsp;<span class="op" id="2067032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2067038">panic</span><span class="op" id="2067043">(</span><span class="ident" id="2067044">e</span><span class="op" id="2067045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2067050">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2067054">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2067057">}</span><span class="op" id="2067058">(</span><span class="op" id="2067059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2067062">if</span>&nbsp;<span class="ident" id="2067065">f</span>&nbsp;<span class="op" id="2067067">==</span>&nbsp;<span class="ident" id="2067070">nil</span>&nbsp;<span class="op" id="2067074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2067078">f</span>&nbsp;<span class="op" id="2067080">=</span>&nbsp;<span class="ident" id="2067082">notSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2067092">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2067095">s</span><span class="op" id="2067096">.</span><span class="ident" id="2067097">buf</span>&nbsp;<span class="op" id="2067101">=</span>&nbsp;<span class="ident" id="2067103">s</span><span class="op" id="2067104">.</span><span class="ident" id="2067105">buf</span><span class="op" id="2067108">[</span><span class="op" id="2067109">:</span><span class="num" id="2067110">0</span><span class="op" id="2067111">]</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2067114">tok</span>&nbsp;<span class="op" id="2067118">=</span>&nbsp;<span class="ident" id="2067120">s</span><span class="op" id="2067121">.</span><span class="ident" id="2067122">token</span><span class="op" id="2067127">(</span><span class="ident" id="2067128">skipSpace</span><span class="op" id="2067137">,</span>&nbsp;<span class="ident" id="2067139">f</span><span class="op" id="2067140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2067143">return</span><br>
<span class="lineno"></span><span class="op" id="2067150">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2067153">//&nbsp;space&nbsp;is&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;unicode.White_Space&nbsp;ranges,</span><br>
<span class="lineno">280</span><span class="comment" id="2067207">//&nbsp;to&nbsp;avoid&nbsp;depending&nbsp;on&nbsp;package&nbsp;unicode.</span><br>
<span class="lineno"></span><span class="keyword" id="2067249">var</span>&nbsp;<span class="ident" id="2067253">space</span>&nbsp;<span class="op" id="2067259">=</span>&nbsp;<span class="op" id="2067261">[</span><span class="op" id="2067262">]</span><span class="op" id="2067263">[</span><span class="num" id="2067264">2</span><span class="op" id="2067265">]</span><span class="builtintype" id="2067266">uint16</span><span class="op" id="2067272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2067275">{</span><span class="num" id="2067276">0x0009</span><span class="op" id="2067282">,</span>&nbsp;<span class="num" id="2067284">0x000d</span><span class="op" id="2067290">}</span><span class="op" id="2067291">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2067294">{</span><span class="num" id="2067295">0x0020</span><span class="op" id="2067301">,</span>&nbsp;<span class="num" id="2067303">0x0020</span><span class="op" id="2067309">}</span><span class="op" id="2067310">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2067313">{</span><span class="num" id="2067314">0x0085</span><span class="op" id="2067320">,</span>&nbsp;<span class="num" id="2067322">0x0085</span><span class="op" id="2067328">}</span><span class="op" id="2067329">,</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2067332">{</span><span class="num" id="2067333">0x00a0</span><span class="op" id="2067339">,</span>&nbsp;<span class="num" id="2067341">0x00a0</span><span class="op" id="2067347">}</span><span class="op" id="2067348">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2067351">{</span><span class="num" id="2067352">0x1680</span><span class="op" id="2067358">,</span>&nbsp;<span class="num" id="2067360">0x1680</span><span class="op" id="2067366">}</span><span class="op" id="2067367">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2067370">{</span><span class="num" id="2067371">0x2000</span><span class="op" id="2067377">,</span>&nbsp;<span class="num" id="2067379">0x200a</span><span class="op" id="2067385">}</span><span class="op" id="2067386">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2067389">{</span><span class="num" id="2067390">0x2028</span><span class="op" id="2067396">,</span>&nbsp;<span class="num" id="2067398">0x2029</span><span class="op" id="2067404">}</span><span class="op" id="2067405">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2067408">{</span><span class="num" id="2067409">0x202f</span><span class="op" id="2067415">,</span>&nbsp;<span class="num" id="2067417">0x202f</span><span class="op" id="2067423">}</span><span class="op" id="2067424">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2067427">{</span><span class="num" id="2067428">0x205f</span><span class="op" id="2067434">,</span>&nbsp;<span class="num" id="2067436">0x205f</span><span class="op" id="2067442">}</span><span class="op" id="2067443">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2067446">{</span><span class="num" id="2067447">0x3000</span><span class="op" id="2067453">,</span>&nbsp;<span class="num" id="2067455">0x3000</span><span class="op" id="2067461">}</span><span class="op" id="2067462">,</span><br>
<span class="lineno"></span><span class="op" id="2067464">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2067467">func</span>&nbsp;<span class="ident" id="2067472">isSpace</span><span class="op" id="2067479">(</span><span class="ident" id="2067480">r</span>&nbsp;<span class="builtintype" id="2067482">rune</span><span class="op" id="2067486">)</span>&nbsp;<span class="builtintype" id="2067488">bool</span>&nbsp;<span class="op" id="2067493">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2067496">if</span>&nbsp;<span class="ident" id="2067499">r</span>&nbsp;<span class="op" id="2067501">&gt;=</span>&nbsp;<span class="num" id="2067504">1</span><span class="op" id="2067505">&lt;&lt;</span><span class="num" id="2067507">16</span>&nbsp;<span class="op" id="2067510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2067514">return</span>&nbsp;<span class="builtintype" id="2067521">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2067528">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2067531">rx</span>&nbsp;<span class="op" id="2067534">:=</span>&nbsp;<span class="builtintype" id="2067537">uint16</span><span class="op" id="2067543">(</span><span class="ident" id="2067544">r</span><span class="op" id="2067545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2067548">for</span>&nbsp;<span class="ident" id="2067552">_</span><span class="op" id="2067553">,</span>&nbsp;<span class="ident" id="2067555">rng</span>&nbsp;<span class="op" id="2067559">:=</span>&nbsp;<span class="keyword" id="2067562">range</span>&nbsp;<span class="ident" id="2067568">space</span>&nbsp;<span class="op" id="2067574">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2067578">if</span>&nbsp;<span class="ident" id="2067581">rx</span>&nbsp;<span class="op" id="2067584">&lt;</span>&nbsp;<span class="ident" id="2067586">rng</span><span class="op" id="2067589">[</span><span class="num" id="2067590">0</span><span class="op" id="2067591">]</span>&nbsp;<span class="op" id="2067593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2067598">return</span>&nbsp;<span class="builtintype" id="2067605">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2067613">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2067617">if</span>&nbsp;<span class="ident" id="2067620">rx</span>&nbsp;<span class="op" id="2067623">&lt;=</span>&nbsp;<span class="ident" id="2067626">rng</span><span class="op" id="2067629">[</span><span class="num" id="2067630">1</span><span class="op" id="2067631">]</span>&nbsp;<span class="op" id="2067633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2067638">return</span>&nbsp;<span class="builtintype" id="2067645">true</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2067652">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2067655">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2067658">return</span>&nbsp;<span class="builtintype" id="2067665">false</span><br>
<span class="lineno"></span><span class="op" id="2067671">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="2067674">//&nbsp;notSpace&nbsp;is&nbsp;the&nbsp;default&nbsp;scanning&nbsp;function&nbsp;used&nbsp;in&nbsp;Token.</span><br>
<span class="lineno"></span><span class="keyword" id="2067734">func</span>&nbsp;<span class="ident" id="2067739">notSpace</span><span class="op" id="2067747">(</span><span class="ident" id="2067748">r</span>&nbsp;<span class="builtintype" id="2067750">rune</span><span class="op" id="2067754">)</span>&nbsp;<span class="builtintype" id="2067756">bool</span>&nbsp;<span class="op" id="2067761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2067764">return</span>&nbsp;<span class="op" id="2067771">!</span><span class="ident" id="2067772">isSpace</span><span class="op" id="2067779">(</span><span class="ident" id="2067780">r</span><span class="op" id="2067781">)</span><br>
<span class="lineno"></span><span class="op" id="2067783">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">315</span><span class="comment" id="2067786">//&nbsp;SkipSpace&nbsp;provides&nbsp;Scan&nbsp;methods&nbsp;the&nbsp;ability&nbsp;to&nbsp;skip&nbsp;space&nbsp;and&nbsp;newline</span><br>
<span class="lineno"></span><span class="comment" id="2067859">//&nbsp;characters&nbsp;in&nbsp;keeping&nbsp;with&nbsp;the&nbsp;current&nbsp;scanning&nbsp;mode&nbsp;set&nbsp;by&nbsp;format&nbsp;strings</span><br>
<span class="lineno"></span><span class="comment" id="2067937">//&nbsp;and&nbsp;Scan/Scanln.</span><br>
<span class="lineno"></span><span class="keyword" id="2067957">func</span>&nbsp;<span class="op" id="2067962">(</span><span class="ident" id="2067963">s</span>&nbsp;<span class="op" id="2067965">*</span><span class="ident" id="2067966">ss</span><span class="op" id="2067968">)</span>&nbsp;<span class="ident" id="2067970">SkipSpace</span><span class="op" id="2067979">(</span><span class="op" id="2067980">)</span>&nbsp;<span class="op" id="2067982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2067985">s</span><span class="op" id="2067986">.</span><span class="ident" id="2067987">skipSpace</span><span class="op" id="2067996">(</span><span class="builtintype" id="2067997">false</span><span class="op" id="2068002">)</span><br>
<span class="lineno">320</span><span class="op" id="2068004">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2068007">//&nbsp;readRune&nbsp;is&nbsp;a&nbsp;structure&nbsp;to&nbsp;enable&nbsp;reading&nbsp;UTF-8&nbsp;encoded&nbsp;code&nbsp;points</span><br>
<span class="lineno"></span><span class="comment" id="2068078">//&nbsp;from&nbsp;an&nbsp;io.Reader.&nbsp;&nbsp;It&nbsp;is&nbsp;used&nbsp;if&nbsp;the&nbsp;Reader&nbsp;given&nbsp;to&nbsp;the&nbsp;scanner&nbsp;does</span><br>
<span class="lineno"></span><span class="comment" id="2068152">//&nbsp;not&nbsp;already&nbsp;implement&nbsp;io.RuneReader.</span><br>
<span class="lineno">325</span><span class="keyword" id="2068192">type</span>&nbsp;<span class="ident" id="2068197">readRune</span>&nbsp;<span class="keyword" id="2068206">struct</span>&nbsp;<span class="op" id="2068213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2068216">reader</span>&nbsp;&nbsp;<span class="ident" id="2068224">io</span><span class="op" id="2068226">.</span><span class="ident" id="2068227">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2068235">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2068243">[</span><span class="ident" id="2068244">utf8</span><span class="op" id="2068248">.</span><span class="ident" id="2068249">UTFMax</span><span class="op" id="2068255">]</span><span class="builtintype" id="2068256">byte</span>&nbsp;<span class="comment" id="2068261">//&nbsp;used&nbsp;only&nbsp;inside&nbsp;ReadRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2068291">pending</span>&nbsp;<span class="builtintype" id="2068299">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2068317">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;in&nbsp;pendBuf;&nbsp;only&nbsp;&gt;0&nbsp;for&nbsp;bad&nbsp;UTF-8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2068371">pendBuf</span>&nbsp;<span class="op" id="2068379">[</span><span class="ident" id="2068380">utf8</span><span class="op" id="2068384">.</span><span class="ident" id="2068385">UTFMax</span><span class="op" id="2068391">]</span><span class="builtintype" id="2068392">byte</span>&nbsp;<span class="comment" id="2068397">//&nbsp;bytes&nbsp;left&nbsp;over</span><br>
<span class="lineno">330</span><span class="op" id="2068416">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2068419">//&nbsp;readByte&nbsp;returns&nbsp;the&nbsp;next&nbsp;byte&nbsp;from&nbsp;the&nbsp;input,&nbsp;which&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="2068482">//&nbsp;left&nbsp;over&nbsp;from&nbsp;a&nbsp;previous&nbsp;read&nbsp;if&nbsp;the&nbsp;UTF-8&nbsp;was&nbsp;ill-formed.</span><br>
<span class="lineno"></span><span class="keyword" id="2068545">func</span>&nbsp;<span class="op" id="2068550">(</span><span class="ident" id="2068551">r</span>&nbsp;<span class="op" id="2068553">*</span><span class="ident" id="2068554">readRune</span><span class="op" id="2068562">)</span>&nbsp;<span class="ident" id="2068564">readByte</span><span class="op" id="2068572">(</span><span class="op" id="2068573">)</span>&nbsp;<span class="op" id="2068575">(</span><span class="ident" id="2068576">b</span>&nbsp;<span class="builtintype" id="2068578">byte</span><span class="op" id="2068582">,</span>&nbsp;<span class="ident" id="2068584">err</span>&nbsp;<span class="builtintype" id="2068588">error</span><span class="op" id="2068593">)</span>&nbsp;<span class="op" id="2068595">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2068598">if</span>&nbsp;<span class="ident" id="2068601">r</span><span class="op" id="2068602">.</span><span class="ident" id="2068603">pending</span>&nbsp;<span class="op" id="2068611">&gt;</span>&nbsp;<span class="num" id="2068613">0</span>&nbsp;<span class="op" id="2068615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2068619">b</span>&nbsp;<span class="op" id="2068621">=</span>&nbsp;<span class="ident" id="2068623">r</span><span class="op" id="2068624">.</span><span class="ident" id="2068625">pendBuf</span><span class="op" id="2068632">[</span><span class="num" id="2068633">0</span><span class="op" id="2068634">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2068638">copy</span><span class="op" id="2068642">(</span><span class="ident" id="2068643">r</span><span class="op" id="2068644">.</span><span class="ident" id="2068645">pendBuf</span><span class="op" id="2068652">[</span><span class="num" id="2068653">0</span><span class="op" id="2068654">:</span><span class="op" id="2068655">]</span><span class="op" id="2068656">,</span>&nbsp;<span class="ident" id="2068658">r</span><span class="op" id="2068659">.</span><span class="ident" id="2068660">pendBuf</span><span class="op" id="2068667">[</span><span class="num" id="2068668">1</span><span class="op" id="2068669">:</span><span class="op" id="2068670">]</span><span class="op" id="2068671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2068675">r</span><span class="op" id="2068676">.</span><span class="ident" id="2068677">pending</span><span class="op" id="2068684">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2068689">return</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2068697">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2068700">n</span><span class="op" id="2068701">,</span>&nbsp;<span class="ident" id="2068703">err</span>&nbsp;<span class="op" id="2068707">:=</span>&nbsp;<span class="ident" id="2068710">io</span><span class="op" id="2068712">.</span><span class="ident" id="2068713">ReadFull</span><span class="op" id="2068721">(</span><span class="ident" id="2068722">r</span><span class="op" id="2068723">.</span><span class="ident" id="2068724">reader</span><span class="op" id="2068730">,</span>&nbsp;<span class="ident" id="2068732">r</span><span class="op" id="2068733">.</span><span class="ident" id="2068734">pendBuf</span><span class="op" id="2068741">[</span><span class="num" id="2068742">0</span><span class="op" id="2068743">:</span><span class="num" id="2068744">1</span><span class="op" id="2068745">]</span><span class="op" id="2068746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2068749">if</span>&nbsp;<span class="ident" id="2068752">n</span>&nbsp;<span class="op" id="2068754">!=</span>&nbsp;<span class="num" id="2068757">1</span>&nbsp;<span class="op" id="2068759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2068763">return</span>&nbsp;<span class="num" id="2068770">0</span><span class="op" id="2068771">,</span>&nbsp;<span class="ident" id="2068773">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2068778">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2068781">return</span>&nbsp;<span class="ident" id="2068788">r</span><span class="op" id="2068789">.</span><span class="ident" id="2068790">pendBuf</span><span class="op" id="2068797">[</span><span class="num" id="2068798">0</span><span class="op" id="2068799">]</span><span class="op" id="2068800">,</span>&nbsp;<span class="ident" id="2068802">err</span><br>
<span class="lineno"></span><span class="op" id="2068806">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2068809">//&nbsp;unread&nbsp;saves&nbsp;the&nbsp;bytes&nbsp;for&nbsp;the&nbsp;next&nbsp;read.</span><br>
<span class="lineno"></span><span class="keyword" id="2068854">func</span>&nbsp;<span class="op" id="2068859">(</span><span class="ident" id="2068860">r</span>&nbsp;<span class="op" id="2068862">*</span><span class="ident" id="2068863">readRune</span><span class="op" id="2068871">)</span>&nbsp;<span class="ident" id="2068873">unread</span><span class="op" id="2068879">(</span><span class="ident" id="2068880">buf</span>&nbsp;<span class="op" id="2068884">[</span><span class="op" id="2068885">]</span><span class="builtintype" id="2068886">byte</span><span class="op" id="2068890">)</span>&nbsp;<span class="op" id="2068892">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2068895">copy</span><span class="op" id="2068899">(</span><span class="ident" id="2068900">r</span><span class="op" id="2068901">.</span><span class="ident" id="2068902">pendBuf</span><span class="op" id="2068909">[</span><span class="ident" id="2068910">r</span><span class="op" id="2068911">.</span><span class="ident" id="2068912">pending</span><span class="op" id="2068919">:</span><span class="op" id="2068920">]</span><span class="op" id="2068921">,</span>&nbsp;<span class="ident" id="2068923">buf</span><span class="op" id="2068926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2068929">r</span><span class="op" id="2068930">.</span><span class="ident" id="2068931">pending</span>&nbsp;<span class="op" id="2068939">+=</span>&nbsp;<span class="builtinfunc" id="2068942">len</span><span class="op" id="2068945">(</span><span class="ident" id="2068946">buf</span><span class="op" id="2068949">)</span><br>
<span class="lineno"></span><span class="op" id="2068951">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2068954">//&nbsp;ReadRune&nbsp;returns&nbsp;the&nbsp;next&nbsp;UTF-8&nbsp;encoded&nbsp;code&nbsp;point&nbsp;from&nbsp;the</span><br>
<span class="lineno">355</span><span class="comment" id="2069017">//&nbsp;io.Reader&nbsp;inside&nbsp;r.</span><br>
<span class="lineno"></span><span class="keyword" id="2069040">func</span>&nbsp;<span class="op" id="2069045">(</span><span class="ident" id="2069046">r</span>&nbsp;<span class="op" id="2069048">*</span><span class="ident" id="2069049">readRune</span><span class="op" id="2069057">)</span>&nbsp;<span class="ident" id="2069059">ReadRune</span><span class="op" id="2069067">(</span><span class="op" id="2069068">)</span>&nbsp;<span class="op" id="2069070">(</span><span class="ident" id="2069071">rr</span>&nbsp;<span class="builtintype" id="2069074">rune</span><span class="op" id="2069078">,</span>&nbsp;<span class="ident" id="2069080">size</span>&nbsp;<span class="builtintype" id="2069085">int</span><span class="op" id="2069088">,</span>&nbsp;<span class="ident" id="2069090">err</span>&nbsp;<span class="builtintype" id="2069094">error</span><span class="op" id="2069099">)</span>&nbsp;<span class="op" id="2069101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2069104">r</span><span class="op" id="2069105">.</span><span class="ident" id="2069106">buf</span><span class="op" id="2069109">[</span><span class="num" id="2069110">0</span><span class="op" id="2069111">]</span><span class="op" id="2069112">,</span>&nbsp;<span class="ident" id="2069114">err</span>&nbsp;<span class="op" id="2069118">=</span>&nbsp;<span class="ident" id="2069120">r</span><span class="op" id="2069121">.</span><span class="ident" id="2069122">readByte</span><span class="op" id="2069130">(</span><span class="op" id="2069131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2069134">if</span>&nbsp;<span class="ident" id="2069137">err</span>&nbsp;<span class="op" id="2069141">!=</span>&nbsp;<span class="ident" id="2069144">nil</span>&nbsp;<span class="op" id="2069148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2069152">return</span>&nbsp;<span class="num" id="2069159">0</span><span class="op" id="2069160">,</span>&nbsp;<span class="num" id="2069162">0</span><span class="op" id="2069163">,</span>&nbsp;<span class="ident" id="2069165">err</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2069170">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2069173">if</span>&nbsp;<span class="ident" id="2069176">r</span><span class="op" id="2069177">.</span><span class="ident" id="2069178">buf</span><span class="op" id="2069181">[</span><span class="num" id="2069182">0</span><span class="op" id="2069183">]</span>&nbsp;<span class="op" id="2069185">&lt;</span>&nbsp;<span class="ident" id="2069187">utf8</span><span class="op" id="2069191">.</span><span class="ident" id="2069192">RuneSelf</span>&nbsp;<span class="op" id="2069201">{</span>&nbsp;<span class="comment" id="2069203">//&nbsp;fast&nbsp;check&nbsp;for&nbsp;common&nbsp;ASCII&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2069241">rr</span>&nbsp;<span class="op" id="2069244">=</span>&nbsp;<span class="builtintype" id="2069246">rune</span><span class="op" id="2069250">(</span><span class="ident" id="2069251">r</span><span class="op" id="2069252">.</span><span class="ident" id="2069253">buf</span><span class="op" id="2069256">[</span><span class="num" id="2069257">0</span><span class="op" id="2069258">]</span><span class="op" id="2069259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2069263">size</span>&nbsp;<span class="op" id="2069268">=</span>&nbsp;<span class="num" id="2069270">1</span>&nbsp;<span class="comment" id="2069272">//&nbsp;Known&nbsp;to&nbsp;be&nbsp;1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2069292">return</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2069300">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2069303">var</span>&nbsp;<span class="ident" id="2069307">n</span>&nbsp;<span class="builtintype" id="2069309">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2069314">for</span>&nbsp;<span class="ident" id="2069318">n</span>&nbsp;<span class="op" id="2069320">=</span>&nbsp;<span class="num" id="2069322">1</span><span class="op" id="2069323">;</span>&nbsp;<span class="op" id="2069325">!</span><span class="ident" id="2069326">utf8</span><span class="op" id="2069330">.</span><span class="ident" id="2069331">FullRune</span><span class="op" id="2069339">(</span><span class="ident" id="2069340">r</span><span class="op" id="2069341">.</span><span class="ident" id="2069342">buf</span><span class="op" id="2069345">[</span><span class="num" id="2069346">0</span><span class="op" id="2069347">:</span><span class="ident" id="2069348">n</span><span class="op" id="2069349">]</span><span class="op" id="2069350">)</span><span class="op" id="2069351">;</span>&nbsp;<span class="ident" id="2069353">n</span><span class="op" id="2069354">++</span>&nbsp;<span class="op" id="2069357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2069361">r</span><span class="op" id="2069362">.</span><span class="ident" id="2069363">buf</span><span class="op" id="2069366">[</span><span class="ident" id="2069367">n</span><span class="op" id="2069368">]</span><span class="op" id="2069369">,</span>&nbsp;<span class="ident" id="2069371">err</span>&nbsp;<span class="op" id="2069375">=</span>&nbsp;<span class="ident" id="2069377">r</span><span class="op" id="2069378">.</span><span class="ident" id="2069379">readByte</span><span class="op" id="2069387">(</span><span class="op" id="2069388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2069392">if</span>&nbsp;<span class="ident" id="2069395">err</span>&nbsp;<span class="op" id="2069399">!=</span>&nbsp;<span class="ident" id="2069402">nil</span>&nbsp;<span class="op" id="2069406">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2069411">if</span>&nbsp;<span class="ident" id="2069414">err</span>&nbsp;<span class="op" id="2069418">==</span>&nbsp;<span class="ident" id="2069421">io</span><span class="op" id="2069423">.</span><span class="ident" id="2069424">EOF</span>&nbsp;<span class="op" id="2069428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2069434">err</span>&nbsp;<span class="op" id="2069438">=</span>&nbsp;<span class="ident" id="2069440">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2069448">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2069457">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2069462">return</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2069471">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2069474">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2069477">rr</span><span class="op" id="2069479">,</span>&nbsp;<span class="ident" id="2069481">size</span>&nbsp;<span class="op" id="2069486">=</span>&nbsp;<span class="ident" id="2069488">utf8</span><span class="op" id="2069492">.</span><span class="ident" id="2069493">DecodeRune</span><span class="op" id="2069503">(</span><span class="ident" id="2069504">r</span><span class="op" id="2069505">.</span><span class="ident" id="2069506">buf</span><span class="op" id="2069509">[</span><span class="num" id="2069510">0</span><span class="op" id="2069511">:</span><span class="ident" id="2069512">n</span><span class="op" id="2069513">]</span><span class="op" id="2069514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2069517">if</span>&nbsp;<span class="ident" id="2069520">size</span>&nbsp;<span class="op" id="2069525">&lt;</span>&nbsp;<span class="ident" id="2069527">n</span>&nbsp;<span class="op" id="2069529">{</span>&nbsp;<span class="comment" id="2069531">//&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2069545">r</span><span class="op" id="2069546">.</span><span class="ident" id="2069547">unread</span><span class="op" id="2069553">(</span><span class="ident" id="2069554">r</span><span class="op" id="2069555">.</span><span class="ident" id="2069556">buf</span><span class="op" id="2069559">[</span><span class="ident" id="2069560">size</span><span class="op" id="2069564">:</span><span class="ident" id="2069565">n</span><span class="op" id="2069566">]</span><span class="op" id="2069567">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2069570">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2069573">return</span><br>
<span class="lineno"></span><span class="op" id="2069580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2069583">var</span>&nbsp;<span class="ident" id="2069587">ssFree</span>&nbsp;<span class="op" id="2069594">=</span>&nbsp;<span class="ident" id="2069596">sync</span><span class="op" id="2069600">.</span><span class="ident" id="2069601">Pool</span><span class="op" id="2069605">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2069608">New</span><span class="op" id="2069611">:</span>&nbsp;<span class="keyword" id="2069613">func</span><span class="op" id="2069617">(</span><span class="op" id="2069618">)</span>&nbsp;<span class="keyword" id="2069620">interface</span><span class="op" id="2069629">{</span><span class="op" id="2069630">}</span>&nbsp;<span class="op" id="2069632">{</span>&nbsp;<span class="keyword" id="2069634">return</span>&nbsp;<span class="builtinfunc" id="2069641">new</span><span class="op" id="2069644">(</span><span class="ident" id="2069645">ss</span><span class="op" id="2069647">)</span>&nbsp;<span class="op" id="2069649">}</span><span class="op" id="2069650">,</span><br>
<span class="lineno"></span><span class="op" id="2069652">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2069655">//&nbsp;newScanState&nbsp;allocates&nbsp;a&nbsp;new&nbsp;ss&nbsp;struct&nbsp;or&nbsp;grab&nbsp;a&nbsp;cached&nbsp;one.</span><br>
<span class="lineno"></span><span class="keyword" id="2069719">func</span>&nbsp;<span class="ident" id="2069724">newScanState</span><span class="op" id="2069736">(</span><span class="ident" id="2069737">r</span>&nbsp;<span class="ident" id="2069739">io</span><span class="op" id="2069741">.</span><span class="ident" id="2069742">Reader</span><span class="op" id="2069748">,</span>&nbsp;<span class="ident" id="2069750">nlIsSpace</span><span class="op" id="2069759">,</span>&nbsp;<span class="ident" id="2069761">nlIsEnd</span>&nbsp;<span class="builtintype" id="2069769">bool</span><span class="op" id="2069773">)</span>&nbsp;<span class="op" id="2069775">(</span><span class="ident" id="2069776">s</span>&nbsp;<span class="op" id="2069778">*</span><span class="ident" id="2069779">ss</span><span class="op" id="2069781">,</span>&nbsp;<span class="ident" id="2069783">old</span>&nbsp;<span class="ident" id="2069787">ssave</span><span class="op" id="2069792">)</span>&nbsp;<span class="op" id="2069794">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2069797">//&nbsp;If&nbsp;the&nbsp;reader&nbsp;is&nbsp;a&nbsp;*ss,&nbsp;then&nbsp;we&#39;ve&nbsp;got&nbsp;a&nbsp;recursive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2069852">//&nbsp;call&nbsp;to&nbsp;Scan,&nbsp;so&nbsp;re-use&nbsp;the&nbsp;scan&nbsp;state.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2069896">s</span><span class="op" id="2069897">,</span>&nbsp;<span class="ident" id="2069899">ok</span>&nbsp;<span class="op" id="2069902">:=</span>&nbsp;<span class="ident" id="2069905">r</span><span class="op" id="2069906">.</span><span class="op" id="2069907">(</span><span class="op" id="2069908">*</span><span class="ident" id="2069909">ss</span><span class="op" id="2069911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2069914">if</span>&nbsp;<span class="ident" id="2069917">ok</span>&nbsp;<span class="op" id="2069920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2069924">old</span>&nbsp;<span class="op" id="2069928">=</span>&nbsp;<span class="ident" id="2069930">s</span><span class="op" id="2069931">.</span><span class="ident" id="2069932">ssave</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2069940">s</span><span class="op" id="2069941">.</span><span class="ident" id="2069942">limit</span>&nbsp;<span class="op" id="2069948">=</span>&nbsp;<span class="ident" id="2069950">s</span><span class="op" id="2069951">.</span><span class="ident" id="2069952">argLimit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2069963">s</span><span class="op" id="2069964">.</span><span class="ident" id="2069965">nlIsEnd</span>&nbsp;<span class="op" id="2069973">=</span>&nbsp;<span class="ident" id="2069975">nlIsEnd</span>&nbsp;<span class="op" id="2069983">||</span>&nbsp;<span class="ident" id="2069986">s</span><span class="op" id="2069987">.</span><span class="ident" id="2069988">nlIsEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2069998">s</span><span class="op" id="2069999">.</span><span class="ident" id="2070000">nlIsSpace</span>&nbsp;<span class="op" id="2070010">=</span>&nbsp;<span class="ident" id="2070012">nlIsSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2070024">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2070032">}</span><br>
<span class="lineno">400</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2070036">s</span>&nbsp;<span class="op" id="2070038">=</span>&nbsp;<span class="ident" id="2070040">ssFree</span><span class="op" id="2070046">.</span><span class="ident" id="2070047">Get</span><span class="op" id="2070050">(</span><span class="op" id="2070051">)</span><span class="op" id="2070052">.</span><span class="op" id="2070053">(</span><span class="op" id="2070054">*</span><span class="ident" id="2070055">ss</span><span class="op" id="2070057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2070060">if</span>&nbsp;<span class="ident" id="2070063">rr</span><span class="op" id="2070065">,</span>&nbsp;<span class="ident" id="2070067">ok</span>&nbsp;<span class="op" id="2070070">:=</span>&nbsp;<span class="ident" id="2070073">r</span><span class="op" id="2070074">.</span><span class="op" id="2070075">(</span><span class="ident" id="2070076">io</span><span class="op" id="2070078">.</span><span class="ident" id="2070079">RuneReader</span><span class="op" id="2070089">)</span><span class="op" id="2070090">;</span>&nbsp;<span class="ident" id="2070092">ok</span>&nbsp;<span class="op" id="2070095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2070099">s</span><span class="op" id="2070100">.</span><span class="ident" id="2070101">rr</span>&nbsp;<span class="op" id="2070104">=</span>&nbsp;<span class="ident" id="2070106">rr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2070110">}</span>&nbsp;<span class="keyword" id="2070112">else</span>&nbsp;<span class="op" id="2070117">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2070121">s</span><span class="op" id="2070122">.</span><span class="ident" id="2070123">rr</span>&nbsp;<span class="op" id="2070126">=</span>&nbsp;<span class="op" id="2070128">&amp;</span><span class="ident" id="2070129">readRune</span><span class="op" id="2070137">{</span><span class="ident" id="2070138">reader</span><span class="op" id="2070144">:</span>&nbsp;<span class="ident" id="2070146">r</span><span class="op" id="2070147">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2070150">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2070153">s</span><span class="op" id="2070154">.</span><span class="ident" id="2070155">nlIsSpace</span>&nbsp;<span class="op" id="2070165">=</span>&nbsp;<span class="ident" id="2070167">nlIsSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2070178">s</span><span class="op" id="2070179">.</span><span class="ident" id="2070180">nlIsEnd</span>&nbsp;<span class="op" id="2070188">=</span>&nbsp;<span class="ident" id="2070190">nlIsEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2070199">s</span><span class="op" id="2070200">.</span><span class="ident" id="2070201">prevRune</span>&nbsp;<span class="op" id="2070210">=</span>&nbsp;<span class="op" id="2070212">-</span><span class="num" id="2070213">1</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2070216">s</span><span class="op" id="2070217">.</span><span class="ident" id="2070218">peekRune</span>&nbsp;<span class="op" id="2070227">=</span>&nbsp;<span class="op" id="2070229">-</span><span class="num" id="2070230">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2070233">s</span><span class="op" id="2070234">.</span><span class="ident" id="2070235">atEOF</span>&nbsp;<span class="op" id="2070241">=</span>&nbsp;<span class="builtintype" id="2070243">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2070250">s</span><span class="op" id="2070251">.</span><span class="ident" id="2070252">limit</span>&nbsp;<span class="op" id="2070258">=</span>&nbsp;<span class="ident" id="2070260">hugeWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2070269">s</span><span class="op" id="2070270">.</span><span class="ident" id="2070271">argLimit</span>&nbsp;<span class="op" id="2070280">=</span>&nbsp;<span class="ident" id="2070282">hugeWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2070291">s</span><span class="op" id="2070292">.</span><span class="ident" id="2070293">maxWid</span>&nbsp;<span class="op" id="2070300">=</span>&nbsp;<span class="ident" id="2070302">hugeWid</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2070311">s</span><span class="op" id="2070312">.</span><span class="ident" id="2070313">validSave</span>&nbsp;<span class="op" id="2070323">=</span>&nbsp;<span class="builtintype" id="2070325">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2070331">s</span><span class="op" id="2070332">.</span><span class="ident" id="2070333">count</span>&nbsp;<span class="op" id="2070339">=</span>&nbsp;<span class="num" id="2070341">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2070344">return</span><br>
<span class="lineno"></span><span class="op" id="2070351">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span><span class="comment" id="2070354">//&nbsp;free&nbsp;saves&nbsp;used&nbsp;ss&nbsp;structs&nbsp;in&nbsp;ssFree;&nbsp;avoid&nbsp;an&nbsp;allocation&nbsp;per&nbsp;invocation.</span><br>
<span class="lineno"></span><span class="keyword" id="2070431">func</span>&nbsp;<span class="op" id="2070436">(</span><span class="ident" id="2070437">s</span>&nbsp;<span class="op" id="2070439">*</span><span class="ident" id="2070440">ss</span><span class="op" id="2070442">)</span>&nbsp;<span class="ident" id="2070444">free</span><span class="op" id="2070448">(</span><span class="ident" id="2070449">old</span>&nbsp;<span class="ident" id="2070453">ssave</span><span class="op" id="2070458">)</span>&nbsp;<span class="op" id="2070460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2070463">//&nbsp;If&nbsp;it&nbsp;was&nbsp;used&nbsp;recursively,&nbsp;just&nbsp;restore&nbsp;the&nbsp;old&nbsp;state.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2070523">if</span>&nbsp;<span class="ident" id="2070526">old</span><span class="op" id="2070529">.</span><span class="ident" id="2070530">validSave</span>&nbsp;<span class="op" id="2070540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2070544">s</span><span class="op" id="2070545">.</span><span class="ident" id="2070546">ssave</span>&nbsp;<span class="op" id="2070552">=</span>&nbsp;<span class="ident" id="2070554">old</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2070560">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2070568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2070571">//&nbsp;Don&#39;t&nbsp;hold&nbsp;on&nbsp;to&nbsp;ss&nbsp;structs&nbsp;with&nbsp;large&nbsp;buffers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2070623">if</span>&nbsp;<span class="builtinfunc" id="2070626">cap</span><span class="op" id="2070629">(</span><span class="ident" id="2070630">s</span><span class="op" id="2070631">.</span><span class="ident" id="2070632">buf</span><span class="op" id="2070635">)</span>&nbsp;<span class="op" id="2070637">&gt;</span>&nbsp;<span class="num" id="2070639">1024</span>&nbsp;<span class="op" id="2070644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2070648">return</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2070656">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2070659">s</span><span class="op" id="2070660">.</span><span class="ident" id="2070661">buf</span>&nbsp;<span class="op" id="2070665">=</span>&nbsp;<span class="ident" id="2070667">s</span><span class="op" id="2070668">.</span><span class="ident" id="2070669">buf</span><span class="op" id="2070672">[</span><span class="op" id="2070673">:</span><span class="num" id="2070674">0</span><span class="op" id="2070675">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2070678">s</span><span class="op" id="2070679">.</span><span class="ident" id="2070680">rr</span>&nbsp;<span class="op" id="2070683">=</span>&nbsp;<span class="ident" id="2070685">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2070690">ssFree</span><span class="op" id="2070696">.</span><span class="ident" id="2070697">Put</span><span class="op" id="2070700">(</span><span class="ident" id="2070701">s</span><span class="op" id="2070702">)</span><br>
<span class="lineno"></span><span class="op" id="2070704">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="comment" id="2070707">//&nbsp;skipSpace&nbsp;skips&nbsp;spaces&nbsp;and&nbsp;maybe&nbsp;newlines.</span><br>
<span class="lineno"></span><span class="keyword" id="2070753">func</span>&nbsp;<span class="op" id="2070758">(</span><span class="ident" id="2070759">s</span>&nbsp;<span class="op" id="2070761">*</span><span class="ident" id="2070762">ss</span><span class="op" id="2070764">)</span>&nbsp;<span class="ident" id="2070766">skipSpace</span><span class="op" id="2070775">(</span><span class="ident" id="2070776">stopAtNewline</span>&nbsp;<span class="builtintype" id="2070790">bool</span><span class="op" id="2070794">)</span>&nbsp;<span class="op" id="2070796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2070799">for</span>&nbsp;<span class="op" id="2070803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2070807">r</span>&nbsp;<span class="op" id="2070809">:=</span>&nbsp;<span class="ident" id="2070812">s</span><span class="op" id="2070813">.</span><span class="ident" id="2070814">getRune</span><span class="op" id="2070821">(</span><span class="op" id="2070822">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2070826">if</span>&nbsp;<span class="ident" id="2070829">r</span>&nbsp;<span class="op" id="2070831">==</span>&nbsp;<span class="ident" id="2070834">eof</span>&nbsp;<span class="op" id="2070838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2070843">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2070852">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2070856">if</span>&nbsp;<span class="ident" id="2070859">r</span>&nbsp;<span class="op" id="2070861">==</span>&nbsp;<span class="string" id="2070864">&#39;\r&#39;</span>&nbsp;<span class="op" id="2070869">&amp;&amp;</span>&nbsp;<span class="ident" id="2070872">s</span><span class="op" id="2070873">.</span><span class="ident" id="2070874">peek</span><span class="op" id="2070878">(</span><span class="string" id="2070879">&#34;\n&#34;</span><span class="op" id="2070883">)</span>&nbsp;<span class="op" id="2070885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2070890">continue</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2070901">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2070905">if</span>&nbsp;<span class="ident" id="2070908">r</span>&nbsp;<span class="op" id="2070910">==</span>&nbsp;<span class="string" id="2070913">&#39;\n&#39;</span>&nbsp;<span class="op" id="2070918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2070923">if</span>&nbsp;<span class="ident" id="2070926">stopAtNewline</span>&nbsp;<span class="op" id="2070940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2070946">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2070955">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2070960">if</span>&nbsp;<span class="ident" id="2070963">s</span><span class="op" id="2070964">.</span><span class="ident" id="2070965">nlIsSpace</span>&nbsp;<span class="op" id="2070975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2070981">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2070993">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2070998">s</span><span class="op" id="2070999">.</span><span class="ident" id="2071000">errorString</span><span class="op" id="2071011">(</span><span class="string" id="2071012">&#34;unexpected&nbsp;newline&#34;</span><span class="op" id="2071032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2071037">return</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2071046">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2071050">if</span>&nbsp;<span class="op" id="2071053">!</span><span class="ident" id="2071054">isSpace</span><span class="op" id="2071061">(</span><span class="ident" id="2071062">r</span><span class="op" id="2071063">)</span>&nbsp;<span class="op" id="2071065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2071070">s</span><span class="op" id="2071071">.</span><span class="ident" id="2071072">UnreadRune</span><span class="op" id="2071082">(</span><span class="op" id="2071083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2071088">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2071096">}</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2071099">}</span><br>
<span class="lineno"></span><span class="op" id="2071101">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2071104">//&nbsp;token&nbsp;returns&nbsp;the&nbsp;next&nbsp;space-delimited&nbsp;string&nbsp;from&nbsp;the&nbsp;input.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="2071173">//&nbsp;skips&nbsp;white&nbsp;space.&nbsp;&nbsp;For&nbsp;Scanln,&nbsp;it&nbsp;stops&nbsp;at&nbsp;newlines.&nbsp;&nbsp;For&nbsp;Scan,</span><br>
<span class="lineno">465</span><span class="comment" id="2071241">//&nbsp;newlines&nbsp;are&nbsp;treated&nbsp;as&nbsp;spaces.</span><br>
<span class="lineno"></span><span class="keyword" id="2071276">func</span>&nbsp;<span class="op" id="2071281">(</span><span class="ident" id="2071282">s</span>&nbsp;<span class="op" id="2071284">*</span><span class="ident" id="2071285">ss</span><span class="op" id="2071287">)</span>&nbsp;<span class="ident" id="2071289">token</span><span class="op" id="2071294">(</span><span class="ident" id="2071295">skipSpace</span>&nbsp;<span class="builtintype" id="2071305">bool</span><span class="op" id="2071309">,</span>&nbsp;<span class="ident" id="2071311">f</span>&nbsp;<span class="keyword" id="2071313">func</span><span class="op" id="2071317">(</span><span class="builtintype" id="2071318">rune</span><span class="op" id="2071322">)</span>&nbsp;<span class="builtintype" id="2071324">bool</span><span class="op" id="2071328">)</span>&nbsp;<span class="op" id="2071330">[</span><span class="op" id="2071331">]</span><span class="builtintype" id="2071332">byte</span>&nbsp;<span class="op" id="2071337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2071340">if</span>&nbsp;<span class="ident" id="2071343">skipSpace</span>&nbsp;<span class="op" id="2071353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2071357">s</span><span class="op" id="2071358">.</span><span class="ident" id="2071359">skipSpace</span><span class="op" id="2071368">(</span><span class="builtintype" id="2071369">false</span><span class="op" id="2071374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2071377">}</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2071380">//&nbsp;read&nbsp;until&nbsp;white&nbsp;space&nbsp;or&nbsp;newline</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2071418">for</span>&nbsp;<span class="op" id="2071422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2071426">r</span>&nbsp;<span class="op" id="2071428">:=</span>&nbsp;<span class="ident" id="2071431">s</span><span class="op" id="2071432">.</span><span class="ident" id="2071433">getRune</span><span class="op" id="2071440">(</span><span class="op" id="2071441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2071445">if</span>&nbsp;<span class="ident" id="2071448">r</span>&nbsp;<span class="op" id="2071450">==</span>&nbsp;<span class="ident" id="2071453">eof</span>&nbsp;<span class="op" id="2071457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2071462">break</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2071470">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2071474">if</span>&nbsp;<span class="op" id="2071477">!</span><span class="ident" id="2071478">f</span><span class="op" id="2071479">(</span><span class="ident" id="2071480">r</span><span class="op" id="2071481">)</span>&nbsp;<span class="op" id="2071483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2071488">s</span><span class="op" id="2071489">.</span><span class="ident" id="2071490">UnreadRune</span><span class="op" id="2071500">(</span><span class="op" id="2071501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2071506">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2071514">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2071518">s</span><span class="op" id="2071519">.</span><span class="ident" id="2071520">buf</span><span class="op" id="2071523">.</span><span class="ident" id="2071524">WriteRune</span><span class="op" id="2071533">(</span><span class="ident" id="2071534">r</span><span class="op" id="2071535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2071538">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2071541">return</span>&nbsp;<span class="ident" id="2071548">s</span><span class="op" id="2071549">.</span><span class="ident" id="2071550">buf</span><br>
<span class="lineno"></span><span class="op" id="2071554">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span><span class="keyword" id="2071557">var</span>&nbsp;<span class="ident" id="2071561">complexError</span>&nbsp;<span class="op" id="2071574">=</span>&nbsp;<span class="ident" id="2071576">errors</span><span class="op" id="2071582">.</span><span class="ident" id="2071583">New</span><span class="op" id="2071586">(</span><span class="string" id="2071587">&#34;syntax&nbsp;error&nbsp;scanning&nbsp;complex&nbsp;number&#34;</span><span class="op" id="2071625">)</span><br>
<span class="lineno"></span><span class="keyword" id="2071627">var</span>&nbsp;<span class="ident" id="2071631">boolError</span>&nbsp;<span class="op" id="2071641">=</span>&nbsp;<span class="ident" id="2071643">errors</span><span class="op" id="2071649">.</span><span class="ident" id="2071650">New</span><span class="op" id="2071653">(</span><span class="string" id="2071654">&#34;syntax&nbsp;error&nbsp;scanning&nbsp;boolean&#34;</span><span class="op" id="2071685">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2071688">func</span>&nbsp;<span class="ident" id="2071693">indexRune</span><span class="op" id="2071702">(</span><span class="ident" id="2071703">s</span>&nbsp;<span class="builtintype" id="2071705">string</span><span class="op" id="2071711">,</span>&nbsp;<span class="ident" id="2071713">r</span>&nbsp;<span class="builtintype" id="2071715">rune</span><span class="op" id="2071719">)</span>&nbsp;<span class="builtintype" id="2071721">int</span>&nbsp;<span class="op" id="2071725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2071728">for</span>&nbsp;<span class="ident" id="2071732">i</span><span class="op" id="2071733">,</span>&nbsp;<span class="ident" id="2071735">c</span>&nbsp;<span class="op" id="2071737">:=</span>&nbsp;<span class="keyword" id="2071740">range</span>&nbsp;<span class="ident" id="2071746">s</span>&nbsp;<span class="op" id="2071748">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2071752">if</span>&nbsp;<span class="ident" id="2071755">c</span>&nbsp;<span class="op" id="2071757">==</span>&nbsp;<span class="ident" id="2071760">r</span>&nbsp;<span class="op" id="2071762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2071767">return</span>&nbsp;<span class="ident" id="2071774">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2071778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2071781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2071784">return</span>&nbsp;<span class="op" id="2071791">-</span><span class="num" id="2071792">1</span><br>
<span class="lineno">495</span><span class="op" id="2071794">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2071797">//&nbsp;consume&nbsp;reads&nbsp;the&nbsp;next&nbsp;rune&nbsp;in&nbsp;the&nbsp;input&nbsp;and&nbsp;reports&nbsp;whether&nbsp;it&nbsp;is&nbsp;in&nbsp;the&nbsp;ok&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="2071885">//&nbsp;If&nbsp;accept&nbsp;is&nbsp;true,&nbsp;it&nbsp;puts&nbsp;the&nbsp;character&nbsp;into&nbsp;the&nbsp;input&nbsp;token.</span><br>
<span class="lineno"></span><span class="keyword" id="2071951">func</span>&nbsp;<span class="op" id="2071956">(</span><span class="ident" id="2071957">s</span>&nbsp;<span class="op" id="2071959">*</span><span class="ident" id="2071960">ss</span><span class="op" id="2071962">)</span>&nbsp;<span class="ident" id="2071964">consume</span><span class="op" id="2071971">(</span><span class="ident" id="2071972">ok</span>&nbsp;<span class="builtintype" id="2071975">string</span><span class="op" id="2071981">,</span>&nbsp;<span class="ident" id="2071983">accept</span>&nbsp;<span class="builtintype" id="2071990">bool</span><span class="op" id="2071994">)</span>&nbsp;<span class="builtintype" id="2071996">bool</span>&nbsp;<span class="op" id="2072001">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2072004">r</span>&nbsp;<span class="op" id="2072006">:=</span>&nbsp;<span class="ident" id="2072009">s</span><span class="op" id="2072010">.</span><span class="ident" id="2072011">getRune</span><span class="op" id="2072018">(</span><span class="op" id="2072019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2072022">if</span>&nbsp;<span class="ident" id="2072025">r</span>&nbsp;<span class="op" id="2072027">==</span>&nbsp;<span class="ident" id="2072030">eof</span>&nbsp;<span class="op" id="2072034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2072038">return</span>&nbsp;<span class="builtintype" id="2072045">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2072052">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2072055">if</span>&nbsp;<span class="ident" id="2072058">indexRune</span><span class="op" id="2072067">(</span><span class="ident" id="2072068">ok</span><span class="op" id="2072070">,</span>&nbsp;<span class="ident" id="2072072">r</span><span class="op" id="2072073">)</span>&nbsp;<span class="op" id="2072075">&gt;=</span>&nbsp;<span class="num" id="2072078">0</span>&nbsp;<span class="op" id="2072080">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2072084">if</span>&nbsp;<span class="ident" id="2072087">accept</span>&nbsp;<span class="op" id="2072094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2072099">s</span><span class="op" id="2072100">.</span><span class="ident" id="2072101">buf</span><span class="op" id="2072104">.</span><span class="ident" id="2072105">WriteRune</span><span class="op" id="2072114">(</span><span class="ident" id="2072115">r</span><span class="op" id="2072116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2072120">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2072124">return</span>&nbsp;<span class="builtintype" id="2072131">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2072137">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2072140">if</span>&nbsp;<span class="ident" id="2072143">r</span>&nbsp;<span class="op" id="2072145">!=</span>&nbsp;<span class="ident" id="2072148">eof</span>&nbsp;<span class="op" id="2072152">&amp;&amp;</span>&nbsp;<span class="ident" id="2072155">accept</span>&nbsp;<span class="op" id="2072162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2072166">s</span><span class="op" id="2072167">.</span><span class="ident" id="2072168">UnreadRune</span><span class="op" id="2072178">(</span><span class="op" id="2072179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2072182">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2072185">return</span>&nbsp;<span class="builtintype" id="2072192">false</span><br>
<span class="lineno"></span><span class="op" id="2072198">}</span><br>
<span class="lineno">515</span><br>
<span class="lineno"></span><span class="comment" id="2072201">//&nbsp;peek&nbsp;reports&nbsp;whether&nbsp;the&nbsp;next&nbsp;character&nbsp;is&nbsp;in&nbsp;the&nbsp;ok&nbsp;string,&nbsp;without&nbsp;consuming&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="2072287">func</span>&nbsp;<span class="op" id="2072292">(</span><span class="ident" id="2072293">s</span>&nbsp;<span class="op" id="2072295">*</span><span class="ident" id="2072296">ss</span><span class="op" id="2072298">)</span>&nbsp;<span class="ident" id="2072300">peek</span><span class="op" id="2072304">(</span><span class="ident" id="2072305">ok</span>&nbsp;<span class="builtintype" id="2072308">string</span><span class="op" id="2072314">)</span>&nbsp;<span class="builtintype" id="2072316">bool</span>&nbsp;<span class="op" id="2072321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2072324">r</span>&nbsp;<span class="op" id="2072326">:=</span>&nbsp;<span class="ident" id="2072329">s</span><span class="op" id="2072330">.</span><span class="ident" id="2072331">getRune</span><span class="op" id="2072338">(</span><span class="op" id="2072339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2072342">if</span>&nbsp;<span class="ident" id="2072345">r</span>&nbsp;<span class="op" id="2072347">!=</span>&nbsp;<span class="ident" id="2072350">eof</span>&nbsp;<span class="op" id="2072354">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2072358">s</span><span class="op" id="2072359">.</span><span class="ident" id="2072360">UnreadRune</span><span class="op" id="2072370">(</span><span class="op" id="2072371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2072374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2072377">return</span>&nbsp;<span class="ident" id="2072384">indexRune</span><span class="op" id="2072393">(</span><span class="ident" id="2072394">ok</span><span class="op" id="2072396">,</span>&nbsp;<span class="ident" id="2072398">r</span><span class="op" id="2072399">)</span>&nbsp;<span class="op" id="2072401">&gt;=</span>&nbsp;<span class="num" id="2072404">0</span><br>
<span class="lineno"></span><span class="op" id="2072406">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span><span class="keyword" id="2072409">func</span>&nbsp;<span class="op" id="2072414">(</span><span class="ident" id="2072415">s</span>&nbsp;<span class="op" id="2072417">*</span><span class="ident" id="2072418">ss</span><span class="op" id="2072420">)</span>&nbsp;<span class="ident" id="2072422">notEOF</span><span class="op" id="2072428">(</span><span class="op" id="2072429">)</span>&nbsp;<span class="op" id="2072431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2072434">//&nbsp;Guarantee&nbsp;there&nbsp;is&nbsp;data&nbsp;to&nbsp;be&nbsp;read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2072474">if</span>&nbsp;<span class="ident" id="2072477">r</span>&nbsp;<span class="op" id="2072479">:=</span>&nbsp;<span class="ident" id="2072482">s</span><span class="op" id="2072483">.</span><span class="ident" id="2072484">getRune</span><span class="op" id="2072491">(</span><span class="op" id="2072492">)</span><span class="op" id="2072493">;</span>&nbsp;<span class="ident" id="2072495">r</span>&nbsp;<span class="op" id="2072497">==</span>&nbsp;<span class="ident" id="2072500">eof</span>&nbsp;<span class="op" id="2072504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2072508">panic</span><span class="op" id="2072513">(</span><span class="ident" id="2072514">io</span><span class="op" id="2072516">.</span><span class="ident" id="2072517">EOF</span><span class="op" id="2072520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2072523">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2072526">s</span><span class="op" id="2072527">.</span><span class="ident" id="2072528">UnreadRune</span><span class="op" id="2072538">(</span><span class="op" id="2072539">)</span><br>
<span class="lineno"></span><span class="op" id="2072541">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2072544">//&nbsp;accept&nbsp;checks&nbsp;the&nbsp;next&nbsp;rune&nbsp;in&nbsp;the&nbsp;input.&nbsp;&nbsp;If&nbsp;it&#39;s&nbsp;a&nbsp;byte&nbsp;(sic)&nbsp;in&nbsp;the&nbsp;string,&nbsp;it&nbsp;puts&nbsp;it&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2072644">//&nbsp;buffer&nbsp;and&nbsp;returns&nbsp;true.&nbsp;Otherwise&nbsp;it&nbsp;return&nbsp;false.</span><br>
<span class="lineno">535</span><span class="keyword" id="2072699">func</span>&nbsp;<span class="op" id="2072704">(</span><span class="ident" id="2072705">s</span>&nbsp;<span class="op" id="2072707">*</span><span class="ident" id="2072708">ss</span><span class="op" id="2072710">)</span>&nbsp;<span class="ident" id="2072712">accept</span><span class="op" id="2072718">(</span><span class="ident" id="2072719">ok</span>&nbsp;<span class="builtintype" id="2072722">string</span><span class="op" id="2072728">)</span>&nbsp;<span class="builtintype" id="2072730">bool</span>&nbsp;<span class="op" id="2072735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2072738">return</span>&nbsp;<span class="ident" id="2072745">s</span><span class="op" id="2072746">.</span><span class="ident" id="2072747">consume</span><span class="op" id="2072754">(</span><span class="ident" id="2072755">ok</span><span class="op" id="2072757">,</span>&nbsp;<span class="builtintype" id="2072759">true</span><span class="op" id="2072763">)</span><br>
<span class="lineno"></span><span class="op" id="2072765">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2072768">//&nbsp;okVerb&nbsp;verifies&nbsp;that&nbsp;the&nbsp;verb&nbsp;is&nbsp;present&nbsp;in&nbsp;the&nbsp;list,&nbsp;setting&nbsp;s.err&nbsp;appropriately&nbsp;if&nbsp;not.</span><br>
<span class="lineno">540</span><span class="keyword" id="2072861">func</span>&nbsp;<span class="op" id="2072866">(</span><span class="ident" id="2072867">s</span>&nbsp;<span class="op" id="2072869">*</span><span class="ident" id="2072870">ss</span><span class="op" id="2072872">)</span>&nbsp;<span class="ident" id="2072874">okVerb</span><span class="op" id="2072880">(</span><span class="ident" id="2072881">verb</span>&nbsp;<span class="builtintype" id="2072886">rune</span><span class="op" id="2072890">,</span>&nbsp;<span class="ident" id="2072892">okVerbs</span><span class="op" id="2072899">,</span>&nbsp;<span class="ident" id="2072901">typ</span>&nbsp;<span class="builtintype" id="2072905">string</span><span class="op" id="2072911">)</span>&nbsp;<span class="builtintype" id="2072913">bool</span>&nbsp;<span class="op" id="2072918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2072921">for</span>&nbsp;<span class="ident" id="2072925">_</span><span class="op" id="2072926">,</span>&nbsp;<span class="ident" id="2072928">v</span>&nbsp;<span class="op" id="2072930">:=</span>&nbsp;<span class="keyword" id="2072933">range</span>&nbsp;<span class="ident" id="2072939">okVerbs</span>&nbsp;<span class="op" id="2072947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2072951">if</span>&nbsp;<span class="ident" id="2072954">v</span>&nbsp;<span class="op" id="2072956">==</span>&nbsp;<span class="ident" id="2072959">verb</span>&nbsp;<span class="op" id="2072964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2072969">return</span>&nbsp;<span class="builtintype" id="2072976">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2072983">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2072986">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2072989">s</span><span class="op" id="2072990">.</span><span class="ident" id="2072991">errorString</span><span class="op" id="2073002">(</span><span class="string" id="2073003">&#34;bad&nbsp;verb&nbsp;%&#34;</span>&nbsp;<span class="op" id="2073016">+</span>&nbsp;<span class="builtintype" id="2073018">string</span><span class="op" id="2073024">(</span><span class="ident" id="2073025">verb</span><span class="op" id="2073029">)</span>&nbsp;<span class="op" id="2073031">+</span>&nbsp;<span class="string" id="2073033">&#34;&nbsp;for&nbsp;&#34;</span>&nbsp;<span class="op" id="2073041">+</span>&nbsp;<span class="ident" id="2073043">typ</span><span class="op" id="2073046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2073049">return</span>&nbsp;<span class="builtintype" id="2073056">false</span><br>
<span class="lineno"></span><span class="op" id="2073062">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">550</span><span class="comment" id="2073065">//&nbsp;scanBool&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;boolean&nbsp;represented&nbsp;by&nbsp;the&nbsp;next&nbsp;token.</span><br>
<span class="lineno"></span><span class="keyword" id="2073141">func</span>&nbsp;<span class="op" id="2073146">(</span><span class="ident" id="2073147">s</span>&nbsp;<span class="op" id="2073149">*</span><span class="ident" id="2073150">ss</span><span class="op" id="2073152">)</span>&nbsp;<span class="ident" id="2073154">scanBool</span><span class="op" id="2073162">(</span><span class="ident" id="2073163">verb</span>&nbsp;<span class="builtintype" id="2073168">rune</span><span class="op" id="2073172">)</span>&nbsp;<span class="builtintype" id="2073174">bool</span>&nbsp;<span class="op" id="2073179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2073182">s</span><span class="op" id="2073183">.</span><span class="ident" id="2073184">skipSpace</span><span class="op" id="2073193">(</span><span class="builtintype" id="2073194">false</span><span class="op" id="2073199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2073202">s</span><span class="op" id="2073203">.</span><span class="ident" id="2073204">notEOF</span><span class="op" id="2073210">(</span><span class="op" id="2073211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2073214">if</span>&nbsp;<span class="op" id="2073217">!</span><span class="ident" id="2073218">s</span><span class="op" id="2073219">.</span><span class="ident" id="2073220">okVerb</span><span class="op" id="2073226">(</span><span class="ident" id="2073227">verb</span><span class="op" id="2073231">,</span>&nbsp;<span class="string" id="2073233">&#34;tv&#34;</span><span class="op" id="2073237">,</span>&nbsp;<span class="string" id="2073239">&#34;boolean&#34;</span><span class="op" id="2073248">)</span>&nbsp;<span class="op" id="2073250">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2073254">return</span>&nbsp;<span class="builtintype" id="2073261">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2073268">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2073271">//&nbsp;Syntax-checking&nbsp;a&nbsp;boolean&nbsp;is&nbsp;annoying.&nbsp;&nbsp;We&#39;re&nbsp;not&nbsp;fastidious&nbsp;about&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2073348">switch</span>&nbsp;<span class="ident" id="2073355">s</span><span class="op" id="2073356">.</span><span class="ident" id="2073357">getRune</span><span class="op" id="2073364">(</span><span class="op" id="2073365">)</span>&nbsp;<span class="op" id="2073367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2073370">case</span>&nbsp;<span class="string" id="2073375">&#39;0&#39;</span><span class="op" id="2073378">:</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2073382">return</span>&nbsp;<span class="builtintype" id="2073389">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2073396">case</span>&nbsp;<span class="string" id="2073401">&#39;1&#39;</span><span class="op" id="2073404">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2073408">return</span>&nbsp;<span class="builtintype" id="2073415">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2073421">case</span>&nbsp;<span class="string" id="2073426">&#39;t&#39;</span><span class="op" id="2073429">,</span>&nbsp;<span class="string" id="2073431">&#39;T&#39;</span><span class="op" id="2073434">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2073438">if</span>&nbsp;<span class="ident" id="2073441">s</span><span class="op" id="2073442">.</span><span class="ident" id="2073443">accept</span><span class="op" id="2073449">(</span><span class="string" id="2073450">&#34;rR&#34;</span><span class="op" id="2073454">)</span>&nbsp;<span class="op" id="2073456">&amp;&amp;</span>&nbsp;<span class="op" id="2073459">(</span><span class="op" id="2073460">!</span><span class="ident" id="2073461">s</span><span class="op" id="2073462">.</span><span class="ident" id="2073463">accept</span><span class="op" id="2073469">(</span><span class="string" id="2073470">&#34;uU&#34;</span><span class="op" id="2073474">)</span>&nbsp;<span class="op" id="2073476">||</span>&nbsp;<span class="op" id="2073479">!</span><span class="ident" id="2073480">s</span><span class="op" id="2073481">.</span><span class="ident" id="2073482">accept</span><span class="op" id="2073488">(</span><span class="string" id="2073489">&#34;eE&#34;</span><span class="op" id="2073493">)</span><span class="op" id="2073494">)</span>&nbsp;<span class="op" id="2073496">{</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2073501">s</span><span class="op" id="2073502">.</span><span class="builtintype" id="2073503">error</span><span class="op" id="2073508">(</span><span class="ident" id="2073509">boolError</span><span class="op" id="2073518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2073522">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2073526">return</span>&nbsp;<span class="builtintype" id="2073533">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2073539">case</span>&nbsp;<span class="string" id="2073544">&#39;f&#39;</span><span class="op" id="2073547">,</span>&nbsp;<span class="string" id="2073549">&#39;F&#39;</span><span class="op" id="2073552">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2073556">if</span>&nbsp;<span class="ident" id="2073559">s</span><span class="op" id="2073560">.</span><span class="ident" id="2073561">accept</span><span class="op" id="2073567">(</span><span class="string" id="2073568">&#34;aA&#34;</span><span class="op" id="2073572">)</span>&nbsp;<span class="op" id="2073574">&amp;&amp;</span>&nbsp;<span class="op" id="2073577">(</span><span class="op" id="2073578">!</span><span class="ident" id="2073579">s</span><span class="op" id="2073580">.</span><span class="ident" id="2073581">accept</span><span class="op" id="2073587">(</span><span class="string" id="2073588">&#34;lL&#34;</span><span class="op" id="2073592">)</span>&nbsp;<span class="op" id="2073594">||</span>&nbsp;<span class="op" id="2073597">!</span><span class="ident" id="2073598">s</span><span class="op" id="2073599">.</span><span class="ident" id="2073600">accept</span><span class="op" id="2073606">(</span><span class="string" id="2073607">&#34;sS&#34;</span><span class="op" id="2073611">)</span>&nbsp;<span class="op" id="2073613">||</span>&nbsp;<span class="op" id="2073616">!</span><span class="ident" id="2073617">s</span><span class="op" id="2073618">.</span><span class="ident" id="2073619">accept</span><span class="op" id="2073625">(</span><span class="string" id="2073626">&#34;eE&#34;</span><span class="op" id="2073630">)</span><span class="op" id="2073631">)</span>&nbsp;<span class="op" id="2073633">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2073638">s</span><span class="op" id="2073639">.</span><span class="builtintype" id="2073640">error</span><span class="op" id="2073645">(</span><span class="ident" id="2073646">boolError</span><span class="op" id="2073655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2073659">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2073663">return</span>&nbsp;<span class="builtintype" id="2073670">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2073677">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2073680">return</span>&nbsp;<span class="builtintype" id="2073687">false</span><br>
<span class="lineno">575</span><span class="op" id="2073693">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2073696">//&nbsp;Numerical&nbsp;elements</span><br>
<span class="lineno"></span><span class="keyword" id="2073718">const</span>&nbsp;<span class="op" id="2073724">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2073727">binaryDigits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2073745">=</span>&nbsp;<span class="string" id="2073747">&#34;01&#34;</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2073753">octalDigits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2073771">=</span>&nbsp;<span class="string" id="2073773">&#34;01234567&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2073785">decimalDigits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2073803">=</span>&nbsp;<span class="string" id="2073805">&#34;0123456789&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2073819">hexadecimalDigits</span>&nbsp;<span class="op" id="2073837">=</span>&nbsp;<span class="string" id="2073839">&#34;0123456789aAbBcCdDeEfF&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2073865">sign</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2073883">=</span>&nbsp;<span class="string" id="2073885">&#34;+-&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2073891">period</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2073909">=</span>&nbsp;<span class="string" id="2073911">&#34;.&#34;</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2073916">exponent</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2073934">=</span>&nbsp;<span class="string" id="2073936">&#34;eEp&#34;</span><br>
<span class="lineno"></span><span class="op" id="2073942">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2073945">//&nbsp;getBase&nbsp;returns&nbsp;the&nbsp;numeric&nbsp;base&nbsp;represented&nbsp;by&nbsp;the&nbsp;verb&nbsp;and&nbsp;its&nbsp;digit&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2074027">func</span>&nbsp;<span class="op" id="2074032">(</span><span class="ident" id="2074033">s</span>&nbsp;<span class="op" id="2074035">*</span><span class="ident" id="2074036">ss</span><span class="op" id="2074038">)</span>&nbsp;<span class="ident" id="2074040">getBase</span><span class="op" id="2074047">(</span><span class="ident" id="2074048">verb</span>&nbsp;<span class="builtintype" id="2074053">rune</span><span class="op" id="2074057">)</span>&nbsp;<span class="op" id="2074059">(</span><span class="ident" id="2074060">base</span>&nbsp;<span class="builtintype" id="2074065">int</span><span class="op" id="2074068">,</span>&nbsp;<span class="ident" id="2074070">digits</span>&nbsp;<span class="builtintype" id="2074077">string</span><span class="op" id="2074083">)</span>&nbsp;<span class="op" id="2074085">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2074088">s</span><span class="op" id="2074089">.</span><span class="ident" id="2074090">okVerb</span><span class="op" id="2074096">(</span><span class="ident" id="2074097">verb</span><span class="op" id="2074101">,</span>&nbsp;<span class="string" id="2074103">&#34;bdoUxXv&#34;</span><span class="op" id="2074112">,</span>&nbsp;<span class="string" id="2074114">&#34;integer&#34;</span><span class="op" id="2074123">)</span>&nbsp;<span class="comment" id="2074125">//&nbsp;sets&nbsp;s.err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2074140">base</span>&nbsp;<span class="op" id="2074145">=</span>&nbsp;<span class="num" id="2074147">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2074151">digits</span>&nbsp;<span class="op" id="2074158">=</span>&nbsp;<span class="ident" id="2074160">decimalDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2074175">switch</span>&nbsp;<span class="ident" id="2074182">verb</span>&nbsp;<span class="op" id="2074187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2074190">case</span>&nbsp;<span class="string" id="2074195">&#39;b&#39;</span><span class="op" id="2074198">:</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2074202">base</span>&nbsp;<span class="op" id="2074207">=</span>&nbsp;<span class="num" id="2074209">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2074213">digits</span>&nbsp;<span class="op" id="2074220">=</span>&nbsp;<span class="ident" id="2074222">binaryDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2074236">case</span>&nbsp;<span class="string" id="2074241">&#39;o&#39;</span><span class="op" id="2074244">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2074248">base</span>&nbsp;<span class="op" id="2074253">=</span>&nbsp;<span class="num" id="2074255">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2074259">digits</span>&nbsp;<span class="op" id="2074266">=</span>&nbsp;<span class="ident" id="2074268">octalDigits</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2074281">case</span>&nbsp;<span class="string" id="2074286">&#39;x&#39;</span><span class="op" id="2074289">,</span>&nbsp;<span class="string" id="2074291">&#39;X&#39;</span><span class="op" id="2074294">,</span>&nbsp;<span class="string" id="2074296">&#39;U&#39;</span><span class="op" id="2074299">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2074303">base</span>&nbsp;<span class="op" id="2074308">=</span>&nbsp;<span class="num" id="2074310">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2074315">digits</span>&nbsp;<span class="op" id="2074322">=</span>&nbsp;<span class="ident" id="2074324">hexadecimalDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2074343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2074346">return</span><br>
<span class="lineno">605</span><span class="op" id="2074353">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2074356">//&nbsp;scanNumber&nbsp;returns&nbsp;the&nbsp;numerical&nbsp;string&nbsp;with&nbsp;specified&nbsp;digits&nbsp;starting&nbsp;here.</span><br>
<span class="lineno"></span><span class="keyword" id="2074436">func</span>&nbsp;<span class="op" id="2074441">(</span><span class="ident" id="2074442">s</span>&nbsp;<span class="op" id="2074444">*</span><span class="ident" id="2074445">ss</span><span class="op" id="2074447">)</span>&nbsp;<span class="ident" id="2074449">scanNumber</span><span class="op" id="2074459">(</span><span class="ident" id="2074460">digits</span>&nbsp;<span class="builtintype" id="2074467">string</span><span class="op" id="2074473">,</span>&nbsp;<span class="ident" id="2074475">haveDigits</span>&nbsp;<span class="builtintype" id="2074486">bool</span><span class="op" id="2074490">)</span>&nbsp;<span class="builtintype" id="2074492">string</span>&nbsp;<span class="op" id="2074499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2074502">if</span>&nbsp;<span class="op" id="2074505">!</span><span class="ident" id="2074506">haveDigits</span>&nbsp;<span class="op" id="2074517">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2074521">s</span><span class="op" id="2074522">.</span><span class="ident" id="2074523">notEOF</span><span class="op" id="2074529">(</span><span class="op" id="2074530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2074534">if</span>&nbsp;<span class="op" id="2074537">!</span><span class="ident" id="2074538">s</span><span class="op" id="2074539">.</span><span class="ident" id="2074540">accept</span><span class="op" id="2074546">(</span><span class="ident" id="2074547">digits</span><span class="op" id="2074553">)</span>&nbsp;<span class="op" id="2074555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2074560">s</span><span class="op" id="2074561">.</span><span class="ident" id="2074562">errorString</span><span class="op" id="2074573">(</span><span class="string" id="2074574">&#34;expected&nbsp;integer&#34;</span><span class="op" id="2074592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2074596">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2074599">}</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2074602">for</span>&nbsp;<span class="ident" id="2074606">s</span><span class="op" id="2074607">.</span><span class="ident" id="2074608">accept</span><span class="op" id="2074614">(</span><span class="ident" id="2074615">digits</span><span class="op" id="2074621">)</span>&nbsp;<span class="op" id="2074623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2074626">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2074629">return</span>&nbsp;<span class="builtintype" id="2074636">string</span><span class="op" id="2074642">(</span><span class="ident" id="2074643">s</span><span class="op" id="2074644">.</span><span class="ident" id="2074645">buf</span><span class="op" id="2074648">)</span><br>
<span class="lineno"></span><span class="op" id="2074650">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">620</span><span class="comment" id="2074653">//&nbsp;scanRune&nbsp;returns&nbsp;the&nbsp;next&nbsp;rune&nbsp;value&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="keyword" id="2074707">func</span>&nbsp;<span class="op" id="2074712">(</span><span class="ident" id="2074713">s</span>&nbsp;<span class="op" id="2074715">*</span><span class="ident" id="2074716">ss</span><span class="op" id="2074718">)</span>&nbsp;<span class="ident" id="2074720">scanRune</span><span class="op" id="2074728">(</span><span class="ident" id="2074729">bitSize</span>&nbsp;<span class="builtintype" id="2074737">int</span><span class="op" id="2074740">)</span>&nbsp;<span class="ident" id="2074742">int64</span>&nbsp;<span class="op" id="2074748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2074751">s</span><span class="op" id="2074752">.</span><span class="ident" id="2074753">notEOF</span><span class="op" id="2074759">(</span><span class="op" id="2074760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2074763">r</span>&nbsp;<span class="op" id="2074765">:=</span>&nbsp;<span class="ident" id="2074768">int64</span><span class="op" id="2074773">(</span><span class="ident" id="2074774">s</span><span class="op" id="2074775">.</span><span class="ident" id="2074776">getRune</span><span class="op" id="2074783">(</span><span class="op" id="2074784">)</span><span class="op" id="2074785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2074788">n</span>&nbsp;<span class="op" id="2074790">:=</span>&nbsp;<span class="builtintype" id="2074793">uint</span><span class="op" id="2074797">(</span><span class="ident" id="2074798">bitSize</span><span class="op" id="2074805">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2074808">x</span>&nbsp;<span class="op" id="2074810">:=</span>&nbsp;<span class="op" id="2074813">(</span><span class="ident" id="2074814">r</span>&nbsp;<span class="op" id="2074816">&lt;&lt;</span>&nbsp;<span class="op" id="2074819">(</span><span class="num" id="2074820">64</span>&nbsp;<span class="op" id="2074823">-</span>&nbsp;<span class="ident" id="2074825">n</span><span class="op" id="2074826">)</span><span class="op" id="2074827">)</span>&nbsp;<span class="op" id="2074829">&gt;&gt;</span>&nbsp;<span class="op" id="2074832">(</span><span class="num" id="2074833">64</span>&nbsp;<span class="op" id="2074836">-</span>&nbsp;<span class="ident" id="2074838">n</span><span class="op" id="2074839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2074842">if</span>&nbsp;<span class="ident" id="2074845">x</span>&nbsp;<span class="op" id="2074847">!=</span>&nbsp;<span class="ident" id="2074850">r</span>&nbsp;<span class="op" id="2074852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2074856">s</span><span class="op" id="2074857">.</span><span class="ident" id="2074858">errorString</span><span class="op" id="2074869">(</span><span class="string" id="2074870">&#34;overflow&nbsp;on&nbsp;character&nbsp;value&nbsp;&#34;</span>&nbsp;<span class="op" id="2074901">+</span>&nbsp;<span class="builtintype" id="2074903">string</span><span class="op" id="2074909">(</span><span class="ident" id="2074910">r</span><span class="op" id="2074911">)</span><span class="op" id="2074912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2074915">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2074918">return</span>&nbsp;<span class="ident" id="2074925">r</span><br>
<span class="lineno">630</span><span class="op" id="2074927">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2074930">//&nbsp;scanBasePrefix&nbsp;reports&nbsp;whether&nbsp;the&nbsp;integer&nbsp;begins&nbsp;with&nbsp;a&nbsp;0&nbsp;or&nbsp;0x,</span><br>
<span class="lineno"></span><span class="comment" id="2074999">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;base,&nbsp;digit&nbsp;string,&nbsp;and&nbsp;whether&nbsp;a&nbsp;zero&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span><span class="comment" id="2075068">//&nbsp;It&nbsp;is&nbsp;called&nbsp;only&nbsp;if&nbsp;the&nbsp;verb&nbsp;is&nbsp;%v.</span><br>
<span class="lineno">635</span><span class="keyword" id="2075108">func</span>&nbsp;<span class="op" id="2075113">(</span><span class="ident" id="2075114">s</span>&nbsp;<span class="op" id="2075116">*</span><span class="ident" id="2075117">ss</span><span class="op" id="2075119">)</span>&nbsp;<span class="ident" id="2075121">scanBasePrefix</span><span class="op" id="2075135">(</span><span class="op" id="2075136">)</span>&nbsp;<span class="op" id="2075138">(</span><span class="ident" id="2075139">base</span>&nbsp;<span class="builtintype" id="2075144">int</span><span class="op" id="2075147">,</span>&nbsp;<span class="ident" id="2075149">digits</span>&nbsp;<span class="builtintype" id="2075156">string</span><span class="op" id="2075162">,</span>&nbsp;<span class="ident" id="2075164">found</span>&nbsp;<span class="builtintype" id="2075170">bool</span><span class="op" id="2075174">)</span>&nbsp;<span class="op" id="2075176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2075179">if</span>&nbsp;<span class="op" id="2075182">!</span><span class="ident" id="2075183">s</span><span class="op" id="2075184">.</span><span class="ident" id="2075185">peek</span><span class="op" id="2075189">(</span><span class="string" id="2075190">&#34;0&#34;</span><span class="op" id="2075193">)</span>&nbsp;<span class="op" id="2075195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2075199">return</span>&nbsp;<span class="num" id="2075206">10</span><span class="op" id="2075208">,</span>&nbsp;<span class="ident" id="2075210">decimalDigits</span><span class="op" id="2075223">,</span>&nbsp;<span class="builtintype" id="2075225">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2075232">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2075235">s</span><span class="op" id="2075236">.</span><span class="ident" id="2075237">accept</span><span class="op" id="2075243">(</span><span class="string" id="2075244">&#34;0&#34;</span><span class="op" id="2075247">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2075250">found</span>&nbsp;<span class="op" id="2075256">=</span>&nbsp;<span class="builtintype" id="2075258">true</span>&nbsp;<span class="comment" id="2075263">//&nbsp;We&#39;ve&nbsp;put&nbsp;a&nbsp;digit&nbsp;into&nbsp;the&nbsp;token&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2075308">//&nbsp;Special&nbsp;cases&nbsp;for&nbsp;&#39;0&#39;&nbsp;&amp;&amp;&nbsp;&#39;0x&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2075342">base</span><span class="op" id="2075346">,</span>&nbsp;<span class="ident" id="2075348">digits</span>&nbsp;<span class="op" id="2075355">=</span>&nbsp;<span class="num" id="2075357">8</span><span class="op" id="2075358">,</span>&nbsp;<span class="ident" id="2075360">octalDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2075373">if</span>&nbsp;<span class="ident" id="2075376">s</span><span class="op" id="2075377">.</span><span class="ident" id="2075378">peek</span><span class="op" id="2075382">(</span><span class="string" id="2075383">&#34;xX&#34;</span><span class="op" id="2075387">)</span>&nbsp;<span class="op" id="2075389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2075393">s</span><span class="op" id="2075394">.</span><span class="ident" id="2075395">consume</span><span class="op" id="2075402">(</span><span class="string" id="2075403">&#34;xX&#34;</span><span class="op" id="2075407">,</span>&nbsp;<span class="builtintype" id="2075409">false</span><span class="op" id="2075414">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2075418">base</span><span class="op" id="2075422">,</span>&nbsp;<span class="ident" id="2075424">digits</span>&nbsp;<span class="op" id="2075431">=</span>&nbsp;<span class="num" id="2075433">16</span><span class="op" id="2075435">,</span>&nbsp;<span class="ident" id="2075437">hexadecimalDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2075456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2075459">return</span><br>
<span class="lineno"></span><span class="op" id="2075466">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">650</span><span class="comment" id="2075469">//&nbsp;scanInt&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;integer&nbsp;represented&nbsp;by&nbsp;the&nbsp;next</span><br>
<span class="lineno"></span><span class="comment" id="2075537">//&nbsp;token,&nbsp;checking&nbsp;for&nbsp;overflow.&nbsp;&nbsp;Any&nbsp;error&nbsp;is&nbsp;stored&nbsp;in&nbsp;s.err.</span><br>
<span class="lineno"></span><span class="keyword" id="2075601">func</span>&nbsp;<span class="op" id="2075606">(</span><span class="ident" id="2075607">s</span>&nbsp;<span class="op" id="2075609">*</span><span class="ident" id="2075610">ss</span><span class="op" id="2075612">)</span>&nbsp;<span class="ident" id="2075614">scanInt</span><span class="op" id="2075621">(</span><span class="ident" id="2075622">verb</span>&nbsp;<span class="builtintype" id="2075627">rune</span><span class="op" id="2075631">,</span>&nbsp;<span class="ident" id="2075633">bitSize</span>&nbsp;<span class="builtintype" id="2075641">int</span><span class="op" id="2075644">)</span>&nbsp;<span class="ident" id="2075646">int64</span>&nbsp;<span class="op" id="2075652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2075655">if</span>&nbsp;<span class="ident" id="2075658">verb</span>&nbsp;<span class="op" id="2075663">==</span>&nbsp;<span class="string" id="2075666">&#39;c&#39;</span>&nbsp;<span class="op" id="2075670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2075674">return</span>&nbsp;<span class="ident" id="2075681">s</span><span class="op" id="2075682">.</span><span class="ident" id="2075683">scanRune</span><span class="op" id="2075691">(</span><span class="ident" id="2075692">bitSize</span><span class="op" id="2075699">)</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2075702">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2075705">s</span><span class="op" id="2075706">.</span><span class="ident" id="2075707">skipSpace</span><span class="op" id="2075716">(</span><span class="builtintype" id="2075717">false</span><span class="op" id="2075722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2075725">s</span><span class="op" id="2075726">.</span><span class="ident" id="2075727">notEOF</span><span class="op" id="2075733">(</span><span class="op" id="2075734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2075737">base</span><span class="op" id="2075741">,</span>&nbsp;<span class="ident" id="2075743">digits</span>&nbsp;<span class="op" id="2075750">:=</span>&nbsp;<span class="ident" id="2075753">s</span><span class="op" id="2075754">.</span><span class="ident" id="2075755">getBase</span><span class="op" id="2075762">(</span><span class="ident" id="2075763">verb</span><span class="op" id="2075767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2075770">haveDigits</span>&nbsp;<span class="op" id="2075781">:=</span>&nbsp;<span class="builtintype" id="2075784">false</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2075791">if</span>&nbsp;<span class="ident" id="2075794">verb</span>&nbsp;<span class="op" id="2075799">==</span>&nbsp;<span class="string" id="2075802">&#39;U&#39;</span>&nbsp;<span class="op" id="2075806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2075810">if</span>&nbsp;<span class="op" id="2075813">!</span><span class="ident" id="2075814">s</span><span class="op" id="2075815">.</span><span class="ident" id="2075816">consume</span><span class="op" id="2075823">(</span><span class="string" id="2075824">&#34;U&#34;</span><span class="op" id="2075827">,</span>&nbsp;<span class="builtintype" id="2075829">false</span><span class="op" id="2075834">)</span>&nbsp;<span class="op" id="2075836">||</span>&nbsp;<span class="op" id="2075839">!</span><span class="ident" id="2075840">s</span><span class="op" id="2075841">.</span><span class="ident" id="2075842">consume</span><span class="op" id="2075849">(</span><span class="string" id="2075850">&#34;+&#34;</span><span class="op" id="2075853">,</span>&nbsp;<span class="builtintype" id="2075855">false</span><span class="op" id="2075860">)</span>&nbsp;<span class="op" id="2075862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2075867">s</span><span class="op" id="2075868">.</span><span class="ident" id="2075869">errorString</span><span class="op" id="2075880">(</span><span class="string" id="2075881">&#34;bad&nbsp;unicode&nbsp;format&nbsp;&#34;</span><span class="op" id="2075902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2075906">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2075909">}</span>&nbsp;<span class="keyword" id="2075911">else</span>&nbsp;<span class="op" id="2075916">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2075920">s</span><span class="op" id="2075921">.</span><span class="ident" id="2075922">accept</span><span class="op" id="2075928">(</span><span class="ident" id="2075929">sign</span><span class="op" id="2075933">)</span>&nbsp;<span class="comment" id="2075935">//&nbsp;If&nbsp;there&#39;s&nbsp;a&nbsp;sign,&nbsp;it&nbsp;will&nbsp;be&nbsp;left&nbsp;in&nbsp;the&nbsp;token&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2075996">if</span>&nbsp;<span class="ident" id="2075999">verb</span>&nbsp;<span class="op" id="2076004">==</span>&nbsp;<span class="string" id="2076007">&#39;v&#39;</span>&nbsp;<span class="op" id="2076011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2076016">base</span><span class="op" id="2076020">,</span>&nbsp;<span class="ident" id="2076022">digits</span><span class="op" id="2076028">,</span>&nbsp;<span class="ident" id="2076030">haveDigits</span>&nbsp;<span class="op" id="2076041">=</span>&nbsp;<span class="ident" id="2076043">s</span><span class="op" id="2076044">.</span><span class="ident" id="2076045">scanBasePrefix</span><span class="op" id="2076059">(</span><span class="op" id="2076060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2076064">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2076067">}</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2076070">tok</span>&nbsp;<span class="op" id="2076074">:=</span>&nbsp;<span class="ident" id="2076077">s</span><span class="op" id="2076078">.</span><span class="ident" id="2076079">scanNumber</span><span class="op" id="2076089">(</span><span class="ident" id="2076090">digits</span><span class="op" id="2076096">,</span>&nbsp;<span class="ident" id="2076098">haveDigits</span><span class="op" id="2076108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2076111">i</span><span class="op" id="2076112">,</span>&nbsp;<span class="ident" id="2076114">err</span>&nbsp;<span class="op" id="2076118">:=</span>&nbsp;<span class="ident" id="2076121">strconv</span><span class="op" id="2076128">.</span><span class="ident" id="2076129">ParseInt</span><span class="op" id="2076137">(</span><span class="ident" id="2076138">tok</span><span class="op" id="2076141">,</span>&nbsp;<span class="ident" id="2076143">base</span><span class="op" id="2076147">,</span>&nbsp;<span class="num" id="2076149">64</span><span class="op" id="2076151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2076154">if</span>&nbsp;<span class="ident" id="2076157">err</span>&nbsp;<span class="op" id="2076161">!=</span>&nbsp;<span class="ident" id="2076164">nil</span>&nbsp;<span class="op" id="2076168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2076172">s</span><span class="op" id="2076173">.</span><span class="builtintype" id="2076174">error</span><span class="op" id="2076179">(</span><span class="ident" id="2076180">err</span><span class="op" id="2076183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2076186">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2076189">n</span>&nbsp;<span class="op" id="2076191">:=</span>&nbsp;<span class="builtintype" id="2076194">uint</span><span class="op" id="2076198">(</span><span class="ident" id="2076199">bitSize</span><span class="op" id="2076206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2076209">x</span>&nbsp;<span class="op" id="2076211">:=</span>&nbsp;<span class="op" id="2076214">(</span><span class="ident" id="2076215">i</span>&nbsp;<span class="op" id="2076217">&lt;&lt;</span>&nbsp;<span class="op" id="2076220">(</span><span class="num" id="2076221">64</span>&nbsp;<span class="op" id="2076224">-</span>&nbsp;<span class="ident" id="2076226">n</span><span class="op" id="2076227">)</span><span class="op" id="2076228">)</span>&nbsp;<span class="op" id="2076230">&gt;&gt;</span>&nbsp;<span class="op" id="2076233">(</span><span class="num" id="2076234">64</span>&nbsp;<span class="op" id="2076237">-</span>&nbsp;<span class="ident" id="2076239">n</span><span class="op" id="2076240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2076243">if</span>&nbsp;<span class="ident" id="2076246">x</span>&nbsp;<span class="op" id="2076248">!=</span>&nbsp;<span class="ident" id="2076251">i</span>&nbsp;<span class="op" id="2076253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2076257">s</span><span class="op" id="2076258">.</span><span class="ident" id="2076259">errorString</span><span class="op" id="2076270">(</span><span class="string" id="2076271">&#34;integer&nbsp;overflow&nbsp;on&nbsp;token&nbsp;&#34;</span>&nbsp;<span class="op" id="2076300">+</span>&nbsp;<span class="ident" id="2076302">tok</span><span class="op" id="2076305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2076308">}</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2076311">return</span>&nbsp;<span class="ident" id="2076318">i</span><br>
<span class="lineno"></span><span class="op" id="2076320">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2076323">//&nbsp;scanUint&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;unsigned&nbsp;integer&nbsp;represented</span><br>
<span class="lineno"></span><span class="comment" id="2076389">//&nbsp;by&nbsp;the&nbsp;next&nbsp;token,&nbsp;checking&nbsp;for&nbsp;overflow.&nbsp;&nbsp;Any&nbsp;error&nbsp;is&nbsp;stored&nbsp;in&nbsp;s.err.</span><br>
<span class="lineno">685</span><span class="keyword" id="2076465">func</span>&nbsp;<span class="op" id="2076470">(</span><span class="ident" id="2076471">s</span>&nbsp;<span class="op" id="2076473">*</span><span class="ident" id="2076474">ss</span><span class="op" id="2076476">)</span>&nbsp;<span class="ident" id="2076478">scanUint</span><span class="op" id="2076486">(</span><span class="ident" id="2076487">verb</span>&nbsp;<span class="builtintype" id="2076492">rune</span><span class="op" id="2076496">,</span>&nbsp;<span class="ident" id="2076498">bitSize</span>&nbsp;<span class="builtintype" id="2076506">int</span><span class="op" id="2076509">)</span>&nbsp;<span class="ident" id="2076511">uint64</span>&nbsp;<span class="op" id="2076518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2076521">if</span>&nbsp;<span class="ident" id="2076524">verb</span>&nbsp;<span class="op" id="2076529">==</span>&nbsp;<span class="string" id="2076532">&#39;c&#39;</span>&nbsp;<span class="op" id="2076536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2076540">return</span>&nbsp;<span class="ident" id="2076547">uint64</span><span class="op" id="2076553">(</span><span class="ident" id="2076554">s</span><span class="op" id="2076555">.</span><span class="ident" id="2076556">scanRune</span><span class="op" id="2076564">(</span><span class="ident" id="2076565">bitSize</span><span class="op" id="2076572">)</span><span class="op" id="2076573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2076576">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2076579">s</span><span class="op" id="2076580">.</span><span class="ident" id="2076581">skipSpace</span><span class="op" id="2076590">(</span><span class="builtintype" id="2076591">false</span><span class="op" id="2076596">)</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2076599">s</span><span class="op" id="2076600">.</span><span class="ident" id="2076601">notEOF</span><span class="op" id="2076607">(</span><span class="op" id="2076608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2076611">base</span><span class="op" id="2076615">,</span>&nbsp;<span class="ident" id="2076617">digits</span>&nbsp;<span class="op" id="2076624">:=</span>&nbsp;<span class="ident" id="2076627">s</span><span class="op" id="2076628">.</span><span class="ident" id="2076629">getBase</span><span class="op" id="2076636">(</span><span class="ident" id="2076637">verb</span><span class="op" id="2076641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2076644">haveDigits</span>&nbsp;<span class="op" id="2076655">:=</span>&nbsp;<span class="builtintype" id="2076658">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2076665">if</span>&nbsp;<span class="ident" id="2076668">verb</span>&nbsp;<span class="op" id="2076673">==</span>&nbsp;<span class="string" id="2076676">&#39;U&#39;</span>&nbsp;<span class="op" id="2076680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2076684">if</span>&nbsp;<span class="op" id="2076687">!</span><span class="ident" id="2076688">s</span><span class="op" id="2076689">.</span><span class="ident" id="2076690">consume</span><span class="op" id="2076697">(</span><span class="string" id="2076698">&#34;U&#34;</span><span class="op" id="2076701">,</span>&nbsp;<span class="builtintype" id="2076703">false</span><span class="op" id="2076708">)</span>&nbsp;<span class="op" id="2076710">||</span>&nbsp;<span class="op" id="2076713">!</span><span class="ident" id="2076714">s</span><span class="op" id="2076715">.</span><span class="ident" id="2076716">consume</span><span class="op" id="2076723">(</span><span class="string" id="2076724">&#34;+&#34;</span><span class="op" id="2076727">,</span>&nbsp;<span class="builtintype" id="2076729">false</span><span class="op" id="2076734">)</span>&nbsp;<span class="op" id="2076736">{</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2076741">s</span><span class="op" id="2076742">.</span><span class="ident" id="2076743">errorString</span><span class="op" id="2076754">(</span><span class="string" id="2076755">&#34;bad&nbsp;unicode&nbsp;format&nbsp;&#34;</span><span class="op" id="2076776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2076780">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2076783">}</span>&nbsp;<span class="keyword" id="2076785">else</span>&nbsp;<span class="keyword" id="2076790">if</span>&nbsp;<span class="ident" id="2076793">verb</span>&nbsp;<span class="op" id="2076798">==</span>&nbsp;<span class="string" id="2076801">&#39;v&#39;</span>&nbsp;<span class="op" id="2076805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2076809">base</span><span class="op" id="2076813">,</span>&nbsp;<span class="ident" id="2076815">digits</span><span class="op" id="2076821">,</span>&nbsp;<span class="ident" id="2076823">haveDigits</span>&nbsp;<span class="op" id="2076834">=</span>&nbsp;<span class="ident" id="2076836">s</span><span class="op" id="2076837">.</span><span class="ident" id="2076838">scanBasePrefix</span><span class="op" id="2076852">(</span><span class="op" id="2076853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2076856">}</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2076859">tok</span>&nbsp;<span class="op" id="2076863">:=</span>&nbsp;<span class="ident" id="2076866">s</span><span class="op" id="2076867">.</span><span class="ident" id="2076868">scanNumber</span><span class="op" id="2076878">(</span><span class="ident" id="2076879">digits</span><span class="op" id="2076885">,</span>&nbsp;<span class="ident" id="2076887">haveDigits</span><span class="op" id="2076897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2076900">i</span><span class="op" id="2076901">,</span>&nbsp;<span class="ident" id="2076903">err</span>&nbsp;<span class="op" id="2076907">:=</span>&nbsp;<span class="ident" id="2076910">strconv</span><span class="op" id="2076917">.</span><span class="ident" id="2076918">ParseUint</span><span class="op" id="2076927">(</span><span class="ident" id="2076928">tok</span><span class="op" id="2076931">,</span>&nbsp;<span class="ident" id="2076933">base</span><span class="op" id="2076937">,</span>&nbsp;<span class="num" id="2076939">64</span><span class="op" id="2076941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2076944">if</span>&nbsp;<span class="ident" id="2076947">err</span>&nbsp;<span class="op" id="2076951">!=</span>&nbsp;<span class="ident" id="2076954">nil</span>&nbsp;<span class="op" id="2076958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2076962">s</span><span class="op" id="2076963">.</span><span class="builtintype" id="2076964">error</span><span class="op" id="2076969">(</span><span class="ident" id="2076970">err</span><span class="op" id="2076973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2076976">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2076979">n</span>&nbsp;<span class="op" id="2076981">:=</span>&nbsp;<span class="builtintype" id="2076984">uint</span><span class="op" id="2076988">(</span><span class="ident" id="2076989">bitSize</span><span class="op" id="2076996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2076999">x</span>&nbsp;<span class="op" id="2077001">:=</span>&nbsp;<span class="op" id="2077004">(</span><span class="ident" id="2077005">i</span>&nbsp;<span class="op" id="2077007">&lt;&lt;</span>&nbsp;<span class="op" id="2077010">(</span><span class="num" id="2077011">64</span>&nbsp;<span class="op" id="2077014">-</span>&nbsp;<span class="ident" id="2077016">n</span><span class="op" id="2077017">)</span><span class="op" id="2077018">)</span>&nbsp;<span class="op" id="2077020">&gt;&gt;</span>&nbsp;<span class="op" id="2077023">(</span><span class="num" id="2077024">64</span>&nbsp;<span class="op" id="2077027">-</span>&nbsp;<span class="ident" id="2077029">n</span><span class="op" id="2077030">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2077033">if</span>&nbsp;<span class="ident" id="2077036">x</span>&nbsp;<span class="op" id="2077038">!=</span>&nbsp;<span class="ident" id="2077041">i</span>&nbsp;<span class="op" id="2077043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2077047">s</span><span class="op" id="2077048">.</span><span class="ident" id="2077049">errorString</span><span class="op" id="2077060">(</span><span class="string" id="2077061">&#34;unsigned&nbsp;integer&nbsp;overflow&nbsp;on&nbsp;token&nbsp;&#34;</span>&nbsp;<span class="op" id="2077099">+</span>&nbsp;<span class="ident" id="2077101">tok</span><span class="op" id="2077104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2077107">}</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2077110">return</span>&nbsp;<span class="ident" id="2077117">i</span><br>
<span class="lineno"></span><span class="op" id="2077119">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2077122">//&nbsp;floatToken&nbsp;returns&nbsp;the&nbsp;floating-point&nbsp;number&nbsp;starting&nbsp;here,&nbsp;no&nbsp;longer&nbsp;than&nbsp;swid</span><br>
<span class="lineno"></span><span class="comment" id="2077205">//&nbsp;if&nbsp;the&nbsp;width&nbsp;is&nbsp;specified.&nbsp;It&#39;s&nbsp;not&nbsp;rigorous&nbsp;about&nbsp;syntax&nbsp;because&nbsp;it&nbsp;doesn&#39;t&nbsp;check&nbsp;that</span><br>
<span class="lineno">715</span><span class="comment" id="2077296">//&nbsp;we&nbsp;have&nbsp;at&nbsp;least&nbsp;some&nbsp;digits,&nbsp;but&nbsp;Atof&nbsp;will&nbsp;do&nbsp;that.</span><br>
<span class="lineno"></span><span class="keyword" id="2077352">func</span>&nbsp;<span class="op" id="2077357">(</span><span class="ident" id="2077358">s</span>&nbsp;<span class="op" id="2077360">*</span><span class="ident" id="2077361">ss</span><span class="op" id="2077363">)</span>&nbsp;<span class="ident" id="2077365">floatToken</span><span class="op" id="2077375">(</span><span class="op" id="2077376">)</span>&nbsp;<span class="builtintype" id="2077378">string</span>&nbsp;<span class="op" id="2077385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2077388">s</span><span class="op" id="2077389">.</span><span class="ident" id="2077390">buf</span>&nbsp;<span class="op" id="2077394">=</span>&nbsp;<span class="ident" id="2077396">s</span><span class="op" id="2077397">.</span><span class="ident" id="2077398">buf</span><span class="op" id="2077401">[</span><span class="op" id="2077402">:</span><span class="num" id="2077403">0</span><span class="op" id="2077404">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2077407">//&nbsp;NaN?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2077416">if</span>&nbsp;<span class="ident" id="2077419">s</span><span class="op" id="2077420">.</span><span class="ident" id="2077421">accept</span><span class="op" id="2077427">(</span><span class="string" id="2077428">&#34;nN&#34;</span><span class="op" id="2077432">)</span>&nbsp;<span class="op" id="2077434">&amp;&amp;</span>&nbsp;<span class="ident" id="2077437">s</span><span class="op" id="2077438">.</span><span class="ident" id="2077439">accept</span><span class="op" id="2077445">(</span><span class="string" id="2077446">&#34;aA&#34;</span><span class="op" id="2077450">)</span>&nbsp;<span class="op" id="2077452">&amp;&amp;</span>&nbsp;<span class="ident" id="2077455">s</span><span class="op" id="2077456">.</span><span class="ident" id="2077457">accept</span><span class="op" id="2077463">(</span><span class="string" id="2077464">&#34;nN&#34;</span><span class="op" id="2077468">)</span>&nbsp;<span class="op" id="2077470">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2077474">return</span>&nbsp;<span class="builtintype" id="2077481">string</span><span class="op" id="2077487">(</span><span class="ident" id="2077488">s</span><span class="op" id="2077489">.</span><span class="ident" id="2077490">buf</span><span class="op" id="2077493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2077496">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2077499">//&nbsp;leading&nbsp;sign?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2077517">s</span><span class="op" id="2077518">.</span><span class="ident" id="2077519">accept</span><span class="op" id="2077525">(</span><span class="ident" id="2077526">sign</span><span class="op" id="2077530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2077533">//&nbsp;Inf?</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2077542">if</span>&nbsp;<span class="ident" id="2077545">s</span><span class="op" id="2077546">.</span><span class="ident" id="2077547">accept</span><span class="op" id="2077553">(</span><span class="string" id="2077554">&#34;iI&#34;</span><span class="op" id="2077558">)</span>&nbsp;<span class="op" id="2077560">&amp;&amp;</span>&nbsp;<span class="ident" id="2077563">s</span><span class="op" id="2077564">.</span><span class="ident" id="2077565">accept</span><span class="op" id="2077571">(</span><span class="string" id="2077572">&#34;nN&#34;</span><span class="op" id="2077576">)</span>&nbsp;<span class="op" id="2077578">&amp;&amp;</span>&nbsp;<span class="ident" id="2077581">s</span><span class="op" id="2077582">.</span><span class="ident" id="2077583">accept</span><span class="op" id="2077589">(</span><span class="string" id="2077590">&#34;fF&#34;</span><span class="op" id="2077594">)</span>&nbsp;<span class="op" id="2077596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2077600">return</span>&nbsp;<span class="builtintype" id="2077607">string</span><span class="op" id="2077613">(</span><span class="ident" id="2077614">s</span><span class="op" id="2077615">.</span><span class="ident" id="2077616">buf</span><span class="op" id="2077619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2077622">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2077625">//&nbsp;digits?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2077637">for</span>&nbsp;<span class="ident" id="2077641">s</span><span class="op" id="2077642">.</span><span class="ident" id="2077643">accept</span><span class="op" id="2077649">(</span><span class="ident" id="2077650">decimalDigits</span><span class="op" id="2077663">)</span>&nbsp;<span class="op" id="2077665">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2077668">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2077671">//&nbsp;decimal&nbsp;point?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2077690">if</span>&nbsp;<span class="ident" id="2077693">s</span><span class="op" id="2077694">.</span><span class="ident" id="2077695">accept</span><span class="op" id="2077701">(</span><span class="ident" id="2077702">period</span><span class="op" id="2077708">)</span>&nbsp;<span class="op" id="2077710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2077714">//&nbsp;fraction?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2077729">for</span>&nbsp;<span class="ident" id="2077733">s</span><span class="op" id="2077734">.</span><span class="ident" id="2077735">accept</span><span class="op" id="2077741">(</span><span class="ident" id="2077742">decimalDigits</span><span class="op" id="2077755">)</span>&nbsp;<span class="op" id="2077757">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2077761">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2077764">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2077767">//&nbsp;exponent?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2077781">if</span>&nbsp;<span class="ident" id="2077784">s</span><span class="op" id="2077785">.</span><span class="ident" id="2077786">accept</span><span class="op" id="2077792">(</span><span class="ident" id="2077793">exponent</span><span class="op" id="2077801">)</span>&nbsp;<span class="op" id="2077803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2077807">//&nbsp;leading&nbsp;sign?</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2077826">s</span><span class="op" id="2077827">.</span><span class="ident" id="2077828">accept</span><span class="op" id="2077834">(</span><span class="ident" id="2077835">sign</span><span class="op" id="2077839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2077843">//&nbsp;digits?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2077856">for</span>&nbsp;<span class="ident" id="2077860">s</span><span class="op" id="2077861">.</span><span class="ident" id="2077862">accept</span><span class="op" id="2077868">(</span><span class="ident" id="2077869">decimalDigits</span><span class="op" id="2077882">)</span>&nbsp;<span class="op" id="2077884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2077888">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2077891">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2077894">return</span>&nbsp;<span class="builtintype" id="2077901">string</span><span class="op" id="2077907">(</span><span class="ident" id="2077908">s</span><span class="op" id="2077909">.</span><span class="ident" id="2077910">buf</span><span class="op" id="2077913">)</span><br>
<span class="lineno"></span><span class="op" id="2077915">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2077918">//&nbsp;complexTokens&nbsp;returns&nbsp;the&nbsp;real&nbsp;and&nbsp;imaginary&nbsp;parts&nbsp;of&nbsp;the&nbsp;complex&nbsp;number&nbsp;starting&nbsp;here.</span><br>
<span class="lineno"></span><span class="comment" id="2078009">//&nbsp;The&nbsp;number&nbsp;might&nbsp;be&nbsp;parenthesized&nbsp;and&nbsp;has&nbsp;the&nbsp;format&nbsp;(N+Ni)&nbsp;where&nbsp;N&nbsp;is&nbsp;a&nbsp;floating-point</span><br>
<span class="lineno">750</span><span class="comment" id="2078100">//&nbsp;number&nbsp;and&nbsp;there&nbsp;are&nbsp;no&nbsp;spaces&nbsp;within.</span><br>
<span class="lineno"></span><span class="keyword" id="2078142">func</span>&nbsp;<span class="op" id="2078147">(</span><span class="ident" id="2078148">s</span>&nbsp;<span class="op" id="2078150">*</span><span class="ident" id="2078151">ss</span><span class="op" id="2078153">)</span>&nbsp;<span class="ident" id="2078155">complexTokens</span><span class="op" id="2078168">(</span><span class="op" id="2078169">)</span>&nbsp;<span class="op" id="2078171">(</span><span class="builtinfunc" id="2078172">real</span><span class="op" id="2078176">,</span>&nbsp;<span class="builtinfunc" id="2078178">imag</span>&nbsp;<span class="builtintype" id="2078183">string</span><span class="op" id="2078189">)</span>&nbsp;<span class="op" id="2078191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2078194">//&nbsp;TODO:&nbsp;accept&nbsp;N&nbsp;and&nbsp;Ni&nbsp;independently?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2078235">parens</span>&nbsp;<span class="op" id="2078242">:=</span>&nbsp;<span class="ident" id="2078245">s</span><span class="op" id="2078246">.</span><span class="ident" id="2078247">accept</span><span class="op" id="2078253">(</span><span class="string" id="2078254">&#34;(&#34;</span><span class="op" id="2078257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2078260">real</span>&nbsp;<span class="op" id="2078265">=</span>&nbsp;<span class="ident" id="2078267">s</span><span class="op" id="2078268">.</span><span class="ident" id="2078269">floatToken</span><span class="op" id="2078279">(</span><span class="op" id="2078280">)</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2078283">s</span><span class="op" id="2078284">.</span><span class="ident" id="2078285">buf</span>&nbsp;<span class="op" id="2078289">=</span>&nbsp;<span class="ident" id="2078291">s</span><span class="op" id="2078292">.</span><span class="ident" id="2078293">buf</span><span class="op" id="2078296">[</span><span class="op" id="2078297">:</span><span class="num" id="2078298">0</span><span class="op" id="2078299">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2078302">//&nbsp;Must&nbsp;now&nbsp;have&nbsp;a&nbsp;sign.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2078328">if</span>&nbsp;<span class="op" id="2078331">!</span><span class="ident" id="2078332">s</span><span class="op" id="2078333">.</span><span class="ident" id="2078334">accept</span><span class="op" id="2078340">(</span><span class="string" id="2078341">&#34;+-&#34;</span><span class="op" id="2078345">)</span>&nbsp;<span class="op" id="2078347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2078351">s</span><span class="op" id="2078352">.</span><span class="builtintype" id="2078353">error</span><span class="op" id="2078358">(</span><span class="ident" id="2078359">complexError</span><span class="op" id="2078371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2078374">}</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2078377">//&nbsp;Sign&nbsp;is&nbsp;now&nbsp;in&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2078403">imagSign</span>&nbsp;<span class="op" id="2078412">:=</span>&nbsp;<span class="builtintype" id="2078415">string</span><span class="op" id="2078421">(</span><span class="ident" id="2078422">s</span><span class="op" id="2078423">.</span><span class="ident" id="2078424">buf</span><span class="op" id="2078427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2078430">imag</span>&nbsp;<span class="op" id="2078435">=</span>&nbsp;<span class="ident" id="2078437">s</span><span class="op" id="2078438">.</span><span class="ident" id="2078439">floatToken</span><span class="op" id="2078449">(</span><span class="op" id="2078450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2078453">if</span>&nbsp;<span class="op" id="2078456">!</span><span class="ident" id="2078457">s</span><span class="op" id="2078458">.</span><span class="ident" id="2078459">accept</span><span class="op" id="2078465">(</span><span class="string" id="2078466">&#34;i&#34;</span><span class="op" id="2078469">)</span>&nbsp;<span class="op" id="2078471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2078475">s</span><span class="op" id="2078476">.</span><span class="builtintype" id="2078477">error</span><span class="op" id="2078482">(</span><span class="ident" id="2078483">complexError</span><span class="op" id="2078495">)</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2078498">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2078501">if</span>&nbsp;<span class="ident" id="2078504">parens</span>&nbsp;<span class="op" id="2078511">&amp;&amp;</span>&nbsp;<span class="op" id="2078514">!</span><span class="ident" id="2078515">s</span><span class="op" id="2078516">.</span><span class="ident" id="2078517">accept</span><span class="op" id="2078523">(</span><span class="string" id="2078524">&#34;)&#34;</span><span class="op" id="2078527">)</span>&nbsp;<span class="op" id="2078529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2078533">s</span><span class="op" id="2078534">.</span><span class="builtintype" id="2078535">error</span><span class="op" id="2078540">(</span><span class="ident" id="2078541">complexError</span><span class="op" id="2078553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2078556">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2078559">return</span>&nbsp;<span class="builtinfunc" id="2078566">real</span><span class="op" id="2078570">,</span>&nbsp;<span class="ident" id="2078572">imagSign</span>&nbsp;<span class="op" id="2078581">+</span>&nbsp;<span class="builtinfunc" id="2078583">imag</span><br>
<span class="lineno">770</span><span class="op" id="2078588">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2078591">//&nbsp;convertFloat&nbsp;converts&nbsp;the&nbsp;string&nbsp;to&nbsp;a&nbsp;float64value.</span><br>
<span class="lineno"></span><span class="keyword" id="2078646">func</span>&nbsp;<span class="op" id="2078651">(</span><span class="ident" id="2078652">s</span>&nbsp;<span class="op" id="2078654">*</span><span class="ident" id="2078655">ss</span><span class="op" id="2078657">)</span>&nbsp;<span class="ident" id="2078659">convertFloat</span><span class="op" id="2078671">(</span><span class="ident" id="2078672">str</span>&nbsp;<span class="builtintype" id="2078676">string</span><span class="op" id="2078682">,</span>&nbsp;<span class="ident" id="2078684">n</span>&nbsp;<span class="builtintype" id="2078686">int</span><span class="op" id="2078689">)</span>&nbsp;<span class="builtintype" id="2078691">float64</span>&nbsp;<span class="op" id="2078699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2078702">if</span>&nbsp;<span class="ident" id="2078705">p</span>&nbsp;<span class="op" id="2078707">:=</span>&nbsp;<span class="ident" id="2078710">indexRune</span><span class="op" id="2078719">(</span><span class="ident" id="2078720">str</span><span class="op" id="2078723">,</span>&nbsp;<span class="string" id="2078725">&#39;p&#39;</span><span class="op" id="2078728">)</span><span class="op" id="2078729">;</span>&nbsp;<span class="ident" id="2078731">p</span>&nbsp;<span class="op" id="2078733">&gt;=</span>&nbsp;<span class="num" id="2078736">0</span>&nbsp;<span class="op" id="2078738">{</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2078742">//&nbsp;Atof&nbsp;doesn&#39;t&nbsp;handle&nbsp;power-of-2&nbsp;exponents,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2078789">//&nbsp;but&nbsp;they&#39;re&nbsp;easy&nbsp;to&nbsp;evaluate.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2078824">f</span><span class="op" id="2078825">,</span>&nbsp;<span class="ident" id="2078827">err</span>&nbsp;<span class="op" id="2078831">:=</span>&nbsp;<span class="ident" id="2078834">strconv</span><span class="op" id="2078841">.</span><span class="ident" id="2078842">ParseFloat</span><span class="op" id="2078852">(</span><span class="ident" id="2078853">str</span><span class="op" id="2078856">[</span><span class="op" id="2078857">:</span><span class="ident" id="2078858">p</span><span class="op" id="2078859">]</span><span class="op" id="2078860">,</span>&nbsp;<span class="ident" id="2078862">n</span><span class="op" id="2078863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2078867">if</span>&nbsp;<span class="ident" id="2078870">err</span>&nbsp;<span class="op" id="2078874">!=</span>&nbsp;<span class="ident" id="2078877">nil</span>&nbsp;<span class="op" id="2078881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2078886">//&nbsp;Put&nbsp;full&nbsp;string&nbsp;into&nbsp;error.</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2078920">if</span>&nbsp;<span class="ident" id="2078923">e</span><span class="op" id="2078924">,</span>&nbsp;<span class="ident" id="2078926">ok</span>&nbsp;<span class="op" id="2078929">:=</span>&nbsp;<span class="ident" id="2078932">err</span><span class="op" id="2078935">.</span><span class="op" id="2078936">(</span><span class="op" id="2078937">*</span><span class="ident" id="2078938">strconv</span><span class="op" id="2078945">.</span><span class="ident" id="2078946">NumError</span><span class="op" id="2078954">)</span><span class="op" id="2078955">;</span>&nbsp;<span class="ident" id="2078957">ok</span>&nbsp;<span class="op" id="2078960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2078966">e</span><span class="op" id="2078967">.</span><span class="ident" id="2078968">Num</span>&nbsp;<span class="op" id="2078972">=</span>&nbsp;<span class="ident" id="2078974">str</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2078981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2078986">s</span><span class="op" id="2078987">.</span><span class="builtintype" id="2078988">error</span><span class="op" id="2078993">(</span><span class="ident" id="2078994">err</span><span class="op" id="2078997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2079001">}</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2079005">m</span><span class="op" id="2079006">,</span>&nbsp;<span class="ident" id="2079008">err</span>&nbsp;<span class="op" id="2079012">:=</span>&nbsp;<span class="ident" id="2079015">strconv</span><span class="op" id="2079022">.</span><span class="ident" id="2079023">Atoi</span><span class="op" id="2079027">(</span><span class="ident" id="2079028">str</span><span class="op" id="2079031">[</span><span class="ident" id="2079032">p</span><span class="op" id="2079033">+</span><span class="num" id="2079034">1</span><span class="op" id="2079035">:</span><span class="op" id="2079036">]</span><span class="op" id="2079037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2079041">if</span>&nbsp;<span class="ident" id="2079044">err</span>&nbsp;<span class="op" id="2079048">!=</span>&nbsp;<span class="ident" id="2079051">nil</span>&nbsp;<span class="op" id="2079055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2079060">//&nbsp;Put&nbsp;full&nbsp;string&nbsp;into&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2079094">if</span>&nbsp;<span class="ident" id="2079097">e</span><span class="op" id="2079098">,</span>&nbsp;<span class="ident" id="2079100">ok</span>&nbsp;<span class="op" id="2079103">:=</span>&nbsp;<span class="ident" id="2079106">err</span><span class="op" id="2079109">.</span><span class="op" id="2079110">(</span><span class="op" id="2079111">*</span><span class="ident" id="2079112">strconv</span><span class="op" id="2079119">.</span><span class="ident" id="2079120">NumError</span><span class="op" id="2079128">)</span><span class="op" id="2079129">;</span>&nbsp;<span class="ident" id="2079131">ok</span>&nbsp;<span class="op" id="2079134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2079140">e</span><span class="op" id="2079141">.</span><span class="ident" id="2079142">Num</span>&nbsp;<span class="op" id="2079146">=</span>&nbsp;<span class="ident" id="2079148">str</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2079155">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2079160">s</span><span class="op" id="2079161">.</span><span class="builtintype" id="2079162">error</span><span class="op" id="2079167">(</span><span class="ident" id="2079168">err</span><span class="op" id="2079171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2079175">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2079179">return</span>&nbsp;<span class="ident" id="2079186">math</span><span class="op" id="2079190">.</span><span class="ident" id="2079191">Ldexp</span><span class="op" id="2079196">(</span><span class="ident" id="2079197">f</span><span class="op" id="2079198">,</span>&nbsp;<span class="ident" id="2079200">m</span><span class="op" id="2079201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2079204">}</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2079207">f</span><span class="op" id="2079208">,</span>&nbsp;<span class="ident" id="2079210">err</span>&nbsp;<span class="op" id="2079214">:=</span>&nbsp;<span class="ident" id="2079217">strconv</span><span class="op" id="2079224">.</span><span class="ident" id="2079225">ParseFloat</span><span class="op" id="2079235">(</span><span class="ident" id="2079236">str</span><span class="op" id="2079239">,</span>&nbsp;<span class="ident" id="2079241">n</span><span class="op" id="2079242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2079245">if</span>&nbsp;<span class="ident" id="2079248">err</span>&nbsp;<span class="op" id="2079252">!=</span>&nbsp;<span class="ident" id="2079255">nil</span>&nbsp;<span class="op" id="2079259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2079263">s</span><span class="op" id="2079264">.</span><span class="builtintype" id="2079265">error</span><span class="op" id="2079270">(</span><span class="ident" id="2079271">err</span><span class="op" id="2079274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2079277">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2079280">return</span>&nbsp;<span class="ident" id="2079287">f</span><br>
<span class="lineno">800</span><span class="op" id="2079289">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2079292">//&nbsp;convertComplex&nbsp;converts&nbsp;the&nbsp;next&nbsp;token&nbsp;to&nbsp;a&nbsp;complex128&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="2079357">//&nbsp;The&nbsp;atof&nbsp;argument&nbsp;is&nbsp;a&nbsp;type-specific&nbsp;reader&nbsp;for&nbsp;the&nbsp;underlying&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2079429">//&nbsp;If&nbsp;we&#39;re&nbsp;reading&nbsp;complex64,&nbsp;atof&nbsp;will&nbsp;parse&nbsp;float32s&nbsp;and&nbsp;convert&nbsp;them</span><br>
<span class="lineno">805</span><span class="comment" id="2079502">//&nbsp;to&nbsp;float64&#39;s&nbsp;to&nbsp;avoid&nbsp;reproducing&nbsp;this&nbsp;code&nbsp;for&nbsp;each&nbsp;complex&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2079572">func</span>&nbsp;<span class="op" id="2079577">(</span><span class="ident" id="2079578">s</span>&nbsp;<span class="op" id="2079580">*</span><span class="ident" id="2079581">ss</span><span class="op" id="2079583">)</span>&nbsp;<span class="ident" id="2079585">scanComplex</span><span class="op" id="2079596">(</span><span class="ident" id="2079597">verb</span>&nbsp;<span class="builtintype" id="2079602">rune</span><span class="op" id="2079606">,</span>&nbsp;<span class="ident" id="2079608">n</span>&nbsp;<span class="builtintype" id="2079610">int</span><span class="op" id="2079613">)</span>&nbsp;<span class="builtintype" id="2079615">complex128</span>&nbsp;<span class="op" id="2079626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2079629">if</span>&nbsp;<span class="op" id="2079632">!</span><span class="ident" id="2079633">s</span><span class="op" id="2079634">.</span><span class="ident" id="2079635">okVerb</span><span class="op" id="2079641">(</span><span class="ident" id="2079642">verb</span><span class="op" id="2079646">,</span>&nbsp;<span class="ident" id="2079648">floatVerbs</span><span class="op" id="2079658">,</span>&nbsp;<span class="string" id="2079660">&#34;complex&#34;</span><span class="op" id="2079669">)</span>&nbsp;<span class="op" id="2079671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2079675">return</span>&nbsp;<span class="num" id="2079682">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2079685">}</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2079688">s</span><span class="op" id="2079689">.</span><span class="ident" id="2079690">skipSpace</span><span class="op" id="2079699">(</span><span class="builtintype" id="2079700">false</span><span class="op" id="2079705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2079708">s</span><span class="op" id="2079709">.</span><span class="ident" id="2079710">notEOF</span><span class="op" id="2079716">(</span><span class="op" id="2079717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2079720">sreal</span><span class="op" id="2079725">,</span>&nbsp;<span class="ident" id="2079727">simag</span>&nbsp;<span class="op" id="2079733">:=</span>&nbsp;<span class="ident" id="2079736">s</span><span class="op" id="2079737">.</span><span class="ident" id="2079738">complexTokens</span><span class="op" id="2079751">(</span><span class="op" id="2079752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2079755">real</span>&nbsp;<span class="op" id="2079760">:=</span>&nbsp;<span class="ident" id="2079763">s</span><span class="op" id="2079764">.</span><span class="ident" id="2079765">convertFloat</span><span class="op" id="2079777">(</span><span class="ident" id="2079778">sreal</span><span class="op" id="2079783">,</span>&nbsp;<span class="ident" id="2079785">n</span><span class="op" id="2079786">/</span><span class="num" id="2079787">2</span><span class="op" id="2079788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2079791">imag</span>&nbsp;<span class="op" id="2079796">:=</span>&nbsp;<span class="ident" id="2079799">s</span><span class="op" id="2079800">.</span><span class="ident" id="2079801">convertFloat</span><span class="op" id="2079813">(</span><span class="ident" id="2079814">simag</span><span class="op" id="2079819">,</span>&nbsp;<span class="ident" id="2079821">n</span><span class="op" id="2079822">/</span><span class="num" id="2079823">2</span><span class="op" id="2079824">)</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2079827">return</span>&nbsp;<span class="builtinfunc" id="2079834">complex</span><span class="op" id="2079841">(</span><span class="builtinfunc" id="2079842">real</span><span class="op" id="2079846">,</span>&nbsp;<span class="builtinfunc" id="2079848">imag</span><span class="op" id="2079852">)</span><br>
<span class="lineno"></span><span class="op" id="2079854">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2079857">//&nbsp;convertString&nbsp;returns&nbsp;the&nbsp;string&nbsp;represented&nbsp;by&nbsp;the&nbsp;next&nbsp;input&nbsp;characters.</span><br>
<span class="lineno"></span><span class="comment" id="2079935">//&nbsp;The&nbsp;format&nbsp;of&nbsp;the&nbsp;input&nbsp;is&nbsp;determined&nbsp;by&nbsp;the&nbsp;verb.</span><br>
<span class="lineno">820</span><span class="keyword" id="2079989">func</span>&nbsp;<span class="op" id="2079994">(</span><span class="ident" id="2079995">s</span>&nbsp;<span class="op" id="2079997">*</span><span class="ident" id="2079998">ss</span><span class="op" id="2080000">)</span>&nbsp;<span class="ident" id="2080002">convertString</span><span class="op" id="2080015">(</span><span class="ident" id="2080016">verb</span>&nbsp;<span class="builtintype" id="2080021">rune</span><span class="op" id="2080025">)</span>&nbsp;<span class="op" id="2080027">(</span><span class="ident" id="2080028">str</span>&nbsp;<span class="builtintype" id="2080032">string</span><span class="op" id="2080038">)</span>&nbsp;<span class="op" id="2080040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2080043">if</span>&nbsp;<span class="op" id="2080046">!</span><span class="ident" id="2080047">s</span><span class="op" id="2080048">.</span><span class="ident" id="2080049">okVerb</span><span class="op" id="2080055">(</span><span class="ident" id="2080056">verb</span><span class="op" id="2080060">,</span>&nbsp;<span class="string" id="2080062">&#34;svqx&#34;</span><span class="op" id="2080068">,</span>&nbsp;<span class="string" id="2080070">&#34;string&#34;</span><span class="op" id="2080078">)</span>&nbsp;<span class="op" id="2080080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2080084">return</span>&nbsp;<span class="string" id="2080091">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2080095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2080098">s</span><span class="op" id="2080099">.</span><span class="ident" id="2080100">skipSpace</span><span class="op" id="2080109">(</span><span class="builtintype" id="2080110">false</span><span class="op" id="2080115">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2080118">s</span><span class="op" id="2080119">.</span><span class="ident" id="2080120">notEOF</span><span class="op" id="2080126">(</span><span class="op" id="2080127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2080130">switch</span>&nbsp;<span class="ident" id="2080137">verb</span>&nbsp;<span class="op" id="2080142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2080145">case</span>&nbsp;<span class="string" id="2080150">&#39;q&#39;</span><span class="op" id="2080153">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2080157">str</span>&nbsp;<span class="op" id="2080161">=</span>&nbsp;<span class="ident" id="2080163">s</span><span class="op" id="2080164">.</span><span class="ident" id="2080165">quotedString</span><span class="op" id="2080177">(</span><span class="op" id="2080178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2080181">case</span>&nbsp;<span class="string" id="2080186">&#39;x&#39;</span><span class="op" id="2080189">:</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2080193">str</span>&nbsp;<span class="op" id="2080197">=</span>&nbsp;<span class="ident" id="2080199">s</span><span class="op" id="2080200">.</span><span class="ident" id="2080201">hexString</span><span class="op" id="2080210">(</span><span class="op" id="2080211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2080214">default</span><span class="op" id="2080221">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2080225">str</span>&nbsp;<span class="op" id="2080229">=</span>&nbsp;<span class="builtintype" id="2080231">string</span><span class="op" id="2080237">(</span><span class="ident" id="2080238">s</span><span class="op" id="2080239">.</span><span class="ident" id="2080240">token</span><span class="op" id="2080245">(</span><span class="builtintype" id="2080246">true</span><span class="op" id="2080250">,</span>&nbsp;<span class="ident" id="2080252">notSpace</span><span class="op" id="2080260">)</span><span class="op" id="2080261">)</span>&nbsp;<span class="comment" id="2080263">//&nbsp;%s&nbsp;and&nbsp;%v&nbsp;just&nbsp;return&nbsp;the&nbsp;next&nbsp;word</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2080303">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2080306">return</span><br>
<span class="lineno">835</span><span class="op" id="2080313">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2080316">//&nbsp;quotedString&nbsp;returns&nbsp;the&nbsp;double-&nbsp;or&nbsp;back-quoted&nbsp;string&nbsp;represented&nbsp;by&nbsp;the&nbsp;next&nbsp;input&nbsp;characters.</span><br>
<span class="lineno"></span><span class="keyword" id="2080416">func</span>&nbsp;<span class="op" id="2080421">(</span><span class="ident" id="2080422">s</span>&nbsp;<span class="op" id="2080424">*</span><span class="ident" id="2080425">ss</span><span class="op" id="2080427">)</span>&nbsp;<span class="ident" id="2080429">quotedString</span><span class="op" id="2080441">(</span><span class="op" id="2080442">)</span>&nbsp;<span class="builtintype" id="2080444">string</span>&nbsp;<span class="op" id="2080451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2080454">s</span><span class="op" id="2080455">.</span><span class="ident" id="2080456">notEOF</span><span class="op" id="2080462">(</span><span class="op" id="2080463">)</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2080466">quote</span>&nbsp;<span class="op" id="2080472">:=</span>&nbsp;<span class="ident" id="2080475">s</span><span class="op" id="2080476">.</span><span class="ident" id="2080477">getRune</span><span class="op" id="2080484">(</span><span class="op" id="2080485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2080488">switch</span>&nbsp;<span class="ident" id="2080495">quote</span>&nbsp;<span class="op" id="2080501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2080504">case</span>&nbsp;<span class="string" id="2080509">&#39;`&#39;</span><span class="op" id="2080512">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2080516">//&nbsp;Back-quoted:&nbsp;Anything&nbsp;goes&nbsp;until&nbsp;EOF&nbsp;or&nbsp;back&nbsp;quote.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2080573">for</span>&nbsp;<span class="op" id="2080577">{</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2080582">r</span>&nbsp;<span class="op" id="2080584">:=</span>&nbsp;<span class="ident" id="2080587">s</span><span class="op" id="2080588">.</span><span class="ident" id="2080589">mustReadRune</span><span class="op" id="2080601">(</span><span class="op" id="2080602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2080607">if</span>&nbsp;<span class="ident" id="2080610">r</span>&nbsp;<span class="op" id="2080612">==</span>&nbsp;<span class="ident" id="2080615">quote</span>&nbsp;<span class="op" id="2080621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2080627">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2080636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2080641">s</span><span class="op" id="2080642">.</span><span class="ident" id="2080643">buf</span><span class="op" id="2080646">.</span><span class="ident" id="2080647">WriteRune</span><span class="op" id="2080656">(</span><span class="ident" id="2080657">r</span><span class="op" id="2080658">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2080662">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2080666">return</span>&nbsp;<span class="builtintype" id="2080673">string</span><span class="op" id="2080679">(</span><span class="ident" id="2080680">s</span><span class="op" id="2080681">.</span><span class="ident" id="2080682">buf</span><span class="op" id="2080685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2080688">case</span>&nbsp;<span class="string" id="2080693">&#39;&#34;&#39;</span><span class="op" id="2080696">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2080700">//&nbsp;Double-quoted:&nbsp;Include&nbsp;the&nbsp;quotes&nbsp;and&nbsp;let&nbsp;strconv.Unquote&nbsp;do&nbsp;the&nbsp;backslash&nbsp;escapes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2080789">s</span><span class="op" id="2080790">.</span><span class="ident" id="2080791">buf</span><span class="op" id="2080794">.</span><span class="ident" id="2080795">WriteRune</span><span class="op" id="2080804">(</span><span class="ident" id="2080805">quote</span><span class="op" id="2080810">)</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2080814">for</span>&nbsp;<span class="op" id="2080818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2080823">r</span>&nbsp;<span class="op" id="2080825">:=</span>&nbsp;<span class="ident" id="2080828">s</span><span class="op" id="2080829">.</span><span class="ident" id="2080830">mustReadRune</span><span class="op" id="2080842">(</span><span class="op" id="2080843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2080848">s</span><span class="op" id="2080849">.</span><span class="ident" id="2080850">buf</span><span class="op" id="2080853">.</span><span class="ident" id="2080854">WriteRune</span><span class="op" id="2080863">(</span><span class="ident" id="2080864">r</span><span class="op" id="2080865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2080870">if</span>&nbsp;<span class="ident" id="2080873">r</span>&nbsp;<span class="op" id="2080875">==</span>&nbsp;<span class="string" id="2080878">&#39;\\&#39;</span>&nbsp;<span class="op" id="2080883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2080889">//&nbsp;In&nbsp;a&nbsp;legal&nbsp;backslash&nbsp;escape,&nbsp;no&nbsp;matter&nbsp;how&nbsp;long,&nbsp;only&nbsp;the&nbsp;character</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2080964">//&nbsp;immediately&nbsp;after&nbsp;the&nbsp;escape&nbsp;can&nbsp;itself&nbsp;be&nbsp;a&nbsp;backslash&nbsp;or&nbsp;quote.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2081036">//&nbsp;Thus&nbsp;we&nbsp;only&nbsp;need&nbsp;to&nbsp;protect&nbsp;the&nbsp;first&nbsp;character&nbsp;after&nbsp;the&nbsp;backslash.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2081113">s</span><span class="op" id="2081114">.</span><span class="ident" id="2081115">buf</span><span class="op" id="2081118">.</span><span class="ident" id="2081119">WriteRune</span><span class="op" id="2081128">(</span><span class="ident" id="2081129">s</span><span class="op" id="2081130">.</span><span class="ident" id="2081131">mustReadRune</span><span class="op" id="2081143">(</span><span class="op" id="2081144">)</span><span class="op" id="2081145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2081150">}</span>&nbsp;<span class="keyword" id="2081152">else</span>&nbsp;<span class="keyword" id="2081157">if</span>&nbsp;<span class="ident" id="2081160">r</span>&nbsp;<span class="op" id="2081162">==</span>&nbsp;<span class="string" id="2081165">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2081169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2081175">break</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2081184">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2081188">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2081192">result</span><span class="op" id="2081198">,</span>&nbsp;<span class="ident" id="2081200">err</span>&nbsp;<span class="op" id="2081204">:=</span>&nbsp;<span class="ident" id="2081207">strconv</span><span class="op" id="2081214">.</span><span class="ident" id="2081215">Unquote</span><span class="op" id="2081222">(</span><span class="builtintype" id="2081223">string</span><span class="op" id="2081229">(</span><span class="ident" id="2081230">s</span><span class="op" id="2081231">.</span><span class="ident" id="2081232">buf</span><span class="op" id="2081235">)</span><span class="op" id="2081236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2081240">if</span>&nbsp;<span class="ident" id="2081243">err</span>&nbsp;<span class="op" id="2081247">!=</span>&nbsp;<span class="ident" id="2081250">nil</span>&nbsp;<span class="op" id="2081254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2081259">s</span><span class="op" id="2081260">.</span><span class="builtintype" id="2081261">error</span><span class="op" id="2081266">(</span><span class="ident" id="2081267">err</span><span class="op" id="2081270">)</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2081274">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2081278">return</span>&nbsp;<span class="ident" id="2081285">result</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2081293">default</span><span class="op" id="2081300">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2081304">s</span><span class="op" id="2081305">.</span><span class="ident" id="2081306">errorString</span><span class="op" id="2081317">(</span><span class="string" id="2081318">&#34;expected&nbsp;quoted&nbsp;string&#34;</span><span class="op" id="2081342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2081345">}</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2081348">return</span>&nbsp;<span class="string" id="2081355">&#34;&#34;</span><br>
<span class="lineno"></span><span class="op" id="2081358">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2081361">//&nbsp;hexDigit&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;hexadecimal&nbsp;digit</span><br>
<span class="lineno"></span><span class="keyword" id="2081416">func</span>&nbsp;<span class="op" id="2081421">(</span><span class="ident" id="2081422">s</span>&nbsp;<span class="op" id="2081424">*</span><span class="ident" id="2081425">ss</span><span class="op" id="2081427">)</span>&nbsp;<span class="ident" id="2081429">hexDigit</span><span class="op" id="2081437">(</span><span class="ident" id="2081438">d</span>&nbsp;<span class="builtintype" id="2081440">rune</span><span class="op" id="2081444">)</span>&nbsp;<span class="builtintype" id="2081446">int</span>&nbsp;<span class="op" id="2081450">{</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2081453">digit</span>&nbsp;<span class="op" id="2081459">:=</span>&nbsp;<span class="builtintype" id="2081462">int</span><span class="op" id="2081465">(</span><span class="ident" id="2081466">d</span><span class="op" id="2081467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2081470">switch</span>&nbsp;<span class="ident" id="2081477">digit</span>&nbsp;<span class="op" id="2081483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2081486">case</span>&nbsp;<span class="string" id="2081491">&#39;0&#39;</span><span class="op" id="2081494">,</span>&nbsp;<span class="string" id="2081496">&#39;1&#39;</span><span class="op" id="2081499">,</span>&nbsp;<span class="string" id="2081501">&#39;2&#39;</span><span class="op" id="2081504">,</span>&nbsp;<span class="string" id="2081506">&#39;3&#39;</span><span class="op" id="2081509">,</span>&nbsp;<span class="string" id="2081511">&#39;4&#39;</span><span class="op" id="2081514">,</span>&nbsp;<span class="string" id="2081516">&#39;5&#39;</span><span class="op" id="2081519">,</span>&nbsp;<span class="string" id="2081521">&#39;6&#39;</span><span class="op" id="2081524">,</span>&nbsp;<span class="string" id="2081526">&#39;7&#39;</span><span class="op" id="2081529">,</span>&nbsp;<span class="string" id="2081531">&#39;8&#39;</span><span class="op" id="2081534">,</span>&nbsp;<span class="string" id="2081536">&#39;9&#39;</span><span class="op" id="2081539">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2081543">return</span>&nbsp;<span class="ident" id="2081550">digit</span>&nbsp;<span class="op" id="2081556">-</span>&nbsp;<span class="string" id="2081558">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2081563">case</span>&nbsp;<span class="string" id="2081568">&#39;a&#39;</span><span class="op" id="2081571">,</span>&nbsp;<span class="string" id="2081573">&#39;b&#39;</span><span class="op" id="2081576">,</span>&nbsp;<span class="string" id="2081578">&#39;c&#39;</span><span class="op" id="2081581">,</span>&nbsp;<span class="string" id="2081583">&#39;d&#39;</span><span class="op" id="2081586">,</span>&nbsp;<span class="string" id="2081588">&#39;e&#39;</span><span class="op" id="2081591">,</span>&nbsp;<span class="string" id="2081593">&#39;f&#39;</span><span class="op" id="2081596">:</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2081600">return</span>&nbsp;<span class="num" id="2081607">10</span>&nbsp;<span class="op" id="2081610">+</span>&nbsp;<span class="ident" id="2081612">digit</span>&nbsp;<span class="op" id="2081618">-</span>&nbsp;<span class="string" id="2081620">&#39;a&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2081625">case</span>&nbsp;<span class="string" id="2081630">&#39;A&#39;</span><span class="op" id="2081633">,</span>&nbsp;<span class="string" id="2081635">&#39;B&#39;</span><span class="op" id="2081638">,</span>&nbsp;<span class="string" id="2081640">&#39;C&#39;</span><span class="op" id="2081643">,</span>&nbsp;<span class="string" id="2081645">&#39;D&#39;</span><span class="op" id="2081648">,</span>&nbsp;<span class="string" id="2081650">&#39;E&#39;</span><span class="op" id="2081653">,</span>&nbsp;<span class="string" id="2081655">&#39;F&#39;</span><span class="op" id="2081658">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2081662">return</span>&nbsp;<span class="num" id="2081669">10</span>&nbsp;<span class="op" id="2081672">+</span>&nbsp;<span class="ident" id="2081674">digit</span>&nbsp;<span class="op" id="2081680">-</span>&nbsp;<span class="string" id="2081682">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2081687">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2081690">s</span><span class="op" id="2081691">.</span><span class="ident" id="2081692">errorString</span><span class="op" id="2081703">(</span><span class="string" id="2081704">&#34;illegal&nbsp;hex&nbsp;digit&#34;</span><span class="op" id="2081723">)</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2081726">return</span>&nbsp;<span class="num" id="2081733">0</span><br>
<span class="lineno"></span><span class="op" id="2081735">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2081738">//&nbsp;hexByte&nbsp;returns&nbsp;the&nbsp;next&nbsp;hex-encoded&nbsp;(two-character)&nbsp;byte&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="2081815">//&nbsp;There&nbsp;must&nbsp;be&nbsp;either&nbsp;two&nbsp;hexadecimal&nbsp;digits&nbsp;or&nbsp;a&nbsp;space&nbsp;character&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno">895</span><span class="keyword" id="2081897">func</span>&nbsp;<span class="op" id="2081902">(</span><span class="ident" id="2081903">s</span>&nbsp;<span class="op" id="2081905">*</span><span class="ident" id="2081906">ss</span><span class="op" id="2081908">)</span>&nbsp;<span class="ident" id="2081910">hexByte</span><span class="op" id="2081917">(</span><span class="op" id="2081918">)</span>&nbsp;<span class="op" id="2081920">(</span><span class="ident" id="2081921">b</span>&nbsp;<span class="builtintype" id="2081923">byte</span><span class="op" id="2081927">,</span>&nbsp;<span class="ident" id="2081929">ok</span>&nbsp;<span class="builtintype" id="2081932">bool</span><span class="op" id="2081936">)</span>&nbsp;<span class="op" id="2081938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2081941">rune1</span>&nbsp;<span class="op" id="2081947">:=</span>&nbsp;<span class="ident" id="2081950">s</span><span class="op" id="2081951">.</span><span class="ident" id="2081952">getRune</span><span class="op" id="2081959">(</span><span class="op" id="2081960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2081963">if</span>&nbsp;<span class="ident" id="2081966">rune1</span>&nbsp;<span class="op" id="2081972">==</span>&nbsp;<span class="ident" id="2081975">eof</span>&nbsp;<span class="op" id="2081979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2081983">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2081991">}</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2081994">if</span>&nbsp;<span class="ident" id="2081997">isSpace</span><span class="op" id="2082004">(</span><span class="ident" id="2082005">rune1</span><span class="op" id="2082010">)</span>&nbsp;<span class="op" id="2082012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2082016">s</span><span class="op" id="2082017">.</span><span class="ident" id="2082018">UnreadRune</span><span class="op" id="2082028">(</span><span class="op" id="2082029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2082033">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2082041">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2082044">rune2</span>&nbsp;<span class="op" id="2082050">:=</span>&nbsp;<span class="ident" id="2082053">s</span><span class="op" id="2082054">.</span><span class="ident" id="2082055">mustReadRune</span><span class="op" id="2082067">(</span><span class="op" id="2082068">)</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2082071">return</span>&nbsp;<span class="builtintype" id="2082078">byte</span><span class="op" id="2082082">(</span><span class="ident" id="2082083">s</span><span class="op" id="2082084">.</span><span class="ident" id="2082085">hexDigit</span><span class="op" id="2082093">(</span><span class="ident" id="2082094">rune1</span><span class="op" id="2082099">)</span><span class="op" id="2082100">&lt;&lt;</span><span class="num" id="2082102">4</span>&nbsp;<span class="op" id="2082104">|</span>&nbsp;<span class="ident" id="2082106">s</span><span class="op" id="2082107">.</span><span class="ident" id="2082108">hexDigit</span><span class="op" id="2082116">(</span><span class="ident" id="2082117">rune2</span><span class="op" id="2082122">)</span><span class="op" id="2082123">)</span><span class="op" id="2082124">,</span>&nbsp;<span class="builtintype" id="2082126">true</span><br>
<span class="lineno"></span><span class="op" id="2082131">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2082134">//&nbsp;hexString&nbsp;returns&nbsp;the&nbsp;space-delimited&nbsp;hexpair-encoded&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2082199">func</span>&nbsp;<span class="op" id="2082204">(</span><span class="ident" id="2082205">s</span>&nbsp;<span class="op" id="2082207">*</span><span class="ident" id="2082208">ss</span><span class="op" id="2082210">)</span>&nbsp;<span class="ident" id="2082212">hexString</span><span class="op" id="2082221">(</span><span class="op" id="2082222">)</span>&nbsp;<span class="builtintype" id="2082224">string</span>&nbsp;<span class="op" id="2082231">{</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2082234">s</span><span class="op" id="2082235">.</span><span class="ident" id="2082236">notEOF</span><span class="op" id="2082242">(</span><span class="op" id="2082243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2082246">for</span>&nbsp;<span class="op" id="2082250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2082254">b</span><span class="op" id="2082255">,</span>&nbsp;<span class="ident" id="2082257">ok</span>&nbsp;<span class="op" id="2082260">:=</span>&nbsp;<span class="ident" id="2082263">s</span><span class="op" id="2082264">.</span><span class="ident" id="2082265">hexByte</span><span class="op" id="2082272">(</span><span class="op" id="2082273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2082277">if</span>&nbsp;<span class="op" id="2082280">!</span><span class="ident" id="2082281">ok</span>&nbsp;<span class="op" id="2082284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2082289">break</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2082297">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2082301">s</span><span class="op" id="2082302">.</span><span class="ident" id="2082303">buf</span><span class="op" id="2082306">.</span><span class="ident" id="2082307">WriteByte</span><span class="op" id="2082316">(</span><span class="ident" id="2082317">b</span><span class="op" id="2082318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2082321">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2082324">if</span>&nbsp;<span class="builtinfunc" id="2082327">len</span><span class="op" id="2082330">(</span><span class="ident" id="2082331">s</span><span class="op" id="2082332">.</span><span class="ident" id="2082333">buf</span><span class="op" id="2082336">)</span>&nbsp;<span class="op" id="2082338">==</span>&nbsp;<span class="num" id="2082341">0</span>&nbsp;<span class="op" id="2082343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2082347">s</span><span class="op" id="2082348">.</span><span class="ident" id="2082349">errorString</span><span class="op" id="2082360">(</span><span class="string" id="2082361">&#34;no&nbsp;hex&nbsp;data&nbsp;for&nbsp;%x&nbsp;string&#34;</span><span class="op" id="2082388">)</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2082392">return</span>&nbsp;<span class="string" id="2082399">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2082403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2082406">return</span>&nbsp;<span class="builtintype" id="2082413">string</span><span class="op" id="2082419">(</span><span class="ident" id="2082420">s</span><span class="op" id="2082421">.</span><span class="ident" id="2082422">buf</span><span class="op" id="2082425">)</span><br>
<span class="lineno"></span><span class="op" id="2082427">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">925</span><span class="keyword" id="2082430">const</span>&nbsp;<span class="ident" id="2082436">floatVerbs</span>&nbsp;<span class="op" id="2082447">=</span>&nbsp;<span class="string" id="2082449">&#34;beEfFgGv&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2082461">const</span>&nbsp;<span class="ident" id="2082467">hugeWid</span>&nbsp;<span class="op" id="2082475">=</span>&nbsp;<span class="num" id="2082477">1</span>&nbsp;<span class="op" id="2082479">&lt;&lt;</span>&nbsp;<span class="num" id="2082482">30</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2082486">//&nbsp;scanOne&nbsp;scans&nbsp;a&nbsp;single&nbsp;value,&nbsp;deriving&nbsp;the&nbsp;scanner&nbsp;from&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;argument.</span><br>
<span class="lineno">930</span><span class="keyword" id="2082571">func</span>&nbsp;<span class="op" id="2082576">(</span><span class="ident" id="2082577">s</span>&nbsp;<span class="op" id="2082579">*</span><span class="ident" id="2082580">ss</span><span class="op" id="2082582">)</span>&nbsp;<span class="ident" id="2082584">scanOne</span><span class="op" id="2082591">(</span><span class="ident" id="2082592">verb</span>&nbsp;<span class="builtintype" id="2082597">rune</span><span class="op" id="2082601">,</span>&nbsp;<span class="ident" id="2082603">arg</span>&nbsp;<span class="keyword" id="2082607">interface</span><span class="op" id="2082616">{</span><span class="op" id="2082617">}</span><span class="op" id="2082618">)</span>&nbsp;<span class="op" id="2082620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2082623">s</span><span class="op" id="2082624">.</span><span class="ident" id="2082625">buf</span>&nbsp;<span class="op" id="2082629">=</span>&nbsp;<span class="ident" id="2082631">s</span><span class="op" id="2082632">.</span><span class="ident" id="2082633">buf</span><span class="op" id="2082636">[</span><span class="op" id="2082637">:</span><span class="num" id="2082638">0</span><span class="op" id="2082639">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2082642">var</span>&nbsp;<span class="ident" id="2082646">err</span>&nbsp;<span class="builtintype" id="2082650">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2082657">//&nbsp;If&nbsp;the&nbsp;parameter&nbsp;has&nbsp;its&nbsp;own&nbsp;Scan&nbsp;method,&nbsp;use&nbsp;that.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2082713">if</span>&nbsp;<span class="ident" id="2082716">v</span><span class="op" id="2082717">,</span>&nbsp;<span class="ident" id="2082719">ok</span>&nbsp;<span class="op" id="2082722">:=</span>&nbsp;<span class="ident" id="2082725">arg</span><span class="op" id="2082728">.</span><span class="op" id="2082729">(</span><span class="ident" id="2082730">Scanner</span><span class="op" id="2082737">)</span><span class="op" id="2082738">;</span>&nbsp;<span class="ident" id="2082740">ok</span>&nbsp;<span class="op" id="2082743">{</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2082747">err</span>&nbsp;<span class="op" id="2082751">=</span>&nbsp;<span class="ident" id="2082753">v</span><span class="op" id="2082754">.</span><span class="ident" id="2082755">Scan</span><span class="op" id="2082759">(</span><span class="ident" id="2082760">s</span><span class="op" id="2082761">,</span>&nbsp;<span class="ident" id="2082763">verb</span><span class="op" id="2082767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2082771">if</span>&nbsp;<span class="ident" id="2082774">err</span>&nbsp;<span class="op" id="2082778">!=</span>&nbsp;<span class="ident" id="2082781">nil</span>&nbsp;<span class="op" id="2082785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2082790">if</span>&nbsp;<span class="ident" id="2082793">err</span>&nbsp;<span class="op" id="2082797">==</span>&nbsp;<span class="ident" id="2082800">io</span><span class="op" id="2082802">.</span><span class="ident" id="2082803">EOF</span>&nbsp;<span class="op" id="2082807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2082813">err</span>&nbsp;<span class="op" id="2082817">=</span>&nbsp;<span class="ident" id="2082819">io</span><span class="op" id="2082821">.</span><span class="ident" id="2082822">ErrUnexpectedEOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2082842">}</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2082847">s</span><span class="op" id="2082848">.</span><span class="builtintype" id="2082849">error</span><span class="op" id="2082854">(</span><span class="ident" id="2082855">err</span><span class="op" id="2082858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2082862">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2082866">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2082874">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2082878">switch</span>&nbsp;<span class="ident" id="2082885">v</span>&nbsp;<span class="op" id="2082887">:=</span>&nbsp;<span class="ident" id="2082890">arg</span><span class="op" id="2082893">.</span><span class="op" id="2082894">(</span><span class="keyword" id="2082895">type</span><span class="op" id="2082899">)</span>&nbsp;<span class="op" id="2082901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2082904">case</span>&nbsp;<span class="op" id="2082909">*</span><span class="builtintype" id="2082910">bool</span><span class="op" id="2082914">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2082918">*</span><span class="ident" id="2082919">v</span>&nbsp;<span class="op" id="2082921">=</span>&nbsp;<span class="ident" id="2082923">s</span><span class="op" id="2082924">.</span><span class="ident" id="2082925">scanBool</span><span class="op" id="2082933">(</span><span class="ident" id="2082934">verb</span><span class="op" id="2082938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2082941">case</span>&nbsp;<span class="op" id="2082946">*</span><span class="builtintype" id="2082947">complex64</span><span class="op" id="2082956">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2082960">*</span><span class="ident" id="2082961">v</span>&nbsp;<span class="op" id="2082963">=</span>&nbsp;<span class="builtintype" id="2082965">complex64</span><span class="op" id="2082974">(</span><span class="ident" id="2082975">s</span><span class="op" id="2082976">.</span><span class="ident" id="2082977">scanComplex</span><span class="op" id="2082988">(</span><span class="ident" id="2082989">verb</span><span class="op" id="2082993">,</span>&nbsp;<span class="num" id="2082995">64</span><span class="op" id="2082997">)</span><span class="op" id="2082998">)</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2083001">case</span>&nbsp;<span class="op" id="2083006">*</span><span class="builtintype" id="2083007">complex128</span><span class="op" id="2083017">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2083021">*</span><span class="ident" id="2083022">v</span>&nbsp;<span class="op" id="2083024">=</span>&nbsp;<span class="ident" id="2083026">s</span><span class="op" id="2083027">.</span><span class="ident" id="2083028">scanComplex</span><span class="op" id="2083039">(</span><span class="ident" id="2083040">verb</span><span class="op" id="2083044">,</span>&nbsp;<span class="num" id="2083046">128</span><span class="op" id="2083049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2083052">case</span>&nbsp;<span class="op" id="2083057">*</span><span class="builtintype" id="2083058">int</span><span class="op" id="2083061">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2083065">*</span><span class="ident" id="2083066">v</span>&nbsp;<span class="op" id="2083068">=</span>&nbsp;<span class="builtintype" id="2083070">int</span><span class="op" id="2083073">(</span><span class="ident" id="2083074">s</span><span class="op" id="2083075">.</span><span class="ident" id="2083076">scanInt</span><span class="op" id="2083083">(</span><span class="ident" id="2083084">verb</span><span class="op" id="2083088">,</span>&nbsp;<span class="ident" id="2083090">intBits</span><span class="op" id="2083097">)</span><span class="op" id="2083098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2083101">case</span>&nbsp;<span class="op" id="2083106">*</span><span class="builtintype" id="2083107">int8</span><span class="op" id="2083111">:</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2083115">*</span><span class="ident" id="2083116">v</span>&nbsp;<span class="op" id="2083118">=</span>&nbsp;<span class="builtintype" id="2083120">int8</span><span class="op" id="2083124">(</span><span class="ident" id="2083125">s</span><span class="op" id="2083126">.</span><span class="ident" id="2083127">scanInt</span><span class="op" id="2083134">(</span><span class="ident" id="2083135">verb</span><span class="op" id="2083139">,</span>&nbsp;<span class="num" id="2083141">8</span><span class="op" id="2083142">)</span><span class="op" id="2083143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2083146">case</span>&nbsp;<span class="op" id="2083151">*</span><span class="builtintype" id="2083152">int16</span><span class="op" id="2083157">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2083161">*</span><span class="ident" id="2083162">v</span>&nbsp;<span class="op" id="2083164">=</span>&nbsp;<span class="builtintype" id="2083166">int16</span><span class="op" id="2083171">(</span><span class="ident" id="2083172">s</span><span class="op" id="2083173">.</span><span class="ident" id="2083174">scanInt</span><span class="op" id="2083181">(</span><span class="ident" id="2083182">verb</span><span class="op" id="2083186">,</span>&nbsp;<span class="num" id="2083188">16</span><span class="op" id="2083190">)</span><span class="op" id="2083191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2083194">case</span>&nbsp;<span class="op" id="2083199">*</span><span class="builtintype" id="2083200">int32</span><span class="op" id="2083205">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2083209">*</span><span class="ident" id="2083210">v</span>&nbsp;<span class="op" id="2083212">=</span>&nbsp;<span class="builtintype" id="2083214">int32</span><span class="op" id="2083219">(</span><span class="ident" id="2083220">s</span><span class="op" id="2083221">.</span><span class="ident" id="2083222">scanInt</span><span class="op" id="2083229">(</span><span class="ident" id="2083230">verb</span><span class="op" id="2083234">,</span>&nbsp;<span class="num" id="2083236">32</span><span class="op" id="2083238">)</span><span class="op" id="2083239">)</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2083242">case</span>&nbsp;<span class="op" id="2083247">*</span><span class="ident" id="2083248">int64</span><span class="op" id="2083253">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2083257">*</span><span class="ident" id="2083258">v</span>&nbsp;<span class="op" id="2083260">=</span>&nbsp;<span class="ident" id="2083262">s</span><span class="op" id="2083263">.</span><span class="ident" id="2083264">scanInt</span><span class="op" id="2083271">(</span><span class="ident" id="2083272">verb</span><span class="op" id="2083276">,</span>&nbsp;<span class="num" id="2083278">64</span><span class="op" id="2083280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2083283">case</span>&nbsp;<span class="op" id="2083288">*</span><span class="builtintype" id="2083289">uint</span><span class="op" id="2083293">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2083297">*</span><span class="ident" id="2083298">v</span>&nbsp;<span class="op" id="2083300">=</span>&nbsp;<span class="builtintype" id="2083302">uint</span><span class="op" id="2083306">(</span><span class="ident" id="2083307">s</span><span class="op" id="2083308">.</span><span class="ident" id="2083309">scanUint</span><span class="op" id="2083317">(</span><span class="ident" id="2083318">verb</span><span class="op" id="2083322">,</span>&nbsp;<span class="ident" id="2083324">intBits</span><span class="op" id="2083331">)</span><span class="op" id="2083332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2083335">case</span>&nbsp;<span class="op" id="2083340">*</span><span class="builtintype" id="2083341">uint8</span><span class="op" id="2083346">:</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2083350">*</span><span class="ident" id="2083351">v</span>&nbsp;<span class="op" id="2083353">=</span>&nbsp;<span class="builtintype" id="2083355">uint8</span><span class="op" id="2083360">(</span><span class="ident" id="2083361">s</span><span class="op" id="2083362">.</span><span class="ident" id="2083363">scanUint</span><span class="op" id="2083371">(</span><span class="ident" id="2083372">verb</span><span class="op" id="2083376">,</span>&nbsp;<span class="num" id="2083378">8</span><span class="op" id="2083379">)</span><span class="op" id="2083380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2083383">case</span>&nbsp;<span class="op" id="2083388">*</span><span class="builtintype" id="2083389">uint16</span><span class="op" id="2083395">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2083399">*</span><span class="ident" id="2083400">v</span>&nbsp;<span class="op" id="2083402">=</span>&nbsp;<span class="builtintype" id="2083404">uint16</span><span class="op" id="2083410">(</span><span class="ident" id="2083411">s</span><span class="op" id="2083412">.</span><span class="ident" id="2083413">scanUint</span><span class="op" id="2083421">(</span><span class="ident" id="2083422">verb</span><span class="op" id="2083426">,</span>&nbsp;<span class="num" id="2083428">16</span><span class="op" id="2083430">)</span><span class="op" id="2083431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2083434">case</span>&nbsp;<span class="op" id="2083439">*</span><span class="builtintype" id="2083440">uint32</span><span class="op" id="2083446">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2083450">*</span><span class="ident" id="2083451">v</span>&nbsp;<span class="op" id="2083453">=</span>&nbsp;<span class="builtintype" id="2083455">uint32</span><span class="op" id="2083461">(</span><span class="ident" id="2083462">s</span><span class="op" id="2083463">.</span><span class="ident" id="2083464">scanUint</span><span class="op" id="2083472">(</span><span class="ident" id="2083473">verb</span><span class="op" id="2083477">,</span>&nbsp;<span class="num" id="2083479">32</span><span class="op" id="2083481">)</span><span class="op" id="2083482">)</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2083485">case</span>&nbsp;<span class="op" id="2083490">*</span><span class="ident" id="2083491">uint64</span><span class="op" id="2083497">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2083501">*</span><span class="ident" id="2083502">v</span>&nbsp;<span class="op" id="2083504">=</span>&nbsp;<span class="ident" id="2083506">s</span><span class="op" id="2083507">.</span><span class="ident" id="2083508">scanUint</span><span class="op" id="2083516">(</span><span class="ident" id="2083517">verb</span><span class="op" id="2083521">,</span>&nbsp;<span class="num" id="2083523">64</span><span class="op" id="2083525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2083528">case</span>&nbsp;<span class="op" id="2083533">*</span><span class="builtintype" id="2083534">uintptr</span><span class="op" id="2083541">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2083545">*</span><span class="ident" id="2083546">v</span>&nbsp;<span class="op" id="2083548">=</span>&nbsp;<span class="builtintype" id="2083550">uintptr</span><span class="op" id="2083557">(</span><span class="ident" id="2083558">s</span><span class="op" id="2083559">.</span><span class="ident" id="2083560">scanUint</span><span class="op" id="2083568">(</span><span class="ident" id="2083569">verb</span><span class="op" id="2083573">,</span>&nbsp;<span class="ident" id="2083575">uintptrBits</span><span class="op" id="2083586">)</span><span class="op" id="2083587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2083590">//&nbsp;Floats&nbsp;are&nbsp;tricky&nbsp;because&nbsp;you&nbsp;want&nbsp;to&nbsp;scan&nbsp;in&nbsp;the&nbsp;precision&nbsp;of&nbsp;the&nbsp;result,&nbsp;not</span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2083673">//&nbsp;scan&nbsp;in&nbsp;high&nbsp;precision&nbsp;and&nbsp;convert,&nbsp;in&nbsp;order&nbsp;to&nbsp;preserve&nbsp;the&nbsp;correct&nbsp;error&nbsp;condition.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2083763">case</span>&nbsp;<span class="op" id="2083768">*</span><span class="builtintype" id="2083769">float32</span><span class="op" id="2083776">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2083780">if</span>&nbsp;<span class="ident" id="2083783">s</span><span class="op" id="2083784">.</span><span class="ident" id="2083785">okVerb</span><span class="op" id="2083791">(</span><span class="ident" id="2083792">verb</span><span class="op" id="2083796">,</span>&nbsp;<span class="ident" id="2083798">floatVerbs</span><span class="op" id="2083808">,</span>&nbsp;<span class="string" id="2083810">&#34;float32&#34;</span><span class="op" id="2083819">)</span>&nbsp;<span class="op" id="2083821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2083826">s</span><span class="op" id="2083827">.</span><span class="ident" id="2083828">skipSpace</span><span class="op" id="2083837">(</span><span class="builtintype" id="2083838">false</span><span class="op" id="2083843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2083848">s</span><span class="op" id="2083849">.</span><span class="ident" id="2083850">notEOF</span><span class="op" id="2083856">(</span><span class="op" id="2083857">)</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2083862">*</span><span class="ident" id="2083863">v</span>&nbsp;<span class="op" id="2083865">=</span>&nbsp;<span class="builtintype" id="2083867">float32</span><span class="op" id="2083874">(</span><span class="ident" id="2083875">s</span><span class="op" id="2083876">.</span><span class="ident" id="2083877">convertFloat</span><span class="op" id="2083889">(</span><span class="ident" id="2083890">s</span><span class="op" id="2083891">.</span><span class="ident" id="2083892">floatToken</span><span class="op" id="2083902">(</span><span class="op" id="2083903">)</span><span class="op" id="2083904">,</span>&nbsp;<span class="num" id="2083906">32</span><span class="op" id="2083908">)</span><span class="op" id="2083909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2083913">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2083916">case</span>&nbsp;<span class="op" id="2083921">*</span><span class="builtintype" id="2083922">float64</span><span class="op" id="2083929">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2083933">if</span>&nbsp;<span class="ident" id="2083936">s</span><span class="op" id="2083937">.</span><span class="ident" id="2083938">okVerb</span><span class="op" id="2083944">(</span><span class="ident" id="2083945">verb</span><span class="op" id="2083949">,</span>&nbsp;<span class="ident" id="2083951">floatVerbs</span><span class="op" id="2083961">,</span>&nbsp;<span class="string" id="2083963">&#34;float64&#34;</span><span class="op" id="2083972">)</span>&nbsp;<span class="op" id="2083974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2083979">s</span><span class="op" id="2083980">.</span><span class="ident" id="2083981">skipSpace</span><span class="op" id="2083990">(</span><span class="builtintype" id="2083991">false</span><span class="op" id="2083996">)</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2084001">s</span><span class="op" id="2084002">.</span><span class="ident" id="2084003">notEOF</span><span class="op" id="2084009">(</span><span class="op" id="2084010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2084015">*</span><span class="ident" id="2084016">v</span>&nbsp;<span class="op" id="2084018">=</span>&nbsp;<span class="ident" id="2084020">s</span><span class="op" id="2084021">.</span><span class="ident" id="2084022">convertFloat</span><span class="op" id="2084034">(</span><span class="ident" id="2084035">s</span><span class="op" id="2084036">.</span><span class="ident" id="2084037">floatToken</span><span class="op" id="2084047">(</span><span class="op" id="2084048">)</span><span class="op" id="2084049">,</span>&nbsp;<span class="num" id="2084051">64</span><span class="op" id="2084053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2084057">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2084060">case</span>&nbsp;<span class="op" id="2084065">*</span><span class="builtintype" id="2084066">string</span><span class="op" id="2084072">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2084076">*</span><span class="ident" id="2084077">v</span>&nbsp;<span class="op" id="2084079">=</span>&nbsp;<span class="ident" id="2084081">s</span><span class="op" id="2084082">.</span><span class="ident" id="2084083">convertString</span><span class="op" id="2084096">(</span><span class="ident" id="2084097">verb</span><span class="op" id="2084101">)</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2084104">case</span>&nbsp;<span class="op" id="2084109">*</span><span class="op" id="2084110">[</span><span class="op" id="2084111">]</span><span class="builtintype" id="2084112">byte</span><span class="op" id="2084116">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2084120">//&nbsp;We&nbsp;scan&nbsp;to&nbsp;string&nbsp;and&nbsp;convert&nbsp;so&nbsp;we&nbsp;get&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2084185">//&nbsp;If&nbsp;we&nbsp;scanned&nbsp;to&nbsp;bytes,&nbsp;the&nbsp;slice&nbsp;would&nbsp;point&nbsp;at&nbsp;the&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2084251">*</span><span class="ident" id="2084252">v</span>&nbsp;<span class="op" id="2084254">=</span>&nbsp;<span class="op" id="2084256">[</span><span class="op" id="2084257">]</span><span class="builtintype" id="2084258">byte</span><span class="op" id="2084262">(</span><span class="ident" id="2084263">s</span><span class="op" id="2084264">.</span><span class="ident" id="2084265">convertString</span><span class="op" id="2084278">(</span><span class="ident" id="2084279">verb</span><span class="op" id="2084283">)</span><span class="op" id="2084284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2084287">default</span><span class="op" id="2084294">:</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2084298">val</span>&nbsp;<span class="op" id="2084302">:=</span>&nbsp;<span class="ident" id="2084305">reflect</span><span class="op" id="2084312">.</span><span class="ident" id="2084313">ValueOf</span><span class="op" id="2084320">(</span><span class="ident" id="2084321">v</span><span class="op" id="2084322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2084326">ptr</span>&nbsp;<span class="op" id="2084330">:=</span>&nbsp;<span class="ident" id="2084333">val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2084339">if</span>&nbsp;<span class="ident" id="2084342">ptr</span><span class="op" id="2084345">.</span><span class="ident" id="2084346">Kind</span><span class="op" id="2084350">(</span><span class="op" id="2084351">)</span>&nbsp;<span class="op" id="2084353">!=</span>&nbsp;<span class="ident" id="2084356">reflect</span><span class="op" id="2084363">.</span><span class="ident" id="2084364">Ptr</span>&nbsp;<span class="op" id="2084368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2084373">s</span><span class="op" id="2084374">.</span><span class="ident" id="2084375">errorString</span><span class="op" id="2084386">(</span><span class="string" id="2084387">&#34;type&nbsp;not&nbsp;a&nbsp;pointer:&nbsp;&#34;</span>&nbsp;<span class="op" id="2084410">+</span>&nbsp;<span class="ident" id="2084412">val</span><span class="op" id="2084415">.</span><span class="ident" id="2084416">Type</span><span class="op" id="2084420">(</span><span class="op" id="2084421">)</span><span class="op" id="2084422">.</span><span class="ident" id="2084423">String</span><span class="op" id="2084429">(</span><span class="op" id="2084430">)</span><span class="op" id="2084431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2084436">return</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2084445">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2084449">switch</span>&nbsp;<span class="ident" id="2084456">v</span>&nbsp;<span class="op" id="2084458">:=</span>&nbsp;<span class="ident" id="2084461">ptr</span><span class="op" id="2084464">.</span><span class="ident" id="2084465">Elem</span><span class="op" id="2084469">(</span><span class="op" id="2084470">)</span><span class="op" id="2084471">;</span>&nbsp;<span class="ident" id="2084473">v</span><span class="op" id="2084474">.</span><span class="ident" id="2084475">Kind</span><span class="op" id="2084479">(</span><span class="op" id="2084480">)</span>&nbsp;<span class="op" id="2084482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2084486">case</span>&nbsp;<span class="ident" id="2084491">reflect</span><span class="op" id="2084498">.</span><span class="ident" id="2084499">Bool</span><span class="op" id="2084503">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2084508">v</span><span class="op" id="2084509">.</span><span class="ident" id="2084510">SetBool</span><span class="op" id="2084517">(</span><span class="ident" id="2084518">s</span><span class="op" id="2084519">.</span><span class="ident" id="2084520">scanBool</span><span class="op" id="2084528">(</span><span class="ident" id="2084529">verb</span><span class="op" id="2084533">)</span><span class="op" id="2084534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2084538">case</span>&nbsp;<span class="ident" id="2084543">reflect</span><span class="op" id="2084550">.</span><span class="ident" id="2084551">Int</span><span class="op" id="2084554">,</span>&nbsp;<span class="ident" id="2084556">reflect</span><span class="op" id="2084563">.</span><span class="ident" id="2084564">Int8</span><span class="op" id="2084568">,</span>&nbsp;<span class="ident" id="2084570">reflect</span><span class="op" id="2084577">.</span><span class="ident" id="2084578">Int16</span><span class="op" id="2084583">,</span>&nbsp;<span class="ident" id="2084585">reflect</span><span class="op" id="2084592">.</span><span class="ident" id="2084593">Int32</span><span class="op" id="2084598">,</span>&nbsp;<span class="ident" id="2084600">reflect</span><span class="op" id="2084607">.</span><span class="ident" id="2084608">Int64</span><span class="op" id="2084613">:</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2084618">v</span><span class="op" id="2084619">.</span><span class="ident" id="2084620">SetInt</span><span class="op" id="2084626">(</span><span class="ident" id="2084627">s</span><span class="op" id="2084628">.</span><span class="ident" id="2084629">scanInt</span><span class="op" id="2084636">(</span><span class="ident" id="2084637">verb</span><span class="op" id="2084641">,</span>&nbsp;<span class="ident" id="2084643">v</span><span class="op" id="2084644">.</span><span class="ident" id="2084645">Type</span><span class="op" id="2084649">(</span><span class="op" id="2084650">)</span><span class="op" id="2084651">.</span><span class="ident" id="2084652">Bits</span><span class="op" id="2084656">(</span><span class="op" id="2084657">)</span><span class="op" id="2084658">)</span><span class="op" id="2084659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2084663">case</span>&nbsp;<span class="ident" id="2084668">reflect</span><span class="op" id="2084675">.</span><span class="ident" id="2084676">Uint</span><span class="op" id="2084680">,</span>&nbsp;<span class="ident" id="2084682">reflect</span><span class="op" id="2084689">.</span><span class="ident" id="2084690">Uint8</span><span class="op" id="2084695">,</span>&nbsp;<span class="ident" id="2084697">reflect</span><span class="op" id="2084704">.</span><span class="ident" id="2084705">Uint16</span><span class="op" id="2084711">,</span>&nbsp;<span class="ident" id="2084713">reflect</span><span class="op" id="2084720">.</span><span class="ident" id="2084721">Uint32</span><span class="op" id="2084727">,</span>&nbsp;<span class="ident" id="2084729">reflect</span><span class="op" id="2084736">.</span><span class="ident" id="2084737">Uint64</span><span class="op" id="2084743">,</span>&nbsp;<span class="ident" id="2084745">reflect</span><span class="op" id="2084752">.</span><span class="ident" id="2084753">Uintptr</span><span class="op" id="2084760">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2084765">v</span><span class="op" id="2084766">.</span><span class="ident" id="2084767">SetUint</span><span class="op" id="2084774">(</span><span class="ident" id="2084775">s</span><span class="op" id="2084776">.</span><span class="ident" id="2084777">scanUint</span><span class="op" id="2084785">(</span><span class="ident" id="2084786">verb</span><span class="op" id="2084790">,</span>&nbsp;<span class="ident" id="2084792">v</span><span class="op" id="2084793">.</span><span class="ident" id="2084794">Type</span><span class="op" id="2084798">(</span><span class="op" id="2084799">)</span><span class="op" id="2084800">.</span><span class="ident" id="2084801">Bits</span><span class="op" id="2084805">(</span><span class="op" id="2084806">)</span><span class="op" id="2084807">)</span><span class="op" id="2084808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2084812">case</span>&nbsp;<span class="ident" id="2084817">reflect</span><span class="op" id="2084824">.</span><span class="ident" id="2084825">String</span><span class="op" id="2084831">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2084836">v</span><span class="op" id="2084837">.</span><span class="ident" id="2084838">SetString</span><span class="op" id="2084847">(</span><span class="ident" id="2084848">s</span><span class="op" id="2084849">.</span><span class="ident" id="2084850">convertString</span><span class="op" id="2084863">(</span><span class="ident" id="2084864">verb</span><span class="op" id="2084868">)</span><span class="op" id="2084869">)</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2084873">case</span>&nbsp;<span class="ident" id="2084878">reflect</span><span class="op" id="2084885">.</span><span class="ident" id="2084886">Slice</span><span class="op" id="2084891">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2084896">//&nbsp;For&nbsp;now,&nbsp;can&nbsp;only&nbsp;handle&nbsp;(renamed)&nbsp;[]byte.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2084945">typ</span>&nbsp;<span class="op" id="2084949">:=</span>&nbsp;<span class="ident" id="2084952">v</span><span class="op" id="2084953">.</span><span class="ident" id="2084954">Type</span><span class="op" id="2084958">(</span><span class="op" id="2084959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2084964">if</span>&nbsp;<span class="ident" id="2084967">typ</span><span class="op" id="2084970">.</span><span class="ident" id="2084971">Elem</span><span class="op" id="2084975">(</span><span class="op" id="2084976">)</span><span class="op" id="2084977">.</span><span class="ident" id="2084978">Kind</span><span class="op" id="2084982">(</span><span class="op" id="2084983">)</span>&nbsp;<span class="op" id="2084985">!=</span>&nbsp;<span class="ident" id="2084988">reflect</span><span class="op" id="2084995">.</span><span class="ident" id="2084996">Uint8</span>&nbsp;<span class="op" id="2085002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2085008">s</span><span class="op" id="2085009">.</span><span class="ident" id="2085010">errorString</span><span class="op" id="2085021">(</span><span class="string" id="2085022">&#34;can&#39;t&nbsp;scan&nbsp;type:&nbsp;&#34;</span>&nbsp;<span class="op" id="2085042">+</span>&nbsp;<span class="ident" id="2085044">val</span><span class="op" id="2085047">.</span><span class="ident" id="2085048">Type</span><span class="op" id="2085052">(</span><span class="op" id="2085053">)</span><span class="op" id="2085054">.</span><span class="ident" id="2085055">String</span><span class="op" id="2085061">(</span><span class="op" id="2085062">)</span><span class="op" id="2085063">)</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2085068">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2085073">str</span>&nbsp;<span class="op" id="2085077">:=</span>&nbsp;<span class="ident" id="2085080">s</span><span class="op" id="2085081">.</span><span class="ident" id="2085082">convertString</span><span class="op" id="2085095">(</span><span class="ident" id="2085096">verb</span><span class="op" id="2085100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2085105">v</span><span class="op" id="2085106">.</span><span class="ident" id="2085107">Set</span><span class="op" id="2085110">(</span><span class="ident" id="2085111">reflect</span><span class="op" id="2085118">.</span><span class="ident" id="2085119">MakeSlice</span><span class="op" id="2085128">(</span><span class="ident" id="2085129">typ</span><span class="op" id="2085132">,</span>&nbsp;<span class="builtinfunc" id="2085134">len</span><span class="op" id="2085137">(</span><span class="ident" id="2085138">str</span><span class="op" id="2085141">)</span><span class="op" id="2085142">,</span>&nbsp;<span class="builtinfunc" id="2085144">len</span><span class="op" id="2085147">(</span><span class="ident" id="2085148">str</span><span class="op" id="2085151">)</span><span class="op" id="2085152">)</span><span class="op" id="2085153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2085158">for</span>&nbsp;<span class="ident" id="2085162">i</span>&nbsp;<span class="op" id="2085164">:=</span>&nbsp;<span class="num" id="2085167">0</span><span class="op" id="2085168">;</span>&nbsp;<span class="ident" id="2085170">i</span>&nbsp;<span class="op" id="2085172">&lt;</span>&nbsp;<span class="builtinfunc" id="2085174">len</span><span class="op" id="2085177">(</span><span class="ident" id="2085178">str</span><span class="op" id="2085181">)</span><span class="op" id="2085182">;</span>&nbsp;<span class="ident" id="2085184">i</span><span class="op" id="2085185">++</span>&nbsp;<span class="op" id="2085188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2085194">v</span><span class="op" id="2085195">.</span><span class="ident" id="2085196">Index</span><span class="op" id="2085201">(</span><span class="ident" id="2085202">i</span><span class="op" id="2085203">)</span><span class="op" id="2085204">.</span><span class="ident" id="2085205">SetUint</span><span class="op" id="2085212">(</span><span class="ident" id="2085213">uint64</span><span class="op" id="2085219">(</span><span class="ident" id="2085220">str</span><span class="op" id="2085223">[</span><span class="ident" id="2085224">i</span><span class="op" id="2085225">]</span><span class="op" id="2085226">)</span><span class="op" id="2085227">)</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2085232">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2085236">case</span>&nbsp;<span class="ident" id="2085241">reflect</span><span class="op" id="2085248">.</span><span class="ident" id="2085249">Float32</span><span class="op" id="2085256">,</span>&nbsp;<span class="ident" id="2085258">reflect</span><span class="op" id="2085265">.</span><span class="ident" id="2085266">Float64</span><span class="op" id="2085273">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2085278">s</span><span class="op" id="2085279">.</span><span class="ident" id="2085280">skipSpace</span><span class="op" id="2085289">(</span><span class="builtintype" id="2085290">false</span><span class="op" id="2085295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2085300">s</span><span class="op" id="2085301">.</span><span class="ident" id="2085302">notEOF</span><span class="op" id="2085308">(</span><span class="op" id="2085309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2085314">v</span><span class="op" id="2085315">.</span><span class="ident" id="2085316">SetFloat</span><span class="op" id="2085324">(</span><span class="ident" id="2085325">s</span><span class="op" id="2085326">.</span><span class="ident" id="2085327">convertFloat</span><span class="op" id="2085339">(</span><span class="ident" id="2085340">s</span><span class="op" id="2085341">.</span><span class="ident" id="2085342">floatToken</span><span class="op" id="2085352">(</span><span class="op" id="2085353">)</span><span class="op" id="2085354">,</span>&nbsp;<span class="ident" id="2085356">v</span><span class="op" id="2085357">.</span><span class="ident" id="2085358">Type</span><span class="op" id="2085362">(</span><span class="op" id="2085363">)</span><span class="op" id="2085364">.</span><span class="ident" id="2085365">Bits</span><span class="op" id="2085369">(</span><span class="op" id="2085370">)</span><span class="op" id="2085371">)</span><span class="op" id="2085372">)</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2085376">case</span>&nbsp;<span class="ident" id="2085381">reflect</span><span class="op" id="2085388">.</span><span class="ident" id="2085389">Complex64</span><span class="op" id="2085398">,</span>&nbsp;<span class="ident" id="2085400">reflect</span><span class="op" id="2085407">.</span><span class="ident" id="2085408">Complex128</span><span class="op" id="2085418">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2085423">v</span><span class="op" id="2085424">.</span><span class="ident" id="2085425">SetComplex</span><span class="op" id="2085435">(</span><span class="ident" id="2085436">s</span><span class="op" id="2085437">.</span><span class="ident" id="2085438">scanComplex</span><span class="op" id="2085449">(</span><span class="ident" id="2085450">verb</span><span class="op" id="2085454">,</span>&nbsp;<span class="ident" id="2085456">v</span><span class="op" id="2085457">.</span><span class="ident" id="2085458">Type</span><span class="op" id="2085462">(</span><span class="op" id="2085463">)</span><span class="op" id="2085464">.</span><span class="ident" id="2085465">Bits</span><span class="op" id="2085469">(</span><span class="op" id="2085470">)</span><span class="op" id="2085471">)</span><span class="op" id="2085472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2085476">default</span><span class="op" id="2085483">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2085488">s</span><span class="op" id="2085489">.</span><span class="ident" id="2085490">errorString</span><span class="op" id="2085501">(</span><span class="string" id="2085502">&#34;can&#39;t&nbsp;scan&nbsp;type:&nbsp;&#34;</span>&nbsp;<span class="op" id="2085522">+</span>&nbsp;<span class="ident" id="2085524">val</span><span class="op" id="2085527">.</span><span class="ident" id="2085528">Type</span><span class="op" id="2085532">(</span><span class="op" id="2085533">)</span><span class="op" id="2085534">.</span><span class="ident" id="2085535">String</span><span class="op" id="2085541">(</span><span class="op" id="2085542">)</span><span class="op" id="2085543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2085547">}</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2085550">}</span><br>
<span class="lineno"></span><span class="op" id="2085552">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2085555">//&nbsp;errorHandler&nbsp;turns&nbsp;local&nbsp;panics&nbsp;into&nbsp;error&nbsp;returns.</span><br>
<span class="lineno"></span><span class="keyword" id="2085610">func</span>&nbsp;<span class="ident" id="2085615">errorHandler</span><span class="op" id="2085627">(</span><span class="ident" id="2085628">errp</span>&nbsp;<span class="op" id="2085633">*</span><span class="builtintype" id="2085634">error</span><span class="op" id="2085639">)</span>&nbsp;<span class="op" id="2085641">{</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2085644">if</span>&nbsp;<span class="ident" id="2085647">e</span>&nbsp;<span class="op" id="2085649">:=</span>&nbsp;<span class="builtinfunc" id="2085652">recover</span><span class="op" id="2085659">(</span><span class="op" id="2085660">)</span><span class="op" id="2085661">;</span>&nbsp;<span class="ident" id="2085663">e</span>&nbsp;<span class="op" id="2085665">!=</span>&nbsp;<span class="ident" id="2085668">nil</span>&nbsp;<span class="op" id="2085672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2085676">if</span>&nbsp;<span class="ident" id="2085679">se</span><span class="op" id="2085681">,</span>&nbsp;<span class="ident" id="2085683">ok</span>&nbsp;<span class="op" id="2085686">:=</span>&nbsp;<span class="ident" id="2085689">e</span><span class="op" id="2085690">.</span><span class="op" id="2085691">(</span><span class="ident" id="2085692">scanError</span><span class="op" id="2085701">)</span><span class="op" id="2085702">;</span>&nbsp;<span class="ident" id="2085704">ok</span>&nbsp;<span class="op" id="2085707">{</span>&nbsp;<span class="comment" id="2085709">//&nbsp;catch&nbsp;local&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2085733">*</span><span class="ident" id="2085734">errp</span>&nbsp;<span class="op" id="2085739">=</span>&nbsp;<span class="ident" id="2085741">se</span><span class="op" id="2085743">.</span><span class="ident" id="2085744">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2085750">}</span>&nbsp;<span class="keyword" id="2085752">else</span>&nbsp;<span class="keyword" id="2085757">if</span>&nbsp;<span class="ident" id="2085760">eof</span><span class="op" id="2085763">,</span>&nbsp;<span class="ident" id="2085765">ok</span>&nbsp;<span class="op" id="2085768">:=</span>&nbsp;<span class="ident" id="2085771">e</span><span class="op" id="2085772">.</span><span class="op" id="2085773">(</span><span class="builtintype" id="2085774">error</span><span class="op" id="2085779">)</span><span class="op" id="2085780">;</span>&nbsp;<span class="ident" id="2085782">ok</span>&nbsp;<span class="op" id="2085785">&amp;&amp;</span>&nbsp;<span class="ident" id="2085788">eof</span>&nbsp;<span class="op" id="2085792">==</span>&nbsp;<span class="ident" id="2085795">io</span><span class="op" id="2085797">.</span><span class="ident" id="2085798">EOF</span>&nbsp;<span class="op" id="2085802">{</span>&nbsp;<span class="comment" id="2085804">//&nbsp;out&nbsp;of&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2085823">*</span><span class="ident" id="2085824">errp</span>&nbsp;<span class="op" id="2085829">=</span>&nbsp;<span class="ident" id="2085831">eof</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2085837">}</span>&nbsp;<span class="keyword" id="2085839">else</span>&nbsp;<span class="op" id="2085844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2085849">panic</span><span class="op" id="2085854">(</span><span class="ident" id="2085855">e</span><span class="op" id="2085856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2085860">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2085863">}</span><br>
<span class="lineno"></span><span class="op" id="2085865">}</span><br>
<span class="lineno">1045</span><br>
<span class="lineno"></span><span class="comment" id="2085868">//&nbsp;doScan&nbsp;does&nbsp;the&nbsp;real&nbsp;work&nbsp;for&nbsp;scanning&nbsp;without&nbsp;a&nbsp;format&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2085935">func</span>&nbsp;<span class="op" id="2085940">(</span><span class="ident" id="2085941">s</span>&nbsp;<span class="op" id="2085943">*</span><span class="ident" id="2085944">ss</span><span class="op" id="2085946">)</span>&nbsp;<span class="ident" id="2085948">doScan</span><span class="op" id="2085954">(</span><span class="ident" id="2085955">a</span>&nbsp;<span class="op" id="2085957">[</span><span class="op" id="2085958">]</span><span class="keyword" id="2085959">interface</span><span class="op" id="2085968">{</span><span class="op" id="2085969">}</span><span class="op" id="2085970">)</span>&nbsp;<span class="op" id="2085972">(</span><span class="ident" id="2085973">numProcessed</span>&nbsp;<span class="builtintype" id="2085986">int</span><span class="op" id="2085989">,</span>&nbsp;<span class="ident" id="2085991">err</span>&nbsp;<span class="builtintype" id="2085995">error</span><span class="op" id="2086000">)</span>&nbsp;<span class="op" id="2086002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2086005">defer</span>&nbsp;<span class="ident" id="2086011">errorHandler</span><span class="op" id="2086023">(</span><span class="op" id="2086024">&amp;</span><span class="ident" id="2086025">err</span><span class="op" id="2086028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2086031">for</span>&nbsp;<span class="ident" id="2086035">_</span><span class="op" id="2086036">,</span>&nbsp;<span class="ident" id="2086038">arg</span>&nbsp;<span class="op" id="2086042">:=</span>&nbsp;<span class="keyword" id="2086045">range</span>&nbsp;<span class="ident" id="2086051">a</span>&nbsp;<span class="op" id="2086053">{</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2086057">s</span><span class="op" id="2086058">.</span><span class="ident" id="2086059">scanOne</span><span class="op" id="2086066">(</span><span class="string" id="2086067">&#39;v&#39;</span><span class="op" id="2086070">,</span>&nbsp;<span class="ident" id="2086072">arg</span><span class="op" id="2086075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2086079">numProcessed</span><span class="op" id="2086091">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2086095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2086098">//&nbsp;Check&nbsp;for&nbsp;newline&nbsp;if&nbsp;required.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2086133">if</span>&nbsp;<span class="op" id="2086136">!</span><span class="ident" id="2086137">s</span><span class="op" id="2086138">.</span><span class="ident" id="2086139">nlIsSpace</span>&nbsp;<span class="op" id="2086149">{</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2086153">for</span>&nbsp;<span class="op" id="2086157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2086162">r</span>&nbsp;<span class="op" id="2086164">:=</span>&nbsp;<span class="ident" id="2086167">s</span><span class="op" id="2086168">.</span><span class="ident" id="2086169">getRune</span><span class="op" id="2086176">(</span><span class="op" id="2086177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2086182">if</span>&nbsp;<span class="ident" id="2086185">r</span>&nbsp;<span class="op" id="2086187">==</span>&nbsp;<span class="string" id="2086190">&#39;\n&#39;</span>&nbsp;<span class="op" id="2086195">||</span>&nbsp;<span class="ident" id="2086198">r</span>&nbsp;<span class="op" id="2086200">==</span>&nbsp;<span class="ident" id="2086203">eof</span>&nbsp;<span class="op" id="2086207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2086213">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2086222">}</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2086227">if</span>&nbsp;<span class="op" id="2086230">!</span><span class="ident" id="2086231">isSpace</span><span class="op" id="2086238">(</span><span class="ident" id="2086239">r</span><span class="op" id="2086240">)</span>&nbsp;<span class="op" id="2086242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2086248">s</span><span class="op" id="2086249">.</span><span class="ident" id="2086250">errorString</span><span class="op" id="2086261">(</span><span class="string" id="2086262">&#34;expected&nbsp;newline&#34;</span><span class="op" id="2086280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2086286">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2086295">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2086299">}</span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2086302">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2086305">return</span><br>
<span class="lineno"></span><span class="op" id="2086312">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2086315">//&nbsp;advance&nbsp;determines&nbsp;whether&nbsp;the&nbsp;next&nbsp;characters&nbsp;in&nbsp;the&nbsp;input&nbsp;match</span><br>
<span class="lineno">1070</span><span class="comment" id="2086384">//&nbsp;those&nbsp;of&nbsp;the&nbsp;format.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;(sic)&nbsp;consumed</span><br>
<span class="lineno"></span><span class="comment" id="2086455">//&nbsp;in&nbsp;the&nbsp;format.&nbsp;Newlines&nbsp;included,&nbsp;all&nbsp;runs&nbsp;of&nbsp;space&nbsp;characters&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="2086524">//&nbsp;either&nbsp;input&nbsp;or&nbsp;format&nbsp;behave&nbsp;as&nbsp;a&nbsp;single&nbsp;space.&nbsp;This&nbsp;routine&nbsp;also</span><br>
<span class="lineno"></span><span class="comment" id="2086594">//&nbsp;handles&nbsp;the&nbsp;%%&nbsp;case.&nbsp;&nbsp;If&nbsp;the&nbsp;return&nbsp;value&nbsp;is&nbsp;zero,&nbsp;either&nbsp;format</span><br>
<span class="lineno"></span><span class="comment" id="2086662">//&nbsp;starts&nbsp;with&nbsp;a&nbsp;%&nbsp;(with&nbsp;no&nbsp;following&nbsp;%)&nbsp;or&nbsp;the&nbsp;input&nbsp;is&nbsp;empty.</span><br>
<span class="lineno">1075</span><span class="comment" id="2086726">//&nbsp;If&nbsp;it&nbsp;is&nbsp;negative,&nbsp;the&nbsp;input&nbsp;did&nbsp;not&nbsp;match&nbsp;the&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2086784">func</span>&nbsp;<span class="op" id="2086789">(</span><span class="ident" id="2086790">s</span>&nbsp;<span class="op" id="2086792">*</span><span class="ident" id="2086793">ss</span><span class="op" id="2086795">)</span>&nbsp;<span class="ident" id="2086797">advance</span><span class="op" id="2086804">(</span><span class="ident" id="2086805">format</span>&nbsp;<span class="builtintype" id="2086812">string</span><span class="op" id="2086818">)</span>&nbsp;<span class="op" id="2086820">(</span><span class="ident" id="2086821">i</span>&nbsp;<span class="builtintype" id="2086823">int</span><span class="op" id="2086826">)</span>&nbsp;<span class="op" id="2086828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2086831">for</span>&nbsp;<span class="ident" id="2086835">i</span>&nbsp;<span class="op" id="2086837">&lt;</span>&nbsp;<span class="builtinfunc" id="2086839">len</span><span class="op" id="2086842">(</span><span class="ident" id="2086843">format</span><span class="op" id="2086849">)</span>&nbsp;<span class="op" id="2086851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2086855">fmtc</span><span class="op" id="2086859">,</span>&nbsp;<span class="ident" id="2086861">w</span>&nbsp;<span class="op" id="2086863">:=</span>&nbsp;<span class="ident" id="2086866">utf8</span><span class="op" id="2086870">.</span><span class="ident" id="2086871">DecodeRuneInString</span><span class="op" id="2086889">(</span><span class="ident" id="2086890">format</span><span class="op" id="2086896">[</span><span class="ident" id="2086897">i</span><span class="op" id="2086898">:</span><span class="op" id="2086899">]</span><span class="op" id="2086900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2086904">if</span>&nbsp;<span class="ident" id="2086907">fmtc</span>&nbsp;<span class="op" id="2086912">==</span>&nbsp;<span class="string" id="2086915">&#39;%&#39;</span>&nbsp;<span class="op" id="2086919">{</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2086924">//&nbsp;%%&nbsp;acts&nbsp;like&nbsp;a&nbsp;real&nbsp;percent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2086958">nextc</span><span class="op" id="2086963">,</span>&nbsp;<span class="ident" id="2086965">_</span>&nbsp;<span class="op" id="2086967">:=</span>&nbsp;<span class="ident" id="2086970">utf8</span><span class="op" id="2086974">.</span><span class="ident" id="2086975">DecodeRuneInString</span><span class="op" id="2086993">(</span><span class="ident" id="2086994">format</span><span class="op" id="2087000">[</span><span class="ident" id="2087001">i</span><span class="op" id="2087002">+</span><span class="ident" id="2087003">w</span><span class="op" id="2087004">:</span><span class="op" id="2087005">]</span><span class="op" id="2087006">)</span>&nbsp;<span class="comment" id="2087008">//&nbsp;will&nbsp;not&nbsp;match&nbsp;%&nbsp;if&nbsp;string&nbsp;is&nbsp;empty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2087050">if</span>&nbsp;<span class="ident" id="2087053">nextc</span>&nbsp;<span class="op" id="2087059">!=</span>&nbsp;<span class="string" id="2087062">&#39;%&#39;</span>&nbsp;<span class="op" id="2087066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2087072">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2087082">}</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2087087">i</span>&nbsp;<span class="op" id="2087089">+=</span>&nbsp;<span class="ident" id="2087092">w</span>&nbsp;<span class="comment" id="2087094">//&nbsp;skip&nbsp;the&nbsp;first&nbsp;%</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2087116">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2087120">sawSpace</span>&nbsp;<span class="op" id="2087129">:=</span>&nbsp;<span class="builtintype" id="2087132">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2087140">for</span>&nbsp;<span class="ident" id="2087144">isSpace</span><span class="op" id="2087151">(</span><span class="ident" id="2087152">fmtc</span><span class="op" id="2087156">)</span>&nbsp;<span class="op" id="2087158">&amp;&amp;</span>&nbsp;<span class="ident" id="2087161">i</span>&nbsp;<span class="op" id="2087163">&lt;</span>&nbsp;<span class="builtinfunc" id="2087165">len</span><span class="op" id="2087168">(</span><span class="ident" id="2087169">format</span><span class="op" id="2087175">)</span>&nbsp;<span class="op" id="2087177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2087182">sawSpace</span>&nbsp;<span class="op" id="2087191">=</span>&nbsp;<span class="builtintype" id="2087193">true</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2087201">i</span>&nbsp;<span class="op" id="2087203">+=</span>&nbsp;<span class="ident" id="2087206">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2087211">fmtc</span><span class="op" id="2087215">,</span>&nbsp;<span class="ident" id="2087217">w</span>&nbsp;<span class="op" id="2087219">=</span>&nbsp;<span class="ident" id="2087221">utf8</span><span class="op" id="2087225">.</span><span class="ident" id="2087226">DecodeRuneInString</span><span class="op" id="2087244">(</span><span class="ident" id="2087245">format</span><span class="op" id="2087251">[</span><span class="ident" id="2087252">i</span><span class="op" id="2087253">:</span><span class="op" id="2087254">]</span><span class="op" id="2087255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2087259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2087263">if</span>&nbsp;<span class="ident" id="2087266">sawSpace</span>&nbsp;<span class="op" id="2087275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2087280">//&nbsp;There&nbsp;was&nbsp;space&nbsp;in&nbsp;the&nbsp;format,&nbsp;so&nbsp;there&nbsp;should&nbsp;be&nbsp;space&nbsp;(EOF)</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2087348">//&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2087368">inputc</span>&nbsp;<span class="op" id="2087375">:=</span>&nbsp;<span class="ident" id="2087378">s</span><span class="op" id="2087379">.</span><span class="ident" id="2087380">getRune</span><span class="op" id="2087387">(</span><span class="op" id="2087388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2087393">if</span>&nbsp;<span class="ident" id="2087396">inputc</span>&nbsp;<span class="op" id="2087403">==</span>&nbsp;<span class="ident" id="2087406">eof</span>&nbsp;<span class="op" id="2087410">||</span>&nbsp;<span class="ident" id="2087413">inputc</span>&nbsp;<span class="op" id="2087420">==</span>&nbsp;<span class="string" id="2087423">&#39;\n&#39;</span>&nbsp;<span class="op" id="2087428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2087434">//&nbsp;If&nbsp;we&#39;ve&nbsp;reached&nbsp;a&nbsp;newline,&nbsp;stop&nbsp;now;&nbsp;don&#39;t&nbsp;read&nbsp;ahead.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2087497">return</span><br>
<span class="lineno">1100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2087507">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2087512">if</span>&nbsp;<span class="op" id="2087515">!</span><span class="ident" id="2087516">isSpace</span><span class="op" id="2087523">(</span><span class="ident" id="2087524">inputc</span><span class="op" id="2087530">)</span>&nbsp;<span class="op" id="2087532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2087538">//&nbsp;Space&nbsp;in&nbsp;format&nbsp;but&nbsp;not&nbsp;in&nbsp;input:&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2087585">s</span><span class="op" id="2087586">.</span><span class="ident" id="2087587">errorString</span><span class="op" id="2087598">(</span><span class="string" id="2087599">&#34;expected&nbsp;space&nbsp;in&nbsp;input&nbsp;to&nbsp;match&nbsp;format&#34;</span><span class="op" id="2087640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2087645">}</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2087650">s</span><span class="op" id="2087651">.</span><span class="ident" id="2087652">skipSpace</span><span class="op" id="2087661">(</span><span class="builtintype" id="2087662">true</span><span class="op" id="2087666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2087671">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2087682">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2087686">inputc</span>&nbsp;<span class="op" id="2087693">:=</span>&nbsp;<span class="ident" id="2087696">s</span><span class="op" id="2087697">.</span><span class="ident" id="2087698">mustReadRune</span><span class="op" id="2087710">(</span><span class="op" id="2087711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2087715">if</span>&nbsp;<span class="ident" id="2087718">fmtc</span>&nbsp;<span class="op" id="2087723">!=</span>&nbsp;<span class="ident" id="2087726">inputc</span>&nbsp;<span class="op" id="2087733">{</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2087738">s</span><span class="op" id="2087739">.</span><span class="ident" id="2087740">UnreadRune</span><span class="op" id="2087750">(</span><span class="op" id="2087751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2087756">return</span>&nbsp;<span class="op" id="2087763">-</span><span class="num" id="2087764">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2087768">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2087772">i</span>&nbsp;<span class="op" id="2087774">+=</span>&nbsp;<span class="ident" id="2087777">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2087780">}</span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2087783">return</span><br>
<span class="lineno"></span><span class="op" id="2087790">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2087793">//&nbsp;doScanf&nbsp;does&nbsp;the&nbsp;real&nbsp;work&nbsp;when&nbsp;scanning&nbsp;with&nbsp;a&nbsp;format&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="2087859">//&nbsp;&nbsp;At&nbsp;the&nbsp;moment,&nbsp;it&nbsp;handles&nbsp;only&nbsp;pointers&nbsp;to&nbsp;basic&nbsp;types.</span><br>
<span class="lineno">1120</span><span class="keyword" id="2087919">func</span>&nbsp;<span class="op" id="2087924">(</span><span class="ident" id="2087925">s</span>&nbsp;<span class="op" id="2087927">*</span><span class="ident" id="2087928">ss</span><span class="op" id="2087930">)</span>&nbsp;<span class="ident" id="2087932">doScanf</span><span class="op" id="2087939">(</span><span class="ident" id="2087940">format</span>&nbsp;<span class="builtintype" id="2087947">string</span><span class="op" id="2087953">,</span>&nbsp;<span class="ident" id="2087955">a</span>&nbsp;<span class="op" id="2087957">[</span><span class="op" id="2087958">]</span><span class="keyword" id="2087959">interface</span><span class="op" id="2087968">{</span><span class="op" id="2087969">}</span><span class="op" id="2087970">)</span>&nbsp;<span class="op" id="2087972">(</span><span class="ident" id="2087973">numProcessed</span>&nbsp;<span class="builtintype" id="2087986">int</span><span class="op" id="2087989">,</span>&nbsp;<span class="ident" id="2087991">err</span>&nbsp;<span class="builtintype" id="2087995">error</span><span class="op" id="2088000">)</span>&nbsp;<span class="op" id="2088002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2088005">defer</span>&nbsp;<span class="ident" id="2088011">errorHandler</span><span class="op" id="2088023">(</span><span class="op" id="2088024">&amp;</span><span class="ident" id="2088025">err</span><span class="op" id="2088028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2088031">end</span>&nbsp;<span class="op" id="2088035">:=</span>&nbsp;<span class="builtinfunc" id="2088038">len</span><span class="op" id="2088041">(</span><span class="ident" id="2088042">format</span><span class="op" id="2088048">)</span>&nbsp;<span class="op" id="2088050">-</span>&nbsp;<span class="num" id="2088052">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2088055">//&nbsp;We&nbsp;process&nbsp;one&nbsp;item&nbsp;per&nbsp;non-trivial&nbsp;format</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2088102">for</span>&nbsp;<span class="ident" id="2088106">i</span>&nbsp;<span class="op" id="2088108">:=</span>&nbsp;<span class="num" id="2088111">0</span><span class="op" id="2088112">;</span>&nbsp;<span class="ident" id="2088114">i</span>&nbsp;<span class="op" id="2088116">&lt;=</span>&nbsp;<span class="ident" id="2088119">end</span><span class="op" id="2088122">;</span>&nbsp;<span class="op" id="2088124">{</span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2088128">w</span>&nbsp;<span class="op" id="2088130">:=</span>&nbsp;<span class="ident" id="2088133">s</span><span class="op" id="2088134">.</span><span class="ident" id="2088135">advance</span><span class="op" id="2088142">(</span><span class="ident" id="2088143">format</span><span class="op" id="2088149">[</span><span class="ident" id="2088150">i</span><span class="op" id="2088151">:</span><span class="op" id="2088152">]</span><span class="op" id="2088153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2088157">if</span>&nbsp;<span class="ident" id="2088160">w</span>&nbsp;<span class="op" id="2088162">&gt;</span>&nbsp;<span class="num" id="2088164">0</span>&nbsp;<span class="op" id="2088166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2088171">i</span>&nbsp;<span class="op" id="2088173">+=</span>&nbsp;<span class="ident" id="2088176">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2088181">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2088192">}</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2088196">//&nbsp;Either&nbsp;we&nbsp;failed&nbsp;to&nbsp;advance,&nbsp;we&nbsp;have&nbsp;a&nbsp;percent&nbsp;character,&nbsp;or&nbsp;we&nbsp;ran&nbsp;out&nbsp;of&nbsp;input.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2088283">if</span>&nbsp;<span class="ident" id="2088286">format</span><span class="op" id="2088292">[</span><span class="ident" id="2088293">i</span><span class="op" id="2088294">]</span>&nbsp;<span class="op" id="2088296">!=</span>&nbsp;<span class="string" id="2088299">&#39;%&#39;</span>&nbsp;<span class="op" id="2088303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2088308">//&nbsp;Can&#39;t&nbsp;advance&nbsp;format.&nbsp;&nbsp;Why&nbsp;not?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2088346">if</span>&nbsp;<span class="ident" id="2088349">w</span>&nbsp;<span class="op" id="2088351">&lt;</span>&nbsp;<span class="num" id="2088353">0</span>&nbsp;<span class="op" id="2088355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2088361">s</span><span class="op" id="2088362">.</span><span class="ident" id="2088363">errorString</span><span class="op" id="2088374">(</span><span class="string" id="2088375">&#34;input&nbsp;does&nbsp;not&nbsp;match&nbsp;format&#34;</span><span class="op" id="2088404">)</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2088409">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2088414">//&nbsp;Otherwise&nbsp;at&nbsp;EOF;&nbsp;&#34;too&nbsp;many&nbsp;operands&#34;&nbsp;error&nbsp;handled&nbsp;below</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2088478">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2088486">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2088490">i</span><span class="op" id="2088491">++</span>&nbsp;<span class="comment" id="2088494">//&nbsp;%&nbsp;is&nbsp;one&nbsp;byte</span><br>
<span class="lineno">1140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2088514">//&nbsp;do&nbsp;we&nbsp;have&nbsp;20&nbsp;(width)?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2088542">var</span>&nbsp;<span class="ident" id="2088546">widPresent</span>&nbsp;<span class="builtintype" id="2088557">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2088564">s</span><span class="op" id="2088565">.</span><span class="ident" id="2088566">maxWid</span><span class="op" id="2088572">,</span>&nbsp;<span class="ident" id="2088574">widPresent</span><span class="op" id="2088584">,</span>&nbsp;<span class="ident" id="2088586">i</span>&nbsp;<span class="op" id="2088588">=</span>&nbsp;<span class="ident" id="2088590">parsenum</span><span class="op" id="2088598">(</span><span class="ident" id="2088599">format</span><span class="op" id="2088605">,</span>&nbsp;<span class="ident" id="2088607">i</span><span class="op" id="2088608">,</span>&nbsp;<span class="ident" id="2088610">end</span><span class="op" id="2088613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2088617">if</span>&nbsp;<span class="op" id="2088620">!</span><span class="ident" id="2088621">widPresent</span>&nbsp;<span class="op" id="2088632">{</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2088637">s</span><span class="op" id="2088638">.</span><span class="ident" id="2088639">maxWid</span>&nbsp;<span class="op" id="2088646">=</span>&nbsp;<span class="ident" id="2088648">hugeWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2088658">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2088662">s</span><span class="op" id="2088663">.</span><span class="ident" id="2088664">argLimit</span>&nbsp;<span class="op" id="2088673">=</span>&nbsp;<span class="ident" id="2088675">s</span><span class="op" id="2088676">.</span><span class="ident" id="2088677">limit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2088685">if</span>&nbsp;<span class="ident" id="2088688">f</span>&nbsp;<span class="op" id="2088690">:=</span>&nbsp;<span class="ident" id="2088693">s</span><span class="op" id="2088694">.</span><span class="ident" id="2088695">count</span>&nbsp;<span class="op" id="2088701">+</span>&nbsp;<span class="ident" id="2088703">s</span><span class="op" id="2088704">.</span><span class="ident" id="2088705">maxWid</span><span class="op" id="2088711">;</span>&nbsp;<span class="ident" id="2088713">f</span>&nbsp;<span class="op" id="2088715">&lt;</span>&nbsp;<span class="ident" id="2088717">s</span><span class="op" id="2088718">.</span><span class="ident" id="2088719">argLimit</span>&nbsp;<span class="op" id="2088728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2088733">s</span><span class="op" id="2088734">.</span><span class="ident" id="2088735">argLimit</span>&nbsp;<span class="op" id="2088744">=</span>&nbsp;<span class="ident" id="2088746">f</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2088750">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2088755">c</span><span class="op" id="2088756">,</span>&nbsp;<span class="ident" id="2088758">w</span>&nbsp;<span class="op" id="2088760">:=</span>&nbsp;<span class="ident" id="2088763">utf8</span><span class="op" id="2088767">.</span><span class="ident" id="2088768">DecodeRuneInString</span><span class="op" id="2088786">(</span><span class="ident" id="2088787">format</span><span class="op" id="2088793">[</span><span class="ident" id="2088794">i</span><span class="op" id="2088795">:</span><span class="op" id="2088796">]</span><span class="op" id="2088797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2088801">i</span>&nbsp;<span class="op" id="2088803">+=</span>&nbsp;<span class="ident" id="2088806">w</span><br>
<span class="lineno"></span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2088811">if</span>&nbsp;<span class="ident" id="2088814">numProcessed</span>&nbsp;<span class="op" id="2088827">&gt;=</span>&nbsp;<span class="builtinfunc" id="2088830">len</span><span class="op" id="2088833">(</span><span class="ident" id="2088834">a</span><span class="op" id="2088835">)</span>&nbsp;<span class="op" id="2088837">{</span>&nbsp;<span class="comment" id="2088839">//&nbsp;out&nbsp;of&nbsp;operands</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2088861">s</span><span class="op" id="2088862">.</span><span class="ident" id="2088863">errorString</span><span class="op" id="2088874">(</span><span class="string" id="2088875">&#34;too&nbsp;few&nbsp;operands&nbsp;for&nbsp;format&nbsp;%&#34;</span>&nbsp;<span class="op" id="2088907">+</span>&nbsp;<span class="ident" id="2088909">format</span><span class="op" id="2088915">[</span><span class="ident" id="2088916">i</span><span class="op" id="2088917">-</span><span class="ident" id="2088918">w</span><span class="op" id="2088919">:</span><span class="op" id="2088920">]</span><span class="op" id="2088921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2088926">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2088934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2088938">arg</span>&nbsp;<span class="op" id="2088942">:=</span>&nbsp;<span class="ident" id="2088945">a</span><span class="op" id="2088946">[</span><span class="ident" id="2088947">numProcessed</span><span class="op" id="2088959">]</span><br>
<span class="lineno">1160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2088964">s</span><span class="op" id="2088965">.</span><span class="ident" id="2088966">scanOne</span><span class="op" id="2088973">(</span><span class="ident" id="2088974">c</span><span class="op" id="2088975">,</span>&nbsp;<span class="ident" id="2088977">arg</span><span class="op" id="2088980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2088984">numProcessed</span><span class="op" id="2088996">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2089001">s</span><span class="op" id="2089002">.</span><span class="ident" id="2089003">argLimit</span>&nbsp;<span class="op" id="2089012">=</span>&nbsp;<span class="ident" id="2089014">s</span><span class="op" id="2089015">.</span><span class="ident" id="2089016">limit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2089023">}</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2089026">if</span>&nbsp;<span class="ident" id="2089029">numProcessed</span>&nbsp;<span class="op" id="2089042">&lt;</span>&nbsp;<span class="builtinfunc" id="2089044">len</span><span class="op" id="2089047">(</span><span class="ident" id="2089048">a</span><span class="op" id="2089049">)</span>&nbsp;<span class="op" id="2089051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2089055">s</span><span class="op" id="2089056">.</span><span class="ident" id="2089057">errorString</span><span class="op" id="2089068">(</span><span class="string" id="2089069">&#34;too&nbsp;many&nbsp;operands&#34;</span><span class="op" id="2089088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2089091">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2089094">return</span><br>
<span class="lineno"></span><span class="op" id="2089101">}</span>
</div>
</body>
</html>
