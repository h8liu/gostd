<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="128015">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="128071">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="128125">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="128176">package</span>&nbsp;<span class="ident" id="128184">cipher_test</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="128197">import</span>&nbsp;<span class="op" id="128204">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="128207">&#34;crypto/aes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="128221">&#34;crypto/cipher&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="128238">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="128248">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="128251">func</span>&nbsp;<span class="ident" id="128256">TestCryptBlocks</span><span class="op" id="128271">(</span><span class="ident" id="128272">t</span>&nbsp;<span class="op" id="128274">*</span><span class="ident" id="128275"><a href="/crypto/cipher/cipher_test.go.html#128238">testing</a></span><span class="op" id="128282">.</span><span class="ident" id="128283">T</span><span class="op" id="128284">)</span>&nbsp;<span class="op" id="128286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="128289">buf</span>&nbsp;<span class="op" id="128293">:=</span>&nbsp;<span class="builtinfunc" id="128296">make</span><span class="op" id="128300">(</span><span class="op" id="128301">[</span><span class="op" id="128302">]</span><span class="builtintype" id="128303">byte</span><span class="op" id="128307">,</span>&nbsp;<span class="num" id="128309">16</span><span class="op" id="128311">)</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="128314">block</span><span class="op" id="128319">,</span>&nbsp;<span class="ident" id="128321">_</span>&nbsp;<span class="op" id="128323">:=</span>&nbsp;<span class="ident" id="128326"><a href="/crypto/cipher/cipher_test.go.html#128207">aes</a></span><span class="op" id="128329">.</span><span class="ident" id="128330">NewCipher</span><span class="op" id="128339">(</span><span class="ident" id="128340"><a href="/crypto/cipher/cipher_test.go.html#128289">buf</a></span><span class="op" id="128343">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="128347">mode</span>&nbsp;<span class="op" id="128352">:=</span>&nbsp;<span class="ident" id="128355"><a href="/crypto/cipher/cipher_test.go.html#128221">cipher</a></span><span class="op" id="128361">.</span><span class="ident" id="128362">NewCBCDecrypter</span><span class="op" id="128377">(</span><span class="ident" id="128378"><a href="/crypto/cipher/cipher_test.go.html#128314">block</a></span><span class="op" id="128383">,</span>&nbsp;<span class="ident" id="128385"><a href="/crypto/cipher/cipher_test.go.html#128289">buf</a></span><span class="op" id="128388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="128391"><a href="/crypto/cipher/cipher_test.go.html#128838">mustPanic</a></span><span class="op" id="128400">(</span><span class="ident" id="128401"><a href="/crypto/cipher/cipher_test.go.html#128272">t</a></span><span class="op" id="128402">,</span>&nbsp;<span class="string" id="128404">&#34;crypto/cipher:&nbsp;input&nbsp;not&nbsp;full&nbsp;blocks&#34;</span><span class="op" id="128442">,</span>&nbsp;<span class="keyword" id="128444">func</span><span class="op" id="128448">(</span><span class="op" id="128449">)</span>&nbsp;<span class="op" id="128451">{</span>&nbsp;<span class="ident" id="128453"><a href="/crypto/cipher/cipher_test.go.html#128347">mode</a></span><span class="op" id="128457">.</span><span class="ident" id="128458">CryptBlocks</span><span class="op" id="128469">(</span><span class="ident" id="128470"><a href="/crypto/cipher/cipher_test.go.html#128289">buf</a></span><span class="op" id="128473">,</span>&nbsp;<span class="ident" id="128475"><a href="/crypto/cipher/cipher_test.go.html#128289">buf</a></span><span class="op" id="128478">[</span><span class="op" id="128479">:</span><span class="num" id="128480">3</span><span class="op" id="128481">]</span><span class="op" id="128482">)</span>&nbsp;<span class="op" id="128484">}</span><span class="op" id="128485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="128488"><a href="/crypto/cipher/cipher_test.go.html#128838">mustPanic</a></span><span class="op" id="128497">(</span><span class="ident" id="128498"><a href="/crypto/cipher/cipher_test.go.html#128272">t</a></span><span class="op" id="128499">,</span>&nbsp;<span class="string" id="128501">&#34;crypto/cipher:&nbsp;output&nbsp;smaller&nbsp;than&nbsp;input&#34;</span><span class="op" id="128543">,</span>&nbsp;<span class="keyword" id="128545">func</span><span class="op" id="128549">(</span><span class="op" id="128550">)</span>&nbsp;<span class="op" id="128552">{</span>&nbsp;<span class="ident" id="128554"><a href="/crypto/cipher/cipher_test.go.html#128347">mode</a></span><span class="op" id="128558">.</span><span class="ident" id="128559">CryptBlocks</span><span class="op" id="128570">(</span><span class="ident" id="128571"><a href="/crypto/cipher/cipher_test.go.html#128289">buf</a></span><span class="op" id="128574">[</span><span class="op" id="128575">:</span><span class="num" id="128576">3</span><span class="op" id="128577">]</span><span class="op" id="128578">,</span>&nbsp;<span class="ident" id="128580"><a href="/crypto/cipher/cipher_test.go.html#128289">buf</a></span><span class="op" id="128583">)</span>&nbsp;<span class="op" id="128585">}</span><span class="op" id="128586">)</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="128590"><a href="/crypto/cipher/cipher_test.go.html#128347">mode</a></span>&nbsp;<span class="op" id="128595">=</span>&nbsp;<span class="ident" id="128597"><a href="/crypto/cipher/cipher_test.go.html#128221">cipher</a></span><span class="op" id="128603">.</span><span class="ident" id="128604">NewCBCEncrypter</span><span class="op" id="128619">(</span><span class="ident" id="128620"><a href="/crypto/cipher/cipher_test.go.html#128314">block</a></span><span class="op" id="128625">,</span>&nbsp;<span class="ident" id="128627"><a href="/crypto/cipher/cipher_test.go.html#128289">buf</a></span><span class="op" id="128630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="128633"><a href="/crypto/cipher/cipher_test.go.html#128838">mustPanic</a></span><span class="op" id="128642">(</span><span class="ident" id="128643"><a href="/crypto/cipher/cipher_test.go.html#128272">t</a></span><span class="op" id="128644">,</span>&nbsp;<span class="string" id="128646">&#34;crypto/cipher:&nbsp;input&nbsp;not&nbsp;full&nbsp;blocks&#34;</span><span class="op" id="128684">,</span>&nbsp;<span class="keyword" id="128686">func</span><span class="op" id="128690">(</span><span class="op" id="128691">)</span>&nbsp;<span class="op" id="128693">{</span>&nbsp;<span class="ident" id="128695"><a href="/crypto/cipher/cipher_test.go.html#128347">mode</a></span><span class="op" id="128699">.</span><span class="ident" id="128700">CryptBlocks</span><span class="op" id="128711">(</span><span class="ident" id="128712"><a href="/crypto/cipher/cipher_test.go.html#128289">buf</a></span><span class="op" id="128715">,</span>&nbsp;<span class="ident" id="128717"><a href="/crypto/cipher/cipher_test.go.html#128289">buf</a></span><span class="op" id="128720">[</span><span class="op" id="128721">:</span><span class="num" id="128722">3</span><span class="op" id="128723">]</span><span class="op" id="128724">)</span>&nbsp;<span class="op" id="128726">}</span><span class="op" id="128727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="128730"><a href="/crypto/cipher/cipher_test.go.html#128838">mustPanic</a></span><span class="op" id="128739">(</span><span class="ident" id="128740"><a href="/crypto/cipher/cipher_test.go.html#128272">t</a></span><span class="op" id="128741">,</span>&nbsp;<span class="string" id="128743">&#34;crypto/cipher:&nbsp;output&nbsp;smaller&nbsp;than&nbsp;input&#34;</span><span class="op" id="128785">,</span>&nbsp;<span class="keyword" id="128787">func</span><span class="op" id="128791">(</span><span class="op" id="128792">)</span>&nbsp;<span class="op" id="128794">{</span>&nbsp;<span class="ident" id="128796"><a href="/crypto/cipher/cipher_test.go.html#128347">mode</a></span><span class="op" id="128800">.</span><span class="ident" id="128801">CryptBlocks</span><span class="op" id="128812">(</span><span class="ident" id="128813"><a href="/crypto/cipher/cipher_test.go.html#128289">buf</a></span><span class="op" id="128816">[</span><span class="op" id="128817">:</span><span class="num" id="128818">3</span><span class="op" id="128819">]</span><span class="op" id="128820">,</span>&nbsp;<span class="ident" id="128822"><a href="/crypto/cipher/cipher_test.go.html#128289">buf</a></span><span class="op" id="128825">)</span>&nbsp;<span class="op" id="128827">}</span><span class="op" id="128828">)</span><br>
<span class="lineno"></span><span class="op" id="128830">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="128833">func</span>&nbsp;<span class="ident" id="128838">mustPanic</span><span class="op" id="128847">(</span><span class="ident" id="128848">t</span>&nbsp;<span class="op" id="128850">*</span><span class="ident" id="128851"><a href="/crypto/cipher/cipher_test.go.html#128238">testing</a></span><span class="op" id="128858">.</span><span class="ident" id="128859">T</span><span class="op" id="128860">,</span>&nbsp;<span class="ident" id="128862">msg</span>&nbsp;<span class="builtintype" id="128866">string</span><span class="op" id="128872">,</span>&nbsp;<span class="ident" id="128874">f</span>&nbsp;<span class="keyword" id="128876">func</span><span class="op" id="128880">(</span><span class="op" id="128881">)</span><span class="op" id="128882">)</span>&nbsp;<span class="op" id="128884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="128887">defer</span>&nbsp;<span class="keyword" id="128893">func</span><span class="op" id="128897">(</span><span class="op" id="128898">)</span>&nbsp;<span class="op" id="128900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="128904">err</span>&nbsp;<span class="op" id="128908">:=</span>&nbsp;<span class="builtinfunc" id="128911">recover</span><span class="op" id="128918">(</span><span class="op" id="128919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="128923">if</span>&nbsp;<span class="ident" id="128926"><a href="/crypto/cipher/cipher_test.go.html#128904">err</a></span>&nbsp;<span class="op" id="128930">==</span>&nbsp;<span class="ident" id="128933">nil</span>&nbsp;<span class="op" id="128937">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="128942"><a href="/crypto/cipher/cipher_test.go.html#128848">t</a></span><span class="op" id="128943">.</span><span class="ident" id="128944">Errorf</span><span class="op" id="128950">(</span><span class="string" id="128951">&#34;function&nbsp;did&nbsp;not&nbsp;panic,&nbsp;wanted&nbsp;%q&#34;</span><span class="op" id="128986">,</span>&nbsp;<span class="ident" id="128988"><a href="/crypto/cipher/cipher_test.go.html#128862">msg</a></span><span class="op" id="128991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="128995">}</span>&nbsp;<span class="keyword" id="128997">else</span>&nbsp;<span class="keyword" id="129002">if</span>&nbsp;<span class="ident" id="129005"><a href="/crypto/cipher/cipher_test.go.html#128904">err</a></span>&nbsp;<span class="op" id="129009">!=</span>&nbsp;<span class="ident" id="129012"><a href="/crypto/cipher/cipher_test.go.html#128862">msg</a></span>&nbsp;<span class="op" id="129016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="129021"><a href="/crypto/cipher/cipher_test.go.html#128848">t</a></span><span class="op" id="129022">.</span><span class="ident" id="129023">Errorf</span><span class="op" id="129029">(</span><span class="string" id="129030">&#34;got&nbsp;panic&nbsp;%v,&nbsp;wanted&nbsp;%q&#34;</span><span class="op" id="129055">,</span>&nbsp;<span class="ident" id="129057"><a href="/crypto/cipher/cipher_test.go.html#128904">err</a></span><span class="op" id="129060">,</span>&nbsp;<span class="ident" id="129062"><a href="/crypto/cipher/cipher_test.go.html#128862">msg</a></span><span class="op" id="129065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="129069">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="129072">}</span><span class="op" id="129073">(</span><span class="op" id="129074">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="129077"><a href="/crypto/cipher/cipher_test.go.html#128874">f</a></span><span class="op" id="129078">(</span><span class="op" id="129079">)</span><br>
<span class="lineno"></span><span class="op" id="129081">}</span>
</div>
</body>
</html>
