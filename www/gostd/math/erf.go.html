<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1826269">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1826324">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1826378">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1826429">package</span>&nbsp;<span class="ident" id="1826437">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1826443">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspFloating-point&nbsp;error&nbsp;function&nbsp;and&nbsp;complementary&nbsp;error&nbsp;function.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="1826515">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code&nbsp;and&nbsp;the&nbsp;long&nbsp;comment&nbsp;below&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="1826569">//&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/s_erf.c&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1826621">//&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="1826676">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="1826706">//</span><br>
<span class="lineno"></span><span class="comment" id="1826709">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="1826765">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1826834">//</span><br>
<span class="lineno"></span><span class="comment" id="1826837">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno">20</span><span class="comment" id="1826896">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="1826952">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="1827009">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="1827026">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="1827082">//</span><br>
<span class="lineno">25</span><span class="comment" id="1827085">//</span><br>
<span class="lineno"></span><span class="comment" id="1827088">//&nbsp;double&nbsp;erf(double&nbsp;x)</span><br>
<span class="lineno"></span><span class="comment" id="1827112">//&nbsp;double&nbsp;erfc(double&nbsp;x)</span><br>
<span class="lineno"></span><span class="comment" id="1827137">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="1827168">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|\</span><br>
<span class="lineno">30</span><span class="comment" id="1827200">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;&nbsp;---------&nbsp;&nbsp;|&nbsp;exp(-t*t)dt</span><br>
<span class="lineno"></span><span class="comment" id="1827243">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqrt(pi)&nbsp;\|</span><br>
<span class="lineno"></span><span class="comment" id="1827274">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="1827305">//</span><br>
<span class="lineno"></span><span class="comment" id="1827308">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;&nbsp;1-erf(x)</span><br>
<span class="lineno">35</span><span class="comment" id="1827335">//&nbsp;&nbsp;Note&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="1827349">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(-x)&nbsp;=&nbsp;-erf(x)</span><br>
<span class="lineno"></span><span class="comment" id="1827383">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(-x)&nbsp;=&nbsp;2&nbsp;-&nbsp;erfc(x)</span><br>
<span class="lineno"></span><span class="comment" id="1827422">//</span><br>
<span class="lineno"></span><span class="comment" id="1827425">//&nbsp;Method:</span><br>
<span class="lineno">40</span><span class="comment" id="1827436">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;For&nbsp;|x|&nbsp;in&nbsp;[0,&nbsp;0.84375]</span><br>
<span class="lineno"></span><span class="comment" id="1827471">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;x&nbsp;+&nbsp;x*R(x**2)</span><br>
<span class="lineno"></span><span class="comment" id="1827507">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;1&nbsp;-&nbsp;erf(x)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;in&nbsp;[-.84375,0.25]</span><br>
<span class="lineno"></span><span class="comment" id="1827573">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0.5&nbsp;+&nbsp;((0.5-x)-x*R)&nbsp;&nbsp;if&nbsp;x&nbsp;in&nbsp;[0.25,0.84375]</span><br>
<span class="lineno"></span><span class="comment" id="1827639">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;R&nbsp;=&nbsp;P/Q&nbsp;where&nbsp;P&nbsp;is&nbsp;an&nbsp;odd&nbsp;poly&nbsp;of&nbsp;degree&nbsp;8&nbsp;and</span><br>
<span class="lineno">45</span><span class="comment" id="1827703">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Q&nbsp;is&nbsp;an&nbsp;odd&nbsp;poly&nbsp;of&nbsp;degree&nbsp;10.</span><br>
<span class="lineno"></span><span class="comment" id="1827745">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-57.90</span><br>
<span class="lineno"></span><span class="comment" id="1827801">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;R&nbsp;-&nbsp;(erf(x)-x)/x&nbsp;|&nbsp;&lt;=&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="1827851">//</span><br>
<span class="lineno"></span><span class="comment" id="1827854">//</span><br>
<span class="lineno">50</span><span class="comment" id="1827857">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remark.&nbsp;The&nbsp;formula&nbsp;is&nbsp;derived&nbsp;by&nbsp;noting</span><br>
<span class="lineno"></span><span class="comment" id="1827909">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;=&nbsp;(2/sqrt(pi))*(x&nbsp;-&nbsp;x**3/3&nbsp;+&nbsp;x**5/10&nbsp;-&nbsp;x**7/42&nbsp;+&nbsp;....)</span><br>
<span class="lineno"></span><span class="comment" id="1827983">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="1828003">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2/sqrt(pi)&nbsp;=&nbsp;1.128379167095512573896158903121545171688</span><br>
<span class="lineno"></span><span class="comment" id="1828070">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;close&nbsp;to&nbsp;one.&nbsp;The&nbsp;interval&nbsp;is&nbsp;chosen&nbsp;because&nbsp;the&nbsp;fix</span><br>
<span class="lineno">55</span><span class="comment" id="1828137">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;point&nbsp;of&nbsp;erf(x)&nbsp;is&nbsp;near&nbsp;0.6174&nbsp;(i.e.,&nbsp;erf(x)=x&nbsp;when&nbsp;x&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="1828205">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;near&nbsp;0.6174),&nbsp;and&nbsp;by&nbsp;some&nbsp;experiment,&nbsp;0.84375&nbsp;is&nbsp;chosen&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="1828275">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;guarantee&nbsp;the&nbsp;error&nbsp;is&nbsp;less&nbsp;than&nbsp;one&nbsp;ulp&nbsp;for&nbsp;erf.</span><br>
<span class="lineno"></span><span class="comment" id="1828336">//</span><br>
<span class="lineno"></span><span class="comment" id="1828339">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.&nbsp;For&nbsp;|x|&nbsp;in&nbsp;[0.84375,1.25],&nbsp;let&nbsp;s&nbsp;=&nbsp;|x|&nbsp;-&nbsp;1,&nbsp;and</span><br>
<span class="lineno">60</span><span class="comment" id="1828398">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;=&nbsp;0.84506291151&nbsp;rounded&nbsp;to&nbsp;single&nbsp;(24&nbsp;bits)</span><br>
<span class="lineno"></span><span class="comment" id="1828455">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)&nbsp;*&nbsp;(c&nbsp;&nbsp;+&nbsp;P1(s)/Q1(s))</span><br>
<span class="lineno"></span><span class="comment" id="1828510">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;(1-c)&nbsp;&nbsp;-&nbsp;P1(s)/Q1(s)&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="1828566">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1+(c+P1(s)/Q1(s))&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="1828622">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|P1/Q1&nbsp;-&nbsp;(erf(|x|)-c)|&nbsp;&lt;=&nbsp;2**-59.06</span><br>
<span class="lineno">65</span><span class="comment" id="1828674">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remark:&nbsp;here&nbsp;we&nbsp;use&nbsp;the&nbsp;taylor&nbsp;series&nbsp;expansion&nbsp;at&nbsp;x=1.</span><br>
<span class="lineno"></span><span class="comment" id="1828741">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(1+s)&nbsp;=&nbsp;erf(1)&nbsp;+&nbsp;s*Poly(s)</span><br>
<span class="lineno"></span><span class="comment" id="1828787">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0.845..&nbsp;+&nbsp;P1(s)/Q1(s)</span><br>
<span class="lineno"></span><span class="comment" id="1828836">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;That&nbsp;is,&nbsp;we&nbsp;use&nbsp;rational&nbsp;approximation&nbsp;to&nbsp;approximate</span><br>
<span class="lineno"></span><span class="comment" id="1828901">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(1+s)&nbsp;-&nbsp;(c&nbsp;=&nbsp;(single)0.84506291151)</span><br>
<span class="lineno">70</span><span class="comment" id="1828964">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note&nbsp;that&nbsp;|P1/Q1|&lt;&nbsp;0.078&nbsp;for&nbsp;x&nbsp;in&nbsp;[0.84375,1.25]</span><br>
<span class="lineno"></span><span class="comment" id="1829024">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="1829041">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P1(s)&nbsp;=&nbsp;degree&nbsp;6&nbsp;poly&nbsp;in&nbsp;s</span><br>
<span class="lineno"></span><span class="comment" id="1829084">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Q1(s)&nbsp;=&nbsp;degree&nbsp;6&nbsp;poly&nbsp;in&nbsp;s</span><br>
<span class="lineno"></span><span class="comment" id="1829127">//</span><br>
<span class="lineno">75</span><span class="comment" id="1829130">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.&nbsp;For&nbsp;x&nbsp;in&nbsp;[1.25,1/0.35(~2.857143)],</span><br>
<span class="lineno"></span><span class="comment" id="1829176">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;(1/x)*exp(-x*x-0.5625+R1/S1)</span><br>
<span class="lineno"></span><span class="comment" id="1829231">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;1&nbsp;-&nbsp;erfc(x)</span><br>
<span class="lineno"></span><span class="comment" id="1829269">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="1829286">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R1(z)&nbsp;=&nbsp;degree&nbsp;7&nbsp;poly&nbsp;in&nbsp;z,&nbsp;(z=1/x**2)</span><br>
<span class="lineno">80</span><span class="comment" id="1829341">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S1(z)&nbsp;=&nbsp;degree&nbsp;8&nbsp;poly&nbsp;in&nbsp;z</span><br>
<span class="lineno"></span><span class="comment" id="1829384">//</span><br>
<span class="lineno"></span><span class="comment" id="1829387">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4.&nbsp;For&nbsp;x&nbsp;in&nbsp;[1/0.35,28]</span><br>
<span class="lineno"></span><span class="comment" id="1829419">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;(1/x)*exp(-x*x-0.5625+R2/S2)&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="1829483">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.0&nbsp;-&nbsp;(1/x)*exp(-x*x-0.5625+R2/S2)&nbsp;if&nbsp;-6&lt;x&lt;0</span><br>
<span class="lineno">85</span><span class="comment" id="1829554">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.0&nbsp;-&nbsp;tiny&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(if&nbsp;x&nbsp;&lt;=&nbsp;-6)</span><br>
<span class="lineno"></span><span class="comment" id="1829615">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)*(1.0&nbsp;-&nbsp;erfc(x))&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;6,&nbsp;else</span><br>
<span class="lineno"></span><span class="comment" id="1829680">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)*(1.0&nbsp;-&nbsp;tiny)</span><br>
<span class="lineno"></span><span class="comment" id="1829727">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="1829744">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R2(z)&nbsp;=&nbsp;degree&nbsp;6&nbsp;poly&nbsp;in&nbsp;z,&nbsp;(z=1/x**2)</span><br>
<span class="lineno">90</span><span class="comment" id="1829799">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S2(z)&nbsp;=&nbsp;degree&nbsp;7&nbsp;poly&nbsp;in&nbsp;z</span><br>
<span class="lineno"></span><span class="comment" id="1829842">//</span><br>
<span class="lineno"></span><span class="comment" id="1829845">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note1:</span><br>
<span class="lineno"></span><span class="comment" id="1829860">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;To&nbsp;compute&nbsp;exp(-x*x-0.5625+R/S),&nbsp;let&nbsp;s&nbsp;be&nbsp;a&nbsp;single</span><br>
<span class="lineno"></span><span class="comment" id="1829922">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;precision&nbsp;number&nbsp;and&nbsp;s&nbsp;:=&nbsp;x;&nbsp;then</span><br>
<span class="lineno">95</span><span class="comment" id="1829967">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-x*x&nbsp;=&nbsp;-s*s&nbsp;+&nbsp;(s-x)*(s+x)</span><br>
<span class="lineno"></span><span class="comment" id="1830009">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-x*x-0.5626+R/S)&nbsp;=</span><br>
<span class="lineno"></span><span class="comment" id="1830048">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-s*s-0.5625)*exp((s-x)*(s+x)+R/S);</span><br>
<span class="lineno"></span><span class="comment" id="1830111">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note2:</span><br>
<span class="lineno"></span><span class="comment" id="1830126">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Here&nbsp;4&nbsp;and&nbsp;5&nbsp;make&nbsp;use&nbsp;of&nbsp;the&nbsp;asymptotic&nbsp;series</span><br>
<span class="lineno">100</span><span class="comment" id="1830184">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-x*x)</span><br>
<span class="lineno"></span><span class="comment" id="1830220">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;~&nbsp;----------&nbsp;*&nbsp;(&nbsp;1&nbsp;+&nbsp;Poly(1/x**2)&nbsp;)</span><br>
<span class="lineno"></span><span class="comment" id="1830280">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x*sqrt(pi)</span><br>
<span class="lineno"></span><span class="comment" id="1830317">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;use&nbsp;rational&nbsp;approximation&nbsp;to&nbsp;approximate</span><br>
<span class="lineno"></span><span class="comment" id="1830373">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g(s)=f(1/x**2)&nbsp;=&nbsp;log(erfc(x)*x)&nbsp;-&nbsp;x*x&nbsp;+&nbsp;0.5625</span><br>
<span class="lineno">105</span><span class="comment" id="1830436">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Here&nbsp;is&nbsp;the&nbsp;error&nbsp;bound&nbsp;for&nbsp;R1/S1&nbsp;and&nbsp;R2/S2</span><br>
<span class="lineno"></span><span class="comment" id="1830491">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|R1/S1&nbsp;-&nbsp;f(x)|&nbsp;&nbsp;&lt;&nbsp;2**(-62.57)</span><br>
<span class="lineno"></span><span class="comment" id="1830537">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|R2/S2&nbsp;-&nbsp;f(x)|&nbsp;&nbsp;&lt;&nbsp;2**(-61.52)</span><br>
<span class="lineno"></span><span class="comment" id="1830583">//</span><br>
<span class="lineno"></span><span class="comment" id="1830586">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.&nbsp;For&nbsp;inf&nbsp;&gt;&nbsp;x&nbsp;&gt;=&nbsp;28</span><br>
<span class="lineno">110</span><span class="comment" id="1830615">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)&nbsp;*(1&nbsp;-&nbsp;tiny)&nbsp;&nbsp;(raise&nbsp;inexact)</span><br>
<span class="lineno"></span><span class="comment" id="1830678">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;tiny*tiny&nbsp;(raise&nbsp;underflow)&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="1830741">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2&nbsp;-&nbsp;tiny&nbsp;if&nbsp;x&lt;0</span><br>
<span class="lineno"></span><span class="comment" id="1830783">//</span><br>
<span class="lineno"></span><span class="comment" id="1830786">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.&nbsp;Special&nbsp;case:</span><br>
<span class="lineno">115</span><span class="comment" id="1830811">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(0)&nbsp;&nbsp;=&nbsp;0,&nbsp;erf(inf)&nbsp;&nbsp;=&nbsp;1,&nbsp;erf(-inf)&nbsp;=&nbsp;-1,</span><br>
<span class="lineno"></span><span class="comment" id="1830871">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(0)&nbsp;=&nbsp;1,&nbsp;erfc(inf)&nbsp;=&nbsp;0,&nbsp;erfc(-inf)&nbsp;=&nbsp;2,</span><br>
<span class="lineno"></span><span class="comment" id="1830931">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc/erf(NaN)&nbsp;is&nbsp;NaN</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1830969">const</span>&nbsp;<span class="op" id="1830975">(</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1830978">erx</span>&nbsp;<span class="op" id="1830982">=</span>&nbsp;<span class="num" id="1830984">8.45062911510467529297e-01</span>&nbsp;<span class="comment" id="1831011">//&nbsp;0x3FEB0AC160000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1831034">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erf&nbsp;in&nbsp;[0,&nbsp;0.84375]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1831093">efx</span>&nbsp;&nbsp;<span class="op" id="1831098">=</span>&nbsp;<span class="num" id="1831100">1.28379167095512586316e-01</span>&nbsp;&nbsp;<span class="comment" id="1831128">//&nbsp;0x3FC06EBA8214DB69</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1831151">efx8</span>&nbsp;<span class="op" id="1831156">=</span>&nbsp;<span class="num" id="1831158">1.02703333676410069053e+00</span>&nbsp;&nbsp;<span class="comment" id="1831186">//&nbsp;0x3FF06EBA8214DB69</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1831209">pp0</span>&nbsp;&nbsp;<span class="op" id="1831214">=</span>&nbsp;<span class="num" id="1831216">1.28379167095512558561e-01</span>&nbsp;&nbsp;<span class="comment" id="1831244">//&nbsp;0x3FC06EBA8214DB68</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1831267">pp1</span>&nbsp;&nbsp;<span class="op" id="1831272">=</span>&nbsp;<span class="op" id="1831274">-</span><span class="num" id="1831275">3.25042107247001499370e-01</span>&nbsp;<span class="comment" id="1831302">//&nbsp;0xBFD4CD7D691CB913</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1831325">pp2</span>&nbsp;&nbsp;<span class="op" id="1831330">=</span>&nbsp;<span class="op" id="1831332">-</span><span class="num" id="1831333">2.84817495755985104766e-02</span>&nbsp;<span class="comment" id="1831360">//&nbsp;0xBF9D2A51DBD7194F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1831383">pp3</span>&nbsp;&nbsp;<span class="op" id="1831388">=</span>&nbsp;<span class="op" id="1831390">-</span><span class="num" id="1831391">5.77027029648944159157e-03</span>&nbsp;<span class="comment" id="1831418">//&nbsp;0xBF77A291236668E4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1831441">pp4</span>&nbsp;&nbsp;<span class="op" id="1831446">=</span>&nbsp;<span class="op" id="1831448">-</span><span class="num" id="1831449">2.37630166566501626084e-05</span>&nbsp;<span class="comment" id="1831476">//&nbsp;0xBEF8EAD6120016AC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1831499">qq1</span>&nbsp;&nbsp;<span class="op" id="1831504">=</span>&nbsp;<span class="num" id="1831506">3.97917223959155352819e-01</span>&nbsp;&nbsp;<span class="comment" id="1831534">//&nbsp;0x3FD97779CDDADC09</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1831557">qq2</span>&nbsp;&nbsp;<span class="op" id="1831562">=</span>&nbsp;<span class="num" id="1831564">6.50222499887672944485e-02</span>&nbsp;&nbsp;<span class="comment" id="1831592">//&nbsp;0x3FB0A54C5536CEBA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1831615">qq3</span>&nbsp;&nbsp;<span class="op" id="1831620">=</span>&nbsp;<span class="num" id="1831622">5.08130628187576562776e-03</span>&nbsp;&nbsp;<span class="comment" id="1831650">//&nbsp;0x3F74D022C4D36B0F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1831673">qq4</span>&nbsp;&nbsp;<span class="op" id="1831678">=</span>&nbsp;<span class="num" id="1831680">1.32494738004321644526e-04</span>&nbsp;&nbsp;<span class="comment" id="1831708">//&nbsp;0x3F215DC9221C1A10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1831731">qq5</span>&nbsp;&nbsp;<span class="op" id="1831736">=</span>&nbsp;<span class="op" id="1831738">-</span><span class="num" id="1831739">3.96022827877536812320e-06</span>&nbsp;<span class="comment" id="1831766">//&nbsp;0xBED09C4342A26120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1831789">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erf&nbsp;&nbsp;in&nbsp;[0.84375,&nbsp;1.25]</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1831852">pa0</span>&nbsp;<span class="op" id="1831856">=</span>&nbsp;<span class="op" id="1831858">-</span><span class="num" id="1831859">2.36211856075265944077e-03</span>&nbsp;<span class="comment" id="1831886">//&nbsp;0xBF6359B8BEF77538</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1831909">pa1</span>&nbsp;<span class="op" id="1831913">=</span>&nbsp;<span class="num" id="1831915">4.14856118683748331666e-01</span>&nbsp;&nbsp;<span class="comment" id="1831943">//&nbsp;0x3FDA8D00AD92B34D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1831966">pa2</span>&nbsp;<span class="op" id="1831970">=</span>&nbsp;<span class="op" id="1831972">-</span><span class="num" id="1831973">3.72207876035701323847e-01</span>&nbsp;<span class="comment" id="1832000">//&nbsp;0xBFD7D240FBB8C3F1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1832023">pa3</span>&nbsp;<span class="op" id="1832027">=</span>&nbsp;<span class="num" id="1832029">3.18346619901161753674e-01</span>&nbsp;&nbsp;<span class="comment" id="1832057">//&nbsp;0x3FD45FCA805120E4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1832080">pa4</span>&nbsp;<span class="op" id="1832084">=</span>&nbsp;<span class="op" id="1832086">-</span><span class="num" id="1832087">1.10894694282396677476e-01</span>&nbsp;<span class="comment" id="1832114">//&nbsp;0xBFBC63983D3E28EC</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1832137">pa5</span>&nbsp;<span class="op" id="1832141">=</span>&nbsp;<span class="num" id="1832143">3.54783043256182359371e-02</span>&nbsp;&nbsp;<span class="comment" id="1832171">//&nbsp;0x3FA22A36599795EB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1832194">pa6</span>&nbsp;<span class="op" id="1832198">=</span>&nbsp;<span class="op" id="1832200">-</span><span class="num" id="1832201">2.16637559486879084300e-03</span>&nbsp;<span class="comment" id="1832228">//&nbsp;0xBF61BF380A96073F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1832251">qa1</span>&nbsp;<span class="op" id="1832255">=</span>&nbsp;<span class="num" id="1832257">1.06420880400844228286e-01</span>&nbsp;&nbsp;<span class="comment" id="1832285">//&nbsp;0x3FBB3E6618EEE323</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1832308">qa2</span>&nbsp;<span class="op" id="1832312">=</span>&nbsp;<span class="num" id="1832314">5.40397917702171048937e-01</span>&nbsp;&nbsp;<span class="comment" id="1832342">//&nbsp;0x3FE14AF092EB6F33</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1832365">qa3</span>&nbsp;<span class="op" id="1832369">=</span>&nbsp;<span class="num" id="1832371">7.18286544141962662868e-02</span>&nbsp;&nbsp;<span class="comment" id="1832399">//&nbsp;0x3FB2635CD99FE9A7</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1832422">qa4</span>&nbsp;<span class="op" id="1832426">=</span>&nbsp;<span class="num" id="1832428">1.26171219808761642112e-01</span>&nbsp;&nbsp;<span class="comment" id="1832456">//&nbsp;0x3FC02660E763351F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1832479">qa5</span>&nbsp;<span class="op" id="1832483">=</span>&nbsp;<span class="num" id="1832485">1.36370839120290507362e-02</span>&nbsp;&nbsp;<span class="comment" id="1832513">//&nbsp;0x3F8BEDC26B51DD1C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1832536">qa6</span>&nbsp;<span class="op" id="1832540">=</span>&nbsp;<span class="num" id="1832542">1.19844998467991074170e-02</span>&nbsp;&nbsp;<span class="comment" id="1832570">//&nbsp;0x3F888B545735151D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1832593">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erfc&nbsp;in&nbsp;[1.25,&nbsp;1/0.35]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1832655">ra0</span>&nbsp;<span class="op" id="1832659">=</span>&nbsp;<span class="op" id="1832661">-</span><span class="num" id="1832662">9.86494403484714822705e-03</span>&nbsp;<span class="comment" id="1832689">//&nbsp;0xBF843412600D6435</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1832712">ra1</span>&nbsp;<span class="op" id="1832716">=</span>&nbsp;<span class="op" id="1832718">-</span><span class="num" id="1832719">6.93858572707181764372e-01</span>&nbsp;<span class="comment" id="1832746">//&nbsp;0xBFE63416E4BA7360</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1832769">ra2</span>&nbsp;<span class="op" id="1832773">=</span>&nbsp;<span class="op" id="1832775">-</span><span class="num" id="1832776">1.05586262253232909814e+01</span>&nbsp;<span class="comment" id="1832803">//&nbsp;0xC0251E0441B0E726</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1832826">ra3</span>&nbsp;<span class="op" id="1832830">=</span>&nbsp;<span class="op" id="1832832">-</span><span class="num" id="1832833">6.23753324503260060396e+01</span>&nbsp;<span class="comment" id="1832860">//&nbsp;0xC04F300AE4CBA38D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1832883">ra4</span>&nbsp;<span class="op" id="1832887">=</span>&nbsp;<span class="op" id="1832889">-</span><span class="num" id="1832890">1.62396669462573470355e+02</span>&nbsp;<span class="comment" id="1832917">//&nbsp;0xC0644CB184282266</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1832940">ra5</span>&nbsp;<span class="op" id="1832944">=</span>&nbsp;<span class="op" id="1832946">-</span><span class="num" id="1832947">1.84605092906711035994e+02</span>&nbsp;<span class="comment" id="1832974">//&nbsp;0xC067135CEBCCABB2</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1832997">ra6</span>&nbsp;<span class="op" id="1833001">=</span>&nbsp;<span class="op" id="1833003">-</span><span class="num" id="1833004">8.12874355063065934246e+01</span>&nbsp;<span class="comment" id="1833031">//&nbsp;0xC054526557E4D2F2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1833054">ra7</span>&nbsp;<span class="op" id="1833058">=</span>&nbsp;<span class="op" id="1833060">-</span><span class="num" id="1833061">9.81432934416914548592e+00</span>&nbsp;<span class="comment" id="1833088">//&nbsp;0xC023A0EFC69AC25C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1833111">sa1</span>&nbsp;<span class="op" id="1833115">=</span>&nbsp;<span class="num" id="1833117">1.96512716674392571292e+01</span>&nbsp;&nbsp;<span class="comment" id="1833145">//&nbsp;0x4033A6B9BD707687</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1833168">sa2</span>&nbsp;<span class="op" id="1833172">=</span>&nbsp;<span class="num" id="1833174">1.37657754143519042600e+02</span>&nbsp;&nbsp;<span class="comment" id="1833202">//&nbsp;0x4061350C526AE721</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1833225">sa3</span>&nbsp;<span class="op" id="1833229">=</span>&nbsp;<span class="num" id="1833231">4.34565877475229228821e+02</span>&nbsp;&nbsp;<span class="comment" id="1833259">//&nbsp;0x407B290DD58A1A71</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1833282">sa4</span>&nbsp;<span class="op" id="1833286">=</span>&nbsp;<span class="num" id="1833288">6.45387271733267880336e+02</span>&nbsp;&nbsp;<span class="comment" id="1833316">//&nbsp;0x40842B1921EC2868</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1833339">sa5</span>&nbsp;<span class="op" id="1833343">=</span>&nbsp;<span class="num" id="1833345">4.29008140027567833386e+02</span>&nbsp;&nbsp;<span class="comment" id="1833373">//&nbsp;0x407AD02157700314</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1833396">sa6</span>&nbsp;<span class="op" id="1833400">=</span>&nbsp;<span class="num" id="1833402">1.08635005541779435134e+02</span>&nbsp;&nbsp;<span class="comment" id="1833430">//&nbsp;0x405B28A3EE48AE2C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1833453">sa7</span>&nbsp;<span class="op" id="1833457">=</span>&nbsp;<span class="num" id="1833459">6.57024977031928170135e+00</span>&nbsp;&nbsp;<span class="comment" id="1833487">//&nbsp;0x401A47EF8E484A93</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1833510">sa8</span>&nbsp;<span class="op" id="1833514">=</span>&nbsp;<span class="op" id="1833516">-</span><span class="num" id="1833517">6.04244152148580987438e-02</span>&nbsp;<span class="comment" id="1833544">//&nbsp;0xBFAEEFF2EE749A62</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1833567">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erfc&nbsp;in&nbsp;[1/.35,&nbsp;28]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1833626">rb0</span>&nbsp;<span class="op" id="1833630">=</span>&nbsp;<span class="op" id="1833632">-</span><span class="num" id="1833633">9.86494292470009928597e-03</span>&nbsp;<span class="comment" id="1833660">//&nbsp;0xBF84341239E86F4A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1833683">rb1</span>&nbsp;<span class="op" id="1833687">=</span>&nbsp;<span class="op" id="1833689">-</span><span class="num" id="1833690">7.99283237680523006574e-01</span>&nbsp;<span class="comment" id="1833717">//&nbsp;0xBFE993BA70C285DE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1833740">rb2</span>&nbsp;<span class="op" id="1833744">=</span>&nbsp;<span class="op" id="1833746">-</span><span class="num" id="1833747">1.77579549177547519889e+01</span>&nbsp;<span class="comment" id="1833774">//&nbsp;0xC031C209555F995A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1833797">rb3</span>&nbsp;<span class="op" id="1833801">=</span>&nbsp;<span class="op" id="1833803">-</span><span class="num" id="1833804">1.60636384855821916062e+02</span>&nbsp;<span class="comment" id="1833831">//&nbsp;0xC064145D43C5ED98</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1833854">rb4</span>&nbsp;<span class="op" id="1833858">=</span>&nbsp;<span class="op" id="1833860">-</span><span class="num" id="1833861">6.37566443368389627722e+02</span>&nbsp;<span class="comment" id="1833888">//&nbsp;0xC083EC881375F228</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1833911">rb5</span>&nbsp;<span class="op" id="1833915">=</span>&nbsp;<span class="op" id="1833917">-</span><span class="num" id="1833918">1.02509513161107724954e+03</span>&nbsp;<span class="comment" id="1833945">//&nbsp;0xC09004616A2E5992</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1833968">rb6</span>&nbsp;<span class="op" id="1833972">=</span>&nbsp;<span class="op" id="1833974">-</span><span class="num" id="1833975">4.83519191608651397019e+02</span>&nbsp;<span class="comment" id="1834002">//&nbsp;0xC07E384E9BDC383F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1834025">sb1</span>&nbsp;<span class="op" id="1834029">=</span>&nbsp;<span class="num" id="1834031">3.03380607434824582924e+01</span>&nbsp;&nbsp;<span class="comment" id="1834059">//&nbsp;0x403E568B261D5190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1834082">sb2</span>&nbsp;<span class="op" id="1834086">=</span>&nbsp;<span class="num" id="1834088">3.25792512996573918826e+02</span>&nbsp;&nbsp;<span class="comment" id="1834116">//&nbsp;0x40745CAE221B9F0A</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1834139">sb3</span>&nbsp;<span class="op" id="1834143">=</span>&nbsp;<span class="num" id="1834145">1.53672958608443695994e+03</span>&nbsp;&nbsp;<span class="comment" id="1834173">//&nbsp;0x409802EB189D5118</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1834196">sb4</span>&nbsp;<span class="op" id="1834200">=</span>&nbsp;<span class="num" id="1834202">3.19985821950859553908e+03</span>&nbsp;&nbsp;<span class="comment" id="1834230">//&nbsp;0x40A8FFB7688C246A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1834253">sb5</span>&nbsp;<span class="op" id="1834257">=</span>&nbsp;<span class="num" id="1834259">2.55305040643316442583e+03</span>&nbsp;&nbsp;<span class="comment" id="1834287">//&nbsp;0x40A3F219CEDF3BE6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1834310">sb6</span>&nbsp;<span class="op" id="1834314">=</span>&nbsp;<span class="num" id="1834316">4.74528541206955367215e+02</span>&nbsp;&nbsp;<span class="comment" id="1834344">//&nbsp;0x407DA874E79FE763</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1834367">sb7</span>&nbsp;<span class="op" id="1834371">=</span>&nbsp;<span class="op" id="1834373">-</span><span class="num" id="1834374">2.24409524465858183362e+01</span>&nbsp;<span class="comment" id="1834401">//&nbsp;0xC03670E242712D62</span><br>
<span class="lineno">180</span><span class="op" id="1834423">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1834426">//&nbsp;Erf&nbsp;returns&nbsp;the&nbsp;error&nbsp;function&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="1834466">//</span><br>
<span class="lineno"></span><span class="comment" id="1834469">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">185</span><span class="comment" id="1834491">//&nbsp;&nbsp;&nbsp;&nbspErf(+Inf)&nbsp;=&nbsp;1</span><br>
<span class="lineno"></span><span class="comment" id="1834508">//&nbsp;&nbsp;&nbsp;&nbspErf(-Inf)&nbsp;=&nbsp;-1</span><br>
<span class="lineno"></span><span class="comment" id="1834526">//&nbsp;&nbsp;&nbsp;&nbspErf(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="1834544">func</span>&nbsp;<span class="ident" id="1834549">Erf</span><span class="op" id="1834552">(</span><span class="ident" id="1834553">x</span>&nbsp;<span class="builtintype" id="1834555">float64</span><span class="op" id="1834562">)</span>&nbsp;<span class="builtintype" id="1834564">float64</span>&nbsp;<span class="op" id="1834572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1834575">const</span>&nbsp;<span class="op" id="1834581">(</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1834585">VeryTiny</span>&nbsp;<span class="op" id="1834594">=</span>&nbsp;<span class="num" id="1834596">2.848094538889218e-306</span>&nbsp;<span class="comment" id="1834619">//&nbsp;0x0080000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1834643">Small</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1834652">=</span>&nbsp;<span class="num" id="1834654">1.0</span>&nbsp;<span class="op" id="1834658">/</span>&nbsp;<span class="op" id="1834660">(</span><span class="num" id="1834661">1</span>&nbsp;<span class="op" id="1834663">&lt;&lt;</span>&nbsp;<span class="num" id="1834666">28</span><span class="op" id="1834668">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1834677">//&nbsp;2**-28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1834688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1834691">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1834709">switch</span>&nbsp;<span class="op" id="1834716">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1834719">case</span>&nbsp;<span class="ident" id="1834724">IsNaN</span><span class="op" id="1834729">(</span><span class="ident" id="1834730">x</span><span class="op" id="1834731">)</span><span class="op" id="1834732">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1834736">return</span>&nbsp;<span class="ident" id="1834743">NaN</span><span class="op" id="1834746">(</span><span class="op" id="1834747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1834750">case</span>&nbsp;<span class="ident" id="1834755">IsInf</span><span class="op" id="1834760">(</span><span class="ident" id="1834761">x</span><span class="op" id="1834762">,</span>&nbsp;<span class="num" id="1834764">1</span><span class="op" id="1834765">)</span><span class="op" id="1834766">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1834770">return</span>&nbsp;<span class="num" id="1834777">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1834780">case</span>&nbsp;<span class="ident" id="1834785">IsInf</span><span class="op" id="1834790">(</span><span class="ident" id="1834791">x</span><span class="op" id="1834792">,</span>&nbsp;<span class="op" id="1834794">-</span><span class="num" id="1834795">1</span><span class="op" id="1834796">)</span><span class="op" id="1834797">:</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1834801">return</span>&nbsp;<span class="op" id="1834808">-</span><span class="num" id="1834809">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1834812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1834815">sign</span>&nbsp;<span class="op" id="1834820">:=</span>&nbsp;<span class="builtintype" id="1834823">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1834830">if</span>&nbsp;<span class="ident" id="1834833">x</span>&nbsp;<span class="op" id="1834835">&lt;</span>&nbsp;<span class="num" id="1834837">0</span>&nbsp;<span class="op" id="1834839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1834843">x</span>&nbsp;<span class="op" id="1834845">=</span>&nbsp;<span class="op" id="1834847">-</span><span class="ident" id="1834848">x</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1834852">sign</span>&nbsp;<span class="op" id="1834857">=</span>&nbsp;<span class="builtintype" id="1834859">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1834865">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1834868">if</span>&nbsp;<span class="ident" id="1834871">x</span>&nbsp;<span class="op" id="1834873">&lt;</span>&nbsp;<span class="num" id="1834875">0.84375</span>&nbsp;<span class="op" id="1834883">{</span>&nbsp;<span class="comment" id="1834885">//&nbsp;|x|&nbsp;&lt;&nbsp;0.84375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1834904">var</span>&nbsp;<span class="ident" id="1834908">temp</span>&nbsp;<span class="builtintype" id="1834913">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1834923">if</span>&nbsp;<span class="ident" id="1834926">x</span>&nbsp;<span class="op" id="1834928">&lt;</span>&nbsp;<span class="ident" id="1834930">Small</span>&nbsp;<span class="op" id="1834936">{</span>&nbsp;<span class="comment" id="1834938">//&nbsp;|x|&nbsp;&lt;&nbsp;2**-28</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1834957">if</span>&nbsp;<span class="ident" id="1834960">x</span>&nbsp;<span class="op" id="1834962">&lt;</span>&nbsp;<span class="ident" id="1834964">VeryTiny</span>&nbsp;<span class="op" id="1834973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1834979">temp</span>&nbsp;<span class="op" id="1834984">=</span>&nbsp;<span class="num" id="1834986">0.125</span>&nbsp;<span class="op" id="1834992">*</span>&nbsp;<span class="op" id="1834994">(</span><span class="num" id="1834995">8.0</span><span class="op" id="1834998">*</span><span class="ident" id="1834999">x</span>&nbsp;<span class="op" id="1835001">+</span>&nbsp;<span class="ident" id="1835003">efx8</span><span class="op" id="1835007">*</span><span class="ident" id="1835008">x</span><span class="op" id="1835009">)</span>&nbsp;<span class="comment" id="1835011">//&nbsp;avoid&nbsp;underflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1835033">}</span>&nbsp;<span class="keyword" id="1835035">else</span>&nbsp;<span class="op" id="1835040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1835046">temp</span>&nbsp;<span class="op" id="1835051">=</span>&nbsp;<span class="ident" id="1835053">x</span>&nbsp;<span class="op" id="1835055">+</span>&nbsp;<span class="ident" id="1835057">efx</span><span class="op" id="1835060">*</span><span class="ident" id="1835061">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1835066">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1835070">}</span>&nbsp;<span class="keyword" id="1835072">else</span>&nbsp;<span class="op" id="1835077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1835082">z</span>&nbsp;<span class="op" id="1835084">:=</span>&nbsp;<span class="ident" id="1835087">x</span>&nbsp;<span class="op" id="1835089">*</span>&nbsp;<span class="ident" id="1835091">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1835096">r</span>&nbsp;<span class="op" id="1835098">:=</span>&nbsp;<span class="ident" id="1835101">pp0</span>&nbsp;<span class="op" id="1835105">+</span>&nbsp;<span class="ident" id="1835107">z</span><span class="op" id="1835108">*</span><span class="op" id="1835109">(</span><span class="ident" id="1835110">pp1</span><span class="op" id="1835113">+</span><span class="ident" id="1835114">z</span><span class="op" id="1835115">*</span><span class="op" id="1835116">(</span><span class="ident" id="1835117">pp2</span><span class="op" id="1835120">+</span><span class="ident" id="1835121">z</span><span class="op" id="1835122">*</span><span class="op" id="1835123">(</span><span class="ident" id="1835124">pp3</span><span class="op" id="1835127">+</span><span class="ident" id="1835128">z</span><span class="op" id="1835129">*</span><span class="ident" id="1835130">pp4</span><span class="op" id="1835133">)</span><span class="op" id="1835134">)</span><span class="op" id="1835135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1835140">s</span>&nbsp;<span class="op" id="1835142">:=</span>&nbsp;<span class="num" id="1835145">1</span>&nbsp;<span class="op" id="1835147">+</span>&nbsp;<span class="ident" id="1835149">z</span><span class="op" id="1835150">*</span><span class="op" id="1835151">(</span><span class="ident" id="1835152">qq1</span><span class="op" id="1835155">+</span><span class="ident" id="1835156">z</span><span class="op" id="1835157">*</span><span class="op" id="1835158">(</span><span class="ident" id="1835159">qq2</span><span class="op" id="1835162">+</span><span class="ident" id="1835163">z</span><span class="op" id="1835164">*</span><span class="op" id="1835165">(</span><span class="ident" id="1835166">qq3</span><span class="op" id="1835169">+</span><span class="ident" id="1835170">z</span><span class="op" id="1835171">*</span><span class="op" id="1835172">(</span><span class="ident" id="1835173">qq4</span><span class="op" id="1835176">+</span><span class="ident" id="1835177">z</span><span class="op" id="1835178">*</span><span class="ident" id="1835179">qq5</span><span class="op" id="1835182">)</span><span class="op" id="1835183">)</span><span class="op" id="1835184">)</span><span class="op" id="1835185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1835190">y</span>&nbsp;<span class="op" id="1835192">:=</span>&nbsp;<span class="ident" id="1835195">r</span>&nbsp;<span class="op" id="1835197">/</span>&nbsp;<span class="ident" id="1835199">s</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1835204">temp</span>&nbsp;<span class="op" id="1835209">=</span>&nbsp;<span class="ident" id="1835211">x</span>&nbsp;<span class="op" id="1835213">+</span>&nbsp;<span class="ident" id="1835215">x</span><span class="op" id="1835216">*</span><span class="ident" id="1835217">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1835221">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1835225">if</span>&nbsp;<span class="ident" id="1835228">sign</span>&nbsp;<span class="op" id="1835233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1835238">return</span>&nbsp;<span class="op" id="1835245">-</span><span class="ident" id="1835246">temp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1835253">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1835257">return</span>&nbsp;<span class="ident" id="1835264">temp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1835270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1835273">if</span>&nbsp;<span class="ident" id="1835276">x</span>&nbsp;<span class="op" id="1835278">&lt;</span>&nbsp;<span class="num" id="1835280">1.25</span>&nbsp;<span class="op" id="1835285">{</span>&nbsp;<span class="comment" id="1835287">//&nbsp;0.84375&nbsp;&lt;=&nbsp;|x|&nbsp;&lt;&nbsp;1.25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1835314">s</span>&nbsp;<span class="op" id="1835316">:=</span>&nbsp;<span class="ident" id="1835319">x</span>&nbsp;<span class="op" id="1835321">-</span>&nbsp;<span class="num" id="1835323">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1835327">P</span>&nbsp;<span class="op" id="1835329">:=</span>&nbsp;<span class="ident" id="1835332">pa0</span>&nbsp;<span class="op" id="1835336">+</span>&nbsp;<span class="ident" id="1835338">s</span><span class="op" id="1835339">*</span><span class="op" id="1835340">(</span><span class="ident" id="1835341">pa1</span><span class="op" id="1835344">+</span><span class="ident" id="1835345">s</span><span class="op" id="1835346">*</span><span class="op" id="1835347">(</span><span class="ident" id="1835348">pa2</span><span class="op" id="1835351">+</span><span class="ident" id="1835352">s</span><span class="op" id="1835353">*</span><span class="op" id="1835354">(</span><span class="ident" id="1835355">pa3</span><span class="op" id="1835358">+</span><span class="ident" id="1835359">s</span><span class="op" id="1835360">*</span><span class="op" id="1835361">(</span><span class="ident" id="1835362">pa4</span><span class="op" id="1835365">+</span><span class="ident" id="1835366">s</span><span class="op" id="1835367">*</span><span class="op" id="1835368">(</span><span class="ident" id="1835369">pa5</span><span class="op" id="1835372">+</span><span class="ident" id="1835373">s</span><span class="op" id="1835374">*</span><span class="ident" id="1835375">pa6</span><span class="op" id="1835378">)</span><span class="op" id="1835379">)</span><span class="op" id="1835380">)</span><span class="op" id="1835381">)</span><span class="op" id="1835382">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1835386">Q</span>&nbsp;<span class="op" id="1835388">:=</span>&nbsp;<span class="num" id="1835391">1</span>&nbsp;<span class="op" id="1835393">+</span>&nbsp;<span class="ident" id="1835395">s</span><span class="op" id="1835396">*</span><span class="op" id="1835397">(</span><span class="ident" id="1835398">qa1</span><span class="op" id="1835401">+</span><span class="ident" id="1835402">s</span><span class="op" id="1835403">*</span><span class="op" id="1835404">(</span><span class="ident" id="1835405">qa2</span><span class="op" id="1835408">+</span><span class="ident" id="1835409">s</span><span class="op" id="1835410">*</span><span class="op" id="1835411">(</span><span class="ident" id="1835412">qa3</span><span class="op" id="1835415">+</span><span class="ident" id="1835416">s</span><span class="op" id="1835417">*</span><span class="op" id="1835418">(</span><span class="ident" id="1835419">qa4</span><span class="op" id="1835422">+</span><span class="ident" id="1835423">s</span><span class="op" id="1835424">*</span><span class="op" id="1835425">(</span><span class="ident" id="1835426">qa5</span><span class="op" id="1835429">+</span><span class="ident" id="1835430">s</span><span class="op" id="1835431">*</span><span class="ident" id="1835432">qa6</span><span class="op" id="1835435">)</span><span class="op" id="1835436">)</span><span class="op" id="1835437">)</span><span class="op" id="1835438">)</span><span class="op" id="1835439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1835443">if</span>&nbsp;<span class="ident" id="1835446">sign</span>&nbsp;<span class="op" id="1835451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1835456">return</span>&nbsp;<span class="op" id="1835463">-</span><span class="ident" id="1835464">erx</span>&nbsp;<span class="op" id="1835468">-</span>&nbsp;<span class="ident" id="1835470">P</span><span class="op" id="1835471">/</span><span class="ident" id="1835472">Q</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1835476">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1835480">return</span>&nbsp;<span class="ident" id="1835487">erx</span>&nbsp;<span class="op" id="1835491">+</span>&nbsp;<span class="ident" id="1835493">P</span><span class="op" id="1835494">/</span><span class="ident" id="1835495">Q</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1835498">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1835501">if</span>&nbsp;<span class="ident" id="1835504">x</span>&nbsp;<span class="op" id="1835506">&gt;=</span>&nbsp;<span class="num" id="1835509">6</span>&nbsp;<span class="op" id="1835511">{</span>&nbsp;<span class="comment" id="1835513">//&nbsp;inf&nbsp;&gt;&nbsp;|x|&nbsp;&gt;=&nbsp;6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1835533">if</span>&nbsp;<span class="ident" id="1835536">sign</span>&nbsp;<span class="op" id="1835541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1835546">return</span>&nbsp;<span class="op" id="1835553">-</span><span class="num" id="1835554">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1835558">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1835562">return</span>&nbsp;<span class="num" id="1835569">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1835572">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1835575">s</span>&nbsp;<span class="op" id="1835577">:=</span>&nbsp;<span class="num" id="1835580">1</span>&nbsp;<span class="op" id="1835582">/</span>&nbsp;<span class="op" id="1835584">(</span><span class="ident" id="1835585">x</span>&nbsp;<span class="op" id="1835587">*</span>&nbsp;<span class="ident" id="1835589">x</span><span class="op" id="1835590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1835593">var</span>&nbsp;<span class="ident" id="1835597">R</span><span class="op" id="1835598">,</span>&nbsp;<span class="ident" id="1835600">S</span>&nbsp;<span class="builtintype" id="1835602">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1835611">if</span>&nbsp;<span class="ident" id="1835614">x</span>&nbsp;<span class="op" id="1835616">&lt;</span>&nbsp;<span class="num" id="1835618">1</span><span class="op" id="1835619">/</span><span class="num" id="1835620">0.35</span>&nbsp;<span class="op" id="1835625">{</span>&nbsp;<span class="comment" id="1835627">//&nbsp;|x|&nbsp;&lt;&nbsp;1&nbsp;/&nbsp;0.35&nbsp;&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1835659">R</span>&nbsp;<span class="op" id="1835661">=</span>&nbsp;<span class="ident" id="1835663">ra0</span>&nbsp;<span class="op" id="1835667">+</span>&nbsp;<span class="ident" id="1835669">s</span><span class="op" id="1835670">*</span><span class="op" id="1835671">(</span><span class="ident" id="1835672">ra1</span><span class="op" id="1835675">+</span><span class="ident" id="1835676">s</span><span class="op" id="1835677">*</span><span class="op" id="1835678">(</span><span class="ident" id="1835679">ra2</span><span class="op" id="1835682">+</span><span class="ident" id="1835683">s</span><span class="op" id="1835684">*</span><span class="op" id="1835685">(</span><span class="ident" id="1835686">ra3</span><span class="op" id="1835689">+</span><span class="ident" id="1835690">s</span><span class="op" id="1835691">*</span><span class="op" id="1835692">(</span><span class="ident" id="1835693">ra4</span><span class="op" id="1835696">+</span><span class="ident" id="1835697">s</span><span class="op" id="1835698">*</span><span class="op" id="1835699">(</span><span class="ident" id="1835700">ra5</span><span class="op" id="1835703">+</span><span class="ident" id="1835704">s</span><span class="op" id="1835705">*</span><span class="op" id="1835706">(</span><span class="ident" id="1835707">ra6</span><span class="op" id="1835710">+</span><span class="ident" id="1835711">s</span><span class="op" id="1835712">*</span><span class="ident" id="1835713">ra7</span><span class="op" id="1835716">)</span><span class="op" id="1835717">)</span><span class="op" id="1835718">)</span><span class="op" id="1835719">)</span><span class="op" id="1835720">)</span><span class="op" id="1835721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1835725">S</span>&nbsp;<span class="op" id="1835727">=</span>&nbsp;<span class="num" id="1835729">1</span>&nbsp;<span class="op" id="1835731">+</span>&nbsp;<span class="ident" id="1835733">s</span><span class="op" id="1835734">*</span><span class="op" id="1835735">(</span><span class="ident" id="1835736">sa1</span><span class="op" id="1835739">+</span><span class="ident" id="1835740">s</span><span class="op" id="1835741">*</span><span class="op" id="1835742">(</span><span class="ident" id="1835743">sa2</span><span class="op" id="1835746">+</span><span class="ident" id="1835747">s</span><span class="op" id="1835748">*</span><span class="op" id="1835749">(</span><span class="ident" id="1835750">sa3</span><span class="op" id="1835753">+</span><span class="ident" id="1835754">s</span><span class="op" id="1835755">*</span><span class="op" id="1835756">(</span><span class="ident" id="1835757">sa4</span><span class="op" id="1835760">+</span><span class="ident" id="1835761">s</span><span class="op" id="1835762">*</span><span class="op" id="1835763">(</span><span class="ident" id="1835764">sa5</span><span class="op" id="1835767">+</span><span class="ident" id="1835768">s</span><span class="op" id="1835769">*</span><span class="op" id="1835770">(</span><span class="ident" id="1835771">sa6</span><span class="op" id="1835774">+</span><span class="ident" id="1835775">s</span><span class="op" id="1835776">*</span><span class="op" id="1835777">(</span><span class="ident" id="1835778">sa7</span><span class="op" id="1835781">+</span><span class="ident" id="1835782">s</span><span class="op" id="1835783">*</span><span class="ident" id="1835784">sa8</span><span class="op" id="1835787">)</span><span class="op" id="1835788">)</span><span class="op" id="1835789">)</span><span class="op" id="1835790">)</span><span class="op" id="1835791">)</span><span class="op" id="1835792">)</span><span class="op" id="1835793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1835796">}</span>&nbsp;<span class="keyword" id="1835798">else</span>&nbsp;<span class="op" id="1835803">{</span>&nbsp;<span class="comment" id="1835805">//&nbsp;|x|&nbsp;&gt;=&nbsp;1&nbsp;/&nbsp;0.35&nbsp;&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1835838">R</span>&nbsp;<span class="op" id="1835840">=</span>&nbsp;<span class="ident" id="1835842">rb0</span>&nbsp;<span class="op" id="1835846">+</span>&nbsp;<span class="ident" id="1835848">s</span><span class="op" id="1835849">*</span><span class="op" id="1835850">(</span><span class="ident" id="1835851">rb1</span><span class="op" id="1835854">+</span><span class="ident" id="1835855">s</span><span class="op" id="1835856">*</span><span class="op" id="1835857">(</span><span class="ident" id="1835858">rb2</span><span class="op" id="1835861">+</span><span class="ident" id="1835862">s</span><span class="op" id="1835863">*</span><span class="op" id="1835864">(</span><span class="ident" id="1835865">rb3</span><span class="op" id="1835868">+</span><span class="ident" id="1835869">s</span><span class="op" id="1835870">*</span><span class="op" id="1835871">(</span><span class="ident" id="1835872">rb4</span><span class="op" id="1835875">+</span><span class="ident" id="1835876">s</span><span class="op" id="1835877">*</span><span class="op" id="1835878">(</span><span class="ident" id="1835879">rb5</span><span class="op" id="1835882">+</span><span class="ident" id="1835883">s</span><span class="op" id="1835884">*</span><span class="ident" id="1835885">rb6</span><span class="op" id="1835888">)</span><span class="op" id="1835889">)</span><span class="op" id="1835890">)</span><span class="op" id="1835891">)</span><span class="op" id="1835892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1835896">S</span>&nbsp;<span class="op" id="1835898">=</span>&nbsp;<span class="num" id="1835900">1</span>&nbsp;<span class="op" id="1835902">+</span>&nbsp;<span class="ident" id="1835904">s</span><span class="op" id="1835905">*</span><span class="op" id="1835906">(</span><span class="ident" id="1835907">sb1</span><span class="op" id="1835910">+</span><span class="ident" id="1835911">s</span><span class="op" id="1835912">*</span><span class="op" id="1835913">(</span><span class="ident" id="1835914">sb2</span><span class="op" id="1835917">+</span><span class="ident" id="1835918">s</span><span class="op" id="1835919">*</span><span class="op" id="1835920">(</span><span class="ident" id="1835921">sb3</span><span class="op" id="1835924">+</span><span class="ident" id="1835925">s</span><span class="op" id="1835926">*</span><span class="op" id="1835927">(</span><span class="ident" id="1835928">sb4</span><span class="op" id="1835931">+</span><span class="ident" id="1835932">s</span><span class="op" id="1835933">*</span><span class="op" id="1835934">(</span><span class="ident" id="1835935">sb5</span><span class="op" id="1835938">+</span><span class="ident" id="1835939">s</span><span class="op" id="1835940">*</span><span class="op" id="1835941">(</span><span class="ident" id="1835942">sb6</span><span class="op" id="1835945">+</span><span class="ident" id="1835946">s</span><span class="op" id="1835947">*</span><span class="ident" id="1835948">sb7</span><span class="op" id="1835951">)</span><span class="op" id="1835952">)</span><span class="op" id="1835953">)</span><span class="op" id="1835954">)</span><span class="op" id="1835955">)</span><span class="op" id="1835956">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1835959">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1835962">z</span>&nbsp;<span class="op" id="1835964">:=</span>&nbsp;<span class="ident" id="1835967">Float64frombits</span><span class="op" id="1835982">(</span><span class="ident" id="1835983">Float64bits</span><span class="op" id="1835994">(</span><span class="ident" id="1835995">x</span><span class="op" id="1835996">)</span>&nbsp;<span class="op" id="1835998">&amp;</span>&nbsp;<span class="num" id="1836000">0xffffffff00000000</span><span class="op" id="1836018">)</span>&nbsp;<span class="comment" id="1836020">//&nbsp;pseudo-single&nbsp;(20-bit)&nbsp;precision&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1836059">r</span>&nbsp;<span class="op" id="1836061">:=</span>&nbsp;<span class="ident" id="1836064">Exp</span><span class="op" id="1836067">(</span><span class="op" id="1836068">-</span><span class="ident" id="1836069">z</span><span class="op" id="1836070">*</span><span class="ident" id="1836071">z</span><span class="op" id="1836072">-</span><span class="num" id="1836073">0.5625</span><span class="op" id="1836079">)</span>&nbsp;<span class="op" id="1836081">*</span>&nbsp;<span class="ident" id="1836083">Exp</span><span class="op" id="1836086">(</span><span class="op" id="1836087">(</span><span class="ident" id="1836088">z</span><span class="op" id="1836089">-</span><span class="ident" id="1836090">x</span><span class="op" id="1836091">)</span><span class="op" id="1836092">*</span><span class="op" id="1836093">(</span><span class="ident" id="1836094">z</span><span class="op" id="1836095">+</span><span class="ident" id="1836096">x</span><span class="op" id="1836097">)</span><span class="op" id="1836098">+</span><span class="ident" id="1836099">R</span><span class="op" id="1836100">/</span><span class="ident" id="1836101">S</span><span class="op" id="1836102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1836105">if</span>&nbsp;<span class="ident" id="1836108">sign</span>&nbsp;<span class="op" id="1836113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1836117">return</span>&nbsp;<span class="ident" id="1836124">r</span><span class="op" id="1836125">/</span><span class="ident" id="1836126">x</span>&nbsp;<span class="op" id="1836128">-</span>&nbsp;<span class="num" id="1836130">1</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1836133">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1836136">return</span>&nbsp;<span class="num" id="1836143">1</span>&nbsp;<span class="op" id="1836145">-</span>&nbsp;<span class="ident" id="1836147">r</span><span class="op" id="1836148">/</span><span class="ident" id="1836149">x</span><br>
<span class="lineno"></span><span class="op" id="1836151">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1836154">//&nbsp;Erfc&nbsp;returns&nbsp;the&nbsp;complementary&nbsp;error&nbsp;function&nbsp;of&nbsp;x.</span><br>
<span class="lineno">260</span><span class="comment" id="1836209">//</span><br>
<span class="lineno"></span><span class="comment" id="1836212">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="1836234">//&nbsp;&nbsp;&nbsp;&nbspErfc(+Inf)&nbsp;=&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="1836252">//&nbsp;&nbsp;&nbsp;&nbspErfc(-Inf)&nbsp;=&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="1836270">//&nbsp;&nbsp;&nbsp;&nbspErfc(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno">265</span><span class="keyword" id="1836289">func</span>&nbsp;<span class="ident" id="1836294">Erfc</span><span class="op" id="1836298">(</span><span class="ident" id="1836299">x</span>&nbsp;<span class="builtintype" id="1836301">float64</span><span class="op" id="1836308">)</span>&nbsp;<span class="builtintype" id="1836310">float64</span>&nbsp;<span class="op" id="1836318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1836321">const</span>&nbsp;<span class="ident" id="1836327">Tiny</span>&nbsp;<span class="op" id="1836332">=</span>&nbsp;<span class="num" id="1836334">1.0</span>&nbsp;<span class="op" id="1836338">/</span>&nbsp;<span class="op" id="1836340">(</span><span class="num" id="1836341">1</span>&nbsp;<span class="op" id="1836343">&lt;&lt;</span>&nbsp;<span class="num" id="1836346">56</span><span class="op" id="1836348">)</span>&nbsp;<span class="comment" id="1836350">//&nbsp;2**-56</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1836361">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1836379">switch</span>&nbsp;<span class="op" id="1836386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1836389">case</span>&nbsp;<span class="ident" id="1836394">IsNaN</span><span class="op" id="1836399">(</span><span class="ident" id="1836400">x</span><span class="op" id="1836401">)</span><span class="op" id="1836402">:</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1836406">return</span>&nbsp;<span class="ident" id="1836413">NaN</span><span class="op" id="1836416">(</span><span class="op" id="1836417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1836420">case</span>&nbsp;<span class="ident" id="1836425">IsInf</span><span class="op" id="1836430">(</span><span class="ident" id="1836431">x</span><span class="op" id="1836432">,</span>&nbsp;<span class="num" id="1836434">1</span><span class="op" id="1836435">)</span><span class="op" id="1836436">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1836440">return</span>&nbsp;<span class="num" id="1836447">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1836450">case</span>&nbsp;<span class="ident" id="1836455">IsInf</span><span class="op" id="1836460">(</span><span class="ident" id="1836461">x</span><span class="op" id="1836462">,</span>&nbsp;<span class="op" id="1836464">-</span><span class="num" id="1836465">1</span><span class="op" id="1836466">)</span><span class="op" id="1836467">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1836471">return</span>&nbsp;<span class="num" id="1836478">2</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1836481">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1836484">sign</span>&nbsp;<span class="op" id="1836489">:=</span>&nbsp;<span class="builtintype" id="1836492">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1836499">if</span>&nbsp;<span class="ident" id="1836502">x</span>&nbsp;<span class="op" id="1836504">&lt;</span>&nbsp;<span class="num" id="1836506">0</span>&nbsp;<span class="op" id="1836508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1836512">x</span>&nbsp;<span class="op" id="1836514">=</span>&nbsp;<span class="op" id="1836516">-</span><span class="ident" id="1836517">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1836521">sign</span>&nbsp;<span class="op" id="1836526">=</span>&nbsp;<span class="builtintype" id="1836528">true</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1836534">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1836537">if</span>&nbsp;<span class="ident" id="1836540">x</span>&nbsp;<span class="op" id="1836542">&lt;</span>&nbsp;<span class="num" id="1836544">0.84375</span>&nbsp;<span class="op" id="1836552">{</span>&nbsp;<span class="comment" id="1836554">//&nbsp;|x|&nbsp;&lt;&nbsp;0.84375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1836573">var</span>&nbsp;<span class="ident" id="1836577">temp</span>&nbsp;<span class="builtintype" id="1836582">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1836592">if</span>&nbsp;<span class="ident" id="1836595">x</span>&nbsp;<span class="op" id="1836597">&lt;</span>&nbsp;<span class="ident" id="1836599">Tiny</span>&nbsp;<span class="op" id="1836604">{</span>&nbsp;<span class="comment" id="1836606">//&nbsp;|x|&nbsp;&lt;&nbsp;2**-56</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1836625">temp</span>&nbsp;<span class="op" id="1836630">=</span>&nbsp;<span class="ident" id="1836632">x</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1836636">}</span>&nbsp;<span class="keyword" id="1836638">else</span>&nbsp;<span class="op" id="1836643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1836648">z</span>&nbsp;<span class="op" id="1836650">:=</span>&nbsp;<span class="ident" id="1836653">x</span>&nbsp;<span class="op" id="1836655">*</span>&nbsp;<span class="ident" id="1836657">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1836662">r</span>&nbsp;<span class="op" id="1836664">:=</span>&nbsp;<span class="ident" id="1836667">pp0</span>&nbsp;<span class="op" id="1836671">+</span>&nbsp;<span class="ident" id="1836673">z</span><span class="op" id="1836674">*</span><span class="op" id="1836675">(</span><span class="ident" id="1836676">pp1</span><span class="op" id="1836679">+</span><span class="ident" id="1836680">z</span><span class="op" id="1836681">*</span><span class="op" id="1836682">(</span><span class="ident" id="1836683">pp2</span><span class="op" id="1836686">+</span><span class="ident" id="1836687">z</span><span class="op" id="1836688">*</span><span class="op" id="1836689">(</span><span class="ident" id="1836690">pp3</span><span class="op" id="1836693">+</span><span class="ident" id="1836694">z</span><span class="op" id="1836695">*</span><span class="ident" id="1836696">pp4</span><span class="op" id="1836699">)</span><span class="op" id="1836700">)</span><span class="op" id="1836701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1836706">s</span>&nbsp;<span class="op" id="1836708">:=</span>&nbsp;<span class="num" id="1836711">1</span>&nbsp;<span class="op" id="1836713">+</span>&nbsp;<span class="ident" id="1836715">z</span><span class="op" id="1836716">*</span><span class="op" id="1836717">(</span><span class="ident" id="1836718">qq1</span><span class="op" id="1836721">+</span><span class="ident" id="1836722">z</span><span class="op" id="1836723">*</span><span class="op" id="1836724">(</span><span class="ident" id="1836725">qq2</span><span class="op" id="1836728">+</span><span class="ident" id="1836729">z</span><span class="op" id="1836730">*</span><span class="op" id="1836731">(</span><span class="ident" id="1836732">qq3</span><span class="op" id="1836735">+</span><span class="ident" id="1836736">z</span><span class="op" id="1836737">*</span><span class="op" id="1836738">(</span><span class="ident" id="1836739">qq4</span><span class="op" id="1836742">+</span><span class="ident" id="1836743">z</span><span class="op" id="1836744">*</span><span class="ident" id="1836745">qq5</span><span class="op" id="1836748">)</span><span class="op" id="1836749">)</span><span class="op" id="1836750">)</span><span class="op" id="1836751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1836756">y</span>&nbsp;<span class="op" id="1836758">:=</span>&nbsp;<span class="ident" id="1836761">r</span>&nbsp;<span class="op" id="1836763">/</span>&nbsp;<span class="ident" id="1836765">s</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1836770">if</span>&nbsp;<span class="ident" id="1836773">x</span>&nbsp;<span class="op" id="1836775">&lt;</span>&nbsp;<span class="num" id="1836777">0.25</span>&nbsp;<span class="op" id="1836782">{</span>&nbsp;<span class="comment" id="1836784">//&nbsp;|x|&nbsp;&lt;&nbsp;1/4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1836801">temp</span>&nbsp;<span class="op" id="1836806">=</span>&nbsp;<span class="ident" id="1836808">x</span>&nbsp;<span class="op" id="1836810">+</span>&nbsp;<span class="ident" id="1836812">x</span><span class="op" id="1836813">*</span><span class="ident" id="1836814">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1836819">}</span>&nbsp;<span class="keyword" id="1836821">else</span>&nbsp;<span class="op" id="1836826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1836832">temp</span>&nbsp;<span class="op" id="1836837">=</span>&nbsp;<span class="num" id="1836839">0.5</span>&nbsp;<span class="op" id="1836843">+</span>&nbsp;<span class="op" id="1836845">(</span><span class="ident" id="1836846">x</span><span class="op" id="1836847">*</span><span class="ident" id="1836848">y</span>&nbsp;<span class="op" id="1836850">+</span>&nbsp;<span class="op" id="1836852">(</span><span class="ident" id="1836853">x</span>&nbsp;<span class="op" id="1836855">-</span>&nbsp;<span class="num" id="1836857">0.5</span><span class="op" id="1836860">)</span><span class="op" id="1836861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1836866">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1836870">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1836874">if</span>&nbsp;<span class="ident" id="1836877">sign</span>&nbsp;<span class="op" id="1836882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1836887">return</span>&nbsp;<span class="num" id="1836894">1</span>&nbsp;<span class="op" id="1836896">+</span>&nbsp;<span class="ident" id="1836898">temp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1836905">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1836909">return</span>&nbsp;<span class="num" id="1836916">1</span>&nbsp;<span class="op" id="1836918">-</span>&nbsp;<span class="ident" id="1836920">temp</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1836926">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1836929">if</span>&nbsp;<span class="ident" id="1836932">x</span>&nbsp;<span class="op" id="1836934">&lt;</span>&nbsp;<span class="num" id="1836936">1.25</span>&nbsp;<span class="op" id="1836941">{</span>&nbsp;<span class="comment" id="1836943">//&nbsp;0.84375&nbsp;&lt;=&nbsp;|x|&nbsp;&lt;&nbsp;1.25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1836970">s</span>&nbsp;<span class="op" id="1836972">:=</span>&nbsp;<span class="ident" id="1836975">x</span>&nbsp;<span class="op" id="1836977">-</span>&nbsp;<span class="num" id="1836979">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1836983">P</span>&nbsp;<span class="op" id="1836985">:=</span>&nbsp;<span class="ident" id="1836988">pa0</span>&nbsp;<span class="op" id="1836992">+</span>&nbsp;<span class="ident" id="1836994">s</span><span class="op" id="1836995">*</span><span class="op" id="1836996">(</span><span class="ident" id="1836997">pa1</span><span class="op" id="1837000">+</span><span class="ident" id="1837001">s</span><span class="op" id="1837002">*</span><span class="op" id="1837003">(</span><span class="ident" id="1837004">pa2</span><span class="op" id="1837007">+</span><span class="ident" id="1837008">s</span><span class="op" id="1837009">*</span><span class="op" id="1837010">(</span><span class="ident" id="1837011">pa3</span><span class="op" id="1837014">+</span><span class="ident" id="1837015">s</span><span class="op" id="1837016">*</span><span class="op" id="1837017">(</span><span class="ident" id="1837018">pa4</span><span class="op" id="1837021">+</span><span class="ident" id="1837022">s</span><span class="op" id="1837023">*</span><span class="op" id="1837024">(</span><span class="ident" id="1837025">pa5</span><span class="op" id="1837028">+</span><span class="ident" id="1837029">s</span><span class="op" id="1837030">*</span><span class="ident" id="1837031">pa6</span><span class="op" id="1837034">)</span><span class="op" id="1837035">)</span><span class="op" id="1837036">)</span><span class="op" id="1837037">)</span><span class="op" id="1837038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1837042">Q</span>&nbsp;<span class="op" id="1837044">:=</span>&nbsp;<span class="num" id="1837047">1</span>&nbsp;<span class="op" id="1837049">+</span>&nbsp;<span class="ident" id="1837051">s</span><span class="op" id="1837052">*</span><span class="op" id="1837053">(</span><span class="ident" id="1837054">qa1</span><span class="op" id="1837057">+</span><span class="ident" id="1837058">s</span><span class="op" id="1837059">*</span><span class="op" id="1837060">(</span><span class="ident" id="1837061">qa2</span><span class="op" id="1837064">+</span><span class="ident" id="1837065">s</span><span class="op" id="1837066">*</span><span class="op" id="1837067">(</span><span class="ident" id="1837068">qa3</span><span class="op" id="1837071">+</span><span class="ident" id="1837072">s</span><span class="op" id="1837073">*</span><span class="op" id="1837074">(</span><span class="ident" id="1837075">qa4</span><span class="op" id="1837078">+</span><span class="ident" id="1837079">s</span><span class="op" id="1837080">*</span><span class="op" id="1837081">(</span><span class="ident" id="1837082">qa5</span><span class="op" id="1837085">+</span><span class="ident" id="1837086">s</span><span class="op" id="1837087">*</span><span class="ident" id="1837088">qa6</span><span class="op" id="1837091">)</span><span class="op" id="1837092">)</span><span class="op" id="1837093">)</span><span class="op" id="1837094">)</span><span class="op" id="1837095">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1837099">if</span>&nbsp;<span class="ident" id="1837102">sign</span>&nbsp;<span class="op" id="1837107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1837112">return</span>&nbsp;<span class="num" id="1837119">1</span>&nbsp;<span class="op" id="1837121">+</span>&nbsp;<span class="ident" id="1837123">erx</span>&nbsp;<span class="op" id="1837127">+</span>&nbsp;<span class="ident" id="1837129">P</span><span class="op" id="1837130">/</span><span class="ident" id="1837131">Q</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1837135">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1837139">return</span>&nbsp;<span class="num" id="1837146">1</span>&nbsp;<span class="op" id="1837148">-</span>&nbsp;<span class="ident" id="1837150">erx</span>&nbsp;<span class="op" id="1837154">-</span>&nbsp;<span class="ident" id="1837156">P</span><span class="op" id="1837157">/</span><span class="ident" id="1837158">Q</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1837162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1837165">if</span>&nbsp;<span class="ident" id="1837168">x</span>&nbsp;<span class="op" id="1837170">&lt;</span>&nbsp;<span class="num" id="1837172">28</span>&nbsp;<span class="op" id="1837175">{</span>&nbsp;<span class="comment" id="1837177">//&nbsp;|x|&nbsp;&lt;&nbsp;28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1837191">s</span>&nbsp;<span class="op" id="1837193">:=</span>&nbsp;<span class="num" id="1837196">1</span>&nbsp;<span class="op" id="1837198">/</span>&nbsp;<span class="op" id="1837200">(</span><span class="ident" id="1837201">x</span>&nbsp;<span class="op" id="1837203">*</span>&nbsp;<span class="ident" id="1837205">x</span><span class="op" id="1837206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1837210">var</span>&nbsp;<span class="ident" id="1837214">R</span><span class="op" id="1837215">,</span>&nbsp;<span class="ident" id="1837217">S</span>&nbsp;<span class="builtintype" id="1837219">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1837229">if</span>&nbsp;<span class="ident" id="1837232">x</span>&nbsp;<span class="op" id="1837234">&lt;</span>&nbsp;<span class="num" id="1837236">1</span><span class="op" id="1837237">/</span><span class="num" id="1837238">0.35</span>&nbsp;<span class="op" id="1837243">{</span>&nbsp;<span class="comment" id="1837245">//&nbsp;|x|&nbsp;&lt;&nbsp;1&nbsp;/&nbsp;0.35&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1837277">R</span>&nbsp;<span class="op" id="1837279">=</span>&nbsp;<span class="ident" id="1837281">ra0</span>&nbsp;<span class="op" id="1837285">+</span>&nbsp;<span class="ident" id="1837287">s</span><span class="op" id="1837288">*</span><span class="op" id="1837289">(</span><span class="ident" id="1837290">ra1</span><span class="op" id="1837293">+</span><span class="ident" id="1837294">s</span><span class="op" id="1837295">*</span><span class="op" id="1837296">(</span><span class="ident" id="1837297">ra2</span><span class="op" id="1837300">+</span><span class="ident" id="1837301">s</span><span class="op" id="1837302">*</span><span class="op" id="1837303">(</span><span class="ident" id="1837304">ra3</span><span class="op" id="1837307">+</span><span class="ident" id="1837308">s</span><span class="op" id="1837309">*</span><span class="op" id="1837310">(</span><span class="ident" id="1837311">ra4</span><span class="op" id="1837314">+</span><span class="ident" id="1837315">s</span><span class="op" id="1837316">*</span><span class="op" id="1837317">(</span><span class="ident" id="1837318">ra5</span><span class="op" id="1837321">+</span><span class="ident" id="1837322">s</span><span class="op" id="1837323">*</span><span class="op" id="1837324">(</span><span class="ident" id="1837325">ra6</span><span class="op" id="1837328">+</span><span class="ident" id="1837329">s</span><span class="op" id="1837330">*</span><span class="ident" id="1837331">ra7</span><span class="op" id="1837334">)</span><span class="op" id="1837335">)</span><span class="op" id="1837336">)</span><span class="op" id="1837337">)</span><span class="op" id="1837338">)</span><span class="op" id="1837339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1837344">S</span>&nbsp;<span class="op" id="1837346">=</span>&nbsp;<span class="num" id="1837348">1</span>&nbsp;<span class="op" id="1837350">+</span>&nbsp;<span class="ident" id="1837352">s</span><span class="op" id="1837353">*</span><span class="op" id="1837354">(</span><span class="ident" id="1837355">sa1</span><span class="op" id="1837358">+</span><span class="ident" id="1837359">s</span><span class="op" id="1837360">*</span><span class="op" id="1837361">(</span><span class="ident" id="1837362">sa2</span><span class="op" id="1837365">+</span><span class="ident" id="1837366">s</span><span class="op" id="1837367">*</span><span class="op" id="1837368">(</span><span class="ident" id="1837369">sa3</span><span class="op" id="1837372">+</span><span class="ident" id="1837373">s</span><span class="op" id="1837374">*</span><span class="op" id="1837375">(</span><span class="ident" id="1837376">sa4</span><span class="op" id="1837379">+</span><span class="ident" id="1837380">s</span><span class="op" id="1837381">*</span><span class="op" id="1837382">(</span><span class="ident" id="1837383">sa5</span><span class="op" id="1837386">+</span><span class="ident" id="1837387">s</span><span class="op" id="1837388">*</span><span class="op" id="1837389">(</span><span class="ident" id="1837390">sa6</span><span class="op" id="1837393">+</span><span class="ident" id="1837394">s</span><span class="op" id="1837395">*</span><span class="op" id="1837396">(</span><span class="ident" id="1837397">sa7</span><span class="op" id="1837400">+</span><span class="ident" id="1837401">s</span><span class="op" id="1837402">*</span><span class="ident" id="1837403">sa8</span><span class="op" id="1837406">)</span><span class="op" id="1837407">)</span><span class="op" id="1837408">)</span><span class="op" id="1837409">)</span><span class="op" id="1837410">)</span><span class="op" id="1837411">)</span><span class="op" id="1837412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1837416">}</span>&nbsp;<span class="keyword" id="1837418">else</span>&nbsp;<span class="op" id="1837423">{</span>&nbsp;<span class="comment" id="1837425">//&nbsp;|x|&nbsp;&gt;=&nbsp;1&nbsp;/&nbsp;0.35&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1837458">if</span>&nbsp;<span class="ident" id="1837461">sign</span>&nbsp;<span class="op" id="1837466">&amp;&amp;</span>&nbsp;<span class="ident" id="1837469">x</span>&nbsp;<span class="op" id="1837471">&gt;</span>&nbsp;<span class="num" id="1837473">6</span>&nbsp;<span class="op" id="1837475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1837481">return</span>&nbsp;<span class="num" id="1837488">2</span>&nbsp;<span class="comment" id="1837490">//&nbsp;x&nbsp;&lt;&nbsp;-6</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1837503">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1837508">R</span>&nbsp;<span class="op" id="1837510">=</span>&nbsp;<span class="ident" id="1837512">rb0</span>&nbsp;<span class="op" id="1837516">+</span>&nbsp;<span class="ident" id="1837518">s</span><span class="op" id="1837519">*</span><span class="op" id="1837520">(</span><span class="ident" id="1837521">rb1</span><span class="op" id="1837524">+</span><span class="ident" id="1837525">s</span><span class="op" id="1837526">*</span><span class="op" id="1837527">(</span><span class="ident" id="1837528">rb2</span><span class="op" id="1837531">+</span><span class="ident" id="1837532">s</span><span class="op" id="1837533">*</span><span class="op" id="1837534">(</span><span class="ident" id="1837535">rb3</span><span class="op" id="1837538">+</span><span class="ident" id="1837539">s</span><span class="op" id="1837540">*</span><span class="op" id="1837541">(</span><span class="ident" id="1837542">rb4</span><span class="op" id="1837545">+</span><span class="ident" id="1837546">s</span><span class="op" id="1837547">*</span><span class="op" id="1837548">(</span><span class="ident" id="1837549">rb5</span><span class="op" id="1837552">+</span><span class="ident" id="1837553">s</span><span class="op" id="1837554">*</span><span class="ident" id="1837555">rb6</span><span class="op" id="1837558">)</span><span class="op" id="1837559">)</span><span class="op" id="1837560">)</span><span class="op" id="1837561">)</span><span class="op" id="1837562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1837567">S</span>&nbsp;<span class="op" id="1837569">=</span>&nbsp;<span class="num" id="1837571">1</span>&nbsp;<span class="op" id="1837573">+</span>&nbsp;<span class="ident" id="1837575">s</span><span class="op" id="1837576">*</span><span class="op" id="1837577">(</span><span class="ident" id="1837578">sb1</span><span class="op" id="1837581">+</span><span class="ident" id="1837582">s</span><span class="op" id="1837583">*</span><span class="op" id="1837584">(</span><span class="ident" id="1837585">sb2</span><span class="op" id="1837588">+</span><span class="ident" id="1837589">s</span><span class="op" id="1837590">*</span><span class="op" id="1837591">(</span><span class="ident" id="1837592">sb3</span><span class="op" id="1837595">+</span><span class="ident" id="1837596">s</span><span class="op" id="1837597">*</span><span class="op" id="1837598">(</span><span class="ident" id="1837599">sb4</span><span class="op" id="1837602">+</span><span class="ident" id="1837603">s</span><span class="op" id="1837604">*</span><span class="op" id="1837605">(</span><span class="ident" id="1837606">sb5</span><span class="op" id="1837609">+</span><span class="ident" id="1837610">s</span><span class="op" id="1837611">*</span><span class="op" id="1837612">(</span><span class="ident" id="1837613">sb6</span><span class="op" id="1837616">+</span><span class="ident" id="1837617">s</span><span class="op" id="1837618">*</span><span class="ident" id="1837619">sb7</span><span class="op" id="1837622">)</span><span class="op" id="1837623">)</span><span class="op" id="1837624">)</span><span class="op" id="1837625">)</span><span class="op" id="1837626">)</span><span class="op" id="1837627">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1837631">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1837635">z</span>&nbsp;<span class="op" id="1837637">:=</span>&nbsp;<span class="ident" id="1837640">Float64frombits</span><span class="op" id="1837655">(</span><span class="ident" id="1837656">Float64bits</span><span class="op" id="1837667">(</span><span class="ident" id="1837668">x</span><span class="op" id="1837669">)</span>&nbsp;<span class="op" id="1837671">&amp;</span>&nbsp;<span class="num" id="1837673">0xffffffff00000000</span><span class="op" id="1837691">)</span>&nbsp;<span class="comment" id="1837693">//&nbsp;pseudo-single&nbsp;(20-bit)&nbsp;precision&nbsp;x</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1837733">r</span>&nbsp;<span class="op" id="1837735">:=</span>&nbsp;<span class="ident" id="1837738">Exp</span><span class="op" id="1837741">(</span><span class="op" id="1837742">-</span><span class="ident" id="1837743">z</span><span class="op" id="1837744">*</span><span class="ident" id="1837745">z</span><span class="op" id="1837746">-</span><span class="num" id="1837747">0.5625</span><span class="op" id="1837753">)</span>&nbsp;<span class="op" id="1837755">*</span>&nbsp;<span class="ident" id="1837757">Exp</span><span class="op" id="1837760">(</span><span class="op" id="1837761">(</span><span class="ident" id="1837762">z</span><span class="op" id="1837763">-</span><span class="ident" id="1837764">x</span><span class="op" id="1837765">)</span><span class="op" id="1837766">*</span><span class="op" id="1837767">(</span><span class="ident" id="1837768">z</span><span class="op" id="1837769">+</span><span class="ident" id="1837770">x</span><span class="op" id="1837771">)</span><span class="op" id="1837772">+</span><span class="ident" id="1837773">R</span><span class="op" id="1837774">/</span><span class="ident" id="1837775">S</span><span class="op" id="1837776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1837780">if</span>&nbsp;<span class="ident" id="1837783">sign</span>&nbsp;<span class="op" id="1837788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1837793">return</span>&nbsp;<span class="num" id="1837800">2</span>&nbsp;<span class="op" id="1837802">-</span>&nbsp;<span class="ident" id="1837804">r</span><span class="op" id="1837805">/</span><span class="ident" id="1837806">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1837810">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1837814">return</span>&nbsp;<span class="ident" id="1837821">r</span>&nbsp;<span class="op" id="1837823">/</span>&nbsp;<span class="ident" id="1837825">x</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1837828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1837831">if</span>&nbsp;<span class="ident" id="1837834">sign</span>&nbsp;<span class="op" id="1837839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1837843">return</span>&nbsp;<span class="num" id="1837850">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1837853">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1837856">return</span>&nbsp;<span class="num" id="1837863">0</span><br>
<span class="lineno">335</span><span class="op" id="1837865">}</span>
</div>
</body>
</html>
