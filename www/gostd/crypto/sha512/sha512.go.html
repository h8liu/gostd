<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/sha512</h2>
<ul>
<li><a href="/gostd/crypto/sha512/sha512.go.html" class="current">sha512.go</a></li>
<li><a href="/gostd/crypto/sha512/sha512_test.go.html">sha512_test.go</a></li>
<li><a href="/gostd/crypto/sha512/sha512block_decl.go.html">sha512block_decl.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4184254">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4184309">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4184363">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4184414">//&nbsp;Package&nbsp;sha512&nbsp;implements&nbsp;the&nbsp;SHA384&nbsp;and&nbsp;SHA512&nbsp;hash&nbsp;algorithms&nbsp;as&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="4184492">//&nbsp;in&nbsp;FIPS&nbsp;180-2.</span><br>
<span class="lineno"></span><span class="keyword" id="4184510">package</span>&nbsp;<span class="ident" id="4184518">sha512</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4184526">import</span>&nbsp;<span class="op" id="4184533">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4184536">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4184546">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="4184553">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4184556">func</span>&nbsp;<span class="ident" id="4184561">init</span><span class="op" id="4184565">(</span><span class="op" id="4184566">)</span>&nbsp;<span class="op" id="4184568">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4184571">crypto</span><span class="op" id="4184577">.</span><span class="ident" id="4184578">RegisterHash</span><span class="op" id="4184590">(</span><span class="ident" id="4184591">crypto</span><span class="op" id="4184597">.</span><span class="ident" id="4184598">SHA384</span><span class="op" id="4184604">,</span>&nbsp;<span class="ident" id="4184606">New384</span><span class="op" id="4184612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4184615">crypto</span><span class="op" id="4184621">.</span><span class="ident" id="4184622">RegisterHash</span><span class="op" id="4184634">(</span><span class="ident" id="4184635">crypto</span><span class="op" id="4184641">.</span><span class="ident" id="4184642">SHA512</span><span class="op" id="4184648">,</span>&nbsp;<span class="ident" id="4184650">New</span><span class="op" id="4184653">)</span><br>
<span class="lineno"></span><span class="op" id="4184655">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4184658">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA512&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno">20</span><span class="keyword" id="4184701">const</span>&nbsp;<span class="ident" id="4184707">Size</span>&nbsp;<span class="op" id="4184712">=</span>&nbsp;<span class="num" id="4184714">64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4184718">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA384&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4184761">const</span>&nbsp;<span class="ident" id="4184767">Size384</span>&nbsp;<span class="op" id="4184775">=</span>&nbsp;<span class="num" id="4184777">48</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="4184781">//&nbsp;The&nbsp;blocksize&nbsp;of&nbsp;SHA512&nbsp;and&nbsp;SHA384&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4184829">const</span>&nbsp;<span class="ident" id="4184835">BlockSize</span>&nbsp;<span class="op" id="4184845">=</span>&nbsp;<span class="num" id="4184847">128</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4184852">const</span>&nbsp;<span class="op" id="4184858">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4184861">chunk</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4184871">=</span>&nbsp;<span class="num" id="4184873">128</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4184878">init0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4184888">=</span>&nbsp;<span class="num" id="4184890">0x6a09e667f3bcc908</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4184910">init1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4184920">=</span>&nbsp;<span class="num" id="4184922">0xbb67ae8584caa73b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4184942">init2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4184952">=</span>&nbsp;<span class="num" id="4184954">0x3c6ef372fe94f82b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4184974">init3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4184984">=</span>&nbsp;<span class="num" id="4184986">0xa54ff53a5f1d36f1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4185006">init4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4185016">=</span>&nbsp;<span class="num" id="4185018">0x510e527fade682d1</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4185038">init5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4185048">=</span>&nbsp;<span class="num" id="4185050">0x9b05688c2b3e6c1f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4185070">init6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4185080">=</span>&nbsp;<span class="num" id="4185082">0x1f83d9abfb41bd6b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4185102">init7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4185112">=</span>&nbsp;<span class="num" id="4185114">0x5be0cd19137e2179</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4185134">init0_384</span>&nbsp;<span class="op" id="4185144">=</span>&nbsp;<span class="num" id="4185146">0xcbbb9d5dc1059ed8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4185166">init1_384</span>&nbsp;<span class="op" id="4185176">=</span>&nbsp;<span class="num" id="4185178">0x629a292a367cd507</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4185198">init2_384</span>&nbsp;<span class="op" id="4185208">=</span>&nbsp;<span class="num" id="4185210">0x9159015a3070dd17</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4185230">init3_384</span>&nbsp;<span class="op" id="4185240">=</span>&nbsp;<span class="num" id="4185242">0x152fecd8f70e5939</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4185262">init4_384</span>&nbsp;<span class="op" id="4185272">=</span>&nbsp;<span class="num" id="4185274">0x67332667ffc00b31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4185294">init5_384</span>&nbsp;<span class="op" id="4185304">=</span>&nbsp;<span class="num" id="4185306">0x8eb44a8768581511</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4185326">init6_384</span>&nbsp;<span class="op" id="4185336">=</span>&nbsp;<span class="num" id="4185338">0xdb0c2e0d64f98fa7</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4185358">init7_384</span>&nbsp;<span class="op" id="4185368">=</span>&nbsp;<span class="num" id="4185370">0x47b5481dbefa4fa4</span><br>
<span class="lineno"></span><span class="op" id="4185389">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4185392">//&nbsp;digest&nbsp;represents&nbsp;the&nbsp;partial&nbsp;evaluation&nbsp;of&nbsp;a&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4185451">type</span>&nbsp;<span class="ident" id="4185456">digest</span>&nbsp;<span class="keyword" id="4185463">struct</span>&nbsp;<span class="op" id="4185470">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4185473">h</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4185479">[</span><span class="num" id="4185480">8</span><span class="op" id="4185481">]</span><span class="ident" id="4185482">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4185490">x</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4185496">[</span><span class="ident" id="4185497">chunk</span><span class="op" id="4185502">]</span><span class="builtintype" id="4185503">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4185509">nx</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4185515">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4185520">len</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4185526">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4185534">is384</span>&nbsp;<span class="builtintype" id="4185540">bool</span>&nbsp;<span class="comment" id="4185545">//&nbsp;mark&nbsp;if&nbsp;this&nbsp;digest&nbsp;is&nbsp;SHA-384</span><br>
<span class="lineno">55</span><span class="op" id="4185579">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4185582">func</span>&nbsp;<span class="op" id="4185587">(</span><span class="ident" id="4185588">d</span>&nbsp;<span class="op" id="4185590">*</span><span class="ident" id="4185591">digest</span><span class="op" id="4185597">)</span>&nbsp;<span class="ident" id="4185599">Reset</span><span class="op" id="4185604">(</span><span class="op" id="4185605">)</span>&nbsp;<span class="op" id="4185607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4185610">if</span>&nbsp;<span class="op" id="4185613">!</span><span class="ident" id="4185614">d</span><span class="op" id="4185615">.</span><span class="ident" id="4185616">is384</span>&nbsp;<span class="op" id="4185622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4185626">d</span><span class="op" id="4185627">.</span><span class="ident" id="4185628">h</span><span class="op" id="4185629">[</span><span class="num" id="4185630">0</span><span class="op" id="4185631">]</span>&nbsp;<span class="op" id="4185633">=</span>&nbsp;<span class="ident" id="4185635">init0</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4185643">d</span><span class="op" id="4185644">.</span><span class="ident" id="4185645">h</span><span class="op" id="4185646">[</span><span class="num" id="4185647">1</span><span class="op" id="4185648">]</span>&nbsp;<span class="op" id="4185650">=</span>&nbsp;<span class="ident" id="4185652">init1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4185660">d</span><span class="op" id="4185661">.</span><span class="ident" id="4185662">h</span><span class="op" id="4185663">[</span><span class="num" id="4185664">2</span><span class="op" id="4185665">]</span>&nbsp;<span class="op" id="4185667">=</span>&nbsp;<span class="ident" id="4185669">init2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4185677">d</span><span class="op" id="4185678">.</span><span class="ident" id="4185679">h</span><span class="op" id="4185680">[</span><span class="num" id="4185681">3</span><span class="op" id="4185682">]</span>&nbsp;<span class="op" id="4185684">=</span>&nbsp;<span class="ident" id="4185686">init3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4185694">d</span><span class="op" id="4185695">.</span><span class="ident" id="4185696">h</span><span class="op" id="4185697">[</span><span class="num" id="4185698">4</span><span class="op" id="4185699">]</span>&nbsp;<span class="op" id="4185701">=</span>&nbsp;<span class="ident" id="4185703">init4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4185711">d</span><span class="op" id="4185712">.</span><span class="ident" id="4185713">h</span><span class="op" id="4185714">[</span><span class="num" id="4185715">5</span><span class="op" id="4185716">]</span>&nbsp;<span class="op" id="4185718">=</span>&nbsp;<span class="ident" id="4185720">init5</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4185728">d</span><span class="op" id="4185729">.</span><span class="ident" id="4185730">h</span><span class="op" id="4185731">[</span><span class="num" id="4185732">6</span><span class="op" id="4185733">]</span>&nbsp;<span class="op" id="4185735">=</span>&nbsp;<span class="ident" id="4185737">init6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4185745">d</span><span class="op" id="4185746">.</span><span class="ident" id="4185747">h</span><span class="op" id="4185748">[</span><span class="num" id="4185749">7</span><span class="op" id="4185750">]</span>&nbsp;<span class="op" id="4185752">=</span>&nbsp;<span class="ident" id="4185754">init7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4185761">}</span>&nbsp;<span class="keyword" id="4185763">else</span>&nbsp;<span class="op" id="4185768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4185772">d</span><span class="op" id="4185773">.</span><span class="ident" id="4185774">h</span><span class="op" id="4185775">[</span><span class="num" id="4185776">0</span><span class="op" id="4185777">]</span>&nbsp;<span class="op" id="4185779">=</span>&nbsp;<span class="ident" id="4185781">init0_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4185793">d</span><span class="op" id="4185794">.</span><span class="ident" id="4185795">h</span><span class="op" id="4185796">[</span><span class="num" id="4185797">1</span><span class="op" id="4185798">]</span>&nbsp;<span class="op" id="4185800">=</span>&nbsp;<span class="ident" id="4185802">init1_384</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4185814">d</span><span class="op" id="4185815">.</span><span class="ident" id="4185816">h</span><span class="op" id="4185817">[</span><span class="num" id="4185818">2</span><span class="op" id="4185819">]</span>&nbsp;<span class="op" id="4185821">=</span>&nbsp;<span class="ident" id="4185823">init2_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4185835">d</span><span class="op" id="4185836">.</span><span class="ident" id="4185837">h</span><span class="op" id="4185838">[</span><span class="num" id="4185839">3</span><span class="op" id="4185840">]</span>&nbsp;<span class="op" id="4185842">=</span>&nbsp;<span class="ident" id="4185844">init3_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4185856">d</span><span class="op" id="4185857">.</span><span class="ident" id="4185858">h</span><span class="op" id="4185859">[</span><span class="num" id="4185860">4</span><span class="op" id="4185861">]</span>&nbsp;<span class="op" id="4185863">=</span>&nbsp;<span class="ident" id="4185865">init4_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4185877">d</span><span class="op" id="4185878">.</span><span class="ident" id="4185879">h</span><span class="op" id="4185880">[</span><span class="num" id="4185881">5</span><span class="op" id="4185882">]</span>&nbsp;<span class="op" id="4185884">=</span>&nbsp;<span class="ident" id="4185886">init5_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4185898">d</span><span class="op" id="4185899">.</span><span class="ident" id="4185900">h</span><span class="op" id="4185901">[</span><span class="num" id="4185902">6</span><span class="op" id="4185903">]</span>&nbsp;<span class="op" id="4185905">=</span>&nbsp;<span class="ident" id="4185907">init6_384</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4185919">d</span><span class="op" id="4185920">.</span><span class="ident" id="4185921">h</span><span class="op" id="4185922">[</span><span class="num" id="4185923">7</span><span class="op" id="4185924">]</span>&nbsp;<span class="op" id="4185926">=</span>&nbsp;<span class="ident" id="4185928">init7_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4185939">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4185942">d</span><span class="op" id="4185943">.</span><span class="ident" id="4185944">nx</span>&nbsp;<span class="op" id="4185947">=</span>&nbsp;<span class="num" id="4185949">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4185952">d</span><span class="op" id="4185953">.</span><span class="builtinfunc" id="4185954">len</span>&nbsp;<span class="op" id="4185958">=</span>&nbsp;<span class="num" id="4185960">0</span><br>
<span class="lineno"></span><span class="op" id="4185962">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="4185965">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA512&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4186027">func</span>&nbsp;<span class="ident" id="4186032">New</span><span class="op" id="4186035">(</span><span class="op" id="4186036">)</span>&nbsp;<span class="ident" id="4186038">hash</span><span class="op" id="4186042">.</span><span class="ident" id="4186043">Hash</span>&nbsp;<span class="op" id="4186048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4186051">d</span>&nbsp;<span class="op" id="4186053">:=</span>&nbsp;<span class="builtinfunc" id="4186056">new</span><span class="op" id="4186059">(</span><span class="ident" id="4186060">digest</span><span class="op" id="4186066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4186069">d</span><span class="op" id="4186070">.</span><span class="ident" id="4186071">Reset</span><span class="op" id="4186076">(</span><span class="op" id="4186077">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4186080">return</span>&nbsp;<span class="ident" id="4186087">d</span><br>
<span class="lineno"></span><span class="op" id="4186089">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4186092">//&nbsp;New384&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA384&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4186157">func</span>&nbsp;<span class="ident" id="4186162">New384</span><span class="op" id="4186168">(</span><span class="op" id="4186169">)</span>&nbsp;<span class="ident" id="4186171">hash</span><span class="op" id="4186175">.</span><span class="ident" id="4186176">Hash</span>&nbsp;<span class="op" id="4186181">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4186184">d</span>&nbsp;<span class="op" id="4186186">:=</span>&nbsp;<span class="builtinfunc" id="4186189">new</span><span class="op" id="4186192">(</span><span class="ident" id="4186193">digest</span><span class="op" id="4186199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4186202">d</span><span class="op" id="4186203">.</span><span class="ident" id="4186204">is384</span>&nbsp;<span class="op" id="4186210">=</span>&nbsp;<span class="builtintype" id="4186212">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4186218">d</span><span class="op" id="4186219">.</span><span class="ident" id="4186220">Reset</span><span class="op" id="4186225">(</span><span class="op" id="4186226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4186229">return</span>&nbsp;<span class="ident" id="4186236">d</span><br>
<span class="lineno"></span><span class="op" id="4186238">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="4186241">func</span>&nbsp;<span class="op" id="4186246">(</span><span class="ident" id="4186247">d</span>&nbsp;<span class="op" id="4186249">*</span><span class="ident" id="4186250">digest</span><span class="op" id="4186256">)</span>&nbsp;<span class="ident" id="4186258">Size</span><span class="op" id="4186262">(</span><span class="op" id="4186263">)</span>&nbsp;<span class="builtintype" id="4186265">int</span>&nbsp;<span class="op" id="4186269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4186272">if</span>&nbsp;<span class="op" id="4186275">!</span><span class="ident" id="4186276">d</span><span class="op" id="4186277">.</span><span class="ident" id="4186278">is384</span>&nbsp;<span class="op" id="4186284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4186288">return</span>&nbsp;<span class="ident" id="4186295">Size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4186301">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4186304">return</span>&nbsp;<span class="ident" id="4186311">Size384</span><br>
<span class="lineno"></span><span class="op" id="4186319">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4186322">func</span>&nbsp;<span class="op" id="4186327">(</span><span class="ident" id="4186328">d</span>&nbsp;<span class="op" id="4186330">*</span><span class="ident" id="4186331">digest</span><span class="op" id="4186337">)</span>&nbsp;<span class="ident" id="4186339">BlockSize</span><span class="op" id="4186348">(</span><span class="op" id="4186349">)</span>&nbsp;<span class="builtintype" id="4186351">int</span>&nbsp;<span class="op" id="4186355">{</span>&nbsp;<span class="keyword" id="4186357">return</span>&nbsp;<span class="ident" id="4186364">BlockSize</span>&nbsp;<span class="op" id="4186374">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="keyword" id="4186377">func</span>&nbsp;<span class="op" id="4186382">(</span><span class="ident" id="4186383">d</span>&nbsp;<span class="op" id="4186385">*</span><span class="ident" id="4186386">digest</span><span class="op" id="4186392">)</span>&nbsp;<span class="ident" id="4186394">Write</span><span class="op" id="4186399">(</span><span class="ident" id="4186400">p</span>&nbsp;<span class="op" id="4186402">[</span><span class="op" id="4186403">]</span><span class="builtintype" id="4186404">byte</span><span class="op" id="4186408">)</span>&nbsp;<span class="op" id="4186410">(</span><span class="ident" id="4186411">nn</span>&nbsp;<span class="builtintype" id="4186414">int</span><span class="op" id="4186417">,</span>&nbsp;<span class="ident" id="4186419">err</span>&nbsp;<span class="builtintype" id="4186423">error</span><span class="op" id="4186428">)</span>&nbsp;<span class="op" id="4186430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4186433">nn</span>&nbsp;<span class="op" id="4186436">=</span>&nbsp;<span class="builtinfunc" id="4186438">len</span><span class="op" id="4186441">(</span><span class="ident" id="4186442">p</span><span class="op" id="4186443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4186446">d</span><span class="op" id="4186447">.</span><span class="builtinfunc" id="4186448">len</span>&nbsp;<span class="op" id="4186452">+=</span>&nbsp;<span class="ident" id="4186455">uint64</span><span class="op" id="4186461">(</span><span class="ident" id="4186462">nn</span><span class="op" id="4186464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4186467">if</span>&nbsp;<span class="ident" id="4186470">d</span><span class="op" id="4186471">.</span><span class="ident" id="4186472">nx</span>&nbsp;<span class="op" id="4186475">&gt;</span>&nbsp;<span class="num" id="4186477">0</span>&nbsp;<span class="op" id="4186479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4186483">n</span>&nbsp;<span class="op" id="4186485">:=</span>&nbsp;<span class="builtinfunc" id="4186488">copy</span><span class="op" id="4186492">(</span><span class="ident" id="4186493">d</span><span class="op" id="4186494">.</span><span class="ident" id="4186495">x</span><span class="op" id="4186496">[</span><span class="ident" id="4186497">d</span><span class="op" id="4186498">.</span><span class="ident" id="4186499">nx</span><span class="op" id="4186501">:</span><span class="op" id="4186502">]</span><span class="op" id="4186503">,</span>&nbsp;<span class="ident" id="4186505">p</span><span class="op" id="4186506">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4186510">d</span><span class="op" id="4186511">.</span><span class="ident" id="4186512">nx</span>&nbsp;<span class="op" id="4186515">+=</span>&nbsp;<span class="ident" id="4186518">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4186522">if</span>&nbsp;<span class="ident" id="4186525">d</span><span class="op" id="4186526">.</span><span class="ident" id="4186527">nx</span>&nbsp;<span class="op" id="4186530">==</span>&nbsp;<span class="ident" id="4186533">chunk</span>&nbsp;<span class="op" id="4186539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4186544">block</span><span class="op" id="4186549">(</span><span class="ident" id="4186550">d</span><span class="op" id="4186551">,</span>&nbsp;<span class="ident" id="4186553">d</span><span class="op" id="4186554">.</span><span class="ident" id="4186555">x</span><span class="op" id="4186556">[</span><span class="op" id="4186557">:</span><span class="op" id="4186558">]</span><span class="op" id="4186559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4186564">d</span><span class="op" id="4186565">.</span><span class="ident" id="4186566">nx</span>&nbsp;<span class="op" id="4186569">=</span>&nbsp;<span class="num" id="4186571">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4186575">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4186579">p</span>&nbsp;<span class="op" id="4186581">=</span>&nbsp;<span class="ident" id="4186583">p</span><span class="op" id="4186584">[</span><span class="ident" id="4186585">n</span><span class="op" id="4186586">:</span><span class="op" id="4186587">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4186590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4186593">if</span>&nbsp;<span class="builtinfunc" id="4186596">len</span><span class="op" id="4186599">(</span><span class="ident" id="4186600">p</span><span class="op" id="4186601">)</span>&nbsp;<span class="op" id="4186603">&gt;=</span>&nbsp;<span class="ident" id="4186606">chunk</span>&nbsp;<span class="op" id="4186612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4186616">n</span>&nbsp;<span class="op" id="4186618">:=</span>&nbsp;<span class="builtinfunc" id="4186621">len</span><span class="op" id="4186624">(</span><span class="ident" id="4186625">p</span><span class="op" id="4186626">)</span>&nbsp;<span class="op" id="4186628">&amp;^</span>&nbsp;<span class="op" id="4186631">(</span><span class="ident" id="4186632">chunk</span>&nbsp;<span class="op" id="4186638">-</span>&nbsp;<span class="num" id="4186640">1</span><span class="op" id="4186641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4186645">block</span><span class="op" id="4186650">(</span><span class="ident" id="4186651">d</span><span class="op" id="4186652">,</span>&nbsp;<span class="ident" id="4186654">p</span><span class="op" id="4186655">[</span><span class="op" id="4186656">:</span><span class="ident" id="4186657">n</span><span class="op" id="4186658">]</span><span class="op" id="4186659">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4186663">p</span>&nbsp;<span class="op" id="4186665">=</span>&nbsp;<span class="ident" id="4186667">p</span><span class="op" id="4186668">[</span><span class="ident" id="4186669">n</span><span class="op" id="4186670">:</span><span class="op" id="4186671">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4186674">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4186677">if</span>&nbsp;<span class="builtinfunc" id="4186680">len</span><span class="op" id="4186683">(</span><span class="ident" id="4186684">p</span><span class="op" id="4186685">)</span>&nbsp;<span class="op" id="4186687">&gt;</span>&nbsp;<span class="num" id="4186689">0</span>&nbsp;<span class="op" id="4186691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4186695">d</span><span class="op" id="4186696">.</span><span class="ident" id="4186697">nx</span>&nbsp;<span class="op" id="4186700">=</span>&nbsp;<span class="builtinfunc" id="4186702">copy</span><span class="op" id="4186706">(</span><span class="ident" id="4186707">d</span><span class="op" id="4186708">.</span><span class="ident" id="4186709">x</span><span class="op" id="4186710">[</span><span class="op" id="4186711">:</span><span class="op" id="4186712">]</span><span class="op" id="4186713">,</span>&nbsp;<span class="ident" id="4186715">p</span><span class="op" id="4186716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4186719">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4186722">return</span><br>
<span class="lineno"></span><span class="op" id="4186729">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4186732">func</span>&nbsp;<span class="op" id="4186737">(</span><span class="ident" id="4186738">d0</span>&nbsp;<span class="op" id="4186741">*</span><span class="ident" id="4186742">digest</span><span class="op" id="4186748">)</span>&nbsp;<span class="ident" id="4186750">Sum</span><span class="op" id="4186753">(</span><span class="ident" id="4186754">in</span>&nbsp;<span class="op" id="4186757">[</span><span class="op" id="4186758">]</span><span class="builtintype" id="4186759">byte</span><span class="op" id="4186763">)</span>&nbsp;<span class="op" id="4186765">[</span><span class="op" id="4186766">]</span><span class="builtintype" id="4186767">byte</span>&nbsp;<span class="op" id="4186772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4186775">//&nbsp;Make&nbsp;a&nbsp;copy&nbsp;of&nbsp;d0&nbsp;so&nbsp;that&nbsp;caller&nbsp;can&nbsp;keep&nbsp;writing&nbsp;and&nbsp;summing.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4186842">d</span>&nbsp;<span class="op" id="4186844">:=</span>&nbsp;<span class="builtinfunc" id="4186847">new</span><span class="op" id="4186850">(</span><span class="ident" id="4186851">digest</span><span class="op" id="4186857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4186860">*</span><span class="ident" id="4186861">d</span>&nbsp;<span class="op" id="4186863">=</span>&nbsp;<span class="op" id="4186865">*</span><span class="ident" id="4186866">d0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4186870">hash</span>&nbsp;<span class="op" id="4186875">:=</span>&nbsp;<span class="ident" id="4186878">d</span><span class="op" id="4186879">.</span><span class="ident" id="4186880">checkSum</span><span class="op" id="4186888">(</span><span class="op" id="4186889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4186892">if</span>&nbsp;<span class="ident" id="4186895">d</span><span class="op" id="4186896">.</span><span class="ident" id="4186897">is384</span>&nbsp;<span class="op" id="4186903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4186907">return</span>&nbsp;<span class="builtinfunc" id="4186914">append</span><span class="op" id="4186920">(</span><span class="ident" id="4186921">in</span><span class="op" id="4186923">,</span>&nbsp;<span class="ident" id="4186925">hash</span><span class="op" id="4186929">[</span><span class="op" id="4186930">:</span><span class="ident" id="4186931">Size384</span><span class="op" id="4186938">]</span><span class="op" id="4186939">...</span><span class="op" id="4186942">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4186945">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4186948">return</span>&nbsp;<span class="builtinfunc" id="4186955">append</span><span class="op" id="4186961">(</span><span class="ident" id="4186962">in</span><span class="op" id="4186964">,</span>&nbsp;<span class="ident" id="4186966">hash</span><span class="op" id="4186970">[</span><span class="op" id="4186971">:</span><span class="op" id="4186972">]</span><span class="op" id="4186973">...</span><span class="op" id="4186976">)</span><br>
<span class="lineno"></span><span class="op" id="4186978">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4186981">func</span>&nbsp;<span class="op" id="4186986">(</span><span class="ident" id="4186987">d</span>&nbsp;<span class="op" id="4186989">*</span><span class="ident" id="4186990">digest</span><span class="op" id="4186996">)</span>&nbsp;<span class="ident" id="4186998">checkSum</span><span class="op" id="4187006">(</span><span class="op" id="4187007">)</span>&nbsp;<span class="op" id="4187009">[</span><span class="ident" id="4187010">Size</span><span class="op" id="4187014">]</span><span class="builtintype" id="4187015">byte</span>&nbsp;<span class="op" id="4187020">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4187023">//&nbsp;Padding.&nbsp;&nbsp;Add&nbsp;a&nbsp;1&nbsp;bit&nbsp;and&nbsp;0&nbsp;bits&nbsp;until&nbsp;112&nbsp;bytes&nbsp;mod&nbsp;128.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4187085">len</span>&nbsp;<span class="op" id="4187089">:=</span>&nbsp;<span class="ident" id="4187092">d</span><span class="op" id="4187093">.</span><span class="builtinfunc" id="4187094">len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4187099">var</span>&nbsp;<span class="ident" id="4187103">tmp</span>&nbsp;<span class="op" id="4187107">[</span><span class="num" id="4187108">128</span><span class="op" id="4187111">]</span><span class="builtintype" id="4187112">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4187118">tmp</span><span class="op" id="4187121">[</span><span class="num" id="4187122">0</span><span class="op" id="4187123">]</span>&nbsp;<span class="op" id="4187125">=</span>&nbsp;<span class="num" id="4187127">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4187133">if</span>&nbsp;<span class="builtinfunc" id="4187136">len</span><span class="op" id="4187139">%</span><span class="num" id="4187140">128</span>&nbsp;<span class="op" id="4187144">&lt;</span>&nbsp;<span class="num" id="4187146">112</span>&nbsp;<span class="op" id="4187150">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4187154">d</span><span class="op" id="4187155">.</span><span class="ident" id="4187156">Write</span><span class="op" id="4187161">(</span><span class="ident" id="4187162">tmp</span><span class="op" id="4187165">[</span><span class="num" id="4187166">0</span>&nbsp;<span class="op" id="4187168">:</span>&nbsp;<span class="num" id="4187170">112</span><span class="op" id="4187173">-</span><span class="builtinfunc" id="4187174">len</span><span class="op" id="4187177">%</span><span class="num" id="4187178">128</span><span class="op" id="4187181">]</span><span class="op" id="4187182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4187185">}</span>&nbsp;<span class="keyword" id="4187187">else</span>&nbsp;<span class="op" id="4187192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4187196">d</span><span class="op" id="4187197">.</span><span class="ident" id="4187198">Write</span><span class="op" id="4187203">(</span><span class="ident" id="4187204">tmp</span><span class="op" id="4187207">[</span><span class="num" id="4187208">0</span>&nbsp;<span class="op" id="4187210">:</span>&nbsp;<span class="num" id="4187212">128</span><span class="op" id="4187215">+</span><span class="num" id="4187216">112</span><span class="op" id="4187219">-</span><span class="builtinfunc" id="4187220">len</span><span class="op" id="4187223">%</span><span class="num" id="4187224">128</span><span class="op" id="4187227">]</span><span class="op" id="4187228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4187231">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4187235">//&nbsp;Length&nbsp;in&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4187255">len</span>&nbsp;<span class="op" id="4187259">&lt;&lt;=</span>&nbsp;<span class="num" id="4187263">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4187266">for</span>&nbsp;<span class="ident" id="4187270">i</span>&nbsp;<span class="op" id="4187272">:=</span>&nbsp;<span class="builtintype" id="4187275">uint</span><span class="op" id="4187279">(</span><span class="num" id="4187280">0</span><span class="op" id="4187281">)</span><span class="op" id="4187282">;</span>&nbsp;<span class="ident" id="4187284">i</span>&nbsp;<span class="op" id="4187286">&lt;</span>&nbsp;<span class="num" id="4187288">16</span><span class="op" id="4187290">;</span>&nbsp;<span class="ident" id="4187292">i</span><span class="op" id="4187293">++</span>&nbsp;<span class="op" id="4187296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4187300">tmp</span><span class="op" id="4187303">[</span><span class="ident" id="4187304">i</span><span class="op" id="4187305">]</span>&nbsp;<span class="op" id="4187307">=</span>&nbsp;<span class="builtintype" id="4187309">byte</span><span class="op" id="4187313">(</span><span class="builtinfunc" id="4187314">len</span>&nbsp;<span class="op" id="4187318">&gt;&gt;</span>&nbsp;<span class="op" id="4187321">(</span><span class="num" id="4187322">120</span>&nbsp;<span class="op" id="4187326">-</span>&nbsp;<span class="num" id="4187328">8</span><span class="op" id="4187329">*</span><span class="ident" id="4187330">i</span><span class="op" id="4187331">)</span><span class="op" id="4187332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4187335">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4187338">d</span><span class="op" id="4187339">.</span><span class="ident" id="4187340">Write</span><span class="op" id="4187345">(</span><span class="ident" id="4187346">tmp</span><span class="op" id="4187349">[</span><span class="num" id="4187350">0</span><span class="op" id="4187351">:</span><span class="num" id="4187352">16</span><span class="op" id="4187354">]</span><span class="op" id="4187355">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4187359">if</span>&nbsp;<span class="ident" id="4187362">d</span><span class="op" id="4187363">.</span><span class="ident" id="4187364">nx</span>&nbsp;<span class="op" id="4187367">!=</span>&nbsp;<span class="num" id="4187370">0</span>&nbsp;<span class="op" id="4187372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4187376">panic</span><span class="op" id="4187381">(</span><span class="string" id="4187382">&#34;d.nx&nbsp;!=&nbsp;0&#34;</span><span class="op" id="4187393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4187396">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4187400">h</span>&nbsp;<span class="op" id="4187402">:=</span>&nbsp;<span class="ident" id="4187405">d</span><span class="op" id="4187406">.</span><span class="ident" id="4187407">h</span><span class="op" id="4187408">[</span><span class="op" id="4187409">:</span><span class="op" id="4187410">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4187413">if</span>&nbsp;<span class="ident" id="4187416">d</span><span class="op" id="4187417">.</span><span class="ident" id="4187418">is384</span>&nbsp;<span class="op" id="4187424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4187428">h</span>&nbsp;<span class="op" id="4187430">=</span>&nbsp;<span class="ident" id="4187432">d</span><span class="op" id="4187433">.</span><span class="ident" id="4187434">h</span><span class="op" id="4187435">[</span><span class="op" id="4187436">:</span><span class="num" id="4187437">6</span><span class="op" id="4187438">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4187441">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4187445">var</span>&nbsp;<span class="ident" id="4187449">digest</span>&nbsp;<span class="op" id="4187456">[</span><span class="ident" id="4187457">Size</span><span class="op" id="4187461">]</span><span class="builtintype" id="4187462">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4187468">for</span>&nbsp;<span class="ident" id="4187472">i</span><span class="op" id="4187473">,</span>&nbsp;<span class="ident" id="4187475">s</span>&nbsp;<span class="op" id="4187477">:=</span>&nbsp;<span class="keyword" id="4187480">range</span>&nbsp;<span class="ident" id="4187486">h</span>&nbsp;<span class="op" id="4187488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4187492">digest</span><span class="op" id="4187498">[</span><span class="ident" id="4187499">i</span><span class="op" id="4187500">*</span><span class="num" id="4187501">8</span><span class="op" id="4187502">]</span>&nbsp;<span class="op" id="4187504">=</span>&nbsp;<span class="builtintype" id="4187506">byte</span><span class="op" id="4187510">(</span><span class="ident" id="4187511">s</span>&nbsp;<span class="op" id="4187513">&gt;&gt;</span>&nbsp;<span class="num" id="4187516">56</span><span class="op" id="4187518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4187522">digest</span><span class="op" id="4187528">[</span><span class="ident" id="4187529">i</span><span class="op" id="4187530">*</span><span class="num" id="4187531">8</span><span class="op" id="4187532">+</span><span class="num" id="4187533">1</span><span class="op" id="4187534">]</span>&nbsp;<span class="op" id="4187536">=</span>&nbsp;<span class="builtintype" id="4187538">byte</span><span class="op" id="4187542">(</span><span class="ident" id="4187543">s</span>&nbsp;<span class="op" id="4187545">&gt;&gt;</span>&nbsp;<span class="num" id="4187548">48</span><span class="op" id="4187550">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4187554">digest</span><span class="op" id="4187560">[</span><span class="ident" id="4187561">i</span><span class="op" id="4187562">*</span><span class="num" id="4187563">8</span><span class="op" id="4187564">+</span><span class="num" id="4187565">2</span><span class="op" id="4187566">]</span>&nbsp;<span class="op" id="4187568">=</span>&nbsp;<span class="builtintype" id="4187570">byte</span><span class="op" id="4187574">(</span><span class="ident" id="4187575">s</span>&nbsp;<span class="op" id="4187577">&gt;&gt;</span>&nbsp;<span class="num" id="4187580">40</span><span class="op" id="4187582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4187586">digest</span><span class="op" id="4187592">[</span><span class="ident" id="4187593">i</span><span class="op" id="4187594">*</span><span class="num" id="4187595">8</span><span class="op" id="4187596">+</span><span class="num" id="4187597">3</span><span class="op" id="4187598">]</span>&nbsp;<span class="op" id="4187600">=</span>&nbsp;<span class="builtintype" id="4187602">byte</span><span class="op" id="4187606">(</span><span class="ident" id="4187607">s</span>&nbsp;<span class="op" id="4187609">&gt;&gt;</span>&nbsp;<span class="num" id="4187612">32</span><span class="op" id="4187614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4187618">digest</span><span class="op" id="4187624">[</span><span class="ident" id="4187625">i</span><span class="op" id="4187626">*</span><span class="num" id="4187627">8</span><span class="op" id="4187628">+</span><span class="num" id="4187629">4</span><span class="op" id="4187630">]</span>&nbsp;<span class="op" id="4187632">=</span>&nbsp;<span class="builtintype" id="4187634">byte</span><span class="op" id="4187638">(</span><span class="ident" id="4187639">s</span>&nbsp;<span class="op" id="4187641">&gt;&gt;</span>&nbsp;<span class="num" id="4187644">24</span><span class="op" id="4187646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4187650">digest</span><span class="op" id="4187656">[</span><span class="ident" id="4187657">i</span><span class="op" id="4187658">*</span><span class="num" id="4187659">8</span><span class="op" id="4187660">+</span><span class="num" id="4187661">5</span><span class="op" id="4187662">]</span>&nbsp;<span class="op" id="4187664">=</span>&nbsp;<span class="builtintype" id="4187666">byte</span><span class="op" id="4187670">(</span><span class="ident" id="4187671">s</span>&nbsp;<span class="op" id="4187673">&gt;&gt;</span>&nbsp;<span class="num" id="4187676">16</span><span class="op" id="4187678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4187682">digest</span><span class="op" id="4187688">[</span><span class="ident" id="4187689">i</span><span class="op" id="4187690">*</span><span class="num" id="4187691">8</span><span class="op" id="4187692">+</span><span class="num" id="4187693">6</span><span class="op" id="4187694">]</span>&nbsp;<span class="op" id="4187696">=</span>&nbsp;<span class="builtintype" id="4187698">byte</span><span class="op" id="4187702">(</span><span class="ident" id="4187703">s</span>&nbsp;<span class="op" id="4187705">&gt;&gt;</span>&nbsp;<span class="num" id="4187708">8</span><span class="op" id="4187709">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4187713">digest</span><span class="op" id="4187719">[</span><span class="ident" id="4187720">i</span><span class="op" id="4187721">*</span><span class="num" id="4187722">8</span><span class="op" id="4187723">+</span><span class="num" id="4187724">7</span><span class="op" id="4187725">]</span>&nbsp;<span class="op" id="4187727">=</span>&nbsp;<span class="builtintype" id="4187729">byte</span><span class="op" id="4187733">(</span><span class="ident" id="4187734">s</span><span class="op" id="4187735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4187738">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4187742">return</span>&nbsp;<span class="ident" id="4187749">digest</span><br>
<span class="lineno"></span><span class="op" id="4187756">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="comment" id="4187759">//&nbsp;Sum512&nbsp;returns&nbsp;the&nbsp;SHA512&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4187810">func</span>&nbsp;<span class="ident" id="4187815">Sum512</span><span class="op" id="4187821">(</span><span class="ident" id="4187822">data</span>&nbsp;<span class="op" id="4187827">[</span><span class="op" id="4187828">]</span><span class="builtintype" id="4187829">byte</span><span class="op" id="4187833">)</span>&nbsp;<span class="op" id="4187835">[</span><span class="ident" id="4187836">Size</span><span class="op" id="4187840">]</span><span class="builtintype" id="4187841">byte</span>&nbsp;<span class="op" id="4187846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4187849">var</span>&nbsp;<span class="ident" id="4187853">d</span>&nbsp;<span class="ident" id="4187855">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4187863">d</span><span class="op" id="4187864">.</span><span class="ident" id="4187865">Reset</span><span class="op" id="4187870">(</span><span class="op" id="4187871">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4187874">d</span><span class="op" id="4187875">.</span><span class="ident" id="4187876">Write</span><span class="op" id="4187881">(</span><span class="ident" id="4187882">data</span><span class="op" id="4187886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4187889">return</span>&nbsp;<span class="ident" id="4187896">d</span><span class="op" id="4187897">.</span><span class="ident" id="4187898">checkSum</span><span class="op" id="4187906">(</span><span class="op" id="4187907">)</span><br>
<span class="lineno"></span><span class="op" id="4187909">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4187912">//&nbsp;Sum384&nbsp;returns&nbsp;the&nbsp;SHA384&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno">190</span><span class="keyword" id="4187963">func</span>&nbsp;<span class="ident" id="4187968">Sum384</span><span class="op" id="4187974">(</span><span class="ident" id="4187975">data</span>&nbsp;<span class="op" id="4187980">[</span><span class="op" id="4187981">]</span><span class="builtintype" id="4187982">byte</span><span class="op" id="4187986">)</span>&nbsp;<span class="op" id="4187988">(</span><span class="ident" id="4187989">sum384</span>&nbsp;<span class="op" id="4187996">[</span><span class="ident" id="4187997">Size384</span><span class="op" id="4188004">]</span><span class="builtintype" id="4188005">byte</span><span class="op" id="4188009">)</span>&nbsp;<span class="op" id="4188011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4188014">var</span>&nbsp;<span class="ident" id="4188018">d</span>&nbsp;<span class="ident" id="4188020">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4188028">d</span><span class="op" id="4188029">.</span><span class="ident" id="4188030">is384</span>&nbsp;<span class="op" id="4188036">=</span>&nbsp;<span class="builtintype" id="4188038">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4188044">d</span><span class="op" id="4188045">.</span><span class="ident" id="4188046">Reset</span><span class="op" id="4188051">(</span><span class="op" id="4188052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4188055">d</span><span class="op" id="4188056">.</span><span class="ident" id="4188057">Write</span><span class="op" id="4188062">(</span><span class="ident" id="4188063">data</span><span class="op" id="4188067">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4188070">sum</span>&nbsp;<span class="op" id="4188074">:=</span>&nbsp;<span class="ident" id="4188077">d</span><span class="op" id="4188078">.</span><span class="ident" id="4188079">checkSum</span><span class="op" id="4188087">(</span><span class="op" id="4188088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4188091">copy</span><span class="op" id="4188095">(</span><span class="ident" id="4188096">sum384</span><span class="op" id="4188102">[</span><span class="op" id="4188103">:</span><span class="op" id="4188104">]</span><span class="op" id="4188105">,</span>&nbsp;<span class="ident" id="4188107">sum</span><span class="op" id="4188110">[</span><span class="op" id="4188111">:</span><span class="ident" id="4188112">Size384</span><span class="op" id="4188119">]</span><span class="op" id="4188120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4188123">return</span><br>
<span class="lineno"></span><span class="op" id="4188130">}</span>
</div>
</body>
</html>
