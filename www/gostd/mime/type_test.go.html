<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>mime</h2>
<ul>
<li><a href="/gostd/mime/grammar.go.html">grammar.go</a></li>
<li><a href="/gostd/mime/mediatype.go.html">mediatype.go</a></li>
<li><a href="/gostd/mime/mediatype_test.go.html">mediatype_test.go</a></li>
<li><a href="/gostd/mime/type.go.html">type.go</a></li>
<li><a href="/gostd/mime/type_test.go.html">type_test.go</a></li>
<li><a href="/gostd/mime/type_unix.go.html">type_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7884002">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7884057">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7884111">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7884162">package</span>&nbsp;<span class="ident" id="7884170">mime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7884176">import</span>&nbsp;<span class="op" id="7884183">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7884186">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7884196">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="7884199">var</span>&nbsp;<span class="ident" id="7884203">typeTests</span>&nbsp;<span class="op" id="7884213">=</span>&nbsp;<span class="ident" id="7884215">initMimeForTests</span><span class="op" id="7884231">(</span><span class="op" id="7884232">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7884235">func</span>&nbsp;<span class="ident" id="7884240">TestTypeByExtension</span><span class="op" id="7884259">(</span><span class="ident" id="7884260">t</span>&nbsp;<span class="op" id="7884262">*</span><span class="ident" id="7884263">testing</span><span class="op" id="7884270">.</span><span class="ident" id="7884271">T</span><span class="op" id="7884272">)</span>&nbsp;<span class="op" id="7884274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7884277">for</span>&nbsp;<span class="ident" id="7884281">ext</span><span class="op" id="7884284">,</span>&nbsp;<span class="ident" id="7884286">want</span>&nbsp;<span class="op" id="7884291">:=</span>&nbsp;<span class="keyword" id="7884294">range</span>&nbsp;<span class="ident" id="7884300">typeTests</span>&nbsp;<span class="op" id="7884310">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7884314">val</span>&nbsp;<span class="op" id="7884318">:=</span>&nbsp;<span class="ident" id="7884321">TypeByExtension</span><span class="op" id="7884336">(</span><span class="ident" id="7884337">ext</span><span class="op" id="7884340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7884344">if</span>&nbsp;<span class="ident" id="7884347">val</span>&nbsp;<span class="op" id="7884351">!=</span>&nbsp;<span class="ident" id="7884354">want</span>&nbsp;<span class="op" id="7884359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7884364">t</span><span class="op" id="7884365">.</span><span class="ident" id="7884366">Errorf</span><span class="op" id="7884372">(</span><span class="string" id="7884373">&#34;TypeByExtension(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7884408">,</span>&nbsp;<span class="ident" id="7884410">ext</span><span class="op" id="7884413">,</span>&nbsp;<span class="ident" id="7884415">val</span><span class="op" id="7884418">,</span>&nbsp;<span class="ident" id="7884420">want</span><span class="op" id="7884424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7884428">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7884431">}</span><br>
<span class="lineno">20</span><span class="op" id="7884433">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7884436">func</span>&nbsp;<span class="ident" id="7884441">TestTypeByExtensionCase</span><span class="op" id="7884464">(</span><span class="ident" id="7884465">t</span>&nbsp;<span class="op" id="7884467">*</span><span class="ident" id="7884468">testing</span><span class="op" id="7884475">.</span><span class="ident" id="7884476">T</span><span class="op" id="7884477">)</span>&nbsp;<span class="op" id="7884479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7884482">const</span>&nbsp;<span class="ident" id="7884488">custom</span>&nbsp;<span class="op" id="7884495">=</span>&nbsp;<span class="string" id="7884497">&#34;test/test;&nbsp;charset=iso-8859-1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7884530">const</span>&nbsp;<span class="ident" id="7884536">caps</span>&nbsp;<span class="op" id="7884541">=</span>&nbsp;<span class="string" id="7884543">&#34;test/test;&nbsp;WAS=ALLCAPS&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7884569">if</span>&nbsp;<span class="ident" id="7884572">err</span>&nbsp;<span class="op" id="7884576">:=</span>&nbsp;<span class="ident" id="7884579">AddExtensionType</span><span class="op" id="7884595">(</span><span class="string" id="7884596">&#34;.TEST&#34;</span><span class="op" id="7884603">,</span>&nbsp;<span class="ident" id="7884605">caps</span><span class="op" id="7884609">)</span><span class="op" id="7884610">;</span>&nbsp;<span class="ident" id="7884612">err</span>&nbsp;<span class="op" id="7884616">!=</span>&nbsp;<span class="ident" id="7884619">nil</span>&nbsp;<span class="op" id="7884623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7884627">t</span><span class="op" id="7884628">.</span><span class="ident" id="7884629">Fatalf</span><span class="op" id="7884635">(</span><span class="string" id="7884636">&#34;error&nbsp;%s&nbsp;for&nbsp;AddExtension(%s)&#34;</span><span class="op" id="7884667">,</span>&nbsp;<span class="ident" id="7884669">err</span><span class="op" id="7884672">,</span>&nbsp;<span class="ident" id="7884674">custom</span><span class="op" id="7884680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7884683">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7884686">if</span>&nbsp;<span class="ident" id="7884689">err</span>&nbsp;<span class="op" id="7884693">:=</span>&nbsp;<span class="ident" id="7884696">AddExtensionType</span><span class="op" id="7884712">(</span><span class="string" id="7884713">&#34;.tesT&#34;</span><span class="op" id="7884720">,</span>&nbsp;<span class="ident" id="7884722">custom</span><span class="op" id="7884728">)</span><span class="op" id="7884729">;</span>&nbsp;<span class="ident" id="7884731">err</span>&nbsp;<span class="op" id="7884735">!=</span>&nbsp;<span class="ident" id="7884738">nil</span>&nbsp;<span class="op" id="7884742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7884746">t</span><span class="op" id="7884747">.</span><span class="ident" id="7884748">Fatalf</span><span class="op" id="7884754">(</span><span class="string" id="7884755">&#34;error&nbsp;%s&nbsp;for&nbsp;AddExtension(%s)&#34;</span><span class="op" id="7884786">,</span>&nbsp;<span class="ident" id="7884788">err</span><span class="op" id="7884791">,</span>&nbsp;<span class="ident" id="7884793">custom</span><span class="op" id="7884799">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7884802">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7884806">//&nbsp;case-sensitive&nbsp;lookup</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7884832">if</span>&nbsp;<span class="ident" id="7884835">got</span>&nbsp;<span class="op" id="7884839">:=</span>&nbsp;<span class="ident" id="7884842">TypeByExtension</span><span class="op" id="7884857">(</span><span class="string" id="7884858">&#34;.tesT&#34;</span><span class="op" id="7884865">)</span><span class="op" id="7884866">;</span>&nbsp;<span class="ident" id="7884868">got</span>&nbsp;<span class="op" id="7884872">!=</span>&nbsp;<span class="ident" id="7884875">custom</span>&nbsp;<span class="op" id="7884882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7884886">t</span><span class="op" id="7884887">.</span><span class="ident" id="7884888">Fatalf</span><span class="op" id="7884894">(</span><span class="string" id="7884895">&#34;for&nbsp;.tesT,&nbsp;got&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7884923">,</span>&nbsp;<span class="ident" id="7884925">got</span><span class="op" id="7884928">,</span>&nbsp;<span class="ident" id="7884930">custom</span><span class="op" id="7884936">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7884939">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7884942">if</span>&nbsp;<span class="ident" id="7884945">got</span>&nbsp;<span class="op" id="7884949">:=</span>&nbsp;<span class="ident" id="7884952">TypeByExtension</span><span class="op" id="7884967">(</span><span class="string" id="7884968">&#34;.TEST&#34;</span><span class="op" id="7884975">)</span><span class="op" id="7884976">;</span>&nbsp;<span class="ident" id="7884978">got</span>&nbsp;<span class="op" id="7884982">!=</span>&nbsp;<span class="ident" id="7884985">caps</span>&nbsp;<span class="op" id="7884990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7884994">t</span><span class="op" id="7884995">.</span><span class="ident" id="7884996">Fatalf</span><span class="op" id="7885002">(</span><span class="string" id="7885003">&#34;for&nbsp;.TEST,&nbsp;got&nbsp;%q;&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7885031">,</span>&nbsp;<span class="ident" id="7885033">got</span><span class="op" id="7885036">,</span>&nbsp;<span class="ident" id="7885038">caps</span><span class="op" id="7885042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7885045">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7885049">//&nbsp;case-insensitive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7885070">if</span>&nbsp;<span class="ident" id="7885073">got</span>&nbsp;<span class="op" id="7885077">:=</span>&nbsp;<span class="ident" id="7885080">TypeByExtension</span><span class="op" id="7885095">(</span><span class="string" id="7885096">&#34;.TesT&#34;</span><span class="op" id="7885103">)</span><span class="op" id="7885104">;</span>&nbsp;<span class="ident" id="7885106">got</span>&nbsp;<span class="op" id="7885110">!=</span>&nbsp;<span class="ident" id="7885113">custom</span>&nbsp;<span class="op" id="7885120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7885124">t</span><span class="op" id="7885125">.</span><span class="ident" id="7885126">Fatalf</span><span class="op" id="7885132">(</span><span class="string" id="7885133">&#34;for&nbsp;.TesT,&nbsp;got&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7885161">,</span>&nbsp;<span class="ident" id="7885163">got</span><span class="op" id="7885166">,</span>&nbsp;<span class="ident" id="7885168">custom</span><span class="op" id="7885174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7885177">}</span><br>
<span class="lineno"></span><span class="op" id="7885179">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="7885182">func</span>&nbsp;<span class="ident" id="7885187">TestLookupMallocs</span><span class="op" id="7885204">(</span><span class="ident" id="7885205">t</span>&nbsp;<span class="op" id="7885207">*</span><span class="ident" id="7885208">testing</span><span class="op" id="7885215">.</span><span class="ident" id="7885216">T</span><span class="op" id="7885217">)</span>&nbsp;<span class="op" id="7885219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7885222">n</span>&nbsp;<span class="op" id="7885224">:=</span>&nbsp;<span class="ident" id="7885227">testing</span><span class="op" id="7885234">.</span><span class="ident" id="7885235">AllocsPerRun</span><span class="op" id="7885247">(</span><span class="num" id="7885248">10000</span><span class="op" id="7885253">,</span>&nbsp;<span class="keyword" id="7885255">func</span><span class="op" id="7885259">(</span><span class="op" id="7885260">)</span>&nbsp;<span class="op" id="7885262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7885266">TypeByExtension</span><span class="op" id="7885281">(</span><span class="string" id="7885282">&#34;.html&#34;</span><span class="op" id="7885289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7885293">TypeByExtension</span><span class="op" id="7885308">(</span><span class="string" id="7885309">&#34;.HtML&#34;</span><span class="op" id="7885316">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7885319">}</span><span class="op" id="7885320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7885323">if</span>&nbsp;<span class="ident" id="7885326">n</span>&nbsp;<span class="op" id="7885328">&gt;</span>&nbsp;<span class="num" id="7885330">0</span>&nbsp;<span class="op" id="7885332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7885336">t</span><span class="op" id="7885337">.</span><span class="ident" id="7885338">Errorf</span><span class="op" id="7885344">(</span><span class="string" id="7885345">&#34;allocs&nbsp;=&nbsp;%v;&nbsp;want&nbsp;0&#34;</span><span class="op" id="7885366">,</span>&nbsp;<span class="ident" id="7885368">n</span><span class="op" id="7885369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7885372">}</span><br>
<span class="lineno"></span><span class="op" id="7885374">}</span>
</div>
</body>
</html>
