<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3725069">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3725124">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3725178">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3725229">package</span>&nbsp;<span class="ident" id="3725237">mime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3725243">import</span>&nbsp;<span class="op" id="3725250">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3725253">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3725262">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3725272">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3725279">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3725287">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3725298">&#34;unicode&#34;</span><br>
<span class="lineno"></span><span class="op" id="3725308">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="3725311">//&nbsp;FormatMediaType&nbsp;serializes&nbsp;mediatype&nbsp;t&nbsp;and&nbsp;the&nbsp;parameters</span><br>
<span class="lineno"></span><span class="comment" id="3725372">//&nbsp;param&nbsp;as&nbsp;a&nbsp;media&nbsp;type&nbsp;conforming&nbsp;to&nbsp;RFC&nbsp;2045&nbsp;and&nbsp;RFC&nbsp;2616.</span><br>
<span class="lineno"></span><span class="comment" id="3725434">//&nbsp;The&nbsp;type&nbsp;and&nbsp;parameter&nbsp;names&nbsp;are&nbsp;written&nbsp;in&nbsp;lower-case.</span><br>
<span class="lineno"></span><span class="comment" id="3725493">//&nbsp;When&nbsp;any&nbsp;of&nbsp;the&nbsp;arguments&nbsp;result&nbsp;in&nbsp;a&nbsp;standard&nbsp;violation&nbsp;then</span><br>
<span class="lineno">20</span><span class="comment" id="3725558">//&nbsp;FormatMediaType&nbsp;returns&nbsp;the&nbsp;empty&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="3725603">func</span>&nbsp;<span class="ident" id="3725608">FormatMediaType</span><span class="op" id="3725623">(</span><span class="ident" id="3725624">t</span>&nbsp;<span class="builtintype" id="3725626">string</span><span class="op" id="3725632">,</span>&nbsp;<span class="ident" id="3725634">param</span>&nbsp;<span class="keyword" id="3725640">map</span><span class="op" id="3725643">[</span><span class="builtintype" id="3725644">string</span><span class="op" id="3725650">]</span><span class="builtintype" id="3725651">string</span><span class="op" id="3725657">)</span>&nbsp;<span class="builtintype" id="3725659">string</span>&nbsp;<span class="op" id="3725666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3725669">slash</span>&nbsp;<span class="op" id="3725675">:=</span>&nbsp;<span class="ident" id="3725678">strings</span><span class="op" id="3725685">.</span><span class="ident" id="3725686">Index</span><span class="op" id="3725691">(</span><span class="ident" id="3725692">t</span><span class="op" id="3725693">,</span>&nbsp;<span class="string" id="3725695">&#34;/&#34;</span><span class="op" id="3725698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3725701">if</span>&nbsp;<span class="ident" id="3725704">slash</span>&nbsp;<span class="op" id="3725710">==</span>&nbsp;<span class="op" id="3725713">-</span><span class="num" id="3725714">1</span>&nbsp;<span class="op" id="3725716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3725720">return</span>&nbsp;<span class="string" id="3725727">&#34;&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3725731">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3725734">major</span><span class="op" id="3725739">,</span>&nbsp;<span class="ident" id="3725741">sub</span>&nbsp;<span class="op" id="3725745">:=</span>&nbsp;<span class="ident" id="3725748">t</span><span class="op" id="3725749">[</span><span class="op" id="3725750">:</span><span class="ident" id="3725751">slash</span><span class="op" id="3725756">]</span><span class="op" id="3725757">,</span>&nbsp;<span class="ident" id="3725759">t</span><span class="op" id="3725760">[</span><span class="ident" id="3725761">slash</span><span class="op" id="3725766">+</span><span class="num" id="3725767">1</span><span class="op" id="3725768">:</span><span class="op" id="3725769">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3725772">if</span>&nbsp;<span class="op" id="3725775">!</span><span class="ident" id="3725776">isToken</span><span class="op" id="3725783">(</span><span class="ident" id="3725784">major</span><span class="op" id="3725789">)</span>&nbsp;<span class="op" id="3725791">||</span>&nbsp;<span class="op" id="3725794">!</span><span class="ident" id="3725795">isToken</span><span class="op" id="3725802">(</span><span class="ident" id="3725803">sub</span><span class="op" id="3725806">)</span>&nbsp;<span class="op" id="3725808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3725812">return</span>&nbsp;<span class="string" id="3725819">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3725823">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3725826">var</span>&nbsp;<span class="ident" id="3725830">b</span>&nbsp;<span class="ident" id="3725832">bytes</span><span class="op" id="3725837">.</span><span class="ident" id="3725838">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3725846">b</span><span class="op" id="3725847">.</span><span class="ident" id="3725848">WriteString</span><span class="op" id="3725859">(</span><span class="ident" id="3725860">strings</span><span class="op" id="3725867">.</span><span class="ident" id="3725868">ToLower</span><span class="op" id="3725875">(</span><span class="ident" id="3725876">major</span><span class="op" id="3725881">)</span><span class="op" id="3725882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3725885">b</span><span class="op" id="3725886">.</span><span class="ident" id="3725887">WriteByte</span><span class="op" id="3725896">(</span><span class="string" id="3725897">&#39;/&#39;</span><span class="op" id="3725900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3725903">b</span><span class="op" id="3725904">.</span><span class="ident" id="3725905">WriteString</span><span class="op" id="3725916">(</span><span class="ident" id="3725917">strings</span><span class="op" id="3725924">.</span><span class="ident" id="3725925">ToLower</span><span class="op" id="3725932">(</span><span class="ident" id="3725933">sub</span><span class="op" id="3725936">)</span><span class="op" id="3725937">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3725941">attrs</span>&nbsp;<span class="op" id="3725947">:=</span>&nbsp;<span class="builtinfunc" id="3725950">make</span><span class="op" id="3725954">(</span><span class="op" id="3725955">[</span><span class="op" id="3725956">]</span><span class="builtintype" id="3725957">string</span><span class="op" id="3725963">,</span>&nbsp;<span class="num" id="3725965">0</span><span class="op" id="3725966">,</span>&nbsp;<span class="builtinfunc" id="3725968">len</span><span class="op" id="3725971">(</span><span class="ident" id="3725972">param</span><span class="op" id="3725977">)</span><span class="op" id="3725978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3725981">for</span>&nbsp;<span class="ident" id="3725985">a</span>&nbsp;<span class="op" id="3725987">:=</span>&nbsp;<span class="keyword" id="3725990">range</span>&nbsp;<span class="ident" id="3725996">param</span>&nbsp;<span class="op" id="3726002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3726006">attrs</span>&nbsp;<span class="op" id="3726012">=</span>&nbsp;<span class="builtinfunc" id="3726014">append</span><span class="op" id="3726020">(</span><span class="ident" id="3726021">attrs</span><span class="op" id="3726026">,</span>&nbsp;<span class="ident" id="3726028">a</span><span class="op" id="3726029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3726032">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3726035">sort</span><span class="op" id="3726039">.</span><span class="ident" id="3726040">Strings</span><span class="op" id="3726047">(</span><span class="ident" id="3726048">attrs</span><span class="op" id="3726053">)</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3726057">for</span>&nbsp;<span class="ident" id="3726061">_</span><span class="op" id="3726062">,</span>&nbsp;<span class="ident" id="3726064">attribute</span>&nbsp;<span class="op" id="3726074">:=</span>&nbsp;<span class="keyword" id="3726077">range</span>&nbsp;<span class="ident" id="3726083">attrs</span>&nbsp;<span class="op" id="3726089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3726093">value</span>&nbsp;<span class="op" id="3726099">:=</span>&nbsp;<span class="ident" id="3726102">param</span><span class="op" id="3726107">[</span><span class="ident" id="3726108">attribute</span><span class="op" id="3726117">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3726121">b</span><span class="op" id="3726122">.</span><span class="ident" id="3726123">WriteByte</span><span class="op" id="3726132">(</span><span class="string" id="3726133">&#39;;&#39;</span><span class="op" id="3726136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3726140">b</span><span class="op" id="3726141">.</span><span class="ident" id="3726142">WriteByte</span><span class="op" id="3726151">(</span><span class="string" id="3726152">&#39;&nbsp;&#39;</span><span class="op" id="3726155">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3726159">if</span>&nbsp;<span class="op" id="3726162">!</span><span class="ident" id="3726163">isToken</span><span class="op" id="3726170">(</span><span class="ident" id="3726171">attribute</span><span class="op" id="3726180">)</span>&nbsp;<span class="op" id="3726182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3726187">return</span>&nbsp;<span class="string" id="3726194">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3726199">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3726203">b</span><span class="op" id="3726204">.</span><span class="ident" id="3726205">WriteString</span><span class="op" id="3726216">(</span><span class="ident" id="3726217">strings</span><span class="op" id="3726224">.</span><span class="ident" id="3726225">ToLower</span><span class="op" id="3726232">(</span><span class="ident" id="3726233">attribute</span><span class="op" id="3726242">)</span><span class="op" id="3726243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3726247">b</span><span class="op" id="3726248">.</span><span class="ident" id="3726249">WriteByte</span><span class="op" id="3726258">(</span><span class="string" id="3726259">&#39;=&#39;</span><span class="op" id="3726262">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3726266">if</span>&nbsp;<span class="ident" id="3726269">isToken</span><span class="op" id="3726276">(</span><span class="ident" id="3726277">value</span><span class="op" id="3726282">)</span>&nbsp;<span class="op" id="3726284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3726289">b</span><span class="op" id="3726290">.</span><span class="ident" id="3726291">WriteString</span><span class="op" id="3726302">(</span><span class="ident" id="3726303">value</span><span class="op" id="3726308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3726313">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3726324">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3726329">b</span><span class="op" id="3726330">.</span><span class="ident" id="3726331">WriteByte</span><span class="op" id="3726340">(</span><span class="string" id="3726341">&#39;&#34;&#39;</span><span class="op" id="3726344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3726348">offset</span>&nbsp;<span class="op" id="3726355">:=</span>&nbsp;<span class="num" id="3726358">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3726362">for</span>&nbsp;<span class="ident" id="3726366">index</span><span class="op" id="3726371">,</span>&nbsp;<span class="ident" id="3726373">character</span>&nbsp;<span class="op" id="3726383">:=</span>&nbsp;<span class="keyword" id="3726386">range</span>&nbsp;<span class="ident" id="3726392">value</span>&nbsp;<span class="op" id="3726398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3726403">if</span>&nbsp;<span class="ident" id="3726406">character</span>&nbsp;<span class="op" id="3726416">==</span>&nbsp;<span class="string" id="3726419">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="3726423">||</span>&nbsp;<span class="ident" id="3726426">character</span>&nbsp;<span class="op" id="3726436">==</span>&nbsp;<span class="string" id="3726439">&#39;\\&#39;</span>&nbsp;<span class="op" id="3726444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3726450">b</span><span class="op" id="3726451">.</span><span class="ident" id="3726452">WriteString</span><span class="op" id="3726463">(</span><span class="ident" id="3726464">value</span><span class="op" id="3726469">[</span><span class="ident" id="3726470">offset</span><span class="op" id="3726476">:</span><span class="ident" id="3726477">index</span><span class="op" id="3726482">]</span><span class="op" id="3726483">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3726489">offset</span>&nbsp;<span class="op" id="3726496">=</span>&nbsp;<span class="ident" id="3726498">index</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3726508">b</span><span class="op" id="3726509">.</span><span class="ident" id="3726510">WriteByte</span><span class="op" id="3726519">(</span><span class="string" id="3726520">&#39;\\&#39;</span><span class="op" id="3726524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3726529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3726534">if</span>&nbsp;<span class="ident" id="3726537">character</span><span class="op" id="3726546">&amp;</span><span class="num" id="3726547">0x80</span>&nbsp;<span class="op" id="3726552">!=</span>&nbsp;<span class="num" id="3726555">0</span>&nbsp;<span class="op" id="3726557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3726563">return</span>&nbsp;<span class="string" id="3726570">&#34;&#34;</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3726576">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3726580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3726584">b</span><span class="op" id="3726585">.</span><span class="ident" id="3726586">WriteString</span><span class="op" id="3726597">(</span><span class="ident" id="3726598">value</span><span class="op" id="3726603">[</span><span class="ident" id="3726604">offset</span><span class="op" id="3726610">:</span><span class="op" id="3726611">]</span><span class="op" id="3726612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3726616">b</span><span class="op" id="3726617">.</span><span class="ident" id="3726618">WriteByte</span><span class="op" id="3726627">(</span><span class="string" id="3726628">&#39;&#34;&#39;</span><span class="op" id="3726631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3726634">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3726637">return</span>&nbsp;<span class="ident" id="3726644">b</span><span class="op" id="3726645">.</span><span class="ident" id="3726646">String</span><span class="op" id="3726652">(</span><span class="op" id="3726653">)</span><br>
<span class="lineno"></span><span class="op" id="3726655">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3726658">func</span>&nbsp;<span class="ident" id="3726663">checkMediaTypeDisposition</span><span class="op" id="3726688">(</span><span class="ident" id="3726689">s</span>&nbsp;<span class="builtintype" id="3726691">string</span><span class="op" id="3726697">)</span>&nbsp;<span class="builtintype" id="3726699">error</span>&nbsp;<span class="op" id="3726705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3726708">typ</span><span class="op" id="3726711">,</span>&nbsp;<span class="ident" id="3726713">rest</span>&nbsp;<span class="op" id="3726718">:=</span>&nbsp;<span class="ident" id="3726721">consumeToken</span><span class="op" id="3726733">(</span><span class="ident" id="3726734">s</span><span class="op" id="3726735">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3726738">if</span>&nbsp;<span class="ident" id="3726741">typ</span>&nbsp;<span class="op" id="3726745">==</span>&nbsp;<span class="string" id="3726748">&#34;&#34;</span>&nbsp;<span class="op" id="3726751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3726755">return</span>&nbsp;<span class="ident" id="3726762">errors</span><span class="op" id="3726768">.</span><span class="ident" id="3726769">New</span><span class="op" id="3726772">(</span><span class="string" id="3726773">&#34;mime:&nbsp;no&nbsp;media&nbsp;type&#34;</span><span class="op" id="3726794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3726797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3726800">if</span>&nbsp;<span class="ident" id="3726803">rest</span>&nbsp;<span class="op" id="3726808">==</span>&nbsp;<span class="string" id="3726811">&#34;&#34;</span>&nbsp;<span class="op" id="3726814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3726818">return</span>&nbsp;<span class="ident" id="3726825">nil</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3726830">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3726833">if</span>&nbsp;<span class="op" id="3726836">!</span><span class="ident" id="3726837">strings</span><span class="op" id="3726844">.</span><span class="ident" id="3726845">HasPrefix</span><span class="op" id="3726854">(</span><span class="ident" id="3726855">rest</span><span class="op" id="3726859">,</span>&nbsp;<span class="string" id="3726861">&#34;/&#34;</span><span class="op" id="3726864">)</span>&nbsp;<span class="op" id="3726866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3726870">return</span>&nbsp;<span class="ident" id="3726877">errors</span><span class="op" id="3726883">.</span><span class="ident" id="3726884">New</span><span class="op" id="3726887">(</span><span class="string" id="3726888">&#34;mime:&nbsp;expected&nbsp;slash&nbsp;after&nbsp;first&nbsp;token&#34;</span><span class="op" id="3726928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3726931">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3726934">subtype</span><span class="op" id="3726941">,</span>&nbsp;<span class="ident" id="3726943">rest</span>&nbsp;<span class="op" id="3726948">:=</span>&nbsp;<span class="ident" id="3726951">consumeToken</span><span class="op" id="3726963">(</span><span class="ident" id="3726964">rest</span><span class="op" id="3726968">[</span><span class="num" id="3726969">1</span><span class="op" id="3726970">:</span><span class="op" id="3726971">]</span><span class="op" id="3726972">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3726975">if</span>&nbsp;<span class="ident" id="3726978">subtype</span>&nbsp;<span class="op" id="3726986">==</span>&nbsp;<span class="string" id="3726989">&#34;&#34;</span>&nbsp;<span class="op" id="3726992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3726996">return</span>&nbsp;<span class="ident" id="3727003">errors</span><span class="op" id="3727009">.</span><span class="ident" id="3727010">New</span><span class="op" id="3727013">(</span><span class="string" id="3727014">&#34;mime:&nbsp;expected&nbsp;token&nbsp;after&nbsp;slash&#34;</span><span class="op" id="3727048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3727051">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3727054">if</span>&nbsp;<span class="ident" id="3727057">rest</span>&nbsp;<span class="op" id="3727062">!=</span>&nbsp;<span class="string" id="3727065">&#34;&#34;</span>&nbsp;<span class="op" id="3727068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3727072">return</span>&nbsp;<span class="ident" id="3727079">errors</span><span class="op" id="3727085">.</span><span class="ident" id="3727086">New</span><span class="op" id="3727089">(</span><span class="string" id="3727090">&#34;mime:&nbsp;unexpected&nbsp;content&nbsp;after&nbsp;media&nbsp;subtype&#34;</span><span class="op" id="3727136">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3727139">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3727142">return</span>&nbsp;<span class="ident" id="3727149">nil</span><br>
<span class="lineno"></span><span class="op" id="3727153">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3727156">//&nbsp;ParseMediaType&nbsp;parses&nbsp;a&nbsp;media&nbsp;type&nbsp;value&nbsp;and&nbsp;any&nbsp;optional</span><br>
<span class="lineno">95</span><span class="comment" id="3727217">//&nbsp;parameters,&nbsp;per&nbsp;RFC&nbsp;1521.&nbsp;&nbsp;Media&nbsp;types&nbsp;are&nbsp;the&nbsp;values&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3727277">//&nbsp;Content-Type&nbsp;and&nbsp;Content-Disposition&nbsp;headers&nbsp;(RFC&nbsp;2183).</span><br>
<span class="lineno"></span><span class="comment" id="3727337">//&nbsp;On&nbsp;success,&nbsp;ParseMediaType&nbsp;returns&nbsp;the&nbsp;media&nbsp;type&nbsp;converted</span><br>
<span class="lineno"></span><span class="comment" id="3727400">//&nbsp;to&nbsp;lowercase&nbsp;and&nbsp;trimmed&nbsp;of&nbsp;white&nbsp;space&nbsp;and&nbsp;a&nbsp;non-nil&nbsp;map.</span><br>
<span class="lineno"></span><span class="comment" id="3727462">//&nbsp;The&nbsp;returned&nbsp;map,&nbsp;params,&nbsp;maps&nbsp;from&nbsp;the&nbsp;lowercase</span><br>
<span class="lineno">100</span><span class="comment" id="3727515">//&nbsp;attribute&nbsp;to&nbsp;the&nbsp;attribute&nbsp;value&nbsp;with&nbsp;its&nbsp;case&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="keyword" id="3727576">func</span>&nbsp;<span class="ident" id="3727581">ParseMediaType</span><span class="op" id="3727595">(</span><span class="ident" id="3727596">v</span>&nbsp;<span class="builtintype" id="3727598">string</span><span class="op" id="3727604">)</span>&nbsp;<span class="op" id="3727606">(</span><span class="ident" id="3727607">mediatype</span>&nbsp;<span class="builtintype" id="3727617">string</span><span class="op" id="3727623">,</span>&nbsp;<span class="ident" id="3727625">params</span>&nbsp;<span class="keyword" id="3727632">map</span><span class="op" id="3727635">[</span><span class="builtintype" id="3727636">string</span><span class="op" id="3727642">]</span><span class="builtintype" id="3727643">string</span><span class="op" id="3727649">,</span>&nbsp;<span class="ident" id="3727651">err</span>&nbsp;<span class="builtintype" id="3727655">error</span><span class="op" id="3727660">)</span>&nbsp;<span class="op" id="3727662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3727665">i</span>&nbsp;<span class="op" id="3727667">:=</span>&nbsp;<span class="ident" id="3727670">strings</span><span class="op" id="3727677">.</span><span class="ident" id="3727678">Index</span><span class="op" id="3727683">(</span><span class="ident" id="3727684">v</span><span class="op" id="3727685">,</span>&nbsp;<span class="string" id="3727687">&#34;;&#34;</span><span class="op" id="3727690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3727693">if</span>&nbsp;<span class="ident" id="3727696">i</span>&nbsp;<span class="op" id="3727698">==</span>&nbsp;<span class="op" id="3727701">-</span><span class="num" id="3727702">1</span>&nbsp;<span class="op" id="3727704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3727708">i</span>&nbsp;<span class="op" id="3727710">=</span>&nbsp;<span class="builtinfunc" id="3727712">len</span><span class="op" id="3727715">(</span><span class="ident" id="3727716">v</span><span class="op" id="3727717">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3727720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3727723">mediatype</span>&nbsp;<span class="op" id="3727733">=</span>&nbsp;<span class="ident" id="3727735">strings</span><span class="op" id="3727742">.</span><span class="ident" id="3727743">TrimSpace</span><span class="op" id="3727752">(</span><span class="ident" id="3727753">strings</span><span class="op" id="3727760">.</span><span class="ident" id="3727761">ToLower</span><span class="op" id="3727768">(</span><span class="ident" id="3727769">v</span><span class="op" id="3727770">[</span><span class="num" id="3727771">0</span><span class="op" id="3727772">:</span><span class="ident" id="3727773">i</span><span class="op" id="3727774">]</span><span class="op" id="3727775">)</span><span class="op" id="3727776">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3727780">err</span>&nbsp;<span class="op" id="3727784">=</span>&nbsp;<span class="ident" id="3727786">checkMediaTypeDisposition</span><span class="op" id="3727811">(</span><span class="ident" id="3727812">mediatype</span><span class="op" id="3727821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3727824">if</span>&nbsp;<span class="ident" id="3727827">err</span>&nbsp;<span class="op" id="3727831">!=</span>&nbsp;<span class="ident" id="3727834">nil</span>&nbsp;<span class="op" id="3727838">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3727842">return</span>&nbsp;<span class="string" id="3727849">&#34;&#34;</span><span class="op" id="3727851">,</span>&nbsp;<span class="ident" id="3727853">nil</span><span class="op" id="3727856">,</span>&nbsp;<span class="ident" id="3727858">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3727863">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3727867">params</span>&nbsp;<span class="op" id="3727874">=</span>&nbsp;<span class="builtinfunc" id="3727876">make</span><span class="op" id="3727880">(</span><span class="keyword" id="3727881">map</span><span class="op" id="3727884">[</span><span class="builtintype" id="3727885">string</span><span class="op" id="3727891">]</span><span class="builtintype" id="3727892">string</span><span class="op" id="3727898">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3727902">//&nbsp;Map&nbsp;of&nbsp;base&nbsp;parameter&nbsp;name&nbsp;-&gt;&nbsp;parameter&nbsp;name&nbsp;-&gt;&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3727960">//&nbsp;for&nbsp;parameters&nbsp;containing&nbsp;a&nbsp;&#39;*&#39;&nbsp;character.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3728007">//&nbsp;Lazily&nbsp;initialized.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3728031">var</span>&nbsp;<span class="ident" id="3728035">continuation</span>&nbsp;<span class="keyword" id="3728048">map</span><span class="op" id="3728051">[</span><span class="builtintype" id="3728052">string</span><span class="op" id="3728058">]</span><span class="keyword" id="3728059">map</span><span class="op" id="3728062">[</span><span class="builtintype" id="3728063">string</span><span class="op" id="3728069">]</span><span class="builtintype" id="3728070">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3728079">v</span>&nbsp;<span class="op" id="3728081">=</span>&nbsp;<span class="ident" id="3728083">v</span><span class="op" id="3728084">[</span><span class="ident" id="3728085">i</span><span class="op" id="3728086">:</span><span class="op" id="3728087">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3728090">for</span>&nbsp;<span class="builtinfunc" id="3728094">len</span><span class="op" id="3728097">(</span><span class="ident" id="3728098">v</span><span class="op" id="3728099">)</span>&nbsp;<span class="op" id="3728101">&gt;</span>&nbsp;<span class="num" id="3728103">0</span>&nbsp;<span class="op" id="3728105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3728109">v</span>&nbsp;<span class="op" id="3728111">=</span>&nbsp;<span class="ident" id="3728113">strings</span><span class="op" id="3728120">.</span><span class="ident" id="3728121">TrimLeftFunc</span><span class="op" id="3728133">(</span><span class="ident" id="3728134">v</span><span class="op" id="3728135">,</span>&nbsp;<span class="ident" id="3728137">unicode</span><span class="op" id="3728144">.</span><span class="ident" id="3728145">IsSpace</span><span class="op" id="3728152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3728156">if</span>&nbsp;<span class="builtinfunc" id="3728159">len</span><span class="op" id="3728162">(</span><span class="ident" id="3728163">v</span><span class="op" id="3728164">)</span>&nbsp;<span class="op" id="3728166">==</span>&nbsp;<span class="num" id="3728169">0</span>&nbsp;<span class="op" id="3728171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3728176">break</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3728184">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3728188">key</span><span class="op" id="3728191">,</span>&nbsp;<span class="ident" id="3728193">value</span><span class="op" id="3728198">,</span>&nbsp;<span class="ident" id="3728200">rest</span>&nbsp;<span class="op" id="3728205">:=</span>&nbsp;<span class="ident" id="3728208">consumeMediaParam</span><span class="op" id="3728225">(</span><span class="ident" id="3728226">v</span><span class="op" id="3728227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3728231">if</span>&nbsp;<span class="ident" id="3728234">key</span>&nbsp;<span class="op" id="3728238">==</span>&nbsp;<span class="string" id="3728241">&#34;&#34;</span>&nbsp;<span class="op" id="3728244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3728249">if</span>&nbsp;<span class="ident" id="3728252">strings</span><span class="op" id="3728259">.</span><span class="ident" id="3728260">TrimSpace</span><span class="op" id="3728269">(</span><span class="ident" id="3728270">rest</span><span class="op" id="3728274">)</span>&nbsp;<span class="op" id="3728276">==</span>&nbsp;<span class="string" id="3728279">&#34;;&#34;</span>&nbsp;<span class="op" id="3728283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3728289">//&nbsp;Ignore&nbsp;trailing&nbsp;semicolons.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3728324">//&nbsp;Not&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3728345">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3728355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3728360">//&nbsp;Parse&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3728379">return</span>&nbsp;<span class="string" id="3728386">&#34;&#34;</span><span class="op" id="3728388">,</span>&nbsp;<span class="ident" id="3728390">nil</span><span class="op" id="3728393">,</span>&nbsp;<span class="ident" id="3728395">errors</span><span class="op" id="3728401">.</span><span class="ident" id="3728402">New</span><span class="op" id="3728405">(</span><span class="string" id="3728406">&#34;mime:&nbsp;invalid&nbsp;media&nbsp;parameter&#34;</span><span class="op" id="3728437">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3728441">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3728446">pmap</span>&nbsp;<span class="op" id="3728451">:=</span>&nbsp;<span class="ident" id="3728454">params</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3728463">if</span>&nbsp;<span class="ident" id="3728466">idx</span>&nbsp;<span class="op" id="3728470">:=</span>&nbsp;<span class="ident" id="3728473">strings</span><span class="op" id="3728480">.</span><span class="ident" id="3728481">Index</span><span class="op" id="3728486">(</span><span class="ident" id="3728487">key</span><span class="op" id="3728490">,</span>&nbsp;<span class="string" id="3728492">&#34;*&#34;</span><span class="op" id="3728495">)</span><span class="op" id="3728496">;</span>&nbsp;<span class="ident" id="3728498">idx</span>&nbsp;<span class="op" id="3728502">!=</span>&nbsp;<span class="op" id="3728505">-</span><span class="num" id="3728506">1</span>&nbsp;<span class="op" id="3728508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3728513">baseName</span>&nbsp;<span class="op" id="3728522">:=</span>&nbsp;<span class="ident" id="3728525">key</span><span class="op" id="3728528">[</span><span class="op" id="3728529">:</span><span class="ident" id="3728530">idx</span><span class="op" id="3728533">]</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3728538">if</span>&nbsp;<span class="ident" id="3728541">continuation</span>&nbsp;<span class="op" id="3728554">==</span>&nbsp;<span class="ident" id="3728557">nil</span>&nbsp;<span class="op" id="3728561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3728567">continuation</span>&nbsp;<span class="op" id="3728580">=</span>&nbsp;<span class="builtinfunc" id="3728582">make</span><span class="op" id="3728586">(</span><span class="keyword" id="3728587">map</span><span class="op" id="3728590">[</span><span class="builtintype" id="3728591">string</span><span class="op" id="3728597">]</span><span class="keyword" id="3728598">map</span><span class="op" id="3728601">[</span><span class="builtintype" id="3728602">string</span><span class="op" id="3728608">]</span><span class="builtintype" id="3728609">string</span><span class="op" id="3728615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3728620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3728625">var</span>&nbsp;<span class="ident" id="3728629">ok</span>&nbsp;<span class="builtintype" id="3728632">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3728640">if</span>&nbsp;<span class="ident" id="3728643">pmap</span><span class="op" id="3728647">,</span>&nbsp;<span class="ident" id="3728649">ok</span>&nbsp;<span class="op" id="3728652">=</span>&nbsp;<span class="ident" id="3728654">continuation</span><span class="op" id="3728666">[</span><span class="ident" id="3728667">baseName</span><span class="op" id="3728675">]</span><span class="op" id="3728676">;</span>&nbsp;<span class="op" id="3728678">!</span><span class="ident" id="3728679">ok</span>&nbsp;<span class="op" id="3728682">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3728688">continuation</span><span class="op" id="3728700">[</span><span class="ident" id="3728701">baseName</span><span class="op" id="3728709">]</span>&nbsp;<span class="op" id="3728711">=</span>&nbsp;<span class="builtinfunc" id="3728713">make</span><span class="op" id="3728717">(</span><span class="keyword" id="3728718">map</span><span class="op" id="3728721">[</span><span class="builtintype" id="3728722">string</span><span class="op" id="3728728">]</span><span class="builtintype" id="3728729">string</span><span class="op" id="3728735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3728741">pmap</span>&nbsp;<span class="op" id="3728746">=</span>&nbsp;<span class="ident" id="3728748">continuation</span><span class="op" id="3728760">[</span><span class="ident" id="3728761">baseName</span><span class="op" id="3728769">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3728774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3728778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3728782">if</span>&nbsp;<span class="ident" id="3728785">_</span><span class="op" id="3728786">,</span>&nbsp;<span class="ident" id="3728788">exists</span>&nbsp;<span class="op" id="3728795">:=</span>&nbsp;<span class="ident" id="3728798">pmap</span><span class="op" id="3728802">[</span><span class="ident" id="3728803">key</span><span class="op" id="3728806">]</span><span class="op" id="3728807">;</span>&nbsp;<span class="ident" id="3728809">exists</span>&nbsp;<span class="op" id="3728816">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3728821">//&nbsp;Duplicate&nbsp;parameter&nbsp;name&nbsp;is&nbsp;bogus.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3728862">return</span>&nbsp;<span class="string" id="3728869">&#34;&#34;</span><span class="op" id="3728871">,</span>&nbsp;<span class="ident" id="3728873">nil</span><span class="op" id="3728876">,</span>&nbsp;<span class="ident" id="3728878">errors</span><span class="op" id="3728884">.</span><span class="ident" id="3728885">New</span><span class="op" id="3728888">(</span><span class="string" id="3728889">&#34;mime:&nbsp;duplicate&nbsp;parameter&nbsp;name&#34;</span><span class="op" id="3728921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3728925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3728929">pmap</span><span class="op" id="3728933">[</span><span class="ident" id="3728934">key</span><span class="op" id="3728937">]</span>&nbsp;<span class="op" id="3728939">=</span>&nbsp;<span class="ident" id="3728941">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3728949">v</span>&nbsp;<span class="op" id="3728951">=</span>&nbsp;<span class="ident" id="3728953">rest</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3728959">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3728963">//&nbsp;Stitch&nbsp;together&nbsp;any&nbsp;continuations&nbsp;or&nbsp;things&nbsp;with&nbsp;stars</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3729022">//&nbsp;(i.e.&nbsp;RFC&nbsp;2231&nbsp;things&nbsp;with&nbsp;stars:&nbsp;&#34;foo*0&#34;&nbsp;or&nbsp;&#34;foo*&#34;)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3729079">var</span>&nbsp;<span class="ident" id="3729083">buf</span>&nbsp;<span class="ident" id="3729087">bytes</span><span class="op" id="3729092">.</span><span class="ident" id="3729093">Buffer</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3729101">for</span>&nbsp;<span class="ident" id="3729105">key</span><span class="op" id="3729108">,</span>&nbsp;<span class="ident" id="3729110">pieceMap</span>&nbsp;<span class="op" id="3729119">:=</span>&nbsp;<span class="keyword" id="3729122">range</span>&nbsp;<span class="ident" id="3729128">continuation</span>&nbsp;<span class="op" id="3729141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3729145">singlePartKey</span>&nbsp;<span class="op" id="3729159">:=</span>&nbsp;<span class="ident" id="3729162">key</span>&nbsp;<span class="op" id="3729166">+</span>&nbsp;<span class="string" id="3729168">&#34;*&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3729174">if</span>&nbsp;<span class="ident" id="3729177">v</span><span class="op" id="3729178">,</span>&nbsp;<span class="ident" id="3729180">ok</span>&nbsp;<span class="op" id="3729183">:=</span>&nbsp;<span class="ident" id="3729186">pieceMap</span><span class="op" id="3729194">[</span><span class="ident" id="3729195">singlePartKey</span><span class="op" id="3729208">]</span><span class="op" id="3729209">;</span>&nbsp;<span class="ident" id="3729211">ok</span>&nbsp;<span class="op" id="3729214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3729219">decv</span>&nbsp;<span class="op" id="3729224">:=</span>&nbsp;<span class="ident" id="3729227">decode2231Enc</span><span class="op" id="3729240">(</span><span class="ident" id="3729241">v</span><span class="op" id="3729242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3729247">params</span><span class="op" id="3729253">[</span><span class="ident" id="3729254">key</span><span class="op" id="3729257">]</span>&nbsp;<span class="op" id="3729259">=</span>&nbsp;<span class="ident" id="3729261">decv</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3729269">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3729280">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3729285">buf</span><span class="op" id="3729288">.</span><span class="ident" id="3729289">Reset</span><span class="op" id="3729294">(</span><span class="op" id="3729295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3729299">valid</span>&nbsp;<span class="op" id="3729305">:=</span>&nbsp;<span class="ident" id="3729308">false</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3729316">for</span>&nbsp;<span class="ident" id="3729320">n</span>&nbsp;<span class="op" id="3729322">:=</span>&nbsp;<span class="num" id="3729325">0</span><span class="op" id="3729326">;</span>&nbsp;<span class="op" id="3729328">;</span>&nbsp;<span class="ident" id="3729330">n</span><span class="op" id="3729331">++</span>&nbsp;<span class="op" id="3729334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3729339">simplePart</span>&nbsp;<span class="op" id="3729350">:=</span>&nbsp;<span class="ident" id="3729353">fmt</span><span class="op" id="3729356">.</span><span class="ident" id="3729357">Sprintf</span><span class="op" id="3729364">(</span><span class="string" id="3729365">&#34;%s*%d&#34;</span><span class="op" id="3729372">,</span>&nbsp;<span class="ident" id="3729374">key</span><span class="op" id="3729377">,</span>&nbsp;<span class="ident" id="3729379">n</span><span class="op" id="3729380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3729385">if</span>&nbsp;<span class="ident" id="3729388">v</span><span class="op" id="3729389">,</span>&nbsp;<span class="ident" id="3729391">ok</span>&nbsp;<span class="op" id="3729394">:=</span>&nbsp;<span class="ident" id="3729397">pieceMap</span><span class="op" id="3729405">[</span><span class="ident" id="3729406">simplePart</span><span class="op" id="3729416">]</span><span class="op" id="3729417">;</span>&nbsp;<span class="ident" id="3729419">ok</span>&nbsp;<span class="op" id="3729422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3729428">valid</span>&nbsp;<span class="op" id="3729434">=</span>&nbsp;<span class="ident" id="3729436">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3729445">buf</span><span class="op" id="3729448">.</span><span class="ident" id="3729449">WriteString</span><span class="op" id="3729460">(</span><span class="ident" id="3729461">v</span><span class="op" id="3729462">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3729468">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3729480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3729485">encodedPart</span>&nbsp;<span class="op" id="3729497">:=</span>&nbsp;<span class="ident" id="3729500">simplePart</span>&nbsp;<span class="op" id="3729511">+</span>&nbsp;<span class="string" id="3729513">&#34;*&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3729520">if</span>&nbsp;<span class="ident" id="3729523">v</span><span class="op" id="3729524">,</span>&nbsp;<span class="ident" id="3729526">ok</span>&nbsp;<span class="op" id="3729529">:=</span>&nbsp;<span class="ident" id="3729532">pieceMap</span><span class="op" id="3729540">[</span><span class="ident" id="3729541">encodedPart</span><span class="op" id="3729552">]</span><span class="op" id="3729553">;</span>&nbsp;<span class="ident" id="3729555">ok</span>&nbsp;<span class="op" id="3729558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3729564">valid</span>&nbsp;<span class="op" id="3729570">=</span>&nbsp;<span class="ident" id="3729572">true</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3729581">if</span>&nbsp;<span class="ident" id="3729584">n</span>&nbsp;<span class="op" id="3729586">==</span>&nbsp;<span class="num" id="3729589">0</span>&nbsp;<span class="op" id="3729591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3729598">buf</span><span class="op" id="3729601">.</span><span class="ident" id="3729602">WriteString</span><span class="op" id="3729613">(</span><span class="ident" id="3729614">decode2231Enc</span><span class="op" id="3729627">(</span><span class="ident" id="3729628">v</span><span class="op" id="3729629">)</span><span class="op" id="3729630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3729636">}</span>&nbsp;<span class="keyword" id="3729638">else</span>&nbsp;<span class="op" id="3729643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3729650">decv</span><span class="op" id="3729654">,</span>&nbsp;<span class="ident" id="3729656">_</span>&nbsp;<span class="op" id="3729658">:=</span>&nbsp;<span class="ident" id="3729661">percentHexUnescape</span><span class="op" id="3729679">(</span><span class="ident" id="3729680">v</span><span class="op" id="3729681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3729688">buf</span><span class="op" id="3729691">.</span><span class="ident" id="3729692">WriteString</span><span class="op" id="3729703">(</span><span class="ident" id="3729704">decv</span><span class="op" id="3729708">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3729714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3729719">}</span>&nbsp;<span class="keyword" id="3729721">else</span>&nbsp;<span class="op" id="3729726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3729732">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3729741">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3729745">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3729749">if</span>&nbsp;<span class="ident" id="3729752">valid</span>&nbsp;<span class="op" id="3729758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3729763">params</span><span class="op" id="3729769">[</span><span class="ident" id="3729770">key</span><span class="op" id="3729773">]</span>&nbsp;<span class="op" id="3729775">=</span>&nbsp;<span class="ident" id="3729777">buf</span><span class="op" id="3729780">.</span><span class="ident" id="3729781">String</span><span class="op" id="3729787">(</span><span class="op" id="3729788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3729792">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3729795">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3729799">return</span><br>
<span class="lineno"></span><span class="op" id="3729806">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3729809">func</span>&nbsp;<span class="ident" id="3729814">decode2231Enc</span><span class="op" id="3729827">(</span><span class="ident" id="3729828">v</span>&nbsp;<span class="builtintype" id="3729830">string</span><span class="op" id="3729836">)</span>&nbsp;<span class="builtintype" id="3729838">string</span>&nbsp;<span class="op" id="3729845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3729848">sv</span>&nbsp;<span class="op" id="3729851">:=</span>&nbsp;<span class="ident" id="3729854">strings</span><span class="op" id="3729861">.</span><span class="ident" id="3729862">SplitN</span><span class="op" id="3729868">(</span><span class="ident" id="3729869">v</span><span class="op" id="3729870">,</span>&nbsp;<span class="string" id="3729872">&#34;&#39;&#34;</span><span class="op" id="3729875">,</span>&nbsp;<span class="num" id="3729877">3</span><span class="op" id="3729878">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3729881">if</span>&nbsp;<span class="builtinfunc" id="3729884">len</span><span class="op" id="3729887">(</span><span class="ident" id="3729888">sv</span><span class="op" id="3729890">)</span>&nbsp;<span class="op" id="3729892">!=</span>&nbsp;<span class="num" id="3729895">3</span>&nbsp;<span class="op" id="3729897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3729901">return</span>&nbsp;<span class="string" id="3729908">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3729912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3729915">//&nbsp;TODO:&nbsp;ignoring&nbsp;lang&nbsp;in&nbsp;sv[1]&nbsp;for&nbsp;now.&nbsp;If&nbsp;anybody&nbsp;needs&nbsp;it&nbsp;we&#39;ll</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3729983">//&nbsp;need&nbsp;to&nbsp;decide&nbsp;how&nbsp;to&nbsp;expose&nbsp;it&nbsp;in&nbsp;the&nbsp;API.&nbsp;But&nbsp;I&#39;m&nbsp;not&nbsp;sure</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3730048">//&nbsp;anybody&nbsp;uses&nbsp;it&nbsp;in&nbsp;practice.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3730081">charset</span>&nbsp;<span class="op" id="3730089">:=</span>&nbsp;<span class="ident" id="3730092">strings</span><span class="op" id="3730099">.</span><span class="ident" id="3730100">ToLower</span><span class="op" id="3730107">(</span><span class="ident" id="3730108">sv</span><span class="op" id="3730110">[</span><span class="num" id="3730111">0</span><span class="op" id="3730112">]</span><span class="op" id="3730113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3730116">if</span>&nbsp;<span class="ident" id="3730119">charset</span>&nbsp;<span class="op" id="3730127">!=</span>&nbsp;<span class="string" id="3730130">&#34;us-ascii&#34;</span>&nbsp;<span class="op" id="3730141">&amp;&amp;</span>&nbsp;<span class="ident" id="3730144">charset</span>&nbsp;<span class="op" id="3730152">!=</span>&nbsp;<span class="string" id="3730155">&#34;utf-8&#34;</span>&nbsp;<span class="op" id="3730163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3730167">//&nbsp;TODO:&nbsp;unsupported&nbsp;encoding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3730199">return</span>&nbsp;<span class="string" id="3730206">&#34;&#34;</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3730210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3730213">encv</span><span class="op" id="3730217">,</span>&nbsp;<span class="ident" id="3730219">_</span>&nbsp;<span class="op" id="3730221">:=</span>&nbsp;<span class="ident" id="3730224">percentHexUnescape</span><span class="op" id="3730242">(</span><span class="ident" id="3730243">sv</span><span class="op" id="3730245">[</span><span class="num" id="3730246">2</span><span class="op" id="3730247">]</span><span class="op" id="3730248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3730251">return</span>&nbsp;<span class="ident" id="3730258">encv</span><br>
<span class="lineno"></span><span class="op" id="3730263">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="keyword" id="3730266">func</span>&nbsp;<span class="ident" id="3730271">isNotTokenChar</span><span class="op" id="3730285">(</span><span class="ident" id="3730286">r</span>&nbsp;<span class="builtintype" id="3730288">rune</span><span class="op" id="3730292">)</span>&nbsp;<span class="builtintype" id="3730294">bool</span>&nbsp;<span class="op" id="3730299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3730302">return</span>&nbsp;<span class="op" id="3730309">!</span><span class="ident" id="3730310">isTokenChar</span><span class="op" id="3730321">(</span><span class="ident" id="3730322">r</span><span class="op" id="3730323">)</span><br>
<span class="lineno"></span><span class="op" id="3730325">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3730328">//&nbsp;consumeToken&nbsp;consumes&nbsp;a&nbsp;token&nbsp;from&nbsp;the&nbsp;beginning&nbsp;of&nbsp;provided</span><br>
<span class="lineno">220</span><span class="comment" id="3730392">//&nbsp;string,&nbsp;per&nbsp;RFC&nbsp;2045&nbsp;section&nbsp;5.1&nbsp;(referenced&nbsp;from&nbsp;2183),&nbsp;and&nbsp;return</span><br>
<span class="lineno"></span><span class="comment" id="3730463">//&nbsp;the&nbsp;token&nbsp;consumed&nbsp;and&nbsp;the&nbsp;rest&nbsp;of&nbsp;the&nbsp;string.&nbsp;&nbsp;Returns&nbsp;(&#34;&#34;,&nbsp;v)&nbsp;on</span><br>
<span class="lineno"></span><span class="comment" id="3730533">//&nbsp;failure&nbsp;to&nbsp;consume&nbsp;at&nbsp;least&nbsp;one&nbsp;character.</span><br>
<span class="lineno"></span><span class="keyword" id="3730579">func</span>&nbsp;<span class="ident" id="3730584">consumeToken</span><span class="op" id="3730596">(</span><span class="ident" id="3730597">v</span>&nbsp;<span class="builtintype" id="3730599">string</span><span class="op" id="3730605">)</span>&nbsp;<span class="op" id="3730607">(</span><span class="ident" id="3730608">token</span><span class="op" id="3730613">,</span>&nbsp;<span class="ident" id="3730615">rest</span>&nbsp;<span class="builtintype" id="3730620">string</span><span class="op" id="3730626">)</span>&nbsp;<span class="op" id="3730628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3730631">notPos</span>&nbsp;<span class="op" id="3730638">:=</span>&nbsp;<span class="ident" id="3730641">strings</span><span class="op" id="3730648">.</span><span class="ident" id="3730649">IndexFunc</span><span class="op" id="3730658">(</span><span class="ident" id="3730659">v</span><span class="op" id="3730660">,</span>&nbsp;<span class="ident" id="3730662">isNotTokenChar</span><span class="op" id="3730676">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3730679">if</span>&nbsp;<span class="ident" id="3730682">notPos</span>&nbsp;<span class="op" id="3730689">==</span>&nbsp;<span class="op" id="3730692">-</span><span class="num" id="3730693">1</span>&nbsp;<span class="op" id="3730695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3730699">return</span>&nbsp;<span class="ident" id="3730706">v</span><span class="op" id="3730707">,</span>&nbsp;<span class="string" id="3730709">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3730713">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3730716">if</span>&nbsp;<span class="ident" id="3730719">notPos</span>&nbsp;<span class="op" id="3730726">==</span>&nbsp;<span class="num" id="3730729">0</span>&nbsp;<span class="op" id="3730731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3730735">return</span>&nbsp;<span class="string" id="3730742">&#34;&#34;</span><span class="op" id="3730744">,</span>&nbsp;<span class="ident" id="3730746">v</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3730749">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3730752">return</span>&nbsp;<span class="ident" id="3730759">v</span><span class="op" id="3730760">[</span><span class="num" id="3730761">0</span><span class="op" id="3730762">:</span><span class="ident" id="3730763">notPos</span><span class="op" id="3730769">]</span><span class="op" id="3730770">,</span>&nbsp;<span class="ident" id="3730772">v</span><span class="op" id="3730773">[</span><span class="ident" id="3730774">notPos</span><span class="op" id="3730780">:</span><span class="op" id="3730781">]</span><br>
<span class="lineno"></span><span class="op" id="3730783">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3730786">//&nbsp;consumeValue&nbsp;consumes&nbsp;a&nbsp;&#34;value&#34;&nbsp;per&nbsp;RFC&nbsp;2045,&nbsp;where&nbsp;a&nbsp;value&nbsp;is</span><br>
<span class="lineno">235</span><span class="comment" id="3730852">//&nbsp;either&nbsp;a&nbsp;&#39;token&#39;&nbsp;or&nbsp;a&nbsp;&#39;quoted-string&#39;.&nbsp;&nbsp;On&nbsp;success,&nbsp;consumeValue</span><br>
<span class="lineno"></span><span class="comment" id="3730920">//&nbsp;returns&nbsp;the&nbsp;value&nbsp;consumed&nbsp;(and&nbsp;de-quoted/escaped,&nbsp;if&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3730979">//&nbsp;quoted-string)&nbsp;and&nbsp;the&nbsp;rest&nbsp;of&nbsp;the&nbsp;string.&nbsp;&nbsp;On&nbsp;failure,&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="3731046">//&nbsp;(&#34;&#34;,&nbsp;v).</span><br>
<span class="lineno"></span><span class="keyword" id="3731058">func</span>&nbsp;<span class="ident" id="3731063">consumeValue</span><span class="op" id="3731075">(</span><span class="ident" id="3731076">v</span>&nbsp;<span class="builtintype" id="3731078">string</span><span class="op" id="3731084">)</span>&nbsp;<span class="op" id="3731086">(</span><span class="ident" id="3731087">value</span><span class="op" id="3731092">,</span>&nbsp;<span class="ident" id="3731094">rest</span>&nbsp;<span class="builtintype" id="3731099">string</span><span class="op" id="3731105">)</span>&nbsp;<span class="op" id="3731107">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3731110">if</span>&nbsp;<span class="op" id="3731113">!</span><span class="ident" id="3731114">strings</span><span class="op" id="3731121">.</span><span class="ident" id="3731122">HasPrefix</span><span class="op" id="3731131">(</span><span class="ident" id="3731132">v</span><span class="op" id="3731133">,</span>&nbsp;<span class="string" id="3731135">`&#34;`</span><span class="op" id="3731138">)</span>&nbsp;<span class="op" id="3731140">&amp;&amp;</span>&nbsp;<span class="op" id="3731143">!</span><span class="ident" id="3731144">strings</span><span class="op" id="3731151">.</span><span class="ident" id="3731152">HasPrefix</span><span class="op" id="3731161">(</span><span class="ident" id="3731162">v</span><span class="op" id="3731163">,</span>&nbsp;<span class="string" id="3731165">`&#39;`</span><span class="op" id="3731168">)</span>&nbsp;<span class="op" id="3731170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3731174">return</span>&nbsp;<span class="ident" id="3731181">consumeToken</span><span class="op" id="3731193">(</span><span class="ident" id="3731194">v</span><span class="op" id="3731195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3731198">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3731202">leadQuote</span>&nbsp;<span class="op" id="3731212">:=</span>&nbsp;<span class="builtintype" id="3731215">rune</span><span class="op" id="3731219">(</span><span class="ident" id="3731220">v</span><span class="op" id="3731221">[</span><span class="num" id="3731222">0</span><span class="op" id="3731223">]</span><span class="op" id="3731224">)</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3731228">//&nbsp;parse&nbsp;a&nbsp;quoted-string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3731254">rest</span>&nbsp;<span class="op" id="3731259">=</span>&nbsp;<span class="ident" id="3731261">v</span><span class="op" id="3731262">[</span><span class="num" id="3731263">1</span><span class="op" id="3731264">:</span><span class="op" id="3731265">]</span>&nbsp;<span class="comment" id="3731267">//&nbsp;consume&nbsp;the&nbsp;leading&nbsp;quote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3731297">buffer</span>&nbsp;<span class="op" id="3731304">:=</span>&nbsp;<span class="builtinfunc" id="3731307">new</span><span class="op" id="3731310">(</span><span class="ident" id="3731311">bytes</span><span class="op" id="3731316">.</span><span class="ident" id="3731317">Buffer</span><span class="op" id="3731323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3731326">var</span>&nbsp;<span class="ident" id="3731330">idx</span>&nbsp;<span class="builtintype" id="3731334">int</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3731339">var</span>&nbsp;<span class="ident" id="3731343">r</span>&nbsp;<span class="builtintype" id="3731345">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3731351">var</span>&nbsp;<span class="ident" id="3731355">nextIsLiteral</span>&nbsp;<span class="builtintype" id="3731369">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3731375">for</span>&nbsp;<span class="ident" id="3731379">idx</span><span class="op" id="3731382">,</span>&nbsp;<span class="ident" id="3731384">r</span>&nbsp;<span class="op" id="3731386">=</span>&nbsp;<span class="keyword" id="3731388">range</span>&nbsp;<span class="ident" id="3731394">rest</span>&nbsp;<span class="op" id="3731399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3731403">switch</span>&nbsp;<span class="op" id="3731410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3731414">case</span>&nbsp;<span class="ident" id="3731419">nextIsLiteral</span><span class="op" id="3731432">:</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3731437">buffer</span><span class="op" id="3731443">.</span><span class="ident" id="3731444">WriteRune</span><span class="op" id="3731453">(</span><span class="ident" id="3731454">r</span><span class="op" id="3731455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3731460">nextIsLiteral</span>&nbsp;<span class="op" id="3731474">=</span>&nbsp;<span class="ident" id="3731476">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3731484">case</span>&nbsp;<span class="ident" id="3731489">r</span>&nbsp;<span class="op" id="3731491">==</span>&nbsp;<span class="ident" id="3731494">leadQuote</span><span class="op" id="3731503">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3731508">return</span>&nbsp;<span class="ident" id="3731515">buffer</span><span class="op" id="3731521">.</span><span class="ident" id="3731522">String</span><span class="op" id="3731528">(</span><span class="op" id="3731529">)</span><span class="op" id="3731530">,</span>&nbsp;<span class="ident" id="3731532">rest</span><span class="op" id="3731536">[</span><span class="ident" id="3731537">idx</span><span class="op" id="3731540">+</span><span class="num" id="3731541">1</span><span class="op" id="3731542">:</span><span class="op" id="3731543">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3731547">case</span>&nbsp;<span class="ident" id="3731552">r</span>&nbsp;<span class="op" id="3731554">==</span>&nbsp;<span class="string" id="3731557">&#39;\\&#39;</span><span class="op" id="3731561">:</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3731566">nextIsLiteral</span>&nbsp;<span class="op" id="3731580">=</span>&nbsp;<span class="ident" id="3731582">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3731589">case</span>&nbsp;<span class="ident" id="3731594">r</span>&nbsp;<span class="op" id="3731596">!=</span>&nbsp;<span class="string" id="3731599">&#39;\r&#39;</span>&nbsp;<span class="op" id="3731604">&amp;&amp;</span>&nbsp;<span class="ident" id="3731607">r</span>&nbsp;<span class="op" id="3731609">!=</span>&nbsp;<span class="string" id="3731612">&#39;\n&#39;</span><span class="op" id="3731616">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3731621">buffer</span><span class="op" id="3731627">.</span><span class="ident" id="3731628">WriteRune</span><span class="op" id="3731637">(</span><span class="ident" id="3731638">r</span><span class="op" id="3731639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3731643">default</span><span class="op" id="3731650">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3731655">return</span>&nbsp;<span class="string" id="3731662">&#34;&#34;</span><span class="op" id="3731664">,</span>&nbsp;<span class="ident" id="3731666">v</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3731670">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3731673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3731676">return</span>&nbsp;<span class="string" id="3731683">&#34;&#34;</span><span class="op" id="3731685">,</span>&nbsp;<span class="ident" id="3731687">v</span><br>
<span class="lineno"></span><span class="op" id="3731689">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span><span class="keyword" id="3731692">func</span>&nbsp;<span class="ident" id="3731697">consumeMediaParam</span><span class="op" id="3731714">(</span><span class="ident" id="3731715">v</span>&nbsp;<span class="builtintype" id="3731717">string</span><span class="op" id="3731723">)</span>&nbsp;<span class="op" id="3731725">(</span><span class="ident" id="3731726">param</span><span class="op" id="3731731">,</span>&nbsp;<span class="ident" id="3731733">value</span><span class="op" id="3731738">,</span>&nbsp;<span class="ident" id="3731740">rest</span>&nbsp;<span class="builtintype" id="3731745">string</span><span class="op" id="3731751">)</span>&nbsp;<span class="op" id="3731753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3731756">rest</span>&nbsp;<span class="op" id="3731761">=</span>&nbsp;<span class="ident" id="3731763">strings</span><span class="op" id="3731770">.</span><span class="ident" id="3731771">TrimLeftFunc</span><span class="op" id="3731783">(</span><span class="ident" id="3731784">v</span><span class="op" id="3731785">,</span>&nbsp;<span class="ident" id="3731787">unicode</span><span class="op" id="3731794">.</span><span class="ident" id="3731795">IsSpace</span><span class="op" id="3731802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3731805">if</span>&nbsp;<span class="op" id="3731808">!</span><span class="ident" id="3731809">strings</span><span class="op" id="3731816">.</span><span class="ident" id="3731817">HasPrefix</span><span class="op" id="3731826">(</span><span class="ident" id="3731827">rest</span><span class="op" id="3731831">,</span>&nbsp;<span class="string" id="3731833">&#34;;&#34;</span><span class="op" id="3731836">)</span>&nbsp;<span class="op" id="3731838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3731842">return</span>&nbsp;<span class="string" id="3731849">&#34;&#34;</span><span class="op" id="3731851">,</span>&nbsp;<span class="string" id="3731853">&#34;&#34;</span><span class="op" id="3731855">,</span>&nbsp;<span class="ident" id="3731857">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3731860">}</span><br>
<span class="lineno">275</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3731864">rest</span>&nbsp;<span class="op" id="3731869">=</span>&nbsp;<span class="ident" id="3731871">rest</span><span class="op" id="3731875">[</span><span class="num" id="3731876">1</span><span class="op" id="3731877">:</span><span class="op" id="3731878">]</span>&nbsp;<span class="comment" id="3731880">//&nbsp;consume&nbsp;semicolon</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3731902">rest</span>&nbsp;<span class="op" id="3731907">=</span>&nbsp;<span class="ident" id="3731909">strings</span><span class="op" id="3731916">.</span><span class="ident" id="3731917">TrimLeftFunc</span><span class="op" id="3731929">(</span><span class="ident" id="3731930">rest</span><span class="op" id="3731934">,</span>&nbsp;<span class="ident" id="3731936">unicode</span><span class="op" id="3731943">.</span><span class="ident" id="3731944">IsSpace</span><span class="op" id="3731951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3731954">param</span><span class="op" id="3731959">,</span>&nbsp;<span class="ident" id="3731961">rest</span>&nbsp;<span class="op" id="3731966">=</span>&nbsp;<span class="ident" id="3731968">consumeToken</span><span class="op" id="3731980">(</span><span class="ident" id="3731981">rest</span><span class="op" id="3731985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3731988">param</span>&nbsp;<span class="op" id="3731994">=</span>&nbsp;<span class="ident" id="3731996">strings</span><span class="op" id="3732003">.</span><span class="ident" id="3732004">ToLower</span><span class="op" id="3732011">(</span><span class="ident" id="3732012">param</span><span class="op" id="3732017">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3732020">if</span>&nbsp;<span class="ident" id="3732023">param</span>&nbsp;<span class="op" id="3732029">==</span>&nbsp;<span class="string" id="3732032">&#34;&#34;</span>&nbsp;<span class="op" id="3732035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3732039">return</span>&nbsp;<span class="string" id="3732046">&#34;&#34;</span><span class="op" id="3732048">,</span>&nbsp;<span class="string" id="3732050">&#34;&#34;</span><span class="op" id="3732052">,</span>&nbsp;<span class="ident" id="3732054">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3732057">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3732061">rest</span>&nbsp;<span class="op" id="3732066">=</span>&nbsp;<span class="ident" id="3732068">strings</span><span class="op" id="3732075">.</span><span class="ident" id="3732076">TrimLeftFunc</span><span class="op" id="3732088">(</span><span class="ident" id="3732089">rest</span><span class="op" id="3732093">,</span>&nbsp;<span class="ident" id="3732095">unicode</span><span class="op" id="3732102">.</span><span class="ident" id="3732103">IsSpace</span><span class="op" id="3732110">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3732113">if</span>&nbsp;<span class="op" id="3732116">!</span><span class="ident" id="3732117">strings</span><span class="op" id="3732124">.</span><span class="ident" id="3732125">HasPrefix</span><span class="op" id="3732134">(</span><span class="ident" id="3732135">rest</span><span class="op" id="3732139">,</span>&nbsp;<span class="string" id="3732141">&#34;=&#34;</span><span class="op" id="3732144">)</span>&nbsp;<span class="op" id="3732146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3732150">return</span>&nbsp;<span class="string" id="3732157">&#34;&#34;</span><span class="op" id="3732159">,</span>&nbsp;<span class="string" id="3732161">&#34;&#34;</span><span class="op" id="3732163">,</span>&nbsp;<span class="ident" id="3732165">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3732168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3732171">rest</span>&nbsp;<span class="op" id="3732176">=</span>&nbsp;<span class="ident" id="3732178">rest</span><span class="op" id="3732182">[</span><span class="num" id="3732183">1</span><span class="op" id="3732184">:</span><span class="op" id="3732185">]</span>&nbsp;<span class="comment" id="3732187">//&nbsp;consume&nbsp;equals&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3732211">rest</span>&nbsp;<span class="op" id="3732216">=</span>&nbsp;<span class="ident" id="3732218">strings</span><span class="op" id="3732225">.</span><span class="ident" id="3732226">TrimLeftFunc</span><span class="op" id="3732238">(</span><span class="ident" id="3732239">rest</span><span class="op" id="3732243">,</span>&nbsp;<span class="ident" id="3732245">unicode</span><span class="op" id="3732252">.</span><span class="ident" id="3732253">IsSpace</span><span class="op" id="3732260">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3732263">value</span><span class="op" id="3732268">,</span>&nbsp;<span class="ident" id="3732270">rest</span>&nbsp;<span class="op" id="3732275">=</span>&nbsp;<span class="ident" id="3732277">consumeValue</span><span class="op" id="3732289">(</span><span class="ident" id="3732290">rest</span><span class="op" id="3732294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3732297">if</span>&nbsp;<span class="ident" id="3732300">value</span>&nbsp;<span class="op" id="3732306">==</span>&nbsp;<span class="string" id="3732309">&#34;&#34;</span>&nbsp;<span class="op" id="3732312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3732316">return</span>&nbsp;<span class="string" id="3732323">&#34;&#34;</span><span class="op" id="3732325">,</span>&nbsp;<span class="string" id="3732327">&#34;&#34;</span><span class="op" id="3732329">,</span>&nbsp;<span class="ident" id="3732331">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3732334">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3732337">return</span>&nbsp;<span class="ident" id="3732344">param</span><span class="op" id="3732349">,</span>&nbsp;<span class="ident" id="3732351">value</span><span class="op" id="3732356">,</span>&nbsp;<span class="ident" id="3732358">rest</span><br>
<span class="lineno">295</span><span class="op" id="3732363">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3732366">func</span>&nbsp;<span class="ident" id="3732371">percentHexUnescape</span><span class="op" id="3732389">(</span><span class="ident" id="3732390">s</span>&nbsp;<span class="builtintype" id="3732392">string</span><span class="op" id="3732398">)</span>&nbsp;<span class="op" id="3732400">(</span><span class="builtintype" id="3732401">string</span><span class="op" id="3732407">,</span>&nbsp;<span class="builtintype" id="3732409">error</span><span class="op" id="3732414">)</span>&nbsp;<span class="op" id="3732416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3732419">//&nbsp;Count&nbsp;%,&nbsp;check&nbsp;that&nbsp;they&#39;re&nbsp;well-formed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3732464">percents</span>&nbsp;<span class="op" id="3732473">:=</span>&nbsp;<span class="num" id="3732476">0</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3732479">for</span>&nbsp;<span class="ident" id="3732483">i</span>&nbsp;<span class="op" id="3732485">:=</span>&nbsp;<span class="num" id="3732488">0</span><span class="op" id="3732489">;</span>&nbsp;<span class="ident" id="3732491">i</span>&nbsp;<span class="op" id="3732493">&lt;</span>&nbsp;<span class="builtinfunc" id="3732495">len</span><span class="op" id="3732498">(</span><span class="ident" id="3732499">s</span><span class="op" id="3732500">)</span><span class="op" id="3732501">;</span>&nbsp;<span class="op" id="3732503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3732507">if</span>&nbsp;<span class="ident" id="3732510">s</span><span class="op" id="3732511">[</span><span class="ident" id="3732512">i</span><span class="op" id="3732513">]</span>&nbsp;<span class="op" id="3732515">!=</span>&nbsp;<span class="string" id="3732518">&#39;%&#39;</span>&nbsp;<span class="op" id="3732522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3732527">i</span><span class="op" id="3732528">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3732534">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3732545">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3732549">percents</span><span class="op" id="3732557">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3732562">if</span>&nbsp;<span class="ident" id="3732565">i</span><span class="op" id="3732566">+</span><span class="num" id="3732567">2</span>&nbsp;<span class="op" id="3732569">&gt;=</span>&nbsp;<span class="builtinfunc" id="3732572">len</span><span class="op" id="3732575">(</span><span class="ident" id="3732576">s</span><span class="op" id="3732577">)</span>&nbsp;<span class="op" id="3732579">||</span>&nbsp;<span class="op" id="3732582">!</span><span class="ident" id="3732583">ishex</span><span class="op" id="3732588">(</span><span class="ident" id="3732589">s</span><span class="op" id="3732590">[</span><span class="ident" id="3732591">i</span><span class="op" id="3732592">+</span><span class="num" id="3732593">1</span><span class="op" id="3732594">]</span><span class="op" id="3732595">)</span>&nbsp;<span class="op" id="3732597">||</span>&nbsp;<span class="op" id="3732600">!</span><span class="ident" id="3732601">ishex</span><span class="op" id="3732606">(</span><span class="ident" id="3732607">s</span><span class="op" id="3732608">[</span><span class="ident" id="3732609">i</span><span class="op" id="3732610">+</span><span class="num" id="3732611">2</span><span class="op" id="3732612">]</span><span class="op" id="3732613">)</span>&nbsp;<span class="op" id="3732615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3732620">s</span>&nbsp;<span class="op" id="3732622">=</span>&nbsp;<span class="ident" id="3732624">s</span><span class="op" id="3732625">[</span><span class="ident" id="3732626">i</span><span class="op" id="3732627">:</span><span class="op" id="3732628">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3732633">if</span>&nbsp;<span class="builtinfunc" id="3732636">len</span><span class="op" id="3732639">(</span><span class="ident" id="3732640">s</span><span class="op" id="3732641">)</span>&nbsp;<span class="op" id="3732643">&gt;</span>&nbsp;<span class="num" id="3732645">3</span>&nbsp;<span class="op" id="3732647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3732653">s</span>&nbsp;<span class="op" id="3732655">=</span>&nbsp;<span class="ident" id="3732657">s</span><span class="op" id="3732658">[</span><span class="num" id="3732659">0</span><span class="op" id="3732660">:</span><span class="num" id="3732661">3</span><span class="op" id="3732662">]</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3732667">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3732672">return</span>&nbsp;<span class="string" id="3732679">&#34;&#34;</span><span class="op" id="3732681">,</span>&nbsp;<span class="ident" id="3732683">fmt</span><span class="op" id="3732686">.</span><span class="ident" id="3732687">Errorf</span><span class="op" id="3732693">(</span><span class="string" id="3732694">&#34;mime:&nbsp;bogus&nbsp;characters&nbsp;after&nbsp;%%:&nbsp;%q&#34;</span><span class="op" id="3732731">,</span>&nbsp;<span class="ident" id="3732733">s</span><span class="op" id="3732734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3732738">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3732742">i</span>&nbsp;<span class="op" id="3732744">+=</span>&nbsp;<span class="num" id="3732747">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3732750">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3732753">if</span>&nbsp;<span class="ident" id="3732756">percents</span>&nbsp;<span class="op" id="3732765">==</span>&nbsp;<span class="num" id="3732768">0</span>&nbsp;<span class="op" id="3732770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3732774">return</span>&nbsp;<span class="ident" id="3732781">s</span><span class="op" id="3732782">,</span>&nbsp;<span class="ident" id="3732784">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3732789">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3732793">t</span>&nbsp;<span class="op" id="3732795">:=</span>&nbsp;<span class="builtinfunc" id="3732798">make</span><span class="op" id="3732802">(</span><span class="op" id="3732803">[</span><span class="op" id="3732804">]</span><span class="builtintype" id="3732805">byte</span><span class="op" id="3732809">,</span>&nbsp;<span class="builtinfunc" id="3732811">len</span><span class="op" id="3732814">(</span><span class="ident" id="3732815">s</span><span class="op" id="3732816">)</span><span class="op" id="3732817">-</span><span class="num" id="3732818">2</span><span class="op" id="3732819">*</span><span class="ident" id="3732820">percents</span><span class="op" id="3732828">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3732831">j</span>&nbsp;<span class="op" id="3732833">:=</span>&nbsp;<span class="num" id="3732836">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3732839">for</span>&nbsp;<span class="ident" id="3732843">i</span>&nbsp;<span class="op" id="3732845">:=</span>&nbsp;<span class="num" id="3732848">0</span><span class="op" id="3732849">;</span>&nbsp;<span class="ident" id="3732851">i</span>&nbsp;<span class="op" id="3732853">&lt;</span>&nbsp;<span class="builtinfunc" id="3732855">len</span><span class="op" id="3732858">(</span><span class="ident" id="3732859">s</span><span class="op" id="3732860">)</span><span class="op" id="3732861">;</span>&nbsp;<span class="op" id="3732863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3732867">switch</span>&nbsp;<span class="ident" id="3732874">s</span><span class="op" id="3732875">[</span><span class="ident" id="3732876">i</span><span class="op" id="3732877">]</span>&nbsp;<span class="op" id="3732879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3732883">case</span>&nbsp;<span class="string" id="3732888">&#39;%&#39;</span><span class="op" id="3732891">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3732896">t</span><span class="op" id="3732897">[</span><span class="ident" id="3732898">j</span><span class="op" id="3732899">]</span>&nbsp;<span class="op" id="3732901">=</span>&nbsp;<span class="ident" id="3732903">unhex</span><span class="op" id="3732908">(</span><span class="ident" id="3732909">s</span><span class="op" id="3732910">[</span><span class="ident" id="3732911">i</span><span class="op" id="3732912">+</span><span class="num" id="3732913">1</span><span class="op" id="3732914">]</span><span class="op" id="3732915">)</span><span class="op" id="3732916">&lt;&lt;</span><span class="num" id="3732918">4</span>&nbsp;<span class="op" id="3732920">|</span>&nbsp;<span class="ident" id="3732922">unhex</span><span class="op" id="3732927">(</span><span class="ident" id="3732928">s</span><span class="op" id="3732929">[</span><span class="ident" id="3732930">i</span><span class="op" id="3732931">+</span><span class="num" id="3732932">2</span><span class="op" id="3732933">]</span><span class="op" id="3732934">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3732939">j</span><span class="op" id="3732940">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3732946">i</span>&nbsp;<span class="op" id="3732948">+=</span>&nbsp;<span class="num" id="3732951">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3732955">default</span><span class="op" id="3732962">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3732967">t</span><span class="op" id="3732968">[</span><span class="ident" id="3732969">j</span><span class="op" id="3732970">]</span>&nbsp;<span class="op" id="3732972">=</span>&nbsp;<span class="ident" id="3732974">s</span><span class="op" id="3732975">[</span><span class="ident" id="3732976">i</span><span class="op" id="3732977">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3732982">j</span><span class="op" id="3732983">++</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3732989">i</span><span class="op" id="3732990">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3732995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3732998">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3733001">return</span>&nbsp;<span class="builtintype" id="3733008">string</span><span class="op" id="3733014">(</span><span class="ident" id="3733015">t</span><span class="op" id="3733016">)</span><span class="op" id="3733017">,</span>&nbsp;<span class="ident" id="3733019">nil</span><br>
<span class="lineno"></span><span class="op" id="3733023">}</span><br>
<span class="lineno">335</span><br>
<span class="lineno"></span><span class="keyword" id="3733026">func</span>&nbsp;<span class="ident" id="3733031">ishex</span><span class="op" id="3733036">(</span><span class="ident" id="3733037">c</span>&nbsp;<span class="builtintype" id="3733039">byte</span><span class="op" id="3733043">)</span>&nbsp;<span class="builtintype" id="3733045">bool</span>&nbsp;<span class="op" id="3733050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3733053">switch</span>&nbsp;<span class="op" id="3733060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3733063">case</span>&nbsp;<span class="string" id="3733068">&#39;0&#39;</span>&nbsp;<span class="op" id="3733072">&lt;=</span>&nbsp;<span class="ident" id="3733075">c</span>&nbsp;<span class="op" id="3733077">&amp;&amp;</span>&nbsp;<span class="ident" id="3733080">c</span>&nbsp;<span class="op" id="3733082">&lt;=</span>&nbsp;<span class="string" id="3733085">&#39;9&#39;</span><span class="op" id="3733088">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3733092">return</span>&nbsp;<span class="ident" id="3733099">true</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3733105">case</span>&nbsp;<span class="string" id="3733110">&#39;a&#39;</span>&nbsp;<span class="op" id="3733114">&lt;=</span>&nbsp;<span class="ident" id="3733117">c</span>&nbsp;<span class="op" id="3733119">&amp;&amp;</span>&nbsp;<span class="ident" id="3733122">c</span>&nbsp;<span class="op" id="3733124">&lt;=</span>&nbsp;<span class="string" id="3733127">&#39;f&#39;</span><span class="op" id="3733130">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3733134">return</span>&nbsp;<span class="ident" id="3733141">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3733147">case</span>&nbsp;<span class="string" id="3733152">&#39;A&#39;</span>&nbsp;<span class="op" id="3733156">&lt;=</span>&nbsp;<span class="ident" id="3733159">c</span>&nbsp;<span class="op" id="3733161">&amp;&amp;</span>&nbsp;<span class="ident" id="3733164">c</span>&nbsp;<span class="op" id="3733166">&lt;=</span>&nbsp;<span class="string" id="3733169">&#39;F&#39;</span><span class="op" id="3733172">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3733176">return</span>&nbsp;<span class="ident" id="3733183">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3733189">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3733192">return</span>&nbsp;<span class="ident" id="3733199">false</span><br>
<span class="lineno"></span><span class="op" id="3733205">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3733208">func</span>&nbsp;<span class="ident" id="3733213">unhex</span><span class="op" id="3733218">(</span><span class="ident" id="3733219">c</span>&nbsp;<span class="builtintype" id="3733221">byte</span><span class="op" id="3733225">)</span>&nbsp;<span class="builtintype" id="3733227">byte</span>&nbsp;<span class="op" id="3733232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3733235">switch</span>&nbsp;<span class="op" id="3733242">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3733245">case</span>&nbsp;<span class="string" id="3733250">&#39;0&#39;</span>&nbsp;<span class="op" id="3733254">&lt;=</span>&nbsp;<span class="ident" id="3733257">c</span>&nbsp;<span class="op" id="3733259">&amp;&amp;</span>&nbsp;<span class="ident" id="3733262">c</span>&nbsp;<span class="op" id="3733264">&lt;=</span>&nbsp;<span class="string" id="3733267">&#39;9&#39;</span><span class="op" id="3733270">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3733274">return</span>&nbsp;<span class="ident" id="3733281">c</span>&nbsp;<span class="op" id="3733283">-</span>&nbsp;<span class="string" id="3733285">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3733290">case</span>&nbsp;<span class="string" id="3733295">&#39;a&#39;</span>&nbsp;<span class="op" id="3733299">&lt;=</span>&nbsp;<span class="ident" id="3733302">c</span>&nbsp;<span class="op" id="3733304">&amp;&amp;</span>&nbsp;<span class="ident" id="3733307">c</span>&nbsp;<span class="op" id="3733309">&lt;=</span>&nbsp;<span class="string" id="3733312">&#39;f&#39;</span><span class="op" id="3733315">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3733319">return</span>&nbsp;<span class="ident" id="3733326">c</span>&nbsp;<span class="op" id="3733328">-</span>&nbsp;<span class="string" id="3733330">&#39;a&#39;</span>&nbsp;<span class="op" id="3733334">+</span>&nbsp;<span class="num" id="3733336">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3733340">case</span>&nbsp;<span class="string" id="3733345">&#39;A&#39;</span>&nbsp;<span class="op" id="3733349">&lt;=</span>&nbsp;<span class="ident" id="3733352">c</span>&nbsp;<span class="op" id="3733354">&amp;&amp;</span>&nbsp;<span class="ident" id="3733357">c</span>&nbsp;<span class="op" id="3733359">&lt;=</span>&nbsp;<span class="string" id="3733362">&#39;F&#39;</span><span class="op" id="3733365">:</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3733369">return</span>&nbsp;<span class="ident" id="3733376">c</span>&nbsp;<span class="op" id="3733378">-</span>&nbsp;<span class="string" id="3733380">&#39;A&#39;</span>&nbsp;<span class="op" id="3733384">+</span>&nbsp;<span class="num" id="3733386">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3733390">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3733393">return</span>&nbsp;<span class="num" id="3733400">0</span><br>
<span class="lineno"></span><span class="op" id="3733402">}</span>
</div>
</body>
</html>
