<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>os</h2>
<ul>
<li><a href="/gostd/os/dir_unix.go.html">dir_unix.go</a></li>
<li><a href="/gostd/os/doc.go.html">doc.go</a></li>
<li><a href="/gostd/os/env.go.html">env.go</a></li>
<li><a href="/gostd/os/env_test.go.html">env_test.go</a></li>
<li><a href="/gostd/os/env_unix_test.go.html">env_unix_test.go</a></li>
<li><a href="/gostd/os/error.go.html">error.go</a></li>
<li><a href="/gostd/os/error_test.go.html">error_test.go</a></li>
<li><a href="/gostd/os/error_unix.go.html">error_unix.go</a></li>
<li><a href="/gostd/os/exec.go.html">exec.go</a></li>
<li><a href="/gostd/os/exec_posix.go.html">exec_posix.go</a></li>
<li><a href="/gostd/os/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/os/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/os/file.go.html">file.go</a></li>
<li><a href="/gostd/os/file_posix.go.html">file_posix.go</a></li>
<li><a href="/gostd/os/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/os/getwd.go.html">getwd.go</a></li>
<li><a href="/gostd/os/os_test.go.html">os_test.go</a></li>
<li><a href="/gostd/os/os_unix_test.go.html">os_unix_test.go</a></li>
<li><a href="/gostd/os/path.go.html">path.go</a></li>
<li><a href="/gostd/os/path_test.go.html">path_test.go</a></li>
<li><a href="/gostd/os/path_unix.go.html">path_unix.go</a></li>
<li><a href="/gostd/os/pipe_linux.go.html">pipe_linux.go</a></li>
<li><a href="/gostd/os/proc.go.html">proc.go</a></li>
<li><a href="/gostd/os/stat_linux.go.html">stat_linux.go</a></li>
<li><a href="/gostd/os/sys_linux.go.html">sys_linux.go</a></li>
<li><a href="/gostd/os/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/os/types.go.html">types.go</a></li>
<li><a href="/gostd/os/types_notwin.go.html">types_notwin.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2501097">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2501152">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2501206">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2501257">package</span>&nbsp;<span class="ident" id="2501265">os</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2501269">import</span>&nbsp;<span class="op" id="2501276">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2501279">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2501290">&#34;time&#34;</span><br>
<span class="lineno">10</span><span class="op" id="2501297">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2501300">func</span>&nbsp;<span class="ident" id="2501305">sameFile</span><span class="op" id="2501313">(</span><span class="ident" id="2501314">fs1</span><span class="op" id="2501317">,</span>&nbsp;<span class="ident" id="2501319">fs2</span>&nbsp;<span class="op" id="2501323">*</span><span class="ident" id="2501324">fileStat</span><span class="op" id="2501332">)</span>&nbsp;<span class="builtintype" id="2501334">bool</span>&nbsp;<span class="op" id="2501339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2501342">stat1</span>&nbsp;<span class="op" id="2501348">:=</span>&nbsp;<span class="ident" id="2501351">fs1</span><span class="op" id="2501354">.</span><span class="ident" id="2501355">sys</span><span class="op" id="2501358">.</span><span class="op" id="2501359">(</span><span class="op" id="2501360">*</span><span class="ident" id="2501361">syscall</span><span class="op" id="2501368">.</span><span class="ident" id="2501369">Stat_t</span><span class="op" id="2501375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2501378">stat2</span>&nbsp;<span class="op" id="2501384">:=</span>&nbsp;<span class="ident" id="2501387">fs2</span><span class="op" id="2501390">.</span><span class="ident" id="2501391">sys</span><span class="op" id="2501394">.</span><span class="op" id="2501395">(</span><span class="op" id="2501396">*</span><span class="ident" id="2501397">syscall</span><span class="op" id="2501404">.</span><span class="ident" id="2501405">Stat_t</span><span class="op" id="2501411">)</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2501414">return</span>&nbsp;<span class="ident" id="2501421">stat1</span><span class="op" id="2501426">.</span><span class="ident" id="2501427">Dev</span>&nbsp;<span class="op" id="2501431">==</span>&nbsp;<span class="ident" id="2501434">stat2</span><span class="op" id="2501439">.</span><span class="ident" id="2501440">Dev</span>&nbsp;<span class="op" id="2501444">&amp;&amp;</span>&nbsp;<span class="ident" id="2501447">stat1</span><span class="op" id="2501452">.</span><span class="ident" id="2501453">Ino</span>&nbsp;<span class="op" id="2501457">==</span>&nbsp;<span class="ident" id="2501460">stat2</span><span class="op" id="2501465">.</span><span class="ident" id="2501466">Ino</span><br>
<span class="lineno"></span><span class="op" id="2501470">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2501473">func</span>&nbsp;<span class="ident" id="2501478">fileInfoFromStat</span><span class="op" id="2501494">(</span><span class="ident" id="2501495">st</span>&nbsp;<span class="op" id="2501498">*</span><span class="ident" id="2501499">syscall</span><span class="op" id="2501506">.</span><span class="ident" id="2501507">Stat_t</span><span class="op" id="2501513">,</span>&nbsp;<span class="ident" id="2501515">name</span>&nbsp;<span class="builtintype" id="2501520">string</span><span class="op" id="2501526">)</span>&nbsp;<span class="ident" id="2501528">FileInfo</span>&nbsp;<span class="op" id="2501537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2501540">fs</span>&nbsp;<span class="op" id="2501543">:=</span>&nbsp;<span class="op" id="2501546">&amp;</span><span class="ident" id="2501547">fileStat</span><span class="op" id="2501555">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2501559">name</span><span class="op" id="2501563">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2501568">basename</span><span class="op" id="2501576">(</span><span class="ident" id="2501577">name</span><span class="op" id="2501581">)</span><span class="op" id="2501582">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2501586">size</span><span class="op" id="2501590">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2501595">int64</span><span class="op" id="2501600">(</span><span class="ident" id="2501601">st</span><span class="op" id="2501603">.</span><span class="ident" id="2501604">Size</span><span class="op" id="2501608">)</span><span class="op" id="2501609">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2501613">modTime</span><span class="op" id="2501620">:</span>&nbsp;<span class="ident" id="2501622">timespecToTime</span><span class="op" id="2501636">(</span><span class="ident" id="2501637">st</span><span class="op" id="2501639">.</span><span class="ident" id="2501640">Mtim</span><span class="op" id="2501644">)</span><span class="op" id="2501645">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2501649">sys</span><span class="op" id="2501652">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2501658">st</span><span class="op" id="2501660">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2501663">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2501666">fs</span><span class="op" id="2501668">.</span><span class="ident" id="2501669">mode</span>&nbsp;<span class="op" id="2501674">=</span>&nbsp;<span class="ident" id="2501676">FileMode</span><span class="op" id="2501684">(</span><span class="ident" id="2501685">st</span><span class="op" id="2501687">.</span><span class="ident" id="2501688">Mode</span>&nbsp;<span class="op" id="2501693">&amp;</span>&nbsp;<span class="num" id="2501695">0777</span><span class="op" id="2501699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2501702">switch</span>&nbsp;<span class="ident" id="2501709">st</span><span class="op" id="2501711">.</span><span class="ident" id="2501712">Mode</span>&nbsp;<span class="op" id="2501717">&amp;</span>&nbsp;<span class="ident" id="2501719">syscall</span><span class="op" id="2501726">.</span><span class="ident" id="2501727">S_IFMT</span>&nbsp;<span class="op" id="2501734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2501737">case</span>&nbsp;<span class="ident" id="2501742">syscall</span><span class="op" id="2501749">.</span><span class="ident" id="2501750">S_IFBLK</span><span class="op" id="2501757">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2501761">fs</span><span class="op" id="2501763">.</span><span class="ident" id="2501764">mode</span>&nbsp;<span class="op" id="2501769">|=</span>&nbsp;<span class="ident" id="2501772">ModeDevice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2501784">case</span>&nbsp;<span class="ident" id="2501789">syscall</span><span class="op" id="2501796">.</span><span class="ident" id="2501797">S_IFCHR</span><span class="op" id="2501804">:</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2501808">fs</span><span class="op" id="2501810">.</span><span class="ident" id="2501811">mode</span>&nbsp;<span class="op" id="2501816">|=</span>&nbsp;<span class="ident" id="2501819">ModeDevice</span>&nbsp;<span class="op" id="2501830">|</span>&nbsp;<span class="ident" id="2501832">ModeCharDevice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2501848">case</span>&nbsp;<span class="ident" id="2501853">syscall</span><span class="op" id="2501860">.</span><span class="ident" id="2501861">S_IFDIR</span><span class="op" id="2501868">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2501872">fs</span><span class="op" id="2501874">.</span><span class="ident" id="2501875">mode</span>&nbsp;<span class="op" id="2501880">|=</span>&nbsp;<span class="ident" id="2501883">ModeDir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2501892">case</span>&nbsp;<span class="ident" id="2501897">syscall</span><span class="op" id="2501904">.</span><span class="ident" id="2501905">S_IFIFO</span><span class="op" id="2501912">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2501916">fs</span><span class="op" id="2501918">.</span><span class="ident" id="2501919">mode</span>&nbsp;<span class="op" id="2501924">|=</span>&nbsp;<span class="ident" id="2501927">ModeNamedPipe</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2501942">case</span>&nbsp;<span class="ident" id="2501947">syscall</span><span class="op" id="2501954">.</span><span class="ident" id="2501955">S_IFLNK</span><span class="op" id="2501962">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2501966">fs</span><span class="op" id="2501968">.</span><span class="ident" id="2501969">mode</span>&nbsp;<span class="op" id="2501974">|=</span>&nbsp;<span class="ident" id="2501977">ModeSymlink</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2501990">case</span>&nbsp;<span class="ident" id="2501995">syscall</span><span class="op" id="2502002">.</span><span class="ident" id="2502003">S_IFREG</span><span class="op" id="2502010">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2502014">//&nbsp;nothing&nbsp;to&nbsp;do</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2502032">case</span>&nbsp;<span class="ident" id="2502037">syscall</span><span class="op" id="2502044">.</span><span class="ident" id="2502045">S_IFSOCK</span><span class="op" id="2502053">:</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2502057">fs</span><span class="op" id="2502059">.</span><span class="ident" id="2502060">mode</span>&nbsp;<span class="op" id="2502065">|=</span>&nbsp;<span class="ident" id="2502068">ModeSocket</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2502080">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2502083">if</span>&nbsp;<span class="ident" id="2502086">st</span><span class="op" id="2502088">.</span><span class="ident" id="2502089">Mode</span><span class="op" id="2502093">&amp;</span><span class="ident" id="2502094">syscall</span><span class="op" id="2502101">.</span><span class="ident" id="2502102">S_ISGID</span>&nbsp;<span class="op" id="2502110">!=</span>&nbsp;<span class="num" id="2502113">0</span>&nbsp;<span class="op" id="2502115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2502119">fs</span><span class="op" id="2502121">.</span><span class="ident" id="2502122">mode</span>&nbsp;<span class="op" id="2502127">|=</span>&nbsp;<span class="ident" id="2502130">ModeSetgid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2502142">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2502145">if</span>&nbsp;<span class="ident" id="2502148">st</span><span class="op" id="2502150">.</span><span class="ident" id="2502151">Mode</span><span class="op" id="2502155">&amp;</span><span class="ident" id="2502156">syscall</span><span class="op" id="2502163">.</span><span class="ident" id="2502164">S_ISUID</span>&nbsp;<span class="op" id="2502172">!=</span>&nbsp;<span class="num" id="2502175">0</span>&nbsp;<span class="op" id="2502177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2502181">fs</span><span class="op" id="2502183">.</span><span class="ident" id="2502184">mode</span>&nbsp;<span class="op" id="2502189">|=</span>&nbsp;<span class="ident" id="2502192">ModeSetuid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2502204">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2502207">if</span>&nbsp;<span class="ident" id="2502210">st</span><span class="op" id="2502212">.</span><span class="ident" id="2502213">Mode</span><span class="op" id="2502217">&amp;</span><span class="ident" id="2502218">syscall</span><span class="op" id="2502225">.</span><span class="ident" id="2502226">S_ISVTX</span>&nbsp;<span class="op" id="2502234">!=</span>&nbsp;<span class="num" id="2502237">0</span>&nbsp;<span class="op" id="2502239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2502243">fs</span><span class="op" id="2502245">.</span><span class="ident" id="2502246">mode</span>&nbsp;<span class="op" id="2502251">|=</span>&nbsp;<span class="ident" id="2502254">ModeSticky</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2502266">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2502269">return</span>&nbsp;<span class="ident" id="2502276">fs</span><br>
<span class="lineno"></span><span class="op" id="2502279">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2502282">func</span>&nbsp;<span class="ident" id="2502287">timespecToTime</span><span class="op" id="2502301">(</span><span class="ident" id="2502302">ts</span>&nbsp;<span class="ident" id="2502305">syscall</span><span class="op" id="2502312">.</span><span class="ident" id="2502313">Timespec</span><span class="op" id="2502321">)</span>&nbsp;<span class="ident" id="2502323">time</span><span class="op" id="2502327">.</span><span class="ident" id="2502328">Time</span>&nbsp;<span class="op" id="2502333">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2502336">return</span>&nbsp;<span class="ident" id="2502343">time</span><span class="op" id="2502347">.</span><span class="ident" id="2502348">Unix</span><span class="op" id="2502352">(</span><span class="ident" id="2502353">int64</span><span class="op" id="2502358">(</span><span class="ident" id="2502359">ts</span><span class="op" id="2502361">.</span><span class="ident" id="2502362">Sec</span><span class="op" id="2502365">)</span><span class="op" id="2502366">,</span>&nbsp;<span class="ident" id="2502368">int64</span><span class="op" id="2502373">(</span><span class="ident" id="2502374">ts</span><span class="op" id="2502376">.</span><span class="ident" id="2502377">Nsec</span><span class="op" id="2502381">)</span><span class="op" id="2502382">)</span><br>
<span class="lineno"></span><span class="op" id="2502384">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2502387">//&nbsp;For&nbsp;testing.</span><br>
<span class="lineno"></span><span class="keyword" id="2502403">func</span>&nbsp;<span class="ident" id="2502408">atime</span><span class="op" id="2502413">(</span><span class="ident" id="2502414">fi</span>&nbsp;<span class="ident" id="2502417">FileInfo</span><span class="op" id="2502425">)</span>&nbsp;<span class="ident" id="2502427">time</span><span class="op" id="2502431">.</span><span class="ident" id="2502432">Time</span>&nbsp;<span class="op" id="2502437">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2502440">return</span>&nbsp;<span class="ident" id="2502447">timespecToTime</span><span class="op" id="2502461">(</span><span class="ident" id="2502462">fi</span><span class="op" id="2502464">.</span><span class="ident" id="2502465">Sys</span><span class="op" id="2502468">(</span><span class="op" id="2502469">)</span><span class="op" id="2502470">.</span><span class="op" id="2502471">(</span><span class="op" id="2502472">*</span><span class="ident" id="2502473">syscall</span><span class="op" id="2502480">.</span><span class="ident" id="2502481">Stat_t</span><span class="op" id="2502487">)</span><span class="op" id="2502488">.</span><span class="ident" id="2502489">Atim</span><span class="op" id="2502493">)</span><br>
<span class="lineno"></span><span class="op" id="2502495">}</span>
</div>
</body>
</html>
