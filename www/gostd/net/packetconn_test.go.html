<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html" class="current">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6517792">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6517848">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6517902">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6517953">//&nbsp;This&nbsp;file&nbsp;implements&nbsp;API&nbsp;tests&nbsp;across&nbsp;platforms&nbsp;and&nbsp;will&nbsp;never&nbsp;have&nbsp;a&nbsp;build</span><br>
<span class="lineno"></span><span class="comment" id="6518032">//&nbsp;tag.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6518041">package</span>&nbsp;<span class="ident" id="6518049">net</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="6518054">import</span>&nbsp;<span class="op" id="6518061">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6518064">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6518070">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6518081">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6518092">&#34;testing&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6518103">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="6518110">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6518113">func</span>&nbsp;<span class="ident" id="6518118">packetConnTestData</span><span class="op" id="6518136">(</span><span class="ident" id="6518137">t</span>&nbsp;<span class="op" id="6518139">*</span><span class="ident" id="6518140">testing</span><span class="op" id="6518147">.</span><span class="ident" id="6518148">T</span><span class="op" id="6518149">,</span>&nbsp;<span class="ident" id="6518151">net</span>&nbsp;<span class="builtintype" id="6518155">string</span><span class="op" id="6518161">,</span>&nbsp;<span class="ident" id="6518163">i</span>&nbsp;<span class="builtintype" id="6518165">int</span><span class="op" id="6518168">)</span>&nbsp;<span class="op" id="6518170">(</span><span class="op" id="6518171">[</span><span class="op" id="6518172">]</span><span class="builtintype" id="6518173">byte</span><span class="op" id="6518177">,</span>&nbsp;<span class="keyword" id="6518179">func</span><span class="op" id="6518183">(</span><span class="op" id="6518184">)</span><span class="op" id="6518185">)</span>&nbsp;<span class="op" id="6518187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6518190">switch</span>&nbsp;<span class="ident" id="6518197">net</span>&nbsp;<span class="op" id="6518201">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6518204">case</span>&nbsp;<span class="string" id="6518209">&#34;udp&#34;</span><span class="op" id="6518214">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6518218">return</span>&nbsp;<span class="op" id="6518225">[</span><span class="op" id="6518226">]</span><span class="builtintype" id="6518227">byte</span><span class="op" id="6518231">(</span><span class="string" id="6518232">&#34;UDP&nbsp;PACKETCONN&nbsp;TEST&#34;</span><span class="op" id="6518253">)</span><span class="op" id="6518254">,</span>&nbsp;<span class="builtintype" id="6518256">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6518261">case</span>&nbsp;<span class="string" id="6518266">&#34;ip&#34;</span><span class="op" id="6518270">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6518274">if</span>&nbsp;<span class="ident" id="6518277">skip</span><span class="op" id="6518281">,</span>&nbsp;<span class="ident" id="6518283">skipmsg</span>&nbsp;<span class="op" id="6518291">:=</span>&nbsp;<span class="ident" id="6518294">skipRawSocketTest</span><span class="op" id="6518311">(</span><span class="ident" id="6518312">t</span><span class="op" id="6518313">)</span><span class="op" id="6518314">;</span>&nbsp;<span class="ident" id="6518316">skip</span>&nbsp;<span class="op" id="6518321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6518326">return</span>&nbsp;<span class="builtintype" id="6518333">nil</span><span class="op" id="6518336">,</span>&nbsp;<span class="keyword" id="6518338">func</span><span class="op" id="6518342">(</span><span class="op" id="6518343">)</span>&nbsp;<span class="op" id="6518345">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6518351">t</span><span class="op" id="6518352">.</span><span class="ident" id="6518353">Logf</span><span class="op" id="6518357">(</span><span class="ident" id="6518358">skipmsg</span><span class="op" id="6518365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6518370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6518374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6518378">b</span><span class="op" id="6518379">,</span>&nbsp;<span class="ident" id="6518381">err</span>&nbsp;<span class="op" id="6518385">:=</span>&nbsp;<span class="op" id="6518388">(</span><span class="op" id="6518389">&amp;</span><span class="ident" id="6518390">icmpMessage</span><span class="op" id="6518401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6518406">Type</span><span class="op" id="6518410">:</span>&nbsp;<span class="ident" id="6518412">icmpv4EchoRequest</span><span class="op" id="6518429">,</span>&nbsp;<span class="ident" id="6518431">Code</span><span class="op" id="6518435">:</span>&nbsp;<span class="num" id="6518437">0</span><span class="op" id="6518438">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6518443">Body</span><span class="op" id="6518447">:</span>&nbsp;<span class="op" id="6518449">&amp;</span><span class="ident" id="6518450">icmpEcho</span><span class="op" id="6518458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6518464">ID</span><span class="op" id="6518466">:</span>&nbsp;<span class="ident" id="6518468">os</span><span class="op" id="6518470">.</span><span class="ident" id="6518471">Getpid</span><span class="op" id="6518477">(</span><span class="op" id="6518478">)</span>&nbsp;<span class="op" id="6518480">&amp;</span>&nbsp;<span class="num" id="6518482">0xffff</span><span class="op" id="6518488">,</span>&nbsp;<span class="ident" id="6518490">Seq</span><span class="op" id="6518493">:</span>&nbsp;<span class="ident" id="6518495">i</span>&nbsp;<span class="op" id="6518497">+</span>&nbsp;<span class="num" id="6518499">1</span><span class="op" id="6518500">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6518506">Data</span><span class="op" id="6518510">:</span>&nbsp;<span class="op" id="6518512">[</span><span class="op" id="6518513">]</span><span class="builtintype" id="6518514">byte</span><span class="op" id="6518518">(</span><span class="string" id="6518519">&#34;IP&nbsp;PACKETCONN&nbsp;TEST&#34;</span><span class="op" id="6518539">)</span><span class="op" id="6518540">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6518545">}</span><span class="op" id="6518546">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6518550">}</span><span class="op" id="6518551">)</span><span class="op" id="6518552">.</span><span class="ident" id="6518553">Marshal</span><span class="op" id="6518560">(</span><span class="op" id="6518561">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6518565">if</span>&nbsp;<span class="ident" id="6518568">err</span>&nbsp;<span class="op" id="6518572">!=</span>&nbsp;<span class="builtintype" id="6518575">nil</span>&nbsp;<span class="op" id="6518579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6518584">return</span>&nbsp;<span class="builtintype" id="6518591">nil</span><span class="op" id="6518594">,</span>&nbsp;<span class="keyword" id="6518596">func</span><span class="op" id="6518600">(</span><span class="op" id="6518601">)</span>&nbsp;<span class="op" id="6518603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6518609">t</span><span class="op" id="6518610">.</span><span class="ident" id="6518611">Fatalf</span><span class="op" id="6518617">(</span><span class="string" id="6518618">&#34;icmpMessage.Marshal&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6518650">,</span>&nbsp;<span class="ident" id="6518652">err</span><span class="op" id="6518655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6518660">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6518664">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6518668">return</span>&nbsp;<span class="ident" id="6518675">b</span><span class="op" id="6518676">,</span>&nbsp;<span class="builtintype" id="6518678">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6518683">case</span>&nbsp;<span class="string" id="6518688">&#34;unixgram&#34;</span><span class="op" id="6518698">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6518702">switch</span>&nbsp;<span class="ident" id="6518709">runtime</span><span class="op" id="6518716">.</span><span class="ident" id="6518717">GOOS</span>&nbsp;<span class="op" id="6518722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6518726">case</span>&nbsp;<span class="string" id="6518731">&#34;nacl&#34;</span><span class="op" id="6518737">,</span>&nbsp;<span class="string" id="6518739">&#34;plan9&#34;</span><span class="op" id="6518746">,</span>&nbsp;<span class="string" id="6518748">&#34;windows&#34;</span><span class="op" id="6518757">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6518762">return</span>&nbsp;<span class="builtintype" id="6518769">nil</span><span class="op" id="6518772">,</span>&nbsp;<span class="keyword" id="6518774">func</span><span class="op" id="6518778">(</span><span class="op" id="6518779">)</span>&nbsp;<span class="op" id="6518781">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6518787">t</span><span class="op" id="6518788">.</span><span class="ident" id="6518789">Logf</span><span class="op" id="6518793">(</span><span class="string" id="6518794">&#34;skipping&nbsp;%q&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6518818">,</span>&nbsp;<span class="ident" id="6518820">net</span><span class="op" id="6518823">,</span>&nbsp;<span class="ident" id="6518825">runtime</span><span class="op" id="6518832">.</span><span class="ident" id="6518833">GOOS</span><span class="op" id="6518837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6518842">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6518846">default</span><span class="op" id="6518853">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6518858">return</span>&nbsp;<span class="op" id="6518865">[</span><span class="op" id="6518866">]</span><span class="builtintype" id="6518867">byte</span><span class="op" id="6518871">(</span><span class="string" id="6518872">&#34;UNIXGRAM&nbsp;PACKETCONN&nbsp;TEST&#34;</span><span class="op" id="6518898">)</span><span class="op" id="6518899">,</span>&nbsp;<span class="builtintype" id="6518901">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6518907">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6518910">default</span><span class="op" id="6518917">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6518921">return</span>&nbsp;<span class="builtintype" id="6518928">nil</span><span class="op" id="6518931">,</span>&nbsp;<span class="keyword" id="6518933">func</span><span class="op" id="6518937">(</span><span class="op" id="6518938">)</span>&nbsp;<span class="op" id="6518940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6518945">t</span><span class="op" id="6518946">.</span><span class="ident" id="6518947">Logf</span><span class="op" id="6518951">(</span><span class="string" id="6518952">&#34;skipping&nbsp;%q&nbsp;test&#34;</span><span class="op" id="6518970">,</span>&nbsp;<span class="ident" id="6518972">net</span><span class="op" id="6518975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6518979">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6518982">}</span><br>
<span class="lineno">55</span><span class="op" id="6518984">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6518987">var</span>&nbsp;<span class="ident" id="6518991">packetConnTests</span>&nbsp;<span class="op" id="6519007">=</span>&nbsp;<span class="op" id="6519009">[</span><span class="op" id="6519010">]</span><span class="keyword" id="6519011">struct</span>&nbsp;<span class="op" id="6519018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6519021">net</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6519027">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6519035">addr1</span>&nbsp;<span class="builtintype" id="6519041">string</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6519049">addr2</span>&nbsp;<span class="builtintype" id="6519055">string</span><br>
<span class="lineno"></span><span class="op" id="6519062">}</span><span class="op" id="6519063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6519066">{</span><span class="string" id="6519067">&#34;udp&#34;</span><span class="op" id="6519072">,</span>&nbsp;<span class="string" id="6519074">&#34;127.0.0.1:0&#34;</span><span class="op" id="6519087">,</span>&nbsp;<span class="string" id="6519089">&#34;127.0.0.1:0&#34;</span><span class="op" id="6519102">}</span><span class="op" id="6519103">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6519106">{</span><span class="string" id="6519107">&#34;ip:icmp&#34;</span><span class="op" id="6519116">,</span>&nbsp;<span class="string" id="6519118">&#34;127.0.0.1&#34;</span><span class="op" id="6519129">,</span>&nbsp;<span class="string" id="6519131">&#34;127.0.0.1&#34;</span><span class="op" id="6519142">}</span><span class="op" id="6519143">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6519146">{</span><span class="string" id="6519147">&#34;unixgram&#34;</span><span class="op" id="6519157">,</span>&nbsp;<span class="ident" id="6519159">testUnixAddr</span><span class="op" id="6519171">(</span><span class="op" id="6519172">)</span><span class="op" id="6519173">,</span>&nbsp;<span class="ident" id="6519175">testUnixAddr</span><span class="op" id="6519187">(</span><span class="op" id="6519188">)</span><span class="op" id="6519189">}</span><span class="op" id="6519190">,</span><br>
<span class="lineno">65</span><span class="op" id="6519192">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6519195">func</span>&nbsp;<span class="ident" id="6519200">TestPacketConn</span><span class="op" id="6519214">(</span><span class="ident" id="6519215">t</span>&nbsp;<span class="op" id="6519217">*</span><span class="ident" id="6519218">testing</span><span class="op" id="6519225">.</span><span class="ident" id="6519226">T</span><span class="op" id="6519227">)</span>&nbsp;<span class="op" id="6519229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6519232">closer</span>&nbsp;<span class="op" id="6519239">:=</span>&nbsp;<span class="keyword" id="6519242">func</span><span class="op" id="6519246">(</span><span class="ident" id="6519247">c</span>&nbsp;<span class="ident" id="6519249">PacketConn</span><span class="op" id="6519259">,</span>&nbsp;<span class="ident" id="6519261">net</span><span class="op" id="6519264">,</span>&nbsp;<span class="ident" id="6519266">addr1</span><span class="op" id="6519271">,</span>&nbsp;<span class="ident" id="6519273">addr2</span>&nbsp;<span class="builtintype" id="6519279">string</span><span class="op" id="6519285">)</span>&nbsp;<span class="op" id="6519287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6519291">c</span><span class="op" id="6519292">.</span><span class="ident" id="6519293">Close</span><span class="op" id="6519298">(</span><span class="op" id="6519299">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6519303">switch</span>&nbsp;<span class="ident" id="6519310">net</span>&nbsp;<span class="op" id="6519314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6519318">case</span>&nbsp;<span class="string" id="6519323">&#34;unixgram&#34;</span><span class="op" id="6519333">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6519338">os</span><span class="op" id="6519340">.</span><span class="ident" id="6519341">Remove</span><span class="op" id="6519347">(</span><span class="ident" id="6519348">addr1</span><span class="op" id="6519353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6519358">os</span><span class="op" id="6519360">.</span><span class="ident" id="6519361">Remove</span><span class="op" id="6519367">(</span><span class="ident" id="6519368">addr2</span><span class="op" id="6519373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6519377">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6519380">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6519384">for</span>&nbsp;<span class="ident" id="6519388">i</span><span class="op" id="6519389">,</span>&nbsp;<span class="ident" id="6519391">tt</span>&nbsp;<span class="op" id="6519394">:=</span>&nbsp;<span class="keyword" id="6519397">range</span>&nbsp;<span class="ident" id="6519403">packetConnTests</span>&nbsp;<span class="op" id="6519419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6519423">netstr</span>&nbsp;<span class="op" id="6519430">:=</span>&nbsp;<span class="ident" id="6519433">strings</span><span class="op" id="6519440">.</span><span class="ident" id="6519441">Split</span><span class="op" id="6519446">(</span><span class="ident" id="6519447">tt</span><span class="op" id="6519449">.</span><span class="ident" id="6519450">net</span><span class="op" id="6519453">,</span>&nbsp;<span class="string" id="6519455">&#34;:&#34;</span><span class="op" id="6519458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6519462">wb</span><span class="op" id="6519464">,</span>&nbsp;<span class="ident" id="6519466">skipOrFatalFn</span>&nbsp;<span class="op" id="6519480">:=</span>&nbsp;<span class="ident" id="6519483">packetConnTestData</span><span class="op" id="6519501">(</span><span class="ident" id="6519502">t</span><span class="op" id="6519503">,</span>&nbsp;<span class="ident" id="6519505">netstr</span><span class="op" id="6519511">[</span><span class="num" id="6519512">0</span><span class="op" id="6519513">]</span><span class="op" id="6519514">,</span>&nbsp;<span class="ident" id="6519516">i</span><span class="op" id="6519517">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6519521">if</span>&nbsp;<span class="ident" id="6519524">skipOrFatalFn</span>&nbsp;<span class="op" id="6519538">!=</span>&nbsp;<span class="builtintype" id="6519541">nil</span>&nbsp;<span class="op" id="6519545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6519550">skipOrFatalFn</span><span class="op" id="6519563">(</span><span class="op" id="6519564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6519569">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6519580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6519585">c1</span><span class="op" id="6519587">,</span>&nbsp;<span class="ident" id="6519589">err</span>&nbsp;<span class="op" id="6519593">:=</span>&nbsp;<span class="ident" id="6519596">ListenPacket</span><span class="op" id="6519608">(</span><span class="ident" id="6519609">tt</span><span class="op" id="6519611">.</span><span class="ident" id="6519612">net</span><span class="op" id="6519615">,</span>&nbsp;<span class="ident" id="6519617">tt</span><span class="op" id="6519619">.</span><span class="ident" id="6519620">addr1</span><span class="op" id="6519625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6519629">if</span>&nbsp;<span class="ident" id="6519632">err</span>&nbsp;<span class="op" id="6519636">!=</span>&nbsp;<span class="builtintype" id="6519639">nil</span>&nbsp;<span class="op" id="6519643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6519648">t</span><span class="op" id="6519649">.</span><span class="ident" id="6519650">Fatalf</span><span class="op" id="6519656">(</span><span class="string" id="6519657">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6519682">,</span>&nbsp;<span class="ident" id="6519684">err</span><span class="op" id="6519687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6519691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6519695">defer</span>&nbsp;<span class="ident" id="6519701">closer</span><span class="op" id="6519707">(</span><span class="ident" id="6519708">c1</span><span class="op" id="6519710">,</span>&nbsp;<span class="ident" id="6519712">netstr</span><span class="op" id="6519718">[</span><span class="num" id="6519719">0</span><span class="op" id="6519720">]</span><span class="op" id="6519721">,</span>&nbsp;<span class="ident" id="6519723">tt</span><span class="op" id="6519725">.</span><span class="ident" id="6519726">addr1</span><span class="op" id="6519731">,</span>&nbsp;<span class="ident" id="6519733">tt</span><span class="op" id="6519735">.</span><span class="ident" id="6519736">addr2</span><span class="op" id="6519741">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6519745">c1</span><span class="op" id="6519747">.</span><span class="ident" id="6519748">LocalAddr</span><span class="op" id="6519757">(</span><span class="op" id="6519758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6519762">c1</span><span class="op" id="6519764">.</span><span class="ident" id="6519765">SetDeadline</span><span class="op" id="6519776">(</span><span class="ident" id="6519777">time</span><span class="op" id="6519781">.</span><span class="ident" id="6519782">Now</span><span class="op" id="6519785">(</span><span class="op" id="6519786">)</span><span class="op" id="6519787">.</span><span class="ident" id="6519788">Add</span><span class="op" id="6519791">(</span><span class="num" id="6519792">100</span>&nbsp;<span class="op" id="6519796">*</span>&nbsp;<span class="ident" id="6519798">time</span><span class="op" id="6519802">.</span><span class="ident" id="6519803">Millisecond</span><span class="op" id="6519814">)</span><span class="op" id="6519815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6519819">c1</span><span class="op" id="6519821">.</span><span class="ident" id="6519822">SetReadDeadline</span><span class="op" id="6519837">(</span><span class="ident" id="6519838">time</span><span class="op" id="6519842">.</span><span class="ident" id="6519843">Now</span><span class="op" id="6519846">(</span><span class="op" id="6519847">)</span><span class="op" id="6519848">.</span><span class="ident" id="6519849">Add</span><span class="op" id="6519852">(</span><span class="num" id="6519853">100</span>&nbsp;<span class="op" id="6519857">*</span>&nbsp;<span class="ident" id="6519859">time</span><span class="op" id="6519863">.</span><span class="ident" id="6519864">Millisecond</span><span class="op" id="6519875">)</span><span class="op" id="6519876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6519880">c1</span><span class="op" id="6519882">.</span><span class="ident" id="6519883">SetWriteDeadline</span><span class="op" id="6519899">(</span><span class="ident" id="6519900">time</span><span class="op" id="6519904">.</span><span class="ident" id="6519905">Now</span><span class="op" id="6519908">(</span><span class="op" id="6519909">)</span><span class="op" id="6519910">.</span><span class="ident" id="6519911">Add</span><span class="op" id="6519914">(</span><span class="num" id="6519915">100</span>&nbsp;<span class="op" id="6519919">*</span>&nbsp;<span class="ident" id="6519921">time</span><span class="op" id="6519925">.</span><span class="ident" id="6519926">Millisecond</span><span class="op" id="6519937">)</span><span class="op" id="6519938">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6519943">c2</span><span class="op" id="6519945">,</span>&nbsp;<span class="ident" id="6519947">err</span>&nbsp;<span class="op" id="6519951">:=</span>&nbsp;<span class="ident" id="6519954">ListenPacket</span><span class="op" id="6519966">(</span><span class="ident" id="6519967">tt</span><span class="op" id="6519969">.</span><span class="ident" id="6519970">net</span><span class="op" id="6519973">,</span>&nbsp;<span class="ident" id="6519975">tt</span><span class="op" id="6519977">.</span><span class="ident" id="6519978">addr2</span><span class="op" id="6519983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6519987">if</span>&nbsp;<span class="ident" id="6519990">err</span>&nbsp;<span class="op" id="6519994">!=</span>&nbsp;<span class="builtintype" id="6519997">nil</span>&nbsp;<span class="op" id="6520001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6520006">t</span><span class="op" id="6520007">.</span><span class="ident" id="6520008">Fatalf</span><span class="op" id="6520014">(</span><span class="string" id="6520015">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6520040">,</span>&nbsp;<span class="ident" id="6520042">err</span><span class="op" id="6520045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6520049">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6520053">defer</span>&nbsp;<span class="ident" id="6520059">closer</span><span class="op" id="6520065">(</span><span class="ident" id="6520066">c2</span><span class="op" id="6520068">,</span>&nbsp;<span class="ident" id="6520070">netstr</span><span class="op" id="6520076">[</span><span class="num" id="6520077">0</span><span class="op" id="6520078">]</span><span class="op" id="6520079">,</span>&nbsp;<span class="ident" id="6520081">tt</span><span class="op" id="6520083">.</span><span class="ident" id="6520084">addr1</span><span class="op" id="6520089">,</span>&nbsp;<span class="ident" id="6520091">tt</span><span class="op" id="6520093">.</span><span class="ident" id="6520094">addr2</span><span class="op" id="6520099">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6520103">c2</span><span class="op" id="6520105">.</span><span class="ident" id="6520106">LocalAddr</span><span class="op" id="6520115">(</span><span class="op" id="6520116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6520120">c2</span><span class="op" id="6520122">.</span><span class="ident" id="6520123">SetDeadline</span><span class="op" id="6520134">(</span><span class="ident" id="6520135">time</span><span class="op" id="6520139">.</span><span class="ident" id="6520140">Now</span><span class="op" id="6520143">(</span><span class="op" id="6520144">)</span><span class="op" id="6520145">.</span><span class="ident" id="6520146">Add</span><span class="op" id="6520149">(</span><span class="num" id="6520150">100</span>&nbsp;<span class="op" id="6520154">*</span>&nbsp;<span class="ident" id="6520156">time</span><span class="op" id="6520160">.</span><span class="ident" id="6520161">Millisecond</span><span class="op" id="6520172">)</span><span class="op" id="6520173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6520177">c2</span><span class="op" id="6520179">.</span><span class="ident" id="6520180">SetReadDeadline</span><span class="op" id="6520195">(</span><span class="ident" id="6520196">time</span><span class="op" id="6520200">.</span><span class="ident" id="6520201">Now</span><span class="op" id="6520204">(</span><span class="op" id="6520205">)</span><span class="op" id="6520206">.</span><span class="ident" id="6520207">Add</span><span class="op" id="6520210">(</span><span class="num" id="6520211">100</span>&nbsp;<span class="op" id="6520215">*</span>&nbsp;<span class="ident" id="6520217">time</span><span class="op" id="6520221">.</span><span class="ident" id="6520222">Millisecond</span><span class="op" id="6520233">)</span><span class="op" id="6520234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6520238">c2</span><span class="op" id="6520240">.</span><span class="ident" id="6520241">SetWriteDeadline</span><span class="op" id="6520257">(</span><span class="ident" id="6520258">time</span><span class="op" id="6520262">.</span><span class="ident" id="6520263">Now</span><span class="op" id="6520266">(</span><span class="op" id="6520267">)</span><span class="op" id="6520268">.</span><span class="ident" id="6520269">Add</span><span class="op" id="6520272">(</span><span class="num" id="6520273">100</span>&nbsp;<span class="op" id="6520277">*</span>&nbsp;<span class="ident" id="6520279">time</span><span class="op" id="6520283">.</span><span class="ident" id="6520284">Millisecond</span><span class="op" id="6520295">)</span><span class="op" id="6520296">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6520301">if</span>&nbsp;<span class="ident" id="6520304">_</span><span class="op" id="6520305">,</span>&nbsp;<span class="ident" id="6520307">err</span>&nbsp;<span class="op" id="6520311">:=</span>&nbsp;<span class="ident" id="6520314">c1</span><span class="op" id="6520316">.</span><span class="ident" id="6520317">WriteTo</span><span class="op" id="6520324">(</span><span class="ident" id="6520325">wb</span><span class="op" id="6520327">,</span>&nbsp;<span class="ident" id="6520329">c2</span><span class="op" id="6520331">.</span><span class="ident" id="6520332">LocalAddr</span><span class="op" id="6520341">(</span><span class="op" id="6520342">)</span><span class="op" id="6520343">)</span><span class="op" id="6520344">;</span>&nbsp;<span class="ident" id="6520346">err</span>&nbsp;<span class="op" id="6520350">!=</span>&nbsp;<span class="builtintype" id="6520353">nil</span>&nbsp;<span class="op" id="6520357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6520362">t</span><span class="op" id="6520363">.</span><span class="ident" id="6520364">Fatalf</span><span class="op" id="6520370">(</span><span class="string" id="6520371">&#34;PacketConn.WriteTo&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6520402">,</span>&nbsp;<span class="ident" id="6520404">err</span><span class="op" id="6520407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6520411">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6520415">rb2</span>&nbsp;<span class="op" id="6520419">:=</span>&nbsp;<span class="builtinfunc" id="6520422">make</span><span class="op" id="6520426">(</span><span class="op" id="6520427">[</span><span class="op" id="6520428">]</span><span class="builtintype" id="6520429">byte</span><span class="op" id="6520433">,</span>&nbsp;<span class="num" id="6520435">128</span><span class="op" id="6520438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6520442">if</span>&nbsp;<span class="ident" id="6520445">_</span><span class="op" id="6520446">,</span>&nbsp;<span class="ident" id="6520448">_</span><span class="op" id="6520449">,</span>&nbsp;<span class="ident" id="6520451">err</span>&nbsp;<span class="op" id="6520455">:=</span>&nbsp;<span class="ident" id="6520458">c2</span><span class="op" id="6520460">.</span><span class="ident" id="6520461">ReadFrom</span><span class="op" id="6520469">(</span><span class="ident" id="6520470">rb2</span><span class="op" id="6520473">)</span><span class="op" id="6520474">;</span>&nbsp;<span class="ident" id="6520476">err</span>&nbsp;<span class="op" id="6520480">!=</span>&nbsp;<span class="builtintype" id="6520483">nil</span>&nbsp;<span class="op" id="6520487">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6520492">t</span><span class="op" id="6520493">.</span><span class="ident" id="6520494">Fatalf</span><span class="op" id="6520500">(</span><span class="string" id="6520501">&#34;PacketConn.ReadFrom&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6520533">,</span>&nbsp;<span class="ident" id="6520535">err</span><span class="op" id="6520538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6520542">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6520546">if</span>&nbsp;<span class="ident" id="6520549">_</span><span class="op" id="6520550">,</span>&nbsp;<span class="ident" id="6520552">err</span>&nbsp;<span class="op" id="6520556">:=</span>&nbsp;<span class="ident" id="6520559">c2</span><span class="op" id="6520561">.</span><span class="ident" id="6520562">WriteTo</span><span class="op" id="6520569">(</span><span class="ident" id="6520570">wb</span><span class="op" id="6520572">,</span>&nbsp;<span class="ident" id="6520574">c1</span><span class="op" id="6520576">.</span><span class="ident" id="6520577">LocalAddr</span><span class="op" id="6520586">(</span><span class="op" id="6520587">)</span><span class="op" id="6520588">)</span><span class="op" id="6520589">;</span>&nbsp;<span class="ident" id="6520591">err</span>&nbsp;<span class="op" id="6520595">!=</span>&nbsp;<span class="builtintype" id="6520598">nil</span>&nbsp;<span class="op" id="6520602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6520607">t</span><span class="op" id="6520608">.</span><span class="ident" id="6520609">Fatalf</span><span class="op" id="6520615">(</span><span class="string" id="6520616">&#34;PacketConn.WriteTo&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6520647">,</span>&nbsp;<span class="ident" id="6520649">err</span><span class="op" id="6520652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6520656">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6520660">rb1</span>&nbsp;<span class="op" id="6520664">:=</span>&nbsp;<span class="builtinfunc" id="6520667">make</span><span class="op" id="6520671">(</span><span class="op" id="6520672">[</span><span class="op" id="6520673">]</span><span class="builtintype" id="6520674">byte</span><span class="op" id="6520678">,</span>&nbsp;<span class="num" id="6520680">128</span><span class="op" id="6520683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6520687">if</span>&nbsp;<span class="ident" id="6520690">_</span><span class="op" id="6520691">,</span>&nbsp;<span class="ident" id="6520693">_</span><span class="op" id="6520694">,</span>&nbsp;<span class="ident" id="6520696">err</span>&nbsp;<span class="op" id="6520700">:=</span>&nbsp;<span class="ident" id="6520703">c1</span><span class="op" id="6520705">.</span><span class="ident" id="6520706">ReadFrom</span><span class="op" id="6520714">(</span><span class="ident" id="6520715">rb1</span><span class="op" id="6520718">)</span><span class="op" id="6520719">;</span>&nbsp;<span class="ident" id="6520721">err</span>&nbsp;<span class="op" id="6520725">!=</span>&nbsp;<span class="builtintype" id="6520728">nil</span>&nbsp;<span class="op" id="6520732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6520737">t</span><span class="op" id="6520738">.</span><span class="ident" id="6520739">Fatalf</span><span class="op" id="6520745">(</span><span class="string" id="6520746">&#34;PacketConn.ReadFrom&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6520778">,</span>&nbsp;<span class="ident" id="6520780">err</span><span class="op" id="6520783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6520787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6520790">}</span><br>
<span class="lineno">120</span><span class="op" id="6520792">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6520795">func</span>&nbsp;<span class="ident" id="6520800">TestConnAndPacketConn</span><span class="op" id="6520821">(</span><span class="ident" id="6520822">t</span>&nbsp;<span class="op" id="6520824">*</span><span class="ident" id="6520825">testing</span><span class="op" id="6520832">.</span><span class="ident" id="6520833">T</span><span class="op" id="6520834">)</span>&nbsp;<span class="op" id="6520836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6520839">closer</span>&nbsp;<span class="op" id="6520846">:=</span>&nbsp;<span class="keyword" id="6520849">func</span><span class="op" id="6520853">(</span><span class="ident" id="6520854">c</span>&nbsp;<span class="ident" id="6520856">PacketConn</span><span class="op" id="6520866">,</span>&nbsp;<span class="ident" id="6520868">net</span><span class="op" id="6520871">,</span>&nbsp;<span class="ident" id="6520873">addr1</span><span class="op" id="6520878">,</span>&nbsp;<span class="ident" id="6520880">addr2</span>&nbsp;<span class="builtintype" id="6520886">string</span><span class="op" id="6520892">)</span>&nbsp;<span class="op" id="6520894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6520898">c</span><span class="op" id="6520899">.</span><span class="ident" id="6520900">Close</span><span class="op" id="6520905">(</span><span class="op" id="6520906">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6520910">switch</span>&nbsp;<span class="ident" id="6520917">net</span>&nbsp;<span class="op" id="6520921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6520925">case</span>&nbsp;<span class="string" id="6520930">&#34;unixgram&#34;</span><span class="op" id="6520940">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6520945">os</span><span class="op" id="6520947">.</span><span class="ident" id="6520948">Remove</span><span class="op" id="6520954">(</span><span class="ident" id="6520955">addr1</span><span class="op" id="6520960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6520965">os</span><span class="op" id="6520967">.</span><span class="ident" id="6520968">Remove</span><span class="op" id="6520974">(</span><span class="ident" id="6520975">addr2</span><span class="op" id="6520980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6520984">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6520987">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6520991">for</span>&nbsp;<span class="ident" id="6520995">i</span><span class="op" id="6520996">,</span>&nbsp;<span class="ident" id="6520998">tt</span>&nbsp;<span class="op" id="6521001">:=</span>&nbsp;<span class="keyword" id="6521004">range</span>&nbsp;<span class="ident" id="6521010">packetConnTests</span>&nbsp;<span class="op" id="6521026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6521030">var</span>&nbsp;<span class="ident" id="6521034">wb</span>&nbsp;<span class="op" id="6521037">[</span><span class="op" id="6521038">]</span><span class="builtintype" id="6521039">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6521046">netstr</span>&nbsp;<span class="op" id="6521053">:=</span>&nbsp;<span class="ident" id="6521056">strings</span><span class="op" id="6521063">.</span><span class="ident" id="6521064">Split</span><span class="op" id="6521069">(</span><span class="ident" id="6521070">tt</span><span class="op" id="6521072">.</span><span class="ident" id="6521073">net</span><span class="op" id="6521076">,</span>&nbsp;<span class="string" id="6521078">&#34;:&#34;</span><span class="op" id="6521081">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6521085">wb</span><span class="op" id="6521087">,</span>&nbsp;<span class="ident" id="6521089">skipOrFatalFn</span>&nbsp;<span class="op" id="6521103">:=</span>&nbsp;<span class="ident" id="6521106">packetConnTestData</span><span class="op" id="6521124">(</span><span class="ident" id="6521125">t</span><span class="op" id="6521126">,</span>&nbsp;<span class="ident" id="6521128">netstr</span><span class="op" id="6521134">[</span><span class="num" id="6521135">0</span><span class="op" id="6521136">]</span><span class="op" id="6521137">,</span>&nbsp;<span class="ident" id="6521139">i</span><span class="op" id="6521140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6521144">if</span>&nbsp;<span class="ident" id="6521147">skipOrFatalFn</span>&nbsp;<span class="op" id="6521161">!=</span>&nbsp;<span class="builtintype" id="6521164">nil</span>&nbsp;<span class="op" id="6521168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6521173">skipOrFatalFn</span><span class="op" id="6521186">(</span><span class="op" id="6521187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6521192">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6521203">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6521208">c1</span><span class="op" id="6521210">,</span>&nbsp;<span class="ident" id="6521212">err</span>&nbsp;<span class="op" id="6521216">:=</span>&nbsp;<span class="ident" id="6521219">ListenPacket</span><span class="op" id="6521231">(</span><span class="ident" id="6521232">tt</span><span class="op" id="6521234">.</span><span class="ident" id="6521235">net</span><span class="op" id="6521238">,</span>&nbsp;<span class="ident" id="6521240">tt</span><span class="op" id="6521242">.</span><span class="ident" id="6521243">addr1</span><span class="op" id="6521248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6521252">if</span>&nbsp;<span class="ident" id="6521255">err</span>&nbsp;<span class="op" id="6521259">!=</span>&nbsp;<span class="builtintype" id="6521262">nil</span>&nbsp;<span class="op" id="6521266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6521271">t</span><span class="op" id="6521272">.</span><span class="ident" id="6521273">Fatalf</span><span class="op" id="6521279">(</span><span class="string" id="6521280">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6521305">,</span>&nbsp;<span class="ident" id="6521307">err</span><span class="op" id="6521310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6521314">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6521318">defer</span>&nbsp;<span class="ident" id="6521324">closer</span><span class="op" id="6521330">(</span><span class="ident" id="6521331">c1</span><span class="op" id="6521333">,</span>&nbsp;<span class="ident" id="6521335">netstr</span><span class="op" id="6521341">[</span><span class="num" id="6521342">0</span><span class="op" id="6521343">]</span><span class="op" id="6521344">,</span>&nbsp;<span class="ident" id="6521346">tt</span><span class="op" id="6521348">.</span><span class="ident" id="6521349">addr1</span><span class="op" id="6521354">,</span>&nbsp;<span class="ident" id="6521356">tt</span><span class="op" id="6521358">.</span><span class="ident" id="6521359">addr2</span><span class="op" id="6521364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6521368">c1</span><span class="op" id="6521370">.</span><span class="ident" id="6521371">LocalAddr</span><span class="op" id="6521380">(</span><span class="op" id="6521381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6521385">c1</span><span class="op" id="6521387">.</span><span class="ident" id="6521388">SetDeadline</span><span class="op" id="6521399">(</span><span class="ident" id="6521400">time</span><span class="op" id="6521404">.</span><span class="ident" id="6521405">Now</span><span class="op" id="6521408">(</span><span class="op" id="6521409">)</span><span class="op" id="6521410">.</span><span class="ident" id="6521411">Add</span><span class="op" id="6521414">(</span><span class="num" id="6521415">100</span>&nbsp;<span class="op" id="6521419">*</span>&nbsp;<span class="ident" id="6521421">time</span><span class="op" id="6521425">.</span><span class="ident" id="6521426">Millisecond</span><span class="op" id="6521437">)</span><span class="op" id="6521438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6521442">c1</span><span class="op" id="6521444">.</span><span class="ident" id="6521445">SetReadDeadline</span><span class="op" id="6521460">(</span><span class="ident" id="6521461">time</span><span class="op" id="6521465">.</span><span class="ident" id="6521466">Now</span><span class="op" id="6521469">(</span><span class="op" id="6521470">)</span><span class="op" id="6521471">.</span><span class="ident" id="6521472">Add</span><span class="op" id="6521475">(</span><span class="num" id="6521476">100</span>&nbsp;<span class="op" id="6521480">*</span>&nbsp;<span class="ident" id="6521482">time</span><span class="op" id="6521486">.</span><span class="ident" id="6521487">Millisecond</span><span class="op" id="6521498">)</span><span class="op" id="6521499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6521503">c1</span><span class="op" id="6521505">.</span><span class="ident" id="6521506">SetWriteDeadline</span><span class="op" id="6521522">(</span><span class="ident" id="6521523">time</span><span class="op" id="6521527">.</span><span class="ident" id="6521528">Now</span><span class="op" id="6521531">(</span><span class="op" id="6521532">)</span><span class="op" id="6521533">.</span><span class="ident" id="6521534">Add</span><span class="op" id="6521537">(</span><span class="num" id="6521538">100</span>&nbsp;<span class="op" id="6521542">*</span>&nbsp;<span class="ident" id="6521544">time</span><span class="op" id="6521548">.</span><span class="ident" id="6521549">Millisecond</span><span class="op" id="6521560">)</span><span class="op" id="6521561">)</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6521566">c2</span><span class="op" id="6521568">,</span>&nbsp;<span class="ident" id="6521570">err</span>&nbsp;<span class="op" id="6521574">:=</span>&nbsp;<span class="ident" id="6521577">Dial</span><span class="op" id="6521581">(</span><span class="ident" id="6521582">tt</span><span class="op" id="6521584">.</span><span class="ident" id="6521585">net</span><span class="op" id="6521588">,</span>&nbsp;<span class="ident" id="6521590">c1</span><span class="op" id="6521592">.</span><span class="ident" id="6521593">LocalAddr</span><span class="op" id="6521602">(</span><span class="op" id="6521603">)</span><span class="op" id="6521604">.</span><span class="ident" id="6521605">String</span><span class="op" id="6521611">(</span><span class="op" id="6521612">)</span><span class="op" id="6521613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6521617">if</span>&nbsp;<span class="ident" id="6521620">err</span>&nbsp;<span class="op" id="6521624">!=</span>&nbsp;<span class="builtintype" id="6521627">nil</span>&nbsp;<span class="op" id="6521631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6521636">t</span><span class="op" id="6521637">.</span><span class="ident" id="6521638">Fatalf</span><span class="op" id="6521644">(</span><span class="string" id="6521645">&#34;Dial&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6521662">,</span>&nbsp;<span class="ident" id="6521664">err</span><span class="op" id="6521667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6521671">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6521675">defer</span>&nbsp;<span class="ident" id="6521681">c2</span><span class="op" id="6521683">.</span><span class="ident" id="6521684">Close</span><span class="op" id="6521689">(</span><span class="op" id="6521690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6521694">c2</span><span class="op" id="6521696">.</span><span class="ident" id="6521697">LocalAddr</span><span class="op" id="6521706">(</span><span class="op" id="6521707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6521711">c2</span><span class="op" id="6521713">.</span><span class="ident" id="6521714">RemoteAddr</span><span class="op" id="6521724">(</span><span class="op" id="6521725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6521729">c2</span><span class="op" id="6521731">.</span><span class="ident" id="6521732">SetDeadline</span><span class="op" id="6521743">(</span><span class="ident" id="6521744">time</span><span class="op" id="6521748">.</span><span class="ident" id="6521749">Now</span><span class="op" id="6521752">(</span><span class="op" id="6521753">)</span><span class="op" id="6521754">.</span><span class="ident" id="6521755">Add</span><span class="op" id="6521758">(</span><span class="num" id="6521759">100</span>&nbsp;<span class="op" id="6521763">*</span>&nbsp;<span class="ident" id="6521765">time</span><span class="op" id="6521769">.</span><span class="ident" id="6521770">Millisecond</span><span class="op" id="6521781">)</span><span class="op" id="6521782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6521786">c2</span><span class="op" id="6521788">.</span><span class="ident" id="6521789">SetReadDeadline</span><span class="op" id="6521804">(</span><span class="ident" id="6521805">time</span><span class="op" id="6521809">.</span><span class="ident" id="6521810">Now</span><span class="op" id="6521813">(</span><span class="op" id="6521814">)</span><span class="op" id="6521815">.</span><span class="ident" id="6521816">Add</span><span class="op" id="6521819">(</span><span class="num" id="6521820">100</span>&nbsp;<span class="op" id="6521824">*</span>&nbsp;<span class="ident" id="6521826">time</span><span class="op" id="6521830">.</span><span class="ident" id="6521831">Millisecond</span><span class="op" id="6521842">)</span><span class="op" id="6521843">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6521847">c2</span><span class="op" id="6521849">.</span><span class="ident" id="6521850">SetWriteDeadline</span><span class="op" id="6521866">(</span><span class="ident" id="6521867">time</span><span class="op" id="6521871">.</span><span class="ident" id="6521872">Now</span><span class="op" id="6521875">(</span><span class="op" id="6521876">)</span><span class="op" id="6521877">.</span><span class="ident" id="6521878">Add</span><span class="op" id="6521881">(</span><span class="num" id="6521882">100</span>&nbsp;<span class="op" id="6521886">*</span>&nbsp;<span class="ident" id="6521888">time</span><span class="op" id="6521892">.</span><span class="ident" id="6521893">Millisecond</span><span class="op" id="6521904">)</span><span class="op" id="6521905">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6521910">if</span>&nbsp;<span class="ident" id="6521913">_</span><span class="op" id="6521914">,</span>&nbsp;<span class="ident" id="6521916">err</span>&nbsp;<span class="op" id="6521920">:=</span>&nbsp;<span class="ident" id="6521923">c2</span><span class="op" id="6521925">.</span><span class="ident" id="6521926">Write</span><span class="op" id="6521931">(</span><span class="ident" id="6521932">wb</span><span class="op" id="6521934">)</span><span class="op" id="6521935">;</span>&nbsp;<span class="ident" id="6521937">err</span>&nbsp;<span class="op" id="6521941">!=</span>&nbsp;<span class="builtintype" id="6521944">nil</span>&nbsp;<span class="op" id="6521948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6521953">t</span><span class="op" id="6521954">.</span><span class="ident" id="6521955">Fatalf</span><span class="op" id="6521961">(</span><span class="string" id="6521962">&#34;Conn.Write&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6521985">,</span>&nbsp;<span class="ident" id="6521987">err</span><span class="op" id="6521990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6521994">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6521998">rb1</span>&nbsp;<span class="op" id="6522002">:=</span>&nbsp;<span class="builtinfunc" id="6522005">make</span><span class="op" id="6522009">(</span><span class="op" id="6522010">[</span><span class="op" id="6522011">]</span><span class="builtintype" id="6522012">byte</span><span class="op" id="6522016">,</span>&nbsp;<span class="num" id="6522018">128</span><span class="op" id="6522021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6522025">if</span>&nbsp;<span class="ident" id="6522028">_</span><span class="op" id="6522029">,</span>&nbsp;<span class="ident" id="6522031">_</span><span class="op" id="6522032">,</span>&nbsp;<span class="ident" id="6522034">err</span>&nbsp;<span class="op" id="6522038">:=</span>&nbsp;<span class="ident" id="6522041">c1</span><span class="op" id="6522043">.</span><span class="ident" id="6522044">ReadFrom</span><span class="op" id="6522052">(</span><span class="ident" id="6522053">rb1</span><span class="op" id="6522056">)</span><span class="op" id="6522057">;</span>&nbsp;<span class="ident" id="6522059">err</span>&nbsp;<span class="op" id="6522063">!=</span>&nbsp;<span class="builtintype" id="6522066">nil</span>&nbsp;<span class="op" id="6522070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6522075">t</span><span class="op" id="6522076">.</span><span class="ident" id="6522077">Fatalf</span><span class="op" id="6522083">(</span><span class="string" id="6522084">&#34;PacketConn.ReadFrom&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6522116">,</span>&nbsp;<span class="ident" id="6522118">err</span><span class="op" id="6522121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6522125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6522129">var</span>&nbsp;<span class="ident" id="6522133">dst</span>&nbsp;<span class="ident" id="6522137">Addr</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6522144">switch</span>&nbsp;<span class="ident" id="6522151">netstr</span><span class="op" id="6522157">[</span><span class="num" id="6522158">0</span><span class="op" id="6522159">]</span>&nbsp;<span class="op" id="6522161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6522165">case</span>&nbsp;<span class="string" id="6522170">&#34;ip&#34;</span><span class="op" id="6522174">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6522179">dst</span>&nbsp;<span class="op" id="6522183">=</span>&nbsp;<span class="op" id="6522185">&amp;</span><span class="ident" id="6522186">IPAddr</span><span class="op" id="6522192">{</span><span class="ident" id="6522193">IP</span><span class="op" id="6522195">:</span>&nbsp;<span class="ident" id="6522197">IPv4</span><span class="op" id="6522201">(</span><span class="num" id="6522202">127</span><span class="op" id="6522205">,</span>&nbsp;<span class="num" id="6522207">0</span><span class="op" id="6522208">,</span>&nbsp;<span class="num" id="6522210">0</span><span class="op" id="6522211">,</span>&nbsp;<span class="num" id="6522213">1</span><span class="op" id="6522214">)</span><span class="op" id="6522215">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6522219">case</span>&nbsp;<span class="string" id="6522224">&#34;unixgram&#34;</span><span class="op" id="6522234">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6522239">continue</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6522250">default</span><span class="op" id="6522257">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6522262">dst</span>&nbsp;<span class="op" id="6522266">=</span>&nbsp;<span class="ident" id="6522268">c2</span><span class="op" id="6522270">.</span><span class="ident" id="6522271">LocalAddr</span><span class="op" id="6522280">(</span><span class="op" id="6522281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6522285">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6522289">if</span>&nbsp;<span class="ident" id="6522292">_</span><span class="op" id="6522293">,</span>&nbsp;<span class="ident" id="6522295">err</span>&nbsp;<span class="op" id="6522299">:=</span>&nbsp;<span class="ident" id="6522302">c1</span><span class="op" id="6522304">.</span><span class="ident" id="6522305">WriteTo</span><span class="op" id="6522312">(</span><span class="ident" id="6522313">wb</span><span class="op" id="6522315">,</span>&nbsp;<span class="ident" id="6522317">dst</span><span class="op" id="6522320">)</span><span class="op" id="6522321">;</span>&nbsp;<span class="ident" id="6522323">err</span>&nbsp;<span class="op" id="6522327">!=</span>&nbsp;<span class="builtintype" id="6522330">nil</span>&nbsp;<span class="op" id="6522334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6522339">t</span><span class="op" id="6522340">.</span><span class="ident" id="6522341">Fatalf</span><span class="op" id="6522347">(</span><span class="string" id="6522348">&#34;PacketConn.WriteTo&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6522379">,</span>&nbsp;<span class="ident" id="6522381">err</span><span class="op" id="6522384">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6522388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6522392">rb2</span>&nbsp;<span class="op" id="6522396">:=</span>&nbsp;<span class="builtinfunc" id="6522399">make</span><span class="op" id="6522403">(</span><span class="op" id="6522404">[</span><span class="op" id="6522405">]</span><span class="builtintype" id="6522406">byte</span><span class="op" id="6522410">,</span>&nbsp;<span class="num" id="6522412">128</span><span class="op" id="6522415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6522419">if</span>&nbsp;<span class="ident" id="6522422">_</span><span class="op" id="6522423">,</span>&nbsp;<span class="ident" id="6522425">err</span>&nbsp;<span class="op" id="6522429">:=</span>&nbsp;<span class="ident" id="6522432">c2</span><span class="op" id="6522434">.</span><span class="ident" id="6522435">Read</span><span class="op" id="6522439">(</span><span class="ident" id="6522440">rb2</span><span class="op" id="6522443">)</span><span class="op" id="6522444">;</span>&nbsp;<span class="ident" id="6522446">err</span>&nbsp;<span class="op" id="6522450">!=</span>&nbsp;<span class="builtintype" id="6522453">nil</span>&nbsp;<span class="op" id="6522457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6522462">t</span><span class="op" id="6522463">.</span><span class="ident" id="6522464">Fatalf</span><span class="op" id="6522470">(</span><span class="string" id="6522471">&#34;Conn.Read&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6522493">,</span>&nbsp;<span class="ident" id="6522495">err</span><span class="op" id="6522498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6522502">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6522505">}</span><br>
<span class="lineno"></span><span class="op" id="6522507">}</span>
</div>
</body>
</html>
