<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/cipher</h2>
<ul>
<li><a href="/gostd/crypto/cipher/benchmark_test.go.html">benchmark_test.go</a></li>
<li><a href="/gostd/crypto/cipher/cbc.go.html">cbc.go</a></li>
<li><a href="/gostd/crypto/cipher/cbc_aes_test.go.html">cbc_aes_test.go</a></li>
<li><a href="/gostd/crypto/cipher/cfb.go.html">cfb.go</a></li>
<li><a href="/gostd/crypto/cipher/cfb_test.go.html">cfb_test.go</a></li>
<li><a href="/gostd/crypto/cipher/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/cipher/cipher_test.go.html">cipher_test.go</a></li>
<li><a href="/gostd/crypto/cipher/common_test.go.html">common_test.go</a></li>
<li><a href="/gostd/crypto/cipher/ctr.go.html">ctr.go</a></li>
<li><a href="/gostd/crypto/cipher/ctr_aes_test.go.html">ctr_aes_test.go</a></li>
<li><a href="/gostd/crypto/cipher/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/cipher/gcm.go.html">gcm.go</a></li>
<li><a href="/gostd/crypto/cipher/gcm_test.go.html">gcm_test.go</a></li>
<li><a href="/gostd/crypto/cipher/io.go.html">io.go</a></li>
<li><a href="/gostd/crypto/cipher/ofb.go.html">ofb.go</a></li>
<li><a href="/gostd/crypto/cipher/ofb_test.go.html">ofb_test.go</a></li>
<li><a href="/gostd/crypto/cipher/xor.go.html">xor.go</a></li>
<li><a href="/gostd/crypto/cipher/xor_test.go.html">xor_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3816145">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3816200">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3816254">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3816305">//&nbsp;Counter&nbsp;(CTR)&nbsp;mode.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3816329">//&nbsp;CTR&nbsp;converts&nbsp;a&nbsp;block&nbsp;cipher&nbsp;into&nbsp;a&nbsp;stream&nbsp;cipher&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="3816384">//&nbsp;repeatedly&nbsp;encrypting&nbsp;an&nbsp;incrementing&nbsp;counter&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3816437">//&nbsp;xoring&nbsp;the&nbsp;resulting&nbsp;stream&nbsp;of&nbsp;data&nbsp;with&nbsp;the&nbsp;input.</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="3816493">//&nbsp;See&nbsp;NIST&nbsp;SP&nbsp;800-38A,&nbsp;pp&nbsp;13-15</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3816527">package</span>&nbsp;<span class="ident" id="3816535">cipher</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="3816543">type</span>&nbsp;<span class="ident" id="3816548">ctr</span>&nbsp;<span class="keyword" id="3816552">struct</span>&nbsp;<span class="op" id="3816559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3816562">b</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3816570">Block</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3816577">ctr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3816585">[</span><span class="op" id="3816586">]</span><span class="builtintype" id="3816587">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3816593">out</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3816601">[</span><span class="op" id="3816602">]</span><span class="builtintype" id="3816603">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3816609">outUsed</span>&nbsp;<span class="builtintype" id="3816617">int</span><br>
<span class="lineno">20</span><span class="op" id="3816621">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3816624">const</span>&nbsp;<span class="ident" id="3816630">streamBufferSize</span>&nbsp;<span class="op" id="3816647">=</span>&nbsp;<span class="num" id="3816649">512</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3816654">//&nbsp;NewCTR&nbsp;returns&nbsp;a&nbsp;Stream&nbsp;which&nbsp;encrypts/decrypts&nbsp;using&nbsp;the&nbsp;given&nbsp;Block&nbsp;in</span><br>
<span class="lineno">25</span><span class="comment" id="3816730">//&nbsp;counter&nbsp;mode.&nbsp;The&nbsp;length&nbsp;of&nbsp;iv&nbsp;must&nbsp;be&nbsp;the&nbsp;same&nbsp;as&nbsp;the&nbsp;Block&#39;s&nbsp;block&nbsp;size.</span><br>
<span class="lineno"></span><span class="keyword" id="3816808">func</span>&nbsp;<span class="ident" id="3816813">NewCTR</span><span class="op" id="3816819">(</span><span class="ident" id="3816820">block</span>&nbsp;<span class="ident" id="3816826">Block</span><span class="op" id="3816831">,</span>&nbsp;<span class="ident" id="3816833">iv</span>&nbsp;<span class="op" id="3816836">[</span><span class="op" id="3816837">]</span><span class="builtintype" id="3816838">byte</span><span class="op" id="3816842">)</span>&nbsp;<span class="ident" id="3816844">Stream</span>&nbsp;<span class="op" id="3816851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3816854">if</span>&nbsp;<span class="builtinfunc" id="3816857">len</span><span class="op" id="3816860">(</span><span class="ident" id="3816861">iv</span><span class="op" id="3816863">)</span>&nbsp;<span class="op" id="3816865">!=</span>&nbsp;<span class="ident" id="3816868">block</span><span class="op" id="3816873">.</span><span class="ident" id="3816874">BlockSize</span><span class="op" id="3816883">(</span><span class="op" id="3816884">)</span>&nbsp;<span class="op" id="3816886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3816890">panic</span><span class="op" id="3816895">(</span><span class="string" id="3816896">&#34;cipher.NewCTR:&nbsp;IV&nbsp;length&nbsp;must&nbsp;equal&nbsp;block&nbsp;size&#34;</span><span class="op" id="3816944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3816947">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3816950">bufSize</span>&nbsp;<span class="op" id="3816958">:=</span>&nbsp;<span class="ident" id="3816961">streamBufferSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3816979">if</span>&nbsp;<span class="ident" id="3816982">bufSize</span>&nbsp;<span class="op" id="3816990">&lt;</span>&nbsp;<span class="ident" id="3816992">block</span><span class="op" id="3816997">.</span><span class="ident" id="3816998">BlockSize</span><span class="op" id="3817007">(</span><span class="op" id="3817008">)</span>&nbsp;<span class="op" id="3817010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3817014">bufSize</span>&nbsp;<span class="op" id="3817022">=</span>&nbsp;<span class="ident" id="3817024">block</span><span class="op" id="3817029">.</span><span class="ident" id="3817030">BlockSize</span><span class="op" id="3817039">(</span><span class="op" id="3817040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3817043">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3817046">return</span>&nbsp;<span class="op" id="3817053">&amp;</span><span class="ident" id="3817054">ctr</span><span class="op" id="3817057">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3817061">b</span><span class="op" id="3817062">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3817070">block</span><span class="op" id="3817075">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3817079">ctr</span><span class="op" id="3817082">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3817088">dup</span><span class="op" id="3817091">(</span><span class="ident" id="3817092">iv</span><span class="op" id="3817094">)</span><span class="op" id="3817095">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3817099">out</span><span class="op" id="3817102">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3817108">make</span><span class="op" id="3817112">(</span><span class="op" id="3817113">[</span><span class="op" id="3817114">]</span><span class="builtintype" id="3817115">byte</span><span class="op" id="3817119">,</span>&nbsp;<span class="num" id="3817121">0</span><span class="op" id="3817122">,</span>&nbsp;<span class="ident" id="3817124">bufSize</span><span class="op" id="3817131">)</span><span class="op" id="3817132">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3817136">outUsed</span><span class="op" id="3817143">:</span>&nbsp;<span class="num" id="3817145">0</span><span class="op" id="3817146">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3817149">}</span><br>
<span class="lineno">40</span><span class="op" id="3817151">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3817154">func</span>&nbsp;<span class="op" id="3817159">(</span><span class="ident" id="3817160">x</span>&nbsp;<span class="op" id="3817162">*</span><span class="ident" id="3817163">ctr</span><span class="op" id="3817166">)</span>&nbsp;<span class="ident" id="3817168">refill</span><span class="op" id="3817174">(</span><span class="op" id="3817175">)</span>&nbsp;<span class="op" id="3817177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3817180">remain</span>&nbsp;<span class="op" id="3817187">:=</span>&nbsp;<span class="builtinfunc" id="3817190">len</span><span class="op" id="3817193">(</span><span class="ident" id="3817194">x</span><span class="op" id="3817195">.</span><span class="ident" id="3817196">out</span><span class="op" id="3817199">)</span>&nbsp;<span class="op" id="3817201">-</span>&nbsp;<span class="ident" id="3817203">x</span><span class="op" id="3817204">.</span><span class="ident" id="3817205">outUsed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3817214">if</span>&nbsp;<span class="ident" id="3817217">remain</span>&nbsp;<span class="op" id="3817224">&gt;</span>&nbsp;<span class="ident" id="3817226">x</span><span class="op" id="3817227">.</span><span class="ident" id="3817228">outUsed</span>&nbsp;<span class="op" id="3817236">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3817240">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3817248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3817251">copy</span><span class="op" id="3817255">(</span><span class="ident" id="3817256">x</span><span class="op" id="3817257">.</span><span class="ident" id="3817258">out</span><span class="op" id="3817261">,</span>&nbsp;<span class="ident" id="3817263">x</span><span class="op" id="3817264">.</span><span class="ident" id="3817265">out</span><span class="op" id="3817268">[</span><span class="ident" id="3817269">x</span><span class="op" id="3817270">.</span><span class="ident" id="3817271">outUsed</span><span class="op" id="3817278">:</span><span class="op" id="3817279">]</span><span class="op" id="3817280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3817283">x</span><span class="op" id="3817284">.</span><span class="ident" id="3817285">out</span>&nbsp;<span class="op" id="3817289">=</span>&nbsp;<span class="ident" id="3817291">x</span><span class="op" id="3817292">.</span><span class="ident" id="3817293">out</span><span class="op" id="3817296">[</span><span class="op" id="3817297">:</span><span class="builtinfunc" id="3817298">cap</span><span class="op" id="3817301">(</span><span class="ident" id="3817302">x</span><span class="op" id="3817303">.</span><span class="ident" id="3817304">out</span><span class="op" id="3817307">)</span><span class="op" id="3817308">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3817311">bs</span>&nbsp;<span class="op" id="3817314">:=</span>&nbsp;<span class="ident" id="3817317">x</span><span class="op" id="3817318">.</span><span class="ident" id="3817319">b</span><span class="op" id="3817320">.</span><span class="ident" id="3817321">BlockSize</span><span class="op" id="3817330">(</span><span class="op" id="3817331">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3817334">for</span>&nbsp;<span class="ident" id="3817338">remain</span>&nbsp;<span class="op" id="3817345">&lt;</span>&nbsp;<span class="builtinfunc" id="3817347">len</span><span class="op" id="3817350">(</span><span class="ident" id="3817351">x</span><span class="op" id="3817352">.</span><span class="ident" id="3817353">out</span><span class="op" id="3817356">)</span><span class="op" id="3817357">-</span><span class="ident" id="3817358">bs</span>&nbsp;<span class="op" id="3817361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3817365">x</span><span class="op" id="3817366">.</span><span class="ident" id="3817367">b</span><span class="op" id="3817368">.</span><span class="ident" id="3817369">Encrypt</span><span class="op" id="3817376">(</span><span class="ident" id="3817377">x</span><span class="op" id="3817378">.</span><span class="ident" id="3817379">out</span><span class="op" id="3817382">[</span><span class="ident" id="3817383">remain</span><span class="op" id="3817389">:</span><span class="op" id="3817390">]</span><span class="op" id="3817391">,</span>&nbsp;<span class="ident" id="3817393">x</span><span class="op" id="3817394">.</span><span class="ident" id="3817395">ctr</span><span class="op" id="3817398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3817402">remain</span>&nbsp;<span class="op" id="3817409">+=</span>&nbsp;<span class="ident" id="3817412">bs</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3817418">//&nbsp;Increment&nbsp;counter</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3817441">for</span>&nbsp;<span class="ident" id="3817445">i</span>&nbsp;<span class="op" id="3817447">:=</span>&nbsp;<span class="builtinfunc" id="3817450">len</span><span class="op" id="3817453">(</span><span class="ident" id="3817454">x</span><span class="op" id="3817455">.</span><span class="ident" id="3817456">ctr</span><span class="op" id="3817459">)</span>&nbsp;<span class="op" id="3817461">-</span>&nbsp;<span class="num" id="3817463">1</span><span class="op" id="3817464">;</span>&nbsp;<span class="ident" id="3817466">i</span>&nbsp;<span class="op" id="3817468">&gt;=</span>&nbsp;<span class="num" id="3817471">0</span><span class="op" id="3817472">;</span>&nbsp;<span class="ident" id="3817474">i</span><span class="op" id="3817475">--</span>&nbsp;<span class="op" id="3817478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3817483">x</span><span class="op" id="3817484">.</span><span class="ident" id="3817485">ctr</span><span class="op" id="3817488">[</span><span class="ident" id="3817489">i</span><span class="op" id="3817490">]</span><span class="op" id="3817491">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3817497">if</span>&nbsp;<span class="ident" id="3817500">x</span><span class="op" id="3817501">.</span><span class="ident" id="3817502">ctr</span><span class="op" id="3817505">[</span><span class="ident" id="3817506">i</span><span class="op" id="3817507">]</span>&nbsp;<span class="op" id="3817509">!=</span>&nbsp;<span class="num" id="3817512">0</span>&nbsp;<span class="op" id="3817514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3817520">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3817529">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3817533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3817536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3817539">x</span><span class="op" id="3817540">.</span><span class="ident" id="3817541">out</span>&nbsp;<span class="op" id="3817545">=</span>&nbsp;<span class="ident" id="3817547">x</span><span class="op" id="3817548">.</span><span class="ident" id="3817549">out</span><span class="op" id="3817552">[</span><span class="op" id="3817553">:</span><span class="ident" id="3817554">remain</span><span class="op" id="3817560">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3817563">x</span><span class="op" id="3817564">.</span><span class="ident" id="3817565">outUsed</span>&nbsp;<span class="op" id="3817573">=</span>&nbsp;<span class="num" id="3817575">0</span><br>
<span class="lineno"></span><span class="op" id="3817577">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="3817580">func</span>&nbsp;<span class="op" id="3817585">(</span><span class="ident" id="3817586">x</span>&nbsp;<span class="op" id="3817588">*</span><span class="ident" id="3817589">ctr</span><span class="op" id="3817592">)</span>&nbsp;<span class="ident" id="3817594">XORKeyStream</span><span class="op" id="3817606">(</span><span class="ident" id="3817607">dst</span><span class="op" id="3817610">,</span>&nbsp;<span class="ident" id="3817612">src</span>&nbsp;<span class="op" id="3817616">[</span><span class="op" id="3817617">]</span><span class="builtintype" id="3817618">byte</span><span class="op" id="3817622">)</span>&nbsp;<span class="op" id="3817624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3817627">for</span>&nbsp;<span class="builtinfunc" id="3817631">len</span><span class="op" id="3817634">(</span><span class="ident" id="3817635">src</span><span class="op" id="3817638">)</span>&nbsp;<span class="op" id="3817640">&gt;</span>&nbsp;<span class="num" id="3817642">0</span>&nbsp;<span class="op" id="3817644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3817648">if</span>&nbsp;<span class="ident" id="3817651">x</span><span class="op" id="3817652">.</span><span class="ident" id="3817653">outUsed</span>&nbsp;<span class="op" id="3817661">&gt;=</span>&nbsp;<span class="builtinfunc" id="3817664">len</span><span class="op" id="3817667">(</span><span class="ident" id="3817668">x</span><span class="op" id="3817669">.</span><span class="ident" id="3817670">out</span><span class="op" id="3817673">)</span><span class="op" id="3817674">-</span><span class="ident" id="3817675">x</span><span class="op" id="3817676">.</span><span class="ident" id="3817677">b</span><span class="op" id="3817678">.</span><span class="ident" id="3817679">BlockSize</span><span class="op" id="3817688">(</span><span class="op" id="3817689">)</span>&nbsp;<span class="op" id="3817691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3817696">x</span><span class="op" id="3817697">.</span><span class="ident" id="3817698">refill</span><span class="op" id="3817704">(</span><span class="op" id="3817705">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3817709">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3817713">n</span>&nbsp;<span class="op" id="3817715">:=</span>&nbsp;<span class="ident" id="3817718">xorBytes</span><span class="op" id="3817726">(</span><span class="ident" id="3817727">dst</span><span class="op" id="3817730">,</span>&nbsp;<span class="ident" id="3817732">src</span><span class="op" id="3817735">,</span>&nbsp;<span class="ident" id="3817737">x</span><span class="op" id="3817738">.</span><span class="ident" id="3817739">out</span><span class="op" id="3817742">[</span><span class="ident" id="3817743">x</span><span class="op" id="3817744">.</span><span class="ident" id="3817745">outUsed</span><span class="op" id="3817752">:</span><span class="op" id="3817753">]</span><span class="op" id="3817754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3817758">dst</span>&nbsp;<span class="op" id="3817762">=</span>&nbsp;<span class="ident" id="3817764">dst</span><span class="op" id="3817767">[</span><span class="ident" id="3817768">n</span><span class="op" id="3817769">:</span><span class="op" id="3817770">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3817774">src</span>&nbsp;<span class="op" id="3817778">=</span>&nbsp;<span class="ident" id="3817780">src</span><span class="op" id="3817783">[</span><span class="ident" id="3817784">n</span><span class="op" id="3817785">:</span><span class="op" id="3817786">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3817790">x</span><span class="op" id="3817791">.</span><span class="ident" id="3817792">outUsed</span>&nbsp;<span class="op" id="3817800">+=</span>&nbsp;<span class="ident" id="3817803">n</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3817806">}</span><br>
<span class="lineno"></span><span class="op" id="3817808">}</span>
</div>
</body>
</html>
