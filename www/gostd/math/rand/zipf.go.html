<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math/rand</h2>
<ul>
<li><a href="/gostd/math/rand/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/math/rand/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/rand/normal.go.html">normal.go</a></li>
<li><a href="/gostd/math/rand/rand.go.html">rand.go</a></li>
<li><a href="/gostd/math/rand/rand_test.go.html">rand_test.go</a></li>
<li><a href="/gostd/math/rand/regress_test.go.html">regress_test.go</a></li>
<li><a href="/gostd/math/rand/rng.go.html">rng.go</a></li>
<li><a href="/gostd/math/rand/zipf.go.html" class="current">zipf.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2921394">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2921449">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2921503">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2921554">//&nbsp;W.Hormann,&nbsp;G.Derflinger:</span><br>
<span class="lineno"></span><span class="comment" id="2921582">//&nbsp;&#34;Rejection-Inversion&nbsp;to&nbsp;Generate&nbsp;Variates</span><br>
<span class="lineno"></span><span class="comment" id="2921627">//&nbsp;from&nbsp;Monotone&nbsp;Discrete&nbsp;Distributions&#34;</span><br>
<span class="lineno"></span><span class="comment" id="2921668">//&nbsp;http://eeyore.wu-wien.ac.at/papers/96-04-04.wh-der.ps.gz</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="2921729">package</span>&nbsp;<span class="ident" id="2921737">rand</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2921743">import</span>&nbsp;<span class="string" id="2921750">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2921758">//&nbsp;A&nbsp;Zipf&nbsp;generates&nbsp;Zipf&nbsp;distributed&nbsp;variates.</span><br>
<span class="lineno">15</span><span class="keyword" id="2921805">type</span>&nbsp;<span class="ident" id="2921810">Zipf</span>&nbsp;<span class="keyword" id="2921815">struct</span>&nbsp;<span class="op" id="2921822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2921825">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2921838">*</span><span class="ident" id="2921839">Rand</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2921845">imax</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2921858">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2921867">v</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2921880">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2921889">q</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2921902">float64</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2921911">s</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2921924">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2921933">oneminusQ</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2921946">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2921955">oneminusQinv</span>&nbsp;<span class="builtintype" id="2921968">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2921977">hxm</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2921990">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2921999">hx0minusHxm</span>&nbsp;&nbsp;<span class="builtintype" id="2922012">float64</span><br>
<span class="lineno">25</span><span class="op" id="2922020">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2922023">func</span>&nbsp;<span class="op" id="2922028">(</span><span class="ident" id="2922029">z</span>&nbsp;<span class="op" id="2922031">*</span><span class="ident" id="2922032">Zipf</span><span class="op" id="2922036">)</span>&nbsp;<span class="ident" id="2922038">h</span><span class="op" id="2922039">(</span><span class="ident" id="2922040">x</span>&nbsp;<span class="builtintype" id="2922042">float64</span><span class="op" id="2922049">)</span>&nbsp;<span class="builtintype" id="2922051">float64</span>&nbsp;<span class="op" id="2922059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2922062">return</span>&nbsp;<span class="ident" id="2922069">math</span><span class="op" id="2922073">.</span><span class="ident" id="2922074">Exp</span><span class="op" id="2922077">(</span><span class="ident" id="2922078">z</span><span class="op" id="2922079">.</span><span class="ident" id="2922080">oneminusQ</span><span class="op" id="2922089">*</span><span class="ident" id="2922090">math</span><span class="op" id="2922094">.</span><span class="ident" id="2922095">Log</span><span class="op" id="2922098">(</span><span class="ident" id="2922099">z</span><span class="op" id="2922100">.</span><span class="ident" id="2922101">v</span><span class="op" id="2922102">+</span><span class="ident" id="2922103">x</span><span class="op" id="2922104">)</span><span class="op" id="2922105">)</span>&nbsp;<span class="op" id="2922107">*</span>&nbsp;<span class="ident" id="2922109">z</span><span class="op" id="2922110">.</span><span class="ident" id="2922111">oneminusQinv</span><br>
<span class="lineno"></span><span class="op" id="2922124">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="2922127">func</span>&nbsp;<span class="op" id="2922132">(</span><span class="ident" id="2922133">z</span>&nbsp;<span class="op" id="2922135">*</span><span class="ident" id="2922136">Zipf</span><span class="op" id="2922140">)</span>&nbsp;<span class="ident" id="2922142">hinv</span><span class="op" id="2922146">(</span><span class="ident" id="2922147">x</span>&nbsp;<span class="builtintype" id="2922149">float64</span><span class="op" id="2922156">)</span>&nbsp;<span class="builtintype" id="2922158">float64</span>&nbsp;<span class="op" id="2922166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2922169">return</span>&nbsp;<span class="ident" id="2922176">math</span><span class="op" id="2922180">.</span><span class="ident" id="2922181">Exp</span><span class="op" id="2922184">(</span><span class="ident" id="2922185">z</span><span class="op" id="2922186">.</span><span class="ident" id="2922187">oneminusQinv</span><span class="op" id="2922199">*</span><span class="ident" id="2922200">math</span><span class="op" id="2922204">.</span><span class="ident" id="2922205">Log</span><span class="op" id="2922208">(</span><span class="ident" id="2922209">z</span><span class="op" id="2922210">.</span><span class="ident" id="2922211">oneminusQ</span><span class="op" id="2922220">*</span><span class="ident" id="2922221">x</span><span class="op" id="2922222">)</span><span class="op" id="2922223">)</span>&nbsp;<span class="op" id="2922225">-</span>&nbsp;<span class="ident" id="2922227">z</span><span class="op" id="2922228">.</span><span class="ident" id="2922229">v</span><br>
<span class="lineno"></span><span class="op" id="2922231">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="2922234">//&nbsp;NewZipf&nbsp;returns&nbsp;a&nbsp;Zipf&nbsp;generating&nbsp;variates&nbsp;p(k)&nbsp;on&nbsp;[0,&nbsp;imax]</span><br>
<span class="lineno"></span><span class="comment" id="2922298">//&nbsp;proportional&nbsp;to&nbsp;(v+k)**(-s)&nbsp;where&nbsp;s&gt;1&nbsp;and&nbsp;k&gt;=0,&nbsp;and&nbsp;v&gt;=1.</span><br>
<span class="lineno"></span><span class="keyword" id="2922359">func</span>&nbsp;<span class="ident" id="2922364">NewZipf</span><span class="op" id="2922371">(</span><span class="ident" id="2922372">r</span>&nbsp;<span class="op" id="2922374">*</span><span class="ident" id="2922375">Rand</span><span class="op" id="2922379">,</span>&nbsp;<span class="ident" id="2922381">s</span>&nbsp;<span class="builtintype" id="2922383">float64</span><span class="op" id="2922390">,</span>&nbsp;<span class="ident" id="2922392">v</span>&nbsp;<span class="builtintype" id="2922394">float64</span><span class="op" id="2922401">,</span>&nbsp;<span class="ident" id="2922403">imax</span>&nbsp;<span class="ident" id="2922408">uint64</span><span class="op" id="2922414">)</span>&nbsp;<span class="op" id="2922416">*</span><span class="ident" id="2922417">Zipf</span>&nbsp;<span class="op" id="2922422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2922425">z</span>&nbsp;<span class="op" id="2922427">:=</span>&nbsp;<span class="builtinfunc" id="2922430">new</span><span class="op" id="2922433">(</span><span class="ident" id="2922434">Zipf</span><span class="op" id="2922438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2922441">if</span>&nbsp;<span class="ident" id="2922444">s</span>&nbsp;<span class="op" id="2922446">&lt;=</span>&nbsp;<span class="num" id="2922449">1.0</span>&nbsp;<span class="op" id="2922453">||</span>&nbsp;<span class="ident" id="2922456">v</span>&nbsp;<span class="op" id="2922458">&lt;</span>&nbsp;<span class="num" id="2922460">1</span>&nbsp;<span class="op" id="2922462">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2922466">return</span>&nbsp;<span class="builtintype" id="2922473">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2922478">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2922481">z</span><span class="op" id="2922482">.</span><span class="ident" id="2922483">r</span>&nbsp;<span class="op" id="2922485">=</span>&nbsp;<span class="ident" id="2922487">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2922490">z</span><span class="op" id="2922491">.</span><span class="ident" id="2922492">imax</span>&nbsp;<span class="op" id="2922497">=</span>&nbsp;<span class="builtintype" id="2922499">float64</span><span class="op" id="2922506">(</span><span class="ident" id="2922507">imax</span><span class="op" id="2922511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2922514">z</span><span class="op" id="2922515">.</span><span class="ident" id="2922516">v</span>&nbsp;<span class="op" id="2922518">=</span>&nbsp;<span class="ident" id="2922520">v</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2922523">z</span><span class="op" id="2922524">.</span><span class="ident" id="2922525">q</span>&nbsp;<span class="op" id="2922527">=</span>&nbsp;<span class="ident" id="2922529">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2922532">z</span><span class="op" id="2922533">.</span><span class="ident" id="2922534">oneminusQ</span>&nbsp;<span class="op" id="2922544">=</span>&nbsp;<span class="num" id="2922546">1.0</span>&nbsp;<span class="op" id="2922550">-</span>&nbsp;<span class="ident" id="2922552">z</span><span class="op" id="2922553">.</span><span class="ident" id="2922554">q</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2922557">z</span><span class="op" id="2922558">.</span><span class="ident" id="2922559">oneminusQinv</span>&nbsp;<span class="op" id="2922572">=</span>&nbsp;<span class="num" id="2922574">1.0</span>&nbsp;<span class="op" id="2922578">/</span>&nbsp;<span class="ident" id="2922580">z</span><span class="op" id="2922581">.</span><span class="ident" id="2922582">oneminusQ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2922593">z</span><span class="op" id="2922594">.</span><span class="ident" id="2922595">hxm</span>&nbsp;<span class="op" id="2922599">=</span>&nbsp;<span class="ident" id="2922601">z</span><span class="op" id="2922602">.</span><span class="ident" id="2922603">h</span><span class="op" id="2922604">(</span><span class="ident" id="2922605">z</span><span class="op" id="2922606">.</span><span class="ident" id="2922607">imax</span>&nbsp;<span class="op" id="2922612">+</span>&nbsp;<span class="num" id="2922614">0.5</span><span class="op" id="2922617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2922620">z</span><span class="op" id="2922621">.</span><span class="ident" id="2922622">hx0minusHxm</span>&nbsp;<span class="op" id="2922634">=</span>&nbsp;<span class="ident" id="2922636">z</span><span class="op" id="2922637">.</span><span class="ident" id="2922638">h</span><span class="op" id="2922639">(</span><span class="num" id="2922640">0.5</span><span class="op" id="2922643">)</span>&nbsp;<span class="op" id="2922645">-</span>&nbsp;<span class="ident" id="2922647">math</span><span class="op" id="2922651">.</span><span class="ident" id="2922652">Exp</span><span class="op" id="2922655">(</span><span class="ident" id="2922656">math</span><span class="op" id="2922660">.</span><span class="ident" id="2922661">Log</span><span class="op" id="2922664">(</span><span class="ident" id="2922665">z</span><span class="op" id="2922666">.</span><span class="ident" id="2922667">v</span><span class="op" id="2922668">)</span><span class="op" id="2922669">*</span><span class="op" id="2922670">(</span><span class="op" id="2922671">-</span><span class="ident" id="2922672">z</span><span class="op" id="2922673">.</span><span class="ident" id="2922674">q</span><span class="op" id="2922675">)</span><span class="op" id="2922676">)</span>&nbsp;<span class="op" id="2922678">-</span>&nbsp;<span class="ident" id="2922680">z</span><span class="op" id="2922681">.</span><span class="ident" id="2922682">hxm</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2922687">z</span><span class="op" id="2922688">.</span><span class="ident" id="2922689">s</span>&nbsp;<span class="op" id="2922691">=</span>&nbsp;<span class="num" id="2922693">1</span>&nbsp;<span class="op" id="2922695">-</span>&nbsp;<span class="ident" id="2922697">z</span><span class="op" id="2922698">.</span><span class="ident" id="2922699">hinv</span><span class="op" id="2922703">(</span><span class="ident" id="2922704">z</span><span class="op" id="2922705">.</span><span class="ident" id="2922706">h</span><span class="op" id="2922707">(</span><span class="num" id="2922708">1.5</span><span class="op" id="2922711">)</span><span class="op" id="2922712">-</span><span class="ident" id="2922713">math</span><span class="op" id="2922717">.</span><span class="ident" id="2922718">Exp</span><span class="op" id="2922721">(</span><span class="op" id="2922722">-</span><span class="ident" id="2922723">z</span><span class="op" id="2922724">.</span><span class="ident" id="2922725">q</span><span class="op" id="2922726">*</span><span class="ident" id="2922727">math</span><span class="op" id="2922731">.</span><span class="ident" id="2922732">Log</span><span class="op" id="2922735">(</span><span class="ident" id="2922736">z</span><span class="op" id="2922737">.</span><span class="ident" id="2922738">v</span><span class="op" id="2922739">+</span><span class="num" id="2922740">1.0</span><span class="op" id="2922743">)</span><span class="op" id="2922744">)</span><span class="op" id="2922745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2922748">return</span>&nbsp;<span class="ident" id="2922755">z</span><br>
<span class="lineno"></span><span class="op" id="2922757">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2922760">//&nbsp;Uint64&nbsp;returns&nbsp;a&nbsp;value&nbsp;drawn&nbsp;from&nbsp;the&nbsp;Zipf&nbsp;distribution&nbsp;described</span><br>
<span class="lineno">55</span><span class="comment" id="2922829">//&nbsp;by&nbsp;the&nbsp;Zipf&nbsp;object.</span><br>
<span class="lineno"></span><span class="keyword" id="2922852">func</span>&nbsp;<span class="op" id="2922857">(</span><span class="ident" id="2922858">z</span>&nbsp;<span class="op" id="2922860">*</span><span class="ident" id="2922861">Zipf</span><span class="op" id="2922865">)</span>&nbsp;<span class="ident" id="2922867">Uint64</span><span class="op" id="2922873">(</span><span class="op" id="2922874">)</span>&nbsp;<span class="ident" id="2922876">uint64</span>&nbsp;<span class="op" id="2922883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2922886">if</span>&nbsp;<span class="ident" id="2922889">z</span>&nbsp;<span class="op" id="2922891">==</span>&nbsp;<span class="builtintype" id="2922894">nil</span>&nbsp;<span class="op" id="2922898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2922902">panic</span><span class="op" id="2922907">(</span><span class="string" id="2922908">&#34;rand:&nbsp;nil&nbsp;Zipf&#34;</span><span class="op" id="2922924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2922927">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2922930">k</span>&nbsp;<span class="op" id="2922932">:=</span>&nbsp;<span class="num" id="2922935">0.0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2922941">for</span>&nbsp;<span class="op" id="2922945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2922949">r</span>&nbsp;<span class="op" id="2922951">:=</span>&nbsp;<span class="ident" id="2922954">z</span><span class="op" id="2922955">.</span><span class="ident" id="2922956">r</span><span class="op" id="2922957">.</span><span class="ident" id="2922958">Float64</span><span class="op" id="2922965">(</span><span class="op" id="2922966">)</span>&nbsp;<span class="comment" id="2922968">//&nbsp;r&nbsp;on&nbsp;[0,1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2922984">ur</span>&nbsp;<span class="op" id="2922987">:=</span>&nbsp;<span class="ident" id="2922990">z</span><span class="op" id="2922991">.</span><span class="ident" id="2922992">hxm</span>&nbsp;<span class="op" id="2922996">+</span>&nbsp;<span class="ident" id="2922998">r</span><span class="op" id="2922999">*</span><span class="ident" id="2923000">z</span><span class="op" id="2923001">.</span><span class="ident" id="2923002">hx0minusHxm</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2923016">x</span>&nbsp;<span class="op" id="2923018">:=</span>&nbsp;<span class="ident" id="2923021">z</span><span class="op" id="2923022">.</span><span class="ident" id="2923023">hinv</span><span class="op" id="2923027">(</span><span class="ident" id="2923028">ur</span><span class="op" id="2923030">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2923034">k</span>&nbsp;<span class="op" id="2923036">=</span>&nbsp;<span class="ident" id="2923038">math</span><span class="op" id="2923042">.</span><span class="ident" id="2923043">Floor</span><span class="op" id="2923048">(</span><span class="ident" id="2923049">x</span>&nbsp;<span class="op" id="2923051">+</span>&nbsp;<span class="num" id="2923053">0.5</span><span class="op" id="2923056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2923060">if</span>&nbsp;<span class="ident" id="2923063">k</span><span class="op" id="2923064">-</span><span class="ident" id="2923065">x</span>&nbsp;<span class="op" id="2923067">&lt;=</span>&nbsp;<span class="ident" id="2923070">z</span><span class="op" id="2923071">.</span><span class="ident" id="2923072">s</span>&nbsp;<span class="op" id="2923074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2923079">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2923087">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2923091">if</span>&nbsp;<span class="ident" id="2923094">ur</span>&nbsp;<span class="op" id="2923097">&gt;=</span>&nbsp;<span class="ident" id="2923100">z</span><span class="op" id="2923101">.</span><span class="ident" id="2923102">h</span><span class="op" id="2923103">(</span><span class="ident" id="2923104">k</span><span class="op" id="2923105">+</span><span class="num" id="2923106">0.5</span><span class="op" id="2923109">)</span><span class="op" id="2923110">-</span><span class="ident" id="2923111">math</span><span class="op" id="2923115">.</span><span class="ident" id="2923116">Exp</span><span class="op" id="2923119">(</span><span class="op" id="2923120">-</span><span class="ident" id="2923121">math</span><span class="op" id="2923125">.</span><span class="ident" id="2923126">Log</span><span class="op" id="2923129">(</span><span class="ident" id="2923130">k</span><span class="op" id="2923131">+</span><span class="ident" id="2923132">z</span><span class="op" id="2923133">.</span><span class="ident" id="2923134">v</span><span class="op" id="2923135">)</span><span class="op" id="2923136">*</span><span class="ident" id="2923137">z</span><span class="op" id="2923138">.</span><span class="ident" id="2923139">q</span><span class="op" id="2923140">)</span>&nbsp;<span class="op" id="2923142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2923147">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2923155">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2923158">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2923161">return</span>&nbsp;<span class="ident" id="2923168">uint64</span><span class="op" id="2923174">(</span><span class="ident" id="2923175">k</span><span class="op" id="2923176">)</span><br>
<span class="lineno">75</span><span class="op" id="2923178">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
