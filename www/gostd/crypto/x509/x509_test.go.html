<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html" class="current">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6485852">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6485907">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6485961">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6486012">package</span>&nbsp;<span class="ident" id="6486020">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6486026">import</span>&nbsp;<span class="op" id="6486033">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6486036">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6486045">&#34;crypto/dsa&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6486059">&#34;crypto/ecdsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6486075">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6486094">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6486109">&#34;crypto/rsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6486123">_</span>&nbsp;<span class="string" id="6486125">&#34;crypto/sha256&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6486142">_</span>&nbsp;<span class="string" id="6486144">&#34;crypto/sha512&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6486161">&#34;crypto/x509/pkix&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6486181">&#34;encoding/asn1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6486198">&#34;encoding/base64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6486217">&#34;encoding/hex&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6486233">&#34;encoding/pem&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6486249">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6486261">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6486268">&#34;os/exec&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6486279">&#34;reflect&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6486290">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6486301">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6486312">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="6486319">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="6486322">func</span>&nbsp;<span class="ident" id="6486327">TestParsePKCS1PrivateKey</span><span class="op" id="6486351">(</span><span class="ident" id="6486352">t</span>&nbsp;<span class="op" id="6486354">*</span><span class="ident" id="6486355">testing</span><span class="op" id="6486362">.</span><span class="ident" id="6486363">T</span><span class="op" id="6486364">)</span>&nbsp;<span class="op" id="6486366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6486369">block</span><span class="op" id="6486374">,</span>&nbsp;<span class="ident" id="6486376">_</span>&nbsp;<span class="op" id="6486378">:=</span>&nbsp;<span class="ident" id="6486381">pem</span><span class="op" id="6486384">.</span><span class="ident" id="6486385">Decode</span><span class="op" id="6486391">(</span><span class="op" id="6486392">[</span><span class="op" id="6486393">]</span><span class="builtintype" id="6486394">byte</span><span class="op" id="6486398">(</span><span class="ident" id="6486399">pemPrivateKey</span><span class="op" id="6486412">)</span><span class="op" id="6486413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6486416">priv</span><span class="op" id="6486420">,</span>&nbsp;<span class="ident" id="6486422">err</span>&nbsp;<span class="op" id="6486426">:=</span>&nbsp;<span class="ident" id="6486429">ParsePKCS1PrivateKey</span><span class="op" id="6486449">(</span><span class="ident" id="6486450">block</span><span class="op" id="6486455">.</span><span class="ident" id="6486456">Bytes</span><span class="op" id="6486461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6486464">if</span>&nbsp;<span class="ident" id="6486467">err</span>&nbsp;<span class="op" id="6486471">!=</span>&nbsp;<span class="builtintype" id="6486474">nil</span>&nbsp;<span class="op" id="6486478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6486482">t</span><span class="op" id="6486483">.</span><span class="ident" id="6486484">Errorf</span><span class="op" id="6486490">(</span><span class="string" id="6486491">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="6486524">,</span>&nbsp;<span class="ident" id="6486526">err</span><span class="op" id="6486529">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6486533">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6486541">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6486544">if</span>&nbsp;<span class="ident" id="6486547">priv</span><span class="op" id="6486551">.</span><span class="ident" id="6486552">PublicKey</span><span class="op" id="6486561">.</span><span class="ident" id="6486562">N</span><span class="op" id="6486563">.</span><span class="ident" id="6486564">Cmp</span><span class="op" id="6486567">(</span><span class="ident" id="6486568">rsaPrivateKey</span><span class="op" id="6486581">.</span><span class="ident" id="6486582">PublicKey</span><span class="op" id="6486591">.</span><span class="ident" id="6486592">N</span><span class="op" id="6486593">)</span>&nbsp;<span class="op" id="6486595">!=</span>&nbsp;<span class="num" id="6486598">0</span>&nbsp;<span class="op" id="6486600">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6486605">priv</span><span class="op" id="6486609">.</span><span class="ident" id="6486610">PublicKey</span><span class="op" id="6486619">.</span><span class="ident" id="6486620">E</span>&nbsp;<span class="op" id="6486622">!=</span>&nbsp;<span class="ident" id="6486625">rsaPrivateKey</span><span class="op" id="6486638">.</span><span class="ident" id="6486639">PublicKey</span><span class="op" id="6486648">.</span><span class="ident" id="6486649">E</span>&nbsp;<span class="op" id="6486651">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6486656">priv</span><span class="op" id="6486660">.</span><span class="ident" id="6486661">D</span><span class="op" id="6486662">.</span><span class="ident" id="6486663">Cmp</span><span class="op" id="6486666">(</span><span class="ident" id="6486667">rsaPrivateKey</span><span class="op" id="6486680">.</span><span class="ident" id="6486681">D</span><span class="op" id="6486682">)</span>&nbsp;<span class="op" id="6486684">!=</span>&nbsp;<span class="num" id="6486687">0</span>&nbsp;<span class="op" id="6486689">||</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6486694">priv</span><span class="op" id="6486698">.</span><span class="ident" id="6486699">Primes</span><span class="op" id="6486705">[</span><span class="num" id="6486706">0</span><span class="op" id="6486707">]</span><span class="op" id="6486708">.</span><span class="ident" id="6486709">Cmp</span><span class="op" id="6486712">(</span><span class="ident" id="6486713">rsaPrivateKey</span><span class="op" id="6486726">.</span><span class="ident" id="6486727">Primes</span><span class="op" id="6486733">[</span><span class="num" id="6486734">0</span><span class="op" id="6486735">]</span><span class="op" id="6486736">)</span>&nbsp;<span class="op" id="6486738">!=</span>&nbsp;<span class="num" id="6486741">0</span>&nbsp;<span class="op" id="6486743">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6486748">priv</span><span class="op" id="6486752">.</span><span class="ident" id="6486753">Primes</span><span class="op" id="6486759">[</span><span class="num" id="6486760">1</span><span class="op" id="6486761">]</span><span class="op" id="6486762">.</span><span class="ident" id="6486763">Cmp</span><span class="op" id="6486766">(</span><span class="ident" id="6486767">rsaPrivateKey</span><span class="op" id="6486780">.</span><span class="ident" id="6486781">Primes</span><span class="op" id="6486787">[</span><span class="num" id="6486788">1</span><span class="op" id="6486789">]</span><span class="op" id="6486790">)</span>&nbsp;<span class="op" id="6486792">!=</span>&nbsp;<span class="num" id="6486795">0</span>&nbsp;<span class="op" id="6486797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6486801">t</span><span class="op" id="6486802">.</span><span class="ident" id="6486803">Errorf</span><span class="op" id="6486809">(</span><span class="string" id="6486810">&#34;got:%+v&nbsp;want:%+v&#34;</span><span class="op" id="6486828">,</span>&nbsp;<span class="ident" id="6486830">priv</span><span class="op" id="6486834">,</span>&nbsp;<span class="ident" id="6486836">rsaPrivateKey</span><span class="op" id="6486849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6486852">}</span><br>
<span class="lineno"></span><span class="op" id="6486854">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="6486857">func</span>&nbsp;<span class="ident" id="6486862">TestParsePKIXPublicKey</span><span class="op" id="6486884">(</span><span class="ident" id="6486885">t</span>&nbsp;<span class="op" id="6486887">*</span><span class="ident" id="6486888">testing</span><span class="op" id="6486895">.</span><span class="ident" id="6486896">T</span><span class="op" id="6486897">)</span>&nbsp;<span class="op" id="6486899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6486902">block</span><span class="op" id="6486907">,</span>&nbsp;<span class="ident" id="6486909">_</span>&nbsp;<span class="op" id="6486911">:=</span>&nbsp;<span class="ident" id="6486914">pem</span><span class="op" id="6486917">.</span><span class="ident" id="6486918">Decode</span><span class="op" id="6486924">(</span><span class="op" id="6486925">[</span><span class="op" id="6486926">]</span><span class="builtintype" id="6486927">byte</span><span class="op" id="6486931">(</span><span class="ident" id="6486932">pemPublicKey</span><span class="op" id="6486944">)</span><span class="op" id="6486945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6486948">pub</span><span class="op" id="6486951">,</span>&nbsp;<span class="ident" id="6486953">err</span>&nbsp;<span class="op" id="6486957">:=</span>&nbsp;<span class="ident" id="6486960">ParsePKIXPublicKey</span><span class="op" id="6486978">(</span><span class="ident" id="6486979">block</span><span class="op" id="6486984">.</span><span class="ident" id="6486985">Bytes</span><span class="op" id="6486990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6486993">if</span>&nbsp;<span class="ident" id="6486996">err</span>&nbsp;<span class="op" id="6487000">!=</span>&nbsp;<span class="builtintype" id="6487003">nil</span>&nbsp;<span class="op" id="6487007">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6487011">t</span><span class="op" id="6487012">.</span><span class="ident" id="6487013">Errorf</span><span class="op" id="6487019">(</span><span class="string" id="6487020">&#34;Failed&nbsp;to&nbsp;parse&nbsp;RSA&nbsp;public&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="6487056">,</span>&nbsp;<span class="ident" id="6487058">err</span><span class="op" id="6487061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6487065">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6487073">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6487076">rsaPub</span><span class="op" id="6487082">,</span>&nbsp;<span class="ident" id="6487084">ok</span>&nbsp;<span class="op" id="6487087">:=</span>&nbsp;<span class="ident" id="6487090">pub</span><span class="op" id="6487093">.</span><span class="op" id="6487094">(</span><span class="op" id="6487095">*</span><span class="ident" id="6487096">rsa</span><span class="op" id="6487099">.</span><span class="ident" id="6487100">PublicKey</span><span class="op" id="6487109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6487112">if</span>&nbsp;<span class="op" id="6487115">!</span><span class="ident" id="6487116">ok</span>&nbsp;<span class="op" id="6487119">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6487123">t</span><span class="op" id="6487124">.</span><span class="ident" id="6487125">Errorf</span><span class="op" id="6487131">(</span><span class="string" id="6487132">&#34;Value&nbsp;returned&nbsp;from&nbsp;ParsePKIXPublicKey&nbsp;was&nbsp;not&nbsp;an&nbsp;RSA&nbsp;public&nbsp;key&#34;</span><span class="op" id="6487198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6487202">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6487210">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6487214">pubBytes2</span><span class="op" id="6487223">,</span>&nbsp;<span class="ident" id="6487225">err</span>&nbsp;<span class="op" id="6487229">:=</span>&nbsp;<span class="ident" id="6487232">MarshalPKIXPublicKey</span><span class="op" id="6487252">(</span><span class="ident" id="6487253">rsaPub</span><span class="op" id="6487259">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6487262">if</span>&nbsp;<span class="ident" id="6487265">err</span>&nbsp;<span class="op" id="6487269">!=</span>&nbsp;<span class="builtintype" id="6487272">nil</span>&nbsp;<span class="op" id="6487276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6487280">t</span><span class="op" id="6487281">.</span><span class="ident" id="6487282">Errorf</span><span class="op" id="6487288">(</span><span class="string" id="6487289">&#34;Failed&nbsp;to&nbsp;marshal&nbsp;RSA&nbsp;public&nbsp;key&nbsp;for&nbsp;the&nbsp;second&nbsp;time:&nbsp;%s&#34;</span><span class="op" id="6487347">,</span>&nbsp;<span class="ident" id="6487349">err</span><span class="op" id="6487352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6487356">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6487364">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6487367">if</span>&nbsp;<span class="op" id="6487370">!</span><span class="ident" id="6487371">bytes</span><span class="op" id="6487376">.</span><span class="ident" id="6487377">Equal</span><span class="op" id="6487382">(</span><span class="ident" id="6487383">pubBytes2</span><span class="op" id="6487392">,</span>&nbsp;<span class="ident" id="6487394">block</span><span class="op" id="6487399">.</span><span class="ident" id="6487400">Bytes</span><span class="op" id="6487405">)</span>&nbsp;<span class="op" id="6487407">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6487411">t</span><span class="op" id="6487412">.</span><span class="ident" id="6487413">Errorf</span><span class="op" id="6487419">(</span><span class="string" id="6487420">&#34;Reserialization&nbsp;of&nbsp;public&nbsp;key&nbsp;didn&#39;t&nbsp;match.&nbsp;got&nbsp;%x,&nbsp;want&nbsp;%x&#34;</span><span class="op" id="6487481">,</span>&nbsp;<span class="ident" id="6487483">pubBytes2</span><span class="op" id="6487492">,</span>&nbsp;<span class="ident" id="6487494">block</span><span class="op" id="6487499">.</span><span class="ident" id="6487500">Bytes</span><span class="op" id="6487505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6487508">}</span><br>
<span class="lineno"></span><span class="op" id="6487510">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6487513">var</span>&nbsp;<span class="ident" id="6487517">pemPublicKey</span>&nbsp;<span class="op" id="6487530">=</span>&nbsp;<span class="string" id="6487532">`-----BEGIN&nbsp;PUBLIC&nbsp;KEY-----<br>
<span class="lineno">70</span>MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA3VoPN9PKUjKFLMwOge6+<br>
<span class="lineno"></span>wnDi8sbETGIx2FKXGgqtAKpzmem53kRGEQg8WeqRmp12wgp74TGpkEXsGae7RS1k<br>
<span class="lineno"></span>enJCnma4fii+noGH7R0qKgHvPrI2Bwa9hzsH8tHxpyM3qrXslOmD45EH9SxIDUBJ<br>
<span class="lineno"></span>FehNdaPbLP1gFyahKMsdfxFJLUvbUycuZSJ2ZnIgeVxwm4qbSvZInL9Iu4FzuPtg<br>
<span class="lineno"></span>fINKcbbovy1qq4KvPIrXzhbY3PWDc6btxCf3SE0JdE1MCPThntB62/bLMSQ7xdDR<br>
<span class="lineno">75</span>FF53oIpvxe/SCOymfWq/LW849Ytv3Xwod0+wzAP8STXG4HSELS4UedPYeHJJJYcZ<br>
<span class="lineno"></span>+QIDAQAB<br>
<span class="lineno"></span>-----END&nbsp;PUBLIC&nbsp;KEY-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="6487987">var</span>&nbsp;<span class="ident" id="6487991">pemPrivateKey</span>&nbsp;<span class="op" id="6488005">=</span>&nbsp;<span class="string" id="6488007">`-----BEGIN&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno"></span>MIIBOgIBAAJBALKZD0nEffqM1ACuak0bijtqE2QrI/KLADv7l3kK3ppMyCuLKoF0<br>
<span class="lineno"></span>fd7Ai2KW5ToIwzFofvJcS/STa6HA5gQenRUCAwEAAQJBAIq9amn00aS0h/CrjXqu<br>
<span class="lineno"></span>/ThglAXJmZhOMPVn4eiu7/ROixi9sex436MaVeMqSNf7Ex9a8fRNfWss7Sqd9eWu<br>
<span class="lineno"></span>RTUCIQDasvGASLqmjeffBNLTXV2A5g4t+kLVCpsEIZAycV5GswIhANEPLmax0ME/<br>
<span class="lineno">85</span>EO+ZJ79TJKN5yiGBRsv5yvx5UiHxajEXAiAhAol5N4EUyq6I9w1rYdhPMGpLfk7A<br>
<span class="lineno"></span>IU2snfRJ6Nq2CQIgFrPsWRCkV+gOYcajD17rEqmuLrdIRexpg8N1DOSXoJ8CIGlS<br>
<span class="lineno"></span>tAboUGBxTDq3ZroNism3DaMIbKPyYrAqhKov1h5V<br>
<span class="lineno"></span>-----END&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="6488504">func</span>&nbsp;<span class="ident" id="6488509">bigFromString</span><span class="op" id="6488522">(</span><span class="ident" id="6488523">s</span>&nbsp;<span class="builtintype" id="6488525">string</span><span class="op" id="6488531">)</span>&nbsp;<span class="op" id="6488533">*</span><span class="ident" id="6488534">big</span><span class="op" id="6488537">.</span><span class="ident" id="6488538">Int</span>&nbsp;<span class="op" id="6488542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6488545">ret</span>&nbsp;<span class="op" id="6488549">:=</span>&nbsp;<span class="builtinfunc" id="6488552">new</span><span class="op" id="6488555">(</span><span class="ident" id="6488556">big</span><span class="op" id="6488559">.</span><span class="ident" id="6488560">Int</span><span class="op" id="6488563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6488566">ret</span><span class="op" id="6488569">.</span><span class="ident" id="6488570">SetString</span><span class="op" id="6488579">(</span><span class="ident" id="6488580">s</span><span class="op" id="6488581">,</span>&nbsp;<span class="num" id="6488583">10</span><span class="op" id="6488585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6488588">return</span>&nbsp;<span class="ident" id="6488595">ret</span><br>
<span class="lineno">95</span><span class="op" id="6488599">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6488602">func</span>&nbsp;<span class="ident" id="6488607">fromBase10</span><span class="op" id="6488617">(</span><span class="ident" id="6488618">base10</span>&nbsp;<span class="builtintype" id="6488625">string</span><span class="op" id="6488631">)</span>&nbsp;<span class="op" id="6488633">*</span><span class="ident" id="6488634">big</span><span class="op" id="6488637">.</span><span class="ident" id="6488638">Int</span>&nbsp;<span class="op" id="6488642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6488645">i</span>&nbsp;<span class="op" id="6488647">:=</span>&nbsp;<span class="builtinfunc" id="6488650">new</span><span class="op" id="6488653">(</span><span class="ident" id="6488654">big</span><span class="op" id="6488657">.</span><span class="ident" id="6488658">Int</span><span class="op" id="6488661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6488664">i</span><span class="op" id="6488665">.</span><span class="ident" id="6488666">SetString</span><span class="op" id="6488675">(</span><span class="ident" id="6488676">base10</span><span class="op" id="6488682">,</span>&nbsp;<span class="num" id="6488684">10</span><span class="op" id="6488686">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6488689">return</span>&nbsp;<span class="ident" id="6488696">i</span><br>
<span class="lineno"></span><span class="op" id="6488698">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6488701">func</span>&nbsp;<span class="ident" id="6488706">bigFromHexString</span><span class="op" id="6488722">(</span><span class="ident" id="6488723">s</span>&nbsp;<span class="builtintype" id="6488725">string</span><span class="op" id="6488731">)</span>&nbsp;<span class="op" id="6488733">*</span><span class="ident" id="6488734">big</span><span class="op" id="6488737">.</span><span class="ident" id="6488738">Int</span>&nbsp;<span class="op" id="6488742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6488745">ret</span>&nbsp;<span class="op" id="6488749">:=</span>&nbsp;<span class="builtinfunc" id="6488752">new</span><span class="op" id="6488755">(</span><span class="ident" id="6488756">big</span><span class="op" id="6488759">.</span><span class="ident" id="6488760">Int</span><span class="op" id="6488763">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6488766">ret</span><span class="op" id="6488769">.</span><span class="ident" id="6488770">SetString</span><span class="op" id="6488779">(</span><span class="ident" id="6488780">s</span><span class="op" id="6488781">,</span>&nbsp;<span class="num" id="6488783">16</span><span class="op" id="6488785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6488788">return</span>&nbsp;<span class="ident" id="6488795">ret</span><br>
<span class="lineno"></span><span class="op" id="6488799">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6488802">var</span>&nbsp;<span class="ident" id="6488806">rsaPrivateKey</span>&nbsp;<span class="op" id="6488820">=</span>&nbsp;<span class="op" id="6488822">&amp;</span><span class="ident" id="6488823">rsa</span><span class="op" id="6488826">.</span><span class="ident" id="6488827">PrivateKey</span><span class="op" id="6488837">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6488840">PublicKey</span><span class="op" id="6488849">:</span>&nbsp;<span class="ident" id="6488851">rsa</span><span class="op" id="6488854">.</span><span class="ident" id="6488855">PublicKey</span><span class="op" id="6488864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6488868">N</span><span class="op" id="6488869">:</span>&nbsp;<span class="ident" id="6488871">bigFromString</span><span class="op" id="6488884">(</span><span class="string" id="6488885">&#34;9353930466774385905609975137998169297361893554149986716853295022578535724979677252958524466350471210367835187480748268864277464700638583474144061408845077&#34;</span><span class="op" id="6489041">)</span><span class="op" id="6489042">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6489046">E</span><span class="op" id="6489047">:</span>&nbsp;<span class="num" id="6489049">65537</span><span class="op" id="6489054">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6489057">}</span><span class="op" id="6489058">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6489061">D</span><span class="op" id="6489062">:</span>&nbsp;<span class="ident" id="6489064">bigFromString</span><span class="op" id="6489077">(</span><span class="string" id="6489078">&#34;7266398431328116344057699379749222532279343923819063639497049039389899328538543087657733766554155839834519529439851673014800261285757759040931985506583861&#34;</span><span class="op" id="6489234">)</span><span class="op" id="6489235">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6489238">Primes</span><span class="op" id="6489244">:</span>&nbsp;<span class="op" id="6489246">[</span><span class="op" id="6489247">]</span><span class="op" id="6489248">*</span><span class="ident" id="6489249">big</span><span class="op" id="6489252">.</span><span class="ident" id="6489253">Int</span><span class="op" id="6489256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6489260">bigFromString</span><span class="op" id="6489273">(</span><span class="string" id="6489274">&#34;98920366548084643601728869055592650835572950932266967461790948584315647051443&#34;</span><span class="op" id="6489353">)</span><span class="op" id="6489354">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6489358">bigFromString</span><span class="op" id="6489371">(</span><span class="string" id="6489372">&#34;94560208308847015747498523884063394671606671904944666360068158221458669711639&#34;</span><span class="op" id="6489451">)</span><span class="op" id="6489452">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6489455">}</span><span class="op" id="6489456">,</span><br>
<span class="lineno"></span><span class="op" id="6489458">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="6489461">func</span>&nbsp;<span class="ident" id="6489466">TestMarshalRSAPrivateKey</span><span class="op" id="6489490">(</span><span class="ident" id="6489491">t</span>&nbsp;<span class="op" id="6489493">*</span><span class="ident" id="6489494">testing</span><span class="op" id="6489501">.</span><span class="ident" id="6489502">T</span><span class="op" id="6489503">)</span>&nbsp;<span class="op" id="6489505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6489508">priv</span>&nbsp;<span class="op" id="6489513">:=</span>&nbsp;<span class="op" id="6489516">&amp;</span><span class="ident" id="6489517">rsa</span><span class="op" id="6489520">.</span><span class="ident" id="6489521">PrivateKey</span><span class="op" id="6489531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6489535">PublicKey</span><span class="op" id="6489544">:</span>&nbsp;<span class="ident" id="6489546">rsa</span><span class="op" id="6489549">.</span><span class="ident" id="6489550">PublicKey</span><span class="op" id="6489559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6489564">N</span><span class="op" id="6489565">:</span>&nbsp;<span class="ident" id="6489567">fromBase10</span><span class="op" id="6489577">(</span><span class="string" id="6489578">&#34;16346378922382193400538269749936049106320265317511766357599732575277382844051791096569333808598921852351577762718529818072849191122419410612033592401403764925096136759934497687765453905884149505175426053037420486697072448609022753683683718057795566811401938833367954642951433473337066311978821180526439641496973296037000052546108507805269279414789035461158073156772151892452251106173507240488993608650881929629163465099476849643165682709047462010581308719577053905787496296934240246311806555924593059995202856826239801816771116902778517096212527979497399966526283516447337775509777558018145573127308919204297111496233&#34;</span><span class="op" id="6490197">)</span><span class="op" id="6490198">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6490203">E</span><span class="op" id="6490204">:</span>&nbsp;<span class="num" id="6490206">3</span><span class="op" id="6490207">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6490211">}</span><span class="op" id="6490212">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6490216">D</span><span class="op" id="6490217">:</span>&nbsp;<span class="ident" id="6490219">fromBase10</span><span class="op" id="6490229">(</span><span class="string" id="6490230">&#34;10897585948254795600358846499957366070880176878341177571733155050184921896034527397712889205732614568234385175145686545381899460748279607074689061600935843283397424506622998458510302603922766336783617368686090042765718290914099334449154829375179958369993407724946186243249568928237086215759259909861748642124071874879861299389874230489928271621259294894142840428407196932444474088857746123104978617098858619445675532587787023228852383149557470077802718705420275739737958953794088728369933811184572620857678792001136676902250566845618813972833750098806496641114644760255910789397593428910198080271317419213080834885003&#34;</span><span class="op" id="6490849">)</span><span class="op" id="6490850">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6490854">Primes</span><span class="op" id="6490860">:</span>&nbsp;<span class="op" id="6490862">[</span><span class="op" id="6490863">]</span><span class="op" id="6490864">*</span><span class="ident" id="6490865">big</span><span class="op" id="6490868">.</span><span class="ident" id="6490869">Int</span><span class="op" id="6490872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6490877">fromBase10</span><span class="op" id="6490887">(</span><span class="string" id="6490888">&#34;1025363189502892836833747188838978207017355117492483312747347695538428729137306368764177201532277413433182799108299960196606011786562992097313508180436744488171474690412562218914213688661311117337381958560443&#34;</span><span class="op" id="6491098">)</span><span class="op" id="6491099">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6491104">fromBase10</span><span class="op" id="6491114">(</span><span class="string" id="6491115">&#34;3467903426626310123395340254094941045497208049900750380025518552334536945536837294961497712862519984786362199788654739924501424784631315081391467293694361474867825728031147665777546570788493758372218019373&#34;</span><span class="op" id="6491322">)</span><span class="op" id="6491323">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6491328">fromBase10</span><span class="op" id="6491338">(</span><span class="string" id="6491339">&#34;4597024781409332673052708605078359346966325141767460991205742124888960305710298765592730135879076084498363772408626791576005136245060321874472727132746643162385746062759369754202494417496879741537284589047&#34;</span><span class="op" id="6491546">)</span><span class="op" id="6491547">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6491551">}</span><span class="op" id="6491552">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6491555">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6491559">derBytes</span>&nbsp;<span class="op" id="6491568">:=</span>&nbsp;<span class="ident" id="6491571">MarshalPKCS1PrivateKey</span><span class="op" id="6491593">(</span><span class="ident" id="6491594">priv</span><span class="op" id="6491598">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6491602">priv2</span><span class="op" id="6491607">,</span>&nbsp;<span class="ident" id="6491609">err</span>&nbsp;<span class="op" id="6491613">:=</span>&nbsp;<span class="ident" id="6491616">ParsePKCS1PrivateKey</span><span class="op" id="6491636">(</span><span class="ident" id="6491637">derBytes</span><span class="op" id="6491645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6491648">if</span>&nbsp;<span class="ident" id="6491651">err</span>&nbsp;<span class="op" id="6491655">!=</span>&nbsp;<span class="builtintype" id="6491658">nil</span>&nbsp;<span class="op" id="6491662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6491666">t</span><span class="op" id="6491667">.</span><span class="ident" id="6491668">Errorf</span><span class="op" id="6491674">(</span><span class="string" id="6491675">&#34;error&nbsp;parsing&nbsp;serialized&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="6491709">,</span>&nbsp;<span class="ident" id="6491711">err</span><span class="op" id="6491714">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6491718">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6491726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6491729">if</span>&nbsp;<span class="ident" id="6491732">priv</span><span class="op" id="6491736">.</span><span class="ident" id="6491737">PublicKey</span><span class="op" id="6491746">.</span><span class="ident" id="6491747">N</span><span class="op" id="6491748">.</span><span class="ident" id="6491749">Cmp</span><span class="op" id="6491752">(</span><span class="ident" id="6491753">priv2</span><span class="op" id="6491758">.</span><span class="ident" id="6491759">PublicKey</span><span class="op" id="6491768">.</span><span class="ident" id="6491769">N</span><span class="op" id="6491770">)</span>&nbsp;<span class="op" id="6491772">!=</span>&nbsp;<span class="num" id="6491775">0</span>&nbsp;<span class="op" id="6491777">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6491782">priv</span><span class="op" id="6491786">.</span><span class="ident" id="6491787">PublicKey</span><span class="op" id="6491796">.</span><span class="ident" id="6491797">E</span>&nbsp;<span class="op" id="6491799">!=</span>&nbsp;<span class="ident" id="6491802">priv2</span><span class="op" id="6491807">.</span><span class="ident" id="6491808">PublicKey</span><span class="op" id="6491817">.</span><span class="ident" id="6491818">E</span>&nbsp;<span class="op" id="6491820">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6491825">priv</span><span class="op" id="6491829">.</span><span class="ident" id="6491830">D</span><span class="op" id="6491831">.</span><span class="ident" id="6491832">Cmp</span><span class="op" id="6491835">(</span><span class="ident" id="6491836">priv2</span><span class="op" id="6491841">.</span><span class="ident" id="6491842">D</span><span class="op" id="6491843">)</span>&nbsp;<span class="op" id="6491845">!=</span>&nbsp;<span class="num" id="6491848">0</span>&nbsp;<span class="op" id="6491850">||</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="6491855">len</span><span class="op" id="6491858">(</span><span class="ident" id="6491859">priv2</span><span class="op" id="6491864">.</span><span class="ident" id="6491865">Primes</span><span class="op" id="6491871">)</span>&nbsp;<span class="op" id="6491873">!=</span>&nbsp;<span class="num" id="6491876">3</span>&nbsp;<span class="op" id="6491878">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6491883">priv</span><span class="op" id="6491887">.</span><span class="ident" id="6491888">Primes</span><span class="op" id="6491894">[</span><span class="num" id="6491895">0</span><span class="op" id="6491896">]</span><span class="op" id="6491897">.</span><span class="ident" id="6491898">Cmp</span><span class="op" id="6491901">(</span><span class="ident" id="6491902">priv2</span><span class="op" id="6491907">.</span><span class="ident" id="6491908">Primes</span><span class="op" id="6491914">[</span><span class="num" id="6491915">0</span><span class="op" id="6491916">]</span><span class="op" id="6491917">)</span>&nbsp;<span class="op" id="6491919">!=</span>&nbsp;<span class="num" id="6491922">0</span>&nbsp;<span class="op" id="6491924">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6491929">priv</span><span class="op" id="6491933">.</span><span class="ident" id="6491934">Primes</span><span class="op" id="6491940">[</span><span class="num" id="6491941">1</span><span class="op" id="6491942">]</span><span class="op" id="6491943">.</span><span class="ident" id="6491944">Cmp</span><span class="op" id="6491947">(</span><span class="ident" id="6491948">priv2</span><span class="op" id="6491953">.</span><span class="ident" id="6491954">Primes</span><span class="op" id="6491960">[</span><span class="num" id="6491961">1</span><span class="op" id="6491962">]</span><span class="op" id="6491963">)</span>&nbsp;<span class="op" id="6491965">!=</span>&nbsp;<span class="num" id="6491968">0</span>&nbsp;<span class="op" id="6491970">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6491975">priv</span><span class="op" id="6491979">.</span><span class="ident" id="6491980">Primes</span><span class="op" id="6491986">[</span><span class="num" id="6491987">2</span><span class="op" id="6491988">]</span><span class="op" id="6491989">.</span><span class="ident" id="6491990">Cmp</span><span class="op" id="6491993">(</span><span class="ident" id="6491994">priv2</span><span class="op" id="6491999">.</span><span class="ident" id="6492000">Primes</span><span class="op" id="6492006">[</span><span class="num" id="6492007">2</span><span class="op" id="6492008">]</span><span class="op" id="6492009">)</span>&nbsp;<span class="op" id="6492011">!=</span>&nbsp;<span class="num" id="6492014">0</span>&nbsp;<span class="op" id="6492016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6492020">t</span><span class="op" id="6492021">.</span><span class="ident" id="6492022">Errorf</span><span class="op" id="6492028">(</span><span class="string" id="6492029">&#34;got:%+v&nbsp;want:%+v&#34;</span><span class="op" id="6492047">,</span>&nbsp;<span class="ident" id="6492049">priv</span><span class="op" id="6492053">,</span>&nbsp;<span class="ident" id="6492055">priv2</span><span class="op" id="6492060">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6492063">}</span><br>
<span class="lineno"></span><span class="op" id="6492065">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6492068">type</span>&nbsp;<span class="ident" id="6492073">matchHostnamesTest</span>&nbsp;<span class="keyword" id="6492092">struct</span>&nbsp;<span class="op" id="6492099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6492102">pattern</span><span class="op" id="6492109">,</span>&nbsp;<span class="ident" id="6492111">host</span>&nbsp;<span class="builtintype" id="6492116">string</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6492124">ok</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6492138">bool</span><br>
<span class="lineno"></span><span class="op" id="6492143">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6492146">var</span>&nbsp;<span class="ident" id="6492150">matchHostnamesTests</span>&nbsp;<span class="op" id="6492170">=</span>&nbsp;<span class="op" id="6492172">[</span><span class="op" id="6492173">]</span><span class="ident" id="6492174">matchHostnamesTest</span><span class="op" id="6492192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6492195">{</span><span class="string" id="6492196">&#34;a.b.c&#34;</span><span class="op" id="6492203">,</span>&nbsp;<span class="string" id="6492205">&#34;a.b.c&#34;</span><span class="op" id="6492212">,</span>&nbsp;<span class="builtintype" id="6492214">true</span><span class="op" id="6492218">}</span><span class="op" id="6492219">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6492222">{</span><span class="string" id="6492223">&#34;a.b.c&#34;</span><span class="op" id="6492230">,</span>&nbsp;<span class="string" id="6492232">&#34;b.b.c&#34;</span><span class="op" id="6492239">,</span>&nbsp;<span class="builtintype" id="6492241">false</span><span class="op" id="6492246">}</span><span class="op" id="6492247">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6492250">{</span><span class="string" id="6492251">&#34;&#34;</span><span class="op" id="6492253">,</span>&nbsp;<span class="string" id="6492255">&#34;b.b.c&#34;</span><span class="op" id="6492262">,</span>&nbsp;<span class="builtintype" id="6492264">false</span><span class="op" id="6492269">}</span><span class="op" id="6492270">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6492273">{</span><span class="string" id="6492274">&#34;a.b.c&#34;</span><span class="op" id="6492281">,</span>&nbsp;<span class="string" id="6492283">&#34;&#34;</span><span class="op" id="6492285">,</span>&nbsp;<span class="builtintype" id="6492287">false</span><span class="op" id="6492292">}</span><span class="op" id="6492293">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6492296">{</span><span class="string" id="6492297">&#34;example.com&#34;</span><span class="op" id="6492310">,</span>&nbsp;<span class="string" id="6492312">&#34;example.com&#34;</span><span class="op" id="6492325">,</span>&nbsp;<span class="builtintype" id="6492327">true</span><span class="op" id="6492331">}</span><span class="op" id="6492332">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6492335">{</span><span class="string" id="6492336">&#34;example.com&#34;</span><span class="op" id="6492349">,</span>&nbsp;<span class="string" id="6492351">&#34;www.example.com&#34;</span><span class="op" id="6492368">,</span>&nbsp;<span class="builtintype" id="6492370">false</span><span class="op" id="6492375">}</span><span class="op" id="6492376">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6492379">{</span><span class="string" id="6492380">&#34;*.example.com&#34;</span><span class="op" id="6492395">,</span>&nbsp;<span class="string" id="6492397">&#34;www.example.com&#34;</span><span class="op" id="6492414">,</span>&nbsp;<span class="builtintype" id="6492416">true</span><span class="op" id="6492420">}</span><span class="op" id="6492421">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6492424">{</span><span class="string" id="6492425">&#34;*.example.com&#34;</span><span class="op" id="6492440">,</span>&nbsp;<span class="string" id="6492442">&#34;xyz.www.example.com&#34;</span><span class="op" id="6492463">,</span>&nbsp;<span class="builtintype" id="6492465">false</span><span class="op" id="6492470">}</span><span class="op" id="6492471">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6492474">{</span><span class="string" id="6492475">&#34;*.*.example.com&#34;</span><span class="op" id="6492492">,</span>&nbsp;<span class="string" id="6492494">&#34;xyz.www.example.com&#34;</span><span class="op" id="6492515">,</span>&nbsp;<span class="builtintype" id="6492517">true</span><span class="op" id="6492521">}</span><span class="op" id="6492522">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6492525">{</span><span class="string" id="6492526">&#34;*.www.*.com&#34;</span><span class="op" id="6492539">,</span>&nbsp;<span class="string" id="6492541">&#34;xyz.www.example.com&#34;</span><span class="op" id="6492562">,</span>&nbsp;<span class="builtintype" id="6492564">true</span><span class="op" id="6492568">}</span><span class="op" id="6492569">,</span><br>
<span class="lineno"></span><span class="op" id="6492571">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="6492574">func</span>&nbsp;<span class="ident" id="6492579">TestMatchHostnames</span><span class="op" id="6492597">(</span><span class="ident" id="6492598">t</span>&nbsp;<span class="op" id="6492600">*</span><span class="ident" id="6492601">testing</span><span class="op" id="6492608">.</span><span class="ident" id="6492609">T</span><span class="op" id="6492610">)</span>&nbsp;<span class="op" id="6492612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6492615">for</span>&nbsp;<span class="ident" id="6492619">i</span><span class="op" id="6492620">,</span>&nbsp;<span class="ident" id="6492622">test</span>&nbsp;<span class="op" id="6492627">:=</span>&nbsp;<span class="keyword" id="6492630">range</span>&nbsp;<span class="ident" id="6492636">matchHostnamesTests</span>&nbsp;<span class="op" id="6492656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6492660">r</span>&nbsp;<span class="op" id="6492662">:=</span>&nbsp;<span class="ident" id="6492665">matchHostnames</span><span class="op" id="6492679">(</span><span class="ident" id="6492680">test</span><span class="op" id="6492684">.</span><span class="ident" id="6492685">pattern</span><span class="op" id="6492692">,</span>&nbsp;<span class="ident" id="6492694">test</span><span class="op" id="6492698">.</span><span class="ident" id="6492699">host</span><span class="op" id="6492703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6492707">if</span>&nbsp;<span class="ident" id="6492710">r</span>&nbsp;<span class="op" id="6492712">!=</span>&nbsp;<span class="ident" id="6492715">test</span><span class="op" id="6492719">.</span><span class="ident" id="6492720">ok</span>&nbsp;<span class="op" id="6492723">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6492728">t</span><span class="op" id="6492729">.</span><span class="ident" id="6492730">Errorf</span><span class="op" id="6492736">(</span><span class="string" id="6492737">&#34;#%d&nbsp;mismatch&nbsp;got:&nbsp;%t&nbsp;want:&nbsp;%t&#34;</span><span class="op" id="6492768">,</span>&nbsp;<span class="ident" id="6492770">i</span><span class="op" id="6492771">,</span>&nbsp;<span class="ident" id="6492773">r</span><span class="op" id="6492774">,</span>&nbsp;<span class="ident" id="6492776">test</span><span class="op" id="6492780">.</span><span class="ident" id="6492781">ok</span><span class="op" id="6492783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6492787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6492790">}</span><br>
<span class="lineno"></span><span class="op" id="6492792">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="keyword" id="6492795">func</span>&nbsp;<span class="ident" id="6492800">TestMatchIP</span><span class="op" id="6492811">(</span><span class="ident" id="6492812">t</span>&nbsp;<span class="op" id="6492814">*</span><span class="ident" id="6492815">testing</span><span class="op" id="6492822">.</span><span class="ident" id="6492823">T</span><span class="op" id="6492824">)</span>&nbsp;<span class="op" id="6492826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6492829">//&nbsp;Check&nbsp;that&nbsp;pattern&nbsp;matching&nbsp;is&nbsp;working.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6492873">c</span>&nbsp;<span class="op" id="6492875">:=</span>&nbsp;<span class="op" id="6492878">&amp;</span><span class="ident" id="6492879">Certificate</span><span class="op" id="6492890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6492894">DNSNames</span><span class="op" id="6492902">:</span>&nbsp;<span class="op" id="6492904">[</span><span class="op" id="6492905">]</span><span class="builtintype" id="6492906">string</span><span class="op" id="6492912">{</span><span class="string" id="6492913">&#34;*.foo.bar.baz&#34;</span><span class="op" id="6492928">}</span><span class="op" id="6492929">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6492933">Subject</span><span class="op" id="6492940">:</span>&nbsp;<span class="ident" id="6492942">pkix</span><span class="op" id="6492946">.</span><span class="ident" id="6492947">Name</span><span class="op" id="6492951">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6492956">CommonName</span><span class="op" id="6492966">:</span>&nbsp;<span class="string" id="6492968">&#34;*.foo.bar.baz&#34;</span><span class="op" id="6492983">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6492987">}</span><span class="op" id="6492988">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6492991">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6492994">err</span>&nbsp;<span class="op" id="6492998">:=</span>&nbsp;<span class="ident" id="6493001">c</span><span class="op" id="6493002">.</span><span class="ident" id="6493003">VerifyHostname</span><span class="op" id="6493017">(</span><span class="string" id="6493018">&#34;quux.foo.bar.baz&#34;</span><span class="op" id="6493036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6493039">if</span>&nbsp;<span class="ident" id="6493042">err</span>&nbsp;<span class="op" id="6493046">!=</span>&nbsp;<span class="builtintype" id="6493049">nil</span>&nbsp;<span class="op" id="6493053">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6493057">t</span><span class="op" id="6493058">.</span><span class="ident" id="6493059">Fatalf</span><span class="op" id="6493065">(</span><span class="string" id="6493066">&#34;VerifyHostname(quux.foo.bar.baz):&nbsp;%v&#34;</span><span class="op" id="6493104">,</span>&nbsp;<span class="ident" id="6493106">err</span><span class="op" id="6493109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6493112">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6493116">//&nbsp;But&nbsp;check&nbsp;that&nbsp;if&nbsp;we&nbsp;change&nbsp;it&nbsp;to&nbsp;be&nbsp;matching&nbsp;against&nbsp;an&nbsp;IP&nbsp;address,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6493189">//&nbsp;it&nbsp;is&nbsp;rejected.</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6493209">c</span>&nbsp;<span class="op" id="6493211">=</span>&nbsp;<span class="op" id="6493213">&amp;</span><span class="ident" id="6493214">Certificate</span><span class="op" id="6493225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6493229">DNSNames</span><span class="op" id="6493237">:</span>&nbsp;<span class="op" id="6493239">[</span><span class="op" id="6493240">]</span><span class="builtintype" id="6493241">string</span><span class="op" id="6493247">{</span><span class="string" id="6493248">&#34;*.2.3.4&#34;</span><span class="op" id="6493257">}</span><span class="op" id="6493258">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6493262">Subject</span><span class="op" id="6493269">:</span>&nbsp;<span class="ident" id="6493271">pkix</span><span class="op" id="6493275">.</span><span class="ident" id="6493276">Name</span><span class="op" id="6493280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6493285">CommonName</span><span class="op" id="6493295">:</span>&nbsp;<span class="string" id="6493297">&#34;*.2.3.4&#34;</span><span class="op" id="6493306">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6493310">}</span><span class="op" id="6493311">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6493314">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6493317">err</span>&nbsp;<span class="op" id="6493321">=</span>&nbsp;<span class="ident" id="6493323">c</span><span class="op" id="6493324">.</span><span class="ident" id="6493325">VerifyHostname</span><span class="op" id="6493339">(</span><span class="string" id="6493340">&#34;1.2.3.4&#34;</span><span class="op" id="6493349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6493352">if</span>&nbsp;<span class="ident" id="6493355">err</span>&nbsp;<span class="op" id="6493359">==</span>&nbsp;<span class="builtintype" id="6493362">nil</span>&nbsp;<span class="op" id="6493366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6493370">t</span><span class="op" id="6493371">.</span><span class="ident" id="6493372">Fatalf</span><span class="op" id="6493378">(</span><span class="string" id="6493379">&#34;VerifyHostname(1.2.3.4)&nbsp;should&nbsp;have&nbsp;failed,&nbsp;did&nbsp;not&#34;</span><span class="op" id="6493432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6493435">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6493439">c</span>&nbsp;<span class="op" id="6493441">=</span>&nbsp;<span class="op" id="6493443">&amp;</span><span class="ident" id="6493444">Certificate</span><span class="op" id="6493455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6493459">IPAddresses</span><span class="op" id="6493470">:</span>&nbsp;<span class="op" id="6493472">[</span><span class="op" id="6493473">]</span><span class="ident" id="6493474">net</span><span class="op" id="6493477">.</span><span class="ident" id="6493478">IP</span><span class="op" id="6493480">{</span><span class="ident" id="6493481">net</span><span class="op" id="6493484">.</span><span class="ident" id="6493485">ParseIP</span><span class="op" id="6493492">(</span><span class="string" id="6493493">&#34;127.0.0.1&#34;</span><span class="op" id="6493504">)</span><span class="op" id="6493505">,</span>&nbsp;<span class="ident" id="6493507">net</span><span class="op" id="6493510">.</span><span class="ident" id="6493511">ParseIP</span><span class="op" id="6493518">(</span><span class="string" id="6493519">&#34;::1&#34;</span><span class="op" id="6493524">)</span><span class="op" id="6493525">}</span><span class="op" id="6493526">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6493529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6493532">err</span>&nbsp;<span class="op" id="6493536">=</span>&nbsp;<span class="ident" id="6493538">c</span><span class="op" id="6493539">.</span><span class="ident" id="6493540">VerifyHostname</span><span class="op" id="6493554">(</span><span class="string" id="6493555">&#34;127.0.0.1&#34;</span><span class="op" id="6493566">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6493569">if</span>&nbsp;<span class="ident" id="6493572">err</span>&nbsp;<span class="op" id="6493576">!=</span>&nbsp;<span class="builtintype" id="6493579">nil</span>&nbsp;<span class="op" id="6493583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6493587">t</span><span class="op" id="6493588">.</span><span class="ident" id="6493589">Fatalf</span><span class="op" id="6493595">(</span><span class="string" id="6493596">&#34;VerifyHostname(127.0.0.1):&nbsp;%v&#34;</span><span class="op" id="6493627">,</span>&nbsp;<span class="ident" id="6493629">err</span><span class="op" id="6493632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6493635">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6493638">err</span>&nbsp;<span class="op" id="6493642">=</span>&nbsp;<span class="ident" id="6493644">c</span><span class="op" id="6493645">.</span><span class="ident" id="6493646">VerifyHostname</span><span class="op" id="6493660">(</span><span class="string" id="6493661">&#34;::1&#34;</span><span class="op" id="6493666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6493669">if</span>&nbsp;<span class="ident" id="6493672">err</span>&nbsp;<span class="op" id="6493676">!=</span>&nbsp;<span class="builtintype" id="6493679">nil</span>&nbsp;<span class="op" id="6493683">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6493687">t</span><span class="op" id="6493688">.</span><span class="ident" id="6493689">Fatalf</span><span class="op" id="6493695">(</span><span class="string" id="6493696">&#34;VerifyHostname(::1):&nbsp;%v&#34;</span><span class="op" id="6493721">,</span>&nbsp;<span class="ident" id="6493723">err</span><span class="op" id="6493726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6493729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6493732">err</span>&nbsp;<span class="op" id="6493736">=</span>&nbsp;<span class="ident" id="6493738">c</span><span class="op" id="6493739">.</span><span class="ident" id="6493740">VerifyHostname</span><span class="op" id="6493754">(</span><span class="string" id="6493755">&#34;[::1]&#34;</span><span class="op" id="6493762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6493765">if</span>&nbsp;<span class="ident" id="6493768">err</span>&nbsp;<span class="op" id="6493772">!=</span>&nbsp;<span class="builtintype" id="6493775">nil</span>&nbsp;<span class="op" id="6493779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6493783">t</span><span class="op" id="6493784">.</span><span class="ident" id="6493785">Fatalf</span><span class="op" id="6493791">(</span><span class="string" id="6493792">&#34;VerifyHostname([::1]):&nbsp;%v&#34;</span><span class="op" id="6493819">,</span>&nbsp;<span class="ident" id="6493821">err</span><span class="op" id="6493824">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6493827">}</span><br>
<span class="lineno"></span><span class="op" id="6493829">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6493832">func</span>&nbsp;<span class="ident" id="6493837">TestCertificateParse</span><span class="op" id="6493857">(</span><span class="ident" id="6493858">t</span>&nbsp;<span class="op" id="6493860">*</span><span class="ident" id="6493861">testing</span><span class="op" id="6493868">.</span><span class="ident" id="6493869">T</span><span class="op" id="6493870">)</span>&nbsp;<span class="op" id="6493872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6493875">s</span><span class="op" id="6493876">,</span>&nbsp;<span class="ident" id="6493878">_</span>&nbsp;<span class="op" id="6493880">:=</span>&nbsp;<span class="ident" id="6493883">hex</span><span class="op" id="6493886">.</span><span class="ident" id="6493887">DecodeString</span><span class="op" id="6493899">(</span><span class="ident" id="6493900">certBytes</span><span class="op" id="6493909">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6493912">certs</span><span class="op" id="6493917">,</span>&nbsp;<span class="ident" id="6493919">err</span>&nbsp;<span class="op" id="6493923">:=</span>&nbsp;<span class="ident" id="6493926">ParseCertificates</span><span class="op" id="6493943">(</span><span class="ident" id="6493944">s</span><span class="op" id="6493945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6493948">if</span>&nbsp;<span class="ident" id="6493951">err</span>&nbsp;<span class="op" id="6493955">!=</span>&nbsp;<span class="builtintype" id="6493958">nil</span>&nbsp;<span class="op" id="6493962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6493966">t</span><span class="op" id="6493967">.</span><span class="ident" id="6493968">Error</span><span class="op" id="6493973">(</span><span class="ident" id="6493974">err</span><span class="op" id="6493977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6493980">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6493983">if</span>&nbsp;<span class="builtinfunc" id="6493986">len</span><span class="op" id="6493989">(</span><span class="ident" id="6493990">certs</span><span class="op" id="6493995">)</span>&nbsp;<span class="op" id="6493997">!=</span>&nbsp;<span class="num" id="6494000">2</span>&nbsp;<span class="op" id="6494002">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6494006">t</span><span class="op" id="6494007">.</span><span class="ident" id="6494008">Errorf</span><span class="op" id="6494014">(</span><span class="string" id="6494015">&#34;Wrong&nbsp;number&nbsp;of&nbsp;certs:&nbsp;got&nbsp;%d&nbsp;want&nbsp;2&#34;</span><span class="op" id="6494053">,</span>&nbsp;<span class="builtinfunc" id="6494055">len</span><span class="op" id="6494058">(</span><span class="ident" id="6494059">certs</span><span class="op" id="6494064">)</span><span class="op" id="6494065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6494069">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6494077">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6494081">err</span>&nbsp;<span class="op" id="6494085">=</span>&nbsp;<span class="ident" id="6494087">certs</span><span class="op" id="6494092">[</span><span class="num" id="6494093">0</span><span class="op" id="6494094">]</span><span class="op" id="6494095">.</span><span class="ident" id="6494096">CheckSignatureFrom</span><span class="op" id="6494114">(</span><span class="ident" id="6494115">certs</span><span class="op" id="6494120">[</span><span class="num" id="6494121">1</span><span class="op" id="6494122">]</span><span class="op" id="6494123">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6494126">if</span>&nbsp;<span class="ident" id="6494129">err</span>&nbsp;<span class="op" id="6494133">!=</span>&nbsp;<span class="builtintype" id="6494136">nil</span>&nbsp;<span class="op" id="6494140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6494144">t</span><span class="op" id="6494145">.</span><span class="ident" id="6494146">Error</span><span class="op" id="6494151">(</span><span class="ident" id="6494152">err</span><span class="op" id="6494155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6494158">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6494162">if</span>&nbsp;<span class="ident" id="6494165">err</span>&nbsp;<span class="op" id="6494169">:=</span>&nbsp;<span class="ident" id="6494172">certs</span><span class="op" id="6494177">[</span><span class="num" id="6494178">0</span><span class="op" id="6494179">]</span><span class="op" id="6494180">.</span><span class="ident" id="6494181">VerifyHostname</span><span class="op" id="6494195">(</span><span class="string" id="6494196">&#34;mail.google.com&#34;</span><span class="op" id="6494213">)</span><span class="op" id="6494214">;</span>&nbsp;<span class="ident" id="6494216">err</span>&nbsp;<span class="op" id="6494220">!=</span>&nbsp;<span class="builtintype" id="6494223">nil</span>&nbsp;<span class="op" id="6494227">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6494231">t</span><span class="op" id="6494232">.</span><span class="ident" id="6494233">Error</span><span class="op" id="6494238">(</span><span class="ident" id="6494239">err</span><span class="op" id="6494242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6494245">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6494249">const</span>&nbsp;<span class="ident" id="6494255">expectedExtensions</span>&nbsp;<span class="op" id="6494274">=</span>&nbsp;<span class="num" id="6494276">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6494279">if</span>&nbsp;<span class="ident" id="6494282">n</span>&nbsp;<span class="op" id="6494284">:=</span>&nbsp;<span class="builtinfunc" id="6494287">len</span><span class="op" id="6494290">(</span><span class="ident" id="6494291">certs</span><span class="op" id="6494296">[</span><span class="num" id="6494297">0</span><span class="op" id="6494298">]</span><span class="op" id="6494299">.</span><span class="ident" id="6494300">Extensions</span><span class="op" id="6494310">)</span><span class="op" id="6494311">;</span>&nbsp;<span class="ident" id="6494313">n</span>&nbsp;<span class="op" id="6494315">!=</span>&nbsp;<span class="ident" id="6494318">expectedExtensions</span>&nbsp;<span class="op" id="6494337">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6494341">t</span><span class="op" id="6494342">.</span><span class="ident" id="6494343">Errorf</span><span class="op" id="6494349">(</span><span class="string" id="6494350">&#34;want&nbsp;%d&nbsp;extensions,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="6494378">,</span>&nbsp;<span class="ident" id="6494380">expectedExtensions</span><span class="op" id="6494398">,</span>&nbsp;<span class="ident" id="6494400">n</span><span class="op" id="6494401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6494404">}</span><br>
<span class="lineno"></span><span class="op" id="6494406">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6494409">var</span>&nbsp;<span class="ident" id="6494413">certBytes</span>&nbsp;<span class="op" id="6494423">=</span>&nbsp;<span class="string" id="6494425">&#34;308203223082028ba00302010202106edf0d9499fd4533dd1297fc42a93be1300d06092a864886&#34;</span>&nbsp;<span class="op" id="6494506">+</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6494509">&#34;f70d0101050500304c310b3009060355040613025a4131253023060355040a131c546861777465&#34;</span>&nbsp;<span class="op" id="6494590">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6494593">&#34;20436f6e73756c74696e67202850747929204c74642e311630140603550403130d546861777465&#34;</span>&nbsp;<span class="op" id="6494674">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6494677">&#34;20534743204341301e170d3039303332353136343932395a170d3130303332353136343932395a&#34;</span>&nbsp;<span class="op" id="6494758">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6494761">&#34;3069310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630&#34;</span>&nbsp;<span class="op" id="6494842">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6494845">&#34;140603550407130d4d6f756e7461696e205669657731133011060355040a130a476f6f676c6520&#34;</span>&nbsp;<span class="op" id="6494926">+</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6494929">&#34;496e63311830160603550403130f6d61696c2e676f6f676c652e636f6d30819f300d06092a8648&#34;</span>&nbsp;<span class="op" id="6495010">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6495013">&#34;86f70d010101050003818d0030818902818100c5d6f892fccaf5614b064149e80a2c9581a218ef&#34;</span>&nbsp;<span class="op" id="6495094">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6495097">&#34;41ec35bd7a58125ae76f9ea54ddc893abbeb029f6b73616bf0ffd868791fba7af9c4aebf3706ba&#34;</span>&nbsp;<span class="op" id="6495178">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6495181">&#34;3eeaeed27435b4ddcfb157c05f351d66aa87fee0de072d66d773affbd36ab78bef090e0cc861a9&#34;</span>&nbsp;<span class="op" id="6495262">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6495265">&#34;03ac90dd98b51c9c41566c017f0beec3bff391051ffba0f5cc6850ad2a590203010001a381e730&#34;</span>&nbsp;<span class="op" id="6495346">+</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6495349">&#34;81e430280603551d250421301f06082b0601050507030106082b06010505070302060960864801&#34;</span>&nbsp;<span class="op" id="6495430">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6495433">&#34;86f842040130360603551d1f042f302d302ba029a0278625687474703a2f2f63726c2e74686177&#34;</span>&nbsp;<span class="op" id="6495514">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6495517">&#34;74652e636f6d2f54686177746553474343412e63726c307206082b060105050701010466306430&#34;</span>&nbsp;<span class="op" id="6495598">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6495601">&#34;2206082b060105050730018616687474703a2f2f6f6373702e7468617774652e636f6d303e0608&#34;</span>&nbsp;<span class="op" id="6495682">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6495685">&#34;2b060105050730028632687474703a2f2f7777772e7468617774652e636f6d2f7265706f736974&#34;</span>&nbsp;<span class="op" id="6495766">+</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6495769">&#34;6f72792f5468617774655f5347435f43412e637274300c0603551d130101ff04023000300d0609&#34;</span>&nbsp;<span class="op" id="6495850">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6495853">&#34;2a864886f70d01010505000381810062f1f3050ebc105e497c7aedf87e24d2f4a986bb3b837bd1&#34;</span>&nbsp;<span class="op" id="6495934">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6495937">&#34;9b91ebcad98b065992f6bd2b49b7d6d3cb2e427a99d606c7b1d46352527fac39e6a8b6726de5bf&#34;</span>&nbsp;<span class="op" id="6496018">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6496021">&#34;70212a52cba07634a5e332011bd1868e78eb5e3c93cf03072276786f207494feaa0ed9d53b2110&#34;</span>&nbsp;<span class="op" id="6496102">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6496105">&#34;a76571f90209cdae884385c882587030ee15f33d761e2e45a6bc308203233082028ca003020102&#34;</span>&nbsp;<span class="op" id="6496186">+</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6496189">&#34;020430000002300d06092a864886f70d0101050500305f310b3009060355040613025553311730&#34;</span>&nbsp;<span class="op" id="6496270">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6496273">&#34;15060355040a130e566572695369676e2c20496e632e31373035060355040b132e436c61737320&#34;</span>&nbsp;<span class="op" id="6496354">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6496357">&#34;33205075626c6963205072696d6172792043657274696669636174696f6e20417574686f726974&#34;</span>&nbsp;<span class="op" id="6496438">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6496441">&#34;79301e170d3034303531333030303030305a170d3134303531323233353935395a304c310b3009&#34;</span>&nbsp;<span class="op" id="6496522">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6496525">&#34;060355040613025a4131253023060355040a131c54686177746520436f6e73756c74696e672028&#34;</span>&nbsp;<span class="op" id="6496606">+</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6496609">&#34;50747929204c74642e311630140603550403130d5468617774652053474320434130819f300d06&#34;</span>&nbsp;<span class="op" id="6496690">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6496693">&#34;092a864886f70d010101050003818d0030818902818100d4d367d08d157faecd31fe7d1d91a13f&#34;</span>&nbsp;<span class="op" id="6496774">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6496777">&#34;0b713cacccc864fb63fc324b0794bd6f80ba2fe10493c033fc093323e90b742b71c403c6d2cde2&#34;</span>&nbsp;<span class="op" id="6496858">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6496861">&#34;2ff50963cdff48a500bfe0e7f388b72d32de9836e60aad007bc4644a3b847503f270927d0e62f5&#34;</span>&nbsp;<span class="op" id="6496942">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6496945">&#34;21ab693684317590f8bfc76c881b06957cc9e5a8de75a12c7a68dfd5ca1c875860190203010001&#34;</span>&nbsp;<span class="op" id="6497026">+</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6497029">&#34;a381fe3081fb30120603551d130101ff040830060101ff020100300b0603551d0f040403020106&#34;</span>&nbsp;<span class="op" id="6497110">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6497113">&#34;301106096086480186f842010104040302010630280603551d110421301fa41d301b3119301706&#34;</span>&nbsp;<span class="op" id="6497194">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6497197">&#34;035504031310507269766174654c6162656c332d313530310603551d1f042a30283026a024a022&#34;</span>&nbsp;<span class="op" id="6497278">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6497281">&#34;8620687474703a2f2f63726c2e766572697369676e2e636f6d2f706361332e63726c303206082b&#34;</span>&nbsp;<span class="op" id="6497362">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6497365">&#34;0601050507010104263024302206082b060105050730018616687474703a2f2f6f6373702e7468&#34;</span>&nbsp;<span class="op" id="6497446">+</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6497449">&#34;617774652e636f6d30340603551d25042d302b06082b0601050507030106082b06010505070302&#34;</span>&nbsp;<span class="op" id="6497530">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6497533">&#34;06096086480186f8420401060a6086480186f845010801300d06092a864886f70d010105050003&#34;</span>&nbsp;<span class="op" id="6497614">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6497617">&#34;81810055ac63eadea1ddd2905f9f0bce76be13518f93d9052bc81b774bad6950a1eededcfddb07&#34;</span>&nbsp;<span class="op" id="6497698">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6497701">&#34;e9e83994dcab72792f06bfab8170c4a8edea5334edef1e53d906c7562bd15cf4d18a8eb42bb137&#34;</span>&nbsp;<span class="op" id="6497782">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6497785">&#34;9048084225c53e8acb7feb6f04d16dc574a2f7a27c7b603c77cd0ece48027f012fb69b37e02a2a&#34;</span>&nbsp;<span class="op" id="6497866">+</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6497869">&#34;36dcd585d6ace53f546f961e05af&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6497901">func</span>&nbsp;<span class="ident" id="6497906">TestCreateSelfSignedCertificate</span><span class="op" id="6497937">(</span><span class="ident" id="6497938">t</span>&nbsp;<span class="op" id="6497940">*</span><span class="ident" id="6497941">testing</span><span class="op" id="6497948">.</span><span class="ident" id="6497949">T</span><span class="op" id="6497950">)</span>&nbsp;<span class="op" id="6497952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6497955">random</span>&nbsp;<span class="op" id="6497962">:=</span>&nbsp;<span class="ident" id="6497965">rand</span><span class="op" id="6497969">.</span><span class="ident" id="6497970">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6497979">block</span><span class="op" id="6497984">,</span>&nbsp;<span class="ident" id="6497986">_</span>&nbsp;<span class="op" id="6497988">:=</span>&nbsp;<span class="ident" id="6497991">pem</span><span class="op" id="6497994">.</span><span class="ident" id="6497995">Decode</span><span class="op" id="6498001">(</span><span class="op" id="6498002">[</span><span class="op" id="6498003">]</span><span class="builtintype" id="6498004">byte</span><span class="op" id="6498008">(</span><span class="ident" id="6498009">pemPrivateKey</span><span class="op" id="6498022">)</span><span class="op" id="6498023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6498026">rsaPriv</span><span class="op" id="6498033">,</span>&nbsp;<span class="ident" id="6498035">err</span>&nbsp;<span class="op" id="6498039">:=</span>&nbsp;<span class="ident" id="6498042">ParsePKCS1PrivateKey</span><span class="op" id="6498062">(</span><span class="ident" id="6498063">block</span><span class="op" id="6498068">.</span><span class="ident" id="6498069">Bytes</span><span class="op" id="6498074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6498077">if</span>&nbsp;<span class="ident" id="6498080">err</span>&nbsp;<span class="op" id="6498084">!=</span>&nbsp;<span class="builtintype" id="6498087">nil</span>&nbsp;<span class="op" id="6498091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6498095">t</span><span class="op" id="6498096">.</span><span class="ident" id="6498097">Fatalf</span><span class="op" id="6498103">(</span><span class="string" id="6498104">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="6498137">,</span>&nbsp;<span class="ident" id="6498139">err</span><span class="op" id="6498142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6498145">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6498149">ecdsaPriv</span><span class="op" id="6498158">,</span>&nbsp;<span class="ident" id="6498160">err</span>&nbsp;<span class="op" id="6498164">:=</span>&nbsp;<span class="ident" id="6498167">ecdsa</span><span class="op" id="6498172">.</span><span class="ident" id="6498173">GenerateKey</span><span class="op" id="6498184">(</span><span class="ident" id="6498185">elliptic</span><span class="op" id="6498193">.</span><span class="ident" id="6498194">P256</span><span class="op" id="6498198">(</span><span class="op" id="6498199">)</span><span class="op" id="6498200">,</span>&nbsp;<span class="ident" id="6498202">rand</span><span class="op" id="6498206">.</span><span class="ident" id="6498207">Reader</span><span class="op" id="6498213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6498216">if</span>&nbsp;<span class="ident" id="6498219">err</span>&nbsp;<span class="op" id="6498223">!=</span>&nbsp;<span class="builtintype" id="6498226">nil</span>&nbsp;<span class="op" id="6498230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6498234">t</span><span class="op" id="6498235">.</span><span class="ident" id="6498236">Fatalf</span><span class="op" id="6498242">(</span><span class="string" id="6498243">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="6498277">,</span>&nbsp;<span class="ident" id="6498279">err</span><span class="op" id="6498282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6498285">}</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6498289">tests</span>&nbsp;<span class="op" id="6498295">:=</span>&nbsp;<span class="op" id="6498298">[</span><span class="op" id="6498299">]</span><span class="keyword" id="6498300">struct</span>&nbsp;<span class="op" id="6498307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6498311">name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6498321">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6498330">pub</span><span class="op" id="6498333">,</span>&nbsp;<span class="ident" id="6498335">priv</span>&nbsp;<span class="keyword" id="6498340">interface</span><span class="op" id="6498349">{</span><span class="op" id="6498350">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6498354">checkSig</span>&nbsp;&nbsp;<span class="builtintype" id="6498364">bool</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6498371">sigAlgo</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6498381">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6498401">}</span><span class="op" id="6498402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6498406">{</span><span class="string" id="6498407">&#34;RSA/RSA&#34;</span><span class="op" id="6498416">,</span>&nbsp;<span class="op" id="6498418">&amp;</span><span class="ident" id="6498419">rsaPriv</span><span class="op" id="6498426">.</span><span class="ident" id="6498427">PublicKey</span><span class="op" id="6498436">,</span>&nbsp;<span class="ident" id="6498438">rsaPriv</span><span class="op" id="6498445">,</span>&nbsp;<span class="builtintype" id="6498447">true</span><span class="op" id="6498451">,</span>&nbsp;<span class="ident" id="6498453">SHA1WithRSA</span><span class="op" id="6498464">}</span><span class="op" id="6498465">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6498469">{</span><span class="string" id="6498470">&#34;RSA/ECDSA&#34;</span><span class="op" id="6498481">,</span>&nbsp;<span class="op" id="6498483">&amp;</span><span class="ident" id="6498484">rsaPriv</span><span class="op" id="6498491">.</span><span class="ident" id="6498492">PublicKey</span><span class="op" id="6498501">,</span>&nbsp;<span class="ident" id="6498503">ecdsaPriv</span><span class="op" id="6498512">,</span>&nbsp;<span class="builtintype" id="6498514">false</span><span class="op" id="6498519">,</span>&nbsp;<span class="ident" id="6498521">ECDSAWithSHA384</span><span class="op" id="6498536">}</span><span class="op" id="6498537">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6498541">{</span><span class="string" id="6498542">&#34;ECDSA/RSA&#34;</span><span class="op" id="6498553">,</span>&nbsp;<span class="op" id="6498555">&amp;</span><span class="ident" id="6498556">ecdsaPriv</span><span class="op" id="6498565">.</span><span class="ident" id="6498566">PublicKey</span><span class="op" id="6498575">,</span>&nbsp;<span class="ident" id="6498577">rsaPriv</span><span class="op" id="6498584">,</span>&nbsp;<span class="builtintype" id="6498586">false</span><span class="op" id="6498591">,</span>&nbsp;<span class="ident" id="6498593">SHA256WithRSA</span><span class="op" id="6498606">}</span><span class="op" id="6498607">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6498611">{</span><span class="string" id="6498612">&#34;ECDSA/ECDSA&#34;</span><span class="op" id="6498625">,</span>&nbsp;<span class="op" id="6498627">&amp;</span><span class="ident" id="6498628">ecdsaPriv</span><span class="op" id="6498637">.</span><span class="ident" id="6498638">PublicKey</span><span class="op" id="6498647">,</span>&nbsp;<span class="ident" id="6498649">ecdsaPriv</span><span class="op" id="6498658">,</span>&nbsp;<span class="builtintype" id="6498660">true</span><span class="op" id="6498664">,</span>&nbsp;<span class="ident" id="6498666">ECDSAWithSHA1</span><span class="op" id="6498679">}</span><span class="op" id="6498680">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6498683">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6498687">testExtKeyUsage</span>&nbsp;<span class="op" id="6498703">:=</span>&nbsp;<span class="op" id="6498706">[</span><span class="op" id="6498707">]</span><span class="ident" id="6498708">ExtKeyUsage</span><span class="op" id="6498719">{</span><span class="ident" id="6498720">ExtKeyUsageClientAuth</span><span class="op" id="6498741">,</span>&nbsp;<span class="ident" id="6498743">ExtKeyUsageServerAuth</span><span class="op" id="6498764">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6498767">testUnknownExtKeyUsage</span>&nbsp;<span class="op" id="6498790">:=</span>&nbsp;<span class="op" id="6498793">[</span><span class="op" id="6498794">]</span><span class="ident" id="6498795">asn1</span><span class="op" id="6498799">.</span><span class="ident" id="6498800">ObjectIdentifier</span><span class="op" id="6498816">{</span><span class="op" id="6498817">[</span><span class="op" id="6498818">]</span><span class="builtintype" id="6498819">int</span><span class="op" id="6498822">{</span><span class="num" id="6498823">1</span><span class="op" id="6498824">,</span>&nbsp;<span class="num" id="6498826">2</span><span class="op" id="6498827">,</span>&nbsp;<span class="num" id="6498829">3</span><span class="op" id="6498830">}</span><span class="op" id="6498831">,</span>&nbsp;<span class="op" id="6498833">[</span><span class="op" id="6498834">]</span><span class="builtintype" id="6498835">int</span><span class="op" id="6498838">{</span><span class="num" id="6498839">2</span><span class="op" id="6498840">,</span>&nbsp;<span class="num" id="6498842">59</span><span class="op" id="6498844">,</span>&nbsp;<span class="num" id="6498846">1</span><span class="op" id="6498847">}</span><span class="op" id="6498848">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6498851">extraExtensionData</span>&nbsp;<span class="op" id="6498870">:=</span>&nbsp;<span class="op" id="6498873">[</span><span class="op" id="6498874">]</span><span class="builtintype" id="6498875">byte</span><span class="op" id="6498879">(</span><span class="string" id="6498880">&#34;extra&nbsp;extension&#34;</span><span class="op" id="6498897">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6498901">for</span>&nbsp;<span class="ident" id="6498905">_</span><span class="op" id="6498906">,</span>&nbsp;<span class="ident" id="6498908">test</span>&nbsp;<span class="op" id="6498913">:=</span>&nbsp;<span class="keyword" id="6498916">range</span>&nbsp;<span class="ident" id="6498922">tests</span>&nbsp;<span class="op" id="6498928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6498932">commonName</span>&nbsp;<span class="op" id="6498943">:=</span>&nbsp;<span class="string" id="6498946">&#34;test.example.com&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6498967">template</span>&nbsp;<span class="op" id="6498976">:=</span>&nbsp;<span class="ident" id="6498979">Certificate</span><span class="op" id="6498990">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6498995">SerialNumber</span><span class="op" id="6499007">:</span>&nbsp;<span class="ident" id="6499009">big</span><span class="op" id="6499012">.</span><span class="ident" id="6499013">NewInt</span><span class="op" id="6499019">(</span><span class="num" id="6499020">1</span><span class="op" id="6499021">)</span><span class="op" id="6499022">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6499027">Subject</span><span class="op" id="6499034">:</span>&nbsp;<span class="ident" id="6499036">pkix</span><span class="op" id="6499040">.</span><span class="ident" id="6499041">Name</span><span class="op" id="6499045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6499051">CommonName</span><span class="op" id="6499061">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6499065">commonName</span><span class="op" id="6499075">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6499081">Organization</span><span class="op" id="6499093">:</span>&nbsp;<span class="op" id="6499095">[</span><span class="op" id="6499096">]</span><span class="builtintype" id="6499097">string</span><span class="op" id="6499103">{</span><span class="string" id="6499104">&#34;Σ&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="6499116">}</span><span class="op" id="6499117">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6499122">}</span><span class="op" id="6499123">,</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6499128">NotBefore</span><span class="op" id="6499137">:</span>&nbsp;<span class="ident" id="6499139">time</span><span class="op" id="6499143">.</span><span class="ident" id="6499144">Unix</span><span class="op" id="6499148">(</span><span class="num" id="6499149">1000</span><span class="op" id="6499153">,</span>&nbsp;<span class="num" id="6499155">0</span><span class="op" id="6499156">)</span><span class="op" id="6499157">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6499162">NotAfter</span><span class="op" id="6499170">:</span>&nbsp;&nbsp;<span class="ident" id="6499173">time</span><span class="op" id="6499177">.</span><span class="ident" id="6499178">Unix</span><span class="op" id="6499182">(</span><span class="num" id="6499183">100000</span><span class="op" id="6499189">,</span>&nbsp;<span class="num" id="6499191">0</span><span class="op" id="6499192">)</span><span class="op" id="6499193">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6499199">SignatureAlgorithm</span><span class="op" id="6499217">:</span>&nbsp;<span class="ident" id="6499219">test</span><span class="op" id="6499223">.</span><span class="ident" id="6499224">sigAlgo</span><span class="op" id="6499231">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6499237">SubjectKeyId</span><span class="op" id="6499249">:</span>&nbsp;<span class="op" id="6499251">[</span><span class="op" id="6499252">]</span><span class="builtintype" id="6499253">byte</span><span class="op" id="6499257">{</span><span class="num" id="6499258">1</span><span class="op" id="6499259">,</span>&nbsp;<span class="num" id="6499261">2</span><span class="op" id="6499262">,</span>&nbsp;<span class="num" id="6499264">3</span><span class="op" id="6499265">,</span>&nbsp;<span class="num" id="6499267">4</span><span class="op" id="6499268">}</span><span class="op" id="6499269">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6499274">KeyUsage</span><span class="op" id="6499282">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6499288">KeyUsageCertSign</span><span class="op" id="6499304">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6499310">ExtKeyUsage</span><span class="op" id="6499321">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6499330">testExtKeyUsage</span><span class="op" id="6499345">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6499350">UnknownExtKeyUsage</span><span class="op" id="6499368">:</span>&nbsp;<span class="ident" id="6499370">testUnknownExtKeyUsage</span><span class="op" id="6499392">,</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6499398">BasicConstraintsValid</span><span class="op" id="6499419">:</span>&nbsp;<span class="builtintype" id="6499421">true</span><span class="op" id="6499425">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6499430">IsCA</span><span class="op" id="6499434">:</span>&nbsp;<span class="builtintype" id="6499436">true</span><span class="op" id="6499440">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6499446">OCSPServer</span><span class="op" id="6499456">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6499469">[</span><span class="op" id="6499470">]</span><span class="builtintype" id="6499471">string</span><span class="op" id="6499477">{</span><span class="string" id="6499478">&#34;http://ocsp.example.com&#34;</span><span class="op" id="6499503">}</span><span class="op" id="6499504">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6499509">IssuingCertificateURL</span><span class="op" id="6499530">:</span>&nbsp;<span class="op" id="6499532">[</span><span class="op" id="6499533">]</span><span class="builtintype" id="6499534">string</span><span class="op" id="6499540">{</span><span class="string" id="6499541">&#34;http://crt.example.com/ca1.crt&#34;</span><span class="op" id="6499573">}</span><span class="op" id="6499574">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6499580">DNSNames</span><span class="op" id="6499588">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6499596">[</span><span class="op" id="6499597">]</span><span class="builtintype" id="6499598">string</span><span class="op" id="6499604">{</span><span class="string" id="6499605">&#34;test.example.com&#34;</span><span class="op" id="6499623">}</span><span class="op" id="6499624">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6499629">EmailAddresses</span><span class="op" id="6499643">:</span>&nbsp;<span class="op" id="6499645">[</span><span class="op" id="6499646">]</span><span class="builtintype" id="6499647">string</span><span class="op" id="6499653">{</span><span class="string" id="6499654">&#34;gopher@golang.org&#34;</span><span class="op" id="6499673">}</span><span class="op" id="6499674">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6499679">IPAddresses</span><span class="op" id="6499690">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6499695">[</span><span class="op" id="6499696">]</span><span class="ident" id="6499697">net</span><span class="op" id="6499700">.</span><span class="ident" id="6499701">IP</span><span class="op" id="6499703">{</span><span class="ident" id="6499704">net</span><span class="op" id="6499707">.</span><span class="ident" id="6499708">IPv4</span><span class="op" id="6499712">(</span><span class="num" id="6499713">127</span><span class="op" id="6499716">,</span>&nbsp;<span class="num" id="6499718">0</span><span class="op" id="6499719">,</span>&nbsp;<span class="num" id="6499721">0</span><span class="op" id="6499722">,</span>&nbsp;<span class="num" id="6499724">1</span><span class="op" id="6499725">)</span><span class="op" id="6499726">.</span><span class="ident" id="6499727">To4</span><span class="op" id="6499730">(</span><span class="op" id="6499731">)</span><span class="op" id="6499732">,</span>&nbsp;<span class="ident" id="6499734">net</span><span class="op" id="6499737">.</span><span class="ident" id="6499738">ParseIP</span><span class="op" id="6499745">(</span><span class="string" id="6499746">&#34;2001:4860:0:2001::68&#34;</span><span class="op" id="6499768">)</span><span class="op" id="6499769">}</span><span class="op" id="6499770">,</span><br>
<span class="lineno">350</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6499776">PolicyIdentifiers</span><span class="op" id="6499793">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6499797">[</span><span class="op" id="6499798">]</span><span class="ident" id="6499799">asn1</span><span class="op" id="6499803">.</span><span class="ident" id="6499804">ObjectIdentifier</span><span class="op" id="6499820">{</span><span class="op" id="6499821">[</span><span class="op" id="6499822">]</span><span class="builtintype" id="6499823">int</span><span class="op" id="6499826">{</span><span class="num" id="6499827">1</span><span class="op" id="6499828">,</span>&nbsp;<span class="num" id="6499830">2</span><span class="op" id="6499831">,</span>&nbsp;<span class="num" id="6499833">3</span><span class="op" id="6499834">}</span><span class="op" id="6499835">}</span><span class="op" id="6499836">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6499841">PermittedDNSDomains</span><span class="op" id="6499860">:</span>&nbsp;<span class="op" id="6499862">[</span><span class="op" id="6499863">]</span><span class="builtintype" id="6499864">string</span><span class="op" id="6499870">{</span><span class="string" id="6499871">&#34;.example.com&#34;</span><span class="op" id="6499885">,</span>&nbsp;<span class="string" id="6499887">&#34;example.com&#34;</span><span class="op" id="6499900">}</span><span class="op" id="6499901">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6499907">CRLDistributionPoints</span><span class="op" id="6499928">:</span>&nbsp;<span class="op" id="6499930">[</span><span class="op" id="6499931">]</span><span class="builtintype" id="6499932">string</span><span class="op" id="6499938">{</span><span class="string" id="6499939">&#34;http://crl1.example.com/ca1.crl&#34;</span><span class="op" id="6499972">,</span>&nbsp;<span class="string" id="6499974">&#34;http://crl2.example.com/ca1.crl&#34;</span><span class="op" id="6500007">}</span><span class="op" id="6500008">,</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6500014">ExtraExtensions</span><span class="op" id="6500029">:</span>&nbsp;<span class="op" id="6500031">[</span><span class="op" id="6500032">]</span><span class="ident" id="6500033">pkix</span><span class="op" id="6500037">.</span><span class="ident" id="6500038">Extension</span><span class="op" id="6500047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6500053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6500060">Id</span><span class="op" id="6500062">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6500067">[</span><span class="op" id="6500068">]</span><span class="builtintype" id="6500069">int</span><span class="op" id="6500072">{</span><span class="num" id="6500073">1</span><span class="op" id="6500074">,</span>&nbsp;<span class="num" id="6500076">2</span><span class="op" id="6500077">,</span>&nbsp;<span class="num" id="6500079">3</span><span class="op" id="6500080">,</span>&nbsp;<span class="num" id="6500082">4</span><span class="op" id="6500083">}</span><span class="op" id="6500084">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6500091">Value</span><span class="op" id="6500096">:</span>&nbsp;<span class="ident" id="6500098">extraExtensionData</span><span class="op" id="6500116">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6500122">}</span><span class="op" id="6500123">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6500129">//&nbsp;This&nbsp;extension&nbsp;should&nbsp;override&nbsp;the&nbsp;SubjectKeyId,&nbsp;above.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6500192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6500199">Id</span><span class="op" id="6500201">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6500209">oidExtensionSubjectKeyId</span><span class="op" id="6500233">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6500240">Critical</span><span class="op" id="6500248">:</span>&nbsp;<span class="builtintype" id="6500250">false</span><span class="op" id="6500255">,</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6500262">Value</span><span class="op" id="6500267">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6500272">[</span><span class="op" id="6500273">]</span><span class="builtintype" id="6500274">byte</span><span class="op" id="6500278">{</span><span class="num" id="6500279">0x04</span><span class="op" id="6500283">,</span>&nbsp;<span class="num" id="6500285">0x04</span><span class="op" id="6500289">,</span>&nbsp;<span class="num" id="6500291">4</span><span class="op" id="6500292">,</span>&nbsp;<span class="num" id="6500294">3</span><span class="op" id="6500295">,</span>&nbsp;<span class="num" id="6500297">2</span><span class="op" id="6500298">,</span>&nbsp;<span class="num" id="6500300">1</span><span class="op" id="6500301">}</span><span class="op" id="6500302">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6500308">}</span><span class="op" id="6500309">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6500314">}</span><span class="op" id="6500315">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6500319">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6500324">derBytes</span><span class="op" id="6500332">,</span>&nbsp;<span class="ident" id="6500334">err</span>&nbsp;<span class="op" id="6500338">:=</span>&nbsp;<span class="ident" id="6500341">CreateCertificate</span><span class="op" id="6500358">(</span><span class="ident" id="6500359">random</span><span class="op" id="6500365">,</span>&nbsp;<span class="op" id="6500367">&amp;</span><span class="ident" id="6500368">template</span><span class="op" id="6500376">,</span>&nbsp;<span class="op" id="6500378">&amp;</span><span class="ident" id="6500379">template</span><span class="op" id="6500387">,</span>&nbsp;<span class="ident" id="6500389">test</span><span class="op" id="6500393">.</span><span class="ident" id="6500394">pub</span><span class="op" id="6500397">,</span>&nbsp;<span class="ident" id="6500399">test</span><span class="op" id="6500403">.</span><span class="ident" id="6500404">priv</span><span class="op" id="6500408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6500412">if</span>&nbsp;<span class="ident" id="6500415">err</span>&nbsp;<span class="op" id="6500419">!=</span>&nbsp;<span class="builtintype" id="6500422">nil</span>&nbsp;<span class="op" id="6500426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6500431">t</span><span class="op" id="6500432">.</span><span class="ident" id="6500433">Errorf</span><span class="op" id="6500439">(</span><span class="string" id="6500440">&#34;%s:&nbsp;failed&nbsp;to&nbsp;create&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="6500478">,</span>&nbsp;<span class="ident" id="6500480">test</span><span class="op" id="6500484">.</span><span class="ident" id="6500485">name</span><span class="op" id="6500489">,</span>&nbsp;<span class="ident" id="6500491">err</span><span class="op" id="6500494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6500499">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6500510">}</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6500515">cert</span><span class="op" id="6500519">,</span>&nbsp;<span class="ident" id="6500521">err</span>&nbsp;<span class="op" id="6500525">:=</span>&nbsp;<span class="ident" id="6500528">ParseCertificate</span><span class="op" id="6500544">(</span><span class="ident" id="6500545">derBytes</span><span class="op" id="6500553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6500557">if</span>&nbsp;<span class="ident" id="6500560">err</span>&nbsp;<span class="op" id="6500564">!=</span>&nbsp;<span class="builtintype" id="6500567">nil</span>&nbsp;<span class="op" id="6500571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6500576">t</span><span class="op" id="6500577">.</span><span class="ident" id="6500578">Errorf</span><span class="op" id="6500584">(</span><span class="string" id="6500585">&#34;%s:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="6500622">,</span>&nbsp;<span class="ident" id="6500624">test</span><span class="op" id="6500628">.</span><span class="ident" id="6500629">name</span><span class="op" id="6500633">,</span>&nbsp;<span class="ident" id="6500635">err</span><span class="op" id="6500638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6500643">continue</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6500654">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6500659">if</span>&nbsp;<span class="builtinfunc" id="6500662">len</span><span class="op" id="6500665">(</span><span class="ident" id="6500666">cert</span><span class="op" id="6500670">.</span><span class="ident" id="6500671">PolicyIdentifiers</span><span class="op" id="6500688">)</span>&nbsp;<span class="op" id="6500690">!=</span>&nbsp;<span class="num" id="6500693">1</span>&nbsp;<span class="op" id="6500695">||</span>&nbsp;<span class="op" id="6500698">!</span><span class="ident" id="6500699">cert</span><span class="op" id="6500703">.</span><span class="ident" id="6500704">PolicyIdentifiers</span><span class="op" id="6500721">[</span><span class="num" id="6500722">0</span><span class="op" id="6500723">]</span><span class="op" id="6500724">.</span><span class="ident" id="6500725">Equal</span><span class="op" id="6500730">(</span><span class="ident" id="6500731">template</span><span class="op" id="6500739">.</span><span class="ident" id="6500740">PolicyIdentifiers</span><span class="op" id="6500757">[</span><span class="num" id="6500758">0</span><span class="op" id="6500759">]</span><span class="op" id="6500760">)</span>&nbsp;<span class="op" id="6500762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6500767">t</span><span class="op" id="6500768">.</span><span class="ident" id="6500769">Errorf</span><span class="op" id="6500775">(</span><span class="string" id="6500776">&#34;%s:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;policy&nbsp;identifiers:&nbsp;got:%#v&nbsp;want:%#v&#34;</span><span class="op" id="6500834">,</span>&nbsp;<span class="ident" id="6500836">test</span><span class="op" id="6500840">.</span><span class="ident" id="6500841">name</span><span class="op" id="6500845">,</span>&nbsp;<span class="ident" id="6500847">cert</span><span class="op" id="6500851">.</span><span class="ident" id="6500852">PolicyIdentifiers</span><span class="op" id="6500869">,</span>&nbsp;<span class="ident" id="6500871">template</span><span class="op" id="6500879">.</span><span class="ident" id="6500880">PolicyIdentifiers</span><span class="op" id="6500897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6500901">}</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6500906">if</span>&nbsp;<span class="builtinfunc" id="6500909">len</span><span class="op" id="6500912">(</span><span class="ident" id="6500913">cert</span><span class="op" id="6500917">.</span><span class="ident" id="6500918">PermittedDNSDomains</span><span class="op" id="6500937">)</span>&nbsp;<span class="op" id="6500939">!=</span>&nbsp;<span class="num" id="6500942">2</span>&nbsp;<span class="op" id="6500944">||</span>&nbsp;<span class="ident" id="6500947">cert</span><span class="op" id="6500951">.</span><span class="ident" id="6500952">PermittedDNSDomains</span><span class="op" id="6500971">[</span><span class="num" id="6500972">0</span><span class="op" id="6500973">]</span>&nbsp;<span class="op" id="6500975">!=</span>&nbsp;<span class="string" id="6500978">&#34;.example.com&#34;</span>&nbsp;<span class="op" id="6500993">||</span>&nbsp;<span class="ident" id="6500996">cert</span><span class="op" id="6501000">.</span><span class="ident" id="6501001">PermittedDNSDomains</span><span class="op" id="6501020">[</span><span class="num" id="6501021">1</span><span class="op" id="6501022">]</span>&nbsp;<span class="op" id="6501024">!=</span>&nbsp;<span class="string" id="6501027">&#34;example.com&#34;</span>&nbsp;<span class="op" id="6501041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6501046">t</span><span class="op" id="6501047">.</span><span class="ident" id="6501048">Errorf</span><span class="op" id="6501054">(</span><span class="string" id="6501055">&#34;%s:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;name&nbsp;constraints:&nbsp;%#v&#34;</span><span class="op" id="6501098">,</span>&nbsp;<span class="ident" id="6501100">test</span><span class="op" id="6501104">.</span><span class="ident" id="6501105">name</span><span class="op" id="6501109">,</span>&nbsp;<span class="ident" id="6501111">cert</span><span class="op" id="6501115">.</span><span class="ident" id="6501116">PermittedDNSDomains</span><span class="op" id="6501135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6501139">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6501144">if</span>&nbsp;<span class="ident" id="6501147">cert</span><span class="op" id="6501151">.</span><span class="ident" id="6501152">Subject</span><span class="op" id="6501159">.</span><span class="ident" id="6501160">CommonName</span>&nbsp;<span class="op" id="6501171">!=</span>&nbsp;<span class="ident" id="6501174">commonName</span>&nbsp;<span class="op" id="6501185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6501190">t</span><span class="op" id="6501191">.</span><span class="ident" id="6501192">Errorf</span><span class="op" id="6501198">(</span><span class="string" id="6501199">&#34;%s:&nbsp;subject&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="6501271">,</span>&nbsp;<span class="ident" id="6501273">test</span><span class="op" id="6501277">.</span><span class="ident" id="6501278">name</span><span class="op" id="6501282">,</span>&nbsp;<span class="ident" id="6501284">cert</span><span class="op" id="6501288">.</span><span class="ident" id="6501289">Subject</span><span class="op" id="6501296">.</span><span class="ident" id="6501297">CommonName</span><span class="op" id="6501307">,</span>&nbsp;<span class="ident" id="6501309">commonName</span><span class="op" id="6501319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6501323">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6501328">if</span>&nbsp;<span class="ident" id="6501331">cert</span><span class="op" id="6501335">.</span><span class="ident" id="6501336">Issuer</span><span class="op" id="6501342">.</span><span class="ident" id="6501343">CommonName</span>&nbsp;<span class="op" id="6501354">!=</span>&nbsp;<span class="ident" id="6501357">commonName</span>&nbsp;<span class="op" id="6501368">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6501373">t</span><span class="op" id="6501374">.</span><span class="ident" id="6501375">Errorf</span><span class="op" id="6501381">(</span><span class="string" id="6501382">&#34;%s:&nbsp;issuer&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="6501453">,</span>&nbsp;<span class="ident" id="6501455">test</span><span class="op" id="6501459">.</span><span class="ident" id="6501460">name</span><span class="op" id="6501464">,</span>&nbsp;<span class="ident" id="6501466">cert</span><span class="op" id="6501470">.</span><span class="ident" id="6501471">Issuer</span><span class="op" id="6501477">.</span><span class="ident" id="6501478">CommonName</span><span class="op" id="6501488">,</span>&nbsp;<span class="ident" id="6501490">commonName</span><span class="op" id="6501500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6501504">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6501509">if</span>&nbsp;<span class="ident" id="6501512">cert</span><span class="op" id="6501516">.</span><span class="ident" id="6501517">SignatureAlgorithm</span>&nbsp;<span class="op" id="6501536">!=</span>&nbsp;<span class="ident" id="6501539">test</span><span class="op" id="6501543">.</span><span class="ident" id="6501544">sigAlgo</span>&nbsp;<span class="op" id="6501552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6501557">t</span><span class="op" id="6501558">.</span><span class="ident" id="6501559">Errorf</span><span class="op" id="6501565">(</span><span class="string" id="6501566">&#34;%s:&nbsp;SignatureAlgorithm&nbsp;wasn&#39;t&nbsp;copied&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6501635">,</span>&nbsp;<span class="ident" id="6501637">test</span><span class="op" id="6501641">.</span><span class="ident" id="6501642">name</span><span class="op" id="6501646">,</span>&nbsp;<span class="ident" id="6501648">cert</span><span class="op" id="6501652">.</span><span class="ident" id="6501653">SignatureAlgorithm</span><span class="op" id="6501671">,</span>&nbsp;<span class="ident" id="6501673">test</span><span class="op" id="6501677">.</span><span class="ident" id="6501678">sigAlgo</span><span class="op" id="6501685">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6501689">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6501694">if</span>&nbsp;<span class="op" id="6501697">!</span><span class="ident" id="6501698">reflect</span><span class="op" id="6501705">.</span><span class="ident" id="6501706">DeepEqual</span><span class="op" id="6501715">(</span><span class="ident" id="6501716">cert</span><span class="op" id="6501720">.</span><span class="ident" id="6501721">ExtKeyUsage</span><span class="op" id="6501732">,</span>&nbsp;<span class="ident" id="6501734">testExtKeyUsage</span><span class="op" id="6501749">)</span>&nbsp;<span class="op" id="6501751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6501756">t</span><span class="op" id="6501757">.</span><span class="ident" id="6501758">Errorf</span><span class="op" id="6501764">(</span><span class="string" id="6501765">&#34;%s:&nbsp;extkeyusage&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6501841">,</span>&nbsp;<span class="ident" id="6501843">test</span><span class="op" id="6501847">.</span><span class="ident" id="6501848">name</span><span class="op" id="6501852">,</span>&nbsp;<span class="ident" id="6501854">cert</span><span class="op" id="6501858">.</span><span class="ident" id="6501859">ExtKeyUsage</span><span class="op" id="6501870">,</span>&nbsp;<span class="ident" id="6501872">testExtKeyUsage</span><span class="op" id="6501887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6501891">}</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6501896">if</span>&nbsp;<span class="op" id="6501899">!</span><span class="ident" id="6501900">reflect</span><span class="op" id="6501907">.</span><span class="ident" id="6501908">DeepEqual</span><span class="op" id="6501917">(</span><span class="ident" id="6501918">cert</span><span class="op" id="6501922">.</span><span class="ident" id="6501923">UnknownExtKeyUsage</span><span class="op" id="6501941">,</span>&nbsp;<span class="ident" id="6501943">testUnknownExtKeyUsage</span><span class="op" id="6501965">)</span>&nbsp;<span class="op" id="6501967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6501972">t</span><span class="op" id="6501973">.</span><span class="ident" id="6501974">Errorf</span><span class="op" id="6501980">(</span><span class="string" id="6501981">&#34;%s:&nbsp;unknown&nbsp;extkeyusage&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6502065">,</span>&nbsp;<span class="ident" id="6502067">test</span><span class="op" id="6502071">.</span><span class="ident" id="6502072">name</span><span class="op" id="6502076">,</span>&nbsp;<span class="ident" id="6502078">cert</span><span class="op" id="6502082">.</span><span class="ident" id="6502083">UnknownExtKeyUsage</span><span class="op" id="6502101">,</span>&nbsp;<span class="ident" id="6502103">testUnknownExtKeyUsage</span><span class="op" id="6502125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6502129">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6502134">if</span>&nbsp;<span class="op" id="6502137">!</span><span class="ident" id="6502138">reflect</span><span class="op" id="6502145">.</span><span class="ident" id="6502146">DeepEqual</span><span class="op" id="6502155">(</span><span class="ident" id="6502156">cert</span><span class="op" id="6502160">.</span><span class="ident" id="6502161">OCSPServer</span><span class="op" id="6502171">,</span>&nbsp;<span class="ident" id="6502173">template</span><span class="op" id="6502181">.</span><span class="ident" id="6502182">OCSPServer</span><span class="op" id="6502192">)</span>&nbsp;<span class="op" id="6502194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6502199">t</span><span class="op" id="6502200">.</span><span class="ident" id="6502201">Errorf</span><span class="op" id="6502207">(</span><span class="string" id="6502208">&#34;%s:&nbsp;OCSP&nbsp;servers&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6502264">,</span>&nbsp;<span class="ident" id="6502266">test</span><span class="op" id="6502270">.</span><span class="ident" id="6502271">name</span><span class="op" id="6502275">,</span>&nbsp;<span class="ident" id="6502277">cert</span><span class="op" id="6502281">.</span><span class="ident" id="6502282">OCSPServer</span><span class="op" id="6502292">,</span>&nbsp;<span class="ident" id="6502294">template</span><span class="op" id="6502302">.</span><span class="ident" id="6502303">OCSPServer</span><span class="op" id="6502313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6502317">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6502322">if</span>&nbsp;<span class="op" id="6502325">!</span><span class="ident" id="6502326">reflect</span><span class="op" id="6502333">.</span><span class="ident" id="6502334">DeepEqual</span><span class="op" id="6502343">(</span><span class="ident" id="6502344">cert</span><span class="op" id="6502348">.</span><span class="ident" id="6502349">IssuingCertificateURL</span><span class="op" id="6502370">,</span>&nbsp;<span class="ident" id="6502372">template</span><span class="op" id="6502380">.</span><span class="ident" id="6502381">IssuingCertificateURL</span><span class="op" id="6502402">)</span>&nbsp;<span class="op" id="6502404">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6502409">t</span><span class="op" id="6502410">.</span><span class="ident" id="6502411">Errorf</span><span class="op" id="6502417">(</span><span class="string" id="6502418">&#34;%s:&nbsp;Issuing&nbsp;certificate&nbsp;URLs&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6502486">,</span>&nbsp;<span class="ident" id="6502488">test</span><span class="op" id="6502492">.</span><span class="ident" id="6502493">name</span><span class="op" id="6502497">,</span>&nbsp;<span class="ident" id="6502499">cert</span><span class="op" id="6502503">.</span><span class="ident" id="6502504">IssuingCertificateURL</span><span class="op" id="6502525">,</span>&nbsp;<span class="ident" id="6502527">template</span><span class="op" id="6502535">.</span><span class="ident" id="6502536">IssuingCertificateURL</span><span class="op" id="6502557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6502561">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6502566">if</span>&nbsp;<span class="op" id="6502569">!</span><span class="ident" id="6502570">reflect</span><span class="op" id="6502577">.</span><span class="ident" id="6502578">DeepEqual</span><span class="op" id="6502587">(</span><span class="ident" id="6502588">cert</span><span class="op" id="6502592">.</span><span class="ident" id="6502593">DNSNames</span><span class="op" id="6502601">,</span>&nbsp;<span class="ident" id="6502603">template</span><span class="op" id="6502611">.</span><span class="ident" id="6502612">DNSNames</span><span class="op" id="6502620">)</span>&nbsp;<span class="op" id="6502622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6502627">t</span><span class="op" id="6502628">.</span><span class="ident" id="6502629">Errorf</span><span class="op" id="6502635">(</span><span class="string" id="6502636">&#34;%s:&nbsp;SAN&nbsp;DNS&nbsp;names&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6502693">,</span>&nbsp;<span class="ident" id="6502695">test</span><span class="op" id="6502699">.</span><span class="ident" id="6502700">name</span><span class="op" id="6502704">,</span>&nbsp;<span class="ident" id="6502706">cert</span><span class="op" id="6502710">.</span><span class="ident" id="6502711">DNSNames</span><span class="op" id="6502719">,</span>&nbsp;<span class="ident" id="6502721">template</span><span class="op" id="6502729">.</span><span class="ident" id="6502730">DNSNames</span><span class="op" id="6502738">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6502742">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6502747">if</span>&nbsp;<span class="op" id="6502750">!</span><span class="ident" id="6502751">reflect</span><span class="op" id="6502758">.</span><span class="ident" id="6502759">DeepEqual</span><span class="op" id="6502768">(</span><span class="ident" id="6502769">cert</span><span class="op" id="6502773">.</span><span class="ident" id="6502774">EmailAddresses</span><span class="op" id="6502788">,</span>&nbsp;<span class="ident" id="6502790">template</span><span class="op" id="6502798">.</span><span class="ident" id="6502799">EmailAddresses</span><span class="op" id="6502813">)</span>&nbsp;<span class="op" id="6502815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6502820">t</span><span class="op" id="6502821">.</span><span class="ident" id="6502822">Errorf</span><span class="op" id="6502828">(</span><span class="string" id="6502829">&#34;%s:&nbsp;SAN&nbsp;emails&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6502883">,</span>&nbsp;<span class="ident" id="6502885">test</span><span class="op" id="6502889">.</span><span class="ident" id="6502890">name</span><span class="op" id="6502894">,</span>&nbsp;<span class="ident" id="6502896">cert</span><span class="op" id="6502900">.</span><span class="ident" id="6502901">EmailAddresses</span><span class="op" id="6502915">,</span>&nbsp;<span class="ident" id="6502917">template</span><span class="op" id="6502925">.</span><span class="ident" id="6502926">EmailAddresses</span><span class="op" id="6502940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6502944">}</span><br>
<span class="lineno">425</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6502949">if</span>&nbsp;<span class="op" id="6502952">!</span><span class="ident" id="6502953">reflect</span><span class="op" id="6502960">.</span><span class="ident" id="6502961">DeepEqual</span><span class="op" id="6502970">(</span><span class="ident" id="6502971">cert</span><span class="op" id="6502975">.</span><span class="ident" id="6502976">IPAddresses</span><span class="op" id="6502987">,</span>&nbsp;<span class="ident" id="6502989">template</span><span class="op" id="6502997">.</span><span class="ident" id="6502998">IPAddresses</span><span class="op" id="6503009">)</span>&nbsp;<span class="op" id="6503011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6503016">t</span><span class="op" id="6503017">.</span><span class="ident" id="6503018">Errorf</span><span class="op" id="6503024">(</span><span class="string" id="6503025">&#34;%s:&nbsp;SAN&nbsp;IPs&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6503076">,</span>&nbsp;<span class="ident" id="6503078">test</span><span class="op" id="6503082">.</span><span class="ident" id="6503083">name</span><span class="op" id="6503087">,</span>&nbsp;<span class="ident" id="6503089">cert</span><span class="op" id="6503093">.</span><span class="ident" id="6503094">IPAddresses</span><span class="op" id="6503105">,</span>&nbsp;<span class="ident" id="6503107">template</span><span class="op" id="6503115">.</span><span class="ident" id="6503116">IPAddresses</span><span class="op" id="6503127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6503131">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6503136">if</span>&nbsp;<span class="op" id="6503139">!</span><span class="ident" id="6503140">reflect</span><span class="op" id="6503147">.</span><span class="ident" id="6503148">DeepEqual</span><span class="op" id="6503157">(</span><span class="ident" id="6503158">cert</span><span class="op" id="6503162">.</span><span class="ident" id="6503163">CRLDistributionPoints</span><span class="op" id="6503184">,</span>&nbsp;<span class="ident" id="6503186">template</span><span class="op" id="6503194">.</span><span class="ident" id="6503195">CRLDistributionPoints</span><span class="op" id="6503216">)</span>&nbsp;<span class="op" id="6503218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6503223">t</span><span class="op" id="6503224">.</span><span class="ident" id="6503225">Errorf</span><span class="op" id="6503231">(</span><span class="string" id="6503232">&#34;%s:&nbsp;CRL&nbsp;distribution&nbsp;points&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6503299">,</span>&nbsp;<span class="ident" id="6503301">test</span><span class="op" id="6503305">.</span><span class="ident" id="6503306">name</span><span class="op" id="6503310">,</span>&nbsp;<span class="ident" id="6503312">cert</span><span class="op" id="6503316">.</span><span class="ident" id="6503317">CRLDistributionPoints</span><span class="op" id="6503338">,</span>&nbsp;<span class="ident" id="6503340">template</span><span class="op" id="6503348">.</span><span class="ident" id="6503349">CRLDistributionPoints</span><span class="op" id="6503370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6503374">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6503379">if</span>&nbsp;<span class="op" id="6503382">!</span><span class="ident" id="6503383">bytes</span><span class="op" id="6503388">.</span><span class="ident" id="6503389">Equal</span><span class="op" id="6503394">(</span><span class="ident" id="6503395">cert</span><span class="op" id="6503399">.</span><span class="ident" id="6503400">SubjectKeyId</span><span class="op" id="6503412">,</span>&nbsp;<span class="op" id="6503414">[</span><span class="op" id="6503415">]</span><span class="builtintype" id="6503416">byte</span><span class="op" id="6503420">{</span><span class="num" id="6503421">4</span><span class="op" id="6503422">,</span>&nbsp;<span class="num" id="6503424">3</span><span class="op" id="6503425">,</span>&nbsp;<span class="num" id="6503427">2</span><span class="op" id="6503428">,</span>&nbsp;<span class="num" id="6503430">1</span><span class="op" id="6503431">}</span><span class="op" id="6503432">)</span>&nbsp;<span class="op" id="6503434">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6503439">t</span><span class="op" id="6503440">.</span><span class="ident" id="6503441">Errorf</span><span class="op" id="6503447">(</span><span class="string" id="6503448">&#34;%s:&nbsp;ExtraExtensions&nbsp;didn&#39;t&nbsp;override&nbsp;SubjectKeyId&#34;</span><span class="op" id="6503498">,</span>&nbsp;<span class="ident" id="6503500">test</span><span class="op" id="6503504">.</span><span class="ident" id="6503505">name</span><span class="op" id="6503509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6503513">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6503518">if</span>&nbsp;<span class="ident" id="6503521">bytes</span><span class="op" id="6503526">.</span><span class="ident" id="6503527">Index</span><span class="op" id="6503532">(</span><span class="ident" id="6503533">derBytes</span><span class="op" id="6503541">,</span>&nbsp;<span class="ident" id="6503543">extraExtensionData</span><span class="op" id="6503561">)</span>&nbsp;<span class="op" id="6503563">==</span>&nbsp;<span class="op" id="6503566">-</span><span class="num" id="6503567">1</span>&nbsp;<span class="op" id="6503569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6503574">t</span><span class="op" id="6503575">.</span><span class="ident" id="6503576">Errorf</span><span class="op" id="6503582">(</span><span class="string" id="6503583">&#34;%s:&nbsp;didn&#39;t&nbsp;find&nbsp;extra&nbsp;extension&nbsp;in&nbsp;DER&nbsp;output&#34;</span><span class="op" id="6503630">,</span>&nbsp;<span class="ident" id="6503632">test</span><span class="op" id="6503636">.</span><span class="ident" id="6503637">name</span><span class="op" id="6503641">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6503645">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6503650">if</span>&nbsp;<span class="ident" id="6503653">test</span><span class="op" id="6503657">.</span><span class="ident" id="6503658">checkSig</span>&nbsp;<span class="op" id="6503667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6503672">err</span>&nbsp;<span class="op" id="6503676">=</span>&nbsp;<span class="ident" id="6503678">cert</span><span class="op" id="6503682">.</span><span class="ident" id="6503683">CheckSignatureFrom</span><span class="op" id="6503701">(</span><span class="ident" id="6503702">cert</span><span class="op" id="6503706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6503711">if</span>&nbsp;<span class="ident" id="6503714">err</span>&nbsp;<span class="op" id="6503718">!=</span>&nbsp;<span class="builtintype" id="6503721">nil</span>&nbsp;<span class="op" id="6503725">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6503731">t</span><span class="op" id="6503732">.</span><span class="ident" id="6503733">Errorf</span><span class="op" id="6503739">(</span><span class="string" id="6503740">&#34;%s:&nbsp;signature&nbsp;verification&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="6503779">,</span>&nbsp;<span class="ident" id="6503781">test</span><span class="op" id="6503785">.</span><span class="ident" id="6503786">name</span><span class="op" id="6503790">,</span>&nbsp;<span class="ident" id="6503792">err</span><span class="op" id="6503795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6503800">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6503804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6503807">}</span><br>
<span class="lineno"></span><span class="op" id="6503809">}</span><br>
<span class="lineno">450</span><br>
<span class="lineno"></span><span class="comment" id="6503812">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA1&nbsp;&amp;&nbsp;secp256r1</span><br>
<span class="lineno"></span><span class="keyword" id="6503873">var</span>&nbsp;<span class="ident" id="6503877">ecdsaSHA1CertPem</span>&nbsp;<span class="op" id="6503894">=</span>&nbsp;<span class="string" id="6503896">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIICDjCCAbUCCQDF6SfN0nsnrjAJBgcqhkjOPQQBMIGPMQswCQYDVQQGEwJVUzET<br>
<span class="lineno">455</span>MBEGA1UECAwKQ2FsaWZvcm5pYTEWMBQGA1UEBwwNTW91bnRhaW4gVmlldzEVMBMG<br>
<span class="lineno"></span>A1UECgwMR29vZ2xlLCBJbmMuMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEG<br>
<span class="lineno"></span>CSqGSIb3DQEJARYUZ29sYW5nLWRldkBnbWFpbC5jb20wHhcNMTIwNTIwMjAyMDUw<br>
<span class="lineno"></span>WhcNMjIwNTE4MjAyMDUwWjCBjzELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlm<br>
<span class="lineno"></span>b3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFTATBgNVBAoMDEdvb2dsZSwg<br>
<span class="lineno">460</span>SW5jLjEXMBUGA1UEAwwOd3d3Lmdvb2dsZS5jb20xIzAhBgkqhkiG9w0BCQEWFGdv<br>
<span class="lineno"></span>bGFuZy1kZXZAZ21haWwuY29tMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE/Wgn<br>
<span class="lineno"></span>WQDo5+bz71T0327ERgd5SDDXFbXLpzIZDXTkjpe8QTEbsF+ezsQfrekrpDPC4Cd3<br>
<span class="lineno"></span>P9LY0tG+aI8IyVKdUjAJBgcqhkjOPQQBA0gAMEUCIGlsqMcRqWVIWTD6wXwe6Jk2<br>
<span class="lineno"></span>DKxL46r/FLgJYnzBEH99AiEA3fBouObsvV1R3oVkb4BQYnD4/4LeId6lAT43YvyV<br>
<span class="lineno">465</span>a/A=<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6504675">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA256&nbsp;&amp;&nbsp;secp256r1</span><br>
<span class="lineno">470</span><span class="keyword" id="6504738">var</span>&nbsp;<span class="ident" id="6504742">ecdsaSHA256p256CertPem</span>&nbsp;<span class="op" id="6504765">=</span>&nbsp;<span class="string" id="6504767">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIICDzCCAbYCCQDlsuMWvgQzhTAKBggqhkjOPQQDAjCBjzELMAkGA1UEBhMCVVMx<br>
<span class="lineno"></span>EzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFTAT<br>
<span class="lineno"></span>BgNVBAoMDEdvb2dsZSwgSW5jLjEXMBUGA1UEAwwOd3d3Lmdvb2dsZS5jb20xIzAh<br>
<span class="lineno">475</span>BgkqhkiG9w0BCQEWFGdvbGFuZy1kZXZAZ21haWwuY29tMB4XDTEyMDUyMTAwMTkx<br>
<span class="lineno"></span>NloXDTIyMDUxOTAwMTkxNlowgY8xCzAJBgNVBAYTAlVTMRMwEQYDVQQIDApDYWxp<br>
<span class="lineno"></span>Zm9ybmlhMRYwFAYDVQQHDA1Nb3VudGFpbiBWaWV3MRUwEwYDVQQKDAxHb29nbGUs<br>
<span class="lineno"></span>IEluYy4xFzAVBgNVBAMMDnd3dy5nb29nbGUuY29tMSMwIQYJKoZIhvcNAQkBFhRn<br>
<span class="lineno"></span>b2xhbmctZGV2QGdtYWlsLmNvbTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABPMt<br>
<span class="lineno">480</span>2ErhxAty5EJRu9yM+MTy+hUXm3pdW1ensAv382KoGExSXAFWP7pjJnNtHO+XSwVm<br>
<span class="lineno"></span>YNtqjcAGFKpweoN//kQwCgYIKoZIzj0EAwIDRwAwRAIgIYSaUA/IB81gjbIw/hUV<br>
<span class="lineno"></span>70twxJr5EcgOo0hLp3Jm+EYCIFDO3NNcgmURbJ1kfoS3N/0O+irUtoPw38YoNkqJ<br>
<span class="lineno"></span>h5wi<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno">485</span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6505546">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA256&nbsp;&amp;&nbsp;secp384r1</span><br>
<span class="lineno"></span><span class="keyword" id="6505609">var</span>&nbsp;<span class="ident" id="6505613">ecdsaSHA256p384CertPem</span>&nbsp;<span class="op" id="6505636">=</span>&nbsp;<span class="string" id="6505638">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno">490</span>MIICSjCCAdECCQDje/no7mXkVzAKBggqhkjOPQQDAjCBjjELMAkGA1UEBhMCVVMx<br>
<span class="lineno"></span>EzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDAS<br>
<span class="lineno"></span>BgNVBAoMC0dvb2dsZSwgSW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEG<br>
<span class="lineno"></span>CSqGSIb3DQEJARYUZ29sYW5nLWRldkBnbWFpbC5jb20wHhcNMTIwNTIxMDYxMDM0<br>
<span class="lineno"></span>WhcNMjIwNTE5MDYxMDM0WjCBjjELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlm<br>
<span class="lineno">495</span>b3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDASBgNVBAoMC0dvb2dsZSwg<br>
<span class="lineno"></span>SW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEGCSqGSIb3DQEJARYUZ29s<br>
<span class="lineno"></span>YW5nLWRldkBnbWFpbC5jb20wdjAQBgcqhkjOPQIBBgUrgQQAIgNiAARRuzRNIKRK<br>
<span class="lineno"></span>jIktEmXanNmrTR/q/FaHXLhWRZ6nHWe26Fw7Rsrbk+VjGy4vfWtNn7xSFKrOu5ze<br>
<span class="lineno"></span>qxKnmE0h5E480MNgrUiRkaGO2GMJJVmxx20aqkXOk59U8yGA4CghE6MwCgYIKoZI<br>
<span class="lineno">500</span>zj0EAwIDZwAwZAIwBZEN8gvmRmfeP/9C1PRLzODIY4JqWub2PLRT4mv9GU+yw3Gr<br>
<span class="lineno"></span>PU9A3CHMdEcdw/MEAjBBO1lId8KOCh9UZunsSMfqXiVurpzmhWd6VYZ/32G+M+Mh<br>
<span class="lineno"></span>3yILeYQzllt/g0rKVRk=<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span><span class="comment" id="6506498">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA384&nbsp;&amp;&nbsp;secp521r1</span><br>
<span class="lineno"></span><span class="keyword" id="6506561">var</span>&nbsp;<span class="ident" id="6506565">ecdsaSHA384p521CertPem</span>&nbsp;<span class="op" id="6506588">=</span>&nbsp;<span class="string" id="6506590">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIICljCCAfcCCQDhp1AFD/ahKjAKBggqhkjOPQQDAzCBjjELMAkGA1UEBhMCVVMx<br>
<span class="lineno">510</span>EzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDAS<br>
<span class="lineno"></span>BgNVBAoMC0dvb2dsZSwgSW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEG<br>
<span class="lineno"></span>CSqGSIb3DQEJARYUZ29sYW5nLWRldkBnbWFpbC5jb20wHhcNMTIwNTIxMTUwNDI5<br>
<span class="lineno"></span>WhcNMjIwNTE5MTUwNDI5WjCBjjELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlm<br>
<span class="lineno"></span>b3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDASBgNVBAoMC0dvb2dsZSwg<br>
<span class="lineno">515</span>SW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEGCSqGSIb3DQEJARYUZ29s<br>
<span class="lineno"></span>YW5nLWRldkBnbWFpbC5jb20wgZswEAYHKoZIzj0CAQYFK4EEACMDgYYABACqx9Rv<br>
<span class="lineno"></span>IssRs1LWYcNN+WffwlHw4Tv3y8/LIAA9MF1ZScIonU9nRMxt4a2uGJVCPDw6JHpz<br>
<span class="lineno"></span>PaYc0E9puLoE9AfKpwFr59Jkot7dBg55SKPEFkddoip/rvmN7NPAWjMBirOwjOkm<br>
<span class="lineno"></span>8FPthvPhGPqsu9AvgVuHu3PosWiHGNrhh379pva8MzAKBggqhkjOPQQDAwOBjAAw<br>
<span class="lineno">520</span>gYgCQgEHNmswkUdPpHqrVxp9PvLVl+xxPuHBkT+75z9JizyxtqykHQo9Uh6SWCYH<br>
<span class="lineno"></span>BF9KLolo01wMt8DjoYP5Fb3j5MH7xwJCAbWZzTOp4l4DPkIvAh4LeC4VWbwPPyqh<br>
<span class="lineno"></span>kBg71w/iEcSY3wUKgHGcJJrObZw7wys91I5kENljqw/Samdr3ka+jBJa<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">525</span><br>
<span class="lineno"></span><span class="keyword" id="6507551">var</span>&nbsp;<span class="ident" id="6507555">ecdsaTests</span>&nbsp;<span class="op" id="6507566">=</span>&nbsp;<span class="op" id="6507568">[</span><span class="op" id="6507569">]</span><span class="keyword" id="6507570">struct</span>&nbsp;<span class="op" id="6507577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6507580">sigAlgo</span>&nbsp;<span class="ident" id="6507588">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6507608">pemCert</span>&nbsp;<span class="builtintype" id="6507616">string</span><br>
<span class="lineno"></span><span class="op" id="6507623">}</span><span class="op" id="6507624">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6507627">{</span><span class="ident" id="6507628">ECDSAWithSHA1</span><span class="op" id="6507641">,</span>&nbsp;<span class="ident" id="6507643">ecdsaSHA1CertPem</span><span class="op" id="6507659">}</span><span class="op" id="6507660">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6507663">{</span><span class="ident" id="6507664">ECDSAWithSHA256</span><span class="op" id="6507679">,</span>&nbsp;<span class="ident" id="6507681">ecdsaSHA256p256CertPem</span><span class="op" id="6507703">}</span><span class="op" id="6507704">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6507707">{</span><span class="ident" id="6507708">ECDSAWithSHA256</span><span class="op" id="6507723">,</span>&nbsp;<span class="ident" id="6507725">ecdsaSHA256p384CertPem</span><span class="op" id="6507747">}</span><span class="op" id="6507748">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6507751">{</span><span class="ident" id="6507752">ECDSAWithSHA384</span><span class="op" id="6507767">,</span>&nbsp;<span class="ident" id="6507769">ecdsaSHA384p521CertPem</span><span class="op" id="6507791">}</span><span class="op" id="6507792">,</span><br>
<span class="lineno"></span><span class="op" id="6507794">}</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span><span class="keyword" id="6507797">func</span>&nbsp;<span class="ident" id="6507802">TestECDSA</span><span class="op" id="6507811">(</span><span class="ident" id="6507812">t</span>&nbsp;<span class="op" id="6507814">*</span><span class="ident" id="6507815">testing</span><span class="op" id="6507822">.</span><span class="ident" id="6507823">T</span><span class="op" id="6507824">)</span>&nbsp;<span class="op" id="6507826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6507829">for</span>&nbsp;<span class="ident" id="6507833">i</span><span class="op" id="6507834">,</span>&nbsp;<span class="ident" id="6507836">test</span>&nbsp;<span class="op" id="6507841">:=</span>&nbsp;<span class="keyword" id="6507844">range</span>&nbsp;<span class="ident" id="6507850">ecdsaTests</span>&nbsp;<span class="op" id="6507861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6507865">pemBlock</span><span class="op" id="6507873">,</span>&nbsp;<span class="ident" id="6507875">_</span>&nbsp;<span class="op" id="6507877">:=</span>&nbsp;<span class="ident" id="6507880">pem</span><span class="op" id="6507883">.</span><span class="ident" id="6507884">Decode</span><span class="op" id="6507890">(</span><span class="op" id="6507891">[</span><span class="op" id="6507892">]</span><span class="builtintype" id="6507893">byte</span><span class="op" id="6507897">(</span><span class="ident" id="6507898">test</span><span class="op" id="6507902">.</span><span class="ident" id="6507903">pemCert</span><span class="op" id="6507910">)</span><span class="op" id="6507911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6507915">cert</span><span class="op" id="6507919">,</span>&nbsp;<span class="ident" id="6507921">err</span>&nbsp;<span class="op" id="6507925">:=</span>&nbsp;<span class="ident" id="6507928">ParseCertificate</span><span class="op" id="6507944">(</span><span class="ident" id="6507945">pemBlock</span><span class="op" id="6507953">.</span><span class="ident" id="6507954">Bytes</span><span class="op" id="6507959">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6507963">if</span>&nbsp;<span class="ident" id="6507966">err</span>&nbsp;<span class="op" id="6507970">!=</span>&nbsp;<span class="builtintype" id="6507973">nil</span>&nbsp;<span class="op" id="6507977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6507982">t</span><span class="op" id="6507983">.</span><span class="ident" id="6507984">Errorf</span><span class="op" id="6507990">(</span><span class="string" id="6507991">&#34;%d:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="6508028">,</span>&nbsp;<span class="ident" id="6508030">i</span><span class="op" id="6508031">,</span>&nbsp;<span class="ident" id="6508033">err</span><span class="op" id="6508036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6508041">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6508052">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6508056">if</span>&nbsp;<span class="ident" id="6508059">sa</span>&nbsp;<span class="op" id="6508062">:=</span>&nbsp;<span class="ident" id="6508065">cert</span><span class="op" id="6508069">.</span><span class="ident" id="6508070">SignatureAlgorithm</span><span class="op" id="6508088">;</span>&nbsp;<span class="ident" id="6508090">sa</span>&nbsp;<span class="op" id="6508093">!=</span>&nbsp;<span class="ident" id="6508096">test</span><span class="op" id="6508100">.</span><span class="ident" id="6508101">sigAlgo</span>&nbsp;<span class="op" id="6508109">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6508114">t</span><span class="op" id="6508115">.</span><span class="ident" id="6508116">Errorf</span><span class="op" id="6508122">(</span><span class="string" id="6508123">&#34;%d:&nbsp;signature&nbsp;algorithm&nbsp;is&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6508163">,</span>&nbsp;<span class="ident" id="6508165">i</span><span class="op" id="6508166">,</span>&nbsp;<span class="ident" id="6508168">sa</span><span class="op" id="6508170">,</span>&nbsp;<span class="ident" id="6508172">test</span><span class="op" id="6508176">.</span><span class="ident" id="6508177">sigAlgo</span><span class="op" id="6508184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6508188">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6508192">if</span>&nbsp;<span class="ident" id="6508195">parsedKey</span><span class="op" id="6508204">,</span>&nbsp;<span class="ident" id="6508206">ok</span>&nbsp;<span class="op" id="6508209">:=</span>&nbsp;<span class="ident" id="6508212">cert</span><span class="op" id="6508216">.</span><span class="ident" id="6508217">PublicKey</span><span class="op" id="6508226">.</span><span class="op" id="6508227">(</span><span class="op" id="6508228">*</span><span class="ident" id="6508229">ecdsa</span><span class="op" id="6508234">.</span><span class="ident" id="6508235">PublicKey</span><span class="op" id="6508244">)</span><span class="op" id="6508245">;</span>&nbsp;<span class="op" id="6508247">!</span><span class="ident" id="6508248">ok</span>&nbsp;<span class="op" id="6508251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6508256">t</span><span class="op" id="6508257">.</span><span class="ident" id="6508258">Errorf</span><span class="op" id="6508264">(</span><span class="string" id="6508265">&#34;%d:&nbsp;wanted&nbsp;an&nbsp;ECDSA&nbsp;public&nbsp;key&nbsp;but&nbsp;found:&nbsp;%#v&#34;</span><span class="op" id="6508312">,</span>&nbsp;<span class="ident" id="6508314">i</span><span class="op" id="6508315">,</span>&nbsp;<span class="ident" id="6508317">parsedKey</span><span class="op" id="6508326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6508330">}</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6508334">if</span>&nbsp;<span class="ident" id="6508337">pka</span>&nbsp;<span class="op" id="6508341">:=</span>&nbsp;<span class="ident" id="6508344">cert</span><span class="op" id="6508348">.</span><span class="ident" id="6508349">PublicKeyAlgorithm</span><span class="op" id="6508367">;</span>&nbsp;<span class="ident" id="6508369">pka</span>&nbsp;<span class="op" id="6508373">!=</span>&nbsp;<span class="ident" id="6508376">ECDSA</span>&nbsp;<span class="op" id="6508382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6508387">t</span><span class="op" id="6508388">.</span><span class="ident" id="6508389">Errorf</span><span class="op" id="6508395">(</span><span class="string" id="6508396">&#34;%d:&nbsp;public&nbsp;key&nbsp;algorithm&nbsp;is&nbsp;%v,&nbsp;want&nbsp;ECDSA&#34;</span><span class="op" id="6508440">,</span>&nbsp;<span class="ident" id="6508442">i</span><span class="op" id="6508443">,</span>&nbsp;<span class="ident" id="6508445">pka</span><span class="op" id="6508448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6508452">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6508456">if</span>&nbsp;<span class="ident" id="6508459">err</span>&nbsp;<span class="op" id="6508463">=</span>&nbsp;<span class="ident" id="6508465">cert</span><span class="op" id="6508469">.</span><span class="ident" id="6508470">CheckSignatureFrom</span><span class="op" id="6508488">(</span><span class="ident" id="6508489">cert</span><span class="op" id="6508493">)</span><span class="op" id="6508494">;</span>&nbsp;<span class="ident" id="6508496">err</span>&nbsp;<span class="op" id="6508500">!=</span>&nbsp;<span class="builtintype" id="6508503">nil</span>&nbsp;<span class="op" id="6508507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6508512">t</span><span class="op" id="6508513">.</span><span class="ident" id="6508514">Errorf</span><span class="op" id="6508520">(</span><span class="string" id="6508521">&#34;%d:&nbsp;certificate&nbsp;verification&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="6508562">,</span>&nbsp;<span class="ident" id="6508564">i</span><span class="op" id="6508565">,</span>&nbsp;<span class="ident" id="6508567">err</span><span class="op" id="6508570">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6508574">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6508577">}</span><br>
<span class="lineno"></span><span class="op" id="6508579">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6508582">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;DSA&nbsp;with&nbsp;SHA1</span><br>
<span class="lineno">560</span><span class="keyword" id="6508629">var</span>&nbsp;<span class="ident" id="6508633">dsaCertPem</span>&nbsp;<span class="op" id="6508644">=</span>&nbsp;<span class="string" id="6508646">`-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIIEDTCCA82gAwIBAgIJALHPghaoxeDhMAkGByqGSM44BAMweTELMAkGA1UEBhMC<br>
<span class="lineno"></span>VVMxCzAJBgNVBAgTAk5DMQ8wDQYDVQQHEwZOZXd0b24xFDASBgNVBAoTC0dvb2ds<br>
<span class="lineno"></span>ZSwgSW5jMRIwEAYDVQQDEwlKb24gQWxsaWUxIjAgBgkqhkiG9w0BCQEWE2pvbmFs<br>
<span class="lineno"></span>bGllQGdvb2dsZS5jb20wHhcNMTEwNTE0MDMwMTQ1WhcNMTEwNjEzMDMwMTQ1WjB5<br>
<span class="lineno">565</span>MQswCQYDVQQGEwJVUzELMAkGA1UECBMCTkMxDzANBgNVBAcTBk5ld3RvbjEUMBIG<br>
<span class="lineno"></span>A1UEChMLR29vZ2xlLCBJbmMxEjAQBgNVBAMTCUpvbiBBbGxpZTEiMCAGCSqGSIb3<br>
<span class="lineno"></span>DQEJARYTam9uYWxsaWVAZ29vZ2xlLmNvbTCCAbcwggEsBgcqhkjOOAQBMIIBHwKB<br>
<span class="lineno"></span>gQC8hLUnQ7FpFYu4WXTj6DKvXvz8QrJkNJCVMTpKAT7uBpobk32S5RrPKXocd4gN<br>
<span class="lineno"></span>8lyGB9ggS03EVlEwXvSmO0DH2MQtke2jl9j1HLydClMf4sbx5V6TV9IFw505U1iW<br>
<span class="lineno">570</span>jL7awRMgxge+FsudtJK254FjMFo03ZnOQ8ZJJ9E6AEDrlwIVAJpnBn9moyP11Ox5<br>
<span class="lineno"></span>Asc/5dnjb6dPAoGBAJFHd4KVv1iTVCvEG6gGiYop5DJh28hUQcN9kul+2A0yPUSC<br>
<span class="lineno"></span>X93oN00P8Vh3eYgSaCWZsha7zDG53MrVJ0Zf6v/X/CoZNhLldeNOepivTRAzn+Rz<br>
<span class="lineno"></span>kKUYy5l1sxYLHQKF0UGNCXfFKZT0PCmgU+PWhYNBBMn6/cIh44vp85ideo5CA4GE<br>
<span class="lineno"></span>AAKBgFmifCafzeRaohYKXJgMGSEaggCVCRq5xdyDCat+wbOkjC4mfG01/um3G8u5<br>
<span class="lineno">575</span>LxasjlWRKTR/tcAL7t0QuokVyQaYdVypZXNaMtx1db7YBuHjj3aP+8JOQRI9xz8c<br>
<span class="lineno"></span>bp5NDJ5pISiFOv4p3GZfqZPcqckDt78AtkQrmnal2txhhjF6o4HeMIHbMB0GA1Ud<br>
<span class="lineno"></span>DgQWBBQVyyr7hO11ZFFpWX50298Sa3V+rzCBqwYDVR0jBIGjMIGggBQVyyr7hO11<br>
<span class="lineno"></span>ZFFpWX50298Sa3V+r6F9pHsweTELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAk5DMQ8w<br>
<span class="lineno"></span>DQYDVQQHEwZOZXd0b24xFDASBgNVBAoTC0dvb2dsZSwgSW5jMRIwEAYDVQQDEwlK<br>
<span class="lineno">580</span>b24gQWxsaWUxIjAgBgkqhkiG9w0BCQEWE2pvbmFsbGllQGdvb2dsZS5jb22CCQCx<br>
<span class="lineno"></span>z4IWqMXg4TAMBgNVHRMEBTADAQH/MAkGByqGSM44BAMDLwAwLAIUPtn/5j8Q1jJI<br>
<span class="lineno"></span>7ggOIsgrhgUdjGQCFCsmDq1H11q9+9Wp9IMeGrTSKHIM<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">585</span><br>
<span class="lineno"></span><span class="keyword" id="6510114">func</span>&nbsp;<span class="ident" id="6510119">TestParseCertificateWithDsaPublicKey</span><span class="op" id="6510155">(</span><span class="ident" id="6510156">t</span>&nbsp;<span class="op" id="6510158">*</span><span class="ident" id="6510159">testing</span><span class="op" id="6510166">.</span><span class="ident" id="6510167">T</span><span class="op" id="6510168">)</span>&nbsp;<span class="op" id="6510170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6510173">expectedKey</span>&nbsp;<span class="op" id="6510185">:=</span>&nbsp;<span class="op" id="6510188">&amp;</span><span class="ident" id="6510189">dsa</span><span class="op" id="6510192">.</span><span class="ident" id="6510193">PublicKey</span><span class="op" id="6510202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6510206">Parameters</span><span class="op" id="6510216">:</span>&nbsp;<span class="ident" id="6510218">dsa</span><span class="op" id="6510221">.</span><span class="ident" id="6510222">Parameters</span><span class="op" id="6510232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6510237">P</span><span class="op" id="6510238">:</span>&nbsp;<span class="ident" id="6510240">bigFromHexString</span><span class="op" id="6510256">(</span><span class="string" id="6510257">&#34;00BC84B52743B169158BB85974E3E832AF5EFCFC42B264349095313A4A013EEE069A1B937D92E51ACF297A1C77880DF25C8607D8204B4DC45651305EF4A63B40C7D8C42D91EDA397D8F51CBC9D0A531FE2C6F1E55E9357D205C39D395358968CBEDAC11320C607BE16CB9DB492B6E78163305A34DD99CE43C64927D13A0040EB97&#34;</span><span class="op" id="6510517">)</span><span class="op" id="6510518">,</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6510523">Q</span><span class="op" id="6510524">:</span>&nbsp;<span class="ident" id="6510526">bigFromHexString</span><span class="op" id="6510542">(</span><span class="string" id="6510543">&#34;009A67067F66A323F5D4EC7902C73FE5D9E36FA74F&#34;</span><span class="op" id="6510587">)</span><span class="op" id="6510588">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6510593">G</span><span class="op" id="6510594">:</span>&nbsp;<span class="ident" id="6510596">bigFromHexString</span><span class="op" id="6510612">(</span><span class="string" id="6510613">&#34;009147778295BF5893542BC41BA806898A29E43261DBC85441C37D92E97ED80D323D44825FDDE8374D0FF15877798812682599B216BBCC31B9DCCAD527465FEAFFD7FC2A193612E575E34E7A98AF4D10339FE47390A518CB9975B3160B1D0285D1418D0977C52994F43C29A053E3D685834104C9FAFDC221E38BE9F3989D7A8E42&#34;</span><span class="op" id="6510873">)</span><span class="op" id="6510874">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6510878">}</span><span class="op" id="6510879">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6510883">Y</span><span class="op" id="6510884">:</span>&nbsp;<span class="ident" id="6510886">bigFromHexString</span><span class="op" id="6510902">(</span><span class="string" id="6510903">&#34;59A27C269FCDE45AA2160A5C980C19211A820095091AB9C5DC8309AB7EC1B3A48C2E267C6D35FEE9B71BCBB92F16AC8E559129347FB5C00BEEDD10BA8915C90698755CA965735A32DC7575BED806E1E38F768FFBC24E41123DC73F1C6E9E4D0C9E692128853AFE29DC665FA993DCA9C903B7BF00B6442B9A76A5DADC6186317A&#34;</span><span class="op" id="6511161">)</span><span class="op" id="6511162">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6511165">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6511168">pemBlock</span><span class="op" id="6511176">,</span>&nbsp;<span class="ident" id="6511178">_</span>&nbsp;<span class="op" id="6511180">:=</span>&nbsp;<span class="ident" id="6511183">pem</span><span class="op" id="6511186">.</span><span class="ident" id="6511187">Decode</span><span class="op" id="6511193">(</span><span class="op" id="6511194">[</span><span class="op" id="6511195">]</span><span class="builtintype" id="6511196">byte</span><span class="op" id="6511200">(</span><span class="ident" id="6511201">dsaCertPem</span><span class="op" id="6511211">)</span><span class="op" id="6511212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6511215">cert</span><span class="op" id="6511219">,</span>&nbsp;<span class="ident" id="6511221">err</span>&nbsp;<span class="op" id="6511225">:=</span>&nbsp;<span class="ident" id="6511228">ParseCertificate</span><span class="op" id="6511244">(</span><span class="ident" id="6511245">pemBlock</span><span class="op" id="6511253">.</span><span class="ident" id="6511254">Bytes</span><span class="op" id="6511259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6511262">if</span>&nbsp;<span class="ident" id="6511265">err</span>&nbsp;<span class="op" id="6511269">!=</span>&nbsp;<span class="builtintype" id="6511272">nil</span>&nbsp;<span class="op" id="6511276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6511280">t</span><span class="op" id="6511281">.</span><span class="ident" id="6511282">Fatalf</span><span class="op" id="6511288">(</span><span class="string" id="6511289">&#34;Failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="6511322">,</span>&nbsp;<span class="ident" id="6511324">err</span><span class="op" id="6511327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6511330">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6511333">if</span>&nbsp;<span class="ident" id="6511336">cert</span><span class="op" id="6511340">.</span><span class="ident" id="6511341">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="6511360">!=</span>&nbsp;<span class="ident" id="6511363">DSA</span>&nbsp;<span class="op" id="6511367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6511371">t</span><span class="op" id="6511372">.</span><span class="ident" id="6511373">Errorf</span><span class="op" id="6511379">(</span><span class="string" id="6511380">&#34;Parsed&nbsp;key&nbsp;algorithm&nbsp;was&nbsp;not&nbsp;DSA&#34;</span><span class="op" id="6511414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6511417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6511420">parsedKey</span><span class="op" id="6511429">,</span>&nbsp;<span class="ident" id="6511431">ok</span>&nbsp;<span class="op" id="6511434">:=</span>&nbsp;<span class="ident" id="6511437">cert</span><span class="op" id="6511441">.</span><span class="ident" id="6511442">PublicKey</span><span class="op" id="6511451">.</span><span class="op" id="6511452">(</span><span class="op" id="6511453">*</span><span class="ident" id="6511454">dsa</span><span class="op" id="6511457">.</span><span class="ident" id="6511458">PublicKey</span><span class="op" id="6511467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6511470">if</span>&nbsp;<span class="op" id="6511473">!</span><span class="ident" id="6511474">ok</span>&nbsp;<span class="op" id="6511477">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6511481">t</span><span class="op" id="6511482">.</span><span class="ident" id="6511483">Fatalf</span><span class="op" id="6511489">(</span><span class="string" id="6511490">&#34;Parsed&nbsp;key&nbsp;was&nbsp;not&nbsp;a&nbsp;DSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="6511524">,</span>&nbsp;<span class="ident" id="6511526">err</span><span class="op" id="6511529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6511532">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6511535">if</span>&nbsp;<span class="ident" id="6511538">expectedKey</span><span class="op" id="6511549">.</span><span class="ident" id="6511550">Y</span><span class="op" id="6511551">.</span><span class="ident" id="6511552">Cmp</span><span class="op" id="6511555">(</span><span class="ident" id="6511556">parsedKey</span><span class="op" id="6511565">.</span><span class="ident" id="6511566">Y</span><span class="op" id="6511567">)</span>&nbsp;<span class="op" id="6511569">!=</span>&nbsp;<span class="num" id="6511572">0</span>&nbsp;<span class="op" id="6511574">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6511579">expectedKey</span><span class="op" id="6511590">.</span><span class="ident" id="6511591">P</span><span class="op" id="6511592">.</span><span class="ident" id="6511593">Cmp</span><span class="op" id="6511596">(</span><span class="ident" id="6511597">parsedKey</span><span class="op" id="6511606">.</span><span class="ident" id="6511607">P</span><span class="op" id="6511608">)</span>&nbsp;<span class="op" id="6511610">!=</span>&nbsp;<span class="num" id="6511613">0</span>&nbsp;<span class="op" id="6511615">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6511620">expectedKey</span><span class="op" id="6511631">.</span><span class="ident" id="6511632">Q</span><span class="op" id="6511633">.</span><span class="ident" id="6511634">Cmp</span><span class="op" id="6511637">(</span><span class="ident" id="6511638">parsedKey</span><span class="op" id="6511647">.</span><span class="ident" id="6511648">Q</span><span class="op" id="6511649">)</span>&nbsp;<span class="op" id="6511651">!=</span>&nbsp;<span class="num" id="6511654">0</span>&nbsp;<span class="op" id="6511656">||</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6511661">expectedKey</span><span class="op" id="6511672">.</span><span class="ident" id="6511673">G</span><span class="op" id="6511674">.</span><span class="ident" id="6511675">Cmp</span><span class="op" id="6511678">(</span><span class="ident" id="6511679">parsedKey</span><span class="op" id="6511688">.</span><span class="ident" id="6511689">G</span><span class="op" id="6511690">)</span>&nbsp;<span class="op" id="6511692">!=</span>&nbsp;<span class="num" id="6511695">0</span>&nbsp;<span class="op" id="6511697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6511701">t</span><span class="op" id="6511702">.</span><span class="ident" id="6511703">Fatal</span><span class="op" id="6511708">(</span><span class="string" id="6511709">&#34;Parsed&nbsp;key&nbsp;differs&nbsp;from&nbsp;expected&nbsp;key&#34;</span><span class="op" id="6511747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6511750">}</span><br>
<span class="lineno"></span><span class="op" id="6511752">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span><span class="keyword" id="6511755">func</span>&nbsp;<span class="ident" id="6511760">TestParseCertificateWithDSASignatureAlgorithm</span><span class="op" id="6511805">(</span><span class="ident" id="6511806">t</span>&nbsp;<span class="op" id="6511808">*</span><span class="ident" id="6511809">testing</span><span class="op" id="6511816">.</span><span class="ident" id="6511817">T</span><span class="op" id="6511818">)</span>&nbsp;<span class="op" id="6511820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6511823">pemBlock</span><span class="op" id="6511831">,</span>&nbsp;<span class="ident" id="6511833">_</span>&nbsp;<span class="op" id="6511835">:=</span>&nbsp;<span class="ident" id="6511838">pem</span><span class="op" id="6511841">.</span><span class="ident" id="6511842">Decode</span><span class="op" id="6511848">(</span><span class="op" id="6511849">[</span><span class="op" id="6511850">]</span><span class="builtintype" id="6511851">byte</span><span class="op" id="6511855">(</span><span class="ident" id="6511856">dsaCertPem</span><span class="op" id="6511866">)</span><span class="op" id="6511867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6511870">cert</span><span class="op" id="6511874">,</span>&nbsp;<span class="ident" id="6511876">err</span>&nbsp;<span class="op" id="6511880">:=</span>&nbsp;<span class="ident" id="6511883">ParseCertificate</span><span class="op" id="6511899">(</span><span class="ident" id="6511900">pemBlock</span><span class="op" id="6511908">.</span><span class="ident" id="6511909">Bytes</span><span class="op" id="6511914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6511917">if</span>&nbsp;<span class="ident" id="6511920">err</span>&nbsp;<span class="op" id="6511924">!=</span>&nbsp;<span class="builtintype" id="6511927">nil</span>&nbsp;<span class="op" id="6511931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6511935">t</span><span class="op" id="6511936">.</span><span class="ident" id="6511937">Fatalf</span><span class="op" id="6511943">(</span><span class="string" id="6511944">&#34;Failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="6511977">,</span>&nbsp;<span class="ident" id="6511979">err</span><span class="op" id="6511982">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6511985">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6511988">if</span>&nbsp;<span class="ident" id="6511991">cert</span><span class="op" id="6511995">.</span><span class="ident" id="6511996">SignatureAlgorithm</span>&nbsp;<span class="op" id="6512015">!=</span>&nbsp;<span class="ident" id="6512018">DSAWithSHA1</span>&nbsp;<span class="op" id="6512030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6512034">t</span><span class="op" id="6512035">.</span><span class="ident" id="6512036">Errorf</span><span class="op" id="6512042">(</span><span class="string" id="6512043">&#34;Parsed&nbsp;signature&nbsp;algorithm&nbsp;was&nbsp;not&nbsp;DSAWithSHA1&#34;</span><span class="op" id="6512091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6512094">}</span><br>
<span class="lineno"></span><span class="op" id="6512096">}</span><br>
<span class="lineno">625</span><br>
<span class="lineno"></span><span class="keyword" id="6512099">func</span>&nbsp;<span class="ident" id="6512104">TestVerifyCertificateWithDSASignature</span><span class="op" id="6512141">(</span><span class="ident" id="6512142">t</span>&nbsp;<span class="op" id="6512144">*</span><span class="ident" id="6512145">testing</span><span class="op" id="6512152">.</span><span class="ident" id="6512153">T</span><span class="op" id="6512154">)</span>&nbsp;<span class="op" id="6512156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6512159">pemBlock</span><span class="op" id="6512167">,</span>&nbsp;<span class="ident" id="6512169">_</span>&nbsp;<span class="op" id="6512171">:=</span>&nbsp;<span class="ident" id="6512174">pem</span><span class="op" id="6512177">.</span><span class="ident" id="6512178">Decode</span><span class="op" id="6512184">(</span><span class="op" id="6512185">[</span><span class="op" id="6512186">]</span><span class="builtintype" id="6512187">byte</span><span class="op" id="6512191">(</span><span class="ident" id="6512192">dsaCertPem</span><span class="op" id="6512202">)</span><span class="op" id="6512203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6512206">cert</span><span class="op" id="6512210">,</span>&nbsp;<span class="ident" id="6512212">err</span>&nbsp;<span class="op" id="6512216">:=</span>&nbsp;<span class="ident" id="6512219">ParseCertificate</span><span class="op" id="6512235">(</span><span class="ident" id="6512236">pemBlock</span><span class="op" id="6512244">.</span><span class="ident" id="6512245">Bytes</span><span class="op" id="6512250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6512253">if</span>&nbsp;<span class="ident" id="6512256">err</span>&nbsp;<span class="op" id="6512260">!=</span>&nbsp;<span class="builtintype" id="6512263">nil</span>&nbsp;<span class="op" id="6512267">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6512271">t</span><span class="op" id="6512272">.</span><span class="ident" id="6512273">Fatalf</span><span class="op" id="6512279">(</span><span class="string" id="6512280">&#34;Failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="6512313">,</span>&nbsp;<span class="ident" id="6512315">err</span><span class="op" id="6512318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6512321">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6512324">//&nbsp;test&nbsp;cert&nbsp;is&nbsp;self-signed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6512353">if</span>&nbsp;<span class="ident" id="6512356">err</span>&nbsp;<span class="op" id="6512360">=</span>&nbsp;<span class="ident" id="6512362">cert</span><span class="op" id="6512366">.</span><span class="ident" id="6512367">CheckSignatureFrom</span><span class="op" id="6512385">(</span><span class="ident" id="6512386">cert</span><span class="op" id="6512390">)</span><span class="op" id="6512391">;</span>&nbsp;<span class="ident" id="6512393">err</span>&nbsp;<span class="op" id="6512397">!=</span>&nbsp;<span class="builtintype" id="6512400">nil</span>&nbsp;<span class="op" id="6512404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6512408">t</span><span class="op" id="6512409">.</span><span class="ident" id="6512410">Fatalf</span><span class="op" id="6512416">(</span><span class="string" id="6512417">&#34;DSA&nbsp;Certificate&nbsp;verification&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="6512458">,</span>&nbsp;<span class="ident" id="6512460">err</span><span class="op" id="6512463">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6512466">}</span><br>
<span class="lineno"></span><span class="op" id="6512468">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6512471">const</span>&nbsp;<span class="ident" id="6512477">pemCertificate</span>&nbsp;<span class="op" id="6512492">=</span>&nbsp;<span class="string" id="6512494">`-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIIB5DCCAZCgAwIBAgIBATALBgkqhkiG9w0BAQUwLTEQMA4GA1UEChMHQWNtZSBDbzEZMBcGA1UE<br>
<span class="lineno">640</span>AxMQdGVzdC5leGFtcGxlLmNvbTAeFw03MDAxMDEwMDE2NDBaFw03MDAxMDIwMzQ2NDBaMC0xEDAO<br>
<span class="lineno"></span>BgNVBAoTB0FjbWUgQ28xGTAXBgNVBAMTEHRlc3QuZXhhbXBsZS5jb20wWjALBgkqhkiG9w0BAQED<br>
<span class="lineno"></span>SwAwSAJBALKZD0nEffqM1ACuak0bijtqE2QrI/KLADv7l3kK3ppMyCuLKoF0fd7Ai2KW5ToIwzFo<br>
<span class="lineno"></span>fvJcS/STa6HA5gQenRUCAwEAAaOBnjCBmzAOBgNVHQ8BAf8EBAMCAAQwDwYDVR0TAQH/BAUwAwEB<br>
<span class="lineno"></span>/zANBgNVHQ4EBgQEAQIDBDAPBgNVHSMECDAGgAQBAgMEMBsGA1UdEQQUMBKCEHRlc3QuZXhhbXBs<br>
<span class="lineno">645</span>ZS5jb20wDwYDVR0gBAgwBjAEBgIqAzAqBgNVHR4EIzAhoB8wDoIMLmV4YW1wbGUuY29tMA2CC2V4<br>
<span class="lineno"></span>YW1wbGUuY29tMAsGCSqGSIb3DQEBBQNBAHKZKoS1wEQOGhgklx4+/yFYQlnqwKXvar/ZecQvJwui<br>
<span class="lineno"></span>0seMQnwBhwdBkHfVIU2Fu5VUMRyxlf0ZNaDXcpU581k=<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----`</span><br>
<span class="lineno"></span><br>
<span class="lineno">650</span><span class="keyword" id="6513212">func</span>&nbsp;<span class="ident" id="6513217">TestCRLCreation</span><span class="op" id="6513232">(</span><span class="ident" id="6513233">t</span>&nbsp;<span class="op" id="6513235">*</span><span class="ident" id="6513236">testing</span><span class="op" id="6513243">.</span><span class="ident" id="6513244">T</span><span class="op" id="6513245">)</span>&nbsp;<span class="op" id="6513247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513250">block</span><span class="op" id="6513255">,</span>&nbsp;<span class="ident" id="6513257">_</span>&nbsp;<span class="op" id="6513259">:=</span>&nbsp;<span class="ident" id="6513262">pem</span><span class="op" id="6513265">.</span><span class="ident" id="6513266">Decode</span><span class="op" id="6513272">(</span><span class="op" id="6513273">[</span><span class="op" id="6513274">]</span><span class="builtintype" id="6513275">byte</span><span class="op" id="6513279">(</span><span class="ident" id="6513280">pemPrivateKey</span><span class="op" id="6513293">)</span><span class="op" id="6513294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513297">priv</span><span class="op" id="6513301">,</span>&nbsp;<span class="ident" id="6513303">_</span>&nbsp;<span class="op" id="6513305">:=</span>&nbsp;<span class="ident" id="6513308">ParsePKCS1PrivateKey</span><span class="op" id="6513328">(</span><span class="ident" id="6513329">block</span><span class="op" id="6513334">.</span><span class="ident" id="6513335">Bytes</span><span class="op" id="6513340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513343">block</span><span class="op" id="6513348">,</span>&nbsp;<span class="ident" id="6513350">_</span>&nbsp;<span class="op" id="6513352">=</span>&nbsp;<span class="ident" id="6513354">pem</span><span class="op" id="6513357">.</span><span class="ident" id="6513358">Decode</span><span class="op" id="6513364">(</span><span class="op" id="6513365">[</span><span class="op" id="6513366">]</span><span class="builtintype" id="6513367">byte</span><span class="op" id="6513371">(</span><span class="ident" id="6513372">pemCertificate</span><span class="op" id="6513386">)</span><span class="op" id="6513387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513390">cert</span><span class="op" id="6513394">,</span>&nbsp;<span class="ident" id="6513396">_</span>&nbsp;<span class="op" id="6513398">:=</span>&nbsp;<span class="ident" id="6513401">ParseCertificate</span><span class="op" id="6513417">(</span><span class="ident" id="6513418">block</span><span class="op" id="6513423">.</span><span class="ident" id="6513424">Bytes</span><span class="op" id="6513429">)</span><br>
<span class="lineno">655</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513433">now</span>&nbsp;<span class="op" id="6513437">:=</span>&nbsp;<span class="ident" id="6513440">time</span><span class="op" id="6513444">.</span><span class="ident" id="6513445">Unix</span><span class="op" id="6513449">(</span><span class="num" id="6513450">1000</span><span class="op" id="6513454">,</span>&nbsp;<span class="num" id="6513456">0</span><span class="op" id="6513457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513460">expiry</span>&nbsp;<span class="op" id="6513467">:=</span>&nbsp;<span class="ident" id="6513470">time</span><span class="op" id="6513474">.</span><span class="ident" id="6513475">Unix</span><span class="op" id="6513479">(</span><span class="num" id="6513480">10000</span><span class="op" id="6513485">,</span>&nbsp;<span class="num" id="6513487">0</span><span class="op" id="6513488">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513492">revokedCerts</span>&nbsp;<span class="op" id="6513505">:=</span>&nbsp;<span class="op" id="6513508">[</span><span class="op" id="6513509">]</span><span class="ident" id="6513510">pkix</span><span class="op" id="6513514">.</span><span class="ident" id="6513515">RevokedCertificate</span><span class="op" id="6513533">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6513537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513542">SerialNumber</span><span class="op" id="6513554">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6513558">big</span><span class="op" id="6513561">.</span><span class="ident" id="6513562">NewInt</span><span class="op" id="6513568">(</span><span class="num" id="6513569">1</span><span class="op" id="6513570">)</span><span class="op" id="6513571">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513576">RevocationTime</span><span class="op" id="6513590">:</span>&nbsp;<span class="ident" id="6513592">now</span><span class="op" id="6513595">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6513599">}</span><span class="op" id="6513600">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6513604">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513609">SerialNumber</span><span class="op" id="6513621">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6513625">big</span><span class="op" id="6513628">.</span><span class="ident" id="6513629">NewInt</span><span class="op" id="6513635">(</span><span class="num" id="6513636">42</span><span class="op" id="6513638">)</span><span class="op" id="6513639">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513644">RevocationTime</span><span class="op" id="6513658">:</span>&nbsp;<span class="ident" id="6513660">now</span><span class="op" id="6513663">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6513667">}</span><span class="op" id="6513668">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6513671">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513675">crlBytes</span><span class="op" id="6513683">,</span>&nbsp;<span class="ident" id="6513685">err</span>&nbsp;<span class="op" id="6513689">:=</span>&nbsp;<span class="ident" id="6513692">cert</span><span class="op" id="6513696">.</span><span class="ident" id="6513697">CreateCRL</span><span class="op" id="6513706">(</span><span class="ident" id="6513707">rand</span><span class="op" id="6513711">.</span><span class="ident" id="6513712">Reader</span><span class="op" id="6513718">,</span>&nbsp;<span class="ident" id="6513720">priv</span><span class="op" id="6513724">,</span>&nbsp;<span class="ident" id="6513726">revokedCerts</span><span class="op" id="6513738">,</span>&nbsp;<span class="ident" id="6513740">now</span><span class="op" id="6513743">,</span>&nbsp;<span class="ident" id="6513745">expiry</span><span class="op" id="6513751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6513754">if</span>&nbsp;<span class="ident" id="6513757">err</span>&nbsp;<span class="op" id="6513761">!=</span>&nbsp;<span class="builtintype" id="6513764">nil</span>&nbsp;<span class="op" id="6513768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513772">t</span><span class="op" id="6513773">.</span><span class="ident" id="6513774">Errorf</span><span class="op" id="6513780">(</span><span class="string" id="6513781">&#34;error&nbsp;creating&nbsp;CRL:&nbsp;%s&#34;</span><span class="op" id="6513805">,</span>&nbsp;<span class="ident" id="6513807">err</span><span class="op" id="6513810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6513813">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513817">_</span><span class="op" id="6513818">,</span>&nbsp;<span class="ident" id="6513820">err</span>&nbsp;<span class="op" id="6513824">=</span>&nbsp;<span class="ident" id="6513826">ParseDERCRL</span><span class="op" id="6513837">(</span><span class="ident" id="6513838">crlBytes</span><span class="op" id="6513846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6513849">if</span>&nbsp;<span class="ident" id="6513852">err</span>&nbsp;<span class="op" id="6513856">!=</span>&nbsp;<span class="builtintype" id="6513859">nil</span>&nbsp;<span class="op" id="6513863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513867">t</span><span class="op" id="6513868">.</span><span class="ident" id="6513869">Errorf</span><span class="op" id="6513875">(</span><span class="string" id="6513876">&#34;error&nbsp;reparsing&nbsp;CRL:&nbsp;%s&#34;</span><span class="op" id="6513901">,</span>&nbsp;<span class="ident" id="6513903">err</span><span class="op" id="6513906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6513909">}</span><br>
<span class="lineno"></span><span class="op" id="6513911">}</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="6513914">func</span>&nbsp;<span class="ident" id="6513919">fromBase64</span><span class="op" id="6513929">(</span><span class="ident" id="6513930">in</span>&nbsp;<span class="builtintype" id="6513933">string</span><span class="op" id="6513939">)</span>&nbsp;<span class="op" id="6513941">[</span><span class="op" id="6513942">]</span><span class="builtintype" id="6513943">byte</span>&nbsp;<span class="op" id="6513948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6513951">out</span>&nbsp;<span class="op" id="6513955">:=</span>&nbsp;<span class="builtinfunc" id="6513958">make</span><span class="op" id="6513962">(</span><span class="op" id="6513963">[</span><span class="op" id="6513964">]</span><span class="builtintype" id="6513965">byte</span><span class="op" id="6513969">,</span>&nbsp;<span class="ident" id="6513971">base64</span><span class="op" id="6513977">.</span><span class="ident" id="6513978">StdEncoding</span><span class="op" id="6513989">.</span><span class="ident" id="6513990">DecodedLen</span><span class="op" id="6514000">(</span><span class="builtinfunc" id="6514001">len</span><span class="op" id="6514004">(</span><span class="ident" id="6514005">in</span><span class="op" id="6514007">)</span><span class="op" id="6514008">)</span><span class="op" id="6514009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6514012">n</span><span class="op" id="6514013">,</span>&nbsp;<span class="ident" id="6514015">err</span>&nbsp;<span class="op" id="6514019">:=</span>&nbsp;<span class="ident" id="6514022">base64</span><span class="op" id="6514028">.</span><span class="ident" id="6514029">StdEncoding</span><span class="op" id="6514040">.</span><span class="ident" id="6514041">Decode</span><span class="op" id="6514047">(</span><span class="ident" id="6514048">out</span><span class="op" id="6514051">,</span>&nbsp;<span class="op" id="6514053">[</span><span class="op" id="6514054">]</span><span class="builtintype" id="6514055">byte</span><span class="op" id="6514059">(</span><span class="ident" id="6514060">in</span><span class="op" id="6514062">)</span><span class="op" id="6514063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6514066">if</span>&nbsp;<span class="ident" id="6514069">err</span>&nbsp;<span class="op" id="6514073">!=</span>&nbsp;<span class="builtintype" id="6514076">nil</span>&nbsp;<span class="op" id="6514080">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="6514084">panic</span><span class="op" id="6514089">(</span><span class="string" id="6514090">&#34;failed&nbsp;to&nbsp;base64&nbsp;decode&#34;</span><span class="op" id="6514115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6514118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6514121">return</span>&nbsp;<span class="ident" id="6514128">out</span><span class="op" id="6514131">[</span><span class="op" id="6514132">:</span><span class="ident" id="6514133">n</span><span class="op" id="6514134">]</span><br>
<span class="lineno"></span><span class="op" id="6514136">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">690</span><span class="keyword" id="6514139">func</span>&nbsp;<span class="ident" id="6514144">TestParseDERCRL</span><span class="op" id="6514159">(</span><span class="ident" id="6514160">t</span>&nbsp;<span class="op" id="6514162">*</span><span class="ident" id="6514163">testing</span><span class="op" id="6514170">.</span><span class="ident" id="6514171">T</span><span class="op" id="6514172">)</span>&nbsp;<span class="op" id="6514174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6514177">derBytes</span>&nbsp;<span class="op" id="6514186">:=</span>&nbsp;<span class="ident" id="6514189">fromBase64</span><span class="op" id="6514199">(</span><span class="ident" id="6514200">derCRLBase64</span><span class="op" id="6514212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6514215">certList</span><span class="op" id="6514223">,</span>&nbsp;<span class="ident" id="6514225">err</span>&nbsp;<span class="op" id="6514229">:=</span>&nbsp;<span class="ident" id="6514232">ParseDERCRL</span><span class="op" id="6514243">(</span><span class="ident" id="6514244">derBytes</span><span class="op" id="6514252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6514255">if</span>&nbsp;<span class="ident" id="6514258">err</span>&nbsp;<span class="op" id="6514262">!=</span>&nbsp;<span class="builtintype" id="6514265">nil</span>&nbsp;<span class="op" id="6514269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6514273">t</span><span class="op" id="6514274">.</span><span class="ident" id="6514275">Errorf</span><span class="op" id="6514281">(</span><span class="string" id="6514282">&#34;error&nbsp;parsing:&nbsp;%s&#34;</span><span class="op" id="6514301">,</span>&nbsp;<span class="ident" id="6514303">err</span><span class="op" id="6514306">)</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6514310">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6514318">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6514321">numCerts</span>&nbsp;<span class="op" id="6514330">:=</span>&nbsp;<span class="builtinfunc" id="6514333">len</span><span class="op" id="6514336">(</span><span class="ident" id="6514337">certList</span><span class="op" id="6514345">.</span><span class="ident" id="6514346">TBSCertList</span><span class="op" id="6514357">.</span><span class="ident" id="6514358">RevokedCertificates</span><span class="op" id="6514377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6514380">expected</span>&nbsp;<span class="op" id="6514389">:=</span>&nbsp;<span class="num" id="6514392">88</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6514396">if</span>&nbsp;<span class="ident" id="6514399">numCerts</span>&nbsp;<span class="op" id="6514408">!=</span>&nbsp;<span class="ident" id="6514411">expected</span>&nbsp;<span class="op" id="6514420">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6514424">t</span><span class="op" id="6514425">.</span><span class="ident" id="6514426">Errorf</span><span class="op" id="6514432">(</span><span class="string" id="6514433">&#34;bad&nbsp;number&nbsp;of&nbsp;revoked&nbsp;certificates.&nbsp;got:&nbsp;%d&nbsp;want:&nbsp;%d&#34;</span><span class="op" id="6514487">,</span>&nbsp;<span class="ident" id="6514489">numCerts</span><span class="op" id="6514497">,</span>&nbsp;<span class="ident" id="6514499">expected</span><span class="op" id="6514507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6514510">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6514514">if</span>&nbsp;<span class="ident" id="6514517">certList</span><span class="op" id="6514525">.</span><span class="ident" id="6514526">HasExpired</span><span class="op" id="6514536">(</span><span class="ident" id="6514537">time</span><span class="op" id="6514541">.</span><span class="ident" id="6514542">Unix</span><span class="op" id="6514546">(</span><span class="num" id="6514547">1302517272</span><span class="op" id="6514557">,</span>&nbsp;<span class="num" id="6514559">0</span><span class="op" id="6514560">)</span><span class="op" id="6514561">)</span>&nbsp;<span class="op" id="6514563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6514567">t</span><span class="op" id="6514568">.</span><span class="ident" id="6514569">Errorf</span><span class="op" id="6514575">(</span><span class="string" id="6514576">&#34;CRL&nbsp;has&nbsp;expired&nbsp;(but&nbsp;shouldn&#39;t&nbsp;have)&#34;</span><span class="op" id="6514614">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6514617">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6514621">//&nbsp;Can&#39;t&nbsp;check&nbsp;the&nbsp;signature&nbsp;here&nbsp;without&nbsp;a&nbsp;package&nbsp;cycle.</span><br>
<span class="lineno"></span><span class="op" id="6514680">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">710</span><span class="keyword" id="6514683">func</span>&nbsp;<span class="ident" id="6514688">TestCRLWithoutExpiry</span><span class="op" id="6514708">(</span><span class="ident" id="6514709">t</span>&nbsp;<span class="op" id="6514711">*</span><span class="ident" id="6514712">testing</span><span class="op" id="6514719">.</span><span class="ident" id="6514720">T</span><span class="op" id="6514721">)</span>&nbsp;<span class="op" id="6514723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6514726">derBytes</span>&nbsp;<span class="op" id="6514735">:=</span>&nbsp;<span class="ident" id="6514738">fromBase64</span><span class="op" id="6514748">(</span><span class="string" id="6514749">&#34;MIHYMIGZMAkGByqGSM44BAMwEjEQMA4GA1UEAxMHQ2FybERTUxcNOTkwODI3MDcwMDAwWjBpMBMCAgDIFw05OTA4MjIwNzAwMDBaMBMCAgDJFw05OTA4MjIwNzAwMDBaMBMCAgDTFw05OTA4MjIwNzAwMDBaMBMCAgDSFw05OTA4MjIwNzAwMDBaMBMCAgDUFw05OTA4MjQwNzAwMDBaMAkGByqGSM44BAMDLwAwLAIUfmVSdjP+NHMX0feW+aDU2G1cfT0CFAJ6W7fVWxjBz4fvftok8yqDnDWh&#34;</span><span class="op" id="6515043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515046">certList</span><span class="op" id="6515054">,</span>&nbsp;<span class="ident" id="6515056">err</span>&nbsp;<span class="op" id="6515060">:=</span>&nbsp;<span class="ident" id="6515063">ParseDERCRL</span><span class="op" id="6515074">(</span><span class="ident" id="6515075">derBytes</span><span class="op" id="6515083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6515086">if</span>&nbsp;<span class="ident" id="6515089">err</span>&nbsp;<span class="op" id="6515093">!=</span>&nbsp;<span class="builtintype" id="6515096">nil</span>&nbsp;<span class="op" id="6515100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515104">t</span><span class="op" id="6515105">.</span><span class="ident" id="6515106">Fatal</span><span class="op" id="6515111">(</span><span class="ident" id="6515112">err</span><span class="op" id="6515115">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6515118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6515121">if</span>&nbsp;<span class="op" id="6515124">!</span><span class="ident" id="6515125">certList</span><span class="op" id="6515133">.</span><span class="ident" id="6515134">TBSCertList</span><span class="op" id="6515145">.</span><span class="ident" id="6515146">NextUpdate</span><span class="op" id="6515156">.</span><span class="ident" id="6515157">IsZero</span><span class="op" id="6515163">(</span><span class="op" id="6515164">)</span>&nbsp;<span class="op" id="6515166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515170">t</span><span class="op" id="6515171">.</span><span class="ident" id="6515172">Errorf</span><span class="op" id="6515178">(</span><span class="string" id="6515179">&#34;NextUpdate&nbsp;is&nbsp;not&nbsp;the&nbsp;zero&nbsp;value&#34;</span><span class="op" id="6515213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6515216">}</span><br>
<span class="lineno"></span><span class="op" id="6515218">}</span><br>
<span class="lineno">720</span><br>
<span class="lineno"></span><span class="keyword" id="6515221">func</span>&nbsp;<span class="ident" id="6515226">TestParsePEMCRL</span><span class="op" id="6515241">(</span><span class="ident" id="6515242">t</span>&nbsp;<span class="op" id="6515244">*</span><span class="ident" id="6515245">testing</span><span class="op" id="6515252">.</span><span class="ident" id="6515253">T</span><span class="op" id="6515254">)</span>&nbsp;<span class="op" id="6515256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515259">pemBytes</span>&nbsp;<span class="op" id="6515268">:=</span>&nbsp;<span class="ident" id="6515271">fromBase64</span><span class="op" id="6515281">(</span><span class="ident" id="6515282">pemCRLBase64</span><span class="op" id="6515294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515297">certList</span><span class="op" id="6515305">,</span>&nbsp;<span class="ident" id="6515307">err</span>&nbsp;<span class="op" id="6515311">:=</span>&nbsp;<span class="ident" id="6515314">ParseCRL</span><span class="op" id="6515322">(</span><span class="ident" id="6515323">pemBytes</span><span class="op" id="6515331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6515334">if</span>&nbsp;<span class="ident" id="6515337">err</span>&nbsp;<span class="op" id="6515341">!=</span>&nbsp;<span class="builtintype" id="6515344">nil</span>&nbsp;<span class="op" id="6515348">{</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515352">t</span><span class="op" id="6515353">.</span><span class="ident" id="6515354">Errorf</span><span class="op" id="6515360">(</span><span class="string" id="6515361">&#34;error&nbsp;parsing:&nbsp;%s&#34;</span><span class="op" id="6515380">,</span>&nbsp;<span class="ident" id="6515382">err</span><span class="op" id="6515385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6515389">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6515397">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515400">numCerts</span>&nbsp;<span class="op" id="6515409">:=</span>&nbsp;<span class="builtinfunc" id="6515412">len</span><span class="op" id="6515415">(</span><span class="ident" id="6515416">certList</span><span class="op" id="6515424">.</span><span class="ident" id="6515425">TBSCertList</span><span class="op" id="6515436">.</span><span class="ident" id="6515437">RevokedCertificates</span><span class="op" id="6515456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515459">expected</span>&nbsp;<span class="op" id="6515468">:=</span>&nbsp;<span class="num" id="6515471">2</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6515474">if</span>&nbsp;<span class="ident" id="6515477">numCerts</span>&nbsp;<span class="op" id="6515486">!=</span>&nbsp;<span class="ident" id="6515489">expected</span>&nbsp;<span class="op" id="6515498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515502">t</span><span class="op" id="6515503">.</span><span class="ident" id="6515504">Errorf</span><span class="op" id="6515510">(</span><span class="string" id="6515511">&#34;bad&nbsp;number&nbsp;of&nbsp;revoked&nbsp;certificates.&nbsp;got:&nbsp;%d&nbsp;want:&nbsp;%d&#34;</span><span class="op" id="6515565">,</span>&nbsp;<span class="ident" id="6515567">numCerts</span><span class="op" id="6515575">,</span>&nbsp;<span class="ident" id="6515577">expected</span><span class="op" id="6515585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6515588">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6515592">if</span>&nbsp;<span class="ident" id="6515595">certList</span><span class="op" id="6515603">.</span><span class="ident" id="6515604">HasExpired</span><span class="op" id="6515614">(</span><span class="ident" id="6515615">time</span><span class="op" id="6515619">.</span><span class="ident" id="6515620">Unix</span><span class="op" id="6515624">(</span><span class="num" id="6515625">1302517272</span><span class="op" id="6515635">,</span>&nbsp;<span class="num" id="6515637">0</span><span class="op" id="6515638">)</span><span class="op" id="6515639">)</span>&nbsp;<span class="op" id="6515641">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515645">t</span><span class="op" id="6515646">.</span><span class="ident" id="6515647">Errorf</span><span class="op" id="6515653">(</span><span class="string" id="6515654">&#34;CRL&nbsp;has&nbsp;expired&nbsp;(but&nbsp;shouldn&#39;t&nbsp;have)&#34;</span><span class="op" id="6515692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6515695">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6515699">//&nbsp;Can&#39;t&nbsp;check&nbsp;the&nbsp;signature&nbsp;here&nbsp;without&nbsp;a&nbsp;package&nbsp;cycle.</span><br>
<span class="lineno"></span><span class="op" id="6515758">}</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span><span class="keyword" id="6515761">func</span>&nbsp;<span class="ident" id="6515766">TestImports</span><span class="op" id="6515777">(</span><span class="ident" id="6515778">t</span>&nbsp;<span class="op" id="6515780">*</span><span class="ident" id="6515781">testing</span><span class="op" id="6515788">.</span><span class="ident" id="6515789">T</span><span class="op" id="6515790">)</span>&nbsp;<span class="op" id="6515792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6515795">switch</span>&nbsp;<span class="ident" id="6515802">runtime</span><span class="op" id="6515809">.</span><span class="ident" id="6515810">GOOS</span>&nbsp;<span class="op" id="6515815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6515818">case</span>&nbsp;<span class="string" id="6515823">&#34;android&#34;</span><span class="op" id="6515832">,</span>&nbsp;<span class="string" id="6515834">&#34;nacl&#34;</span><span class="op" id="6515840">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515844">t</span><span class="op" id="6515845">.</span><span class="ident" id="6515846">Skipf</span><span class="op" id="6515851">(</span><span class="string" id="6515852">&#34;skipping&nbsp;on&nbsp;%s&#34;</span><span class="op" id="6515868">,</span>&nbsp;<span class="ident" id="6515870">runtime</span><span class="op" id="6515877">.</span><span class="ident" id="6515878">GOOS</span><span class="op" id="6515882">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6515885">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6515889">if</span>&nbsp;<span class="ident" id="6515892">err</span>&nbsp;<span class="op" id="6515896">:=</span>&nbsp;<span class="ident" id="6515899">exec</span><span class="op" id="6515903">.</span><span class="ident" id="6515904">Command</span><span class="op" id="6515911">(</span><span class="string" id="6515912">&#34;go&#34;</span><span class="op" id="6515916">,</span>&nbsp;<span class="string" id="6515918">&#34;run&#34;</span><span class="op" id="6515923">,</span>&nbsp;<span class="string" id="6515925">&#34;x509_test_import.go&#34;</span><span class="op" id="6515946">)</span><span class="op" id="6515947">.</span><span class="ident" id="6515948">Run</span><span class="op" id="6515951">(</span><span class="op" id="6515952">)</span><span class="op" id="6515953">;</span>&nbsp;<span class="ident" id="6515955">err</span>&nbsp;<span class="op" id="6515959">!=</span>&nbsp;<span class="builtintype" id="6515962">nil</span>&nbsp;<span class="op" id="6515966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6515970">t</span><span class="op" id="6515971">.</span><span class="ident" id="6515972">Errorf</span><span class="op" id="6515978">(</span><span class="string" id="6515979">&#34;failed&nbsp;to&nbsp;run&nbsp;x509_test_import.go:&nbsp;%s&#34;</span><span class="op" id="6516018">,</span>&nbsp;<span class="ident" id="6516020">err</span><span class="op" id="6516023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6516026">}</span><br>
<span class="lineno">750</span><span class="op" id="6516028">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6516031">const</span>&nbsp;<span class="ident" id="6516037">derCRLBase64</span>&nbsp;<span class="op" id="6516050">=</span>&nbsp;<span class="string" id="6516052">&#34;MIINqzCCDJMCAQEwDQYJKoZIhvcNAQEFBQAwVjEZMBcGA1UEAxMQUEtJIEZJTk1FQ0NBTklDQTEVMBMGA1UEChMMRklOTUVDQ0FOSUNBMRUwEwYDVQQLEwxGSU5NRUNDQU5JQ0ExCzAJBgNVBAYTAklUFw0xMTA1MDQxNjU3NDJaFw0xMTA1MDQyMDU3NDJaMIIMBzAhAg4Ze1od49Lt1qIXBydAzhcNMDkwNzE2MDg0MzIyWjAAMCECDl0HSL9bcZ1Ci/UHJ0DPFw0wOTA3MTYwODQzMTNaMAAwIQIOESB9tVAmX3cY7QcnQNAXDTA5MDcxNjA4NDUyMlowADAhAg4S1tGAQ3mHt8uVBydA1RcNMDkwODA0MTUyNTIyWjAAMCECDlQ249Y7vtC25ScHJ0DWFw0wOTA4MDQxNTI1MzdaMAAwIQIOISMop3NkA4PfYwcnQNkXDTA5MDgwNDExMDAzNFowADAhAg56/BMoS29KEShTBydA2hcNMDkwODA0MTEwMTAzWjAAMCECDnBp/22HPH5CSWoHJ0DbFw0wOTA4MDQxMDU0NDlaMAAwIQIOV9IP+8CD8bK+XAcnQNwXDTA5MDgwNDEwNTcxN1owADAhAg4v5aRz0IxWqYiXBydA3RcNMDkwODA0MTA1NzQ1WjAAMCECDlOU34VzvZAybQwHJ0DeFw0wOTA4MDQxMDU4MjFaMAAwIAINO4CD9lluIxcwBydBAxcNMDkwNzIyMTUzMTU5WjAAMCECDgOllfO8Y1QA7/wHJ0ExFw0wOTA3MjQxMTQxNDNaMAAwIQIOJBX7jbiCdRdyjgcnQUQXDTA5MDkxNjA5MzAwOFowADAhAg5iYSAgmDrlH/RZBydBRRcNMDkwOTE2MDkzMDE3WjAAMCECDmu6k6srP3jcMaQHJ0FRFw0wOTA4MDQxMDU2NDBaMAAwIQIOX8aHlO0V+WVH4QcnQVMXDTA5MDgwNDEwNTcyOVowADAhAg5flK2rg3NnsRgDBydBzhcNMTEwMjAxMTUzMzQ2WjAAMCECDg35yJDL1jOPTgoHJ0HPFw0xMTAyMDExNTM0MjZaMAAwIQIOMyFJ6+e9iiGVBQcnQdAXDTA5MDkxODEzMjAwNVowADAhAg5Emb/Oykucmn8fBydB1xcNMDkwOTIxMTAxMDQ3WjAAMCECDjQKCncV+MnUavMHJ0HaFw0wOTA5MjIwODE1MjZaMAAwIQIOaxiFUt3dpd+tPwcnQfQXDTEwMDYxODA4NDI1MVowADAhAg5G7P8nO0tkrMt7BydB9RcNMTAwNjE4MDg0MjMwWjAAMCECDmTCC3SXhmDRst4HJ0H2Fw0wOTA5MjgxMjA3MjBaMAAwIQIOHoGhUr/pRwzTKgcnQfcXDTA5MDkyODEyMDcyNFowADAhAg50wrcrCiw8mQmPBydCBBcNMTAwMjE2MTMwMTA2WjAAMCECDifWmkvwyhEqwEcHJ0IFFw0xMDAyMTYxMzAxMjBaMAAwIQIOfgPmlW9fg+osNgcnQhwXDTEwMDQxMzA5NTIwMFowADAhAg4YHAGuA6LgCk7tBydCHRcNMTAwNDEzMDk1MTM4WjAAMCECDi1zH1bxkNJhokAHJ0IsFw0xMDA0MTMwOTU5MzBaMAAwIQIOMipNccsb/wo2fwcnQi0XDTEwMDQxMzA5NTkwMFowADAhAg46lCmvPl4GpP6ABydCShcNMTAwMTE5MDk1MjE3WjAAMCECDjaTcaj+wBpcGAsHJ0JLFw0xMDAxMTkwOTUyMzRaMAAwIQIOOMC13EOrBuxIOQcnQloXDTEwMDIwMTA5NDcwNVowADAhAg5KmZl+krz4RsmrBydCWxcNMTAwMjAxMDk0NjQwWjAAMCECDmLG3zQJ/fzdSsUHJ0JiFw0xMDAzMDEwOTUxNDBaMAAwIQIOP39ksgHdojf4owcnQmMXDTEwMDMwMTA5NTExN1owADAhAg4LDQzvWNRlD6v9BydCZBcNMTAwMzAxMDk0NjIyWjAAMCECDkmNfeclaFhIaaUHJ0JlFw0xMDAzMDEwOTQ2MDVaMAAwIQIOT/qWWfpH/m8NTwcnQpQXDTEwMDUxMTA5MTgyMVowADAhAg5m/ksYxvCEgJSvBydClRcNMTAwNTExMDkxODAxWjAAMCECDgvf3Ohq6JOPU9AHJ0KWFw0xMDA1MTEwOTIxMjNaMAAwIQIOKSPas10z4jNVIQcnQpcXDTEwMDUxMTA5MjEwMlowADAhAg4mCWmhoZ3lyKCDBydCohcNMTEwNDI4MTEwMjI1WjAAMCECDkeiyRsBMK0Gvr4HJ0KjFw0xMTA0MjgxMTAyMDdaMAAwIQIOa09b/nH2+55SSwcnQq4XDTExMDQwMTA4Mjk0NlowADAhAg5O7M7iq7gGplr1BydCrxcNMTEwNDAxMDgzMDE3WjAAMCECDjlT6mJxUjTvyogHJ0K1Fw0xMTAxMjcxNTQ4NTJaMAAwIQIODS/l4UUFLe21NAcnQrYXDTExMDEyNzE1NDgyOFowADAhAg5lPRA0XdOUF6lSBydDHhcNMTEwMTI4MTQzNTA1WjAAMCECDixKX4fFGGpENwgHJ0MfFw0xMTAxMjgxNDM1MzBaMAAwIQIORNBkqsPnpKTtbAcnQ08XDTEwMDkwOTA4NDg0MlowADAhAg5QL+EMM3lohedEBydDUBcNMTAwOTA5MDg0ODE5WjAAMCECDlhDnHK+HiTRAXcHJ0NUFw0xMDEwMTkxNjIxNDBaMAAwIQIOdBFqAzq/INz53gcnQ1UXDTEwMTAxOTE2MjA0NFowADAhAg4OjR7s8MgKles1BydDWhcNMTEwMTI3MTY1MzM2WjAAMCECDmfR/elHee+d0SoHJ0NbFw0xMTAxMjcxNjUzNTZaMAAwIQIOBTKv2ui+KFMI+wcnQ5YXDTEwMDkxNTEwMjE1N1owADAhAg49F3c/GSah+oRUBydDmxcNMTEwMTI3MTczMjMzWjAAMCECDggv4I61WwpKFMMHJ0OcFw0xMTAxMjcxNzMyNTVaMAAwIQIOXx/Y8sEvwS10LAcnQ6UXDTExMDEyODExMjkzN1owADAhAg5LSLbnVrSKaw/9BydDphcNMTEwMTI4MTEyOTIwWjAAMCECDmFFoCuhKUeACQQHJ0PfFw0xMTAxMTExMDE3MzdaMAAwIQIOQTDdFh2fSPF6AAcnQ+AXDTExMDExMTEwMTcxMFowADAhAg5B8AOXX61FpvbbBydD5RcNMTAxMDA2MTAxNDM2WjAAMCECDh41P2Gmi7PkwI4HJ0PmFw0xMDEwMDYxMDE2MjVaMAAwIQIOWUHGLQCd+Ale9gcnQ/0XDTExMDUwMjA3NTYxMFowADAhAg5Z2c9AYkikmgWOBydD/hcNMTEwNTAyMDc1NjM0WjAAMCECDmf/UD+/h8nf+74HJ0QVFw0xMTA0MTUwNzI4MzNaMAAwIQIOICvj4epy3MrqfwcnRBYXDTExMDQxNTA3Mjg1NlowADAhAg4bouRMfOYqgv4xBydEHxcNMTEwMzA4MTYyNDI1WjAAMCECDhebWHGoKiTp7pEHJ0QgFw0xMTAzMDgxNjI0NDhaMAAwIQIOX+qnxxAqJ8LtawcnRDcXDTExMDEzMTE1MTIyOFowADAhAg4j0fICqZ+wkOdqBydEOBcNMTEwMTMxMTUxMTQxWjAAMCECDhmXjsV4SUpWtAMHJ0RLFw0xMTAxMjgxMTI0MTJaMAAwIQIODno/w+zG43kkTwcnREwXDTExMDEyODExMjM1MlowADAhAg4b1gc88767Fr+LBydETxcNMTEwMTI4MTEwMjA4WjAAMCECDn+M3Pa1w2nyFeUHJ0RQFw0xMTAxMjgxMDU4NDVaMAAwIQIOaduoyIH61tqybAcnRJUXDTEwMTIxNTA5NDMyMlowADAhAg4nLqQPkyi3ESAKBydElhcNMTAxMjE1MDk0MzM2WjAAMCECDi504NIMH8578gQHJ0SbFw0xMTAyMTQxNDA1NDFaMAAwIQIOGuaM8PDaC5u1egcnRJwXDTExMDIxNDE0MDYwNFowADAhAg4ehYq/BXGnB5PWBydEnxcNMTEwMjA0MDgwOTUxWjAAMCECDkSD4eS4FxW5H20HJ0SgFw0xMTAyMDQwODA5MjVaMAAwIQIOOCcb6ilYObt1egcnRKEXDTExMDEyNjEwNDEyOVowADAhAg58tISWCCwFnKGnBydEohcNMTEwMjA0MDgxMzQyWjAAMCECDn5rjtabY/L/WL0HJ0TJFw0xMTAyMDQxMTAzNDFaMAAwDQYJKoZIhvcNAQEFBQADggEBAGnF2Gs0+LNiYCW1Ipm83OXQYP/bd5tFFRzyz3iepFqNfYs4D68/QihjFoRHQoXEB0OEe1tvaVnnPGnEOpi6krwekquMxo4H88B5SlyiFIqemCOIss0SxlCFs69LmfRYvPPvPEhoXtQ3ZThe0UvKG83GOklhvGl6OaiRf4Mt+m8zOT4Wox/j6aOBK6cw6qKCdmD+Yj1rrNqFGg1CnSWMoD6S6mwNgkzwdBUJZ22BwrzAAo4RHa2Uy3ef1FjwD0XtU5N3uDSxGGBEDvOe5z82rps3E22FpAA8eYl8kaXtmWqyvYU0epp4brGuTxCuBMCAsxt/OjIjeNNQbBGkwxgfYA0=&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6520728">const</span>&nbsp;<span class="ident" id="6520734">pemCRLBase64</span>&nbsp;<span class="op" id="6520747">=</span>&nbsp;<span class="string" id="6520749">&#34;LS0tLS1CRUdJTiBYNTA5IENSTC0tLS0tDQpNSUlCOWpDQ0FWOENBUUV3RFFZSktvWklodmNOQVFFRkJRQXdiREVhTUJnR0ExVUVDaE1SVWxOQklGTmxZM1Z5DQphWFI1SUVsdVl5NHhIakFjQmdOVkJBTVRGVkpUUVNCUWRXSnNhV01nVW05dmRDQkRRU0IyTVRFdU1Dd0dDU3FHDQpTSWIzRFFFSkFSWWZjbk5oYTJWdmJuSnZiM1J6YVdkdVFISnpZWE5sWTNWeWFYUjVMbU52YlJjTk1URXdNakl6DQpNVGt5T0RNd1doY05NVEV3T0RJeU1Ua3lPRE13V2pDQmpEQktBaEVBckRxb2g5RkhKSFhUN09QZ3V1bjQrQmNODQpNRGt4TVRBeU1UUXlOekE1V2pBbU1Bb0dBMVVkRlFRRENnRUpNQmdHQTFVZEdBUVJHQTh5TURBNU1URXdNakUwDQpNalExTlZvd1BnSVJBTEd6blowOTVQQjVhQU9MUGc1N2ZNTVhEVEF5TVRBeU16RTBOVEF4TkZvd0dqQVlCZ05WDQpIUmdFRVJnUE1qQXdNakV3TWpNeE5EVXdNVFJhb0RBd0xqQWZCZ05WSFNNRUdEQVdnQlQxVERGNlVRTS9MTmVMDQpsNWx2cUhHUXEzZzltekFMQmdOVkhSUUVCQUlDQUlRd0RRWUpLb1pJaHZjTkFRRUZCUUFEZ1lFQUZVNUFzNk16DQpxNVBSc2lmYW9iUVBHaDFhSkx5QytNczVBZ2MwYld5QTNHQWR4dXI1U3BQWmVSV0NCamlQL01FSEJXSkNsQkhQDQpHUmNxNXlJZDNFakRrYUV5eFJhK2k2N0x6dmhJNmMyOUVlNks5cFNZd2ppLzdSVWhtbW5Qclh0VHhsTDBsckxyDQptUVFKNnhoRFJhNUczUUE0Q21VZHNITnZicnpnbUNZcHZWRT0NCi0tLS0tRU5EIFg1MDkgQ1JMLS0tLS0NCg0K&#34;</span><br>
<span class="lineno">755</span><br>
<span class="lineno"></span><span class="keyword" id="6521753">func</span>&nbsp;<span class="ident" id="6521758">TestCreateCertificateRequest</span><span class="op" id="6521786">(</span><span class="ident" id="6521787">t</span>&nbsp;<span class="op" id="6521789">*</span><span class="ident" id="6521790">testing</span><span class="op" id="6521797">.</span><span class="ident" id="6521798">T</span><span class="op" id="6521799">)</span>&nbsp;<span class="op" id="6521801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6521804">random</span>&nbsp;<span class="op" id="6521811">:=</span>&nbsp;<span class="ident" id="6521814">rand</span><span class="op" id="6521818">.</span><span class="ident" id="6521819">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6521828">block</span><span class="op" id="6521833">,</span>&nbsp;<span class="ident" id="6521835">_</span>&nbsp;<span class="op" id="6521837">:=</span>&nbsp;<span class="ident" id="6521840">pem</span><span class="op" id="6521843">.</span><span class="ident" id="6521844">Decode</span><span class="op" id="6521850">(</span><span class="op" id="6521851">[</span><span class="op" id="6521852">]</span><span class="builtintype" id="6521853">byte</span><span class="op" id="6521857">(</span><span class="ident" id="6521858">pemPrivateKey</span><span class="op" id="6521871">)</span><span class="op" id="6521872">)</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6521875">rsaPriv</span><span class="op" id="6521882">,</span>&nbsp;<span class="ident" id="6521884">err</span>&nbsp;<span class="op" id="6521888">:=</span>&nbsp;<span class="ident" id="6521891">ParsePKCS1PrivateKey</span><span class="op" id="6521911">(</span><span class="ident" id="6521912">block</span><span class="op" id="6521917">.</span><span class="ident" id="6521918">Bytes</span><span class="op" id="6521923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6521926">if</span>&nbsp;<span class="ident" id="6521929">err</span>&nbsp;<span class="op" id="6521933">!=</span>&nbsp;<span class="builtintype" id="6521936">nil</span>&nbsp;<span class="op" id="6521940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6521944">t</span><span class="op" id="6521945">.</span><span class="ident" id="6521946">Fatalf</span><span class="op" id="6521952">(</span><span class="string" id="6521953">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="6521986">,</span>&nbsp;<span class="ident" id="6521988">err</span><span class="op" id="6521991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6521994">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6521998">ecdsa256Priv</span><span class="op" id="6522010">,</span>&nbsp;<span class="ident" id="6522012">err</span>&nbsp;<span class="op" id="6522016">:=</span>&nbsp;<span class="ident" id="6522019">ecdsa</span><span class="op" id="6522024">.</span><span class="ident" id="6522025">GenerateKey</span><span class="op" id="6522036">(</span><span class="ident" id="6522037">elliptic</span><span class="op" id="6522045">.</span><span class="ident" id="6522046">P256</span><span class="op" id="6522050">(</span><span class="op" id="6522051">)</span><span class="op" id="6522052">,</span>&nbsp;<span class="ident" id="6522054">rand</span><span class="op" id="6522058">.</span><span class="ident" id="6522059">Reader</span><span class="op" id="6522065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6522068">if</span>&nbsp;<span class="ident" id="6522071">err</span>&nbsp;<span class="op" id="6522075">!=</span>&nbsp;<span class="builtintype" id="6522078">nil</span>&nbsp;<span class="op" id="6522082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6522086">t</span><span class="op" id="6522087">.</span><span class="ident" id="6522088">Fatalf</span><span class="op" id="6522094">(</span><span class="string" id="6522095">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="6522129">,</span>&nbsp;<span class="ident" id="6522131">err</span><span class="op" id="6522134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6522137">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6522141">ecdsa384Priv</span><span class="op" id="6522153">,</span>&nbsp;<span class="ident" id="6522155">err</span>&nbsp;<span class="op" id="6522159">:=</span>&nbsp;<span class="ident" id="6522162">ecdsa</span><span class="op" id="6522167">.</span><span class="ident" id="6522168">GenerateKey</span><span class="op" id="6522179">(</span><span class="ident" id="6522180">elliptic</span><span class="op" id="6522188">.</span><span class="ident" id="6522189">P384</span><span class="op" id="6522193">(</span><span class="op" id="6522194">)</span><span class="op" id="6522195">,</span>&nbsp;<span class="ident" id="6522197">rand</span><span class="op" id="6522201">.</span><span class="ident" id="6522202">Reader</span><span class="op" id="6522208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6522211">if</span>&nbsp;<span class="ident" id="6522214">err</span>&nbsp;<span class="op" id="6522218">!=</span>&nbsp;<span class="builtintype" id="6522221">nil</span>&nbsp;<span class="op" id="6522225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6522229">t</span><span class="op" id="6522230">.</span><span class="ident" id="6522231">Fatalf</span><span class="op" id="6522237">(</span><span class="string" id="6522238">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="6522272">,</span>&nbsp;<span class="ident" id="6522274">err</span><span class="op" id="6522277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6522280">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6522284">ecdsa521Priv</span><span class="op" id="6522296">,</span>&nbsp;<span class="ident" id="6522298">err</span>&nbsp;<span class="op" id="6522302">:=</span>&nbsp;<span class="ident" id="6522305">ecdsa</span><span class="op" id="6522310">.</span><span class="ident" id="6522311">GenerateKey</span><span class="op" id="6522322">(</span><span class="ident" id="6522323">elliptic</span><span class="op" id="6522331">.</span><span class="ident" id="6522332">P521</span><span class="op" id="6522336">(</span><span class="op" id="6522337">)</span><span class="op" id="6522338">,</span>&nbsp;<span class="ident" id="6522340">rand</span><span class="op" id="6522344">.</span><span class="ident" id="6522345">Reader</span><span class="op" id="6522351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6522354">if</span>&nbsp;<span class="ident" id="6522357">err</span>&nbsp;<span class="op" id="6522361">!=</span>&nbsp;<span class="builtintype" id="6522364">nil</span>&nbsp;<span class="op" id="6522368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6522372">t</span><span class="op" id="6522373">.</span><span class="ident" id="6522374">Fatalf</span><span class="op" id="6522380">(</span><span class="string" id="6522381">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="6522415">,</span>&nbsp;<span class="ident" id="6522417">err</span><span class="op" id="6522420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6522423">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6522427">tests</span>&nbsp;<span class="op" id="6522433">:=</span>&nbsp;<span class="op" id="6522436">[</span><span class="op" id="6522437">]</span><span class="keyword" id="6522438">struct</span>&nbsp;<span class="op" id="6522445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6522449">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6522457">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6522466">priv</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6522474">interface</span><span class="op" id="6522483">{</span><span class="op" id="6522484">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6522488">sigAlgo</span>&nbsp;<span class="ident" id="6522496">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6522516">}</span><span class="op" id="6522517">{</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6522521">{</span><span class="string" id="6522522">&#34;RSA&#34;</span><span class="op" id="6522527">,</span>&nbsp;<span class="ident" id="6522529">rsaPriv</span><span class="op" id="6522536">,</span>&nbsp;<span class="ident" id="6522538">SHA1WithRSA</span><span class="op" id="6522549">}</span><span class="op" id="6522550">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6522554">{</span><span class="string" id="6522555">&#34;ECDSA-256&#34;</span><span class="op" id="6522566">,</span>&nbsp;<span class="ident" id="6522568">ecdsa256Priv</span><span class="op" id="6522580">,</span>&nbsp;<span class="ident" id="6522582">ECDSAWithSHA1</span><span class="op" id="6522595">}</span><span class="op" id="6522596">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6522600">{</span><span class="string" id="6522601">&#34;ECDSA-384&#34;</span><span class="op" id="6522612">,</span>&nbsp;<span class="ident" id="6522614">ecdsa384Priv</span><span class="op" id="6522626">,</span>&nbsp;<span class="ident" id="6522628">ECDSAWithSHA1</span><span class="op" id="6522641">}</span><span class="op" id="6522642">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6522646">{</span><span class="string" id="6522647">&#34;ECDSA-521&#34;</span><span class="op" id="6522658">,</span>&nbsp;<span class="ident" id="6522660">ecdsa521Priv</span><span class="op" id="6522672">,</span>&nbsp;<span class="ident" id="6522674">ECDSAWithSHA1</span><span class="op" id="6522687">}</span><span class="op" id="6522688">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6522691">}</span><br>
<span class="lineno">790</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6522695">for</span>&nbsp;<span class="ident" id="6522699">_</span><span class="op" id="6522700">,</span>&nbsp;<span class="ident" id="6522702">test</span>&nbsp;<span class="op" id="6522707">:=</span>&nbsp;<span class="keyword" id="6522710">range</span>&nbsp;<span class="ident" id="6522716">tests</span>&nbsp;<span class="op" id="6522722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6522726">template</span>&nbsp;<span class="op" id="6522735">:=</span>&nbsp;<span class="ident" id="6522738">CertificateRequest</span><span class="op" id="6522756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6522761">Subject</span><span class="op" id="6522768">:</span>&nbsp;<span class="ident" id="6522770">pkix</span><span class="op" id="6522774">.</span><span class="ident" id="6522775">Name</span><span class="op" id="6522779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6522785">CommonName</span><span class="op" id="6522795">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6522799">&#34;test.example.com&#34;</span><span class="op" id="6522817">,</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6522823">Organization</span><span class="op" id="6522835">:</span>&nbsp;<span class="op" id="6522837">[</span><span class="op" id="6522838">]</span><span class="builtintype" id="6522839">string</span><span class="op" id="6522845">{</span><span class="string" id="6522846">&#34;Σ&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="6522858">}</span><span class="op" id="6522859">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6522864">}</span><span class="op" id="6522865">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6522870">SignatureAlgorithm</span><span class="op" id="6522888">:</span>&nbsp;<span class="ident" id="6522890">test</span><span class="op" id="6522894">.</span><span class="ident" id="6522895">sigAlgo</span><span class="op" id="6522902">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6522907">DNSNames</span><span class="op" id="6522915">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6522927">[</span><span class="op" id="6522928">]</span><span class="builtintype" id="6522929">string</span><span class="op" id="6522935">{</span><span class="string" id="6522936">&#34;test.example.com&#34;</span><span class="op" id="6522954">}</span><span class="op" id="6522955">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6522960">EmailAddresses</span><span class="op" id="6522974">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6522980">[</span><span class="op" id="6522981">]</span><span class="builtintype" id="6522982">string</span><span class="op" id="6522988">{</span><span class="string" id="6522989">&#34;gopher@golang.org&#34;</span><span class="op" id="6523008">}</span><span class="op" id="6523009">,</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6523014">IPAddresses</span><span class="op" id="6523025">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6523034">[</span><span class="op" id="6523035">]</span><span class="ident" id="6523036">net</span><span class="op" id="6523039">.</span><span class="ident" id="6523040">IP</span><span class="op" id="6523042">{</span><span class="ident" id="6523043">net</span><span class="op" id="6523046">.</span><span class="ident" id="6523047">IPv4</span><span class="op" id="6523051">(</span><span class="num" id="6523052">127</span><span class="op" id="6523055">,</span>&nbsp;<span class="num" id="6523057">0</span><span class="op" id="6523058">,</span>&nbsp;<span class="num" id="6523060">0</span><span class="op" id="6523061">,</span>&nbsp;<span class="num" id="6523063">1</span><span class="op" id="6523064">)</span><span class="op" id="6523065">.</span><span class="ident" id="6523066">To4</span><span class="op" id="6523069">(</span><span class="op" id="6523070">)</span><span class="op" id="6523071">,</span>&nbsp;<span class="ident" id="6523073">net</span><span class="op" id="6523076">.</span><span class="ident" id="6523077">ParseIP</span><span class="op" id="6523084">(</span><span class="string" id="6523085">&#34;2001:4860:0:2001::68&#34;</span><span class="op" id="6523107">)</span><span class="op" id="6523108">}</span><span class="op" id="6523109">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6523113">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6523118">derBytes</span><span class="op" id="6523126">,</span>&nbsp;<span class="ident" id="6523128">err</span>&nbsp;<span class="op" id="6523132">:=</span>&nbsp;<span class="ident" id="6523135">CreateCertificateRequest</span><span class="op" id="6523159">(</span><span class="ident" id="6523160">random</span><span class="op" id="6523166">,</span>&nbsp;<span class="op" id="6523168">&amp;</span><span class="ident" id="6523169">template</span><span class="op" id="6523177">,</span>&nbsp;<span class="ident" id="6523179">test</span><span class="op" id="6523183">.</span><span class="ident" id="6523184">priv</span><span class="op" id="6523188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6523192">if</span>&nbsp;<span class="ident" id="6523195">err</span>&nbsp;<span class="op" id="6523199">!=</span>&nbsp;<span class="builtintype" id="6523202">nil</span>&nbsp;<span class="op" id="6523206">{</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6523211">t</span><span class="op" id="6523212">.</span><span class="ident" id="6523213">Errorf</span><span class="op" id="6523219">(</span><span class="string" id="6523220">&#34;%s:&nbsp;failed&nbsp;to&nbsp;create&nbsp;certificate&nbsp;request:&nbsp;%s&#34;</span><span class="op" id="6523266">,</span>&nbsp;<span class="ident" id="6523268">test</span><span class="op" id="6523272">.</span><span class="ident" id="6523273">name</span><span class="op" id="6523277">,</span>&nbsp;<span class="ident" id="6523279">err</span><span class="op" id="6523282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6523287">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6523298">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6523303">out</span><span class="op" id="6523306">,</span>&nbsp;<span class="ident" id="6523308">err</span>&nbsp;<span class="op" id="6523312">:=</span>&nbsp;<span class="ident" id="6523315">ParseCertificateRequest</span><span class="op" id="6523338">(</span><span class="ident" id="6523339">derBytes</span><span class="op" id="6523347">)</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6523351">if</span>&nbsp;<span class="ident" id="6523354">err</span>&nbsp;<span class="op" id="6523358">!=</span>&nbsp;<span class="builtintype" id="6523361">nil</span>&nbsp;<span class="op" id="6523365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6523370">t</span><span class="op" id="6523371">.</span><span class="ident" id="6523372">Errorf</span><span class="op" id="6523378">(</span><span class="string" id="6523379">&#34;%s:&nbsp;failed&nbsp;to&nbsp;create&nbsp;certificate&nbsp;request:&nbsp;%s&#34;</span><span class="op" id="6523425">,</span>&nbsp;<span class="ident" id="6523427">test</span><span class="op" id="6523431">.</span><span class="ident" id="6523432">name</span><span class="op" id="6523436">,</span>&nbsp;<span class="ident" id="6523438">err</span><span class="op" id="6523441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6523446">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6523457">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6523462">if</span>&nbsp;<span class="ident" id="6523465">out</span><span class="op" id="6523468">.</span><span class="ident" id="6523469">Subject</span><span class="op" id="6523476">.</span><span class="ident" id="6523477">CommonName</span>&nbsp;<span class="op" id="6523488">!=</span>&nbsp;<span class="ident" id="6523491">template</span><span class="op" id="6523499">.</span><span class="ident" id="6523500">Subject</span><span class="op" id="6523507">.</span><span class="ident" id="6523508">CommonName</span>&nbsp;<span class="op" id="6523519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6523524">t</span><span class="op" id="6523525">.</span><span class="ident" id="6523526">Errorf</span><span class="op" id="6523532">(</span><span class="string" id="6523533">&#34;%s:&nbsp;output&nbsp;subject&nbsp;common&nbsp;name&nbsp;and&nbsp;template&nbsp;subject&nbsp;common&nbsp;name&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="6523610">,</span>&nbsp;<span class="ident" id="6523612">test</span><span class="op" id="6523616">.</span><span class="ident" id="6523617">name</span><span class="op" id="6523621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6523625">}</span>&nbsp;<span class="keyword" id="6523627">else</span>&nbsp;<span class="keyword" id="6523632">if</span>&nbsp;<span class="builtinfunc" id="6523635">len</span><span class="op" id="6523638">(</span><span class="ident" id="6523639">out</span><span class="op" id="6523642">.</span><span class="ident" id="6523643">Subject</span><span class="op" id="6523650">.</span><span class="ident" id="6523651">Organization</span><span class="op" id="6523663">)</span>&nbsp;<span class="op" id="6523665">!=</span>&nbsp;<span class="builtinfunc" id="6523668">len</span><span class="op" id="6523671">(</span><span class="ident" id="6523672">template</span><span class="op" id="6523680">.</span><span class="ident" id="6523681">Subject</span><span class="op" id="6523688">.</span><span class="ident" id="6523689">Organization</span><span class="op" id="6523701">)</span>&nbsp;<span class="op" id="6523703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6523708">t</span><span class="op" id="6523709">.</span><span class="ident" id="6523710">Errorf</span><span class="op" id="6523716">(</span><span class="string" id="6523717">&#34;%s:&nbsp;output&nbsp;subject&nbsp;organisation&nbsp;and&nbsp;template&nbsp;subject&nbsp;organisation&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="6523796">,</span>&nbsp;<span class="ident" id="6523798">test</span><span class="op" id="6523802">.</span><span class="ident" id="6523803">name</span><span class="op" id="6523807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6523811">}</span>&nbsp;<span class="keyword" id="6523813">else</span>&nbsp;<span class="keyword" id="6523818">if</span>&nbsp;<span class="builtinfunc" id="6523821">len</span><span class="op" id="6523824">(</span><span class="ident" id="6523825">out</span><span class="op" id="6523828">.</span><span class="ident" id="6523829">DNSNames</span><span class="op" id="6523837">)</span>&nbsp;<span class="op" id="6523839">!=</span>&nbsp;<span class="builtinfunc" id="6523842">len</span><span class="op" id="6523845">(</span><span class="ident" id="6523846">template</span><span class="op" id="6523854">.</span><span class="ident" id="6523855">DNSNames</span><span class="op" id="6523863">)</span>&nbsp;<span class="op" id="6523865">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6523870">t</span><span class="op" id="6523871">.</span><span class="ident" id="6523872">Errorf</span><span class="op" id="6523878">(</span><span class="string" id="6523879">&#34;%s:&nbsp;output&nbsp;DNS&nbsp;names&nbsp;and&nbsp;template&nbsp;DNS&nbsp;names&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="6523936">,</span>&nbsp;<span class="ident" id="6523938">test</span><span class="op" id="6523942">.</span><span class="ident" id="6523943">name</span><span class="op" id="6523947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6523951">}</span>&nbsp;<span class="keyword" id="6523953">else</span>&nbsp;<span class="keyword" id="6523958">if</span>&nbsp;<span class="builtinfunc" id="6523961">len</span><span class="op" id="6523964">(</span><span class="ident" id="6523965">out</span><span class="op" id="6523968">.</span><span class="ident" id="6523969">EmailAddresses</span><span class="op" id="6523983">)</span>&nbsp;<span class="op" id="6523985">!=</span>&nbsp;<span class="builtinfunc" id="6523988">len</span><span class="op" id="6523991">(</span><span class="ident" id="6523992">template</span><span class="op" id="6524000">.</span><span class="ident" id="6524001">EmailAddresses</span><span class="op" id="6524015">)</span>&nbsp;<span class="op" id="6524017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6524022">t</span><span class="op" id="6524023">.</span><span class="ident" id="6524024">Errorf</span><span class="op" id="6524030">(</span><span class="string" id="6524031">&#34;%s:&nbsp;output&nbsp;email&nbsp;addresses&nbsp;and&nbsp;template&nbsp;email&nbsp;addresses&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="6524100">,</span>&nbsp;<span class="ident" id="6524102">test</span><span class="op" id="6524106">.</span><span class="ident" id="6524107">name</span><span class="op" id="6524111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6524115">}</span>&nbsp;<span class="keyword" id="6524117">else</span>&nbsp;<span class="keyword" id="6524122">if</span>&nbsp;<span class="builtinfunc" id="6524125">len</span><span class="op" id="6524128">(</span><span class="ident" id="6524129">out</span><span class="op" id="6524132">.</span><span class="ident" id="6524133">IPAddresses</span><span class="op" id="6524144">)</span>&nbsp;<span class="op" id="6524146">!=</span>&nbsp;<span class="builtinfunc" id="6524149">len</span><span class="op" id="6524152">(</span><span class="ident" id="6524153">template</span><span class="op" id="6524161">.</span><span class="ident" id="6524162">IPAddresses</span><span class="op" id="6524173">)</span>&nbsp;<span class="op" id="6524175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6524180">t</span><span class="op" id="6524181">.</span><span class="ident" id="6524182">Errorf</span><span class="op" id="6524188">(</span><span class="string" id="6524189">&#34;%s:&nbsp;output&nbsp;IP&nbsp;addresses&nbsp;and&nbsp;template&nbsp;IP&nbsp;addresses&nbsp;names&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="6524258">,</span>&nbsp;<span class="ident" id="6524260">test</span><span class="op" id="6524264">.</span><span class="ident" id="6524265">name</span><span class="op" id="6524269">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6524273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6524276">}</span><br>
<span class="lineno"></span><span class="op" id="6524278">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6524281">func</span>&nbsp;<span class="ident" id="6524286">marshalAndParseCSR</span><span class="op" id="6524304">(</span><span class="ident" id="6524305">t</span>&nbsp;<span class="op" id="6524307">*</span><span class="ident" id="6524308">testing</span><span class="op" id="6524315">.</span><span class="ident" id="6524316">T</span><span class="op" id="6524317">,</span>&nbsp;<span class="ident" id="6524319">template</span>&nbsp;<span class="op" id="6524328">*</span><span class="ident" id="6524329">CertificateRequest</span><span class="op" id="6524347">)</span>&nbsp;<span class="op" id="6524349">*</span><span class="ident" id="6524350">CertificateRequest</span>&nbsp;<span class="op" id="6524369">{</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6524372">block</span><span class="op" id="6524377">,</span>&nbsp;<span class="ident" id="6524379">_</span>&nbsp;<span class="op" id="6524381">:=</span>&nbsp;<span class="ident" id="6524384">pem</span><span class="op" id="6524387">.</span><span class="ident" id="6524388">Decode</span><span class="op" id="6524394">(</span><span class="op" id="6524395">[</span><span class="op" id="6524396">]</span><span class="builtintype" id="6524397">byte</span><span class="op" id="6524401">(</span><span class="ident" id="6524402">pemPrivateKey</span><span class="op" id="6524415">)</span><span class="op" id="6524416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6524419">rsaPriv</span><span class="op" id="6524426">,</span>&nbsp;<span class="ident" id="6524428">err</span>&nbsp;<span class="op" id="6524432">:=</span>&nbsp;<span class="ident" id="6524435">ParsePKCS1PrivateKey</span><span class="op" id="6524455">(</span><span class="ident" id="6524456">block</span><span class="op" id="6524461">.</span><span class="ident" id="6524462">Bytes</span><span class="op" id="6524467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6524470">if</span>&nbsp;<span class="ident" id="6524473">err</span>&nbsp;<span class="op" id="6524477">!=</span>&nbsp;<span class="builtintype" id="6524480">nil</span>&nbsp;<span class="op" id="6524484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6524488">t</span><span class="op" id="6524489">.</span><span class="ident" id="6524490">Fatal</span><span class="op" id="6524495">(</span><span class="ident" id="6524496">err</span><span class="op" id="6524499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6524502">}</span><br>
<span class="lineno">835</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6524506">derBytes</span><span class="op" id="6524514">,</span>&nbsp;<span class="ident" id="6524516">err</span>&nbsp;<span class="op" id="6524520">:=</span>&nbsp;<span class="ident" id="6524523">CreateCertificateRequest</span><span class="op" id="6524547">(</span><span class="ident" id="6524548">rand</span><span class="op" id="6524552">.</span><span class="ident" id="6524553">Reader</span><span class="op" id="6524559">,</span>&nbsp;<span class="ident" id="6524561">template</span><span class="op" id="6524569">,</span>&nbsp;<span class="ident" id="6524571">rsaPriv</span><span class="op" id="6524578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6524581">if</span>&nbsp;<span class="ident" id="6524584">err</span>&nbsp;<span class="op" id="6524588">!=</span>&nbsp;<span class="builtintype" id="6524591">nil</span>&nbsp;<span class="op" id="6524595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6524599">t</span><span class="op" id="6524600">.</span><span class="ident" id="6524601">Fatal</span><span class="op" id="6524606">(</span><span class="ident" id="6524607">err</span><span class="op" id="6524610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6524613">}</span><br>
<span class="lineno">840</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6524617">csr</span><span class="op" id="6524620">,</span>&nbsp;<span class="ident" id="6524622">err</span>&nbsp;<span class="op" id="6524626">:=</span>&nbsp;<span class="ident" id="6524629">ParseCertificateRequest</span><span class="op" id="6524652">(</span><span class="ident" id="6524653">derBytes</span><span class="op" id="6524661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6524664">if</span>&nbsp;<span class="ident" id="6524667">err</span>&nbsp;<span class="op" id="6524671">!=</span>&nbsp;<span class="builtintype" id="6524674">nil</span>&nbsp;<span class="op" id="6524678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6524682">t</span><span class="op" id="6524683">.</span><span class="ident" id="6524684">Fatal</span><span class="op" id="6524689">(</span><span class="ident" id="6524690">err</span><span class="op" id="6524693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6524696">}</span><br>
<span class="lineno">845</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6524700">return</span>&nbsp;<span class="ident" id="6524707">csr</span><br>
<span class="lineno"></span><span class="op" id="6524711">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6524714">func</span>&nbsp;<span class="ident" id="6524719">TestCertificateRequestOverrides</span><span class="op" id="6524750">(</span><span class="ident" id="6524751">t</span>&nbsp;<span class="op" id="6524753">*</span><span class="ident" id="6524754">testing</span><span class="op" id="6524761">.</span><span class="ident" id="6524762">T</span><span class="op" id="6524763">)</span>&nbsp;<span class="op" id="6524765">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6524768">sanContents</span><span class="op" id="6524779">,</span>&nbsp;<span class="ident" id="6524781">err</span>&nbsp;<span class="op" id="6524785">:=</span>&nbsp;<span class="ident" id="6524788">marshalSANs</span><span class="op" id="6524799">(</span><span class="op" id="6524800">[</span><span class="op" id="6524801">]</span><span class="builtintype" id="6524802">string</span><span class="op" id="6524808">{</span><span class="string" id="6524809">&#34;foo.example.com&#34;</span><span class="op" id="6524826">}</span><span class="op" id="6524827">,</span>&nbsp;<span class="builtintype" id="6524829">nil</span><span class="op" id="6524832">,</span>&nbsp;<span class="builtintype" id="6524834">nil</span><span class="op" id="6524837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6524840">if</span>&nbsp;<span class="ident" id="6524843">err</span>&nbsp;<span class="op" id="6524847">!=</span>&nbsp;<span class="builtintype" id="6524850">nil</span>&nbsp;<span class="op" id="6524854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6524858">t</span><span class="op" id="6524859">.</span><span class="ident" id="6524860">Fatal</span><span class="op" id="6524865">(</span><span class="ident" id="6524866">err</span><span class="op" id="6524869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6524872">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6524876">template</span>&nbsp;<span class="op" id="6524885">:=</span>&nbsp;<span class="ident" id="6524888">CertificateRequest</span><span class="op" id="6524906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6524910">Subject</span><span class="op" id="6524917">:</span>&nbsp;<span class="ident" id="6524919">pkix</span><span class="op" id="6524923">.</span><span class="ident" id="6524924">Name</span><span class="op" id="6524928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6524933">CommonName</span><span class="op" id="6524943">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6524947">&#34;test.example.com&#34;</span><span class="op" id="6524965">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6524970">Organization</span><span class="op" id="6524982">:</span>&nbsp;<span class="op" id="6524984">[</span><span class="op" id="6524985">]</span><span class="builtintype" id="6524986">string</span><span class="op" id="6524992">{</span><span class="string" id="6524993">&#34;Σ&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="6525005">}</span><span class="op" id="6525006">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6525010">}</span><span class="op" id="6525011">,</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6525015">DNSNames</span><span class="op" id="6525023">:</span>&nbsp;<span class="op" id="6525025">[</span><span class="op" id="6525026">]</span><span class="builtintype" id="6525027">string</span><span class="op" id="6525033">{</span><span class="string" id="6525034">&#34;test.example.com&#34;</span><span class="op" id="6525052">}</span><span class="op" id="6525053">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6525058">//&nbsp;An&nbsp;explicit&nbsp;extension&nbsp;should&nbsp;override&nbsp;the&nbsp;DNSNames&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6525123">//&nbsp;template.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6525138">ExtraExtensions</span><span class="op" id="6525153">:</span>&nbsp;<span class="op" id="6525155">[</span><span class="op" id="6525156">]</span><span class="ident" id="6525157">pkix</span><span class="op" id="6525161">.</span><span class="ident" id="6525162">Extension</span><span class="op" id="6525171">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6525176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6525182">Id</span><span class="op" id="6525184">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6525189">oidExtensionSubjectAltName</span><span class="op" id="6525215">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6525221">Value</span><span class="op" id="6525226">:</span>&nbsp;<span class="ident" id="6525228">sanContents</span><span class="op" id="6525239">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6525244">}</span><span class="op" id="6525245">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6525249">}</span><span class="op" id="6525250">,</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6525253">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6525257">csr</span>&nbsp;<span class="op" id="6525261">:=</span>&nbsp;<span class="ident" id="6525264">marshalAndParseCSR</span><span class="op" id="6525282">(</span><span class="ident" id="6525283">t</span><span class="op" id="6525284">,</span>&nbsp;<span class="op" id="6525286">&amp;</span><span class="ident" id="6525287">template</span><span class="op" id="6525295">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6525299">if</span>&nbsp;<span class="builtinfunc" id="6525302">len</span><span class="op" id="6525305">(</span><span class="ident" id="6525306">csr</span><span class="op" id="6525309">.</span><span class="ident" id="6525310">DNSNames</span><span class="op" id="6525318">)</span>&nbsp;<span class="op" id="6525320">!=</span>&nbsp;<span class="num" id="6525323">1</span>&nbsp;<span class="op" id="6525325">||</span>&nbsp;<span class="ident" id="6525328">csr</span><span class="op" id="6525331">.</span><span class="ident" id="6525332">DNSNames</span><span class="op" id="6525340">[</span><span class="num" id="6525341">0</span><span class="op" id="6525342">]</span>&nbsp;<span class="op" id="6525344">!=</span>&nbsp;<span class="string" id="6525347">&#34;foo.example.com&#34;</span>&nbsp;<span class="op" id="6525365">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6525369">t</span><span class="op" id="6525370">.</span><span class="ident" id="6525371">Errorf</span><span class="op" id="6525377">(</span><span class="string" id="6525378">&#34;Extension&nbsp;did&nbsp;not&nbsp;override&nbsp;template.&nbsp;Got&nbsp;%v\n&#34;</span><span class="op" id="6525425">,</span>&nbsp;<span class="ident" id="6525427">csr</span><span class="op" id="6525430">.</span><span class="ident" id="6525431">DNSNames</span><span class="op" id="6525439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6525442">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6525446">//&nbsp;If&nbsp;there&nbsp;is&nbsp;already&nbsp;an&nbsp;attribute&nbsp;with&nbsp;X.509&nbsp;extensions&nbsp;then&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6525514">//&nbsp;extra&nbsp;extensions&nbsp;should&nbsp;be&nbsp;added&nbsp;to&nbsp;it&nbsp;rather&nbsp;than&nbsp;creating&nbsp;a&nbsp;CSR</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6525584">//&nbsp;with&nbsp;two&nbsp;extension&nbsp;attributes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6525620">template</span><span class="op" id="6525628">.</span><span class="ident" id="6525629">Attributes</span>&nbsp;<span class="op" id="6525640">=</span>&nbsp;<span class="op" id="6525642">[</span><span class="op" id="6525643">]</span><span class="ident" id="6525644">pkix</span><span class="op" id="6525648">.</span><span class="ident" id="6525649">AttributeTypeAndValueSET</span><span class="op" id="6525673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6525677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6525682">Type</span><span class="op" id="6525686">:</span>&nbsp;<span class="ident" id="6525688">oidExtensionRequest</span><span class="op" id="6525707">,</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6525712">Value</span><span class="op" id="6525717">:</span>&nbsp;<span class="op" id="6525719">[</span><span class="op" id="6525720">]</span><span class="op" id="6525721">[</span><span class="op" id="6525722">]</span><span class="ident" id="6525723">pkix</span><span class="op" id="6525727">.</span><span class="ident" id="6525728">AttributeTypeAndValue</span><span class="op" id="6525749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6525755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6525762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6525770">Type</span><span class="op" id="6525774">:</span>&nbsp;&nbsp;<span class="ident" id="6525777">oidExtensionAuthorityInfoAccess</span><span class="op" id="6525808">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6525816">Value</span><span class="op" id="6525821">:</span>&nbsp;<span class="op" id="6525823">[</span><span class="op" id="6525824">]</span><span class="builtintype" id="6525825">byte</span><span class="op" id="6525829">(</span><span class="string" id="6525830">&#34;foo&#34;</span><span class="op" id="6525835">)</span><span class="op" id="6525836">,</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6525843">}</span><span class="op" id="6525844">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6525850">}</span><span class="op" id="6525851">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6525856">}</span><span class="op" id="6525857">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6525861">}</span><span class="op" id="6525862">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6525865">}</span><br>
<span class="lineno">895</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6525869">csr</span>&nbsp;<span class="op" id="6525873">=</span>&nbsp;<span class="ident" id="6525875">marshalAndParseCSR</span><span class="op" id="6525893">(</span><span class="ident" id="6525894">t</span><span class="op" id="6525895">,</span>&nbsp;<span class="op" id="6525897">&amp;</span><span class="ident" id="6525898">template</span><span class="op" id="6525906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6525909">if</span>&nbsp;<span class="ident" id="6525912">l</span>&nbsp;<span class="op" id="6525914">:=</span>&nbsp;<span class="builtinfunc" id="6525917">len</span><span class="op" id="6525920">(</span><span class="ident" id="6525921">csr</span><span class="op" id="6525924">.</span><span class="ident" id="6525925">Attributes</span><span class="op" id="6525935">)</span><span class="op" id="6525936">;</span>&nbsp;<span class="ident" id="6525938">l</span>&nbsp;<span class="op" id="6525940">!=</span>&nbsp;<span class="num" id="6525943">1</span>&nbsp;<span class="op" id="6525945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6525949">t</span><span class="op" id="6525950">.</span><span class="ident" id="6525951">Errorf</span><span class="op" id="6525957">(</span><span class="string" id="6525958">&#34;incorrect&nbsp;number&nbsp;of&nbsp;attributes:&nbsp;%d\n&#34;</span><span class="op" id="6525996">,</span>&nbsp;<span class="ident" id="6525998">l</span><span class="op" id="6525999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6526002">}</span><br>
<span class="lineno">900</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6526006">if</span>&nbsp;<span class="op" id="6526009">!</span><span class="ident" id="6526010">csr</span><span class="op" id="6526013">.</span><span class="ident" id="6526014">Attributes</span><span class="op" id="6526024">[</span><span class="num" id="6526025">0</span><span class="op" id="6526026">]</span><span class="op" id="6526027">.</span><span class="ident" id="6526028">Type</span><span class="op" id="6526032">.</span><span class="ident" id="6526033">Equal</span><span class="op" id="6526038">(</span><span class="ident" id="6526039">oidExtensionRequest</span><span class="op" id="6526058">)</span>&nbsp;<span class="op" id="6526060">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="6526065">len</span><span class="op" id="6526068">(</span><span class="ident" id="6526069">csr</span><span class="op" id="6526072">.</span><span class="ident" id="6526073">Attributes</span><span class="op" id="6526083">[</span><span class="num" id="6526084">0</span><span class="op" id="6526085">]</span><span class="op" id="6526086">.</span><span class="ident" id="6526087">Value</span><span class="op" id="6526092">)</span>&nbsp;<span class="op" id="6526094">!=</span>&nbsp;<span class="num" id="6526097">1</span>&nbsp;<span class="op" id="6526099">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="6526104">len</span><span class="op" id="6526107">(</span><span class="ident" id="6526108">csr</span><span class="op" id="6526111">.</span><span class="ident" id="6526112">Attributes</span><span class="op" id="6526122">[</span><span class="num" id="6526123">0</span><span class="op" id="6526124">]</span><span class="op" id="6526125">.</span><span class="ident" id="6526126">Value</span><span class="op" id="6526131">[</span><span class="num" id="6526132">0</span><span class="op" id="6526133">]</span><span class="op" id="6526134">)</span>&nbsp;<span class="op" id="6526136">!=</span>&nbsp;<span class="num" id="6526139">2</span>&nbsp;<span class="op" id="6526141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6526145">t</span><span class="op" id="6526146">.</span><span class="ident" id="6526147">Errorf</span><span class="op" id="6526153">(</span><span class="string" id="6526154">&#34;bad&nbsp;attributes:&nbsp;%#v\n&#34;</span><span class="op" id="6526177">,</span>&nbsp;<span class="ident" id="6526179">csr</span><span class="op" id="6526182">.</span><span class="ident" id="6526183">Attributes</span><span class="op" id="6526193">)</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6526196">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6526200">sanContents2</span><span class="op" id="6526212">,</span>&nbsp;<span class="ident" id="6526214">err</span>&nbsp;<span class="op" id="6526218">:=</span>&nbsp;<span class="ident" id="6526221">marshalSANs</span><span class="op" id="6526232">(</span><span class="op" id="6526233">[</span><span class="op" id="6526234">]</span><span class="builtintype" id="6526235">string</span><span class="op" id="6526241">{</span><span class="string" id="6526242">&#34;foo2.example.com&#34;</span><span class="op" id="6526260">}</span><span class="op" id="6526261">,</span>&nbsp;<span class="builtintype" id="6526263">nil</span><span class="op" id="6526266">,</span>&nbsp;<span class="builtintype" id="6526268">nil</span><span class="op" id="6526271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6526274">if</span>&nbsp;<span class="ident" id="6526277">err</span>&nbsp;<span class="op" id="6526281">!=</span>&nbsp;<span class="builtintype" id="6526284">nil</span>&nbsp;<span class="op" id="6526288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6526292">t</span><span class="op" id="6526293">.</span><span class="ident" id="6526294">Fatal</span><span class="op" id="6526299">(</span><span class="ident" id="6526300">err</span><span class="op" id="6526303">)</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6526306">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6526310">//&nbsp;Extensions&nbsp;in&nbsp;Attributes&nbsp;should&nbsp;override&nbsp;those&nbsp;in&nbsp;ExtraExtensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6526381">template</span><span class="op" id="6526389">.</span><span class="ident" id="6526390">Attributes</span><span class="op" id="6526400">[</span><span class="num" id="6526401">0</span><span class="op" id="6526402">]</span><span class="op" id="6526403">.</span><span class="ident" id="6526404">Value</span><span class="op" id="6526409">[</span><span class="num" id="6526410">0</span><span class="op" id="6526411">]</span>&nbsp;<span class="op" id="6526413">=</span>&nbsp;<span class="builtinfunc" id="6526415">append</span><span class="op" id="6526421">(</span><span class="ident" id="6526422">template</span><span class="op" id="6526430">.</span><span class="ident" id="6526431">Attributes</span><span class="op" id="6526441">[</span><span class="num" id="6526442">0</span><span class="op" id="6526443">]</span><span class="op" id="6526444">.</span><span class="ident" id="6526445">Value</span><span class="op" id="6526450">[</span><span class="num" id="6526451">0</span><span class="op" id="6526452">]</span><span class="op" id="6526453">,</span>&nbsp;<span class="ident" id="6526455">pkix</span><span class="op" id="6526459">.</span><span class="ident" id="6526460">AttributeTypeAndValue</span><span class="op" id="6526481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6526485">Type</span><span class="op" id="6526489">:</span>&nbsp;&nbsp;<span class="ident" id="6526492">oidExtensionSubjectAltName</span><span class="op" id="6526518">,</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6526522">Value</span><span class="op" id="6526527">:</span>&nbsp;<span class="ident" id="6526529">sanContents2</span><span class="op" id="6526541">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6526544">}</span><span class="op" id="6526545">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6526549">csr</span>&nbsp;<span class="op" id="6526553">=</span>&nbsp;<span class="ident" id="6526555">marshalAndParseCSR</span><span class="op" id="6526573">(</span><span class="ident" id="6526574">t</span><span class="op" id="6526575">,</span>&nbsp;<span class="op" id="6526577">&amp;</span><span class="ident" id="6526578">template</span><span class="op" id="6526586">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6526590">if</span>&nbsp;<span class="builtinfunc" id="6526593">len</span><span class="op" id="6526596">(</span><span class="ident" id="6526597">csr</span><span class="op" id="6526600">.</span><span class="ident" id="6526601">DNSNames</span><span class="op" id="6526609">)</span>&nbsp;<span class="op" id="6526611">!=</span>&nbsp;<span class="num" id="6526614">1</span>&nbsp;<span class="op" id="6526616">||</span>&nbsp;<span class="ident" id="6526619">csr</span><span class="op" id="6526622">.</span><span class="ident" id="6526623">DNSNames</span><span class="op" id="6526631">[</span><span class="num" id="6526632">0</span><span class="op" id="6526633">]</span>&nbsp;<span class="op" id="6526635">!=</span>&nbsp;<span class="string" id="6526638">&#34;foo2.example.com&#34;</span>&nbsp;<span class="op" id="6526657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6526661">t</span><span class="op" id="6526662">.</span><span class="ident" id="6526663">Errorf</span><span class="op" id="6526669">(</span><span class="string" id="6526670">&#34;Attributes&nbsp;did&nbsp;not&nbsp;override&nbsp;ExtraExtensions.&nbsp;Got&nbsp;%v\n&#34;</span><span class="op" id="6526725">,</span>&nbsp;<span class="ident" id="6526727">csr</span><span class="op" id="6526730">.</span><span class="ident" id="6526731">DNSNames</span><span class="op" id="6526739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6526742">}</span><br>
<span class="lineno"></span><span class="op" id="6526744">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">925</span><span class="keyword" id="6526747">func</span>&nbsp;<span class="ident" id="6526752">TestParseCertificateRequest</span><span class="op" id="6526779">(</span><span class="ident" id="6526780">t</span>&nbsp;<span class="op" id="6526782">*</span><span class="ident" id="6526783">testing</span><span class="op" id="6526790">.</span><span class="ident" id="6526791">T</span><span class="op" id="6526792">)</span>&nbsp;<span class="op" id="6526794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6526797">csrBytes</span>&nbsp;<span class="op" id="6526806">:=</span>&nbsp;<span class="ident" id="6526809">fromBase64</span><span class="op" id="6526819">(</span><span class="ident" id="6526820">csrBase64</span><span class="op" id="6526829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6526832">csr</span><span class="op" id="6526835">,</span>&nbsp;<span class="ident" id="6526837">err</span>&nbsp;<span class="op" id="6526841">:=</span>&nbsp;<span class="ident" id="6526844">ParseCertificateRequest</span><span class="op" id="6526867">(</span><span class="ident" id="6526868">csrBytes</span><span class="op" id="6526876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6526879">if</span>&nbsp;<span class="ident" id="6526882">err</span>&nbsp;<span class="op" id="6526886">!=</span>&nbsp;<span class="builtintype" id="6526889">nil</span>&nbsp;<span class="op" id="6526893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6526897">t</span><span class="op" id="6526898">.</span><span class="ident" id="6526899">Fatalf</span><span class="op" id="6526905">(</span><span class="string" id="6526906">&#34;failed&nbsp;to&nbsp;parse&nbsp;CSR:&nbsp;%s&#34;</span><span class="op" id="6526931">,</span>&nbsp;<span class="ident" id="6526933">err</span><span class="op" id="6526936">)</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6526939">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6526943">if</span>&nbsp;<span class="builtinfunc" id="6526946">len</span><span class="op" id="6526949">(</span><span class="ident" id="6526950">csr</span><span class="op" id="6526953">.</span><span class="ident" id="6526954">EmailAddresses</span><span class="op" id="6526968">)</span>&nbsp;<span class="op" id="6526970">!=</span>&nbsp;<span class="num" id="6526973">1</span>&nbsp;<span class="op" id="6526975">||</span>&nbsp;<span class="ident" id="6526978">csr</span><span class="op" id="6526981">.</span><span class="ident" id="6526982">EmailAddresses</span><span class="op" id="6526996">[</span><span class="num" id="6526997">0</span><span class="op" id="6526998">]</span>&nbsp;<span class="op" id="6527000">!=</span>&nbsp;<span class="string" id="6527003">&#34;gopher@golang.org&#34;</span>&nbsp;<span class="op" id="6527023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6527027">t</span><span class="op" id="6527028">.</span><span class="ident" id="6527029">Errorf</span><span class="op" id="6527035">(</span><span class="string" id="6527036">&#34;incorrect&nbsp;email&nbsp;addresses&nbsp;found:&nbsp;%v&#34;</span><span class="op" id="6527073">,</span>&nbsp;<span class="ident" id="6527075">csr</span><span class="op" id="6527078">.</span><span class="ident" id="6527079">EmailAddresses</span><span class="op" id="6527093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6527096">}</span><br>
<span class="lineno">935</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6527100">if</span>&nbsp;<span class="builtinfunc" id="6527103">len</span><span class="op" id="6527106">(</span><span class="ident" id="6527107">csr</span><span class="op" id="6527110">.</span><span class="ident" id="6527111">DNSNames</span><span class="op" id="6527119">)</span>&nbsp;<span class="op" id="6527121">!=</span>&nbsp;<span class="num" id="6527124">1</span>&nbsp;<span class="op" id="6527126">||</span>&nbsp;<span class="ident" id="6527129">csr</span><span class="op" id="6527132">.</span><span class="ident" id="6527133">DNSNames</span><span class="op" id="6527141">[</span><span class="num" id="6527142">0</span><span class="op" id="6527143">]</span>&nbsp;<span class="op" id="6527145">!=</span>&nbsp;<span class="string" id="6527148">&#34;test.example.com&#34;</span>&nbsp;<span class="op" id="6527167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6527171">t</span><span class="op" id="6527172">.</span><span class="ident" id="6527173">Errorf</span><span class="op" id="6527179">(</span><span class="string" id="6527180">&#34;incorrect&nbsp;DNS&nbsp;names&nbsp;found:&nbsp;%v&#34;</span><span class="op" id="6527211">,</span>&nbsp;<span class="ident" id="6527213">csr</span><span class="op" id="6527216">.</span><span class="ident" id="6527217">DNSNames</span><span class="op" id="6527225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6527228">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6527232">if</span>&nbsp;<span class="builtinfunc" id="6527235">len</span><span class="op" id="6527238">(</span><span class="ident" id="6527239">csr</span><span class="op" id="6527242">.</span><span class="ident" id="6527243">Subject</span><span class="op" id="6527250">.</span><span class="ident" id="6527251">Country</span><span class="op" id="6527258">)</span>&nbsp;<span class="op" id="6527260">!=</span>&nbsp;<span class="num" id="6527263">1</span>&nbsp;<span class="op" id="6527265">||</span>&nbsp;<span class="ident" id="6527268">csr</span><span class="op" id="6527271">.</span><span class="ident" id="6527272">Subject</span><span class="op" id="6527279">.</span><span class="ident" id="6527280">Country</span><span class="op" id="6527287">[</span><span class="num" id="6527288">0</span><span class="op" id="6527289">]</span>&nbsp;<span class="op" id="6527291">!=</span>&nbsp;<span class="string" id="6527294">&#34;AU&#34;</span>&nbsp;<span class="op" id="6527299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6527303">t</span><span class="op" id="6527304">.</span><span class="ident" id="6527305">Errorf</span><span class="op" id="6527311">(</span><span class="string" id="6527312">&#34;incorrect&nbsp;Subject&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="6527340">,</span>&nbsp;<span class="ident" id="6527342">csr</span><span class="op" id="6527345">.</span><span class="ident" id="6527346">Subject</span><span class="op" id="6527353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6527356">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6527360">found</span>&nbsp;<span class="op" id="6527366">:=</span>&nbsp;<span class="builtintype" id="6527369">false</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6527376">for</span>&nbsp;<span class="ident" id="6527380">_</span><span class="op" id="6527381">,</span>&nbsp;<span class="ident" id="6527383">e</span>&nbsp;<span class="op" id="6527385">:=</span>&nbsp;<span class="keyword" id="6527388">range</span>&nbsp;<span class="ident" id="6527394">csr</span><span class="op" id="6527397">.</span><span class="ident" id="6527398">Extensions</span>&nbsp;<span class="op" id="6527409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6527413">if</span>&nbsp;<span class="ident" id="6527416">e</span><span class="op" id="6527417">.</span><span class="ident" id="6527418">Id</span><span class="op" id="6527420">.</span><span class="ident" id="6527421">Equal</span><span class="op" id="6527426">(</span><span class="ident" id="6527427">oidExtensionBasicConstraints</span><span class="op" id="6527455">)</span>&nbsp;<span class="op" id="6527457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6527462">found</span>&nbsp;<span class="op" id="6527468">=</span>&nbsp;<span class="builtintype" id="6527470">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6527478">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6527486">}</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6527489">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6527492">if</span>&nbsp;<span class="op" id="6527495">!</span><span class="ident" id="6527496">found</span>&nbsp;<span class="op" id="6527502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6527506">t</span><span class="op" id="6527507">.</span><span class="ident" id="6527508">Errorf</span><span class="op" id="6527514">(</span><span class="string" id="6527515">&#34;basic&nbsp;constraints&nbsp;extension&nbsp;not&nbsp;found&nbsp;in&nbsp;CSR&#34;</span><span class="op" id="6527561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6527564">}</span><br>
<span class="lineno"></span><span class="op" id="6527566">}</span><br>
<span class="lineno">955</span><br>
<span class="lineno"></span><span class="keyword" id="6527569">func</span>&nbsp;<span class="ident" id="6527574">TestMaxPathLen</span><span class="op" id="6527588">(</span><span class="ident" id="6527589">t</span>&nbsp;<span class="op" id="6527591">*</span><span class="ident" id="6527592">testing</span><span class="op" id="6527599">.</span><span class="ident" id="6527600">T</span><span class="op" id="6527601">)</span>&nbsp;<span class="op" id="6527603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6527606">block</span><span class="op" id="6527611">,</span>&nbsp;<span class="ident" id="6527613">_</span>&nbsp;<span class="op" id="6527615">:=</span>&nbsp;<span class="ident" id="6527618">pem</span><span class="op" id="6527621">.</span><span class="ident" id="6527622">Decode</span><span class="op" id="6527628">(</span><span class="op" id="6527629">[</span><span class="op" id="6527630">]</span><span class="builtintype" id="6527631">byte</span><span class="op" id="6527635">(</span><span class="ident" id="6527636">pemPrivateKey</span><span class="op" id="6527649">)</span><span class="op" id="6527650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6527653">rsaPriv</span><span class="op" id="6527660">,</span>&nbsp;<span class="ident" id="6527662">err</span>&nbsp;<span class="op" id="6527666">:=</span>&nbsp;<span class="ident" id="6527669">ParsePKCS1PrivateKey</span><span class="op" id="6527689">(</span><span class="ident" id="6527690">block</span><span class="op" id="6527695">.</span><span class="ident" id="6527696">Bytes</span><span class="op" id="6527701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6527704">if</span>&nbsp;<span class="ident" id="6527707">err</span>&nbsp;<span class="op" id="6527711">!=</span>&nbsp;<span class="builtintype" id="6527714">nil</span>&nbsp;<span class="op" id="6527718">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6527722">t</span><span class="op" id="6527723">.</span><span class="ident" id="6527724">Fatalf</span><span class="op" id="6527730">(</span><span class="string" id="6527731">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="6527764">,</span>&nbsp;<span class="ident" id="6527766">err</span><span class="op" id="6527769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6527772">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6527776">template</span>&nbsp;<span class="op" id="6527785">:=</span>&nbsp;<span class="op" id="6527788">&amp;</span><span class="ident" id="6527789">Certificate</span><span class="op" id="6527800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6527804">SerialNumber</span><span class="op" id="6527816">:</span>&nbsp;<span class="ident" id="6527818">big</span><span class="op" id="6527821">.</span><span class="ident" id="6527822">NewInt</span><span class="op" id="6527828">(</span><span class="num" id="6527829">1</span><span class="op" id="6527830">)</span><span class="op" id="6527831">,</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6527835">Subject</span><span class="op" id="6527842">:</span>&nbsp;<span class="ident" id="6527844">pkix</span><span class="op" id="6527848">.</span><span class="ident" id="6527849">Name</span><span class="op" id="6527853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6527858">CommonName</span><span class="op" id="6527868">:</span>&nbsp;<span class="string" id="6527870">&#34;Σ&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="6527882">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6527886">}</span><span class="op" id="6527887">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6527891">NotBefore</span><span class="op" id="6527900">:</span>&nbsp;<span class="ident" id="6527902">time</span><span class="op" id="6527906">.</span><span class="ident" id="6527907">Unix</span><span class="op" id="6527911">(</span><span class="num" id="6527912">1000</span><span class="op" id="6527916">,</span>&nbsp;<span class="num" id="6527918">0</span><span class="op" id="6527919">)</span><span class="op" id="6527920">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6527924">NotAfter</span><span class="op" id="6527932">:</span>&nbsp;&nbsp;<span class="ident" id="6527935">time</span><span class="op" id="6527939">.</span><span class="ident" id="6527940">Unix</span><span class="op" id="6527944">(</span><span class="num" id="6527945">100000</span><span class="op" id="6527951">,</span>&nbsp;<span class="num" id="6527953">0</span><span class="op" id="6527954">)</span><span class="op" id="6527955">,</span><br>
<span class="lineno">970</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6527960">BasicConstraintsValid</span><span class="op" id="6527981">:</span>&nbsp;<span class="builtintype" id="6527983">true</span><span class="op" id="6527987">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6527991">IsCA</span><span class="op" id="6527995">:</span>&nbsp;<span class="builtintype" id="6527997">true</span><span class="op" id="6528001">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6528004">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6528008">serialiseAndParse</span>&nbsp;<span class="op" id="6528026">:=</span>&nbsp;<span class="keyword" id="6528029">func</span><span class="op" id="6528033">(</span><span class="ident" id="6528034">template</span>&nbsp;<span class="op" id="6528043">*</span><span class="ident" id="6528044">Certificate</span><span class="op" id="6528055">)</span>&nbsp;<span class="op" id="6528057">*</span><span class="ident" id="6528058">Certificate</span>&nbsp;<span class="op" id="6528070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6528074">derBytes</span><span class="op" id="6528082">,</span>&nbsp;<span class="ident" id="6528084">err</span>&nbsp;<span class="op" id="6528088">:=</span>&nbsp;<span class="ident" id="6528091">CreateCertificate</span><span class="op" id="6528108">(</span><span class="ident" id="6528109">rand</span><span class="op" id="6528113">.</span><span class="ident" id="6528114">Reader</span><span class="op" id="6528120">,</span>&nbsp;<span class="ident" id="6528122">template</span><span class="op" id="6528130">,</span>&nbsp;<span class="ident" id="6528132">template</span><span class="op" id="6528140">,</span>&nbsp;<span class="op" id="6528142">&amp;</span><span class="ident" id="6528143">rsaPriv</span><span class="op" id="6528150">.</span><span class="ident" id="6528151">PublicKey</span><span class="op" id="6528160">,</span>&nbsp;<span class="ident" id="6528162">rsaPriv</span><span class="op" id="6528169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6528173">if</span>&nbsp;<span class="ident" id="6528176">err</span>&nbsp;<span class="op" id="6528180">!=</span>&nbsp;<span class="builtintype" id="6528183">nil</span>&nbsp;<span class="op" id="6528187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6528192">t</span><span class="op" id="6528193">.</span><span class="ident" id="6528194">Fatalf</span><span class="op" id="6528200">(</span><span class="string" id="6528201">&#34;failed&nbsp;to&nbsp;create&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="6528235">,</span>&nbsp;<span class="ident" id="6528237">err</span><span class="op" id="6528240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6528245">return</span>&nbsp;<span class="builtintype" id="6528252">nil</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6528258">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6528263">cert</span><span class="op" id="6528267">,</span>&nbsp;<span class="ident" id="6528269">err</span>&nbsp;<span class="op" id="6528273">:=</span>&nbsp;<span class="ident" id="6528276">ParseCertificate</span><span class="op" id="6528292">(</span><span class="ident" id="6528293">derBytes</span><span class="op" id="6528301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6528305">if</span>&nbsp;<span class="ident" id="6528308">err</span>&nbsp;<span class="op" id="6528312">!=</span>&nbsp;<span class="builtintype" id="6528315">nil</span>&nbsp;<span class="op" id="6528319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6528324">t</span><span class="op" id="6528325">.</span><span class="ident" id="6528326">Fatalf</span><span class="op" id="6528332">(</span><span class="string" id="6528333">&#34;failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="6528366">,</span>&nbsp;<span class="ident" id="6528368">err</span><span class="op" id="6528371">)</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6528376">return</span>&nbsp;<span class="builtintype" id="6528383">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6528389">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6528394">return</span>&nbsp;<span class="ident" id="6528401">cert</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6528407">}</span><br>
<span class="lineno">990</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6528411">cert1</span>&nbsp;<span class="op" id="6528417">:=</span>&nbsp;<span class="ident" id="6528420">serialiseAndParse</span><span class="op" id="6528437">(</span><span class="ident" id="6528438">template</span><span class="op" id="6528446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6528449">if</span>&nbsp;<span class="ident" id="6528452">m</span>&nbsp;<span class="op" id="6528454">:=</span>&nbsp;<span class="ident" id="6528457">cert1</span><span class="op" id="6528462">.</span><span class="ident" id="6528463">MaxPathLen</span><span class="op" id="6528473">;</span>&nbsp;<span class="ident" id="6528475">m</span>&nbsp;<span class="op" id="6528477">!=</span>&nbsp;<span class="op" id="6528480">-</span><span class="num" id="6528481">1</span>&nbsp;<span class="op" id="6528483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6528487">t</span><span class="op" id="6528488">.</span><span class="ident" id="6528489">Errorf</span><span class="op" id="6528495">(</span><span class="string" id="6528496">&#34;Omitting&nbsp;MaxPathLen&nbsp;didn&#39;t&nbsp;turn&nbsp;into&nbsp;-1,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="6528545">,</span>&nbsp;<span class="ident" id="6528547">m</span><span class="op" id="6528548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6528551">}</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6528554">if</span>&nbsp;<span class="ident" id="6528557">cert1</span><span class="op" id="6528562">.</span><span class="ident" id="6528563">MaxPathLenZero</span>&nbsp;<span class="op" id="6528578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6528582">t</span><span class="op" id="6528583">.</span><span class="ident" id="6528584">Errorf</span><span class="op" id="6528590">(</span><span class="string" id="6528591">&#34;Omitting&nbsp;MaxPathLen&nbsp;resulted&nbsp;in&nbsp;MaxPathLenZero&#34;</span><span class="op" id="6528639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6528642">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6528646">template</span><span class="op" id="6528654">.</span><span class="ident" id="6528655">MaxPathLen</span>&nbsp;<span class="op" id="6528666">=</span>&nbsp;<span class="num" id="6528668">1</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6528671">cert2</span>&nbsp;<span class="op" id="6528677">:=</span>&nbsp;<span class="ident" id="6528680">serialiseAndParse</span><span class="op" id="6528697">(</span><span class="ident" id="6528698">template</span><span class="op" id="6528706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6528709">if</span>&nbsp;<span class="ident" id="6528712">m</span>&nbsp;<span class="op" id="6528714">:=</span>&nbsp;<span class="ident" id="6528717">cert2</span><span class="op" id="6528722">.</span><span class="ident" id="6528723">MaxPathLen</span><span class="op" id="6528733">;</span>&nbsp;<span class="ident" id="6528735">m</span>&nbsp;<span class="op" id="6528737">!=</span>&nbsp;<span class="num" id="6528740">1</span>&nbsp;<span class="op" id="6528742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6528746">t</span><span class="op" id="6528747">.</span><span class="ident" id="6528748">Errorf</span><span class="op" id="6528754">(</span><span class="string" id="6528755">&#34;Setting&nbsp;MaxPathLen&nbsp;didn&#39;t&nbsp;work.&nbsp;Got&nbsp;%d&nbsp;but&nbsp;set&nbsp;1&#34;</span><span class="op" id="6528805">,</span>&nbsp;<span class="ident" id="6528807">m</span><span class="op" id="6528808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6528811">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6528814">if</span>&nbsp;<span class="ident" id="6528817">cert2</span><span class="op" id="6528822">.</span><span class="ident" id="6528823">MaxPathLenZero</span>&nbsp;<span class="op" id="6528838">{</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6528842">t</span><span class="op" id="6528843">.</span><span class="ident" id="6528844">Errorf</span><span class="op" id="6528850">(</span><span class="string" id="6528851">&#34;Setting&nbsp;MaxPathLen&nbsp;resulted&nbsp;in&nbsp;MaxPathLenZero&#34;</span><span class="op" id="6528898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6528901">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6528905">template</span><span class="op" id="6528913">.</span><span class="ident" id="6528914">MaxPathLen</span>&nbsp;<span class="op" id="6528925">=</span>&nbsp;<span class="num" id="6528927">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6528930">template</span><span class="op" id="6528938">.</span><span class="ident" id="6528939">MaxPathLenZero</span>&nbsp;<span class="op" id="6528954">=</span>&nbsp;<span class="builtintype" id="6528956">true</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6528962">cert3</span>&nbsp;<span class="op" id="6528968">:=</span>&nbsp;<span class="ident" id="6528971">serialiseAndParse</span><span class="op" id="6528988">(</span><span class="ident" id="6528989">template</span><span class="op" id="6528997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6529000">if</span>&nbsp;<span class="ident" id="6529003">m</span>&nbsp;<span class="op" id="6529005">:=</span>&nbsp;<span class="ident" id="6529008">cert3</span><span class="op" id="6529013">.</span><span class="ident" id="6529014">MaxPathLen</span><span class="op" id="6529024">;</span>&nbsp;<span class="ident" id="6529026">m</span>&nbsp;<span class="op" id="6529028">!=</span>&nbsp;<span class="num" id="6529031">0</span>&nbsp;<span class="op" id="6529033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6529037">t</span><span class="op" id="6529038">.</span><span class="ident" id="6529039">Errorf</span><span class="op" id="6529045">(</span><span class="string" id="6529046">&#34;Setting&nbsp;MaxPathLenZero&nbsp;didn&#39;t&nbsp;work,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="6529090">,</span>&nbsp;<span class="ident" id="6529092">m</span><span class="op" id="6529093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6529096">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6529099">if</span>&nbsp;<span class="op" id="6529102">!</span><span class="ident" id="6529103">cert3</span><span class="op" id="6529108">.</span><span class="ident" id="6529109">MaxPathLenZero</span>&nbsp;<span class="op" id="6529124">{</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6529128">t</span><span class="op" id="6529129">.</span><span class="ident" id="6529130">Errorf</span><span class="op" id="6529136">(</span><span class="string" id="6529137">&#34;Setting&nbsp;MaxPathLen&nbsp;to&nbsp;zero&nbsp;didn&#39;t&nbsp;result&nbsp;in&nbsp;MaxPathLenZero&#34;</span><span class="op" id="6529197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6529200">}</span><br>
<span class="lineno"></span><span class="op" id="6529202">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6529205">//&nbsp;This&nbsp;CSR&nbsp;was&nbsp;generated&nbsp;with&nbsp;OpenSSL:</span><br>
<span class="lineno">1020</span><span class="comment" id="6529245">//&nbsp;&nbsp;openssl&nbsp;req&nbsp;-out&nbsp;CSR.csr&nbsp;-new&nbsp;-newkey&nbsp;rsa:2048&nbsp;-nodes&nbsp;-keyout&nbsp;privateKey.key&nbsp;-config&nbsp;openssl.cnf</span><br>
<span class="lineno"></span><span class="comment" id="6529346">//</span><br>
<span class="lineno"></span><span class="comment" id="6529349">//&nbsp;The&nbsp;openssl.cnf&nbsp;needs&nbsp;to&nbsp;include&nbsp;this&nbsp;section:</span><br>
<span class="lineno"></span><span class="comment" id="6529399">//&nbsp;&nbsp;&nbsp;[&nbsp;v3_req&nbsp;]</span><br>
<span class="lineno"></span><span class="comment" id="6529415">//&nbsp;&nbsp;&nbsp;basicConstraints&nbsp;=&nbsp;CA:FALSE</span><br>
<span class="lineno">1025</span><span class="comment" id="6529448">//&nbsp;&nbsp;&nbsp;keyUsage&nbsp;=&nbsp;nonRepudiation,&nbsp;digitalSignature,&nbsp;keyEncipherment</span><br>
<span class="lineno"></span><span class="comment" id="6529514">//&nbsp;&nbsp;&nbsp;subjectAltName&nbsp;=&nbsp;email:gopher@golang.org,DNS:test.example.com</span><br>
<span class="lineno"></span><span class="keyword" id="6529581">const</span>&nbsp;<span class="ident" id="6529587">csrBase64</span>&nbsp;<span class="op" id="6529597">=</span>&nbsp;<span class="string" id="6529599">&#34;MIIC4zCCAcsCAQAwRTELMAkGA1UEBhMCQVUxEzARBgNVBAgMClNvbWUtU3RhdGUxITAfBgNVBAoMGEludGVybmV0IFdpZGdpdHMgUHR5IEx0ZDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAOY+MVedRg2JEnyeLcSzcsMv2VcsTfkB5+Etd6hihAh6MrGezNyASMMKuQN6YhCX1icQDiQtGsDLTtheNnSXK06tAhHjAP/hGlszRJp+5+rP2M58fDBAkUBEhskbCUWwpY14jFtVuGNJ8vF8h8IeczdolvQhX9lVai9G0EUXJMliMKdjA899H0mRs9PzHyidyrXFNiZlQXfD8Kg7gETn2Ny965iyI6ujAIYSCvam6TnxRHYH2MBKyVGvsYGbPYUQJCsgdgyajEg6ekihvQY3SzO1HSAlZAd7d1QYO4VeWJ2mY6Wu3Jpmh+AmG19S9CcHqGjd0bhuAX9cpPOKgnEmqn0CAwEAAaBZMFcGCSqGSIb3DQEJDjFKMEgwCQYDVR0TBAIwADALBgNVHQ8EBAMCBeAwLgYDVR0RBCcwJYERZ29waGVyQGdvbGFuZy5vcmeCEHRlc3QuZXhhbXBsZS5jb20wDQYJKoZIhvcNAQEFBQADggEBAC9+QpKfdabxwCWwf4IEe1cKjdXLS1ScSuw27a3kZzQiPV78WJMa6dB8dqhdH5BRwGZ/qsgLrO6ZHlNeIv2Ib41Ccq71ecHW/nXc94A1BzJ/bVdI9LZcmTUvR1/m1jCpN7UqQ0ml1u9VihK7Pe762hEYxuWDQzYEU0l15S/bXmqeq3eF1A59XT/2jwe5+NV0Wwf4UQlkTXsAQMsJ+KzrQafd8Qv2A49o048uRvmjeJDrXLawGVianZ7D5A6Fpd1rZh6XcjqBpmgLw41DRQWENOdzhy+HyphKRv1MlY8OLkNqpGMhu8DdgJVGoT16DGiickoEa7Z3UCPVNgdTkT9jq7U=&#34;</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
