<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/base64</h2>
<ul>
<li><a href="/gostd/encoding/base64/base64.go.html">base64.go</a></li>
<li><a href="/gostd/encoding/base64/base64_test.go.html" class="current">base64_test.go</a></li>
<li><a href="/gostd/encoding/base64/example_test.go.html">example_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7904248">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7904303">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7904357">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7904408">package</span>&nbsp;<span class="ident" id="7904416">base64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7904424">import</span>&nbsp;<span class="op" id="7904431">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7904434">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7904443">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7904453">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7904459">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7904472">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7904483">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7904494">&#34;testing&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7904505">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="7904512">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7904515">type</span>&nbsp;<span class="ident" id="7904520">testpair</span>&nbsp;<span class="keyword" id="7904529">struct</span>&nbsp;<span class="op" id="7904536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7904539">decoded</span><span class="op" id="7904546">,</span>&nbsp;<span class="ident" id="7904548">encoded</span>&nbsp;<span class="builtintype" id="7904556">string</span><br>
<span class="lineno">20</span><span class="op" id="7904563">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7904566">var</span>&nbsp;<span class="ident" id="7904570">pairs</span>&nbsp;<span class="op" id="7904576">=</span>&nbsp;<span class="op" id="7904578">[</span><span class="op" id="7904579">]</span><span class="ident" id="7904580">testpair</span><span class="op" id="7904588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7904591">//&nbsp;RFC&nbsp;3548&nbsp;examples</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7904613">{</span><span class="string" id="7904614">&#34;\x14\xfb\x9c\x03\xd9\x7e&#34;</span><span class="op" id="7904640">,</span>&nbsp;<span class="string" id="7904642">&#34;FPucA9l+&#34;</span><span class="op" id="7904652">}</span><span class="op" id="7904653">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7904656">{</span><span class="string" id="7904657">&#34;\x14\xfb\x9c\x03\xd9&#34;</span><span class="op" id="7904679">,</span>&nbsp;<span class="string" id="7904681">&#34;FPucA9k=&#34;</span><span class="op" id="7904691">}</span><span class="op" id="7904692">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7904695">{</span><span class="string" id="7904696">&#34;\x14\xfb\x9c\x03&#34;</span><span class="op" id="7904714">,</span>&nbsp;<span class="string" id="7904716">&#34;FPucAw==&#34;</span><span class="op" id="7904726">}</span><span class="op" id="7904727">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7904731">//&nbsp;RFC&nbsp;4648&nbsp;examples</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7904753">{</span><span class="string" id="7904754">&#34;&#34;</span><span class="op" id="7904756">,</span>&nbsp;<span class="string" id="7904758">&#34;&#34;</span><span class="op" id="7904760">}</span><span class="op" id="7904761">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7904764">{</span><span class="string" id="7904765">&#34;f&#34;</span><span class="op" id="7904768">,</span>&nbsp;<span class="string" id="7904770">&#34;Zg==&#34;</span><span class="op" id="7904776">}</span><span class="op" id="7904777">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7904780">{</span><span class="string" id="7904781">&#34;fo&#34;</span><span class="op" id="7904785">,</span>&nbsp;<span class="string" id="7904787">&#34;Zm8=&#34;</span><span class="op" id="7904793">}</span><span class="op" id="7904794">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7904797">{</span><span class="string" id="7904798">&#34;foo&#34;</span><span class="op" id="7904803">,</span>&nbsp;<span class="string" id="7904805">&#34;Zm9v&#34;</span><span class="op" id="7904811">}</span><span class="op" id="7904812">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7904815">{</span><span class="string" id="7904816">&#34;foob&#34;</span><span class="op" id="7904822">,</span>&nbsp;<span class="string" id="7904824">&#34;Zm9vYg==&#34;</span><span class="op" id="7904834">}</span><span class="op" id="7904835">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7904838">{</span><span class="string" id="7904839">&#34;fooba&#34;</span><span class="op" id="7904846">,</span>&nbsp;<span class="string" id="7904848">&#34;Zm9vYmE=&#34;</span><span class="op" id="7904858">}</span><span class="op" id="7904859">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7904862">{</span><span class="string" id="7904863">&#34;foobar&#34;</span><span class="op" id="7904871">,</span>&nbsp;<span class="string" id="7904873">&#34;Zm9vYmFy&#34;</span><span class="op" id="7904883">}</span><span class="op" id="7904884">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7904888">//&nbsp;Wikipedia&nbsp;examples</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7904911">{</span><span class="string" id="7904912">&#34;sure.&#34;</span><span class="op" id="7904919">,</span>&nbsp;<span class="string" id="7904921">&#34;c3VyZS4=&#34;</span><span class="op" id="7904931">}</span><span class="op" id="7904932">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7904935">{</span><span class="string" id="7904936">&#34;sure&#34;</span><span class="op" id="7904942">,</span>&nbsp;<span class="string" id="7904944">&#34;c3VyZQ==&#34;</span><span class="op" id="7904954">}</span><span class="op" id="7904955">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7904958">{</span><span class="string" id="7904959">&#34;sur&#34;</span><span class="op" id="7904964">,</span>&nbsp;<span class="string" id="7904966">&#34;c3Vy&#34;</span><span class="op" id="7904972">}</span><span class="op" id="7904973">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7904976">{</span><span class="string" id="7904977">&#34;su&#34;</span><span class="op" id="7904981">,</span>&nbsp;<span class="string" id="7904983">&#34;c3U=&#34;</span><span class="op" id="7904989">}</span><span class="op" id="7904990">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7904993">{</span><span class="string" id="7904994">&#34;leasure.&#34;</span><span class="op" id="7905004">,</span>&nbsp;<span class="string" id="7905006">&#34;bGVhc3VyZS4=&#34;</span><span class="op" id="7905020">}</span><span class="op" id="7905021">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7905024">{</span><span class="string" id="7905025">&#34;easure.&#34;</span><span class="op" id="7905034">,</span>&nbsp;<span class="string" id="7905036">&#34;ZWFzdXJlLg==&#34;</span><span class="op" id="7905050">}</span><span class="op" id="7905051">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7905054">{</span><span class="string" id="7905055">&#34;asure.&#34;</span><span class="op" id="7905063">,</span>&nbsp;<span class="string" id="7905065">&#34;YXN1cmUu&#34;</span><span class="op" id="7905075">}</span><span class="op" id="7905076">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7905079">{</span><span class="string" id="7905080">&#34;sure.&#34;</span><span class="op" id="7905087">,</span>&nbsp;<span class="string" id="7905089">&#34;c3VyZS4=&#34;</span><span class="op" id="7905099">}</span><span class="op" id="7905100">,</span><br>
<span class="lineno"></span><span class="op" id="7905102">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7905105">var</span>&nbsp;<span class="ident" id="7905109">bigtest</span>&nbsp;<span class="op" id="7905117">=</span>&nbsp;<span class="ident" id="7905119">testpair</span><span class="op" id="7905127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7905130">&#34;Twas&nbsp;brillig,&nbsp;and&nbsp;the&nbsp;slithy&nbsp;toves&#34;</span><span class="op" id="7905166">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7905169">&#34;VHdhcyBicmlsbGlnLCBhbmQgdGhlIHNsaXRoeSB0b3Zlcw==&#34;</span><span class="op" id="7905219">,</span><br>
<span class="lineno"></span><span class="op" id="7905221">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7905224">func</span>&nbsp;<span class="ident" id="7905229">testEqual</span><span class="op" id="7905238">(</span><span class="ident" id="7905239">t</span>&nbsp;<span class="op" id="7905241">*</span><span class="ident" id="7905242">testing</span><span class="op" id="7905249">.</span><span class="ident" id="7905250">T</span><span class="op" id="7905251">,</span>&nbsp;<span class="ident" id="7905253">msg</span>&nbsp;<span class="builtintype" id="7905257">string</span><span class="op" id="7905263">,</span>&nbsp;<span class="ident" id="7905265">args</span>&nbsp;<span class="op" id="7905270">...</span><span class="keyword" id="7905273">interface</span><span class="op" id="7905282">{</span><span class="op" id="7905283">}</span><span class="op" id="7905284">)</span>&nbsp;<span class="builtintype" id="7905286">bool</span>&nbsp;<span class="op" id="7905291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7905294">if</span>&nbsp;<span class="ident" id="7905297">args</span><span class="op" id="7905301">[</span><span class="builtinfunc" id="7905302">len</span><span class="op" id="7905305">(</span><span class="ident" id="7905306">args</span><span class="op" id="7905310">)</span><span class="op" id="7905311">-</span><span class="num" id="7905312">2</span><span class="op" id="7905313">]</span>&nbsp;<span class="op" id="7905315">!=</span>&nbsp;<span class="ident" id="7905318">args</span><span class="op" id="7905322">[</span><span class="builtinfunc" id="7905323">len</span><span class="op" id="7905326">(</span><span class="ident" id="7905327">args</span><span class="op" id="7905331">)</span><span class="op" id="7905332">-</span><span class="num" id="7905333">1</span><span class="op" id="7905334">]</span>&nbsp;<span class="op" id="7905336">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7905340">t</span><span class="op" id="7905341">.</span><span class="ident" id="7905342">Errorf</span><span class="op" id="7905348">(</span><span class="ident" id="7905349">msg</span><span class="op" id="7905352">,</span>&nbsp;<span class="ident" id="7905354">args</span><span class="op" id="7905358">...</span><span class="op" id="7905361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7905365">return</span>&nbsp;<span class="builtintype" id="7905372">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7905379">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7905382">return</span>&nbsp;<span class="builtintype" id="7905389">true</span><br>
<span class="lineno"></span><span class="op" id="7905394">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="7905397">func</span>&nbsp;<span class="ident" id="7905402">TestEncode</span><span class="op" id="7905412">(</span><span class="ident" id="7905413">t</span>&nbsp;<span class="op" id="7905415">*</span><span class="ident" id="7905416">testing</span><span class="op" id="7905423">.</span><span class="ident" id="7905424">T</span><span class="op" id="7905425">)</span>&nbsp;<span class="op" id="7905427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7905430">for</span>&nbsp;<span class="ident" id="7905434">_</span><span class="op" id="7905435">,</span>&nbsp;<span class="ident" id="7905437">p</span>&nbsp;<span class="op" id="7905439">:=</span>&nbsp;<span class="keyword" id="7905442">range</span>&nbsp;<span class="ident" id="7905448">pairs</span>&nbsp;<span class="op" id="7905454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7905458">got</span>&nbsp;<span class="op" id="7905462">:=</span>&nbsp;<span class="ident" id="7905465">StdEncoding</span><span class="op" id="7905476">.</span><span class="ident" id="7905477">EncodeToString</span><span class="op" id="7905491">(</span><span class="op" id="7905492">[</span><span class="op" id="7905493">]</span><span class="builtintype" id="7905494">byte</span><span class="op" id="7905498">(</span><span class="ident" id="7905499">p</span><span class="op" id="7905500">.</span><span class="ident" id="7905501">decoded</span><span class="op" id="7905508">)</span><span class="op" id="7905509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7905513">testEqual</span><span class="op" id="7905522">(</span><span class="ident" id="7905523">t</span><span class="op" id="7905524">,</span>&nbsp;<span class="string" id="7905526">&#34;Encode(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7905552">,</span>&nbsp;<span class="ident" id="7905554">p</span><span class="op" id="7905555">.</span><span class="ident" id="7905556">decoded</span><span class="op" id="7905563">,</span>&nbsp;<span class="ident" id="7905565">got</span><span class="op" id="7905568">,</span>&nbsp;<span class="ident" id="7905570">p</span><span class="op" id="7905571">.</span><span class="ident" id="7905572">encoded</span><span class="op" id="7905579">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7905582">}</span><br>
<span class="lineno"></span><span class="op" id="7905584">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7905587">func</span>&nbsp;<span class="ident" id="7905592">TestEncoder</span><span class="op" id="7905603">(</span><span class="ident" id="7905604">t</span>&nbsp;<span class="op" id="7905606">*</span><span class="ident" id="7905607">testing</span><span class="op" id="7905614">.</span><span class="ident" id="7905615">T</span><span class="op" id="7905616">)</span>&nbsp;<span class="op" id="7905618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7905621">for</span>&nbsp;<span class="ident" id="7905625">_</span><span class="op" id="7905626">,</span>&nbsp;<span class="ident" id="7905628">p</span>&nbsp;<span class="op" id="7905630">:=</span>&nbsp;<span class="keyword" id="7905633">range</span>&nbsp;<span class="ident" id="7905639">pairs</span>&nbsp;<span class="op" id="7905645">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7905649">bb</span>&nbsp;<span class="op" id="7905652">:=</span>&nbsp;<span class="op" id="7905655">&amp;</span><span class="ident" id="7905656">bytes</span><span class="op" id="7905661">.</span><span class="ident" id="7905662">Buffer</span><span class="op" id="7905668">{</span><span class="op" id="7905669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7905673">encoder</span>&nbsp;<span class="op" id="7905681">:=</span>&nbsp;<span class="ident" id="7905684">NewEncoder</span><span class="op" id="7905694">(</span><span class="ident" id="7905695">StdEncoding</span><span class="op" id="7905706">,</span>&nbsp;<span class="ident" id="7905708">bb</span><span class="op" id="7905710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7905714">encoder</span><span class="op" id="7905721">.</span><span class="ident" id="7905722">Write</span><span class="op" id="7905727">(</span><span class="op" id="7905728">[</span><span class="op" id="7905729">]</span><span class="builtintype" id="7905730">byte</span><span class="op" id="7905734">(</span><span class="ident" id="7905735">p</span><span class="op" id="7905736">.</span><span class="ident" id="7905737">decoded</span><span class="op" id="7905744">)</span><span class="op" id="7905745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7905749">encoder</span><span class="op" id="7905756">.</span><span class="ident" id="7905757">Close</span><span class="op" id="7905762">(</span><span class="op" id="7905763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7905767">testEqual</span><span class="op" id="7905776">(</span><span class="ident" id="7905777">t</span><span class="op" id="7905778">,</span>&nbsp;<span class="string" id="7905780">&#34;Encode(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7905806">,</span>&nbsp;<span class="ident" id="7905808">p</span><span class="op" id="7905809">.</span><span class="ident" id="7905810">decoded</span><span class="op" id="7905817">,</span>&nbsp;<span class="ident" id="7905819">bb</span><span class="op" id="7905821">.</span><span class="ident" id="7905822">String</span><span class="op" id="7905828">(</span><span class="op" id="7905829">)</span><span class="op" id="7905830">,</span>&nbsp;<span class="ident" id="7905832">p</span><span class="op" id="7905833">.</span><span class="ident" id="7905834">encoded</span><span class="op" id="7905841">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7905844">}</span><br>
<span class="lineno"></span><span class="op" id="7905846">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7905849">func</span>&nbsp;<span class="ident" id="7905854">TestEncoderBuffering</span><span class="op" id="7905874">(</span><span class="ident" id="7905875">t</span>&nbsp;<span class="op" id="7905877">*</span><span class="ident" id="7905878">testing</span><span class="op" id="7905885">.</span><span class="ident" id="7905886">T</span><span class="op" id="7905887">)</span>&nbsp;<span class="op" id="7905889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7905892">input</span>&nbsp;<span class="op" id="7905898">:=</span>&nbsp;<span class="op" id="7905901">[</span><span class="op" id="7905902">]</span><span class="builtintype" id="7905903">byte</span><span class="op" id="7905907">(</span><span class="ident" id="7905908">bigtest</span><span class="op" id="7905915">.</span><span class="ident" id="7905916">decoded</span><span class="op" id="7905923">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7905926">for</span>&nbsp;<span class="ident" id="7905930">bs</span>&nbsp;<span class="op" id="7905933">:=</span>&nbsp;<span class="num" id="7905936">1</span><span class="op" id="7905937">;</span>&nbsp;<span class="ident" id="7905939">bs</span>&nbsp;<span class="op" id="7905942">&lt;=</span>&nbsp;<span class="num" id="7905945">12</span><span class="op" id="7905947">;</span>&nbsp;<span class="ident" id="7905949">bs</span><span class="op" id="7905951">++</span>&nbsp;<span class="op" id="7905954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7905958">bb</span>&nbsp;<span class="op" id="7905961">:=</span>&nbsp;<span class="op" id="7905964">&amp;</span><span class="ident" id="7905965">bytes</span><span class="op" id="7905970">.</span><span class="ident" id="7905971">Buffer</span><span class="op" id="7905977">{</span><span class="op" id="7905978">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7905982">encoder</span>&nbsp;<span class="op" id="7905990">:=</span>&nbsp;<span class="ident" id="7905993">NewEncoder</span><span class="op" id="7906003">(</span><span class="ident" id="7906004">StdEncoding</span><span class="op" id="7906015">,</span>&nbsp;<span class="ident" id="7906017">bb</span><span class="op" id="7906019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7906023">for</span>&nbsp;<span class="ident" id="7906027">pos</span>&nbsp;<span class="op" id="7906031">:=</span>&nbsp;<span class="num" id="7906034">0</span><span class="op" id="7906035">;</span>&nbsp;<span class="ident" id="7906037">pos</span>&nbsp;<span class="op" id="7906041">&lt;</span>&nbsp;<span class="builtinfunc" id="7906043">len</span><span class="op" id="7906046">(</span><span class="ident" id="7906047">input</span><span class="op" id="7906052">)</span><span class="op" id="7906053">;</span>&nbsp;<span class="ident" id="7906055">pos</span>&nbsp;<span class="op" id="7906059">+=</span>&nbsp;<span class="ident" id="7906062">bs</span>&nbsp;<span class="op" id="7906065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7906070">end</span>&nbsp;<span class="op" id="7906074">:=</span>&nbsp;<span class="ident" id="7906077">pos</span>&nbsp;<span class="op" id="7906081">+</span>&nbsp;<span class="ident" id="7906083">bs</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7906089">if</span>&nbsp;<span class="ident" id="7906092">end</span>&nbsp;<span class="op" id="7906096">&gt;</span>&nbsp;<span class="builtinfunc" id="7906098">len</span><span class="op" id="7906101">(</span><span class="ident" id="7906102">input</span><span class="op" id="7906107">)</span>&nbsp;<span class="op" id="7906109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7906115">end</span>&nbsp;<span class="op" id="7906119">=</span>&nbsp;<span class="builtinfunc" id="7906121">len</span><span class="op" id="7906124">(</span><span class="ident" id="7906125">input</span><span class="op" id="7906130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7906135">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7906140">n</span><span class="op" id="7906141">,</span>&nbsp;<span class="ident" id="7906143">err</span>&nbsp;<span class="op" id="7906147">:=</span>&nbsp;<span class="ident" id="7906150">encoder</span><span class="op" id="7906157">.</span><span class="ident" id="7906158">Write</span><span class="op" id="7906163">(</span><span class="ident" id="7906164">input</span><span class="op" id="7906169">[</span><span class="ident" id="7906170">pos</span><span class="op" id="7906173">:</span><span class="ident" id="7906174">end</span><span class="op" id="7906177">]</span><span class="op" id="7906178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7906183">testEqual</span><span class="op" id="7906192">(</span><span class="ident" id="7906193">t</span><span class="op" id="7906194">,</span>&nbsp;<span class="string" id="7906196">&#34;Write(%q)&nbsp;gave&nbsp;error&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7906230">,</span>&nbsp;<span class="ident" id="7906232">input</span><span class="op" id="7906237">[</span><span class="ident" id="7906238">pos</span><span class="op" id="7906241">:</span><span class="ident" id="7906242">end</span><span class="op" id="7906245">]</span><span class="op" id="7906246">,</span>&nbsp;<span class="ident" id="7906248">err</span><span class="op" id="7906251">,</span>&nbsp;<span class="builtintype" id="7906253">error</span><span class="op" id="7906258">(</span><span class="builtintype" id="7906259">nil</span><span class="op" id="7906262">)</span><span class="op" id="7906263">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7906268">testEqual</span><span class="op" id="7906277">(</span><span class="ident" id="7906278">t</span><span class="op" id="7906279">,</span>&nbsp;<span class="string" id="7906281">&#34;Write(%q)&nbsp;gave&nbsp;length&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7906316">,</span>&nbsp;<span class="ident" id="7906318">input</span><span class="op" id="7906323">[</span><span class="ident" id="7906324">pos</span><span class="op" id="7906327">:</span><span class="ident" id="7906328">end</span><span class="op" id="7906331">]</span><span class="op" id="7906332">,</span>&nbsp;<span class="ident" id="7906334">n</span><span class="op" id="7906335">,</span>&nbsp;<span class="ident" id="7906337">end</span><span class="op" id="7906340">-</span><span class="ident" id="7906341">pos</span><span class="op" id="7906344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7906348">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7906352">err</span>&nbsp;<span class="op" id="7906356">:=</span>&nbsp;<span class="ident" id="7906359">encoder</span><span class="op" id="7906366">.</span><span class="ident" id="7906367">Close</span><span class="op" id="7906372">(</span><span class="op" id="7906373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7906377">testEqual</span><span class="op" id="7906386">(</span><span class="ident" id="7906387">t</span><span class="op" id="7906388">,</span>&nbsp;<span class="string" id="7906390">&#34;Close&nbsp;gave&nbsp;error&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7906420">,</span>&nbsp;<span class="ident" id="7906422">err</span><span class="op" id="7906425">,</span>&nbsp;<span class="builtintype" id="7906427">error</span><span class="op" id="7906432">(</span><span class="builtintype" id="7906433">nil</span><span class="op" id="7906436">)</span><span class="op" id="7906437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7906441">testEqual</span><span class="op" id="7906450">(</span><span class="ident" id="7906451">t</span><span class="op" id="7906452">,</span>&nbsp;<span class="string" id="7906454">&#34;Encoding/%d&nbsp;of&nbsp;%q&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7906487">,</span>&nbsp;<span class="ident" id="7906489">bs</span><span class="op" id="7906491">,</span>&nbsp;<span class="ident" id="7906493">bigtest</span><span class="op" id="7906500">.</span><span class="ident" id="7906501">decoded</span><span class="op" id="7906508">,</span>&nbsp;<span class="ident" id="7906510">bb</span><span class="op" id="7906512">.</span><span class="ident" id="7906513">String</span><span class="op" id="7906519">(</span><span class="op" id="7906520">)</span><span class="op" id="7906521">,</span>&nbsp;<span class="ident" id="7906523">bigtest</span><span class="op" id="7906530">.</span><span class="ident" id="7906531">encoded</span><span class="op" id="7906538">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7906541">}</span><br>
<span class="lineno"></span><span class="op" id="7906543">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7906546">func</span>&nbsp;<span class="ident" id="7906551">TestDecode</span><span class="op" id="7906561">(</span><span class="ident" id="7906562">t</span>&nbsp;<span class="op" id="7906564">*</span><span class="ident" id="7906565">testing</span><span class="op" id="7906572">.</span><span class="ident" id="7906573">T</span><span class="op" id="7906574">)</span>&nbsp;<span class="op" id="7906576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7906579">for</span>&nbsp;<span class="ident" id="7906583">_</span><span class="op" id="7906584">,</span>&nbsp;<span class="ident" id="7906586">p</span>&nbsp;<span class="op" id="7906588">:=</span>&nbsp;<span class="keyword" id="7906591">range</span>&nbsp;<span class="ident" id="7906597">pairs</span>&nbsp;<span class="op" id="7906603">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7906607">dbuf</span>&nbsp;<span class="op" id="7906612">:=</span>&nbsp;<span class="builtinfunc" id="7906615">make</span><span class="op" id="7906619">(</span><span class="op" id="7906620">[</span><span class="op" id="7906621">]</span><span class="builtintype" id="7906622">byte</span><span class="op" id="7906626">,</span>&nbsp;<span class="ident" id="7906628">StdEncoding</span><span class="op" id="7906639">.</span><span class="ident" id="7906640">DecodedLen</span><span class="op" id="7906650">(</span><span class="builtinfunc" id="7906651">len</span><span class="op" id="7906654">(</span><span class="ident" id="7906655">p</span><span class="op" id="7906656">.</span><span class="ident" id="7906657">encoded</span><span class="op" id="7906664">)</span><span class="op" id="7906665">)</span><span class="op" id="7906666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7906670">count</span><span class="op" id="7906675">,</span>&nbsp;<span class="ident" id="7906677">end</span><span class="op" id="7906680">,</span>&nbsp;<span class="ident" id="7906682">err</span>&nbsp;<span class="op" id="7906686">:=</span>&nbsp;<span class="ident" id="7906689">StdEncoding</span><span class="op" id="7906700">.</span><span class="ident" id="7906701">decode</span><span class="op" id="7906707">(</span><span class="ident" id="7906708">dbuf</span><span class="op" id="7906712">,</span>&nbsp;<span class="op" id="7906714">[</span><span class="op" id="7906715">]</span><span class="builtintype" id="7906716">byte</span><span class="op" id="7906720">(</span><span class="ident" id="7906721">p</span><span class="op" id="7906722">.</span><span class="ident" id="7906723">encoded</span><span class="op" id="7906730">)</span><span class="op" id="7906731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7906735">testEqual</span><span class="op" id="7906744">(</span><span class="ident" id="7906745">t</span><span class="op" id="7906746">,</span>&nbsp;<span class="string" id="7906748">&#34;Decode(%q)&nbsp;=&nbsp;error&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7906780">,</span>&nbsp;<span class="ident" id="7906782">p</span><span class="op" id="7906783">.</span><span class="ident" id="7906784">encoded</span><span class="op" id="7906791">,</span>&nbsp;<span class="ident" id="7906793">err</span><span class="op" id="7906796">,</span>&nbsp;<span class="builtintype" id="7906798">error</span><span class="op" id="7906803">(</span><span class="builtintype" id="7906804">nil</span><span class="op" id="7906807">)</span><span class="op" id="7906808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7906812">testEqual</span><span class="op" id="7906821">(</span><span class="ident" id="7906822">t</span><span class="op" id="7906823">,</span>&nbsp;<span class="string" id="7906825">&#34;Decode(%q)&nbsp;=&nbsp;length&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7906858">,</span>&nbsp;<span class="ident" id="7906860">p</span><span class="op" id="7906861">.</span><span class="ident" id="7906862">encoded</span><span class="op" id="7906869">,</span>&nbsp;<span class="ident" id="7906871">count</span><span class="op" id="7906876">,</span>&nbsp;<span class="builtinfunc" id="7906878">len</span><span class="op" id="7906881">(</span><span class="ident" id="7906882">p</span><span class="op" id="7906883">.</span><span class="ident" id="7906884">decoded</span><span class="op" id="7906891">)</span><span class="op" id="7906892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7906896">if</span>&nbsp;<span class="builtinfunc" id="7906899">len</span><span class="op" id="7906902">(</span><span class="ident" id="7906903">p</span><span class="op" id="7906904">.</span><span class="ident" id="7906905">encoded</span><span class="op" id="7906912">)</span>&nbsp;<span class="op" id="7906914">&gt;</span>&nbsp;<span class="num" id="7906916">0</span>&nbsp;<span class="op" id="7906918">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7906923">testEqual</span><span class="op" id="7906932">(</span><span class="ident" id="7906933">t</span><span class="op" id="7906934">,</span>&nbsp;<span class="string" id="7906936">&#34;Decode(%q)&nbsp;=&nbsp;end&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7906966">,</span>&nbsp;<span class="ident" id="7906968">p</span><span class="op" id="7906969">.</span><span class="ident" id="7906970">encoded</span><span class="op" id="7906977">,</span>&nbsp;<span class="ident" id="7906979">end</span><span class="op" id="7906982">,</span>&nbsp;<span class="op" id="7906984">(</span><span class="ident" id="7906985">p</span><span class="op" id="7906986">.</span><span class="ident" id="7906987">encoded</span><span class="op" id="7906994">[</span><span class="builtinfunc" id="7906995">len</span><span class="op" id="7906998">(</span><span class="ident" id="7906999">p</span><span class="op" id="7907000">.</span><span class="ident" id="7907001">encoded</span><span class="op" id="7907008">)</span><span class="op" id="7907009">-</span><span class="num" id="7907010">1</span><span class="op" id="7907011">]</span>&nbsp;<span class="op" id="7907013">==</span>&nbsp;<span class="string" id="7907016">&#39;=&#39;</span><span class="op" id="7907019">)</span><span class="op" id="7907020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7907024">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7907028">testEqual</span><span class="op" id="7907037">(</span><span class="ident" id="7907038">t</span><span class="op" id="7907039">,</span>&nbsp;<span class="string" id="7907041">&#34;Decode(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7907067">,</span>&nbsp;<span class="ident" id="7907069">p</span><span class="op" id="7907070">.</span><span class="ident" id="7907071">encoded</span><span class="op" id="7907078">,</span>&nbsp;<span class="builtintype" id="7907080">string</span><span class="op" id="7907086">(</span><span class="ident" id="7907087">dbuf</span><span class="op" id="7907091">[</span><span class="num" id="7907092">0</span><span class="op" id="7907093">:</span><span class="ident" id="7907094">count</span><span class="op" id="7907099">]</span><span class="op" id="7907100">)</span><span class="op" id="7907101">,</span>&nbsp;<span class="ident" id="7907103">p</span><span class="op" id="7907104">.</span><span class="ident" id="7907105">decoded</span><span class="op" id="7907112">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7907117">dbuf</span><span class="op" id="7907121">,</span>&nbsp;<span class="ident" id="7907123">err</span>&nbsp;<span class="op" id="7907127">=</span>&nbsp;<span class="ident" id="7907129">StdEncoding</span><span class="op" id="7907140">.</span><span class="ident" id="7907141">DecodeString</span><span class="op" id="7907153">(</span><span class="ident" id="7907154">p</span><span class="op" id="7907155">.</span><span class="ident" id="7907156">encoded</span><span class="op" id="7907163">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7907167">testEqual</span><span class="op" id="7907176">(</span><span class="ident" id="7907177">t</span><span class="op" id="7907178">,</span>&nbsp;<span class="string" id="7907180">&#34;DecodeString(%q)&nbsp;=&nbsp;error&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7907218">,</span>&nbsp;<span class="ident" id="7907220">p</span><span class="op" id="7907221">.</span><span class="ident" id="7907222">encoded</span><span class="op" id="7907229">,</span>&nbsp;<span class="ident" id="7907231">err</span><span class="op" id="7907234">,</span>&nbsp;<span class="builtintype" id="7907236">error</span><span class="op" id="7907241">(</span><span class="builtintype" id="7907242">nil</span><span class="op" id="7907245">)</span><span class="op" id="7907246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7907250">testEqual</span><span class="op" id="7907259">(</span><span class="ident" id="7907260">t</span><span class="op" id="7907261">,</span>&nbsp;<span class="string" id="7907263">&#34;DecodeString(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7907295">,</span>&nbsp;<span class="builtintype" id="7907297">string</span><span class="op" id="7907303">(</span><span class="ident" id="7907304">dbuf</span><span class="op" id="7907308">)</span><span class="op" id="7907309">,</span>&nbsp;<span class="ident" id="7907311">p</span><span class="op" id="7907312">.</span><span class="ident" id="7907313">decoded</span><span class="op" id="7907320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7907323">}</span><br>
<span class="lineno"></span><span class="op" id="7907325">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="7907328">func</span>&nbsp;<span class="ident" id="7907333">TestDecoder</span><span class="op" id="7907344">(</span><span class="ident" id="7907345">t</span>&nbsp;<span class="op" id="7907347">*</span><span class="ident" id="7907348">testing</span><span class="op" id="7907355">.</span><span class="ident" id="7907356">T</span><span class="op" id="7907357">)</span>&nbsp;<span class="op" id="7907359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7907362">for</span>&nbsp;<span class="ident" id="7907366">_</span><span class="op" id="7907367">,</span>&nbsp;<span class="ident" id="7907369">p</span>&nbsp;<span class="op" id="7907371">:=</span>&nbsp;<span class="keyword" id="7907374">range</span>&nbsp;<span class="ident" id="7907380">pairs</span>&nbsp;<span class="op" id="7907386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7907390">decoder</span>&nbsp;<span class="op" id="7907398">:=</span>&nbsp;<span class="ident" id="7907401">NewDecoder</span><span class="op" id="7907411">(</span><span class="ident" id="7907412">StdEncoding</span><span class="op" id="7907423">,</span>&nbsp;<span class="ident" id="7907425">strings</span><span class="op" id="7907432">.</span><span class="ident" id="7907433">NewReader</span><span class="op" id="7907442">(</span><span class="ident" id="7907443">p</span><span class="op" id="7907444">.</span><span class="ident" id="7907445">encoded</span><span class="op" id="7907452">)</span><span class="op" id="7907453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7907457">dbuf</span>&nbsp;<span class="op" id="7907462">:=</span>&nbsp;<span class="builtinfunc" id="7907465">make</span><span class="op" id="7907469">(</span><span class="op" id="7907470">[</span><span class="op" id="7907471">]</span><span class="builtintype" id="7907472">byte</span><span class="op" id="7907476">,</span>&nbsp;<span class="ident" id="7907478">StdEncoding</span><span class="op" id="7907489">.</span><span class="ident" id="7907490">DecodedLen</span><span class="op" id="7907500">(</span><span class="builtinfunc" id="7907501">len</span><span class="op" id="7907504">(</span><span class="ident" id="7907505">p</span><span class="op" id="7907506">.</span><span class="ident" id="7907507">encoded</span><span class="op" id="7907514">)</span><span class="op" id="7907515">)</span><span class="op" id="7907516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7907520">count</span><span class="op" id="7907525">,</span>&nbsp;<span class="ident" id="7907527">err</span>&nbsp;<span class="op" id="7907531">:=</span>&nbsp;<span class="ident" id="7907534">decoder</span><span class="op" id="7907541">.</span><span class="ident" id="7907542">Read</span><span class="op" id="7907546">(</span><span class="ident" id="7907547">dbuf</span><span class="op" id="7907551">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7907555">if</span>&nbsp;<span class="ident" id="7907558">err</span>&nbsp;<span class="op" id="7907562">!=</span>&nbsp;<span class="builtintype" id="7907565">nil</span>&nbsp;<span class="op" id="7907569">&amp;&amp;</span>&nbsp;<span class="ident" id="7907572">err</span>&nbsp;<span class="op" id="7907576">!=</span>&nbsp;<span class="ident" id="7907579">io</span><span class="op" id="7907581">.</span><span class="ident" id="7907582">EOF</span>&nbsp;<span class="op" id="7907586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7907591">t</span><span class="op" id="7907592">.</span><span class="ident" id="7907593">Fatal</span><span class="op" id="7907598">(</span><span class="string" id="7907599">&#34;Read&nbsp;failed&#34;</span><span class="op" id="7907612">,</span>&nbsp;<span class="ident" id="7907614">err</span><span class="op" id="7907617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7907621">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7907625">testEqual</span><span class="op" id="7907634">(</span><span class="ident" id="7907635">t</span><span class="op" id="7907636">,</span>&nbsp;<span class="string" id="7907638">&#34;Read&nbsp;from&nbsp;%q&nbsp;=&nbsp;length&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7907673">,</span>&nbsp;<span class="ident" id="7907675">p</span><span class="op" id="7907676">.</span><span class="ident" id="7907677">encoded</span><span class="op" id="7907684">,</span>&nbsp;<span class="ident" id="7907686">count</span><span class="op" id="7907691">,</span>&nbsp;<span class="builtinfunc" id="7907693">len</span><span class="op" id="7907696">(</span><span class="ident" id="7907697">p</span><span class="op" id="7907698">.</span><span class="ident" id="7907699">decoded</span><span class="op" id="7907706">)</span><span class="op" id="7907707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7907711">testEqual</span><span class="op" id="7907720">(</span><span class="ident" id="7907721">t</span><span class="op" id="7907722">,</span>&nbsp;<span class="string" id="7907724">&#34;Decoding&nbsp;of&nbsp;%q&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7907754">,</span>&nbsp;<span class="ident" id="7907756">p</span><span class="op" id="7907757">.</span><span class="ident" id="7907758">encoded</span><span class="op" id="7907765">,</span>&nbsp;<span class="builtintype" id="7907767">string</span><span class="op" id="7907773">(</span><span class="ident" id="7907774">dbuf</span><span class="op" id="7907778">[</span><span class="num" id="7907779">0</span><span class="op" id="7907780">:</span><span class="ident" id="7907781">count</span><span class="op" id="7907786">]</span><span class="op" id="7907787">)</span><span class="op" id="7907788">,</span>&nbsp;<span class="ident" id="7907790">p</span><span class="op" id="7907791">.</span><span class="ident" id="7907792">decoded</span><span class="op" id="7907799">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7907803">if</span>&nbsp;<span class="ident" id="7907806">err</span>&nbsp;<span class="op" id="7907810">!=</span>&nbsp;<span class="ident" id="7907813">io</span><span class="op" id="7907815">.</span><span class="ident" id="7907816">EOF</span>&nbsp;<span class="op" id="7907820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7907825">count</span><span class="op" id="7907830">,</span>&nbsp;<span class="ident" id="7907832">err</span>&nbsp;<span class="op" id="7907836">=</span>&nbsp;<span class="ident" id="7907838">decoder</span><span class="op" id="7907845">.</span><span class="ident" id="7907846">Read</span><span class="op" id="7907850">(</span><span class="ident" id="7907851">dbuf</span><span class="op" id="7907855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7907859">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7907863">testEqual</span><span class="op" id="7907872">(</span><span class="ident" id="7907873">t</span><span class="op" id="7907874">,</span>&nbsp;<span class="string" id="7907876">&#34;Read&nbsp;from&nbsp;%q&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7907904">,</span>&nbsp;<span class="ident" id="7907906">p</span><span class="op" id="7907907">.</span><span class="ident" id="7907908">encoded</span><span class="op" id="7907915">,</span>&nbsp;<span class="ident" id="7907917">err</span><span class="op" id="7907920">,</span>&nbsp;<span class="ident" id="7907922">io</span><span class="op" id="7907924">.</span><span class="ident" id="7907925">EOF</span><span class="op" id="7907928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7907931">}</span><br>
<span class="lineno">130</span><span class="op" id="7907933">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7907936">func</span>&nbsp;<span class="ident" id="7907941">TestDecoderBuffering</span><span class="op" id="7907961">(</span><span class="ident" id="7907962">t</span>&nbsp;<span class="op" id="7907964">*</span><span class="ident" id="7907965">testing</span><span class="op" id="7907972">.</span><span class="ident" id="7907973">T</span><span class="op" id="7907974">)</span>&nbsp;<span class="op" id="7907976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7907979">for</span>&nbsp;<span class="ident" id="7907983">bs</span>&nbsp;<span class="op" id="7907986">:=</span>&nbsp;<span class="num" id="7907989">1</span><span class="op" id="7907990">;</span>&nbsp;<span class="ident" id="7907992">bs</span>&nbsp;<span class="op" id="7907995">&lt;=</span>&nbsp;<span class="num" id="7907998">12</span><span class="op" id="7908000">;</span>&nbsp;<span class="ident" id="7908002">bs</span><span class="op" id="7908004">++</span>&nbsp;<span class="op" id="7908007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7908011">decoder</span>&nbsp;<span class="op" id="7908019">:=</span>&nbsp;<span class="ident" id="7908022">NewDecoder</span><span class="op" id="7908032">(</span><span class="ident" id="7908033">StdEncoding</span><span class="op" id="7908044">,</span>&nbsp;<span class="ident" id="7908046">strings</span><span class="op" id="7908053">.</span><span class="ident" id="7908054">NewReader</span><span class="op" id="7908063">(</span><span class="ident" id="7908064">bigtest</span><span class="op" id="7908071">.</span><span class="ident" id="7908072">encoded</span><span class="op" id="7908079">)</span><span class="op" id="7908080">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7908084">buf</span>&nbsp;<span class="op" id="7908088">:=</span>&nbsp;<span class="builtinfunc" id="7908091">make</span><span class="op" id="7908095">(</span><span class="op" id="7908096">[</span><span class="op" id="7908097">]</span><span class="builtintype" id="7908098">byte</span><span class="op" id="7908102">,</span>&nbsp;<span class="builtinfunc" id="7908104">len</span><span class="op" id="7908107">(</span><span class="ident" id="7908108">bigtest</span><span class="op" id="7908115">.</span><span class="ident" id="7908116">decoded</span><span class="op" id="7908123">)</span><span class="op" id="7908124">+</span><span class="num" id="7908125">12</span><span class="op" id="7908127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7908131">var</span>&nbsp;<span class="ident" id="7908135">total</span>&nbsp;<span class="builtintype" id="7908141">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7908147">for</span>&nbsp;<span class="ident" id="7908151">total</span>&nbsp;<span class="op" id="7908157">=</span>&nbsp;<span class="num" id="7908159">0</span><span class="op" id="7908160">;</span>&nbsp;<span class="ident" id="7908162">total</span>&nbsp;<span class="op" id="7908168">&lt;</span>&nbsp;<span class="builtinfunc" id="7908170">len</span><span class="op" id="7908173">(</span><span class="ident" id="7908174">bigtest</span><span class="op" id="7908181">.</span><span class="ident" id="7908182">decoded</span><span class="op" id="7908189">)</span><span class="op" id="7908190">;</span>&nbsp;<span class="op" id="7908192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7908197">n</span><span class="op" id="7908198">,</span>&nbsp;<span class="ident" id="7908200">err</span>&nbsp;<span class="op" id="7908204">:=</span>&nbsp;<span class="ident" id="7908207">decoder</span><span class="op" id="7908214">.</span><span class="ident" id="7908215">Read</span><span class="op" id="7908219">(</span><span class="ident" id="7908220">buf</span><span class="op" id="7908223">[</span><span class="ident" id="7908224">total</span>&nbsp;<span class="op" id="7908230">:</span>&nbsp;<span class="ident" id="7908232">total</span><span class="op" id="7908237">+</span><span class="ident" id="7908238">bs</span><span class="op" id="7908240">]</span><span class="op" id="7908241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7908246">testEqual</span><span class="op" id="7908255">(</span><span class="ident" id="7908256">t</span><span class="op" id="7908257">,</span>&nbsp;<span class="string" id="7908259">&#34;Read&nbsp;from&nbsp;%q&nbsp;at&nbsp;pos&nbsp;%d&nbsp;=&nbsp;%d,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;%v&#34;</span><span class="op" id="7908304">,</span>&nbsp;<span class="ident" id="7908306">bigtest</span><span class="op" id="7908313">.</span><span class="ident" id="7908314">encoded</span><span class="op" id="7908321">,</span>&nbsp;<span class="ident" id="7908323">total</span><span class="op" id="7908328">,</span>&nbsp;<span class="ident" id="7908330">n</span><span class="op" id="7908331">,</span>&nbsp;<span class="ident" id="7908333">err</span><span class="op" id="7908336">,</span>&nbsp;<span class="builtintype" id="7908338">error</span><span class="op" id="7908343">(</span><span class="builtintype" id="7908344">nil</span><span class="op" id="7908347">)</span><span class="op" id="7908348">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7908353">total</span>&nbsp;<span class="op" id="7908359">+=</span>&nbsp;<span class="ident" id="7908362">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7908366">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7908370">testEqual</span><span class="op" id="7908379">(</span><span class="ident" id="7908380">t</span><span class="op" id="7908381">,</span>&nbsp;<span class="string" id="7908383">&#34;Decoding/%d&nbsp;of&nbsp;%q&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7908416">,</span>&nbsp;<span class="ident" id="7908418">bs</span><span class="op" id="7908420">,</span>&nbsp;<span class="ident" id="7908422">bigtest</span><span class="op" id="7908429">.</span><span class="ident" id="7908430">encoded</span><span class="op" id="7908437">,</span>&nbsp;<span class="builtintype" id="7908439">string</span><span class="op" id="7908445">(</span><span class="ident" id="7908446">buf</span><span class="op" id="7908449">[</span><span class="num" id="7908450">0</span><span class="op" id="7908451">:</span><span class="ident" id="7908452">total</span><span class="op" id="7908457">]</span><span class="op" id="7908458">)</span><span class="op" id="7908459">,</span>&nbsp;<span class="ident" id="7908461">bigtest</span><span class="op" id="7908468">.</span><span class="ident" id="7908469">decoded</span><span class="op" id="7908476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7908479">}</span><br>
<span class="lineno"></span><span class="op" id="7908481">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="keyword" id="7908484">func</span>&nbsp;<span class="ident" id="7908489">TestDecodeCorrupt</span><span class="op" id="7908506">(</span><span class="ident" id="7908507">t</span>&nbsp;<span class="op" id="7908509">*</span><span class="ident" id="7908510">testing</span><span class="op" id="7908517">.</span><span class="ident" id="7908518">T</span><span class="op" id="7908519">)</span>&nbsp;<span class="op" id="7908521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7908524">testCases</span>&nbsp;<span class="op" id="7908534">:=</span>&nbsp;<span class="op" id="7908537">[</span><span class="op" id="7908538">]</span><span class="keyword" id="7908539">struct</span>&nbsp;<span class="op" id="7908546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7908550">input</span>&nbsp;&nbsp;<span class="builtintype" id="7908557">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7908566">offset</span>&nbsp;<span class="builtintype" id="7908573">int</span>&nbsp;<span class="comment" id="7908577">//&nbsp;-1&nbsp;means&nbsp;no&nbsp;corruption.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7908605">}</span><span class="op" id="7908606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7908610">{</span><span class="string" id="7908611">&#34;&#34;</span><span class="op" id="7908613">,</span>&nbsp;<span class="op" id="7908615">-</span><span class="num" id="7908616">1</span><span class="op" id="7908617">}</span><span class="op" id="7908618">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7908622">{</span><span class="string" id="7908623">&#34;!!!!&#34;</span><span class="op" id="7908629">,</span>&nbsp;<span class="num" id="7908631">0</span><span class="op" id="7908632">}</span><span class="op" id="7908633">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7908637">{</span><span class="string" id="7908638">&#34;====&#34;</span><span class="op" id="7908644">,</span>&nbsp;<span class="num" id="7908646">0</span><span class="op" id="7908647">}</span><span class="op" id="7908648">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7908652">{</span><span class="string" id="7908653">&#34;x===&#34;</span><span class="op" id="7908659">,</span>&nbsp;<span class="num" id="7908661">1</span><span class="op" id="7908662">}</span><span class="op" id="7908663">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7908667">{</span><span class="string" id="7908668">&#34;=AAA&#34;</span><span class="op" id="7908674">,</span>&nbsp;<span class="num" id="7908676">0</span><span class="op" id="7908677">}</span><span class="op" id="7908678">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7908682">{</span><span class="string" id="7908683">&#34;A=AA&#34;</span><span class="op" id="7908689">,</span>&nbsp;<span class="num" id="7908691">1</span><span class="op" id="7908692">}</span><span class="op" id="7908693">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7908697">{</span><span class="string" id="7908698">&#34;AA=A&#34;</span><span class="op" id="7908704">,</span>&nbsp;<span class="num" id="7908706">2</span><span class="op" id="7908707">}</span><span class="op" id="7908708">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7908712">{</span><span class="string" id="7908713">&#34;AA==A&#34;</span><span class="op" id="7908720">,</span>&nbsp;<span class="num" id="7908722">4</span><span class="op" id="7908723">}</span><span class="op" id="7908724">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7908728">{</span><span class="string" id="7908729">&#34;AAA=AAAA&#34;</span><span class="op" id="7908739">,</span>&nbsp;<span class="num" id="7908741">4</span><span class="op" id="7908742">}</span><span class="op" id="7908743">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7908747">{</span><span class="string" id="7908748">&#34;AAAAA&#34;</span><span class="op" id="7908755">,</span>&nbsp;<span class="num" id="7908757">4</span><span class="op" id="7908758">}</span><span class="op" id="7908759">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7908763">{</span><span class="string" id="7908764">&#34;AAAAAA&#34;</span><span class="op" id="7908772">,</span>&nbsp;<span class="num" id="7908774">4</span><span class="op" id="7908775">}</span><span class="op" id="7908776">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7908780">{</span><span class="string" id="7908781">&#34;A=&#34;</span><span class="op" id="7908785">,</span>&nbsp;<span class="num" id="7908787">1</span><span class="op" id="7908788">}</span><span class="op" id="7908789">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7908793">{</span><span class="string" id="7908794">&#34;A==&#34;</span><span class="op" id="7908799">,</span>&nbsp;<span class="num" id="7908801">1</span><span class="op" id="7908802">}</span><span class="op" id="7908803">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7908807">{</span><span class="string" id="7908808">&#34;AA=&#34;</span><span class="op" id="7908813">,</span>&nbsp;<span class="num" id="7908815">3</span><span class="op" id="7908816">}</span><span class="op" id="7908817">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7908821">{</span><span class="string" id="7908822">&#34;AA==&#34;</span><span class="op" id="7908828">,</span>&nbsp;<span class="op" id="7908830">-</span><span class="num" id="7908831">1</span><span class="op" id="7908832">}</span><span class="op" id="7908833">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7908837">{</span><span class="string" id="7908838">&#34;AAA=&#34;</span><span class="op" id="7908844">,</span>&nbsp;<span class="op" id="7908846">-</span><span class="num" id="7908847">1</span><span class="op" id="7908848">}</span><span class="op" id="7908849">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7908853">{</span><span class="string" id="7908854">&#34;AAAA&#34;</span><span class="op" id="7908860">,</span>&nbsp;<span class="op" id="7908862">-</span><span class="num" id="7908863">1</span><span class="op" id="7908864">}</span><span class="op" id="7908865">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7908869">{</span><span class="string" id="7908870">&#34;AAAAAA=&#34;</span><span class="op" id="7908879">,</span>&nbsp;<span class="num" id="7908881">7</span><span class="op" id="7908882">}</span><span class="op" id="7908883">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7908887">{</span><span class="string" id="7908888">&#34;YWJjZA=====&#34;</span><span class="op" id="7908901">,</span>&nbsp;<span class="num" id="7908903">8</span><span class="op" id="7908904">}</span><span class="op" id="7908905">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7908908">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7908911">for</span>&nbsp;<span class="ident" id="7908915">_</span><span class="op" id="7908916">,</span>&nbsp;<span class="ident" id="7908918">tc</span>&nbsp;<span class="op" id="7908921">:=</span>&nbsp;<span class="keyword" id="7908924">range</span>&nbsp;<span class="ident" id="7908930">testCases</span>&nbsp;<span class="op" id="7908940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7908944">dbuf</span>&nbsp;<span class="op" id="7908949">:=</span>&nbsp;<span class="builtinfunc" id="7908952">make</span><span class="op" id="7908956">(</span><span class="op" id="7908957">[</span><span class="op" id="7908958">]</span><span class="builtintype" id="7908959">byte</span><span class="op" id="7908963">,</span>&nbsp;<span class="ident" id="7908965">StdEncoding</span><span class="op" id="7908976">.</span><span class="ident" id="7908977">DecodedLen</span><span class="op" id="7908987">(</span><span class="builtinfunc" id="7908988">len</span><span class="op" id="7908991">(</span><span class="ident" id="7908992">tc</span><span class="op" id="7908994">.</span><span class="ident" id="7908995">input</span><span class="op" id="7909000">)</span><span class="op" id="7909001">)</span><span class="op" id="7909002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7909006">_</span><span class="op" id="7909007">,</span>&nbsp;<span class="ident" id="7909009">err</span>&nbsp;<span class="op" id="7909013">:=</span>&nbsp;<span class="ident" id="7909016">StdEncoding</span><span class="op" id="7909027">.</span><span class="ident" id="7909028">Decode</span><span class="op" id="7909034">(</span><span class="ident" id="7909035">dbuf</span><span class="op" id="7909039">,</span>&nbsp;<span class="op" id="7909041">[</span><span class="op" id="7909042">]</span><span class="builtintype" id="7909043">byte</span><span class="op" id="7909047">(</span><span class="ident" id="7909048">tc</span><span class="op" id="7909050">.</span><span class="ident" id="7909051">input</span><span class="op" id="7909056">)</span><span class="op" id="7909057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7909061">if</span>&nbsp;<span class="ident" id="7909064">tc</span><span class="op" id="7909066">.</span><span class="ident" id="7909067">offset</span>&nbsp;<span class="op" id="7909074">==</span>&nbsp;<span class="op" id="7909077">-</span><span class="num" id="7909078">1</span>&nbsp;<span class="op" id="7909080">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7909085">if</span>&nbsp;<span class="ident" id="7909088">err</span>&nbsp;<span class="op" id="7909092">!=</span>&nbsp;<span class="builtintype" id="7909095">nil</span>&nbsp;<span class="op" id="7909099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7909105">t</span><span class="op" id="7909106">.</span><span class="ident" id="7909107">Error</span><span class="op" id="7909112">(</span><span class="string" id="7909113">&#34;Decoder&nbsp;wrongly&nbsp;detected&nbsp;coruption&nbsp;in&#34;</span><span class="op" id="7909152">,</span>&nbsp;<span class="ident" id="7909154">tc</span><span class="op" id="7909156">.</span><span class="ident" id="7909157">input</span><span class="op" id="7909162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7909167">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7909172">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7909183">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7909187">switch</span>&nbsp;<span class="ident" id="7909194">err</span>&nbsp;<span class="op" id="7909198">:=</span>&nbsp;<span class="ident" id="7909201">err</span><span class="op" id="7909204">.</span><span class="op" id="7909205">(</span><span class="keyword" id="7909206">type</span><span class="op" id="7909210">)</span>&nbsp;<span class="op" id="7909212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7909216">case</span>&nbsp;<span class="ident" id="7909221">CorruptInputError</span><span class="op" id="7909238">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7909243">testEqual</span><span class="op" id="7909252">(</span><span class="ident" id="7909253">t</span><span class="op" id="7909254">,</span>&nbsp;<span class="string" id="7909256">&#34;Corruption&nbsp;in&nbsp;%q&nbsp;at&nbsp;offset&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7909296">,</span>&nbsp;<span class="ident" id="7909298">tc</span><span class="op" id="7909300">.</span><span class="ident" id="7909301">input</span><span class="op" id="7909306">,</span>&nbsp;<span class="builtintype" id="7909308">int</span><span class="op" id="7909311">(</span><span class="ident" id="7909312">err</span><span class="op" id="7909315">)</span><span class="op" id="7909316">,</span>&nbsp;<span class="ident" id="7909318">tc</span><span class="op" id="7909320">.</span><span class="ident" id="7909321">offset</span><span class="op" id="7909327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7909331">default</span><span class="op" id="7909338">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7909343">t</span><span class="op" id="7909344">.</span><span class="ident" id="7909345">Error</span><span class="op" id="7909350">(</span><span class="string" id="7909351">&#34;Decoder&nbsp;failed&nbsp;to&nbsp;detect&nbsp;corruption&nbsp;in&#34;</span><span class="op" id="7909391">,</span>&nbsp;<span class="ident" id="7909393">tc</span><span class="op" id="7909395">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7909399">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7909402">}</span><br>
<span class="lineno"></span><span class="op" id="7909404">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7909407">func</span>&nbsp;<span class="ident" id="7909412">TestBig</span><span class="op" id="7909419">(</span><span class="ident" id="7909420">t</span>&nbsp;<span class="op" id="7909422">*</span><span class="ident" id="7909423">testing</span><span class="op" id="7909430">.</span><span class="ident" id="7909431">T</span><span class="op" id="7909432">)</span>&nbsp;<span class="op" id="7909434">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7909437">n</span>&nbsp;<span class="op" id="7909439">:=</span>&nbsp;<span class="num" id="7909442">3</span><span class="op" id="7909443">*</span><span class="num" id="7909444">1000</span>&nbsp;<span class="op" id="7909449">+</span>&nbsp;<span class="num" id="7909451">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7909454">raw</span>&nbsp;<span class="op" id="7909458">:=</span>&nbsp;<span class="builtinfunc" id="7909461">make</span><span class="op" id="7909465">(</span><span class="op" id="7909466">[</span><span class="op" id="7909467">]</span><span class="builtintype" id="7909468">byte</span><span class="op" id="7909472">,</span>&nbsp;<span class="ident" id="7909474">n</span><span class="op" id="7909475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7909478">const</span>&nbsp;<span class="ident" id="7909484">alpha</span>&nbsp;<span class="op" id="7909490">=</span>&nbsp;<span class="string" id="7909492">&#34;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7909558">for</span>&nbsp;<span class="ident" id="7909562">i</span>&nbsp;<span class="op" id="7909564">:=</span>&nbsp;<span class="num" id="7909567">0</span><span class="op" id="7909568">;</span>&nbsp;<span class="ident" id="7909570">i</span>&nbsp;<span class="op" id="7909572">&lt;</span>&nbsp;<span class="ident" id="7909574">n</span><span class="op" id="7909575">;</span>&nbsp;<span class="ident" id="7909577">i</span><span class="op" id="7909578">++</span>&nbsp;<span class="op" id="7909581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7909585">raw</span><span class="op" id="7909588">[</span><span class="ident" id="7909589">i</span><span class="op" id="7909590">]</span>&nbsp;<span class="op" id="7909592">=</span>&nbsp;<span class="ident" id="7909594">alpha</span><span class="op" id="7909599">[</span><span class="ident" id="7909600">i</span><span class="op" id="7909601">%</span><span class="builtinfunc" id="7909602">len</span><span class="op" id="7909605">(</span><span class="ident" id="7909606">alpha</span><span class="op" id="7909611">)</span><span class="op" id="7909612">]</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7909615">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7909618">encoded</span>&nbsp;<span class="op" id="7909626">:=</span>&nbsp;<span class="builtinfunc" id="7909629">new</span><span class="op" id="7909632">(</span><span class="ident" id="7909633">bytes</span><span class="op" id="7909638">.</span><span class="ident" id="7909639">Buffer</span><span class="op" id="7909645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7909648">w</span>&nbsp;<span class="op" id="7909650">:=</span>&nbsp;<span class="ident" id="7909653">NewEncoder</span><span class="op" id="7909663">(</span><span class="ident" id="7909664">StdEncoding</span><span class="op" id="7909675">,</span>&nbsp;<span class="ident" id="7909677">encoded</span><span class="op" id="7909684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7909687">nn</span><span class="op" id="7909689">,</span>&nbsp;<span class="ident" id="7909691">err</span>&nbsp;<span class="op" id="7909695">:=</span>&nbsp;<span class="ident" id="7909698">w</span><span class="op" id="7909699">.</span><span class="ident" id="7909700">Write</span><span class="op" id="7909705">(</span><span class="ident" id="7909706">raw</span><span class="op" id="7909709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7909712">if</span>&nbsp;<span class="ident" id="7909715">nn</span>&nbsp;<span class="op" id="7909718">!=</span>&nbsp;<span class="ident" id="7909721">n</span>&nbsp;<span class="op" id="7909723">||</span>&nbsp;<span class="ident" id="7909726">err</span>&nbsp;<span class="op" id="7909730">!=</span>&nbsp;<span class="builtintype" id="7909733">nil</span>&nbsp;<span class="op" id="7909737">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7909741">t</span><span class="op" id="7909742">.</span><span class="ident" id="7909743">Fatalf</span><span class="op" id="7909749">(</span><span class="string" id="7909750">&#34;Encoder.Write(raw)&nbsp;=&nbsp;%d,&nbsp;%v&nbsp;want&nbsp;%d,&nbsp;nil&#34;</span><span class="op" id="7909792">,</span>&nbsp;<span class="ident" id="7909794">nn</span><span class="op" id="7909796">,</span>&nbsp;<span class="ident" id="7909798">err</span><span class="op" id="7909801">,</span>&nbsp;<span class="ident" id="7909803">n</span><span class="op" id="7909804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7909807">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7909810">err</span>&nbsp;<span class="op" id="7909814">=</span>&nbsp;<span class="ident" id="7909816">w</span><span class="op" id="7909817">.</span><span class="ident" id="7909818">Close</span><span class="op" id="7909823">(</span><span class="op" id="7909824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7909827">if</span>&nbsp;<span class="ident" id="7909830">err</span>&nbsp;<span class="op" id="7909834">!=</span>&nbsp;<span class="builtintype" id="7909837">nil</span>&nbsp;<span class="op" id="7909841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7909845">t</span><span class="op" id="7909846">.</span><span class="ident" id="7909847">Fatalf</span><span class="op" id="7909853">(</span><span class="string" id="7909854">&#34;Encoder.Close()&nbsp;=&nbsp;%v&nbsp;want&nbsp;nil&#34;</span><span class="op" id="7909885">,</span>&nbsp;<span class="ident" id="7909887">err</span><span class="op" id="7909890">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7909893">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7909896">decoded</span><span class="op" id="7909903">,</span>&nbsp;<span class="ident" id="7909905">err</span>&nbsp;<span class="op" id="7909909">:=</span>&nbsp;<span class="ident" id="7909912">ioutil</span><span class="op" id="7909918">.</span><span class="ident" id="7909919">ReadAll</span><span class="op" id="7909926">(</span><span class="ident" id="7909927">NewDecoder</span><span class="op" id="7909937">(</span><span class="ident" id="7909938">StdEncoding</span><span class="op" id="7909949">,</span>&nbsp;<span class="ident" id="7909951">encoded</span><span class="op" id="7909958">)</span><span class="op" id="7909959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7909962">if</span>&nbsp;<span class="ident" id="7909965">err</span>&nbsp;<span class="op" id="7909969">!=</span>&nbsp;<span class="builtintype" id="7909972">nil</span>&nbsp;<span class="op" id="7909976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7909980">t</span><span class="op" id="7909981">.</span><span class="ident" id="7909982">Fatalf</span><span class="op" id="7909988">(</span><span class="string" id="7909989">&#34;ioutil.ReadAll(NewDecoder(...)):&nbsp;%v&#34;</span><span class="op" id="7910026">,</span>&nbsp;<span class="ident" id="7910028">err</span><span class="op" id="7910031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7910034">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7910038">if</span>&nbsp;<span class="op" id="7910041">!</span><span class="ident" id="7910042">bytes</span><span class="op" id="7910047">.</span><span class="ident" id="7910048">Equal</span><span class="op" id="7910053">(</span><span class="ident" id="7910054">raw</span><span class="op" id="7910057">,</span>&nbsp;<span class="ident" id="7910059">decoded</span><span class="op" id="7910066">)</span>&nbsp;<span class="op" id="7910068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7910072">var</span>&nbsp;<span class="ident" id="7910076">i</span>&nbsp;<span class="builtintype" id="7910078">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7910084">for</span>&nbsp;<span class="ident" id="7910088">i</span>&nbsp;<span class="op" id="7910090">=</span>&nbsp;<span class="num" id="7910092">0</span><span class="op" id="7910093">;</span>&nbsp;<span class="ident" id="7910095">i</span>&nbsp;<span class="op" id="7910097">&lt;</span>&nbsp;<span class="builtinfunc" id="7910099">len</span><span class="op" id="7910102">(</span><span class="ident" id="7910103">decoded</span><span class="op" id="7910110">)</span>&nbsp;<span class="op" id="7910112">&amp;&amp;</span>&nbsp;<span class="ident" id="7910115">i</span>&nbsp;<span class="op" id="7910117">&lt;</span>&nbsp;<span class="builtinfunc" id="7910119">len</span><span class="op" id="7910122">(</span><span class="ident" id="7910123">raw</span><span class="op" id="7910126">)</span><span class="op" id="7910127">;</span>&nbsp;<span class="ident" id="7910129">i</span><span class="op" id="7910130">++</span>&nbsp;<span class="op" id="7910133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7910138">if</span>&nbsp;<span class="ident" id="7910141">decoded</span><span class="op" id="7910148">[</span><span class="ident" id="7910149">i</span><span class="op" id="7910150">]</span>&nbsp;<span class="op" id="7910152">!=</span>&nbsp;<span class="ident" id="7910155">raw</span><span class="op" id="7910158">[</span><span class="ident" id="7910159">i</span><span class="op" id="7910160">]</span>&nbsp;<span class="op" id="7910162">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7910168">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7910177">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7910181">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7910185">t</span><span class="op" id="7910186">.</span><span class="ident" id="7910187">Errorf</span><span class="op" id="7910193">(</span><span class="string" id="7910194">&#34;Decode(Encode(%d-byte&nbsp;string))&nbsp;failed&nbsp;at&nbsp;offset&nbsp;%d&#34;</span><span class="op" id="7910246">,</span>&nbsp;<span class="ident" id="7910248">n</span><span class="op" id="7910249">,</span>&nbsp;<span class="ident" id="7910251">i</span><span class="op" id="7910252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7910255">}</span><br>
<span class="lineno">220</span><span class="op" id="7910257">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7910260">func</span>&nbsp;<span class="ident" id="7910265">TestNewLineCharacters</span><span class="op" id="7910286">(</span><span class="ident" id="7910287">t</span>&nbsp;<span class="op" id="7910289">*</span><span class="ident" id="7910290">testing</span><span class="op" id="7910297">.</span><span class="ident" id="7910298">T</span><span class="op" id="7910299">)</span>&nbsp;<span class="op" id="7910301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7910304">//&nbsp;Each&nbsp;of&nbsp;these&nbsp;should&nbsp;decode&nbsp;to&nbsp;the&nbsp;string&nbsp;&#34;sure&#34;,&nbsp;without&nbsp;errors.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7910374">const</span>&nbsp;<span class="ident" id="7910380">expected</span>&nbsp;<span class="op" id="7910389">=</span>&nbsp;<span class="string" id="7910391">&#34;sure&#34;</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7910399">examples</span>&nbsp;<span class="op" id="7910408">:=</span>&nbsp;<span class="op" id="7910411">[</span><span class="op" id="7910412">]</span><span class="builtintype" id="7910413">string</span><span class="op" id="7910419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7910423">&#34;c3VyZQ==&#34;</span><span class="op" id="7910433">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7910437">&#34;c3VyZQ==\r&#34;</span><span class="op" id="7910449">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7910453">&#34;c3VyZQ==\n&#34;</span><span class="op" id="7910465">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7910469">&#34;c3VyZQ==\r\n&#34;</span><span class="op" id="7910483">,</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7910487">&#34;c3VyZ\r\nQ==&#34;</span><span class="op" id="7910501">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7910505">&#34;c3V\ryZ\nQ==&#34;</span><span class="op" id="7910519">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7910523">&#34;c3V\nyZ\rQ==&#34;</span><span class="op" id="7910537">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7910541">&#34;c3VyZ\nQ==&#34;</span><span class="op" id="7910553">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7910557">&#34;c3VyZQ\n==&#34;</span><span class="op" id="7910569">,</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7910573">&#34;c3VyZQ=\n=&#34;</span><span class="op" id="7910585">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7910589">&#34;c3VyZQ=\r\n\r\n=&#34;</span><span class="op" id="7910607">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7910610">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7910613">for</span>&nbsp;<span class="ident" id="7910617">_</span><span class="op" id="7910618">,</span>&nbsp;<span class="ident" id="7910620">e</span>&nbsp;<span class="op" id="7910622">:=</span>&nbsp;<span class="keyword" id="7910625">range</span>&nbsp;<span class="ident" id="7910631">examples</span>&nbsp;<span class="op" id="7910640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7910644">buf</span><span class="op" id="7910647">,</span>&nbsp;<span class="ident" id="7910649">err</span>&nbsp;<span class="op" id="7910653">:=</span>&nbsp;<span class="ident" id="7910656">StdEncoding</span><span class="op" id="7910667">.</span><span class="ident" id="7910668">DecodeString</span><span class="op" id="7910680">(</span><span class="ident" id="7910681">e</span><span class="op" id="7910682">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7910686">if</span>&nbsp;<span class="ident" id="7910689">err</span>&nbsp;<span class="op" id="7910693">!=</span>&nbsp;<span class="builtintype" id="7910696">nil</span>&nbsp;<span class="op" id="7910700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7910705">t</span><span class="op" id="7910706">.</span><span class="ident" id="7910707">Errorf</span><span class="op" id="7910713">(</span><span class="string" id="7910714">&#34;Decode(%q)&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7910737">,</span>&nbsp;<span class="ident" id="7910739">e</span><span class="op" id="7910740">,</span>&nbsp;<span class="ident" id="7910742">err</span><span class="op" id="7910745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7910750">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7910761">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7910765">if</span>&nbsp;<span class="ident" id="7910768">s</span>&nbsp;<span class="op" id="7910770">:=</span>&nbsp;<span class="builtintype" id="7910773">string</span><span class="op" id="7910779">(</span><span class="ident" id="7910780">buf</span><span class="op" id="7910783">)</span><span class="op" id="7910784">;</span>&nbsp;<span class="ident" id="7910786">s</span>&nbsp;<span class="op" id="7910788">!=</span>&nbsp;<span class="ident" id="7910791">expected</span>&nbsp;<span class="op" id="7910800">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7910805">t</span><span class="op" id="7910806">.</span><span class="ident" id="7910807">Errorf</span><span class="op" id="7910813">(</span><span class="string" id="7910814">&#34;Decode(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7910840">,</span>&nbsp;<span class="ident" id="7910842">e</span><span class="op" id="7910843">,</span>&nbsp;<span class="ident" id="7910845">s</span><span class="op" id="7910846">,</span>&nbsp;<span class="ident" id="7910848">expected</span><span class="op" id="7910856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7910860">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7910863">}</span><br>
<span class="lineno"></span><span class="op" id="7910865">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="keyword" id="7910868">type</span>&nbsp;<span class="ident" id="7910873">nextRead</span>&nbsp;<span class="keyword" id="7910882">struct</span>&nbsp;<span class="op" id="7910889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7910892">n</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7910896">int</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="7910902">//&nbsp;bytes&nbsp;to&nbsp;return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7910922">err</span>&nbsp;<span class="builtintype" id="7910926">error</span>&nbsp;<span class="comment" id="7910932">//&nbsp;error&nbsp;to&nbsp;return</span><br>
<span class="lineno"></span><span class="op" id="7910951">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="comment" id="7910954">//&nbsp;faultInjectReader&nbsp;returns&nbsp;data&nbsp;from&nbsp;source,&nbsp;rate-limited</span><br>
<span class="lineno"></span><span class="comment" id="7911014">//&nbsp;and&nbsp;with&nbsp;the&nbsp;errors&nbsp;as&nbsp;written&nbsp;to&nbsp;nextc.</span><br>
<span class="lineno"></span><span class="keyword" id="7911058">type</span>&nbsp;<span class="ident" id="7911063">faultInjectReader</span>&nbsp;<span class="keyword" id="7911081">struct</span>&nbsp;<span class="op" id="7911088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7911091">source</span>&nbsp;<span class="builtintype" id="7911098">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7911106">nextc</span>&nbsp;&nbsp;<span class="op" id="7911113">&lt;-</span><span class="keyword" id="7911115">chan</span>&nbsp;<span class="ident" id="7911120">nextRead</span><br>
<span class="lineno">260</span><span class="op" id="7911129">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7911132">func</span>&nbsp;<span class="op" id="7911137">(</span><span class="ident" id="7911138">r</span>&nbsp;<span class="op" id="7911140">*</span><span class="ident" id="7911141">faultInjectReader</span><span class="op" id="7911158">)</span>&nbsp;<span class="ident" id="7911160">Read</span><span class="op" id="7911164">(</span><span class="ident" id="7911165">p</span>&nbsp;<span class="op" id="7911167">[</span><span class="op" id="7911168">]</span><span class="builtintype" id="7911169">byte</span><span class="op" id="7911173">)</span>&nbsp;<span class="op" id="7911175">(</span><span class="builtintype" id="7911176">int</span><span class="op" id="7911179">,</span>&nbsp;<span class="builtintype" id="7911181">error</span><span class="op" id="7911186">)</span>&nbsp;<span class="op" id="7911188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7911191">nr</span>&nbsp;<span class="op" id="7911194">:=</span>&nbsp;<span class="op" id="7911197">&lt;-</span><span class="ident" id="7911199">r</span><span class="op" id="7911200">.</span><span class="ident" id="7911201">nextc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7911208">if</span>&nbsp;<span class="builtinfunc" id="7911211">len</span><span class="op" id="7911214">(</span><span class="ident" id="7911215">p</span><span class="op" id="7911216">)</span>&nbsp;<span class="op" id="7911218">&gt;</span>&nbsp;<span class="ident" id="7911220">nr</span><span class="op" id="7911222">.</span><span class="ident" id="7911223">n</span>&nbsp;<span class="op" id="7911225">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7911229">p</span>&nbsp;<span class="op" id="7911231">=</span>&nbsp;<span class="ident" id="7911233">p</span><span class="op" id="7911234">[</span><span class="op" id="7911235">:</span><span class="ident" id="7911236">nr</span><span class="op" id="7911238">.</span><span class="ident" id="7911239">n</span><span class="op" id="7911240">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7911243">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7911246">n</span>&nbsp;<span class="op" id="7911248">:=</span>&nbsp;<span class="builtinfunc" id="7911251">copy</span><span class="op" id="7911255">(</span><span class="ident" id="7911256">p</span><span class="op" id="7911257">,</span>&nbsp;<span class="ident" id="7911259">r</span><span class="op" id="7911260">.</span><span class="ident" id="7911261">source</span><span class="op" id="7911267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7911270">r</span><span class="op" id="7911271">.</span><span class="ident" id="7911272">source</span>&nbsp;<span class="op" id="7911279">=</span>&nbsp;<span class="ident" id="7911281">r</span><span class="op" id="7911282">.</span><span class="ident" id="7911283">source</span><span class="op" id="7911289">[</span><span class="ident" id="7911290">n</span><span class="op" id="7911291">:</span><span class="op" id="7911292">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7911295">return</span>&nbsp;<span class="ident" id="7911302">n</span><span class="op" id="7911303">,</span>&nbsp;<span class="ident" id="7911305">nr</span><span class="op" id="7911307">.</span><span class="ident" id="7911308">err</span><br>
<span class="lineno">270</span><span class="op" id="7911312">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7911315">//&nbsp;tests&nbsp;that&nbsp;we&nbsp;don&#39;t&nbsp;ignore&nbsp;errors&nbsp;from&nbsp;our&nbsp;underlying&nbsp;reader</span><br>
<span class="lineno"></span><span class="keyword" id="7911379">func</span>&nbsp;<span class="ident" id="7911384">TestDecoderIssue3577</span><span class="op" id="7911404">(</span><span class="ident" id="7911405">t</span>&nbsp;<span class="op" id="7911407">*</span><span class="ident" id="7911408">testing</span><span class="op" id="7911415">.</span><span class="ident" id="7911416">T</span><span class="op" id="7911417">)</span>&nbsp;<span class="op" id="7911419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7911422">next</span>&nbsp;<span class="op" id="7911427">:=</span>&nbsp;<span class="builtinfunc" id="7911430">make</span><span class="op" id="7911434">(</span><span class="keyword" id="7911435">chan</span>&nbsp;<span class="ident" id="7911440">nextRead</span><span class="op" id="7911448">,</span>&nbsp;<span class="num" id="7911450">10</span><span class="op" id="7911452">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7911455">wantErr</span>&nbsp;<span class="op" id="7911463">:=</span>&nbsp;<span class="ident" id="7911466">errors</span><span class="op" id="7911472">.</span><span class="ident" id="7911473">New</span><span class="op" id="7911476">(</span><span class="string" id="7911477">&#34;my&nbsp;error&#34;</span><span class="op" id="7911487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7911490">next</span>&nbsp;<span class="op" id="7911495">&lt;-</span>&nbsp;<span class="ident" id="7911498">nextRead</span><span class="op" id="7911506">{</span><span class="num" id="7911507">5</span><span class="op" id="7911508">,</span>&nbsp;<span class="builtintype" id="7911510">nil</span><span class="op" id="7911513">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7911516">next</span>&nbsp;<span class="op" id="7911521">&lt;-</span>&nbsp;<span class="ident" id="7911524">nextRead</span><span class="op" id="7911532">{</span><span class="num" id="7911533">10</span><span class="op" id="7911535">,</span>&nbsp;<span class="ident" id="7911537">wantErr</span><span class="op" id="7911544">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7911547">next</span>&nbsp;<span class="op" id="7911552">&lt;-</span>&nbsp;<span class="ident" id="7911555">nextRead</span><span class="op" id="7911563">{</span><span class="num" id="7911564">0</span><span class="op" id="7911565">,</span>&nbsp;<span class="ident" id="7911567">wantErr</span><span class="op" id="7911574">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7911577">d</span>&nbsp;<span class="op" id="7911579">:=</span>&nbsp;<span class="ident" id="7911582">NewDecoder</span><span class="op" id="7911592">(</span><span class="ident" id="7911593">StdEncoding</span><span class="op" id="7911604">,</span>&nbsp;<span class="op" id="7911606">&amp;</span><span class="ident" id="7911607">faultInjectReader</span><span class="op" id="7911624">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7911628">source</span><span class="op" id="7911634">:</span>&nbsp;<span class="string" id="7911636">&#34;VHdhcyBicmlsbGlnLCBhbmQgdGhlIHNsaXRoeSB0b3Zlcw==&#34;</span><span class="op" id="7911686">,</span>&nbsp;<span class="comment" id="7911688">//&nbsp;twas&nbsp;brillig...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7911709">nextc</span><span class="op" id="7911714">:</span>&nbsp;&nbsp;<span class="ident" id="7911717">next</span><span class="op" id="7911721">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7911724">}</span><span class="op" id="7911725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7911728">errc</span>&nbsp;<span class="op" id="7911733">:=</span>&nbsp;<span class="builtinfunc" id="7911736">make</span><span class="op" id="7911740">(</span><span class="keyword" id="7911741">chan</span>&nbsp;<span class="builtintype" id="7911746">error</span><span class="op" id="7911751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7911754">go</span>&nbsp;<span class="keyword" id="7911757">func</span><span class="op" id="7911761">(</span><span class="op" id="7911762">)</span>&nbsp;<span class="op" id="7911764">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7911768">_</span><span class="op" id="7911769">,</span>&nbsp;<span class="ident" id="7911771">err</span>&nbsp;<span class="op" id="7911775">:=</span>&nbsp;<span class="ident" id="7911778">ioutil</span><span class="op" id="7911784">.</span><span class="ident" id="7911785">ReadAll</span><span class="op" id="7911792">(</span><span class="ident" id="7911793">d</span><span class="op" id="7911794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7911798">errc</span>&nbsp;<span class="op" id="7911803">&lt;-</span>&nbsp;<span class="ident" id="7911806">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7911811">}</span><span class="op" id="7911812">(</span><span class="op" id="7911813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7911816">select</span>&nbsp;<span class="op" id="7911823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7911826">case</span>&nbsp;<span class="ident" id="7911831">err</span>&nbsp;<span class="op" id="7911835">:=</span>&nbsp;<span class="op" id="7911838">&lt;-</span><span class="ident" id="7911840">errc</span><span class="op" id="7911844">:</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7911848">if</span>&nbsp;<span class="ident" id="7911851">err</span>&nbsp;<span class="op" id="7911855">!=</span>&nbsp;<span class="ident" id="7911858">wantErr</span>&nbsp;<span class="op" id="7911866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7911871">t</span><span class="op" id="7911872">.</span><span class="ident" id="7911873">Errorf</span><span class="op" id="7911879">(</span><span class="string" id="7911880">&#34;got&nbsp;error&nbsp;%v;&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7911903">,</span>&nbsp;<span class="ident" id="7911905">err</span><span class="op" id="7911908">,</span>&nbsp;<span class="ident" id="7911910">wantErr</span><span class="op" id="7911917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7911921">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7911924">case</span>&nbsp;<span class="op" id="7911929">&lt;-</span><span class="ident" id="7911931">time</span><span class="op" id="7911935">.</span><span class="ident" id="7911936">After</span><span class="op" id="7911941">(</span><span class="num" id="7911942">5</span>&nbsp;<span class="op" id="7911944">*</span>&nbsp;<span class="ident" id="7911946">time</span><span class="op" id="7911950">.</span><span class="ident" id="7911951">Second</span><span class="op" id="7911957">)</span><span class="op" id="7911958">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7911962">t</span><span class="op" id="7911963">.</span><span class="ident" id="7911964">Errorf</span><span class="op" id="7911970">(</span><span class="string" id="7911971">&#34;timeout;&nbsp;Decoder&nbsp;blocked&nbsp;without&nbsp;returning&nbsp;an&nbsp;error&#34;</span><span class="op" id="7912024">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7912027">}</span><br>
<span class="lineno"></span><span class="op" id="7912029">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7912032">func</span>&nbsp;<span class="ident" id="7912037">TestDecoderIssue4779</span><span class="op" id="7912057">(</span><span class="ident" id="7912058">t</span>&nbsp;<span class="op" id="7912060">*</span><span class="ident" id="7912061">testing</span><span class="op" id="7912068">.</span><span class="ident" id="7912069">T</span><span class="op" id="7912070">)</span>&nbsp;<span class="op" id="7912072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7912075">encoded</span>&nbsp;<span class="op" id="7912083">:=</span>&nbsp;<span class="string" id="7912086">`CP/EAT8AAAEF<br>
<span class="lineno">300</span>AQEBAQEBAAAAAAAAAAMAAQIEBQYHCAkKCwEAAQUBAQEBAQEAAAAAAAAAAQACAwQFBgcICQoLEAAB<br>
<span class="lineno"></span>BAEDAgQCBQcGCAUDDDMBAAIRAwQhEjEFQVFhEyJxgTIGFJGhsUIjJBVSwWIzNHKC0UMHJZJT8OHx<br>
<span class="lineno"></span>Y3M1FqKygyZEk1RkRcKjdDYX0lXiZfKzhMPTdePzRieUpIW0lcTU5PSltcXV5fVWZnaGlqa2xtbm<br>
<span class="lineno"></span>9jdHV2d3h5ent8fX5/cRAAICAQIEBAMEBQYHBwYFNQEAAhEDITESBEFRYXEiEwUygZEUobFCI8FS<br>
<span class="lineno"></span>0fAzJGLhcoKSQ1MVY3M08SUGFqKygwcmNcLSRJNUoxdkRVU2dGXi8rOEw9N14/NGlKSFtJXE1OT0<br>
<span class="lineno">305</span>pbXF1eX1VmZ2hpamtsbW5vYnN0dXZ3eHl6e3x//aAAwDAQACEQMRAD8A9VSSSSUpJJJJSkkkJ+Tj<br>
<span class="lineno"></span>1kiy1jCJJDnAcCTykpKkuQ6p/jN6FgmxlNduXawwAzaGH+V6jn/R/wCt71zdn+N/qL3kVYFNYB4N<br>
<span class="lineno"></span>ji6PDVjWpKp9TSXnvTf8bFNjg3qOEa2n6VlLpj/rT/pf567DpX1i6L1hs9Py67X8mqdtg/rUWbbf<br>
<span class="lineno"></span>+gkp0kkkklKSSSSUpJJJJT//0PVUkkklKVLq3WMDpGI7KzrNjADtYNXvI/Mqr/Pd/q9W3vaxjnvM<br>
<span class="lineno"></span>NaCXE9gNSvGPrf8AWS3qmba5jjsJhoB0DAf0NDf6sevf+/lf8Hj0JJATfWT6/dV6oXU1uOLQeKKn<br>
<span class="lineno">310</span>EQP+Hubtfe/+R7Mf/g7f5xcocp++Z11JMCJPgFBxOg7/AOuqDx8I/ikpkXkmSdU8mJIJA/O8EMAy<br>
<span class="lineno"></span>j+mSARB/17pKVXYWHXjsj7yIex0PadzXMO1zT5KHoNA3HT8ietoGhgjsfA+CSnvvqh/jJtqsrwOv<br>
<span class="lineno"></span>2b6NGNzXfTYexzJ+nU7/ALkf4P8Awv6P9KvTQQ4AgyDqCF85Pho3CTB7eHwXoH+LT65uZbX9X+o2<br>
<span class="lineno"></span>bqbPb06551Y4<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7913117">encodedShort</span>&nbsp;<span class="op" id="7913130">:=</span>&nbsp;<span class="ident" id="7913133">strings</span><span class="op" id="7913140">.</span><span class="ident" id="7913141">Replace</span><span class="op" id="7913148">(</span><span class="ident" id="7913149">encoded</span><span class="op" id="7913156">,</span>&nbsp;<span class="string" id="7913158">&#34;\n&#34;</span><span class="op" id="7913162">,</span>&nbsp;<span class="string" id="7913164">&#34;&#34;</span><span class="op" id="7913166">,</span>&nbsp;<span class="op" id="7913168">-</span><span class="num" id="7913169">1</span><span class="op" id="7913170">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7913174">dec</span>&nbsp;<span class="op" id="7913178">:=</span>&nbsp;<span class="ident" id="7913181">NewDecoder</span><span class="op" id="7913191">(</span><span class="ident" id="7913192">StdEncoding</span><span class="op" id="7913203">,</span>&nbsp;<span class="ident" id="7913205">strings</span><span class="op" id="7913212">.</span><span class="ident" id="7913213">NewReader</span><span class="op" id="7913222">(</span><span class="ident" id="7913223">encoded</span><span class="op" id="7913230">)</span><span class="op" id="7913231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7913234">res1</span><span class="op" id="7913238">,</span>&nbsp;<span class="ident" id="7913240">err</span>&nbsp;<span class="op" id="7913244">:=</span>&nbsp;<span class="ident" id="7913247">ioutil</span><span class="op" id="7913253">.</span><span class="ident" id="7913254">ReadAll</span><span class="op" id="7913261">(</span><span class="ident" id="7913262">dec</span><span class="op" id="7913265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7913268">if</span>&nbsp;<span class="ident" id="7913271">err</span>&nbsp;<span class="op" id="7913275">!=</span>&nbsp;<span class="builtintype" id="7913278">nil</span>&nbsp;<span class="op" id="7913282">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7913286">t</span><span class="op" id="7913287">.</span><span class="ident" id="7913288">Errorf</span><span class="op" id="7913294">(</span><span class="string" id="7913295">&#34;ReadAll&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7913315">,</span>&nbsp;<span class="ident" id="7913317">err</span><span class="op" id="7913320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7913323">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7913327">dec</span>&nbsp;<span class="op" id="7913331">=</span>&nbsp;<span class="ident" id="7913333">NewDecoder</span><span class="op" id="7913343">(</span><span class="ident" id="7913344">StdEncoding</span><span class="op" id="7913355">,</span>&nbsp;<span class="ident" id="7913357">strings</span><span class="op" id="7913364">.</span><span class="ident" id="7913365">NewReader</span><span class="op" id="7913374">(</span><span class="ident" id="7913375">encodedShort</span><span class="op" id="7913387">)</span><span class="op" id="7913388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7913391">var</span>&nbsp;<span class="ident" id="7913395">res2</span>&nbsp;<span class="op" id="7913400">[</span><span class="op" id="7913401">]</span><span class="builtintype" id="7913402">byte</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7913408">res2</span><span class="op" id="7913412">,</span>&nbsp;<span class="ident" id="7913414">err</span>&nbsp;<span class="op" id="7913418">=</span>&nbsp;<span class="ident" id="7913420">ioutil</span><span class="op" id="7913426">.</span><span class="ident" id="7913427">ReadAll</span><span class="op" id="7913434">(</span><span class="ident" id="7913435">dec</span><span class="op" id="7913438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7913441">if</span>&nbsp;<span class="ident" id="7913444">err</span>&nbsp;<span class="op" id="7913448">!=</span>&nbsp;<span class="builtintype" id="7913451">nil</span>&nbsp;<span class="op" id="7913455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7913459">t</span><span class="op" id="7913460">.</span><span class="ident" id="7913461">Errorf</span><span class="op" id="7913467">(</span><span class="string" id="7913468">&#34;ReadAll&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7913488">,</span>&nbsp;<span class="ident" id="7913490">err</span><span class="op" id="7913493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7913496">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7913500">if</span>&nbsp;<span class="op" id="7913503">!</span><span class="ident" id="7913504">bytes</span><span class="op" id="7913509">.</span><span class="ident" id="7913510">Equal</span><span class="op" id="7913515">(</span><span class="ident" id="7913516">res1</span><span class="op" id="7913520">,</span>&nbsp;<span class="ident" id="7913522">res2</span><span class="op" id="7913526">)</span>&nbsp;<span class="op" id="7913528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7913532">t</span><span class="op" id="7913533">.</span><span class="ident" id="7913534">Error</span><span class="op" id="7913539">(</span><span class="string" id="7913540">&#34;Decoded&nbsp;results&nbsp;not&nbsp;equal&#34;</span><span class="op" id="7913567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7913570">}</span><br>
<span class="lineno"></span><span class="op" id="7913572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="keyword" id="7913575">func</span>&nbsp;<span class="ident" id="7913580">TestDecoderIssue7733</span><span class="op" id="7913600">(</span><span class="ident" id="7913601">t</span>&nbsp;<span class="op" id="7913603">*</span><span class="ident" id="7913604">testing</span><span class="op" id="7913611">.</span><span class="ident" id="7913612">T</span><span class="op" id="7913613">)</span>&nbsp;<span class="op" id="7913615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7913618">s</span><span class="op" id="7913619">,</span>&nbsp;<span class="ident" id="7913621">err</span>&nbsp;<span class="op" id="7913625">:=</span>&nbsp;<span class="ident" id="7913628">StdEncoding</span><span class="op" id="7913639">.</span><span class="ident" id="7913640">DecodeString</span><span class="op" id="7913652">(</span><span class="string" id="7913653">&#34;YWJjZA=====&#34;</span><span class="op" id="7913666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7913669">want</span>&nbsp;<span class="op" id="7913674">:=</span>&nbsp;<span class="ident" id="7913677">CorruptInputError</span><span class="op" id="7913694">(</span><span class="num" id="7913695">8</span><span class="op" id="7913696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7913699">if</span>&nbsp;<span class="op" id="7913702">!</span><span class="ident" id="7913703">reflect</span><span class="op" id="7913710">.</span><span class="ident" id="7913711">DeepEqual</span><span class="op" id="7913720">(</span><span class="ident" id="7913721">want</span><span class="op" id="7913725">,</span>&nbsp;<span class="ident" id="7913727">err</span><span class="op" id="7913730">)</span>&nbsp;<span class="op" id="7913732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7913736">t</span><span class="op" id="7913737">.</span><span class="ident" id="7913738">Errorf</span><span class="op" id="7913744">(</span><span class="string" id="7913745">&#34;Error&nbsp;=&nbsp;%v;&nbsp;want&nbsp;CorruptInputError(8)&#34;</span><span class="op" id="7913784">,</span>&nbsp;<span class="ident" id="7913786">err</span><span class="op" id="7913789">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7913792">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7913795">if</span>&nbsp;<span class="builtintype" id="7913798">string</span><span class="op" id="7913804">(</span><span class="ident" id="7913805">s</span><span class="op" id="7913806">)</span>&nbsp;<span class="op" id="7913808">!=</span>&nbsp;<span class="string" id="7913811">&#34;abcd&#34;</span>&nbsp;<span class="op" id="7913818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7913822">t</span><span class="op" id="7913823">.</span><span class="ident" id="7913824">Errorf</span><span class="op" id="7913830">(</span><span class="string" id="7913831">&#34;DecodeString&nbsp;=&nbsp;%q;&nbsp;want&nbsp;abcd&#34;</span><span class="op" id="7913861">,</span>&nbsp;<span class="ident" id="7913863">s</span><span class="op" id="7913864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7913867">}</span><br>
<span class="lineno"></span><span class="op" id="7913869">}</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span><span class="keyword" id="7913872">func</span>&nbsp;<span class="ident" id="7913877">BenchmarkEncodeToString</span><span class="op" id="7913900">(</span><span class="ident" id="7913901">b</span>&nbsp;<span class="op" id="7913903">*</span><span class="ident" id="7913904">testing</span><span class="op" id="7913911">.</span><span class="ident" id="7913912">B</span><span class="op" id="7913913">)</span>&nbsp;<span class="op" id="7913915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7913918">data</span>&nbsp;<span class="op" id="7913923">:=</span>&nbsp;<span class="builtinfunc" id="7913926">make</span><span class="op" id="7913930">(</span><span class="op" id="7913931">[</span><span class="op" id="7913932">]</span><span class="builtintype" id="7913933">byte</span><span class="op" id="7913937">,</span>&nbsp;<span class="num" id="7913939">8192</span><span class="op" id="7913943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7913946">b</span><span class="op" id="7913947">.</span><span class="ident" id="7913948">SetBytes</span><span class="op" id="7913956">(</span><span class="ident" id="7913957">int64</span><span class="op" id="7913962">(</span><span class="builtinfunc" id="7913963">len</span><span class="op" id="7913966">(</span><span class="ident" id="7913967">data</span><span class="op" id="7913971">)</span><span class="op" id="7913972">)</span><span class="op" id="7913973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7913976">for</span>&nbsp;<span class="ident" id="7913980">i</span>&nbsp;<span class="op" id="7913982">:=</span>&nbsp;<span class="num" id="7913985">0</span><span class="op" id="7913986">;</span>&nbsp;<span class="ident" id="7913988">i</span>&nbsp;<span class="op" id="7913990">&lt;</span>&nbsp;<span class="ident" id="7913992">b</span><span class="op" id="7913993">.</span><span class="ident" id="7913994">N</span><span class="op" id="7913995">;</span>&nbsp;<span class="ident" id="7913997">i</span><span class="op" id="7913998">++</span>&nbsp;<span class="op" id="7914001">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7914005">StdEncoding</span><span class="op" id="7914016">.</span><span class="ident" id="7914017">EncodeToString</span><span class="op" id="7914031">(</span><span class="ident" id="7914032">data</span><span class="op" id="7914036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7914039">}</span><br>
<span class="lineno"></span><span class="op" id="7914041">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7914044">func</span>&nbsp;<span class="ident" id="7914049">BenchmarkDecodeString</span><span class="op" id="7914070">(</span><span class="ident" id="7914071">b</span>&nbsp;<span class="op" id="7914073">*</span><span class="ident" id="7914074">testing</span><span class="op" id="7914081">.</span><span class="ident" id="7914082">B</span><span class="op" id="7914083">)</span>&nbsp;<span class="op" id="7914085">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7914088">data</span>&nbsp;<span class="op" id="7914093">:=</span>&nbsp;<span class="ident" id="7914096">StdEncoding</span><span class="op" id="7914107">.</span><span class="ident" id="7914108">EncodeToString</span><span class="op" id="7914122">(</span><span class="builtinfunc" id="7914123">make</span><span class="op" id="7914127">(</span><span class="op" id="7914128">[</span><span class="op" id="7914129">]</span><span class="builtintype" id="7914130">byte</span><span class="op" id="7914134">,</span>&nbsp;<span class="num" id="7914136">8192</span><span class="op" id="7914140">)</span><span class="op" id="7914141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7914144">b</span><span class="op" id="7914145">.</span><span class="ident" id="7914146">SetBytes</span><span class="op" id="7914154">(</span><span class="ident" id="7914155">int64</span><span class="op" id="7914160">(</span><span class="builtinfunc" id="7914161">len</span><span class="op" id="7914164">(</span><span class="ident" id="7914165">data</span><span class="op" id="7914169">)</span><span class="op" id="7914170">)</span><span class="op" id="7914171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7914174">for</span>&nbsp;<span class="ident" id="7914178">i</span>&nbsp;<span class="op" id="7914180">:=</span>&nbsp;<span class="num" id="7914183">0</span><span class="op" id="7914184">;</span>&nbsp;<span class="ident" id="7914186">i</span>&nbsp;<span class="op" id="7914188">&lt;</span>&nbsp;<span class="ident" id="7914190">b</span><span class="op" id="7914191">.</span><span class="ident" id="7914192">N</span><span class="op" id="7914193">;</span>&nbsp;<span class="ident" id="7914195">i</span><span class="op" id="7914196">++</span>&nbsp;<span class="op" id="7914199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7914203">StdEncoding</span><span class="op" id="7914214">.</span><span class="ident" id="7914215">DecodeString</span><span class="op" id="7914227">(</span><span class="ident" id="7914228">data</span><span class="op" id="7914232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7914235">}</span><br>
<span class="lineno">360</span><span class="op" id="7914237">}</span>
</div>
</body>
</html>
