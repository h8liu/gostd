<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/template</h2>
<ul>
<li><a href="/gostd/text/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/text/template/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/text/template/examplefiles_test.go.html">examplefiles_test.go</a></li>
<li><a href="/gostd/text/template/examplefunc_test.go.html">examplefunc_test.go</a></li>
<li><a href="/gostd/text/template/exec.go.html">exec.go</a></li>
<li><a href="/gostd/text/template/exec_test.go.html">exec_test.go</a></li>
<li><a href="/gostd/text/template/funcs.go.html">funcs.go</a></li>
<li><a href="/gostd/text/template/helper.go.html">helper.go</a></li>
<li><a href="/gostd/text/template/multi_test.go.html" class="current">multi_test.go</a></li>
<li><a href="/gostd/text/template/template.go.html">template.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7037265">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7037320">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7037374">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7037425">package</span>&nbsp;<span class="ident" id="7037433">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7037443">//&nbsp;Tests&nbsp;for&nbsp;mulitple-template&nbsp;parsing&nbsp;and&nbsp;execution.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7037498">import</span>&nbsp;<span class="op" id="7037505">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7037508">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7037517">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7037524">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7037535">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7037546">&#34;text/template/parse&#34;</span><br>
<span class="lineno">15</span><span class="op" id="7037568">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7037571">const</span>&nbsp;<span class="op" id="7037577">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7037580">noError</span>&nbsp;&nbsp;<span class="op" id="7037589">=</span>&nbsp;<span class="builtintype" id="7037591">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7037597">hasError</span>&nbsp;<span class="op" id="7037606">=</span>&nbsp;<span class="builtintype" id="7037608">false</span><br>
<span class="lineno">20</span><span class="op" id="7037614">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7037617">type</span>&nbsp;<span class="ident" id="7037622">multiParseTest</span>&nbsp;<span class="keyword" id="7037637">struct</span>&nbsp;<span class="op" id="7037644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7037647">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7037655">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7037663">input</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7037671">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7037679">ok</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7037687">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7037693">names</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7037701">[</span><span class="op" id="7037702">]</span><span class="builtintype" id="7037703">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7037711">results</span>&nbsp;<span class="op" id="7037719">[</span><span class="op" id="7037720">]</span><span class="builtintype" id="7037721">string</span><br>
<span class="lineno"></span><span class="op" id="7037728">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="7037731">var</span>&nbsp;<span class="ident" id="7037735">multiParseTests</span>&nbsp;<span class="op" id="7037751">=</span>&nbsp;<span class="op" id="7037753">[</span><span class="op" id="7037754">]</span><span class="ident" id="7037755">multiParseTest</span><span class="op" id="7037769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7037772">{</span><span class="string" id="7037773">&#34;empty&#34;</span><span class="op" id="7037780">,</span>&nbsp;<span class="string" id="7037782">&#34;&#34;</span><span class="op" id="7037784">,</span>&nbsp;<span class="ident" id="7037786">noError</span><span class="op" id="7037793">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7037797">nil</span><span class="op" id="7037800">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7037804">nil</span><span class="op" id="7037807">}</span><span class="op" id="7037808">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7037811">{</span><span class="string" id="7037812">&#34;one&#34;</span><span class="op" id="7037817">,</span>&nbsp;<span class="string" id="7037819">`{{define&nbsp;&#34;foo&#34;}}&nbsp;FOO&nbsp;{{end}}`</span><span class="op" id="7037849">,</span>&nbsp;<span class="ident" id="7037851">noError</span><span class="op" id="7037858">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7037862">[</span><span class="op" id="7037863">]</span><span class="builtintype" id="7037864">string</span><span class="op" id="7037870">{</span><span class="string" id="7037871">&#34;foo&#34;</span><span class="op" id="7037876">}</span><span class="op" id="7037877">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7037881">[</span><span class="op" id="7037882">]</span><span class="builtintype" id="7037883">string</span><span class="op" id="7037889">{</span><span class="string" id="7037890">&#34;&nbsp;FOO&nbsp;&#34;</span><span class="op" id="7037897">}</span><span class="op" id="7037898">}</span><span class="op" id="7037899">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7037902">{</span><span class="string" id="7037903">&#34;two&#34;</span><span class="op" id="7037908">,</span>&nbsp;<span class="string" id="7037910">`{{define&nbsp;&#34;foo&#34;}}&nbsp;FOO&nbsp;{{end}}{{define&nbsp;&#34;bar&#34;}}&nbsp;BAR&nbsp;{{end}}`</span><span class="op" id="7037968">,</span>&nbsp;<span class="ident" id="7037970">noError</span><span class="op" id="7037977">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7037981">[</span><span class="op" id="7037982">]</span><span class="builtintype" id="7037983">string</span><span class="op" id="7037989">{</span><span class="string" id="7037990">&#34;foo&#34;</span><span class="op" id="7037995">,</span>&nbsp;<span class="string" id="7037997">&#34;bar&#34;</span><span class="op" id="7038002">}</span><span class="op" id="7038003">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7038007">[</span><span class="op" id="7038008">]</span><span class="builtintype" id="7038009">string</span><span class="op" id="7038015">{</span><span class="string" id="7038016">&#34;&nbsp;FOO&nbsp;&#34;</span><span class="op" id="7038023">,</span>&nbsp;<span class="string" id="7038025">&#34;&nbsp;BAR&nbsp;&#34;</span><span class="op" id="7038032">}</span><span class="op" id="7038033">}</span><span class="op" id="7038034">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7038037">//&nbsp;errors</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7038048">{</span><span class="string" id="7038049">&#34;missing&nbsp;end&#34;</span><span class="op" id="7038062">,</span>&nbsp;<span class="string" id="7038064">`{{define&nbsp;&#34;foo&#34;}}&nbsp;FOO&nbsp;`</span><span class="op" id="7038087">,</span>&nbsp;<span class="ident" id="7038089">hasError</span><span class="op" id="7038097">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7038101">nil</span><span class="op" id="7038104">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7038108">nil</span><span class="op" id="7038111">}</span><span class="op" id="7038112">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7038115">{</span><span class="string" id="7038116">&#34;malformed&nbsp;name&#34;</span><span class="op" id="7038132">,</span>&nbsp;<span class="string" id="7038134">`{{define&nbsp;&#34;foo}}&nbsp;FOO&nbsp;`</span><span class="op" id="7038156">,</span>&nbsp;<span class="ident" id="7038158">hasError</span><span class="op" id="7038166">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7038170">nil</span><span class="op" id="7038173">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7038177">nil</span><span class="op" id="7038180">}</span><span class="op" id="7038181">,</span><br>
<span class="lineno"></span><span class="op" id="7038183">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7038186">func</span>&nbsp;<span class="ident" id="7038191">TestMultiParse</span><span class="op" id="7038205">(</span><span class="ident" id="7038206">t</span>&nbsp;<span class="op" id="7038208">*</span><span class="ident" id="7038209">testing</span><span class="op" id="7038216">.</span><span class="ident" id="7038217">T</span><span class="op" id="7038218">)</span>&nbsp;<span class="op" id="7038220">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7038223">for</span>&nbsp;<span class="ident" id="7038227">_</span><span class="op" id="7038228">,</span>&nbsp;<span class="ident" id="7038230">test</span>&nbsp;<span class="op" id="7038235">:=</span>&nbsp;<span class="keyword" id="7038238">range</span>&nbsp;<span class="ident" id="7038244">multiParseTests</span>&nbsp;<span class="op" id="7038260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7038264">template</span><span class="op" id="7038272">,</span>&nbsp;<span class="ident" id="7038274">err</span>&nbsp;<span class="op" id="7038278">:=</span>&nbsp;<span class="ident" id="7038281">New</span><span class="op" id="7038284">(</span><span class="string" id="7038285">&#34;root&#34;</span><span class="op" id="7038291">)</span><span class="op" id="7038292">.</span><span class="ident" id="7038293">Parse</span><span class="op" id="7038298">(</span><span class="ident" id="7038299">test</span><span class="op" id="7038303">.</span><span class="ident" id="7038304">input</span><span class="op" id="7038309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7038313">switch</span>&nbsp;<span class="op" id="7038320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7038324">case</span>&nbsp;<span class="ident" id="7038329">err</span>&nbsp;<span class="op" id="7038333">==</span>&nbsp;<span class="builtintype" id="7038336">nil</span>&nbsp;<span class="op" id="7038340">&amp;&amp;</span>&nbsp;<span class="op" id="7038343">!</span><span class="ident" id="7038344">test</span><span class="op" id="7038348">.</span><span class="ident" id="7038349">ok</span><span class="op" id="7038351">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7038356">t</span><span class="op" id="7038357">.</span><span class="ident" id="7038358">Errorf</span><span class="op" id="7038364">(</span><span class="string" id="7038365">&#34;%q:&nbsp;expected&nbsp;error;&nbsp;got&nbsp;none&#34;</span><span class="op" id="7038395">,</span>&nbsp;<span class="ident" id="7038397">test</span><span class="op" id="7038401">.</span><span class="ident" id="7038402">name</span><span class="op" id="7038406">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7038411">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7038422">case</span>&nbsp;<span class="ident" id="7038427">err</span>&nbsp;<span class="op" id="7038431">!=</span>&nbsp;<span class="builtintype" id="7038434">nil</span>&nbsp;<span class="op" id="7038438">&amp;&amp;</span>&nbsp;<span class="ident" id="7038441">test</span><span class="op" id="7038445">.</span><span class="ident" id="7038446">ok</span><span class="op" id="7038448">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7038453">t</span><span class="op" id="7038454">.</span><span class="ident" id="7038455">Errorf</span><span class="op" id="7038461">(</span><span class="string" id="7038462">&#34;%q:&nbsp;unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="7038488">,</span>&nbsp;<span class="ident" id="7038490">test</span><span class="op" id="7038494">.</span><span class="ident" id="7038495">name</span><span class="op" id="7038499">,</span>&nbsp;<span class="ident" id="7038501">err</span><span class="op" id="7038504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7038509">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7038520">case</span>&nbsp;<span class="ident" id="7038525">err</span>&nbsp;<span class="op" id="7038529">!=</span>&nbsp;<span class="builtintype" id="7038532">nil</span>&nbsp;<span class="op" id="7038536">&amp;&amp;</span>&nbsp;<span class="op" id="7038539">!</span><span class="ident" id="7038540">test</span><span class="op" id="7038544">.</span><span class="ident" id="7038545">ok</span><span class="op" id="7038547">:</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7038552">//&nbsp;expected&nbsp;error,&nbsp;got&nbsp;one</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7038582">if</span>&nbsp;<span class="op" id="7038585">*</span><span class="ident" id="7038586">debug</span>&nbsp;<span class="op" id="7038592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7038598">fmt</span><span class="op" id="7038601">.</span><span class="ident" id="7038602">Printf</span><span class="op" id="7038608">(</span><span class="string" id="7038609">&#34;%s:&nbsp;%s\n\t%s\n&#34;</span><span class="op" id="7038625">,</span>&nbsp;<span class="ident" id="7038627">test</span><span class="op" id="7038631">.</span><span class="ident" id="7038632">name</span><span class="op" id="7038636">,</span>&nbsp;<span class="ident" id="7038638">test</span><span class="op" id="7038642">.</span><span class="ident" id="7038643">input</span><span class="op" id="7038648">,</span>&nbsp;<span class="ident" id="7038650">err</span><span class="op" id="7038653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7038658">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7038663">continue</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7038674">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7038678">if</span>&nbsp;<span class="ident" id="7038681">template</span>&nbsp;<span class="op" id="7038690">==</span>&nbsp;<span class="builtintype" id="7038693">nil</span>&nbsp;<span class="op" id="7038697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7038702">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7038713">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7038717">if</span>&nbsp;<span class="builtinfunc" id="7038720">len</span><span class="op" id="7038723">(</span><span class="ident" id="7038724">template</span><span class="op" id="7038732">.</span><span class="ident" id="7038733">tmpl</span><span class="op" id="7038737">)</span>&nbsp;<span class="op" id="7038739">!=</span>&nbsp;<span class="builtinfunc" id="7038742">len</span><span class="op" id="7038745">(</span><span class="ident" id="7038746">test</span><span class="op" id="7038750">.</span><span class="ident" id="7038751">names</span><span class="op" id="7038756">)</span><span class="op" id="7038757">+</span><span class="num" id="7038758">1</span>&nbsp;<span class="op" id="7038760">{</span>&nbsp;<span class="comment" id="7038762">//&nbsp;+1&nbsp;for&nbsp;root</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7038780">t</span><span class="op" id="7038781">.</span><span class="ident" id="7038782">Errorf</span><span class="op" id="7038788">(</span><span class="string" id="7038789">&#34;%s:&nbsp;wrong&nbsp;number&nbsp;of&nbsp;templates;&nbsp;wanted&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7038838">,</span>&nbsp;<span class="ident" id="7038840">test</span><span class="op" id="7038844">.</span><span class="ident" id="7038845">name</span><span class="op" id="7038849">,</span>&nbsp;<span class="builtinfunc" id="7038851">len</span><span class="op" id="7038854">(</span><span class="ident" id="7038855">test</span><span class="op" id="7038859">.</span><span class="ident" id="7038860">names</span><span class="op" id="7038865">)</span><span class="op" id="7038866">,</span>&nbsp;<span class="builtinfunc" id="7038868">len</span><span class="op" id="7038871">(</span><span class="ident" id="7038872">template</span><span class="op" id="7038880">.</span><span class="ident" id="7038881">tmpl</span><span class="op" id="7038885">)</span><span class="op" id="7038886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7038891">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7038902">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7038906">for</span>&nbsp;<span class="ident" id="7038910">i</span><span class="op" id="7038911">,</span>&nbsp;<span class="ident" id="7038913">name</span>&nbsp;<span class="op" id="7038918">:=</span>&nbsp;<span class="keyword" id="7038921">range</span>&nbsp;<span class="ident" id="7038927">test</span><span class="op" id="7038931">.</span><span class="ident" id="7038932">names</span>&nbsp;<span class="op" id="7038938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7038943">tmpl</span><span class="op" id="7038947">,</span>&nbsp;<span class="ident" id="7038949">ok</span>&nbsp;<span class="op" id="7038952">:=</span>&nbsp;<span class="ident" id="7038955">template</span><span class="op" id="7038963">.</span><span class="ident" id="7038964">tmpl</span><span class="op" id="7038968">[</span><span class="ident" id="7038969">name</span><span class="op" id="7038973">]</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7038978">if</span>&nbsp;<span class="op" id="7038981">!</span><span class="ident" id="7038982">ok</span>&nbsp;<span class="op" id="7038985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7038991">t</span><span class="op" id="7038992">.</span><span class="ident" id="7038993">Errorf</span><span class="op" id="7038999">(</span><span class="string" id="7039000">&#34;%s:&nbsp;can&#39;t&nbsp;find&nbsp;template&nbsp;%q&#34;</span><span class="op" id="7039028">,</span>&nbsp;<span class="ident" id="7039030">test</span><span class="op" id="7039034">.</span><span class="ident" id="7039035">name</span><span class="op" id="7039039">,</span>&nbsp;<span class="ident" id="7039041">name</span><span class="op" id="7039045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7039051">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7039063">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7039068">result</span>&nbsp;<span class="op" id="7039075">:=</span>&nbsp;<span class="ident" id="7039078">tmpl</span><span class="op" id="7039082">.</span><span class="ident" id="7039083">Root</span><span class="op" id="7039087">.</span><span class="ident" id="7039088">String</span><span class="op" id="7039094">(</span><span class="op" id="7039095">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7039100">if</span>&nbsp;<span class="ident" id="7039103">result</span>&nbsp;<span class="op" id="7039110">!=</span>&nbsp;<span class="ident" id="7039113">test</span><span class="op" id="7039117">.</span><span class="ident" id="7039118">results</span><span class="op" id="7039125">[</span><span class="ident" id="7039126">i</span><span class="op" id="7039127">]</span>&nbsp;<span class="op" id="7039129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7039135">t</span><span class="op" id="7039136">.</span><span class="ident" id="7039137">Errorf</span><span class="op" id="7039143">(</span><span class="string" id="7039144">&#34;%s=(%q):&nbsp;got\n\t%v\nexpected\n\t%v&#34;</span><span class="op" id="7039180">,</span>&nbsp;<span class="ident" id="7039182">test</span><span class="op" id="7039186">.</span><span class="ident" id="7039187">name</span><span class="op" id="7039191">,</span>&nbsp;<span class="ident" id="7039193">test</span><span class="op" id="7039197">.</span><span class="ident" id="7039198">input</span><span class="op" id="7039203">,</span>&nbsp;<span class="ident" id="7039205">result</span><span class="op" id="7039211">,</span>&nbsp;<span class="ident" id="7039213">test</span><span class="op" id="7039217">.</span><span class="ident" id="7039218">results</span><span class="op" id="7039225">[</span><span class="ident" id="7039226">i</span><span class="op" id="7039227">]</span><span class="op" id="7039228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7039233">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7039237">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7039240">}</span><br>
<span class="lineno">85</span><span class="op" id="7039242">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7039245">var</span>&nbsp;<span class="ident" id="7039249">multiExecTests</span>&nbsp;<span class="op" id="7039264">=</span>&nbsp;<span class="op" id="7039266">[</span><span class="op" id="7039267">]</span><span class="ident" id="7039268">execTest</span><span class="op" id="7039276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7039279">{</span><span class="string" id="7039280">&#34;empty&#34;</span><span class="op" id="7039287">,</span>&nbsp;<span class="string" id="7039289">&#34;&#34;</span><span class="op" id="7039291">,</span>&nbsp;<span class="string" id="7039293">&#34;&#34;</span><span class="op" id="7039295">,</span>&nbsp;<span class="builtintype" id="7039297">nil</span><span class="op" id="7039300">,</span>&nbsp;<span class="builtintype" id="7039302">true</span><span class="op" id="7039306">}</span><span class="op" id="7039307">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7039310">{</span><span class="string" id="7039311">&#34;text&#34;</span><span class="op" id="7039317">,</span>&nbsp;<span class="string" id="7039319">&#34;some&nbsp;text&#34;</span><span class="op" id="7039330">,</span>&nbsp;<span class="string" id="7039332">&#34;some&nbsp;text&#34;</span><span class="op" id="7039343">,</span>&nbsp;<span class="builtintype" id="7039345">nil</span><span class="op" id="7039348">,</span>&nbsp;<span class="builtintype" id="7039350">true</span><span class="op" id="7039354">}</span><span class="op" id="7039355">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7039358">{</span><span class="string" id="7039359">&#34;invoke&nbsp;x&#34;</span><span class="op" id="7039369">,</span>&nbsp;<span class="string" id="7039371">`{{template&nbsp;&#34;x&#34;&nbsp;.SI}}`</span><span class="op" id="7039393">,</span>&nbsp;<span class="string" id="7039395">&#34;TEXT&#34;</span><span class="op" id="7039401">,</span>&nbsp;<span class="ident" id="7039403">tVal</span><span class="op" id="7039407">,</span>&nbsp;<span class="builtintype" id="7039409">true</span><span class="op" id="7039413">}</span><span class="op" id="7039414">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7039417">{</span><span class="string" id="7039418">&#34;invoke&nbsp;x&nbsp;no&nbsp;args&#34;</span><span class="op" id="7039436">,</span>&nbsp;<span class="string" id="7039438">`{{template&nbsp;&#34;x&#34;}}`</span><span class="op" id="7039456">,</span>&nbsp;<span class="string" id="7039458">&#34;TEXT&#34;</span><span class="op" id="7039464">,</span>&nbsp;<span class="ident" id="7039466">tVal</span><span class="op" id="7039470">,</span>&nbsp;<span class="builtintype" id="7039472">true</span><span class="op" id="7039476">}</span><span class="op" id="7039477">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7039480">{</span><span class="string" id="7039481">&#34;invoke&nbsp;dot&nbsp;int&#34;</span><span class="op" id="7039497">,</span>&nbsp;<span class="string" id="7039499">`{{template&nbsp;&#34;dot&#34;&nbsp;.I}}`</span><span class="op" id="7039522">,</span>&nbsp;<span class="string" id="7039524">&#34;17&#34;</span><span class="op" id="7039528">,</span>&nbsp;<span class="ident" id="7039530">tVal</span><span class="op" id="7039534">,</span>&nbsp;<span class="builtintype" id="7039536">true</span><span class="op" id="7039540">}</span><span class="op" id="7039541">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7039544">{</span><span class="string" id="7039545">&#34;invoke&nbsp;dot&nbsp;[]int&#34;</span><span class="op" id="7039563">,</span>&nbsp;<span class="string" id="7039565">`{{template&nbsp;&#34;dot&#34;&nbsp;.SI}}`</span><span class="op" id="7039589">,</span>&nbsp;<span class="string" id="7039591">&#34;[3&nbsp;4&nbsp;5]&#34;</span><span class="op" id="7039600">,</span>&nbsp;<span class="ident" id="7039602">tVal</span><span class="op" id="7039606">,</span>&nbsp;<span class="builtintype" id="7039608">true</span><span class="op" id="7039612">}</span><span class="op" id="7039613">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7039616">{</span><span class="string" id="7039617">&#34;invoke&nbsp;dotV&#34;</span><span class="op" id="7039630">,</span>&nbsp;<span class="string" id="7039632">`{{template&nbsp;&#34;dotV&#34;&nbsp;.U}}`</span><span class="op" id="7039656">,</span>&nbsp;<span class="string" id="7039658">&#34;v&#34;</span><span class="op" id="7039661">,</span>&nbsp;<span class="ident" id="7039663">tVal</span><span class="op" id="7039667">,</span>&nbsp;<span class="builtintype" id="7039669">true</span><span class="op" id="7039673">}</span><span class="op" id="7039674">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7039677">{</span><span class="string" id="7039678">&#34;invoke&nbsp;nested&nbsp;int&#34;</span><span class="op" id="7039697">,</span>&nbsp;<span class="string" id="7039699">`{{template&nbsp;&#34;nested&#34;&nbsp;.I}}`</span><span class="op" id="7039725">,</span>&nbsp;<span class="string" id="7039727">&#34;17&#34;</span><span class="op" id="7039731">,</span>&nbsp;<span class="ident" id="7039733">tVal</span><span class="op" id="7039737">,</span>&nbsp;<span class="builtintype" id="7039739">true</span><span class="op" id="7039743">}</span><span class="op" id="7039744">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7039747">{</span><span class="string" id="7039748">&#34;variable&nbsp;declared&nbsp;by&nbsp;template&#34;</span><span class="op" id="7039779">,</span>&nbsp;<span class="string" id="7039781">`{{template&nbsp;&#34;nested&#34;&nbsp;$x:=.SI}},{{index&nbsp;$x&nbsp;1}}`</span><span class="op" id="7039827">,</span>&nbsp;<span class="string" id="7039829">&#34;[3&nbsp;4&nbsp;5],4&#34;</span><span class="op" id="7039840">,</span>&nbsp;<span class="ident" id="7039842">tVal</span><span class="op" id="7039846">,</span>&nbsp;<span class="builtintype" id="7039848">true</span><span class="op" id="7039852">}</span><span class="op" id="7039853">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7039857">//&nbsp;User-defined&nbsp;function:&nbsp;test&nbsp;argument&nbsp;evaluator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7039909">{</span><span class="string" id="7039910">&#34;testFunc&nbsp;literal&#34;</span><span class="op" id="7039928">,</span>&nbsp;<span class="string" id="7039930">`{{oneArg&nbsp;&#34;joe&#34;}}`</span><span class="op" id="7039948">,</span>&nbsp;<span class="string" id="7039950">&#34;oneArg=joe&#34;</span><span class="op" id="7039962">,</span>&nbsp;<span class="ident" id="7039964">tVal</span><span class="op" id="7039968">,</span>&nbsp;<span class="builtintype" id="7039970">true</span><span class="op" id="7039974">}</span><span class="op" id="7039975">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7039978">{</span><span class="string" id="7039979">&#34;testFunc&nbsp;.&#34;</span><span class="op" id="7039991">,</span>&nbsp;<span class="string" id="7039993">`{{oneArg&nbsp;.}}`</span><span class="op" id="7040007">,</span>&nbsp;<span class="string" id="7040009">&#34;oneArg=joe&#34;</span><span class="op" id="7040021">,</span>&nbsp;<span class="string" id="7040023">&#34;joe&#34;</span><span class="op" id="7040028">,</span>&nbsp;<span class="builtintype" id="7040030">true</span><span class="op" id="7040034">}</span><span class="op" id="7040035">,</span><br>
<span class="lineno"></span><span class="op" id="7040037">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7040040">//&nbsp;These&nbsp;strings&nbsp;are&nbsp;also&nbsp;in&nbsp;testdata/*.</span><br>
<span class="lineno"></span><span class="keyword" id="7040081">const</span>&nbsp;<span class="ident" id="7040087">multiText1</span>&nbsp;<span class="op" id="7040098">=</span>&nbsp;<span class="string" id="7040100">`<br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;{{define&nbsp;&#34;x&#34;}}TEXT{{end}}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;{{define&nbsp;&#34;dotV&#34;}}{{.V}}{{end}}<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7040164">const</span>&nbsp;<span class="ident" id="7040170">multiText2</span>&nbsp;<span class="op" id="7040181">=</span>&nbsp;<span class="string" id="7040183">`<br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;{{define&nbsp;&#34;dot&#34;}}{{.}}{{end}}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;{{define&nbsp;&#34;nested&#34;}}{{template&nbsp;&#34;dot&#34;&nbsp;.}}{{end}}<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7040266">func</span>&nbsp;<span class="ident" id="7040271">TestMultiExecute</span><span class="op" id="7040287">(</span><span class="ident" id="7040288">t</span>&nbsp;<span class="op" id="7040290">*</span><span class="ident" id="7040291">testing</span><span class="op" id="7040298">.</span><span class="ident" id="7040299">T</span><span class="op" id="7040300">)</span>&nbsp;<span class="op" id="7040302">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7040305">//&nbsp;Declare&nbsp;a&nbsp;couple&nbsp;of&nbsp;templates&nbsp;first.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7040346">template</span><span class="op" id="7040354">,</span>&nbsp;<span class="ident" id="7040356">err</span>&nbsp;<span class="op" id="7040360">:=</span>&nbsp;<span class="ident" id="7040363">New</span><span class="op" id="7040366">(</span><span class="string" id="7040367">&#34;root&#34;</span><span class="op" id="7040373">)</span><span class="op" id="7040374">.</span><span class="ident" id="7040375">Parse</span><span class="op" id="7040380">(</span><span class="ident" id="7040381">multiText1</span><span class="op" id="7040391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7040394">if</span>&nbsp;<span class="ident" id="7040397">err</span>&nbsp;<span class="op" id="7040401">!=</span>&nbsp;<span class="builtintype" id="7040404">nil</span>&nbsp;<span class="op" id="7040408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7040412">t</span><span class="op" id="7040413">.</span><span class="ident" id="7040414">Fatalf</span><span class="op" id="7040420">(</span><span class="string" id="7040421">&#34;parse&nbsp;error&nbsp;for&nbsp;1:&nbsp;%s&#34;</span><span class="op" id="7040444">,</span>&nbsp;<span class="ident" id="7040446">err</span><span class="op" id="7040449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7040452">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7040455">_</span><span class="op" id="7040456">,</span>&nbsp;<span class="ident" id="7040458">err</span>&nbsp;<span class="op" id="7040462">=</span>&nbsp;<span class="ident" id="7040464">template</span><span class="op" id="7040472">.</span><span class="ident" id="7040473">Parse</span><span class="op" id="7040478">(</span><span class="ident" id="7040479">multiText2</span><span class="op" id="7040489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7040492">if</span>&nbsp;<span class="ident" id="7040495">err</span>&nbsp;<span class="op" id="7040499">!=</span>&nbsp;<span class="builtintype" id="7040502">nil</span>&nbsp;<span class="op" id="7040506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7040510">t</span><span class="op" id="7040511">.</span><span class="ident" id="7040512">Fatalf</span><span class="op" id="7040518">(</span><span class="string" id="7040519">&#34;parse&nbsp;error&nbsp;for&nbsp;2:&nbsp;%s&#34;</span><span class="op" id="7040542">,</span>&nbsp;<span class="ident" id="7040544">err</span><span class="op" id="7040547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7040550">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7040553">testExecute</span><span class="op" id="7040564">(</span><span class="ident" id="7040565">multiExecTests</span><span class="op" id="7040579">,</span>&nbsp;<span class="ident" id="7040581">template</span><span class="op" id="7040589">,</span>&nbsp;<span class="ident" id="7040591">t</span><span class="op" id="7040592">)</span><br>
<span class="lineno">125</span><span class="op" id="7040594">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7040597">func</span>&nbsp;<span class="ident" id="7040602">TestParseFiles</span><span class="op" id="7040616">(</span><span class="ident" id="7040617">t</span>&nbsp;<span class="op" id="7040619">*</span><span class="ident" id="7040620">testing</span><span class="op" id="7040627">.</span><span class="ident" id="7040628">T</span><span class="op" id="7040629">)</span>&nbsp;<span class="op" id="7040631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7040634">_</span><span class="op" id="7040635">,</span>&nbsp;<span class="ident" id="7040637">err</span>&nbsp;<span class="op" id="7040641">:=</span>&nbsp;<span class="ident" id="7040644">ParseFiles</span><span class="op" id="7040654">(</span><span class="string" id="7040655">&#34;DOES&nbsp;NOT&nbsp;EXIST&#34;</span><span class="op" id="7040671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7040674">if</span>&nbsp;<span class="ident" id="7040677">err</span>&nbsp;<span class="op" id="7040681">==</span>&nbsp;<span class="builtintype" id="7040684">nil</span>&nbsp;<span class="op" id="7040688">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7040692">t</span><span class="op" id="7040693">.</span><span class="ident" id="7040694">Error</span><span class="op" id="7040699">(</span><span class="string" id="7040700">&#34;expected&nbsp;error&nbsp;for&nbsp;non-existent&nbsp;file;&nbsp;got&nbsp;none&#34;</span><span class="op" id="7040748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7040751">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7040754">template</span>&nbsp;<span class="op" id="7040763">:=</span>&nbsp;<span class="ident" id="7040766">New</span><span class="op" id="7040769">(</span><span class="string" id="7040770">&#34;root&#34;</span><span class="op" id="7040776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7040779">_</span><span class="op" id="7040780">,</span>&nbsp;<span class="ident" id="7040782">err</span>&nbsp;<span class="op" id="7040786">=</span>&nbsp;<span class="ident" id="7040788">template</span><span class="op" id="7040796">.</span><span class="ident" id="7040797">ParseFiles</span><span class="op" id="7040807">(</span><span class="string" id="7040808">&#34;testdata/file1.tmpl&#34;</span><span class="op" id="7040829">,</span>&nbsp;<span class="string" id="7040831">&#34;testdata/file2.tmpl&#34;</span><span class="op" id="7040852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7040855">if</span>&nbsp;<span class="ident" id="7040858">err</span>&nbsp;<span class="op" id="7040862">!=</span>&nbsp;<span class="builtintype" id="7040865">nil</span>&nbsp;<span class="op" id="7040869">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7040873">t</span><span class="op" id="7040874">.</span><span class="ident" id="7040875">Fatalf</span><span class="op" id="7040881">(</span><span class="string" id="7040882">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="7040907">,</span>&nbsp;<span class="ident" id="7040909">err</span><span class="op" id="7040912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7040915">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7040918">testExecute</span><span class="op" id="7040929">(</span><span class="ident" id="7040930">multiExecTests</span><span class="op" id="7040944">,</span>&nbsp;<span class="ident" id="7040946">template</span><span class="op" id="7040954">,</span>&nbsp;<span class="ident" id="7040956">t</span><span class="op" id="7040957">)</span><br>
<span class="lineno"></span><span class="op" id="7040959">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="keyword" id="7040962">func</span>&nbsp;<span class="ident" id="7040967">TestParseGlob</span><span class="op" id="7040980">(</span><span class="ident" id="7040981">t</span>&nbsp;<span class="op" id="7040983">*</span><span class="ident" id="7040984">testing</span><span class="op" id="7040991">.</span><span class="ident" id="7040992">T</span><span class="op" id="7040993">)</span>&nbsp;<span class="op" id="7040995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7040998">_</span><span class="op" id="7040999">,</span>&nbsp;<span class="ident" id="7041001">err</span>&nbsp;<span class="op" id="7041005">:=</span>&nbsp;<span class="ident" id="7041008">ParseGlob</span><span class="op" id="7041017">(</span><span class="string" id="7041018">&#34;DOES&nbsp;NOT&nbsp;EXIST&#34;</span><span class="op" id="7041034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7041037">if</span>&nbsp;<span class="ident" id="7041040">err</span>&nbsp;<span class="op" id="7041044">==</span>&nbsp;<span class="builtintype" id="7041047">nil</span>&nbsp;<span class="op" id="7041051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7041055">t</span><span class="op" id="7041056">.</span><span class="ident" id="7041057">Error</span><span class="op" id="7041062">(</span><span class="string" id="7041063">&#34;expected&nbsp;error&nbsp;for&nbsp;non-existent&nbsp;file;&nbsp;got&nbsp;none&#34;</span><span class="op" id="7041111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7041114">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7041117">_</span><span class="op" id="7041118">,</span>&nbsp;<span class="ident" id="7041120">err</span>&nbsp;<span class="op" id="7041124">=</span>&nbsp;<span class="ident" id="7041126">New</span><span class="op" id="7041129">(</span><span class="string" id="7041130">&#34;error&#34;</span><span class="op" id="7041137">)</span><span class="op" id="7041138">.</span><span class="ident" id="7041139">ParseGlob</span><span class="op" id="7041148">(</span><span class="string" id="7041149">&#34;[x&#34;</span><span class="op" id="7041153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7041156">if</span>&nbsp;<span class="ident" id="7041159">err</span>&nbsp;<span class="op" id="7041163">==</span>&nbsp;<span class="builtintype" id="7041166">nil</span>&nbsp;<span class="op" id="7041170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7041174">t</span><span class="op" id="7041175">.</span><span class="ident" id="7041176">Error</span><span class="op" id="7041181">(</span><span class="string" id="7041182">&#34;expected&nbsp;error&nbsp;for&nbsp;bad&nbsp;pattern;&nbsp;got&nbsp;none&#34;</span><span class="op" id="7041224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7041227">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7041230">template</span>&nbsp;<span class="op" id="7041239">:=</span>&nbsp;<span class="ident" id="7041242">New</span><span class="op" id="7041245">(</span><span class="string" id="7041246">&#34;root&#34;</span><span class="op" id="7041252">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7041255">_</span><span class="op" id="7041256">,</span>&nbsp;<span class="ident" id="7041258">err</span>&nbsp;<span class="op" id="7041262">=</span>&nbsp;<span class="ident" id="7041264">template</span><span class="op" id="7041272">.</span><span class="ident" id="7041273">ParseGlob</span><span class="op" id="7041282">(</span><span class="string" id="7041283">&#34;testdata/file*.tmpl&#34;</span><span class="op" id="7041304">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7041307">if</span>&nbsp;<span class="ident" id="7041310">err</span>&nbsp;<span class="op" id="7041314">!=</span>&nbsp;<span class="builtintype" id="7041317">nil</span>&nbsp;<span class="op" id="7041321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7041325">t</span><span class="op" id="7041326">.</span><span class="ident" id="7041327">Fatalf</span><span class="op" id="7041333">(</span><span class="string" id="7041334">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="7041359">,</span>&nbsp;<span class="ident" id="7041361">err</span><span class="op" id="7041364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7041367">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7041370">testExecute</span><span class="op" id="7041381">(</span><span class="ident" id="7041382">multiExecTests</span><span class="op" id="7041396">,</span>&nbsp;<span class="ident" id="7041398">template</span><span class="op" id="7041406">,</span>&nbsp;<span class="ident" id="7041408">t</span><span class="op" id="7041409">)</span><br>
<span class="lineno">155</span><span class="op" id="7041411">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7041414">//&nbsp;In&nbsp;these&nbsp;tests,&nbsp;actual&nbsp;content&nbsp;(not&nbsp;just&nbsp;template&nbsp;definitions)&nbsp;comes&nbsp;from&nbsp;the&nbsp;parsed&nbsp;files.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7041510">var</span>&nbsp;<span class="ident" id="7041514">templateFileExecTests</span>&nbsp;<span class="op" id="7041536">=</span>&nbsp;<span class="op" id="7041538">[</span><span class="op" id="7041539">]</span><span class="ident" id="7041540">execTest</span><span class="op" id="7041548">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7041551">{</span><span class="string" id="7041552">&#34;test&#34;</span><span class="op" id="7041558">,</span>&nbsp;<span class="string" id="7041560">`{{template&nbsp;&#34;tmpl1.tmpl&#34;}}{{template&nbsp;&#34;tmpl2.tmpl&#34;}}`</span><span class="op" id="7041612">,</span>&nbsp;<span class="string" id="7041614">&#34;template1\n\ny\ntemplate2\n\nx\n&#34;</span><span class="op" id="7041648">,</span>&nbsp;<span class="num" id="7041650">0</span><span class="op" id="7041651">,</span>&nbsp;<span class="builtintype" id="7041653">true</span><span class="op" id="7041657">}</span><span class="op" id="7041658">,</span><br>
<span class="lineno"></span><span class="op" id="7041660">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7041663">func</span>&nbsp;<span class="ident" id="7041668">TestParseFilesWithData</span><span class="op" id="7041690">(</span><span class="ident" id="7041691">t</span>&nbsp;<span class="op" id="7041693">*</span><span class="ident" id="7041694">testing</span><span class="op" id="7041701">.</span><span class="ident" id="7041702">T</span><span class="op" id="7041703">)</span>&nbsp;<span class="op" id="7041705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7041708">template</span><span class="op" id="7041716">,</span>&nbsp;<span class="ident" id="7041718">err</span>&nbsp;<span class="op" id="7041722">:=</span>&nbsp;<span class="ident" id="7041725">New</span><span class="op" id="7041728">(</span><span class="string" id="7041729">&#34;root&#34;</span><span class="op" id="7041735">)</span><span class="op" id="7041736">.</span><span class="ident" id="7041737">ParseFiles</span><span class="op" id="7041747">(</span><span class="string" id="7041748">&#34;testdata/tmpl1.tmpl&#34;</span><span class="op" id="7041769">,</span>&nbsp;<span class="string" id="7041771">&#34;testdata/tmpl2.tmpl&#34;</span><span class="op" id="7041792">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7041795">if</span>&nbsp;<span class="ident" id="7041798">err</span>&nbsp;<span class="op" id="7041802">!=</span>&nbsp;<span class="builtintype" id="7041805">nil</span>&nbsp;<span class="op" id="7041809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7041813">t</span><span class="op" id="7041814">.</span><span class="ident" id="7041815">Fatalf</span><span class="op" id="7041821">(</span><span class="string" id="7041822">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="7041847">,</span>&nbsp;<span class="ident" id="7041849">err</span><span class="op" id="7041852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7041855">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7041858">testExecute</span><span class="op" id="7041869">(</span><span class="ident" id="7041870">templateFileExecTests</span><span class="op" id="7041891">,</span>&nbsp;<span class="ident" id="7041893">template</span><span class="op" id="7041901">,</span>&nbsp;<span class="ident" id="7041903">t</span><span class="op" id="7041904">)</span><br>
<span class="lineno"></span><span class="op" id="7041906">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="7041909">func</span>&nbsp;<span class="ident" id="7041914">TestParseGlobWithData</span><span class="op" id="7041935">(</span><span class="ident" id="7041936">t</span>&nbsp;<span class="op" id="7041938">*</span><span class="ident" id="7041939">testing</span><span class="op" id="7041946">.</span><span class="ident" id="7041947">T</span><span class="op" id="7041948">)</span>&nbsp;<span class="op" id="7041950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7041953">template</span><span class="op" id="7041961">,</span>&nbsp;<span class="ident" id="7041963">err</span>&nbsp;<span class="op" id="7041967">:=</span>&nbsp;<span class="ident" id="7041970">New</span><span class="op" id="7041973">(</span><span class="string" id="7041974">&#34;root&#34;</span><span class="op" id="7041980">)</span><span class="op" id="7041981">.</span><span class="ident" id="7041982">ParseGlob</span><span class="op" id="7041991">(</span><span class="string" id="7041992">&#34;testdata/tmpl*.tmpl&#34;</span><span class="op" id="7042013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7042016">if</span>&nbsp;<span class="ident" id="7042019">err</span>&nbsp;<span class="op" id="7042023">!=</span>&nbsp;<span class="builtintype" id="7042026">nil</span>&nbsp;<span class="op" id="7042030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7042034">t</span><span class="op" id="7042035">.</span><span class="ident" id="7042036">Fatalf</span><span class="op" id="7042042">(</span><span class="string" id="7042043">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="7042068">,</span>&nbsp;<span class="ident" id="7042070">err</span><span class="op" id="7042073">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7042076">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7042079">testExecute</span><span class="op" id="7042090">(</span><span class="ident" id="7042091">templateFileExecTests</span><span class="op" id="7042112">,</span>&nbsp;<span class="ident" id="7042114">template</span><span class="op" id="7042122">,</span>&nbsp;<span class="ident" id="7042124">t</span><span class="op" id="7042125">)</span><br>
<span class="lineno"></span><span class="op" id="7042127">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7042130">const</span>&nbsp;<span class="op" id="7042136">(</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7042139">cloneText1</span>&nbsp;<span class="op" id="7042150">=</span>&nbsp;<span class="string" id="7042152">`{{define&nbsp;&#34;a&#34;}}{{template&nbsp;&#34;b&#34;}}{{template&nbsp;&#34;c&#34;}}{{end}}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7042209">cloneText2</span>&nbsp;<span class="op" id="7042220">=</span>&nbsp;<span class="string" id="7042222">`{{define&nbsp;&#34;b&#34;}}b{{end}}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7042248">cloneText3</span>&nbsp;<span class="op" id="7042259">=</span>&nbsp;<span class="string" id="7042261">`{{define&nbsp;&#34;c&#34;}}root{{end}}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7042290">cloneText4</span>&nbsp;<span class="op" id="7042301">=</span>&nbsp;<span class="string" id="7042303">`{{define&nbsp;&#34;c&#34;}}clone{{end}}`</span><br>
<span class="lineno"></span><span class="op" id="7042332">)</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="7042335">func</span>&nbsp;<span class="ident" id="7042340">TestClone</span><span class="op" id="7042349">(</span><span class="ident" id="7042350">t</span>&nbsp;<span class="op" id="7042352">*</span><span class="ident" id="7042353">testing</span><span class="op" id="7042360">.</span><span class="ident" id="7042361">T</span><span class="op" id="7042362">)</span>&nbsp;<span class="op" id="7042364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7042367">//&nbsp;Create&nbsp;some&nbsp;templates&nbsp;and&nbsp;clone&nbsp;the&nbsp;root.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7042413">root</span><span class="op" id="7042417">,</span>&nbsp;<span class="ident" id="7042419">err</span>&nbsp;<span class="op" id="7042423">:=</span>&nbsp;<span class="ident" id="7042426">New</span><span class="op" id="7042429">(</span><span class="string" id="7042430">&#34;root&#34;</span><span class="op" id="7042436">)</span><span class="op" id="7042437">.</span><span class="ident" id="7042438">Parse</span><span class="op" id="7042443">(</span><span class="ident" id="7042444">cloneText1</span><span class="op" id="7042454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7042457">if</span>&nbsp;<span class="ident" id="7042460">err</span>&nbsp;<span class="op" id="7042464">!=</span>&nbsp;<span class="builtintype" id="7042467">nil</span>&nbsp;<span class="op" id="7042471">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7042475">t</span><span class="op" id="7042476">.</span><span class="ident" id="7042477">Fatal</span><span class="op" id="7042482">(</span><span class="ident" id="7042483">err</span><span class="op" id="7042486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7042489">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7042492">_</span><span class="op" id="7042493">,</span>&nbsp;<span class="ident" id="7042495">err</span>&nbsp;<span class="op" id="7042499">=</span>&nbsp;<span class="ident" id="7042501">root</span><span class="op" id="7042505">.</span><span class="ident" id="7042506">Parse</span><span class="op" id="7042511">(</span><span class="ident" id="7042512">cloneText2</span><span class="op" id="7042522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7042525">if</span>&nbsp;<span class="ident" id="7042528">err</span>&nbsp;<span class="op" id="7042532">!=</span>&nbsp;<span class="builtintype" id="7042535">nil</span>&nbsp;<span class="op" id="7042539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7042543">t</span><span class="op" id="7042544">.</span><span class="ident" id="7042545">Fatal</span><span class="op" id="7042550">(</span><span class="ident" id="7042551">err</span><span class="op" id="7042554">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7042557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7042560">clone</span>&nbsp;<span class="op" id="7042566">:=</span>&nbsp;<span class="ident" id="7042569">Must</span><span class="op" id="7042573">(</span><span class="ident" id="7042574">root</span><span class="op" id="7042578">.</span><span class="ident" id="7042579">Clone</span><span class="op" id="7042584">(</span><span class="op" id="7042585">)</span><span class="op" id="7042586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7042589">//&nbsp;Add&nbsp;variants&nbsp;to&nbsp;both.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7042615">_</span><span class="op" id="7042616">,</span>&nbsp;<span class="ident" id="7042618">err</span>&nbsp;<span class="op" id="7042622">=</span>&nbsp;<span class="ident" id="7042624">root</span><span class="op" id="7042628">.</span><span class="ident" id="7042629">Parse</span><span class="op" id="7042634">(</span><span class="ident" id="7042635">cloneText3</span><span class="op" id="7042645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7042648">if</span>&nbsp;<span class="ident" id="7042651">err</span>&nbsp;<span class="op" id="7042655">!=</span>&nbsp;<span class="builtintype" id="7042658">nil</span>&nbsp;<span class="op" id="7042662">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7042666">t</span><span class="op" id="7042667">.</span><span class="ident" id="7042668">Fatal</span><span class="op" id="7042673">(</span><span class="ident" id="7042674">err</span><span class="op" id="7042677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7042680">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7042683">_</span><span class="op" id="7042684">,</span>&nbsp;<span class="ident" id="7042686">err</span>&nbsp;<span class="op" id="7042690">=</span>&nbsp;<span class="ident" id="7042692">clone</span><span class="op" id="7042697">.</span><span class="ident" id="7042698">Parse</span><span class="op" id="7042703">(</span><span class="ident" id="7042704">cloneText4</span><span class="op" id="7042714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7042717">if</span>&nbsp;<span class="ident" id="7042720">err</span>&nbsp;<span class="op" id="7042724">!=</span>&nbsp;<span class="builtintype" id="7042727">nil</span>&nbsp;<span class="op" id="7042731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7042735">t</span><span class="op" id="7042736">.</span><span class="ident" id="7042737">Fatal</span><span class="op" id="7042742">(</span><span class="ident" id="7042743">err</span><span class="op" id="7042746">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7042749">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7042752">//&nbsp;Verify&nbsp;that&nbsp;the&nbsp;clone&nbsp;is&nbsp;self-consistent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7042798">for</span>&nbsp;<span class="ident" id="7042802">k</span><span class="op" id="7042803">,</span>&nbsp;<span class="ident" id="7042805">v</span>&nbsp;<span class="op" id="7042807">:=</span>&nbsp;<span class="keyword" id="7042810">range</span>&nbsp;<span class="ident" id="7042816">clone</span><span class="op" id="7042821">.</span><span class="ident" id="7042822">tmpl</span>&nbsp;<span class="op" id="7042827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7042831">if</span>&nbsp;<span class="ident" id="7042834">k</span>&nbsp;<span class="op" id="7042836">==</span>&nbsp;<span class="ident" id="7042839">clone</span><span class="op" id="7042844">.</span><span class="ident" id="7042845">name</span>&nbsp;<span class="op" id="7042850">&amp;&amp;</span>&nbsp;<span class="ident" id="7042853">v</span><span class="op" id="7042854">.</span><span class="ident" id="7042855">tmpl</span><span class="op" id="7042859">[</span><span class="ident" id="7042860">k</span><span class="op" id="7042861">]</span>&nbsp;<span class="op" id="7042863">!=</span>&nbsp;<span class="ident" id="7042866">clone</span>&nbsp;<span class="op" id="7042872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7042877">t</span><span class="op" id="7042878">.</span><span class="ident" id="7042879">Error</span><span class="op" id="7042884">(</span><span class="string" id="7042885">&#34;clone&nbsp;does&nbsp;not&nbsp;contain&nbsp;root&#34;</span><span class="op" id="7042914">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7042918">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7042922">if</span>&nbsp;<span class="ident" id="7042925">v</span>&nbsp;<span class="op" id="7042927">!=</span>&nbsp;<span class="ident" id="7042930">v</span><span class="op" id="7042931">.</span><span class="ident" id="7042932">tmpl</span><span class="op" id="7042936">[</span><span class="ident" id="7042937">v</span><span class="op" id="7042938">.</span><span class="ident" id="7042939">name</span><span class="op" id="7042943">]</span>&nbsp;<span class="op" id="7042945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7042950">t</span><span class="op" id="7042951">.</span><span class="ident" id="7042952">Errorf</span><span class="op" id="7042958">(</span><span class="string" id="7042959">&#34;clone&nbsp;does&nbsp;not&nbsp;contain&nbsp;self&nbsp;for&nbsp;%q&#34;</span><span class="op" id="7042995">,</span>&nbsp;<span class="ident" id="7042997">k</span><span class="op" id="7042998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7043002">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7043005">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7043008">//&nbsp;Execute&nbsp;root.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7043026">var</span>&nbsp;<span class="ident" id="7043030">b</span>&nbsp;<span class="ident" id="7043032">bytes</span><span class="op" id="7043037">.</span><span class="ident" id="7043038">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7043046">err</span>&nbsp;<span class="op" id="7043050">=</span>&nbsp;<span class="ident" id="7043052">root</span><span class="op" id="7043056">.</span><span class="ident" id="7043057">ExecuteTemplate</span><span class="op" id="7043072">(</span><span class="op" id="7043073">&amp;</span><span class="ident" id="7043074">b</span><span class="op" id="7043075">,</span>&nbsp;<span class="string" id="7043077">&#34;a&#34;</span><span class="op" id="7043080">,</span>&nbsp;<span class="num" id="7043082">0</span><span class="op" id="7043083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7043086">if</span>&nbsp;<span class="ident" id="7043089">err</span>&nbsp;<span class="op" id="7043093">!=</span>&nbsp;<span class="builtintype" id="7043096">nil</span>&nbsp;<span class="op" id="7043100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7043104">t</span><span class="op" id="7043105">.</span><span class="ident" id="7043106">Fatal</span><span class="op" id="7043111">(</span><span class="ident" id="7043112">err</span><span class="op" id="7043115">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7043118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7043121">if</span>&nbsp;<span class="ident" id="7043124">b</span><span class="op" id="7043125">.</span><span class="ident" id="7043126">String</span><span class="op" id="7043132">(</span><span class="op" id="7043133">)</span>&nbsp;<span class="op" id="7043135">!=</span>&nbsp;<span class="string" id="7043138">&#34;broot&#34;</span>&nbsp;<span class="op" id="7043146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7043150">t</span><span class="op" id="7043151">.</span><span class="ident" id="7043152">Errorf</span><span class="op" id="7043158">(</span><span class="string" id="7043159">&#34;expected&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7043179">,</span>&nbsp;<span class="string" id="7043181">&#34;broot&#34;</span><span class="op" id="7043188">,</span>&nbsp;<span class="ident" id="7043190">b</span><span class="op" id="7043191">.</span><span class="ident" id="7043192">String</span><span class="op" id="7043198">(</span><span class="op" id="7043199">)</span><span class="op" id="7043200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7043203">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7043206">//&nbsp;Execute&nbsp;copy.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7043224">b</span><span class="op" id="7043225">.</span><span class="ident" id="7043226">Reset</span><span class="op" id="7043231">(</span><span class="op" id="7043232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7043235">err</span>&nbsp;<span class="op" id="7043239">=</span>&nbsp;<span class="ident" id="7043241">clone</span><span class="op" id="7043246">.</span><span class="ident" id="7043247">ExecuteTemplate</span><span class="op" id="7043262">(</span><span class="op" id="7043263">&amp;</span><span class="ident" id="7043264">b</span><span class="op" id="7043265">,</span>&nbsp;<span class="string" id="7043267">&#34;a&#34;</span><span class="op" id="7043270">,</span>&nbsp;<span class="num" id="7043272">0</span><span class="op" id="7043273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7043276">if</span>&nbsp;<span class="ident" id="7043279">err</span>&nbsp;<span class="op" id="7043283">!=</span>&nbsp;<span class="builtintype" id="7043286">nil</span>&nbsp;<span class="op" id="7043290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7043294">t</span><span class="op" id="7043295">.</span><span class="ident" id="7043296">Fatal</span><span class="op" id="7043301">(</span><span class="ident" id="7043302">err</span><span class="op" id="7043305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7043308">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7043311">if</span>&nbsp;<span class="ident" id="7043314">b</span><span class="op" id="7043315">.</span><span class="ident" id="7043316">String</span><span class="op" id="7043322">(</span><span class="op" id="7043323">)</span>&nbsp;<span class="op" id="7043325">!=</span>&nbsp;<span class="string" id="7043328">&#34;bclone&#34;</span>&nbsp;<span class="op" id="7043337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7043341">t</span><span class="op" id="7043342">.</span><span class="ident" id="7043343">Errorf</span><span class="op" id="7043349">(</span><span class="string" id="7043350">&#34;expected&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7043370">,</span>&nbsp;<span class="string" id="7043372">&#34;bclone&#34;</span><span class="op" id="7043380">,</span>&nbsp;<span class="ident" id="7043382">b</span><span class="op" id="7043383">.</span><span class="ident" id="7043384">String</span><span class="op" id="7043390">(</span><span class="op" id="7043391">)</span><span class="op" id="7043392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7043395">}</span><br>
<span class="lineno"></span><span class="op" id="7043397">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="7043400">func</span>&nbsp;<span class="ident" id="7043405">TestAddParseTree</span><span class="op" id="7043421">(</span><span class="ident" id="7043422">t</span>&nbsp;<span class="op" id="7043424">*</span><span class="ident" id="7043425">testing</span><span class="op" id="7043432">.</span><span class="ident" id="7043433">T</span><span class="op" id="7043434">)</span>&nbsp;<span class="op" id="7043436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7043439">//&nbsp;Create&nbsp;some&nbsp;templates.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7043466">root</span><span class="op" id="7043470">,</span>&nbsp;<span class="ident" id="7043472">err</span>&nbsp;<span class="op" id="7043476">:=</span>&nbsp;<span class="ident" id="7043479">New</span><span class="op" id="7043482">(</span><span class="string" id="7043483">&#34;root&#34;</span><span class="op" id="7043489">)</span><span class="op" id="7043490">.</span><span class="ident" id="7043491">Parse</span><span class="op" id="7043496">(</span><span class="ident" id="7043497">cloneText1</span><span class="op" id="7043507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7043510">if</span>&nbsp;<span class="ident" id="7043513">err</span>&nbsp;<span class="op" id="7043517">!=</span>&nbsp;<span class="builtintype" id="7043520">nil</span>&nbsp;<span class="op" id="7043524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7043528">t</span><span class="op" id="7043529">.</span><span class="ident" id="7043530">Fatal</span><span class="op" id="7043535">(</span><span class="ident" id="7043536">err</span><span class="op" id="7043539">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7043542">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7043545">_</span><span class="op" id="7043546">,</span>&nbsp;<span class="ident" id="7043548">err</span>&nbsp;<span class="op" id="7043552">=</span>&nbsp;<span class="ident" id="7043554">root</span><span class="op" id="7043558">.</span><span class="ident" id="7043559">Parse</span><span class="op" id="7043564">(</span><span class="ident" id="7043565">cloneText2</span><span class="op" id="7043575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7043578">if</span>&nbsp;<span class="ident" id="7043581">err</span>&nbsp;<span class="op" id="7043585">!=</span>&nbsp;<span class="builtintype" id="7043588">nil</span>&nbsp;<span class="op" id="7043592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7043596">t</span><span class="op" id="7043597">.</span><span class="ident" id="7043598">Fatal</span><span class="op" id="7043603">(</span><span class="ident" id="7043604">err</span><span class="op" id="7043607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7043610">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7043613">//&nbsp;Add&nbsp;a&nbsp;new&nbsp;parse&nbsp;tree.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7043639">tree</span><span class="op" id="7043643">,</span>&nbsp;<span class="ident" id="7043645">err</span>&nbsp;<span class="op" id="7043649">:=</span>&nbsp;<span class="ident" id="7043652">parse</span><span class="op" id="7043657">.</span><span class="ident" id="7043658">Parse</span><span class="op" id="7043663">(</span><span class="string" id="7043664">&#34;cloneText3&#34;</span><span class="op" id="7043676">,</span>&nbsp;<span class="ident" id="7043678">cloneText3</span><span class="op" id="7043688">,</span>&nbsp;<span class="string" id="7043690">&#34;&#34;</span><span class="op" id="7043692">,</span>&nbsp;<span class="string" id="7043694">&#34;&#34;</span><span class="op" id="7043696">,</span>&nbsp;<span class="builtintype" id="7043698">nil</span><span class="op" id="7043701">,</span>&nbsp;<span class="ident" id="7043703">builtins</span><span class="op" id="7043711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7043714">if</span>&nbsp;<span class="ident" id="7043717">err</span>&nbsp;<span class="op" id="7043721">!=</span>&nbsp;<span class="builtintype" id="7043724">nil</span>&nbsp;<span class="op" id="7043728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7043732">t</span><span class="op" id="7043733">.</span><span class="ident" id="7043734">Fatal</span><span class="op" id="7043739">(</span><span class="ident" id="7043740">err</span><span class="op" id="7043743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7043746">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7043749">added</span><span class="op" id="7043754">,</span>&nbsp;<span class="ident" id="7043756">err</span>&nbsp;<span class="op" id="7043760">:=</span>&nbsp;<span class="ident" id="7043763">root</span><span class="op" id="7043767">.</span><span class="ident" id="7043768">AddParseTree</span><span class="op" id="7043780">(</span><span class="string" id="7043781">&#34;c&#34;</span><span class="op" id="7043784">,</span>&nbsp;<span class="ident" id="7043786">tree</span><span class="op" id="7043790">[</span><span class="string" id="7043791">&#34;c&#34;</span><span class="op" id="7043794">]</span><span class="op" id="7043795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7043798">//&nbsp;Execute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7043811">var</span>&nbsp;<span class="ident" id="7043815">b</span>&nbsp;<span class="ident" id="7043817">bytes</span><span class="op" id="7043822">.</span><span class="ident" id="7043823">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7043831">err</span>&nbsp;<span class="op" id="7043835">=</span>&nbsp;<span class="ident" id="7043837">added</span><span class="op" id="7043842">.</span><span class="ident" id="7043843">ExecuteTemplate</span><span class="op" id="7043858">(</span><span class="op" id="7043859">&amp;</span><span class="ident" id="7043860">b</span><span class="op" id="7043861">,</span>&nbsp;<span class="string" id="7043863">&#34;a&#34;</span><span class="op" id="7043866">,</span>&nbsp;<span class="num" id="7043868">0</span><span class="op" id="7043869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7043872">if</span>&nbsp;<span class="ident" id="7043875">err</span>&nbsp;<span class="op" id="7043879">!=</span>&nbsp;<span class="builtintype" id="7043882">nil</span>&nbsp;<span class="op" id="7043886">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7043890">t</span><span class="op" id="7043891">.</span><span class="ident" id="7043892">Fatal</span><span class="op" id="7043897">(</span><span class="ident" id="7043898">err</span><span class="op" id="7043901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7043904">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7043907">if</span>&nbsp;<span class="ident" id="7043910">b</span><span class="op" id="7043911">.</span><span class="ident" id="7043912">String</span><span class="op" id="7043918">(</span><span class="op" id="7043919">)</span>&nbsp;<span class="op" id="7043921">!=</span>&nbsp;<span class="string" id="7043924">&#34;broot&#34;</span>&nbsp;<span class="op" id="7043932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7043936">t</span><span class="op" id="7043937">.</span><span class="ident" id="7043938">Errorf</span><span class="op" id="7043944">(</span><span class="string" id="7043945">&#34;expected&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7043965">,</span>&nbsp;<span class="string" id="7043967">&#34;broot&#34;</span><span class="op" id="7043974">,</span>&nbsp;<span class="ident" id="7043976">b</span><span class="op" id="7043977">.</span><span class="ident" id="7043978">String</span><span class="op" id="7043984">(</span><span class="op" id="7043985">)</span><span class="op" id="7043986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7043989">}</span><br>
<span class="lineno">260</span><span class="op" id="7043991">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7043994">//&nbsp;Issue&nbsp;7032</span><br>
<span class="lineno"></span><span class="keyword" id="7044008">func</span>&nbsp;<span class="ident" id="7044013">TestAddParseTreeToUnparsedTemplate</span><span class="op" id="7044047">(</span><span class="ident" id="7044048">t</span>&nbsp;<span class="op" id="7044050">*</span><span class="ident" id="7044051">testing</span><span class="op" id="7044058">.</span><span class="ident" id="7044059">T</span><span class="op" id="7044060">)</span>&nbsp;<span class="op" id="7044062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7044065">master</span>&nbsp;<span class="op" id="7044072">:=</span>&nbsp;<span class="string" id="7044075">&#34;{{define&nbsp;\&#34;master\&#34;}}{{end}}&#34;</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7044107">tmpl</span>&nbsp;<span class="op" id="7044112">:=</span>&nbsp;<span class="ident" id="7044115">New</span><span class="op" id="7044118">(</span><span class="string" id="7044119">&#34;master&#34;</span><span class="op" id="7044127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7044130">tree</span><span class="op" id="7044134">,</span>&nbsp;<span class="ident" id="7044136">err</span>&nbsp;<span class="op" id="7044140">:=</span>&nbsp;<span class="ident" id="7044143">parse</span><span class="op" id="7044148">.</span><span class="ident" id="7044149">Parse</span><span class="op" id="7044154">(</span><span class="string" id="7044155">&#34;master&#34;</span><span class="op" id="7044163">,</span>&nbsp;<span class="ident" id="7044165">master</span><span class="op" id="7044171">,</span>&nbsp;<span class="string" id="7044173">&#34;&#34;</span><span class="op" id="7044175">,</span>&nbsp;<span class="string" id="7044177">&#34;&#34;</span><span class="op" id="7044179">,</span>&nbsp;<span class="builtintype" id="7044181">nil</span><span class="op" id="7044184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7044187">if</span>&nbsp;<span class="ident" id="7044190">err</span>&nbsp;<span class="op" id="7044194">!=</span>&nbsp;<span class="builtintype" id="7044197">nil</span>&nbsp;<span class="op" id="7044201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7044205">t</span><span class="op" id="7044206">.</span><span class="ident" id="7044207">Fatalf</span><span class="op" id="7044213">(</span><span class="string" id="7044214">&#34;unexpected&nbsp;parse&nbsp;err:&nbsp;%v&#34;</span><span class="op" id="7044240">,</span>&nbsp;<span class="ident" id="7044242">err</span><span class="op" id="7044245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7044248">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7044251">masterTree</span>&nbsp;<span class="op" id="7044262">:=</span>&nbsp;<span class="ident" id="7044265">tree</span><span class="op" id="7044269">[</span><span class="string" id="7044270">&#34;master&#34;</span><span class="op" id="7044278">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7044281">tmpl</span><span class="op" id="7044285">.</span><span class="ident" id="7044286">AddParseTree</span><span class="op" id="7044298">(</span><span class="string" id="7044299">&#34;master&#34;</span><span class="op" id="7044307">,</span>&nbsp;<span class="ident" id="7044309">masterTree</span><span class="op" id="7044319">)</span>&nbsp;<span class="comment" id="7044321">//&nbsp;used&nbsp;to&nbsp;panic</span><br>
<span class="lineno"></span><span class="op" id="7044338">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7044341">func</span>&nbsp;<span class="ident" id="7044346">TestRedefinition</span><span class="op" id="7044362">(</span><span class="ident" id="7044363">t</span>&nbsp;<span class="op" id="7044365">*</span><span class="ident" id="7044366">testing</span><span class="op" id="7044373">.</span><span class="ident" id="7044374">T</span><span class="op" id="7044375">)</span>&nbsp;<span class="op" id="7044377">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7044380">var</span>&nbsp;<span class="ident" id="7044384">tmpl</span>&nbsp;<span class="op" id="7044389">*</span><span class="ident" id="7044390">Template</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7044400">var</span>&nbsp;<span class="ident" id="7044404">err</span>&nbsp;<span class="builtintype" id="7044408">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7044415">if</span>&nbsp;<span class="ident" id="7044418">tmpl</span><span class="op" id="7044422">,</span>&nbsp;<span class="ident" id="7044424">err</span>&nbsp;<span class="op" id="7044428">=</span>&nbsp;<span class="ident" id="7044430">New</span><span class="op" id="7044433">(</span><span class="string" id="7044434">&#34;tmpl1&#34;</span><span class="op" id="7044441">)</span><span class="op" id="7044442">.</span><span class="ident" id="7044443">Parse</span><span class="op" id="7044448">(</span><span class="string" id="7044449">`{{define&nbsp;&#34;test&#34;}}foo{{end}}`</span><span class="op" id="7044478">)</span><span class="op" id="7044479">;</span>&nbsp;<span class="ident" id="7044481">err</span>&nbsp;<span class="op" id="7044485">!=</span>&nbsp;<span class="builtintype" id="7044488">nil</span>&nbsp;<span class="op" id="7044492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7044496">t</span><span class="op" id="7044497">.</span><span class="ident" id="7044498">Fatalf</span><span class="op" id="7044504">(</span><span class="string" id="7044505">&#34;parse&nbsp;1:&nbsp;%v&#34;</span><span class="op" id="7044518">,</span>&nbsp;<span class="ident" id="7044520">err</span><span class="op" id="7044523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7044526">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7044529">if</span>&nbsp;<span class="ident" id="7044532">_</span><span class="op" id="7044533">,</span>&nbsp;<span class="ident" id="7044535">err</span>&nbsp;<span class="op" id="7044539">=</span>&nbsp;<span class="ident" id="7044541">tmpl</span><span class="op" id="7044545">.</span><span class="ident" id="7044546">Parse</span><span class="op" id="7044551">(</span><span class="string" id="7044552">`{{define&nbsp;&#34;test&#34;}}bar{{end}}`</span><span class="op" id="7044581">)</span><span class="op" id="7044582">;</span>&nbsp;<span class="ident" id="7044584">err</span>&nbsp;<span class="op" id="7044588">==</span>&nbsp;<span class="builtintype" id="7044591">nil</span>&nbsp;<span class="op" id="7044595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7044599">t</span><span class="op" id="7044600">.</span><span class="ident" id="7044601">Fatal</span><span class="op" id="7044606">(</span><span class="string" id="7044607">&#34;expected&nbsp;error&#34;</span><span class="op" id="7044623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7044626">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7044629">if</span>&nbsp;<span class="op" id="7044632">!</span><span class="ident" id="7044633">strings</span><span class="op" id="7044640">.</span><span class="ident" id="7044641">Contains</span><span class="op" id="7044649">(</span><span class="ident" id="7044650">err</span><span class="op" id="7044653">.</span><span class="ident" id="7044654">Error</span><span class="op" id="7044659">(</span><span class="op" id="7044660">)</span><span class="op" id="7044661">,</span>&nbsp;<span class="string" id="7044663">&#34;redefinition&#34;</span><span class="op" id="7044677">)</span>&nbsp;<span class="op" id="7044679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7044683">t</span><span class="op" id="7044684">.</span><span class="ident" id="7044685">Fatalf</span><span class="op" id="7044691">(</span><span class="string" id="7044692">&#34;expected&nbsp;redefinition&nbsp;error;&nbsp;got&nbsp;%v&#34;</span><span class="op" id="7044729">,</span>&nbsp;<span class="ident" id="7044731">err</span><span class="op" id="7044734">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7044737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7044740">if</span>&nbsp;<span class="ident" id="7044743">_</span><span class="op" id="7044744">,</span>&nbsp;<span class="ident" id="7044746">err</span>&nbsp;<span class="op" id="7044750">=</span>&nbsp;<span class="ident" id="7044752">tmpl</span><span class="op" id="7044756">.</span><span class="ident" id="7044757">New</span><span class="op" id="7044760">(</span><span class="string" id="7044761">&#34;tmpl2&#34;</span><span class="op" id="7044768">)</span><span class="op" id="7044769">.</span><span class="ident" id="7044770">Parse</span><span class="op" id="7044775">(</span><span class="string" id="7044776">`{{define&nbsp;&#34;test&#34;}}bar{{end}}`</span><span class="op" id="7044805">)</span><span class="op" id="7044806">;</span>&nbsp;<span class="ident" id="7044808">err</span>&nbsp;<span class="op" id="7044812">==</span>&nbsp;<span class="builtintype" id="7044815">nil</span>&nbsp;<span class="op" id="7044819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7044823">t</span><span class="op" id="7044824">.</span><span class="ident" id="7044825">Fatal</span><span class="op" id="7044830">(</span><span class="string" id="7044831">&#34;expected&nbsp;error&#34;</span><span class="op" id="7044847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7044850">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7044853">if</span>&nbsp;<span class="op" id="7044856">!</span><span class="ident" id="7044857">strings</span><span class="op" id="7044864">.</span><span class="ident" id="7044865">Contains</span><span class="op" id="7044873">(</span><span class="ident" id="7044874">err</span><span class="op" id="7044877">.</span><span class="ident" id="7044878">Error</span><span class="op" id="7044883">(</span><span class="op" id="7044884">)</span><span class="op" id="7044885">,</span>&nbsp;<span class="string" id="7044887">&#34;redefinition&#34;</span><span class="op" id="7044901">)</span>&nbsp;<span class="op" id="7044903">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7044907">t</span><span class="op" id="7044908">.</span><span class="ident" id="7044909">Fatalf</span><span class="op" id="7044915">(</span><span class="string" id="7044916">&#34;expected&nbsp;redefinition&nbsp;error;&nbsp;got&nbsp;%v&#34;</span><span class="op" id="7044953">,</span>&nbsp;<span class="ident" id="7044955">err</span><span class="op" id="7044958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7044961">}</span><br>
<span class="lineno"></span><span class="op" id="7044963">}</span>
</div>
</body>
</html>
