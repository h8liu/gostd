<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/scanner</h2>
<ul>
<li><a href="/gostd/go/scanner/errors.go.html">errors.go</a></li>
<li><a href="/gostd/go/scanner/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/go/scanner/scanner.go.html">scanner.go</a></li>
<li><a href="/gostd/go/scanner/scanner_test.go.html">scanner_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4327230">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4327285">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4327339">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4327390">package</span>&nbsp;<span class="ident" id="4327398">scanner</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4327407">import</span>&nbsp;<span class="op" id="4327414">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4327417">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4327424">&#34;go/token&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4327436">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4327442">&#34;sort&#34;</span><br>
<span class="lineno"></span><span class="op" id="4327449">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4327452">//&nbsp;In&nbsp;an&nbsp;ErrorList,&nbsp;an&nbsp;error&nbsp;is&nbsp;represented&nbsp;by&nbsp;an&nbsp;*Error.</span><br>
<span class="lineno">15</span><span class="comment" id="4327510">//&nbsp;The&nbsp;position&nbsp;Pos,&nbsp;if&nbsp;valid,&nbsp;points&nbsp;to&nbsp;the&nbsp;beginning&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4327568">//&nbsp;the&nbsp;offending&nbsp;token,&nbsp;and&nbsp;the&nbsp;error&nbsp;condition&nbsp;is&nbsp;described</span><br>
<span class="lineno"></span><span class="comment" id="4327629">//&nbsp;by&nbsp;Msg.</span><br>
<span class="lineno"></span><span class="comment" id="4327640">//</span><br>
<span class="lineno"></span><span class="keyword" id="4327643">type</span>&nbsp;<span class="ident" id="4327648">Error</span>&nbsp;<span class="keyword" id="4327654">struct</span>&nbsp;<span class="op" id="4327661">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4327664">Pos</span>&nbsp;<span class="ident" id="4327668">token</span><span class="op" id="4327673">.</span><span class="ident" id="4327674">Position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4327684">Msg</span>&nbsp;<span class="builtintype" id="4327688">string</span><br>
<span class="lineno"></span><span class="op" id="4327695">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4327698">//&nbsp;Error&nbsp;implements&nbsp;the&nbsp;error&nbsp;interface.</span><br>
<span class="lineno">25</span><span class="keyword" id="4327739">func</span>&nbsp;<span class="op" id="4327744">(</span><span class="ident" id="4327745">e</span>&nbsp;<span class="ident" id="4327747">Error</span><span class="op" id="4327752">)</span>&nbsp;<span class="ident" id="4327754">Error</span><span class="op" id="4327759">(</span><span class="op" id="4327760">)</span>&nbsp;<span class="builtintype" id="4327762">string</span>&nbsp;<span class="op" id="4327769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4327772">if</span>&nbsp;<span class="ident" id="4327775">e</span><span class="op" id="4327776">.</span><span class="ident" id="4327777">Pos</span><span class="op" id="4327780">.</span><span class="ident" id="4327781">Filename</span>&nbsp;<span class="op" id="4327790">!=</span>&nbsp;<span class="string" id="4327793">&#34;&#34;</span>&nbsp;<span class="op" id="4327796">||</span>&nbsp;<span class="ident" id="4327799">e</span><span class="op" id="4327800">.</span><span class="ident" id="4327801">Pos</span><span class="op" id="4327804">.</span><span class="ident" id="4327805">IsValid</span><span class="op" id="4327812">(</span><span class="op" id="4327813">)</span>&nbsp;<span class="op" id="4327815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4327819">//&nbsp;don&#39;t&nbsp;print&nbsp;&#34;&lt;unknown&nbsp;position&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4327857">//&nbsp;TODO(gri)&nbsp;reconsider&nbsp;the&nbsp;semantics&nbsp;of&nbsp;Position.IsValid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4327917">return</span>&nbsp;<span class="ident" id="4327924">e</span><span class="op" id="4327925">.</span><span class="ident" id="4327926">Pos</span><span class="op" id="4327929">.</span><span class="ident" id="4327930">String</span><span class="op" id="4327936">(</span><span class="op" id="4327937">)</span>&nbsp;<span class="op" id="4327939">+</span>&nbsp;<span class="string" id="4327941">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="4327946">+</span>&nbsp;<span class="ident" id="4327948">e</span><span class="op" id="4327949">.</span><span class="ident" id="4327950">Msg</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4327955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4327958">return</span>&nbsp;<span class="ident" id="4327965">e</span><span class="op" id="4327966">.</span><span class="ident" id="4327967">Msg</span><br>
<span class="lineno"></span><span class="op" id="4327971">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4327974">//&nbsp;ErrorList&nbsp;is&nbsp;a&nbsp;list&nbsp;of&nbsp;*Errors.</span><br>
<span class="lineno">35</span><span class="comment" id="4328009">//&nbsp;The&nbsp;zero&nbsp;value&nbsp;for&nbsp;an&nbsp;ErrorList&nbsp;is&nbsp;an&nbsp;empty&nbsp;ErrorList&nbsp;ready&nbsp;to&nbsp;use.</span><br>
<span class="lineno"></span><span class="comment" id="4328080">//</span><br>
<span class="lineno"></span><span class="keyword" id="4328083">type</span>&nbsp;<span class="ident" id="4328088">ErrorList</span>&nbsp;<span class="op" id="4328098">[</span><span class="op" id="4328099">]</span><span class="op" id="4328100">*</span><span class="ident" id="4328101">Error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4328108">//&nbsp;Add&nbsp;adds&nbsp;an&nbsp;Error&nbsp;with&nbsp;given&nbsp;position&nbsp;and&nbsp;error&nbsp;message&nbsp;to&nbsp;an&nbsp;ErrorList.</span><br>
<span class="lineno">40</span><span class="keyword" id="4328184">func</span>&nbsp;<span class="op" id="4328189">(</span><span class="ident" id="4328190">p</span>&nbsp;<span class="op" id="4328192">*</span><span class="ident" id="4328193">ErrorList</span><span class="op" id="4328202">)</span>&nbsp;<span class="ident" id="4328204">Add</span><span class="op" id="4328207">(</span><span class="ident" id="4328208">pos</span>&nbsp;<span class="ident" id="4328212">token</span><span class="op" id="4328217">.</span><span class="ident" id="4328218">Position</span><span class="op" id="4328226">,</span>&nbsp;<span class="ident" id="4328228">msg</span>&nbsp;<span class="builtintype" id="4328232">string</span><span class="op" id="4328238">)</span>&nbsp;<span class="op" id="4328240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4328243">*</span><span class="ident" id="4328244">p</span>&nbsp;<span class="op" id="4328246">=</span>&nbsp;<span class="builtinfunc" id="4328248">append</span><span class="op" id="4328254">(</span><span class="op" id="4328255">*</span><span class="ident" id="4328256">p</span><span class="op" id="4328257">,</span>&nbsp;<span class="op" id="4328259">&amp;</span><span class="ident" id="4328260">Error</span><span class="op" id="4328265">{</span><span class="ident" id="4328266">pos</span><span class="op" id="4328269">,</span>&nbsp;<span class="ident" id="4328271">msg</span><span class="op" id="4328274">}</span><span class="op" id="4328275">)</span><br>
<span class="lineno"></span><span class="op" id="4328277">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4328280">//&nbsp;Reset&nbsp;resets&nbsp;an&nbsp;ErrorList&nbsp;to&nbsp;no&nbsp;errors.</span><br>
<span class="lineno">45</span><span class="keyword" id="4328323">func</span>&nbsp;<span class="op" id="4328328">(</span><span class="ident" id="4328329">p</span>&nbsp;<span class="op" id="4328331">*</span><span class="ident" id="4328332">ErrorList</span><span class="op" id="4328341">)</span>&nbsp;<span class="ident" id="4328343">Reset</span><span class="op" id="4328348">(</span><span class="op" id="4328349">)</span>&nbsp;<span class="op" id="4328351">{</span>&nbsp;<span class="op" id="4328353">*</span><span class="ident" id="4328354">p</span>&nbsp;<span class="op" id="4328356">=</span>&nbsp;<span class="op" id="4328358">(</span><span class="op" id="4328359">*</span><span class="ident" id="4328360">p</span><span class="op" id="4328361">)</span><span class="op" id="4328362">[</span><span class="num" id="4328363">0</span><span class="op" id="4328364">:</span><span class="num" id="4328365">0</span><span class="op" id="4328366">]</span>&nbsp;<span class="op" id="4328368">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4328371">//&nbsp;ErrorList&nbsp;implements&nbsp;the&nbsp;sort&nbsp;Interface.</span><br>
<span class="lineno"></span><span class="keyword" id="4328415">func</span>&nbsp;<span class="op" id="4328420">(</span><span class="ident" id="4328421">p</span>&nbsp;<span class="ident" id="4328423">ErrorList</span><span class="op" id="4328432">)</span>&nbsp;<span class="ident" id="4328434">Len</span><span class="op" id="4328437">(</span><span class="op" id="4328438">)</span>&nbsp;<span class="builtintype" id="4328440">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4328449">{</span>&nbsp;<span class="keyword" id="4328451">return</span>&nbsp;<span class="builtinfunc" id="4328458">len</span><span class="op" id="4328461">(</span><span class="ident" id="4328462">p</span><span class="op" id="4328463">)</span>&nbsp;<span class="op" id="4328465">}</span><br>
<span class="lineno"></span><span class="keyword" id="4328467">func</span>&nbsp;<span class="op" id="4328472">(</span><span class="ident" id="4328473">p</span>&nbsp;<span class="ident" id="4328475">ErrorList</span><span class="op" id="4328484">)</span>&nbsp;<span class="ident" id="4328486">Swap</span><span class="op" id="4328490">(</span><span class="ident" id="4328491">i</span><span class="op" id="4328492">,</span>&nbsp;<span class="ident" id="4328494">j</span>&nbsp;<span class="builtintype" id="4328496">int</span><span class="op" id="4328499">)</span>&nbsp;<span class="op" id="4328501">{</span>&nbsp;<span class="ident" id="4328503">p</span><span class="op" id="4328504">[</span><span class="ident" id="4328505">i</span><span class="op" id="4328506">]</span><span class="op" id="4328507">,</span>&nbsp;<span class="ident" id="4328509">p</span><span class="op" id="4328510">[</span><span class="ident" id="4328511">j</span><span class="op" id="4328512">]</span>&nbsp;<span class="op" id="4328514">=</span>&nbsp;<span class="ident" id="4328516">p</span><span class="op" id="4328517">[</span><span class="ident" id="4328518">j</span><span class="op" id="4328519">]</span><span class="op" id="4328520">,</span>&nbsp;<span class="ident" id="4328522">p</span><span class="op" id="4328523">[</span><span class="ident" id="4328524">i</span><span class="op" id="4328525">]</span>&nbsp;<span class="op" id="4328527">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="keyword" id="4328530">func</span>&nbsp;<span class="op" id="4328535">(</span><span class="ident" id="4328536">p</span>&nbsp;<span class="ident" id="4328538">ErrorList</span><span class="op" id="4328547">)</span>&nbsp;<span class="ident" id="4328549">Less</span><span class="op" id="4328553">(</span><span class="ident" id="4328554">i</span><span class="op" id="4328555">,</span>&nbsp;<span class="ident" id="4328557">j</span>&nbsp;<span class="builtintype" id="4328559">int</span><span class="op" id="4328562">)</span>&nbsp;<span class="builtintype" id="4328564">bool</span>&nbsp;<span class="op" id="4328569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4328572">e</span>&nbsp;<span class="op" id="4328574">:=</span>&nbsp;<span class="op" id="4328577">&amp;</span><span class="ident" id="4328578">p</span><span class="op" id="4328579">[</span><span class="ident" id="4328580">i</span><span class="op" id="4328581">]</span><span class="op" id="4328582">.</span><span class="ident" id="4328583">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4328588">f</span>&nbsp;<span class="op" id="4328590">:=</span>&nbsp;<span class="op" id="4328593">&amp;</span><span class="ident" id="4328594">p</span><span class="op" id="4328595">[</span><span class="ident" id="4328596">j</span><span class="op" id="4328597">]</span><span class="op" id="4328598">.</span><span class="ident" id="4328599">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4328604">//&nbsp;Note&nbsp;that&nbsp;it&nbsp;is&nbsp;not&nbsp;sufficient&nbsp;to&nbsp;simply&nbsp;compare&nbsp;file&nbsp;offsets&nbsp;because</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4328678">//&nbsp;the&nbsp;offsets&nbsp;do&nbsp;not&nbsp;reflect&nbsp;modified&nbsp;line&nbsp;information&nbsp;(through&nbsp;//line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4328751">//&nbsp;comments).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4328766">if</span>&nbsp;<span class="ident" id="4328769">e</span><span class="op" id="4328770">.</span><span class="ident" id="4328771">Filename</span>&nbsp;<span class="op" id="4328780">&lt;</span>&nbsp;<span class="ident" id="4328782">f</span><span class="op" id="4328783">.</span><span class="ident" id="4328784">Filename</span>&nbsp;<span class="op" id="4328793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4328797">return</span>&nbsp;<span class="builtintype" id="4328804">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4328810">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4328813">if</span>&nbsp;<span class="ident" id="4328816">e</span><span class="op" id="4328817">.</span><span class="ident" id="4328818">Filename</span>&nbsp;<span class="op" id="4328827">==</span>&nbsp;<span class="ident" id="4328830">f</span><span class="op" id="4328831">.</span><span class="ident" id="4328832">Filename</span>&nbsp;<span class="op" id="4328841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4328845">if</span>&nbsp;<span class="ident" id="4328848">e</span><span class="op" id="4328849">.</span><span class="ident" id="4328850">Line</span>&nbsp;<span class="op" id="4328855">&lt;</span>&nbsp;<span class="ident" id="4328857">f</span><span class="op" id="4328858">.</span><span class="ident" id="4328859">Line</span>&nbsp;<span class="op" id="4328864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4328869">return</span>&nbsp;<span class="builtintype" id="4328876">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4328883">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4328887">if</span>&nbsp;<span class="ident" id="4328890">e</span><span class="op" id="4328891">.</span><span class="ident" id="4328892">Line</span>&nbsp;<span class="op" id="4328897">==</span>&nbsp;<span class="ident" id="4328900">f</span><span class="op" id="4328901">.</span><span class="ident" id="4328902">Line</span>&nbsp;<span class="op" id="4328907">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4328912">return</span>&nbsp;<span class="ident" id="4328919">e</span><span class="op" id="4328920">.</span><span class="ident" id="4328921">Column</span>&nbsp;<span class="op" id="4328928">&lt;</span>&nbsp;<span class="ident" id="4328930">f</span><span class="op" id="4328931">.</span><span class="ident" id="4328932">Column</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4328941">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4328944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4328947">return</span>&nbsp;<span class="builtintype" id="4328954">false</span><br>
<span class="lineno"></span><span class="op" id="4328960">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="comment" id="4328963">//&nbsp;Sort&nbsp;sorts&nbsp;an&nbsp;ErrorList.&nbsp;*Error&nbsp;entries&nbsp;are&nbsp;sorted&nbsp;by&nbsp;position,</span><br>
<span class="lineno"></span><span class="comment" id="4329030">//&nbsp;other&nbsp;errors&nbsp;are&nbsp;sorted&nbsp;by&nbsp;error&nbsp;message,&nbsp;and&nbsp;before&nbsp;any&nbsp;*Error</span><br>
<span class="lineno"></span><span class="comment" id="4329097">//&nbsp;entry.</span><br>
<span class="lineno"></span><span class="comment" id="4329107">//</span><br>
<span class="lineno">75</span><span class="keyword" id="4329110">func</span>&nbsp;<span class="op" id="4329115">(</span><span class="ident" id="4329116">p</span>&nbsp;<span class="ident" id="4329118">ErrorList</span><span class="op" id="4329127">)</span>&nbsp;<span class="ident" id="4329129">Sort</span><span class="op" id="4329133">(</span><span class="op" id="4329134">)</span>&nbsp;<span class="op" id="4329136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4329139">sort</span><span class="op" id="4329143">.</span><span class="ident" id="4329144">Sort</span><span class="op" id="4329148">(</span><span class="ident" id="4329149">p</span><span class="op" id="4329150">)</span><br>
<span class="lineno"></span><span class="op" id="4329152">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4329155">//&nbsp;RemoveMultiples&nbsp;sorts&nbsp;an&nbsp;ErrorList&nbsp;and&nbsp;removes&nbsp;all&nbsp;but&nbsp;the&nbsp;first&nbsp;error&nbsp;per&nbsp;line.</span><br>
<span class="lineno">80</span><span class="keyword" id="4329239">func</span>&nbsp;<span class="op" id="4329244">(</span><span class="ident" id="4329245">p</span>&nbsp;<span class="op" id="4329247">*</span><span class="ident" id="4329248">ErrorList</span><span class="op" id="4329257">)</span>&nbsp;<span class="ident" id="4329259">RemoveMultiples</span><span class="op" id="4329274">(</span><span class="op" id="4329275">)</span>&nbsp;<span class="op" id="4329277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4329280">sort</span><span class="op" id="4329284">.</span><span class="ident" id="4329285">Sort</span><span class="op" id="4329289">(</span><span class="ident" id="4329290">p</span><span class="op" id="4329291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4329294">var</span>&nbsp;<span class="ident" id="4329298">last</span>&nbsp;<span class="ident" id="4329303">token</span><span class="op" id="4329308">.</span><span class="ident" id="4329309">Position</span>&nbsp;<span class="comment" id="4329318">//&nbsp;initial&nbsp;last.Line&nbsp;is&nbsp;!=&nbsp;any&nbsp;legal&nbsp;error&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4329367">i</span>&nbsp;<span class="op" id="4329369">:=</span>&nbsp;<span class="num" id="4329372">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4329375">for</span>&nbsp;<span class="ident" id="4329379">_</span><span class="op" id="4329380">,</span>&nbsp;<span class="ident" id="4329382">e</span>&nbsp;<span class="op" id="4329384">:=</span>&nbsp;<span class="keyword" id="4329387">range</span>&nbsp;<span class="op" id="4329393">*</span><span class="ident" id="4329394">p</span>&nbsp;<span class="op" id="4329396">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4329400">if</span>&nbsp;<span class="ident" id="4329403">e</span><span class="op" id="4329404">.</span><span class="ident" id="4329405">Pos</span><span class="op" id="4329408">.</span><span class="ident" id="4329409">Filename</span>&nbsp;<span class="op" id="4329418">!=</span>&nbsp;<span class="ident" id="4329421">last</span><span class="op" id="4329425">.</span><span class="ident" id="4329426">Filename</span>&nbsp;<span class="op" id="4329435">||</span>&nbsp;<span class="ident" id="4329438">e</span><span class="op" id="4329439">.</span><span class="ident" id="4329440">Pos</span><span class="op" id="4329443">.</span><span class="ident" id="4329444">Line</span>&nbsp;<span class="op" id="4329449">!=</span>&nbsp;<span class="ident" id="4329452">last</span><span class="op" id="4329456">.</span><span class="ident" id="4329457">Line</span>&nbsp;<span class="op" id="4329462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4329467">last</span>&nbsp;<span class="op" id="4329472">=</span>&nbsp;<span class="ident" id="4329474">e</span><span class="op" id="4329475">.</span><span class="ident" id="4329476">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4329483">(</span><span class="op" id="4329484">*</span><span class="ident" id="4329485">p</span><span class="op" id="4329486">)</span><span class="op" id="4329487">[</span><span class="ident" id="4329488">i</span><span class="op" id="4329489">]</span>&nbsp;<span class="op" id="4329491">=</span>&nbsp;<span class="ident" id="4329493">e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4329498">i</span><span class="op" id="4329499">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4329504">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4329507">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4329510">(</span><span class="op" id="4329511">*</span><span class="ident" id="4329512">p</span><span class="op" id="4329513">)</span>&nbsp;<span class="op" id="4329515">=</span>&nbsp;<span class="op" id="4329517">(</span><span class="op" id="4329518">*</span><span class="ident" id="4329519">p</span><span class="op" id="4329520">)</span><span class="op" id="4329521">[</span><span class="num" id="4329522">0</span><span class="op" id="4329523">:</span><span class="ident" id="4329524">i</span><span class="op" id="4329525">]</span><br>
<span class="lineno"></span><span class="op" id="4329527">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4329530">//&nbsp;An&nbsp;ErrorList&nbsp;implements&nbsp;the&nbsp;error&nbsp;interface.</span><br>
<span class="lineno">95</span><span class="keyword" id="4329578">func</span>&nbsp;<span class="op" id="4329583">(</span><span class="ident" id="4329584">p</span>&nbsp;<span class="ident" id="4329586">ErrorList</span><span class="op" id="4329595">)</span>&nbsp;<span class="ident" id="4329597">Error</span><span class="op" id="4329602">(</span><span class="op" id="4329603">)</span>&nbsp;<span class="builtintype" id="4329605">string</span>&nbsp;<span class="op" id="4329612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4329615">switch</span>&nbsp;<span class="builtinfunc" id="4329622">len</span><span class="op" id="4329625">(</span><span class="ident" id="4329626">p</span><span class="op" id="4329627">)</span>&nbsp;<span class="op" id="4329629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4329632">case</span>&nbsp;<span class="num" id="4329637">0</span><span class="op" id="4329638">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4329642">return</span>&nbsp;<span class="string" id="4329649">&#34;no&nbsp;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4329662">case</span>&nbsp;<span class="num" id="4329667">1</span><span class="op" id="4329668">:</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4329672">return</span>&nbsp;<span class="ident" id="4329679">p</span><span class="op" id="4329680">[</span><span class="num" id="4329681">0</span><span class="op" id="4329682">]</span><span class="op" id="4329683">.</span><span class="ident" id="4329684">Error</span><span class="op" id="4329689">(</span><span class="op" id="4329690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4329693">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4329696">return</span>&nbsp;<span class="ident" id="4329703">fmt</span><span class="op" id="4329706">.</span><span class="ident" id="4329707">Sprintf</span><span class="op" id="4329714">(</span><span class="string" id="4329715">&#34;%s&nbsp;(and&nbsp;%d&nbsp;more&nbsp;errors)&#34;</span><span class="op" id="4329740">,</span>&nbsp;<span class="ident" id="4329742">p</span><span class="op" id="4329743">[</span><span class="num" id="4329744">0</span><span class="op" id="4329745">]</span><span class="op" id="4329746">,</span>&nbsp;<span class="builtinfunc" id="4329748">len</span><span class="op" id="4329751">(</span><span class="ident" id="4329752">p</span><span class="op" id="4329753">)</span><span class="op" id="4329754">-</span><span class="num" id="4329755">1</span><span class="op" id="4329756">)</span><br>
<span class="lineno"></span><span class="op" id="4329758">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="comment" id="4329761">//&nbsp;Err&nbsp;returns&nbsp;an&nbsp;error&nbsp;equivalent&nbsp;to&nbsp;this&nbsp;error&nbsp;list.</span><br>
<span class="lineno"></span><span class="comment" id="4329816">//&nbsp;If&nbsp;the&nbsp;list&nbsp;is&nbsp;empty,&nbsp;Err&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="4329858">func</span>&nbsp;<span class="op" id="4329863">(</span><span class="ident" id="4329864">p</span>&nbsp;<span class="ident" id="4329866">ErrorList</span><span class="op" id="4329875">)</span>&nbsp;<span class="ident" id="4329877">Err</span><span class="op" id="4329880">(</span><span class="op" id="4329881">)</span>&nbsp;<span class="builtintype" id="4329883">error</span>&nbsp;<span class="op" id="4329889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4329892">if</span>&nbsp;<span class="builtinfunc" id="4329895">len</span><span class="op" id="4329898">(</span><span class="ident" id="4329899">p</span><span class="op" id="4329900">)</span>&nbsp;<span class="op" id="4329902">==</span>&nbsp;<span class="num" id="4329905">0</span>&nbsp;<span class="op" id="4329907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4329911">return</span>&nbsp;<span class="ident" id="4329918">nil</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4329923">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4329926">return</span>&nbsp;<span class="ident" id="4329933">p</span><br>
<span class="lineno"></span><span class="op" id="4329935">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4329938">//&nbsp;PrintError&nbsp;is&nbsp;a&nbsp;utility&nbsp;function&nbsp;that&nbsp;prints&nbsp;a&nbsp;list&nbsp;of&nbsp;errors&nbsp;to&nbsp;w,</span><br>
<span class="lineno">115</span><span class="comment" id="4330009">//&nbsp;one&nbsp;error&nbsp;per&nbsp;line,&nbsp;if&nbsp;the&nbsp;err&nbsp;parameter&nbsp;is&nbsp;an&nbsp;ErrorList.&nbsp;Otherwise</span><br>
<span class="lineno"></span><span class="comment" id="4330080">//&nbsp;it&nbsp;prints&nbsp;the&nbsp;err&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="4330109">//</span><br>
<span class="lineno"></span><span class="keyword" id="4330112">func</span>&nbsp;<span class="ident" id="4330117">PrintError</span><span class="op" id="4330127">(</span><span class="ident" id="4330128">w</span>&nbsp;<span class="ident" id="4330130">io</span><span class="op" id="4330132">.</span><span class="ident" id="4330133">Writer</span><span class="op" id="4330139">,</span>&nbsp;<span class="ident" id="4330141">err</span>&nbsp;<span class="builtintype" id="4330145">error</span><span class="op" id="4330150">)</span>&nbsp;<span class="op" id="4330152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4330155">if</span>&nbsp;<span class="ident" id="4330158">list</span><span class="op" id="4330162">,</span>&nbsp;<span class="ident" id="4330164">ok</span>&nbsp;<span class="op" id="4330167">:=</span>&nbsp;<span class="ident" id="4330170">err</span><span class="op" id="4330173">.</span><span class="op" id="4330174">(</span><span class="ident" id="4330175">ErrorList</span><span class="op" id="4330184">)</span><span class="op" id="4330185">;</span>&nbsp;<span class="ident" id="4330187">ok</span>&nbsp;<span class="op" id="4330190">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4330194">for</span>&nbsp;<span class="ident" id="4330198">_</span><span class="op" id="4330199">,</span>&nbsp;<span class="ident" id="4330201">e</span>&nbsp;<span class="op" id="4330203">:=</span>&nbsp;<span class="keyword" id="4330206">range</span>&nbsp;<span class="ident" id="4330212">list</span>&nbsp;<span class="op" id="4330217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4330222">fmt</span><span class="op" id="4330225">.</span><span class="ident" id="4330226">Fprintf</span><span class="op" id="4330233">(</span><span class="ident" id="4330234">w</span><span class="op" id="4330235">,</span>&nbsp;<span class="string" id="4330237">&#34;%s\n&#34;</span><span class="op" id="4330243">,</span>&nbsp;<span class="ident" id="4330245">e</span><span class="op" id="4330246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4330250">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4330253">}</span>&nbsp;<span class="keyword" id="4330255">else</span>&nbsp;<span class="keyword" id="4330260">if</span>&nbsp;<span class="ident" id="4330263">err</span>&nbsp;<span class="op" id="4330267">!=</span>&nbsp;<span class="ident" id="4330270">nil</span>&nbsp;<span class="op" id="4330274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4330278">fmt</span><span class="op" id="4330281">.</span><span class="ident" id="4330282">Fprintf</span><span class="op" id="4330289">(</span><span class="ident" id="4330290">w</span><span class="op" id="4330291">,</span>&nbsp;<span class="string" id="4330293">&#34;%s\n&#34;</span><span class="op" id="4330299">,</span>&nbsp;<span class="ident" id="4330301">err</span><span class="op" id="4330304">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4330307">}</span><br>
<span class="lineno"></span><span class="op" id="4330309">}</span>
</div>
</body>
</html>
