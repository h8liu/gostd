<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>mime</h2>
<ul>
<li><a href="/gostd/mime/grammar.go.html">grammar.go</a></li>
<li><a href="/gostd/mime/mediatype.go.html">mediatype.go</a></li>
<li><a href="/gostd/mime/mediatype_test.go.html" class="current">mediatype_test.go</a></li>
<li><a href="/gostd/mime/type.go.html">type.go</a></li>
<li><a href="/gostd/mime/type_test.go.html">type_test.go</a></li>
<li><a href="/gostd/mime/type_unix.go.html">type_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7333800">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7333855">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7333909">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7333960">package</span>&nbsp;<span class="ident" id="7333968">mime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7333974">import</span>&nbsp;<span class="op" id="7333981">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7333984">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7333995">&#34;testing&#34;</span><br>
<span class="lineno">10</span><span class="op" id="7334005">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7334008">func</span>&nbsp;<span class="ident" id="7334013">TestConsumeToken</span><span class="op" id="7334029">(</span><span class="ident" id="7334030">t</span>&nbsp;<span class="op" id="7334032">*</span><span class="ident" id="7334033">testing</span><span class="op" id="7334040">.</span><span class="ident" id="7334041">T</span><span class="op" id="7334042">)</span>&nbsp;<span class="op" id="7334044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7334047">tests</span>&nbsp;<span class="op" id="7334053">:=</span>&nbsp;<span class="op" id="7334056">[</span><span class="op" id="7334057">...</span><span class="op" id="7334060">]</span><span class="op" id="7334061">[</span><span class="num" id="7334062">3</span><span class="op" id="7334063">]</span><span class="builtintype" id="7334064">string</span><span class="op" id="7334070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7334074">{</span><span class="string" id="7334075">&#34;foo&nbsp;bar&#34;</span><span class="op" id="7334084">,</span>&nbsp;<span class="string" id="7334086">&#34;foo&#34;</span><span class="op" id="7334091">,</span>&nbsp;<span class="string" id="7334093">&#34;&nbsp;bar&#34;</span><span class="op" id="7334099">}</span><span class="op" id="7334100">,</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7334104">{</span><span class="string" id="7334105">&#34;bar&#34;</span><span class="op" id="7334110">,</span>&nbsp;<span class="string" id="7334112">&#34;bar&#34;</span><span class="op" id="7334117">,</span>&nbsp;<span class="string" id="7334119">&#34;&#34;</span><span class="op" id="7334121">}</span><span class="op" id="7334122">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7334126">{</span><span class="string" id="7334127">&#34;&#34;</span><span class="op" id="7334129">,</span>&nbsp;<span class="string" id="7334131">&#34;&#34;</span><span class="op" id="7334133">,</span>&nbsp;<span class="string" id="7334135">&#34;&#34;</span><span class="op" id="7334137">}</span><span class="op" id="7334138">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7334142">{</span><span class="string" id="7334143">&#34;&nbsp;foo&#34;</span><span class="op" id="7334149">,</span>&nbsp;<span class="string" id="7334151">&#34;&#34;</span><span class="op" id="7334153">,</span>&nbsp;<span class="string" id="7334155">&#34;&nbsp;foo&#34;</span><span class="op" id="7334161">}</span><span class="op" id="7334162">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7334165">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7334168">for</span>&nbsp;<span class="ident" id="7334172">_</span><span class="op" id="7334173">,</span>&nbsp;<span class="ident" id="7334175">test</span>&nbsp;<span class="op" id="7334180">:=</span>&nbsp;<span class="keyword" id="7334183">range</span>&nbsp;<span class="ident" id="7334189">tests</span>&nbsp;<span class="op" id="7334195">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7334199">token</span><span class="op" id="7334204">,</span>&nbsp;<span class="ident" id="7334206">rest</span>&nbsp;<span class="op" id="7334211">:=</span>&nbsp;<span class="ident" id="7334214">consumeToken</span><span class="op" id="7334226">(</span><span class="ident" id="7334227">test</span><span class="op" id="7334231">[</span><span class="num" id="7334232">0</span><span class="op" id="7334233">]</span><span class="op" id="7334234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7334238">expectedToken</span>&nbsp;<span class="op" id="7334252">:=</span>&nbsp;<span class="ident" id="7334255">test</span><span class="op" id="7334259">[</span><span class="num" id="7334260">1</span><span class="op" id="7334261">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7334265">expectedRest</span>&nbsp;<span class="op" id="7334278">:=</span>&nbsp;<span class="ident" id="7334281">test</span><span class="op" id="7334285">[</span><span class="num" id="7334286">2</span><span class="op" id="7334287">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7334291">if</span>&nbsp;<span class="ident" id="7334294">token</span>&nbsp;<span class="op" id="7334300">!=</span>&nbsp;<span class="ident" id="7334303">expectedToken</span>&nbsp;<span class="op" id="7334317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7334322">t</span><span class="op" id="7334323">.</span><span class="ident" id="7334324">Errorf</span><span class="op" id="7334330">(</span><span class="string" id="7334331">&#34;expected&nbsp;to&nbsp;consume&nbsp;token&nbsp;&#39;%s&#39;,&nbsp;not&nbsp;&#39;%s&#39;&nbsp;from&nbsp;&#39;%s&#39;&#34;</span><span class="op" id="7334383">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7334389">expectedToken</span><span class="op" id="7334402">,</span>&nbsp;<span class="ident" id="7334404">token</span><span class="op" id="7334409">,</span>&nbsp;<span class="ident" id="7334411">test</span><span class="op" id="7334415">[</span><span class="num" id="7334416">0</span><span class="op" id="7334417">]</span><span class="op" id="7334418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7334422">}</span>&nbsp;<span class="keyword" id="7334424">else</span>&nbsp;<span class="keyword" id="7334429">if</span>&nbsp;<span class="ident" id="7334432">rest</span>&nbsp;<span class="op" id="7334437">!=</span>&nbsp;<span class="ident" id="7334440">expectedRest</span>&nbsp;<span class="op" id="7334453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7334458">t</span><span class="op" id="7334459">.</span><span class="ident" id="7334460">Errorf</span><span class="op" id="7334466">(</span><span class="string" id="7334467">&#34;expected&nbsp;to&nbsp;have&nbsp;left&nbsp;&#39;%s&#39;,&nbsp;not&nbsp;&#39;%s&#39;&nbsp;after&nbsp;reading&nbsp;token&nbsp;&#39;%s&#39;&nbsp;from&nbsp;&#39;%s&#39;&#34;</span><span class="op" id="7334540">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7334546">expectedRest</span><span class="op" id="7334558">,</span>&nbsp;<span class="ident" id="7334560">rest</span><span class="op" id="7334564">,</span>&nbsp;<span class="ident" id="7334566">token</span><span class="op" id="7334571">,</span>&nbsp;<span class="ident" id="7334573">test</span><span class="op" id="7334577">[</span><span class="num" id="7334578">0</span><span class="op" id="7334579">]</span><span class="op" id="7334580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7334584">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7334587">}</span><br>
<span class="lineno"></span><span class="op" id="7334589">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7334592">func</span>&nbsp;<span class="ident" id="7334597">TestConsumeValue</span><span class="op" id="7334613">(</span><span class="ident" id="7334614">t</span>&nbsp;<span class="op" id="7334616">*</span><span class="ident" id="7334617">testing</span><span class="op" id="7334624">.</span><span class="ident" id="7334625">T</span><span class="op" id="7334626">)</span>&nbsp;<span class="op" id="7334628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7334631">tests</span>&nbsp;<span class="op" id="7334637">:=</span>&nbsp;<span class="op" id="7334640">[</span><span class="op" id="7334641">...</span><span class="op" id="7334644">]</span><span class="op" id="7334645">[</span><span class="num" id="7334646">3</span><span class="op" id="7334647">]</span><span class="builtintype" id="7334648">string</span><span class="op" id="7334654">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7334658">{</span><span class="string" id="7334659">&#34;foo&nbsp;bar&#34;</span><span class="op" id="7334668">,</span>&nbsp;<span class="string" id="7334670">&#34;foo&#34;</span><span class="op" id="7334675">,</span>&nbsp;<span class="string" id="7334677">&#34;&nbsp;bar&#34;</span><span class="op" id="7334683">}</span><span class="op" id="7334684">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7334688">{</span><span class="string" id="7334689">&#34;bar&#34;</span><span class="op" id="7334694">,</span>&nbsp;<span class="string" id="7334696">&#34;bar&#34;</span><span class="op" id="7334701">,</span>&nbsp;<span class="string" id="7334703">&#34;&#34;</span><span class="op" id="7334705">}</span><span class="op" id="7334706">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7334710">{</span><span class="string" id="7334711">&#34;&nbsp;bar&nbsp;&#34;</span><span class="op" id="7334718">,</span>&nbsp;<span class="string" id="7334720">&#34;&#34;</span><span class="op" id="7334722">,</span>&nbsp;<span class="string" id="7334724">&#34;&nbsp;bar&nbsp;&#34;</span><span class="op" id="7334731">}</span><span class="op" id="7334732">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7334736">{</span><span class="string" id="7334737">`&#34;My&nbsp;value&#34;end`</span><span class="op" id="7334752">,</span>&nbsp;<span class="string" id="7334754">&#34;My&nbsp;value&#34;</span><span class="op" id="7334764">,</span>&nbsp;<span class="string" id="7334766">&#34;end&#34;</span><span class="op" id="7334771">}</span><span class="op" id="7334772">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7334776">{</span><span class="string" id="7334777">`&#34;My&nbsp;value&#34;&nbsp;end`</span><span class="op" id="7334793">,</span>&nbsp;<span class="string" id="7334795">&#34;My&nbsp;value&#34;</span><span class="op" id="7334805">,</span>&nbsp;<span class="string" id="7334807">&#34;&nbsp;end&#34;</span><span class="op" id="7334813">}</span><span class="op" id="7334814">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7334818">{</span><span class="string" id="7334819">`&#34;\\&#34;&nbsp;rest`</span><span class="op" id="7334830">,</span>&nbsp;<span class="string" id="7334832">&#34;\\&#34;</span><span class="op" id="7334836">,</span>&nbsp;<span class="string" id="7334838">&#34;&nbsp;rest&#34;</span><span class="op" id="7334845">}</span><span class="op" id="7334846">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7334850">{</span><span class="string" id="7334851">`&#34;My&nbsp;\&#34;&nbsp;value&#34;end`</span><span class="op" id="7334869">,</span>&nbsp;<span class="string" id="7334871">&#34;My&nbsp;\&#34;&nbsp;value&#34;</span><span class="op" id="7334884">,</span>&nbsp;<span class="string" id="7334886">&#34;end&#34;</span><span class="op" id="7334891">}</span><span class="op" id="7334892">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7334896">{</span><span class="string" id="7334897">`&#34;\&#34;&nbsp;rest`</span><span class="op" id="7334907">,</span>&nbsp;<span class="string" id="7334909">&#34;&#34;</span><span class="op" id="7334911">,</span>&nbsp;<span class="string" id="7334913">`&#34;\&#34;&nbsp;rest`</span><span class="op" id="7334923">}</span><span class="op" id="7334924">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7334927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7334930">for</span>&nbsp;<span class="ident" id="7334934">_</span><span class="op" id="7334935">,</span>&nbsp;<span class="ident" id="7334937">test</span>&nbsp;<span class="op" id="7334942">:=</span>&nbsp;<span class="keyword" id="7334945">range</span>&nbsp;<span class="ident" id="7334951">tests</span>&nbsp;<span class="op" id="7334957">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7334961">value</span><span class="op" id="7334966">,</span>&nbsp;<span class="ident" id="7334968">rest</span>&nbsp;<span class="op" id="7334973">:=</span>&nbsp;<span class="ident" id="7334976">consumeValue</span><span class="op" id="7334988">(</span><span class="ident" id="7334989">test</span><span class="op" id="7334993">[</span><span class="num" id="7334994">0</span><span class="op" id="7334995">]</span><span class="op" id="7334996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7335000">expectedValue</span>&nbsp;<span class="op" id="7335014">:=</span>&nbsp;<span class="ident" id="7335017">test</span><span class="op" id="7335021">[</span><span class="num" id="7335022">1</span><span class="op" id="7335023">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7335027">expectedRest</span>&nbsp;<span class="op" id="7335040">:=</span>&nbsp;<span class="ident" id="7335043">test</span><span class="op" id="7335047">[</span><span class="num" id="7335048">2</span><span class="op" id="7335049">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7335053">if</span>&nbsp;<span class="ident" id="7335056">value</span>&nbsp;<span class="op" id="7335062">!=</span>&nbsp;<span class="ident" id="7335065">expectedValue</span>&nbsp;<span class="op" id="7335079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7335084">t</span><span class="op" id="7335085">.</span><span class="ident" id="7335086">Errorf</span><span class="op" id="7335092">(</span><span class="string" id="7335093">&#34;expected&nbsp;to&nbsp;consume&nbsp;value&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="7335145">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7335151">expectedValue</span><span class="op" id="7335164">,</span>&nbsp;<span class="ident" id="7335166">value</span><span class="op" id="7335171">,</span>&nbsp;<span class="ident" id="7335173">test</span><span class="op" id="7335177">[</span><span class="num" id="7335178">0</span><span class="op" id="7335179">]</span><span class="op" id="7335180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7335184">}</span>&nbsp;<span class="keyword" id="7335186">else</span>&nbsp;<span class="keyword" id="7335191">if</span>&nbsp;<span class="ident" id="7335194">rest</span>&nbsp;<span class="op" id="7335199">!=</span>&nbsp;<span class="ident" id="7335202">expectedRest</span>&nbsp;<span class="op" id="7335215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7335220">t</span><span class="op" id="7335221">.</span><span class="ident" id="7335222">Errorf</span><span class="op" id="7335228">(</span><span class="string" id="7335229">&#34;expected&nbsp;to&nbsp;have&nbsp;left&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;after&nbsp;reading&nbsp;value&nbsp;[%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="7335302">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7335308">expectedRest</span><span class="op" id="7335320">,</span>&nbsp;<span class="ident" id="7335322">rest</span><span class="op" id="7335326">,</span>&nbsp;<span class="ident" id="7335328">value</span><span class="op" id="7335333">,</span>&nbsp;<span class="ident" id="7335335">test</span><span class="op" id="7335339">[</span><span class="num" id="7335340">0</span><span class="op" id="7335341">]</span><span class="op" id="7335342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7335346">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7335349">}</span><br>
<span class="lineno"></span><span class="op" id="7335351">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7335354">func</span>&nbsp;<span class="ident" id="7335359">TestConsumeMediaParam</span><span class="op" id="7335380">(</span><span class="ident" id="7335381">t</span>&nbsp;<span class="op" id="7335383">*</span><span class="ident" id="7335384">testing</span><span class="op" id="7335391">.</span><span class="ident" id="7335392">T</span><span class="op" id="7335393">)</span>&nbsp;<span class="op" id="7335395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7335398">tests</span>&nbsp;<span class="op" id="7335404">:=</span>&nbsp;<span class="op" id="7335407">[</span><span class="op" id="7335408">...</span><span class="op" id="7335411">]</span><span class="op" id="7335412">[</span><span class="num" id="7335413">4</span><span class="op" id="7335414">]</span><span class="builtintype" id="7335415">string</span><span class="op" id="7335421">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7335425">{</span><span class="string" id="7335426">&#34;&nbsp;;&nbsp;foo=bar&#34;</span><span class="op" id="7335438">,</span>&nbsp;<span class="string" id="7335440">&#34;foo&#34;</span><span class="op" id="7335445">,</span>&nbsp;<span class="string" id="7335447">&#34;bar&#34;</span><span class="op" id="7335452">,</span>&nbsp;<span class="string" id="7335454">&#34;&#34;</span><span class="op" id="7335456">}</span><span class="op" id="7335457">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7335461">{</span><span class="string" id="7335462">&#34;;&nbsp;foo=bar&#34;</span><span class="op" id="7335473">,</span>&nbsp;<span class="string" id="7335475">&#34;foo&#34;</span><span class="op" id="7335480">,</span>&nbsp;<span class="string" id="7335482">&#34;bar&#34;</span><span class="op" id="7335487">,</span>&nbsp;<span class="string" id="7335489">&#34;&#34;</span><span class="op" id="7335491">}</span><span class="op" id="7335492">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7335496">{</span><span class="string" id="7335497">&#34;;foo=bar&#34;</span><span class="op" id="7335507">,</span>&nbsp;<span class="string" id="7335509">&#34;foo&#34;</span><span class="op" id="7335514">,</span>&nbsp;<span class="string" id="7335516">&#34;bar&#34;</span><span class="op" id="7335521">,</span>&nbsp;<span class="string" id="7335523">&#34;&#34;</span><span class="op" id="7335525">}</span><span class="op" id="7335526">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7335530">{</span><span class="string" id="7335531">&#34;;FOO=bar&#34;</span><span class="op" id="7335541">,</span>&nbsp;<span class="string" id="7335543">&#34;foo&#34;</span><span class="op" id="7335548">,</span>&nbsp;<span class="string" id="7335550">&#34;bar&#34;</span><span class="op" id="7335555">,</span>&nbsp;<span class="string" id="7335557">&#34;&#34;</span><span class="op" id="7335559">}</span><span class="op" id="7335560">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7335564">{</span><span class="string" id="7335565">`;foo=&#34;bar&#34;`</span><span class="op" id="7335577">,</span>&nbsp;<span class="string" id="7335579">&#34;foo&#34;</span><span class="op" id="7335584">,</span>&nbsp;<span class="string" id="7335586">&#34;bar&#34;</span><span class="op" id="7335591">,</span>&nbsp;<span class="string" id="7335593">&#34;&#34;</span><span class="op" id="7335595">}</span><span class="op" id="7335596">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7335600">{</span><span class="string" id="7335601">`;foo=&#34;bar&#34;;&nbsp;`</span><span class="op" id="7335615">,</span>&nbsp;<span class="string" id="7335617">&#34;foo&#34;</span><span class="op" id="7335622">,</span>&nbsp;<span class="string" id="7335624">&#34;bar&#34;</span><span class="op" id="7335629">,</span>&nbsp;<span class="string" id="7335631">&#34;;&nbsp;&#34;</span><span class="op" id="7335635">}</span><span class="op" id="7335636">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7335640">{</span><span class="string" id="7335641">`;foo=&#34;bar&#34;;&nbsp;foo=baz`</span><span class="op" id="7335662">,</span>&nbsp;<span class="string" id="7335664">&#34;foo&#34;</span><span class="op" id="7335669">,</span>&nbsp;<span class="string" id="7335671">&#34;bar&#34;</span><span class="op" id="7335676">,</span>&nbsp;<span class="string" id="7335678">&#34;;&nbsp;foo=baz&#34;</span><span class="op" id="7335689">}</span><span class="op" id="7335690">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7335694">{</span><span class="string" id="7335695">`&nbsp;;&nbsp;boundary=----CUT;`</span><span class="op" id="7335717">,</span>&nbsp;<span class="string" id="7335719">&#34;boundary&#34;</span><span class="op" id="7335729">,</span>&nbsp;<span class="string" id="7335731">&#34;----CUT&#34;</span><span class="op" id="7335740">,</span>&nbsp;<span class="string" id="7335742">&#34;;&#34;</span><span class="op" id="7335745">}</span><span class="op" id="7335746">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7335750">{</span><span class="string" id="7335751">`&nbsp;;&nbsp;key=value;&nbsp;&nbsp;blah=&#34;value&#34;;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="7335792">,</span>&nbsp;<span class="string" id="7335794">&#34;key&#34;</span><span class="op" id="7335799">,</span>&nbsp;<span class="string" id="7335801">&#34;value&#34;</span><span class="op" id="7335808">,</span>&nbsp;<span class="string" id="7335810">`;&nbsp;&nbsp;blah=&#34;value&#34;;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="7335839">}</span><span class="op" id="7335840">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7335844">{</span><span class="string" id="7335845">`;&nbsp;&nbsp;blah=&#34;value&#34;;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="7335874">,</span>&nbsp;<span class="string" id="7335876">&#34;blah&#34;</span><span class="op" id="7335882">,</span>&nbsp;<span class="string" id="7335884">&#34;value&#34;</span><span class="op" id="7335891">,</span>&nbsp;<span class="string" id="7335893">`;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="7335907">}</span><span class="op" id="7335908">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7335912">{</span><span class="string" id="7335913">`;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="7335927">,</span>&nbsp;<span class="string" id="7335929">&#34;name&#34;</span><span class="op" id="7335935">,</span>&nbsp;<span class="string" id="7335937">&#34;foo&#34;</span><span class="op" id="7335942">,</span>&nbsp;<span class="string" id="7335944">`&nbsp;`</span><span class="op" id="7335947">}</span><span class="op" id="7335948">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7335951">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7335954">for</span>&nbsp;<span class="ident" id="7335958">_</span><span class="op" id="7335959">,</span>&nbsp;<span class="ident" id="7335961">test</span>&nbsp;<span class="op" id="7335966">:=</span>&nbsp;<span class="keyword" id="7335969">range</span>&nbsp;<span class="ident" id="7335975">tests</span>&nbsp;<span class="op" id="7335981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7335985">param</span><span class="op" id="7335990">,</span>&nbsp;<span class="ident" id="7335992">value</span><span class="op" id="7335997">,</span>&nbsp;<span class="ident" id="7335999">rest</span>&nbsp;<span class="op" id="7336004">:=</span>&nbsp;<span class="ident" id="7336007">consumeMediaParam</span><span class="op" id="7336024">(</span><span class="ident" id="7336025">test</span><span class="op" id="7336029">[</span><span class="num" id="7336030">0</span><span class="op" id="7336031">]</span><span class="op" id="7336032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7336036">expectedParam</span>&nbsp;<span class="op" id="7336050">:=</span>&nbsp;<span class="ident" id="7336053">test</span><span class="op" id="7336057">[</span><span class="num" id="7336058">1</span><span class="op" id="7336059">]</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7336063">expectedValue</span>&nbsp;<span class="op" id="7336077">:=</span>&nbsp;<span class="ident" id="7336080">test</span><span class="op" id="7336084">[</span><span class="num" id="7336085">2</span><span class="op" id="7336086">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7336090">expectedRest</span>&nbsp;<span class="op" id="7336103">:=</span>&nbsp;<span class="ident" id="7336106">test</span><span class="op" id="7336110">[</span><span class="num" id="7336111">3</span><span class="op" id="7336112">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7336116">if</span>&nbsp;<span class="ident" id="7336119">param</span>&nbsp;<span class="op" id="7336125">!=</span>&nbsp;<span class="ident" id="7336128">expectedParam</span>&nbsp;<span class="op" id="7336142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7336147">t</span><span class="op" id="7336148">.</span><span class="ident" id="7336149">Errorf</span><span class="op" id="7336155">(</span><span class="string" id="7336156">&#34;expected&nbsp;to&nbsp;consume&nbsp;param&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="7336208">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7336214">expectedParam</span><span class="op" id="7336227">,</span>&nbsp;<span class="ident" id="7336229">param</span><span class="op" id="7336234">,</span>&nbsp;<span class="ident" id="7336236">test</span><span class="op" id="7336240">[</span><span class="num" id="7336241">0</span><span class="op" id="7336242">]</span><span class="op" id="7336243">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7336247">}</span>&nbsp;<span class="keyword" id="7336249">else</span>&nbsp;<span class="keyword" id="7336254">if</span>&nbsp;<span class="ident" id="7336257">value</span>&nbsp;<span class="op" id="7336263">!=</span>&nbsp;<span class="ident" id="7336266">expectedValue</span>&nbsp;<span class="op" id="7336280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7336285">t</span><span class="op" id="7336286">.</span><span class="ident" id="7336287">Errorf</span><span class="op" id="7336293">(</span><span class="string" id="7336294">&#34;expected&nbsp;to&nbsp;consume&nbsp;value&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="7336346">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7336352">expectedValue</span><span class="op" id="7336365">,</span>&nbsp;<span class="ident" id="7336367">value</span><span class="op" id="7336372">,</span>&nbsp;<span class="ident" id="7336374">test</span><span class="op" id="7336378">[</span><span class="num" id="7336379">0</span><span class="op" id="7336380">]</span><span class="op" id="7336381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7336385">}</span>&nbsp;<span class="keyword" id="7336387">else</span>&nbsp;<span class="keyword" id="7336392">if</span>&nbsp;<span class="ident" id="7336395">rest</span>&nbsp;<span class="op" id="7336400">!=</span>&nbsp;<span class="ident" id="7336403">expectedRest</span>&nbsp;<span class="op" id="7336416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7336421">t</span><span class="op" id="7336422">.</span><span class="ident" id="7336423">Errorf</span><span class="op" id="7336429">(</span><span class="string" id="7336430">&#34;expected&nbsp;to&nbsp;have&nbsp;left&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;after&nbsp;reading&nbsp;[%s/%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="7336500">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7336506">expectedRest</span><span class="op" id="7336518">,</span>&nbsp;<span class="ident" id="7336520">rest</span><span class="op" id="7336524">,</span>&nbsp;<span class="ident" id="7336526">param</span><span class="op" id="7336531">,</span>&nbsp;<span class="ident" id="7336533">value</span><span class="op" id="7336538">,</span>&nbsp;<span class="ident" id="7336540">test</span><span class="op" id="7336544">[</span><span class="num" id="7336545">0</span><span class="op" id="7336546">]</span><span class="op" id="7336547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7336551">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7336554">}</span><br>
<span class="lineno"></span><span class="op" id="7336556">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="7336559">type</span>&nbsp;<span class="ident" id="7336564">mediaTypeTest</span>&nbsp;<span class="keyword" id="7336578">struct</span>&nbsp;<span class="op" id="7336585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7336588">in</span>&nbsp;<span class="builtintype" id="7336591">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7336599">t</span>&nbsp;&nbsp;<span class="builtintype" id="7336602">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7336610">p</span>&nbsp;&nbsp;<span class="keyword" id="7336613">map</span><span class="op" id="7336616">[</span><span class="builtintype" id="7336617">string</span><span class="op" id="7336623">]</span><span class="builtintype" id="7336624">string</span><br>
<span class="lineno"></span><span class="op" id="7336631">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="7336634">func</span>&nbsp;<span class="ident" id="7336639">TestParseMediaType</span><span class="op" id="7336657">(</span><span class="ident" id="7336658">t</span>&nbsp;<span class="op" id="7336660">*</span><span class="ident" id="7336661">testing</span><span class="op" id="7336668">.</span><span class="ident" id="7336669">T</span><span class="op" id="7336670">)</span>&nbsp;<span class="op" id="7336672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7336675">//&nbsp;Convenience&nbsp;map&nbsp;initializer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7336707">m</span>&nbsp;<span class="op" id="7336709">:=</span>&nbsp;<span class="keyword" id="7336712">func</span><span class="op" id="7336716">(</span><span class="ident" id="7336717">s</span>&nbsp;<span class="op" id="7336719">...</span><span class="builtintype" id="7336722">string</span><span class="op" id="7336728">)</span>&nbsp;<span class="keyword" id="7336730">map</span><span class="op" id="7336733">[</span><span class="builtintype" id="7336734">string</span><span class="op" id="7336740">]</span><span class="builtintype" id="7336741">string</span>&nbsp;<span class="op" id="7336748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7336752">sm</span>&nbsp;<span class="op" id="7336755">:=</span>&nbsp;<span class="builtinfunc" id="7336758">make</span><span class="op" id="7336762">(</span><span class="keyword" id="7336763">map</span><span class="op" id="7336766">[</span><span class="builtintype" id="7336767">string</span><span class="op" id="7336773">]</span><span class="builtintype" id="7336774">string</span><span class="op" id="7336780">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7336784">for</span>&nbsp;<span class="ident" id="7336788">i</span>&nbsp;<span class="op" id="7336790">:=</span>&nbsp;<span class="num" id="7336793">0</span><span class="op" id="7336794">;</span>&nbsp;<span class="ident" id="7336796">i</span>&nbsp;<span class="op" id="7336798">&lt;</span>&nbsp;<span class="builtinfunc" id="7336800">len</span><span class="op" id="7336803">(</span><span class="ident" id="7336804">s</span><span class="op" id="7336805">)</span><span class="op" id="7336806">;</span>&nbsp;<span class="ident" id="7336808">i</span>&nbsp;<span class="op" id="7336810">+=</span>&nbsp;<span class="num" id="7336813">2</span>&nbsp;<span class="op" id="7336815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7336820">sm</span><span class="op" id="7336822">[</span><span class="ident" id="7336823">s</span><span class="op" id="7336824">[</span><span class="ident" id="7336825">i</span><span class="op" id="7336826">]</span><span class="op" id="7336827">]</span>&nbsp;<span class="op" id="7336829">=</span>&nbsp;<span class="ident" id="7336831">s</span><span class="op" id="7336832">[</span><span class="ident" id="7336833">i</span><span class="op" id="7336834">+</span><span class="num" id="7336835">1</span><span class="op" id="7336836">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7336840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7336844">return</span>&nbsp;<span class="ident" id="7336851">sm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7336855">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7336859">nameFoo</span>&nbsp;<span class="op" id="7336867">:=</span>&nbsp;<span class="keyword" id="7336870">map</span><span class="op" id="7336873">[</span><span class="builtintype" id="7336874">string</span><span class="op" id="7336880">]</span><span class="builtintype" id="7336881">string</span><span class="op" id="7336887">{</span><span class="string" id="7336888">&#34;name&#34;</span><span class="op" id="7336894">:</span>&nbsp;<span class="string" id="7336896">&#34;foo&#34;</span><span class="op" id="7336901">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7336904">tests</span>&nbsp;<span class="op" id="7336910">:=</span>&nbsp;<span class="op" id="7336913">[</span><span class="op" id="7336914">]</span><span class="ident" id="7336915">mediaTypeTest</span><span class="op" id="7336928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7336932">{</span><span class="string" id="7336933">`form-data;&nbsp;name=&#34;foo&#34;`</span><span class="op" id="7336956">,</span>&nbsp;<span class="string" id="7336958">&#34;form-data&#34;</span><span class="op" id="7336969">,</span>&nbsp;<span class="ident" id="7336971">nameFoo</span><span class="op" id="7336978">}</span><span class="op" id="7336979">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7336983">{</span><span class="string" id="7336984">`&nbsp;form-data&nbsp;;&nbsp;name=foo`</span><span class="op" id="7337007">,</span>&nbsp;<span class="string" id="7337009">&#34;form-data&#34;</span><span class="op" id="7337020">,</span>&nbsp;<span class="ident" id="7337022">nameFoo</span><span class="op" id="7337029">}</span><span class="op" id="7337030">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7337034">{</span><span class="string" id="7337035">`FORM-DATA;name=&#34;foo&#34;`</span><span class="op" id="7337057">,</span>&nbsp;<span class="string" id="7337059">&#34;form-data&#34;</span><span class="op" id="7337070">,</span>&nbsp;<span class="ident" id="7337072">nameFoo</span><span class="op" id="7337079">}</span><span class="op" id="7337080">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7337084">{</span><span class="string" id="7337085">`&nbsp;FORM-DATA&nbsp;;&nbsp;name=&#34;foo&#34;`</span><span class="op" id="7337110">,</span>&nbsp;<span class="string" id="7337112">&#34;form-data&#34;</span><span class="op" id="7337123">,</span>&nbsp;<span class="ident" id="7337125">nameFoo</span><span class="op" id="7337132">}</span><span class="op" id="7337133">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7337137">{</span><span class="string" id="7337138">`&nbsp;FORM-DATA&nbsp;;&nbsp;name=&#34;foo&#34;`</span><span class="op" id="7337163">,</span>&nbsp;<span class="string" id="7337165">&#34;form-data&#34;</span><span class="op" id="7337176">,</span>&nbsp;<span class="ident" id="7337178">nameFoo</span><span class="op" id="7337185">}</span><span class="op" id="7337186">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7337191">{</span><span class="string" id="7337192">`form-data;&nbsp;key=value;&nbsp;&nbsp;blah=&#34;value&#34;;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="7337241">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7337246">&#34;form-data&#34;</span><span class="op" id="7337257">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7337262">m</span><span class="op" id="7337263">(</span><span class="string" id="7337264">&#34;key&#34;</span><span class="op" id="7337269">,</span>&nbsp;<span class="string" id="7337271">&#34;value&#34;</span><span class="op" id="7337278">,</span>&nbsp;<span class="string" id="7337280">&#34;blah&#34;</span><span class="op" id="7337286">,</span>&nbsp;<span class="string" id="7337288">&#34;value&#34;</span><span class="op" id="7337295">,</span>&nbsp;<span class="string" id="7337297">&#34;name&#34;</span><span class="op" id="7337303">,</span>&nbsp;<span class="string" id="7337305">&#34;foo&#34;</span><span class="op" id="7337310">)</span><span class="op" id="7337311">}</span><span class="op" id="7337312">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7337317">{</span><span class="string" id="7337318">`foo;&nbsp;key=val1;&nbsp;key=the-key-appears-again-which-is-bogus`</span><span class="op" id="7337375">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7337380">&#34;&#34;</span><span class="op" id="7337382">,</span>&nbsp;<span class="ident" id="7337384">m</span><span class="op" id="7337385">(</span><span class="op" id="7337386">)</span><span class="op" id="7337387">}</span><span class="op" id="7337388">,</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7337393">//&nbsp;From&nbsp;RFC&nbsp;2231:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7337413">{</span><span class="string" id="7337414">`application/x-stuff;&nbsp;title*=us-ascii&#39;en-us&#39;This%20is%20%2A%2A%2Afun%2A%2A%2A`</span><span class="op" id="7337492">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7337497">&#34;application/x-stuff&#34;</span><span class="op" id="7337518">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7337523">m</span><span class="op" id="7337524">(</span><span class="string" id="7337525">&#34;title&#34;</span><span class="op" id="7337532">,</span>&nbsp;<span class="string" id="7337534">&#34;This&nbsp;is&nbsp;***fun***&#34;</span><span class="op" id="7337553">)</span><span class="op" id="7337554">}</span><span class="op" id="7337555">,</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7337560">{</span><span class="string" id="7337561">`message/external-body;&nbsp;access-type=URL;&nbsp;`</span>&nbsp;<span class="op" id="7337604">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7337609">`URL*0=&#34;ftp://&#34;;`</span>&nbsp;<span class="op" id="7337627">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7337632">`URL*1=&#34;cs.utk.edu/pub/moore/bulk-mailer/bulk-mailer.tar&#34;`</span><span class="op" id="7337690">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7337695">&#34;message/external-body&#34;</span><span class="op" id="7337718">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7337723">m</span><span class="op" id="7337724">(</span><span class="string" id="7337725">&#34;access-type&#34;</span><span class="op" id="7337738">,</span>&nbsp;<span class="string" id="7337740">&#34;URL&#34;</span><span class="op" id="7337745">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7337751">&#34;url&#34;</span><span class="op" id="7337756">,</span>&nbsp;<span class="string" id="7337758">&#34;ftp://cs.utk.edu/pub/moore/bulk-mailer/bulk-mailer.tar&#34;</span><span class="op" id="7337814">)</span><span class="op" id="7337815">}</span><span class="op" id="7337816">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7337821">{</span><span class="string" id="7337822">`application/x-stuff;&nbsp;`</span>&nbsp;<span class="op" id="7337846">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7337851">`title*0*=us-ascii&#39;en&#39;This%20is%20even%20more%20;&nbsp;`</span>&nbsp;<span class="op" id="7337903">+</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7337908">`title*1*=%2A%2A%2Afun%2A%2A%2A%20;&nbsp;`</span>&nbsp;<span class="op" id="7337946">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7337951">`title*2=&#34;isn&#39;t&nbsp;it!&#34;`</span><span class="op" id="7337972">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7337977">&#34;application/x-stuff&#34;</span><span class="op" id="7337998">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7338003">m</span><span class="op" id="7338004">(</span><span class="string" id="7338005">&#34;title&#34;</span><span class="op" id="7338012">,</span>&nbsp;<span class="string" id="7338014">&#34;This&nbsp;is&nbsp;even&nbsp;more&nbsp;***fun***&nbsp;isn&#39;t&nbsp;it!&#34;</span><span class="op" id="7338053">)</span><span class="op" id="7338054">}</span><span class="op" id="7338055">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7338060">//&nbsp;Tests&nbsp;from&nbsp;http://greenbytes.de/tech/tc2231/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7338110">//&nbsp;TODO(bradfitz):&nbsp;add&nbsp;the&nbsp;rest&nbsp;of&nbsp;the&nbsp;tests&nbsp;from&nbsp;that&nbsp;site.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7338173">{</span><span class="string" id="7338174">`attachment;&nbsp;filename=&#34;f\oo.html&#34;`</span><span class="op" id="7338208">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7338213">&#34;attachment&#34;</span><span class="op" id="7338225">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7338230">m</span><span class="op" id="7338231">(</span><span class="string" id="7338232">&#34;filename&#34;</span><span class="op" id="7338242">,</span>&nbsp;<span class="string" id="7338244">&#34;foo.html&#34;</span><span class="op" id="7338254">)</span><span class="op" id="7338255">}</span><span class="op" id="7338256">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7338260">{</span><span class="string" id="7338261">`attachment;&nbsp;filename=&#34;\&#34;quoting\&#34;&nbsp;tested.html&#34;`</span><span class="op" id="7338309">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7338314">&#34;attachment&#34;</span><span class="op" id="7338326">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7338331">m</span><span class="op" id="7338332">(</span><span class="string" id="7338333">&#34;filename&#34;</span><span class="op" id="7338343">,</span>&nbsp;<span class="string" id="7338345">`&#34;quoting&#34;&nbsp;tested.html`</span><span class="op" id="7338368">)</span><span class="op" id="7338369">}</span><span class="op" id="7338370">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7338374">{</span><span class="string" id="7338375">`attachment;&nbsp;filename=&#34;Here&#39;s&nbsp;a&nbsp;semicolon;.html&#34;`</span><span class="op" id="7338424">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7338429">&#34;attachment&#34;</span><span class="op" id="7338441">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7338446">m</span><span class="op" id="7338447">(</span><span class="string" id="7338448">&#34;filename&#34;</span><span class="op" id="7338458">,</span>&nbsp;<span class="string" id="7338460">&#34;Here&#39;s&nbsp;a&nbsp;semicolon;.html&#34;</span><span class="op" id="7338486">)</span><span class="op" id="7338487">}</span><span class="op" id="7338488">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7338492">{</span><span class="string" id="7338493">`attachment;&nbsp;foo=&#34;\&#34;\\&#34;;filename=&#34;foo.html&#34;`</span><span class="op" id="7338537">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7338542">&#34;attachment&#34;</span><span class="op" id="7338554">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7338559">m</span><span class="op" id="7338560">(</span><span class="string" id="7338561">&#34;foo&#34;</span><span class="op" id="7338566">,</span>&nbsp;<span class="string" id="7338568">&#34;\&#34;\\&#34;</span><span class="op" id="7338574">,</span>&nbsp;<span class="string" id="7338576">&#34;filename&#34;</span><span class="op" id="7338586">,</span>&nbsp;<span class="string" id="7338588">&#34;foo.html&#34;</span><span class="op" id="7338598">)</span><span class="op" id="7338599">}</span><span class="op" id="7338600">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7338604">{</span><span class="string" id="7338605">`attachment;&nbsp;filename=foo.html`</span><span class="op" id="7338636">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7338641">&#34;attachment&#34;</span><span class="op" id="7338653">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7338658">m</span><span class="op" id="7338659">(</span><span class="string" id="7338660">&#34;filename&#34;</span><span class="op" id="7338670">,</span>&nbsp;<span class="string" id="7338672">&#34;foo.html&#34;</span><span class="op" id="7338682">)</span><span class="op" id="7338683">}</span><span class="op" id="7338684">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7338688">{</span><span class="string" id="7338689">`attachment;&nbsp;filename=foo.html&nbsp;;`</span><span class="op" id="7338722">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7338727">&#34;attachment&#34;</span><span class="op" id="7338739">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7338744">m</span><span class="op" id="7338745">(</span><span class="string" id="7338746">&#34;filename&#34;</span><span class="op" id="7338756">,</span>&nbsp;<span class="string" id="7338758">&#34;foo.html&#34;</span><span class="op" id="7338768">)</span><span class="op" id="7338769">}</span><span class="op" id="7338770">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7338774">{</span><span class="string" id="7338775">`attachment;&nbsp;filename=&#39;foo.html&#39;`</span><span class="op" id="7338808">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7338813">&#34;attachment&#34;</span><span class="op" id="7338825">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7338830">m</span><span class="op" id="7338831">(</span><span class="string" id="7338832">&#34;filename&#34;</span><span class="op" id="7338842">,</span>&nbsp;<span class="string" id="7338844">&#34;foo.html&#34;</span><span class="op" id="7338854">)</span><span class="op" id="7338855">}</span><span class="op" id="7338856">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7338860">{</span><span class="string" id="7338861">`attachment;&nbsp;filename=&#34;foo-%41.html&#34;`</span><span class="op" id="7338898">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7338903">&#34;attachment&#34;</span><span class="op" id="7338915">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7338920">m</span><span class="op" id="7338921">(</span><span class="string" id="7338922">&#34;filename&#34;</span><span class="op" id="7338932">,</span>&nbsp;<span class="string" id="7338934">&#34;foo-%41.html&#34;</span><span class="op" id="7338948">)</span><span class="op" id="7338949">}</span><span class="op" id="7338950">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7338954">{</span><span class="string" id="7338955">`attachment;&nbsp;filename=&#34;foo-%\41.html&#34;`</span><span class="op" id="7338993">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7338998">&#34;attachment&#34;</span><span class="op" id="7339010">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7339015">m</span><span class="op" id="7339016">(</span><span class="string" id="7339017">&#34;filename&#34;</span><span class="op" id="7339027">,</span>&nbsp;<span class="string" id="7339029">&#34;foo-%41.html&#34;</span><span class="op" id="7339043">)</span><span class="op" id="7339044">}</span><span class="op" id="7339045">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7339049">{</span><span class="string" id="7339050">`filename=foo.html`</span><span class="op" id="7339069">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7339074">&#34;&#34;</span><span class="op" id="7339076">,</span>&nbsp;<span class="ident" id="7339078">m</span><span class="op" id="7339079">(</span><span class="op" id="7339080">)</span><span class="op" id="7339081">}</span><span class="op" id="7339082">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7339086">{</span><span class="string" id="7339087">`x=y;&nbsp;filename=foo.html`</span><span class="op" id="7339111">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7339116">&#34;&#34;</span><span class="op" id="7339118">,</span>&nbsp;<span class="ident" id="7339120">m</span><span class="op" id="7339121">(</span><span class="op" id="7339122">)</span><span class="op" id="7339123">}</span><span class="op" id="7339124">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7339128">{</span><span class="string" id="7339129">`&#34;foo;&nbsp;filename=bar;baz&#34;;&nbsp;filename=qux`</span><span class="op" id="7339168">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7339173">&#34;&#34;</span><span class="op" id="7339175">,</span>&nbsp;<span class="ident" id="7339177">m</span><span class="op" id="7339178">(</span><span class="op" id="7339179">)</span><span class="op" id="7339180">}</span><span class="op" id="7339181">,</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7339185">{</span><span class="string" id="7339186">`inline;&nbsp;attachment;&nbsp;filename=foo.html`</span><span class="op" id="7339225">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7339230">&#34;&#34;</span><span class="op" id="7339232">,</span>&nbsp;<span class="ident" id="7339234">m</span><span class="op" id="7339235">(</span><span class="op" id="7339236">)</span><span class="op" id="7339237">}</span><span class="op" id="7339238">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7339242">{</span><span class="string" id="7339243">`attachment;&nbsp;filename=&#34;foo.html&#34;.txt`</span><span class="op" id="7339280">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7339285">&#34;&#34;</span><span class="op" id="7339287">,</span>&nbsp;<span class="ident" id="7339289">m</span><span class="op" id="7339290">(</span><span class="op" id="7339291">)</span><span class="op" id="7339292">}</span><span class="op" id="7339293">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7339297">{</span><span class="string" id="7339298">`attachment;&nbsp;filename=&#34;bar`</span><span class="op" id="7339325">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7339330">&#34;&#34;</span><span class="op" id="7339332">,</span>&nbsp;<span class="ident" id="7339334">m</span><span class="op" id="7339335">(</span><span class="op" id="7339336">)</span><span class="op" id="7339337">}</span><span class="op" id="7339338">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7339342">{</span><span class="string" id="7339343">`attachment;&nbsp;creation-date=&#34;Wed,&nbsp;12&nbsp;Feb&nbsp;1997&nbsp;16:29:51&nbsp;-0500&#34;`</span><span class="op" id="7339404">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7339409">&#34;attachment&#34;</span><span class="op" id="7339421">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7339426">m</span><span class="op" id="7339427">(</span><span class="string" id="7339428">&#34;creation-date&#34;</span><span class="op" id="7339443">,</span>&nbsp;<span class="string" id="7339445">&#34;Wed,&nbsp;12&nbsp;Feb&nbsp;1997&nbsp;16:29:51&nbsp;-0500&#34;</span><span class="op" id="7339478">)</span><span class="op" id="7339479">}</span><span class="op" id="7339480">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7339484">{</span><span class="string" id="7339485">`foobar`</span><span class="op" id="7339493">,</span>&nbsp;<span class="string" id="7339495">&#34;foobar&#34;</span><span class="op" id="7339503">,</span>&nbsp;<span class="ident" id="7339505">m</span><span class="op" id="7339506">(</span><span class="op" id="7339507">)</span><span class="op" id="7339508">}</span><span class="op" id="7339509">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7339513">{</span><span class="string" id="7339514">`attachment;&nbsp;filename*&nbsp;=UTF-8&#39;&#39;foo-%c3%a4.html`</span><span class="op" id="7339561">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7339566">&#34;attachment&#34;</span><span class="op" id="7339578">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7339583">m</span><span class="op" id="7339584">(</span><span class="string" id="7339585">&#34;filename&#34;</span><span class="op" id="7339595">,</span>&nbsp;<span class="string" id="7339597">&#34;foo-.html&#34;</span><span class="op" id="7339610">)</span><span class="op" id="7339611">}</span><span class="op" id="7339612">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7339616">{</span><span class="string" id="7339617">`attachment;&nbsp;filename*=UTF-8&#39;&#39;A-%2541.html`</span><span class="op" id="7339660">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7339665">&#34;attachment&#34;</span><span class="op" id="7339677">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7339682">m</span><span class="op" id="7339683">(</span><span class="string" id="7339684">&#34;filename&#34;</span><span class="op" id="7339694">,</span>&nbsp;<span class="string" id="7339696">&#34;A-%41.html&#34;</span><span class="op" id="7339708">)</span><span class="op" id="7339709">}</span><span class="op" id="7339710">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7339714">{</span><span class="string" id="7339715">`attachment;&nbsp;filename*0=&#34;foo.&#34;;&nbsp;filename*1=&#34;html&#34;`</span><span class="op" id="7339765">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7339770">&#34;attachment&#34;</span><span class="op" id="7339782">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7339787">m</span><span class="op" id="7339788">(</span><span class="string" id="7339789">&#34;filename&#34;</span><span class="op" id="7339799">,</span>&nbsp;<span class="string" id="7339801">&#34;foo.html&#34;</span><span class="op" id="7339811">)</span><span class="op" id="7339812">}</span><span class="op" id="7339813">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7339817">{</span><span class="string" id="7339818">`attachment;&nbsp;filename*0*=UTF-8&#39;&#39;foo-%c3%a4;&nbsp;filename*1=&#34;.html&#34;`</span><span class="op" id="7339881">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7339886">&#34;attachment&#34;</span><span class="op" id="7339898">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7339903">m</span><span class="op" id="7339904">(</span><span class="string" id="7339905">&#34;filename&#34;</span><span class="op" id="7339915">,</span>&nbsp;<span class="string" id="7339917">&#34;foo-.html&#34;</span><span class="op" id="7339930">)</span><span class="op" id="7339931">}</span><span class="op" id="7339932">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7339936">{</span><span class="string" id="7339937">`attachment;&nbsp;filename*0=&#34;foo&#34;;&nbsp;filename*01=&#34;bar&#34;`</span><span class="op" id="7339986">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7339991">&#34;attachment&#34;</span><span class="op" id="7340003">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7340008">m</span><span class="op" id="7340009">(</span><span class="string" id="7340010">&#34;filename&#34;</span><span class="op" id="7340020">,</span>&nbsp;<span class="string" id="7340022">&#34;foo&#34;</span><span class="op" id="7340027">)</span><span class="op" id="7340028">}</span><span class="op" id="7340029">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7340033">{</span><span class="string" id="7340034">`attachment;&nbsp;filename*0=&#34;foo&#34;;&nbsp;filename*2=&#34;bar&#34;`</span><span class="op" id="7340082">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7340087">&#34;attachment&#34;</span><span class="op" id="7340099">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7340104">m</span><span class="op" id="7340105">(</span><span class="string" id="7340106">&#34;filename&#34;</span><span class="op" id="7340116">,</span>&nbsp;<span class="string" id="7340118">&#34;foo&#34;</span><span class="op" id="7340123">)</span><span class="op" id="7340124">}</span><span class="op" id="7340125">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7340129">{</span><span class="string" id="7340130">`attachment;&nbsp;filename*1=&#34;foo&#34;;&nbsp;filename*2=&#34;bar&#34;`</span><span class="op" id="7340178">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7340183">&#34;attachment&#34;</span><span class="op" id="7340195">,</span>&nbsp;<span class="ident" id="7340197">m</span><span class="op" id="7340198">(</span><span class="op" id="7340199">)</span><span class="op" id="7340200">}</span><span class="op" id="7340201">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7340205">{</span><span class="string" id="7340206">`attachment;&nbsp;filename*1=&#34;bar&#34;;&nbsp;filename*0=&#34;foo&#34;`</span><span class="op" id="7340254">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7340259">&#34;attachment&#34;</span><span class="op" id="7340271">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7340276">m</span><span class="op" id="7340277">(</span><span class="string" id="7340278">&#34;filename&#34;</span><span class="op" id="7340288">,</span>&nbsp;<span class="string" id="7340290">&#34;foobar&#34;</span><span class="op" id="7340298">)</span><span class="op" id="7340299">}</span><span class="op" id="7340300">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7340304">{</span><span class="string" id="7340305">`attachment;&nbsp;filename=&#34;foo-ae.html&#34;;&nbsp;filename*=UTF-8&#39;&#39;foo-%c3%a4.html`</span><span class="op" id="7340375">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7340380">&#34;attachment&#34;</span><span class="op" id="7340392">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7340397">m</span><span class="op" id="7340398">(</span><span class="string" id="7340399">&#34;filename&#34;</span><span class="op" id="7340409">,</span>&nbsp;<span class="string" id="7340411">&#34;foo-.html&#34;</span><span class="op" id="7340424">)</span><span class="op" id="7340425">}</span><span class="op" id="7340426">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7340430">{</span><span class="string" id="7340431">`attachment;&nbsp;filename*=UTF-8&#39;&#39;foo-%c3%a4.html;&nbsp;filename=&#34;foo-ae.html&#34;`</span><span class="op" id="7340501">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7340506">&#34;attachment&#34;</span><span class="op" id="7340518">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7340523">m</span><span class="op" id="7340524">(</span><span class="string" id="7340525">&#34;filename&#34;</span><span class="op" id="7340535">,</span>&nbsp;<span class="string" id="7340537">&#34;foo-.html&#34;</span><span class="op" id="7340550">)</span><span class="op" id="7340551">}</span><span class="op" id="7340552">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7340557">//&nbsp;Browsers&nbsp;also&nbsp;just&nbsp;send&nbsp;UTF-8&nbsp;directly&nbsp;without&nbsp;RFC&nbsp;2231,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7340619">//&nbsp;at&nbsp;least&nbsp;when&nbsp;the&nbsp;source&nbsp;page&nbsp;is&nbsp;served&nbsp;with&nbsp;UTF-8.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7340676">{</span><span class="string" id="7340677">`form-data;&nbsp;firstname=&#34;&#34;;&nbsp;lastname=&#34;&#34;`</span><span class="op" id="7340741">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7340746">&#34;form-data&#34;</span><span class="op" id="7340757">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7340762">m</span><span class="op" id="7340763">(</span><span class="string" id="7340764">&#34;firstname&#34;</span><span class="op" id="7340775">,</span>&nbsp;<span class="string" id="7340777">&#34;&#34;</span><span class="op" id="7340787">,</span>&nbsp;<span class="string" id="7340789">&#34;lastname&#34;</span><span class="op" id="7340799">,</span>&nbsp;<span class="string" id="7340801">&#34;&#34;</span><span class="op" id="7340821">)</span><span class="op" id="7340822">}</span><span class="op" id="7340823">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7340826">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7340829">for</span>&nbsp;<span class="ident" id="7340833">_</span><span class="op" id="7340834">,</span>&nbsp;<span class="ident" id="7340836">test</span>&nbsp;<span class="op" id="7340841">:=</span>&nbsp;<span class="keyword" id="7340844">range</span>&nbsp;<span class="ident" id="7340850">tests</span>&nbsp;<span class="op" id="7340856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7340860">mt</span><span class="op" id="7340862">,</span>&nbsp;<span class="ident" id="7340864">params</span><span class="op" id="7340870">,</span>&nbsp;<span class="ident" id="7340872">err</span>&nbsp;<span class="op" id="7340876">:=</span>&nbsp;<span class="ident" id="7340879">ParseMediaType</span><span class="op" id="7340893">(</span><span class="ident" id="7340894">test</span><span class="op" id="7340898">.</span><span class="ident" id="7340899">in</span><span class="op" id="7340901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7340905">if</span>&nbsp;<span class="ident" id="7340908">err</span>&nbsp;<span class="op" id="7340912">!=</span>&nbsp;<span class="builtintype" id="7340915">nil</span>&nbsp;<span class="op" id="7340919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7340924">if</span>&nbsp;<span class="ident" id="7340927">test</span><span class="op" id="7340931">.</span><span class="ident" id="7340932">t</span>&nbsp;<span class="op" id="7340934">!=</span>&nbsp;<span class="string" id="7340937">&#34;&#34;</span>&nbsp;<span class="op" id="7340940">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7340946">t</span><span class="op" id="7340947">.</span><span class="ident" id="7340948">Errorf</span><span class="op" id="7340954">(</span><span class="string" id="7340955">&#34;for&nbsp;input&nbsp;%q,&nbsp;unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="7340991">,</span>&nbsp;<span class="ident" id="7340993">test</span><span class="op" id="7340997">.</span><span class="ident" id="7340998">in</span><span class="op" id="7341000">,</span>&nbsp;<span class="ident" id="7341002">err</span><span class="op" id="7341005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7341011">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7341023">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7341028">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7341039">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7341043">if</span>&nbsp;<span class="ident" id="7341046">g</span><span class="op" id="7341047">,</span>&nbsp;<span class="ident" id="7341049">e</span>&nbsp;<span class="op" id="7341051">:=</span>&nbsp;<span class="ident" id="7341054">mt</span><span class="op" id="7341056">,</span>&nbsp;<span class="ident" id="7341058">test</span><span class="op" id="7341062">.</span><span class="ident" id="7341063">t</span><span class="op" id="7341064">;</span>&nbsp;<span class="ident" id="7341066">g</span>&nbsp;<span class="op" id="7341068">!=</span>&nbsp;<span class="ident" id="7341071">e</span>&nbsp;<span class="op" id="7341073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7341078">t</span><span class="op" id="7341079">.</span><span class="ident" id="7341080">Errorf</span><span class="op" id="7341086">(</span><span class="string" id="7341087">&#34;for&nbsp;input&nbsp;%q,&nbsp;expected&nbsp;type&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7341127">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7341133">test</span><span class="op" id="7341137">.</span><span class="ident" id="7341138">in</span><span class="op" id="7341140">,</span>&nbsp;<span class="ident" id="7341142">e</span><span class="op" id="7341143">,</span>&nbsp;<span class="ident" id="7341145">g</span><span class="op" id="7341146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7341151">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7341162">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7341166">if</span>&nbsp;<span class="builtinfunc" id="7341169">len</span><span class="op" id="7341172">(</span><span class="ident" id="7341173">params</span><span class="op" id="7341179">)</span>&nbsp;<span class="op" id="7341181">==</span>&nbsp;<span class="num" id="7341184">0</span>&nbsp;<span class="op" id="7341186">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="7341189">len</span><span class="op" id="7341192">(</span><span class="ident" id="7341193">test</span><span class="op" id="7341197">.</span><span class="ident" id="7341198">p</span><span class="op" id="7341199">)</span>&nbsp;<span class="op" id="7341201">==</span>&nbsp;<span class="num" id="7341204">0</span>&nbsp;<span class="op" id="7341206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7341211">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7341222">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7341226">if</span>&nbsp;<span class="op" id="7341229">!</span><span class="ident" id="7341230">reflect</span><span class="op" id="7341237">.</span><span class="ident" id="7341238">DeepEqual</span><span class="op" id="7341247">(</span><span class="ident" id="7341248">params</span><span class="op" id="7341254">,</span>&nbsp;<span class="ident" id="7341256">test</span><span class="op" id="7341260">.</span><span class="ident" id="7341261">p</span><span class="op" id="7341262">)</span>&nbsp;<span class="op" id="7341264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7341269">t</span><span class="op" id="7341270">.</span><span class="ident" id="7341271">Errorf</span><span class="op" id="7341277">(</span><span class="string" id="7341278">&#34;for&nbsp;input&nbsp;%q,&nbsp;wrong&nbsp;params.\n&#34;</span><span class="op" id="7341309">+</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7341315">&#34;expected:&nbsp;%#v\n&#34;</span><span class="op" id="7341332">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7341338">&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;got:&nbsp;%#v&#34;</span><span class="op" id="7341353">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7341359">test</span><span class="op" id="7341363">.</span><span class="ident" id="7341364">in</span><span class="op" id="7341366">,</span>&nbsp;<span class="ident" id="7341368">test</span><span class="op" id="7341372">.</span><span class="ident" id="7341373">p</span><span class="op" id="7341374">,</span>&nbsp;<span class="ident" id="7341376">params</span><span class="op" id="7341382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7341386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7341389">}</span><br>
<span class="lineno">245</span><span class="op" id="7341391">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7341394">type</span>&nbsp;<span class="ident" id="7341399">badMediaTypeTest</span>&nbsp;<span class="keyword" id="7341416">struct</span>&nbsp;<span class="op" id="7341423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7341426">in</span>&nbsp;&nbsp;<span class="builtintype" id="7341430">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7341438">err</span>&nbsp;<span class="builtintype" id="7341442">string</span><br>
<span class="lineno">250</span><span class="op" id="7341449">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7341452">var</span>&nbsp;<span class="ident" id="7341456">badMediaTypeTests</span>&nbsp;<span class="op" id="7341474">=</span>&nbsp;<span class="op" id="7341476">[</span><span class="op" id="7341477">]</span><span class="ident" id="7341478">badMediaTypeTest</span><span class="op" id="7341494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7341497">{</span><span class="string" id="7341498">&#34;bogus&nbsp;;=========&#34;</span><span class="op" id="7341516">,</span>&nbsp;<span class="string" id="7341518">&#34;mime:&nbsp;invalid&nbsp;media&nbsp;parameter&#34;</span><span class="op" id="7341549">}</span><span class="op" id="7341550">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7341553">{</span><span class="string" id="7341554">&#34;bogus/&lt;script&gt;alert&lt;/script&gt;&#34;</span><span class="op" id="7341584">,</span>&nbsp;<span class="string" id="7341586">&#34;mime:&nbsp;expected&nbsp;token&nbsp;after&nbsp;slash&#34;</span><span class="op" id="7341620">}</span><span class="op" id="7341621">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7341624">{</span><span class="string" id="7341625">&#34;bogus/bogus&lt;script&gt;alert&lt;/script&gt;&#34;</span><span class="op" id="7341660">,</span>&nbsp;<span class="string" id="7341662">&#34;mime:&nbsp;unexpected&nbsp;content&nbsp;after&nbsp;media&nbsp;subtype&#34;</span><span class="op" id="7341708">}</span><span class="op" id="7341709">,</span><br>
<span class="lineno"></span><span class="op" id="7341711">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7341714">func</span>&nbsp;<span class="ident" id="7341719">TestParseMediaTypeBogus</span><span class="op" id="7341742">(</span><span class="ident" id="7341743">t</span>&nbsp;<span class="op" id="7341745">*</span><span class="ident" id="7341746">testing</span><span class="op" id="7341753">.</span><span class="ident" id="7341754">T</span><span class="op" id="7341755">)</span>&nbsp;<span class="op" id="7341757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7341760">for</span>&nbsp;<span class="ident" id="7341764">_</span><span class="op" id="7341765">,</span>&nbsp;<span class="ident" id="7341767">tt</span>&nbsp;<span class="op" id="7341770">:=</span>&nbsp;<span class="keyword" id="7341773">range</span>&nbsp;<span class="ident" id="7341779">badMediaTypeTests</span>&nbsp;<span class="op" id="7341797">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7341801">mt</span><span class="op" id="7341803">,</span>&nbsp;<span class="ident" id="7341805">params</span><span class="op" id="7341811">,</span>&nbsp;<span class="ident" id="7341813">err</span>&nbsp;<span class="op" id="7341817">:=</span>&nbsp;<span class="ident" id="7341820">ParseMediaType</span><span class="op" id="7341834">(</span><span class="ident" id="7341835">tt</span><span class="op" id="7341837">.</span><span class="ident" id="7341838">in</span><span class="op" id="7341840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7341844">if</span>&nbsp;<span class="ident" id="7341847">err</span>&nbsp;<span class="op" id="7341851">==</span>&nbsp;<span class="builtintype" id="7341854">nil</span>&nbsp;<span class="op" id="7341858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7341863">t</span><span class="op" id="7341864">.</span><span class="ident" id="7341865">Errorf</span><span class="op" id="7341871">(</span><span class="string" id="7341872">&#34;ParseMediaType(%q)&nbsp;=&nbsp;nil&nbsp;error;&nbsp;want&nbsp;parse&nbsp;error&#34;</span><span class="op" id="7341922">,</span>&nbsp;<span class="ident" id="7341924">tt</span><span class="op" id="7341926">.</span><span class="ident" id="7341927">in</span><span class="op" id="7341929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7341934">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7341945">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7341949">if</span>&nbsp;<span class="ident" id="7341952">err</span><span class="op" id="7341955">.</span><span class="ident" id="7341956">Error</span><span class="op" id="7341961">(</span><span class="op" id="7341962">)</span>&nbsp;<span class="op" id="7341964">!=</span>&nbsp;<span class="ident" id="7341967">tt</span><span class="op" id="7341969">.</span><span class="ident" id="7341970">err</span>&nbsp;<span class="op" id="7341974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7341979">t</span><span class="op" id="7341980">.</span><span class="ident" id="7341981">Errorf</span><span class="op" id="7341987">(</span><span class="string" id="7341988">&#34;ParseMediaType(%q)&nbsp;=&nbsp;err&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7342026">,</span>&nbsp;<span class="ident" id="7342028">tt</span><span class="op" id="7342030">.</span><span class="ident" id="7342031">in</span><span class="op" id="7342033">,</span>&nbsp;<span class="ident" id="7342035">err</span><span class="op" id="7342038">.</span><span class="ident" id="7342039">Error</span><span class="op" id="7342044">(</span><span class="op" id="7342045">)</span><span class="op" id="7342046">,</span>&nbsp;<span class="ident" id="7342048">tt</span><span class="op" id="7342050">.</span><span class="ident" id="7342051">err</span><span class="op" id="7342054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7342058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7342062">if</span>&nbsp;<span class="ident" id="7342065">params</span>&nbsp;<span class="op" id="7342072">!=</span>&nbsp;<span class="builtintype" id="7342075">nil</span>&nbsp;<span class="op" id="7342079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7342084">t</span><span class="op" id="7342085">.</span><span class="ident" id="7342086">Errorf</span><span class="op" id="7342092">(</span><span class="string" id="7342093">&#34;ParseMediaType(%q):&nbsp;got&nbsp;non-nil&nbsp;params&nbsp;on&nbsp;error&#34;</span><span class="op" id="7342142">,</span>&nbsp;<span class="ident" id="7342144">tt</span><span class="op" id="7342146">.</span><span class="ident" id="7342147">in</span><span class="op" id="7342149">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7342153">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7342157">if</span>&nbsp;<span class="ident" id="7342160">mt</span>&nbsp;<span class="op" id="7342163">!=</span>&nbsp;<span class="string" id="7342166">&#34;&#34;</span>&nbsp;<span class="op" id="7342169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7342174">t</span><span class="op" id="7342175">.</span><span class="ident" id="7342176">Errorf</span><span class="op" id="7342182">(</span><span class="string" id="7342183">&#34;ParseMediaType(%q):&nbsp;got&nbsp;non-empty&nbsp;media&nbsp;type&nbsp;string&nbsp;on&nbsp;error&#34;</span><span class="op" id="7342245">,</span>&nbsp;<span class="ident" id="7342247">tt</span><span class="op" id="7342249">.</span><span class="ident" id="7342250">in</span><span class="op" id="7342252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7342256">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7342259">}</span><br>
<span class="lineno">275</span><span class="op" id="7342261">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7342264">type</span>&nbsp;<span class="ident" id="7342269">formatTest</span>&nbsp;<span class="keyword" id="7342280">struct</span>&nbsp;<span class="op" id="7342287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7342290">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7342297">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7342305">params</span>&nbsp;<span class="keyword" id="7342312">map</span><span class="op" id="7342315">[</span><span class="builtintype" id="7342316">string</span><span class="op" id="7342322">]</span><span class="builtintype" id="7342323">string</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7342331">want</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7342338">string</span><br>
<span class="lineno"></span><span class="op" id="7342345">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7342348">var</span>&nbsp;<span class="ident" id="7342352">formatTests</span>&nbsp;<span class="op" id="7342364">=</span>&nbsp;<span class="op" id="7342366">[</span><span class="op" id="7342367">]</span><span class="ident" id="7342368">formatTest</span><span class="op" id="7342378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7342381">{</span><span class="string" id="7342382">&#34;noslash&#34;</span><span class="op" id="7342391">,</span>&nbsp;<span class="builtintype" id="7342393">nil</span><span class="op" id="7342396">,</span>&nbsp;<span class="string" id="7342398">&#34;&#34;</span><span class="op" id="7342400">}</span><span class="op" id="7342401">,</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7342404">{</span><span class="string" id="7342405">&#34;foo&nbsp;bar/baz&#34;</span><span class="op" id="7342418">,</span>&nbsp;<span class="builtintype" id="7342420">nil</span><span class="op" id="7342423">,</span>&nbsp;<span class="string" id="7342425">&#34;&#34;</span><span class="op" id="7342427">}</span><span class="op" id="7342428">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7342431">{</span><span class="string" id="7342432">&#34;foo/bar&nbsp;baz&#34;</span><span class="op" id="7342445">,</span>&nbsp;<span class="builtintype" id="7342447">nil</span><span class="op" id="7342450">,</span>&nbsp;<span class="string" id="7342452">&#34;&#34;</span><span class="op" id="7342454">}</span><span class="op" id="7342455">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7342458">{</span><span class="string" id="7342459">&#34;foo/BAR&#34;</span><span class="op" id="7342468">,</span>&nbsp;<span class="builtintype" id="7342470">nil</span><span class="op" id="7342473">,</span>&nbsp;<span class="string" id="7342475">&#34;foo/bar&#34;</span><span class="op" id="7342484">}</span><span class="op" id="7342485">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7342488">{</span><span class="string" id="7342489">&#34;foo/BAR&#34;</span><span class="op" id="7342498">,</span>&nbsp;<span class="keyword" id="7342500">map</span><span class="op" id="7342503">[</span><span class="builtintype" id="7342504">string</span><span class="op" id="7342510">]</span><span class="builtintype" id="7342511">string</span><span class="op" id="7342517">{</span><span class="string" id="7342518">&#34;X&#34;</span><span class="op" id="7342521">:</span>&nbsp;<span class="string" id="7342523">&#34;Y&#34;</span><span class="op" id="7342526">}</span><span class="op" id="7342527">,</span>&nbsp;<span class="string" id="7342529">&#34;foo/bar;&nbsp;x=Y&#34;</span><span class="op" id="7342543">}</span><span class="op" id="7342544">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7342547">{</span><span class="string" id="7342548">&#34;foo/BAR&#34;</span><span class="op" id="7342557">,</span>&nbsp;<span class="keyword" id="7342559">map</span><span class="op" id="7342562">[</span><span class="builtintype" id="7342563">string</span><span class="op" id="7342569">]</span><span class="builtintype" id="7342570">string</span><span class="op" id="7342576">{</span><span class="string" id="7342577">&#34;space&#34;</span><span class="op" id="7342584">:</span>&nbsp;<span class="string" id="7342586">&#34;With&nbsp;space&#34;</span><span class="op" id="7342598">}</span><span class="op" id="7342599">,</span>&nbsp;<span class="string" id="7342601">`foo/bar;&nbsp;space=&#34;With&nbsp;space&#34;`</span><span class="op" id="7342630">}</span><span class="op" id="7342631">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7342634">{</span><span class="string" id="7342635">&#34;foo/BAR&#34;</span><span class="op" id="7342644">,</span>&nbsp;<span class="keyword" id="7342646">map</span><span class="op" id="7342649">[</span><span class="builtintype" id="7342650">string</span><span class="op" id="7342656">]</span><span class="builtintype" id="7342657">string</span><span class="op" id="7342663">{</span><span class="string" id="7342664">&#34;quote&#34;</span><span class="op" id="7342671">:</span>&nbsp;<span class="string" id="7342673">`With&nbsp;&#34;quote`</span><span class="op" id="7342686">}</span><span class="op" id="7342687">,</span>&nbsp;<span class="string" id="7342689">`foo/bar;&nbsp;quote=&#34;With&nbsp;\&#34;quote&#34;`</span><span class="op" id="7342720">}</span><span class="op" id="7342721">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7342724">{</span><span class="string" id="7342725">&#34;foo/BAR&#34;</span><span class="op" id="7342734">,</span>&nbsp;<span class="keyword" id="7342736">map</span><span class="op" id="7342739">[</span><span class="builtintype" id="7342740">string</span><span class="op" id="7342746">]</span><span class="builtintype" id="7342747">string</span><span class="op" id="7342753">{</span><span class="string" id="7342754">&#34;bslash&#34;</span><span class="op" id="7342762">:</span>&nbsp;<span class="string" id="7342764">`With&nbsp;\backslash`</span><span class="op" id="7342781">}</span><span class="op" id="7342782">,</span>&nbsp;<span class="string" id="7342784">`foo/bar;&nbsp;bslash=&#34;With&nbsp;\\backslash&#34;`</span><span class="op" id="7342820">}</span><span class="op" id="7342821">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7342824">{</span><span class="string" id="7342825">&#34;foo/BAR&#34;</span><span class="op" id="7342834">,</span>&nbsp;<span class="keyword" id="7342836">map</span><span class="op" id="7342839">[</span><span class="builtintype" id="7342840">string</span><span class="op" id="7342846">]</span><span class="builtintype" id="7342847">string</span><span class="op" id="7342853">{</span><span class="string" id="7342854">&#34;both&#34;</span><span class="op" id="7342860">:</span>&nbsp;<span class="string" id="7342862">`With&nbsp;\backslash&nbsp;and&nbsp;&#34;quote`</span><span class="op" id="7342890">}</span><span class="op" id="7342891">,</span>&nbsp;<span class="string" id="7342893">`foo/bar;&nbsp;both=&#34;With&nbsp;\\backslash&nbsp;and&nbsp;\&#34;quote&#34;`</span><span class="op" id="7342939">}</span><span class="op" id="7342940">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7342943">{</span><span class="string" id="7342944">&#34;foo/BAR&#34;</span><span class="op" id="7342953">,</span>&nbsp;<span class="keyword" id="7342955">map</span><span class="op" id="7342958">[</span><span class="builtintype" id="7342959">string</span><span class="op" id="7342965">]</span><span class="builtintype" id="7342966">string</span><span class="op" id="7342972">{</span><span class="string" id="7342973">&#34;&#34;</span><span class="op" id="7342975">:</span>&nbsp;<span class="string" id="7342977">&#34;empty&nbsp;attribute&#34;</span><span class="op" id="7342994">}</span><span class="op" id="7342995">,</span>&nbsp;<span class="string" id="7342997">&#34;&#34;</span><span class="op" id="7342999">}</span><span class="op" id="7343000">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7343003">{</span><span class="string" id="7343004">&#34;foo/BAR&#34;</span><span class="op" id="7343013">,</span>&nbsp;<span class="keyword" id="7343015">map</span><span class="op" id="7343018">[</span><span class="builtintype" id="7343019">string</span><span class="op" id="7343025">]</span><span class="builtintype" id="7343026">string</span><span class="op" id="7343032">{</span><span class="string" id="7343033">&#34;bad&nbsp;attribute&#34;</span><span class="op" id="7343048">:</span>&nbsp;<span class="string" id="7343050">&#34;baz&#34;</span><span class="op" id="7343055">}</span><span class="op" id="7343056">,</span>&nbsp;<span class="string" id="7343058">&#34;&#34;</span><span class="op" id="7343060">}</span><span class="op" id="7343061">,</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7343064">{</span><span class="string" id="7343065">&#34;foo/BAR&#34;</span><span class="op" id="7343074">,</span>&nbsp;<span class="keyword" id="7343076">map</span><span class="op" id="7343079">[</span><span class="builtintype" id="7343080">string</span><span class="op" id="7343086">]</span><span class="builtintype" id="7343087">string</span><span class="op" id="7343093">{</span><span class="string" id="7343094">&#34;nonascii&#34;</span><span class="op" id="7343104">:</span>&nbsp;<span class="string" id="7343106">&#34;not&nbsp;an&nbsp;ascii&nbsp;character:&nbsp;&#34;</span><span class="op" id="7343134">}</span><span class="op" id="7343135">,</span>&nbsp;<span class="string" id="7343137">&#34;&#34;</span><span class="op" id="7343139">}</span><span class="op" id="7343140">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7343143">{</span><span class="string" id="7343144">&#34;foo/bar&#34;</span><span class="op" id="7343153">,</span>&nbsp;<span class="keyword" id="7343155">map</span><span class="op" id="7343158">[</span><span class="builtintype" id="7343159">string</span><span class="op" id="7343165">]</span><span class="builtintype" id="7343166">string</span><span class="op" id="7343172">{</span><span class="string" id="7343173">&#34;a&#34;</span><span class="op" id="7343176">:</span>&nbsp;<span class="string" id="7343178">&#34;av&#34;</span><span class="op" id="7343182">,</span>&nbsp;<span class="string" id="7343184">&#34;b&#34;</span><span class="op" id="7343187">:</span>&nbsp;<span class="string" id="7343189">&#34;bv&#34;</span><span class="op" id="7343193">,</span>&nbsp;<span class="string" id="7343195">&#34;c&#34;</span><span class="op" id="7343198">:</span>&nbsp;<span class="string" id="7343200">&#34;cv&#34;</span><span class="op" id="7343204">}</span><span class="op" id="7343205">,</span>&nbsp;<span class="string" id="7343207">&#34;foo/bar;&nbsp;a=av;&nbsp;b=bv;&nbsp;c=cv&#34;</span><span class="op" id="7343234">}</span><span class="op" id="7343235">,</span><br>
<span class="lineno"></span><span class="op" id="7343237">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7343240">func</span>&nbsp;<span class="ident" id="7343245">TestFormatMediaType</span><span class="op" id="7343264">(</span><span class="ident" id="7343265">t</span>&nbsp;<span class="op" id="7343267">*</span><span class="ident" id="7343268">testing</span><span class="op" id="7343275">.</span><span class="ident" id="7343276">T</span><span class="op" id="7343277">)</span>&nbsp;<span class="op" id="7343279">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7343282">for</span>&nbsp;<span class="ident" id="7343286">i</span><span class="op" id="7343287">,</span>&nbsp;<span class="ident" id="7343289">tt</span>&nbsp;<span class="op" id="7343292">:=</span>&nbsp;<span class="keyword" id="7343295">range</span>&nbsp;<span class="ident" id="7343301">formatTests</span>&nbsp;<span class="op" id="7343313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7343317">got</span>&nbsp;<span class="op" id="7343321">:=</span>&nbsp;<span class="ident" id="7343324">FormatMediaType</span><span class="op" id="7343339">(</span><span class="ident" id="7343340">tt</span><span class="op" id="7343342">.</span><span class="ident" id="7343343">typ</span><span class="op" id="7343346">,</span>&nbsp;<span class="ident" id="7343348">tt</span><span class="op" id="7343350">.</span><span class="ident" id="7343351">params</span><span class="op" id="7343357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7343361">if</span>&nbsp;<span class="ident" id="7343364">got</span>&nbsp;<span class="op" id="7343368">!=</span>&nbsp;<span class="ident" id="7343371">tt</span><span class="op" id="7343373">.</span><span class="ident" id="7343374">want</span>&nbsp;<span class="op" id="7343379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7343384">t</span><span class="op" id="7343385">.</span><span class="ident" id="7343386">Errorf</span><span class="op" id="7343392">(</span><span class="string" id="7343393">&#34;%d.&nbsp;FormatMediaType(%q,&nbsp;%v)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7343436">,</span>&nbsp;<span class="ident" id="7343438">i</span><span class="op" id="7343439">,</span>&nbsp;<span class="ident" id="7343441">tt</span><span class="op" id="7343443">.</span><span class="ident" id="7343444">typ</span><span class="op" id="7343447">,</span>&nbsp;<span class="ident" id="7343449">tt</span><span class="op" id="7343451">.</span><span class="ident" id="7343452">params</span><span class="op" id="7343458">,</span>&nbsp;<span class="ident" id="7343460">got</span><span class="op" id="7343463">,</span>&nbsp;<span class="ident" id="7343465">tt</span><span class="op" id="7343467">.</span><span class="ident" id="7343468">want</span><span class="op" id="7343472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7343476">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7343479">}</span><br>
<span class="lineno"></span><span class="op" id="7343481">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
