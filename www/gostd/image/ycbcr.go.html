<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>image</h2>
<ul>
<li><a href="/gostd/image/decode_example_test.go.html">decode_example_test.go</a></li>
<li><a href="/gostd/image/decode_test.go.html">decode_test.go</a></li>
<li><a href="/gostd/image/format.go.html">format.go</a></li>
<li><a href="/gostd/image/geom.go.html">geom.go</a></li>
<li><a href="/gostd/image/image.go.html">image.go</a></li>
<li><a href="/gostd/image/image_test.go.html">image_test.go</a></li>
<li><a href="/gostd/image/names.go.html">names.go</a></li>
<li><a href="/gostd/image/ycbcr.go.html">ycbcr.go</a></li>
<li><a href="/gostd/image/ycbcr_test.go.html">ycbcr_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4960371">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4960426">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4960480">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4960531">package</span>&nbsp;<span class="ident" id="4960539">image</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4960546">import</span>&nbsp;<span class="op" id="4960553">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4960556">&#34;image/color&#34;</span><br>
<span class="lineno"></span><span class="op" id="4960570">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="4960573">//&nbsp;YCbCrSubsampleRatio&nbsp;is&nbsp;the&nbsp;chroma&nbsp;subsample&nbsp;ratio&nbsp;used&nbsp;in&nbsp;a&nbsp;YCbCr&nbsp;image.</span><br>
<span class="lineno"></span><span class="keyword" id="4960649">type</span>&nbsp;<span class="ident" id="4960654">YCbCrSubsampleRatio</span>&nbsp;<span class="builtintype" id="4960674">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4960679">const</span>&nbsp;<span class="op" id="4960685">(</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4960688">YCbCrSubsampleRatio444</span>&nbsp;<span class="ident" id="4960711">YCbCrSubsampleRatio</span>&nbsp;<span class="op" id="4960731">=</span>&nbsp;<span class="ident" id="4960733">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4960739">YCbCrSubsampleRatio422</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4960763">YCbCrSubsampleRatio420</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4960787">YCbCrSubsampleRatio440</span><br>
<span class="lineno"></span><span class="op" id="4960810">)</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="4960813">func</span>&nbsp;<span class="op" id="4960818">(</span><span class="ident" id="4960819">s</span>&nbsp;<span class="ident" id="4960821">YCbCrSubsampleRatio</span><span class="op" id="4960840">)</span>&nbsp;<span class="ident" id="4960842">String</span><span class="op" id="4960848">(</span><span class="op" id="4960849">)</span>&nbsp;<span class="builtintype" id="4960851">string</span>&nbsp;<span class="op" id="4960858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4960861">switch</span>&nbsp;<span class="ident" id="4960868">s</span>&nbsp;<span class="op" id="4960870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4960873">case</span>&nbsp;<span class="ident" id="4960878">YCbCrSubsampleRatio444</span><span class="op" id="4960900">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4960904">return</span>&nbsp;<span class="string" id="4960911">&#34;YCbCrSubsampleRatio444&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4960937">case</span>&nbsp;<span class="ident" id="4960942">YCbCrSubsampleRatio422</span><span class="op" id="4960964">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4960968">return</span>&nbsp;<span class="string" id="4960975">&#34;YCbCrSubsampleRatio422&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4961001">case</span>&nbsp;<span class="ident" id="4961006">YCbCrSubsampleRatio420</span><span class="op" id="4961028">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4961032">return</span>&nbsp;<span class="string" id="4961039">&#34;YCbCrSubsampleRatio420&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4961065">case</span>&nbsp;<span class="ident" id="4961070">YCbCrSubsampleRatio440</span><span class="op" id="4961092">:</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4961096">return</span>&nbsp;<span class="string" id="4961103">&#34;YCbCrSubsampleRatio440&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4961129">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4961132">return</span>&nbsp;<span class="string" id="4961139">&#34;YCbCrSubsampleRatioUnknown&#34;</span><br>
<span class="lineno"></span><span class="op" id="4961168">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="4961171">//&nbsp;YCbCr&nbsp;is&nbsp;an&nbsp;in-memory&nbsp;image&nbsp;of&nbsp;Y&#39;CbCr&nbsp;colors.&nbsp;There&nbsp;is&nbsp;one&nbsp;Y&nbsp;sample&nbsp;per</span><br>
<span class="lineno"></span><span class="comment" id="4961246">//&nbsp;pixel,&nbsp;but&nbsp;each&nbsp;Cb&nbsp;and&nbsp;Cr&nbsp;sample&nbsp;can&nbsp;span&nbsp;one&nbsp;or&nbsp;more&nbsp;pixels.</span><br>
<span class="lineno"></span><span class="comment" id="4961311">//&nbsp;YStride&nbsp;is&nbsp;the&nbsp;Y&nbsp;slice&nbsp;index&nbsp;delta&nbsp;between&nbsp;vertically&nbsp;adjacent&nbsp;pixels.</span><br>
<span class="lineno"></span><span class="comment" id="4961385">//&nbsp;CStride&nbsp;is&nbsp;the&nbsp;Cb&nbsp;and&nbsp;Cr&nbsp;slice&nbsp;index&nbsp;delta&nbsp;between&nbsp;vertically&nbsp;adjacent&nbsp;pixels</span><br>
<span class="lineno"></span><span class="comment" id="4961466">//&nbsp;that&nbsp;map&nbsp;to&nbsp;separate&nbsp;chroma&nbsp;samples.</span><br>
<span class="lineno">40</span><span class="comment" id="4961506">//&nbsp;It&nbsp;is&nbsp;not&nbsp;an&nbsp;absolute&nbsp;requirement,&nbsp;but&nbsp;YStride&nbsp;and&nbsp;len(Y)&nbsp;are&nbsp;typically</span><br>
<span class="lineno"></span><span class="comment" id="4961581">//&nbsp;multiples&nbsp;of&nbsp;8,&nbsp;and:</span><br>
<span class="lineno"></span><span class="comment" id="4961605">//&nbsp;&nbsp;&nbsp;&nbspFor&nbsp;4:4:4,&nbsp;CStride&nbsp;==&nbsp;YStride/1&nbsp;&amp;&amp;&nbsp;len(Cb)&nbsp;==&nbsp;len(Cr)&nbsp;==&nbsp;len(Y)/1.</span><br>
<span class="lineno"></span><span class="comment" id="4961675">//&nbsp;&nbsp;&nbsp;&nbspFor&nbsp;4:2:2,&nbsp;CStride&nbsp;==&nbsp;YStride/2&nbsp;&amp;&amp;&nbsp;len(Cb)&nbsp;==&nbsp;len(Cr)&nbsp;==&nbsp;len(Y)/2.</span><br>
<span class="lineno"></span><span class="comment" id="4961745">//&nbsp;&nbsp;&nbsp;&nbspFor&nbsp;4:2:0,&nbsp;CStride&nbsp;==&nbsp;YStride/2&nbsp;&amp;&amp;&nbsp;len(Cb)&nbsp;==&nbsp;len(Cr)&nbsp;==&nbsp;len(Y)/4.</span><br>
<span class="lineno">45</span><span class="comment" id="4961815">//&nbsp;&nbsp;&nbsp;&nbspFor&nbsp;4:4:0,&nbsp;CStride&nbsp;==&nbsp;YStride/1&nbsp;&amp;&amp;&nbsp;len(Cb)&nbsp;==&nbsp;len(Cr)&nbsp;==&nbsp;len(Y)/2.</span><br>
<span class="lineno"></span><span class="keyword" id="4961885">type</span>&nbsp;<span class="ident" id="4961890">YCbCr</span>&nbsp;<span class="keyword" id="4961896">struct</span>&nbsp;<span class="op" id="4961903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4961906">Y</span><span class="op" id="4961907">,</span>&nbsp;<span class="ident" id="4961909">Cb</span><span class="op" id="4961911">,</span>&nbsp;<span class="ident" id="4961913">Cr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4961921">[</span><span class="op" id="4961922">]</span><span class="builtintype" id="4961923">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4961930">YStride</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4961945">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4961950">CStride</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4961965">int</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4961970">SubsampleRatio</span>&nbsp;<span class="ident" id="4961985">YCbCrSubsampleRatio</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4962006">Rect</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4962021">Rectangle</span><br>
<span class="lineno"></span><span class="op" id="4962031">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4962034">func</span>&nbsp;<span class="op" id="4962039">(</span><span class="ident" id="4962040">p</span>&nbsp;<span class="op" id="4962042">*</span><span class="ident" id="4962043">YCbCr</span><span class="op" id="4962048">)</span>&nbsp;<span class="ident" id="4962050">ColorModel</span><span class="op" id="4962060">(</span><span class="op" id="4962061">)</span>&nbsp;<span class="ident" id="4962063">color</span><span class="op" id="4962068">.</span><span class="ident" id="4962069">Model</span>&nbsp;<span class="op" id="4962075">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4962078">return</span>&nbsp;<span class="ident" id="4962085">color</span><span class="op" id="4962090">.</span><span class="ident" id="4962091">YCbCrModel</span><br>
<span class="lineno"></span><span class="op" id="4962102">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4962105">func</span>&nbsp;<span class="op" id="4962110">(</span><span class="ident" id="4962111">p</span>&nbsp;<span class="op" id="4962113">*</span><span class="ident" id="4962114">YCbCr</span><span class="op" id="4962119">)</span>&nbsp;<span class="ident" id="4962121">Bounds</span><span class="op" id="4962127">(</span><span class="op" id="4962128">)</span>&nbsp;<span class="ident" id="4962130">Rectangle</span>&nbsp;<span class="op" id="4962140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4962143">return</span>&nbsp;<span class="ident" id="4962150">p</span><span class="op" id="4962151">.</span><span class="ident" id="4962152">Rect</span><br>
<span class="lineno">60</span><span class="op" id="4962157">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4962160">func</span>&nbsp;<span class="op" id="4962165">(</span><span class="ident" id="4962166">p</span>&nbsp;<span class="op" id="4962168">*</span><span class="ident" id="4962169">YCbCr</span><span class="op" id="4962174">)</span>&nbsp;<span class="ident" id="4962176">At</span><span class="op" id="4962178">(</span><span class="ident" id="4962179">x</span><span class="op" id="4962180">,</span>&nbsp;<span class="ident" id="4962182">y</span>&nbsp;<span class="builtintype" id="4962184">int</span><span class="op" id="4962187">)</span>&nbsp;<span class="ident" id="4962189">color</span><span class="op" id="4962194">.</span><span class="ident" id="4962195">Color</span>&nbsp;<span class="op" id="4962201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4962204">return</span>&nbsp;<span class="ident" id="4962211">p</span><span class="op" id="4962212">.</span><span class="ident" id="4962213">YCbCrAt</span><span class="op" id="4962220">(</span><span class="ident" id="4962221">x</span><span class="op" id="4962222">,</span>&nbsp;<span class="ident" id="4962224">y</span><span class="op" id="4962225">)</span><br>
<span class="lineno"></span><span class="op" id="4962227">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="4962230">func</span>&nbsp;<span class="op" id="4962235">(</span><span class="ident" id="4962236">p</span>&nbsp;<span class="op" id="4962238">*</span><span class="ident" id="4962239">YCbCr</span><span class="op" id="4962244">)</span>&nbsp;<span class="ident" id="4962246">YCbCrAt</span><span class="op" id="4962253">(</span><span class="ident" id="4962254">x</span><span class="op" id="4962255">,</span>&nbsp;<span class="ident" id="4962257">y</span>&nbsp;<span class="builtintype" id="4962259">int</span><span class="op" id="4962262">)</span>&nbsp;<span class="ident" id="4962264">color</span><span class="op" id="4962269">.</span><span class="ident" id="4962270">YCbCr</span>&nbsp;<span class="op" id="4962276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4962279">if</span>&nbsp;<span class="op" id="4962282">!</span><span class="op" id="4962283">(</span><span class="ident" id="4962284">Point</span><span class="op" id="4962289">{</span><span class="ident" id="4962290">x</span><span class="op" id="4962291">,</span>&nbsp;<span class="ident" id="4962293">y</span><span class="op" id="4962294">}</span><span class="op" id="4962295">.</span><span class="ident" id="4962296">In</span><span class="op" id="4962298">(</span><span class="ident" id="4962299">p</span><span class="op" id="4962300">.</span><span class="ident" id="4962301">Rect</span><span class="op" id="4962305">)</span><span class="op" id="4962306">)</span>&nbsp;<span class="op" id="4962308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4962312">return</span>&nbsp;<span class="ident" id="4962319">color</span><span class="op" id="4962324">.</span><span class="ident" id="4962325">YCbCr</span><span class="op" id="4962330">{</span><span class="op" id="4962331">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4962334">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4962337">yi</span>&nbsp;<span class="op" id="4962340">:=</span>&nbsp;<span class="ident" id="4962343">p</span><span class="op" id="4962344">.</span><span class="ident" id="4962345">YOffset</span><span class="op" id="4962352">(</span><span class="ident" id="4962353">x</span><span class="op" id="4962354">,</span>&nbsp;<span class="ident" id="4962356">y</span><span class="op" id="4962357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4962360">ci</span>&nbsp;<span class="op" id="4962363">:=</span>&nbsp;<span class="ident" id="4962366">p</span><span class="op" id="4962367">.</span><span class="ident" id="4962368">COffset</span><span class="op" id="4962375">(</span><span class="ident" id="4962376">x</span><span class="op" id="4962377">,</span>&nbsp;<span class="ident" id="4962379">y</span><span class="op" id="4962380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4962383">return</span>&nbsp;<span class="ident" id="4962390">color</span><span class="op" id="4962395">.</span><span class="ident" id="4962396">YCbCr</span><span class="op" id="4962401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4962405">p</span><span class="op" id="4962406">.</span><span class="ident" id="4962407">Y</span><span class="op" id="4962408">[</span><span class="ident" id="4962409">yi</span><span class="op" id="4962411">]</span><span class="op" id="4962412">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4962416">p</span><span class="op" id="4962417">.</span><span class="ident" id="4962418">Cb</span><span class="op" id="4962420">[</span><span class="ident" id="4962421">ci</span><span class="op" id="4962423">]</span><span class="op" id="4962424">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4962428">p</span><span class="op" id="4962429">.</span><span class="ident" id="4962430">Cr</span><span class="op" id="4962432">[</span><span class="ident" id="4962433">ci</span><span class="op" id="4962435">]</span><span class="op" id="4962436">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4962439">}</span><br>
<span class="lineno"></span><span class="op" id="4962441">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4962444">//&nbsp;YOffset&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;first&nbsp;element&nbsp;of&nbsp;Y&nbsp;that&nbsp;corresponds&nbsp;to</span><br>
<span class="lineno">80</span><span class="comment" id="4962519">//&nbsp;the&nbsp;pixel&nbsp;at&nbsp;(x,&nbsp;y).</span><br>
<span class="lineno"></span><span class="keyword" id="4962543">func</span>&nbsp;<span class="op" id="4962548">(</span><span class="ident" id="4962549">p</span>&nbsp;<span class="op" id="4962551">*</span><span class="ident" id="4962552">YCbCr</span><span class="op" id="4962557">)</span>&nbsp;<span class="ident" id="4962559">YOffset</span><span class="op" id="4962566">(</span><span class="ident" id="4962567">x</span><span class="op" id="4962568">,</span>&nbsp;<span class="ident" id="4962570">y</span>&nbsp;<span class="builtintype" id="4962572">int</span><span class="op" id="4962575">)</span>&nbsp;<span class="builtintype" id="4962577">int</span>&nbsp;<span class="op" id="4962581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4962584">return</span>&nbsp;<span class="op" id="4962591">(</span><span class="ident" id="4962592">y</span><span class="op" id="4962593">-</span><span class="ident" id="4962594">p</span><span class="op" id="4962595">.</span><span class="ident" id="4962596">Rect</span><span class="op" id="4962600">.</span><span class="ident" id="4962601">Min</span><span class="op" id="4962604">.</span><span class="ident" id="4962605">Y</span><span class="op" id="4962606">)</span><span class="op" id="4962607">*</span><span class="ident" id="4962608">p</span><span class="op" id="4962609">.</span><span class="ident" id="4962610">YStride</span>&nbsp;<span class="op" id="4962618">+</span>&nbsp;<span class="op" id="4962620">(</span><span class="ident" id="4962621">x</span>&nbsp;<span class="op" id="4962623">-</span>&nbsp;<span class="ident" id="4962625">p</span><span class="op" id="4962626">.</span><span class="ident" id="4962627">Rect</span><span class="op" id="4962631">.</span><span class="ident" id="4962632">Min</span><span class="op" id="4962635">.</span><span class="ident" id="4962636">X</span><span class="op" id="4962637">)</span><br>
<span class="lineno"></span><span class="op" id="4962639">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="4962642">//&nbsp;COffset&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;first&nbsp;element&nbsp;of&nbsp;Cb&nbsp;or&nbsp;Cr&nbsp;that&nbsp;corresponds</span><br>
<span class="lineno"></span><span class="comment" id="4962721">//&nbsp;to&nbsp;the&nbsp;pixel&nbsp;at&nbsp;(x,&nbsp;y).</span><br>
<span class="lineno"></span><span class="keyword" id="4962748">func</span>&nbsp;<span class="op" id="4962753">(</span><span class="ident" id="4962754">p</span>&nbsp;<span class="op" id="4962756">*</span><span class="ident" id="4962757">YCbCr</span><span class="op" id="4962762">)</span>&nbsp;<span class="ident" id="4962764">COffset</span><span class="op" id="4962771">(</span><span class="ident" id="4962772">x</span><span class="op" id="4962773">,</span>&nbsp;<span class="ident" id="4962775">y</span>&nbsp;<span class="builtintype" id="4962777">int</span><span class="op" id="4962780">)</span>&nbsp;<span class="builtintype" id="4962782">int</span>&nbsp;<span class="op" id="4962786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4962789">switch</span>&nbsp;<span class="ident" id="4962796">p</span><span class="op" id="4962797">.</span><span class="ident" id="4962798">SubsampleRatio</span>&nbsp;<span class="op" id="4962813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4962816">case</span>&nbsp;<span class="ident" id="4962821">YCbCrSubsampleRatio422</span><span class="op" id="4962843">:</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4962847">return</span>&nbsp;<span class="op" id="4962854">(</span><span class="ident" id="4962855">y</span><span class="op" id="4962856">-</span><span class="ident" id="4962857">p</span><span class="op" id="4962858">.</span><span class="ident" id="4962859">Rect</span><span class="op" id="4962863">.</span><span class="ident" id="4962864">Min</span><span class="op" id="4962867">.</span><span class="ident" id="4962868">Y</span><span class="op" id="4962869">)</span><span class="op" id="4962870">*</span><span class="ident" id="4962871">p</span><span class="op" id="4962872">.</span><span class="ident" id="4962873">CStride</span>&nbsp;<span class="op" id="4962881">+</span>&nbsp;<span class="op" id="4962883">(</span><span class="ident" id="4962884">x</span><span class="op" id="4962885">/</span><span class="num" id="4962886">2</span>&nbsp;<span class="op" id="4962888">-</span>&nbsp;<span class="ident" id="4962890">p</span><span class="op" id="4962891">.</span><span class="ident" id="4962892">Rect</span><span class="op" id="4962896">.</span><span class="ident" id="4962897">Min</span><span class="op" id="4962900">.</span><span class="ident" id="4962901">X</span><span class="op" id="4962902">/</span><span class="num" id="4962903">2</span><span class="op" id="4962904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4962907">case</span>&nbsp;<span class="ident" id="4962912">YCbCrSubsampleRatio420</span><span class="op" id="4962934">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4962938">return</span>&nbsp;<span class="op" id="4962945">(</span><span class="ident" id="4962946">y</span><span class="op" id="4962947">/</span><span class="num" id="4962948">2</span><span class="op" id="4962949">-</span><span class="ident" id="4962950">p</span><span class="op" id="4962951">.</span><span class="ident" id="4962952">Rect</span><span class="op" id="4962956">.</span><span class="ident" id="4962957">Min</span><span class="op" id="4962960">.</span><span class="ident" id="4962961">Y</span><span class="op" id="4962962">/</span><span class="num" id="4962963">2</span><span class="op" id="4962964">)</span><span class="op" id="4962965">*</span><span class="ident" id="4962966">p</span><span class="op" id="4962967">.</span><span class="ident" id="4962968">CStride</span>&nbsp;<span class="op" id="4962976">+</span>&nbsp;<span class="op" id="4962978">(</span><span class="ident" id="4962979">x</span><span class="op" id="4962980">/</span><span class="num" id="4962981">2</span>&nbsp;<span class="op" id="4962983">-</span>&nbsp;<span class="ident" id="4962985">p</span><span class="op" id="4962986">.</span><span class="ident" id="4962987">Rect</span><span class="op" id="4962991">.</span><span class="ident" id="4962992">Min</span><span class="op" id="4962995">.</span><span class="ident" id="4962996">X</span><span class="op" id="4962997">/</span><span class="num" id="4962998">2</span><span class="op" id="4962999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4963002">case</span>&nbsp;<span class="ident" id="4963007">YCbCrSubsampleRatio440</span><span class="op" id="4963029">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4963033">return</span>&nbsp;<span class="op" id="4963040">(</span><span class="ident" id="4963041">y</span><span class="op" id="4963042">/</span><span class="num" id="4963043">2</span><span class="op" id="4963044">-</span><span class="ident" id="4963045">p</span><span class="op" id="4963046">.</span><span class="ident" id="4963047">Rect</span><span class="op" id="4963051">.</span><span class="ident" id="4963052">Min</span><span class="op" id="4963055">.</span><span class="ident" id="4963056">Y</span><span class="op" id="4963057">/</span><span class="num" id="4963058">2</span><span class="op" id="4963059">)</span><span class="op" id="4963060">*</span><span class="ident" id="4963061">p</span><span class="op" id="4963062">.</span><span class="ident" id="4963063">CStride</span>&nbsp;<span class="op" id="4963071">+</span>&nbsp;<span class="op" id="4963073">(</span><span class="ident" id="4963074">x</span>&nbsp;<span class="op" id="4963076">-</span>&nbsp;<span class="ident" id="4963078">p</span><span class="op" id="4963079">.</span><span class="ident" id="4963080">Rect</span><span class="op" id="4963084">.</span><span class="ident" id="4963085">Min</span><span class="op" id="4963088">.</span><span class="ident" id="4963089">X</span><span class="op" id="4963090">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4963093">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4963096">//&nbsp;Default&nbsp;to&nbsp;4:4:4&nbsp;subsampling.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4963130">return</span>&nbsp;<span class="op" id="4963137">(</span><span class="ident" id="4963138">y</span><span class="op" id="4963139">-</span><span class="ident" id="4963140">p</span><span class="op" id="4963141">.</span><span class="ident" id="4963142">Rect</span><span class="op" id="4963146">.</span><span class="ident" id="4963147">Min</span><span class="op" id="4963150">.</span><span class="ident" id="4963151">Y</span><span class="op" id="4963152">)</span><span class="op" id="4963153">*</span><span class="ident" id="4963154">p</span><span class="op" id="4963155">.</span><span class="ident" id="4963156">CStride</span>&nbsp;<span class="op" id="4963164">+</span>&nbsp;<span class="op" id="4963166">(</span><span class="ident" id="4963167">x</span>&nbsp;<span class="op" id="4963169">-</span>&nbsp;<span class="ident" id="4963171">p</span><span class="op" id="4963172">.</span><span class="ident" id="4963173">Rect</span><span class="op" id="4963177">.</span><span class="ident" id="4963178">Min</span><span class="op" id="4963181">.</span><span class="ident" id="4963182">X</span><span class="op" id="4963183">)</span><br>
<span class="lineno"></span><span class="op" id="4963185">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="comment" id="4963188">//&nbsp;SubImage&nbsp;returns&nbsp;an&nbsp;image&nbsp;representing&nbsp;the&nbsp;portion&nbsp;of&nbsp;the&nbsp;image&nbsp;p&nbsp;visible</span><br>
<span class="lineno"></span><span class="comment" id="4963265">//&nbsp;through&nbsp;r.&nbsp;The&nbsp;returned&nbsp;value&nbsp;shares&nbsp;pixels&nbsp;with&nbsp;the&nbsp;original&nbsp;image.</span><br>
<span class="lineno"></span><span class="keyword" id="4963337">func</span>&nbsp;<span class="op" id="4963342">(</span><span class="ident" id="4963343">p</span>&nbsp;<span class="op" id="4963345">*</span><span class="ident" id="4963346">YCbCr</span><span class="op" id="4963351">)</span>&nbsp;<span class="ident" id="4963353">SubImage</span><span class="op" id="4963361">(</span><span class="ident" id="4963362">r</span>&nbsp;<span class="ident" id="4963364">Rectangle</span><span class="op" id="4963373">)</span>&nbsp;<span class="ident" id="4963375">Image</span>&nbsp;<span class="op" id="4963381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4963384">r</span>&nbsp;<span class="op" id="4963386">=</span>&nbsp;<span class="ident" id="4963388">r</span><span class="op" id="4963389">.</span><span class="ident" id="4963390">Intersect</span><span class="op" id="4963399">(</span><span class="ident" id="4963400">p</span><span class="op" id="4963401">.</span><span class="ident" id="4963402">Rect</span><span class="op" id="4963406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4963409">//&nbsp;If&nbsp;r1&nbsp;and&nbsp;r2&nbsp;are&nbsp;Rectangles,&nbsp;r1.Intersect(r2)&nbsp;is&nbsp;not&nbsp;guaranteed&nbsp;to&nbsp;be&nbsp;inside</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4963490">//&nbsp;either&nbsp;r1&nbsp;or&nbsp;r2&nbsp;if&nbsp;the&nbsp;intersection&nbsp;is&nbsp;empty.&nbsp;Without&nbsp;explicitly&nbsp;checking&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4963572">//&nbsp;this,&nbsp;the&nbsp;Pix[i:]&nbsp;expression&nbsp;below&nbsp;can&nbsp;panic.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4963622">if</span>&nbsp;<span class="ident" id="4963625">r</span><span class="op" id="4963626">.</span><span class="ident" id="4963627">Empty</span><span class="op" id="4963632">(</span><span class="op" id="4963633">)</span>&nbsp;<span class="op" id="4963635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4963639">return</span>&nbsp;<span class="op" id="4963646">&amp;</span><span class="ident" id="4963647">YCbCr</span><span class="op" id="4963652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4963657">SubsampleRatio</span><span class="op" id="4963671">:</span>&nbsp;<span class="ident" id="4963673">p</span><span class="op" id="4963674">.</span><span class="ident" id="4963675">SubsampleRatio</span><span class="op" id="4963689">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4963693">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4963696">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4963699">yi</span>&nbsp;<span class="op" id="4963702">:=</span>&nbsp;<span class="ident" id="4963705">p</span><span class="op" id="4963706">.</span><span class="ident" id="4963707">YOffset</span><span class="op" id="4963714">(</span><span class="ident" id="4963715">r</span><span class="op" id="4963716">.</span><span class="ident" id="4963717">Min</span><span class="op" id="4963720">.</span><span class="ident" id="4963721">X</span><span class="op" id="4963722">,</span>&nbsp;<span class="ident" id="4963724">r</span><span class="op" id="4963725">.</span><span class="ident" id="4963726">Min</span><span class="op" id="4963729">.</span><span class="ident" id="4963730">Y</span><span class="op" id="4963731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4963734">ci</span>&nbsp;<span class="op" id="4963737">:=</span>&nbsp;<span class="ident" id="4963740">p</span><span class="op" id="4963741">.</span><span class="ident" id="4963742">COffset</span><span class="op" id="4963749">(</span><span class="ident" id="4963750">r</span><span class="op" id="4963751">.</span><span class="ident" id="4963752">Min</span><span class="op" id="4963755">.</span><span class="ident" id="4963756">X</span><span class="op" id="4963757">,</span>&nbsp;<span class="ident" id="4963759">r</span><span class="op" id="4963760">.</span><span class="ident" id="4963761">Min</span><span class="op" id="4963764">.</span><span class="ident" id="4963765">Y</span><span class="op" id="4963766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4963769">return</span>&nbsp;<span class="op" id="4963776">&amp;</span><span class="ident" id="4963777">YCbCr</span><span class="op" id="4963782">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4963786">Y</span><span class="op" id="4963787">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4963802">p</span><span class="op" id="4963803">.</span><span class="ident" id="4963804">Y</span><span class="op" id="4963805">[</span><span class="ident" id="4963806">yi</span><span class="op" id="4963808">:</span><span class="op" id="4963809">]</span><span class="op" id="4963810">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4963814">Cb</span><span class="op" id="4963816">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4963830">p</span><span class="op" id="4963831">.</span><span class="ident" id="4963832">Cb</span><span class="op" id="4963834">[</span><span class="ident" id="4963835">ci</span><span class="op" id="4963837">:</span><span class="op" id="4963838">]</span><span class="op" id="4963839">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4963843">Cr</span><span class="op" id="4963845">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4963859">p</span><span class="op" id="4963860">.</span><span class="ident" id="4963861">Cr</span><span class="op" id="4963863">[</span><span class="ident" id="4963864">ci</span><span class="op" id="4963866">:</span><span class="op" id="4963867">]</span><span class="op" id="4963868">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4963872">SubsampleRatio</span><span class="op" id="4963886">:</span>&nbsp;<span class="ident" id="4963888">p</span><span class="op" id="4963889">.</span><span class="ident" id="4963890">SubsampleRatio</span><span class="op" id="4963904">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4963908">YStride</span><span class="op" id="4963915">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4963924">p</span><span class="op" id="4963925">.</span><span class="ident" id="4963926">YStride</span><span class="op" id="4963933">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4963937">CStride</span><span class="op" id="4963944">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4963953">p</span><span class="op" id="4963954">.</span><span class="ident" id="4963955">CStride</span><span class="op" id="4963962">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4963966">Rect</span><span class="op" id="4963970">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4963982">r</span><span class="op" id="4963983">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4963986">}</span><br>
<span class="lineno"></span><span class="op" id="4963988">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="4963991">func</span>&nbsp;<span class="op" id="4963996">(</span><span class="ident" id="4963997">p</span>&nbsp;<span class="op" id="4963999">*</span><span class="ident" id="4964000">YCbCr</span><span class="op" id="4964005">)</span>&nbsp;<span class="ident" id="4964007">Opaque</span><span class="op" id="4964013">(</span><span class="op" id="4964014">)</span>&nbsp;<span class="builtintype" id="4964016">bool</span>&nbsp;<span class="op" id="4964021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4964024">return</span>&nbsp;<span class="builtintype" id="4964031">true</span><br>
<span class="lineno"></span><span class="op" id="4964036">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4964039">//&nbsp;NewYCbCr&nbsp;returns&nbsp;a&nbsp;new&nbsp;YCbCr&nbsp;with&nbsp;the&nbsp;given&nbsp;bounds&nbsp;and&nbsp;subsample&nbsp;ratio.</span><br>
<span class="lineno">130</span><span class="keyword" id="4964114">func</span>&nbsp;<span class="ident" id="4964119">NewYCbCr</span><span class="op" id="4964127">(</span><span class="ident" id="4964128">r</span>&nbsp;<span class="ident" id="4964130">Rectangle</span><span class="op" id="4964139">,</span>&nbsp;<span class="ident" id="4964141">subsampleRatio</span>&nbsp;<span class="ident" id="4964156">YCbCrSubsampleRatio</span><span class="op" id="4964175">)</span>&nbsp;<span class="op" id="4964177">*</span><span class="ident" id="4964178">YCbCr</span>&nbsp;<span class="op" id="4964184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4964187">w</span><span class="op" id="4964188">,</span>&nbsp;<span class="ident" id="4964190">h</span><span class="op" id="4964191">,</span>&nbsp;<span class="ident" id="4964193">cw</span><span class="op" id="4964195">,</span>&nbsp;<span class="ident" id="4964197">ch</span>&nbsp;<span class="op" id="4964200">:=</span>&nbsp;<span class="ident" id="4964203">r</span><span class="op" id="4964204">.</span><span class="ident" id="4964205">Dx</span><span class="op" id="4964207">(</span><span class="op" id="4964208">)</span><span class="op" id="4964209">,</span>&nbsp;<span class="ident" id="4964211">r</span><span class="op" id="4964212">.</span><span class="ident" id="4964213">Dy</span><span class="op" id="4964215">(</span><span class="op" id="4964216">)</span><span class="op" id="4964217">,</span>&nbsp;<span class="num" id="4964219">0</span><span class="op" id="4964220">,</span>&nbsp;<span class="num" id="4964222">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4964225">switch</span>&nbsp;<span class="ident" id="4964232">subsampleRatio</span>&nbsp;<span class="op" id="4964247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4964250">case</span>&nbsp;<span class="ident" id="4964255">YCbCrSubsampleRatio422</span><span class="op" id="4964277">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4964281">cw</span>&nbsp;<span class="op" id="4964284">=</span>&nbsp;<span class="op" id="4964286">(</span><span class="ident" id="4964287">r</span><span class="op" id="4964288">.</span><span class="ident" id="4964289">Max</span><span class="op" id="4964292">.</span><span class="ident" id="4964293">X</span><span class="op" id="4964294">+</span><span class="num" id="4964295">1</span><span class="op" id="4964296">)</span><span class="op" id="4964297">/</span><span class="num" id="4964298">2</span>&nbsp;<span class="op" id="4964300">-</span>&nbsp;<span class="ident" id="4964302">r</span><span class="op" id="4964303">.</span><span class="ident" id="4964304">Min</span><span class="op" id="4964307">.</span><span class="ident" id="4964308">X</span><span class="op" id="4964309">/</span><span class="num" id="4964310">2</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4964314">ch</span>&nbsp;<span class="op" id="4964317">=</span>&nbsp;<span class="ident" id="4964319">h</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4964322">case</span>&nbsp;<span class="ident" id="4964327">YCbCrSubsampleRatio420</span><span class="op" id="4964349">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4964353">cw</span>&nbsp;<span class="op" id="4964356">=</span>&nbsp;<span class="op" id="4964358">(</span><span class="ident" id="4964359">r</span><span class="op" id="4964360">.</span><span class="ident" id="4964361">Max</span><span class="op" id="4964364">.</span><span class="ident" id="4964365">X</span><span class="op" id="4964366">+</span><span class="num" id="4964367">1</span><span class="op" id="4964368">)</span><span class="op" id="4964369">/</span><span class="num" id="4964370">2</span>&nbsp;<span class="op" id="4964372">-</span>&nbsp;<span class="ident" id="4964374">r</span><span class="op" id="4964375">.</span><span class="ident" id="4964376">Min</span><span class="op" id="4964379">.</span><span class="ident" id="4964380">X</span><span class="op" id="4964381">/</span><span class="num" id="4964382">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4964386">ch</span>&nbsp;<span class="op" id="4964389">=</span>&nbsp;<span class="op" id="4964391">(</span><span class="ident" id="4964392">r</span><span class="op" id="4964393">.</span><span class="ident" id="4964394">Max</span><span class="op" id="4964397">.</span><span class="ident" id="4964398">Y</span><span class="op" id="4964399">+</span><span class="num" id="4964400">1</span><span class="op" id="4964401">)</span><span class="op" id="4964402">/</span><span class="num" id="4964403">2</span>&nbsp;<span class="op" id="4964405">-</span>&nbsp;<span class="ident" id="4964407">r</span><span class="op" id="4964408">.</span><span class="ident" id="4964409">Min</span><span class="op" id="4964412">.</span><span class="ident" id="4964413">Y</span><span class="op" id="4964414">/</span><span class="num" id="4964415">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4964418">case</span>&nbsp;<span class="ident" id="4964423">YCbCrSubsampleRatio440</span><span class="op" id="4964445">:</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4964449">cw</span>&nbsp;<span class="op" id="4964452">=</span>&nbsp;<span class="ident" id="4964454">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4964458">ch</span>&nbsp;<span class="op" id="4964461">=</span>&nbsp;<span class="op" id="4964463">(</span><span class="ident" id="4964464">r</span><span class="op" id="4964465">.</span><span class="ident" id="4964466">Max</span><span class="op" id="4964469">.</span><span class="ident" id="4964470">Y</span><span class="op" id="4964471">+</span><span class="num" id="4964472">1</span><span class="op" id="4964473">)</span><span class="op" id="4964474">/</span><span class="num" id="4964475">2</span>&nbsp;<span class="op" id="4964477">-</span>&nbsp;<span class="ident" id="4964479">r</span><span class="op" id="4964480">.</span><span class="ident" id="4964481">Min</span><span class="op" id="4964484">.</span><span class="ident" id="4964485">Y</span><span class="op" id="4964486">/</span><span class="num" id="4964487">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4964490">default</span><span class="op" id="4964497">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4964501">//&nbsp;Default&nbsp;to&nbsp;4:4:4&nbsp;subsampling.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4964536">cw</span>&nbsp;<span class="op" id="4964539">=</span>&nbsp;<span class="ident" id="4964541">w</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4964545">ch</span>&nbsp;<span class="op" id="4964548">=</span>&nbsp;<span class="ident" id="4964550">h</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4964553">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4964556">b</span>&nbsp;<span class="op" id="4964558">:=</span>&nbsp;<span class="builtinfunc" id="4964561">make</span><span class="op" id="4964565">(</span><span class="op" id="4964566">[</span><span class="op" id="4964567">]</span><span class="builtintype" id="4964568">byte</span><span class="op" id="4964572">,</span>&nbsp;<span class="ident" id="4964574">w</span><span class="op" id="4964575">*</span><span class="ident" id="4964576">h</span><span class="op" id="4964577">+</span><span class="num" id="4964578">2</span><span class="op" id="4964579">*</span><span class="ident" id="4964580">cw</span><span class="op" id="4964582">*</span><span class="ident" id="4964583">ch</span><span class="op" id="4964585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4964588">return</span>&nbsp;<span class="op" id="4964595">&amp;</span><span class="ident" id="4964596">YCbCr</span><span class="op" id="4964601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4964605">Y</span><span class="op" id="4964606">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4964621">b</span><span class="op" id="4964622">[</span><span class="op" id="4964623">:</span><span class="ident" id="4964624">w</span><span class="op" id="4964625">*</span><span class="ident" id="4964626">h</span><span class="op" id="4964627">]</span><span class="op" id="4964628">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4964632">Cb</span><span class="op" id="4964634">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4964648">b</span><span class="op" id="4964649">[</span><span class="ident" id="4964650">w</span><span class="op" id="4964651">*</span><span class="ident" id="4964652">h</span><span class="op" id="4964653">+</span><span class="num" id="4964654">0</span><span class="op" id="4964655">*</span><span class="ident" id="4964656">cw</span><span class="op" id="4964658">*</span><span class="ident" id="4964659">ch</span>&nbsp;<span class="op" id="4964662">:</span>&nbsp;<span class="ident" id="4964664">w</span><span class="op" id="4964665">*</span><span class="ident" id="4964666">h</span><span class="op" id="4964667">+</span><span class="num" id="4964668">1</span><span class="op" id="4964669">*</span><span class="ident" id="4964670">cw</span><span class="op" id="4964672">*</span><span class="ident" id="4964673">ch</span><span class="op" id="4964675">]</span><span class="op" id="4964676">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4964680">Cr</span><span class="op" id="4964682">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4964696">b</span><span class="op" id="4964697">[</span><span class="ident" id="4964698">w</span><span class="op" id="4964699">*</span><span class="ident" id="4964700">h</span><span class="op" id="4964701">+</span><span class="num" id="4964702">1</span><span class="op" id="4964703">*</span><span class="ident" id="4964704">cw</span><span class="op" id="4964706">*</span><span class="ident" id="4964707">ch</span>&nbsp;<span class="op" id="4964710">:</span>&nbsp;<span class="ident" id="4964712">w</span><span class="op" id="4964713">*</span><span class="ident" id="4964714">h</span><span class="op" id="4964715">+</span><span class="num" id="4964716">2</span><span class="op" id="4964717">*</span><span class="ident" id="4964718">cw</span><span class="op" id="4964720">*</span><span class="ident" id="4964721">ch</span><span class="op" id="4964723">]</span><span class="op" id="4964724">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4964728">SubsampleRatio</span><span class="op" id="4964742">:</span>&nbsp;<span class="ident" id="4964744">subsampleRatio</span><span class="op" id="4964758">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4964762">YStride</span><span class="op" id="4964769">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4964778">w</span><span class="op" id="4964779">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4964783">CStride</span><span class="op" id="4964790">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4964799">cw</span><span class="op" id="4964801">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4964805">Rect</span><span class="op" id="4964809">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4964821">r</span><span class="op" id="4964822">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4964825">}</span><br>
<span class="lineno"></span><span class="op" id="4964827">}</span>
</div>
</body>
</html>
