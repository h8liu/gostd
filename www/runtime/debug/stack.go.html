<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6455002">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6455057">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6455111">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6455162">//&nbsp;Package&nbsp;debug&nbsp;contains&nbsp;facilities&nbsp;for&nbsp;programs&nbsp;to&nbsp;debug&nbsp;themselves&nbsp;while</span><br>
<span class="lineno"></span><span class="comment" id="6455238">//&nbsp;they&nbsp;are&nbsp;running.</span><br>
<span class="lineno"></span><span class="keyword" id="6455259">package</span>&nbsp;<span class="ident" id="6455267">debug</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6455274">import</span>&nbsp;<span class="op" id="6455281">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6455284">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6455293">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6455300">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6455313">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6455319">&#34;runtime&#34;</span><br>
<span class="lineno">15</span><span class="op" id="6455329">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6455332">var</span>&nbsp;<span class="op" id="6455336">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6455339">dunno</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6455349">=</span>&nbsp;<span class="op" id="6455351">[</span><span class="op" id="6455352">]</span><span class="builtintype" id="6455353">byte</span><span class="op" id="6455357">(</span><span class="string" id="6455358">&#34;???&#34;</span><span class="op" id="6455363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6455366">centerDot</span>&nbsp;<span class="op" id="6455376">=</span>&nbsp;<span class="op" id="6455378">[</span><span class="op" id="6455379">]</span><span class="builtintype" id="6455380">byte</span><span class="op" id="6455384">(</span><span class="string" id="6455385">&#34;Â·&#34;</span><span class="op" id="6455389">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6455392">dot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6455402">=</span>&nbsp;<span class="op" id="6455404">[</span><span class="op" id="6455405">]</span><span class="builtintype" id="6455406">byte</span><span class="op" id="6455410">(</span><span class="string" id="6455411">&#34;.&#34;</span><span class="op" id="6455414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6455417">slash</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6455427">=</span>&nbsp;<span class="op" id="6455429">[</span><span class="op" id="6455430">]</span><span class="builtintype" id="6455431">byte</span><span class="op" id="6455435">(</span><span class="string" id="6455436">&#34;/&#34;</span><span class="op" id="6455439">)</span><br>
<span class="lineno"></span><span class="op" id="6455441">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6455444">//&nbsp;PrintStack&nbsp;prints&nbsp;to&nbsp;standard&nbsp;error&nbsp;the&nbsp;stack&nbsp;trace&nbsp;returned&nbsp;by&nbsp;Stack.</span><br>
<span class="lineno">25</span><span class="keyword" id="6455518">func</span>&nbsp;<span class="ident" id="6455523">PrintStack</span><span class="op" id="6455533">(</span><span class="op" id="6455534">)</span>&nbsp;<span class="op" id="6455536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6455539"><a href="/runtime/debug/stack.go.html#6455313">os</a></span><span class="op" id="6455541">.</span><span class="ident" id="6455542">Stderr</span><span class="op" id="6455548">.</span><span class="ident" id="6455549">Write</span><span class="op" id="6455554">(</span><span class="ident" id="6455555"><a href="/runtime/debug/stack.go.html#6456012">stack</a></span><span class="op" id="6455560">(</span><span class="op" id="6455561">)</span><span class="op" id="6455562">)</span><br>
<span class="lineno"></span><span class="op" id="6455564">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6455567">//&nbsp;Stack&nbsp;returns&nbsp;a&nbsp;formatted&nbsp;stack&nbsp;trace&nbsp;of&nbsp;the&nbsp;goroutine&nbsp;that&nbsp;calls&nbsp;it.</span><br>
<span class="lineno">30</span><span class="comment" id="6455640">//&nbsp;For&nbsp;each&nbsp;routine,&nbsp;it&nbsp;includes&nbsp;the&nbsp;source&nbsp;line&nbsp;information&nbsp;and&nbsp;PC&nbsp;value,</span><br>
<span class="lineno"></span><span class="comment" id="6455715">//&nbsp;then&nbsp;attempts&nbsp;to&nbsp;discover,&nbsp;for&nbsp;Go&nbsp;functions,&nbsp;the&nbsp;calling&nbsp;function&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="6455787">//&nbsp;method&nbsp;and&nbsp;the&nbsp;text&nbsp;of&nbsp;the&nbsp;line&nbsp;containing&nbsp;the&nbsp;invocation.</span><br>
<span class="lineno"></span><span class="comment" id="6455849">//</span><br>
<span class="lineno"></span><span class="comment" id="6455852">//&nbsp;This&nbsp;function&nbsp;is&nbsp;deprecated.&nbsp;Use&nbsp;package&nbsp;runtime&#39;s&nbsp;Stack&nbsp;instead.</span><br>
<span class="lineno">35</span><span class="keyword" id="6455921">func</span>&nbsp;<span class="ident" id="6455926">Stack</span><span class="op" id="6455931">(</span><span class="op" id="6455932">)</span>&nbsp;<span class="op" id="6455934">[</span><span class="op" id="6455935">]</span><span class="builtintype" id="6455936">byte</span>&nbsp;<span class="op" id="6455941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6455944">return</span>&nbsp;<span class="ident" id="6455951"><a href="/runtime/debug/stack.go.html#6456012">stack</a></span><span class="op" id="6455956">(</span><span class="op" id="6455957">)</span><br>
<span class="lineno"></span><span class="op" id="6455959">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6455962">//&nbsp;stack&nbsp;implements&nbsp;Stack,&nbsp;skipping&nbsp;2&nbsp;frames</span><br>
<span class="lineno">40</span><span class="keyword" id="6456007">func</span>&nbsp;<span class="ident" id="6456012">stack</span><span class="op" id="6456017">(</span><span class="op" id="6456018">)</span>&nbsp;<span class="op" id="6456020">[</span><span class="op" id="6456021">]</span><span class="builtintype" id="6456022">byte</span>&nbsp;<span class="op" id="6456027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6456030">buf</span>&nbsp;<span class="op" id="6456034">:=</span>&nbsp;<span class="builtinfunc" id="6456037">new</span><span class="op" id="6456040">(</span><span class="ident" id="6456041"><a href="/runtime/debug/stack.go.html#6455284">bytes</a></span><span class="op" id="6456046">.</span><span class="ident" id="6456047">Buffer</span><span class="op" id="6456053">)</span>&nbsp;<span class="comment" id="6456055">//&nbsp;the&nbsp;returned&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6456077">//&nbsp;As&nbsp;we&nbsp;loop,&nbsp;we&nbsp;open&nbsp;files&nbsp;and&nbsp;read&nbsp;them.&nbsp;These&nbsp;variables&nbsp;record&nbsp;the&nbsp;currently</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6456159">//&nbsp;loaded&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6456176">var</span>&nbsp;<span class="ident" id="6456180">lines</span>&nbsp;<span class="op" id="6456186">[</span><span class="op" id="6456187">]</span><span class="op" id="6456188">[</span><span class="op" id="6456189">]</span><span class="builtintype" id="6456190">byte</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6456196">var</span>&nbsp;<span class="ident" id="6456200">lastFile</span>&nbsp;<span class="builtintype" id="6456209">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6456217">for</span>&nbsp;<span class="ident" id="6456221">i</span>&nbsp;<span class="op" id="6456223">:=</span>&nbsp;<span class="num" id="6456226">2</span><span class="op" id="6456227">;</span>&nbsp;<span class="op" id="6456229">;</span>&nbsp;<span class="ident" id="6456231"><a href="/runtime/debug/stack.go.html#6456221">i</a></span><span class="op" id="6456232">++</span>&nbsp;<span class="op" id="6456235">{</span>&nbsp;<span class="comment" id="6456237">//&nbsp;Caller&nbsp;we&nbsp;care&nbsp;about&nbsp;is&nbsp;the&nbsp;user,&nbsp;2&nbsp;frames&nbsp;up</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6456288">pc</span><span class="op" id="6456290">,</span>&nbsp;<span class="ident" id="6456292">file</span><span class="op" id="6456296">,</span>&nbsp;<span class="ident" id="6456298">line</span><span class="op" id="6456302">,</span>&nbsp;<span class="ident" id="6456304">ok</span>&nbsp;<span class="op" id="6456307">:=</span>&nbsp;<span class="ident" id="6456310"><a href="/runtime/debug/stack.go.html#6455319">runtime</a></span><span class="op" id="6456317">.</span><span class="ident" id="6456318">Caller</span><span class="op" id="6456324">(</span><span class="ident" id="6456325"><a href="/runtime/debug/stack.go.html#6456221">i</a></span><span class="op" id="6456326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6456330">if</span>&nbsp;<span class="op" id="6456333">!</span><span class="ident" id="6456334"><a href="/runtime/debug/stack.go.html#6456304">ok</a></span>&nbsp;<span class="op" id="6456337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6456342">break</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6456350">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6456354">//&nbsp;Print&nbsp;this&nbsp;much&nbsp;at&nbsp;least.&nbsp;&nbsp;If&nbsp;we&nbsp;can&#39;t&nbsp;find&nbsp;the&nbsp;source,&nbsp;it&nbsp;won&#39;t&nbsp;show.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6456430"><a href="/runtime/debug/stack.go.html#6455293">fmt</a></span><span class="op" id="6456433">.</span><span class="ident" id="6456434">Fprintf</span><span class="op" id="6456441">(</span><span class="ident" id="6456442"><a href="/runtime/debug/stack.go.html#6456030">buf</a></span><span class="op" id="6456445">,</span>&nbsp;<span class="string" id="6456447">&#34;%s:%d&nbsp;(0x%x)\n&#34;</span><span class="op" id="6456463">,</span>&nbsp;<span class="ident" id="6456465"><a href="/runtime/debug/stack.go.html#6456292">file</a></span><span class="op" id="6456469">,</span>&nbsp;<span class="ident" id="6456471"><a href="/runtime/debug/stack.go.html#6456298">line</a></span><span class="op" id="6456475">,</span>&nbsp;<span class="ident" id="6456477"><a href="/runtime/debug/stack.go.html#6456288">pc</a></span><span class="op" id="6456479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6456483">if</span>&nbsp;<span class="ident" id="6456486"><a href="/runtime/debug/stack.go.html#6456292">file</a></span>&nbsp;<span class="op" id="6456491">!=</span>&nbsp;<span class="ident" id="6456494"><a href="/runtime/debug/stack.go.html#6456200">lastFile</a></span>&nbsp;<span class="op" id="6456503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6456508">data</span><span class="op" id="6456512">,</span>&nbsp;<span class="ident" id="6456514">err</span>&nbsp;<span class="op" id="6456518">:=</span>&nbsp;<span class="ident" id="6456521"><a href="/runtime/debug/stack.go.html#6455300">ioutil</a></span><span class="op" id="6456527">.</span><span class="ident" id="6456528">ReadFile</span><span class="op" id="6456536">(</span><span class="ident" id="6456537"><a href="/runtime/debug/stack.go.html#6456292">file</a></span><span class="op" id="6456541">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6456546">if</span>&nbsp;<span class="ident" id="6456549"><a href="/runtime/debug/stack.go.html#6456514">err</a></span>&nbsp;<span class="op" id="6456553">!=</span>&nbsp;<span class="ident" id="6456556">nil</span>&nbsp;<span class="op" id="6456560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6456566">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6456578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6456583"><a href="/runtime/debug/stack.go.html#6456180">lines</a></span>&nbsp;<span class="op" id="6456589">=</span>&nbsp;<span class="ident" id="6456591"><a href="/runtime/debug/stack.go.html#6455284">bytes</a></span><span class="op" id="6456596">.</span><span class="ident" id="6456597">Split</span><span class="op" id="6456602">(</span><span class="ident" id="6456603"><a href="/runtime/debug/stack.go.html#6456508">data</a></span><span class="op" id="6456607">,</span>&nbsp;<span class="op" id="6456609">[</span><span class="op" id="6456610">]</span><span class="builtintype" id="6456611">byte</span><span class="op" id="6456615">{</span><span class="string" id="6456616">&#39;\n&#39;</span><span class="op" id="6456620">}</span><span class="op" id="6456621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6456626"><a href="/runtime/debug/stack.go.html#6456200">lastFile</a></span>&nbsp;<span class="op" id="6456635">=</span>&nbsp;<span class="ident" id="6456637"><a href="/runtime/debug/stack.go.html#6456292">file</a></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6456644">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6456648"><a href="/runtime/debug/stack.go.html#6456298">line</a></span><span class="op" id="6456652">--</span>&nbsp;<span class="comment" id="6456655">//&nbsp;in&nbsp;stack&nbsp;trace,&nbsp;lines&nbsp;are&nbsp;1-indexed&nbsp;but&nbsp;our&nbsp;array&nbsp;is&nbsp;0-indexed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6456723"><a href="/runtime/debug/stack.go.html#6455293">fmt</a></span><span class="op" id="6456726">.</span><span class="ident" id="6456727">Fprintf</span><span class="op" id="6456734">(</span><span class="ident" id="6456735"><a href="/runtime/debug/stack.go.html#6456030">buf</a></span><span class="op" id="6456738">,</span>&nbsp;<span class="string" id="6456740">&#34;\t%s:&nbsp;%s\n&#34;</span><span class="op" id="6456752">,</span>&nbsp;<span class="ident" id="6456754"><a href="/runtime/debug/stack.go.html#6457088">function</a></span><span class="op" id="6456762">(</span><span class="ident" id="6456763"><a href="/runtime/debug/stack.go.html#6456288">pc</a></span><span class="op" id="6456765">)</span><span class="op" id="6456766">,</span>&nbsp;<span class="ident" id="6456768"><a href="/runtime/debug/stack.go.html#6456878">source</a></span><span class="op" id="6456774">(</span><span class="ident" id="6456775"><a href="/runtime/debug/stack.go.html#6456180">lines</a></span><span class="op" id="6456780">,</span>&nbsp;<span class="ident" id="6456782"><a href="/runtime/debug/stack.go.html#6456298">line</a></span><span class="op" id="6456786">)</span><span class="op" id="6456787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6456790">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6456793">return</span>&nbsp;<span class="ident" id="6456800"><a href="/runtime/debug/stack.go.html#6456030">buf</a></span><span class="op" id="6456803">.</span><span class="ident" id="6456804">Bytes</span><span class="op" id="6456809">(</span><span class="op" id="6456810">)</span><br>
<span class="lineno">65</span><span class="op" id="6456812">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6456815">//&nbsp;source&nbsp;returns&nbsp;a&nbsp;space-trimmed&nbsp;slice&nbsp;of&nbsp;the&nbsp;n&#39;th&nbsp;line.</span><br>
<span class="lineno"></span><span class="keyword" id="6456873">func</span>&nbsp;<span class="ident" id="6456878">source</span><span class="op" id="6456884">(</span><span class="ident" id="6456885">lines</span>&nbsp;<span class="op" id="6456891">[</span><span class="op" id="6456892">]</span><span class="op" id="6456893">[</span><span class="op" id="6456894">]</span><span class="builtintype" id="6456895">byte</span><span class="op" id="6456899">,</span>&nbsp;<span class="ident" id="6456901">n</span>&nbsp;<span class="builtintype" id="6456903">int</span><span class="op" id="6456906">)</span>&nbsp;<span class="op" id="6456908">[</span><span class="op" id="6456909">]</span><span class="builtintype" id="6456910">byte</span>&nbsp;<span class="op" id="6456915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6456918">if</span>&nbsp;<span class="ident" id="6456921"><a href="/runtime/debug/stack.go.html#6456901">n</a></span>&nbsp;<span class="op" id="6456923">&lt;</span>&nbsp;<span class="num" id="6456925">0</span>&nbsp;<span class="op" id="6456927">||</span>&nbsp;<span class="ident" id="6456930"><a href="/runtime/debug/stack.go.html#6456901">n</a></span>&nbsp;<span class="op" id="6456932">&gt;=</span>&nbsp;<span class="builtinfunc" id="6456935">len</span><span class="op" id="6456938">(</span><span class="ident" id="6456939"><a href="/runtime/debug/stack.go.html#6456885">lines</a></span><span class="op" id="6456944">)</span>&nbsp;<span class="op" id="6456946">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6456950">return</span>&nbsp;<span class="ident" id="6456957"><a href="/runtime/debug/stack.go.html#6455339">dunno</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6456964">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6456967">return</span>&nbsp;<span class="ident" id="6456974"><a href="/runtime/debug/stack.go.html#6455284">bytes</a></span><span class="op" id="6456979">.</span><span class="ident" id="6456980">Trim</span><span class="op" id="6456984">(</span><span class="ident" id="6456985"><a href="/runtime/debug/stack.go.html#6456885">lines</a></span><span class="op" id="6456990">[</span><span class="ident" id="6456991"><a href="/runtime/debug/stack.go.html#6456901">n</a></span><span class="op" id="6456992">]</span><span class="op" id="6456993">,</span>&nbsp;<span class="string" id="6456995">&#34;&nbsp;\t&#34;</span><span class="op" id="6457000">)</span><br>
<span class="lineno"></span><span class="op" id="6457002">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="6457005">//&nbsp;function&nbsp;returns,&nbsp;if&nbsp;possible,&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;function&nbsp;containing&nbsp;the&nbsp;PC.</span><br>
<span class="lineno"></span><span class="keyword" id="6457083">func</span>&nbsp;<span class="ident" id="6457088">function</span><span class="op" id="6457096">(</span><span class="ident" id="6457097">pc</span>&nbsp;<span class="builtintype" id="6457100">uintptr</span><span class="op" id="6457107">)</span>&nbsp;<span class="op" id="6457109">[</span><span class="op" id="6457110">]</span><span class="builtintype" id="6457111">byte</span>&nbsp;<span class="op" id="6457116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6457119">fn</span>&nbsp;<span class="op" id="6457122">:=</span>&nbsp;<span class="ident" id="6457125"><a href="/runtime/debug/stack.go.html#6455319">runtime</a></span><span class="op" id="6457132">.</span><span class="ident" id="6457133">FuncForPC</span><span class="op" id="6457142">(</span><span class="ident" id="6457143"><a href="/runtime/debug/stack.go.html#6457097">pc</a></span><span class="op" id="6457145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6457148">if</span>&nbsp;<span class="ident" id="6457151"><a href="/runtime/debug/stack.go.html#6457119">fn</a></span>&nbsp;<span class="op" id="6457154">==</span>&nbsp;<span class="ident" id="6457157">nil</span>&nbsp;<span class="op" id="6457161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6457165">return</span>&nbsp;<span class="ident" id="6457172"><a href="/runtime/debug/stack.go.html#6455339">dunno</a></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6457179">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6457182">name</span>&nbsp;<span class="op" id="6457187">:=</span>&nbsp;<span class="op" id="6457190">[</span><span class="op" id="6457191">]</span><span class="builtintype" id="6457192">byte</span><span class="op" id="6457196">(</span><span class="ident" id="6457197"><a href="/runtime/debug/stack.go.html#6457119">fn</a></span><span class="op" id="6457199">.</span><span class="ident" id="6457200">Name</span><span class="op" id="6457204">(</span><span class="op" id="6457205">)</span><span class="op" id="6457206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6457209">//&nbsp;The&nbsp;name&nbsp;includes&nbsp;the&nbsp;path&nbsp;name&nbsp;to&nbsp;the&nbsp;package,&nbsp;which&nbsp;is&nbsp;unnecessary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6457282">//&nbsp;since&nbsp;the&nbsp;file&nbsp;name&nbsp;is&nbsp;already&nbsp;included.&nbsp;&nbsp;Plus,&nbsp;it&nbsp;has&nbsp;center&nbsp;dots.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6457354">//&nbsp;That&nbsp;is,&nbsp;we&nbsp;see</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6457374">//&nbsp;&nbsp;&nbsp;&nbspruntime/debug.*TÂ·ptrmethod</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6457406">//&nbsp;and&nbsp;want</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6457419">//&nbsp;&nbsp;&nbsp;&nbsp*T.ptrmethod</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6457436">//&nbsp;Since&nbsp;the&nbsp;package&nbsp;path&nbsp;might&nbsp;contains&nbsp;dots&nbsp;(e.g.&nbsp;code.google.com/...),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6457511">//&nbsp;we&nbsp;first&nbsp;remove&nbsp;the&nbsp;path&nbsp;prefix&nbsp;if&nbsp;there&nbsp;is&nbsp;one.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6457564">if</span>&nbsp;<span class="ident" id="6457567">lastslash</span>&nbsp;<span class="op" id="6457577">:=</span>&nbsp;<span class="ident" id="6457580"><a href="/runtime/debug/stack.go.html#6455284">bytes</a></span><span class="op" id="6457585">.</span><span class="ident" id="6457586">LastIndex</span><span class="op" id="6457595">(</span><span class="ident" id="6457596"><a href="/runtime/debug/stack.go.html#6457182">name</a></span><span class="op" id="6457600">,</span>&nbsp;<span class="ident" id="6457602"><a href="/runtime/debug/stack.go.html#6455417">slash</a></span><span class="op" id="6457607">)</span><span class="op" id="6457608">;</span>&nbsp;<span class="ident" id="6457610"><a href="/runtime/debug/stack.go.html#6457567">lastslash</a></span>&nbsp;<span class="op" id="6457620">&gt;=</span>&nbsp;<span class="num" id="6457623">0</span>&nbsp;<span class="op" id="6457625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6457629"><a href="/runtime/debug/stack.go.html#6457182">name</a></span>&nbsp;<span class="op" id="6457634">=</span>&nbsp;<span class="ident" id="6457636"><a href="/runtime/debug/stack.go.html#6457182">name</a></span><span class="op" id="6457640">[</span><span class="ident" id="6457641"><a href="/runtime/debug/stack.go.html#6457567">lastslash</a></span><span class="op" id="6457650">+</span><span class="num" id="6457651">1</span><span class="op" id="6457652">:</span><span class="op" id="6457653">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6457656">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6457659">if</span>&nbsp;<span class="ident" id="6457662">period</span>&nbsp;<span class="op" id="6457669">:=</span>&nbsp;<span class="ident" id="6457672"><a href="/runtime/debug/stack.go.html#6455284">bytes</a></span><span class="op" id="6457677">.</span><span class="ident" id="6457678">Index</span><span class="op" id="6457683">(</span><span class="ident" id="6457684"><a href="/runtime/debug/stack.go.html#6457182">name</a></span><span class="op" id="6457688">,</span>&nbsp;<span class="ident" id="6457690"><a href="/runtime/debug/stack.go.html#6455392">dot</a></span><span class="op" id="6457693">)</span><span class="op" id="6457694">;</span>&nbsp;<span class="ident" id="6457696"><a href="/runtime/debug/stack.go.html#6457662">period</a></span>&nbsp;<span class="op" id="6457703">&gt;=</span>&nbsp;<span class="num" id="6457706">0</span>&nbsp;<span class="op" id="6457708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6457712"><a href="/runtime/debug/stack.go.html#6457182">name</a></span>&nbsp;<span class="op" id="6457717">=</span>&nbsp;<span class="ident" id="6457719"><a href="/runtime/debug/stack.go.html#6457182">name</a></span><span class="op" id="6457723">[</span><span class="ident" id="6457724"><a href="/runtime/debug/stack.go.html#6457662">period</a></span><span class="op" id="6457730">+</span><span class="num" id="6457731">1</span><span class="op" id="6457732">:</span><span class="op" id="6457733">]</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6457736">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6457739"><a href="/runtime/debug/stack.go.html#6457182">name</a></span>&nbsp;<span class="op" id="6457744">=</span>&nbsp;<span class="ident" id="6457746"><a href="/runtime/debug/stack.go.html#6455284">bytes</a></span><span class="op" id="6457751">.</span><span class="ident" id="6457752">Replace</span><span class="op" id="6457759">(</span><span class="ident" id="6457760"><a href="/runtime/debug/stack.go.html#6457182">name</a></span><span class="op" id="6457764">,</span>&nbsp;<span class="ident" id="6457766"><a href="/runtime/debug/stack.go.html#6455366">centerDot</a></span><span class="op" id="6457775">,</span>&nbsp;<span class="ident" id="6457777"><a href="/runtime/debug/stack.go.html#6455392">dot</a></span><span class="op" id="6457780">,</span>&nbsp;<span class="op" id="6457782">-</span><span class="num" id="6457783">1</span><span class="op" id="6457784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6457787">return</span>&nbsp;<span class="ident" id="6457794"><a href="/runtime/debug/stack.go.html#6457182">name</a></span><br>
<span class="lineno"></span><span class="op" id="6457799">}</span>
</div>
</body>
</html>
