<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html" class="current">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3704071">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3704126">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3704180">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3704231">//&nbsp;DNS&nbsp;packet&nbsp;assembly.&nbsp;&nbsp;See&nbsp;RFC&nbsp;1035.</span><br>
<span class="lineno"></span><span class="comment" id="3704270">//</span><br>
<span class="lineno"></span><span class="comment" id="3704273">//&nbsp;This&nbsp;is&nbsp;intended&nbsp;to&nbsp;support&nbsp;name&nbsp;resolution&nbsp;during&nbsp;Dial.</span><br>
<span class="lineno"></span><span class="comment" id="3704333">//&nbsp;It&nbsp;doesn&#39;t&nbsp;have&nbsp;to&nbsp;be&nbsp;blazing&nbsp;fast.</span><br>
<span class="lineno"></span><span class="comment" id="3704372">//</span><br>
<span class="lineno">10</span><span class="comment" id="3704375">//&nbsp;Each&nbsp;message&nbsp;structure&nbsp;has&nbsp;a&nbsp;Walk&nbsp;method&nbsp;that&nbsp;is&nbsp;used&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="3704435">//&nbsp;a&nbsp;generic&nbsp;pack/unpack&nbsp;routine.&nbsp;Thus,&nbsp;if&nbsp;in&nbsp;the&nbsp;future&nbsp;we&nbsp;need</span><br>
<span class="lineno"></span><span class="comment" id="3704500">//&nbsp;to&nbsp;define&nbsp;new&nbsp;message&nbsp;structs,&nbsp;no&nbsp;new&nbsp;pack/unpack/printing&nbsp;code</span><br>
<span class="lineno"></span><span class="comment" id="3704567">//&nbsp;needs&nbsp;to&nbsp;be&nbsp;written.</span><br>
<span class="lineno"></span><span class="comment" id="3704591">//</span><br>
<span class="lineno">15</span><span class="comment" id="3704594">//&nbsp;The&nbsp;first&nbsp;half&nbsp;of&nbsp;this&nbsp;file&nbsp;defines&nbsp;the&nbsp;DNS&nbsp;message&nbsp;formats.</span><br>
<span class="lineno"></span><span class="comment" id="3704658">//&nbsp;The&nbsp;second&nbsp;half&nbsp;implements&nbsp;the&nbsp;conversion&nbsp;to&nbsp;and&nbsp;from&nbsp;wire&nbsp;format.</span><br>
<span class="lineno"></span><span class="comment" id="3704728">//&nbsp;A&nbsp;few&nbsp;of&nbsp;the&nbsp;structure&nbsp;elements&nbsp;have&nbsp;string&nbsp;tags&nbsp;to&nbsp;aid&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3704791">//&nbsp;generic&nbsp;pack/unpack&nbsp;routines.</span><br>
<span class="lineno"></span><span class="comment" id="3704824">//</span><br>
<span class="lineno">20</span><span class="comment" id="3704827">//&nbsp;TODO(rsc):&nbsp;&nbsp;There&nbsp;are&nbsp;enough&nbsp;names&nbsp;defined&nbsp;in&nbsp;this&nbsp;file&nbsp;that&nbsp;they&#39;re&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="3704903">//&nbsp;prefixed&nbsp;with&nbsp;dns.&nbsp;&nbsp;Perhaps&nbsp;put&nbsp;this&nbsp;in&nbsp;its&nbsp;own&nbsp;package&nbsp;later.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3704970">package</span>&nbsp;<span class="ident" id="3704978">net</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="3704983">//&nbsp;Packet&nbsp;formats</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3705002">//&nbsp;Wire&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="3705021">const</span>&nbsp;<span class="op" id="3705027">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3705030">//&nbsp;valid&nbsp;dnsRR_Header.Rrtype&nbsp;and&nbsp;dnsQuestion.qtype</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3705082">dnsTypeA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3705095">=</span>&nbsp;<span class="num" id="3705097">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3705100">dnsTypeNS</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3705113">=</span>&nbsp;<span class="num" id="3705115">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3705118">dnsTypeMD</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3705131">=</span>&nbsp;<span class="num" id="3705133">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3705136">dnsTypeMF</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3705149">=</span>&nbsp;<span class="num" id="3705151">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3705154">dnsTypeCNAME</span>&nbsp;<span class="op" id="3705167">=</span>&nbsp;<span class="num" id="3705169">5</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3705172">dnsTypeSOA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3705185">=</span>&nbsp;<span class="num" id="3705187">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3705190">dnsTypeMB</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3705203">=</span>&nbsp;<span class="num" id="3705205">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3705208">dnsTypeMG</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3705221">=</span>&nbsp;<span class="num" id="3705223">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3705226">dnsTypeMR</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3705239">=</span>&nbsp;<span class="num" id="3705241">9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3705244">dnsTypeNULL</span>&nbsp;&nbsp;<span class="op" id="3705257">=</span>&nbsp;<span class="num" id="3705259">10</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3705263">dnsTypeWKS</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3705276">=</span>&nbsp;<span class="num" id="3705278">11</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3705282">dnsTypePTR</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3705295">=</span>&nbsp;<span class="num" id="3705297">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3705301">dnsTypeHINFO</span>&nbsp;<span class="op" id="3705314">=</span>&nbsp;<span class="num" id="3705316">13</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3705320">dnsTypeMINFO</span>&nbsp;<span class="op" id="3705333">=</span>&nbsp;<span class="num" id="3705335">14</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3705339">dnsTypeMX</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3705352">=</span>&nbsp;<span class="num" id="3705354">15</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3705358">dnsTypeTXT</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3705371">=</span>&nbsp;<span class="num" id="3705373">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3705377">dnsTypeAAAA</span>&nbsp;&nbsp;<span class="op" id="3705390">=</span>&nbsp;<span class="num" id="3705392">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3705396">dnsTypeSRV</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3705409">=</span>&nbsp;<span class="num" id="3705411">33</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3705416">//&nbsp;valid&nbsp;dnsQuestion.qtype&nbsp;only</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3705449">dnsTypeAXFR</span>&nbsp;&nbsp;<span class="op" id="3705462">=</span>&nbsp;<span class="num" id="3705464">252</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3705469">dnsTypeMAILB</span>&nbsp;<span class="op" id="3705482">=</span>&nbsp;<span class="num" id="3705484">253</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3705489">dnsTypeMAILA</span>&nbsp;<span class="op" id="3705502">=</span>&nbsp;<span class="num" id="3705504">254</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3705509">dnsTypeALL</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3705522">=</span>&nbsp;<span class="num" id="3705524">255</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3705530">//&nbsp;valid&nbsp;dnsQuestion.qclass</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3705559">dnsClassINET</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3705574">=</span>&nbsp;<span class="num" id="3705576">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3705579">dnsClassCSNET</span>&nbsp;&nbsp;<span class="op" id="3705594">=</span>&nbsp;<span class="num" id="3705596">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3705599">dnsClassCHAOS</span>&nbsp;&nbsp;<span class="op" id="3705614">=</span>&nbsp;<span class="num" id="3705616">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3705619">dnsClassHESIOD</span>&nbsp;<span class="op" id="3705634">=</span>&nbsp;<span class="num" id="3705636">4</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3705639">dnsClassANY</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3705654">=</span>&nbsp;<span class="num" id="3705656">255</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3705662">//&nbsp;dnsMsg.rcode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3705679">dnsRcodeSuccess</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3705702">=</span>&nbsp;<span class="num" id="3705704">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3705707">dnsRcodeFormatError</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3705730">=</span>&nbsp;<span class="num" id="3705732">1</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3705735">dnsRcodeServerFailure</span>&nbsp;&nbsp;<span class="op" id="3705758">=</span>&nbsp;<span class="num" id="3705760">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3705763">dnsRcodeNameError</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3705786">=</span>&nbsp;<span class="num" id="3705788">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3705791">dnsRcodeNotImplemented</span>&nbsp;<span class="op" id="3705814">=</span>&nbsp;<span class="num" id="3705816">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3705819">dnsRcodeRefused</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3705842">=</span>&nbsp;<span class="num" id="3705844">5</span><br>
<span class="lineno"></span><span class="op" id="3705846">)</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="comment" id="3705849">//&nbsp;A&nbsp;dnsStruct&nbsp;describes&nbsp;how&nbsp;to&nbsp;iterate&nbsp;over&nbsp;its&nbsp;fields&nbsp;to&nbsp;emulate</span><br>
<span class="lineno"></span><span class="comment" id="3705916">//&nbsp;reflective&nbsp;marshalling.</span><br>
<span class="lineno"></span><span class="keyword" id="3705943">type</span>&nbsp;<span class="ident" id="3705948">dnsStruct</span>&nbsp;<span class="keyword" id="3705958">interface</span>&nbsp;<span class="op" id="3705968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3705971">//&nbsp;Walk&nbsp;iterates&nbsp;over&nbsp;fields&nbsp;of&nbsp;a&nbsp;structure&nbsp;and&nbsp;calls&nbsp;f</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3706028">//&nbsp;with&nbsp;a&nbsp;reference&nbsp;to&nbsp;that&nbsp;field,&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3706086">//&nbsp;and&nbsp;a&nbsp;tag&nbsp;(&#34;&#34;,&nbsp;&#34;domain&#34;,&nbsp;&#34;ipv4&#34;,&nbsp;&#34;ipv6&#34;)&nbsp;specifying</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3706142">//&nbsp;particular&nbsp;encodings.&nbsp;Possible&nbsp;concrete&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3706192">//&nbsp;for&nbsp;v&nbsp;are&nbsp;*uint16,&nbsp;*uint32,&nbsp;*string,&nbsp;or&nbsp;[]byte,&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3706248">//&nbsp;*int,&nbsp;*bool&nbsp;in&nbsp;the&nbsp;case&nbsp;of&nbsp;dnsMsgHdr.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3706290">//&nbsp;Whenever&nbsp;f&nbsp;returns&nbsp;false,&nbsp;Walk&nbsp;must&nbsp;stop&nbsp;and&nbsp;return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3706346">//&nbsp;false,&nbsp;and&nbsp;otherwise&nbsp;return&nbsp;true.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3706384">Walk</span><span class="op" id="3706388">(</span><span class="ident" id="3706389">f</span>&nbsp;<span class="keyword" id="3706391">func</span><span class="op" id="3706395">(</span><span class="ident" id="3706396">v</span>&nbsp;<span class="keyword" id="3706398">interface</span><span class="op" id="3706407">{</span><span class="op" id="3706408">}</span><span class="op" id="3706409">,</span>&nbsp;<span class="ident" id="3706411">name</span><span class="op" id="3706415">,</span>&nbsp;<span class="ident" id="3706417">tag</span>&nbsp;<span class="builtintype" id="3706421">string</span><span class="op" id="3706427">)</span>&nbsp;<span class="op" id="3706429">(</span><span class="ident" id="3706430">ok</span>&nbsp;<span class="builtintype" id="3706433">bool</span><span class="op" id="3706437">)</span><span class="op" id="3706438">)</span>&nbsp;<span class="op" id="3706440">(</span><span class="ident" id="3706441">ok</span>&nbsp;<span class="builtintype" id="3706444">bool</span><span class="op" id="3706448">)</span><br>
<span class="lineno"></span><span class="op" id="3706450">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="3706453">//&nbsp;The&nbsp;wire&nbsp;format&nbsp;for&nbsp;the&nbsp;DNS&nbsp;packet&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="3706499">type</span>&nbsp;<span class="ident" id="3706504">dnsHeader</span>&nbsp;<span class="keyword" id="3706514">struct</span>&nbsp;<span class="op" id="3706521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3706524">Id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3706559">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3706567">Bits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3706602">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3706610">Qdcount</span><span class="op" id="3706617">,</span>&nbsp;<span class="ident" id="3706619">Ancount</span><span class="op" id="3706626">,</span>&nbsp;<span class="ident" id="3706628">Nscount</span><span class="op" id="3706635">,</span>&nbsp;<span class="ident" id="3706637">Arcount</span>&nbsp;<span class="builtintype" id="3706645">uint16</span><br>
<span class="lineno">90</span><span class="op" id="3706652">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3706655">func</span>&nbsp;<span class="op" id="3706660">(</span><span class="ident" id="3706661">h</span>&nbsp;<span class="op" id="3706663">*</span><span class="ident" id="3706664">dnsHeader</span><span class="op" id="3706673">)</span>&nbsp;<span class="ident" id="3706675">Walk</span><span class="op" id="3706679">(</span><span class="ident" id="3706680">f</span>&nbsp;<span class="keyword" id="3706682">func</span><span class="op" id="3706686">(</span><span class="ident" id="3706687">v</span>&nbsp;<span class="keyword" id="3706689">interface</span><span class="op" id="3706698">{</span><span class="op" id="3706699">}</span><span class="op" id="3706700">,</span>&nbsp;<span class="ident" id="3706702">name</span><span class="op" id="3706706">,</span>&nbsp;<span class="ident" id="3706708">tag</span>&nbsp;<span class="builtintype" id="3706712">string</span><span class="op" id="3706718">)</span>&nbsp;<span class="builtintype" id="3706720">bool</span><span class="op" id="3706724">)</span>&nbsp;<span class="builtintype" id="3706726">bool</span>&nbsp;<span class="op" id="3706731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3706734">return</span>&nbsp;<span class="ident" id="3706741">f</span><span class="op" id="3706742">(</span><span class="op" id="3706743">&amp;</span><span class="ident" id="3706744">h</span><span class="op" id="3706745">.</span><span class="ident" id="3706746">Id</span><span class="op" id="3706748">,</span>&nbsp;<span class="string" id="3706750">&#34;Id&#34;</span><span class="op" id="3706754">,</span>&nbsp;<span class="string" id="3706756">&#34;&#34;</span><span class="op" id="3706758">)</span>&nbsp;<span class="op" id="3706760">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3706765">f</span><span class="op" id="3706766">(</span><span class="op" id="3706767">&amp;</span><span class="ident" id="3706768">h</span><span class="op" id="3706769">.</span><span class="ident" id="3706770">Bits</span><span class="op" id="3706774">,</span>&nbsp;<span class="string" id="3706776">&#34;Bits&#34;</span><span class="op" id="3706782">,</span>&nbsp;<span class="string" id="3706784">&#34;&#34;</span><span class="op" id="3706786">)</span>&nbsp;<span class="op" id="3706788">&amp;&amp;</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3706793">f</span><span class="op" id="3706794">(</span><span class="op" id="3706795">&amp;</span><span class="ident" id="3706796">h</span><span class="op" id="3706797">.</span><span class="ident" id="3706798">Qdcount</span><span class="op" id="3706805">,</span>&nbsp;<span class="string" id="3706807">&#34;Qdcount&#34;</span><span class="op" id="3706816">,</span>&nbsp;<span class="string" id="3706818">&#34;&#34;</span><span class="op" id="3706820">)</span>&nbsp;<span class="op" id="3706822">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3706827">f</span><span class="op" id="3706828">(</span><span class="op" id="3706829">&amp;</span><span class="ident" id="3706830">h</span><span class="op" id="3706831">.</span><span class="ident" id="3706832">Ancount</span><span class="op" id="3706839">,</span>&nbsp;<span class="string" id="3706841">&#34;Ancount&#34;</span><span class="op" id="3706850">,</span>&nbsp;<span class="string" id="3706852">&#34;&#34;</span><span class="op" id="3706854">)</span>&nbsp;<span class="op" id="3706856">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3706861">f</span><span class="op" id="3706862">(</span><span class="op" id="3706863">&amp;</span><span class="ident" id="3706864">h</span><span class="op" id="3706865">.</span><span class="ident" id="3706866">Nscount</span><span class="op" id="3706873">,</span>&nbsp;<span class="string" id="3706875">&#34;Nscount&#34;</span><span class="op" id="3706884">,</span>&nbsp;<span class="string" id="3706886">&#34;&#34;</span><span class="op" id="3706888">)</span>&nbsp;<span class="op" id="3706890">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3706895">f</span><span class="op" id="3706896">(</span><span class="op" id="3706897">&amp;</span><span class="ident" id="3706898">h</span><span class="op" id="3706899">.</span><span class="ident" id="3706900">Arcount</span><span class="op" id="3706907">,</span>&nbsp;<span class="string" id="3706909">&#34;Arcount&#34;</span><span class="op" id="3706918">,</span>&nbsp;<span class="string" id="3706920">&#34;&#34;</span><span class="op" id="3706922">)</span><br>
<span class="lineno"></span><span class="op" id="3706924">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="keyword" id="3706927">const</span>&nbsp;<span class="op" id="3706933">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3706936">//&nbsp;dnsHeader.Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3706955">_QR</span>&nbsp;<span class="op" id="3706959">=</span>&nbsp;<span class="num" id="3706961">1</span>&nbsp;<span class="op" id="3706963">&lt;&lt;</span>&nbsp;<span class="num" id="3706966">15</span>&nbsp;<span class="comment" id="3706969">//&nbsp;query/response&nbsp;(response=1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3707001">_AA</span>&nbsp;<span class="op" id="3707005">=</span>&nbsp;<span class="num" id="3707007">1</span>&nbsp;<span class="op" id="3707009">&lt;&lt;</span>&nbsp;<span class="num" id="3707012">10</span>&nbsp;<span class="comment" id="3707015">//&nbsp;authoritative</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3707033">_TC</span>&nbsp;<span class="op" id="3707037">=</span>&nbsp;<span class="num" id="3707039">1</span>&nbsp;<span class="op" id="3707041">&lt;&lt;</span>&nbsp;<span class="num" id="3707044">9</span>&nbsp;&nbsp;<span class="comment" id="3707047">//&nbsp;truncated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3707061">_RD</span>&nbsp;<span class="op" id="3707065">=</span>&nbsp;<span class="num" id="3707067">1</span>&nbsp;<span class="op" id="3707069">&lt;&lt;</span>&nbsp;<span class="num" id="3707072">8</span>&nbsp;&nbsp;<span class="comment" id="3707075">//&nbsp;recursion&nbsp;desired</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3707097">_RA</span>&nbsp;<span class="op" id="3707101">=</span>&nbsp;<span class="num" id="3707103">1</span>&nbsp;<span class="op" id="3707105">&lt;&lt;</span>&nbsp;<span class="num" id="3707108">7</span>&nbsp;&nbsp;<span class="comment" id="3707111">//&nbsp;recursion&nbsp;available</span><br>
<span class="lineno"></span><span class="op" id="3707134">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="comment" id="3707137">//&nbsp;DNS&nbsp;queries.</span><br>
<span class="lineno"></span><span class="keyword" id="3707153">type</span>&nbsp;<span class="ident" id="3707158">dnsQuestion</span>&nbsp;<span class="keyword" id="3707170">struct</span>&nbsp;<span class="op" id="3707177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3707180">Name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3707187">string</span>&nbsp;<span class="string" id="3707194">`net:&#34;domain-name&#34;`</span>&nbsp;<span class="comment" id="3707214">//&nbsp;`net:&#34;domain-name&#34;`&nbsp;specifies&nbsp;encoding;&nbsp;see&nbsp;packers&nbsp;below</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3707276">Qtype</span>&nbsp;&nbsp;<span class="builtintype" id="3707283">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3707291">Qclass</span>&nbsp;<span class="builtintype" id="3707298">uint16</span><br>
<span class="lineno">115</span><span class="op" id="3707305">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3707308">func</span>&nbsp;<span class="op" id="3707313">(</span><span class="ident" id="3707314">q</span>&nbsp;<span class="op" id="3707316">*</span><span class="ident" id="3707317">dnsQuestion</span><span class="op" id="3707328">)</span>&nbsp;<span class="ident" id="3707330">Walk</span><span class="op" id="3707334">(</span><span class="ident" id="3707335">f</span>&nbsp;<span class="keyword" id="3707337">func</span><span class="op" id="3707341">(</span><span class="ident" id="3707342">v</span>&nbsp;<span class="keyword" id="3707344">interface</span><span class="op" id="3707353">{</span><span class="op" id="3707354">}</span><span class="op" id="3707355">,</span>&nbsp;<span class="ident" id="3707357">name</span><span class="op" id="3707361">,</span>&nbsp;<span class="ident" id="3707363">tag</span>&nbsp;<span class="builtintype" id="3707367">string</span><span class="op" id="3707373">)</span>&nbsp;<span class="builtintype" id="3707375">bool</span><span class="op" id="3707379">)</span>&nbsp;<span class="builtintype" id="3707381">bool</span>&nbsp;<span class="op" id="3707386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3707389">return</span>&nbsp;<span class="ident" id="3707396">f</span><span class="op" id="3707397">(</span><span class="op" id="3707398">&amp;</span><span class="ident" id="3707399">q</span><span class="op" id="3707400">.</span><span class="ident" id="3707401">Name</span><span class="op" id="3707405">,</span>&nbsp;<span class="string" id="3707407">&#34;Name&#34;</span><span class="op" id="3707413">,</span>&nbsp;<span class="string" id="3707415">&#34;domain&#34;</span><span class="op" id="3707423">)</span>&nbsp;<span class="op" id="3707425">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3707430">f</span><span class="op" id="3707431">(</span><span class="op" id="3707432">&amp;</span><span class="ident" id="3707433">q</span><span class="op" id="3707434">.</span><span class="ident" id="3707435">Qtype</span><span class="op" id="3707440">,</span>&nbsp;<span class="string" id="3707442">&#34;Qtype&#34;</span><span class="op" id="3707449">,</span>&nbsp;<span class="string" id="3707451">&#34;&#34;</span><span class="op" id="3707453">)</span>&nbsp;<span class="op" id="3707455">&amp;&amp;</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3707460">f</span><span class="op" id="3707461">(</span><span class="op" id="3707462">&amp;</span><span class="ident" id="3707463">q</span><span class="op" id="3707464">.</span><span class="ident" id="3707465">Qclass</span><span class="op" id="3707471">,</span>&nbsp;<span class="string" id="3707473">&#34;Qclass&#34;</span><span class="op" id="3707481">,</span>&nbsp;<span class="string" id="3707483">&#34;&#34;</span><span class="op" id="3707485">)</span><br>
<span class="lineno"></span><span class="op" id="3707487">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3707490">//&nbsp;DNS&nbsp;responses&nbsp;(resource&nbsp;records).</span><br>
<span class="lineno"></span><span class="comment" id="3707527">//&nbsp;There&nbsp;are&nbsp;many&nbsp;types&nbsp;of&nbsp;messages,</span><br>
<span class="lineno">125</span><span class="comment" id="3707564">//&nbsp;but&nbsp;they&nbsp;all&nbsp;share&nbsp;the&nbsp;same&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="3707603">type</span>&nbsp;<span class="ident" id="3707608">dnsRR_Header</span>&nbsp;<span class="keyword" id="3707621">struct</span>&nbsp;<span class="op" id="3707628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3707631">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3707640">string</span>&nbsp;<span class="string" id="3707647">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3707668">Rrtype</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3707677">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3707685">Class</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3707694">uint16</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3707702">Ttl</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3707711">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3707719">Rdlength</span>&nbsp;<span class="builtintype" id="3707728">uint16</span>&nbsp;<span class="comment" id="3707735">//&nbsp;length&nbsp;of&nbsp;data&nbsp;after&nbsp;header</span><br>
<span class="lineno"></span><span class="op" id="3707766">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3707769">func</span>&nbsp;<span class="op" id="3707774">(</span><span class="ident" id="3707775">h</span>&nbsp;<span class="op" id="3707777">*</span><span class="ident" id="3707778">dnsRR_Header</span><span class="op" id="3707790">)</span>&nbsp;<span class="ident" id="3707792">Header</span><span class="op" id="3707798">(</span><span class="op" id="3707799">)</span>&nbsp;<span class="op" id="3707801">*</span><span class="ident" id="3707802">dnsRR_Header</span>&nbsp;<span class="op" id="3707815">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3707818">return</span>&nbsp;<span class="ident" id="3707825">h</span><br>
<span class="lineno"></span><span class="op" id="3707827">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3707830">func</span>&nbsp;<span class="op" id="3707835">(</span><span class="ident" id="3707836">h</span>&nbsp;<span class="op" id="3707838">*</span><span class="ident" id="3707839">dnsRR_Header</span><span class="op" id="3707851">)</span>&nbsp;<span class="ident" id="3707853">Walk</span><span class="op" id="3707857">(</span><span class="ident" id="3707858">f</span>&nbsp;<span class="keyword" id="3707860">func</span><span class="op" id="3707864">(</span><span class="ident" id="3707865">v</span>&nbsp;<span class="keyword" id="3707867">interface</span><span class="op" id="3707876">{</span><span class="op" id="3707877">}</span><span class="op" id="3707878">,</span>&nbsp;<span class="ident" id="3707880">name</span><span class="op" id="3707884">,</span>&nbsp;<span class="ident" id="3707886">tag</span>&nbsp;<span class="builtintype" id="3707890">string</span><span class="op" id="3707896">)</span>&nbsp;<span class="builtintype" id="3707898">bool</span><span class="op" id="3707902">)</span>&nbsp;<span class="builtintype" id="3707904">bool</span>&nbsp;<span class="op" id="3707909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3707912">return</span>&nbsp;<span class="ident" id="3707919">f</span><span class="op" id="3707920">(</span><span class="op" id="3707921">&amp;</span><span class="ident" id="3707922">h</span><span class="op" id="3707923">.</span><span class="ident" id="3707924">Name</span><span class="op" id="3707928">,</span>&nbsp;<span class="string" id="3707930">&#34;Name&#34;</span><span class="op" id="3707936">,</span>&nbsp;<span class="string" id="3707938">&#34;domain&#34;</span><span class="op" id="3707946">)</span>&nbsp;<span class="op" id="3707948">&amp;&amp;</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3707953">f</span><span class="op" id="3707954">(</span><span class="op" id="3707955">&amp;</span><span class="ident" id="3707956">h</span><span class="op" id="3707957">.</span><span class="ident" id="3707958">Rrtype</span><span class="op" id="3707964">,</span>&nbsp;<span class="string" id="3707966">&#34;Rrtype&#34;</span><span class="op" id="3707974">,</span>&nbsp;<span class="string" id="3707976">&#34;&#34;</span><span class="op" id="3707978">)</span>&nbsp;<span class="op" id="3707980">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3707985">f</span><span class="op" id="3707986">(</span><span class="op" id="3707987">&amp;</span><span class="ident" id="3707988">h</span><span class="op" id="3707989">.</span><span class="ident" id="3707990">Class</span><span class="op" id="3707995">,</span>&nbsp;<span class="string" id="3707997">&#34;Class&#34;</span><span class="op" id="3708004">,</span>&nbsp;<span class="string" id="3708006">&#34;&#34;</span><span class="op" id="3708008">)</span>&nbsp;<span class="op" id="3708010">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3708015">f</span><span class="op" id="3708016">(</span><span class="op" id="3708017">&amp;</span><span class="ident" id="3708018">h</span><span class="op" id="3708019">.</span><span class="ident" id="3708020">Ttl</span><span class="op" id="3708023">,</span>&nbsp;<span class="string" id="3708025">&#34;Ttl&#34;</span><span class="op" id="3708030">,</span>&nbsp;<span class="string" id="3708032">&#34;&#34;</span><span class="op" id="3708034">)</span>&nbsp;<span class="op" id="3708036">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3708041">f</span><span class="op" id="3708042">(</span><span class="op" id="3708043">&amp;</span><span class="ident" id="3708044">h</span><span class="op" id="3708045">.</span><span class="ident" id="3708046">Rdlength</span><span class="op" id="3708054">,</span>&nbsp;<span class="string" id="3708056">&#34;Rdlength&#34;</span><span class="op" id="3708066">,</span>&nbsp;<span class="string" id="3708068">&#34;&#34;</span><span class="op" id="3708070">)</span><br>
<span class="lineno"></span><span class="op" id="3708072">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="keyword" id="3708075">type</span>&nbsp;<span class="ident" id="3708080">dnsRR</span>&nbsp;<span class="keyword" id="3708086">interface</span>&nbsp;<span class="op" id="3708096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3708099">dnsStruct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3708110">Header</span><span class="op" id="3708116">(</span><span class="op" id="3708117">)</span>&nbsp;<span class="op" id="3708119">*</span><span class="ident" id="3708120">dnsRR_Header</span><br>
<span class="lineno"></span><span class="op" id="3708133">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="comment" id="3708136">//&nbsp;Specific&nbsp;DNS&nbsp;RR&nbsp;formats&nbsp;for&nbsp;each&nbsp;query&nbsp;type.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3708185">type</span>&nbsp;<span class="ident" id="3708190">dnsRR_CNAME</span>&nbsp;<span class="keyword" id="3708202">struct</span>&nbsp;<span class="op" id="3708209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3708212">Hdr</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3708218">dnsRR_Header</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3708232">Cname</span>&nbsp;<span class="builtintype" id="3708238">string</span>&nbsp;<span class="string" id="3708245">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3708265">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3708268">func</span>&nbsp;<span class="op" id="3708273">(</span><span class="ident" id="3708274">rr</span>&nbsp;<span class="op" id="3708277">*</span><span class="ident" id="3708278">dnsRR_CNAME</span><span class="op" id="3708289">)</span>&nbsp;<span class="ident" id="3708291">Header</span><span class="op" id="3708297">(</span><span class="op" id="3708298">)</span>&nbsp;<span class="op" id="3708300">*</span><span class="ident" id="3708301">dnsRR_Header</span>&nbsp;<span class="op" id="3708314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3708317">return</span>&nbsp;<span class="op" id="3708324">&amp;</span><span class="ident" id="3708325">rr</span><span class="op" id="3708327">.</span><span class="ident" id="3708328">Hdr</span><br>
<span class="lineno">160</span><span class="op" id="3708332">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3708335">func</span>&nbsp;<span class="op" id="3708340">(</span><span class="ident" id="3708341">rr</span>&nbsp;<span class="op" id="3708344">*</span><span class="ident" id="3708345">dnsRR_CNAME</span><span class="op" id="3708356">)</span>&nbsp;<span class="ident" id="3708358">Walk</span><span class="op" id="3708362">(</span><span class="ident" id="3708363">f</span>&nbsp;<span class="keyword" id="3708365">func</span><span class="op" id="3708369">(</span><span class="ident" id="3708370">v</span>&nbsp;<span class="keyword" id="3708372">interface</span><span class="op" id="3708381">{</span><span class="op" id="3708382">}</span><span class="op" id="3708383">,</span>&nbsp;<span class="ident" id="3708385">name</span><span class="op" id="3708389">,</span>&nbsp;<span class="ident" id="3708391">tag</span>&nbsp;<span class="builtintype" id="3708395">string</span><span class="op" id="3708401">)</span>&nbsp;<span class="builtintype" id="3708403">bool</span><span class="op" id="3708407">)</span>&nbsp;<span class="builtintype" id="3708409">bool</span>&nbsp;<span class="op" id="3708414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3708417">return</span>&nbsp;<span class="ident" id="3708424">rr</span><span class="op" id="3708426">.</span><span class="ident" id="3708427">Hdr</span><span class="op" id="3708430">.</span><span class="ident" id="3708431">Walk</span><span class="op" id="3708435">(</span><span class="ident" id="3708436">f</span><span class="op" id="3708437">)</span>&nbsp;<span class="op" id="3708439">&amp;&amp;</span>&nbsp;<span class="ident" id="3708442">f</span><span class="op" id="3708443">(</span><span class="op" id="3708444">&amp;</span><span class="ident" id="3708445">rr</span><span class="op" id="3708447">.</span><span class="ident" id="3708448">Cname</span><span class="op" id="3708453">,</span>&nbsp;<span class="string" id="3708455">&#34;Cname&#34;</span><span class="op" id="3708462">,</span>&nbsp;<span class="string" id="3708464">&#34;domain&#34;</span><span class="op" id="3708472">)</span><br>
<span class="lineno"></span><span class="op" id="3708474">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="keyword" id="3708477">type</span>&nbsp;<span class="ident" id="3708482">dnsRR_HINFO</span>&nbsp;<span class="keyword" id="3708494">struct</span>&nbsp;<span class="op" id="3708501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3708504">Hdr</span>&nbsp;<span class="ident" id="3708508">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3708522">Cpu</span>&nbsp;<span class="builtintype" id="3708526">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3708534">Os</span>&nbsp;&nbsp;<span class="builtintype" id="3708538">string</span><br>
<span class="lineno">170</span><span class="op" id="3708545">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3708548">func</span>&nbsp;<span class="op" id="3708553">(</span><span class="ident" id="3708554">rr</span>&nbsp;<span class="op" id="3708557">*</span><span class="ident" id="3708558">dnsRR_HINFO</span><span class="op" id="3708569">)</span>&nbsp;<span class="ident" id="3708571">Header</span><span class="op" id="3708577">(</span><span class="op" id="3708578">)</span>&nbsp;<span class="op" id="3708580">*</span><span class="ident" id="3708581">dnsRR_Header</span>&nbsp;<span class="op" id="3708594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3708597">return</span>&nbsp;<span class="op" id="3708604">&amp;</span><span class="ident" id="3708605">rr</span><span class="op" id="3708607">.</span><span class="ident" id="3708608">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3708612">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="3708615">func</span>&nbsp;<span class="op" id="3708620">(</span><span class="ident" id="3708621">rr</span>&nbsp;<span class="op" id="3708624">*</span><span class="ident" id="3708625">dnsRR_HINFO</span><span class="op" id="3708636">)</span>&nbsp;<span class="ident" id="3708638">Walk</span><span class="op" id="3708642">(</span><span class="ident" id="3708643">f</span>&nbsp;<span class="keyword" id="3708645">func</span><span class="op" id="3708649">(</span><span class="ident" id="3708650">v</span>&nbsp;<span class="keyword" id="3708652">interface</span><span class="op" id="3708661">{</span><span class="op" id="3708662">}</span><span class="op" id="3708663">,</span>&nbsp;<span class="ident" id="3708665">name</span><span class="op" id="3708669">,</span>&nbsp;<span class="ident" id="3708671">tag</span>&nbsp;<span class="builtintype" id="3708675">string</span><span class="op" id="3708681">)</span>&nbsp;<span class="builtintype" id="3708683">bool</span><span class="op" id="3708687">)</span>&nbsp;<span class="builtintype" id="3708689">bool</span>&nbsp;<span class="op" id="3708694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3708697">return</span>&nbsp;<span class="ident" id="3708704">rr</span><span class="op" id="3708706">.</span><span class="ident" id="3708707">Hdr</span><span class="op" id="3708710">.</span><span class="ident" id="3708711">Walk</span><span class="op" id="3708715">(</span><span class="ident" id="3708716">f</span><span class="op" id="3708717">)</span>&nbsp;<span class="op" id="3708719">&amp;&amp;</span>&nbsp;<span class="ident" id="3708722">f</span><span class="op" id="3708723">(</span><span class="op" id="3708724">&amp;</span><span class="ident" id="3708725">rr</span><span class="op" id="3708727">.</span><span class="ident" id="3708728">Cpu</span><span class="op" id="3708731">,</span>&nbsp;<span class="string" id="3708733">&#34;Cpu&#34;</span><span class="op" id="3708738">,</span>&nbsp;<span class="string" id="3708740">&#34;&#34;</span><span class="op" id="3708742">)</span>&nbsp;<span class="op" id="3708744">&amp;&amp;</span>&nbsp;<span class="ident" id="3708747">f</span><span class="op" id="3708748">(</span><span class="op" id="3708749">&amp;</span><span class="ident" id="3708750">rr</span><span class="op" id="3708752">.</span><span class="ident" id="3708753">Os</span><span class="op" id="3708755">,</span>&nbsp;<span class="string" id="3708757">&#34;Os&#34;</span><span class="op" id="3708761">,</span>&nbsp;<span class="string" id="3708763">&#34;&#34;</span><span class="op" id="3708765">)</span><br>
<span class="lineno"></span><span class="op" id="3708767">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="keyword" id="3708770">type</span>&nbsp;<span class="ident" id="3708775">dnsRR_MB</span>&nbsp;<span class="keyword" id="3708784">struct</span>&nbsp;<span class="op" id="3708791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3708794">Hdr</span>&nbsp;<span class="ident" id="3708798">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3708812">Mb</span>&nbsp;&nbsp;<span class="builtintype" id="3708816">string</span>&nbsp;<span class="string" id="3708823">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3708843">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="3708846">func</span>&nbsp;<span class="op" id="3708851">(</span><span class="ident" id="3708852">rr</span>&nbsp;<span class="op" id="3708855">*</span><span class="ident" id="3708856">dnsRR_MB</span><span class="op" id="3708864">)</span>&nbsp;<span class="ident" id="3708866">Header</span><span class="op" id="3708872">(</span><span class="op" id="3708873">)</span>&nbsp;<span class="op" id="3708875">*</span><span class="ident" id="3708876">dnsRR_Header</span>&nbsp;<span class="op" id="3708889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3708892">return</span>&nbsp;<span class="op" id="3708899">&amp;</span><span class="ident" id="3708900">rr</span><span class="op" id="3708902">.</span><span class="ident" id="3708903">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3708907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3708910">func</span>&nbsp;<span class="op" id="3708915">(</span><span class="ident" id="3708916">rr</span>&nbsp;<span class="op" id="3708919">*</span><span class="ident" id="3708920">dnsRR_MB</span><span class="op" id="3708928">)</span>&nbsp;<span class="ident" id="3708930">Walk</span><span class="op" id="3708934">(</span><span class="ident" id="3708935">f</span>&nbsp;<span class="keyword" id="3708937">func</span><span class="op" id="3708941">(</span><span class="ident" id="3708942">v</span>&nbsp;<span class="keyword" id="3708944">interface</span><span class="op" id="3708953">{</span><span class="op" id="3708954">}</span><span class="op" id="3708955">,</span>&nbsp;<span class="ident" id="3708957">name</span><span class="op" id="3708961">,</span>&nbsp;<span class="ident" id="3708963">tag</span>&nbsp;<span class="builtintype" id="3708967">string</span><span class="op" id="3708973">)</span>&nbsp;<span class="builtintype" id="3708975">bool</span><span class="op" id="3708979">)</span>&nbsp;<span class="builtintype" id="3708981">bool</span>&nbsp;<span class="op" id="3708986">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3708989">return</span>&nbsp;<span class="ident" id="3708996">rr</span><span class="op" id="3708998">.</span><span class="ident" id="3708999">Hdr</span><span class="op" id="3709002">.</span><span class="ident" id="3709003">Walk</span><span class="op" id="3709007">(</span><span class="ident" id="3709008">f</span><span class="op" id="3709009">)</span>&nbsp;<span class="op" id="3709011">&amp;&amp;</span>&nbsp;<span class="ident" id="3709014">f</span><span class="op" id="3709015">(</span><span class="op" id="3709016">&amp;</span><span class="ident" id="3709017">rr</span><span class="op" id="3709019">.</span><span class="ident" id="3709020">Mb</span><span class="op" id="3709022">,</span>&nbsp;<span class="string" id="3709024">&#34;Mb&#34;</span><span class="op" id="3709028">,</span>&nbsp;<span class="string" id="3709030">&#34;domain&#34;</span><span class="op" id="3709038">)</span><br>
<span class="lineno"></span><span class="op" id="3709040">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3709043">type</span>&nbsp;<span class="ident" id="3709048">dnsRR_MG</span>&nbsp;<span class="keyword" id="3709057">struct</span>&nbsp;<span class="op" id="3709064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3709067">Hdr</span>&nbsp;<span class="ident" id="3709071">dnsRR_Header</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3709085">Mg</span>&nbsp;&nbsp;<span class="builtintype" id="3709089">string</span>&nbsp;<span class="string" id="3709096">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3709116">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3709119">func</span>&nbsp;<span class="op" id="3709124">(</span><span class="ident" id="3709125">rr</span>&nbsp;<span class="op" id="3709128">*</span><span class="ident" id="3709129">dnsRR_MG</span><span class="op" id="3709137">)</span>&nbsp;<span class="ident" id="3709139">Header</span><span class="op" id="3709145">(</span><span class="op" id="3709146">)</span>&nbsp;<span class="op" id="3709148">*</span><span class="ident" id="3709149">dnsRR_Header</span>&nbsp;<span class="op" id="3709162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3709165">return</span>&nbsp;<span class="op" id="3709172">&amp;</span><span class="ident" id="3709173">rr</span><span class="op" id="3709175">.</span><span class="ident" id="3709176">Hdr</span><br>
<span class="lineno">200</span><span class="op" id="3709180">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3709183">func</span>&nbsp;<span class="op" id="3709188">(</span><span class="ident" id="3709189">rr</span>&nbsp;<span class="op" id="3709192">*</span><span class="ident" id="3709193">dnsRR_MG</span><span class="op" id="3709201">)</span>&nbsp;<span class="ident" id="3709203">Walk</span><span class="op" id="3709207">(</span><span class="ident" id="3709208">f</span>&nbsp;<span class="keyword" id="3709210">func</span><span class="op" id="3709214">(</span><span class="ident" id="3709215">v</span>&nbsp;<span class="keyword" id="3709217">interface</span><span class="op" id="3709226">{</span><span class="op" id="3709227">}</span><span class="op" id="3709228">,</span>&nbsp;<span class="ident" id="3709230">name</span><span class="op" id="3709234">,</span>&nbsp;<span class="ident" id="3709236">tag</span>&nbsp;<span class="builtintype" id="3709240">string</span><span class="op" id="3709246">)</span>&nbsp;<span class="builtintype" id="3709248">bool</span><span class="op" id="3709252">)</span>&nbsp;<span class="builtintype" id="3709254">bool</span>&nbsp;<span class="op" id="3709259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3709262">return</span>&nbsp;<span class="ident" id="3709269">rr</span><span class="op" id="3709271">.</span><span class="ident" id="3709272">Hdr</span><span class="op" id="3709275">.</span><span class="ident" id="3709276">Walk</span><span class="op" id="3709280">(</span><span class="ident" id="3709281">f</span><span class="op" id="3709282">)</span>&nbsp;<span class="op" id="3709284">&amp;&amp;</span>&nbsp;<span class="ident" id="3709287">f</span><span class="op" id="3709288">(</span><span class="op" id="3709289">&amp;</span><span class="ident" id="3709290">rr</span><span class="op" id="3709292">.</span><span class="ident" id="3709293">Mg</span><span class="op" id="3709295">,</span>&nbsp;<span class="string" id="3709297">&#34;Mg&#34;</span><span class="op" id="3709301">,</span>&nbsp;<span class="string" id="3709303">&#34;domain&#34;</span><span class="op" id="3709311">)</span><br>
<span class="lineno"></span><span class="op" id="3709313">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="keyword" id="3709316">type</span>&nbsp;<span class="ident" id="3709321">dnsRR_MINFO</span>&nbsp;<span class="keyword" id="3709333">struct</span>&nbsp;<span class="op" id="3709340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3709343">Hdr</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3709349">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3709363">Rmail</span>&nbsp;<span class="builtintype" id="3709369">string</span>&nbsp;<span class="string" id="3709376">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3709397">Email</span>&nbsp;<span class="builtintype" id="3709403">string</span>&nbsp;<span class="string" id="3709410">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno">210</span><span class="op" id="3709430">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3709433">func</span>&nbsp;<span class="op" id="3709438">(</span><span class="ident" id="3709439">rr</span>&nbsp;<span class="op" id="3709442">*</span><span class="ident" id="3709443">dnsRR_MINFO</span><span class="op" id="3709454">)</span>&nbsp;<span class="ident" id="3709456">Header</span><span class="op" id="3709462">(</span><span class="op" id="3709463">)</span>&nbsp;<span class="op" id="3709465">*</span><span class="ident" id="3709466">dnsRR_Header</span>&nbsp;<span class="op" id="3709479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3709482">return</span>&nbsp;<span class="op" id="3709489">&amp;</span><span class="ident" id="3709490">rr</span><span class="op" id="3709492">.</span><span class="ident" id="3709493">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3709497">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="keyword" id="3709500">func</span>&nbsp;<span class="op" id="3709505">(</span><span class="ident" id="3709506">rr</span>&nbsp;<span class="op" id="3709509">*</span><span class="ident" id="3709510">dnsRR_MINFO</span><span class="op" id="3709521">)</span>&nbsp;<span class="ident" id="3709523">Walk</span><span class="op" id="3709527">(</span><span class="ident" id="3709528">f</span>&nbsp;<span class="keyword" id="3709530">func</span><span class="op" id="3709534">(</span><span class="ident" id="3709535">v</span>&nbsp;<span class="keyword" id="3709537">interface</span><span class="op" id="3709546">{</span><span class="op" id="3709547">}</span><span class="op" id="3709548">,</span>&nbsp;<span class="ident" id="3709550">name</span><span class="op" id="3709554">,</span>&nbsp;<span class="ident" id="3709556">tag</span>&nbsp;<span class="builtintype" id="3709560">string</span><span class="op" id="3709566">)</span>&nbsp;<span class="builtintype" id="3709568">bool</span><span class="op" id="3709572">)</span>&nbsp;<span class="builtintype" id="3709574">bool</span>&nbsp;<span class="op" id="3709579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3709582">return</span>&nbsp;<span class="ident" id="3709589">rr</span><span class="op" id="3709591">.</span><span class="ident" id="3709592">Hdr</span><span class="op" id="3709595">.</span><span class="ident" id="3709596">Walk</span><span class="op" id="3709600">(</span><span class="ident" id="3709601">f</span><span class="op" id="3709602">)</span>&nbsp;<span class="op" id="3709604">&amp;&amp;</span>&nbsp;<span class="ident" id="3709607">f</span><span class="op" id="3709608">(</span><span class="op" id="3709609">&amp;</span><span class="ident" id="3709610">rr</span><span class="op" id="3709612">.</span><span class="ident" id="3709613">Rmail</span><span class="op" id="3709618">,</span>&nbsp;<span class="string" id="3709620">&#34;Rmail&#34;</span><span class="op" id="3709627">,</span>&nbsp;<span class="string" id="3709629">&#34;domain&#34;</span><span class="op" id="3709637">)</span>&nbsp;<span class="op" id="3709639">&amp;&amp;</span>&nbsp;<span class="ident" id="3709642">f</span><span class="op" id="3709643">(</span><span class="op" id="3709644">&amp;</span><span class="ident" id="3709645">rr</span><span class="op" id="3709647">.</span><span class="ident" id="3709648">Email</span><span class="op" id="3709653">,</span>&nbsp;<span class="string" id="3709655">&#34;Email&#34;</span><span class="op" id="3709662">,</span>&nbsp;<span class="string" id="3709664">&#34;domain&#34;</span><span class="op" id="3709672">)</span><br>
<span class="lineno"></span><span class="op" id="3709674">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="keyword" id="3709677">type</span>&nbsp;<span class="ident" id="3709682">dnsRR_MR</span>&nbsp;<span class="keyword" id="3709691">struct</span>&nbsp;<span class="op" id="3709698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3709701">Hdr</span>&nbsp;<span class="ident" id="3709705">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3709719">Mr</span>&nbsp;&nbsp;<span class="builtintype" id="3709723">string</span>&nbsp;<span class="string" id="3709730">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3709750">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span><span class="keyword" id="3709753">func</span>&nbsp;<span class="op" id="3709758">(</span><span class="ident" id="3709759">rr</span>&nbsp;<span class="op" id="3709762">*</span><span class="ident" id="3709763">dnsRR_MR</span><span class="op" id="3709771">)</span>&nbsp;<span class="ident" id="3709773">Header</span><span class="op" id="3709779">(</span><span class="op" id="3709780">)</span>&nbsp;<span class="op" id="3709782">*</span><span class="ident" id="3709783">dnsRR_Header</span>&nbsp;<span class="op" id="3709796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3709799">return</span>&nbsp;<span class="op" id="3709806">&amp;</span><span class="ident" id="3709807">rr</span><span class="op" id="3709809">.</span><span class="ident" id="3709810">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3709814">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3709817">func</span>&nbsp;<span class="op" id="3709822">(</span><span class="ident" id="3709823">rr</span>&nbsp;<span class="op" id="3709826">*</span><span class="ident" id="3709827">dnsRR_MR</span><span class="op" id="3709835">)</span>&nbsp;<span class="ident" id="3709837">Walk</span><span class="op" id="3709841">(</span><span class="ident" id="3709842">f</span>&nbsp;<span class="keyword" id="3709844">func</span><span class="op" id="3709848">(</span><span class="ident" id="3709849">v</span>&nbsp;<span class="keyword" id="3709851">interface</span><span class="op" id="3709860">{</span><span class="op" id="3709861">}</span><span class="op" id="3709862">,</span>&nbsp;<span class="ident" id="3709864">name</span><span class="op" id="3709868">,</span>&nbsp;<span class="ident" id="3709870">tag</span>&nbsp;<span class="builtintype" id="3709874">string</span><span class="op" id="3709880">)</span>&nbsp;<span class="builtintype" id="3709882">bool</span><span class="op" id="3709886">)</span>&nbsp;<span class="builtintype" id="3709888">bool</span>&nbsp;<span class="op" id="3709893">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3709896">return</span>&nbsp;<span class="ident" id="3709903">rr</span><span class="op" id="3709905">.</span><span class="ident" id="3709906">Hdr</span><span class="op" id="3709909">.</span><span class="ident" id="3709910">Walk</span><span class="op" id="3709914">(</span><span class="ident" id="3709915">f</span><span class="op" id="3709916">)</span>&nbsp;<span class="op" id="3709918">&amp;&amp;</span>&nbsp;<span class="ident" id="3709921">f</span><span class="op" id="3709922">(</span><span class="op" id="3709923">&amp;</span><span class="ident" id="3709924">rr</span><span class="op" id="3709926">.</span><span class="ident" id="3709927">Mr</span><span class="op" id="3709929">,</span>&nbsp;<span class="string" id="3709931">&#34;Mr&#34;</span><span class="op" id="3709935">,</span>&nbsp;<span class="string" id="3709937">&#34;domain&#34;</span><span class="op" id="3709945">)</span><br>
<span class="lineno"></span><span class="op" id="3709947">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3709950">type</span>&nbsp;<span class="ident" id="3709955">dnsRR_MX</span>&nbsp;<span class="keyword" id="3709964">struct</span>&nbsp;<span class="op" id="3709971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3709974">Hdr</span>&nbsp;&nbsp;<span class="ident" id="3709979">dnsRR_Header</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3709993">Pref</span>&nbsp;<span class="builtintype" id="3709998">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3710006">Mx</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3710011">string</span>&nbsp;<span class="string" id="3710018">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3710038">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3710041">func</span>&nbsp;<span class="op" id="3710046">(</span><span class="ident" id="3710047">rr</span>&nbsp;<span class="op" id="3710050">*</span><span class="ident" id="3710051">dnsRR_MX</span><span class="op" id="3710059">)</span>&nbsp;<span class="ident" id="3710061">Header</span><span class="op" id="3710067">(</span><span class="op" id="3710068">)</span>&nbsp;<span class="op" id="3710070">*</span><span class="ident" id="3710071">dnsRR_Header</span>&nbsp;<span class="op" id="3710084">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3710087">return</span>&nbsp;<span class="op" id="3710094">&amp;</span><span class="ident" id="3710095">rr</span><span class="op" id="3710097">.</span><span class="ident" id="3710098">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3710102">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3710105">func</span>&nbsp;<span class="op" id="3710110">(</span><span class="ident" id="3710111">rr</span>&nbsp;<span class="op" id="3710114">*</span><span class="ident" id="3710115">dnsRR_MX</span><span class="op" id="3710123">)</span>&nbsp;<span class="ident" id="3710125">Walk</span><span class="op" id="3710129">(</span><span class="ident" id="3710130">f</span>&nbsp;<span class="keyword" id="3710132">func</span><span class="op" id="3710136">(</span><span class="ident" id="3710137">v</span>&nbsp;<span class="keyword" id="3710139">interface</span><span class="op" id="3710148">{</span><span class="op" id="3710149">}</span><span class="op" id="3710150">,</span>&nbsp;<span class="ident" id="3710152">name</span><span class="op" id="3710156">,</span>&nbsp;<span class="ident" id="3710158">tag</span>&nbsp;<span class="builtintype" id="3710162">string</span><span class="op" id="3710168">)</span>&nbsp;<span class="builtintype" id="3710170">bool</span><span class="op" id="3710174">)</span>&nbsp;<span class="builtintype" id="3710176">bool</span>&nbsp;<span class="op" id="3710181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3710184">return</span>&nbsp;<span class="ident" id="3710191">rr</span><span class="op" id="3710193">.</span><span class="ident" id="3710194">Hdr</span><span class="op" id="3710197">.</span><span class="ident" id="3710198">Walk</span><span class="op" id="3710202">(</span><span class="ident" id="3710203">f</span><span class="op" id="3710204">)</span>&nbsp;<span class="op" id="3710206">&amp;&amp;</span>&nbsp;<span class="ident" id="3710209">f</span><span class="op" id="3710210">(</span><span class="op" id="3710211">&amp;</span><span class="ident" id="3710212">rr</span><span class="op" id="3710214">.</span><span class="ident" id="3710215">Pref</span><span class="op" id="3710219">,</span>&nbsp;<span class="string" id="3710221">&#34;Pref&#34;</span><span class="op" id="3710227">,</span>&nbsp;<span class="string" id="3710229">&#34;&#34;</span><span class="op" id="3710231">)</span>&nbsp;<span class="op" id="3710233">&amp;&amp;</span>&nbsp;<span class="ident" id="3710236">f</span><span class="op" id="3710237">(</span><span class="op" id="3710238">&amp;</span><span class="ident" id="3710239">rr</span><span class="op" id="3710241">.</span><span class="ident" id="3710242">Mx</span><span class="op" id="3710244">,</span>&nbsp;<span class="string" id="3710246">&#34;Mx&#34;</span><span class="op" id="3710250">,</span>&nbsp;<span class="string" id="3710252">&#34;domain&#34;</span><span class="op" id="3710260">)</span><br>
<span class="lineno">245</span><span class="op" id="3710262">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3710265">type</span>&nbsp;<span class="ident" id="3710270">dnsRR_NS</span>&nbsp;<span class="keyword" id="3710279">struct</span>&nbsp;<span class="op" id="3710286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3710289">Hdr</span>&nbsp;<span class="ident" id="3710293">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3710307">Ns</span>&nbsp;&nbsp;<span class="builtintype" id="3710311">string</span>&nbsp;<span class="string" id="3710318">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno">250</span><span class="op" id="3710338">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3710341">func</span>&nbsp;<span class="op" id="3710346">(</span><span class="ident" id="3710347">rr</span>&nbsp;<span class="op" id="3710350">*</span><span class="ident" id="3710351">dnsRR_NS</span><span class="op" id="3710359">)</span>&nbsp;<span class="ident" id="3710361">Header</span><span class="op" id="3710367">(</span><span class="op" id="3710368">)</span>&nbsp;<span class="op" id="3710370">*</span><span class="ident" id="3710371">dnsRR_Header</span>&nbsp;<span class="op" id="3710384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3710387">return</span>&nbsp;<span class="op" id="3710394">&amp;</span><span class="ident" id="3710395">rr</span><span class="op" id="3710397">.</span><span class="ident" id="3710398">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3710402">}</span><br>
<span class="lineno">255</span><br>
<span class="lineno"></span><span class="keyword" id="3710405">func</span>&nbsp;<span class="op" id="3710410">(</span><span class="ident" id="3710411">rr</span>&nbsp;<span class="op" id="3710414">*</span><span class="ident" id="3710415">dnsRR_NS</span><span class="op" id="3710423">)</span>&nbsp;<span class="ident" id="3710425">Walk</span><span class="op" id="3710429">(</span><span class="ident" id="3710430">f</span>&nbsp;<span class="keyword" id="3710432">func</span><span class="op" id="3710436">(</span><span class="ident" id="3710437">v</span>&nbsp;<span class="keyword" id="3710439">interface</span><span class="op" id="3710448">{</span><span class="op" id="3710449">}</span><span class="op" id="3710450">,</span>&nbsp;<span class="ident" id="3710452">name</span><span class="op" id="3710456">,</span>&nbsp;<span class="ident" id="3710458">tag</span>&nbsp;<span class="builtintype" id="3710462">string</span><span class="op" id="3710468">)</span>&nbsp;<span class="builtintype" id="3710470">bool</span><span class="op" id="3710474">)</span>&nbsp;<span class="builtintype" id="3710476">bool</span>&nbsp;<span class="op" id="3710481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3710484">return</span>&nbsp;<span class="ident" id="3710491">rr</span><span class="op" id="3710493">.</span><span class="ident" id="3710494">Hdr</span><span class="op" id="3710497">.</span><span class="ident" id="3710498">Walk</span><span class="op" id="3710502">(</span><span class="ident" id="3710503">f</span><span class="op" id="3710504">)</span>&nbsp;<span class="op" id="3710506">&amp;&amp;</span>&nbsp;<span class="ident" id="3710509">f</span><span class="op" id="3710510">(</span><span class="op" id="3710511">&amp;</span><span class="ident" id="3710512">rr</span><span class="op" id="3710514">.</span><span class="ident" id="3710515">Ns</span><span class="op" id="3710517">,</span>&nbsp;<span class="string" id="3710519">&#34;Ns&#34;</span><span class="op" id="3710523">,</span>&nbsp;<span class="string" id="3710525">&#34;domain&#34;</span><span class="op" id="3710533">)</span><br>
<span class="lineno"></span><span class="op" id="3710535">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="keyword" id="3710538">type</span>&nbsp;<span class="ident" id="3710543">dnsRR_PTR</span>&nbsp;<span class="keyword" id="3710553">struct</span>&nbsp;<span class="op" id="3710560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3710563">Hdr</span>&nbsp;<span class="ident" id="3710567">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3710581">Ptr</span>&nbsp;<span class="builtintype" id="3710585">string</span>&nbsp;<span class="string" id="3710592">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3710612">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="keyword" id="3710615">func</span>&nbsp;<span class="op" id="3710620">(</span><span class="ident" id="3710621">rr</span>&nbsp;<span class="op" id="3710624">*</span><span class="ident" id="3710625">dnsRR_PTR</span><span class="op" id="3710634">)</span>&nbsp;<span class="ident" id="3710636">Header</span><span class="op" id="3710642">(</span><span class="op" id="3710643">)</span>&nbsp;<span class="op" id="3710645">*</span><span class="ident" id="3710646">dnsRR_Header</span>&nbsp;<span class="op" id="3710659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3710662">return</span>&nbsp;<span class="op" id="3710669">&amp;</span><span class="ident" id="3710670">rr</span><span class="op" id="3710672">.</span><span class="ident" id="3710673">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3710677">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3710680">func</span>&nbsp;<span class="op" id="3710685">(</span><span class="ident" id="3710686">rr</span>&nbsp;<span class="op" id="3710689">*</span><span class="ident" id="3710690">dnsRR_PTR</span><span class="op" id="3710699">)</span>&nbsp;<span class="ident" id="3710701">Walk</span><span class="op" id="3710705">(</span><span class="ident" id="3710706">f</span>&nbsp;<span class="keyword" id="3710708">func</span><span class="op" id="3710712">(</span><span class="ident" id="3710713">v</span>&nbsp;<span class="keyword" id="3710715">interface</span><span class="op" id="3710724">{</span><span class="op" id="3710725">}</span><span class="op" id="3710726">,</span>&nbsp;<span class="ident" id="3710728">name</span><span class="op" id="3710732">,</span>&nbsp;<span class="ident" id="3710734">tag</span>&nbsp;<span class="builtintype" id="3710738">string</span><span class="op" id="3710744">)</span>&nbsp;<span class="builtintype" id="3710746">bool</span><span class="op" id="3710750">)</span>&nbsp;<span class="builtintype" id="3710752">bool</span>&nbsp;<span class="op" id="3710757">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3710760">return</span>&nbsp;<span class="ident" id="3710767">rr</span><span class="op" id="3710769">.</span><span class="ident" id="3710770">Hdr</span><span class="op" id="3710773">.</span><span class="ident" id="3710774">Walk</span><span class="op" id="3710778">(</span><span class="ident" id="3710779">f</span><span class="op" id="3710780">)</span>&nbsp;<span class="op" id="3710782">&amp;&amp;</span>&nbsp;<span class="ident" id="3710785">f</span><span class="op" id="3710786">(</span><span class="op" id="3710787">&amp;</span><span class="ident" id="3710788">rr</span><span class="op" id="3710790">.</span><span class="ident" id="3710791">Ptr</span><span class="op" id="3710794">,</span>&nbsp;<span class="string" id="3710796">&#34;Ptr&#34;</span><span class="op" id="3710801">,</span>&nbsp;<span class="string" id="3710803">&#34;domain&#34;</span><span class="op" id="3710811">)</span><br>
<span class="lineno"></span><span class="op" id="3710813">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3710816">type</span>&nbsp;<span class="ident" id="3710821">dnsRR_SOA</span>&nbsp;<span class="keyword" id="3710831">struct</span>&nbsp;<span class="op" id="3710838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3710841">Hdr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3710849">dnsRR_Header</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3710863">Ns</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3710871">string</span>&nbsp;<span class="string" id="3710878">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3710899">Mbox</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3710907">string</span>&nbsp;<span class="string" id="3710914">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3710935">Serial</span>&nbsp;&nbsp;<span class="builtintype" id="3710943">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3710951">Refresh</span>&nbsp;<span class="builtintype" id="3710959">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3710967">Retry</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3710975">uint32</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3710983">Expire</span>&nbsp;&nbsp;<span class="builtintype" id="3710991">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3710999">Minttl</span>&nbsp;&nbsp;<span class="builtintype" id="3711007">uint32</span><br>
<span class="lineno"></span><span class="op" id="3711014">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3711017">func</span>&nbsp;<span class="op" id="3711022">(</span><span class="ident" id="3711023">rr</span>&nbsp;<span class="op" id="3711026">*</span><span class="ident" id="3711027">dnsRR_SOA</span><span class="op" id="3711036">)</span>&nbsp;<span class="ident" id="3711038">Header</span><span class="op" id="3711044">(</span><span class="op" id="3711045">)</span>&nbsp;<span class="op" id="3711047">*</span><span class="ident" id="3711048">dnsRR_Header</span>&nbsp;<span class="op" id="3711061">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3711064">return</span>&nbsp;<span class="op" id="3711071">&amp;</span><span class="ident" id="3711072">rr</span><span class="op" id="3711074">.</span><span class="ident" id="3711075">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3711079">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3711082">func</span>&nbsp;<span class="op" id="3711087">(</span><span class="ident" id="3711088">rr</span>&nbsp;<span class="op" id="3711091">*</span><span class="ident" id="3711092">dnsRR_SOA</span><span class="op" id="3711101">)</span>&nbsp;<span class="ident" id="3711103">Walk</span><span class="op" id="3711107">(</span><span class="ident" id="3711108">f</span>&nbsp;<span class="keyword" id="3711110">func</span><span class="op" id="3711114">(</span><span class="ident" id="3711115">v</span>&nbsp;<span class="keyword" id="3711117">interface</span><span class="op" id="3711126">{</span><span class="op" id="3711127">}</span><span class="op" id="3711128">,</span>&nbsp;<span class="ident" id="3711130">name</span><span class="op" id="3711134">,</span>&nbsp;<span class="ident" id="3711136">tag</span>&nbsp;<span class="builtintype" id="3711140">string</span><span class="op" id="3711146">)</span>&nbsp;<span class="builtintype" id="3711148">bool</span><span class="op" id="3711152">)</span>&nbsp;<span class="builtintype" id="3711154">bool</span>&nbsp;<span class="op" id="3711159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3711162">return</span>&nbsp;<span class="ident" id="3711169">rr</span><span class="op" id="3711171">.</span><span class="ident" id="3711172">Hdr</span><span class="op" id="3711175">.</span><span class="ident" id="3711176">Walk</span><span class="op" id="3711180">(</span><span class="ident" id="3711181">f</span><span class="op" id="3711182">)</span>&nbsp;<span class="op" id="3711184">&amp;&amp;</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3711189">f</span><span class="op" id="3711190">(</span><span class="op" id="3711191">&amp;</span><span class="ident" id="3711192">rr</span><span class="op" id="3711194">.</span><span class="ident" id="3711195">Ns</span><span class="op" id="3711197">,</span>&nbsp;<span class="string" id="3711199">&#34;Ns&#34;</span><span class="op" id="3711203">,</span>&nbsp;<span class="string" id="3711205">&#34;domain&#34;</span><span class="op" id="3711213">)</span>&nbsp;<span class="op" id="3711215">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3711220">f</span><span class="op" id="3711221">(</span><span class="op" id="3711222">&amp;</span><span class="ident" id="3711223">rr</span><span class="op" id="3711225">.</span><span class="ident" id="3711226">Mbox</span><span class="op" id="3711230">,</span>&nbsp;<span class="string" id="3711232">&#34;Mbox&#34;</span><span class="op" id="3711238">,</span>&nbsp;<span class="string" id="3711240">&#34;domain&#34;</span><span class="op" id="3711248">)</span>&nbsp;<span class="op" id="3711250">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3711255">f</span><span class="op" id="3711256">(</span><span class="op" id="3711257">&amp;</span><span class="ident" id="3711258">rr</span><span class="op" id="3711260">.</span><span class="ident" id="3711261">Serial</span><span class="op" id="3711267">,</span>&nbsp;<span class="string" id="3711269">&#34;Serial&#34;</span><span class="op" id="3711277">,</span>&nbsp;<span class="string" id="3711279">&#34;&#34;</span><span class="op" id="3711281">)</span>&nbsp;<span class="op" id="3711283">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3711288">f</span><span class="op" id="3711289">(</span><span class="op" id="3711290">&amp;</span><span class="ident" id="3711291">rr</span><span class="op" id="3711293">.</span><span class="ident" id="3711294">Refresh</span><span class="op" id="3711301">,</span>&nbsp;<span class="string" id="3711303">&#34;Refresh&#34;</span><span class="op" id="3711312">,</span>&nbsp;<span class="string" id="3711314">&#34;&#34;</span><span class="op" id="3711316">)</span>&nbsp;<span class="op" id="3711318">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3711323">f</span><span class="op" id="3711324">(</span><span class="op" id="3711325">&amp;</span><span class="ident" id="3711326">rr</span><span class="op" id="3711328">.</span><span class="ident" id="3711329">Retry</span><span class="op" id="3711334">,</span>&nbsp;<span class="string" id="3711336">&#34;Retry&#34;</span><span class="op" id="3711343">,</span>&nbsp;<span class="string" id="3711345">&#34;&#34;</span><span class="op" id="3711347">)</span>&nbsp;<span class="op" id="3711349">&amp;&amp;</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3711354">f</span><span class="op" id="3711355">(</span><span class="op" id="3711356">&amp;</span><span class="ident" id="3711357">rr</span><span class="op" id="3711359">.</span><span class="ident" id="3711360">Expire</span><span class="op" id="3711366">,</span>&nbsp;<span class="string" id="3711368">&#34;Expire&#34;</span><span class="op" id="3711376">,</span>&nbsp;<span class="string" id="3711378">&#34;&#34;</span><span class="op" id="3711380">)</span>&nbsp;<span class="op" id="3711382">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3711387">f</span><span class="op" id="3711388">(</span><span class="op" id="3711389">&amp;</span><span class="ident" id="3711390">rr</span><span class="op" id="3711392">.</span><span class="ident" id="3711393">Minttl</span><span class="op" id="3711399">,</span>&nbsp;<span class="string" id="3711401">&#34;Minttl&#34;</span><span class="op" id="3711409">,</span>&nbsp;<span class="string" id="3711411">&#34;&#34;</span><span class="op" id="3711413">)</span><br>
<span class="lineno"></span><span class="op" id="3711415">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3711418">type</span>&nbsp;<span class="ident" id="3711423">dnsRR_TXT</span>&nbsp;<span class="keyword" id="3711433">struct</span>&nbsp;<span class="op" id="3711440">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3711443">Hdr</span>&nbsp;<span class="ident" id="3711447">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3711461">Txt</span>&nbsp;<span class="builtintype" id="3711465">string</span>&nbsp;<span class="comment" id="3711472">//&nbsp;not&nbsp;domain&nbsp;name</span><br>
<span class="lineno"></span><span class="op" id="3711491">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3711494">func</span>&nbsp;<span class="op" id="3711499">(</span><span class="ident" id="3711500">rr</span>&nbsp;<span class="op" id="3711503">*</span><span class="ident" id="3711504">dnsRR_TXT</span><span class="op" id="3711513">)</span>&nbsp;<span class="ident" id="3711515">Header</span><span class="op" id="3711521">(</span><span class="op" id="3711522">)</span>&nbsp;<span class="op" id="3711524">*</span><span class="ident" id="3711525">dnsRR_Header</span>&nbsp;<span class="op" id="3711538">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3711541">return</span>&nbsp;<span class="op" id="3711548">&amp;</span><span class="ident" id="3711549">rr</span><span class="op" id="3711551">.</span><span class="ident" id="3711552">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3711556">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3711559">func</span>&nbsp;<span class="op" id="3711564">(</span><span class="ident" id="3711565">rr</span>&nbsp;<span class="op" id="3711568">*</span><span class="ident" id="3711569">dnsRR_TXT</span><span class="op" id="3711578">)</span>&nbsp;<span class="ident" id="3711580">Walk</span><span class="op" id="3711584">(</span><span class="ident" id="3711585">f</span>&nbsp;<span class="keyword" id="3711587">func</span><span class="op" id="3711591">(</span><span class="ident" id="3711592">v</span>&nbsp;<span class="keyword" id="3711594">interface</span><span class="op" id="3711603">{</span><span class="op" id="3711604">}</span><span class="op" id="3711605">,</span>&nbsp;<span class="ident" id="3711607">name</span><span class="op" id="3711611">,</span>&nbsp;<span class="ident" id="3711613">tag</span>&nbsp;<span class="builtintype" id="3711617">string</span><span class="op" id="3711623">)</span>&nbsp;<span class="builtintype" id="3711625">bool</span><span class="op" id="3711629">)</span>&nbsp;<span class="builtintype" id="3711631">bool</span>&nbsp;<span class="op" id="3711636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3711639">return</span>&nbsp;<span class="ident" id="3711646">rr</span><span class="op" id="3711648">.</span><span class="ident" id="3711649">Hdr</span><span class="op" id="3711652">.</span><span class="ident" id="3711653">Walk</span><span class="op" id="3711657">(</span><span class="ident" id="3711658">f</span><span class="op" id="3711659">)</span>&nbsp;<span class="op" id="3711661">&amp;&amp;</span>&nbsp;<span class="ident" id="3711664">f</span><span class="op" id="3711665">(</span><span class="op" id="3711666">&amp;</span><span class="ident" id="3711667">rr</span><span class="op" id="3711669">.</span><span class="ident" id="3711670">Txt</span><span class="op" id="3711673">,</span>&nbsp;<span class="string" id="3711675">&#34;Txt&#34;</span><span class="op" id="3711680">,</span>&nbsp;<span class="string" id="3711682">&#34;&#34;</span><span class="op" id="3711684">)</span><br>
<span class="lineno">310</span><span class="op" id="3711686">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3711689">type</span>&nbsp;<span class="ident" id="3711694">dnsRR_SRV</span>&nbsp;<span class="keyword" id="3711704">struct</span>&nbsp;<span class="op" id="3711711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3711714">Hdr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3711723">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3711737">Priority</span>&nbsp;<span class="builtintype" id="3711746">uint16</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3711754">Weight</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3711763">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3711771">Port</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3711780">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3711788">Target</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3711797">string</span>&nbsp;<span class="string" id="3711804">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3711824">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span><span class="keyword" id="3711827">func</span>&nbsp;<span class="op" id="3711832">(</span><span class="ident" id="3711833">rr</span>&nbsp;<span class="op" id="3711836">*</span><span class="ident" id="3711837">dnsRR_SRV</span><span class="op" id="3711846">)</span>&nbsp;<span class="ident" id="3711848">Header</span><span class="op" id="3711854">(</span><span class="op" id="3711855">)</span>&nbsp;<span class="op" id="3711857">*</span><span class="ident" id="3711858">dnsRR_Header</span>&nbsp;<span class="op" id="3711871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3711874">return</span>&nbsp;<span class="op" id="3711881">&amp;</span><span class="ident" id="3711882">rr</span><span class="op" id="3711884">.</span><span class="ident" id="3711885">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3711889">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3711892">func</span>&nbsp;<span class="op" id="3711897">(</span><span class="ident" id="3711898">rr</span>&nbsp;<span class="op" id="3711901">*</span><span class="ident" id="3711902">dnsRR_SRV</span><span class="op" id="3711911">)</span>&nbsp;<span class="ident" id="3711913">Walk</span><span class="op" id="3711917">(</span><span class="ident" id="3711918">f</span>&nbsp;<span class="keyword" id="3711920">func</span><span class="op" id="3711924">(</span><span class="ident" id="3711925">v</span>&nbsp;<span class="keyword" id="3711927">interface</span><span class="op" id="3711936">{</span><span class="op" id="3711937">}</span><span class="op" id="3711938">,</span>&nbsp;<span class="ident" id="3711940">name</span><span class="op" id="3711944">,</span>&nbsp;<span class="ident" id="3711946">tag</span>&nbsp;<span class="builtintype" id="3711950">string</span><span class="op" id="3711956">)</span>&nbsp;<span class="builtintype" id="3711958">bool</span><span class="op" id="3711962">)</span>&nbsp;<span class="builtintype" id="3711964">bool</span>&nbsp;<span class="op" id="3711969">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3711972">return</span>&nbsp;<span class="ident" id="3711979">rr</span><span class="op" id="3711981">.</span><span class="ident" id="3711982">Hdr</span><span class="op" id="3711985">.</span><span class="ident" id="3711986">Walk</span><span class="op" id="3711990">(</span><span class="ident" id="3711991">f</span><span class="op" id="3711992">)</span>&nbsp;<span class="op" id="3711994">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3711999">f</span><span class="op" id="3712000">(</span><span class="op" id="3712001">&amp;</span><span class="ident" id="3712002">rr</span><span class="op" id="3712004">.</span><span class="ident" id="3712005">Priority</span><span class="op" id="3712013">,</span>&nbsp;<span class="string" id="3712015">&#34;Priority&#34;</span><span class="op" id="3712025">,</span>&nbsp;<span class="string" id="3712027">&#34;&#34;</span><span class="op" id="3712029">)</span>&nbsp;<span class="op" id="3712031">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3712036">f</span><span class="op" id="3712037">(</span><span class="op" id="3712038">&amp;</span><span class="ident" id="3712039">rr</span><span class="op" id="3712041">.</span><span class="ident" id="3712042">Weight</span><span class="op" id="3712048">,</span>&nbsp;<span class="string" id="3712050">&#34;Weight&#34;</span><span class="op" id="3712058">,</span>&nbsp;<span class="string" id="3712060">&#34;&#34;</span><span class="op" id="3712062">)</span>&nbsp;<span class="op" id="3712064">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3712069">f</span><span class="op" id="3712070">(</span><span class="op" id="3712071">&amp;</span><span class="ident" id="3712072">rr</span><span class="op" id="3712074">.</span><span class="ident" id="3712075">Port</span><span class="op" id="3712079">,</span>&nbsp;<span class="string" id="3712081">&#34;Port&#34;</span><span class="op" id="3712087">,</span>&nbsp;<span class="string" id="3712089">&#34;&#34;</span><span class="op" id="3712091">)</span>&nbsp;<span class="op" id="3712093">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3712098">f</span><span class="op" id="3712099">(</span><span class="op" id="3712100">&amp;</span><span class="ident" id="3712101">rr</span><span class="op" id="3712103">.</span><span class="ident" id="3712104">Target</span><span class="op" id="3712110">,</span>&nbsp;<span class="string" id="3712112">&#34;Target&#34;</span><span class="op" id="3712120">,</span>&nbsp;<span class="string" id="3712122">&#34;domain&#34;</span><span class="op" id="3712130">)</span><br>
<span class="lineno">330</span><span class="op" id="3712132">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3712135">type</span>&nbsp;<span class="ident" id="3712140">dnsRR_A</span>&nbsp;<span class="keyword" id="3712148">struct</span>&nbsp;<span class="op" id="3712155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3712158">Hdr</span>&nbsp;<span class="ident" id="3712162">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3712176">A</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3712180">uint32</span>&nbsp;<span class="string" id="3712187">`net:&#34;ipv4&#34;`</span><br>
<span class="lineno">335</span><span class="op" id="3712200">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3712203">func</span>&nbsp;<span class="op" id="3712208">(</span><span class="ident" id="3712209">rr</span>&nbsp;<span class="op" id="3712212">*</span><span class="ident" id="3712213">dnsRR_A</span><span class="op" id="3712220">)</span>&nbsp;<span class="ident" id="3712222">Header</span><span class="op" id="3712228">(</span><span class="op" id="3712229">)</span>&nbsp;<span class="op" id="3712231">*</span><span class="ident" id="3712232">dnsRR_Header</span>&nbsp;<span class="op" id="3712245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3712248">return</span>&nbsp;<span class="op" id="3712255">&amp;</span><span class="ident" id="3712256">rr</span><span class="op" id="3712258">.</span><span class="ident" id="3712259">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3712263">}</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span><span class="keyword" id="3712266">func</span>&nbsp;<span class="op" id="3712271">(</span><span class="ident" id="3712272">rr</span>&nbsp;<span class="op" id="3712275">*</span><span class="ident" id="3712276">dnsRR_A</span><span class="op" id="3712283">)</span>&nbsp;<span class="ident" id="3712285">Walk</span><span class="op" id="3712289">(</span><span class="ident" id="3712290">f</span>&nbsp;<span class="keyword" id="3712292">func</span><span class="op" id="3712296">(</span><span class="ident" id="3712297">v</span>&nbsp;<span class="keyword" id="3712299">interface</span><span class="op" id="3712308">{</span><span class="op" id="3712309">}</span><span class="op" id="3712310">,</span>&nbsp;<span class="ident" id="3712312">name</span><span class="op" id="3712316">,</span>&nbsp;<span class="ident" id="3712318">tag</span>&nbsp;<span class="builtintype" id="3712322">string</span><span class="op" id="3712328">)</span>&nbsp;<span class="builtintype" id="3712330">bool</span><span class="op" id="3712334">)</span>&nbsp;<span class="builtintype" id="3712336">bool</span>&nbsp;<span class="op" id="3712341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3712344">return</span>&nbsp;<span class="ident" id="3712351">rr</span><span class="op" id="3712353">.</span><span class="ident" id="3712354">Hdr</span><span class="op" id="3712357">.</span><span class="ident" id="3712358">Walk</span><span class="op" id="3712362">(</span><span class="ident" id="3712363">f</span><span class="op" id="3712364">)</span>&nbsp;<span class="op" id="3712366">&amp;&amp;</span>&nbsp;<span class="ident" id="3712369">f</span><span class="op" id="3712370">(</span><span class="op" id="3712371">&amp;</span><span class="ident" id="3712372">rr</span><span class="op" id="3712374">.</span><span class="ident" id="3712375">A</span><span class="op" id="3712376">,</span>&nbsp;<span class="string" id="3712378">&#34;A&#34;</span><span class="op" id="3712381">,</span>&nbsp;<span class="string" id="3712383">&#34;ipv4&#34;</span><span class="op" id="3712389">)</span><br>
<span class="lineno"></span><span class="op" id="3712391">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">345</span><span class="keyword" id="3712394">type</span>&nbsp;<span class="ident" id="3712399">dnsRR_AAAA</span>&nbsp;<span class="keyword" id="3712410">struct</span>&nbsp;<span class="op" id="3712417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3712420">Hdr</span>&nbsp;&nbsp;<span class="ident" id="3712425">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3712439">AAAA</span>&nbsp;<span class="op" id="3712444">[</span><span class="num" id="3712445">16</span><span class="op" id="3712447">]</span><span class="builtintype" id="3712448">byte</span>&nbsp;<span class="string" id="3712453">`net:&#34;ipv6&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3712466">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="keyword" id="3712469">func</span>&nbsp;<span class="op" id="3712474">(</span><span class="ident" id="3712475">rr</span>&nbsp;<span class="op" id="3712478">*</span><span class="ident" id="3712479">dnsRR_AAAA</span><span class="op" id="3712489">)</span>&nbsp;<span class="ident" id="3712491">Header</span><span class="op" id="3712497">(</span><span class="op" id="3712498">)</span>&nbsp;<span class="op" id="3712500">*</span><span class="ident" id="3712501">dnsRR_Header</span>&nbsp;<span class="op" id="3712514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3712517">return</span>&nbsp;<span class="op" id="3712524">&amp;</span><span class="ident" id="3712525">rr</span><span class="op" id="3712527">.</span><span class="ident" id="3712528">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3712532">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3712535">func</span>&nbsp;<span class="op" id="3712540">(</span><span class="ident" id="3712541">rr</span>&nbsp;<span class="op" id="3712544">*</span><span class="ident" id="3712545">dnsRR_AAAA</span><span class="op" id="3712555">)</span>&nbsp;<span class="ident" id="3712557">Walk</span><span class="op" id="3712561">(</span><span class="ident" id="3712562">f</span>&nbsp;<span class="keyword" id="3712564">func</span><span class="op" id="3712568">(</span><span class="ident" id="3712569">v</span>&nbsp;<span class="keyword" id="3712571">interface</span><span class="op" id="3712580">{</span><span class="op" id="3712581">}</span><span class="op" id="3712582">,</span>&nbsp;<span class="ident" id="3712584">name</span><span class="op" id="3712588">,</span>&nbsp;<span class="ident" id="3712590">tag</span>&nbsp;<span class="builtintype" id="3712594">string</span><span class="op" id="3712600">)</span>&nbsp;<span class="builtintype" id="3712602">bool</span><span class="op" id="3712606">)</span>&nbsp;<span class="builtintype" id="3712608">bool</span>&nbsp;<span class="op" id="3712613">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3712616">return</span>&nbsp;<span class="ident" id="3712623">rr</span><span class="op" id="3712625">.</span><span class="ident" id="3712626">Hdr</span><span class="op" id="3712629">.</span><span class="ident" id="3712630">Walk</span><span class="op" id="3712634">(</span><span class="ident" id="3712635">f</span><span class="op" id="3712636">)</span>&nbsp;<span class="op" id="3712638">&amp;&amp;</span>&nbsp;<span class="ident" id="3712641">f</span><span class="op" id="3712642">(</span><span class="ident" id="3712643">rr</span><span class="op" id="3712645">.</span><span class="ident" id="3712646">AAAA</span><span class="op" id="3712650">[</span><span class="op" id="3712651">:</span><span class="op" id="3712652">]</span><span class="op" id="3712653">,</span>&nbsp;<span class="string" id="3712655">&#34;AAAA&#34;</span><span class="op" id="3712661">,</span>&nbsp;<span class="string" id="3712663">&#34;ipv6&#34;</span><span class="op" id="3712669">)</span><br>
<span class="lineno"></span><span class="op" id="3712671">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3712674">//&nbsp;Packing&nbsp;and&nbsp;unpacking.</span><br>
<span class="lineno"></span><span class="comment" id="3712700">//</span><br>
<span class="lineno">360</span><span class="comment" id="3712703">//&nbsp;All&nbsp;the&nbsp;packers&nbsp;and&nbsp;unpackers&nbsp;take&nbsp;a&nbsp;(msg&nbsp;[]byte,&nbsp;off&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="3712765">//&nbsp;and&nbsp;return&nbsp;(off1&nbsp;int,&nbsp;ok&nbsp;bool).&nbsp;&nbsp;If&nbsp;they&nbsp;return&nbsp;ok==false,&nbsp;they</span><br>
<span class="lineno"></span><span class="comment" id="3712832">//&nbsp;also&nbsp;return&nbsp;off1==len(msg),&nbsp;so&nbsp;that&nbsp;the&nbsp;next&nbsp;unpacker&nbsp;will</span><br>
<span class="lineno"></span><span class="comment" id="3712894">//&nbsp;also&nbsp;fail.&nbsp;&nbsp;This&nbsp;lets&nbsp;us&nbsp;avoid&nbsp;checks&nbsp;of&nbsp;ok&nbsp;until&nbsp;the&nbsp;end&nbsp;of&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3712960">//&nbsp;packing&nbsp;sequence.</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span><span class="comment" id="3712982">//&nbsp;Map&nbsp;of&nbsp;constructors&nbsp;for&nbsp;each&nbsp;RR&nbsp;wire&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="3713028">var</span>&nbsp;<span class="ident" id="3713032">rr_mk</span>&nbsp;<span class="op" id="3713038">=</span>&nbsp;<span class="keyword" id="3713040">map</span><span class="op" id="3713043">[</span><span class="builtintype" id="3713044">int</span><span class="op" id="3713047">]</span><span class="keyword" id="3713048">func</span><span class="op" id="3713052">(</span><span class="op" id="3713053">)</span>&nbsp;<span class="ident" id="3713055">dnsRR</span><span class="op" id="3713060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3713063">dnsTypeCNAME</span><span class="op" id="3713075">:</span>&nbsp;<span class="keyword" id="3713077">func</span><span class="op" id="3713081">(</span><span class="op" id="3713082">)</span>&nbsp;<span class="ident" id="3713084">dnsRR</span>&nbsp;<span class="op" id="3713090">{</span>&nbsp;<span class="keyword" id="3713092">return</span>&nbsp;<span class="builtinfunc" id="3713099">new</span><span class="op" id="3713102">(</span><span class="ident" id="3713103">dnsRR_CNAME</span><span class="op" id="3713114">)</span>&nbsp;<span class="op" id="3713116">}</span><span class="op" id="3713117">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3713120">dnsTypeHINFO</span><span class="op" id="3713132">:</span>&nbsp;<span class="keyword" id="3713134">func</span><span class="op" id="3713138">(</span><span class="op" id="3713139">)</span>&nbsp;<span class="ident" id="3713141">dnsRR</span>&nbsp;<span class="op" id="3713147">{</span>&nbsp;<span class="keyword" id="3713149">return</span>&nbsp;<span class="builtinfunc" id="3713156">new</span><span class="op" id="3713159">(</span><span class="ident" id="3713160">dnsRR_HINFO</span><span class="op" id="3713171">)</span>&nbsp;<span class="op" id="3713173">}</span><span class="op" id="3713174">,</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3713177">dnsTypeMB</span><span class="op" id="3713186">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3713191">func</span><span class="op" id="3713195">(</span><span class="op" id="3713196">)</span>&nbsp;<span class="ident" id="3713198">dnsRR</span>&nbsp;<span class="op" id="3713204">{</span>&nbsp;<span class="keyword" id="3713206">return</span>&nbsp;<span class="builtinfunc" id="3713213">new</span><span class="op" id="3713216">(</span><span class="ident" id="3713217">dnsRR_MB</span><span class="op" id="3713225">)</span>&nbsp;<span class="op" id="3713227">}</span><span class="op" id="3713228">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3713231">dnsTypeMG</span><span class="op" id="3713240">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3713245">func</span><span class="op" id="3713249">(</span><span class="op" id="3713250">)</span>&nbsp;<span class="ident" id="3713252">dnsRR</span>&nbsp;<span class="op" id="3713258">{</span>&nbsp;<span class="keyword" id="3713260">return</span>&nbsp;<span class="builtinfunc" id="3713267">new</span><span class="op" id="3713270">(</span><span class="ident" id="3713271">dnsRR_MG</span><span class="op" id="3713279">)</span>&nbsp;<span class="op" id="3713281">}</span><span class="op" id="3713282">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3713285">dnsTypeMINFO</span><span class="op" id="3713297">:</span>&nbsp;<span class="keyword" id="3713299">func</span><span class="op" id="3713303">(</span><span class="op" id="3713304">)</span>&nbsp;<span class="ident" id="3713306">dnsRR</span>&nbsp;<span class="op" id="3713312">{</span>&nbsp;<span class="keyword" id="3713314">return</span>&nbsp;<span class="builtinfunc" id="3713321">new</span><span class="op" id="3713324">(</span><span class="ident" id="3713325">dnsRR_MINFO</span><span class="op" id="3713336">)</span>&nbsp;<span class="op" id="3713338">}</span><span class="op" id="3713339">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3713342">dnsTypeMR</span><span class="op" id="3713351">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3713356">func</span><span class="op" id="3713360">(</span><span class="op" id="3713361">)</span>&nbsp;<span class="ident" id="3713363">dnsRR</span>&nbsp;<span class="op" id="3713369">{</span>&nbsp;<span class="keyword" id="3713371">return</span>&nbsp;<span class="builtinfunc" id="3713378">new</span><span class="op" id="3713381">(</span><span class="ident" id="3713382">dnsRR_MR</span><span class="op" id="3713390">)</span>&nbsp;<span class="op" id="3713392">}</span><span class="op" id="3713393">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3713396">dnsTypeMX</span><span class="op" id="3713405">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3713410">func</span><span class="op" id="3713414">(</span><span class="op" id="3713415">)</span>&nbsp;<span class="ident" id="3713417">dnsRR</span>&nbsp;<span class="op" id="3713423">{</span>&nbsp;<span class="keyword" id="3713425">return</span>&nbsp;<span class="builtinfunc" id="3713432">new</span><span class="op" id="3713435">(</span><span class="ident" id="3713436">dnsRR_MX</span><span class="op" id="3713444">)</span>&nbsp;<span class="op" id="3713446">}</span><span class="op" id="3713447">,</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3713450">dnsTypeNS</span><span class="op" id="3713459">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3713464">func</span><span class="op" id="3713468">(</span><span class="op" id="3713469">)</span>&nbsp;<span class="ident" id="3713471">dnsRR</span>&nbsp;<span class="op" id="3713477">{</span>&nbsp;<span class="keyword" id="3713479">return</span>&nbsp;<span class="builtinfunc" id="3713486">new</span><span class="op" id="3713489">(</span><span class="ident" id="3713490">dnsRR_NS</span><span class="op" id="3713498">)</span>&nbsp;<span class="op" id="3713500">}</span><span class="op" id="3713501">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3713504">dnsTypePTR</span><span class="op" id="3713514">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="3713518">func</span><span class="op" id="3713522">(</span><span class="op" id="3713523">)</span>&nbsp;<span class="ident" id="3713525">dnsRR</span>&nbsp;<span class="op" id="3713531">{</span>&nbsp;<span class="keyword" id="3713533">return</span>&nbsp;<span class="builtinfunc" id="3713540">new</span><span class="op" id="3713543">(</span><span class="ident" id="3713544">dnsRR_PTR</span><span class="op" id="3713553">)</span>&nbsp;<span class="op" id="3713555">}</span><span class="op" id="3713556">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3713559">dnsTypeSOA</span><span class="op" id="3713569">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="3713573">func</span><span class="op" id="3713577">(</span><span class="op" id="3713578">)</span>&nbsp;<span class="ident" id="3713580">dnsRR</span>&nbsp;<span class="op" id="3713586">{</span>&nbsp;<span class="keyword" id="3713588">return</span>&nbsp;<span class="builtinfunc" id="3713595">new</span><span class="op" id="3713598">(</span><span class="ident" id="3713599">dnsRR_SOA</span><span class="op" id="3713608">)</span>&nbsp;<span class="op" id="3713610">}</span><span class="op" id="3713611">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3713614">dnsTypeTXT</span><span class="op" id="3713624">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="3713628">func</span><span class="op" id="3713632">(</span><span class="op" id="3713633">)</span>&nbsp;<span class="ident" id="3713635">dnsRR</span>&nbsp;<span class="op" id="3713641">{</span>&nbsp;<span class="keyword" id="3713643">return</span>&nbsp;<span class="builtinfunc" id="3713650">new</span><span class="op" id="3713653">(</span><span class="ident" id="3713654">dnsRR_TXT</span><span class="op" id="3713663">)</span>&nbsp;<span class="op" id="3713665">}</span><span class="op" id="3713666">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3713669">dnsTypeSRV</span><span class="op" id="3713679">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="3713683">func</span><span class="op" id="3713687">(</span><span class="op" id="3713688">)</span>&nbsp;<span class="ident" id="3713690">dnsRR</span>&nbsp;<span class="op" id="3713696">{</span>&nbsp;<span class="keyword" id="3713698">return</span>&nbsp;<span class="builtinfunc" id="3713705">new</span><span class="op" id="3713708">(</span><span class="ident" id="3713709">dnsRR_SRV</span><span class="op" id="3713718">)</span>&nbsp;<span class="op" id="3713720">}</span><span class="op" id="3713721">,</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3713724">dnsTypeA</span><span class="op" id="3713732">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3713738">func</span><span class="op" id="3713742">(</span><span class="op" id="3713743">)</span>&nbsp;<span class="ident" id="3713745">dnsRR</span>&nbsp;<span class="op" id="3713751">{</span>&nbsp;<span class="keyword" id="3713753">return</span>&nbsp;<span class="builtinfunc" id="3713760">new</span><span class="op" id="3713763">(</span><span class="ident" id="3713764">dnsRR_A</span><span class="op" id="3713771">)</span>&nbsp;<span class="op" id="3713773">}</span><span class="op" id="3713774">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3713777">dnsTypeAAAA</span><span class="op" id="3713788">:</span>&nbsp;&nbsp;<span class="keyword" id="3713791">func</span><span class="op" id="3713795">(</span><span class="op" id="3713796">)</span>&nbsp;<span class="ident" id="3713798">dnsRR</span>&nbsp;<span class="op" id="3713804">{</span>&nbsp;<span class="keyword" id="3713806">return</span>&nbsp;<span class="builtinfunc" id="3713813">new</span><span class="op" id="3713816">(</span><span class="ident" id="3713817">dnsRR_AAAA</span><span class="op" id="3713827">)</span>&nbsp;<span class="op" id="3713829">}</span><span class="op" id="3713830">,</span><br>
<span class="lineno"></span><span class="op" id="3713832">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3713835">//&nbsp;Pack&nbsp;a&nbsp;domain&nbsp;name&nbsp;s&nbsp;into&nbsp;msg[off:].</span><br>
<span class="lineno">385</span><span class="comment" id="3713875">//&nbsp;Domain&nbsp;names&nbsp;are&nbsp;a&nbsp;sequence&nbsp;of&nbsp;counted&nbsp;strings</span><br>
<span class="lineno"></span><span class="comment" id="3713925">//&nbsp;split&nbsp;at&nbsp;the&nbsp;dots.&nbsp;&nbsp;They&nbsp;end&nbsp;with&nbsp;a&nbsp;zero-length&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="3713984">func</span>&nbsp;<span class="ident" id="3713989">packDomainName</span><span class="op" id="3714003">(</span><span class="ident" id="3714004">s</span>&nbsp;<span class="builtintype" id="3714006">string</span><span class="op" id="3714012">,</span>&nbsp;<span class="ident" id="3714014">msg</span>&nbsp;<span class="op" id="3714018">[</span><span class="op" id="3714019">]</span><span class="builtintype" id="3714020">byte</span><span class="op" id="3714024">,</span>&nbsp;<span class="ident" id="3714026">off</span>&nbsp;<span class="builtintype" id="3714030">int</span><span class="op" id="3714033">)</span>&nbsp;<span class="op" id="3714035">(</span><span class="ident" id="3714036">off1</span>&nbsp;<span class="builtintype" id="3714041">int</span><span class="op" id="3714044">,</span>&nbsp;<span class="ident" id="3714046">ok</span>&nbsp;<span class="builtintype" id="3714049">bool</span><span class="op" id="3714053">)</span>&nbsp;<span class="op" id="3714055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3714058">//&nbsp;Add&nbsp;trailing&nbsp;dot&nbsp;to&nbsp;canonicalize&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3714101">if</span>&nbsp;<span class="ident" id="3714104">n</span>&nbsp;<span class="op" id="3714106">:=</span>&nbsp;<span class="builtinfunc" id="3714109">len</span><span class="op" id="3714112">(</span><span class="ident" id="3714113">s</span><span class="op" id="3714114">)</span><span class="op" id="3714115">;</span>&nbsp;<span class="ident" id="3714117">n</span>&nbsp;<span class="op" id="3714119">==</span>&nbsp;<span class="num" id="3714122">0</span>&nbsp;<span class="op" id="3714124">||</span>&nbsp;<span class="ident" id="3714127">s</span><span class="op" id="3714128">[</span><span class="ident" id="3714129">n</span><span class="op" id="3714130">-</span><span class="num" id="3714131">1</span><span class="op" id="3714132">]</span>&nbsp;<span class="op" id="3714134">!=</span>&nbsp;<span class="string" id="3714137">&#39;.&#39;</span>&nbsp;<span class="op" id="3714141">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3714145">s</span>&nbsp;<span class="op" id="3714147">+=</span>&nbsp;<span class="string" id="3714150">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3714155">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3714159">//&nbsp;Each&nbsp;dot&nbsp;ends&nbsp;a&nbsp;segment&nbsp;of&nbsp;the&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3714200">//&nbsp;We&nbsp;trade&nbsp;each&nbsp;dot&nbsp;byte&nbsp;for&nbsp;a&nbsp;length&nbsp;byte.</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3714246">//&nbsp;There&nbsp;is&nbsp;also&nbsp;a&nbsp;trailing&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3714281">//&nbsp;Check&nbsp;that&nbsp;we&nbsp;have&nbsp;all&nbsp;the&nbsp;space&nbsp;we&nbsp;need.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3714327">tot</span>&nbsp;<span class="op" id="3714331">:=</span>&nbsp;<span class="builtinfunc" id="3714334">len</span><span class="op" id="3714337">(</span><span class="ident" id="3714338">s</span><span class="op" id="3714339">)</span>&nbsp;<span class="op" id="3714341">+</span>&nbsp;<span class="num" id="3714343">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3714346">if</span>&nbsp;<span class="ident" id="3714349">off</span><span class="op" id="3714352">+</span><span class="ident" id="3714353">tot</span>&nbsp;<span class="op" id="3714357">&gt;</span>&nbsp;<span class="builtinfunc" id="3714359">len</span><span class="op" id="3714362">(</span><span class="ident" id="3714363">msg</span><span class="op" id="3714366">)</span>&nbsp;<span class="op" id="3714368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3714372">return</span>&nbsp;<span class="builtinfunc" id="3714379">len</span><span class="op" id="3714382">(</span><span class="ident" id="3714383">msg</span><span class="op" id="3714386">)</span><span class="op" id="3714387">,</span>&nbsp;<span class="builtintype" id="3714389">false</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3714396">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3714400">//&nbsp;Emit&nbsp;sequence&nbsp;of&nbsp;counted&nbsp;strings,&nbsp;chopping&nbsp;at&nbsp;dots.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3714456">begin</span>&nbsp;<span class="op" id="3714462">:=</span>&nbsp;<span class="num" id="3714465">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3714468">for</span>&nbsp;<span class="ident" id="3714472">i</span>&nbsp;<span class="op" id="3714474">:=</span>&nbsp;<span class="num" id="3714477">0</span><span class="op" id="3714478">;</span>&nbsp;<span class="ident" id="3714480">i</span>&nbsp;<span class="op" id="3714482">&lt;</span>&nbsp;<span class="builtinfunc" id="3714484">len</span><span class="op" id="3714487">(</span><span class="ident" id="3714488">s</span><span class="op" id="3714489">)</span><span class="op" id="3714490">;</span>&nbsp;<span class="ident" id="3714492">i</span><span class="op" id="3714493">++</span>&nbsp;<span class="op" id="3714496">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3714500">if</span>&nbsp;<span class="ident" id="3714503">s</span><span class="op" id="3714504">[</span><span class="ident" id="3714505">i</span><span class="op" id="3714506">]</span>&nbsp;<span class="op" id="3714508">==</span>&nbsp;<span class="string" id="3714511">&#39;.&#39;</span>&nbsp;<span class="op" id="3714515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3714520">if</span>&nbsp;<span class="ident" id="3714523">i</span><span class="op" id="3714524">-</span><span class="ident" id="3714525">begin</span>&nbsp;<span class="op" id="3714531">&gt;=</span>&nbsp;<span class="num" id="3714534">1</span><span class="op" id="3714535">&lt;&lt;</span><span class="num" id="3714537">6</span>&nbsp;<span class="op" id="3714539">{</span>&nbsp;<span class="comment" id="3714541">//&nbsp;top&nbsp;two&nbsp;bits&nbsp;of&nbsp;length&nbsp;must&nbsp;be&nbsp;clear</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3714585">return</span>&nbsp;<span class="builtinfunc" id="3714592">len</span><span class="op" id="3714595">(</span><span class="ident" id="3714596">msg</span><span class="op" id="3714599">)</span><span class="op" id="3714600">,</span>&nbsp;<span class="builtintype" id="3714602">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3714611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3714616">msg</span><span class="op" id="3714619">[</span><span class="ident" id="3714620">off</span><span class="op" id="3714623">]</span>&nbsp;<span class="op" id="3714625">=</span>&nbsp;<span class="builtintype" id="3714627">byte</span><span class="op" id="3714631">(</span><span class="ident" id="3714632">i</span>&nbsp;<span class="op" id="3714634">-</span>&nbsp;<span class="ident" id="3714636">begin</span><span class="op" id="3714641">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3714646">off</span><span class="op" id="3714649">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3714655">for</span>&nbsp;<span class="ident" id="3714659">j</span>&nbsp;<span class="op" id="3714661">:=</span>&nbsp;<span class="ident" id="3714664">begin</span><span class="op" id="3714669">;</span>&nbsp;<span class="ident" id="3714671">j</span>&nbsp;<span class="op" id="3714673">&lt;</span>&nbsp;<span class="ident" id="3714675">i</span><span class="op" id="3714676">;</span>&nbsp;<span class="ident" id="3714678">j</span><span class="op" id="3714679">++</span>&nbsp;<span class="op" id="3714682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3714688">msg</span><span class="op" id="3714691">[</span><span class="ident" id="3714692">off</span><span class="op" id="3714695">]</span>&nbsp;<span class="op" id="3714697">=</span>&nbsp;<span class="ident" id="3714699">s</span><span class="op" id="3714700">[</span><span class="ident" id="3714701">j</span><span class="op" id="3714702">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3714708">off</span><span class="op" id="3714711">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3714717">}</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3714722">begin</span>&nbsp;<span class="op" id="3714728">=</span>&nbsp;<span class="ident" id="3714730">i</span>&nbsp;<span class="op" id="3714732">+</span>&nbsp;<span class="num" id="3714734">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3714738">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3714741">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3714744">msg</span><span class="op" id="3714747">[</span><span class="ident" id="3714748">off</span><span class="op" id="3714751">]</span>&nbsp;<span class="op" id="3714753">=</span>&nbsp;<span class="num" id="3714755">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3714758">off</span><span class="op" id="3714761">++</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3714765">return</span>&nbsp;<span class="ident" id="3714772">off</span><span class="op" id="3714775">,</span>&nbsp;<span class="builtintype" id="3714777">true</span><br>
<span class="lineno"></span><span class="op" id="3714782">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3714785">//&nbsp;Unpack&nbsp;a&nbsp;domain&nbsp;name.</span><br>
<span class="lineno"></span><span class="comment" id="3714810">//&nbsp;In&nbsp;addition&nbsp;to&nbsp;the&nbsp;simple&nbsp;sequences&nbsp;of&nbsp;counted&nbsp;strings&nbsp;above,</span><br>
<span class="lineno">425</span><span class="comment" id="3714875">//&nbsp;domain&nbsp;names&nbsp;are&nbsp;allowed&nbsp;to&nbsp;refer&nbsp;to&nbsp;strings&nbsp;elsewhere&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3714940">//&nbsp;packet,&nbsp;to&nbsp;avoid&nbsp;repeating&nbsp;common&nbsp;suffixes&nbsp;when&nbsp;returning</span><br>
<span class="lineno"></span><span class="comment" id="3715001">//&nbsp;many&nbsp;entries&nbsp;in&nbsp;a&nbsp;single&nbsp;domain.&nbsp;&nbsp;The&nbsp;pointers&nbsp;are&nbsp;marked</span><br>
<span class="lineno"></span><span class="comment" id="3715062">//&nbsp;by&nbsp;a&nbsp;length&nbsp;byte&nbsp;with&nbsp;the&nbsp;top&nbsp;two&nbsp;bits&nbsp;set.&nbsp;&nbsp;Ignoring&nbsp;those</span><br>
<span class="lineno"></span><span class="comment" id="3715125">//&nbsp;two&nbsp;bits,&nbsp;that&nbsp;byte&nbsp;and&nbsp;the&nbsp;next&nbsp;give&nbsp;a&nbsp;14&nbsp;bit&nbsp;offset&nbsp;from&nbsp;msg[0]</span><br>
<span class="lineno">430</span><span class="comment" id="3715194">//&nbsp;where&nbsp;we&nbsp;should&nbsp;pick&nbsp;up&nbsp;the&nbsp;trail.</span><br>
<span class="lineno"></span><span class="comment" id="3715232">//&nbsp;Note&nbsp;that&nbsp;if&nbsp;we&nbsp;jump&nbsp;elsewhere&nbsp;in&nbsp;the&nbsp;packet,</span><br>
<span class="lineno"></span><span class="comment" id="3715281">//&nbsp;we&nbsp;return&nbsp;off1&nbsp;==&nbsp;the&nbsp;offset&nbsp;after&nbsp;the&nbsp;first&nbsp;pointer&nbsp;we&nbsp;found,</span><br>
<span class="lineno"></span><span class="comment" id="3715347">//&nbsp;which&nbsp;is&nbsp;where&nbsp;the&nbsp;next&nbsp;record&nbsp;will&nbsp;start.</span><br>
<span class="lineno"></span><span class="comment" id="3715393">//&nbsp;In&nbsp;theory,&nbsp;the&nbsp;pointers&nbsp;are&nbsp;only&nbsp;allowed&nbsp;to&nbsp;jump&nbsp;backward.</span><br>
<span class="lineno">435</span><span class="comment" id="3715455">//&nbsp;We&nbsp;let&nbsp;them&nbsp;jump&nbsp;anywhere&nbsp;and&nbsp;stop&nbsp;jumping&nbsp;after&nbsp;a&nbsp;while.</span><br>
<span class="lineno"></span><span class="keyword" id="3715516">func</span>&nbsp;<span class="ident" id="3715521">unpackDomainName</span><span class="op" id="3715537">(</span><span class="ident" id="3715538">msg</span>&nbsp;<span class="op" id="3715542">[</span><span class="op" id="3715543">]</span><span class="builtintype" id="3715544">byte</span><span class="op" id="3715548">,</span>&nbsp;<span class="ident" id="3715550">off</span>&nbsp;<span class="builtintype" id="3715554">int</span><span class="op" id="3715557">)</span>&nbsp;<span class="op" id="3715559">(</span><span class="ident" id="3715560">s</span>&nbsp;<span class="builtintype" id="3715562">string</span><span class="op" id="3715568">,</span>&nbsp;<span class="ident" id="3715570">off1</span>&nbsp;<span class="builtintype" id="3715575">int</span><span class="op" id="3715578">,</span>&nbsp;<span class="ident" id="3715580">ok</span>&nbsp;<span class="builtintype" id="3715583">bool</span><span class="op" id="3715587">)</span>&nbsp;<span class="op" id="3715589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3715592">s</span>&nbsp;<span class="op" id="3715594">=</span>&nbsp;<span class="string" id="3715596">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3715600">ptr</span>&nbsp;<span class="op" id="3715604">:=</span>&nbsp;<span class="num" id="3715607">0</span>&nbsp;<span class="comment" id="3715609">//&nbsp;number&nbsp;of&nbsp;pointers&nbsp;followed</span><br>
<span class="lineno"></span><span class="ident" id="3715640">Loop</span><span class="op" id="3715644">:</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3715647">for</span>&nbsp;<span class="op" id="3715651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3715655">if</span>&nbsp;<span class="ident" id="3715658">off</span>&nbsp;<span class="op" id="3715662">&gt;=</span>&nbsp;<span class="builtinfunc" id="3715665">len</span><span class="op" id="3715668">(</span><span class="ident" id="3715669">msg</span><span class="op" id="3715672">)</span>&nbsp;<span class="op" id="3715674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3715679">return</span>&nbsp;<span class="string" id="3715686">&#34;&#34;</span><span class="op" id="3715688">,</span>&nbsp;<span class="builtinfunc" id="3715690">len</span><span class="op" id="3715693">(</span><span class="ident" id="3715694">msg</span><span class="op" id="3715697">)</span><span class="op" id="3715698">,</span>&nbsp;<span class="builtintype" id="3715700">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3715708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3715712">c</span>&nbsp;<span class="op" id="3715714">:=</span>&nbsp;<span class="builtintype" id="3715717">int</span><span class="op" id="3715720">(</span><span class="ident" id="3715721">msg</span><span class="op" id="3715724">[</span><span class="ident" id="3715725">off</span><span class="op" id="3715728">]</span><span class="op" id="3715729">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3715733">off</span><span class="op" id="3715736">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3715741">switch</span>&nbsp;<span class="ident" id="3715748">c</span>&nbsp;<span class="op" id="3715750">&amp;</span>&nbsp;<span class="num" id="3715752">0xC0</span>&nbsp;<span class="op" id="3715757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3715761">case</span>&nbsp;<span class="num" id="3715766">0x00</span><span class="op" id="3715770">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3715775">if</span>&nbsp;<span class="ident" id="3715778">c</span>&nbsp;<span class="op" id="3715780">==</span>&nbsp;<span class="num" id="3715783">0x00</span>&nbsp;<span class="op" id="3715788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3715794">//&nbsp;end&nbsp;of&nbsp;name</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3715813">break</span>&nbsp;<span class="ident" id="3715819">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3715827">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3715832">//&nbsp;literal&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3715853">if</span>&nbsp;<span class="ident" id="3715856">off</span><span class="op" id="3715859">+</span><span class="ident" id="3715860">c</span>&nbsp;<span class="op" id="3715862">&gt;</span>&nbsp;<span class="builtinfunc" id="3715864">len</span><span class="op" id="3715867">(</span><span class="ident" id="3715868">msg</span><span class="op" id="3715871">)</span>&nbsp;<span class="op" id="3715873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3715879">return</span>&nbsp;<span class="string" id="3715886">&#34;&#34;</span><span class="op" id="3715888">,</span>&nbsp;<span class="builtinfunc" id="3715890">len</span><span class="op" id="3715893">(</span><span class="ident" id="3715894">msg</span><span class="op" id="3715897">)</span><span class="op" id="3715898">,</span>&nbsp;<span class="builtintype" id="3715900">false</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3715909">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3715914">s</span>&nbsp;<span class="op" id="3715916">+=</span>&nbsp;<span class="builtintype" id="3715919">string</span><span class="op" id="3715925">(</span><span class="ident" id="3715926">msg</span><span class="op" id="3715929">[</span><span class="ident" id="3715930">off</span><span class="op" id="3715933">:</span><span class="ident" id="3715934">off</span><span class="op" id="3715937">+</span><span class="ident" id="3715938">c</span><span class="op" id="3715939">]</span><span class="op" id="3715940">)</span>&nbsp;<span class="op" id="3715942">+</span>&nbsp;<span class="string" id="3715944">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3715951">off</span>&nbsp;<span class="op" id="3715955">+=</span>&nbsp;<span class="ident" id="3715958">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3715962">case</span>&nbsp;<span class="num" id="3715967">0xC0</span><span class="op" id="3715971">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3715976">//&nbsp;pointer&nbsp;to&nbsp;somewhere&nbsp;else&nbsp;in&nbsp;msg.</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3716016">//&nbsp;remember&nbsp;location&nbsp;after&nbsp;first&nbsp;ptr,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3716057">//&nbsp;since&nbsp;that&#39;s&nbsp;how&nbsp;many&nbsp;bytes&nbsp;we&nbsp;consumed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3716104">//&nbsp;also,&nbsp;don&#39;t&nbsp;follow&nbsp;too&nbsp;many&nbsp;pointers&nbsp;--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3716150">//&nbsp;maybe&nbsp;there&#39;s&nbsp;a&nbsp;loop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3716178">if</span>&nbsp;<span class="ident" id="3716181">off</span>&nbsp;<span class="op" id="3716185">&gt;=</span>&nbsp;<span class="builtinfunc" id="3716188">len</span><span class="op" id="3716191">(</span><span class="ident" id="3716192">msg</span><span class="op" id="3716195">)</span>&nbsp;<span class="op" id="3716197">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3716203">return</span>&nbsp;<span class="string" id="3716210">&#34;&#34;</span><span class="op" id="3716212">,</span>&nbsp;<span class="builtinfunc" id="3716214">len</span><span class="op" id="3716217">(</span><span class="ident" id="3716218">msg</span><span class="op" id="3716221">)</span><span class="op" id="3716222">,</span>&nbsp;<span class="builtintype" id="3716224">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3716233">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3716238">c1</span>&nbsp;<span class="op" id="3716241">:=</span>&nbsp;<span class="ident" id="3716244">msg</span><span class="op" id="3716247">[</span><span class="ident" id="3716248">off</span><span class="op" id="3716251">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3716256">off</span><span class="op" id="3716259">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3716265">if</span>&nbsp;<span class="ident" id="3716268">ptr</span>&nbsp;<span class="op" id="3716272">==</span>&nbsp;<span class="num" id="3716275">0</span>&nbsp;<span class="op" id="3716277">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3716283">off1</span>&nbsp;<span class="op" id="3716288">=</span>&nbsp;<span class="ident" id="3716290">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3716297">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3716302">if</span>&nbsp;<span class="ident" id="3716305">ptr</span><span class="op" id="3716308">++</span><span class="op" id="3716310">;</span>&nbsp;<span class="ident" id="3716312">ptr</span>&nbsp;<span class="op" id="3716316">&gt;</span>&nbsp;<span class="num" id="3716318">10</span>&nbsp;<span class="op" id="3716321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3716327">return</span>&nbsp;<span class="string" id="3716334">&#34;&#34;</span><span class="op" id="3716336">,</span>&nbsp;<span class="builtinfunc" id="3716338">len</span><span class="op" id="3716341">(</span><span class="ident" id="3716342">msg</span><span class="op" id="3716345">)</span><span class="op" id="3716346">,</span>&nbsp;<span class="builtintype" id="3716348">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3716357">}</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3716362">off</span>&nbsp;<span class="op" id="3716366">=</span>&nbsp;<span class="op" id="3716368">(</span><span class="ident" id="3716369">c</span><span class="op" id="3716370">^</span><span class="num" id="3716371">0xC0</span><span class="op" id="3716375">)</span><span class="op" id="3716376">&lt;&lt;</span><span class="num" id="3716378">8</span>&nbsp;<span class="op" id="3716380">|</span>&nbsp;<span class="builtintype" id="3716382">int</span><span class="op" id="3716385">(</span><span class="ident" id="3716386">c1</span><span class="op" id="3716388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3716392">default</span><span class="op" id="3716399">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3716404">//&nbsp;0x80&nbsp;and&nbsp;0x40&nbsp;are&nbsp;reserved</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3716437">return</span>&nbsp;<span class="string" id="3716444">&#34;&#34;</span><span class="op" id="3716446">,</span>&nbsp;<span class="builtinfunc" id="3716448">len</span><span class="op" id="3716451">(</span><span class="ident" id="3716452">msg</span><span class="op" id="3716455">)</span><span class="op" id="3716456">,</span>&nbsp;<span class="builtintype" id="3716458">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3716466">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3716469">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3716472">if</span>&nbsp;<span class="ident" id="3716475">ptr</span>&nbsp;<span class="op" id="3716479">==</span>&nbsp;<span class="num" id="3716482">0</span>&nbsp;<span class="op" id="3716484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3716488">off1</span>&nbsp;<span class="op" id="3716493">=</span>&nbsp;<span class="ident" id="3716495">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3716500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3716503">return</span>&nbsp;<span class="ident" id="3716510">s</span><span class="op" id="3716511">,</span>&nbsp;<span class="ident" id="3716513">off1</span><span class="op" id="3716517">,</span>&nbsp;<span class="builtintype" id="3716519">true</span><br>
<span class="lineno">485</span><span class="op" id="3716524">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3716527">//&nbsp;packStruct&nbsp;packs&nbsp;a&nbsp;structure&nbsp;into&nbsp;msg&nbsp;at&nbsp;specified&nbsp;offset&nbsp;off,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3716597">//&nbsp;returns&nbsp;off1&nbsp;such&nbsp;that&nbsp;msg[off:off1]&nbsp;is&nbsp;the&nbsp;encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="3716658">func</span>&nbsp;<span class="ident" id="3716663">packStruct</span><span class="op" id="3716673">(</span><span class="ident" id="3716674">any</span>&nbsp;<span class="ident" id="3716678">dnsStruct</span><span class="op" id="3716687">,</span>&nbsp;<span class="ident" id="3716689">msg</span>&nbsp;<span class="op" id="3716693">[</span><span class="op" id="3716694">]</span><span class="builtintype" id="3716695">byte</span><span class="op" id="3716699">,</span>&nbsp;<span class="ident" id="3716701">off</span>&nbsp;<span class="builtintype" id="3716705">int</span><span class="op" id="3716708">)</span>&nbsp;<span class="op" id="3716710">(</span><span class="ident" id="3716711">off1</span>&nbsp;<span class="builtintype" id="3716716">int</span><span class="op" id="3716719">,</span>&nbsp;<span class="ident" id="3716721">ok</span>&nbsp;<span class="builtintype" id="3716724">bool</span><span class="op" id="3716728">)</span>&nbsp;<span class="op" id="3716730">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3716733">ok</span>&nbsp;<span class="op" id="3716736">=</span>&nbsp;<span class="ident" id="3716738">any</span><span class="op" id="3716741">.</span><span class="ident" id="3716742">Walk</span><span class="op" id="3716746">(</span><span class="keyword" id="3716747">func</span><span class="op" id="3716751">(</span><span class="ident" id="3716752">field</span>&nbsp;<span class="keyword" id="3716758">interface</span><span class="op" id="3716767">{</span><span class="op" id="3716768">}</span><span class="op" id="3716769">,</span>&nbsp;<span class="ident" id="3716771">name</span><span class="op" id="3716775">,</span>&nbsp;<span class="ident" id="3716777">tag</span>&nbsp;<span class="builtintype" id="3716781">string</span><span class="op" id="3716787">)</span>&nbsp;<span class="builtintype" id="3716789">bool</span>&nbsp;<span class="op" id="3716794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3716798">switch</span>&nbsp;<span class="ident" id="3716805">fv</span>&nbsp;<span class="op" id="3716808">:=</span>&nbsp;<span class="ident" id="3716811">field</span><span class="op" id="3716816">.</span><span class="op" id="3716817">(</span><span class="keyword" id="3716818">type</span><span class="op" id="3716822">)</span>&nbsp;<span class="op" id="3716824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3716828">default</span><span class="op" id="3716835">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3716840">println</span><span class="op" id="3716847">(</span><span class="string" id="3716848">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;packing&nbsp;type&#34;</span><span class="op" id="3716880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3716885">return</span>&nbsp;<span class="builtintype" id="3716892">false</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3716900">case</span>&nbsp;<span class="op" id="3716905">*</span><span class="builtintype" id="3716906">uint16</span><span class="op" id="3716912">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3716917">i</span>&nbsp;<span class="op" id="3716919">:=</span>&nbsp;<span class="op" id="3716922">*</span><span class="ident" id="3716923">fv</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3716929">if</span>&nbsp;<span class="ident" id="3716932">off</span><span class="op" id="3716935">+</span><span class="num" id="3716936">2</span>&nbsp;<span class="op" id="3716938">&gt;</span>&nbsp;<span class="builtinfunc" id="3716940">len</span><span class="op" id="3716943">(</span><span class="ident" id="3716944">msg</span><span class="op" id="3716947">)</span>&nbsp;<span class="op" id="3716949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3716955">return</span>&nbsp;<span class="builtintype" id="3716962">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3716971">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3716976">msg</span><span class="op" id="3716979">[</span><span class="ident" id="3716980">off</span><span class="op" id="3716983">]</span>&nbsp;<span class="op" id="3716985">=</span>&nbsp;<span class="builtintype" id="3716987">byte</span><span class="op" id="3716991">(</span><span class="ident" id="3716992">i</span>&nbsp;<span class="op" id="3716994">&gt;&gt;</span>&nbsp;<span class="num" id="3716997">8</span><span class="op" id="3716998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3717003">msg</span><span class="op" id="3717006">[</span><span class="ident" id="3717007">off</span><span class="op" id="3717010">+</span><span class="num" id="3717011">1</span><span class="op" id="3717012">]</span>&nbsp;<span class="op" id="3717014">=</span>&nbsp;<span class="builtintype" id="3717016">byte</span><span class="op" id="3717020">(</span><span class="ident" id="3717021">i</span><span class="op" id="3717022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3717027">off</span>&nbsp;<span class="op" id="3717031">+=</span>&nbsp;<span class="num" id="3717034">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3717038">case</span>&nbsp;<span class="op" id="3717043">*</span><span class="builtintype" id="3717044">uint32</span><span class="op" id="3717050">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3717055">i</span>&nbsp;<span class="op" id="3717057">:=</span>&nbsp;<span class="op" id="3717060">*</span><span class="ident" id="3717061">fv</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3717067">msg</span><span class="op" id="3717070">[</span><span class="ident" id="3717071">off</span><span class="op" id="3717074">]</span>&nbsp;<span class="op" id="3717076">=</span>&nbsp;<span class="builtintype" id="3717078">byte</span><span class="op" id="3717082">(</span><span class="ident" id="3717083">i</span>&nbsp;<span class="op" id="3717085">&gt;&gt;</span>&nbsp;<span class="num" id="3717088">24</span><span class="op" id="3717090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3717095">msg</span><span class="op" id="3717098">[</span><span class="ident" id="3717099">off</span><span class="op" id="3717102">+</span><span class="num" id="3717103">1</span><span class="op" id="3717104">]</span>&nbsp;<span class="op" id="3717106">=</span>&nbsp;<span class="builtintype" id="3717108">byte</span><span class="op" id="3717112">(</span><span class="ident" id="3717113">i</span>&nbsp;<span class="op" id="3717115">&gt;&gt;</span>&nbsp;<span class="num" id="3717118">16</span><span class="op" id="3717120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3717125">msg</span><span class="op" id="3717128">[</span><span class="ident" id="3717129">off</span><span class="op" id="3717132">+</span><span class="num" id="3717133">2</span><span class="op" id="3717134">]</span>&nbsp;<span class="op" id="3717136">=</span>&nbsp;<span class="builtintype" id="3717138">byte</span><span class="op" id="3717142">(</span><span class="ident" id="3717143">i</span>&nbsp;<span class="op" id="3717145">&gt;&gt;</span>&nbsp;<span class="num" id="3717148">8</span><span class="op" id="3717149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3717154">msg</span><span class="op" id="3717157">[</span><span class="ident" id="3717158">off</span><span class="op" id="3717161">+</span><span class="num" id="3717162">3</span><span class="op" id="3717163">]</span>&nbsp;<span class="op" id="3717165">=</span>&nbsp;<span class="builtintype" id="3717167">byte</span><span class="op" id="3717171">(</span><span class="ident" id="3717172">i</span><span class="op" id="3717173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3717178">off</span>&nbsp;<span class="op" id="3717182">+=</span>&nbsp;<span class="num" id="3717185">4</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3717189">case</span>&nbsp;<span class="op" id="3717194">[</span><span class="op" id="3717195">]</span><span class="builtintype" id="3717196">byte</span><span class="op" id="3717200">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3717205">n</span>&nbsp;<span class="op" id="3717207">:=</span>&nbsp;<span class="builtinfunc" id="3717210">len</span><span class="op" id="3717213">(</span><span class="ident" id="3717214">fv</span><span class="op" id="3717216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3717221">if</span>&nbsp;<span class="ident" id="3717224">off</span><span class="op" id="3717227">+</span><span class="ident" id="3717228">n</span>&nbsp;<span class="op" id="3717230">&gt;</span>&nbsp;<span class="builtinfunc" id="3717232">len</span><span class="op" id="3717235">(</span><span class="ident" id="3717236">msg</span><span class="op" id="3717239">)</span>&nbsp;<span class="op" id="3717241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3717247">return</span>&nbsp;<span class="builtintype" id="3717254">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3717263">}</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3717268">copy</span><span class="op" id="3717272">(</span><span class="ident" id="3717273">msg</span><span class="op" id="3717276">[</span><span class="ident" id="3717277">off</span><span class="op" id="3717280">:</span><span class="ident" id="3717281">off</span><span class="op" id="3717284">+</span><span class="ident" id="3717285">n</span><span class="op" id="3717286">]</span><span class="op" id="3717287">,</span>&nbsp;<span class="ident" id="3717289">fv</span><span class="op" id="3717291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3717296">off</span>&nbsp;<span class="op" id="3717300">+=</span>&nbsp;<span class="ident" id="3717303">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3717307">case</span>&nbsp;<span class="op" id="3717312">*</span><span class="builtintype" id="3717313">string</span><span class="op" id="3717319">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3717324">s</span>&nbsp;<span class="op" id="3717326">:=</span>&nbsp;<span class="op" id="3717329">*</span><span class="ident" id="3717330">fv</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3717336">switch</span>&nbsp;<span class="ident" id="3717343">tag</span>&nbsp;<span class="op" id="3717347">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3717352">default</span><span class="op" id="3717359">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3717365">println</span><span class="op" id="3717372">(</span><span class="string" id="3717373">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;string&nbsp;tag&#34;</span><span class="op" id="3717403">,</span>&nbsp;<span class="ident" id="3717405">tag</span><span class="op" id="3717408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3717414">return</span>&nbsp;<span class="builtintype" id="3717421">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3717430">case</span>&nbsp;<span class="string" id="3717435">&#34;domain&#34;</span><span class="op" id="3717443">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3717449">off</span><span class="op" id="3717452">,</span>&nbsp;<span class="ident" id="3717454">ok</span>&nbsp;<span class="op" id="3717457">=</span>&nbsp;<span class="ident" id="3717459">packDomainName</span><span class="op" id="3717473">(</span><span class="ident" id="3717474">s</span><span class="op" id="3717475">,</span>&nbsp;<span class="ident" id="3717477">msg</span><span class="op" id="3717480">,</span>&nbsp;<span class="ident" id="3717482">off</span><span class="op" id="3717485">)</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3717491">if</span>&nbsp;<span class="op" id="3717494">!</span><span class="ident" id="3717495">ok</span>&nbsp;<span class="op" id="3717498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3717505">return</span>&nbsp;<span class="builtintype" id="3717512">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3717522">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3717527">case</span>&nbsp;<span class="string" id="3717532">&#34;&#34;</span><span class="op" id="3717534">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3717540">//&nbsp;Counted&nbsp;string:&nbsp;1&nbsp;byte&nbsp;length.</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3717578">if</span>&nbsp;<span class="builtinfunc" id="3717581">len</span><span class="op" id="3717584">(</span><span class="ident" id="3717585">s</span><span class="op" id="3717586">)</span>&nbsp;<span class="op" id="3717588">&gt;</span>&nbsp;<span class="num" id="3717590">255</span>&nbsp;<span class="op" id="3717594">||</span>&nbsp;<span class="ident" id="3717597">off</span><span class="op" id="3717600">+</span><span class="num" id="3717601">1</span><span class="op" id="3717602">+</span><span class="builtinfunc" id="3717603">len</span><span class="op" id="3717606">(</span><span class="ident" id="3717607">s</span><span class="op" id="3717608">)</span>&nbsp;<span class="op" id="3717610">&gt;</span>&nbsp;<span class="builtinfunc" id="3717612">len</span><span class="op" id="3717615">(</span><span class="ident" id="3717616">msg</span><span class="op" id="3717619">)</span>&nbsp;<span class="op" id="3717621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3717628">return</span>&nbsp;<span class="builtintype" id="3717635">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3717645">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3717651">msg</span><span class="op" id="3717654">[</span><span class="ident" id="3717655">off</span><span class="op" id="3717658">]</span>&nbsp;<span class="op" id="3717660">=</span>&nbsp;<span class="builtintype" id="3717662">byte</span><span class="op" id="3717666">(</span><span class="builtinfunc" id="3717667">len</span><span class="op" id="3717670">(</span><span class="ident" id="3717671">s</span><span class="op" id="3717672">)</span><span class="op" id="3717673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3717679">off</span><span class="op" id="3717682">++</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3717689">off</span>&nbsp;<span class="op" id="3717693">+=</span>&nbsp;<span class="builtinfunc" id="3717696">copy</span><span class="op" id="3717700">(</span><span class="ident" id="3717701">msg</span><span class="op" id="3717704">[</span><span class="ident" id="3717705">off</span><span class="op" id="3717708">:</span><span class="op" id="3717709">]</span><span class="op" id="3717710">,</span>&nbsp;<span class="ident" id="3717712">s</span><span class="op" id="3717713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3717718">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3717722">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3717726">return</span>&nbsp;<span class="builtintype" id="3717733">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3717739">}</span><span class="op" id="3717740">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3717743">if</span>&nbsp;<span class="op" id="3717746">!</span><span class="ident" id="3717747">ok</span>&nbsp;<span class="op" id="3717750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3717754">return</span>&nbsp;<span class="builtinfunc" id="3717761">len</span><span class="op" id="3717764">(</span><span class="ident" id="3717765">msg</span><span class="op" id="3717768">)</span><span class="op" id="3717769">,</span>&nbsp;<span class="builtintype" id="3717771">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3717778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3717781">return</span>&nbsp;<span class="ident" id="3717788">off</span><span class="op" id="3717791">,</span>&nbsp;<span class="builtintype" id="3717793">true</span><br>
<span class="lineno"></span><span class="op" id="3717798">}</span><br>
<span class="lineno">545</span><br>
<span class="lineno"></span><span class="comment" id="3717801">//&nbsp;unpackStruct&nbsp;decodes&nbsp;msg[off:] into&nbsp;the&nbsp;given&nbsp;structure,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3717866">//&nbsp;returns&nbsp;off1&nbsp;such&nbsp;that&nbsp;msg[off:off1]&nbsp;is&nbsp;the&nbsp;encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="3717927">func</span>&nbsp;<span class="ident" id="3717932">unpackStruct</span><span class="op" id="3717944">(</span><span class="ident" id="3717945">any</span>&nbsp;<span class="ident" id="3717949">dnsStruct</span><span class="op" id="3717958">,</span>&nbsp;<span class="ident" id="3717960">msg</span>&nbsp;<span class="op" id="3717964">[</span><span class="op" id="3717965">]</span><span class="builtintype" id="3717966">byte</span><span class="op" id="3717970">,</span>&nbsp;<span class="ident" id="3717972">off</span>&nbsp;<span class="builtintype" id="3717976">int</span><span class="op" id="3717979">)</span>&nbsp;<span class="op" id="3717981">(</span><span class="ident" id="3717982">off1</span>&nbsp;<span class="builtintype" id="3717987">int</span><span class="op" id="3717990">,</span>&nbsp;<span class="ident" id="3717992">ok</span>&nbsp;<span class="builtintype" id="3717995">bool</span><span class="op" id="3717999">)</span>&nbsp;<span class="op" id="3718001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3718004">ok</span>&nbsp;<span class="op" id="3718007">=</span>&nbsp;<span class="ident" id="3718009">any</span><span class="op" id="3718012">.</span><span class="ident" id="3718013">Walk</span><span class="op" id="3718017">(</span><span class="keyword" id="3718018">func</span><span class="op" id="3718022">(</span><span class="ident" id="3718023">field</span>&nbsp;<span class="keyword" id="3718029">interface</span><span class="op" id="3718038">{</span><span class="op" id="3718039">}</span><span class="op" id="3718040">,</span>&nbsp;<span class="ident" id="3718042">name</span><span class="op" id="3718046">,</span>&nbsp;<span class="ident" id="3718048">tag</span>&nbsp;<span class="builtintype" id="3718052">string</span><span class="op" id="3718058">)</span>&nbsp;<span class="builtintype" id="3718060">bool</span>&nbsp;<span class="op" id="3718065">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3718069">switch</span>&nbsp;<span class="ident" id="3718076">fv</span>&nbsp;<span class="op" id="3718079">:=</span>&nbsp;<span class="ident" id="3718082">field</span><span class="op" id="3718087">.</span><span class="op" id="3718088">(</span><span class="keyword" id="3718089">type</span><span class="op" id="3718093">)</span>&nbsp;<span class="op" id="3718095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3718099">default</span><span class="op" id="3718106">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3718111">println</span><span class="op" id="3718118">(</span><span class="string" id="3718119">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;packing&nbsp;type&#34;</span><span class="op" id="3718151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3718156">return</span>&nbsp;<span class="builtintype" id="3718163">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3718171">case</span>&nbsp;<span class="op" id="3718176">*</span><span class="builtintype" id="3718177">uint16</span><span class="op" id="3718183">:</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3718188">if</span>&nbsp;<span class="ident" id="3718191">off</span><span class="op" id="3718194">+</span><span class="num" id="3718195">2</span>&nbsp;<span class="op" id="3718197">&gt;</span>&nbsp;<span class="builtinfunc" id="3718199">len</span><span class="op" id="3718202">(</span><span class="ident" id="3718203">msg</span><span class="op" id="3718206">)</span>&nbsp;<span class="op" id="3718208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3718214">return</span>&nbsp;<span class="builtintype" id="3718221">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3718230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3718235">*</span><span class="ident" id="3718236">fv</span>&nbsp;<span class="op" id="3718239">=</span>&nbsp;<span class="builtintype" id="3718241">uint16</span><span class="op" id="3718247">(</span><span class="ident" id="3718248">msg</span><span class="op" id="3718251">[</span><span class="ident" id="3718252">off</span><span class="op" id="3718255">]</span><span class="op" id="3718256">)</span><span class="op" id="3718257">&lt;&lt;</span><span class="num" id="3718259">8</span>&nbsp;<span class="op" id="3718261">|</span>&nbsp;<span class="builtintype" id="3718263">uint16</span><span class="op" id="3718269">(</span><span class="ident" id="3718270">msg</span><span class="op" id="3718273">[</span><span class="ident" id="3718274">off</span><span class="op" id="3718277">+</span><span class="num" id="3718278">1</span><span class="op" id="3718279">]</span><span class="op" id="3718280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3718285">off</span>&nbsp;<span class="op" id="3718289">+=</span>&nbsp;<span class="num" id="3718292">2</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3718296">case</span>&nbsp;<span class="op" id="3718301">*</span><span class="builtintype" id="3718302">uint32</span><span class="op" id="3718308">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3718313">if</span>&nbsp;<span class="ident" id="3718316">off</span><span class="op" id="3718319">+</span><span class="num" id="3718320">4</span>&nbsp;<span class="op" id="3718322">&gt;</span>&nbsp;<span class="builtinfunc" id="3718324">len</span><span class="op" id="3718327">(</span><span class="ident" id="3718328">msg</span><span class="op" id="3718331">)</span>&nbsp;<span class="op" id="3718333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3718339">return</span>&nbsp;<span class="builtintype" id="3718346">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3718355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3718360">*</span><span class="ident" id="3718361">fv</span>&nbsp;<span class="op" id="3718364">=</span>&nbsp;<span class="builtintype" id="3718366">uint32</span><span class="op" id="3718372">(</span><span class="ident" id="3718373">msg</span><span class="op" id="3718376">[</span><span class="ident" id="3718377">off</span><span class="op" id="3718380">]</span><span class="op" id="3718381">)</span><span class="op" id="3718382">&lt;&lt;</span><span class="num" id="3718384">24</span>&nbsp;<span class="op" id="3718387">|</span>&nbsp;<span class="builtintype" id="3718389">uint32</span><span class="op" id="3718395">(</span><span class="ident" id="3718396">msg</span><span class="op" id="3718399">[</span><span class="ident" id="3718400">off</span><span class="op" id="3718403">+</span><span class="num" id="3718404">1</span><span class="op" id="3718405">]</span><span class="op" id="3718406">)</span><span class="op" id="3718407">&lt;&lt;</span><span class="num" id="3718409">16</span>&nbsp;<span class="op" id="3718412">|</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3718418">uint32</span><span class="op" id="3718424">(</span><span class="ident" id="3718425">msg</span><span class="op" id="3718428">[</span><span class="ident" id="3718429">off</span><span class="op" id="3718432">+</span><span class="num" id="3718433">2</span><span class="op" id="3718434">]</span><span class="op" id="3718435">)</span><span class="op" id="3718436">&lt;&lt;</span><span class="num" id="3718438">8</span>&nbsp;<span class="op" id="3718440">|</span>&nbsp;<span class="builtintype" id="3718442">uint32</span><span class="op" id="3718448">(</span><span class="ident" id="3718449">msg</span><span class="op" id="3718452">[</span><span class="ident" id="3718453">off</span><span class="op" id="3718456">+</span><span class="num" id="3718457">3</span><span class="op" id="3718458">]</span><span class="op" id="3718459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3718464">off</span>&nbsp;<span class="op" id="3718468">+=</span>&nbsp;<span class="num" id="3718471">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3718475">case</span>&nbsp;<span class="op" id="3718480">[</span><span class="op" id="3718481">]</span><span class="builtintype" id="3718482">byte</span><span class="op" id="3718486">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3718491">n</span>&nbsp;<span class="op" id="3718493">:=</span>&nbsp;<span class="builtinfunc" id="3718496">len</span><span class="op" id="3718499">(</span><span class="ident" id="3718500">fv</span><span class="op" id="3718502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3718507">if</span>&nbsp;<span class="ident" id="3718510">off</span><span class="op" id="3718513">+</span><span class="ident" id="3718514">n</span>&nbsp;<span class="op" id="3718516">&gt;</span>&nbsp;<span class="builtinfunc" id="3718518">len</span><span class="op" id="3718521">(</span><span class="ident" id="3718522">msg</span><span class="op" id="3718525">)</span>&nbsp;<span class="op" id="3718527">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3718533">return</span>&nbsp;<span class="builtintype" id="3718540">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3718549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3718554">copy</span><span class="op" id="3718558">(</span><span class="ident" id="3718559">fv</span><span class="op" id="3718561">,</span>&nbsp;<span class="ident" id="3718563">msg</span><span class="op" id="3718566">[</span><span class="ident" id="3718567">off</span><span class="op" id="3718570">:</span><span class="ident" id="3718571">off</span><span class="op" id="3718574">+</span><span class="ident" id="3718575">n</span><span class="op" id="3718576">]</span><span class="op" id="3718577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3718582">off</span>&nbsp;<span class="op" id="3718586">+=</span>&nbsp;<span class="ident" id="3718589">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3718593">case</span>&nbsp;<span class="op" id="3718598">*</span><span class="builtintype" id="3718599">string</span><span class="op" id="3718605">:</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3718610">var</span>&nbsp;<span class="ident" id="3718614">s</span>&nbsp;<span class="builtintype" id="3718616">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3718626">switch</span>&nbsp;<span class="ident" id="3718633">tag</span>&nbsp;<span class="op" id="3718637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3718642">default</span><span class="op" id="3718649">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3718655">println</span><span class="op" id="3718662">(</span><span class="string" id="3718663">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;string&nbsp;tag&#34;</span><span class="op" id="3718693">,</span>&nbsp;<span class="ident" id="3718695">tag</span><span class="op" id="3718698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3718704">return</span>&nbsp;<span class="builtintype" id="3718711">false</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3718720">case</span>&nbsp;<span class="string" id="3718725">&#34;domain&#34;</span><span class="op" id="3718733">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3718739">s</span><span class="op" id="3718740">,</span>&nbsp;<span class="ident" id="3718742">off</span><span class="op" id="3718745">,</span>&nbsp;<span class="ident" id="3718747">ok</span>&nbsp;<span class="op" id="3718750">=</span>&nbsp;<span class="ident" id="3718752">unpackDomainName</span><span class="op" id="3718768">(</span><span class="ident" id="3718769">msg</span><span class="op" id="3718772">,</span>&nbsp;<span class="ident" id="3718774">off</span><span class="op" id="3718777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3718783">if</span>&nbsp;<span class="op" id="3718786">!</span><span class="ident" id="3718787">ok</span>&nbsp;<span class="op" id="3718790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3718797">return</span>&nbsp;<span class="builtintype" id="3718804">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3718814">}</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3718819">case</span>&nbsp;<span class="string" id="3718824">&#34;&#34;</span><span class="op" id="3718826">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3718832">if</span>&nbsp;<span class="ident" id="3718835">off</span>&nbsp;<span class="op" id="3718839">&gt;=</span>&nbsp;<span class="builtinfunc" id="3718842">len</span><span class="op" id="3718845">(</span><span class="ident" id="3718846">msg</span><span class="op" id="3718849">)</span>&nbsp;<span class="op" id="3718851">||</span>&nbsp;<span class="ident" id="3718854">off</span><span class="op" id="3718857">+</span><span class="num" id="3718858">1</span><span class="op" id="3718859">+</span><span class="builtintype" id="3718860">int</span><span class="op" id="3718863">(</span><span class="ident" id="3718864">msg</span><span class="op" id="3718867">[</span><span class="ident" id="3718868">off</span><span class="op" id="3718871">]</span><span class="op" id="3718872">)</span>&nbsp;<span class="op" id="3718874">&gt;</span>&nbsp;<span class="builtinfunc" id="3718876">len</span><span class="op" id="3718879">(</span><span class="ident" id="3718880">msg</span><span class="op" id="3718883">)</span>&nbsp;<span class="op" id="3718885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3718892">return</span>&nbsp;<span class="builtintype" id="3718899">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3718909">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3718915">n</span>&nbsp;<span class="op" id="3718917">:=</span>&nbsp;<span class="builtintype" id="3718920">int</span><span class="op" id="3718923">(</span><span class="ident" id="3718924">msg</span><span class="op" id="3718927">[</span><span class="ident" id="3718928">off</span><span class="op" id="3718931">]</span><span class="op" id="3718932">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3718938">off</span><span class="op" id="3718941">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3718948">b</span>&nbsp;<span class="op" id="3718950">:=</span>&nbsp;<span class="builtinfunc" id="3718953">make</span><span class="op" id="3718957">(</span><span class="op" id="3718958">[</span><span class="op" id="3718959">]</span><span class="builtintype" id="3718960">byte</span><span class="op" id="3718964">,</span>&nbsp;<span class="ident" id="3718966">n</span><span class="op" id="3718967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3718973">for</span>&nbsp;<span class="ident" id="3718977">i</span>&nbsp;<span class="op" id="3718979">:=</span>&nbsp;<span class="num" id="3718982">0</span><span class="op" id="3718983">;</span>&nbsp;<span class="ident" id="3718985">i</span>&nbsp;<span class="op" id="3718987">&lt;</span>&nbsp;<span class="ident" id="3718989">n</span><span class="op" id="3718990">;</span>&nbsp;<span class="ident" id="3718992">i</span><span class="op" id="3718993">++</span>&nbsp;<span class="op" id="3718996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3719003">b</span><span class="op" id="3719004">[</span><span class="ident" id="3719005">i</span><span class="op" id="3719006">]</span>&nbsp;<span class="op" id="3719008">=</span>&nbsp;<span class="ident" id="3719010">msg</span><span class="op" id="3719013">[</span><span class="ident" id="3719014">off</span><span class="op" id="3719017">+</span><span class="ident" id="3719018">i</span><span class="op" id="3719019">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3719025">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3719031">off</span>&nbsp;<span class="op" id="3719035">+=</span>&nbsp;<span class="ident" id="3719038">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3719044">s</span>&nbsp;<span class="op" id="3719046">=</span>&nbsp;<span class="builtintype" id="3719048">string</span><span class="op" id="3719054">(</span><span class="ident" id="3719055">b</span><span class="op" id="3719056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3719061">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3719066">*</span><span class="ident" id="3719067">fv</span>&nbsp;<span class="op" id="3719070">=</span>&nbsp;<span class="ident" id="3719072">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3719076">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3719080">return</span>&nbsp;<span class="builtintype" id="3719087">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3719093">}</span><span class="op" id="3719094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3719097">if</span>&nbsp;<span class="op" id="3719100">!</span><span class="ident" id="3719101">ok</span>&nbsp;<span class="op" id="3719104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3719108">return</span>&nbsp;<span class="builtinfunc" id="3719115">len</span><span class="op" id="3719118">(</span><span class="ident" id="3719119">msg</span><span class="op" id="3719122">)</span><span class="op" id="3719123">,</span>&nbsp;<span class="builtintype" id="3719125">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3719132">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3719135">return</span>&nbsp;<span class="ident" id="3719142">off</span><span class="op" id="3719145">,</span>&nbsp;<span class="builtintype" id="3719147">true</span><br>
<span class="lineno"></span><span class="op" id="3719152">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3719155">//&nbsp;Generic&nbsp;struct&nbsp;printer.&nbsp;Prints&nbsp;fields&nbsp;with&nbsp;tag&nbsp;&#34;ipv4&#34;&nbsp;or&nbsp;&#34;ipv6&#34;</span><br>
<span class="lineno"></span><span class="comment" id="3719222">//&nbsp;as&nbsp;IP&nbsp;addresses.</span><br>
<span class="lineno">610</span><span class="keyword" id="3719242">func</span>&nbsp;<span class="ident" id="3719247">printStruct</span><span class="op" id="3719258">(</span><span class="ident" id="3719259">any</span>&nbsp;<span class="ident" id="3719263">dnsStruct</span><span class="op" id="3719272">)</span>&nbsp;<span class="builtintype" id="3719274">string</span>&nbsp;<span class="op" id="3719281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3719284">s</span>&nbsp;<span class="op" id="3719286">:=</span>&nbsp;<span class="string" id="3719289">&#34;{&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3719294">i</span>&nbsp;<span class="op" id="3719296">:=</span>&nbsp;<span class="num" id="3719299">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3719302">any</span><span class="op" id="3719305">.</span><span class="ident" id="3719306">Walk</span><span class="op" id="3719310">(</span><span class="keyword" id="3719311">func</span><span class="op" id="3719315">(</span><span class="ident" id="3719316">val</span>&nbsp;<span class="keyword" id="3719320">interface</span><span class="op" id="3719329">{</span><span class="op" id="3719330">}</span><span class="op" id="3719331">,</span>&nbsp;<span class="ident" id="3719333">name</span><span class="op" id="3719337">,</span>&nbsp;<span class="ident" id="3719339">tag</span>&nbsp;<span class="builtintype" id="3719343">string</span><span class="op" id="3719349">)</span>&nbsp;<span class="builtintype" id="3719351">bool</span>&nbsp;<span class="op" id="3719356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3719360">i</span><span class="op" id="3719361">++</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3719366">if</span>&nbsp;<span class="ident" id="3719369">i</span>&nbsp;<span class="op" id="3719371">&gt;</span>&nbsp;<span class="num" id="3719373">1</span>&nbsp;<span class="op" id="3719375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3719380">s</span>&nbsp;<span class="op" id="3719382">+=</span>&nbsp;<span class="string" id="3719385">&#34;,&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3719392">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3719396">s</span>&nbsp;<span class="op" id="3719398">+=</span>&nbsp;<span class="ident" id="3719401">name</span>&nbsp;<span class="op" id="3719406">+</span>&nbsp;<span class="string" id="3719408">&#34;=&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3719414">switch</span>&nbsp;<span class="ident" id="3719421">tag</span>&nbsp;<span class="op" id="3719425">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3719429">case</span>&nbsp;<span class="string" id="3719434">&#34;ipv4&#34;</span><span class="op" id="3719440">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3719445">i</span>&nbsp;<span class="op" id="3719447">:=</span>&nbsp;<span class="op" id="3719450">*</span><span class="ident" id="3719451">val</span><span class="op" id="3719454">.</span><span class="op" id="3719455">(</span><span class="op" id="3719456">*</span><span class="builtintype" id="3719457">uint32</span><span class="op" id="3719463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3719468">s</span>&nbsp;<span class="op" id="3719470">+=</span>&nbsp;<span class="ident" id="3719473">IPv4</span><span class="op" id="3719477">(</span><span class="builtintype" id="3719478">byte</span><span class="op" id="3719482">(</span><span class="ident" id="3719483">i</span><span class="op" id="3719484">&gt;&gt;</span><span class="num" id="3719486">24</span><span class="op" id="3719488">)</span><span class="op" id="3719489">,</span>&nbsp;<span class="builtintype" id="3719491">byte</span><span class="op" id="3719495">(</span><span class="ident" id="3719496">i</span><span class="op" id="3719497">&gt;&gt;</span><span class="num" id="3719499">16</span><span class="op" id="3719501">)</span><span class="op" id="3719502">,</span>&nbsp;<span class="builtintype" id="3719504">byte</span><span class="op" id="3719508">(</span><span class="ident" id="3719509">i</span><span class="op" id="3719510">&gt;&gt;</span><span class="num" id="3719512">8</span><span class="op" id="3719513">)</span><span class="op" id="3719514">,</span>&nbsp;<span class="builtintype" id="3719516">byte</span><span class="op" id="3719520">(</span><span class="ident" id="3719521">i</span><span class="op" id="3719522">)</span><span class="op" id="3719523">)</span><span class="op" id="3719524">.</span><span class="ident" id="3719525">String</span><span class="op" id="3719531">(</span><span class="op" id="3719532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3719536">case</span>&nbsp;<span class="string" id="3719541">&#34;ipv6&#34;</span><span class="op" id="3719547">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3719552">i</span>&nbsp;<span class="op" id="3719554">:=</span>&nbsp;<span class="ident" id="3719557">val</span><span class="op" id="3719560">.</span><span class="op" id="3719561">(</span><span class="op" id="3719562">[</span><span class="op" id="3719563">]</span><span class="builtintype" id="3719564">byte</span><span class="op" id="3719568">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3719573">s</span>&nbsp;<span class="op" id="3719575">+=</span>&nbsp;<span class="ident" id="3719578">IP</span><span class="op" id="3719580">(</span><span class="ident" id="3719581">i</span><span class="op" id="3719582">)</span><span class="op" id="3719583">.</span><span class="ident" id="3719584">String</span><span class="op" id="3719590">(</span><span class="op" id="3719591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3719595">default</span><span class="op" id="3719602">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3719607">var</span>&nbsp;<span class="ident" id="3719611">i</span>&nbsp;<span class="builtintype" id="3719613">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3719622">switch</span>&nbsp;<span class="ident" id="3719629">v</span>&nbsp;<span class="op" id="3719631">:=</span>&nbsp;<span class="ident" id="3719634">val</span><span class="op" id="3719637">.</span><span class="op" id="3719638">(</span><span class="keyword" id="3719639">type</span><span class="op" id="3719643">)</span>&nbsp;<span class="op" id="3719645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3719650">default</span><span class="op" id="3719657">:</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3719663">//&nbsp;can&#39;t&nbsp;really&nbsp;happen.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3719691">s</span>&nbsp;<span class="op" id="3719693">+=</span>&nbsp;<span class="string" id="3719696">&#34;&lt;unknown&nbsp;type&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3719717">return</span>&nbsp;<span class="builtintype" id="3719724">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3719732">case</span>&nbsp;<span class="op" id="3719737">*</span><span class="builtintype" id="3719738">string</span><span class="op" id="3719744">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3719750">s</span>&nbsp;<span class="op" id="3719752">+=</span>&nbsp;<span class="op" id="3719755">*</span><span class="ident" id="3719756">v</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3719762">return</span>&nbsp;<span class="builtintype" id="3719769">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3719777">case</span>&nbsp;<span class="op" id="3719782">[</span><span class="op" id="3719783">]</span><span class="builtintype" id="3719784">byte</span><span class="op" id="3719788">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3719794">s</span>&nbsp;<span class="op" id="3719796">+=</span>&nbsp;<span class="builtintype" id="3719799">string</span><span class="op" id="3719805">(</span><span class="ident" id="3719806">v</span><span class="op" id="3719807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3719813">return</span>&nbsp;<span class="builtintype" id="3719820">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3719828">case</span>&nbsp;<span class="op" id="3719833">*</span><span class="builtintype" id="3719834">bool</span><span class="op" id="3719838">:</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3719844">if</span>&nbsp;<span class="op" id="3719847">*</span><span class="ident" id="3719848">v</span>&nbsp;<span class="op" id="3719850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3719857">s</span>&nbsp;<span class="op" id="3719859">+=</span>&nbsp;<span class="string" id="3719862">&#34;true&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3719873">}</span>&nbsp;<span class="keyword" id="3719875">else</span>&nbsp;<span class="op" id="3719880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3719887">s</span>&nbsp;<span class="op" id="3719889">+=</span>&nbsp;<span class="string" id="3719892">&#34;false&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3719904">}</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3719910">return</span>&nbsp;<span class="builtintype" id="3719917">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3719925">case</span>&nbsp;<span class="op" id="3719930">*</span><span class="builtintype" id="3719931">int</span><span class="op" id="3719934">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3719940">i</span>&nbsp;<span class="op" id="3719942">=</span>&nbsp;<span class="builtintype" id="3719944">int64</span><span class="op" id="3719949">(</span><span class="op" id="3719950">*</span><span class="ident" id="3719951">v</span><span class="op" id="3719952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3719957">case</span>&nbsp;<span class="op" id="3719962">*</span><span class="builtintype" id="3719963">uint</span><span class="op" id="3719967">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3719973">i</span>&nbsp;<span class="op" id="3719975">=</span>&nbsp;<span class="builtintype" id="3719977">int64</span><span class="op" id="3719982">(</span><span class="op" id="3719983">*</span><span class="ident" id="3719984">v</span><span class="op" id="3719985">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3719990">case</span>&nbsp;<span class="op" id="3719995">*</span><span class="builtintype" id="3719996">uint8</span><span class="op" id="3720001">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3720007">i</span>&nbsp;<span class="op" id="3720009">=</span>&nbsp;<span class="builtintype" id="3720011">int64</span><span class="op" id="3720016">(</span><span class="op" id="3720017">*</span><span class="ident" id="3720018">v</span><span class="op" id="3720019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3720024">case</span>&nbsp;<span class="op" id="3720029">*</span><span class="builtintype" id="3720030">uint16</span><span class="op" id="3720036">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3720042">i</span>&nbsp;<span class="op" id="3720044">=</span>&nbsp;<span class="builtintype" id="3720046">int64</span><span class="op" id="3720051">(</span><span class="op" id="3720052">*</span><span class="ident" id="3720053">v</span><span class="op" id="3720054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3720059">case</span>&nbsp;<span class="op" id="3720064">*</span><span class="builtintype" id="3720065">uint32</span><span class="op" id="3720071">:</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3720077">i</span>&nbsp;<span class="op" id="3720079">=</span>&nbsp;<span class="builtintype" id="3720081">int64</span><span class="op" id="3720086">(</span><span class="op" id="3720087">*</span><span class="ident" id="3720088">v</span><span class="op" id="3720089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3720094">case</span>&nbsp;<span class="op" id="3720099">*</span><span class="builtintype" id="3720100">uint64</span><span class="op" id="3720106">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3720112">i</span>&nbsp;<span class="op" id="3720114">=</span>&nbsp;<span class="builtintype" id="3720116">int64</span><span class="op" id="3720121">(</span><span class="op" id="3720122">*</span><span class="ident" id="3720123">v</span><span class="op" id="3720124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3720129">case</span>&nbsp;<span class="op" id="3720134">*</span><span class="builtintype" id="3720135">uintptr</span><span class="op" id="3720142">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3720148">i</span>&nbsp;<span class="op" id="3720150">=</span>&nbsp;<span class="builtintype" id="3720152">int64</span><span class="op" id="3720157">(</span><span class="op" id="3720158">*</span><span class="ident" id="3720159">v</span><span class="op" id="3720160">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3720165">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3720170">s</span>&nbsp;<span class="op" id="3720172">+=</span>&nbsp;<span class="ident" id="3720175">itoa</span><span class="op" id="3720179">(</span><span class="builtintype" id="3720180">int</span><span class="op" id="3720183">(</span><span class="ident" id="3720184">i</span><span class="op" id="3720185">)</span><span class="op" id="3720186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3720190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3720194">return</span>&nbsp;<span class="builtintype" id="3720201">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3720207">}</span><span class="op" id="3720208">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3720211">s</span>&nbsp;<span class="op" id="3720213">+=</span>&nbsp;<span class="string" id="3720216">&#34;}&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3720221">return</span>&nbsp;<span class="ident" id="3720228">s</span><br>
<span class="lineno"></span><span class="op" id="3720230">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3720233">//&nbsp;Resource&nbsp;record&nbsp;packer.</span><br>
<span class="lineno">670</span><span class="keyword" id="3720260">func</span>&nbsp;<span class="ident" id="3720265">packRR</span><span class="op" id="3720271">(</span><span class="ident" id="3720272">rr</span>&nbsp;<span class="ident" id="3720275">dnsRR</span><span class="op" id="3720280">,</span>&nbsp;<span class="ident" id="3720282">msg</span>&nbsp;<span class="op" id="3720286">[</span><span class="op" id="3720287">]</span><span class="builtintype" id="3720288">byte</span><span class="op" id="3720292">,</span>&nbsp;<span class="ident" id="3720294">off</span>&nbsp;<span class="builtintype" id="3720298">int</span><span class="op" id="3720301">)</span>&nbsp;<span class="op" id="3720303">(</span><span class="ident" id="3720304">off2</span>&nbsp;<span class="builtintype" id="3720309">int</span><span class="op" id="3720312">,</span>&nbsp;<span class="ident" id="3720314">ok</span>&nbsp;<span class="builtintype" id="3720317">bool</span><span class="op" id="3720321">)</span>&nbsp;<span class="op" id="3720323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3720326">var</span>&nbsp;<span class="ident" id="3720330">off1</span>&nbsp;<span class="builtintype" id="3720335">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3720340">//&nbsp;pack&nbsp;twice,&nbsp;once&nbsp;to&nbsp;find&nbsp;end&nbsp;of&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3720383">//&nbsp;and&nbsp;again&nbsp;to&nbsp;find&nbsp;end&nbsp;of&nbsp;packet.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3720420">//&nbsp;a&nbsp;bit&nbsp;inefficient&nbsp;but&nbsp;this&nbsp;doesn&#39;t&nbsp;need&nbsp;to&nbsp;be&nbsp;fast.</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3720476">//&nbsp;off1&nbsp;is&nbsp;end&nbsp;of&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3720502">//&nbsp;off2&nbsp;is&nbsp;end&nbsp;of&nbsp;rr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3720524">off1</span><span class="op" id="3720528">,</span>&nbsp;<span class="ident" id="3720530">ok</span>&nbsp;<span class="op" id="3720533">=</span>&nbsp;<span class="ident" id="3720535">packStruct</span><span class="op" id="3720545">(</span><span class="ident" id="3720546">rr</span><span class="op" id="3720548">.</span><span class="ident" id="3720549">Header</span><span class="op" id="3720555">(</span><span class="op" id="3720556">)</span><span class="op" id="3720557">,</span>&nbsp;<span class="ident" id="3720559">msg</span><span class="op" id="3720562">,</span>&nbsp;<span class="ident" id="3720564">off</span><span class="op" id="3720567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3720570">off2</span><span class="op" id="3720574">,</span>&nbsp;<span class="ident" id="3720576">ok</span>&nbsp;<span class="op" id="3720579">=</span>&nbsp;<span class="ident" id="3720581">packStruct</span><span class="op" id="3720591">(</span><span class="ident" id="3720592">rr</span><span class="op" id="3720594">,</span>&nbsp;<span class="ident" id="3720596">msg</span><span class="op" id="3720599">,</span>&nbsp;<span class="ident" id="3720601">off</span><span class="op" id="3720604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3720607">if</span>&nbsp;<span class="op" id="3720610">!</span><span class="ident" id="3720611">ok</span>&nbsp;<span class="op" id="3720614">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3720618">return</span>&nbsp;<span class="builtinfunc" id="3720625">len</span><span class="op" id="3720628">(</span><span class="ident" id="3720629">msg</span><span class="op" id="3720632">)</span><span class="op" id="3720633">,</span>&nbsp;<span class="builtintype" id="3720635">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3720642">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3720645">//&nbsp;pack&nbsp;a&nbsp;third&nbsp;time;&nbsp;redo&nbsp;header&nbsp;with&nbsp;correct&nbsp;data&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3720705">rr</span><span class="op" id="3720707">.</span><span class="ident" id="3720708">Header</span><span class="op" id="3720714">(</span><span class="op" id="3720715">)</span><span class="op" id="3720716">.</span><span class="ident" id="3720717">Rdlength</span>&nbsp;<span class="op" id="3720726">=</span>&nbsp;<span class="builtintype" id="3720728">uint16</span><span class="op" id="3720734">(</span><span class="ident" id="3720735">off2</span>&nbsp;<span class="op" id="3720740">-</span>&nbsp;<span class="ident" id="3720742">off1</span><span class="op" id="3720746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3720749">packStruct</span><span class="op" id="3720759">(</span><span class="ident" id="3720760">rr</span><span class="op" id="3720762">.</span><span class="ident" id="3720763">Header</span><span class="op" id="3720769">(</span><span class="op" id="3720770">)</span><span class="op" id="3720771">,</span>&nbsp;<span class="ident" id="3720773">msg</span><span class="op" id="3720776">,</span>&nbsp;<span class="ident" id="3720778">off</span><span class="op" id="3720781">)</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3720784">return</span>&nbsp;<span class="ident" id="3720791">off2</span><span class="op" id="3720795">,</span>&nbsp;<span class="builtintype" id="3720797">true</span><br>
<span class="lineno"></span><span class="op" id="3720802">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3720805">//&nbsp;Resource&nbsp;record&nbsp;unpacker.</span><br>
<span class="lineno"></span><span class="keyword" id="3720834">func</span>&nbsp;<span class="ident" id="3720839">unpackRR</span><span class="op" id="3720847">(</span><span class="ident" id="3720848">msg</span>&nbsp;<span class="op" id="3720852">[</span><span class="op" id="3720853">]</span><span class="builtintype" id="3720854">byte</span><span class="op" id="3720858">,</span>&nbsp;<span class="ident" id="3720860">off</span>&nbsp;<span class="builtintype" id="3720864">int</span><span class="op" id="3720867">)</span>&nbsp;<span class="op" id="3720869">(</span><span class="ident" id="3720870">rr</span>&nbsp;<span class="ident" id="3720873">dnsRR</span><span class="op" id="3720878">,</span>&nbsp;<span class="ident" id="3720880">off1</span>&nbsp;<span class="builtintype" id="3720885">int</span><span class="op" id="3720888">,</span>&nbsp;<span class="ident" id="3720890">ok</span>&nbsp;<span class="builtintype" id="3720893">bool</span><span class="op" id="3720897">)</span>&nbsp;<span class="op" id="3720899">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3720902">//&nbsp;unpack&nbsp;just&nbsp;the&nbsp;header,&nbsp;to&nbsp;find&nbsp;the&nbsp;rr&nbsp;type&nbsp;and&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3720961">var</span>&nbsp;<span class="ident" id="3720965">h</span>&nbsp;<span class="ident" id="3720967">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3720981">off0</span>&nbsp;<span class="op" id="3720986">:=</span>&nbsp;<span class="ident" id="3720989">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3720994">if</span>&nbsp;<span class="ident" id="3720997">off</span><span class="op" id="3721000">,</span>&nbsp;<span class="ident" id="3721002">ok</span>&nbsp;<span class="op" id="3721005">=</span>&nbsp;<span class="ident" id="3721007">unpackStruct</span><span class="op" id="3721019">(</span><span class="op" id="3721020">&amp;</span><span class="ident" id="3721021">h</span><span class="op" id="3721022">,</span>&nbsp;<span class="ident" id="3721024">msg</span><span class="op" id="3721027">,</span>&nbsp;<span class="ident" id="3721029">off</span><span class="op" id="3721032">)</span><span class="op" id="3721033">;</span>&nbsp;<span class="op" id="3721035">!</span><span class="ident" id="3721036">ok</span>&nbsp;<span class="op" id="3721039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3721043">return</span>&nbsp;<span class="builtintype" id="3721050">nil</span><span class="op" id="3721053">,</span>&nbsp;<span class="builtinfunc" id="3721055">len</span><span class="op" id="3721058">(</span><span class="ident" id="3721059">msg</span><span class="op" id="3721062">)</span><span class="op" id="3721063">,</span>&nbsp;<span class="builtintype" id="3721065">false</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3721072">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3721075">end</span>&nbsp;<span class="op" id="3721079">:=</span>&nbsp;<span class="ident" id="3721082">off</span>&nbsp;<span class="op" id="3721086">+</span>&nbsp;<span class="builtintype" id="3721088">int</span><span class="op" id="3721091">(</span><span class="ident" id="3721092">h</span><span class="op" id="3721093">.</span><span class="ident" id="3721094">Rdlength</span><span class="op" id="3721102">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3721106">//&nbsp;make&nbsp;an&nbsp;rr&nbsp;of&nbsp;that&nbsp;type&nbsp;and&nbsp;re-unpack.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3721149">//&nbsp;again&nbsp;inefficient&nbsp;but&nbsp;doesn&#39;t&nbsp;need&nbsp;to&nbsp;be&nbsp;fast.</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3721200">mk</span><span class="op" id="3721202">,</span>&nbsp;<span class="ident" id="3721204">known</span>&nbsp;<span class="op" id="3721210">:=</span>&nbsp;<span class="ident" id="3721213">rr_mk</span><span class="op" id="3721218">[</span><span class="builtintype" id="3721219">int</span><span class="op" id="3721222">(</span><span class="ident" id="3721223">h</span><span class="op" id="3721224">.</span><span class="ident" id="3721225">Rrtype</span><span class="op" id="3721231">)</span><span class="op" id="3721232">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3721235">if</span>&nbsp;<span class="op" id="3721238">!</span><span class="ident" id="3721239">known</span>&nbsp;<span class="op" id="3721245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3721249">return</span>&nbsp;<span class="op" id="3721256">&amp;</span><span class="ident" id="3721257">h</span><span class="op" id="3721258">,</span>&nbsp;<span class="ident" id="3721260">end</span><span class="op" id="3721263">,</span>&nbsp;<span class="builtintype" id="3721265">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3721271">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3721274">rr</span>&nbsp;<span class="op" id="3721277">=</span>&nbsp;<span class="ident" id="3721279">mk</span><span class="op" id="3721281">(</span><span class="op" id="3721282">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3721285">off</span><span class="op" id="3721288">,</span>&nbsp;<span class="ident" id="3721290">ok</span>&nbsp;<span class="op" id="3721293">=</span>&nbsp;<span class="ident" id="3721295">unpackStruct</span><span class="op" id="3721307">(</span><span class="ident" id="3721308">rr</span><span class="op" id="3721310">,</span>&nbsp;<span class="ident" id="3721312">msg</span><span class="op" id="3721315">,</span>&nbsp;<span class="ident" id="3721317">off0</span><span class="op" id="3721321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3721324">if</span>&nbsp;<span class="ident" id="3721327">off</span>&nbsp;<span class="op" id="3721331">!=</span>&nbsp;<span class="ident" id="3721334">end</span>&nbsp;<span class="op" id="3721338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3721342">return</span>&nbsp;<span class="op" id="3721349">&amp;</span><span class="ident" id="3721350">h</span><span class="op" id="3721351">,</span>&nbsp;<span class="ident" id="3721353">end</span><span class="op" id="3721356">,</span>&nbsp;<span class="builtintype" id="3721358">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3721364">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3721367">return</span>&nbsp;<span class="ident" id="3721374">rr</span><span class="op" id="3721376">,</span>&nbsp;<span class="ident" id="3721378">off</span><span class="op" id="3721381">,</span>&nbsp;<span class="ident" id="3721383">ok</span><br>
<span class="lineno">710</span><span class="op" id="3721386">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3721389">//&nbsp;Usable&nbsp;representation&nbsp;of&nbsp;a&nbsp;DNS&nbsp;packet.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3721432">//&nbsp;A&nbsp;manually-unpacked&nbsp;version&nbsp;of&nbsp;(id,&nbsp;bits).</span><br>
<span class="lineno">715</span><span class="comment" id="3721478">//&nbsp;This&nbsp;is&nbsp;in&nbsp;its&nbsp;own&nbsp;struct&nbsp;for&nbsp;easy&nbsp;printing.</span><br>
<span class="lineno"></span><span class="keyword" id="3721526">type</span>&nbsp;<span class="ident" id="3721531">dnsMsgHdr</span>&nbsp;<span class="keyword" id="3721541">struct</span>&nbsp;<span class="op" id="3721548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3721551">id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3721571">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3721579">response</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3721599">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3721605">opcode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3721625">int</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3721630">authoritative</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3721650">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3721656">truncated</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3721676">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3721682">recursion_desired</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3721702">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3721708">recursion_available</span>&nbsp;<span class="builtintype" id="3721728">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3721734">rcode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3721754">int</span><br>
<span class="lineno">725</span><span class="op" id="3721758">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3721761">func</span>&nbsp;<span class="op" id="3721766">(</span><span class="ident" id="3721767">h</span>&nbsp;<span class="op" id="3721769">*</span><span class="ident" id="3721770">dnsMsgHdr</span><span class="op" id="3721779">)</span>&nbsp;<span class="ident" id="3721781">Walk</span><span class="op" id="3721785">(</span><span class="ident" id="3721786">f</span>&nbsp;<span class="keyword" id="3721788">func</span><span class="op" id="3721792">(</span><span class="ident" id="3721793">v</span>&nbsp;<span class="keyword" id="3721795">interface</span><span class="op" id="3721804">{</span><span class="op" id="3721805">}</span><span class="op" id="3721806">,</span>&nbsp;<span class="ident" id="3721808">name</span><span class="op" id="3721812">,</span>&nbsp;<span class="ident" id="3721814">tag</span>&nbsp;<span class="builtintype" id="3721818">string</span><span class="op" id="3721824">)</span>&nbsp;<span class="builtintype" id="3721826">bool</span><span class="op" id="3721830">)</span>&nbsp;<span class="builtintype" id="3721832">bool</span>&nbsp;<span class="op" id="3721837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3721840">return</span>&nbsp;<span class="ident" id="3721847">f</span><span class="op" id="3721848">(</span><span class="op" id="3721849">&amp;</span><span class="ident" id="3721850">h</span><span class="op" id="3721851">.</span><span class="ident" id="3721852">id</span><span class="op" id="3721854">,</span>&nbsp;<span class="string" id="3721856">&#34;id&#34;</span><span class="op" id="3721860">,</span>&nbsp;<span class="string" id="3721862">&#34;&#34;</span><span class="op" id="3721864">)</span>&nbsp;<span class="op" id="3721866">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3721871">f</span><span class="op" id="3721872">(</span><span class="op" id="3721873">&amp;</span><span class="ident" id="3721874">h</span><span class="op" id="3721875">.</span><span class="ident" id="3721876">response</span><span class="op" id="3721884">,</span>&nbsp;<span class="string" id="3721886">&#34;response&#34;</span><span class="op" id="3721896">,</span>&nbsp;<span class="string" id="3721898">&#34;&#34;</span><span class="op" id="3721900">)</span>&nbsp;<span class="op" id="3721902">&amp;&amp;</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3721907">f</span><span class="op" id="3721908">(</span><span class="op" id="3721909">&amp;</span><span class="ident" id="3721910">h</span><span class="op" id="3721911">.</span><span class="ident" id="3721912">opcode</span><span class="op" id="3721918">,</span>&nbsp;<span class="string" id="3721920">&#34;opcode&#34;</span><span class="op" id="3721928">,</span>&nbsp;<span class="string" id="3721930">&#34;&#34;</span><span class="op" id="3721932">)</span>&nbsp;<span class="op" id="3721934">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3721939">f</span><span class="op" id="3721940">(</span><span class="op" id="3721941">&amp;</span><span class="ident" id="3721942">h</span><span class="op" id="3721943">.</span><span class="ident" id="3721944">authoritative</span><span class="op" id="3721957">,</span>&nbsp;<span class="string" id="3721959">&#34;authoritative&#34;</span><span class="op" id="3721974">,</span>&nbsp;<span class="string" id="3721976">&#34;&#34;</span><span class="op" id="3721978">)</span>&nbsp;<span class="op" id="3721980">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3721985">f</span><span class="op" id="3721986">(</span><span class="op" id="3721987">&amp;</span><span class="ident" id="3721988">h</span><span class="op" id="3721989">.</span><span class="ident" id="3721990">truncated</span><span class="op" id="3721999">,</span>&nbsp;<span class="string" id="3722001">&#34;truncated&#34;</span><span class="op" id="3722012">,</span>&nbsp;<span class="string" id="3722014">&#34;&#34;</span><span class="op" id="3722016">)</span>&nbsp;<span class="op" id="3722018">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3722023">f</span><span class="op" id="3722024">(</span><span class="op" id="3722025">&amp;</span><span class="ident" id="3722026">h</span><span class="op" id="3722027">.</span><span class="ident" id="3722028">recursion_desired</span><span class="op" id="3722045">,</span>&nbsp;<span class="string" id="3722047">&#34;recursion_desired&#34;</span><span class="op" id="3722066">,</span>&nbsp;<span class="string" id="3722068">&#34;&#34;</span><span class="op" id="3722070">)</span>&nbsp;<span class="op" id="3722072">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3722077">f</span><span class="op" id="3722078">(</span><span class="op" id="3722079">&amp;</span><span class="ident" id="3722080">h</span><span class="op" id="3722081">.</span><span class="ident" id="3722082">recursion_available</span><span class="op" id="3722101">,</span>&nbsp;<span class="string" id="3722103">&#34;recursion_available&#34;</span><span class="op" id="3722124">,</span>&nbsp;<span class="string" id="3722126">&#34;&#34;</span><span class="op" id="3722128">)</span>&nbsp;<span class="op" id="3722130">&amp;&amp;</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3722135">f</span><span class="op" id="3722136">(</span><span class="op" id="3722137">&amp;</span><span class="ident" id="3722138">h</span><span class="op" id="3722139">.</span><span class="ident" id="3722140">rcode</span><span class="op" id="3722145">,</span>&nbsp;<span class="string" id="3722147">&#34;rcode&#34;</span><span class="op" id="3722154">,</span>&nbsp;<span class="string" id="3722156">&#34;&#34;</span><span class="op" id="3722158">)</span><br>
<span class="lineno"></span><span class="op" id="3722160">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3722163">type</span>&nbsp;<span class="ident" id="3722168">dnsMsg</span>&nbsp;<span class="keyword" id="3722175">struct</span>&nbsp;<span class="op" id="3722182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3722185">dnsMsgHdr</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3722196">question</span>&nbsp;<span class="op" id="3722205">[</span><span class="op" id="3722206">]</span><span class="ident" id="3722207">dnsQuestion</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3722220">answer</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3722229">[</span><span class="op" id="3722230">]</span><span class="ident" id="3722231">dnsRR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3722238">ns</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3722247">[</span><span class="op" id="3722248">]</span><span class="ident" id="3722249">dnsRR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3722256">extra</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3722265">[</span><span class="op" id="3722266">]</span><span class="ident" id="3722267">dnsRR</span><br>
<span class="lineno"></span><span class="op" id="3722273">}</span><br>
<span class="lineno">745</span><br>
<span class="lineno"></span><span class="keyword" id="3722276">func</span>&nbsp;<span class="op" id="3722281">(</span><span class="ident" id="3722282">dns</span>&nbsp;<span class="op" id="3722286">*</span><span class="ident" id="3722287">dnsMsg</span><span class="op" id="3722293">)</span>&nbsp;<span class="ident" id="3722295">Pack</span><span class="op" id="3722299">(</span><span class="op" id="3722300">)</span>&nbsp;<span class="op" id="3722302">(</span><span class="ident" id="3722303">msg</span>&nbsp;<span class="op" id="3722307">[</span><span class="op" id="3722308">]</span><span class="builtintype" id="3722309">byte</span><span class="op" id="3722313">,</span>&nbsp;<span class="ident" id="3722315">ok</span>&nbsp;<span class="builtintype" id="3722318">bool</span><span class="op" id="3722322">)</span>&nbsp;<span class="op" id="3722324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3722327">var</span>&nbsp;<span class="ident" id="3722331">dh</span>&nbsp;<span class="ident" id="3722334">dnsHeader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3722346">//&nbsp;Convert&nbsp;convenient&nbsp;dnsMsg&nbsp;into&nbsp;wire-like&nbsp;dnsHeader.</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3722402">dh</span><span class="op" id="3722404">.</span><span class="ident" id="3722405">Id</span>&nbsp;<span class="op" id="3722408">=</span>&nbsp;<span class="ident" id="3722410">dns</span><span class="op" id="3722413">.</span><span class="ident" id="3722414">id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3722418">dh</span><span class="op" id="3722420">.</span><span class="ident" id="3722421">Bits</span>&nbsp;<span class="op" id="3722426">=</span>&nbsp;<span class="builtintype" id="3722428">uint16</span><span class="op" id="3722434">(</span><span class="ident" id="3722435">dns</span><span class="op" id="3722438">.</span><span class="ident" id="3722439">opcode</span><span class="op" id="3722445">)</span><span class="op" id="3722446">&lt;&lt;</span><span class="num" id="3722448">11</span>&nbsp;<span class="op" id="3722451">|</span>&nbsp;<span class="builtintype" id="3722453">uint16</span><span class="op" id="3722459">(</span><span class="ident" id="3722460">dns</span><span class="op" id="3722463">.</span><span class="ident" id="3722464">rcode</span><span class="op" id="3722469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3722472">if</span>&nbsp;<span class="ident" id="3722475">dns</span><span class="op" id="3722478">.</span><span class="ident" id="3722479">recursion_available</span>&nbsp;<span class="op" id="3722499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3722503">dh</span><span class="op" id="3722505">.</span><span class="ident" id="3722506">Bits</span>&nbsp;<span class="op" id="3722511">|=</span>&nbsp;<span class="ident" id="3722514">_RA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3722519">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3722522">if</span>&nbsp;<span class="ident" id="3722525">dns</span><span class="op" id="3722528">.</span><span class="ident" id="3722529">recursion_desired</span>&nbsp;<span class="op" id="3722547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3722551">dh</span><span class="op" id="3722553">.</span><span class="ident" id="3722554">Bits</span>&nbsp;<span class="op" id="3722559">|=</span>&nbsp;<span class="ident" id="3722562">_RD</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3722567">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3722570">if</span>&nbsp;<span class="ident" id="3722573">dns</span><span class="op" id="3722576">.</span><span class="ident" id="3722577">truncated</span>&nbsp;<span class="op" id="3722587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3722591">dh</span><span class="op" id="3722593">.</span><span class="ident" id="3722594">Bits</span>&nbsp;<span class="op" id="3722599">|=</span>&nbsp;<span class="ident" id="3722602">_TC</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3722607">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3722610">if</span>&nbsp;<span class="ident" id="3722613">dns</span><span class="op" id="3722616">.</span><span class="ident" id="3722617">authoritative</span>&nbsp;<span class="op" id="3722631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3722635">dh</span><span class="op" id="3722637">.</span><span class="ident" id="3722638">Bits</span>&nbsp;<span class="op" id="3722643">|=</span>&nbsp;<span class="ident" id="3722646">_AA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3722651">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3722654">if</span>&nbsp;<span class="ident" id="3722657">dns</span><span class="op" id="3722660">.</span><span class="ident" id="3722661">response</span>&nbsp;<span class="op" id="3722670">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3722674">dh</span><span class="op" id="3722676">.</span><span class="ident" id="3722677">Bits</span>&nbsp;<span class="op" id="3722682">|=</span>&nbsp;<span class="ident" id="3722685">_QR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3722690">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3722694">//&nbsp;Prepare&nbsp;variable&nbsp;sized&nbsp;arrays.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3722729">question</span>&nbsp;<span class="op" id="3722738">:=</span>&nbsp;<span class="ident" id="3722741">dns</span><span class="op" id="3722744">.</span><span class="ident" id="3722745">question</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3722755">answer</span>&nbsp;<span class="op" id="3722762">:=</span>&nbsp;<span class="ident" id="3722765">dns</span><span class="op" id="3722768">.</span><span class="ident" id="3722769">answer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3722777">ns</span>&nbsp;<span class="op" id="3722780">:=</span>&nbsp;<span class="ident" id="3722783">dns</span><span class="op" id="3722786">.</span><span class="ident" id="3722787">ns</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3722791">extra</span>&nbsp;<span class="op" id="3722797">:=</span>&nbsp;<span class="ident" id="3722800">dns</span><span class="op" id="3722803">.</span><span class="ident" id="3722804">extra</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3722812">dh</span><span class="op" id="3722814">.</span><span class="ident" id="3722815">Qdcount</span>&nbsp;<span class="op" id="3722823">=</span>&nbsp;<span class="builtintype" id="3722825">uint16</span><span class="op" id="3722831">(</span><span class="builtinfunc" id="3722832">len</span><span class="op" id="3722835">(</span><span class="ident" id="3722836">question</span><span class="op" id="3722844">)</span><span class="op" id="3722845">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3722848">dh</span><span class="op" id="3722850">.</span><span class="ident" id="3722851">Ancount</span>&nbsp;<span class="op" id="3722859">=</span>&nbsp;<span class="builtintype" id="3722861">uint16</span><span class="op" id="3722867">(</span><span class="builtinfunc" id="3722868">len</span><span class="op" id="3722871">(</span><span class="ident" id="3722872">answer</span><span class="op" id="3722878">)</span><span class="op" id="3722879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3722882">dh</span><span class="op" id="3722884">.</span><span class="ident" id="3722885">Nscount</span>&nbsp;<span class="op" id="3722893">=</span>&nbsp;<span class="builtintype" id="3722895">uint16</span><span class="op" id="3722901">(</span><span class="builtinfunc" id="3722902">len</span><span class="op" id="3722905">(</span><span class="ident" id="3722906">ns</span><span class="op" id="3722908">)</span><span class="op" id="3722909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3722912">dh</span><span class="op" id="3722914">.</span><span class="ident" id="3722915">Arcount</span>&nbsp;<span class="op" id="3722923">=</span>&nbsp;<span class="builtintype" id="3722925">uint16</span><span class="op" id="3722931">(</span><span class="builtinfunc" id="3722932">len</span><span class="op" id="3722935">(</span><span class="ident" id="3722936">extra</span><span class="op" id="3722941">)</span><span class="op" id="3722942">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3722946">//&nbsp;Could&nbsp;work&nbsp;harder&nbsp;to&nbsp;calculate&nbsp;message&nbsp;size,</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3722995">//&nbsp;but&nbsp;this&nbsp;is&nbsp;far&nbsp;more&nbsp;than&nbsp;we&nbsp;need&nbsp;and&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3723041">//&nbsp;big&nbsp;enough&nbsp;to&nbsp;hurt&nbsp;the&nbsp;allocator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3723079">msg</span>&nbsp;<span class="op" id="3723083">=</span>&nbsp;<span class="builtinfunc" id="3723085">make</span><span class="op" id="3723089">(</span><span class="op" id="3723090">[</span><span class="op" id="3723091">]</span><span class="builtintype" id="3723092">byte</span><span class="op" id="3723096">,</span>&nbsp;<span class="num" id="3723098">2000</span><span class="op" id="3723102">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3723106">//&nbsp;Pack&nbsp;it&nbsp;in:&nbsp;header&nbsp;and&nbsp;then&nbsp;the&nbsp;pieces.</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3723150">off</span>&nbsp;<span class="op" id="3723154">:=</span>&nbsp;<span class="num" id="3723157">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3723160">off</span><span class="op" id="3723163">,</span>&nbsp;<span class="ident" id="3723165">ok</span>&nbsp;<span class="op" id="3723168">=</span>&nbsp;<span class="ident" id="3723170">packStruct</span><span class="op" id="3723180">(</span><span class="op" id="3723181">&amp;</span><span class="ident" id="3723182">dh</span><span class="op" id="3723184">,</span>&nbsp;<span class="ident" id="3723186">msg</span><span class="op" id="3723189">,</span>&nbsp;<span class="ident" id="3723191">off</span><span class="op" id="3723194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3723197">for</span>&nbsp;<span class="ident" id="3723201">i</span>&nbsp;<span class="op" id="3723203">:=</span>&nbsp;<span class="num" id="3723206">0</span><span class="op" id="3723207">;</span>&nbsp;<span class="ident" id="3723209">i</span>&nbsp;<span class="op" id="3723211">&lt;</span>&nbsp;<span class="builtinfunc" id="3723213">len</span><span class="op" id="3723216">(</span><span class="ident" id="3723217">question</span><span class="op" id="3723225">)</span><span class="op" id="3723226">;</span>&nbsp;<span class="ident" id="3723228">i</span><span class="op" id="3723229">++</span>&nbsp;<span class="op" id="3723232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3723236">off</span><span class="op" id="3723239">,</span>&nbsp;<span class="ident" id="3723241">ok</span>&nbsp;<span class="op" id="3723244">=</span>&nbsp;<span class="ident" id="3723246">packStruct</span><span class="op" id="3723256">(</span><span class="op" id="3723257">&amp;</span><span class="ident" id="3723258">question</span><span class="op" id="3723266">[</span><span class="ident" id="3723267">i</span><span class="op" id="3723268">]</span><span class="op" id="3723269">,</span>&nbsp;<span class="ident" id="3723271">msg</span><span class="op" id="3723274">,</span>&nbsp;<span class="ident" id="3723276">off</span><span class="op" id="3723279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3723282">}</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3723285">for</span>&nbsp;<span class="ident" id="3723289">i</span>&nbsp;<span class="op" id="3723291">:=</span>&nbsp;<span class="num" id="3723294">0</span><span class="op" id="3723295">;</span>&nbsp;<span class="ident" id="3723297">i</span>&nbsp;<span class="op" id="3723299">&lt;</span>&nbsp;<span class="builtinfunc" id="3723301">len</span><span class="op" id="3723304">(</span><span class="ident" id="3723305">answer</span><span class="op" id="3723311">)</span><span class="op" id="3723312">;</span>&nbsp;<span class="ident" id="3723314">i</span><span class="op" id="3723315">++</span>&nbsp;<span class="op" id="3723318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3723322">off</span><span class="op" id="3723325">,</span>&nbsp;<span class="ident" id="3723327">ok</span>&nbsp;<span class="op" id="3723330">=</span>&nbsp;<span class="ident" id="3723332">packRR</span><span class="op" id="3723338">(</span><span class="ident" id="3723339">answer</span><span class="op" id="3723345">[</span><span class="ident" id="3723346">i</span><span class="op" id="3723347">]</span><span class="op" id="3723348">,</span>&nbsp;<span class="ident" id="3723350">msg</span><span class="op" id="3723353">,</span>&nbsp;<span class="ident" id="3723355">off</span><span class="op" id="3723358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3723361">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3723364">for</span>&nbsp;<span class="ident" id="3723368">i</span>&nbsp;<span class="op" id="3723370">:=</span>&nbsp;<span class="num" id="3723373">0</span><span class="op" id="3723374">;</span>&nbsp;<span class="ident" id="3723376">i</span>&nbsp;<span class="op" id="3723378">&lt;</span>&nbsp;<span class="builtinfunc" id="3723380">len</span><span class="op" id="3723383">(</span><span class="ident" id="3723384">ns</span><span class="op" id="3723386">)</span><span class="op" id="3723387">;</span>&nbsp;<span class="ident" id="3723389">i</span><span class="op" id="3723390">++</span>&nbsp;<span class="op" id="3723393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3723397">off</span><span class="op" id="3723400">,</span>&nbsp;<span class="ident" id="3723402">ok</span>&nbsp;<span class="op" id="3723405">=</span>&nbsp;<span class="ident" id="3723407">packRR</span><span class="op" id="3723413">(</span><span class="ident" id="3723414">ns</span><span class="op" id="3723416">[</span><span class="ident" id="3723417">i</span><span class="op" id="3723418">]</span><span class="op" id="3723419">,</span>&nbsp;<span class="ident" id="3723421">msg</span><span class="op" id="3723424">,</span>&nbsp;<span class="ident" id="3723426">off</span><span class="op" id="3723429">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3723432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3723435">for</span>&nbsp;<span class="ident" id="3723439">i</span>&nbsp;<span class="op" id="3723441">:=</span>&nbsp;<span class="num" id="3723444">0</span><span class="op" id="3723445">;</span>&nbsp;<span class="ident" id="3723447">i</span>&nbsp;<span class="op" id="3723449">&lt;</span>&nbsp;<span class="builtinfunc" id="3723451">len</span><span class="op" id="3723454">(</span><span class="ident" id="3723455">extra</span><span class="op" id="3723460">)</span><span class="op" id="3723461">;</span>&nbsp;<span class="ident" id="3723463">i</span><span class="op" id="3723464">++</span>&nbsp;<span class="op" id="3723467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3723471">off</span><span class="op" id="3723474">,</span>&nbsp;<span class="ident" id="3723476">ok</span>&nbsp;<span class="op" id="3723479">=</span>&nbsp;<span class="ident" id="3723481">packRR</span><span class="op" id="3723487">(</span><span class="ident" id="3723488">extra</span><span class="op" id="3723493">[</span><span class="ident" id="3723494">i</span><span class="op" id="3723495">]</span><span class="op" id="3723496">,</span>&nbsp;<span class="ident" id="3723498">msg</span><span class="op" id="3723501">,</span>&nbsp;<span class="ident" id="3723503">off</span><span class="op" id="3723506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3723509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3723512">if</span>&nbsp;<span class="op" id="3723515">!</span><span class="ident" id="3723516">ok</span>&nbsp;<span class="op" id="3723519">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3723523">return</span>&nbsp;<span class="builtintype" id="3723530">nil</span><span class="op" id="3723533">,</span>&nbsp;<span class="builtintype" id="3723535">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3723542">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3723545">return</span>&nbsp;<span class="ident" id="3723552">msg</span><span class="op" id="3723555">[</span><span class="num" id="3723556">0</span><span class="op" id="3723557">:</span><span class="ident" id="3723558">off</span><span class="op" id="3723561">]</span><span class="op" id="3723562">,</span>&nbsp;<span class="builtintype" id="3723564">true</span><br>
<span class="lineno"></span><span class="op" id="3723569">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">805</span><span class="keyword" id="3723572">func</span>&nbsp;<span class="op" id="3723577">(</span><span class="ident" id="3723578">dns</span>&nbsp;<span class="op" id="3723582">*</span><span class="ident" id="3723583">dnsMsg</span><span class="op" id="3723589">)</span>&nbsp;<span class="ident" id="3723591">Unpack</span><span class="op" id="3723597">(</span><span class="ident" id="3723598">msg</span>&nbsp;<span class="op" id="3723602">[</span><span class="op" id="3723603">]</span><span class="builtintype" id="3723604">byte</span><span class="op" id="3723608">)</span>&nbsp;<span class="builtintype" id="3723610">bool</span>&nbsp;<span class="op" id="3723615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3723618">//&nbsp;Header.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3723630">var</span>&nbsp;<span class="ident" id="3723634">dh</span>&nbsp;<span class="ident" id="3723637">dnsHeader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3723648">off</span>&nbsp;<span class="op" id="3723652">:=</span>&nbsp;<span class="num" id="3723655">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3723658">var</span>&nbsp;<span class="ident" id="3723662">ok</span>&nbsp;<span class="builtintype" id="3723665">bool</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3723671">if</span>&nbsp;<span class="ident" id="3723674">off</span><span class="op" id="3723677">,</span>&nbsp;<span class="ident" id="3723679">ok</span>&nbsp;<span class="op" id="3723682">=</span>&nbsp;<span class="ident" id="3723684">unpackStruct</span><span class="op" id="3723696">(</span><span class="op" id="3723697">&amp;</span><span class="ident" id="3723698">dh</span><span class="op" id="3723700">,</span>&nbsp;<span class="ident" id="3723702">msg</span><span class="op" id="3723705">,</span>&nbsp;<span class="ident" id="3723707">off</span><span class="op" id="3723710">)</span><span class="op" id="3723711">;</span>&nbsp;<span class="op" id="3723713">!</span><span class="ident" id="3723714">ok</span>&nbsp;<span class="op" id="3723717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3723721">return</span>&nbsp;<span class="builtintype" id="3723728">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3723735">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3723738">dns</span><span class="op" id="3723741">.</span><span class="ident" id="3723742">id</span>&nbsp;<span class="op" id="3723745">=</span>&nbsp;<span class="ident" id="3723747">dh</span><span class="op" id="3723749">.</span><span class="ident" id="3723750">Id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3723754">dns</span><span class="op" id="3723757">.</span><span class="ident" id="3723758">response</span>&nbsp;<span class="op" id="3723767">=</span>&nbsp;<span class="op" id="3723769">(</span><span class="ident" id="3723770">dh</span><span class="op" id="3723772">.</span><span class="ident" id="3723773">Bits</span>&nbsp;<span class="op" id="3723778">&amp;</span>&nbsp;<span class="ident" id="3723780">_QR</span><span class="op" id="3723783">)</span>&nbsp;<span class="op" id="3723785">!=</span>&nbsp;<span class="num" id="3723788">0</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3723791">dns</span><span class="op" id="3723794">.</span><span class="ident" id="3723795">opcode</span>&nbsp;<span class="op" id="3723802">=</span>&nbsp;<span class="builtintype" id="3723804">int</span><span class="op" id="3723807">(</span><span class="ident" id="3723808">dh</span><span class="op" id="3723810">.</span><span class="ident" id="3723811">Bits</span><span class="op" id="3723815">&gt;&gt;</span><span class="num" id="3723817">11</span><span class="op" id="3723819">)</span>&nbsp;<span class="op" id="3723821">&amp;</span>&nbsp;<span class="num" id="3723823">0xF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3723828">dns</span><span class="op" id="3723831">.</span><span class="ident" id="3723832">authoritative</span>&nbsp;<span class="op" id="3723846">=</span>&nbsp;<span class="op" id="3723848">(</span><span class="ident" id="3723849">dh</span><span class="op" id="3723851">.</span><span class="ident" id="3723852">Bits</span>&nbsp;<span class="op" id="3723857">&amp;</span>&nbsp;<span class="ident" id="3723859">_AA</span><span class="op" id="3723862">)</span>&nbsp;<span class="op" id="3723864">!=</span>&nbsp;<span class="num" id="3723867">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3723870">dns</span><span class="op" id="3723873">.</span><span class="ident" id="3723874">truncated</span>&nbsp;<span class="op" id="3723884">=</span>&nbsp;<span class="op" id="3723886">(</span><span class="ident" id="3723887">dh</span><span class="op" id="3723889">.</span><span class="ident" id="3723890">Bits</span>&nbsp;<span class="op" id="3723895">&amp;</span>&nbsp;<span class="ident" id="3723897">_TC</span><span class="op" id="3723900">)</span>&nbsp;<span class="op" id="3723902">!=</span>&nbsp;<span class="num" id="3723905">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3723908">dns</span><span class="op" id="3723911">.</span><span class="ident" id="3723912">recursion_desired</span>&nbsp;<span class="op" id="3723930">=</span>&nbsp;<span class="op" id="3723932">(</span><span class="ident" id="3723933">dh</span><span class="op" id="3723935">.</span><span class="ident" id="3723936">Bits</span>&nbsp;<span class="op" id="3723941">&amp;</span>&nbsp;<span class="ident" id="3723943">_RD</span><span class="op" id="3723946">)</span>&nbsp;<span class="op" id="3723948">!=</span>&nbsp;<span class="num" id="3723951">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3723954">dns</span><span class="op" id="3723957">.</span><span class="ident" id="3723958">recursion_available</span>&nbsp;<span class="op" id="3723978">=</span>&nbsp;<span class="op" id="3723980">(</span><span class="ident" id="3723981">dh</span><span class="op" id="3723983">.</span><span class="ident" id="3723984">Bits</span>&nbsp;<span class="op" id="3723989">&amp;</span>&nbsp;<span class="ident" id="3723991">_RA</span><span class="op" id="3723994">)</span>&nbsp;<span class="op" id="3723996">!=</span>&nbsp;<span class="num" id="3723999">0</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3724002">dns</span><span class="op" id="3724005">.</span><span class="ident" id="3724006">rcode</span>&nbsp;<span class="op" id="3724012">=</span>&nbsp;<span class="builtintype" id="3724014">int</span><span class="op" id="3724017">(</span><span class="ident" id="3724018">dh</span><span class="op" id="3724020">.</span><span class="ident" id="3724021">Bits</span>&nbsp;<span class="op" id="3724026">&amp;</span>&nbsp;<span class="num" id="3724028">0xF</span><span class="op" id="3724031">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3724035">//&nbsp;Arrays.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3724047">dns</span><span class="op" id="3724050">.</span><span class="ident" id="3724051">question</span>&nbsp;<span class="op" id="3724060">=</span>&nbsp;<span class="builtinfunc" id="3724062">make</span><span class="op" id="3724066">(</span><span class="op" id="3724067">[</span><span class="op" id="3724068">]</span><span class="ident" id="3724069">dnsQuestion</span><span class="op" id="3724080">,</span>&nbsp;<span class="ident" id="3724082">dh</span><span class="op" id="3724084">.</span><span class="ident" id="3724085">Qdcount</span><span class="op" id="3724092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3724095">dns</span><span class="op" id="3724098">.</span><span class="ident" id="3724099">answer</span>&nbsp;<span class="op" id="3724106">=</span>&nbsp;<span class="builtinfunc" id="3724108">make</span><span class="op" id="3724112">(</span><span class="op" id="3724113">[</span><span class="op" id="3724114">]</span><span class="ident" id="3724115">dnsRR</span><span class="op" id="3724120">,</span>&nbsp;<span class="num" id="3724122">0</span><span class="op" id="3724123">,</span>&nbsp;<span class="ident" id="3724125">dh</span><span class="op" id="3724127">.</span><span class="ident" id="3724128">Ancount</span><span class="op" id="3724135">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3724138">dns</span><span class="op" id="3724141">.</span><span class="ident" id="3724142">ns</span>&nbsp;<span class="op" id="3724145">=</span>&nbsp;<span class="builtinfunc" id="3724147">make</span><span class="op" id="3724151">(</span><span class="op" id="3724152">[</span><span class="op" id="3724153">]</span><span class="ident" id="3724154">dnsRR</span><span class="op" id="3724159">,</span>&nbsp;<span class="num" id="3724161">0</span><span class="op" id="3724162">,</span>&nbsp;<span class="ident" id="3724164">dh</span><span class="op" id="3724166">.</span><span class="ident" id="3724167">Nscount</span><span class="op" id="3724174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3724177">dns</span><span class="op" id="3724180">.</span><span class="ident" id="3724181">extra</span>&nbsp;<span class="op" id="3724187">=</span>&nbsp;<span class="builtinfunc" id="3724189">make</span><span class="op" id="3724193">(</span><span class="op" id="3724194">[</span><span class="op" id="3724195">]</span><span class="ident" id="3724196">dnsRR</span><span class="op" id="3724201">,</span>&nbsp;<span class="num" id="3724203">0</span><span class="op" id="3724204">,</span>&nbsp;<span class="ident" id="3724206">dh</span><span class="op" id="3724208">.</span><span class="ident" id="3724209">Arcount</span><span class="op" id="3724216">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3724220">var</span>&nbsp;<span class="ident" id="3724224">rec</span>&nbsp;<span class="ident" id="3724228">dnsRR</span><br>
<span class="lineno"></span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3724236">for</span>&nbsp;<span class="ident" id="3724240">i</span>&nbsp;<span class="op" id="3724242">:=</span>&nbsp;<span class="num" id="3724245">0</span><span class="op" id="3724246">;</span>&nbsp;<span class="ident" id="3724248">i</span>&nbsp;<span class="op" id="3724250">&lt;</span>&nbsp;<span class="builtinfunc" id="3724252">len</span><span class="op" id="3724255">(</span><span class="ident" id="3724256">dns</span><span class="op" id="3724259">.</span><span class="ident" id="3724260">question</span><span class="op" id="3724268">)</span><span class="op" id="3724269">;</span>&nbsp;<span class="ident" id="3724271">i</span><span class="op" id="3724272">++</span>&nbsp;<span class="op" id="3724275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3724279">off</span><span class="op" id="3724282">,</span>&nbsp;<span class="ident" id="3724284">ok</span>&nbsp;<span class="op" id="3724287">=</span>&nbsp;<span class="ident" id="3724289">unpackStruct</span><span class="op" id="3724301">(</span><span class="op" id="3724302">&amp;</span><span class="ident" id="3724303">dns</span><span class="op" id="3724306">.</span><span class="ident" id="3724307">question</span><span class="op" id="3724315">[</span><span class="ident" id="3724316">i</span><span class="op" id="3724317">]</span><span class="op" id="3724318">,</span>&nbsp;<span class="ident" id="3724320">msg</span><span class="op" id="3724323">,</span>&nbsp;<span class="ident" id="3724325">off</span><span class="op" id="3724328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3724331">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3724334">for</span>&nbsp;<span class="ident" id="3724338">i</span>&nbsp;<span class="op" id="3724340">:=</span>&nbsp;<span class="num" id="3724343">0</span><span class="op" id="3724344">;</span>&nbsp;<span class="ident" id="3724346">i</span>&nbsp;<span class="op" id="3724348">&lt;</span>&nbsp;<span class="builtintype" id="3724350">int</span><span class="op" id="3724353">(</span><span class="ident" id="3724354">dh</span><span class="op" id="3724356">.</span><span class="ident" id="3724357">Ancount</span><span class="op" id="3724364">)</span><span class="op" id="3724365">;</span>&nbsp;<span class="ident" id="3724367">i</span><span class="op" id="3724368">++</span>&nbsp;<span class="op" id="3724371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3724375">rec</span><span class="op" id="3724378">,</span>&nbsp;<span class="ident" id="3724380">off</span><span class="op" id="3724383">,</span>&nbsp;<span class="ident" id="3724385">ok</span>&nbsp;<span class="op" id="3724388">=</span>&nbsp;<span class="ident" id="3724390">unpackRR</span><span class="op" id="3724398">(</span><span class="ident" id="3724399">msg</span><span class="op" id="3724402">,</span>&nbsp;<span class="ident" id="3724404">off</span><span class="op" id="3724407">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3724411">if</span>&nbsp;<span class="op" id="3724414">!</span><span class="ident" id="3724415">ok</span>&nbsp;<span class="op" id="3724418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3724423">return</span>&nbsp;<span class="builtintype" id="3724430">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3724438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3724442">dns</span><span class="op" id="3724445">.</span><span class="ident" id="3724446">answer</span>&nbsp;<span class="op" id="3724453">=</span>&nbsp;<span class="builtinfunc" id="3724455">append</span><span class="op" id="3724461">(</span><span class="ident" id="3724462">dns</span><span class="op" id="3724465">.</span><span class="ident" id="3724466">answer</span><span class="op" id="3724472">,</span>&nbsp;<span class="ident" id="3724474">rec</span><span class="op" id="3724477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3724480">}</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3724483">for</span>&nbsp;<span class="ident" id="3724487">i</span>&nbsp;<span class="op" id="3724489">:=</span>&nbsp;<span class="num" id="3724492">0</span><span class="op" id="3724493">;</span>&nbsp;<span class="ident" id="3724495">i</span>&nbsp;<span class="op" id="3724497">&lt;</span>&nbsp;<span class="builtintype" id="3724499">int</span><span class="op" id="3724502">(</span><span class="ident" id="3724503">dh</span><span class="op" id="3724505">.</span><span class="ident" id="3724506">Nscount</span><span class="op" id="3724513">)</span><span class="op" id="3724514">;</span>&nbsp;<span class="ident" id="3724516">i</span><span class="op" id="3724517">++</span>&nbsp;<span class="op" id="3724520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3724524">rec</span><span class="op" id="3724527">,</span>&nbsp;<span class="ident" id="3724529">off</span><span class="op" id="3724532">,</span>&nbsp;<span class="ident" id="3724534">ok</span>&nbsp;<span class="op" id="3724537">=</span>&nbsp;<span class="ident" id="3724539">unpackRR</span><span class="op" id="3724547">(</span><span class="ident" id="3724548">msg</span><span class="op" id="3724551">,</span>&nbsp;<span class="ident" id="3724553">off</span><span class="op" id="3724556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3724560">if</span>&nbsp;<span class="op" id="3724563">!</span><span class="ident" id="3724564">ok</span>&nbsp;<span class="op" id="3724567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3724572">return</span>&nbsp;<span class="builtintype" id="3724579">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3724587">}</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3724591">dns</span><span class="op" id="3724594">.</span><span class="ident" id="3724595">ns</span>&nbsp;<span class="op" id="3724598">=</span>&nbsp;<span class="builtinfunc" id="3724600">append</span><span class="op" id="3724606">(</span><span class="ident" id="3724607">dns</span><span class="op" id="3724610">.</span><span class="ident" id="3724611">ns</span><span class="op" id="3724613">,</span>&nbsp;<span class="ident" id="3724615">rec</span><span class="op" id="3724618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3724621">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3724624">for</span>&nbsp;<span class="ident" id="3724628">i</span>&nbsp;<span class="op" id="3724630">:=</span>&nbsp;<span class="num" id="3724633">0</span><span class="op" id="3724634">;</span>&nbsp;<span class="ident" id="3724636">i</span>&nbsp;<span class="op" id="3724638">&lt;</span>&nbsp;<span class="builtintype" id="3724640">int</span><span class="op" id="3724643">(</span><span class="ident" id="3724644">dh</span><span class="op" id="3724646">.</span><span class="ident" id="3724647">Arcount</span><span class="op" id="3724654">)</span><span class="op" id="3724655">;</span>&nbsp;<span class="ident" id="3724657">i</span><span class="op" id="3724658">++</span>&nbsp;<span class="op" id="3724661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3724665">rec</span><span class="op" id="3724668">,</span>&nbsp;<span class="ident" id="3724670">off</span><span class="op" id="3724673">,</span>&nbsp;<span class="ident" id="3724675">ok</span>&nbsp;<span class="op" id="3724678">=</span>&nbsp;<span class="ident" id="3724680">unpackRR</span><span class="op" id="3724688">(</span><span class="ident" id="3724689">msg</span><span class="op" id="3724692">,</span>&nbsp;<span class="ident" id="3724694">off</span><span class="op" id="3724697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3724701">if</span>&nbsp;<span class="op" id="3724704">!</span><span class="ident" id="3724705">ok</span>&nbsp;<span class="op" id="3724708">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3724713">return</span>&nbsp;<span class="builtintype" id="3724720">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3724728">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3724732">dns</span><span class="op" id="3724735">.</span><span class="ident" id="3724736">extra</span>&nbsp;<span class="op" id="3724742">=</span>&nbsp;<span class="builtinfunc" id="3724744">append</span><span class="op" id="3724750">(</span><span class="ident" id="3724751">dns</span><span class="op" id="3724754">.</span><span class="ident" id="3724755">extra</span><span class="op" id="3724760">,</span>&nbsp;<span class="ident" id="3724762">rec</span><span class="op" id="3724765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3724768">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3724771">//&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;off&nbsp;!=&nbsp;len(msg)&nbsp;{</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3724796">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;println(&#34;extra&nbsp;bytes&nbsp;in&nbsp;dns&nbsp;packet&#34;,&nbsp;off,&nbsp;&#34;&lt;&#34;,&nbsp;len(msg));</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3724859">//&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3724865">return</span>&nbsp;<span class="builtintype" id="3724872">true</span><br>
<span class="lineno"></span><span class="op" id="3724877">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">860</span><span class="keyword" id="3724880">func</span>&nbsp;<span class="op" id="3724885">(</span><span class="ident" id="3724886">dns</span>&nbsp;<span class="op" id="3724890">*</span><span class="ident" id="3724891">dnsMsg</span><span class="op" id="3724897">)</span>&nbsp;<span class="ident" id="3724899">String</span><span class="op" id="3724905">(</span><span class="op" id="3724906">)</span>&nbsp;<span class="builtintype" id="3724908">string</span>&nbsp;<span class="op" id="3724915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3724918">s</span>&nbsp;<span class="op" id="3724920">:=</span>&nbsp;<span class="string" id="3724923">&#34;DNS:&nbsp;&#34;</span>&nbsp;<span class="op" id="3724931">+</span>&nbsp;<span class="ident" id="3724933">printStruct</span><span class="op" id="3724944">(</span><span class="op" id="3724945">&amp;</span><span class="ident" id="3724946">dns</span><span class="op" id="3724949">.</span><span class="ident" id="3724950">dnsMsgHdr</span><span class="op" id="3724959">)</span>&nbsp;<span class="op" id="3724961">+</span>&nbsp;<span class="string" id="3724963">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3724969">if</span>&nbsp;<span class="builtinfunc" id="3724972">len</span><span class="op" id="3724975">(</span><span class="ident" id="3724976">dns</span><span class="op" id="3724979">.</span><span class="ident" id="3724980">question</span><span class="op" id="3724988">)</span>&nbsp;<span class="op" id="3724990">&gt;</span>&nbsp;<span class="num" id="3724992">0</span>&nbsp;<span class="op" id="3724994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3724998">s</span>&nbsp;<span class="op" id="3725000">+=</span>&nbsp;<span class="string" id="3725003">&#34;--&nbsp;Questions\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3725022">for</span>&nbsp;<span class="ident" id="3725026">i</span>&nbsp;<span class="op" id="3725028">:=</span>&nbsp;<span class="num" id="3725031">0</span><span class="op" id="3725032">;</span>&nbsp;<span class="ident" id="3725034">i</span>&nbsp;<span class="op" id="3725036">&lt;</span>&nbsp;<span class="builtinfunc" id="3725038">len</span><span class="op" id="3725041">(</span><span class="ident" id="3725042">dns</span><span class="op" id="3725045">.</span><span class="ident" id="3725046">question</span><span class="op" id="3725054">)</span><span class="op" id="3725055">;</span>&nbsp;<span class="ident" id="3725057">i</span><span class="op" id="3725058">++</span>&nbsp;<span class="op" id="3725061">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3725066">s</span>&nbsp;<span class="op" id="3725068">+=</span>&nbsp;<span class="ident" id="3725071">printStruct</span><span class="op" id="3725082">(</span><span class="op" id="3725083">&amp;</span><span class="ident" id="3725084">dns</span><span class="op" id="3725087">.</span><span class="ident" id="3725088">question</span><span class="op" id="3725096">[</span><span class="ident" id="3725097">i</span><span class="op" id="3725098">]</span><span class="op" id="3725099">)</span>&nbsp;<span class="op" id="3725101">+</span>&nbsp;<span class="string" id="3725103">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3725110">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3725113">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3725116">if</span>&nbsp;<span class="builtinfunc" id="3725119">len</span><span class="op" id="3725122">(</span><span class="ident" id="3725123">dns</span><span class="op" id="3725126">.</span><span class="ident" id="3725127">answer</span><span class="op" id="3725133">)</span>&nbsp;<span class="op" id="3725135">&gt;</span>&nbsp;<span class="num" id="3725137">0</span>&nbsp;<span class="op" id="3725139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3725143">s</span>&nbsp;<span class="op" id="3725145">+=</span>&nbsp;<span class="string" id="3725148">&#34;--&nbsp;Answers\n&#34;</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3725165">for</span>&nbsp;<span class="ident" id="3725169">i</span>&nbsp;<span class="op" id="3725171">:=</span>&nbsp;<span class="num" id="3725174">0</span><span class="op" id="3725175">;</span>&nbsp;<span class="ident" id="3725177">i</span>&nbsp;<span class="op" id="3725179">&lt;</span>&nbsp;<span class="builtinfunc" id="3725181">len</span><span class="op" id="3725184">(</span><span class="ident" id="3725185">dns</span><span class="op" id="3725188">.</span><span class="ident" id="3725189">answer</span><span class="op" id="3725195">)</span><span class="op" id="3725196">;</span>&nbsp;<span class="ident" id="3725198">i</span><span class="op" id="3725199">++</span>&nbsp;<span class="op" id="3725202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3725207">s</span>&nbsp;<span class="op" id="3725209">+=</span>&nbsp;<span class="ident" id="3725212">printStruct</span><span class="op" id="3725223">(</span><span class="ident" id="3725224">dns</span><span class="op" id="3725227">.</span><span class="ident" id="3725228">answer</span><span class="op" id="3725234">[</span><span class="ident" id="3725235">i</span><span class="op" id="3725236">]</span><span class="op" id="3725237">)</span>&nbsp;<span class="op" id="3725239">+</span>&nbsp;<span class="string" id="3725241">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3725248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3725251">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3725254">if</span>&nbsp;<span class="builtinfunc" id="3725257">len</span><span class="op" id="3725260">(</span><span class="ident" id="3725261">dns</span><span class="op" id="3725264">.</span><span class="ident" id="3725265">ns</span><span class="op" id="3725267">)</span>&nbsp;<span class="op" id="3725269">&gt;</span>&nbsp;<span class="num" id="3725271">0</span>&nbsp;<span class="op" id="3725273">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3725277">s</span>&nbsp;<span class="op" id="3725279">+=</span>&nbsp;<span class="string" id="3725282">&#34;--&nbsp;Name&nbsp;servers\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3725304">for</span>&nbsp;<span class="ident" id="3725308">i</span>&nbsp;<span class="op" id="3725310">:=</span>&nbsp;<span class="num" id="3725313">0</span><span class="op" id="3725314">;</span>&nbsp;<span class="ident" id="3725316">i</span>&nbsp;<span class="op" id="3725318">&lt;</span>&nbsp;<span class="builtinfunc" id="3725320">len</span><span class="op" id="3725323">(</span><span class="ident" id="3725324">dns</span><span class="op" id="3725327">.</span><span class="ident" id="3725328">ns</span><span class="op" id="3725330">)</span><span class="op" id="3725331">;</span>&nbsp;<span class="ident" id="3725333">i</span><span class="op" id="3725334">++</span>&nbsp;<span class="op" id="3725337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3725342">s</span>&nbsp;<span class="op" id="3725344">+=</span>&nbsp;<span class="ident" id="3725347">printStruct</span><span class="op" id="3725358">(</span><span class="ident" id="3725359">dns</span><span class="op" id="3725362">.</span><span class="ident" id="3725363">ns</span><span class="op" id="3725365">[</span><span class="ident" id="3725366">i</span><span class="op" id="3725367">]</span><span class="op" id="3725368">)</span>&nbsp;<span class="op" id="3725370">+</span>&nbsp;<span class="string" id="3725372">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3725379">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3725382">}</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3725385">if</span>&nbsp;<span class="builtinfunc" id="3725388">len</span><span class="op" id="3725391">(</span><span class="ident" id="3725392">dns</span><span class="op" id="3725395">.</span><span class="ident" id="3725396">extra</span><span class="op" id="3725401">)</span>&nbsp;<span class="op" id="3725403">&gt;</span>&nbsp;<span class="num" id="3725405">0</span>&nbsp;<span class="op" id="3725407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3725411">s</span>&nbsp;<span class="op" id="3725413">+=</span>&nbsp;<span class="string" id="3725416">&#34;--&nbsp;Extra\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3725431">for</span>&nbsp;<span class="ident" id="3725435">i</span>&nbsp;<span class="op" id="3725437">:=</span>&nbsp;<span class="num" id="3725440">0</span><span class="op" id="3725441">;</span>&nbsp;<span class="ident" id="3725443">i</span>&nbsp;<span class="op" id="3725445">&lt;</span>&nbsp;<span class="builtinfunc" id="3725447">len</span><span class="op" id="3725450">(</span><span class="ident" id="3725451">dns</span><span class="op" id="3725454">.</span><span class="ident" id="3725455">extra</span><span class="op" id="3725460">)</span><span class="op" id="3725461">;</span>&nbsp;<span class="ident" id="3725463">i</span><span class="op" id="3725464">++</span>&nbsp;<span class="op" id="3725467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3725472">s</span>&nbsp;<span class="op" id="3725474">+=</span>&nbsp;<span class="ident" id="3725477">printStruct</span><span class="op" id="3725488">(</span><span class="ident" id="3725489">dns</span><span class="op" id="3725492">.</span><span class="ident" id="3725493">extra</span><span class="op" id="3725498">[</span><span class="ident" id="3725499">i</span><span class="op" id="3725500">]</span><span class="op" id="3725501">)</span>&nbsp;<span class="op" id="3725503">+</span>&nbsp;<span class="string" id="3725505">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3725512">}</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3725515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3725518">return</span>&nbsp;<span class="ident" id="3725525">s</span><br>
<span class="lineno"></span><span class="op" id="3725527">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
