<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2466395">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2466450">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2466504">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2466555">package</span>&nbsp;<span class="ident" id="2466563">os</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2466567">import</span>&nbsp;<span class="string" id="2466574">&#34;syscall&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2466585">//&nbsp;Pipe&nbsp;returns&nbsp;a&nbsp;connected&nbsp;pair&nbsp;of&nbsp;Files;&nbsp;reads&nbsp;from&nbsp;r&nbsp;return&nbsp;bytes&nbsp;written&nbsp;to&nbsp;w.</span><br>
<span class="lineno">10</span><span class="comment" id="2466668">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;files&nbsp;and&nbsp;an&nbsp;error,&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span><span class="keyword" id="2466714">func</span>&nbsp;<span class="ident" id="2466719">Pipe</span><span class="op" id="2466723">(</span><span class="op" id="2466724">)</span>&nbsp;<span class="op" id="2466726">(</span><span class="ident" id="2466727">r</span>&nbsp;<span class="op" id="2466729">*</span><span class="ident" id="2466730"><a href="/os/file_unix.go.html#2451241">File</a></span><span class="op" id="2466734">,</span>&nbsp;<span class="ident" id="2466736">w</span>&nbsp;<span class="op" id="2466738">*</span><span class="ident" id="2466739"><a href="/os/file_unix.go.html#2451241">File</a></span><span class="op" id="2466743">,</span>&nbsp;<span class="ident" id="2466745">err</span>&nbsp;<span class="builtintype" id="2466749">error</span><span class="op" id="2466754">)</span>&nbsp;<span class="op" id="2466756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2466759">var</span>&nbsp;<span class="ident" id="2466763">p</span>&nbsp;<span class="op" id="2466765">[</span><span class="num" id="2466766">2</span><span class="op" id="2466767">]</span><span class="builtintype" id="2466768">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2466774">e</span>&nbsp;<span class="op" id="2466776">:=</span>&nbsp;<span class="ident" id="2466779"><a href="/os/pipe_linux.go.html#2466574">syscall</a></span><span class="op" id="2466786">.</span><span class="ident" id="2466787">Pipe2</span><span class="op" id="2466792">(</span><span class="ident" id="2466793"><a href="/os/pipe_linux.go.html#2466763">p</a></span><span class="op" id="2466794">[</span><span class="num" id="2466795">0</span><span class="op" id="2466796">:</span><span class="op" id="2466797">]</span><span class="op" id="2466798">,</span>&nbsp;<span class="ident" id="2466800"><a href="/os/pipe_linux.go.html#2466574">syscall</a></span><span class="op" id="2466807">.</span><span class="ident" id="2466808">O_CLOEXEC</span><span class="op" id="2466817">)</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2466820">//&nbsp;pipe2&nbsp;was&nbsp;added&nbsp;in&nbsp;2.6.27&nbsp;and&nbsp;our&nbsp;minimum&nbsp;requirement&nbsp;is&nbsp;2.6.23,&nbsp;so&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2466895">//&nbsp;might&nbsp;not&nbsp;be&nbsp;implemented.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2466925">if</span>&nbsp;<span class="ident" id="2466928"><a href="/os/pipe_linux.go.html#2466774">e</a></span>&nbsp;<span class="op" id="2466930">==</span>&nbsp;<span class="ident" id="2466933"><a href="/os/pipe_linux.go.html#2466574">syscall</a></span><span class="op" id="2466940">.</span><span class="ident" id="2466941">ENOSYS</span>&nbsp;<span class="op" id="2466948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2466952">//&nbsp;See&nbsp;../syscall/exec.go&nbsp;for&nbsp;description&nbsp;of&nbsp;lock.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2467005"><a href="/os/pipe_linux.go.html#2466574">syscall</a></span><span class="op" id="2467012">.</span><span class="ident" id="2467013">ForkLock</span><span class="op" id="2467021">.</span><span class="ident" id="2467022">RLock</span><span class="op" id="2467027">(</span><span class="op" id="2467028">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2467032"><a href="/os/pipe_linux.go.html#2466774">e</a></span>&nbsp;<span class="op" id="2467034">=</span>&nbsp;<span class="ident" id="2467036"><a href="/os/pipe_linux.go.html#2466574">syscall</a></span><span class="op" id="2467043">.</span><span class="ident" id="2467044">Pipe</span><span class="op" id="2467048">(</span><span class="ident" id="2467049"><a href="/os/pipe_linux.go.html#2466763">p</a></span><span class="op" id="2467050">[</span><span class="num" id="2467051">0</span><span class="op" id="2467052">:</span><span class="op" id="2467053">]</span><span class="op" id="2467054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2467058">if</span>&nbsp;<span class="ident" id="2467061"><a href="/os/pipe_linux.go.html#2466774">e</a></span>&nbsp;<span class="op" id="2467063">!=</span>&nbsp;<span class="ident" id="2467066">nil</span>&nbsp;<span class="op" id="2467070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2467075"><a href="/os/pipe_linux.go.html#2466574">syscall</a></span><span class="op" id="2467082">.</span><span class="ident" id="2467083">ForkLock</span><span class="op" id="2467091">.</span><span class="ident" id="2467092">RUnlock</span><span class="op" id="2467099">(</span><span class="op" id="2467100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2467105">return</span>&nbsp;<span class="ident" id="2467112">nil</span><span class="op" id="2467115">,</span>&nbsp;<span class="ident" id="2467117">nil</span><span class="op" id="2467120">,</span>&nbsp;<span class="ident" id="2467122"><a href="/os/error.go.html#2430425">NewSyscallError</a></span><span class="op" id="2467137">(</span><span class="string" id="2467138">&#34;pipe&#34;</span><span class="op" id="2467144">,</span>&nbsp;<span class="ident" id="2467146"><a href="/os/pipe_linux.go.html#2466774">e</a></span><span class="op" id="2467147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2467151">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2467155"><a href="/os/pipe_linux.go.html#2466574">syscall</a></span><span class="op" id="2467162">.</span><span class="ident" id="2467163">CloseOnExec</span><span class="op" id="2467174">(</span><span class="ident" id="2467175"><a href="/os/pipe_linux.go.html#2466763">p</a></span><span class="op" id="2467176">[</span><span class="num" id="2467177">0</span><span class="op" id="2467178">]</span><span class="op" id="2467179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2467183"><a href="/os/pipe_linux.go.html#2466574">syscall</a></span><span class="op" id="2467190">.</span><span class="ident" id="2467191">CloseOnExec</span><span class="op" id="2467202">(</span><span class="ident" id="2467203"><a href="/os/pipe_linux.go.html#2466763">p</a></span><span class="op" id="2467204">[</span><span class="num" id="2467205">1</span><span class="op" id="2467206">]</span><span class="op" id="2467207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2467211"><a href="/os/pipe_linux.go.html#2466574">syscall</a></span><span class="op" id="2467218">.</span><span class="ident" id="2467219">ForkLock</span><span class="op" id="2467227">.</span><span class="ident" id="2467228">RUnlock</span><span class="op" id="2467235">(</span><span class="op" id="2467236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2467239">}</span>&nbsp;<span class="keyword" id="2467241">else</span>&nbsp;<span class="keyword" id="2467246">if</span>&nbsp;<span class="ident" id="2467249"><a href="/os/pipe_linux.go.html#2466774">e</a></span>&nbsp;<span class="op" id="2467251">!=</span>&nbsp;<span class="ident" id="2467254">nil</span>&nbsp;<span class="op" id="2467258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2467262">return</span>&nbsp;<span class="ident" id="2467269">nil</span><span class="op" id="2467272">,</span>&nbsp;<span class="ident" id="2467274">nil</span><span class="op" id="2467277">,</span>&nbsp;<span class="ident" id="2467279"><a href="/os/error.go.html#2430425">NewSyscallError</a></span><span class="op" id="2467294">(</span><span class="string" id="2467295">&#34;pipe2&#34;</span><span class="op" id="2467302">,</span>&nbsp;<span class="ident" id="2467304"><a href="/os/pipe_linux.go.html#2466774">e</a></span><span class="op" id="2467305">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2467308">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2467312">return</span>&nbsp;<span class="ident" id="2467319"><a href="/os/file_unix.go.html#2451969">NewFile</a></span><span class="op" id="2467326">(</span><span class="builtintype" id="2467327">uintptr</span><span class="op" id="2467334">(</span><span class="ident" id="2467335"><a href="/os/pipe_linux.go.html#2466763">p</a></span><span class="op" id="2467336">[</span><span class="num" id="2467337">0</span><span class="op" id="2467338">]</span><span class="op" id="2467339">)</span><span class="op" id="2467340">,</span>&nbsp;<span class="string" id="2467342">&#34;|0&#34;</span><span class="op" id="2467346">)</span><span class="op" id="2467347">,</span>&nbsp;<span class="ident" id="2467349"><a href="/os/file_unix.go.html#2451969">NewFile</a></span><span class="op" id="2467356">(</span><span class="builtintype" id="2467357">uintptr</span><span class="op" id="2467364">(</span><span class="ident" id="2467365"><a href="/os/pipe_linux.go.html#2466763">p</a></span><span class="op" id="2467366">[</span><span class="num" id="2467367">1</span><span class="op" id="2467368">]</span><span class="op" id="2467369">)</span><span class="op" id="2467370">,</span>&nbsp;<span class="string" id="2467372">&#34;|1&#34;</span><span class="op" id="2467376">)</span><span class="op" id="2467377">,</span>&nbsp;<span class="ident" id="2467379">nil</span><br>
<span class="lineno"></span><span class="op" id="2467383">}</span>
</div>
</body>
</html>
