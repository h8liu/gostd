<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>fmt</h2>
<ul>
<li><a href="/gostd/fmt/doc.go.html">doc.go</a></li>
<li><a href="/gostd/fmt/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/fmt/fmt_test.go.html">fmt_test.go</a></li>
<li><a href="/gostd/fmt/format.go.html">format.go</a></li>
<li><a href="/gostd/fmt/print.go.html">print.go</a></li>
<li><a href="/gostd/fmt/scan.go.html">scan.go</a></li>
<li><a href="/gostd/fmt/scan_test.go.html">scan_test.go</a></li>
<li><a href="/gostd/fmt/stringer_test.go.html">stringer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2051525">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2051580">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2051634">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2051685">package</span>&nbsp;<span class="ident" id="2051693">fmt</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2051698">import</span>&nbsp;<span class="op" id="2051705">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2051708">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2051718">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2051724">&#34;math&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2051732">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2051738">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2051749">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2051760">&#34;sync&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2051768">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="2051783">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2051786">//&nbsp;runeUnreader&nbsp;is&nbsp;the&nbsp;interface&nbsp;to&nbsp;something&nbsp;that&nbsp;can&nbsp;unread&nbsp;runes.</span><br>
<span class="lineno"></span><span class="comment" id="2051855">//&nbsp;If&nbsp;the&nbsp;object&nbsp;provided&nbsp;to&nbsp;Scan&nbsp;does&nbsp;not&nbsp;satisfy&nbsp;this&nbsp;interface,</span><br>
<span class="lineno">20</span><span class="comment" id="2051922">//&nbsp;a&nbsp;local&nbsp;buffer&nbsp;will&nbsp;be&nbsp;used&nbsp;to&nbsp;back&nbsp;up&nbsp;the&nbsp;input,&nbsp;but&nbsp;its&nbsp;contents</span><br>
<span class="lineno"></span><span class="comment" id="2051992">//&nbsp;will&nbsp;be&nbsp;lost&nbsp;when&nbsp;Scan&nbsp;returns.</span><br>
<span class="lineno"></span><span class="keyword" id="2052027">type</span>&nbsp;<span class="ident" id="2052032">runeUnreader</span>&nbsp;<span class="keyword" id="2052045">interface</span>&nbsp;<span class="op" id="2052055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2052058">UnreadRune</span><span class="op" id="2052068">(</span><span class="op" id="2052069">)</span>&nbsp;<span class="builtintype" id="2052071">error</span><br>
<span class="lineno"></span><span class="op" id="2052077">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="2052080">//&nbsp;ScanState&nbsp;represents&nbsp;the&nbsp;scanner&nbsp;state&nbsp;passed&nbsp;to&nbsp;custom&nbsp;scanners.</span><br>
<span class="lineno"></span><span class="comment" id="2052149">//&nbsp;Scanners&nbsp;may&nbsp;do&nbsp;rune-at-a-time&nbsp;scanning&nbsp;or&nbsp;ask&nbsp;the&nbsp;ScanState</span><br>
<span class="lineno"></span><span class="comment" id="2052213">//&nbsp;to&nbsp;discover&nbsp;the&nbsp;next&nbsp;space-delimited&nbsp;token.</span><br>
<span class="lineno"></span><span class="keyword" id="2052260">type</span>&nbsp;<span class="ident" id="2052265">ScanState</span>&nbsp;<span class="keyword" id="2052275">interface</span>&nbsp;<span class="op" id="2052285">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2052288">//&nbsp;ReadRune&nbsp;reads&nbsp;the&nbsp;next&nbsp;rune&nbsp;(Unicode&nbsp;code&nbsp;point)&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2052358">//&nbsp;If&nbsp;invoked&nbsp;during&nbsp;Scanln,&nbsp;Fscanln,&nbsp;or&nbsp;Sscanln,&nbsp;ReadRune()&nbsp;will</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2052425">//&nbsp;return&nbsp;EOF&nbsp;after&nbsp;returning&nbsp;the&nbsp;first&nbsp;&#39;\n&#39;&nbsp;or&nbsp;when&nbsp;reading&nbsp;beyond</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2052494">//&nbsp;the&nbsp;specified&nbsp;width.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2052519">ReadRune</span><span class="op" id="2052527">(</span><span class="op" id="2052528">)</span>&nbsp;<span class="op" id="2052530">(</span><span class="ident" id="2052531">r</span>&nbsp;<span class="builtintype" id="2052533">rune</span><span class="op" id="2052537">,</span>&nbsp;<span class="ident" id="2052539">size</span>&nbsp;<span class="builtintype" id="2052544">int</span><span class="op" id="2052547">,</span>&nbsp;<span class="ident" id="2052549">err</span>&nbsp;<span class="builtintype" id="2052553">error</span><span class="op" id="2052558">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2052561">//&nbsp;UnreadRune&nbsp;causes&nbsp;the&nbsp;next&nbsp;call&nbsp;to&nbsp;ReadRune&nbsp;to&nbsp;return&nbsp;the&nbsp;same&nbsp;rune.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2052634">UnreadRune</span><span class="op" id="2052644">(</span><span class="op" id="2052645">)</span>&nbsp;<span class="builtintype" id="2052647">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2052654">//&nbsp;SkipSpace&nbsp;skips&nbsp;space&nbsp;in&nbsp;the&nbsp;input.&nbsp;Newlines&nbsp;are&nbsp;treated&nbsp;as&nbsp;space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2052724">//&nbsp;unless&nbsp;the&nbsp;scan&nbsp;operation&nbsp;is&nbsp;Scanln,&nbsp;Fscanln&nbsp;or&nbsp;Sscanln,&nbsp;in&nbsp;which&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2052799">//&nbsp;a&nbsp;newline&nbsp;is&nbsp;treated&nbsp;as&nbsp;EOF.</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2052832">SkipSpace</span><span class="op" id="2052841">(</span><span class="op" id="2052842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2052845">//&nbsp;Token&nbsp;skips&nbsp;space&nbsp;in&nbsp;the&nbsp;input&nbsp;if&nbsp;skipSpace&nbsp;is&nbsp;true,&nbsp;then&nbsp;returns&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2052919">//&nbsp;run&nbsp;of&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;c&nbsp;satisfying&nbsp;f(c).&nbsp;&nbsp;If&nbsp;f&nbsp;is&nbsp;nil,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2052983">//&nbsp;!unicode.IsSpace(c)&nbsp;is&nbsp;used;&nbsp;that&nbsp;is,&nbsp;the&nbsp;token&nbsp;will&nbsp;hold&nbsp;non-space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2053055">//&nbsp;characters.&nbsp;&nbsp;Newlines&nbsp;are&nbsp;treated&nbsp;as&nbsp;space&nbsp;unless&nbsp;the&nbsp;scan&nbsp;operation</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2053128">//&nbsp;is&nbsp;Scanln,&nbsp;Fscanln&nbsp;or&nbsp;Sscanln,&nbsp;in&nbsp;which&nbsp;case&nbsp;a&nbsp;newline&nbsp;is&nbsp;treated&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2053201">//&nbsp;EOF.&nbsp;&nbsp;The&nbsp;returned&nbsp;slice&nbsp;points&nbsp;to&nbsp;shared&nbsp;data&nbsp;that&nbsp;may&nbsp;be&nbsp;overwritten</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2053276">//&nbsp;by&nbsp;the&nbsp;next&nbsp;call&nbsp;to&nbsp;Token,&nbsp;a&nbsp;call&nbsp;to&nbsp;a&nbsp;Scan&nbsp;function&nbsp;using&nbsp;the&nbsp;ScanState</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2053353">//&nbsp;as&nbsp;input,&nbsp;or&nbsp;when&nbsp;the&nbsp;calling&nbsp;Scan&nbsp;method&nbsp;returns.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2053408">Token</span><span class="op" id="2053413">(</span><span class="ident" id="2053414">skipSpace</span>&nbsp;<span class="builtintype" id="2053424">bool</span><span class="op" id="2053428">,</span>&nbsp;<span class="ident" id="2053430">f</span>&nbsp;<span class="keyword" id="2053432">func</span><span class="op" id="2053436">(</span><span class="builtintype" id="2053437">rune</span><span class="op" id="2053441">)</span>&nbsp;<span class="builtintype" id="2053443">bool</span><span class="op" id="2053447">)</span>&nbsp;<span class="op" id="2053449">(</span><span class="ident" id="2053450">token</span>&nbsp;<span class="op" id="2053456">[</span><span class="op" id="2053457">]</span><span class="builtintype" id="2053458">byte</span><span class="op" id="2053462">,</span>&nbsp;<span class="ident" id="2053464">err</span>&nbsp;<span class="builtintype" id="2053468">error</span><span class="op" id="2053473">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2053476">//&nbsp;Width&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;width&nbsp;option&nbsp;and&nbsp;whether&nbsp;it&nbsp;has&nbsp;been&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2053553">//&nbsp;The&nbsp;unit&nbsp;is&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2053590">Width</span><span class="op" id="2053595">(</span><span class="op" id="2053596">)</span>&nbsp;<span class="op" id="2053598">(</span><span class="ident" id="2053599">wid</span>&nbsp;<span class="builtintype" id="2053603">int</span><span class="op" id="2053606">,</span>&nbsp;<span class="ident" id="2053608">ok</span>&nbsp;<span class="builtintype" id="2053611">bool</span><span class="op" id="2053615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2053618">//&nbsp;Because&nbsp;ReadRune&nbsp;is&nbsp;implemented&nbsp;by&nbsp;the&nbsp;interface,&nbsp;Read&nbsp;should&nbsp;never&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2053693">//&nbsp;called&nbsp;by&nbsp;the&nbsp;scanning&nbsp;routines&nbsp;and&nbsp;a&nbsp;valid&nbsp;implementation&nbsp;of</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2053759">//&nbsp;ScanState&nbsp;may&nbsp;choose&nbsp;always&nbsp;to&nbsp;return&nbsp;an&nbsp;error&nbsp;from&nbsp;Read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2053821">Read</span><span class="op" id="2053825">(</span><span class="ident" id="2053826">buf</span>&nbsp;<span class="op" id="2053830">[</span><span class="op" id="2053831">]</span><span class="builtintype" id="2053832">byte</span><span class="op" id="2053836">)</span>&nbsp;<span class="op" id="2053838">(</span><span class="ident" id="2053839">n</span>&nbsp;<span class="builtintype" id="2053841">int</span><span class="op" id="2053844">,</span>&nbsp;<span class="ident" id="2053846">err</span>&nbsp;<span class="builtintype" id="2053850">error</span><span class="op" id="2053855">)</span><br>
<span class="lineno"></span><span class="op" id="2053857">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2053860">//&nbsp;Scanner&nbsp;is&nbsp;implemented&nbsp;by&nbsp;any&nbsp;value&nbsp;that&nbsp;has&nbsp;a&nbsp;Scan&nbsp;method,&nbsp;which&nbsp;scans</span><br>
<span class="lineno">60</span><span class="comment" id="2053935">//&nbsp;the&nbsp;input&nbsp;for&nbsp;the&nbsp;representation&nbsp;of&nbsp;a&nbsp;value&nbsp;and&nbsp;stores&nbsp;the&nbsp;result&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2054011">//&nbsp;receiver,&nbsp;which&nbsp;must&nbsp;be&nbsp;a&nbsp;pointer&nbsp;to&nbsp;be&nbsp;useful.&nbsp;&nbsp;The&nbsp;Scan&nbsp;method&nbsp;is&nbsp;called</span><br>
<span class="lineno"></span><span class="comment" id="2054089">//&nbsp;for&nbsp;any&nbsp;argument&nbsp;to&nbsp;Scan,&nbsp;Scanf,&nbsp;or&nbsp;Scanln&nbsp;that&nbsp;implements&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="2054155">type</span>&nbsp;<span class="ident" id="2054160">Scanner</span>&nbsp;<span class="keyword" id="2054168">interface</span>&nbsp;<span class="op" id="2054178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2054181">Scan</span><span class="op" id="2054185">(</span><span class="ident" id="2054186">state</span>&nbsp;<span class="ident" id="2054192">ScanState</span><span class="op" id="2054201">,</span>&nbsp;<span class="ident" id="2054203">verb</span>&nbsp;<span class="builtintype" id="2054208">rune</span><span class="op" id="2054212">)</span>&nbsp;<span class="builtintype" id="2054214">error</span><br>
<span class="lineno">65</span><span class="op" id="2054220">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2054223">//&nbsp;Scan&nbsp;scans&nbsp;text&nbsp;read&nbsp;from&nbsp;standard&nbsp;input,&nbsp;storing&nbsp;successive</span><br>
<span class="lineno"></span><span class="comment" id="2054287">//&nbsp;space-separated&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments.&nbsp;&nbsp;Newlines&nbsp;count</span><br>
<span class="lineno"></span><span class="comment" id="2054356">//&nbsp;as&nbsp;space.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;scanned.</span><br>
<span class="lineno">70</span><span class="comment" id="2054423">//&nbsp;If&nbsp;that&nbsp;is&nbsp;less&nbsp;than&nbsp;the&nbsp;number&nbsp;of&nbsp;arguments,&nbsp;err&nbsp;will&nbsp;report&nbsp;why.</span><br>
<span class="lineno"></span><span class="keyword" id="2054493">func</span>&nbsp;<span class="ident" id="2054498">Scan</span><span class="op" id="2054502">(</span><span class="ident" id="2054503">a</span>&nbsp;<span class="op" id="2054505">...</span><span class="keyword" id="2054508">interface</span><span class="op" id="2054517">{</span><span class="op" id="2054518">}</span><span class="op" id="2054519">)</span>&nbsp;<span class="op" id="2054521">(</span><span class="ident" id="2054522">n</span>&nbsp;<span class="builtintype" id="2054524">int</span><span class="op" id="2054527">,</span>&nbsp;<span class="ident" id="2054529">err</span>&nbsp;<span class="builtintype" id="2054533">error</span><span class="op" id="2054538">)</span>&nbsp;<span class="op" id="2054540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2054543">return</span>&nbsp;<span class="ident" id="2054550">Fscan</span><span class="op" id="2054555">(</span><span class="ident" id="2054556">os</span><span class="op" id="2054558">.</span><span class="ident" id="2054559">Stdin</span><span class="op" id="2054564">,</span>&nbsp;<span class="ident" id="2054566">a</span><span class="op" id="2054567">...</span><span class="op" id="2054570">)</span><br>
<span class="lineno"></span><span class="op" id="2054572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="2054575">//&nbsp;Scanln&nbsp;is&nbsp;similar&nbsp;to&nbsp;Scan,&nbsp;but&nbsp;stops&nbsp;scanning&nbsp;at&nbsp;a&nbsp;newline&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2054641">//&nbsp;after&nbsp;the&nbsp;final&nbsp;item&nbsp;there&nbsp;must&nbsp;be&nbsp;a&nbsp;newline&nbsp;or&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="keyword" id="2054697">func</span>&nbsp;<span class="ident" id="2054702">Scanln</span><span class="op" id="2054708">(</span><span class="ident" id="2054709">a</span>&nbsp;<span class="op" id="2054711">...</span><span class="keyword" id="2054714">interface</span><span class="op" id="2054723">{</span><span class="op" id="2054724">}</span><span class="op" id="2054725">)</span>&nbsp;<span class="op" id="2054727">(</span><span class="ident" id="2054728">n</span>&nbsp;<span class="builtintype" id="2054730">int</span><span class="op" id="2054733">,</span>&nbsp;<span class="ident" id="2054735">err</span>&nbsp;<span class="builtintype" id="2054739">error</span><span class="op" id="2054744">)</span>&nbsp;<span class="op" id="2054746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2054749">return</span>&nbsp;<span class="ident" id="2054756">Fscanln</span><span class="op" id="2054763">(</span><span class="ident" id="2054764">os</span><span class="op" id="2054766">.</span><span class="ident" id="2054767">Stdin</span><span class="op" id="2054772">,</span>&nbsp;<span class="ident" id="2054774">a</span><span class="op" id="2054775">...</span><span class="op" id="2054778">)</span><br>
<span class="lineno"></span><span class="op" id="2054780">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="2054783">//&nbsp;Scanf&nbsp;scans&nbsp;text&nbsp;read&nbsp;from&nbsp;standard&nbsp;input,&nbsp;storing&nbsp;successive</span><br>
<span class="lineno"></span><span class="comment" id="2054848">//&nbsp;space-separated&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments&nbsp;as&nbsp;determined&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2054917">//&nbsp;the&nbsp;format.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;scanned.</span><br>
<span class="lineno"></span><span class="keyword" id="2054986">func</span>&nbsp;<span class="ident" id="2054991">Scanf</span><span class="op" id="2054996">(</span><span class="ident" id="2054997">format</span>&nbsp;<span class="builtintype" id="2055004">string</span><span class="op" id="2055010">,</span>&nbsp;<span class="ident" id="2055012">a</span>&nbsp;<span class="op" id="2055014">...</span><span class="keyword" id="2055017">interface</span><span class="op" id="2055026">{</span><span class="op" id="2055027">}</span><span class="op" id="2055028">)</span>&nbsp;<span class="op" id="2055030">(</span><span class="ident" id="2055031">n</span>&nbsp;<span class="builtintype" id="2055033">int</span><span class="op" id="2055036">,</span>&nbsp;<span class="ident" id="2055038">err</span>&nbsp;<span class="builtintype" id="2055042">error</span><span class="op" id="2055047">)</span>&nbsp;<span class="op" id="2055049">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2055052">return</span>&nbsp;<span class="ident" id="2055059">Fscanf</span><span class="op" id="2055065">(</span><span class="ident" id="2055066">os</span><span class="op" id="2055068">.</span><span class="ident" id="2055069">Stdin</span><span class="op" id="2055074">,</span>&nbsp;<span class="ident" id="2055076">format</span><span class="op" id="2055082">,</span>&nbsp;<span class="ident" id="2055084">a</span><span class="op" id="2055085">...</span><span class="op" id="2055088">)</span><br>
<span class="lineno"></span><span class="op" id="2055090">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2055093">type</span>&nbsp;<span class="ident" id="2055098">stringReader</span>&nbsp;<span class="builtintype" id="2055111">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="2055119">func</span>&nbsp;<span class="op" id="2055124">(</span><span class="ident" id="2055125">r</span>&nbsp;<span class="op" id="2055127">*</span><span class="ident" id="2055128">stringReader</span><span class="op" id="2055140">)</span>&nbsp;<span class="ident" id="2055142">Read</span><span class="op" id="2055146">(</span><span class="ident" id="2055147">b</span>&nbsp;<span class="op" id="2055149">[</span><span class="op" id="2055150">]</span><span class="builtintype" id="2055151">byte</span><span class="op" id="2055155">)</span>&nbsp;<span class="op" id="2055157">(</span><span class="ident" id="2055158">n</span>&nbsp;<span class="builtintype" id="2055160">int</span><span class="op" id="2055163">,</span>&nbsp;<span class="ident" id="2055165">err</span>&nbsp;<span class="builtintype" id="2055169">error</span><span class="op" id="2055174">)</span>&nbsp;<span class="op" id="2055176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2055179">n</span>&nbsp;<span class="op" id="2055181">=</span>&nbsp;<span class="builtinfunc" id="2055183">copy</span><span class="op" id="2055187">(</span><span class="ident" id="2055188">b</span><span class="op" id="2055189">,</span>&nbsp;<span class="op" id="2055191">*</span><span class="ident" id="2055192">r</span><span class="op" id="2055193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2055196">*</span><span class="ident" id="2055197">r</span>&nbsp;<span class="op" id="2055199">=</span>&nbsp;<span class="op" id="2055201">(</span><span class="op" id="2055202">*</span><span class="ident" id="2055203">r</span><span class="op" id="2055204">)</span><span class="op" id="2055205">[</span><span class="ident" id="2055206">n</span><span class="op" id="2055207">:</span><span class="op" id="2055208">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2055211">if</span>&nbsp;<span class="ident" id="2055214">n</span>&nbsp;<span class="op" id="2055216">==</span>&nbsp;<span class="num" id="2055219">0</span>&nbsp;<span class="op" id="2055221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2055225">err</span>&nbsp;<span class="op" id="2055229">=</span>&nbsp;<span class="ident" id="2055231">io</span><span class="op" id="2055233">.</span><span class="ident" id="2055234">EOF</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2055239">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2055242">return</span><br>
<span class="lineno"></span><span class="op" id="2055249">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2055252">//&nbsp;Sscan&nbsp;scans&nbsp;the&nbsp;argument&nbsp;string,&nbsp;storing&nbsp;successive&nbsp;space-separated</span><br>
<span class="lineno">100</span><span class="comment" id="2055323">//&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments.&nbsp;&nbsp;Newlines&nbsp;count&nbsp;as&nbsp;space.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="2055390">//&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;scanned.&nbsp;&nbsp;If&nbsp;that&nbsp;is&nbsp;less</span><br>
<span class="lineno"></span><span class="comment" id="2055460">//&nbsp;than&nbsp;the&nbsp;number&nbsp;of&nbsp;arguments,&nbsp;err&nbsp;will&nbsp;report&nbsp;why.</span><br>
<span class="lineno"></span><span class="keyword" id="2055514">func</span>&nbsp;<span class="ident" id="2055519">Sscan</span><span class="op" id="2055524">(</span><span class="ident" id="2055525">str</span>&nbsp;<span class="builtintype" id="2055529">string</span><span class="op" id="2055535">,</span>&nbsp;<span class="ident" id="2055537">a</span>&nbsp;<span class="op" id="2055539">...</span><span class="keyword" id="2055542">interface</span><span class="op" id="2055551">{</span><span class="op" id="2055552">}</span><span class="op" id="2055553">)</span>&nbsp;<span class="op" id="2055555">(</span><span class="ident" id="2055556">n</span>&nbsp;<span class="builtintype" id="2055558">int</span><span class="op" id="2055561">,</span>&nbsp;<span class="ident" id="2055563">err</span>&nbsp;<span class="builtintype" id="2055567">error</span><span class="op" id="2055572">)</span>&nbsp;<span class="op" id="2055574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2055577">return</span>&nbsp;<span class="ident" id="2055584">Fscan</span><span class="op" id="2055589">(</span><span class="op" id="2055590">(</span><span class="op" id="2055591">*</span><span class="ident" id="2055592">stringReader</span><span class="op" id="2055604">)</span><span class="op" id="2055605">(</span><span class="op" id="2055606">&amp;</span><span class="ident" id="2055607">str</span><span class="op" id="2055610">)</span><span class="op" id="2055611">,</span>&nbsp;<span class="ident" id="2055613">a</span><span class="op" id="2055614">...</span><span class="op" id="2055617">)</span><br>
<span class="lineno">105</span><span class="op" id="2055619">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2055622">//&nbsp;Sscanln&nbsp;is&nbsp;similar&nbsp;to&nbsp;Sscan,&nbsp;but&nbsp;stops&nbsp;scanning&nbsp;at&nbsp;a&nbsp;newline&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2055690">//&nbsp;after&nbsp;the&nbsp;final&nbsp;item&nbsp;there&nbsp;must&nbsp;be&nbsp;a&nbsp;newline&nbsp;or&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="keyword" id="2055746">func</span>&nbsp;<span class="ident" id="2055751">Sscanln</span><span class="op" id="2055758">(</span><span class="ident" id="2055759">str</span>&nbsp;<span class="builtintype" id="2055763">string</span><span class="op" id="2055769">,</span>&nbsp;<span class="ident" id="2055771">a</span>&nbsp;<span class="op" id="2055773">...</span><span class="keyword" id="2055776">interface</span><span class="op" id="2055785">{</span><span class="op" id="2055786">}</span><span class="op" id="2055787">)</span>&nbsp;<span class="op" id="2055789">(</span><span class="ident" id="2055790">n</span>&nbsp;<span class="builtintype" id="2055792">int</span><span class="op" id="2055795">,</span>&nbsp;<span class="ident" id="2055797">err</span>&nbsp;<span class="builtintype" id="2055801">error</span><span class="op" id="2055806">)</span>&nbsp;<span class="op" id="2055808">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2055811">return</span>&nbsp;<span class="ident" id="2055818">Fscanln</span><span class="op" id="2055825">(</span><span class="op" id="2055826">(</span><span class="op" id="2055827">*</span><span class="ident" id="2055828">stringReader</span><span class="op" id="2055840">)</span><span class="op" id="2055841">(</span><span class="op" id="2055842">&amp;</span><span class="ident" id="2055843">str</span><span class="op" id="2055846">)</span><span class="op" id="2055847">,</span>&nbsp;<span class="ident" id="2055849">a</span><span class="op" id="2055850">...</span><span class="op" id="2055853">)</span><br>
<span class="lineno"></span><span class="op" id="2055855">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2055858">//&nbsp;Sscanf&nbsp;scans&nbsp;the&nbsp;argument&nbsp;string,&nbsp;storing&nbsp;successive&nbsp;space-separated</span><br>
<span class="lineno"></span><span class="comment" id="2055930">//&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments&nbsp;as&nbsp;determined&nbsp;by&nbsp;the&nbsp;format.&nbsp;&nbsp;It</span><br>
<span class="lineno">115</span><span class="comment" id="2055999">//&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;parsed.</span><br>
<span class="lineno"></span><span class="keyword" id="2056051">func</span>&nbsp;<span class="ident" id="2056056">Sscanf</span><span class="op" id="2056062">(</span><span class="ident" id="2056063">str</span>&nbsp;<span class="builtintype" id="2056067">string</span><span class="op" id="2056073">,</span>&nbsp;<span class="ident" id="2056075">format</span>&nbsp;<span class="builtintype" id="2056082">string</span><span class="op" id="2056088">,</span>&nbsp;<span class="ident" id="2056090">a</span>&nbsp;<span class="op" id="2056092">...</span><span class="keyword" id="2056095">interface</span><span class="op" id="2056104">{</span><span class="op" id="2056105">}</span><span class="op" id="2056106">)</span>&nbsp;<span class="op" id="2056108">(</span><span class="ident" id="2056109">n</span>&nbsp;<span class="builtintype" id="2056111">int</span><span class="op" id="2056114">,</span>&nbsp;<span class="ident" id="2056116">err</span>&nbsp;<span class="builtintype" id="2056120">error</span><span class="op" id="2056125">)</span>&nbsp;<span class="op" id="2056127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2056130">return</span>&nbsp;<span class="ident" id="2056137">Fscanf</span><span class="op" id="2056143">(</span><span class="op" id="2056144">(</span><span class="op" id="2056145">*</span><span class="ident" id="2056146">stringReader</span><span class="op" id="2056158">)</span><span class="op" id="2056159">(</span><span class="op" id="2056160">&amp;</span><span class="ident" id="2056161">str</span><span class="op" id="2056164">)</span><span class="op" id="2056165">,</span>&nbsp;<span class="ident" id="2056167">format</span><span class="op" id="2056173">,</span>&nbsp;<span class="ident" id="2056175">a</span><span class="op" id="2056176">...</span><span class="op" id="2056179">)</span><br>
<span class="lineno"></span><span class="op" id="2056181">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="2056184">//&nbsp;Fscan&nbsp;scans&nbsp;text&nbsp;read&nbsp;from&nbsp;r,&nbsp;storing&nbsp;successive&nbsp;space-separated</span><br>
<span class="lineno"></span><span class="comment" id="2056252">//&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments.&nbsp;&nbsp;Newlines&nbsp;count&nbsp;as&nbsp;space.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="2056319">//&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;scanned.&nbsp;&nbsp;If&nbsp;that&nbsp;is&nbsp;less</span><br>
<span class="lineno"></span><span class="comment" id="2056389">//&nbsp;than&nbsp;the&nbsp;number&nbsp;of&nbsp;arguments,&nbsp;err&nbsp;will&nbsp;report&nbsp;why.</span><br>
<span class="lineno"></span><span class="keyword" id="2056443">func</span>&nbsp;<span class="ident" id="2056448">Fscan</span><span class="op" id="2056453">(</span><span class="ident" id="2056454">r</span>&nbsp;<span class="ident" id="2056456">io</span><span class="op" id="2056458">.</span><span class="ident" id="2056459">Reader</span><span class="op" id="2056465">,</span>&nbsp;<span class="ident" id="2056467">a</span>&nbsp;<span class="op" id="2056469">...</span><span class="keyword" id="2056472">interface</span><span class="op" id="2056481">{</span><span class="op" id="2056482">}</span><span class="op" id="2056483">)</span>&nbsp;<span class="op" id="2056485">(</span><span class="ident" id="2056486">n</span>&nbsp;<span class="builtintype" id="2056488">int</span><span class="op" id="2056491">,</span>&nbsp;<span class="ident" id="2056493">err</span>&nbsp;<span class="builtintype" id="2056497">error</span><span class="op" id="2056502">)</span>&nbsp;<span class="op" id="2056504">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2056507">s</span><span class="op" id="2056508">,</span>&nbsp;<span class="ident" id="2056510">old</span>&nbsp;<span class="op" id="2056514">:=</span>&nbsp;<span class="ident" id="2056517">newScanState</span><span class="op" id="2056529">(</span><span class="ident" id="2056530">r</span><span class="op" id="2056531">,</span>&nbsp;<span class="builtintype" id="2056533">true</span><span class="op" id="2056537">,</span>&nbsp;<span class="builtintype" id="2056539">false</span><span class="op" id="2056544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2056547">n</span><span class="op" id="2056548">,</span>&nbsp;<span class="ident" id="2056550">err</span>&nbsp;<span class="op" id="2056554">=</span>&nbsp;<span class="ident" id="2056556">s</span><span class="op" id="2056557">.</span><span class="ident" id="2056558">doScan</span><span class="op" id="2056564">(</span><span class="ident" id="2056565">a</span><span class="op" id="2056566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2056569">s</span><span class="op" id="2056570">.</span><span class="ident" id="2056571">free</span><span class="op" id="2056575">(</span><span class="ident" id="2056576">old</span><span class="op" id="2056579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2056582">return</span><br>
<span class="lineno"></span><span class="op" id="2056589">}</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span><span class="comment" id="2056592">//&nbsp;Fscanln&nbsp;is&nbsp;similar&nbsp;to&nbsp;Fscan,&nbsp;but&nbsp;stops&nbsp;scanning&nbsp;at&nbsp;a&nbsp;newline&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2056660">//&nbsp;after&nbsp;the&nbsp;final&nbsp;item&nbsp;there&nbsp;must&nbsp;be&nbsp;a&nbsp;newline&nbsp;or&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="keyword" id="2056716">func</span>&nbsp;<span class="ident" id="2056721">Fscanln</span><span class="op" id="2056728">(</span><span class="ident" id="2056729">r</span>&nbsp;<span class="ident" id="2056731">io</span><span class="op" id="2056733">.</span><span class="ident" id="2056734">Reader</span><span class="op" id="2056740">,</span>&nbsp;<span class="ident" id="2056742">a</span>&nbsp;<span class="op" id="2056744">...</span><span class="keyword" id="2056747">interface</span><span class="op" id="2056756">{</span><span class="op" id="2056757">}</span><span class="op" id="2056758">)</span>&nbsp;<span class="op" id="2056760">(</span><span class="ident" id="2056761">n</span>&nbsp;<span class="builtintype" id="2056763">int</span><span class="op" id="2056766">,</span>&nbsp;<span class="ident" id="2056768">err</span>&nbsp;<span class="builtintype" id="2056772">error</span><span class="op" id="2056777">)</span>&nbsp;<span class="op" id="2056779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2056782">s</span><span class="op" id="2056783">,</span>&nbsp;<span class="ident" id="2056785">old</span>&nbsp;<span class="op" id="2056789">:=</span>&nbsp;<span class="ident" id="2056792">newScanState</span><span class="op" id="2056804">(</span><span class="ident" id="2056805">r</span><span class="op" id="2056806">,</span>&nbsp;<span class="builtintype" id="2056808">false</span><span class="op" id="2056813">,</span>&nbsp;<span class="builtintype" id="2056815">true</span><span class="op" id="2056819">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2056822">n</span><span class="op" id="2056823">,</span>&nbsp;<span class="ident" id="2056825">err</span>&nbsp;<span class="op" id="2056829">=</span>&nbsp;<span class="ident" id="2056831">s</span><span class="op" id="2056832">.</span><span class="ident" id="2056833">doScan</span><span class="op" id="2056839">(</span><span class="ident" id="2056840">a</span><span class="op" id="2056841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2056844">s</span><span class="op" id="2056845">.</span><span class="ident" id="2056846">free</span><span class="op" id="2056850">(</span><span class="ident" id="2056851">old</span><span class="op" id="2056854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2056857">return</span><br>
<span class="lineno"></span><span class="op" id="2056864">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="comment" id="2056867">//&nbsp;Fscanf&nbsp;scans&nbsp;text&nbsp;read&nbsp;from&nbsp;r,&nbsp;storing&nbsp;successive&nbsp;space-separated</span><br>
<span class="lineno"></span><span class="comment" id="2056936">//&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments&nbsp;as&nbsp;determined&nbsp;by&nbsp;the&nbsp;format.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="2057005">//&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;parsed.</span><br>
<span class="lineno"></span><span class="keyword" id="2057057">func</span>&nbsp;<span class="ident" id="2057062">Fscanf</span><span class="op" id="2057068">(</span><span class="ident" id="2057069">r</span>&nbsp;<span class="ident" id="2057071">io</span><span class="op" id="2057073">.</span><span class="ident" id="2057074">Reader</span><span class="op" id="2057080">,</span>&nbsp;<span class="ident" id="2057082">format</span>&nbsp;<span class="builtintype" id="2057089">string</span><span class="op" id="2057095">,</span>&nbsp;<span class="ident" id="2057097">a</span>&nbsp;<span class="op" id="2057099">...</span><span class="keyword" id="2057102">interface</span><span class="op" id="2057111">{</span><span class="op" id="2057112">}</span><span class="op" id="2057113">)</span>&nbsp;<span class="op" id="2057115">(</span><span class="ident" id="2057116">n</span>&nbsp;<span class="builtintype" id="2057118">int</span><span class="op" id="2057121">,</span>&nbsp;<span class="ident" id="2057123">err</span>&nbsp;<span class="builtintype" id="2057127">error</span><span class="op" id="2057132">)</span>&nbsp;<span class="op" id="2057134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2057137">s</span><span class="op" id="2057138">,</span>&nbsp;<span class="ident" id="2057140">old</span>&nbsp;<span class="op" id="2057144">:=</span>&nbsp;<span class="ident" id="2057147">newScanState</span><span class="op" id="2057159">(</span><span class="ident" id="2057160">r</span><span class="op" id="2057161">,</span>&nbsp;<span class="builtintype" id="2057163">false</span><span class="op" id="2057168">,</span>&nbsp;<span class="builtintype" id="2057170">false</span><span class="op" id="2057175">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2057178">n</span><span class="op" id="2057179">,</span>&nbsp;<span class="ident" id="2057181">err</span>&nbsp;<span class="op" id="2057185">=</span>&nbsp;<span class="ident" id="2057187">s</span><span class="op" id="2057188">.</span><span class="ident" id="2057189">doScanf</span><span class="op" id="2057196">(</span><span class="ident" id="2057197">format</span><span class="op" id="2057203">,</span>&nbsp;<span class="ident" id="2057205">a</span><span class="op" id="2057206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2057209">s</span><span class="op" id="2057210">.</span><span class="ident" id="2057211">free</span><span class="op" id="2057215">(</span><span class="ident" id="2057216">old</span><span class="op" id="2057219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2057222">return</span><br>
<span class="lineno"></span><span class="op" id="2057229">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="comment" id="2057232">//&nbsp;scanError&nbsp;represents&nbsp;an&nbsp;error&nbsp;generated&nbsp;by&nbsp;the&nbsp;scanning&nbsp;software.</span><br>
<span class="lineno"></span><span class="comment" id="2057301">//&nbsp;It&#39;s&nbsp;used&nbsp;as&nbsp;a&nbsp;unique&nbsp;signature&nbsp;to&nbsp;identify&nbsp;such&nbsp;errors&nbsp;when&nbsp;recovering.</span><br>
<span class="lineno"></span><span class="keyword" id="2057377">type</span>&nbsp;<span class="ident" id="2057382">scanError</span>&nbsp;<span class="keyword" id="2057392">struct</span>&nbsp;<span class="op" id="2057399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2057402">err</span>&nbsp;<span class="builtintype" id="2057406">error</span><br>
<span class="lineno"></span><span class="op" id="2057412">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="keyword" id="2057415">const</span>&nbsp;<span class="ident" id="2057421">eof</span>&nbsp;<span class="op" id="2057425">=</span>&nbsp;<span class="op" id="2057427">-</span><span class="num" id="2057428">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2057431">//&nbsp;ss&nbsp;is&nbsp;the&nbsp;internal&nbsp;implementation&nbsp;of&nbsp;ScanState.</span><br>
<span class="lineno"></span><span class="keyword" id="2057482">type</span>&nbsp;<span class="ident" id="2057487">ss</span>&nbsp;<span class="keyword" id="2057490">struct</span>&nbsp;<span class="op" id="2057497">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2057500">rr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2057509">io</span><span class="op" id="2057511">.</span><span class="ident" id="2057512">RuneReader</span>&nbsp;<span class="comment" id="2057523">//&nbsp;where&nbsp;to&nbsp;read&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2057547">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2057556">buffer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2057570">//&nbsp;token&nbsp;accumulator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2057592">peekRune</span>&nbsp;<span class="builtintype" id="2057601">rune</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2057615">//&nbsp;one-rune&nbsp;lookahead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2057638">prevRune</span>&nbsp;<span class="builtintype" id="2057647">rune</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2057661">//&nbsp;last&nbsp;rune&nbsp;returned&nbsp;by&nbsp;ReadRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2057696">count</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2057705">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2057719">//&nbsp;runes&nbsp;consumed&nbsp;so&nbsp;far.</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2057746">atEOF</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2057755">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2057769">//&nbsp;already&nbsp;read&nbsp;EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2057790">ssave</span><br>
<span class="lineno"></span><span class="op" id="2057796">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2057799">//&nbsp;ssave&nbsp;holds&nbsp;the&nbsp;parts&nbsp;of&nbsp;ss&nbsp;that&nbsp;need&nbsp;to&nbsp;be</span><br>
<span class="lineno">170</span><span class="comment" id="2057846">//&nbsp;saved&nbsp;and&nbsp;restored&nbsp;on&nbsp;recursive&nbsp;scans.</span><br>
<span class="lineno"></span><span class="keyword" id="2057888">type</span>&nbsp;<span class="ident" id="2057893">ssave</span>&nbsp;<span class="keyword" id="2057899">struct</span>&nbsp;<span class="op" id="2057906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2057909">validSave</span>&nbsp;<span class="builtintype" id="2057919">bool</span>&nbsp;<span class="comment" id="2057924">//&nbsp;is&nbsp;or&nbsp;was&nbsp;a&nbsp;part&nbsp;of&nbsp;an&nbsp;actual&nbsp;ss.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2057962">nlIsEnd</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2057972">bool</span>&nbsp;<span class="comment" id="2057977">//&nbsp;whether&nbsp;newline&nbsp;terminates&nbsp;scan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2058013">nlIsSpace</span>&nbsp;<span class="builtintype" id="2058023">bool</span>&nbsp;<span class="comment" id="2058028">//&nbsp;whether&nbsp;newline&nbsp;counts&nbsp;as&nbsp;white&nbsp;space</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2058070">argLimit</span>&nbsp;&nbsp;<span class="builtintype" id="2058080">int</span>&nbsp;&nbsp;<span class="comment" id="2058085">//&nbsp;max&nbsp;value&nbsp;of&nbsp;ss.count&nbsp;for&nbsp;this&nbsp;arg;&nbsp;argLimit&nbsp;&lt;=&nbsp;limit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2058143">limit</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2058153">int</span>&nbsp;&nbsp;<span class="comment" id="2058158">//&nbsp;max&nbsp;value&nbsp;of&nbsp;ss.count.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2058185">maxWid</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2058195">int</span>&nbsp;&nbsp;<span class="comment" id="2058200">//&nbsp;width&nbsp;of&nbsp;this&nbsp;arg.</span><br>
<span class="lineno"></span><span class="op" id="2058222">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="comment" id="2058225">//&nbsp;The&nbsp;Read&nbsp;method&nbsp;is&nbsp;only&nbsp;in&nbsp;ScanState&nbsp;so&nbsp;that&nbsp;ScanState</span><br>
<span class="lineno"></span><span class="comment" id="2058283">//&nbsp;satisfies&nbsp;io.Reader.&nbsp;It&nbsp;will&nbsp;never&nbsp;be&nbsp;called&nbsp;when&nbsp;used&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="2058344">//&nbsp;intended,&nbsp;so&nbsp;there&nbsp;is&nbsp;no&nbsp;need&nbsp;to&nbsp;make&nbsp;it&nbsp;actually&nbsp;work.</span><br>
<span class="lineno"></span><span class="keyword" id="2058403">func</span>&nbsp;<span class="op" id="2058408">(</span><span class="ident" id="2058409">s</span>&nbsp;<span class="op" id="2058411">*</span><span class="ident" id="2058412">ss</span><span class="op" id="2058414">)</span>&nbsp;<span class="ident" id="2058416">Read</span><span class="op" id="2058420">(</span><span class="ident" id="2058421">buf</span>&nbsp;<span class="op" id="2058425">[</span><span class="op" id="2058426">]</span><span class="builtintype" id="2058427">byte</span><span class="op" id="2058431">)</span>&nbsp;<span class="op" id="2058433">(</span><span class="ident" id="2058434">n</span>&nbsp;<span class="builtintype" id="2058436">int</span><span class="op" id="2058439">,</span>&nbsp;<span class="ident" id="2058441">err</span>&nbsp;<span class="builtintype" id="2058445">error</span><span class="op" id="2058450">)</span>&nbsp;<span class="op" id="2058452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2058455">return</span>&nbsp;<span class="num" id="2058462">0</span><span class="op" id="2058463">,</span>&nbsp;<span class="ident" id="2058465">errors</span><span class="op" id="2058471">.</span><span class="ident" id="2058472">New</span><span class="op" id="2058475">(</span><span class="string" id="2058476">&#34;ScanState&#39;s&nbsp;Read&nbsp;should&nbsp;not&nbsp;be&nbsp;called.&nbsp;Use&nbsp;ReadRune&#34;</span><span class="op" id="2058529">)</span><br>
<span class="lineno">185</span><span class="op" id="2058531">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2058534">func</span>&nbsp;<span class="op" id="2058539">(</span><span class="ident" id="2058540">s</span>&nbsp;<span class="op" id="2058542">*</span><span class="ident" id="2058543">ss</span><span class="op" id="2058545">)</span>&nbsp;<span class="ident" id="2058547">ReadRune</span><span class="op" id="2058555">(</span><span class="op" id="2058556">)</span>&nbsp;<span class="op" id="2058558">(</span><span class="ident" id="2058559">r</span>&nbsp;<span class="builtintype" id="2058561">rune</span><span class="op" id="2058565">,</span>&nbsp;<span class="ident" id="2058567">size</span>&nbsp;<span class="builtintype" id="2058572">int</span><span class="op" id="2058575">,</span>&nbsp;<span class="ident" id="2058577">err</span>&nbsp;<span class="builtintype" id="2058581">error</span><span class="op" id="2058586">)</span>&nbsp;<span class="op" id="2058588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2058591">if</span>&nbsp;<span class="ident" id="2058594">s</span><span class="op" id="2058595">.</span><span class="ident" id="2058596">peekRune</span>&nbsp;<span class="op" id="2058605">&gt;=</span>&nbsp;<span class="num" id="2058608">0</span>&nbsp;<span class="op" id="2058610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2058614">s</span><span class="op" id="2058615">.</span><span class="ident" id="2058616">count</span><span class="op" id="2058621">++</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2058626">r</span>&nbsp;<span class="op" id="2058628">=</span>&nbsp;<span class="ident" id="2058630">s</span><span class="op" id="2058631">.</span><span class="ident" id="2058632">peekRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2058643">size</span>&nbsp;<span class="op" id="2058648">=</span>&nbsp;<span class="ident" id="2058650">utf8</span><span class="op" id="2058654">.</span><span class="ident" id="2058655">RuneLen</span><span class="op" id="2058662">(</span><span class="ident" id="2058663">r</span><span class="op" id="2058664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2058668">s</span><span class="op" id="2058669">.</span><span class="ident" id="2058670">prevRune</span>&nbsp;<span class="op" id="2058679">=</span>&nbsp;<span class="ident" id="2058681">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2058685">s</span><span class="op" id="2058686">.</span><span class="ident" id="2058687">peekRune</span>&nbsp;<span class="op" id="2058696">=</span>&nbsp;<span class="op" id="2058698">-</span><span class="num" id="2058699">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2058703">return</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2058711">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2058714">if</span>&nbsp;<span class="ident" id="2058717">s</span><span class="op" id="2058718">.</span><span class="ident" id="2058719">atEOF</span>&nbsp;<span class="op" id="2058725">||</span>&nbsp;<span class="ident" id="2058728">s</span><span class="op" id="2058729">.</span><span class="ident" id="2058730">nlIsEnd</span>&nbsp;<span class="op" id="2058738">&amp;&amp;</span>&nbsp;<span class="ident" id="2058741">s</span><span class="op" id="2058742">.</span><span class="ident" id="2058743">prevRune</span>&nbsp;<span class="op" id="2058752">==</span>&nbsp;<span class="string" id="2058755">&#39;\n&#39;</span>&nbsp;<span class="op" id="2058760">||</span>&nbsp;<span class="ident" id="2058763">s</span><span class="op" id="2058764">.</span><span class="ident" id="2058765">count</span>&nbsp;<span class="op" id="2058771">&gt;=</span>&nbsp;<span class="ident" id="2058774">s</span><span class="op" id="2058775">.</span><span class="ident" id="2058776">argLimit</span>&nbsp;<span class="op" id="2058785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2058789">err</span>&nbsp;<span class="op" id="2058793">=</span>&nbsp;<span class="ident" id="2058795">io</span><span class="op" id="2058797">.</span><span class="ident" id="2058798">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2058804">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2058812">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2058816">r</span><span class="op" id="2058817">,</span>&nbsp;<span class="ident" id="2058819">size</span><span class="op" id="2058823">,</span>&nbsp;<span class="ident" id="2058825">err</span>&nbsp;<span class="op" id="2058829">=</span>&nbsp;<span class="ident" id="2058831">s</span><span class="op" id="2058832">.</span><span class="ident" id="2058833">rr</span><span class="op" id="2058835">.</span><span class="ident" id="2058836">ReadRune</span><span class="op" id="2058844">(</span><span class="op" id="2058845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2058848">if</span>&nbsp;<span class="ident" id="2058851">err</span>&nbsp;<span class="op" id="2058855">==</span>&nbsp;<span class="ident" id="2058858">nil</span>&nbsp;<span class="op" id="2058862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2058866">s</span><span class="op" id="2058867">.</span><span class="ident" id="2058868">count</span><span class="op" id="2058873">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2058878">s</span><span class="op" id="2058879">.</span><span class="ident" id="2058880">prevRune</span>&nbsp;<span class="op" id="2058889">=</span>&nbsp;<span class="ident" id="2058891">r</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2058894">}</span>&nbsp;<span class="keyword" id="2058896">else</span>&nbsp;<span class="keyword" id="2058901">if</span>&nbsp;<span class="ident" id="2058904">err</span>&nbsp;<span class="op" id="2058908">==</span>&nbsp;<span class="ident" id="2058911">io</span><span class="op" id="2058913">.</span><span class="ident" id="2058914">EOF</span>&nbsp;<span class="op" id="2058918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2058922">s</span><span class="op" id="2058923">.</span><span class="ident" id="2058924">atEOF</span>&nbsp;<span class="op" id="2058930">=</span>&nbsp;<span class="builtintype" id="2058932">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2058938">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2058941">return</span><br>
<span class="lineno"></span><span class="op" id="2058948">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="keyword" id="2058951">func</span>&nbsp;<span class="op" id="2058956">(</span><span class="ident" id="2058957">s</span>&nbsp;<span class="op" id="2058959">*</span><span class="ident" id="2058960">ss</span><span class="op" id="2058962">)</span>&nbsp;<span class="ident" id="2058964">Width</span><span class="op" id="2058969">(</span><span class="op" id="2058970">)</span>&nbsp;<span class="op" id="2058972">(</span><span class="ident" id="2058973">wid</span>&nbsp;<span class="builtintype" id="2058977">int</span><span class="op" id="2058980">,</span>&nbsp;<span class="ident" id="2058982">ok</span>&nbsp;<span class="builtintype" id="2058985">bool</span><span class="op" id="2058989">)</span>&nbsp;<span class="op" id="2058991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2058994">if</span>&nbsp;<span class="ident" id="2058997">s</span><span class="op" id="2058998">.</span><span class="ident" id="2058999">maxWid</span>&nbsp;<span class="op" id="2059006">==</span>&nbsp;<span class="ident" id="2059009">hugeWid</span>&nbsp;<span class="op" id="2059017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2059021">return</span>&nbsp;<span class="num" id="2059028">0</span><span class="op" id="2059029">,</span>&nbsp;<span class="builtintype" id="2059031">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2059038">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2059041">return</span>&nbsp;<span class="ident" id="2059048">s</span><span class="op" id="2059049">.</span><span class="ident" id="2059050">maxWid</span><span class="op" id="2059056">,</span>&nbsp;<span class="builtintype" id="2059058">true</span><br>
<span class="lineno"></span><span class="op" id="2059063">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2059066">//&nbsp;The&nbsp;public&nbsp;method&nbsp;returns&nbsp;an&nbsp;error;&nbsp;this&nbsp;private&nbsp;one&nbsp;panics.</span><br>
<span class="lineno"></span><span class="comment" id="2059130">//&nbsp;If&nbsp;getRune&nbsp;reaches&nbsp;EOF,&nbsp;the&nbsp;return&nbsp;value&nbsp;is&nbsp;EOF&nbsp;(-1).</span><br>
<span class="lineno">220</span><span class="keyword" id="2059187">func</span>&nbsp;<span class="op" id="2059192">(</span><span class="ident" id="2059193">s</span>&nbsp;<span class="op" id="2059195">*</span><span class="ident" id="2059196">ss</span><span class="op" id="2059198">)</span>&nbsp;<span class="ident" id="2059200">getRune</span><span class="op" id="2059207">(</span><span class="op" id="2059208">)</span>&nbsp;<span class="op" id="2059210">(</span><span class="ident" id="2059211">r</span>&nbsp;<span class="builtintype" id="2059213">rune</span><span class="op" id="2059217">)</span>&nbsp;<span class="op" id="2059219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2059222">r</span><span class="op" id="2059223">,</span>&nbsp;<span class="ident" id="2059225">_</span><span class="op" id="2059226">,</span>&nbsp;<span class="ident" id="2059228">err</span>&nbsp;<span class="op" id="2059232">:=</span>&nbsp;<span class="ident" id="2059235">s</span><span class="op" id="2059236">.</span><span class="ident" id="2059237">ReadRune</span><span class="op" id="2059245">(</span><span class="op" id="2059246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2059249">if</span>&nbsp;<span class="ident" id="2059252">err</span>&nbsp;<span class="op" id="2059256">!=</span>&nbsp;<span class="ident" id="2059259">nil</span>&nbsp;<span class="op" id="2059263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2059267">if</span>&nbsp;<span class="ident" id="2059270">err</span>&nbsp;<span class="op" id="2059274">==</span>&nbsp;<span class="ident" id="2059277">io</span><span class="op" id="2059279">.</span><span class="ident" id="2059280">EOF</span>&nbsp;<span class="op" id="2059284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2059289">return</span>&nbsp;<span class="ident" id="2059296">eof</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2059302">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2059306">s</span><span class="op" id="2059307">.</span><span class="builtintype" id="2059308">error</span><span class="op" id="2059313">(</span><span class="ident" id="2059314">err</span><span class="op" id="2059317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2059320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2059323">return</span><br>
<span class="lineno"></span><span class="op" id="2059330">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="comment" id="2059333">//&nbsp;mustReadRune&nbsp;turns&nbsp;io.EOF&nbsp;into&nbsp;a&nbsp;panic(io.ErrUnexpectedEOF).</span><br>
<span class="lineno"></span><span class="comment" id="2059397">//&nbsp;It&nbsp;is&nbsp;called&nbsp;in&nbsp;cases&nbsp;such&nbsp;as&nbsp;string&nbsp;scanning&nbsp;where&nbsp;an&nbsp;EOF&nbsp;is&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="2059464">//&nbsp;syntax&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="2059481">func</span>&nbsp;<span class="op" id="2059486">(</span><span class="ident" id="2059487">s</span>&nbsp;<span class="op" id="2059489">*</span><span class="ident" id="2059490">ss</span><span class="op" id="2059492">)</span>&nbsp;<span class="ident" id="2059494">mustReadRune</span><span class="op" id="2059506">(</span><span class="op" id="2059507">)</span>&nbsp;<span class="op" id="2059509">(</span><span class="ident" id="2059510">r</span>&nbsp;<span class="builtintype" id="2059512">rune</span><span class="op" id="2059516">)</span>&nbsp;<span class="op" id="2059518">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2059521">r</span>&nbsp;<span class="op" id="2059523">=</span>&nbsp;<span class="ident" id="2059525">s</span><span class="op" id="2059526">.</span><span class="ident" id="2059527">getRune</span><span class="op" id="2059534">(</span><span class="op" id="2059535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2059538">if</span>&nbsp;<span class="ident" id="2059541">r</span>&nbsp;<span class="op" id="2059543">==</span>&nbsp;<span class="ident" id="2059546">eof</span>&nbsp;<span class="op" id="2059550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2059554">s</span><span class="op" id="2059555">.</span><span class="builtintype" id="2059556">error</span><span class="op" id="2059561">(</span><span class="ident" id="2059562">io</span><span class="op" id="2059564">.</span><span class="ident" id="2059565">ErrUnexpectedEOF</span><span class="op" id="2059581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2059584">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2059587">return</span><br>
<span class="lineno">240</span><span class="op" id="2059594">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2059597">func</span>&nbsp;<span class="op" id="2059602">(</span><span class="ident" id="2059603">s</span>&nbsp;<span class="op" id="2059605">*</span><span class="ident" id="2059606">ss</span><span class="op" id="2059608">)</span>&nbsp;<span class="ident" id="2059610">UnreadRune</span><span class="op" id="2059620">(</span><span class="op" id="2059621">)</span>&nbsp;<span class="builtintype" id="2059623">error</span>&nbsp;<span class="op" id="2059629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2059632">if</span>&nbsp;<span class="ident" id="2059635">u</span><span class="op" id="2059636">,</span>&nbsp;<span class="ident" id="2059638">ok</span>&nbsp;<span class="op" id="2059641">:=</span>&nbsp;<span class="ident" id="2059644">s</span><span class="op" id="2059645">.</span><span class="ident" id="2059646">rr</span><span class="op" id="2059648">.</span><span class="op" id="2059649">(</span><span class="ident" id="2059650">runeUnreader</span><span class="op" id="2059662">)</span><span class="op" id="2059663">;</span>&nbsp;<span class="ident" id="2059665">ok</span>&nbsp;<span class="op" id="2059668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2059672">u</span><span class="op" id="2059673">.</span><span class="ident" id="2059674">UnreadRune</span><span class="op" id="2059684">(</span><span class="op" id="2059685">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2059688">}</span>&nbsp;<span class="keyword" id="2059690">else</span>&nbsp;<span class="op" id="2059695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2059699">s</span><span class="op" id="2059700">.</span><span class="ident" id="2059701">peekRune</span>&nbsp;<span class="op" id="2059710">=</span>&nbsp;<span class="ident" id="2059712">s</span><span class="op" id="2059713">.</span><span class="ident" id="2059714">prevRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2059724">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2059727">s</span><span class="op" id="2059728">.</span><span class="ident" id="2059729">prevRune</span>&nbsp;<span class="op" id="2059738">=</span>&nbsp;<span class="op" id="2059740">-</span><span class="num" id="2059741">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2059744">s</span><span class="op" id="2059745">.</span><span class="ident" id="2059746">count</span><span class="op" id="2059751">--</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2059755">return</span>&nbsp;<span class="ident" id="2059762">nil</span><br>
<span class="lineno"></span><span class="op" id="2059766">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2059769">func</span>&nbsp;<span class="op" id="2059774">(</span><span class="ident" id="2059775">s</span>&nbsp;<span class="op" id="2059777">*</span><span class="ident" id="2059778">ss</span><span class="op" id="2059780">)</span>&nbsp;<span class="builtintype" id="2059782">error</span><span class="op" id="2059787">(</span><span class="ident" id="2059788">err</span>&nbsp;<span class="builtintype" id="2059792">error</span><span class="op" id="2059797">)</span>&nbsp;<span class="op" id="2059799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2059802">panic</span><span class="op" id="2059807">(</span><span class="ident" id="2059808">scanError</span><span class="op" id="2059817">{</span><span class="ident" id="2059818">err</span><span class="op" id="2059821">}</span><span class="op" id="2059822">)</span><br>
<span class="lineno">255</span><span class="op" id="2059824">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2059827">func</span>&nbsp;<span class="op" id="2059832">(</span><span class="ident" id="2059833">s</span>&nbsp;<span class="op" id="2059835">*</span><span class="ident" id="2059836">ss</span><span class="op" id="2059838">)</span>&nbsp;<span class="ident" id="2059840">errorString</span><span class="op" id="2059851">(</span><span class="ident" id="2059852">err</span>&nbsp;<span class="builtintype" id="2059856">string</span><span class="op" id="2059862">)</span>&nbsp;<span class="op" id="2059864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2059867">panic</span><span class="op" id="2059872">(</span><span class="ident" id="2059873">scanError</span><span class="op" id="2059882">{</span><span class="ident" id="2059883">errors</span><span class="op" id="2059889">.</span><span class="ident" id="2059890">New</span><span class="op" id="2059893">(</span><span class="ident" id="2059894">err</span><span class="op" id="2059897">)</span><span class="op" id="2059898">}</span><span class="op" id="2059899">)</span><br>
<span class="lineno"></span><span class="op" id="2059901">}</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="keyword" id="2059904">func</span>&nbsp;<span class="op" id="2059909">(</span><span class="ident" id="2059910">s</span>&nbsp;<span class="op" id="2059912">*</span><span class="ident" id="2059913">ss</span><span class="op" id="2059915">)</span>&nbsp;<span class="ident" id="2059917">Token</span><span class="op" id="2059922">(</span><span class="ident" id="2059923">skipSpace</span>&nbsp;<span class="builtintype" id="2059933">bool</span><span class="op" id="2059937">,</span>&nbsp;<span class="ident" id="2059939">f</span>&nbsp;<span class="keyword" id="2059941">func</span><span class="op" id="2059945">(</span><span class="builtintype" id="2059946">rune</span><span class="op" id="2059950">)</span>&nbsp;<span class="builtintype" id="2059952">bool</span><span class="op" id="2059956">)</span>&nbsp;<span class="op" id="2059958">(</span><span class="ident" id="2059959">tok</span>&nbsp;<span class="op" id="2059963">[</span><span class="op" id="2059964">]</span><span class="builtintype" id="2059965">byte</span><span class="op" id="2059969">,</span>&nbsp;<span class="ident" id="2059971">err</span>&nbsp;<span class="builtintype" id="2059975">error</span><span class="op" id="2059980">)</span>&nbsp;<span class="op" id="2059982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2059985">defer</span>&nbsp;<span class="keyword" id="2059991">func</span><span class="op" id="2059995">(</span><span class="op" id="2059996">)</span>&nbsp;<span class="op" id="2059998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2060002">if</span>&nbsp;<span class="ident" id="2060005">e</span>&nbsp;<span class="op" id="2060007">:=</span>&nbsp;<span class="builtinfunc" id="2060010">recover</span><span class="op" id="2060017">(</span><span class="op" id="2060018">)</span><span class="op" id="2060019">;</span>&nbsp;<span class="ident" id="2060021">e</span>&nbsp;<span class="op" id="2060023">!=</span>&nbsp;<span class="ident" id="2060026">nil</span>&nbsp;<span class="op" id="2060030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2060035">if</span>&nbsp;<span class="ident" id="2060038">se</span><span class="op" id="2060040">,</span>&nbsp;<span class="ident" id="2060042">ok</span>&nbsp;<span class="op" id="2060045">:=</span>&nbsp;<span class="ident" id="2060048">e</span><span class="op" id="2060049">.</span><span class="op" id="2060050">(</span><span class="ident" id="2060051">scanError</span><span class="op" id="2060060">)</span><span class="op" id="2060061">;</span>&nbsp;<span class="ident" id="2060063">ok</span>&nbsp;<span class="op" id="2060066">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2060072">err</span>&nbsp;<span class="op" id="2060076">=</span>&nbsp;<span class="ident" id="2060078">se</span><span class="op" id="2060080">.</span><span class="ident" id="2060081">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2060088">}</span>&nbsp;<span class="keyword" id="2060090">else</span>&nbsp;<span class="op" id="2060095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2060101">panic</span><span class="op" id="2060106">(</span><span class="ident" id="2060107">e</span><span class="op" id="2060108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2060113">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2060117">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2060120">}</span><span class="op" id="2060121">(</span><span class="op" id="2060122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2060125">if</span>&nbsp;<span class="ident" id="2060128">f</span>&nbsp;<span class="op" id="2060130">==</span>&nbsp;<span class="ident" id="2060133">nil</span>&nbsp;<span class="op" id="2060137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2060141">f</span>&nbsp;<span class="op" id="2060143">=</span>&nbsp;<span class="ident" id="2060145">notSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2060155">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2060158">s</span><span class="op" id="2060159">.</span><span class="ident" id="2060160">buf</span>&nbsp;<span class="op" id="2060164">=</span>&nbsp;<span class="ident" id="2060166">s</span><span class="op" id="2060167">.</span><span class="ident" id="2060168">buf</span><span class="op" id="2060171">[</span><span class="op" id="2060172">:</span><span class="num" id="2060173">0</span><span class="op" id="2060174">]</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2060177">tok</span>&nbsp;<span class="op" id="2060181">=</span>&nbsp;<span class="ident" id="2060183">s</span><span class="op" id="2060184">.</span><span class="ident" id="2060185">token</span><span class="op" id="2060190">(</span><span class="ident" id="2060191">skipSpace</span><span class="op" id="2060200">,</span>&nbsp;<span class="ident" id="2060202">f</span><span class="op" id="2060203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2060206">return</span><br>
<span class="lineno"></span><span class="op" id="2060213">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2060216">//&nbsp;space&nbsp;is&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;unicode.White_Space&nbsp;ranges,</span><br>
<span class="lineno">280</span><span class="comment" id="2060270">//&nbsp;to&nbsp;avoid&nbsp;depending&nbsp;on&nbsp;package&nbsp;unicode.</span><br>
<span class="lineno"></span><span class="keyword" id="2060312">var</span>&nbsp;<span class="ident" id="2060316">space</span>&nbsp;<span class="op" id="2060322">=</span>&nbsp;<span class="op" id="2060324">[</span><span class="op" id="2060325">]</span><span class="op" id="2060326">[</span><span class="num" id="2060327">2</span><span class="op" id="2060328">]</span><span class="builtintype" id="2060329">uint16</span><span class="op" id="2060335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2060338">{</span><span class="num" id="2060339">0x0009</span><span class="op" id="2060345">,</span>&nbsp;<span class="num" id="2060347">0x000d</span><span class="op" id="2060353">}</span><span class="op" id="2060354">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2060357">{</span><span class="num" id="2060358">0x0020</span><span class="op" id="2060364">,</span>&nbsp;<span class="num" id="2060366">0x0020</span><span class="op" id="2060372">}</span><span class="op" id="2060373">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2060376">{</span><span class="num" id="2060377">0x0085</span><span class="op" id="2060383">,</span>&nbsp;<span class="num" id="2060385">0x0085</span><span class="op" id="2060391">}</span><span class="op" id="2060392">,</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2060395">{</span><span class="num" id="2060396">0x00a0</span><span class="op" id="2060402">,</span>&nbsp;<span class="num" id="2060404">0x00a0</span><span class="op" id="2060410">}</span><span class="op" id="2060411">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2060414">{</span><span class="num" id="2060415">0x1680</span><span class="op" id="2060421">,</span>&nbsp;<span class="num" id="2060423">0x1680</span><span class="op" id="2060429">}</span><span class="op" id="2060430">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2060433">{</span><span class="num" id="2060434">0x2000</span><span class="op" id="2060440">,</span>&nbsp;<span class="num" id="2060442">0x200a</span><span class="op" id="2060448">}</span><span class="op" id="2060449">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2060452">{</span><span class="num" id="2060453">0x2028</span><span class="op" id="2060459">,</span>&nbsp;<span class="num" id="2060461">0x2029</span><span class="op" id="2060467">}</span><span class="op" id="2060468">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2060471">{</span><span class="num" id="2060472">0x202f</span><span class="op" id="2060478">,</span>&nbsp;<span class="num" id="2060480">0x202f</span><span class="op" id="2060486">}</span><span class="op" id="2060487">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2060490">{</span><span class="num" id="2060491">0x205f</span><span class="op" id="2060497">,</span>&nbsp;<span class="num" id="2060499">0x205f</span><span class="op" id="2060505">}</span><span class="op" id="2060506">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2060509">{</span><span class="num" id="2060510">0x3000</span><span class="op" id="2060516">,</span>&nbsp;<span class="num" id="2060518">0x3000</span><span class="op" id="2060524">}</span><span class="op" id="2060525">,</span><br>
<span class="lineno"></span><span class="op" id="2060527">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2060530">func</span>&nbsp;<span class="ident" id="2060535">isSpace</span><span class="op" id="2060542">(</span><span class="ident" id="2060543">r</span>&nbsp;<span class="builtintype" id="2060545">rune</span><span class="op" id="2060549">)</span>&nbsp;<span class="builtintype" id="2060551">bool</span>&nbsp;<span class="op" id="2060556">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2060559">if</span>&nbsp;<span class="ident" id="2060562">r</span>&nbsp;<span class="op" id="2060564">&gt;=</span>&nbsp;<span class="num" id="2060567">1</span><span class="op" id="2060568">&lt;&lt;</span><span class="num" id="2060570">16</span>&nbsp;<span class="op" id="2060573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2060577">return</span>&nbsp;<span class="builtintype" id="2060584">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2060591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2060594">rx</span>&nbsp;<span class="op" id="2060597">:=</span>&nbsp;<span class="builtintype" id="2060600">uint16</span><span class="op" id="2060606">(</span><span class="ident" id="2060607">r</span><span class="op" id="2060608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2060611">for</span>&nbsp;<span class="ident" id="2060615">_</span><span class="op" id="2060616">,</span>&nbsp;<span class="ident" id="2060618">rng</span>&nbsp;<span class="op" id="2060622">:=</span>&nbsp;<span class="keyword" id="2060625">range</span>&nbsp;<span class="ident" id="2060631">space</span>&nbsp;<span class="op" id="2060637">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2060641">if</span>&nbsp;<span class="ident" id="2060644">rx</span>&nbsp;<span class="op" id="2060647">&lt;</span>&nbsp;<span class="ident" id="2060649">rng</span><span class="op" id="2060652">[</span><span class="num" id="2060653">0</span><span class="op" id="2060654">]</span>&nbsp;<span class="op" id="2060656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2060661">return</span>&nbsp;<span class="builtintype" id="2060668">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2060676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2060680">if</span>&nbsp;<span class="ident" id="2060683">rx</span>&nbsp;<span class="op" id="2060686">&lt;=</span>&nbsp;<span class="ident" id="2060689">rng</span><span class="op" id="2060692">[</span><span class="num" id="2060693">1</span><span class="op" id="2060694">]</span>&nbsp;<span class="op" id="2060696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2060701">return</span>&nbsp;<span class="builtintype" id="2060708">true</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2060715">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2060718">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2060721">return</span>&nbsp;<span class="builtintype" id="2060728">false</span><br>
<span class="lineno"></span><span class="op" id="2060734">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="2060737">//&nbsp;notSpace&nbsp;is&nbsp;the&nbsp;default&nbsp;scanning&nbsp;function&nbsp;used&nbsp;in&nbsp;Token.</span><br>
<span class="lineno"></span><span class="keyword" id="2060797">func</span>&nbsp;<span class="ident" id="2060802">notSpace</span><span class="op" id="2060810">(</span><span class="ident" id="2060811">r</span>&nbsp;<span class="builtintype" id="2060813">rune</span><span class="op" id="2060817">)</span>&nbsp;<span class="builtintype" id="2060819">bool</span>&nbsp;<span class="op" id="2060824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2060827">return</span>&nbsp;<span class="op" id="2060834">!</span><span class="ident" id="2060835">isSpace</span><span class="op" id="2060842">(</span><span class="ident" id="2060843">r</span><span class="op" id="2060844">)</span><br>
<span class="lineno"></span><span class="op" id="2060846">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">315</span><span class="comment" id="2060849">//&nbsp;SkipSpace&nbsp;provides&nbsp;Scan&nbsp;methods&nbsp;the&nbsp;ability&nbsp;to&nbsp;skip&nbsp;space&nbsp;and&nbsp;newline</span><br>
<span class="lineno"></span><span class="comment" id="2060922">//&nbsp;characters&nbsp;in&nbsp;keeping&nbsp;with&nbsp;the&nbsp;current&nbsp;scanning&nbsp;mode&nbsp;set&nbsp;by&nbsp;format&nbsp;strings</span><br>
<span class="lineno"></span><span class="comment" id="2061000">//&nbsp;and&nbsp;Scan/Scanln.</span><br>
<span class="lineno"></span><span class="keyword" id="2061020">func</span>&nbsp;<span class="op" id="2061025">(</span><span class="ident" id="2061026">s</span>&nbsp;<span class="op" id="2061028">*</span><span class="ident" id="2061029">ss</span><span class="op" id="2061031">)</span>&nbsp;<span class="ident" id="2061033">SkipSpace</span><span class="op" id="2061042">(</span><span class="op" id="2061043">)</span>&nbsp;<span class="op" id="2061045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2061048">s</span><span class="op" id="2061049">.</span><span class="ident" id="2061050">skipSpace</span><span class="op" id="2061059">(</span><span class="builtintype" id="2061060">false</span><span class="op" id="2061065">)</span><br>
<span class="lineno">320</span><span class="op" id="2061067">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2061070">//&nbsp;readRune&nbsp;is&nbsp;a&nbsp;structure&nbsp;to&nbsp;enable&nbsp;reading&nbsp;UTF-8&nbsp;encoded&nbsp;code&nbsp;points</span><br>
<span class="lineno"></span><span class="comment" id="2061141">//&nbsp;from&nbsp;an&nbsp;io.Reader.&nbsp;&nbsp;It&nbsp;is&nbsp;used&nbsp;if&nbsp;the&nbsp;Reader&nbsp;given&nbsp;to&nbsp;the&nbsp;scanner&nbsp;does</span><br>
<span class="lineno"></span><span class="comment" id="2061215">//&nbsp;not&nbsp;already&nbsp;implement&nbsp;io.RuneReader.</span><br>
<span class="lineno">325</span><span class="keyword" id="2061255">type</span>&nbsp;<span class="ident" id="2061260">readRune</span>&nbsp;<span class="keyword" id="2061269">struct</span>&nbsp;<span class="op" id="2061276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2061279">reader</span>&nbsp;&nbsp;<span class="ident" id="2061287">io</span><span class="op" id="2061289">.</span><span class="ident" id="2061290">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2061298">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2061306">[</span><span class="ident" id="2061307">utf8</span><span class="op" id="2061311">.</span><span class="ident" id="2061312">UTFMax</span><span class="op" id="2061318">]</span><span class="builtintype" id="2061319">byte</span>&nbsp;<span class="comment" id="2061324">//&nbsp;used&nbsp;only&nbsp;inside&nbsp;ReadRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2061354">pending</span>&nbsp;<span class="builtintype" id="2061362">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2061380">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;in&nbsp;pendBuf;&nbsp;only&nbsp;&gt;0&nbsp;for&nbsp;bad&nbsp;UTF-8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2061434">pendBuf</span>&nbsp;<span class="op" id="2061442">[</span><span class="ident" id="2061443">utf8</span><span class="op" id="2061447">.</span><span class="ident" id="2061448">UTFMax</span><span class="op" id="2061454">]</span><span class="builtintype" id="2061455">byte</span>&nbsp;<span class="comment" id="2061460">//&nbsp;bytes&nbsp;left&nbsp;over</span><br>
<span class="lineno">330</span><span class="op" id="2061479">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2061482">//&nbsp;readByte&nbsp;returns&nbsp;the&nbsp;next&nbsp;byte&nbsp;from&nbsp;the&nbsp;input,&nbsp;which&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="2061545">//&nbsp;left&nbsp;over&nbsp;from&nbsp;a&nbsp;previous&nbsp;read&nbsp;if&nbsp;the&nbsp;UTF-8&nbsp;was&nbsp;ill-formed.</span><br>
<span class="lineno"></span><span class="keyword" id="2061608">func</span>&nbsp;<span class="op" id="2061613">(</span><span class="ident" id="2061614">r</span>&nbsp;<span class="op" id="2061616">*</span><span class="ident" id="2061617">readRune</span><span class="op" id="2061625">)</span>&nbsp;<span class="ident" id="2061627">readByte</span><span class="op" id="2061635">(</span><span class="op" id="2061636">)</span>&nbsp;<span class="op" id="2061638">(</span><span class="ident" id="2061639">b</span>&nbsp;<span class="builtintype" id="2061641">byte</span><span class="op" id="2061645">,</span>&nbsp;<span class="ident" id="2061647">err</span>&nbsp;<span class="builtintype" id="2061651">error</span><span class="op" id="2061656">)</span>&nbsp;<span class="op" id="2061658">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2061661">if</span>&nbsp;<span class="ident" id="2061664">r</span><span class="op" id="2061665">.</span><span class="ident" id="2061666">pending</span>&nbsp;<span class="op" id="2061674">&gt;</span>&nbsp;<span class="num" id="2061676">0</span>&nbsp;<span class="op" id="2061678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2061682">b</span>&nbsp;<span class="op" id="2061684">=</span>&nbsp;<span class="ident" id="2061686">r</span><span class="op" id="2061687">.</span><span class="ident" id="2061688">pendBuf</span><span class="op" id="2061695">[</span><span class="num" id="2061696">0</span><span class="op" id="2061697">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2061701">copy</span><span class="op" id="2061705">(</span><span class="ident" id="2061706">r</span><span class="op" id="2061707">.</span><span class="ident" id="2061708">pendBuf</span><span class="op" id="2061715">[</span><span class="num" id="2061716">0</span><span class="op" id="2061717">:</span><span class="op" id="2061718">]</span><span class="op" id="2061719">,</span>&nbsp;<span class="ident" id="2061721">r</span><span class="op" id="2061722">.</span><span class="ident" id="2061723">pendBuf</span><span class="op" id="2061730">[</span><span class="num" id="2061731">1</span><span class="op" id="2061732">:</span><span class="op" id="2061733">]</span><span class="op" id="2061734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2061738">r</span><span class="op" id="2061739">.</span><span class="ident" id="2061740">pending</span><span class="op" id="2061747">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2061752">return</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2061760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2061763">n</span><span class="op" id="2061764">,</span>&nbsp;<span class="ident" id="2061766">err</span>&nbsp;<span class="op" id="2061770">:=</span>&nbsp;<span class="ident" id="2061773">io</span><span class="op" id="2061775">.</span><span class="ident" id="2061776">ReadFull</span><span class="op" id="2061784">(</span><span class="ident" id="2061785">r</span><span class="op" id="2061786">.</span><span class="ident" id="2061787">reader</span><span class="op" id="2061793">,</span>&nbsp;<span class="ident" id="2061795">r</span><span class="op" id="2061796">.</span><span class="ident" id="2061797">pendBuf</span><span class="op" id="2061804">[</span><span class="num" id="2061805">0</span><span class="op" id="2061806">:</span><span class="num" id="2061807">1</span><span class="op" id="2061808">]</span><span class="op" id="2061809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2061812">if</span>&nbsp;<span class="ident" id="2061815">n</span>&nbsp;<span class="op" id="2061817">!=</span>&nbsp;<span class="num" id="2061820">1</span>&nbsp;<span class="op" id="2061822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2061826">return</span>&nbsp;<span class="num" id="2061833">0</span><span class="op" id="2061834">,</span>&nbsp;<span class="ident" id="2061836">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2061841">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2061844">return</span>&nbsp;<span class="ident" id="2061851">r</span><span class="op" id="2061852">.</span><span class="ident" id="2061853">pendBuf</span><span class="op" id="2061860">[</span><span class="num" id="2061861">0</span><span class="op" id="2061862">]</span><span class="op" id="2061863">,</span>&nbsp;<span class="ident" id="2061865">err</span><br>
<span class="lineno"></span><span class="op" id="2061869">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2061872">//&nbsp;unread&nbsp;saves&nbsp;the&nbsp;bytes&nbsp;for&nbsp;the&nbsp;next&nbsp;read.</span><br>
<span class="lineno"></span><span class="keyword" id="2061917">func</span>&nbsp;<span class="op" id="2061922">(</span><span class="ident" id="2061923">r</span>&nbsp;<span class="op" id="2061925">*</span><span class="ident" id="2061926">readRune</span><span class="op" id="2061934">)</span>&nbsp;<span class="ident" id="2061936">unread</span><span class="op" id="2061942">(</span><span class="ident" id="2061943">buf</span>&nbsp;<span class="op" id="2061947">[</span><span class="op" id="2061948">]</span><span class="builtintype" id="2061949">byte</span><span class="op" id="2061953">)</span>&nbsp;<span class="op" id="2061955">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2061958">copy</span><span class="op" id="2061962">(</span><span class="ident" id="2061963">r</span><span class="op" id="2061964">.</span><span class="ident" id="2061965">pendBuf</span><span class="op" id="2061972">[</span><span class="ident" id="2061973">r</span><span class="op" id="2061974">.</span><span class="ident" id="2061975">pending</span><span class="op" id="2061982">:</span><span class="op" id="2061983">]</span><span class="op" id="2061984">,</span>&nbsp;<span class="ident" id="2061986">buf</span><span class="op" id="2061989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2061992">r</span><span class="op" id="2061993">.</span><span class="ident" id="2061994">pending</span>&nbsp;<span class="op" id="2062002">+=</span>&nbsp;<span class="builtinfunc" id="2062005">len</span><span class="op" id="2062008">(</span><span class="ident" id="2062009">buf</span><span class="op" id="2062012">)</span><br>
<span class="lineno"></span><span class="op" id="2062014">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2062017">//&nbsp;ReadRune&nbsp;returns&nbsp;the&nbsp;next&nbsp;UTF-8&nbsp;encoded&nbsp;code&nbsp;point&nbsp;from&nbsp;the</span><br>
<span class="lineno">355</span><span class="comment" id="2062080">//&nbsp;io.Reader&nbsp;inside&nbsp;r.</span><br>
<span class="lineno"></span><span class="keyword" id="2062103">func</span>&nbsp;<span class="op" id="2062108">(</span><span class="ident" id="2062109">r</span>&nbsp;<span class="op" id="2062111">*</span><span class="ident" id="2062112">readRune</span><span class="op" id="2062120">)</span>&nbsp;<span class="ident" id="2062122">ReadRune</span><span class="op" id="2062130">(</span><span class="op" id="2062131">)</span>&nbsp;<span class="op" id="2062133">(</span><span class="ident" id="2062134">rr</span>&nbsp;<span class="builtintype" id="2062137">rune</span><span class="op" id="2062141">,</span>&nbsp;<span class="ident" id="2062143">size</span>&nbsp;<span class="builtintype" id="2062148">int</span><span class="op" id="2062151">,</span>&nbsp;<span class="ident" id="2062153">err</span>&nbsp;<span class="builtintype" id="2062157">error</span><span class="op" id="2062162">)</span>&nbsp;<span class="op" id="2062164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2062167">r</span><span class="op" id="2062168">.</span><span class="ident" id="2062169">buf</span><span class="op" id="2062172">[</span><span class="num" id="2062173">0</span><span class="op" id="2062174">]</span><span class="op" id="2062175">,</span>&nbsp;<span class="ident" id="2062177">err</span>&nbsp;<span class="op" id="2062181">=</span>&nbsp;<span class="ident" id="2062183">r</span><span class="op" id="2062184">.</span><span class="ident" id="2062185">readByte</span><span class="op" id="2062193">(</span><span class="op" id="2062194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2062197">if</span>&nbsp;<span class="ident" id="2062200">err</span>&nbsp;<span class="op" id="2062204">!=</span>&nbsp;<span class="ident" id="2062207">nil</span>&nbsp;<span class="op" id="2062211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2062215">return</span>&nbsp;<span class="num" id="2062222">0</span><span class="op" id="2062223">,</span>&nbsp;<span class="num" id="2062225">0</span><span class="op" id="2062226">,</span>&nbsp;<span class="ident" id="2062228">err</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2062233">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2062236">if</span>&nbsp;<span class="ident" id="2062239">r</span><span class="op" id="2062240">.</span><span class="ident" id="2062241">buf</span><span class="op" id="2062244">[</span><span class="num" id="2062245">0</span><span class="op" id="2062246">]</span>&nbsp;<span class="op" id="2062248">&lt;</span>&nbsp;<span class="ident" id="2062250">utf8</span><span class="op" id="2062254">.</span><span class="ident" id="2062255">RuneSelf</span>&nbsp;<span class="op" id="2062264">{</span>&nbsp;<span class="comment" id="2062266">//&nbsp;fast&nbsp;check&nbsp;for&nbsp;common&nbsp;ASCII&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2062304">rr</span>&nbsp;<span class="op" id="2062307">=</span>&nbsp;<span class="builtintype" id="2062309">rune</span><span class="op" id="2062313">(</span><span class="ident" id="2062314">r</span><span class="op" id="2062315">.</span><span class="ident" id="2062316">buf</span><span class="op" id="2062319">[</span><span class="num" id="2062320">0</span><span class="op" id="2062321">]</span><span class="op" id="2062322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2062326">size</span>&nbsp;<span class="op" id="2062331">=</span>&nbsp;<span class="num" id="2062333">1</span>&nbsp;<span class="comment" id="2062335">//&nbsp;Known&nbsp;to&nbsp;be&nbsp;1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2062355">return</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2062363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2062366">var</span>&nbsp;<span class="ident" id="2062370">n</span>&nbsp;<span class="builtintype" id="2062372">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2062377">for</span>&nbsp;<span class="ident" id="2062381">n</span>&nbsp;<span class="op" id="2062383">=</span>&nbsp;<span class="num" id="2062385">1</span><span class="op" id="2062386">;</span>&nbsp;<span class="op" id="2062388">!</span><span class="ident" id="2062389">utf8</span><span class="op" id="2062393">.</span><span class="ident" id="2062394">FullRune</span><span class="op" id="2062402">(</span><span class="ident" id="2062403">r</span><span class="op" id="2062404">.</span><span class="ident" id="2062405">buf</span><span class="op" id="2062408">[</span><span class="num" id="2062409">0</span><span class="op" id="2062410">:</span><span class="ident" id="2062411">n</span><span class="op" id="2062412">]</span><span class="op" id="2062413">)</span><span class="op" id="2062414">;</span>&nbsp;<span class="ident" id="2062416">n</span><span class="op" id="2062417">++</span>&nbsp;<span class="op" id="2062420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2062424">r</span><span class="op" id="2062425">.</span><span class="ident" id="2062426">buf</span><span class="op" id="2062429">[</span><span class="ident" id="2062430">n</span><span class="op" id="2062431">]</span><span class="op" id="2062432">,</span>&nbsp;<span class="ident" id="2062434">err</span>&nbsp;<span class="op" id="2062438">=</span>&nbsp;<span class="ident" id="2062440">r</span><span class="op" id="2062441">.</span><span class="ident" id="2062442">readByte</span><span class="op" id="2062450">(</span><span class="op" id="2062451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2062455">if</span>&nbsp;<span class="ident" id="2062458">err</span>&nbsp;<span class="op" id="2062462">!=</span>&nbsp;<span class="ident" id="2062465">nil</span>&nbsp;<span class="op" id="2062469">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2062474">if</span>&nbsp;<span class="ident" id="2062477">err</span>&nbsp;<span class="op" id="2062481">==</span>&nbsp;<span class="ident" id="2062484">io</span><span class="op" id="2062486">.</span><span class="ident" id="2062487">EOF</span>&nbsp;<span class="op" id="2062491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2062497">err</span>&nbsp;<span class="op" id="2062501">=</span>&nbsp;<span class="ident" id="2062503">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2062511">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2062520">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2062525">return</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2062534">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2062537">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2062540">rr</span><span class="op" id="2062542">,</span>&nbsp;<span class="ident" id="2062544">size</span>&nbsp;<span class="op" id="2062549">=</span>&nbsp;<span class="ident" id="2062551">utf8</span><span class="op" id="2062555">.</span><span class="ident" id="2062556">DecodeRune</span><span class="op" id="2062566">(</span><span class="ident" id="2062567">r</span><span class="op" id="2062568">.</span><span class="ident" id="2062569">buf</span><span class="op" id="2062572">[</span><span class="num" id="2062573">0</span><span class="op" id="2062574">:</span><span class="ident" id="2062575">n</span><span class="op" id="2062576">]</span><span class="op" id="2062577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2062580">if</span>&nbsp;<span class="ident" id="2062583">size</span>&nbsp;<span class="op" id="2062588">&lt;</span>&nbsp;<span class="ident" id="2062590">n</span>&nbsp;<span class="op" id="2062592">{</span>&nbsp;<span class="comment" id="2062594">//&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2062608">r</span><span class="op" id="2062609">.</span><span class="ident" id="2062610">unread</span><span class="op" id="2062616">(</span><span class="ident" id="2062617">r</span><span class="op" id="2062618">.</span><span class="ident" id="2062619">buf</span><span class="op" id="2062622">[</span><span class="ident" id="2062623">size</span><span class="op" id="2062627">:</span><span class="ident" id="2062628">n</span><span class="op" id="2062629">]</span><span class="op" id="2062630">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2062633">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2062636">return</span><br>
<span class="lineno"></span><span class="op" id="2062643">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2062646">var</span>&nbsp;<span class="ident" id="2062650">ssFree</span>&nbsp;<span class="op" id="2062657">=</span>&nbsp;<span class="ident" id="2062659">sync</span><span class="op" id="2062663">.</span><span class="ident" id="2062664">Pool</span><span class="op" id="2062668">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2062671">New</span><span class="op" id="2062674">:</span>&nbsp;<span class="keyword" id="2062676">func</span><span class="op" id="2062680">(</span><span class="op" id="2062681">)</span>&nbsp;<span class="keyword" id="2062683">interface</span><span class="op" id="2062692">{</span><span class="op" id="2062693">}</span>&nbsp;<span class="op" id="2062695">{</span>&nbsp;<span class="keyword" id="2062697">return</span>&nbsp;<span class="builtinfunc" id="2062704">new</span><span class="op" id="2062707">(</span><span class="ident" id="2062708">ss</span><span class="op" id="2062710">)</span>&nbsp;<span class="op" id="2062712">}</span><span class="op" id="2062713">,</span><br>
<span class="lineno"></span><span class="op" id="2062715">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2062718">//&nbsp;newScanState&nbsp;allocates&nbsp;a&nbsp;new&nbsp;ss&nbsp;struct&nbsp;or&nbsp;grab&nbsp;a&nbsp;cached&nbsp;one.</span><br>
<span class="lineno"></span><span class="keyword" id="2062782">func</span>&nbsp;<span class="ident" id="2062787">newScanState</span><span class="op" id="2062799">(</span><span class="ident" id="2062800">r</span>&nbsp;<span class="ident" id="2062802">io</span><span class="op" id="2062804">.</span><span class="ident" id="2062805">Reader</span><span class="op" id="2062811">,</span>&nbsp;<span class="ident" id="2062813">nlIsSpace</span><span class="op" id="2062822">,</span>&nbsp;<span class="ident" id="2062824">nlIsEnd</span>&nbsp;<span class="builtintype" id="2062832">bool</span><span class="op" id="2062836">)</span>&nbsp;<span class="op" id="2062838">(</span><span class="ident" id="2062839">s</span>&nbsp;<span class="op" id="2062841">*</span><span class="ident" id="2062842">ss</span><span class="op" id="2062844">,</span>&nbsp;<span class="ident" id="2062846">old</span>&nbsp;<span class="ident" id="2062850">ssave</span><span class="op" id="2062855">)</span>&nbsp;<span class="op" id="2062857">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2062860">//&nbsp;If&nbsp;the&nbsp;reader&nbsp;is&nbsp;a&nbsp;*ss,&nbsp;then&nbsp;we&#39;ve&nbsp;got&nbsp;a&nbsp;recursive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2062915">//&nbsp;call&nbsp;to&nbsp;Scan,&nbsp;so&nbsp;re-use&nbsp;the&nbsp;scan&nbsp;state.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2062959">s</span><span class="op" id="2062960">,</span>&nbsp;<span class="ident" id="2062962">ok</span>&nbsp;<span class="op" id="2062965">:=</span>&nbsp;<span class="ident" id="2062968">r</span><span class="op" id="2062969">.</span><span class="op" id="2062970">(</span><span class="op" id="2062971">*</span><span class="ident" id="2062972">ss</span><span class="op" id="2062974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2062977">if</span>&nbsp;<span class="ident" id="2062980">ok</span>&nbsp;<span class="op" id="2062983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2062987">old</span>&nbsp;<span class="op" id="2062991">=</span>&nbsp;<span class="ident" id="2062993">s</span><span class="op" id="2062994">.</span><span class="ident" id="2062995">ssave</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2063003">s</span><span class="op" id="2063004">.</span><span class="ident" id="2063005">limit</span>&nbsp;<span class="op" id="2063011">=</span>&nbsp;<span class="ident" id="2063013">s</span><span class="op" id="2063014">.</span><span class="ident" id="2063015">argLimit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2063026">s</span><span class="op" id="2063027">.</span><span class="ident" id="2063028">nlIsEnd</span>&nbsp;<span class="op" id="2063036">=</span>&nbsp;<span class="ident" id="2063038">nlIsEnd</span>&nbsp;<span class="op" id="2063046">||</span>&nbsp;<span class="ident" id="2063049">s</span><span class="op" id="2063050">.</span><span class="ident" id="2063051">nlIsEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2063061">s</span><span class="op" id="2063062">.</span><span class="ident" id="2063063">nlIsSpace</span>&nbsp;<span class="op" id="2063073">=</span>&nbsp;<span class="ident" id="2063075">nlIsSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2063087">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2063095">}</span><br>
<span class="lineno">400</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2063099">s</span>&nbsp;<span class="op" id="2063101">=</span>&nbsp;<span class="ident" id="2063103">ssFree</span><span class="op" id="2063109">.</span><span class="ident" id="2063110">Get</span><span class="op" id="2063113">(</span><span class="op" id="2063114">)</span><span class="op" id="2063115">.</span><span class="op" id="2063116">(</span><span class="op" id="2063117">*</span><span class="ident" id="2063118">ss</span><span class="op" id="2063120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2063123">if</span>&nbsp;<span class="ident" id="2063126">rr</span><span class="op" id="2063128">,</span>&nbsp;<span class="ident" id="2063130">ok</span>&nbsp;<span class="op" id="2063133">:=</span>&nbsp;<span class="ident" id="2063136">r</span><span class="op" id="2063137">.</span><span class="op" id="2063138">(</span><span class="ident" id="2063139">io</span><span class="op" id="2063141">.</span><span class="ident" id="2063142">RuneReader</span><span class="op" id="2063152">)</span><span class="op" id="2063153">;</span>&nbsp;<span class="ident" id="2063155">ok</span>&nbsp;<span class="op" id="2063158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2063162">s</span><span class="op" id="2063163">.</span><span class="ident" id="2063164">rr</span>&nbsp;<span class="op" id="2063167">=</span>&nbsp;<span class="ident" id="2063169">rr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2063173">}</span>&nbsp;<span class="keyword" id="2063175">else</span>&nbsp;<span class="op" id="2063180">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2063184">s</span><span class="op" id="2063185">.</span><span class="ident" id="2063186">rr</span>&nbsp;<span class="op" id="2063189">=</span>&nbsp;<span class="op" id="2063191">&amp;</span><span class="ident" id="2063192">readRune</span><span class="op" id="2063200">{</span><span class="ident" id="2063201">reader</span><span class="op" id="2063207">:</span>&nbsp;<span class="ident" id="2063209">r</span><span class="op" id="2063210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2063213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2063216">s</span><span class="op" id="2063217">.</span><span class="ident" id="2063218">nlIsSpace</span>&nbsp;<span class="op" id="2063228">=</span>&nbsp;<span class="ident" id="2063230">nlIsSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2063241">s</span><span class="op" id="2063242">.</span><span class="ident" id="2063243">nlIsEnd</span>&nbsp;<span class="op" id="2063251">=</span>&nbsp;<span class="ident" id="2063253">nlIsEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2063262">s</span><span class="op" id="2063263">.</span><span class="ident" id="2063264">prevRune</span>&nbsp;<span class="op" id="2063273">=</span>&nbsp;<span class="op" id="2063275">-</span><span class="num" id="2063276">1</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2063279">s</span><span class="op" id="2063280">.</span><span class="ident" id="2063281">peekRune</span>&nbsp;<span class="op" id="2063290">=</span>&nbsp;<span class="op" id="2063292">-</span><span class="num" id="2063293">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2063296">s</span><span class="op" id="2063297">.</span><span class="ident" id="2063298">atEOF</span>&nbsp;<span class="op" id="2063304">=</span>&nbsp;<span class="builtintype" id="2063306">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2063313">s</span><span class="op" id="2063314">.</span><span class="ident" id="2063315">limit</span>&nbsp;<span class="op" id="2063321">=</span>&nbsp;<span class="ident" id="2063323">hugeWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2063332">s</span><span class="op" id="2063333">.</span><span class="ident" id="2063334">argLimit</span>&nbsp;<span class="op" id="2063343">=</span>&nbsp;<span class="ident" id="2063345">hugeWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2063354">s</span><span class="op" id="2063355">.</span><span class="ident" id="2063356">maxWid</span>&nbsp;<span class="op" id="2063363">=</span>&nbsp;<span class="ident" id="2063365">hugeWid</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2063374">s</span><span class="op" id="2063375">.</span><span class="ident" id="2063376">validSave</span>&nbsp;<span class="op" id="2063386">=</span>&nbsp;<span class="builtintype" id="2063388">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2063394">s</span><span class="op" id="2063395">.</span><span class="ident" id="2063396">count</span>&nbsp;<span class="op" id="2063402">=</span>&nbsp;<span class="num" id="2063404">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2063407">return</span><br>
<span class="lineno"></span><span class="op" id="2063414">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span><span class="comment" id="2063417">//&nbsp;free&nbsp;saves&nbsp;used&nbsp;ss&nbsp;structs&nbsp;in&nbsp;ssFree;&nbsp;avoid&nbsp;an&nbsp;allocation&nbsp;per&nbsp;invocation.</span><br>
<span class="lineno"></span><span class="keyword" id="2063494">func</span>&nbsp;<span class="op" id="2063499">(</span><span class="ident" id="2063500">s</span>&nbsp;<span class="op" id="2063502">*</span><span class="ident" id="2063503">ss</span><span class="op" id="2063505">)</span>&nbsp;<span class="ident" id="2063507">free</span><span class="op" id="2063511">(</span><span class="ident" id="2063512">old</span>&nbsp;<span class="ident" id="2063516">ssave</span><span class="op" id="2063521">)</span>&nbsp;<span class="op" id="2063523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2063526">//&nbsp;If&nbsp;it&nbsp;was&nbsp;used&nbsp;recursively,&nbsp;just&nbsp;restore&nbsp;the&nbsp;old&nbsp;state.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2063586">if</span>&nbsp;<span class="ident" id="2063589">old</span><span class="op" id="2063592">.</span><span class="ident" id="2063593">validSave</span>&nbsp;<span class="op" id="2063603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2063607">s</span><span class="op" id="2063608">.</span><span class="ident" id="2063609">ssave</span>&nbsp;<span class="op" id="2063615">=</span>&nbsp;<span class="ident" id="2063617">old</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2063623">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2063631">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2063634">//&nbsp;Don&#39;t&nbsp;hold&nbsp;on&nbsp;to&nbsp;ss&nbsp;structs&nbsp;with&nbsp;large&nbsp;buffers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2063686">if</span>&nbsp;<span class="builtinfunc" id="2063689">cap</span><span class="op" id="2063692">(</span><span class="ident" id="2063693">s</span><span class="op" id="2063694">.</span><span class="ident" id="2063695">buf</span><span class="op" id="2063698">)</span>&nbsp;<span class="op" id="2063700">&gt;</span>&nbsp;<span class="num" id="2063702">1024</span>&nbsp;<span class="op" id="2063707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2063711">return</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2063719">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2063722">s</span><span class="op" id="2063723">.</span><span class="ident" id="2063724">buf</span>&nbsp;<span class="op" id="2063728">=</span>&nbsp;<span class="ident" id="2063730">s</span><span class="op" id="2063731">.</span><span class="ident" id="2063732">buf</span><span class="op" id="2063735">[</span><span class="op" id="2063736">:</span><span class="num" id="2063737">0</span><span class="op" id="2063738">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2063741">s</span><span class="op" id="2063742">.</span><span class="ident" id="2063743">rr</span>&nbsp;<span class="op" id="2063746">=</span>&nbsp;<span class="ident" id="2063748">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2063753">ssFree</span><span class="op" id="2063759">.</span><span class="ident" id="2063760">Put</span><span class="op" id="2063763">(</span><span class="ident" id="2063764">s</span><span class="op" id="2063765">)</span><br>
<span class="lineno"></span><span class="op" id="2063767">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="comment" id="2063770">//&nbsp;skipSpace&nbsp;skips&nbsp;spaces&nbsp;and&nbsp;maybe&nbsp;newlines.</span><br>
<span class="lineno"></span><span class="keyword" id="2063816">func</span>&nbsp;<span class="op" id="2063821">(</span><span class="ident" id="2063822">s</span>&nbsp;<span class="op" id="2063824">*</span><span class="ident" id="2063825">ss</span><span class="op" id="2063827">)</span>&nbsp;<span class="ident" id="2063829">skipSpace</span><span class="op" id="2063838">(</span><span class="ident" id="2063839">stopAtNewline</span>&nbsp;<span class="builtintype" id="2063853">bool</span><span class="op" id="2063857">)</span>&nbsp;<span class="op" id="2063859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2063862">for</span>&nbsp;<span class="op" id="2063866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2063870">r</span>&nbsp;<span class="op" id="2063872">:=</span>&nbsp;<span class="ident" id="2063875">s</span><span class="op" id="2063876">.</span><span class="ident" id="2063877">getRune</span><span class="op" id="2063884">(</span><span class="op" id="2063885">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2063889">if</span>&nbsp;<span class="ident" id="2063892">r</span>&nbsp;<span class="op" id="2063894">==</span>&nbsp;<span class="ident" id="2063897">eof</span>&nbsp;<span class="op" id="2063901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2063906">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2063915">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2063919">if</span>&nbsp;<span class="ident" id="2063922">r</span>&nbsp;<span class="op" id="2063924">==</span>&nbsp;<span class="string" id="2063927">&#39;\r&#39;</span>&nbsp;<span class="op" id="2063932">&amp;&amp;</span>&nbsp;<span class="ident" id="2063935">s</span><span class="op" id="2063936">.</span><span class="ident" id="2063937">peek</span><span class="op" id="2063941">(</span><span class="string" id="2063942">&#34;\n&#34;</span><span class="op" id="2063946">)</span>&nbsp;<span class="op" id="2063948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2063953">continue</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2063964">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2063968">if</span>&nbsp;<span class="ident" id="2063971">r</span>&nbsp;<span class="op" id="2063973">==</span>&nbsp;<span class="string" id="2063976">&#39;\n&#39;</span>&nbsp;<span class="op" id="2063981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2063986">if</span>&nbsp;<span class="ident" id="2063989">stopAtNewline</span>&nbsp;<span class="op" id="2064003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2064009">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2064018">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2064023">if</span>&nbsp;<span class="ident" id="2064026">s</span><span class="op" id="2064027">.</span><span class="ident" id="2064028">nlIsSpace</span>&nbsp;<span class="op" id="2064038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2064044">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2064056">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2064061">s</span><span class="op" id="2064062">.</span><span class="ident" id="2064063">errorString</span><span class="op" id="2064074">(</span><span class="string" id="2064075">&#34;unexpected&nbsp;newline&#34;</span><span class="op" id="2064095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2064100">return</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2064109">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2064113">if</span>&nbsp;<span class="op" id="2064116">!</span><span class="ident" id="2064117">isSpace</span><span class="op" id="2064124">(</span><span class="ident" id="2064125">r</span><span class="op" id="2064126">)</span>&nbsp;<span class="op" id="2064128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2064133">s</span><span class="op" id="2064134">.</span><span class="ident" id="2064135">UnreadRune</span><span class="op" id="2064145">(</span><span class="op" id="2064146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2064151">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2064159">}</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2064162">}</span><br>
<span class="lineno"></span><span class="op" id="2064164">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2064167">//&nbsp;token&nbsp;returns&nbsp;the&nbsp;next&nbsp;space-delimited&nbsp;string&nbsp;from&nbsp;the&nbsp;input.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="2064236">//&nbsp;skips&nbsp;white&nbsp;space.&nbsp;&nbsp;For&nbsp;Scanln,&nbsp;it&nbsp;stops&nbsp;at&nbsp;newlines.&nbsp;&nbsp;For&nbsp;Scan,</span><br>
<span class="lineno">465</span><span class="comment" id="2064304">//&nbsp;newlines&nbsp;are&nbsp;treated&nbsp;as&nbsp;spaces.</span><br>
<span class="lineno"></span><span class="keyword" id="2064339">func</span>&nbsp;<span class="op" id="2064344">(</span><span class="ident" id="2064345">s</span>&nbsp;<span class="op" id="2064347">*</span><span class="ident" id="2064348">ss</span><span class="op" id="2064350">)</span>&nbsp;<span class="ident" id="2064352">token</span><span class="op" id="2064357">(</span><span class="ident" id="2064358">skipSpace</span>&nbsp;<span class="builtintype" id="2064368">bool</span><span class="op" id="2064372">,</span>&nbsp;<span class="ident" id="2064374">f</span>&nbsp;<span class="keyword" id="2064376">func</span><span class="op" id="2064380">(</span><span class="builtintype" id="2064381">rune</span><span class="op" id="2064385">)</span>&nbsp;<span class="builtintype" id="2064387">bool</span><span class="op" id="2064391">)</span>&nbsp;<span class="op" id="2064393">[</span><span class="op" id="2064394">]</span><span class="builtintype" id="2064395">byte</span>&nbsp;<span class="op" id="2064400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2064403">if</span>&nbsp;<span class="ident" id="2064406">skipSpace</span>&nbsp;<span class="op" id="2064416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2064420">s</span><span class="op" id="2064421">.</span><span class="ident" id="2064422">skipSpace</span><span class="op" id="2064431">(</span><span class="builtintype" id="2064432">false</span><span class="op" id="2064437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2064440">}</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2064443">//&nbsp;read&nbsp;until&nbsp;white&nbsp;space&nbsp;or&nbsp;newline</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2064481">for</span>&nbsp;<span class="op" id="2064485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2064489">r</span>&nbsp;<span class="op" id="2064491">:=</span>&nbsp;<span class="ident" id="2064494">s</span><span class="op" id="2064495">.</span><span class="ident" id="2064496">getRune</span><span class="op" id="2064503">(</span><span class="op" id="2064504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2064508">if</span>&nbsp;<span class="ident" id="2064511">r</span>&nbsp;<span class="op" id="2064513">==</span>&nbsp;<span class="ident" id="2064516">eof</span>&nbsp;<span class="op" id="2064520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2064525">break</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2064533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2064537">if</span>&nbsp;<span class="op" id="2064540">!</span><span class="ident" id="2064541">f</span><span class="op" id="2064542">(</span><span class="ident" id="2064543">r</span><span class="op" id="2064544">)</span>&nbsp;<span class="op" id="2064546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2064551">s</span><span class="op" id="2064552">.</span><span class="ident" id="2064553">UnreadRune</span><span class="op" id="2064563">(</span><span class="op" id="2064564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2064569">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2064577">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2064581">s</span><span class="op" id="2064582">.</span><span class="ident" id="2064583">buf</span><span class="op" id="2064586">.</span><span class="ident" id="2064587">WriteRune</span><span class="op" id="2064596">(</span><span class="ident" id="2064597">r</span><span class="op" id="2064598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2064601">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2064604">return</span>&nbsp;<span class="ident" id="2064611">s</span><span class="op" id="2064612">.</span><span class="ident" id="2064613">buf</span><br>
<span class="lineno"></span><span class="op" id="2064617">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span><span class="keyword" id="2064620">var</span>&nbsp;<span class="ident" id="2064624">complexError</span>&nbsp;<span class="op" id="2064637">=</span>&nbsp;<span class="ident" id="2064639">errors</span><span class="op" id="2064645">.</span><span class="ident" id="2064646">New</span><span class="op" id="2064649">(</span><span class="string" id="2064650">&#34;syntax&nbsp;error&nbsp;scanning&nbsp;complex&nbsp;number&#34;</span><span class="op" id="2064688">)</span><br>
<span class="lineno"></span><span class="keyword" id="2064690">var</span>&nbsp;<span class="ident" id="2064694">boolError</span>&nbsp;<span class="op" id="2064704">=</span>&nbsp;<span class="ident" id="2064706">errors</span><span class="op" id="2064712">.</span><span class="ident" id="2064713">New</span><span class="op" id="2064716">(</span><span class="string" id="2064717">&#34;syntax&nbsp;error&nbsp;scanning&nbsp;boolean&#34;</span><span class="op" id="2064748">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2064751">func</span>&nbsp;<span class="ident" id="2064756">indexRune</span><span class="op" id="2064765">(</span><span class="ident" id="2064766">s</span>&nbsp;<span class="builtintype" id="2064768">string</span><span class="op" id="2064774">,</span>&nbsp;<span class="ident" id="2064776">r</span>&nbsp;<span class="builtintype" id="2064778">rune</span><span class="op" id="2064782">)</span>&nbsp;<span class="builtintype" id="2064784">int</span>&nbsp;<span class="op" id="2064788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2064791">for</span>&nbsp;<span class="ident" id="2064795">i</span><span class="op" id="2064796">,</span>&nbsp;<span class="ident" id="2064798">c</span>&nbsp;<span class="op" id="2064800">:=</span>&nbsp;<span class="keyword" id="2064803">range</span>&nbsp;<span class="ident" id="2064809">s</span>&nbsp;<span class="op" id="2064811">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2064815">if</span>&nbsp;<span class="ident" id="2064818">c</span>&nbsp;<span class="op" id="2064820">==</span>&nbsp;<span class="ident" id="2064823">r</span>&nbsp;<span class="op" id="2064825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2064830">return</span>&nbsp;<span class="ident" id="2064837">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2064841">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2064844">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2064847">return</span>&nbsp;<span class="op" id="2064854">-</span><span class="num" id="2064855">1</span><br>
<span class="lineno">495</span><span class="op" id="2064857">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2064860">//&nbsp;consume&nbsp;reads&nbsp;the&nbsp;next&nbsp;rune&nbsp;in&nbsp;the&nbsp;input&nbsp;and&nbsp;reports&nbsp;whether&nbsp;it&nbsp;is&nbsp;in&nbsp;the&nbsp;ok&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="2064948">//&nbsp;If&nbsp;accept&nbsp;is&nbsp;true,&nbsp;it&nbsp;puts&nbsp;the&nbsp;character&nbsp;into&nbsp;the&nbsp;input&nbsp;token.</span><br>
<span class="lineno"></span><span class="keyword" id="2065014">func</span>&nbsp;<span class="op" id="2065019">(</span><span class="ident" id="2065020">s</span>&nbsp;<span class="op" id="2065022">*</span><span class="ident" id="2065023">ss</span><span class="op" id="2065025">)</span>&nbsp;<span class="ident" id="2065027">consume</span><span class="op" id="2065034">(</span><span class="ident" id="2065035">ok</span>&nbsp;<span class="builtintype" id="2065038">string</span><span class="op" id="2065044">,</span>&nbsp;<span class="ident" id="2065046">accept</span>&nbsp;<span class="builtintype" id="2065053">bool</span><span class="op" id="2065057">)</span>&nbsp;<span class="builtintype" id="2065059">bool</span>&nbsp;<span class="op" id="2065064">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2065067">r</span>&nbsp;<span class="op" id="2065069">:=</span>&nbsp;<span class="ident" id="2065072">s</span><span class="op" id="2065073">.</span><span class="ident" id="2065074">getRune</span><span class="op" id="2065081">(</span><span class="op" id="2065082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2065085">if</span>&nbsp;<span class="ident" id="2065088">r</span>&nbsp;<span class="op" id="2065090">==</span>&nbsp;<span class="ident" id="2065093">eof</span>&nbsp;<span class="op" id="2065097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2065101">return</span>&nbsp;<span class="builtintype" id="2065108">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2065115">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2065118">if</span>&nbsp;<span class="ident" id="2065121">indexRune</span><span class="op" id="2065130">(</span><span class="ident" id="2065131">ok</span><span class="op" id="2065133">,</span>&nbsp;<span class="ident" id="2065135">r</span><span class="op" id="2065136">)</span>&nbsp;<span class="op" id="2065138">&gt;=</span>&nbsp;<span class="num" id="2065141">0</span>&nbsp;<span class="op" id="2065143">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2065147">if</span>&nbsp;<span class="ident" id="2065150">accept</span>&nbsp;<span class="op" id="2065157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2065162">s</span><span class="op" id="2065163">.</span><span class="ident" id="2065164">buf</span><span class="op" id="2065167">.</span><span class="ident" id="2065168">WriteRune</span><span class="op" id="2065177">(</span><span class="ident" id="2065178">r</span><span class="op" id="2065179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2065183">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2065187">return</span>&nbsp;<span class="builtintype" id="2065194">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2065200">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2065203">if</span>&nbsp;<span class="ident" id="2065206">r</span>&nbsp;<span class="op" id="2065208">!=</span>&nbsp;<span class="ident" id="2065211">eof</span>&nbsp;<span class="op" id="2065215">&amp;&amp;</span>&nbsp;<span class="ident" id="2065218">accept</span>&nbsp;<span class="op" id="2065225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2065229">s</span><span class="op" id="2065230">.</span><span class="ident" id="2065231">UnreadRune</span><span class="op" id="2065241">(</span><span class="op" id="2065242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2065245">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2065248">return</span>&nbsp;<span class="builtintype" id="2065255">false</span><br>
<span class="lineno"></span><span class="op" id="2065261">}</span><br>
<span class="lineno">515</span><br>
<span class="lineno"></span><span class="comment" id="2065264">//&nbsp;peek&nbsp;reports&nbsp;whether&nbsp;the&nbsp;next&nbsp;character&nbsp;is&nbsp;in&nbsp;the&nbsp;ok&nbsp;string,&nbsp;without&nbsp;consuming&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="2065350">func</span>&nbsp;<span class="op" id="2065355">(</span><span class="ident" id="2065356">s</span>&nbsp;<span class="op" id="2065358">*</span><span class="ident" id="2065359">ss</span><span class="op" id="2065361">)</span>&nbsp;<span class="ident" id="2065363">peek</span><span class="op" id="2065367">(</span><span class="ident" id="2065368">ok</span>&nbsp;<span class="builtintype" id="2065371">string</span><span class="op" id="2065377">)</span>&nbsp;<span class="builtintype" id="2065379">bool</span>&nbsp;<span class="op" id="2065384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2065387">r</span>&nbsp;<span class="op" id="2065389">:=</span>&nbsp;<span class="ident" id="2065392">s</span><span class="op" id="2065393">.</span><span class="ident" id="2065394">getRune</span><span class="op" id="2065401">(</span><span class="op" id="2065402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2065405">if</span>&nbsp;<span class="ident" id="2065408">r</span>&nbsp;<span class="op" id="2065410">!=</span>&nbsp;<span class="ident" id="2065413">eof</span>&nbsp;<span class="op" id="2065417">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2065421">s</span><span class="op" id="2065422">.</span><span class="ident" id="2065423">UnreadRune</span><span class="op" id="2065433">(</span><span class="op" id="2065434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2065437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2065440">return</span>&nbsp;<span class="ident" id="2065447">indexRune</span><span class="op" id="2065456">(</span><span class="ident" id="2065457">ok</span><span class="op" id="2065459">,</span>&nbsp;<span class="ident" id="2065461">r</span><span class="op" id="2065462">)</span>&nbsp;<span class="op" id="2065464">&gt;=</span>&nbsp;<span class="num" id="2065467">0</span><br>
<span class="lineno"></span><span class="op" id="2065469">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span><span class="keyword" id="2065472">func</span>&nbsp;<span class="op" id="2065477">(</span><span class="ident" id="2065478">s</span>&nbsp;<span class="op" id="2065480">*</span><span class="ident" id="2065481">ss</span><span class="op" id="2065483">)</span>&nbsp;<span class="ident" id="2065485">notEOF</span><span class="op" id="2065491">(</span><span class="op" id="2065492">)</span>&nbsp;<span class="op" id="2065494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2065497">//&nbsp;Guarantee&nbsp;there&nbsp;is&nbsp;data&nbsp;to&nbsp;be&nbsp;read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2065537">if</span>&nbsp;<span class="ident" id="2065540">r</span>&nbsp;<span class="op" id="2065542">:=</span>&nbsp;<span class="ident" id="2065545">s</span><span class="op" id="2065546">.</span><span class="ident" id="2065547">getRune</span><span class="op" id="2065554">(</span><span class="op" id="2065555">)</span><span class="op" id="2065556">;</span>&nbsp;<span class="ident" id="2065558">r</span>&nbsp;<span class="op" id="2065560">==</span>&nbsp;<span class="ident" id="2065563">eof</span>&nbsp;<span class="op" id="2065567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2065571">panic</span><span class="op" id="2065576">(</span><span class="ident" id="2065577">io</span><span class="op" id="2065579">.</span><span class="ident" id="2065580">EOF</span><span class="op" id="2065583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2065586">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2065589">s</span><span class="op" id="2065590">.</span><span class="ident" id="2065591">UnreadRune</span><span class="op" id="2065601">(</span><span class="op" id="2065602">)</span><br>
<span class="lineno"></span><span class="op" id="2065604">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2065607">//&nbsp;accept&nbsp;checks&nbsp;the&nbsp;next&nbsp;rune&nbsp;in&nbsp;the&nbsp;input.&nbsp;&nbsp;If&nbsp;it&#39;s&nbsp;a&nbsp;byte&nbsp;(sic)&nbsp;in&nbsp;the&nbsp;string,&nbsp;it&nbsp;puts&nbsp;it&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2065707">//&nbsp;buffer&nbsp;and&nbsp;returns&nbsp;true.&nbsp;Otherwise&nbsp;it&nbsp;return&nbsp;false.</span><br>
<span class="lineno">535</span><span class="keyword" id="2065762">func</span>&nbsp;<span class="op" id="2065767">(</span><span class="ident" id="2065768">s</span>&nbsp;<span class="op" id="2065770">*</span><span class="ident" id="2065771">ss</span><span class="op" id="2065773">)</span>&nbsp;<span class="ident" id="2065775">accept</span><span class="op" id="2065781">(</span><span class="ident" id="2065782">ok</span>&nbsp;<span class="builtintype" id="2065785">string</span><span class="op" id="2065791">)</span>&nbsp;<span class="builtintype" id="2065793">bool</span>&nbsp;<span class="op" id="2065798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2065801">return</span>&nbsp;<span class="ident" id="2065808">s</span><span class="op" id="2065809">.</span><span class="ident" id="2065810">consume</span><span class="op" id="2065817">(</span><span class="ident" id="2065818">ok</span><span class="op" id="2065820">,</span>&nbsp;<span class="builtintype" id="2065822">true</span><span class="op" id="2065826">)</span><br>
<span class="lineno"></span><span class="op" id="2065828">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2065831">//&nbsp;okVerb&nbsp;verifies&nbsp;that&nbsp;the&nbsp;verb&nbsp;is&nbsp;present&nbsp;in&nbsp;the&nbsp;list,&nbsp;setting&nbsp;s.err&nbsp;appropriately&nbsp;if&nbsp;not.</span><br>
<span class="lineno">540</span><span class="keyword" id="2065924">func</span>&nbsp;<span class="op" id="2065929">(</span><span class="ident" id="2065930">s</span>&nbsp;<span class="op" id="2065932">*</span><span class="ident" id="2065933">ss</span><span class="op" id="2065935">)</span>&nbsp;<span class="ident" id="2065937">okVerb</span><span class="op" id="2065943">(</span><span class="ident" id="2065944">verb</span>&nbsp;<span class="builtintype" id="2065949">rune</span><span class="op" id="2065953">,</span>&nbsp;<span class="ident" id="2065955">okVerbs</span><span class="op" id="2065962">,</span>&nbsp;<span class="ident" id="2065964">typ</span>&nbsp;<span class="builtintype" id="2065968">string</span><span class="op" id="2065974">)</span>&nbsp;<span class="builtintype" id="2065976">bool</span>&nbsp;<span class="op" id="2065981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2065984">for</span>&nbsp;<span class="ident" id="2065988">_</span><span class="op" id="2065989">,</span>&nbsp;<span class="ident" id="2065991">v</span>&nbsp;<span class="op" id="2065993">:=</span>&nbsp;<span class="keyword" id="2065996">range</span>&nbsp;<span class="ident" id="2066002">okVerbs</span>&nbsp;<span class="op" id="2066010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2066014">if</span>&nbsp;<span class="ident" id="2066017">v</span>&nbsp;<span class="op" id="2066019">==</span>&nbsp;<span class="ident" id="2066022">verb</span>&nbsp;<span class="op" id="2066027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2066032">return</span>&nbsp;<span class="builtintype" id="2066039">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2066046">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2066049">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2066052">s</span><span class="op" id="2066053">.</span><span class="ident" id="2066054">errorString</span><span class="op" id="2066065">(</span><span class="string" id="2066066">&#34;bad&nbsp;verb&nbsp;%&#34;</span>&nbsp;<span class="op" id="2066079">+</span>&nbsp;<span class="builtintype" id="2066081">string</span><span class="op" id="2066087">(</span><span class="ident" id="2066088">verb</span><span class="op" id="2066092">)</span>&nbsp;<span class="op" id="2066094">+</span>&nbsp;<span class="string" id="2066096">&#34;&nbsp;for&nbsp;&#34;</span>&nbsp;<span class="op" id="2066104">+</span>&nbsp;<span class="ident" id="2066106">typ</span><span class="op" id="2066109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2066112">return</span>&nbsp;<span class="builtintype" id="2066119">false</span><br>
<span class="lineno"></span><span class="op" id="2066125">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">550</span><span class="comment" id="2066128">//&nbsp;scanBool&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;boolean&nbsp;represented&nbsp;by&nbsp;the&nbsp;next&nbsp;token.</span><br>
<span class="lineno"></span><span class="keyword" id="2066204">func</span>&nbsp;<span class="op" id="2066209">(</span><span class="ident" id="2066210">s</span>&nbsp;<span class="op" id="2066212">*</span><span class="ident" id="2066213">ss</span><span class="op" id="2066215">)</span>&nbsp;<span class="ident" id="2066217">scanBool</span><span class="op" id="2066225">(</span><span class="ident" id="2066226">verb</span>&nbsp;<span class="builtintype" id="2066231">rune</span><span class="op" id="2066235">)</span>&nbsp;<span class="builtintype" id="2066237">bool</span>&nbsp;<span class="op" id="2066242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2066245">s</span><span class="op" id="2066246">.</span><span class="ident" id="2066247">skipSpace</span><span class="op" id="2066256">(</span><span class="builtintype" id="2066257">false</span><span class="op" id="2066262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2066265">s</span><span class="op" id="2066266">.</span><span class="ident" id="2066267">notEOF</span><span class="op" id="2066273">(</span><span class="op" id="2066274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2066277">if</span>&nbsp;<span class="op" id="2066280">!</span><span class="ident" id="2066281">s</span><span class="op" id="2066282">.</span><span class="ident" id="2066283">okVerb</span><span class="op" id="2066289">(</span><span class="ident" id="2066290">verb</span><span class="op" id="2066294">,</span>&nbsp;<span class="string" id="2066296">&#34;tv&#34;</span><span class="op" id="2066300">,</span>&nbsp;<span class="string" id="2066302">&#34;boolean&#34;</span><span class="op" id="2066311">)</span>&nbsp;<span class="op" id="2066313">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2066317">return</span>&nbsp;<span class="builtintype" id="2066324">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2066331">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2066334">//&nbsp;Syntax-checking&nbsp;a&nbsp;boolean&nbsp;is&nbsp;annoying.&nbsp;&nbsp;We&#39;re&nbsp;not&nbsp;fastidious&nbsp;about&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2066411">switch</span>&nbsp;<span class="ident" id="2066418">s</span><span class="op" id="2066419">.</span><span class="ident" id="2066420">getRune</span><span class="op" id="2066427">(</span><span class="op" id="2066428">)</span>&nbsp;<span class="op" id="2066430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2066433">case</span>&nbsp;<span class="string" id="2066438">&#39;0&#39;</span><span class="op" id="2066441">:</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2066445">return</span>&nbsp;<span class="builtintype" id="2066452">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2066459">case</span>&nbsp;<span class="string" id="2066464">&#39;1&#39;</span><span class="op" id="2066467">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2066471">return</span>&nbsp;<span class="builtintype" id="2066478">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2066484">case</span>&nbsp;<span class="string" id="2066489">&#39;t&#39;</span><span class="op" id="2066492">,</span>&nbsp;<span class="string" id="2066494">&#39;T&#39;</span><span class="op" id="2066497">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2066501">if</span>&nbsp;<span class="ident" id="2066504">s</span><span class="op" id="2066505">.</span><span class="ident" id="2066506">accept</span><span class="op" id="2066512">(</span><span class="string" id="2066513">&#34;rR&#34;</span><span class="op" id="2066517">)</span>&nbsp;<span class="op" id="2066519">&amp;&amp;</span>&nbsp;<span class="op" id="2066522">(</span><span class="op" id="2066523">!</span><span class="ident" id="2066524">s</span><span class="op" id="2066525">.</span><span class="ident" id="2066526">accept</span><span class="op" id="2066532">(</span><span class="string" id="2066533">&#34;uU&#34;</span><span class="op" id="2066537">)</span>&nbsp;<span class="op" id="2066539">||</span>&nbsp;<span class="op" id="2066542">!</span><span class="ident" id="2066543">s</span><span class="op" id="2066544">.</span><span class="ident" id="2066545">accept</span><span class="op" id="2066551">(</span><span class="string" id="2066552">&#34;eE&#34;</span><span class="op" id="2066556">)</span><span class="op" id="2066557">)</span>&nbsp;<span class="op" id="2066559">{</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2066564">s</span><span class="op" id="2066565">.</span><span class="builtintype" id="2066566">error</span><span class="op" id="2066571">(</span><span class="ident" id="2066572">boolError</span><span class="op" id="2066581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2066585">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2066589">return</span>&nbsp;<span class="builtintype" id="2066596">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2066602">case</span>&nbsp;<span class="string" id="2066607">&#39;f&#39;</span><span class="op" id="2066610">,</span>&nbsp;<span class="string" id="2066612">&#39;F&#39;</span><span class="op" id="2066615">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2066619">if</span>&nbsp;<span class="ident" id="2066622">s</span><span class="op" id="2066623">.</span><span class="ident" id="2066624">accept</span><span class="op" id="2066630">(</span><span class="string" id="2066631">&#34;aA&#34;</span><span class="op" id="2066635">)</span>&nbsp;<span class="op" id="2066637">&amp;&amp;</span>&nbsp;<span class="op" id="2066640">(</span><span class="op" id="2066641">!</span><span class="ident" id="2066642">s</span><span class="op" id="2066643">.</span><span class="ident" id="2066644">accept</span><span class="op" id="2066650">(</span><span class="string" id="2066651">&#34;lL&#34;</span><span class="op" id="2066655">)</span>&nbsp;<span class="op" id="2066657">||</span>&nbsp;<span class="op" id="2066660">!</span><span class="ident" id="2066661">s</span><span class="op" id="2066662">.</span><span class="ident" id="2066663">accept</span><span class="op" id="2066669">(</span><span class="string" id="2066670">&#34;sS&#34;</span><span class="op" id="2066674">)</span>&nbsp;<span class="op" id="2066676">||</span>&nbsp;<span class="op" id="2066679">!</span><span class="ident" id="2066680">s</span><span class="op" id="2066681">.</span><span class="ident" id="2066682">accept</span><span class="op" id="2066688">(</span><span class="string" id="2066689">&#34;eE&#34;</span><span class="op" id="2066693">)</span><span class="op" id="2066694">)</span>&nbsp;<span class="op" id="2066696">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2066701">s</span><span class="op" id="2066702">.</span><span class="builtintype" id="2066703">error</span><span class="op" id="2066708">(</span><span class="ident" id="2066709">boolError</span><span class="op" id="2066718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2066722">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2066726">return</span>&nbsp;<span class="builtintype" id="2066733">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2066740">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2066743">return</span>&nbsp;<span class="builtintype" id="2066750">false</span><br>
<span class="lineno">575</span><span class="op" id="2066756">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2066759">//&nbsp;Numerical&nbsp;elements</span><br>
<span class="lineno"></span><span class="keyword" id="2066781">const</span>&nbsp;<span class="op" id="2066787">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2066790">binaryDigits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2066808">=</span>&nbsp;<span class="string" id="2066810">&#34;01&#34;</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2066816">octalDigits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2066834">=</span>&nbsp;<span class="string" id="2066836">&#34;01234567&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2066848">decimalDigits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2066866">=</span>&nbsp;<span class="string" id="2066868">&#34;0123456789&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2066882">hexadecimalDigits</span>&nbsp;<span class="op" id="2066900">=</span>&nbsp;<span class="string" id="2066902">&#34;0123456789aAbBcCdDeEfF&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2066928">sign</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2066946">=</span>&nbsp;<span class="string" id="2066948">&#34;+-&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2066954">period</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2066972">=</span>&nbsp;<span class="string" id="2066974">&#34;.&#34;</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2066979">exponent</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2066997">=</span>&nbsp;<span class="string" id="2066999">&#34;eEp&#34;</span><br>
<span class="lineno"></span><span class="op" id="2067005">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2067008">//&nbsp;getBase&nbsp;returns&nbsp;the&nbsp;numeric&nbsp;base&nbsp;represented&nbsp;by&nbsp;the&nbsp;verb&nbsp;and&nbsp;its&nbsp;digit&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2067090">func</span>&nbsp;<span class="op" id="2067095">(</span><span class="ident" id="2067096">s</span>&nbsp;<span class="op" id="2067098">*</span><span class="ident" id="2067099">ss</span><span class="op" id="2067101">)</span>&nbsp;<span class="ident" id="2067103">getBase</span><span class="op" id="2067110">(</span><span class="ident" id="2067111">verb</span>&nbsp;<span class="builtintype" id="2067116">rune</span><span class="op" id="2067120">)</span>&nbsp;<span class="op" id="2067122">(</span><span class="ident" id="2067123">base</span>&nbsp;<span class="builtintype" id="2067128">int</span><span class="op" id="2067131">,</span>&nbsp;<span class="ident" id="2067133">digits</span>&nbsp;<span class="builtintype" id="2067140">string</span><span class="op" id="2067146">)</span>&nbsp;<span class="op" id="2067148">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2067151">s</span><span class="op" id="2067152">.</span><span class="ident" id="2067153">okVerb</span><span class="op" id="2067159">(</span><span class="ident" id="2067160">verb</span><span class="op" id="2067164">,</span>&nbsp;<span class="string" id="2067166">&#34;bdoUxXv&#34;</span><span class="op" id="2067175">,</span>&nbsp;<span class="string" id="2067177">&#34;integer&#34;</span><span class="op" id="2067186">)</span>&nbsp;<span class="comment" id="2067188">//&nbsp;sets&nbsp;s.err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2067203">base</span>&nbsp;<span class="op" id="2067208">=</span>&nbsp;<span class="num" id="2067210">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2067214">digits</span>&nbsp;<span class="op" id="2067221">=</span>&nbsp;<span class="ident" id="2067223">decimalDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2067238">switch</span>&nbsp;<span class="ident" id="2067245">verb</span>&nbsp;<span class="op" id="2067250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2067253">case</span>&nbsp;<span class="string" id="2067258">&#39;b&#39;</span><span class="op" id="2067261">:</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2067265">base</span>&nbsp;<span class="op" id="2067270">=</span>&nbsp;<span class="num" id="2067272">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2067276">digits</span>&nbsp;<span class="op" id="2067283">=</span>&nbsp;<span class="ident" id="2067285">binaryDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2067299">case</span>&nbsp;<span class="string" id="2067304">&#39;o&#39;</span><span class="op" id="2067307">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2067311">base</span>&nbsp;<span class="op" id="2067316">=</span>&nbsp;<span class="num" id="2067318">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2067322">digits</span>&nbsp;<span class="op" id="2067329">=</span>&nbsp;<span class="ident" id="2067331">octalDigits</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2067344">case</span>&nbsp;<span class="string" id="2067349">&#39;x&#39;</span><span class="op" id="2067352">,</span>&nbsp;<span class="string" id="2067354">&#39;X&#39;</span><span class="op" id="2067357">,</span>&nbsp;<span class="string" id="2067359">&#39;U&#39;</span><span class="op" id="2067362">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2067366">base</span>&nbsp;<span class="op" id="2067371">=</span>&nbsp;<span class="num" id="2067373">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2067378">digits</span>&nbsp;<span class="op" id="2067385">=</span>&nbsp;<span class="ident" id="2067387">hexadecimalDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2067406">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2067409">return</span><br>
<span class="lineno">605</span><span class="op" id="2067416">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2067419">//&nbsp;scanNumber&nbsp;returns&nbsp;the&nbsp;numerical&nbsp;string&nbsp;with&nbsp;specified&nbsp;digits&nbsp;starting&nbsp;here.</span><br>
<span class="lineno"></span><span class="keyword" id="2067499">func</span>&nbsp;<span class="op" id="2067504">(</span><span class="ident" id="2067505">s</span>&nbsp;<span class="op" id="2067507">*</span><span class="ident" id="2067508">ss</span><span class="op" id="2067510">)</span>&nbsp;<span class="ident" id="2067512">scanNumber</span><span class="op" id="2067522">(</span><span class="ident" id="2067523">digits</span>&nbsp;<span class="builtintype" id="2067530">string</span><span class="op" id="2067536">,</span>&nbsp;<span class="ident" id="2067538">haveDigits</span>&nbsp;<span class="builtintype" id="2067549">bool</span><span class="op" id="2067553">)</span>&nbsp;<span class="builtintype" id="2067555">string</span>&nbsp;<span class="op" id="2067562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2067565">if</span>&nbsp;<span class="op" id="2067568">!</span><span class="ident" id="2067569">haveDigits</span>&nbsp;<span class="op" id="2067580">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2067584">s</span><span class="op" id="2067585">.</span><span class="ident" id="2067586">notEOF</span><span class="op" id="2067592">(</span><span class="op" id="2067593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2067597">if</span>&nbsp;<span class="op" id="2067600">!</span><span class="ident" id="2067601">s</span><span class="op" id="2067602">.</span><span class="ident" id="2067603">accept</span><span class="op" id="2067609">(</span><span class="ident" id="2067610">digits</span><span class="op" id="2067616">)</span>&nbsp;<span class="op" id="2067618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2067623">s</span><span class="op" id="2067624">.</span><span class="ident" id="2067625">errorString</span><span class="op" id="2067636">(</span><span class="string" id="2067637">&#34;expected&nbsp;integer&#34;</span><span class="op" id="2067655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2067659">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2067662">}</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2067665">for</span>&nbsp;<span class="ident" id="2067669">s</span><span class="op" id="2067670">.</span><span class="ident" id="2067671">accept</span><span class="op" id="2067677">(</span><span class="ident" id="2067678">digits</span><span class="op" id="2067684">)</span>&nbsp;<span class="op" id="2067686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2067689">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2067692">return</span>&nbsp;<span class="builtintype" id="2067699">string</span><span class="op" id="2067705">(</span><span class="ident" id="2067706">s</span><span class="op" id="2067707">.</span><span class="ident" id="2067708">buf</span><span class="op" id="2067711">)</span><br>
<span class="lineno"></span><span class="op" id="2067713">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">620</span><span class="comment" id="2067716">//&nbsp;scanRune&nbsp;returns&nbsp;the&nbsp;next&nbsp;rune&nbsp;value&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="keyword" id="2067770">func</span>&nbsp;<span class="op" id="2067775">(</span><span class="ident" id="2067776">s</span>&nbsp;<span class="op" id="2067778">*</span><span class="ident" id="2067779">ss</span><span class="op" id="2067781">)</span>&nbsp;<span class="ident" id="2067783">scanRune</span><span class="op" id="2067791">(</span><span class="ident" id="2067792">bitSize</span>&nbsp;<span class="builtintype" id="2067800">int</span><span class="op" id="2067803">)</span>&nbsp;<span class="ident" id="2067805">int64</span>&nbsp;<span class="op" id="2067811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2067814">s</span><span class="op" id="2067815">.</span><span class="ident" id="2067816">notEOF</span><span class="op" id="2067822">(</span><span class="op" id="2067823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2067826">r</span>&nbsp;<span class="op" id="2067828">:=</span>&nbsp;<span class="ident" id="2067831">int64</span><span class="op" id="2067836">(</span><span class="ident" id="2067837">s</span><span class="op" id="2067838">.</span><span class="ident" id="2067839">getRune</span><span class="op" id="2067846">(</span><span class="op" id="2067847">)</span><span class="op" id="2067848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2067851">n</span>&nbsp;<span class="op" id="2067853">:=</span>&nbsp;<span class="builtintype" id="2067856">uint</span><span class="op" id="2067860">(</span><span class="ident" id="2067861">bitSize</span><span class="op" id="2067868">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2067871">x</span>&nbsp;<span class="op" id="2067873">:=</span>&nbsp;<span class="op" id="2067876">(</span><span class="ident" id="2067877">r</span>&nbsp;<span class="op" id="2067879">&lt;&lt;</span>&nbsp;<span class="op" id="2067882">(</span><span class="num" id="2067883">64</span>&nbsp;<span class="op" id="2067886">-</span>&nbsp;<span class="ident" id="2067888">n</span><span class="op" id="2067889">)</span><span class="op" id="2067890">)</span>&nbsp;<span class="op" id="2067892">&gt;&gt;</span>&nbsp;<span class="op" id="2067895">(</span><span class="num" id="2067896">64</span>&nbsp;<span class="op" id="2067899">-</span>&nbsp;<span class="ident" id="2067901">n</span><span class="op" id="2067902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2067905">if</span>&nbsp;<span class="ident" id="2067908">x</span>&nbsp;<span class="op" id="2067910">!=</span>&nbsp;<span class="ident" id="2067913">r</span>&nbsp;<span class="op" id="2067915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2067919">s</span><span class="op" id="2067920">.</span><span class="ident" id="2067921">errorString</span><span class="op" id="2067932">(</span><span class="string" id="2067933">&#34;overflow&nbsp;on&nbsp;character&nbsp;value&nbsp;&#34;</span>&nbsp;<span class="op" id="2067964">+</span>&nbsp;<span class="builtintype" id="2067966">string</span><span class="op" id="2067972">(</span><span class="ident" id="2067973">r</span><span class="op" id="2067974">)</span><span class="op" id="2067975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2067978">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2067981">return</span>&nbsp;<span class="ident" id="2067988">r</span><br>
<span class="lineno">630</span><span class="op" id="2067990">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2067993">//&nbsp;scanBasePrefix&nbsp;reports&nbsp;whether&nbsp;the&nbsp;integer&nbsp;begins&nbsp;with&nbsp;a&nbsp;0&nbsp;or&nbsp;0x,</span><br>
<span class="lineno"></span><span class="comment" id="2068062">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;base,&nbsp;digit&nbsp;string,&nbsp;and&nbsp;whether&nbsp;a&nbsp;zero&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span><span class="comment" id="2068131">//&nbsp;It&nbsp;is&nbsp;called&nbsp;only&nbsp;if&nbsp;the&nbsp;verb&nbsp;is&nbsp;%v.</span><br>
<span class="lineno">635</span><span class="keyword" id="2068171">func</span>&nbsp;<span class="op" id="2068176">(</span><span class="ident" id="2068177">s</span>&nbsp;<span class="op" id="2068179">*</span><span class="ident" id="2068180">ss</span><span class="op" id="2068182">)</span>&nbsp;<span class="ident" id="2068184">scanBasePrefix</span><span class="op" id="2068198">(</span><span class="op" id="2068199">)</span>&nbsp;<span class="op" id="2068201">(</span><span class="ident" id="2068202">base</span>&nbsp;<span class="builtintype" id="2068207">int</span><span class="op" id="2068210">,</span>&nbsp;<span class="ident" id="2068212">digits</span>&nbsp;<span class="builtintype" id="2068219">string</span><span class="op" id="2068225">,</span>&nbsp;<span class="ident" id="2068227">found</span>&nbsp;<span class="builtintype" id="2068233">bool</span><span class="op" id="2068237">)</span>&nbsp;<span class="op" id="2068239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2068242">if</span>&nbsp;<span class="op" id="2068245">!</span><span class="ident" id="2068246">s</span><span class="op" id="2068247">.</span><span class="ident" id="2068248">peek</span><span class="op" id="2068252">(</span><span class="string" id="2068253">&#34;0&#34;</span><span class="op" id="2068256">)</span>&nbsp;<span class="op" id="2068258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2068262">return</span>&nbsp;<span class="num" id="2068269">10</span><span class="op" id="2068271">,</span>&nbsp;<span class="ident" id="2068273">decimalDigits</span><span class="op" id="2068286">,</span>&nbsp;<span class="builtintype" id="2068288">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2068295">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2068298">s</span><span class="op" id="2068299">.</span><span class="ident" id="2068300">accept</span><span class="op" id="2068306">(</span><span class="string" id="2068307">&#34;0&#34;</span><span class="op" id="2068310">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2068313">found</span>&nbsp;<span class="op" id="2068319">=</span>&nbsp;<span class="builtintype" id="2068321">true</span>&nbsp;<span class="comment" id="2068326">//&nbsp;We&#39;ve&nbsp;put&nbsp;a&nbsp;digit&nbsp;into&nbsp;the&nbsp;token&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2068371">//&nbsp;Special&nbsp;cases&nbsp;for&nbsp;&#39;0&#39;&nbsp;&amp;&amp;&nbsp;&#39;0x&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2068405">base</span><span class="op" id="2068409">,</span>&nbsp;<span class="ident" id="2068411">digits</span>&nbsp;<span class="op" id="2068418">=</span>&nbsp;<span class="num" id="2068420">8</span><span class="op" id="2068421">,</span>&nbsp;<span class="ident" id="2068423">octalDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2068436">if</span>&nbsp;<span class="ident" id="2068439">s</span><span class="op" id="2068440">.</span><span class="ident" id="2068441">peek</span><span class="op" id="2068445">(</span><span class="string" id="2068446">&#34;xX&#34;</span><span class="op" id="2068450">)</span>&nbsp;<span class="op" id="2068452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2068456">s</span><span class="op" id="2068457">.</span><span class="ident" id="2068458">consume</span><span class="op" id="2068465">(</span><span class="string" id="2068466">&#34;xX&#34;</span><span class="op" id="2068470">,</span>&nbsp;<span class="builtintype" id="2068472">false</span><span class="op" id="2068477">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2068481">base</span><span class="op" id="2068485">,</span>&nbsp;<span class="ident" id="2068487">digits</span>&nbsp;<span class="op" id="2068494">=</span>&nbsp;<span class="num" id="2068496">16</span><span class="op" id="2068498">,</span>&nbsp;<span class="ident" id="2068500">hexadecimalDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2068519">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2068522">return</span><br>
<span class="lineno"></span><span class="op" id="2068529">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">650</span><span class="comment" id="2068532">//&nbsp;scanInt&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;integer&nbsp;represented&nbsp;by&nbsp;the&nbsp;next</span><br>
<span class="lineno"></span><span class="comment" id="2068600">//&nbsp;token,&nbsp;checking&nbsp;for&nbsp;overflow.&nbsp;&nbsp;Any&nbsp;error&nbsp;is&nbsp;stored&nbsp;in&nbsp;s.err.</span><br>
<span class="lineno"></span><span class="keyword" id="2068664">func</span>&nbsp;<span class="op" id="2068669">(</span><span class="ident" id="2068670">s</span>&nbsp;<span class="op" id="2068672">*</span><span class="ident" id="2068673">ss</span><span class="op" id="2068675">)</span>&nbsp;<span class="ident" id="2068677">scanInt</span><span class="op" id="2068684">(</span><span class="ident" id="2068685">verb</span>&nbsp;<span class="builtintype" id="2068690">rune</span><span class="op" id="2068694">,</span>&nbsp;<span class="ident" id="2068696">bitSize</span>&nbsp;<span class="builtintype" id="2068704">int</span><span class="op" id="2068707">)</span>&nbsp;<span class="ident" id="2068709">int64</span>&nbsp;<span class="op" id="2068715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2068718">if</span>&nbsp;<span class="ident" id="2068721">verb</span>&nbsp;<span class="op" id="2068726">==</span>&nbsp;<span class="string" id="2068729">&#39;c&#39;</span>&nbsp;<span class="op" id="2068733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2068737">return</span>&nbsp;<span class="ident" id="2068744">s</span><span class="op" id="2068745">.</span><span class="ident" id="2068746">scanRune</span><span class="op" id="2068754">(</span><span class="ident" id="2068755">bitSize</span><span class="op" id="2068762">)</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2068765">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2068768">s</span><span class="op" id="2068769">.</span><span class="ident" id="2068770">skipSpace</span><span class="op" id="2068779">(</span><span class="builtintype" id="2068780">false</span><span class="op" id="2068785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2068788">s</span><span class="op" id="2068789">.</span><span class="ident" id="2068790">notEOF</span><span class="op" id="2068796">(</span><span class="op" id="2068797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2068800">base</span><span class="op" id="2068804">,</span>&nbsp;<span class="ident" id="2068806">digits</span>&nbsp;<span class="op" id="2068813">:=</span>&nbsp;<span class="ident" id="2068816">s</span><span class="op" id="2068817">.</span><span class="ident" id="2068818">getBase</span><span class="op" id="2068825">(</span><span class="ident" id="2068826">verb</span><span class="op" id="2068830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2068833">haveDigits</span>&nbsp;<span class="op" id="2068844">:=</span>&nbsp;<span class="builtintype" id="2068847">false</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2068854">if</span>&nbsp;<span class="ident" id="2068857">verb</span>&nbsp;<span class="op" id="2068862">==</span>&nbsp;<span class="string" id="2068865">&#39;U&#39;</span>&nbsp;<span class="op" id="2068869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2068873">if</span>&nbsp;<span class="op" id="2068876">!</span><span class="ident" id="2068877">s</span><span class="op" id="2068878">.</span><span class="ident" id="2068879">consume</span><span class="op" id="2068886">(</span><span class="string" id="2068887">&#34;U&#34;</span><span class="op" id="2068890">,</span>&nbsp;<span class="builtintype" id="2068892">false</span><span class="op" id="2068897">)</span>&nbsp;<span class="op" id="2068899">||</span>&nbsp;<span class="op" id="2068902">!</span><span class="ident" id="2068903">s</span><span class="op" id="2068904">.</span><span class="ident" id="2068905">consume</span><span class="op" id="2068912">(</span><span class="string" id="2068913">&#34;+&#34;</span><span class="op" id="2068916">,</span>&nbsp;<span class="builtintype" id="2068918">false</span><span class="op" id="2068923">)</span>&nbsp;<span class="op" id="2068925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2068930">s</span><span class="op" id="2068931">.</span><span class="ident" id="2068932">errorString</span><span class="op" id="2068943">(</span><span class="string" id="2068944">&#34;bad&nbsp;unicode&nbsp;format&nbsp;&#34;</span><span class="op" id="2068965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2068969">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2068972">}</span>&nbsp;<span class="keyword" id="2068974">else</span>&nbsp;<span class="op" id="2068979">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2068983">s</span><span class="op" id="2068984">.</span><span class="ident" id="2068985">accept</span><span class="op" id="2068991">(</span><span class="ident" id="2068992">sign</span><span class="op" id="2068996">)</span>&nbsp;<span class="comment" id="2068998">//&nbsp;If&nbsp;there&#39;s&nbsp;a&nbsp;sign,&nbsp;it&nbsp;will&nbsp;be&nbsp;left&nbsp;in&nbsp;the&nbsp;token&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2069059">if</span>&nbsp;<span class="ident" id="2069062">verb</span>&nbsp;<span class="op" id="2069067">==</span>&nbsp;<span class="string" id="2069070">&#39;v&#39;</span>&nbsp;<span class="op" id="2069074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2069079">base</span><span class="op" id="2069083">,</span>&nbsp;<span class="ident" id="2069085">digits</span><span class="op" id="2069091">,</span>&nbsp;<span class="ident" id="2069093">haveDigits</span>&nbsp;<span class="op" id="2069104">=</span>&nbsp;<span class="ident" id="2069106">s</span><span class="op" id="2069107">.</span><span class="ident" id="2069108">scanBasePrefix</span><span class="op" id="2069122">(</span><span class="op" id="2069123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2069127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2069130">}</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2069133">tok</span>&nbsp;<span class="op" id="2069137">:=</span>&nbsp;<span class="ident" id="2069140">s</span><span class="op" id="2069141">.</span><span class="ident" id="2069142">scanNumber</span><span class="op" id="2069152">(</span><span class="ident" id="2069153">digits</span><span class="op" id="2069159">,</span>&nbsp;<span class="ident" id="2069161">haveDigits</span><span class="op" id="2069171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2069174">i</span><span class="op" id="2069175">,</span>&nbsp;<span class="ident" id="2069177">err</span>&nbsp;<span class="op" id="2069181">:=</span>&nbsp;<span class="ident" id="2069184">strconv</span><span class="op" id="2069191">.</span><span class="ident" id="2069192">ParseInt</span><span class="op" id="2069200">(</span><span class="ident" id="2069201">tok</span><span class="op" id="2069204">,</span>&nbsp;<span class="ident" id="2069206">base</span><span class="op" id="2069210">,</span>&nbsp;<span class="num" id="2069212">64</span><span class="op" id="2069214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2069217">if</span>&nbsp;<span class="ident" id="2069220">err</span>&nbsp;<span class="op" id="2069224">!=</span>&nbsp;<span class="ident" id="2069227">nil</span>&nbsp;<span class="op" id="2069231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2069235">s</span><span class="op" id="2069236">.</span><span class="builtintype" id="2069237">error</span><span class="op" id="2069242">(</span><span class="ident" id="2069243">err</span><span class="op" id="2069246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2069249">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2069252">n</span>&nbsp;<span class="op" id="2069254">:=</span>&nbsp;<span class="builtintype" id="2069257">uint</span><span class="op" id="2069261">(</span><span class="ident" id="2069262">bitSize</span><span class="op" id="2069269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2069272">x</span>&nbsp;<span class="op" id="2069274">:=</span>&nbsp;<span class="op" id="2069277">(</span><span class="ident" id="2069278">i</span>&nbsp;<span class="op" id="2069280">&lt;&lt;</span>&nbsp;<span class="op" id="2069283">(</span><span class="num" id="2069284">64</span>&nbsp;<span class="op" id="2069287">-</span>&nbsp;<span class="ident" id="2069289">n</span><span class="op" id="2069290">)</span><span class="op" id="2069291">)</span>&nbsp;<span class="op" id="2069293">&gt;&gt;</span>&nbsp;<span class="op" id="2069296">(</span><span class="num" id="2069297">64</span>&nbsp;<span class="op" id="2069300">-</span>&nbsp;<span class="ident" id="2069302">n</span><span class="op" id="2069303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2069306">if</span>&nbsp;<span class="ident" id="2069309">x</span>&nbsp;<span class="op" id="2069311">!=</span>&nbsp;<span class="ident" id="2069314">i</span>&nbsp;<span class="op" id="2069316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2069320">s</span><span class="op" id="2069321">.</span><span class="ident" id="2069322">errorString</span><span class="op" id="2069333">(</span><span class="string" id="2069334">&#34;integer&nbsp;overflow&nbsp;on&nbsp;token&nbsp;&#34;</span>&nbsp;<span class="op" id="2069363">+</span>&nbsp;<span class="ident" id="2069365">tok</span><span class="op" id="2069368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2069371">}</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2069374">return</span>&nbsp;<span class="ident" id="2069381">i</span><br>
<span class="lineno"></span><span class="op" id="2069383">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2069386">//&nbsp;scanUint&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;unsigned&nbsp;integer&nbsp;represented</span><br>
<span class="lineno"></span><span class="comment" id="2069452">//&nbsp;by&nbsp;the&nbsp;next&nbsp;token,&nbsp;checking&nbsp;for&nbsp;overflow.&nbsp;&nbsp;Any&nbsp;error&nbsp;is&nbsp;stored&nbsp;in&nbsp;s.err.</span><br>
<span class="lineno">685</span><span class="keyword" id="2069528">func</span>&nbsp;<span class="op" id="2069533">(</span><span class="ident" id="2069534">s</span>&nbsp;<span class="op" id="2069536">*</span><span class="ident" id="2069537">ss</span><span class="op" id="2069539">)</span>&nbsp;<span class="ident" id="2069541">scanUint</span><span class="op" id="2069549">(</span><span class="ident" id="2069550">verb</span>&nbsp;<span class="builtintype" id="2069555">rune</span><span class="op" id="2069559">,</span>&nbsp;<span class="ident" id="2069561">bitSize</span>&nbsp;<span class="builtintype" id="2069569">int</span><span class="op" id="2069572">)</span>&nbsp;<span class="ident" id="2069574">uint64</span>&nbsp;<span class="op" id="2069581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2069584">if</span>&nbsp;<span class="ident" id="2069587">verb</span>&nbsp;<span class="op" id="2069592">==</span>&nbsp;<span class="string" id="2069595">&#39;c&#39;</span>&nbsp;<span class="op" id="2069599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2069603">return</span>&nbsp;<span class="ident" id="2069610">uint64</span><span class="op" id="2069616">(</span><span class="ident" id="2069617">s</span><span class="op" id="2069618">.</span><span class="ident" id="2069619">scanRune</span><span class="op" id="2069627">(</span><span class="ident" id="2069628">bitSize</span><span class="op" id="2069635">)</span><span class="op" id="2069636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2069639">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2069642">s</span><span class="op" id="2069643">.</span><span class="ident" id="2069644">skipSpace</span><span class="op" id="2069653">(</span><span class="builtintype" id="2069654">false</span><span class="op" id="2069659">)</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2069662">s</span><span class="op" id="2069663">.</span><span class="ident" id="2069664">notEOF</span><span class="op" id="2069670">(</span><span class="op" id="2069671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2069674">base</span><span class="op" id="2069678">,</span>&nbsp;<span class="ident" id="2069680">digits</span>&nbsp;<span class="op" id="2069687">:=</span>&nbsp;<span class="ident" id="2069690">s</span><span class="op" id="2069691">.</span><span class="ident" id="2069692">getBase</span><span class="op" id="2069699">(</span><span class="ident" id="2069700">verb</span><span class="op" id="2069704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2069707">haveDigits</span>&nbsp;<span class="op" id="2069718">:=</span>&nbsp;<span class="builtintype" id="2069721">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2069728">if</span>&nbsp;<span class="ident" id="2069731">verb</span>&nbsp;<span class="op" id="2069736">==</span>&nbsp;<span class="string" id="2069739">&#39;U&#39;</span>&nbsp;<span class="op" id="2069743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2069747">if</span>&nbsp;<span class="op" id="2069750">!</span><span class="ident" id="2069751">s</span><span class="op" id="2069752">.</span><span class="ident" id="2069753">consume</span><span class="op" id="2069760">(</span><span class="string" id="2069761">&#34;U&#34;</span><span class="op" id="2069764">,</span>&nbsp;<span class="builtintype" id="2069766">false</span><span class="op" id="2069771">)</span>&nbsp;<span class="op" id="2069773">||</span>&nbsp;<span class="op" id="2069776">!</span><span class="ident" id="2069777">s</span><span class="op" id="2069778">.</span><span class="ident" id="2069779">consume</span><span class="op" id="2069786">(</span><span class="string" id="2069787">&#34;+&#34;</span><span class="op" id="2069790">,</span>&nbsp;<span class="builtintype" id="2069792">false</span><span class="op" id="2069797">)</span>&nbsp;<span class="op" id="2069799">{</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2069804">s</span><span class="op" id="2069805">.</span><span class="ident" id="2069806">errorString</span><span class="op" id="2069817">(</span><span class="string" id="2069818">&#34;bad&nbsp;unicode&nbsp;format&nbsp;&#34;</span><span class="op" id="2069839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2069843">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2069846">}</span>&nbsp;<span class="keyword" id="2069848">else</span>&nbsp;<span class="keyword" id="2069853">if</span>&nbsp;<span class="ident" id="2069856">verb</span>&nbsp;<span class="op" id="2069861">==</span>&nbsp;<span class="string" id="2069864">&#39;v&#39;</span>&nbsp;<span class="op" id="2069868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2069872">base</span><span class="op" id="2069876">,</span>&nbsp;<span class="ident" id="2069878">digits</span><span class="op" id="2069884">,</span>&nbsp;<span class="ident" id="2069886">haveDigits</span>&nbsp;<span class="op" id="2069897">=</span>&nbsp;<span class="ident" id="2069899">s</span><span class="op" id="2069900">.</span><span class="ident" id="2069901">scanBasePrefix</span><span class="op" id="2069915">(</span><span class="op" id="2069916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2069919">}</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2069922">tok</span>&nbsp;<span class="op" id="2069926">:=</span>&nbsp;<span class="ident" id="2069929">s</span><span class="op" id="2069930">.</span><span class="ident" id="2069931">scanNumber</span><span class="op" id="2069941">(</span><span class="ident" id="2069942">digits</span><span class="op" id="2069948">,</span>&nbsp;<span class="ident" id="2069950">haveDigits</span><span class="op" id="2069960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2069963">i</span><span class="op" id="2069964">,</span>&nbsp;<span class="ident" id="2069966">err</span>&nbsp;<span class="op" id="2069970">:=</span>&nbsp;<span class="ident" id="2069973">strconv</span><span class="op" id="2069980">.</span><span class="ident" id="2069981">ParseUint</span><span class="op" id="2069990">(</span><span class="ident" id="2069991">tok</span><span class="op" id="2069994">,</span>&nbsp;<span class="ident" id="2069996">base</span><span class="op" id="2070000">,</span>&nbsp;<span class="num" id="2070002">64</span><span class="op" id="2070004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2070007">if</span>&nbsp;<span class="ident" id="2070010">err</span>&nbsp;<span class="op" id="2070014">!=</span>&nbsp;<span class="ident" id="2070017">nil</span>&nbsp;<span class="op" id="2070021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2070025">s</span><span class="op" id="2070026">.</span><span class="builtintype" id="2070027">error</span><span class="op" id="2070032">(</span><span class="ident" id="2070033">err</span><span class="op" id="2070036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2070039">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2070042">n</span>&nbsp;<span class="op" id="2070044">:=</span>&nbsp;<span class="builtintype" id="2070047">uint</span><span class="op" id="2070051">(</span><span class="ident" id="2070052">bitSize</span><span class="op" id="2070059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2070062">x</span>&nbsp;<span class="op" id="2070064">:=</span>&nbsp;<span class="op" id="2070067">(</span><span class="ident" id="2070068">i</span>&nbsp;<span class="op" id="2070070">&lt;&lt;</span>&nbsp;<span class="op" id="2070073">(</span><span class="num" id="2070074">64</span>&nbsp;<span class="op" id="2070077">-</span>&nbsp;<span class="ident" id="2070079">n</span><span class="op" id="2070080">)</span><span class="op" id="2070081">)</span>&nbsp;<span class="op" id="2070083">&gt;&gt;</span>&nbsp;<span class="op" id="2070086">(</span><span class="num" id="2070087">64</span>&nbsp;<span class="op" id="2070090">-</span>&nbsp;<span class="ident" id="2070092">n</span><span class="op" id="2070093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2070096">if</span>&nbsp;<span class="ident" id="2070099">x</span>&nbsp;<span class="op" id="2070101">!=</span>&nbsp;<span class="ident" id="2070104">i</span>&nbsp;<span class="op" id="2070106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2070110">s</span><span class="op" id="2070111">.</span><span class="ident" id="2070112">errorString</span><span class="op" id="2070123">(</span><span class="string" id="2070124">&#34;unsigned&nbsp;integer&nbsp;overflow&nbsp;on&nbsp;token&nbsp;&#34;</span>&nbsp;<span class="op" id="2070162">+</span>&nbsp;<span class="ident" id="2070164">tok</span><span class="op" id="2070167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2070170">}</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2070173">return</span>&nbsp;<span class="ident" id="2070180">i</span><br>
<span class="lineno"></span><span class="op" id="2070182">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2070185">//&nbsp;floatToken&nbsp;returns&nbsp;the&nbsp;floating-point&nbsp;number&nbsp;starting&nbsp;here,&nbsp;no&nbsp;longer&nbsp;than&nbsp;swid</span><br>
<span class="lineno"></span><span class="comment" id="2070268">//&nbsp;if&nbsp;the&nbsp;width&nbsp;is&nbsp;specified.&nbsp;It&#39;s&nbsp;not&nbsp;rigorous&nbsp;about&nbsp;syntax&nbsp;because&nbsp;it&nbsp;doesn&#39;t&nbsp;check&nbsp;that</span><br>
<span class="lineno">715</span><span class="comment" id="2070359">//&nbsp;we&nbsp;have&nbsp;at&nbsp;least&nbsp;some&nbsp;digits,&nbsp;but&nbsp;Atof&nbsp;will&nbsp;do&nbsp;that.</span><br>
<span class="lineno"></span><span class="keyword" id="2070415">func</span>&nbsp;<span class="op" id="2070420">(</span><span class="ident" id="2070421">s</span>&nbsp;<span class="op" id="2070423">*</span><span class="ident" id="2070424">ss</span><span class="op" id="2070426">)</span>&nbsp;<span class="ident" id="2070428">floatToken</span><span class="op" id="2070438">(</span><span class="op" id="2070439">)</span>&nbsp;<span class="builtintype" id="2070441">string</span>&nbsp;<span class="op" id="2070448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2070451">s</span><span class="op" id="2070452">.</span><span class="ident" id="2070453">buf</span>&nbsp;<span class="op" id="2070457">=</span>&nbsp;<span class="ident" id="2070459">s</span><span class="op" id="2070460">.</span><span class="ident" id="2070461">buf</span><span class="op" id="2070464">[</span><span class="op" id="2070465">:</span><span class="num" id="2070466">0</span><span class="op" id="2070467">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2070470">//&nbsp;NaN?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2070479">if</span>&nbsp;<span class="ident" id="2070482">s</span><span class="op" id="2070483">.</span><span class="ident" id="2070484">accept</span><span class="op" id="2070490">(</span><span class="string" id="2070491">&#34;nN&#34;</span><span class="op" id="2070495">)</span>&nbsp;<span class="op" id="2070497">&amp;&amp;</span>&nbsp;<span class="ident" id="2070500">s</span><span class="op" id="2070501">.</span><span class="ident" id="2070502">accept</span><span class="op" id="2070508">(</span><span class="string" id="2070509">&#34;aA&#34;</span><span class="op" id="2070513">)</span>&nbsp;<span class="op" id="2070515">&amp;&amp;</span>&nbsp;<span class="ident" id="2070518">s</span><span class="op" id="2070519">.</span><span class="ident" id="2070520">accept</span><span class="op" id="2070526">(</span><span class="string" id="2070527">&#34;nN&#34;</span><span class="op" id="2070531">)</span>&nbsp;<span class="op" id="2070533">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2070537">return</span>&nbsp;<span class="builtintype" id="2070544">string</span><span class="op" id="2070550">(</span><span class="ident" id="2070551">s</span><span class="op" id="2070552">.</span><span class="ident" id="2070553">buf</span><span class="op" id="2070556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2070559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2070562">//&nbsp;leading&nbsp;sign?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2070580">s</span><span class="op" id="2070581">.</span><span class="ident" id="2070582">accept</span><span class="op" id="2070588">(</span><span class="ident" id="2070589">sign</span><span class="op" id="2070593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2070596">//&nbsp;Inf?</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2070605">if</span>&nbsp;<span class="ident" id="2070608">s</span><span class="op" id="2070609">.</span><span class="ident" id="2070610">accept</span><span class="op" id="2070616">(</span><span class="string" id="2070617">&#34;iI&#34;</span><span class="op" id="2070621">)</span>&nbsp;<span class="op" id="2070623">&amp;&amp;</span>&nbsp;<span class="ident" id="2070626">s</span><span class="op" id="2070627">.</span><span class="ident" id="2070628">accept</span><span class="op" id="2070634">(</span><span class="string" id="2070635">&#34;nN&#34;</span><span class="op" id="2070639">)</span>&nbsp;<span class="op" id="2070641">&amp;&amp;</span>&nbsp;<span class="ident" id="2070644">s</span><span class="op" id="2070645">.</span><span class="ident" id="2070646">accept</span><span class="op" id="2070652">(</span><span class="string" id="2070653">&#34;fF&#34;</span><span class="op" id="2070657">)</span>&nbsp;<span class="op" id="2070659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2070663">return</span>&nbsp;<span class="builtintype" id="2070670">string</span><span class="op" id="2070676">(</span><span class="ident" id="2070677">s</span><span class="op" id="2070678">.</span><span class="ident" id="2070679">buf</span><span class="op" id="2070682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2070685">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2070688">//&nbsp;digits?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2070700">for</span>&nbsp;<span class="ident" id="2070704">s</span><span class="op" id="2070705">.</span><span class="ident" id="2070706">accept</span><span class="op" id="2070712">(</span><span class="ident" id="2070713">decimalDigits</span><span class="op" id="2070726">)</span>&nbsp;<span class="op" id="2070728">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2070731">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2070734">//&nbsp;decimal&nbsp;point?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2070753">if</span>&nbsp;<span class="ident" id="2070756">s</span><span class="op" id="2070757">.</span><span class="ident" id="2070758">accept</span><span class="op" id="2070764">(</span><span class="ident" id="2070765">period</span><span class="op" id="2070771">)</span>&nbsp;<span class="op" id="2070773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2070777">//&nbsp;fraction?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2070792">for</span>&nbsp;<span class="ident" id="2070796">s</span><span class="op" id="2070797">.</span><span class="ident" id="2070798">accept</span><span class="op" id="2070804">(</span><span class="ident" id="2070805">decimalDigits</span><span class="op" id="2070818">)</span>&nbsp;<span class="op" id="2070820">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2070824">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2070827">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2070830">//&nbsp;exponent?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2070844">if</span>&nbsp;<span class="ident" id="2070847">s</span><span class="op" id="2070848">.</span><span class="ident" id="2070849">accept</span><span class="op" id="2070855">(</span><span class="ident" id="2070856">exponent</span><span class="op" id="2070864">)</span>&nbsp;<span class="op" id="2070866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2070870">//&nbsp;leading&nbsp;sign?</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2070889">s</span><span class="op" id="2070890">.</span><span class="ident" id="2070891">accept</span><span class="op" id="2070897">(</span><span class="ident" id="2070898">sign</span><span class="op" id="2070902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2070906">//&nbsp;digits?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2070919">for</span>&nbsp;<span class="ident" id="2070923">s</span><span class="op" id="2070924">.</span><span class="ident" id="2070925">accept</span><span class="op" id="2070931">(</span><span class="ident" id="2070932">decimalDigits</span><span class="op" id="2070945">)</span>&nbsp;<span class="op" id="2070947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2070951">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2070954">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2070957">return</span>&nbsp;<span class="builtintype" id="2070964">string</span><span class="op" id="2070970">(</span><span class="ident" id="2070971">s</span><span class="op" id="2070972">.</span><span class="ident" id="2070973">buf</span><span class="op" id="2070976">)</span><br>
<span class="lineno"></span><span class="op" id="2070978">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2070981">//&nbsp;complexTokens&nbsp;returns&nbsp;the&nbsp;real&nbsp;and&nbsp;imaginary&nbsp;parts&nbsp;of&nbsp;the&nbsp;complex&nbsp;number&nbsp;starting&nbsp;here.</span><br>
<span class="lineno"></span><span class="comment" id="2071072">//&nbsp;The&nbsp;number&nbsp;might&nbsp;be&nbsp;parenthesized&nbsp;and&nbsp;has&nbsp;the&nbsp;format&nbsp;(N+Ni)&nbsp;where&nbsp;N&nbsp;is&nbsp;a&nbsp;floating-point</span><br>
<span class="lineno">750</span><span class="comment" id="2071163">//&nbsp;number&nbsp;and&nbsp;there&nbsp;are&nbsp;no&nbsp;spaces&nbsp;within.</span><br>
<span class="lineno"></span><span class="keyword" id="2071205">func</span>&nbsp;<span class="op" id="2071210">(</span><span class="ident" id="2071211">s</span>&nbsp;<span class="op" id="2071213">*</span><span class="ident" id="2071214">ss</span><span class="op" id="2071216">)</span>&nbsp;<span class="ident" id="2071218">complexTokens</span><span class="op" id="2071231">(</span><span class="op" id="2071232">)</span>&nbsp;<span class="op" id="2071234">(</span><span class="builtinfunc" id="2071235">real</span><span class="op" id="2071239">,</span>&nbsp;<span class="builtinfunc" id="2071241">imag</span>&nbsp;<span class="builtintype" id="2071246">string</span><span class="op" id="2071252">)</span>&nbsp;<span class="op" id="2071254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2071257">//&nbsp;TODO:&nbsp;accept&nbsp;N&nbsp;and&nbsp;Ni&nbsp;independently?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2071298">parens</span>&nbsp;<span class="op" id="2071305">:=</span>&nbsp;<span class="ident" id="2071308">s</span><span class="op" id="2071309">.</span><span class="ident" id="2071310">accept</span><span class="op" id="2071316">(</span><span class="string" id="2071317">&#34;(&#34;</span><span class="op" id="2071320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2071323">real</span>&nbsp;<span class="op" id="2071328">=</span>&nbsp;<span class="ident" id="2071330">s</span><span class="op" id="2071331">.</span><span class="ident" id="2071332">floatToken</span><span class="op" id="2071342">(</span><span class="op" id="2071343">)</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2071346">s</span><span class="op" id="2071347">.</span><span class="ident" id="2071348">buf</span>&nbsp;<span class="op" id="2071352">=</span>&nbsp;<span class="ident" id="2071354">s</span><span class="op" id="2071355">.</span><span class="ident" id="2071356">buf</span><span class="op" id="2071359">[</span><span class="op" id="2071360">:</span><span class="num" id="2071361">0</span><span class="op" id="2071362">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2071365">//&nbsp;Must&nbsp;now&nbsp;have&nbsp;a&nbsp;sign.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2071391">if</span>&nbsp;<span class="op" id="2071394">!</span><span class="ident" id="2071395">s</span><span class="op" id="2071396">.</span><span class="ident" id="2071397">accept</span><span class="op" id="2071403">(</span><span class="string" id="2071404">&#34;+-&#34;</span><span class="op" id="2071408">)</span>&nbsp;<span class="op" id="2071410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2071414">s</span><span class="op" id="2071415">.</span><span class="builtintype" id="2071416">error</span><span class="op" id="2071421">(</span><span class="ident" id="2071422">complexError</span><span class="op" id="2071434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2071437">}</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2071440">//&nbsp;Sign&nbsp;is&nbsp;now&nbsp;in&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2071466">imagSign</span>&nbsp;<span class="op" id="2071475">:=</span>&nbsp;<span class="builtintype" id="2071478">string</span><span class="op" id="2071484">(</span><span class="ident" id="2071485">s</span><span class="op" id="2071486">.</span><span class="ident" id="2071487">buf</span><span class="op" id="2071490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2071493">imag</span>&nbsp;<span class="op" id="2071498">=</span>&nbsp;<span class="ident" id="2071500">s</span><span class="op" id="2071501">.</span><span class="ident" id="2071502">floatToken</span><span class="op" id="2071512">(</span><span class="op" id="2071513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2071516">if</span>&nbsp;<span class="op" id="2071519">!</span><span class="ident" id="2071520">s</span><span class="op" id="2071521">.</span><span class="ident" id="2071522">accept</span><span class="op" id="2071528">(</span><span class="string" id="2071529">&#34;i&#34;</span><span class="op" id="2071532">)</span>&nbsp;<span class="op" id="2071534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2071538">s</span><span class="op" id="2071539">.</span><span class="builtintype" id="2071540">error</span><span class="op" id="2071545">(</span><span class="ident" id="2071546">complexError</span><span class="op" id="2071558">)</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2071561">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2071564">if</span>&nbsp;<span class="ident" id="2071567">parens</span>&nbsp;<span class="op" id="2071574">&amp;&amp;</span>&nbsp;<span class="op" id="2071577">!</span><span class="ident" id="2071578">s</span><span class="op" id="2071579">.</span><span class="ident" id="2071580">accept</span><span class="op" id="2071586">(</span><span class="string" id="2071587">&#34;)&#34;</span><span class="op" id="2071590">)</span>&nbsp;<span class="op" id="2071592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2071596">s</span><span class="op" id="2071597">.</span><span class="builtintype" id="2071598">error</span><span class="op" id="2071603">(</span><span class="ident" id="2071604">complexError</span><span class="op" id="2071616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2071619">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2071622">return</span>&nbsp;<span class="builtinfunc" id="2071629">real</span><span class="op" id="2071633">,</span>&nbsp;<span class="ident" id="2071635">imagSign</span>&nbsp;<span class="op" id="2071644">+</span>&nbsp;<span class="builtinfunc" id="2071646">imag</span><br>
<span class="lineno">770</span><span class="op" id="2071651">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2071654">//&nbsp;convertFloat&nbsp;converts&nbsp;the&nbsp;string&nbsp;to&nbsp;a&nbsp;float64value.</span><br>
<span class="lineno"></span><span class="keyword" id="2071709">func</span>&nbsp;<span class="op" id="2071714">(</span><span class="ident" id="2071715">s</span>&nbsp;<span class="op" id="2071717">*</span><span class="ident" id="2071718">ss</span><span class="op" id="2071720">)</span>&nbsp;<span class="ident" id="2071722">convertFloat</span><span class="op" id="2071734">(</span><span class="ident" id="2071735">str</span>&nbsp;<span class="builtintype" id="2071739">string</span><span class="op" id="2071745">,</span>&nbsp;<span class="ident" id="2071747">n</span>&nbsp;<span class="builtintype" id="2071749">int</span><span class="op" id="2071752">)</span>&nbsp;<span class="builtintype" id="2071754">float64</span>&nbsp;<span class="op" id="2071762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2071765">if</span>&nbsp;<span class="ident" id="2071768">p</span>&nbsp;<span class="op" id="2071770">:=</span>&nbsp;<span class="ident" id="2071773">indexRune</span><span class="op" id="2071782">(</span><span class="ident" id="2071783">str</span><span class="op" id="2071786">,</span>&nbsp;<span class="string" id="2071788">&#39;p&#39;</span><span class="op" id="2071791">)</span><span class="op" id="2071792">;</span>&nbsp;<span class="ident" id="2071794">p</span>&nbsp;<span class="op" id="2071796">&gt;=</span>&nbsp;<span class="num" id="2071799">0</span>&nbsp;<span class="op" id="2071801">{</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2071805">//&nbsp;Atof&nbsp;doesn&#39;t&nbsp;handle&nbsp;power-of-2&nbsp;exponents,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2071852">//&nbsp;but&nbsp;they&#39;re&nbsp;easy&nbsp;to&nbsp;evaluate.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2071887">f</span><span class="op" id="2071888">,</span>&nbsp;<span class="ident" id="2071890">err</span>&nbsp;<span class="op" id="2071894">:=</span>&nbsp;<span class="ident" id="2071897">strconv</span><span class="op" id="2071904">.</span><span class="ident" id="2071905">ParseFloat</span><span class="op" id="2071915">(</span><span class="ident" id="2071916">str</span><span class="op" id="2071919">[</span><span class="op" id="2071920">:</span><span class="ident" id="2071921">p</span><span class="op" id="2071922">]</span><span class="op" id="2071923">,</span>&nbsp;<span class="ident" id="2071925">n</span><span class="op" id="2071926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2071930">if</span>&nbsp;<span class="ident" id="2071933">err</span>&nbsp;<span class="op" id="2071937">!=</span>&nbsp;<span class="ident" id="2071940">nil</span>&nbsp;<span class="op" id="2071944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2071949">//&nbsp;Put&nbsp;full&nbsp;string&nbsp;into&nbsp;error.</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2071983">if</span>&nbsp;<span class="ident" id="2071986">e</span><span class="op" id="2071987">,</span>&nbsp;<span class="ident" id="2071989">ok</span>&nbsp;<span class="op" id="2071992">:=</span>&nbsp;<span class="ident" id="2071995">err</span><span class="op" id="2071998">.</span><span class="op" id="2071999">(</span><span class="op" id="2072000">*</span><span class="ident" id="2072001">strconv</span><span class="op" id="2072008">.</span><span class="ident" id="2072009">NumError</span><span class="op" id="2072017">)</span><span class="op" id="2072018">;</span>&nbsp;<span class="ident" id="2072020">ok</span>&nbsp;<span class="op" id="2072023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2072029">e</span><span class="op" id="2072030">.</span><span class="ident" id="2072031">Num</span>&nbsp;<span class="op" id="2072035">=</span>&nbsp;<span class="ident" id="2072037">str</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2072044">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2072049">s</span><span class="op" id="2072050">.</span><span class="builtintype" id="2072051">error</span><span class="op" id="2072056">(</span><span class="ident" id="2072057">err</span><span class="op" id="2072060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2072064">}</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2072068">m</span><span class="op" id="2072069">,</span>&nbsp;<span class="ident" id="2072071">err</span>&nbsp;<span class="op" id="2072075">:=</span>&nbsp;<span class="ident" id="2072078">strconv</span><span class="op" id="2072085">.</span><span class="ident" id="2072086">Atoi</span><span class="op" id="2072090">(</span><span class="ident" id="2072091">str</span><span class="op" id="2072094">[</span><span class="ident" id="2072095">p</span><span class="op" id="2072096">+</span><span class="num" id="2072097">1</span><span class="op" id="2072098">:</span><span class="op" id="2072099">]</span><span class="op" id="2072100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2072104">if</span>&nbsp;<span class="ident" id="2072107">err</span>&nbsp;<span class="op" id="2072111">!=</span>&nbsp;<span class="ident" id="2072114">nil</span>&nbsp;<span class="op" id="2072118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2072123">//&nbsp;Put&nbsp;full&nbsp;string&nbsp;into&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2072157">if</span>&nbsp;<span class="ident" id="2072160">e</span><span class="op" id="2072161">,</span>&nbsp;<span class="ident" id="2072163">ok</span>&nbsp;<span class="op" id="2072166">:=</span>&nbsp;<span class="ident" id="2072169">err</span><span class="op" id="2072172">.</span><span class="op" id="2072173">(</span><span class="op" id="2072174">*</span><span class="ident" id="2072175">strconv</span><span class="op" id="2072182">.</span><span class="ident" id="2072183">NumError</span><span class="op" id="2072191">)</span><span class="op" id="2072192">;</span>&nbsp;<span class="ident" id="2072194">ok</span>&nbsp;<span class="op" id="2072197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2072203">e</span><span class="op" id="2072204">.</span><span class="ident" id="2072205">Num</span>&nbsp;<span class="op" id="2072209">=</span>&nbsp;<span class="ident" id="2072211">str</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2072218">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2072223">s</span><span class="op" id="2072224">.</span><span class="builtintype" id="2072225">error</span><span class="op" id="2072230">(</span><span class="ident" id="2072231">err</span><span class="op" id="2072234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2072238">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2072242">return</span>&nbsp;<span class="ident" id="2072249">math</span><span class="op" id="2072253">.</span><span class="ident" id="2072254">Ldexp</span><span class="op" id="2072259">(</span><span class="ident" id="2072260">f</span><span class="op" id="2072261">,</span>&nbsp;<span class="ident" id="2072263">m</span><span class="op" id="2072264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2072267">}</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2072270">f</span><span class="op" id="2072271">,</span>&nbsp;<span class="ident" id="2072273">err</span>&nbsp;<span class="op" id="2072277">:=</span>&nbsp;<span class="ident" id="2072280">strconv</span><span class="op" id="2072287">.</span><span class="ident" id="2072288">ParseFloat</span><span class="op" id="2072298">(</span><span class="ident" id="2072299">str</span><span class="op" id="2072302">,</span>&nbsp;<span class="ident" id="2072304">n</span><span class="op" id="2072305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2072308">if</span>&nbsp;<span class="ident" id="2072311">err</span>&nbsp;<span class="op" id="2072315">!=</span>&nbsp;<span class="ident" id="2072318">nil</span>&nbsp;<span class="op" id="2072322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2072326">s</span><span class="op" id="2072327">.</span><span class="builtintype" id="2072328">error</span><span class="op" id="2072333">(</span><span class="ident" id="2072334">err</span><span class="op" id="2072337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2072340">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2072343">return</span>&nbsp;<span class="ident" id="2072350">f</span><br>
<span class="lineno">800</span><span class="op" id="2072352">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2072355">//&nbsp;convertComplex&nbsp;converts&nbsp;the&nbsp;next&nbsp;token&nbsp;to&nbsp;a&nbsp;complex128&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="2072420">//&nbsp;The&nbsp;atof&nbsp;argument&nbsp;is&nbsp;a&nbsp;type-specific&nbsp;reader&nbsp;for&nbsp;the&nbsp;underlying&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2072492">//&nbsp;If&nbsp;we&#39;re&nbsp;reading&nbsp;complex64,&nbsp;atof&nbsp;will&nbsp;parse&nbsp;float32s&nbsp;and&nbsp;convert&nbsp;them</span><br>
<span class="lineno">805</span><span class="comment" id="2072565">//&nbsp;to&nbsp;float64&#39;s&nbsp;to&nbsp;avoid&nbsp;reproducing&nbsp;this&nbsp;code&nbsp;for&nbsp;each&nbsp;complex&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2072635">func</span>&nbsp;<span class="op" id="2072640">(</span><span class="ident" id="2072641">s</span>&nbsp;<span class="op" id="2072643">*</span><span class="ident" id="2072644">ss</span><span class="op" id="2072646">)</span>&nbsp;<span class="ident" id="2072648">scanComplex</span><span class="op" id="2072659">(</span><span class="ident" id="2072660">verb</span>&nbsp;<span class="builtintype" id="2072665">rune</span><span class="op" id="2072669">,</span>&nbsp;<span class="ident" id="2072671">n</span>&nbsp;<span class="builtintype" id="2072673">int</span><span class="op" id="2072676">)</span>&nbsp;<span class="builtintype" id="2072678">complex128</span>&nbsp;<span class="op" id="2072689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2072692">if</span>&nbsp;<span class="op" id="2072695">!</span><span class="ident" id="2072696">s</span><span class="op" id="2072697">.</span><span class="ident" id="2072698">okVerb</span><span class="op" id="2072704">(</span><span class="ident" id="2072705">verb</span><span class="op" id="2072709">,</span>&nbsp;<span class="ident" id="2072711">floatVerbs</span><span class="op" id="2072721">,</span>&nbsp;<span class="string" id="2072723">&#34;complex&#34;</span><span class="op" id="2072732">)</span>&nbsp;<span class="op" id="2072734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2072738">return</span>&nbsp;<span class="num" id="2072745">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2072748">}</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2072751">s</span><span class="op" id="2072752">.</span><span class="ident" id="2072753">skipSpace</span><span class="op" id="2072762">(</span><span class="builtintype" id="2072763">false</span><span class="op" id="2072768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2072771">s</span><span class="op" id="2072772">.</span><span class="ident" id="2072773">notEOF</span><span class="op" id="2072779">(</span><span class="op" id="2072780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2072783">sreal</span><span class="op" id="2072788">,</span>&nbsp;<span class="ident" id="2072790">simag</span>&nbsp;<span class="op" id="2072796">:=</span>&nbsp;<span class="ident" id="2072799">s</span><span class="op" id="2072800">.</span><span class="ident" id="2072801">complexTokens</span><span class="op" id="2072814">(</span><span class="op" id="2072815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2072818">real</span>&nbsp;<span class="op" id="2072823">:=</span>&nbsp;<span class="ident" id="2072826">s</span><span class="op" id="2072827">.</span><span class="ident" id="2072828">convertFloat</span><span class="op" id="2072840">(</span><span class="ident" id="2072841">sreal</span><span class="op" id="2072846">,</span>&nbsp;<span class="ident" id="2072848">n</span><span class="op" id="2072849">/</span><span class="num" id="2072850">2</span><span class="op" id="2072851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2072854">imag</span>&nbsp;<span class="op" id="2072859">:=</span>&nbsp;<span class="ident" id="2072862">s</span><span class="op" id="2072863">.</span><span class="ident" id="2072864">convertFloat</span><span class="op" id="2072876">(</span><span class="ident" id="2072877">simag</span><span class="op" id="2072882">,</span>&nbsp;<span class="ident" id="2072884">n</span><span class="op" id="2072885">/</span><span class="num" id="2072886">2</span><span class="op" id="2072887">)</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2072890">return</span>&nbsp;<span class="builtinfunc" id="2072897">complex</span><span class="op" id="2072904">(</span><span class="builtinfunc" id="2072905">real</span><span class="op" id="2072909">,</span>&nbsp;<span class="builtinfunc" id="2072911">imag</span><span class="op" id="2072915">)</span><br>
<span class="lineno"></span><span class="op" id="2072917">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2072920">//&nbsp;convertString&nbsp;returns&nbsp;the&nbsp;string&nbsp;represented&nbsp;by&nbsp;the&nbsp;next&nbsp;input&nbsp;characters.</span><br>
<span class="lineno"></span><span class="comment" id="2072998">//&nbsp;The&nbsp;format&nbsp;of&nbsp;the&nbsp;input&nbsp;is&nbsp;determined&nbsp;by&nbsp;the&nbsp;verb.</span><br>
<span class="lineno">820</span><span class="keyword" id="2073052">func</span>&nbsp;<span class="op" id="2073057">(</span><span class="ident" id="2073058">s</span>&nbsp;<span class="op" id="2073060">*</span><span class="ident" id="2073061">ss</span><span class="op" id="2073063">)</span>&nbsp;<span class="ident" id="2073065">convertString</span><span class="op" id="2073078">(</span><span class="ident" id="2073079">verb</span>&nbsp;<span class="builtintype" id="2073084">rune</span><span class="op" id="2073088">)</span>&nbsp;<span class="op" id="2073090">(</span><span class="ident" id="2073091">str</span>&nbsp;<span class="builtintype" id="2073095">string</span><span class="op" id="2073101">)</span>&nbsp;<span class="op" id="2073103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2073106">if</span>&nbsp;<span class="op" id="2073109">!</span><span class="ident" id="2073110">s</span><span class="op" id="2073111">.</span><span class="ident" id="2073112">okVerb</span><span class="op" id="2073118">(</span><span class="ident" id="2073119">verb</span><span class="op" id="2073123">,</span>&nbsp;<span class="string" id="2073125">&#34;svqx&#34;</span><span class="op" id="2073131">,</span>&nbsp;<span class="string" id="2073133">&#34;string&#34;</span><span class="op" id="2073141">)</span>&nbsp;<span class="op" id="2073143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2073147">return</span>&nbsp;<span class="string" id="2073154">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2073158">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2073161">s</span><span class="op" id="2073162">.</span><span class="ident" id="2073163">skipSpace</span><span class="op" id="2073172">(</span><span class="builtintype" id="2073173">false</span><span class="op" id="2073178">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2073181">s</span><span class="op" id="2073182">.</span><span class="ident" id="2073183">notEOF</span><span class="op" id="2073189">(</span><span class="op" id="2073190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2073193">switch</span>&nbsp;<span class="ident" id="2073200">verb</span>&nbsp;<span class="op" id="2073205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2073208">case</span>&nbsp;<span class="string" id="2073213">&#39;q&#39;</span><span class="op" id="2073216">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2073220">str</span>&nbsp;<span class="op" id="2073224">=</span>&nbsp;<span class="ident" id="2073226">s</span><span class="op" id="2073227">.</span><span class="ident" id="2073228">quotedString</span><span class="op" id="2073240">(</span><span class="op" id="2073241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2073244">case</span>&nbsp;<span class="string" id="2073249">&#39;x&#39;</span><span class="op" id="2073252">:</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2073256">str</span>&nbsp;<span class="op" id="2073260">=</span>&nbsp;<span class="ident" id="2073262">s</span><span class="op" id="2073263">.</span><span class="ident" id="2073264">hexString</span><span class="op" id="2073273">(</span><span class="op" id="2073274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2073277">default</span><span class="op" id="2073284">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2073288">str</span>&nbsp;<span class="op" id="2073292">=</span>&nbsp;<span class="builtintype" id="2073294">string</span><span class="op" id="2073300">(</span><span class="ident" id="2073301">s</span><span class="op" id="2073302">.</span><span class="ident" id="2073303">token</span><span class="op" id="2073308">(</span><span class="builtintype" id="2073309">true</span><span class="op" id="2073313">,</span>&nbsp;<span class="ident" id="2073315">notSpace</span><span class="op" id="2073323">)</span><span class="op" id="2073324">)</span>&nbsp;<span class="comment" id="2073326">//&nbsp;%s&nbsp;and&nbsp;%v&nbsp;just&nbsp;return&nbsp;the&nbsp;next&nbsp;word</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2073366">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2073369">return</span><br>
<span class="lineno">835</span><span class="op" id="2073376">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2073379">//&nbsp;quotedString&nbsp;returns&nbsp;the&nbsp;double-&nbsp;or&nbsp;back-quoted&nbsp;string&nbsp;represented&nbsp;by&nbsp;the&nbsp;next&nbsp;input&nbsp;characters.</span><br>
<span class="lineno"></span><span class="keyword" id="2073479">func</span>&nbsp;<span class="op" id="2073484">(</span><span class="ident" id="2073485">s</span>&nbsp;<span class="op" id="2073487">*</span><span class="ident" id="2073488">ss</span><span class="op" id="2073490">)</span>&nbsp;<span class="ident" id="2073492">quotedString</span><span class="op" id="2073504">(</span><span class="op" id="2073505">)</span>&nbsp;<span class="builtintype" id="2073507">string</span>&nbsp;<span class="op" id="2073514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2073517">s</span><span class="op" id="2073518">.</span><span class="ident" id="2073519">notEOF</span><span class="op" id="2073525">(</span><span class="op" id="2073526">)</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2073529">quote</span>&nbsp;<span class="op" id="2073535">:=</span>&nbsp;<span class="ident" id="2073538">s</span><span class="op" id="2073539">.</span><span class="ident" id="2073540">getRune</span><span class="op" id="2073547">(</span><span class="op" id="2073548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2073551">switch</span>&nbsp;<span class="ident" id="2073558">quote</span>&nbsp;<span class="op" id="2073564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2073567">case</span>&nbsp;<span class="string" id="2073572">&#39;`&#39;</span><span class="op" id="2073575">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2073579">//&nbsp;Back-quoted:&nbsp;Anything&nbsp;goes&nbsp;until&nbsp;EOF&nbsp;or&nbsp;back&nbsp;quote.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2073636">for</span>&nbsp;<span class="op" id="2073640">{</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2073645">r</span>&nbsp;<span class="op" id="2073647">:=</span>&nbsp;<span class="ident" id="2073650">s</span><span class="op" id="2073651">.</span><span class="ident" id="2073652">mustReadRune</span><span class="op" id="2073664">(</span><span class="op" id="2073665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2073670">if</span>&nbsp;<span class="ident" id="2073673">r</span>&nbsp;<span class="op" id="2073675">==</span>&nbsp;<span class="ident" id="2073678">quote</span>&nbsp;<span class="op" id="2073684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2073690">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2073699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2073704">s</span><span class="op" id="2073705">.</span><span class="ident" id="2073706">buf</span><span class="op" id="2073709">.</span><span class="ident" id="2073710">WriteRune</span><span class="op" id="2073719">(</span><span class="ident" id="2073720">r</span><span class="op" id="2073721">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2073725">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2073729">return</span>&nbsp;<span class="builtintype" id="2073736">string</span><span class="op" id="2073742">(</span><span class="ident" id="2073743">s</span><span class="op" id="2073744">.</span><span class="ident" id="2073745">buf</span><span class="op" id="2073748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2073751">case</span>&nbsp;<span class="string" id="2073756">&#39;&#34;&#39;</span><span class="op" id="2073759">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2073763">//&nbsp;Double-quoted:&nbsp;Include&nbsp;the&nbsp;quotes&nbsp;and&nbsp;let&nbsp;strconv.Unquote&nbsp;do&nbsp;the&nbsp;backslash&nbsp;escapes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2073852">s</span><span class="op" id="2073853">.</span><span class="ident" id="2073854">buf</span><span class="op" id="2073857">.</span><span class="ident" id="2073858">WriteRune</span><span class="op" id="2073867">(</span><span class="ident" id="2073868">quote</span><span class="op" id="2073873">)</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2073877">for</span>&nbsp;<span class="op" id="2073881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2073886">r</span>&nbsp;<span class="op" id="2073888">:=</span>&nbsp;<span class="ident" id="2073891">s</span><span class="op" id="2073892">.</span><span class="ident" id="2073893">mustReadRune</span><span class="op" id="2073905">(</span><span class="op" id="2073906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2073911">s</span><span class="op" id="2073912">.</span><span class="ident" id="2073913">buf</span><span class="op" id="2073916">.</span><span class="ident" id="2073917">WriteRune</span><span class="op" id="2073926">(</span><span class="ident" id="2073927">r</span><span class="op" id="2073928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2073933">if</span>&nbsp;<span class="ident" id="2073936">r</span>&nbsp;<span class="op" id="2073938">==</span>&nbsp;<span class="string" id="2073941">&#39;\\&#39;</span>&nbsp;<span class="op" id="2073946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2073952">//&nbsp;In&nbsp;a&nbsp;legal&nbsp;backslash&nbsp;escape,&nbsp;no&nbsp;matter&nbsp;how&nbsp;long,&nbsp;only&nbsp;the&nbsp;character</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2074027">//&nbsp;immediately&nbsp;after&nbsp;the&nbsp;escape&nbsp;can&nbsp;itself&nbsp;be&nbsp;a&nbsp;backslash&nbsp;or&nbsp;quote.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2074099">//&nbsp;Thus&nbsp;we&nbsp;only&nbsp;need&nbsp;to&nbsp;protect&nbsp;the&nbsp;first&nbsp;character&nbsp;after&nbsp;the&nbsp;backslash.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2074176">s</span><span class="op" id="2074177">.</span><span class="ident" id="2074178">buf</span><span class="op" id="2074181">.</span><span class="ident" id="2074182">WriteRune</span><span class="op" id="2074191">(</span><span class="ident" id="2074192">s</span><span class="op" id="2074193">.</span><span class="ident" id="2074194">mustReadRune</span><span class="op" id="2074206">(</span><span class="op" id="2074207">)</span><span class="op" id="2074208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2074213">}</span>&nbsp;<span class="keyword" id="2074215">else</span>&nbsp;<span class="keyword" id="2074220">if</span>&nbsp;<span class="ident" id="2074223">r</span>&nbsp;<span class="op" id="2074225">==</span>&nbsp;<span class="string" id="2074228">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2074232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2074238">break</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2074247">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2074251">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2074255">result</span><span class="op" id="2074261">,</span>&nbsp;<span class="ident" id="2074263">err</span>&nbsp;<span class="op" id="2074267">:=</span>&nbsp;<span class="ident" id="2074270">strconv</span><span class="op" id="2074277">.</span><span class="ident" id="2074278">Unquote</span><span class="op" id="2074285">(</span><span class="builtintype" id="2074286">string</span><span class="op" id="2074292">(</span><span class="ident" id="2074293">s</span><span class="op" id="2074294">.</span><span class="ident" id="2074295">buf</span><span class="op" id="2074298">)</span><span class="op" id="2074299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2074303">if</span>&nbsp;<span class="ident" id="2074306">err</span>&nbsp;<span class="op" id="2074310">!=</span>&nbsp;<span class="ident" id="2074313">nil</span>&nbsp;<span class="op" id="2074317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2074322">s</span><span class="op" id="2074323">.</span><span class="builtintype" id="2074324">error</span><span class="op" id="2074329">(</span><span class="ident" id="2074330">err</span><span class="op" id="2074333">)</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2074337">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2074341">return</span>&nbsp;<span class="ident" id="2074348">result</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2074356">default</span><span class="op" id="2074363">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2074367">s</span><span class="op" id="2074368">.</span><span class="ident" id="2074369">errorString</span><span class="op" id="2074380">(</span><span class="string" id="2074381">&#34;expected&nbsp;quoted&nbsp;string&#34;</span><span class="op" id="2074405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2074408">}</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2074411">return</span>&nbsp;<span class="string" id="2074418">&#34;&#34;</span><br>
<span class="lineno"></span><span class="op" id="2074421">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2074424">//&nbsp;hexDigit&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;hexadecimal&nbsp;digit</span><br>
<span class="lineno"></span><span class="keyword" id="2074479">func</span>&nbsp;<span class="op" id="2074484">(</span><span class="ident" id="2074485">s</span>&nbsp;<span class="op" id="2074487">*</span><span class="ident" id="2074488">ss</span><span class="op" id="2074490">)</span>&nbsp;<span class="ident" id="2074492">hexDigit</span><span class="op" id="2074500">(</span><span class="ident" id="2074501">d</span>&nbsp;<span class="builtintype" id="2074503">rune</span><span class="op" id="2074507">)</span>&nbsp;<span class="builtintype" id="2074509">int</span>&nbsp;<span class="op" id="2074513">{</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2074516">digit</span>&nbsp;<span class="op" id="2074522">:=</span>&nbsp;<span class="builtintype" id="2074525">int</span><span class="op" id="2074528">(</span><span class="ident" id="2074529">d</span><span class="op" id="2074530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2074533">switch</span>&nbsp;<span class="ident" id="2074540">digit</span>&nbsp;<span class="op" id="2074546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2074549">case</span>&nbsp;<span class="string" id="2074554">&#39;0&#39;</span><span class="op" id="2074557">,</span>&nbsp;<span class="string" id="2074559">&#39;1&#39;</span><span class="op" id="2074562">,</span>&nbsp;<span class="string" id="2074564">&#39;2&#39;</span><span class="op" id="2074567">,</span>&nbsp;<span class="string" id="2074569">&#39;3&#39;</span><span class="op" id="2074572">,</span>&nbsp;<span class="string" id="2074574">&#39;4&#39;</span><span class="op" id="2074577">,</span>&nbsp;<span class="string" id="2074579">&#39;5&#39;</span><span class="op" id="2074582">,</span>&nbsp;<span class="string" id="2074584">&#39;6&#39;</span><span class="op" id="2074587">,</span>&nbsp;<span class="string" id="2074589">&#39;7&#39;</span><span class="op" id="2074592">,</span>&nbsp;<span class="string" id="2074594">&#39;8&#39;</span><span class="op" id="2074597">,</span>&nbsp;<span class="string" id="2074599">&#39;9&#39;</span><span class="op" id="2074602">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2074606">return</span>&nbsp;<span class="ident" id="2074613">digit</span>&nbsp;<span class="op" id="2074619">-</span>&nbsp;<span class="string" id="2074621">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2074626">case</span>&nbsp;<span class="string" id="2074631">&#39;a&#39;</span><span class="op" id="2074634">,</span>&nbsp;<span class="string" id="2074636">&#39;b&#39;</span><span class="op" id="2074639">,</span>&nbsp;<span class="string" id="2074641">&#39;c&#39;</span><span class="op" id="2074644">,</span>&nbsp;<span class="string" id="2074646">&#39;d&#39;</span><span class="op" id="2074649">,</span>&nbsp;<span class="string" id="2074651">&#39;e&#39;</span><span class="op" id="2074654">,</span>&nbsp;<span class="string" id="2074656">&#39;f&#39;</span><span class="op" id="2074659">:</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2074663">return</span>&nbsp;<span class="num" id="2074670">10</span>&nbsp;<span class="op" id="2074673">+</span>&nbsp;<span class="ident" id="2074675">digit</span>&nbsp;<span class="op" id="2074681">-</span>&nbsp;<span class="string" id="2074683">&#39;a&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2074688">case</span>&nbsp;<span class="string" id="2074693">&#39;A&#39;</span><span class="op" id="2074696">,</span>&nbsp;<span class="string" id="2074698">&#39;B&#39;</span><span class="op" id="2074701">,</span>&nbsp;<span class="string" id="2074703">&#39;C&#39;</span><span class="op" id="2074706">,</span>&nbsp;<span class="string" id="2074708">&#39;D&#39;</span><span class="op" id="2074711">,</span>&nbsp;<span class="string" id="2074713">&#39;E&#39;</span><span class="op" id="2074716">,</span>&nbsp;<span class="string" id="2074718">&#39;F&#39;</span><span class="op" id="2074721">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2074725">return</span>&nbsp;<span class="num" id="2074732">10</span>&nbsp;<span class="op" id="2074735">+</span>&nbsp;<span class="ident" id="2074737">digit</span>&nbsp;<span class="op" id="2074743">-</span>&nbsp;<span class="string" id="2074745">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2074750">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2074753">s</span><span class="op" id="2074754">.</span><span class="ident" id="2074755">errorString</span><span class="op" id="2074766">(</span><span class="string" id="2074767">&#34;illegal&nbsp;hex&nbsp;digit&#34;</span><span class="op" id="2074786">)</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2074789">return</span>&nbsp;<span class="num" id="2074796">0</span><br>
<span class="lineno"></span><span class="op" id="2074798">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2074801">//&nbsp;hexByte&nbsp;returns&nbsp;the&nbsp;next&nbsp;hex-encoded&nbsp;(two-character)&nbsp;byte&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="2074878">//&nbsp;There&nbsp;must&nbsp;be&nbsp;either&nbsp;two&nbsp;hexadecimal&nbsp;digits&nbsp;or&nbsp;a&nbsp;space&nbsp;character&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno">895</span><span class="keyword" id="2074960">func</span>&nbsp;<span class="op" id="2074965">(</span><span class="ident" id="2074966">s</span>&nbsp;<span class="op" id="2074968">*</span><span class="ident" id="2074969">ss</span><span class="op" id="2074971">)</span>&nbsp;<span class="ident" id="2074973">hexByte</span><span class="op" id="2074980">(</span><span class="op" id="2074981">)</span>&nbsp;<span class="op" id="2074983">(</span><span class="ident" id="2074984">b</span>&nbsp;<span class="builtintype" id="2074986">byte</span><span class="op" id="2074990">,</span>&nbsp;<span class="ident" id="2074992">ok</span>&nbsp;<span class="builtintype" id="2074995">bool</span><span class="op" id="2074999">)</span>&nbsp;<span class="op" id="2075001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2075004">rune1</span>&nbsp;<span class="op" id="2075010">:=</span>&nbsp;<span class="ident" id="2075013">s</span><span class="op" id="2075014">.</span><span class="ident" id="2075015">getRune</span><span class="op" id="2075022">(</span><span class="op" id="2075023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2075026">if</span>&nbsp;<span class="ident" id="2075029">rune1</span>&nbsp;<span class="op" id="2075035">==</span>&nbsp;<span class="ident" id="2075038">eof</span>&nbsp;<span class="op" id="2075042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2075046">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2075054">}</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2075057">if</span>&nbsp;<span class="ident" id="2075060">isSpace</span><span class="op" id="2075067">(</span><span class="ident" id="2075068">rune1</span><span class="op" id="2075073">)</span>&nbsp;<span class="op" id="2075075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2075079">s</span><span class="op" id="2075080">.</span><span class="ident" id="2075081">UnreadRune</span><span class="op" id="2075091">(</span><span class="op" id="2075092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2075096">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2075104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2075107">rune2</span>&nbsp;<span class="op" id="2075113">:=</span>&nbsp;<span class="ident" id="2075116">s</span><span class="op" id="2075117">.</span><span class="ident" id="2075118">mustReadRune</span><span class="op" id="2075130">(</span><span class="op" id="2075131">)</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2075134">return</span>&nbsp;<span class="builtintype" id="2075141">byte</span><span class="op" id="2075145">(</span><span class="ident" id="2075146">s</span><span class="op" id="2075147">.</span><span class="ident" id="2075148">hexDigit</span><span class="op" id="2075156">(</span><span class="ident" id="2075157">rune1</span><span class="op" id="2075162">)</span><span class="op" id="2075163">&lt;&lt;</span><span class="num" id="2075165">4</span>&nbsp;<span class="op" id="2075167">|</span>&nbsp;<span class="ident" id="2075169">s</span><span class="op" id="2075170">.</span><span class="ident" id="2075171">hexDigit</span><span class="op" id="2075179">(</span><span class="ident" id="2075180">rune2</span><span class="op" id="2075185">)</span><span class="op" id="2075186">)</span><span class="op" id="2075187">,</span>&nbsp;<span class="builtintype" id="2075189">true</span><br>
<span class="lineno"></span><span class="op" id="2075194">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2075197">//&nbsp;hexString&nbsp;returns&nbsp;the&nbsp;space-delimited&nbsp;hexpair-encoded&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2075262">func</span>&nbsp;<span class="op" id="2075267">(</span><span class="ident" id="2075268">s</span>&nbsp;<span class="op" id="2075270">*</span><span class="ident" id="2075271">ss</span><span class="op" id="2075273">)</span>&nbsp;<span class="ident" id="2075275">hexString</span><span class="op" id="2075284">(</span><span class="op" id="2075285">)</span>&nbsp;<span class="builtintype" id="2075287">string</span>&nbsp;<span class="op" id="2075294">{</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2075297">s</span><span class="op" id="2075298">.</span><span class="ident" id="2075299">notEOF</span><span class="op" id="2075305">(</span><span class="op" id="2075306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2075309">for</span>&nbsp;<span class="op" id="2075313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2075317">b</span><span class="op" id="2075318">,</span>&nbsp;<span class="ident" id="2075320">ok</span>&nbsp;<span class="op" id="2075323">:=</span>&nbsp;<span class="ident" id="2075326">s</span><span class="op" id="2075327">.</span><span class="ident" id="2075328">hexByte</span><span class="op" id="2075335">(</span><span class="op" id="2075336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2075340">if</span>&nbsp;<span class="op" id="2075343">!</span><span class="ident" id="2075344">ok</span>&nbsp;<span class="op" id="2075347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2075352">break</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2075360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2075364">s</span><span class="op" id="2075365">.</span><span class="ident" id="2075366">buf</span><span class="op" id="2075369">.</span><span class="ident" id="2075370">WriteByte</span><span class="op" id="2075379">(</span><span class="ident" id="2075380">b</span><span class="op" id="2075381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2075384">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2075387">if</span>&nbsp;<span class="builtinfunc" id="2075390">len</span><span class="op" id="2075393">(</span><span class="ident" id="2075394">s</span><span class="op" id="2075395">.</span><span class="ident" id="2075396">buf</span><span class="op" id="2075399">)</span>&nbsp;<span class="op" id="2075401">==</span>&nbsp;<span class="num" id="2075404">0</span>&nbsp;<span class="op" id="2075406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2075410">s</span><span class="op" id="2075411">.</span><span class="ident" id="2075412">errorString</span><span class="op" id="2075423">(</span><span class="string" id="2075424">&#34;no&nbsp;hex&nbsp;data&nbsp;for&nbsp;%x&nbsp;string&#34;</span><span class="op" id="2075451">)</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2075455">return</span>&nbsp;<span class="string" id="2075462">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2075466">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2075469">return</span>&nbsp;<span class="builtintype" id="2075476">string</span><span class="op" id="2075482">(</span><span class="ident" id="2075483">s</span><span class="op" id="2075484">.</span><span class="ident" id="2075485">buf</span><span class="op" id="2075488">)</span><br>
<span class="lineno"></span><span class="op" id="2075490">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">925</span><span class="keyword" id="2075493">const</span>&nbsp;<span class="ident" id="2075499">floatVerbs</span>&nbsp;<span class="op" id="2075510">=</span>&nbsp;<span class="string" id="2075512">&#34;beEfFgGv&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2075524">const</span>&nbsp;<span class="ident" id="2075530">hugeWid</span>&nbsp;<span class="op" id="2075538">=</span>&nbsp;<span class="num" id="2075540">1</span>&nbsp;<span class="op" id="2075542">&lt;&lt;</span>&nbsp;<span class="num" id="2075545">30</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2075549">//&nbsp;scanOne&nbsp;scans&nbsp;a&nbsp;single&nbsp;value,&nbsp;deriving&nbsp;the&nbsp;scanner&nbsp;from&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;argument.</span><br>
<span class="lineno">930</span><span class="keyword" id="2075634">func</span>&nbsp;<span class="op" id="2075639">(</span><span class="ident" id="2075640">s</span>&nbsp;<span class="op" id="2075642">*</span><span class="ident" id="2075643">ss</span><span class="op" id="2075645">)</span>&nbsp;<span class="ident" id="2075647">scanOne</span><span class="op" id="2075654">(</span><span class="ident" id="2075655">verb</span>&nbsp;<span class="builtintype" id="2075660">rune</span><span class="op" id="2075664">,</span>&nbsp;<span class="ident" id="2075666">arg</span>&nbsp;<span class="keyword" id="2075670">interface</span><span class="op" id="2075679">{</span><span class="op" id="2075680">}</span><span class="op" id="2075681">)</span>&nbsp;<span class="op" id="2075683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2075686">s</span><span class="op" id="2075687">.</span><span class="ident" id="2075688">buf</span>&nbsp;<span class="op" id="2075692">=</span>&nbsp;<span class="ident" id="2075694">s</span><span class="op" id="2075695">.</span><span class="ident" id="2075696">buf</span><span class="op" id="2075699">[</span><span class="op" id="2075700">:</span><span class="num" id="2075701">0</span><span class="op" id="2075702">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2075705">var</span>&nbsp;<span class="ident" id="2075709">err</span>&nbsp;<span class="builtintype" id="2075713">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2075720">//&nbsp;If&nbsp;the&nbsp;parameter&nbsp;has&nbsp;its&nbsp;own&nbsp;Scan&nbsp;method,&nbsp;use&nbsp;that.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2075776">if</span>&nbsp;<span class="ident" id="2075779">v</span><span class="op" id="2075780">,</span>&nbsp;<span class="ident" id="2075782">ok</span>&nbsp;<span class="op" id="2075785">:=</span>&nbsp;<span class="ident" id="2075788">arg</span><span class="op" id="2075791">.</span><span class="op" id="2075792">(</span><span class="ident" id="2075793">Scanner</span><span class="op" id="2075800">)</span><span class="op" id="2075801">;</span>&nbsp;<span class="ident" id="2075803">ok</span>&nbsp;<span class="op" id="2075806">{</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2075810">err</span>&nbsp;<span class="op" id="2075814">=</span>&nbsp;<span class="ident" id="2075816">v</span><span class="op" id="2075817">.</span><span class="ident" id="2075818">Scan</span><span class="op" id="2075822">(</span><span class="ident" id="2075823">s</span><span class="op" id="2075824">,</span>&nbsp;<span class="ident" id="2075826">verb</span><span class="op" id="2075830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2075834">if</span>&nbsp;<span class="ident" id="2075837">err</span>&nbsp;<span class="op" id="2075841">!=</span>&nbsp;<span class="ident" id="2075844">nil</span>&nbsp;<span class="op" id="2075848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2075853">if</span>&nbsp;<span class="ident" id="2075856">err</span>&nbsp;<span class="op" id="2075860">==</span>&nbsp;<span class="ident" id="2075863">io</span><span class="op" id="2075865">.</span><span class="ident" id="2075866">EOF</span>&nbsp;<span class="op" id="2075870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2075876">err</span>&nbsp;<span class="op" id="2075880">=</span>&nbsp;<span class="ident" id="2075882">io</span><span class="op" id="2075884">.</span><span class="ident" id="2075885">ErrUnexpectedEOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2075905">}</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2075910">s</span><span class="op" id="2075911">.</span><span class="builtintype" id="2075912">error</span><span class="op" id="2075917">(</span><span class="ident" id="2075918">err</span><span class="op" id="2075921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2075925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2075929">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2075937">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2075941">switch</span>&nbsp;<span class="ident" id="2075948">v</span>&nbsp;<span class="op" id="2075950">:=</span>&nbsp;<span class="ident" id="2075953">arg</span><span class="op" id="2075956">.</span><span class="op" id="2075957">(</span><span class="keyword" id="2075958">type</span><span class="op" id="2075962">)</span>&nbsp;<span class="op" id="2075964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2075967">case</span>&nbsp;<span class="op" id="2075972">*</span><span class="builtintype" id="2075973">bool</span><span class="op" id="2075977">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2075981">*</span><span class="ident" id="2075982">v</span>&nbsp;<span class="op" id="2075984">=</span>&nbsp;<span class="ident" id="2075986">s</span><span class="op" id="2075987">.</span><span class="ident" id="2075988">scanBool</span><span class="op" id="2075996">(</span><span class="ident" id="2075997">verb</span><span class="op" id="2076001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2076004">case</span>&nbsp;<span class="op" id="2076009">*</span><span class="builtintype" id="2076010">complex64</span><span class="op" id="2076019">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2076023">*</span><span class="ident" id="2076024">v</span>&nbsp;<span class="op" id="2076026">=</span>&nbsp;<span class="builtintype" id="2076028">complex64</span><span class="op" id="2076037">(</span><span class="ident" id="2076038">s</span><span class="op" id="2076039">.</span><span class="ident" id="2076040">scanComplex</span><span class="op" id="2076051">(</span><span class="ident" id="2076052">verb</span><span class="op" id="2076056">,</span>&nbsp;<span class="num" id="2076058">64</span><span class="op" id="2076060">)</span><span class="op" id="2076061">)</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2076064">case</span>&nbsp;<span class="op" id="2076069">*</span><span class="builtintype" id="2076070">complex128</span><span class="op" id="2076080">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2076084">*</span><span class="ident" id="2076085">v</span>&nbsp;<span class="op" id="2076087">=</span>&nbsp;<span class="ident" id="2076089">s</span><span class="op" id="2076090">.</span><span class="ident" id="2076091">scanComplex</span><span class="op" id="2076102">(</span><span class="ident" id="2076103">verb</span><span class="op" id="2076107">,</span>&nbsp;<span class="num" id="2076109">128</span><span class="op" id="2076112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2076115">case</span>&nbsp;<span class="op" id="2076120">*</span><span class="builtintype" id="2076121">int</span><span class="op" id="2076124">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2076128">*</span><span class="ident" id="2076129">v</span>&nbsp;<span class="op" id="2076131">=</span>&nbsp;<span class="builtintype" id="2076133">int</span><span class="op" id="2076136">(</span><span class="ident" id="2076137">s</span><span class="op" id="2076138">.</span><span class="ident" id="2076139">scanInt</span><span class="op" id="2076146">(</span><span class="ident" id="2076147">verb</span><span class="op" id="2076151">,</span>&nbsp;<span class="ident" id="2076153">intBits</span><span class="op" id="2076160">)</span><span class="op" id="2076161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2076164">case</span>&nbsp;<span class="op" id="2076169">*</span><span class="builtintype" id="2076170">int8</span><span class="op" id="2076174">:</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2076178">*</span><span class="ident" id="2076179">v</span>&nbsp;<span class="op" id="2076181">=</span>&nbsp;<span class="builtintype" id="2076183">int8</span><span class="op" id="2076187">(</span><span class="ident" id="2076188">s</span><span class="op" id="2076189">.</span><span class="ident" id="2076190">scanInt</span><span class="op" id="2076197">(</span><span class="ident" id="2076198">verb</span><span class="op" id="2076202">,</span>&nbsp;<span class="num" id="2076204">8</span><span class="op" id="2076205">)</span><span class="op" id="2076206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2076209">case</span>&nbsp;<span class="op" id="2076214">*</span><span class="builtintype" id="2076215">int16</span><span class="op" id="2076220">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2076224">*</span><span class="ident" id="2076225">v</span>&nbsp;<span class="op" id="2076227">=</span>&nbsp;<span class="builtintype" id="2076229">int16</span><span class="op" id="2076234">(</span><span class="ident" id="2076235">s</span><span class="op" id="2076236">.</span><span class="ident" id="2076237">scanInt</span><span class="op" id="2076244">(</span><span class="ident" id="2076245">verb</span><span class="op" id="2076249">,</span>&nbsp;<span class="num" id="2076251">16</span><span class="op" id="2076253">)</span><span class="op" id="2076254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2076257">case</span>&nbsp;<span class="op" id="2076262">*</span><span class="builtintype" id="2076263">int32</span><span class="op" id="2076268">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2076272">*</span><span class="ident" id="2076273">v</span>&nbsp;<span class="op" id="2076275">=</span>&nbsp;<span class="builtintype" id="2076277">int32</span><span class="op" id="2076282">(</span><span class="ident" id="2076283">s</span><span class="op" id="2076284">.</span><span class="ident" id="2076285">scanInt</span><span class="op" id="2076292">(</span><span class="ident" id="2076293">verb</span><span class="op" id="2076297">,</span>&nbsp;<span class="num" id="2076299">32</span><span class="op" id="2076301">)</span><span class="op" id="2076302">)</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2076305">case</span>&nbsp;<span class="op" id="2076310">*</span><span class="ident" id="2076311">int64</span><span class="op" id="2076316">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2076320">*</span><span class="ident" id="2076321">v</span>&nbsp;<span class="op" id="2076323">=</span>&nbsp;<span class="ident" id="2076325">s</span><span class="op" id="2076326">.</span><span class="ident" id="2076327">scanInt</span><span class="op" id="2076334">(</span><span class="ident" id="2076335">verb</span><span class="op" id="2076339">,</span>&nbsp;<span class="num" id="2076341">64</span><span class="op" id="2076343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2076346">case</span>&nbsp;<span class="op" id="2076351">*</span><span class="builtintype" id="2076352">uint</span><span class="op" id="2076356">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2076360">*</span><span class="ident" id="2076361">v</span>&nbsp;<span class="op" id="2076363">=</span>&nbsp;<span class="builtintype" id="2076365">uint</span><span class="op" id="2076369">(</span><span class="ident" id="2076370">s</span><span class="op" id="2076371">.</span><span class="ident" id="2076372">scanUint</span><span class="op" id="2076380">(</span><span class="ident" id="2076381">verb</span><span class="op" id="2076385">,</span>&nbsp;<span class="ident" id="2076387">intBits</span><span class="op" id="2076394">)</span><span class="op" id="2076395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2076398">case</span>&nbsp;<span class="op" id="2076403">*</span><span class="builtintype" id="2076404">uint8</span><span class="op" id="2076409">:</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2076413">*</span><span class="ident" id="2076414">v</span>&nbsp;<span class="op" id="2076416">=</span>&nbsp;<span class="builtintype" id="2076418">uint8</span><span class="op" id="2076423">(</span><span class="ident" id="2076424">s</span><span class="op" id="2076425">.</span><span class="ident" id="2076426">scanUint</span><span class="op" id="2076434">(</span><span class="ident" id="2076435">verb</span><span class="op" id="2076439">,</span>&nbsp;<span class="num" id="2076441">8</span><span class="op" id="2076442">)</span><span class="op" id="2076443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2076446">case</span>&nbsp;<span class="op" id="2076451">*</span><span class="builtintype" id="2076452">uint16</span><span class="op" id="2076458">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2076462">*</span><span class="ident" id="2076463">v</span>&nbsp;<span class="op" id="2076465">=</span>&nbsp;<span class="builtintype" id="2076467">uint16</span><span class="op" id="2076473">(</span><span class="ident" id="2076474">s</span><span class="op" id="2076475">.</span><span class="ident" id="2076476">scanUint</span><span class="op" id="2076484">(</span><span class="ident" id="2076485">verb</span><span class="op" id="2076489">,</span>&nbsp;<span class="num" id="2076491">16</span><span class="op" id="2076493">)</span><span class="op" id="2076494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2076497">case</span>&nbsp;<span class="op" id="2076502">*</span><span class="builtintype" id="2076503">uint32</span><span class="op" id="2076509">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2076513">*</span><span class="ident" id="2076514">v</span>&nbsp;<span class="op" id="2076516">=</span>&nbsp;<span class="builtintype" id="2076518">uint32</span><span class="op" id="2076524">(</span><span class="ident" id="2076525">s</span><span class="op" id="2076526">.</span><span class="ident" id="2076527">scanUint</span><span class="op" id="2076535">(</span><span class="ident" id="2076536">verb</span><span class="op" id="2076540">,</span>&nbsp;<span class="num" id="2076542">32</span><span class="op" id="2076544">)</span><span class="op" id="2076545">)</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2076548">case</span>&nbsp;<span class="op" id="2076553">*</span><span class="ident" id="2076554">uint64</span><span class="op" id="2076560">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2076564">*</span><span class="ident" id="2076565">v</span>&nbsp;<span class="op" id="2076567">=</span>&nbsp;<span class="ident" id="2076569">s</span><span class="op" id="2076570">.</span><span class="ident" id="2076571">scanUint</span><span class="op" id="2076579">(</span><span class="ident" id="2076580">verb</span><span class="op" id="2076584">,</span>&nbsp;<span class="num" id="2076586">64</span><span class="op" id="2076588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2076591">case</span>&nbsp;<span class="op" id="2076596">*</span><span class="builtintype" id="2076597">uintptr</span><span class="op" id="2076604">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2076608">*</span><span class="ident" id="2076609">v</span>&nbsp;<span class="op" id="2076611">=</span>&nbsp;<span class="builtintype" id="2076613">uintptr</span><span class="op" id="2076620">(</span><span class="ident" id="2076621">s</span><span class="op" id="2076622">.</span><span class="ident" id="2076623">scanUint</span><span class="op" id="2076631">(</span><span class="ident" id="2076632">verb</span><span class="op" id="2076636">,</span>&nbsp;<span class="ident" id="2076638">uintptrBits</span><span class="op" id="2076649">)</span><span class="op" id="2076650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2076653">//&nbsp;Floats&nbsp;are&nbsp;tricky&nbsp;because&nbsp;you&nbsp;want&nbsp;to&nbsp;scan&nbsp;in&nbsp;the&nbsp;precision&nbsp;of&nbsp;the&nbsp;result,&nbsp;not</span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2076736">//&nbsp;scan&nbsp;in&nbsp;high&nbsp;precision&nbsp;and&nbsp;convert,&nbsp;in&nbsp;order&nbsp;to&nbsp;preserve&nbsp;the&nbsp;correct&nbsp;error&nbsp;condition.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2076826">case</span>&nbsp;<span class="op" id="2076831">*</span><span class="builtintype" id="2076832">float32</span><span class="op" id="2076839">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2076843">if</span>&nbsp;<span class="ident" id="2076846">s</span><span class="op" id="2076847">.</span><span class="ident" id="2076848">okVerb</span><span class="op" id="2076854">(</span><span class="ident" id="2076855">verb</span><span class="op" id="2076859">,</span>&nbsp;<span class="ident" id="2076861">floatVerbs</span><span class="op" id="2076871">,</span>&nbsp;<span class="string" id="2076873">&#34;float32&#34;</span><span class="op" id="2076882">)</span>&nbsp;<span class="op" id="2076884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2076889">s</span><span class="op" id="2076890">.</span><span class="ident" id="2076891">skipSpace</span><span class="op" id="2076900">(</span><span class="builtintype" id="2076901">false</span><span class="op" id="2076906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2076911">s</span><span class="op" id="2076912">.</span><span class="ident" id="2076913">notEOF</span><span class="op" id="2076919">(</span><span class="op" id="2076920">)</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2076925">*</span><span class="ident" id="2076926">v</span>&nbsp;<span class="op" id="2076928">=</span>&nbsp;<span class="builtintype" id="2076930">float32</span><span class="op" id="2076937">(</span><span class="ident" id="2076938">s</span><span class="op" id="2076939">.</span><span class="ident" id="2076940">convertFloat</span><span class="op" id="2076952">(</span><span class="ident" id="2076953">s</span><span class="op" id="2076954">.</span><span class="ident" id="2076955">floatToken</span><span class="op" id="2076965">(</span><span class="op" id="2076966">)</span><span class="op" id="2076967">,</span>&nbsp;<span class="num" id="2076969">32</span><span class="op" id="2076971">)</span><span class="op" id="2076972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2076976">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2076979">case</span>&nbsp;<span class="op" id="2076984">*</span><span class="builtintype" id="2076985">float64</span><span class="op" id="2076992">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2076996">if</span>&nbsp;<span class="ident" id="2076999">s</span><span class="op" id="2077000">.</span><span class="ident" id="2077001">okVerb</span><span class="op" id="2077007">(</span><span class="ident" id="2077008">verb</span><span class="op" id="2077012">,</span>&nbsp;<span class="ident" id="2077014">floatVerbs</span><span class="op" id="2077024">,</span>&nbsp;<span class="string" id="2077026">&#34;float64&#34;</span><span class="op" id="2077035">)</span>&nbsp;<span class="op" id="2077037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2077042">s</span><span class="op" id="2077043">.</span><span class="ident" id="2077044">skipSpace</span><span class="op" id="2077053">(</span><span class="builtintype" id="2077054">false</span><span class="op" id="2077059">)</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2077064">s</span><span class="op" id="2077065">.</span><span class="ident" id="2077066">notEOF</span><span class="op" id="2077072">(</span><span class="op" id="2077073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2077078">*</span><span class="ident" id="2077079">v</span>&nbsp;<span class="op" id="2077081">=</span>&nbsp;<span class="ident" id="2077083">s</span><span class="op" id="2077084">.</span><span class="ident" id="2077085">convertFloat</span><span class="op" id="2077097">(</span><span class="ident" id="2077098">s</span><span class="op" id="2077099">.</span><span class="ident" id="2077100">floatToken</span><span class="op" id="2077110">(</span><span class="op" id="2077111">)</span><span class="op" id="2077112">,</span>&nbsp;<span class="num" id="2077114">64</span><span class="op" id="2077116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2077120">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2077123">case</span>&nbsp;<span class="op" id="2077128">*</span><span class="builtintype" id="2077129">string</span><span class="op" id="2077135">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2077139">*</span><span class="ident" id="2077140">v</span>&nbsp;<span class="op" id="2077142">=</span>&nbsp;<span class="ident" id="2077144">s</span><span class="op" id="2077145">.</span><span class="ident" id="2077146">convertString</span><span class="op" id="2077159">(</span><span class="ident" id="2077160">verb</span><span class="op" id="2077164">)</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2077167">case</span>&nbsp;<span class="op" id="2077172">*</span><span class="op" id="2077173">[</span><span class="op" id="2077174">]</span><span class="builtintype" id="2077175">byte</span><span class="op" id="2077179">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2077183">//&nbsp;We&nbsp;scan&nbsp;to&nbsp;string&nbsp;and&nbsp;convert&nbsp;so&nbsp;we&nbsp;get&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2077248">//&nbsp;If&nbsp;we&nbsp;scanned&nbsp;to&nbsp;bytes,&nbsp;the&nbsp;slice&nbsp;would&nbsp;point&nbsp;at&nbsp;the&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2077314">*</span><span class="ident" id="2077315">v</span>&nbsp;<span class="op" id="2077317">=</span>&nbsp;<span class="op" id="2077319">[</span><span class="op" id="2077320">]</span><span class="builtintype" id="2077321">byte</span><span class="op" id="2077325">(</span><span class="ident" id="2077326">s</span><span class="op" id="2077327">.</span><span class="ident" id="2077328">convertString</span><span class="op" id="2077341">(</span><span class="ident" id="2077342">verb</span><span class="op" id="2077346">)</span><span class="op" id="2077347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2077350">default</span><span class="op" id="2077357">:</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2077361">val</span>&nbsp;<span class="op" id="2077365">:=</span>&nbsp;<span class="ident" id="2077368">reflect</span><span class="op" id="2077375">.</span><span class="ident" id="2077376">ValueOf</span><span class="op" id="2077383">(</span><span class="ident" id="2077384">v</span><span class="op" id="2077385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2077389">ptr</span>&nbsp;<span class="op" id="2077393">:=</span>&nbsp;<span class="ident" id="2077396">val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2077402">if</span>&nbsp;<span class="ident" id="2077405">ptr</span><span class="op" id="2077408">.</span><span class="ident" id="2077409">Kind</span><span class="op" id="2077413">(</span><span class="op" id="2077414">)</span>&nbsp;<span class="op" id="2077416">!=</span>&nbsp;<span class="ident" id="2077419">reflect</span><span class="op" id="2077426">.</span><span class="ident" id="2077427">Ptr</span>&nbsp;<span class="op" id="2077431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2077436">s</span><span class="op" id="2077437">.</span><span class="ident" id="2077438">errorString</span><span class="op" id="2077449">(</span><span class="string" id="2077450">&#34;type&nbsp;not&nbsp;a&nbsp;pointer:&nbsp;&#34;</span>&nbsp;<span class="op" id="2077473">+</span>&nbsp;<span class="ident" id="2077475">val</span><span class="op" id="2077478">.</span><span class="ident" id="2077479">Type</span><span class="op" id="2077483">(</span><span class="op" id="2077484">)</span><span class="op" id="2077485">.</span><span class="ident" id="2077486">String</span><span class="op" id="2077492">(</span><span class="op" id="2077493">)</span><span class="op" id="2077494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2077499">return</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2077508">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2077512">switch</span>&nbsp;<span class="ident" id="2077519">v</span>&nbsp;<span class="op" id="2077521">:=</span>&nbsp;<span class="ident" id="2077524">ptr</span><span class="op" id="2077527">.</span><span class="ident" id="2077528">Elem</span><span class="op" id="2077532">(</span><span class="op" id="2077533">)</span><span class="op" id="2077534">;</span>&nbsp;<span class="ident" id="2077536">v</span><span class="op" id="2077537">.</span><span class="ident" id="2077538">Kind</span><span class="op" id="2077542">(</span><span class="op" id="2077543">)</span>&nbsp;<span class="op" id="2077545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2077549">case</span>&nbsp;<span class="ident" id="2077554">reflect</span><span class="op" id="2077561">.</span><span class="ident" id="2077562">Bool</span><span class="op" id="2077566">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2077571">v</span><span class="op" id="2077572">.</span><span class="ident" id="2077573">SetBool</span><span class="op" id="2077580">(</span><span class="ident" id="2077581">s</span><span class="op" id="2077582">.</span><span class="ident" id="2077583">scanBool</span><span class="op" id="2077591">(</span><span class="ident" id="2077592">verb</span><span class="op" id="2077596">)</span><span class="op" id="2077597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2077601">case</span>&nbsp;<span class="ident" id="2077606">reflect</span><span class="op" id="2077613">.</span><span class="ident" id="2077614">Int</span><span class="op" id="2077617">,</span>&nbsp;<span class="ident" id="2077619">reflect</span><span class="op" id="2077626">.</span><span class="ident" id="2077627">Int8</span><span class="op" id="2077631">,</span>&nbsp;<span class="ident" id="2077633">reflect</span><span class="op" id="2077640">.</span><span class="ident" id="2077641">Int16</span><span class="op" id="2077646">,</span>&nbsp;<span class="ident" id="2077648">reflect</span><span class="op" id="2077655">.</span><span class="ident" id="2077656">Int32</span><span class="op" id="2077661">,</span>&nbsp;<span class="ident" id="2077663">reflect</span><span class="op" id="2077670">.</span><span class="ident" id="2077671">Int64</span><span class="op" id="2077676">:</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2077681">v</span><span class="op" id="2077682">.</span><span class="ident" id="2077683">SetInt</span><span class="op" id="2077689">(</span><span class="ident" id="2077690">s</span><span class="op" id="2077691">.</span><span class="ident" id="2077692">scanInt</span><span class="op" id="2077699">(</span><span class="ident" id="2077700">verb</span><span class="op" id="2077704">,</span>&nbsp;<span class="ident" id="2077706">v</span><span class="op" id="2077707">.</span><span class="ident" id="2077708">Type</span><span class="op" id="2077712">(</span><span class="op" id="2077713">)</span><span class="op" id="2077714">.</span><span class="ident" id="2077715">Bits</span><span class="op" id="2077719">(</span><span class="op" id="2077720">)</span><span class="op" id="2077721">)</span><span class="op" id="2077722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2077726">case</span>&nbsp;<span class="ident" id="2077731">reflect</span><span class="op" id="2077738">.</span><span class="ident" id="2077739">Uint</span><span class="op" id="2077743">,</span>&nbsp;<span class="ident" id="2077745">reflect</span><span class="op" id="2077752">.</span><span class="ident" id="2077753">Uint8</span><span class="op" id="2077758">,</span>&nbsp;<span class="ident" id="2077760">reflect</span><span class="op" id="2077767">.</span><span class="ident" id="2077768">Uint16</span><span class="op" id="2077774">,</span>&nbsp;<span class="ident" id="2077776">reflect</span><span class="op" id="2077783">.</span><span class="ident" id="2077784">Uint32</span><span class="op" id="2077790">,</span>&nbsp;<span class="ident" id="2077792">reflect</span><span class="op" id="2077799">.</span><span class="ident" id="2077800">Uint64</span><span class="op" id="2077806">,</span>&nbsp;<span class="ident" id="2077808">reflect</span><span class="op" id="2077815">.</span><span class="ident" id="2077816">Uintptr</span><span class="op" id="2077823">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2077828">v</span><span class="op" id="2077829">.</span><span class="ident" id="2077830">SetUint</span><span class="op" id="2077837">(</span><span class="ident" id="2077838">s</span><span class="op" id="2077839">.</span><span class="ident" id="2077840">scanUint</span><span class="op" id="2077848">(</span><span class="ident" id="2077849">verb</span><span class="op" id="2077853">,</span>&nbsp;<span class="ident" id="2077855">v</span><span class="op" id="2077856">.</span><span class="ident" id="2077857">Type</span><span class="op" id="2077861">(</span><span class="op" id="2077862">)</span><span class="op" id="2077863">.</span><span class="ident" id="2077864">Bits</span><span class="op" id="2077868">(</span><span class="op" id="2077869">)</span><span class="op" id="2077870">)</span><span class="op" id="2077871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2077875">case</span>&nbsp;<span class="ident" id="2077880">reflect</span><span class="op" id="2077887">.</span><span class="ident" id="2077888">String</span><span class="op" id="2077894">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2077899">v</span><span class="op" id="2077900">.</span><span class="ident" id="2077901">SetString</span><span class="op" id="2077910">(</span><span class="ident" id="2077911">s</span><span class="op" id="2077912">.</span><span class="ident" id="2077913">convertString</span><span class="op" id="2077926">(</span><span class="ident" id="2077927">verb</span><span class="op" id="2077931">)</span><span class="op" id="2077932">)</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2077936">case</span>&nbsp;<span class="ident" id="2077941">reflect</span><span class="op" id="2077948">.</span><span class="ident" id="2077949">Slice</span><span class="op" id="2077954">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2077959">//&nbsp;For&nbsp;now,&nbsp;can&nbsp;only&nbsp;handle&nbsp;(renamed)&nbsp;[]byte.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2078008">typ</span>&nbsp;<span class="op" id="2078012">:=</span>&nbsp;<span class="ident" id="2078015">v</span><span class="op" id="2078016">.</span><span class="ident" id="2078017">Type</span><span class="op" id="2078021">(</span><span class="op" id="2078022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2078027">if</span>&nbsp;<span class="ident" id="2078030">typ</span><span class="op" id="2078033">.</span><span class="ident" id="2078034">Elem</span><span class="op" id="2078038">(</span><span class="op" id="2078039">)</span><span class="op" id="2078040">.</span><span class="ident" id="2078041">Kind</span><span class="op" id="2078045">(</span><span class="op" id="2078046">)</span>&nbsp;<span class="op" id="2078048">!=</span>&nbsp;<span class="ident" id="2078051">reflect</span><span class="op" id="2078058">.</span><span class="ident" id="2078059">Uint8</span>&nbsp;<span class="op" id="2078065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2078071">s</span><span class="op" id="2078072">.</span><span class="ident" id="2078073">errorString</span><span class="op" id="2078084">(</span><span class="string" id="2078085">&#34;can&#39;t&nbsp;scan&nbsp;type:&nbsp;&#34;</span>&nbsp;<span class="op" id="2078105">+</span>&nbsp;<span class="ident" id="2078107">val</span><span class="op" id="2078110">.</span><span class="ident" id="2078111">Type</span><span class="op" id="2078115">(</span><span class="op" id="2078116">)</span><span class="op" id="2078117">.</span><span class="ident" id="2078118">String</span><span class="op" id="2078124">(</span><span class="op" id="2078125">)</span><span class="op" id="2078126">)</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2078131">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2078136">str</span>&nbsp;<span class="op" id="2078140">:=</span>&nbsp;<span class="ident" id="2078143">s</span><span class="op" id="2078144">.</span><span class="ident" id="2078145">convertString</span><span class="op" id="2078158">(</span><span class="ident" id="2078159">verb</span><span class="op" id="2078163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2078168">v</span><span class="op" id="2078169">.</span><span class="ident" id="2078170">Set</span><span class="op" id="2078173">(</span><span class="ident" id="2078174">reflect</span><span class="op" id="2078181">.</span><span class="ident" id="2078182">MakeSlice</span><span class="op" id="2078191">(</span><span class="ident" id="2078192">typ</span><span class="op" id="2078195">,</span>&nbsp;<span class="builtinfunc" id="2078197">len</span><span class="op" id="2078200">(</span><span class="ident" id="2078201">str</span><span class="op" id="2078204">)</span><span class="op" id="2078205">,</span>&nbsp;<span class="builtinfunc" id="2078207">len</span><span class="op" id="2078210">(</span><span class="ident" id="2078211">str</span><span class="op" id="2078214">)</span><span class="op" id="2078215">)</span><span class="op" id="2078216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2078221">for</span>&nbsp;<span class="ident" id="2078225">i</span>&nbsp;<span class="op" id="2078227">:=</span>&nbsp;<span class="num" id="2078230">0</span><span class="op" id="2078231">;</span>&nbsp;<span class="ident" id="2078233">i</span>&nbsp;<span class="op" id="2078235">&lt;</span>&nbsp;<span class="builtinfunc" id="2078237">len</span><span class="op" id="2078240">(</span><span class="ident" id="2078241">str</span><span class="op" id="2078244">)</span><span class="op" id="2078245">;</span>&nbsp;<span class="ident" id="2078247">i</span><span class="op" id="2078248">++</span>&nbsp;<span class="op" id="2078251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2078257">v</span><span class="op" id="2078258">.</span><span class="ident" id="2078259">Index</span><span class="op" id="2078264">(</span><span class="ident" id="2078265">i</span><span class="op" id="2078266">)</span><span class="op" id="2078267">.</span><span class="ident" id="2078268">SetUint</span><span class="op" id="2078275">(</span><span class="ident" id="2078276">uint64</span><span class="op" id="2078282">(</span><span class="ident" id="2078283">str</span><span class="op" id="2078286">[</span><span class="ident" id="2078287">i</span><span class="op" id="2078288">]</span><span class="op" id="2078289">)</span><span class="op" id="2078290">)</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2078295">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2078299">case</span>&nbsp;<span class="ident" id="2078304">reflect</span><span class="op" id="2078311">.</span><span class="ident" id="2078312">Float32</span><span class="op" id="2078319">,</span>&nbsp;<span class="ident" id="2078321">reflect</span><span class="op" id="2078328">.</span><span class="ident" id="2078329">Float64</span><span class="op" id="2078336">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2078341">s</span><span class="op" id="2078342">.</span><span class="ident" id="2078343">skipSpace</span><span class="op" id="2078352">(</span><span class="builtintype" id="2078353">false</span><span class="op" id="2078358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2078363">s</span><span class="op" id="2078364">.</span><span class="ident" id="2078365">notEOF</span><span class="op" id="2078371">(</span><span class="op" id="2078372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2078377">v</span><span class="op" id="2078378">.</span><span class="ident" id="2078379">SetFloat</span><span class="op" id="2078387">(</span><span class="ident" id="2078388">s</span><span class="op" id="2078389">.</span><span class="ident" id="2078390">convertFloat</span><span class="op" id="2078402">(</span><span class="ident" id="2078403">s</span><span class="op" id="2078404">.</span><span class="ident" id="2078405">floatToken</span><span class="op" id="2078415">(</span><span class="op" id="2078416">)</span><span class="op" id="2078417">,</span>&nbsp;<span class="ident" id="2078419">v</span><span class="op" id="2078420">.</span><span class="ident" id="2078421">Type</span><span class="op" id="2078425">(</span><span class="op" id="2078426">)</span><span class="op" id="2078427">.</span><span class="ident" id="2078428">Bits</span><span class="op" id="2078432">(</span><span class="op" id="2078433">)</span><span class="op" id="2078434">)</span><span class="op" id="2078435">)</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2078439">case</span>&nbsp;<span class="ident" id="2078444">reflect</span><span class="op" id="2078451">.</span><span class="ident" id="2078452">Complex64</span><span class="op" id="2078461">,</span>&nbsp;<span class="ident" id="2078463">reflect</span><span class="op" id="2078470">.</span><span class="ident" id="2078471">Complex128</span><span class="op" id="2078481">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2078486">v</span><span class="op" id="2078487">.</span><span class="ident" id="2078488">SetComplex</span><span class="op" id="2078498">(</span><span class="ident" id="2078499">s</span><span class="op" id="2078500">.</span><span class="ident" id="2078501">scanComplex</span><span class="op" id="2078512">(</span><span class="ident" id="2078513">verb</span><span class="op" id="2078517">,</span>&nbsp;<span class="ident" id="2078519">v</span><span class="op" id="2078520">.</span><span class="ident" id="2078521">Type</span><span class="op" id="2078525">(</span><span class="op" id="2078526">)</span><span class="op" id="2078527">.</span><span class="ident" id="2078528">Bits</span><span class="op" id="2078532">(</span><span class="op" id="2078533">)</span><span class="op" id="2078534">)</span><span class="op" id="2078535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2078539">default</span><span class="op" id="2078546">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2078551">s</span><span class="op" id="2078552">.</span><span class="ident" id="2078553">errorString</span><span class="op" id="2078564">(</span><span class="string" id="2078565">&#34;can&#39;t&nbsp;scan&nbsp;type:&nbsp;&#34;</span>&nbsp;<span class="op" id="2078585">+</span>&nbsp;<span class="ident" id="2078587">val</span><span class="op" id="2078590">.</span><span class="ident" id="2078591">Type</span><span class="op" id="2078595">(</span><span class="op" id="2078596">)</span><span class="op" id="2078597">.</span><span class="ident" id="2078598">String</span><span class="op" id="2078604">(</span><span class="op" id="2078605">)</span><span class="op" id="2078606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2078610">}</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2078613">}</span><br>
<span class="lineno"></span><span class="op" id="2078615">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2078618">//&nbsp;errorHandler&nbsp;turns&nbsp;local&nbsp;panics&nbsp;into&nbsp;error&nbsp;returns.</span><br>
<span class="lineno"></span><span class="keyword" id="2078673">func</span>&nbsp;<span class="ident" id="2078678">errorHandler</span><span class="op" id="2078690">(</span><span class="ident" id="2078691">errp</span>&nbsp;<span class="op" id="2078696">*</span><span class="builtintype" id="2078697">error</span><span class="op" id="2078702">)</span>&nbsp;<span class="op" id="2078704">{</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2078707">if</span>&nbsp;<span class="ident" id="2078710">e</span>&nbsp;<span class="op" id="2078712">:=</span>&nbsp;<span class="builtinfunc" id="2078715">recover</span><span class="op" id="2078722">(</span><span class="op" id="2078723">)</span><span class="op" id="2078724">;</span>&nbsp;<span class="ident" id="2078726">e</span>&nbsp;<span class="op" id="2078728">!=</span>&nbsp;<span class="ident" id="2078731">nil</span>&nbsp;<span class="op" id="2078735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2078739">if</span>&nbsp;<span class="ident" id="2078742">se</span><span class="op" id="2078744">,</span>&nbsp;<span class="ident" id="2078746">ok</span>&nbsp;<span class="op" id="2078749">:=</span>&nbsp;<span class="ident" id="2078752">e</span><span class="op" id="2078753">.</span><span class="op" id="2078754">(</span><span class="ident" id="2078755">scanError</span><span class="op" id="2078764">)</span><span class="op" id="2078765">;</span>&nbsp;<span class="ident" id="2078767">ok</span>&nbsp;<span class="op" id="2078770">{</span>&nbsp;<span class="comment" id="2078772">//&nbsp;catch&nbsp;local&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2078796">*</span><span class="ident" id="2078797">errp</span>&nbsp;<span class="op" id="2078802">=</span>&nbsp;<span class="ident" id="2078804">se</span><span class="op" id="2078806">.</span><span class="ident" id="2078807">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2078813">}</span>&nbsp;<span class="keyword" id="2078815">else</span>&nbsp;<span class="keyword" id="2078820">if</span>&nbsp;<span class="ident" id="2078823">eof</span><span class="op" id="2078826">,</span>&nbsp;<span class="ident" id="2078828">ok</span>&nbsp;<span class="op" id="2078831">:=</span>&nbsp;<span class="ident" id="2078834">e</span><span class="op" id="2078835">.</span><span class="op" id="2078836">(</span><span class="builtintype" id="2078837">error</span><span class="op" id="2078842">)</span><span class="op" id="2078843">;</span>&nbsp;<span class="ident" id="2078845">ok</span>&nbsp;<span class="op" id="2078848">&amp;&amp;</span>&nbsp;<span class="ident" id="2078851">eof</span>&nbsp;<span class="op" id="2078855">==</span>&nbsp;<span class="ident" id="2078858">io</span><span class="op" id="2078860">.</span><span class="ident" id="2078861">EOF</span>&nbsp;<span class="op" id="2078865">{</span>&nbsp;<span class="comment" id="2078867">//&nbsp;out&nbsp;of&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2078886">*</span><span class="ident" id="2078887">errp</span>&nbsp;<span class="op" id="2078892">=</span>&nbsp;<span class="ident" id="2078894">eof</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2078900">}</span>&nbsp;<span class="keyword" id="2078902">else</span>&nbsp;<span class="op" id="2078907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2078912">panic</span><span class="op" id="2078917">(</span><span class="ident" id="2078918">e</span><span class="op" id="2078919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2078923">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2078926">}</span><br>
<span class="lineno"></span><span class="op" id="2078928">}</span><br>
<span class="lineno">1045</span><br>
<span class="lineno"></span><span class="comment" id="2078931">//&nbsp;doScan&nbsp;does&nbsp;the&nbsp;real&nbsp;work&nbsp;for&nbsp;scanning&nbsp;without&nbsp;a&nbsp;format&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2078998">func</span>&nbsp;<span class="op" id="2079003">(</span><span class="ident" id="2079004">s</span>&nbsp;<span class="op" id="2079006">*</span><span class="ident" id="2079007">ss</span><span class="op" id="2079009">)</span>&nbsp;<span class="ident" id="2079011">doScan</span><span class="op" id="2079017">(</span><span class="ident" id="2079018">a</span>&nbsp;<span class="op" id="2079020">[</span><span class="op" id="2079021">]</span><span class="keyword" id="2079022">interface</span><span class="op" id="2079031">{</span><span class="op" id="2079032">}</span><span class="op" id="2079033">)</span>&nbsp;<span class="op" id="2079035">(</span><span class="ident" id="2079036">numProcessed</span>&nbsp;<span class="builtintype" id="2079049">int</span><span class="op" id="2079052">,</span>&nbsp;<span class="ident" id="2079054">err</span>&nbsp;<span class="builtintype" id="2079058">error</span><span class="op" id="2079063">)</span>&nbsp;<span class="op" id="2079065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2079068">defer</span>&nbsp;<span class="ident" id="2079074">errorHandler</span><span class="op" id="2079086">(</span><span class="op" id="2079087">&amp;</span><span class="ident" id="2079088">err</span><span class="op" id="2079091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2079094">for</span>&nbsp;<span class="ident" id="2079098">_</span><span class="op" id="2079099">,</span>&nbsp;<span class="ident" id="2079101">arg</span>&nbsp;<span class="op" id="2079105">:=</span>&nbsp;<span class="keyword" id="2079108">range</span>&nbsp;<span class="ident" id="2079114">a</span>&nbsp;<span class="op" id="2079116">{</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2079120">s</span><span class="op" id="2079121">.</span><span class="ident" id="2079122">scanOne</span><span class="op" id="2079129">(</span><span class="string" id="2079130">&#39;v&#39;</span><span class="op" id="2079133">,</span>&nbsp;<span class="ident" id="2079135">arg</span><span class="op" id="2079138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2079142">numProcessed</span><span class="op" id="2079154">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2079158">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2079161">//&nbsp;Check&nbsp;for&nbsp;newline&nbsp;if&nbsp;required.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2079196">if</span>&nbsp;<span class="op" id="2079199">!</span><span class="ident" id="2079200">s</span><span class="op" id="2079201">.</span><span class="ident" id="2079202">nlIsSpace</span>&nbsp;<span class="op" id="2079212">{</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2079216">for</span>&nbsp;<span class="op" id="2079220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2079225">r</span>&nbsp;<span class="op" id="2079227">:=</span>&nbsp;<span class="ident" id="2079230">s</span><span class="op" id="2079231">.</span><span class="ident" id="2079232">getRune</span><span class="op" id="2079239">(</span><span class="op" id="2079240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2079245">if</span>&nbsp;<span class="ident" id="2079248">r</span>&nbsp;<span class="op" id="2079250">==</span>&nbsp;<span class="string" id="2079253">&#39;\n&#39;</span>&nbsp;<span class="op" id="2079258">||</span>&nbsp;<span class="ident" id="2079261">r</span>&nbsp;<span class="op" id="2079263">==</span>&nbsp;<span class="ident" id="2079266">eof</span>&nbsp;<span class="op" id="2079270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2079276">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2079285">}</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2079290">if</span>&nbsp;<span class="op" id="2079293">!</span><span class="ident" id="2079294">isSpace</span><span class="op" id="2079301">(</span><span class="ident" id="2079302">r</span><span class="op" id="2079303">)</span>&nbsp;<span class="op" id="2079305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2079311">s</span><span class="op" id="2079312">.</span><span class="ident" id="2079313">errorString</span><span class="op" id="2079324">(</span><span class="string" id="2079325">&#34;expected&nbsp;newline&#34;</span><span class="op" id="2079343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2079349">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2079358">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2079362">}</span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2079365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2079368">return</span><br>
<span class="lineno"></span><span class="op" id="2079375">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2079378">//&nbsp;advance&nbsp;determines&nbsp;whether&nbsp;the&nbsp;next&nbsp;characters&nbsp;in&nbsp;the&nbsp;input&nbsp;match</span><br>
<span class="lineno">1070</span><span class="comment" id="2079447">//&nbsp;those&nbsp;of&nbsp;the&nbsp;format.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;(sic)&nbsp;consumed</span><br>
<span class="lineno"></span><span class="comment" id="2079518">//&nbsp;in&nbsp;the&nbsp;format.&nbsp;Newlines&nbsp;included,&nbsp;all&nbsp;runs&nbsp;of&nbsp;space&nbsp;characters&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="2079587">//&nbsp;either&nbsp;input&nbsp;or&nbsp;format&nbsp;behave&nbsp;as&nbsp;a&nbsp;single&nbsp;space.&nbsp;This&nbsp;routine&nbsp;also</span><br>
<span class="lineno"></span><span class="comment" id="2079657">//&nbsp;handles&nbsp;the&nbsp;%%&nbsp;case.&nbsp;&nbsp;If&nbsp;the&nbsp;return&nbsp;value&nbsp;is&nbsp;zero,&nbsp;either&nbsp;format</span><br>
<span class="lineno"></span><span class="comment" id="2079725">//&nbsp;starts&nbsp;with&nbsp;a&nbsp;%&nbsp;(with&nbsp;no&nbsp;following&nbsp;%)&nbsp;or&nbsp;the&nbsp;input&nbsp;is&nbsp;empty.</span><br>
<span class="lineno">1075</span><span class="comment" id="2079789">//&nbsp;If&nbsp;it&nbsp;is&nbsp;negative,&nbsp;the&nbsp;input&nbsp;did&nbsp;not&nbsp;match&nbsp;the&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2079847">func</span>&nbsp;<span class="op" id="2079852">(</span><span class="ident" id="2079853">s</span>&nbsp;<span class="op" id="2079855">*</span><span class="ident" id="2079856">ss</span><span class="op" id="2079858">)</span>&nbsp;<span class="ident" id="2079860">advance</span><span class="op" id="2079867">(</span><span class="ident" id="2079868">format</span>&nbsp;<span class="builtintype" id="2079875">string</span><span class="op" id="2079881">)</span>&nbsp;<span class="op" id="2079883">(</span><span class="ident" id="2079884">i</span>&nbsp;<span class="builtintype" id="2079886">int</span><span class="op" id="2079889">)</span>&nbsp;<span class="op" id="2079891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2079894">for</span>&nbsp;<span class="ident" id="2079898">i</span>&nbsp;<span class="op" id="2079900">&lt;</span>&nbsp;<span class="builtinfunc" id="2079902">len</span><span class="op" id="2079905">(</span><span class="ident" id="2079906">format</span><span class="op" id="2079912">)</span>&nbsp;<span class="op" id="2079914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2079918">fmtc</span><span class="op" id="2079922">,</span>&nbsp;<span class="ident" id="2079924">w</span>&nbsp;<span class="op" id="2079926">:=</span>&nbsp;<span class="ident" id="2079929">utf8</span><span class="op" id="2079933">.</span><span class="ident" id="2079934">DecodeRuneInString</span><span class="op" id="2079952">(</span><span class="ident" id="2079953">format</span><span class="op" id="2079959">[</span><span class="ident" id="2079960">i</span><span class="op" id="2079961">:</span><span class="op" id="2079962">]</span><span class="op" id="2079963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2079967">if</span>&nbsp;<span class="ident" id="2079970">fmtc</span>&nbsp;<span class="op" id="2079975">==</span>&nbsp;<span class="string" id="2079978">&#39;%&#39;</span>&nbsp;<span class="op" id="2079982">{</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2079987">//&nbsp;%%&nbsp;acts&nbsp;like&nbsp;a&nbsp;real&nbsp;percent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2080021">nextc</span><span class="op" id="2080026">,</span>&nbsp;<span class="ident" id="2080028">_</span>&nbsp;<span class="op" id="2080030">:=</span>&nbsp;<span class="ident" id="2080033">utf8</span><span class="op" id="2080037">.</span><span class="ident" id="2080038">DecodeRuneInString</span><span class="op" id="2080056">(</span><span class="ident" id="2080057">format</span><span class="op" id="2080063">[</span><span class="ident" id="2080064">i</span><span class="op" id="2080065">+</span><span class="ident" id="2080066">w</span><span class="op" id="2080067">:</span><span class="op" id="2080068">]</span><span class="op" id="2080069">)</span>&nbsp;<span class="comment" id="2080071">//&nbsp;will&nbsp;not&nbsp;match&nbsp;%&nbsp;if&nbsp;string&nbsp;is&nbsp;empty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2080113">if</span>&nbsp;<span class="ident" id="2080116">nextc</span>&nbsp;<span class="op" id="2080122">!=</span>&nbsp;<span class="string" id="2080125">&#39;%&#39;</span>&nbsp;<span class="op" id="2080129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2080135">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2080145">}</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2080150">i</span>&nbsp;<span class="op" id="2080152">+=</span>&nbsp;<span class="ident" id="2080155">w</span>&nbsp;<span class="comment" id="2080157">//&nbsp;skip&nbsp;the&nbsp;first&nbsp;%</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2080179">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2080183">sawSpace</span>&nbsp;<span class="op" id="2080192">:=</span>&nbsp;<span class="builtintype" id="2080195">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2080203">for</span>&nbsp;<span class="ident" id="2080207">isSpace</span><span class="op" id="2080214">(</span><span class="ident" id="2080215">fmtc</span><span class="op" id="2080219">)</span>&nbsp;<span class="op" id="2080221">&amp;&amp;</span>&nbsp;<span class="ident" id="2080224">i</span>&nbsp;<span class="op" id="2080226">&lt;</span>&nbsp;<span class="builtinfunc" id="2080228">len</span><span class="op" id="2080231">(</span><span class="ident" id="2080232">format</span><span class="op" id="2080238">)</span>&nbsp;<span class="op" id="2080240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2080245">sawSpace</span>&nbsp;<span class="op" id="2080254">=</span>&nbsp;<span class="builtintype" id="2080256">true</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2080264">i</span>&nbsp;<span class="op" id="2080266">+=</span>&nbsp;<span class="ident" id="2080269">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2080274">fmtc</span><span class="op" id="2080278">,</span>&nbsp;<span class="ident" id="2080280">w</span>&nbsp;<span class="op" id="2080282">=</span>&nbsp;<span class="ident" id="2080284">utf8</span><span class="op" id="2080288">.</span><span class="ident" id="2080289">DecodeRuneInString</span><span class="op" id="2080307">(</span><span class="ident" id="2080308">format</span><span class="op" id="2080314">[</span><span class="ident" id="2080315">i</span><span class="op" id="2080316">:</span><span class="op" id="2080317">]</span><span class="op" id="2080318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2080322">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2080326">if</span>&nbsp;<span class="ident" id="2080329">sawSpace</span>&nbsp;<span class="op" id="2080338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2080343">//&nbsp;There&nbsp;was&nbsp;space&nbsp;in&nbsp;the&nbsp;format,&nbsp;so&nbsp;there&nbsp;should&nbsp;be&nbsp;space&nbsp;(EOF)</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2080411">//&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2080431">inputc</span>&nbsp;<span class="op" id="2080438">:=</span>&nbsp;<span class="ident" id="2080441">s</span><span class="op" id="2080442">.</span><span class="ident" id="2080443">getRune</span><span class="op" id="2080450">(</span><span class="op" id="2080451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2080456">if</span>&nbsp;<span class="ident" id="2080459">inputc</span>&nbsp;<span class="op" id="2080466">==</span>&nbsp;<span class="ident" id="2080469">eof</span>&nbsp;<span class="op" id="2080473">||</span>&nbsp;<span class="ident" id="2080476">inputc</span>&nbsp;<span class="op" id="2080483">==</span>&nbsp;<span class="string" id="2080486">&#39;\n&#39;</span>&nbsp;<span class="op" id="2080491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2080497">//&nbsp;If&nbsp;we&#39;ve&nbsp;reached&nbsp;a&nbsp;newline,&nbsp;stop&nbsp;now;&nbsp;don&#39;t&nbsp;read&nbsp;ahead.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2080560">return</span><br>
<span class="lineno">1100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2080570">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2080575">if</span>&nbsp;<span class="op" id="2080578">!</span><span class="ident" id="2080579">isSpace</span><span class="op" id="2080586">(</span><span class="ident" id="2080587">inputc</span><span class="op" id="2080593">)</span>&nbsp;<span class="op" id="2080595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2080601">//&nbsp;Space&nbsp;in&nbsp;format&nbsp;but&nbsp;not&nbsp;in&nbsp;input:&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2080648">s</span><span class="op" id="2080649">.</span><span class="ident" id="2080650">errorString</span><span class="op" id="2080661">(</span><span class="string" id="2080662">&#34;expected&nbsp;space&nbsp;in&nbsp;input&nbsp;to&nbsp;match&nbsp;format&#34;</span><span class="op" id="2080703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2080708">}</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2080713">s</span><span class="op" id="2080714">.</span><span class="ident" id="2080715">skipSpace</span><span class="op" id="2080724">(</span><span class="builtintype" id="2080725">true</span><span class="op" id="2080729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2080734">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2080745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2080749">inputc</span>&nbsp;<span class="op" id="2080756">:=</span>&nbsp;<span class="ident" id="2080759">s</span><span class="op" id="2080760">.</span><span class="ident" id="2080761">mustReadRune</span><span class="op" id="2080773">(</span><span class="op" id="2080774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2080778">if</span>&nbsp;<span class="ident" id="2080781">fmtc</span>&nbsp;<span class="op" id="2080786">!=</span>&nbsp;<span class="ident" id="2080789">inputc</span>&nbsp;<span class="op" id="2080796">{</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2080801">s</span><span class="op" id="2080802">.</span><span class="ident" id="2080803">UnreadRune</span><span class="op" id="2080813">(</span><span class="op" id="2080814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2080819">return</span>&nbsp;<span class="op" id="2080826">-</span><span class="num" id="2080827">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2080831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2080835">i</span>&nbsp;<span class="op" id="2080837">+=</span>&nbsp;<span class="ident" id="2080840">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2080843">}</span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2080846">return</span><br>
<span class="lineno"></span><span class="op" id="2080853">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2080856">//&nbsp;doScanf&nbsp;does&nbsp;the&nbsp;real&nbsp;work&nbsp;when&nbsp;scanning&nbsp;with&nbsp;a&nbsp;format&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="2080922">//&nbsp;&nbsp;At&nbsp;the&nbsp;moment,&nbsp;it&nbsp;handles&nbsp;only&nbsp;pointers&nbsp;to&nbsp;basic&nbsp;types.</span><br>
<span class="lineno">1120</span><span class="keyword" id="2080982">func</span>&nbsp;<span class="op" id="2080987">(</span><span class="ident" id="2080988">s</span>&nbsp;<span class="op" id="2080990">*</span><span class="ident" id="2080991">ss</span><span class="op" id="2080993">)</span>&nbsp;<span class="ident" id="2080995">doScanf</span><span class="op" id="2081002">(</span><span class="ident" id="2081003">format</span>&nbsp;<span class="builtintype" id="2081010">string</span><span class="op" id="2081016">,</span>&nbsp;<span class="ident" id="2081018">a</span>&nbsp;<span class="op" id="2081020">[</span><span class="op" id="2081021">]</span><span class="keyword" id="2081022">interface</span><span class="op" id="2081031">{</span><span class="op" id="2081032">}</span><span class="op" id="2081033">)</span>&nbsp;<span class="op" id="2081035">(</span><span class="ident" id="2081036">numProcessed</span>&nbsp;<span class="builtintype" id="2081049">int</span><span class="op" id="2081052">,</span>&nbsp;<span class="ident" id="2081054">err</span>&nbsp;<span class="builtintype" id="2081058">error</span><span class="op" id="2081063">)</span>&nbsp;<span class="op" id="2081065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2081068">defer</span>&nbsp;<span class="ident" id="2081074">errorHandler</span><span class="op" id="2081086">(</span><span class="op" id="2081087">&amp;</span><span class="ident" id="2081088">err</span><span class="op" id="2081091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2081094">end</span>&nbsp;<span class="op" id="2081098">:=</span>&nbsp;<span class="builtinfunc" id="2081101">len</span><span class="op" id="2081104">(</span><span class="ident" id="2081105">format</span><span class="op" id="2081111">)</span>&nbsp;<span class="op" id="2081113">-</span>&nbsp;<span class="num" id="2081115">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2081118">//&nbsp;We&nbsp;process&nbsp;one&nbsp;item&nbsp;per&nbsp;non-trivial&nbsp;format</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2081165">for</span>&nbsp;<span class="ident" id="2081169">i</span>&nbsp;<span class="op" id="2081171">:=</span>&nbsp;<span class="num" id="2081174">0</span><span class="op" id="2081175">;</span>&nbsp;<span class="ident" id="2081177">i</span>&nbsp;<span class="op" id="2081179">&lt;=</span>&nbsp;<span class="ident" id="2081182">end</span><span class="op" id="2081185">;</span>&nbsp;<span class="op" id="2081187">{</span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2081191">w</span>&nbsp;<span class="op" id="2081193">:=</span>&nbsp;<span class="ident" id="2081196">s</span><span class="op" id="2081197">.</span><span class="ident" id="2081198">advance</span><span class="op" id="2081205">(</span><span class="ident" id="2081206">format</span><span class="op" id="2081212">[</span><span class="ident" id="2081213">i</span><span class="op" id="2081214">:</span><span class="op" id="2081215">]</span><span class="op" id="2081216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2081220">if</span>&nbsp;<span class="ident" id="2081223">w</span>&nbsp;<span class="op" id="2081225">&gt;</span>&nbsp;<span class="num" id="2081227">0</span>&nbsp;<span class="op" id="2081229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2081234">i</span>&nbsp;<span class="op" id="2081236">+=</span>&nbsp;<span class="ident" id="2081239">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2081244">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2081255">}</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2081259">//&nbsp;Either&nbsp;we&nbsp;failed&nbsp;to&nbsp;advance,&nbsp;we&nbsp;have&nbsp;a&nbsp;percent&nbsp;character,&nbsp;or&nbsp;we&nbsp;ran&nbsp;out&nbsp;of&nbsp;input.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2081346">if</span>&nbsp;<span class="ident" id="2081349">format</span><span class="op" id="2081355">[</span><span class="ident" id="2081356">i</span><span class="op" id="2081357">]</span>&nbsp;<span class="op" id="2081359">!=</span>&nbsp;<span class="string" id="2081362">&#39;%&#39;</span>&nbsp;<span class="op" id="2081366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2081371">//&nbsp;Can&#39;t&nbsp;advance&nbsp;format.&nbsp;&nbsp;Why&nbsp;not?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2081409">if</span>&nbsp;<span class="ident" id="2081412">w</span>&nbsp;<span class="op" id="2081414">&lt;</span>&nbsp;<span class="num" id="2081416">0</span>&nbsp;<span class="op" id="2081418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2081424">s</span><span class="op" id="2081425">.</span><span class="ident" id="2081426">errorString</span><span class="op" id="2081437">(</span><span class="string" id="2081438">&#34;input&nbsp;does&nbsp;not&nbsp;match&nbsp;format&#34;</span><span class="op" id="2081467">)</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2081472">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2081477">//&nbsp;Otherwise&nbsp;at&nbsp;EOF;&nbsp;&#34;too&nbsp;many&nbsp;operands&#34;&nbsp;error&nbsp;handled&nbsp;below</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2081541">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2081549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2081553">i</span><span class="op" id="2081554">++</span>&nbsp;<span class="comment" id="2081557">//&nbsp;%&nbsp;is&nbsp;one&nbsp;byte</span><br>
<span class="lineno">1140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2081577">//&nbsp;do&nbsp;we&nbsp;have&nbsp;20&nbsp;(width)?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2081605">var</span>&nbsp;<span class="ident" id="2081609">widPresent</span>&nbsp;<span class="builtintype" id="2081620">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2081627">s</span><span class="op" id="2081628">.</span><span class="ident" id="2081629">maxWid</span><span class="op" id="2081635">,</span>&nbsp;<span class="ident" id="2081637">widPresent</span><span class="op" id="2081647">,</span>&nbsp;<span class="ident" id="2081649">i</span>&nbsp;<span class="op" id="2081651">=</span>&nbsp;<span class="ident" id="2081653">parsenum</span><span class="op" id="2081661">(</span><span class="ident" id="2081662">format</span><span class="op" id="2081668">,</span>&nbsp;<span class="ident" id="2081670">i</span><span class="op" id="2081671">,</span>&nbsp;<span class="ident" id="2081673">end</span><span class="op" id="2081676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2081680">if</span>&nbsp;<span class="op" id="2081683">!</span><span class="ident" id="2081684">widPresent</span>&nbsp;<span class="op" id="2081695">{</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2081700">s</span><span class="op" id="2081701">.</span><span class="ident" id="2081702">maxWid</span>&nbsp;<span class="op" id="2081709">=</span>&nbsp;<span class="ident" id="2081711">hugeWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2081721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2081725">s</span><span class="op" id="2081726">.</span><span class="ident" id="2081727">argLimit</span>&nbsp;<span class="op" id="2081736">=</span>&nbsp;<span class="ident" id="2081738">s</span><span class="op" id="2081739">.</span><span class="ident" id="2081740">limit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2081748">if</span>&nbsp;<span class="ident" id="2081751">f</span>&nbsp;<span class="op" id="2081753">:=</span>&nbsp;<span class="ident" id="2081756">s</span><span class="op" id="2081757">.</span><span class="ident" id="2081758">count</span>&nbsp;<span class="op" id="2081764">+</span>&nbsp;<span class="ident" id="2081766">s</span><span class="op" id="2081767">.</span><span class="ident" id="2081768">maxWid</span><span class="op" id="2081774">;</span>&nbsp;<span class="ident" id="2081776">f</span>&nbsp;<span class="op" id="2081778">&lt;</span>&nbsp;<span class="ident" id="2081780">s</span><span class="op" id="2081781">.</span><span class="ident" id="2081782">argLimit</span>&nbsp;<span class="op" id="2081791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2081796">s</span><span class="op" id="2081797">.</span><span class="ident" id="2081798">argLimit</span>&nbsp;<span class="op" id="2081807">=</span>&nbsp;<span class="ident" id="2081809">f</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2081813">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2081818">c</span><span class="op" id="2081819">,</span>&nbsp;<span class="ident" id="2081821">w</span>&nbsp;<span class="op" id="2081823">:=</span>&nbsp;<span class="ident" id="2081826">utf8</span><span class="op" id="2081830">.</span><span class="ident" id="2081831">DecodeRuneInString</span><span class="op" id="2081849">(</span><span class="ident" id="2081850">format</span><span class="op" id="2081856">[</span><span class="ident" id="2081857">i</span><span class="op" id="2081858">:</span><span class="op" id="2081859">]</span><span class="op" id="2081860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2081864">i</span>&nbsp;<span class="op" id="2081866">+=</span>&nbsp;<span class="ident" id="2081869">w</span><br>
<span class="lineno"></span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2081874">if</span>&nbsp;<span class="ident" id="2081877">numProcessed</span>&nbsp;<span class="op" id="2081890">&gt;=</span>&nbsp;<span class="builtinfunc" id="2081893">len</span><span class="op" id="2081896">(</span><span class="ident" id="2081897">a</span><span class="op" id="2081898">)</span>&nbsp;<span class="op" id="2081900">{</span>&nbsp;<span class="comment" id="2081902">//&nbsp;out&nbsp;of&nbsp;operands</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2081924">s</span><span class="op" id="2081925">.</span><span class="ident" id="2081926">errorString</span><span class="op" id="2081937">(</span><span class="string" id="2081938">&#34;too&nbsp;few&nbsp;operands&nbsp;for&nbsp;format&nbsp;%&#34;</span>&nbsp;<span class="op" id="2081970">+</span>&nbsp;<span class="ident" id="2081972">format</span><span class="op" id="2081978">[</span><span class="ident" id="2081979">i</span><span class="op" id="2081980">-</span><span class="ident" id="2081981">w</span><span class="op" id="2081982">:</span><span class="op" id="2081983">]</span><span class="op" id="2081984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2081989">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2081997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2082001">arg</span>&nbsp;<span class="op" id="2082005">:=</span>&nbsp;<span class="ident" id="2082008">a</span><span class="op" id="2082009">[</span><span class="ident" id="2082010">numProcessed</span><span class="op" id="2082022">]</span><br>
<span class="lineno">1160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2082027">s</span><span class="op" id="2082028">.</span><span class="ident" id="2082029">scanOne</span><span class="op" id="2082036">(</span><span class="ident" id="2082037">c</span><span class="op" id="2082038">,</span>&nbsp;<span class="ident" id="2082040">arg</span><span class="op" id="2082043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2082047">numProcessed</span><span class="op" id="2082059">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2082064">s</span><span class="op" id="2082065">.</span><span class="ident" id="2082066">argLimit</span>&nbsp;<span class="op" id="2082075">=</span>&nbsp;<span class="ident" id="2082077">s</span><span class="op" id="2082078">.</span><span class="ident" id="2082079">limit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2082086">}</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2082089">if</span>&nbsp;<span class="ident" id="2082092">numProcessed</span>&nbsp;<span class="op" id="2082105">&lt;</span>&nbsp;<span class="builtinfunc" id="2082107">len</span><span class="op" id="2082110">(</span><span class="ident" id="2082111">a</span><span class="op" id="2082112">)</span>&nbsp;<span class="op" id="2082114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2082118">s</span><span class="op" id="2082119">.</span><span class="ident" id="2082120">errorString</span><span class="op" id="2082131">(</span><span class="string" id="2082132">&#34;too&nbsp;many&nbsp;operands&#34;</span><span class="op" id="2082151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2082154">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2082157">return</span><br>
<span class="lineno"></span><span class="op" id="2082164">}</span>
</div>
</body>
</html>
