<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html" class="current">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3139093">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3139148">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3139202">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3139253">/*<br>
<span class="lineno"></span>Package&nbsp;net&nbsp;provides&nbsp;a&nbsp;portable&nbsp;interface&nbsp;for&nbsp;network&nbsp;I/O,&nbsp;including<br>
<span class="lineno"></span>TCP/IP,&nbsp;UDP,&nbsp;domain&nbsp;name&nbsp;resolution,&nbsp;and&nbsp;Unix&nbsp;domain&nbsp;sockets.<br>
<span class="lineno"></span><br>
<span class="lineno"></span>Although&nbsp;the&nbsp;package&nbsp;provides&nbsp;access&nbsp;to&nbsp;low-level&nbsp;networking<br>
<span class="lineno">10</span>primitives,&nbsp;most&nbsp;clients&nbsp;will&nbsp;need&nbsp;only&nbsp;the&nbsp;basic&nbsp;interface&nbsp;provided<br>
<span class="lineno"></span>by&nbsp;the&nbsp;Dial,&nbsp;Listen,&nbsp;and&nbsp;Accept&nbsp;functions&nbsp;and&nbsp;the&nbsp;associated<br>
<span class="lineno"></span>Conn&nbsp;and&nbsp;Listener&nbsp;interfaces.&nbsp;The&nbsp;crypto/tls&nbsp;package&nbsp;uses<br>
<span class="lineno"></span>the&nbsp;same&nbsp;interfaces&nbsp;and&nbsp;similar&nbsp;Dial&nbsp;and&nbsp;Listen&nbsp;functions.<br>
<span class="lineno"></span><br>
<span class="lineno">15</span>The&nbsp;Dial&nbsp;function&nbsp;connects&nbsp;to&nbsp;a&nbsp;server:<br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;conn,&nbsp;err&nbsp;:=&nbsp;net.Dial(&#34;tcp&#34;,&nbsp;&#34;google.com:80&#34;)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;handle&nbsp;error<br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;fmt.Fprintf(conn,&nbsp;&#34;GET&nbsp;/&nbsp;HTTP/1.0\r\n\r\n&#34;)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;status,&nbsp;err&nbsp;:=&nbsp;bufio.NewReader(conn).ReadString(&#39;\n&#39;)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;...<br>
<span class="lineno"></span><br>
<span class="lineno">25</span>The&nbsp;Listen&nbsp;function&nbsp;creates&nbsp;servers:<br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;ln,&nbsp;err&nbsp;:=&nbsp;net.Listen(&#34;tcp&#34;,&nbsp;&#34;:8080&#34;)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;handle&nbsp;error<br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;conn,&nbsp;err&nbsp;:=&nbsp;ln.Accept()<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;handle&nbsp;error<br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;go&nbsp;handleConnection(conn)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno"></span><span class="keyword" id="3140156">package</span>&nbsp;<span class="ident" id="3140164">net</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="3140169">//&nbsp;TODO(rsc):</span><br>
<span class="lineno"></span><span class="comment" id="3140183">//&nbsp;&nbsp;&nbsp;&nbsp;support&nbsp;for&nbsp;raw&nbsp;ethernet&nbsp;sockets</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3140220">import</span>&nbsp;<span class="op" id="3140227">(</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3140230">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3140240">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3140246">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3140252">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3140263">&#34;time&#34;</span><br>
<span class="lineno">50</span><span class="op" id="3140270">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3140273">//&nbsp;Addr&nbsp;represents&nbsp;a&nbsp;network&nbsp;end&nbsp;point&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3140321">type</span>&nbsp;<span class="ident" id="3140326">Addr</span>&nbsp;<span class="keyword" id="3140331">interface</span>&nbsp;<span class="op" id="3140341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3140344">Network</span><span class="op" id="3140351">(</span><span class="op" id="3140352">)</span>&nbsp;<span class="builtintype" id="3140354">string</span>&nbsp;<span class="comment" id="3140361">//&nbsp;name&nbsp;of&nbsp;the&nbsp;network</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3140385">String</span><span class="op" id="3140391">(</span><span class="op" id="3140392">)</span>&nbsp;<span class="builtintype" id="3140394">string</span>&nbsp;&nbsp;<span class="comment" id="3140402">//&nbsp;string&nbsp;form&nbsp;of&nbsp;address</span><br>
<span class="lineno"></span><span class="op" id="3140428">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3140431">//&nbsp;Conn&nbsp;is&nbsp;a&nbsp;generic&nbsp;stream-oriented&nbsp;network&nbsp;connection.</span><br>
<span class="lineno"></span><span class="comment" id="3140488">//</span><br>
<span class="lineno">60</span><span class="comment" id="3140491">//&nbsp;Multiple&nbsp;goroutines&nbsp;may&nbsp;invoke&nbsp;methods&nbsp;on&nbsp;a&nbsp;Conn&nbsp;simultaneously.</span><br>
<span class="lineno"></span><span class="keyword" id="3140559">type</span>&nbsp;<span class="ident" id="3140564">Conn</span>&nbsp;<span class="keyword" id="3140569">interface</span>&nbsp;<span class="op" id="3140579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3140582">//&nbsp;Read&nbsp;reads&nbsp;data&nbsp;from&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3140623">//&nbsp;Read&nbsp;can&nbsp;be&nbsp;made&nbsp;to&nbsp;time&nbsp;out&nbsp;and&nbsp;return&nbsp;a&nbsp;Error&nbsp;with&nbsp;Timeout()&nbsp;==&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3140698">//&nbsp;after&nbsp;a&nbsp;fixed&nbsp;time&nbsp;limit;&nbsp;see&nbsp;SetDeadline&nbsp;and&nbsp;SetReadDeadline.</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3140765">Read</span><span class="op" id="3140769">(</span><span class="ident" id="3140770">b</span>&nbsp;<span class="op" id="3140772">[</span><span class="op" id="3140773">]</span><span class="builtintype" id="3140774">byte</span><span class="op" id="3140778">)</span>&nbsp;<span class="op" id="3140780">(</span><span class="ident" id="3140781">n</span>&nbsp;<span class="builtintype" id="3140783">int</span><span class="op" id="3140786">,</span>&nbsp;<span class="ident" id="3140788">err</span>&nbsp;<span class="builtintype" id="3140792">error</span><span class="op" id="3140797">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3140801">//&nbsp;Write&nbsp;writes&nbsp;data&nbsp;to&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3140842">//&nbsp;Write&nbsp;can&nbsp;be&nbsp;made&nbsp;to&nbsp;time&nbsp;out&nbsp;and&nbsp;return&nbsp;a&nbsp;Error&nbsp;with&nbsp;Timeout()&nbsp;==&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3140918">//&nbsp;after&nbsp;a&nbsp;fixed&nbsp;time&nbsp;limit;&nbsp;see&nbsp;SetDeadline&nbsp;and&nbsp;SetWriteDeadline.</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3140986">Write</span><span class="op" id="3140991">(</span><span class="ident" id="3140992">b</span>&nbsp;<span class="op" id="3140994">[</span><span class="op" id="3140995">]</span><span class="builtintype" id="3140996">byte</span><span class="op" id="3141000">)</span>&nbsp;<span class="op" id="3141002">(</span><span class="ident" id="3141003">n</span>&nbsp;<span class="builtintype" id="3141005">int</span><span class="op" id="3141008">,</span>&nbsp;<span class="ident" id="3141010">err</span>&nbsp;<span class="builtintype" id="3141014">error</span><span class="op" id="3141019">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3141023">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3141056">//&nbsp;Any&nbsp;blocked&nbsp;Read&nbsp;or&nbsp;Write&nbsp;operations&nbsp;will&nbsp;be&nbsp;unblocked&nbsp;and&nbsp;return&nbsp;errors.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3141134">Close</span><span class="op" id="3141139">(</span><span class="op" id="3141140">)</span>&nbsp;<span class="builtintype" id="3141142">error</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3141150">//&nbsp;LocalAddr&nbsp;returns&nbsp;the&nbsp;local&nbsp;network&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3141199">LocalAddr</span><span class="op" id="3141208">(</span><span class="op" id="3141209">)</span>&nbsp;<span class="ident" id="3141211">Addr</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3141218">//&nbsp;RemoteAddr&nbsp;returns&nbsp;the&nbsp;remote&nbsp;network&nbsp;address.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3141269">RemoteAddr</span><span class="op" id="3141279">(</span><span class="op" id="3141280">)</span>&nbsp;<span class="ident" id="3141282">Addr</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3141289">//&nbsp;SetDeadline&nbsp;sets&nbsp;the&nbsp;read&nbsp;and&nbsp;write&nbsp;deadlines&nbsp;associated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3141350">//&nbsp;with&nbsp;the&nbsp;connection.&nbsp;It&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;calling&nbsp;both</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3141408">//&nbsp;SetReadDeadline&nbsp;and&nbsp;SetWriteDeadline.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3141450">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3141454">//&nbsp;A&nbsp;deadline&nbsp;is&nbsp;an&nbsp;absolute&nbsp;time&nbsp;after&nbsp;which&nbsp;I/O&nbsp;operations</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3141516">//&nbsp;fail&nbsp;with&nbsp;a&nbsp;timeout&nbsp;(see&nbsp;type&nbsp;Error)&nbsp;instead&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3141568">//&nbsp;blocking.&nbsp;The&nbsp;deadline&nbsp;applies&nbsp;to&nbsp;all&nbsp;future&nbsp;I/O,&nbsp;not&nbsp;just</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3141631">//&nbsp;the&nbsp;immediately&nbsp;following&nbsp;call&nbsp;to&nbsp;Read&nbsp;or&nbsp;Write.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3141684">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3141688">//&nbsp;An&nbsp;idle&nbsp;timeout&nbsp;can&nbsp;be&nbsp;implemented&nbsp;by&nbsp;repeatedly&nbsp;extending</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3141751">//&nbsp;the&nbsp;deadline&nbsp;after&nbsp;successful&nbsp;Read&nbsp;or&nbsp;Write&nbsp;calls.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3141806">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3141810">//&nbsp;A&nbsp;zero&nbsp;value&nbsp;for&nbsp;t&nbsp;means&nbsp;I/O&nbsp;operations&nbsp;will&nbsp;not&nbsp;time&nbsp;out.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3141873">SetDeadline</span><span class="op" id="3141884">(</span><span class="ident" id="3141885">t</span>&nbsp;<span class="ident" id="3141887">time</span><span class="op" id="3141891">.</span><span class="ident" id="3141892">Time</span><span class="op" id="3141896">)</span>&nbsp;<span class="builtintype" id="3141898">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3141906">//&nbsp;SetReadDeadline&nbsp;sets&nbsp;the&nbsp;deadline&nbsp;for&nbsp;future&nbsp;Read&nbsp;calls.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3141967">//&nbsp;A&nbsp;zero&nbsp;value&nbsp;for&nbsp;t&nbsp;means&nbsp;Read&nbsp;will&nbsp;not&nbsp;time&nbsp;out.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3142020">SetReadDeadline</span><span class="op" id="3142035">(</span><span class="ident" id="3142036">t</span>&nbsp;<span class="ident" id="3142038">time</span><span class="op" id="3142042">.</span><span class="ident" id="3142043">Time</span><span class="op" id="3142047">)</span>&nbsp;<span class="builtintype" id="3142049">error</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3142057">//&nbsp;SetWriteDeadline&nbsp;sets&nbsp;the&nbsp;deadline&nbsp;for&nbsp;future&nbsp;Write&nbsp;calls.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3142120">//&nbsp;Even&nbsp;if&nbsp;write&nbsp;times&nbsp;out,&nbsp;it&nbsp;may&nbsp;return&nbsp;n&nbsp;&gt;&nbsp;0,&nbsp;indicating&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3142186">//&nbsp;some&nbsp;of&nbsp;the&nbsp;data&nbsp;was&nbsp;successfully&nbsp;written.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3142233">//&nbsp;A&nbsp;zero&nbsp;value&nbsp;for&nbsp;t&nbsp;means&nbsp;Write&nbsp;will&nbsp;not&nbsp;time&nbsp;out.</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3142287">SetWriteDeadline</span><span class="op" id="3142303">(</span><span class="ident" id="3142304">t</span>&nbsp;<span class="ident" id="3142306">time</span><span class="op" id="3142310">.</span><span class="ident" id="3142311">Time</span><span class="op" id="3142315">)</span>&nbsp;<span class="builtintype" id="3142317">error</span><br>
<span class="lineno"></span><span class="op" id="3142323">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3142326">type</span>&nbsp;<span class="ident" id="3142331">conn</span>&nbsp;<span class="keyword" id="3142336">struct</span>&nbsp;<span class="op" id="3142343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3142346">fd</span>&nbsp;<span class="op" id="3142349">*</span><span class="ident" id="3142350">netFD</span><br>
<span class="lineno">110</span><span class="op" id="3142356">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3142359">func</span>&nbsp;<span class="op" id="3142364">(</span><span class="ident" id="3142365">c</span>&nbsp;<span class="op" id="3142367">*</span><span class="ident" id="3142368">conn</span><span class="op" id="3142372">)</span>&nbsp;<span class="ident" id="3142374">ok</span><span class="op" id="3142376">(</span><span class="op" id="3142377">)</span>&nbsp;<span class="builtintype" id="3142379">bool</span>&nbsp;<span class="op" id="3142384">{</span>&nbsp;<span class="keyword" id="3142386">return</span>&nbsp;<span class="ident" id="3142393">c</span>&nbsp;<span class="op" id="3142395">!=</span>&nbsp;<span class="ident" id="3142398">nil</span>&nbsp;<span class="op" id="3142402">&amp;&amp;</span>&nbsp;<span class="ident" id="3142405">c</span><span class="op" id="3142406">.</span><span class="ident" id="3142407">fd</span>&nbsp;<span class="op" id="3142410">!=</span>&nbsp;<span class="ident" id="3142413">nil</span>&nbsp;<span class="op" id="3142417">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3142420">//&nbsp;Implementation&nbsp;of&nbsp;the&nbsp;Conn&nbsp;interface.</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="comment" id="3142462">//&nbsp;Read&nbsp;implements&nbsp;the&nbsp;Conn&nbsp;Read&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="3142503">func</span>&nbsp;<span class="op" id="3142508">(</span><span class="ident" id="3142509">c</span>&nbsp;<span class="op" id="3142511">*</span><span class="ident" id="3142512">conn</span><span class="op" id="3142516">)</span>&nbsp;<span class="ident" id="3142518">Read</span><span class="op" id="3142522">(</span><span class="ident" id="3142523">b</span>&nbsp;<span class="op" id="3142525">[</span><span class="op" id="3142526">]</span><span class="builtintype" id="3142527">byte</span><span class="op" id="3142531">)</span>&nbsp;<span class="op" id="3142533">(</span><span class="builtintype" id="3142534">int</span><span class="op" id="3142537">,</span>&nbsp;<span class="builtintype" id="3142539">error</span><span class="op" id="3142544">)</span>&nbsp;<span class="op" id="3142546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3142549">if</span>&nbsp;<span class="op" id="3142552">!</span><span class="ident" id="3142553">c</span><span class="op" id="3142554">.</span><span class="ident" id="3142555">ok</span><span class="op" id="3142557">(</span><span class="op" id="3142558">)</span>&nbsp;<span class="op" id="3142560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3142564">return</span>&nbsp;<span class="num" id="3142571">0</span><span class="op" id="3142572">,</span>&nbsp;<span class="ident" id="3142574">syscall</span><span class="op" id="3142581">.</span><span class="ident" id="3142582">EINVAL</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3142590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3142593">return</span>&nbsp;<span class="ident" id="3142600">c</span><span class="op" id="3142601">.</span><span class="ident" id="3142602">fd</span><span class="op" id="3142604">.</span><span class="ident" id="3142605">Read</span><span class="op" id="3142609">(</span><span class="ident" id="3142610">b</span><span class="op" id="3142611">)</span><br>
<span class="lineno"></span><span class="op" id="3142613">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3142616">//&nbsp;Write&nbsp;implements&nbsp;the&nbsp;Conn&nbsp;Write&nbsp;method.</span><br>
<span class="lineno">125</span><span class="keyword" id="3142659">func</span>&nbsp;<span class="op" id="3142664">(</span><span class="ident" id="3142665">c</span>&nbsp;<span class="op" id="3142667">*</span><span class="ident" id="3142668">conn</span><span class="op" id="3142672">)</span>&nbsp;<span class="ident" id="3142674">Write</span><span class="op" id="3142679">(</span><span class="ident" id="3142680">b</span>&nbsp;<span class="op" id="3142682">[</span><span class="op" id="3142683">]</span><span class="builtintype" id="3142684">byte</span><span class="op" id="3142688">)</span>&nbsp;<span class="op" id="3142690">(</span><span class="builtintype" id="3142691">int</span><span class="op" id="3142694">,</span>&nbsp;<span class="builtintype" id="3142696">error</span><span class="op" id="3142701">)</span>&nbsp;<span class="op" id="3142703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3142706">if</span>&nbsp;<span class="op" id="3142709">!</span><span class="ident" id="3142710">c</span><span class="op" id="3142711">.</span><span class="ident" id="3142712">ok</span><span class="op" id="3142714">(</span><span class="op" id="3142715">)</span>&nbsp;<span class="op" id="3142717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3142721">return</span>&nbsp;<span class="num" id="3142728">0</span><span class="op" id="3142729">,</span>&nbsp;<span class="ident" id="3142731">syscall</span><span class="op" id="3142738">.</span><span class="ident" id="3142739">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3142747">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3142750">return</span>&nbsp;<span class="ident" id="3142757">c</span><span class="op" id="3142758">.</span><span class="ident" id="3142759">fd</span><span class="op" id="3142761">.</span><span class="ident" id="3142762">Write</span><span class="op" id="3142767">(</span><span class="ident" id="3142768">b</span><span class="op" id="3142769">)</span><br>
<span class="lineno">130</span><span class="op" id="3142771">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3142774">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="3142806">func</span>&nbsp;<span class="op" id="3142811">(</span><span class="ident" id="3142812">c</span>&nbsp;<span class="op" id="3142814">*</span><span class="ident" id="3142815">conn</span><span class="op" id="3142819">)</span>&nbsp;<span class="ident" id="3142821">Close</span><span class="op" id="3142826">(</span><span class="op" id="3142827">)</span>&nbsp;<span class="builtintype" id="3142829">error</span>&nbsp;<span class="op" id="3142835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3142838">if</span>&nbsp;<span class="op" id="3142841">!</span><span class="ident" id="3142842">c</span><span class="op" id="3142843">.</span><span class="ident" id="3142844">ok</span><span class="op" id="3142846">(</span><span class="op" id="3142847">)</span>&nbsp;<span class="op" id="3142849">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3142853">return</span>&nbsp;<span class="ident" id="3142860">syscall</span><span class="op" id="3142867">.</span><span class="ident" id="3142868">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3142876">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3142879">return</span>&nbsp;<span class="ident" id="3142886">c</span><span class="op" id="3142887">.</span><span class="ident" id="3142888">fd</span><span class="op" id="3142890">.</span><span class="ident" id="3142891">Close</span><span class="op" id="3142896">(</span><span class="op" id="3142897">)</span><br>
<span class="lineno"></span><span class="op" id="3142899">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="comment" id="3142902">//&nbsp;LocalAddr&nbsp;returns&nbsp;the&nbsp;local&nbsp;network&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3142950">func</span>&nbsp;<span class="op" id="3142955">(</span><span class="ident" id="3142956">c</span>&nbsp;<span class="op" id="3142958">*</span><span class="ident" id="3142959">conn</span><span class="op" id="3142963">)</span>&nbsp;<span class="ident" id="3142965">LocalAddr</span><span class="op" id="3142974">(</span><span class="op" id="3142975">)</span>&nbsp;<span class="ident" id="3142977">Addr</span>&nbsp;<span class="op" id="3142982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3142985">if</span>&nbsp;<span class="op" id="3142988">!</span><span class="ident" id="3142989">c</span><span class="op" id="3142990">.</span><span class="ident" id="3142991">ok</span><span class="op" id="3142993">(</span><span class="op" id="3142994">)</span>&nbsp;<span class="op" id="3142996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3143000">return</span>&nbsp;<span class="ident" id="3143007">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3143012">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3143015">return</span>&nbsp;<span class="ident" id="3143022">c</span><span class="op" id="3143023">.</span><span class="ident" id="3143024">fd</span><span class="op" id="3143026">.</span><span class="ident" id="3143027">laddr</span><br>
<span class="lineno"></span><span class="op" id="3143033">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3143036">//&nbsp;RemoteAddr&nbsp;returns&nbsp;the&nbsp;remote&nbsp;network&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3143086">func</span>&nbsp;<span class="op" id="3143091">(</span><span class="ident" id="3143092">c</span>&nbsp;<span class="op" id="3143094">*</span><span class="ident" id="3143095">conn</span><span class="op" id="3143099">)</span>&nbsp;<span class="ident" id="3143101">RemoteAddr</span><span class="op" id="3143111">(</span><span class="op" id="3143112">)</span>&nbsp;<span class="ident" id="3143114">Addr</span>&nbsp;<span class="op" id="3143119">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3143122">if</span>&nbsp;<span class="op" id="3143125">!</span><span class="ident" id="3143126">c</span><span class="op" id="3143127">.</span><span class="ident" id="3143128">ok</span><span class="op" id="3143130">(</span><span class="op" id="3143131">)</span>&nbsp;<span class="op" id="3143133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3143137">return</span>&nbsp;<span class="ident" id="3143144">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3143149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3143152">return</span>&nbsp;<span class="ident" id="3143159">c</span><span class="op" id="3143160">.</span><span class="ident" id="3143161">fd</span><span class="op" id="3143163">.</span><span class="ident" id="3143164">raddr</span><br>
<span class="lineno"></span><span class="op" id="3143170">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="3143173">//&nbsp;SetDeadline&nbsp;implements&nbsp;the&nbsp;Conn&nbsp;SetDeadline&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="3143228">func</span>&nbsp;<span class="op" id="3143233">(</span><span class="ident" id="3143234">c</span>&nbsp;<span class="op" id="3143236">*</span><span class="ident" id="3143237">conn</span><span class="op" id="3143241">)</span>&nbsp;<span class="ident" id="3143243">SetDeadline</span><span class="op" id="3143254">(</span><span class="ident" id="3143255">t</span>&nbsp;<span class="ident" id="3143257">time</span><span class="op" id="3143261">.</span><span class="ident" id="3143262">Time</span><span class="op" id="3143266">)</span>&nbsp;<span class="builtintype" id="3143268">error</span>&nbsp;<span class="op" id="3143274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3143277">if</span>&nbsp;<span class="op" id="3143280">!</span><span class="ident" id="3143281">c</span><span class="op" id="3143282">.</span><span class="ident" id="3143283">ok</span><span class="op" id="3143285">(</span><span class="op" id="3143286">)</span>&nbsp;<span class="op" id="3143288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3143292">return</span>&nbsp;<span class="ident" id="3143299">syscall</span><span class="op" id="3143306">.</span><span class="ident" id="3143307">EINVAL</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3143315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3143318">return</span>&nbsp;<span class="ident" id="3143325">c</span><span class="op" id="3143326">.</span><span class="ident" id="3143327">fd</span><span class="op" id="3143329">.</span><span class="ident" id="3143330">setDeadline</span><span class="op" id="3143341">(</span><span class="ident" id="3143342">t</span><span class="op" id="3143343">)</span><br>
<span class="lineno"></span><span class="op" id="3143345">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3143348">//&nbsp;SetReadDeadline&nbsp;implements&nbsp;the&nbsp;Conn&nbsp;SetReadDeadline&nbsp;method.</span><br>
<span class="lineno">165</span><span class="keyword" id="3143411">func</span>&nbsp;<span class="op" id="3143416">(</span><span class="ident" id="3143417">c</span>&nbsp;<span class="op" id="3143419">*</span><span class="ident" id="3143420">conn</span><span class="op" id="3143424">)</span>&nbsp;<span class="ident" id="3143426">SetReadDeadline</span><span class="op" id="3143441">(</span><span class="ident" id="3143442">t</span>&nbsp;<span class="ident" id="3143444">time</span><span class="op" id="3143448">.</span><span class="ident" id="3143449">Time</span><span class="op" id="3143453">)</span>&nbsp;<span class="builtintype" id="3143455">error</span>&nbsp;<span class="op" id="3143461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3143464">if</span>&nbsp;<span class="op" id="3143467">!</span><span class="ident" id="3143468">c</span><span class="op" id="3143469">.</span><span class="ident" id="3143470">ok</span><span class="op" id="3143472">(</span><span class="op" id="3143473">)</span>&nbsp;<span class="op" id="3143475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3143479">return</span>&nbsp;<span class="ident" id="3143486">syscall</span><span class="op" id="3143493">.</span><span class="ident" id="3143494">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3143502">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3143505">return</span>&nbsp;<span class="ident" id="3143512">c</span><span class="op" id="3143513">.</span><span class="ident" id="3143514">fd</span><span class="op" id="3143516">.</span><span class="ident" id="3143517">setReadDeadline</span><span class="op" id="3143532">(</span><span class="ident" id="3143533">t</span><span class="op" id="3143534">)</span><br>
<span class="lineno">170</span><span class="op" id="3143536">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3143539">//&nbsp;SetWriteDeadline&nbsp;implements&nbsp;the&nbsp;Conn&nbsp;SetWriteDeadline&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="3143604">func</span>&nbsp;<span class="op" id="3143609">(</span><span class="ident" id="3143610">c</span>&nbsp;<span class="op" id="3143612">*</span><span class="ident" id="3143613">conn</span><span class="op" id="3143617">)</span>&nbsp;<span class="ident" id="3143619">SetWriteDeadline</span><span class="op" id="3143635">(</span><span class="ident" id="3143636">t</span>&nbsp;<span class="ident" id="3143638">time</span><span class="op" id="3143642">.</span><span class="ident" id="3143643">Time</span><span class="op" id="3143647">)</span>&nbsp;<span class="builtintype" id="3143649">error</span>&nbsp;<span class="op" id="3143655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3143658">if</span>&nbsp;<span class="op" id="3143661">!</span><span class="ident" id="3143662">c</span><span class="op" id="3143663">.</span><span class="ident" id="3143664">ok</span><span class="op" id="3143666">(</span><span class="op" id="3143667">)</span>&nbsp;<span class="op" id="3143669">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3143673">return</span>&nbsp;<span class="ident" id="3143680">syscall</span><span class="op" id="3143687">.</span><span class="ident" id="3143688">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3143696">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3143699">return</span>&nbsp;<span class="ident" id="3143706">c</span><span class="op" id="3143707">.</span><span class="ident" id="3143708">fd</span><span class="op" id="3143710">.</span><span class="ident" id="3143711">setWriteDeadline</span><span class="op" id="3143727">(</span><span class="ident" id="3143728">t</span><span class="op" id="3143729">)</span><br>
<span class="lineno"></span><span class="op" id="3143731">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="comment" id="3143734">//&nbsp;SetReadBuffer&nbsp;sets&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;operating&nbsp;system&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="3143791">//&nbsp;receive&nbsp;buffer&nbsp;associated&nbsp;with&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="3143841">func</span>&nbsp;<span class="op" id="3143846">(</span><span class="ident" id="3143847">c</span>&nbsp;<span class="op" id="3143849">*</span><span class="ident" id="3143850">conn</span><span class="op" id="3143854">)</span>&nbsp;<span class="ident" id="3143856">SetReadBuffer</span><span class="op" id="3143869">(</span><span class="ident" id="3143870">bytes</span>&nbsp;<span class="builtintype" id="3143876">int</span><span class="op" id="3143879">)</span>&nbsp;<span class="builtintype" id="3143881">error</span>&nbsp;<span class="op" id="3143887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3143890">if</span>&nbsp;<span class="op" id="3143893">!</span><span class="ident" id="3143894">c</span><span class="op" id="3143895">.</span><span class="ident" id="3143896">ok</span><span class="op" id="3143898">(</span><span class="op" id="3143899">)</span>&nbsp;<span class="op" id="3143901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3143905">return</span>&nbsp;<span class="ident" id="3143912">syscall</span><span class="op" id="3143919">.</span><span class="ident" id="3143920">EINVAL</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3143928">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3143931">return</span>&nbsp;<span class="ident" id="3143938">setReadBuffer</span><span class="op" id="3143951">(</span><span class="ident" id="3143952">c</span><span class="op" id="3143953">.</span><span class="ident" id="3143954">fd</span><span class="op" id="3143956">,</span>&nbsp;<span class="ident" id="3143958">bytes</span><span class="op" id="3143963">)</span><br>
<span class="lineno"></span><span class="op" id="3143965">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3143968">//&nbsp;SetWriteBuffer&nbsp;sets&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;operating&nbsp;system&#39;s</span><br>
<span class="lineno">190</span><span class="comment" id="3144026">//&nbsp;transmit&nbsp;buffer&nbsp;associated&nbsp;with&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="3144077">func</span>&nbsp;<span class="op" id="3144082">(</span><span class="ident" id="3144083">c</span>&nbsp;<span class="op" id="3144085">*</span><span class="ident" id="3144086">conn</span><span class="op" id="3144090">)</span>&nbsp;<span class="ident" id="3144092">SetWriteBuffer</span><span class="op" id="3144106">(</span><span class="ident" id="3144107">bytes</span>&nbsp;<span class="builtintype" id="3144113">int</span><span class="op" id="3144116">)</span>&nbsp;<span class="builtintype" id="3144118">error</span>&nbsp;<span class="op" id="3144124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3144127">if</span>&nbsp;<span class="op" id="3144130">!</span><span class="ident" id="3144131">c</span><span class="op" id="3144132">.</span><span class="ident" id="3144133">ok</span><span class="op" id="3144135">(</span><span class="op" id="3144136">)</span>&nbsp;<span class="op" id="3144138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3144142">return</span>&nbsp;<span class="ident" id="3144149">syscall</span><span class="op" id="3144156">.</span><span class="ident" id="3144157">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3144165">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3144168">return</span>&nbsp;<span class="ident" id="3144175">setWriteBuffer</span><span class="op" id="3144189">(</span><span class="ident" id="3144190">c</span><span class="op" id="3144191">.</span><span class="ident" id="3144192">fd</span><span class="op" id="3144194">,</span>&nbsp;<span class="ident" id="3144196">bytes</span><span class="op" id="3144201">)</span><br>
<span class="lineno"></span><span class="op" id="3144203">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3144206">//&nbsp;File&nbsp;sets&nbsp;the&nbsp;underlying&nbsp;os.File&nbsp;to&nbsp;blocking&nbsp;mode&nbsp;and&nbsp;returns&nbsp;a&nbsp;copy.</span><br>
<span class="lineno"></span><span class="comment" id="3144279">//&nbsp;It&nbsp;is&nbsp;the&nbsp;caller&#39;s&nbsp;responsibility&nbsp;to&nbsp;close&nbsp;f&nbsp;when&nbsp;finished.</span><br>
<span class="lineno">200</span><span class="comment" id="3144342">//&nbsp;Closing&nbsp;c&nbsp;does&nbsp;not&nbsp;affect&nbsp;f,&nbsp;and&nbsp;closing&nbsp;f&nbsp;does&nbsp;not&nbsp;affect&nbsp;c.</span><br>
<span class="lineno"></span><span class="comment" id="3144407">//</span><br>
<span class="lineno"></span><span class="comment" id="3144410">//&nbsp;The&nbsp;returned&nbsp;os.File&#39;s&nbsp;file&nbsp;descriptor&nbsp;is&nbsp;different&nbsp;from&nbsp;the&nbsp;connection&#39;s.</span><br>
<span class="lineno"></span><span class="comment" id="3144488">//&nbsp;Attempting&nbsp;to&nbsp;change&nbsp;properties&nbsp;of&nbsp;the&nbsp;original&nbsp;using&nbsp;this&nbsp;duplicate</span><br>
<span class="lineno"></span><span class="comment" id="3144560">//&nbsp;may&nbsp;or&nbsp;may&nbsp;not&nbsp;have&nbsp;the&nbsp;desired&nbsp;effect.</span><br>
<span class="lineno">205</span><span class="keyword" id="3144603">func</span>&nbsp;<span class="op" id="3144608">(</span><span class="ident" id="3144609">c</span>&nbsp;<span class="op" id="3144611">*</span><span class="ident" id="3144612">conn</span><span class="op" id="3144616">)</span>&nbsp;<span class="ident" id="3144618">File</span><span class="op" id="3144622">(</span><span class="op" id="3144623">)</span>&nbsp;<span class="op" id="3144625">(</span><span class="ident" id="3144626">f</span>&nbsp;<span class="op" id="3144628">*</span><span class="ident" id="3144629">os</span><span class="op" id="3144631">.</span><span class="ident" id="3144632">File</span><span class="op" id="3144636">,</span>&nbsp;<span class="ident" id="3144638">err</span>&nbsp;<span class="builtintype" id="3144642">error</span><span class="op" id="3144647">)</span>&nbsp;<span class="op" id="3144649">{</span>&nbsp;<span class="keyword" id="3144651">return</span>&nbsp;<span class="ident" id="3144658">c</span><span class="op" id="3144659">.</span><span class="ident" id="3144660">fd</span><span class="op" id="3144662">.</span><span class="ident" id="3144663">dup</span><span class="op" id="3144666">(</span><span class="op" id="3144667">)</span>&nbsp;<span class="op" id="3144669">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3144672">//&nbsp;An&nbsp;Error&nbsp;represents&nbsp;a&nbsp;network&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="3144712">type</span>&nbsp;<span class="ident" id="3144717">Error</span>&nbsp;<span class="keyword" id="3144723">interface</span>&nbsp;<span class="op" id="3144733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3144736">error</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3144743">Timeout</span><span class="op" id="3144750">(</span><span class="op" id="3144751">)</span>&nbsp;<span class="builtintype" id="3144753">bool</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3144760">//&nbsp;Is&nbsp;the&nbsp;error&nbsp;a&nbsp;timeout?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3144788">Temporary</span><span class="op" id="3144797">(</span><span class="op" id="3144798">)</span>&nbsp;<span class="builtintype" id="3144800">bool</span>&nbsp;<span class="comment" id="3144805">//&nbsp;Is&nbsp;the&nbsp;error&nbsp;temporary?</span><br>
<span class="lineno"></span><span class="op" id="3144832">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3144835">//&nbsp;PacketConn&nbsp;is&nbsp;a&nbsp;generic&nbsp;packet-oriented&nbsp;network&nbsp;connection.</span><br>
<span class="lineno">215</span><span class="comment" id="3144898">//</span><br>
<span class="lineno"></span><span class="comment" id="3144901">//&nbsp;Multiple&nbsp;goroutines&nbsp;may&nbsp;invoke&nbsp;methods&nbsp;on&nbsp;a&nbsp;PacketConn&nbsp;simultaneously.</span><br>
<span class="lineno"></span><span class="keyword" id="3144975">type</span>&nbsp;<span class="ident" id="3144980">PacketConn</span>&nbsp;<span class="keyword" id="3144991">interface</span>&nbsp;<span class="op" id="3145001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3145004">//&nbsp;ReadFrom&nbsp;reads&nbsp;a&nbsp;packet&nbsp;from&nbsp;the&nbsp;connection,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3145053">//&nbsp;copying&nbsp;the&nbsp;payload&nbsp;into&nbsp;b.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3145111">//&nbsp;bytes&nbsp;copied&nbsp;into&nbsp;b&nbsp;and&nbsp;the&nbsp;return&nbsp;address&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3145163">//&nbsp;was&nbsp;on&nbsp;the&nbsp;packet.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3145186">//&nbsp;ReadFrom&nbsp;can&nbsp;be&nbsp;made&nbsp;to&nbsp;time&nbsp;out&nbsp;and&nbsp;return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3145234">//&nbsp;an&nbsp;error&nbsp;with&nbsp;Timeout()&nbsp;==&nbsp;true&nbsp;after&nbsp;a&nbsp;fixed&nbsp;time&nbsp;limit;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3145296">//&nbsp;see&nbsp;SetDeadline&nbsp;and&nbsp;SetReadDeadline.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3145337">ReadFrom</span><span class="op" id="3145345">(</span><span class="ident" id="3145346">b</span>&nbsp;<span class="op" id="3145348">[</span><span class="op" id="3145349">]</span><span class="builtintype" id="3145350">byte</span><span class="op" id="3145354">)</span>&nbsp;<span class="op" id="3145356">(</span><span class="ident" id="3145357">n</span>&nbsp;<span class="builtintype" id="3145359">int</span><span class="op" id="3145362">,</span>&nbsp;<span class="ident" id="3145364">addr</span>&nbsp;<span class="ident" id="3145369">Addr</span><span class="op" id="3145373">,</span>&nbsp;<span class="ident" id="3145375">err</span>&nbsp;<span class="builtintype" id="3145379">error</span><span class="op" id="3145384">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3145388">//&nbsp;WriteTo&nbsp;writes&nbsp;a&nbsp;packet&nbsp;with&nbsp;payload&nbsp;b&nbsp;to&nbsp;addr.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3145440">//&nbsp;WriteTo&nbsp;can&nbsp;be&nbsp;made&nbsp;to&nbsp;time&nbsp;out&nbsp;and&nbsp;return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3145487">//&nbsp;an&nbsp;error&nbsp;with&nbsp;Timeout()&nbsp;==&nbsp;true&nbsp;after&nbsp;a&nbsp;fixed&nbsp;time&nbsp;limit;</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3145549">//&nbsp;see&nbsp;SetDeadline&nbsp;and&nbsp;SetWriteDeadline.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3145591">//&nbsp;On&nbsp;packet-oriented&nbsp;connections,&nbsp;write&nbsp;timeouts&nbsp;are&nbsp;rare.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3145652">WriteTo</span><span class="op" id="3145659">(</span><span class="ident" id="3145660">b</span>&nbsp;<span class="op" id="3145662">[</span><span class="op" id="3145663">]</span><span class="builtintype" id="3145664">byte</span><span class="op" id="3145668">,</span>&nbsp;<span class="ident" id="3145670">addr</span>&nbsp;<span class="ident" id="3145675">Addr</span><span class="op" id="3145679">)</span>&nbsp;<span class="op" id="3145681">(</span><span class="ident" id="3145682">n</span>&nbsp;<span class="builtintype" id="3145684">int</span><span class="op" id="3145687">,</span>&nbsp;<span class="ident" id="3145689">err</span>&nbsp;<span class="builtintype" id="3145693">error</span><span class="op" id="3145698">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3145702">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;connection.</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3145735">//&nbsp;Any&nbsp;blocked&nbsp;ReadFrom&nbsp;or&nbsp;WriteTo&nbsp;operations&nbsp;will&nbsp;be&nbsp;unblocked&nbsp;and&nbsp;return&nbsp;errors.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3145819">Close</span><span class="op" id="3145824">(</span><span class="op" id="3145825">)</span>&nbsp;<span class="builtintype" id="3145827">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3145835">//&nbsp;LocalAddr&nbsp;returns&nbsp;the&nbsp;local&nbsp;network&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3145884">LocalAddr</span><span class="op" id="3145893">(</span><span class="op" id="3145894">)</span>&nbsp;<span class="ident" id="3145896">Addr</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3145903">//&nbsp;SetDeadline&nbsp;sets&nbsp;the&nbsp;read&nbsp;and&nbsp;write&nbsp;deadlines&nbsp;associated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3145964">//&nbsp;with&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3145989">SetDeadline</span><span class="op" id="3146000">(</span><span class="ident" id="3146001">t</span>&nbsp;<span class="ident" id="3146003">time</span><span class="op" id="3146007">.</span><span class="ident" id="3146008">Time</span><span class="op" id="3146012">)</span>&nbsp;<span class="builtintype" id="3146014">error</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3146022">//&nbsp;SetReadDeadline&nbsp;sets&nbsp;the&nbsp;deadline&nbsp;for&nbsp;future&nbsp;Read&nbsp;calls.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3146083">//&nbsp;If&nbsp;the&nbsp;deadline&nbsp;is&nbsp;reached,&nbsp;Read&nbsp;will&nbsp;fail&nbsp;with&nbsp;a&nbsp;timeout</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3146145">//&nbsp;(see&nbsp;type&nbsp;Error)&nbsp;instead&nbsp;of&nbsp;blocking.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3146187">//&nbsp;A&nbsp;zero&nbsp;value&nbsp;for&nbsp;t&nbsp;means&nbsp;Read&nbsp;will&nbsp;not&nbsp;time&nbsp;out.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3146240">SetReadDeadline</span><span class="op" id="3146255">(</span><span class="ident" id="3146256">t</span>&nbsp;<span class="ident" id="3146258">time</span><span class="op" id="3146262">.</span><span class="ident" id="3146263">Time</span><span class="op" id="3146267">)</span>&nbsp;<span class="builtintype" id="3146269">error</span><br>
<span class="lineno">250</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3146277">//&nbsp;SetWriteDeadline&nbsp;sets&nbsp;the&nbsp;deadline&nbsp;for&nbsp;future&nbsp;Write&nbsp;calls.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3146340">//&nbsp;If&nbsp;the&nbsp;deadline&nbsp;is&nbsp;reached,&nbsp;Write&nbsp;will&nbsp;fail&nbsp;with&nbsp;a&nbsp;timeout</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3146403">//&nbsp;(see&nbsp;type&nbsp;Error)&nbsp;instead&nbsp;of&nbsp;blocking.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3146445">//&nbsp;A&nbsp;zero&nbsp;value&nbsp;for&nbsp;t&nbsp;means&nbsp;Write&nbsp;will&nbsp;not&nbsp;time&nbsp;out.</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3146499">//&nbsp;Even&nbsp;if&nbsp;write&nbsp;times&nbsp;out,&nbsp;it&nbsp;may&nbsp;return&nbsp;n&nbsp;&gt;&nbsp;0,&nbsp;indicating&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3146565">//&nbsp;some&nbsp;of&nbsp;the&nbsp;data&nbsp;was&nbsp;successfully&nbsp;written.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3146612">SetWriteDeadline</span><span class="op" id="3146628">(</span><span class="ident" id="3146629">t</span>&nbsp;<span class="ident" id="3146631">time</span><span class="op" id="3146635">.</span><span class="ident" id="3146636">Time</span><span class="op" id="3146640">)</span>&nbsp;<span class="builtintype" id="3146642">error</span><br>
<span class="lineno"></span><span class="op" id="3146648">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="keyword" id="3146651">var</span>&nbsp;<span class="ident" id="3146655">listenerBacklog</span>&nbsp;<span class="op" id="3146671">=</span>&nbsp;<span class="ident" id="3146673">maxListenerBacklog</span><span class="op" id="3146691">(</span><span class="op" id="3146692">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3146695">//&nbsp;A&nbsp;Listener&nbsp;is&nbsp;a&nbsp;generic&nbsp;network&nbsp;listener&nbsp;for&nbsp;stream-oriented&nbsp;protocols.</span><br>
<span class="lineno"></span><span class="comment" id="3146770">//</span><br>
<span class="lineno"></span><span class="comment" id="3146773">//&nbsp;Multiple&nbsp;goroutines&nbsp;may&nbsp;invoke&nbsp;methods&nbsp;on&nbsp;a&nbsp;Listener&nbsp;simultaneously.</span><br>
<span class="lineno">265</span><span class="keyword" id="3146845">type</span>&nbsp;<span class="ident" id="3146850">Listener</span>&nbsp;<span class="keyword" id="3146859">interface</span>&nbsp;<span class="op" id="3146869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3146872">//&nbsp;Accept&nbsp;waits&nbsp;for&nbsp;and&nbsp;returns&nbsp;the&nbsp;next&nbsp;connection&nbsp;to&nbsp;the&nbsp;listener.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3146942">Accept</span><span class="op" id="3146948">(</span><span class="op" id="3146949">)</span>&nbsp;<span class="op" id="3146951">(</span><span class="ident" id="3146952">c</span>&nbsp;<span class="ident" id="3146954">Conn</span><span class="op" id="3146958">,</span>&nbsp;<span class="ident" id="3146960">err</span>&nbsp;<span class="builtintype" id="3146964">error</span><span class="op" id="3146969">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3146973">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;listener.</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3147004">//&nbsp;Any&nbsp;blocked&nbsp;Accept&nbsp;operations&nbsp;will&nbsp;be&nbsp;unblocked&nbsp;and&nbsp;return&nbsp;errors.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3147075">Close</span><span class="op" id="3147080">(</span><span class="op" id="3147081">)</span>&nbsp;<span class="builtintype" id="3147083">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3147091">//&nbsp;Addr&nbsp;returns&nbsp;the&nbsp;listener&#39;s&nbsp;network&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3147140">Addr</span><span class="op" id="3147144">(</span><span class="op" id="3147145">)</span>&nbsp;<span class="ident" id="3147147">Addr</span><br>
<span class="lineno">275</span><span class="op" id="3147152">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3147155">//&nbsp;Various&nbsp;errors&nbsp;contained&nbsp;in&nbsp;OpError.</span><br>
<span class="lineno"></span><span class="keyword" id="3147195">var</span>&nbsp;<span class="op" id="3147199">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3147202">//&nbsp;For&nbsp;connection&nbsp;setup&nbsp;and&nbsp;write&nbsp;operations.</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3147249">errMissingAddress</span>&nbsp;<span class="op" id="3147267">=</span>&nbsp;<span class="ident" id="3147269">errors</span><span class="op" id="3147275">.</span><span class="ident" id="3147276">New</span><span class="op" id="3147279">(</span><span class="string" id="3147280">&#34;missing&nbsp;address&#34;</span><span class="op" id="3147297">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3147301">//&nbsp;For&nbsp;both&nbsp;read&nbsp;and&nbsp;write&nbsp;operations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3147341">errTimeout</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3147361">error</span>&nbsp;<span class="op" id="3147367">=</span>&nbsp;<span class="op" id="3147369">&amp;</span><span class="ident" id="3147370">timeoutError</span><span class="op" id="3147382">{</span><span class="op" id="3147383">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3147386">errClosing</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3147412">=</span>&nbsp;<span class="ident" id="3147414">errors</span><span class="op" id="3147420">.</span><span class="ident" id="3147421">New</span><span class="op" id="3147424">(</span><span class="string" id="3147425">&#34;use&nbsp;of&nbsp;closed&nbsp;network&nbsp;connection&#34;</span><span class="op" id="3147459">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3147462">ErrWriteToConnected</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3147488">=</span>&nbsp;<span class="ident" id="3147490">errors</span><span class="op" id="3147496">.</span><span class="ident" id="3147497">New</span><span class="op" id="3147500">(</span><span class="string" id="3147501">&#34;use&nbsp;of&nbsp;WriteTo&nbsp;with&nbsp;pre-connected&nbsp;connection&#34;</span><span class="op" id="3147547">)</span><br>
<span class="lineno"></span><span class="op" id="3147549">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3147552">//&nbsp;OpError&nbsp;is&nbsp;the&nbsp;error&nbsp;type&nbsp;usually&nbsp;returned&nbsp;by&nbsp;functions&nbsp;in&nbsp;the&nbsp;net</span><br>
<span class="lineno"></span><span class="comment" id="3147622">//&nbsp;package.&nbsp;It&nbsp;describes&nbsp;the&nbsp;operation,&nbsp;network&nbsp;type,&nbsp;and&nbsp;address&nbsp;of</span><br>
<span class="lineno">290</span><span class="comment" id="3147691">//&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="3147704">type</span>&nbsp;<span class="ident" id="3147709">OpError</span>&nbsp;<span class="keyword" id="3147717">struct</span>&nbsp;<span class="op" id="3147724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3147727">//&nbsp;Op&nbsp;is&nbsp;the&nbsp;operation&nbsp;which&nbsp;caused&nbsp;the&nbsp;error,&nbsp;such&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3147783">//&nbsp;&#34;read&#34;&nbsp;or&nbsp;&#34;write&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3147806">Op</span>&nbsp;<span class="builtintype" id="3147809">string</span><br>
<span class="lineno">295</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3147818">//&nbsp;Net&nbsp;is&nbsp;the&nbsp;network&nbsp;type&nbsp;on&nbsp;which&nbsp;this&nbsp;error&nbsp;occurred,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3147876">//&nbsp;such&nbsp;as&nbsp;&#34;tcp&#34;&nbsp;or&nbsp;&#34;udp6&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3147905">Net</span>&nbsp;<span class="builtintype" id="3147909">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3147918">//&nbsp;Addr&nbsp;is&nbsp;the&nbsp;network&nbsp;address&nbsp;on&nbsp;which&nbsp;this&nbsp;error&nbsp;occurred.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3147980">Addr</span>&nbsp;<span class="ident" id="3147985">Addr</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3147992">//&nbsp;Err&nbsp;is&nbsp;the&nbsp;error&nbsp;that&nbsp;occurred&nbsp;during&nbsp;the&nbsp;operation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3148049">Err</span>&nbsp;<span class="builtintype" id="3148053">error</span><br>
<span class="lineno">305</span><span class="op" id="3148059">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3148062">func</span>&nbsp;<span class="op" id="3148067">(</span><span class="ident" id="3148068">e</span>&nbsp;<span class="op" id="3148070">*</span><span class="ident" id="3148071">OpError</span><span class="op" id="3148078">)</span>&nbsp;<span class="ident" id="3148080">Error</span><span class="op" id="3148085">(</span><span class="op" id="3148086">)</span>&nbsp;<span class="builtintype" id="3148088">string</span>&nbsp;<span class="op" id="3148095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3148098">if</span>&nbsp;<span class="ident" id="3148101">e</span>&nbsp;<span class="op" id="3148103">==</span>&nbsp;<span class="ident" id="3148106">nil</span>&nbsp;<span class="op" id="3148110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3148114">return</span>&nbsp;<span class="string" id="3148121">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3148130">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3148133">s</span>&nbsp;<span class="op" id="3148135">:=</span>&nbsp;<span class="ident" id="3148138">e</span><span class="op" id="3148139">.</span><span class="ident" id="3148140">Op</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3148144">if</span>&nbsp;<span class="ident" id="3148147">e</span><span class="op" id="3148148">.</span><span class="ident" id="3148149">Net</span>&nbsp;<span class="op" id="3148153">!=</span>&nbsp;<span class="string" id="3148156">&#34;&#34;</span>&nbsp;<span class="op" id="3148159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3148163">s</span>&nbsp;<span class="op" id="3148165">+=</span>&nbsp;<span class="string" id="3148168">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="3148172">+</span>&nbsp;<span class="ident" id="3148174">e</span><span class="op" id="3148175">.</span><span class="ident" id="3148176">Net</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3148181">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3148184">if</span>&nbsp;<span class="ident" id="3148187">e</span><span class="op" id="3148188">.</span><span class="ident" id="3148189">Addr</span>&nbsp;<span class="op" id="3148194">!=</span>&nbsp;<span class="ident" id="3148197">nil</span>&nbsp;<span class="op" id="3148201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3148205">s</span>&nbsp;<span class="op" id="3148207">+=</span>&nbsp;<span class="string" id="3148210">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="3148214">+</span>&nbsp;<span class="ident" id="3148216">e</span><span class="op" id="3148217">.</span><span class="ident" id="3148218">Addr</span><span class="op" id="3148222">.</span><span class="ident" id="3148223">String</span><span class="op" id="3148229">(</span><span class="op" id="3148230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3148233">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3148236">s</span>&nbsp;<span class="op" id="3148238">+=</span>&nbsp;<span class="string" id="3148241">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="3148246">+</span>&nbsp;<span class="ident" id="3148248">e</span><span class="op" id="3148249">.</span><span class="ident" id="3148250">Err</span><span class="op" id="3148253">.</span><span class="ident" id="3148254">Error</span><span class="op" id="3148259">(</span><span class="op" id="3148260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3148263">return</span>&nbsp;<span class="ident" id="3148270">s</span><br>
<span class="lineno">320</span><span class="op" id="3148272">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3148275">type</span>&nbsp;<span class="ident" id="3148280">temporary</span>&nbsp;<span class="keyword" id="3148290">interface</span>&nbsp;<span class="op" id="3148300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3148303">Temporary</span><span class="op" id="3148312">(</span><span class="op" id="3148313">)</span>&nbsp;<span class="builtintype" id="3148315">bool</span><br>
<span class="lineno"></span><span class="op" id="3148320">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span><span class="keyword" id="3148323">func</span>&nbsp;<span class="op" id="3148328">(</span><span class="ident" id="3148329">e</span>&nbsp;<span class="op" id="3148331">*</span><span class="ident" id="3148332">OpError</span><span class="op" id="3148339">)</span>&nbsp;<span class="ident" id="3148341">Temporary</span><span class="op" id="3148350">(</span><span class="op" id="3148351">)</span>&nbsp;<span class="builtintype" id="3148353">bool</span>&nbsp;<span class="op" id="3148358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3148361">t</span><span class="op" id="3148362">,</span>&nbsp;<span class="ident" id="3148364">ok</span>&nbsp;<span class="op" id="3148367">:=</span>&nbsp;<span class="ident" id="3148370">e</span><span class="op" id="3148371">.</span><span class="ident" id="3148372">Err</span><span class="op" id="3148375">.</span><span class="op" id="3148376">(</span><span class="ident" id="3148377">temporary</span><span class="op" id="3148386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3148389">return</span>&nbsp;<span class="ident" id="3148396">ok</span>&nbsp;<span class="op" id="3148399">&amp;&amp;</span>&nbsp;<span class="ident" id="3148402">t</span><span class="op" id="3148403">.</span><span class="ident" id="3148404">Temporary</span><span class="op" id="3148413">(</span><span class="op" id="3148414">)</span><br>
<span class="lineno"></span><span class="op" id="3148416">}</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span><span class="keyword" id="3148419">var</span>&nbsp;<span class="ident" id="3148423">noDeadline</span>&nbsp;<span class="op" id="3148434">=</span>&nbsp;<span class="ident" id="3148436">time</span><span class="op" id="3148440">.</span><span class="ident" id="3148441">Time</span><span class="op" id="3148445">{</span><span class="op" id="3148446">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3148449">type</span>&nbsp;<span class="ident" id="3148454">timeout</span>&nbsp;<span class="keyword" id="3148462">interface</span>&nbsp;<span class="op" id="3148472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3148475">Timeout</span><span class="op" id="3148482">(</span><span class="op" id="3148483">)</span>&nbsp;<span class="builtintype" id="3148485">bool</span><br>
<span class="lineno">335</span><span class="op" id="3148490">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3148493">func</span>&nbsp;<span class="op" id="3148498">(</span><span class="ident" id="3148499">e</span>&nbsp;<span class="op" id="3148501">*</span><span class="ident" id="3148502">OpError</span><span class="op" id="3148509">)</span>&nbsp;<span class="ident" id="3148511">Timeout</span><span class="op" id="3148518">(</span><span class="op" id="3148519">)</span>&nbsp;<span class="builtintype" id="3148521">bool</span>&nbsp;<span class="op" id="3148526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3148529">t</span><span class="op" id="3148530">,</span>&nbsp;<span class="ident" id="3148532">ok</span>&nbsp;<span class="op" id="3148535">:=</span>&nbsp;<span class="ident" id="3148538">e</span><span class="op" id="3148539">.</span><span class="ident" id="3148540">Err</span><span class="op" id="3148543">.</span><span class="op" id="3148544">(</span><span class="ident" id="3148545">timeout</span><span class="op" id="3148552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3148555">return</span>&nbsp;<span class="ident" id="3148562">ok</span>&nbsp;<span class="op" id="3148565">&amp;&amp;</span>&nbsp;<span class="ident" id="3148568">t</span><span class="op" id="3148569">.</span><span class="ident" id="3148570">Timeout</span><span class="op" id="3148577">(</span><span class="op" id="3148578">)</span><br>
<span class="lineno">340</span><span class="op" id="3148580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3148583">type</span>&nbsp;<span class="ident" id="3148588">timeoutError</span>&nbsp;<span class="keyword" id="3148601">struct</span><span class="op" id="3148607">{</span><span class="op" id="3148608">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3148611">func</span>&nbsp;<span class="op" id="3148616">(</span><span class="ident" id="3148617">e</span>&nbsp;<span class="op" id="3148619">*</span><span class="ident" id="3148620">timeoutError</span><span class="op" id="3148632">)</span>&nbsp;<span class="ident" id="3148634">Error</span><span class="op" id="3148639">(</span><span class="op" id="3148640">)</span>&nbsp;<span class="builtintype" id="3148642">string</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3148651">{</span>&nbsp;<span class="keyword" id="3148653">return</span>&nbsp;<span class="string" id="3148660">&#34;i/o&nbsp;timeout&#34;</span>&nbsp;<span class="op" id="3148674">}</span><br>
<span class="lineno">345</span><span class="keyword" id="3148676">func</span>&nbsp;<span class="op" id="3148681">(</span><span class="ident" id="3148682">e</span>&nbsp;<span class="op" id="3148684">*</span><span class="ident" id="3148685">timeoutError</span><span class="op" id="3148697">)</span>&nbsp;<span class="ident" id="3148699">Timeout</span><span class="op" id="3148706">(</span><span class="op" id="3148707">)</span>&nbsp;<span class="builtintype" id="3148709">bool</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3148716">{</span>&nbsp;<span class="keyword" id="3148718">return</span>&nbsp;<span class="builtintype" id="3148725">true</span>&nbsp;<span class="op" id="3148730">}</span><br>
<span class="lineno"></span><span class="keyword" id="3148732">func</span>&nbsp;<span class="op" id="3148737">(</span><span class="ident" id="3148738">e</span>&nbsp;<span class="op" id="3148740">*</span><span class="ident" id="3148741">timeoutError</span><span class="op" id="3148753">)</span>&nbsp;<span class="ident" id="3148755">Temporary</span><span class="op" id="3148764">(</span><span class="op" id="3148765">)</span>&nbsp;<span class="builtintype" id="3148767">bool</span>&nbsp;<span class="op" id="3148772">{</span>&nbsp;<span class="keyword" id="3148774">return</span>&nbsp;<span class="builtintype" id="3148781">true</span>&nbsp;<span class="op" id="3148786">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3148789">type</span>&nbsp;<span class="ident" id="3148794">AddrError</span>&nbsp;<span class="keyword" id="3148804">struct</span>&nbsp;<span class="op" id="3148811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3148814">Err</span>&nbsp;&nbsp;<span class="builtintype" id="3148819">string</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3148827">Addr</span>&nbsp;<span class="builtintype" id="3148832">string</span><br>
<span class="lineno"></span><span class="op" id="3148839">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3148842">func</span>&nbsp;<span class="op" id="3148847">(</span><span class="ident" id="3148848">e</span>&nbsp;<span class="op" id="3148850">*</span><span class="ident" id="3148851">AddrError</span><span class="op" id="3148860">)</span>&nbsp;<span class="ident" id="3148862">Error</span><span class="op" id="3148867">(</span><span class="op" id="3148868">)</span>&nbsp;<span class="builtintype" id="3148870">string</span>&nbsp;<span class="op" id="3148877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3148880">if</span>&nbsp;<span class="ident" id="3148883">e</span>&nbsp;<span class="op" id="3148885">==</span>&nbsp;<span class="ident" id="3148888">nil</span>&nbsp;<span class="op" id="3148892">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3148896">return</span>&nbsp;<span class="string" id="3148903">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3148912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3148915">s</span>&nbsp;<span class="op" id="3148917">:=</span>&nbsp;<span class="ident" id="3148920">e</span><span class="op" id="3148921">.</span><span class="ident" id="3148922">Err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3148927">if</span>&nbsp;<span class="ident" id="3148930">e</span><span class="op" id="3148931">.</span><span class="ident" id="3148932">Addr</span>&nbsp;<span class="op" id="3148937">!=</span>&nbsp;<span class="string" id="3148940">&#34;&#34;</span>&nbsp;<span class="op" id="3148943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3148947">s</span>&nbsp;<span class="op" id="3148949">+=</span>&nbsp;<span class="string" id="3148952">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="3148956">+</span>&nbsp;<span class="ident" id="3148958">e</span><span class="op" id="3148959">.</span><span class="ident" id="3148960">Addr</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3148966">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3148969">return</span>&nbsp;<span class="ident" id="3148976">s</span><br>
<span class="lineno"></span><span class="op" id="3148978">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3148981">func</span>&nbsp;<span class="op" id="3148986">(</span><span class="ident" id="3148987">e</span>&nbsp;<span class="op" id="3148989">*</span><span class="ident" id="3148990">AddrError</span><span class="op" id="3148999">)</span>&nbsp;<span class="ident" id="3149001">Temporary</span><span class="op" id="3149010">(</span><span class="op" id="3149011">)</span>&nbsp;<span class="builtintype" id="3149013">bool</span>&nbsp;<span class="op" id="3149018">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3149021">return</span>&nbsp;<span class="builtintype" id="3149028">false</span><br>
<span class="lineno"></span><span class="op" id="3149034">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3149037">func</span>&nbsp;<span class="op" id="3149042">(</span><span class="ident" id="3149043">e</span>&nbsp;<span class="op" id="3149045">*</span><span class="ident" id="3149046">AddrError</span><span class="op" id="3149055">)</span>&nbsp;<span class="ident" id="3149057">Timeout</span><span class="op" id="3149064">(</span><span class="op" id="3149065">)</span>&nbsp;<span class="builtintype" id="3149067">bool</span>&nbsp;<span class="op" id="3149072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3149075">return</span>&nbsp;<span class="builtintype" id="3149082">false</span><br>
<span class="lineno">370</span><span class="op" id="3149088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3149091">type</span>&nbsp;<span class="ident" id="3149096">UnknownNetworkError</span>&nbsp;<span class="builtintype" id="3149116">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3149124">func</span>&nbsp;<span class="op" id="3149129">(</span><span class="ident" id="3149130">e</span>&nbsp;<span class="ident" id="3149132">UnknownNetworkError</span><span class="op" id="3149151">)</span>&nbsp;<span class="ident" id="3149153">Error</span><span class="op" id="3149158">(</span><span class="op" id="3149159">)</span>&nbsp;<span class="builtintype" id="3149161">string</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3149170">{</span>&nbsp;<span class="keyword" id="3149172">return</span>&nbsp;<span class="string" id="3149179">&#34;unknown&nbsp;network&nbsp;&#34;</span>&nbsp;<span class="op" id="3149198">+</span>&nbsp;<span class="builtintype" id="3149200">string</span><span class="op" id="3149206">(</span><span class="ident" id="3149207">e</span><span class="op" id="3149208">)</span>&nbsp;<span class="op" id="3149210">}</span><br>
<span class="lineno">375</span><span class="keyword" id="3149212">func</span>&nbsp;<span class="op" id="3149217">(</span><span class="ident" id="3149218">e</span>&nbsp;<span class="ident" id="3149220">UnknownNetworkError</span><span class="op" id="3149239">)</span>&nbsp;<span class="ident" id="3149241">Temporary</span><span class="op" id="3149250">(</span><span class="op" id="3149251">)</span>&nbsp;<span class="builtintype" id="3149253">bool</span>&nbsp;<span class="op" id="3149258">{</span>&nbsp;<span class="keyword" id="3149260">return</span>&nbsp;<span class="builtintype" id="3149267">false</span>&nbsp;<span class="op" id="3149273">}</span><br>
<span class="lineno"></span><span class="keyword" id="3149275">func</span>&nbsp;<span class="op" id="3149280">(</span><span class="ident" id="3149281">e</span>&nbsp;<span class="ident" id="3149283">UnknownNetworkError</span><span class="op" id="3149302">)</span>&nbsp;<span class="ident" id="3149304">Timeout</span><span class="op" id="3149311">(</span><span class="op" id="3149312">)</span>&nbsp;<span class="builtintype" id="3149314">bool</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3149321">{</span>&nbsp;<span class="keyword" id="3149323">return</span>&nbsp;<span class="builtintype" id="3149330">false</span>&nbsp;<span class="op" id="3149336">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3149339">type</span>&nbsp;<span class="ident" id="3149344">InvalidAddrError</span>&nbsp;<span class="builtintype" id="3149361">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">380</span><span class="keyword" id="3149369">func</span>&nbsp;<span class="op" id="3149374">(</span><span class="ident" id="3149375">e</span>&nbsp;<span class="ident" id="3149377">InvalidAddrError</span><span class="op" id="3149393">)</span>&nbsp;<span class="ident" id="3149395">Error</span><span class="op" id="3149400">(</span><span class="op" id="3149401">)</span>&nbsp;<span class="builtintype" id="3149403">string</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3149412">{</span>&nbsp;<span class="keyword" id="3149414">return</span>&nbsp;<span class="builtintype" id="3149421">string</span><span class="op" id="3149427">(</span><span class="ident" id="3149428">e</span><span class="op" id="3149429">)</span>&nbsp;<span class="op" id="3149431">}</span><br>
<span class="lineno"></span><span class="keyword" id="3149433">func</span>&nbsp;<span class="op" id="3149438">(</span><span class="ident" id="3149439">e</span>&nbsp;<span class="ident" id="3149441">InvalidAddrError</span><span class="op" id="3149457">)</span>&nbsp;<span class="ident" id="3149459">Timeout</span><span class="op" id="3149466">(</span><span class="op" id="3149467">)</span>&nbsp;<span class="builtintype" id="3149469">bool</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3149476">{</span>&nbsp;<span class="keyword" id="3149478">return</span>&nbsp;<span class="builtintype" id="3149485">false</span>&nbsp;<span class="op" id="3149491">}</span><br>
<span class="lineno"></span><span class="keyword" id="3149493">func</span>&nbsp;<span class="op" id="3149498">(</span><span class="ident" id="3149499">e</span>&nbsp;<span class="ident" id="3149501">InvalidAddrError</span><span class="op" id="3149517">)</span>&nbsp;<span class="ident" id="3149519">Temporary</span><span class="op" id="3149528">(</span><span class="op" id="3149529">)</span>&nbsp;<span class="builtintype" id="3149531">bool</span>&nbsp;<span class="op" id="3149536">{</span>&nbsp;<span class="keyword" id="3149538">return</span>&nbsp;<span class="builtintype" id="3149545">false</span>&nbsp;<span class="op" id="3149551">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3149554">//&nbsp;DNSConfigError&nbsp;represents&nbsp;an&nbsp;error&nbsp;reading&nbsp;the&nbsp;machine&#39;s&nbsp;DNS&nbsp;configuration.</span><br>
<span class="lineno">385</span><span class="keyword" id="3149633">type</span>&nbsp;<span class="ident" id="3149638">DNSConfigError</span>&nbsp;<span class="keyword" id="3149653">struct</span>&nbsp;<span class="op" id="3149660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3149663">Err</span>&nbsp;<span class="builtintype" id="3149667">error</span><br>
<span class="lineno"></span><span class="op" id="3149673">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3149676">func</span>&nbsp;<span class="op" id="3149681">(</span><span class="ident" id="3149682">e</span>&nbsp;<span class="op" id="3149684">*</span><span class="ident" id="3149685">DNSConfigError</span><span class="op" id="3149699">)</span>&nbsp;<span class="ident" id="3149701">Error</span><span class="op" id="3149706">(</span><span class="op" id="3149707">)</span>&nbsp;<span class="builtintype" id="3149709">string</span>&nbsp;<span class="op" id="3149716">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3149719">return</span>&nbsp;<span class="string" id="3149726">&#34;error&nbsp;reading&nbsp;DNS&nbsp;config:&nbsp;&#34;</span>&nbsp;<span class="op" id="3149755">+</span>&nbsp;<span class="ident" id="3149757">e</span><span class="op" id="3149758">.</span><span class="ident" id="3149759">Err</span><span class="op" id="3149762">.</span><span class="ident" id="3149763">Error</span><span class="op" id="3149768">(</span><span class="op" id="3149769">)</span><br>
<span class="lineno"></span><span class="op" id="3149771">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3149774">func</span>&nbsp;<span class="op" id="3149779">(</span><span class="ident" id="3149780">e</span>&nbsp;<span class="op" id="3149782">*</span><span class="ident" id="3149783">DNSConfigError</span><span class="op" id="3149797">)</span>&nbsp;<span class="ident" id="3149799">Timeout</span><span class="op" id="3149806">(</span><span class="op" id="3149807">)</span>&nbsp;<span class="builtintype" id="3149809">bool</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3149816">{</span>&nbsp;<span class="keyword" id="3149818">return</span>&nbsp;<span class="builtintype" id="3149825">false</span>&nbsp;<span class="op" id="3149831">}</span><br>
<span class="lineno"></span><span class="keyword" id="3149833">func</span>&nbsp;<span class="op" id="3149838">(</span><span class="ident" id="3149839">e</span>&nbsp;<span class="op" id="3149841">*</span><span class="ident" id="3149842">DNSConfigError</span><span class="op" id="3149856">)</span>&nbsp;<span class="ident" id="3149858">Temporary</span><span class="op" id="3149867">(</span><span class="op" id="3149868">)</span>&nbsp;<span class="builtintype" id="3149870">bool</span>&nbsp;<span class="op" id="3149875">{</span>&nbsp;<span class="keyword" id="3149877">return</span>&nbsp;<span class="builtintype" id="3149884">false</span>&nbsp;<span class="op" id="3149890">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="keyword" id="3149893">type</span>&nbsp;<span class="ident" id="3149898">writerOnly</span>&nbsp;<span class="keyword" id="3149909">struct</span>&nbsp;<span class="op" id="3149916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3149919">io</span><span class="op" id="3149921">.</span><span class="ident" id="3149922">Writer</span><br>
<span class="lineno"></span><span class="op" id="3149929">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">400</span><span class="comment" id="3149932">//&nbsp;Fallback&nbsp;implementation&nbsp;of&nbsp;io.ReaderFrom&#39;s&nbsp;ReadFrom,&nbsp;when&nbsp;sendfile&nbsp;isn&#39;t</span><br>
<span class="lineno"></span><span class="comment" id="3150008">//&nbsp;applicable.</span><br>
<span class="lineno"></span><span class="keyword" id="3150023">func</span>&nbsp;<span class="ident" id="3150028">genericReadFrom</span><span class="op" id="3150043">(</span><span class="ident" id="3150044">w</span>&nbsp;<span class="ident" id="3150046">io</span><span class="op" id="3150048">.</span><span class="ident" id="3150049">Writer</span><span class="op" id="3150055">,</span>&nbsp;<span class="ident" id="3150057">r</span>&nbsp;<span class="ident" id="3150059">io</span><span class="op" id="3150061">.</span><span class="ident" id="3150062">Reader</span><span class="op" id="3150068">)</span>&nbsp;<span class="op" id="3150070">(</span><span class="ident" id="3150071">n</span>&nbsp;<span class="ident" id="3150073">int64</span><span class="op" id="3150078">,</span>&nbsp;<span class="ident" id="3150080">err</span>&nbsp;<span class="builtintype" id="3150084">error</span><span class="op" id="3150089">)</span>&nbsp;<span class="op" id="3150091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3150094">//&nbsp;Use&nbsp;wrapper&nbsp;to&nbsp;hide&nbsp;existing&nbsp;r.ReadFrom&nbsp;from&nbsp;io.Copy.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3150152">return</span>&nbsp;<span class="ident" id="3150159">io</span><span class="op" id="3150161">.</span><span class="ident" id="3150162">Copy</span><span class="op" id="3150166">(</span><span class="ident" id="3150167">writerOnly</span><span class="op" id="3150177">{</span><span class="ident" id="3150178">w</span><span class="op" id="3150179">}</span><span class="op" id="3150180">,</span>&nbsp;<span class="ident" id="3150182">r</span><span class="op" id="3150183">)</span><br>
<span class="lineno">405</span><span class="op" id="3150185">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3150188">//&nbsp;Limit&nbsp;the&nbsp;number&nbsp;of&nbsp;concurrent&nbsp;cgo-using&nbsp;goroutines,&nbsp;because</span><br>
<span class="lineno"></span><span class="comment" id="3150252">//&nbsp;each&nbsp;will&nbsp;block&nbsp;an&nbsp;entire&nbsp;operating&nbsp;system&nbsp;thread.&nbsp;The&nbsp;usual&nbsp;culprit</span><br>
<span class="lineno"></span><span class="comment" id="3150324">//&nbsp;is&nbsp;resolving&nbsp;many&nbsp;DNS&nbsp;names&nbsp;in&nbsp;separate&nbsp;goroutines&nbsp;but&nbsp;the&nbsp;DNS</span><br>
<span class="lineno">410</span><span class="comment" id="3150390">//&nbsp;server&nbsp;is&nbsp;not&nbsp;responding.&nbsp;Then&nbsp;the&nbsp;many&nbsp;lookups&nbsp;each&nbsp;use&nbsp;a&nbsp;different</span><br>
<span class="lineno"></span><span class="comment" id="3150462">//&nbsp;thread,&nbsp;and&nbsp;the&nbsp;system&nbsp;or&nbsp;the&nbsp;program&nbsp;runs&nbsp;out&nbsp;of&nbsp;threads.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3150525">var</span>&nbsp;<span class="ident" id="3150529">threadLimit</span>&nbsp;<span class="op" id="3150541">=</span>&nbsp;<span class="builtinfunc" id="3150543">make</span><span class="op" id="3150547">(</span><span class="keyword" id="3150548">chan</span>&nbsp;<span class="keyword" id="3150553">struct</span><span class="op" id="3150559">{</span><span class="op" id="3150560">}</span><span class="op" id="3150561">,</span>&nbsp;<span class="num" id="3150563">500</span><span class="op" id="3150566">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">415</span><span class="comment" id="3150569">//&nbsp;Using&nbsp;send&nbsp;for&nbsp;acquire&nbsp;is&nbsp;fine&nbsp;here&nbsp;because&nbsp;we&nbsp;are&nbsp;not&nbsp;using&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="3150638">//&nbsp;to&nbsp;protect&nbsp;any&nbsp;memory.&nbsp;All&nbsp;we&nbsp;care&nbsp;about&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;goroutines</span><br>
<span class="lineno"></span><span class="comment" id="3150710">//&nbsp;making&nbsp;calls&nbsp;at&nbsp;a&nbsp;time.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3150738">func</span>&nbsp;<span class="ident" id="3150743">acquireThread</span><span class="op" id="3150756">(</span><span class="op" id="3150757">)</span>&nbsp;<span class="op" id="3150759">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3150762">threadLimit</span>&nbsp;<span class="op" id="3150774">&lt;-</span>&nbsp;<span class="keyword" id="3150777">struct</span><span class="op" id="3150783">{</span><span class="op" id="3150784">}</span><span class="op" id="3150785">{</span><span class="op" id="3150786">}</span><br>
<span class="lineno"></span><span class="op" id="3150788">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3150791">func</span>&nbsp;<span class="ident" id="3150796">releaseThread</span><span class="op" id="3150809">(</span><span class="op" id="3150810">)</span>&nbsp;<span class="op" id="3150812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3150815">&lt;-</span><span class="ident" id="3150817">threadLimit</span><br>
<span class="lineno">425</span><span class="op" id="3150829">}</span>
</div>
</body>
</html>
