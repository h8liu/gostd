<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/parser</h2>
<ul>
<li><a href="/gostd/go/parser/error_test.go.html">error_test.go</a></li>
<li><a href="/gostd/go/parser/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/go/parser/interface.go.html">interface.go</a></li>
<li><a href="/gostd/go/parser/parser.go.html">parser.go</a></li>
<li><a href="/gostd/go/parser/parser_test.go.html">parser_test.go</a></li>
<li><a href="/gostd/go/parser/performance_test.go.html">performance_test.go</a></li>
<li><a href="/gostd/go/parser/short_test.go.html">short_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7867252">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7867307">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7867361">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7867412">package</span>&nbsp;<span class="ident" id="7867420">parser</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7867428">import</span>&nbsp;<span class="op" id="7867435">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7867438">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7867447">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7867454">&#34;go/ast&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7867464">&#34;go/token&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7867476">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7867482">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7867493">&#34;testing&#34;</span><br>
<span class="lineno">15</span><span class="op" id="7867503">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7867506">var</span>&nbsp;<span class="ident" id="7867510">fset</span>&nbsp;<span class="op" id="7867515">=</span>&nbsp;<span class="ident" id="7867517">token</span><span class="op" id="7867522">.</span><span class="ident" id="7867523">NewFileSet</span><span class="op" id="7867533">(</span><span class="op" id="7867534">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7867537">var</span>&nbsp;<span class="ident" id="7867541">validFiles</span>&nbsp;<span class="op" id="7867552">=</span>&nbsp;<span class="op" id="7867554">[</span><span class="op" id="7867555">]</span><span class="builtintype" id="7867556">string</span><span class="op" id="7867562">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7867565">&#34;parser.go&#34;</span><span class="op" id="7867576">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7867579">&#34;parser_test.go&#34;</span><span class="op" id="7867595">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7867598">&#34;error_test.go&#34;</span><span class="op" id="7867613">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7867616">&#34;short_test.go&#34;</span><span class="op" id="7867631">,</span><br>
<span class="lineno"></span><span class="op" id="7867633">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="7867636">func</span>&nbsp;<span class="ident" id="7867641">TestParse</span><span class="op" id="7867650">(</span><span class="ident" id="7867651">t</span>&nbsp;<span class="op" id="7867653">*</span><span class="ident" id="7867654">testing</span><span class="op" id="7867661">.</span><span class="ident" id="7867662">T</span><span class="op" id="7867663">)</span>&nbsp;<span class="op" id="7867665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7867668">for</span>&nbsp;<span class="ident" id="7867672">_</span><span class="op" id="7867673">,</span>&nbsp;<span class="ident" id="7867675">filename</span>&nbsp;<span class="op" id="7867684">:=</span>&nbsp;<span class="keyword" id="7867687">range</span>&nbsp;<span class="ident" id="7867693">validFiles</span>&nbsp;<span class="op" id="7867704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7867708">_</span><span class="op" id="7867709">,</span>&nbsp;<span class="ident" id="7867711">err</span>&nbsp;<span class="op" id="7867715">:=</span>&nbsp;<span class="ident" id="7867718">ParseFile</span><span class="op" id="7867727">(</span><span class="ident" id="7867728">fset</span><span class="op" id="7867732">,</span>&nbsp;<span class="ident" id="7867734">filename</span><span class="op" id="7867742">,</span>&nbsp;<span class="ident" id="7867744">nil</span><span class="op" id="7867747">,</span>&nbsp;<span class="ident" id="7867749">DeclarationErrors</span><span class="op" id="7867766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7867770">if</span>&nbsp;<span class="ident" id="7867773">err</span>&nbsp;<span class="op" id="7867777">!=</span>&nbsp;<span class="ident" id="7867780">nil</span>&nbsp;<span class="op" id="7867784">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7867789">t</span><span class="op" id="7867790">.</span><span class="ident" id="7867791">Fatalf</span><span class="op" id="7867797">(</span><span class="string" id="7867798">&#34;ParseFile(%s):&nbsp;%v&#34;</span><span class="op" id="7867817">,</span>&nbsp;<span class="ident" id="7867819">filename</span><span class="op" id="7867827">,</span>&nbsp;<span class="ident" id="7867829">err</span><span class="op" id="7867832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7867836">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7867839">}</span><br>
<span class="lineno"></span><span class="op" id="7867841">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="7867844">func</span>&nbsp;<span class="ident" id="7867849">nameFilter</span><span class="op" id="7867859">(</span><span class="ident" id="7867860">filename</span>&nbsp;<span class="builtintype" id="7867869">string</span><span class="op" id="7867875">)</span>&nbsp;<span class="builtintype" id="7867877">bool</span>&nbsp;<span class="op" id="7867882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7867885">switch</span>&nbsp;<span class="ident" id="7867892">filename</span>&nbsp;<span class="op" id="7867901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7867904">case</span>&nbsp;<span class="string" id="7867909">&#34;parser.go&#34;</span><span class="op" id="7867920">,</span>&nbsp;<span class="string" id="7867922">&#34;interface.go&#34;</span><span class="op" id="7867936">,</span>&nbsp;<span class="string" id="7867938">&#34;parser_test.go&#34;</span><span class="op" id="7867954">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7867958">return</span>&nbsp;<span class="builtintype" id="7867965">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7867971">case</span>&nbsp;<span class="string" id="7867976">&#34;parser.go.orig&#34;</span><span class="op" id="7867992">:</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7867996">return</span>&nbsp;<span class="builtintype" id="7868003">true</span>&nbsp;<span class="comment" id="7868008">//&nbsp;permit&nbsp;but&nbsp;should&nbsp;be&nbsp;ignored&nbsp;by&nbsp;ParseDir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7868053">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7868056">return</span>&nbsp;<span class="builtintype" id="7868063">false</span><br>
<span class="lineno"></span><span class="op" id="7868069">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="keyword" id="7868072">func</span>&nbsp;<span class="ident" id="7868077">dirFilter</span><span class="op" id="7868086">(</span><span class="ident" id="7868087">f</span>&nbsp;<span class="ident" id="7868089">os</span><span class="op" id="7868091">.</span><span class="ident" id="7868092">FileInfo</span><span class="op" id="7868100">)</span>&nbsp;<span class="builtintype" id="7868102">bool</span>&nbsp;<span class="op" id="7868107">{</span>&nbsp;<span class="keyword" id="7868109">return</span>&nbsp;<span class="ident" id="7868116">nameFilter</span><span class="op" id="7868126">(</span><span class="ident" id="7868127">f</span><span class="op" id="7868128">.</span><span class="ident" id="7868129">Name</span><span class="op" id="7868133">(</span><span class="op" id="7868134">)</span><span class="op" id="7868135">)</span>&nbsp;<span class="op" id="7868137">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7868140">func</span>&nbsp;<span class="ident" id="7868145">TestParseDir</span><span class="op" id="7868157">(</span><span class="ident" id="7868158">t</span>&nbsp;<span class="op" id="7868160">*</span><span class="ident" id="7868161">testing</span><span class="op" id="7868168">.</span><span class="ident" id="7868169">T</span><span class="op" id="7868170">)</span>&nbsp;<span class="op" id="7868172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7868175">path</span>&nbsp;<span class="op" id="7868180">:=</span>&nbsp;<span class="string" id="7868183">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7868188">pkgs</span><span class="op" id="7868192">,</span>&nbsp;<span class="ident" id="7868194">err</span>&nbsp;<span class="op" id="7868198">:=</span>&nbsp;<span class="ident" id="7868201">ParseDir</span><span class="op" id="7868209">(</span><span class="ident" id="7868210">fset</span><span class="op" id="7868214">,</span>&nbsp;<span class="ident" id="7868216">path</span><span class="op" id="7868220">,</span>&nbsp;<span class="ident" id="7868222">dirFilter</span><span class="op" id="7868231">,</span>&nbsp;<span class="num" id="7868233">0</span><span class="op" id="7868234">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7868237">if</span>&nbsp;<span class="ident" id="7868240">err</span>&nbsp;<span class="op" id="7868244">!=</span>&nbsp;<span class="ident" id="7868247">nil</span>&nbsp;<span class="op" id="7868251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7868255">t</span><span class="op" id="7868256">.</span><span class="ident" id="7868257">Fatalf</span><span class="op" id="7868263">(</span><span class="string" id="7868264">&#34;ParseDir(%s):&nbsp;%v&#34;</span><span class="op" id="7868282">,</span>&nbsp;<span class="ident" id="7868284">path</span><span class="op" id="7868288">,</span>&nbsp;<span class="ident" id="7868290">err</span><span class="op" id="7868293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7868296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7868299">if</span>&nbsp;<span class="ident" id="7868302">n</span>&nbsp;<span class="op" id="7868304">:=</span>&nbsp;<span class="builtinfunc" id="7868307">len</span><span class="op" id="7868310">(</span><span class="ident" id="7868311">pkgs</span><span class="op" id="7868315">)</span><span class="op" id="7868316">;</span>&nbsp;<span class="ident" id="7868318">n</span>&nbsp;<span class="op" id="7868320">!=</span>&nbsp;<span class="num" id="7868323">1</span>&nbsp;<span class="op" id="7868325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7868329">t</span><span class="op" id="7868330">.</span><span class="ident" id="7868331">Errorf</span><span class="op" id="7868337">(</span><span class="string" id="7868338">&#34;got&nbsp;%d&nbsp;packages;&nbsp;want&nbsp;1&#34;</span><span class="op" id="7868363">,</span>&nbsp;<span class="ident" id="7868365">n</span><span class="op" id="7868366">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7868369">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7868372">pkg</span>&nbsp;<span class="op" id="7868376">:=</span>&nbsp;<span class="ident" id="7868379">pkgs</span><span class="op" id="7868383">[</span><span class="string" id="7868384">&#34;parser&#34;</span><span class="op" id="7868392">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7868395">if</span>&nbsp;<span class="ident" id="7868398">pkg</span>&nbsp;<span class="op" id="7868402">==</span>&nbsp;<span class="ident" id="7868405">nil</span>&nbsp;<span class="op" id="7868409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7868413">t</span><span class="op" id="7868414">.</span><span class="ident" id="7868415">Errorf</span><span class="op" id="7868421">(</span><span class="string" id="7868422">`package&nbsp;&#34;parser&#34;&nbsp;not&nbsp;found`</span><span class="op" id="7868450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7868454">return</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7868462">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7868465">if</span>&nbsp;<span class="ident" id="7868468">n</span>&nbsp;<span class="op" id="7868470">:=</span>&nbsp;<span class="builtinfunc" id="7868473">len</span><span class="op" id="7868476">(</span><span class="ident" id="7868477">pkg</span><span class="op" id="7868480">.</span><span class="ident" id="7868481">Files</span><span class="op" id="7868486">)</span><span class="op" id="7868487">;</span>&nbsp;<span class="ident" id="7868489">n</span>&nbsp;<span class="op" id="7868491">!=</span>&nbsp;<span class="num" id="7868494">3</span>&nbsp;<span class="op" id="7868496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7868500">t</span><span class="op" id="7868501">.</span><span class="ident" id="7868502">Errorf</span><span class="op" id="7868508">(</span><span class="string" id="7868509">&#34;got&nbsp;%d&nbsp;package&nbsp;files;&nbsp;want&nbsp;3&#34;</span><span class="op" id="7868539">,</span>&nbsp;<span class="ident" id="7868541">n</span><span class="op" id="7868542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7868545">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7868548">for</span>&nbsp;<span class="ident" id="7868552">filename</span>&nbsp;<span class="op" id="7868561">:=</span>&nbsp;<span class="keyword" id="7868564">range</span>&nbsp;<span class="ident" id="7868570">pkg</span><span class="op" id="7868573">.</span><span class="ident" id="7868574">Files</span>&nbsp;<span class="op" id="7868580">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7868584">if</span>&nbsp;<span class="op" id="7868587">!</span><span class="ident" id="7868588">nameFilter</span><span class="op" id="7868598">(</span><span class="ident" id="7868599">filename</span><span class="op" id="7868607">)</span>&nbsp;<span class="op" id="7868609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7868614">t</span><span class="op" id="7868615">.</span><span class="ident" id="7868616">Errorf</span><span class="op" id="7868622">(</span><span class="string" id="7868623">&#34;unexpected&nbsp;package&nbsp;file:&nbsp;%s&#34;</span><span class="op" id="7868652">,</span>&nbsp;<span class="ident" id="7868654">filename</span><span class="op" id="7868662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7868666">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7868669">}</span><br>
<span class="lineno"></span><span class="op" id="7868671">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="7868674">func</span>&nbsp;<span class="ident" id="7868679">TestParseExpr</span><span class="op" id="7868692">(</span><span class="ident" id="7868693">t</span>&nbsp;<span class="op" id="7868695">*</span><span class="ident" id="7868696">testing</span><span class="op" id="7868703">.</span><span class="ident" id="7868704">T</span><span class="op" id="7868705">)</span>&nbsp;<span class="op" id="7868707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7868710">//&nbsp;just&nbsp;kicking&nbsp;the&nbsp;tires:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7868738">//&nbsp;a&nbsp;valid&nbsp;arithmetic&nbsp;expression</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7868772">src</span>&nbsp;<span class="op" id="7868776">:=</span>&nbsp;<span class="string" id="7868779">&#34;a&nbsp;+&nbsp;b&#34;</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7868788">x</span><span class="op" id="7868789">,</span>&nbsp;<span class="ident" id="7868791">err</span>&nbsp;<span class="op" id="7868795">:=</span>&nbsp;<span class="ident" id="7868798">ParseExpr</span><span class="op" id="7868807">(</span><span class="ident" id="7868808">src</span><span class="op" id="7868811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7868814">if</span>&nbsp;<span class="ident" id="7868817">err</span>&nbsp;<span class="op" id="7868821">!=</span>&nbsp;<span class="ident" id="7868824">nil</span>&nbsp;<span class="op" id="7868828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7868832">t</span><span class="op" id="7868833">.</span><span class="ident" id="7868834">Errorf</span><span class="op" id="7868840">(</span><span class="string" id="7868841">&#34;ParseExpr(%q):&nbsp;%v&#34;</span><span class="op" id="7868860">,</span>&nbsp;<span class="ident" id="7868862">src</span><span class="op" id="7868865">,</span>&nbsp;<span class="ident" id="7868867">err</span><span class="op" id="7868870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7868873">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7868876">//&nbsp;sanity&nbsp;check</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7868893">if</span>&nbsp;<span class="ident" id="7868896">_</span><span class="op" id="7868897">,</span>&nbsp;<span class="ident" id="7868899">ok</span>&nbsp;<span class="op" id="7868902">:=</span>&nbsp;<span class="ident" id="7868905">x</span><span class="op" id="7868906">.</span><span class="op" id="7868907">(</span><span class="op" id="7868908">*</span><span class="ident" id="7868909">ast</span><span class="op" id="7868912">.</span><span class="ident" id="7868913">BinaryExpr</span><span class="op" id="7868923">)</span><span class="op" id="7868924">;</span>&nbsp;<span class="op" id="7868926">!</span><span class="ident" id="7868927">ok</span>&nbsp;<span class="op" id="7868930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7868934">t</span><span class="op" id="7868935">.</span><span class="ident" id="7868936">Errorf</span><span class="op" id="7868942">(</span><span class="string" id="7868943">&#34;ParseExpr(%q):&nbsp;got&nbsp;%T,&nbsp;want&nbsp;*ast.BinaryExpr&#34;</span><span class="op" id="7868988">,</span>&nbsp;<span class="ident" id="7868990">src</span><span class="op" id="7868993">,</span>&nbsp;<span class="ident" id="7868995">x</span><span class="op" id="7868996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7868999">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7869003">//&nbsp;a&nbsp;valid&nbsp;type&nbsp;expression</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7869031">src</span>&nbsp;<span class="op" id="7869035">=</span>&nbsp;<span class="string" id="7869037">&#34;struct{x&nbsp;*int}&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7869055">x</span><span class="op" id="7869056">,</span>&nbsp;<span class="ident" id="7869058">err</span>&nbsp;<span class="op" id="7869062">=</span>&nbsp;<span class="ident" id="7869064">ParseExpr</span><span class="op" id="7869073">(</span><span class="ident" id="7869074">src</span><span class="op" id="7869077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7869080">if</span>&nbsp;<span class="ident" id="7869083">err</span>&nbsp;<span class="op" id="7869087">!=</span>&nbsp;<span class="ident" id="7869090">nil</span>&nbsp;<span class="op" id="7869094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7869098">t</span><span class="op" id="7869099">.</span><span class="ident" id="7869100">Errorf</span><span class="op" id="7869106">(</span><span class="string" id="7869107">&#34;ParseExpr(%q):&nbsp;%v&#34;</span><span class="op" id="7869126">,</span>&nbsp;<span class="ident" id="7869128">src</span><span class="op" id="7869131">,</span>&nbsp;<span class="ident" id="7869133">err</span><span class="op" id="7869136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7869139">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7869142">//&nbsp;sanity&nbsp;check</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7869159">if</span>&nbsp;<span class="ident" id="7869162">_</span><span class="op" id="7869163">,</span>&nbsp;<span class="ident" id="7869165">ok</span>&nbsp;<span class="op" id="7869168">:=</span>&nbsp;<span class="ident" id="7869171">x</span><span class="op" id="7869172">.</span><span class="op" id="7869173">(</span><span class="op" id="7869174">*</span><span class="ident" id="7869175">ast</span><span class="op" id="7869178">.</span><span class="ident" id="7869179">StructType</span><span class="op" id="7869189">)</span><span class="op" id="7869190">;</span>&nbsp;<span class="op" id="7869192">!</span><span class="ident" id="7869193">ok</span>&nbsp;<span class="op" id="7869196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7869200">t</span><span class="op" id="7869201">.</span><span class="ident" id="7869202">Errorf</span><span class="op" id="7869208">(</span><span class="string" id="7869209">&#34;ParseExpr(%q):&nbsp;got&nbsp;%T,&nbsp;want&nbsp;*ast.StructType&#34;</span><span class="op" id="7869254">,</span>&nbsp;<span class="ident" id="7869256">src</span><span class="op" id="7869259">,</span>&nbsp;<span class="ident" id="7869261">x</span><span class="op" id="7869262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7869265">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7869269">//&nbsp;an&nbsp;invalid&nbsp;expression</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7869295">src</span>&nbsp;<span class="op" id="7869299">=</span>&nbsp;<span class="string" id="7869301">&#34;a&nbsp;+&nbsp;*&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7869310">if</span>&nbsp;<span class="ident" id="7869313">_</span><span class="op" id="7869314">,</span>&nbsp;<span class="ident" id="7869316">err</span>&nbsp;<span class="op" id="7869320">:=</span>&nbsp;<span class="ident" id="7869323">ParseExpr</span><span class="op" id="7869332">(</span><span class="ident" id="7869333">src</span><span class="op" id="7869336">)</span><span class="op" id="7869337">;</span>&nbsp;<span class="ident" id="7869339">err</span>&nbsp;<span class="op" id="7869343">==</span>&nbsp;<span class="ident" id="7869346">nil</span>&nbsp;<span class="op" id="7869350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7869354">t</span><span class="op" id="7869355">.</span><span class="ident" id="7869356">Errorf</span><span class="op" id="7869362">(</span><span class="string" id="7869363">&#34;ParseExpr(%q):&nbsp;got&nbsp;no&nbsp;error&#34;</span><span class="op" id="7869392">,</span>&nbsp;<span class="ident" id="7869394">src</span><span class="op" id="7869397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7869400">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7869404">//&nbsp;a&nbsp;valid&nbsp;expression&nbsp;followed&nbsp;by&nbsp;extra&nbsp;tokens&nbsp;is&nbsp;invalid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7869463">src</span>&nbsp;<span class="op" id="7869467">=</span>&nbsp;<span class="string" id="7869469">&#34;a[i]&nbsp;:=&nbsp;x&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7869482">if</span>&nbsp;<span class="ident" id="7869485">_</span><span class="op" id="7869486">,</span>&nbsp;<span class="ident" id="7869488">err</span>&nbsp;<span class="op" id="7869492">:=</span>&nbsp;<span class="ident" id="7869495">ParseExpr</span><span class="op" id="7869504">(</span><span class="ident" id="7869505">src</span><span class="op" id="7869508">)</span><span class="op" id="7869509">;</span>&nbsp;<span class="ident" id="7869511">err</span>&nbsp;<span class="op" id="7869515">==</span>&nbsp;<span class="ident" id="7869518">nil</span>&nbsp;<span class="op" id="7869522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7869526">t</span><span class="op" id="7869527">.</span><span class="ident" id="7869528">Errorf</span><span class="op" id="7869534">(</span><span class="string" id="7869535">&#34;ParseExpr(%q):&nbsp;got&nbsp;no&nbsp;error&#34;</span><span class="op" id="7869564">,</span>&nbsp;<span class="ident" id="7869566">src</span><span class="op" id="7869569">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7869572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7869576">//&nbsp;a&nbsp;semicolon&nbsp;is&nbsp;not&nbsp;permitted&nbsp;unless&nbsp;automatically&nbsp;inserted</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7869639">src</span>&nbsp;<span class="op" id="7869643">=</span>&nbsp;<span class="string" id="7869645">&#34;a&nbsp;+&nbsp;b\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7869656">if</span>&nbsp;<span class="ident" id="7869659">_</span><span class="op" id="7869660">,</span>&nbsp;<span class="ident" id="7869662">err</span>&nbsp;<span class="op" id="7869666">:=</span>&nbsp;<span class="ident" id="7869669">ParseExpr</span><span class="op" id="7869678">(</span><span class="ident" id="7869679">src</span><span class="op" id="7869682">)</span><span class="op" id="7869683">;</span>&nbsp;<span class="ident" id="7869685">err</span>&nbsp;<span class="op" id="7869689">!=</span>&nbsp;<span class="ident" id="7869692">nil</span>&nbsp;<span class="op" id="7869696">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7869700">t</span><span class="op" id="7869701">.</span><span class="ident" id="7869702">Errorf</span><span class="op" id="7869708">(</span><span class="string" id="7869709">&#34;ParseExpr(%q):&nbsp;got&nbsp;error&nbsp;%s&#34;</span><span class="op" id="7869738">,</span>&nbsp;<span class="ident" id="7869740">src</span><span class="op" id="7869743">,</span>&nbsp;<span class="ident" id="7869745">err</span><span class="op" id="7869748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7869751">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7869754">src</span>&nbsp;<span class="op" id="7869758">=</span>&nbsp;<span class="string" id="7869760">&#34;a&nbsp;+&nbsp;b;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7869770">if</span>&nbsp;<span class="ident" id="7869773">_</span><span class="op" id="7869774">,</span>&nbsp;<span class="ident" id="7869776">err</span>&nbsp;<span class="op" id="7869780">:=</span>&nbsp;<span class="ident" id="7869783">ParseExpr</span><span class="op" id="7869792">(</span><span class="ident" id="7869793">src</span><span class="op" id="7869796">)</span><span class="op" id="7869797">;</span>&nbsp;<span class="ident" id="7869799">err</span>&nbsp;<span class="op" id="7869803">==</span>&nbsp;<span class="ident" id="7869806">nil</span>&nbsp;<span class="op" id="7869810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7869814">t</span><span class="op" id="7869815">.</span><span class="ident" id="7869816">Errorf</span><span class="op" id="7869822">(</span><span class="string" id="7869823">&#34;ParseExpr(%q):&nbsp;got&nbsp;no&nbsp;error&#34;</span><span class="op" id="7869852">,</span>&nbsp;<span class="ident" id="7869854">src</span><span class="op" id="7869857">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7869860">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7869864">//&nbsp;various&nbsp;other&nbsp;stuff&nbsp;following&nbsp;a&nbsp;valid&nbsp;expression</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7869917">const</span>&nbsp;<span class="ident" id="7869923">validExpr</span>&nbsp;<span class="op" id="7869933">=</span>&nbsp;<span class="string" id="7869935">&#34;a&nbsp;+&nbsp;b&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7869944">const</span>&nbsp;<span class="ident" id="7869950">anything</span>&nbsp;<span class="op" id="7869959">=</span>&nbsp;<span class="string" id="7869961">&#34;dh3*#D)#_&#34;</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7869974">for</span>&nbsp;<span class="ident" id="7869978">_</span><span class="op" id="7869979">,</span>&nbsp;<span class="ident" id="7869981">c</span>&nbsp;<span class="op" id="7869983">:=</span>&nbsp;<span class="keyword" id="7869986">range</span>&nbsp;<span class="string" id="7869992">&#34;!)]};,&#34;</span>&nbsp;<span class="op" id="7870001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7870005">src</span>&nbsp;<span class="op" id="7870009">:=</span>&nbsp;<span class="ident" id="7870012">validExpr</span>&nbsp;<span class="op" id="7870022">+</span>&nbsp;<span class="builtintype" id="7870024">string</span><span class="op" id="7870030">(</span><span class="ident" id="7870031">c</span><span class="op" id="7870032">)</span>&nbsp;<span class="op" id="7870034">+</span>&nbsp;<span class="ident" id="7870036">anything</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7870047">if</span>&nbsp;<span class="ident" id="7870050">_</span><span class="op" id="7870051">,</span>&nbsp;<span class="ident" id="7870053">err</span>&nbsp;<span class="op" id="7870057">:=</span>&nbsp;<span class="ident" id="7870060">ParseExpr</span><span class="op" id="7870069">(</span><span class="ident" id="7870070">src</span><span class="op" id="7870073">)</span><span class="op" id="7870074">;</span>&nbsp;<span class="ident" id="7870076">err</span>&nbsp;<span class="op" id="7870080">==</span>&nbsp;<span class="ident" id="7870083">nil</span>&nbsp;<span class="op" id="7870087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7870092">t</span><span class="op" id="7870093">.</span><span class="ident" id="7870094">Errorf</span><span class="op" id="7870100">(</span><span class="string" id="7870101">&#34;ParseExpr(%q):&nbsp;got&nbsp;no&nbsp;error&#34;</span><span class="op" id="7870130">,</span>&nbsp;<span class="ident" id="7870132">src</span><span class="op" id="7870135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7870139">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7870142">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7870146">//&nbsp;ParseExpr&nbsp;must&nbsp;not&nbsp;crash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7870175">for</span>&nbsp;<span class="ident" id="7870179">_</span><span class="op" id="7870180">,</span>&nbsp;<span class="ident" id="7870182">src</span>&nbsp;<span class="op" id="7870186">:=</span>&nbsp;<span class="keyword" id="7870189">range</span>&nbsp;<span class="ident" id="7870195">valids</span>&nbsp;<span class="op" id="7870202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7870206">ParseExpr</span><span class="op" id="7870215">(</span><span class="ident" id="7870216">src</span><span class="op" id="7870219">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7870222">}</span><br>
<span class="lineno"></span><span class="op" id="7870224">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7870227">func</span>&nbsp;<span class="ident" id="7870232">TestColonEqualsScope</span><span class="op" id="7870252">(</span><span class="ident" id="7870253">t</span>&nbsp;<span class="op" id="7870255">*</span><span class="ident" id="7870256">testing</span><span class="op" id="7870263">.</span><span class="ident" id="7870264">T</span><span class="op" id="7870265">)</span>&nbsp;<span class="op" id="7870267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7870270">f</span><span class="op" id="7870271">,</span>&nbsp;<span class="ident" id="7870273">err</span>&nbsp;<span class="op" id="7870277">:=</span>&nbsp;<span class="ident" id="7870280">ParseFile</span><span class="op" id="7870289">(</span><span class="ident" id="7870290">fset</span><span class="op" id="7870294">,</span>&nbsp;<span class="string" id="7870296">&#34;&#34;</span><span class="op" id="7870298">,</span>&nbsp;<span class="string" id="7870300">`package&nbsp;p;&nbsp;func&nbsp;f()&nbsp;{&nbsp;x,&nbsp;y,&nbsp;z&nbsp;:=&nbsp;x,&nbsp;y,&nbsp;z&nbsp;}`</span><span class="op" id="7870344">,</span>&nbsp;<span class="num" id="7870346">0</span><span class="op" id="7870347">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7870350">if</span>&nbsp;<span class="ident" id="7870353">err</span>&nbsp;<span class="op" id="7870357">!=</span>&nbsp;<span class="ident" id="7870360">nil</span>&nbsp;<span class="op" id="7870364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7870368">t</span><span class="op" id="7870369">.</span><span class="ident" id="7870370">Fatal</span><span class="op" id="7870375">(</span><span class="ident" id="7870376">err</span><span class="op" id="7870379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7870382">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7870386">//&nbsp;RHS&nbsp;refers&nbsp;to&nbsp;undefined&nbsp;globals;&nbsp;LHS&nbsp;does&nbsp;not.</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7870437">as</span>&nbsp;<span class="op" id="7870440">:=</span>&nbsp;<span class="ident" id="7870443">f</span><span class="op" id="7870444">.</span><span class="ident" id="7870445">Decls</span><span class="op" id="7870450">[</span><span class="num" id="7870451">0</span><span class="op" id="7870452">]</span><span class="op" id="7870453">.</span><span class="op" id="7870454">(</span><span class="op" id="7870455">*</span><span class="ident" id="7870456">ast</span><span class="op" id="7870459">.</span><span class="ident" id="7870460">FuncDecl</span><span class="op" id="7870468">)</span><span class="op" id="7870469">.</span><span class="ident" id="7870470">Body</span><span class="op" id="7870474">.</span><span class="ident" id="7870475">List</span><span class="op" id="7870479">[</span><span class="num" id="7870480">0</span><span class="op" id="7870481">]</span><span class="op" id="7870482">.</span><span class="op" id="7870483">(</span><span class="op" id="7870484">*</span><span class="ident" id="7870485">ast</span><span class="op" id="7870488">.</span><span class="ident" id="7870489">AssignStmt</span><span class="op" id="7870499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7870502">for</span>&nbsp;<span class="ident" id="7870506">_</span><span class="op" id="7870507">,</span>&nbsp;<span class="ident" id="7870509">v</span>&nbsp;<span class="op" id="7870511">:=</span>&nbsp;<span class="keyword" id="7870514">range</span>&nbsp;<span class="ident" id="7870520">as</span><span class="op" id="7870522">.</span><span class="ident" id="7870523">Rhs</span>&nbsp;<span class="op" id="7870527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7870531">id</span>&nbsp;<span class="op" id="7870534">:=</span>&nbsp;<span class="ident" id="7870537">v</span><span class="op" id="7870538">.</span><span class="op" id="7870539">(</span><span class="op" id="7870540">*</span><span class="ident" id="7870541">ast</span><span class="op" id="7870544">.</span><span class="ident" id="7870545">Ident</span><span class="op" id="7870550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7870554">if</span>&nbsp;<span class="ident" id="7870557">id</span><span class="op" id="7870559">.</span><span class="ident" id="7870560">Obj</span>&nbsp;<span class="op" id="7870564">!=</span>&nbsp;<span class="ident" id="7870567">nil</span>&nbsp;<span class="op" id="7870571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7870576">t</span><span class="op" id="7870577">.</span><span class="ident" id="7870578">Errorf</span><span class="op" id="7870584">(</span><span class="string" id="7870585">&#34;rhs&nbsp;%s&nbsp;has&nbsp;Obj,&nbsp;should&nbsp;not&#34;</span><span class="op" id="7870613">,</span>&nbsp;<span class="ident" id="7870615">id</span><span class="op" id="7870617">.</span><span class="ident" id="7870618">Name</span><span class="op" id="7870622">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7870626">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7870629">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7870632">for</span>&nbsp;<span class="ident" id="7870636">_</span><span class="op" id="7870637">,</span>&nbsp;<span class="ident" id="7870639">v</span>&nbsp;<span class="op" id="7870641">:=</span>&nbsp;<span class="keyword" id="7870644">range</span>&nbsp;<span class="ident" id="7870650">as</span><span class="op" id="7870652">.</span><span class="ident" id="7870653">Lhs</span>&nbsp;<span class="op" id="7870657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7870661">id</span>&nbsp;<span class="op" id="7870664">:=</span>&nbsp;<span class="ident" id="7870667">v</span><span class="op" id="7870668">.</span><span class="op" id="7870669">(</span><span class="op" id="7870670">*</span><span class="ident" id="7870671">ast</span><span class="op" id="7870674">.</span><span class="ident" id="7870675">Ident</span><span class="op" id="7870680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7870684">if</span>&nbsp;<span class="ident" id="7870687">id</span><span class="op" id="7870689">.</span><span class="ident" id="7870690">Obj</span>&nbsp;<span class="op" id="7870694">==</span>&nbsp;<span class="ident" id="7870697">nil</span>&nbsp;<span class="op" id="7870701">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7870706">t</span><span class="op" id="7870707">.</span><span class="ident" id="7870708">Errorf</span><span class="op" id="7870714">(</span><span class="string" id="7870715">&#34;lhs&nbsp;%s&nbsp;does&nbsp;not&nbsp;have&nbsp;Obj,&nbsp;should&#34;</span><span class="op" id="7870749">,</span>&nbsp;<span class="ident" id="7870751">id</span><span class="op" id="7870753">.</span><span class="ident" id="7870754">Name</span><span class="op" id="7870758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7870762">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7870765">}</span><br>
<span class="lineno"></span><span class="op" id="7870767">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span><span class="keyword" id="7870770">func</span>&nbsp;<span class="ident" id="7870775">TestVarScope</span><span class="op" id="7870787">(</span><span class="ident" id="7870788">t</span>&nbsp;<span class="op" id="7870790">*</span><span class="ident" id="7870791">testing</span><span class="op" id="7870798">.</span><span class="ident" id="7870799">T</span><span class="op" id="7870800">)</span>&nbsp;<span class="op" id="7870802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7870805">f</span><span class="op" id="7870806">,</span>&nbsp;<span class="ident" id="7870808">err</span>&nbsp;<span class="op" id="7870812">:=</span>&nbsp;<span class="ident" id="7870815">ParseFile</span><span class="op" id="7870824">(</span><span class="ident" id="7870825">fset</span><span class="op" id="7870829">,</span>&nbsp;<span class="string" id="7870831">&#34;&#34;</span><span class="op" id="7870833">,</span>&nbsp;<span class="string" id="7870835">`package&nbsp;p;&nbsp;func&nbsp;f()&nbsp;{&nbsp;var&nbsp;x,&nbsp;y,&nbsp;z&nbsp;=&nbsp;x,&nbsp;y,&nbsp;z&nbsp;}`</span><span class="op" id="7870882">,</span>&nbsp;<span class="num" id="7870884">0</span><span class="op" id="7870885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7870888">if</span>&nbsp;<span class="ident" id="7870891">err</span>&nbsp;<span class="op" id="7870895">!=</span>&nbsp;<span class="ident" id="7870898">nil</span>&nbsp;<span class="op" id="7870902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7870906">t</span><span class="op" id="7870907">.</span><span class="ident" id="7870908">Fatal</span><span class="op" id="7870913">(</span><span class="ident" id="7870914">err</span><span class="op" id="7870917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7870920">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7870924">//&nbsp;RHS&nbsp;refers&nbsp;to&nbsp;undefined&nbsp;globals;&nbsp;LHS&nbsp;does&nbsp;not.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7870975">as</span>&nbsp;<span class="op" id="7870978">:=</span>&nbsp;<span class="ident" id="7870981">f</span><span class="op" id="7870982">.</span><span class="ident" id="7870983">Decls</span><span class="op" id="7870988">[</span><span class="num" id="7870989">0</span><span class="op" id="7870990">]</span><span class="op" id="7870991">.</span><span class="op" id="7870992">(</span><span class="op" id="7870993">*</span><span class="ident" id="7870994">ast</span><span class="op" id="7870997">.</span><span class="ident" id="7870998">FuncDecl</span><span class="op" id="7871006">)</span><span class="op" id="7871007">.</span><span class="ident" id="7871008">Body</span><span class="op" id="7871012">.</span><span class="ident" id="7871013">List</span><span class="op" id="7871017">[</span><span class="num" id="7871018">0</span><span class="op" id="7871019">]</span><span class="op" id="7871020">.</span><span class="op" id="7871021">(</span><span class="op" id="7871022">*</span><span class="ident" id="7871023">ast</span><span class="op" id="7871026">.</span><span class="ident" id="7871027">DeclStmt</span><span class="op" id="7871035">)</span><span class="op" id="7871036">.</span><span class="ident" id="7871037">Decl</span><span class="op" id="7871041">.</span><span class="op" id="7871042">(</span><span class="op" id="7871043">*</span><span class="ident" id="7871044">ast</span><span class="op" id="7871047">.</span><span class="ident" id="7871048">GenDecl</span><span class="op" id="7871055">)</span><span class="op" id="7871056">.</span><span class="ident" id="7871057">Specs</span><span class="op" id="7871062">[</span><span class="num" id="7871063">0</span><span class="op" id="7871064">]</span><span class="op" id="7871065">.</span><span class="op" id="7871066">(</span><span class="op" id="7871067">*</span><span class="ident" id="7871068">ast</span><span class="op" id="7871071">.</span><span class="ident" id="7871072">ValueSpec</span><span class="op" id="7871081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7871084">for</span>&nbsp;<span class="ident" id="7871088">_</span><span class="op" id="7871089">,</span>&nbsp;<span class="ident" id="7871091">v</span>&nbsp;<span class="op" id="7871093">:=</span>&nbsp;<span class="keyword" id="7871096">range</span>&nbsp;<span class="ident" id="7871102">as</span><span class="op" id="7871104">.</span><span class="ident" id="7871105">Values</span>&nbsp;<span class="op" id="7871112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7871116">id</span>&nbsp;<span class="op" id="7871119">:=</span>&nbsp;<span class="ident" id="7871122">v</span><span class="op" id="7871123">.</span><span class="op" id="7871124">(</span><span class="op" id="7871125">*</span><span class="ident" id="7871126">ast</span><span class="op" id="7871129">.</span><span class="ident" id="7871130">Ident</span><span class="op" id="7871135">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7871139">if</span>&nbsp;<span class="ident" id="7871142">id</span><span class="op" id="7871144">.</span><span class="ident" id="7871145">Obj</span>&nbsp;<span class="op" id="7871149">!=</span>&nbsp;<span class="ident" id="7871152">nil</span>&nbsp;<span class="op" id="7871156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7871161">t</span><span class="op" id="7871162">.</span><span class="ident" id="7871163">Errorf</span><span class="op" id="7871169">(</span><span class="string" id="7871170">&#34;rhs&nbsp;%s&nbsp;has&nbsp;Obj,&nbsp;should&nbsp;not&#34;</span><span class="op" id="7871198">,</span>&nbsp;<span class="ident" id="7871200">id</span><span class="op" id="7871202">.</span><span class="ident" id="7871203">Name</span><span class="op" id="7871207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7871211">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7871214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7871217">for</span>&nbsp;<span class="ident" id="7871221">_</span><span class="op" id="7871222">,</span>&nbsp;<span class="ident" id="7871224">id</span>&nbsp;<span class="op" id="7871227">:=</span>&nbsp;<span class="keyword" id="7871230">range</span>&nbsp;<span class="ident" id="7871236">as</span><span class="op" id="7871238">.</span><span class="ident" id="7871239">Names</span>&nbsp;<span class="op" id="7871245">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7871249">if</span>&nbsp;<span class="ident" id="7871252">id</span><span class="op" id="7871254">.</span><span class="ident" id="7871255">Obj</span>&nbsp;<span class="op" id="7871259">==</span>&nbsp;<span class="ident" id="7871262">nil</span>&nbsp;<span class="op" id="7871266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7871271">t</span><span class="op" id="7871272">.</span><span class="ident" id="7871273">Errorf</span><span class="op" id="7871279">(</span><span class="string" id="7871280">&#34;lhs&nbsp;%s&nbsp;does&nbsp;not&nbsp;have&nbsp;Obj,&nbsp;should&#34;</span><span class="op" id="7871314">,</span>&nbsp;<span class="ident" id="7871316">id</span><span class="op" id="7871318">.</span><span class="ident" id="7871319">Name</span><span class="op" id="7871323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7871327">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7871330">}</span><br>
<span class="lineno"></span><span class="op" id="7871332">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="7871335">func</span>&nbsp;<span class="ident" id="7871340">TestObjects</span><span class="op" id="7871351">(</span><span class="ident" id="7871352">t</span>&nbsp;<span class="op" id="7871354">*</span><span class="ident" id="7871355">testing</span><span class="op" id="7871362">.</span><span class="ident" id="7871363">T</span><span class="op" id="7871364">)</span>&nbsp;<span class="op" id="7871366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7871369">const</span>&nbsp;<span class="ident" id="7871375">src</span>&nbsp;<span class="op" id="7871379">=</span>&nbsp;<span class="string" id="7871381">`<br>
<span class="lineno"></span>package&nbsp;p<br>
<span class="lineno"></span>import&nbsp;fmt&nbsp;&#34;fmt&#34;<br>
<span class="lineno">180</span>const&nbsp;pi&nbsp;=&nbsp;3.14<br>
<span class="lineno"></span>type&nbsp;T&nbsp;struct{}<br>
<span class="lineno"></span>var&nbsp;x&nbsp;int<br>
<span class="lineno"></span>func&nbsp;f()&nbsp;{&nbsp;L:&nbsp;}<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7871472">f</span><span class="op" id="7871473">,</span>&nbsp;<span class="ident" id="7871475">err</span>&nbsp;<span class="op" id="7871479">:=</span>&nbsp;<span class="ident" id="7871482">ParseFile</span><span class="op" id="7871491">(</span><span class="ident" id="7871492">fset</span><span class="op" id="7871496">,</span>&nbsp;<span class="string" id="7871498">&#34;&#34;</span><span class="op" id="7871500">,</span>&nbsp;<span class="ident" id="7871502">src</span><span class="op" id="7871505">,</span>&nbsp;<span class="num" id="7871507">0</span><span class="op" id="7871508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7871511">if</span>&nbsp;<span class="ident" id="7871514">err</span>&nbsp;<span class="op" id="7871518">!=</span>&nbsp;<span class="ident" id="7871521">nil</span>&nbsp;<span class="op" id="7871525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7871529">t</span><span class="op" id="7871530">.</span><span class="ident" id="7871531">Fatal</span><span class="op" id="7871536">(</span><span class="ident" id="7871537">err</span><span class="op" id="7871540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7871543">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7871547">objects</span>&nbsp;<span class="op" id="7871555">:=</span>&nbsp;<span class="keyword" id="7871558">map</span><span class="op" id="7871561">[</span><span class="builtintype" id="7871562">string</span><span class="op" id="7871568">]</span><span class="ident" id="7871569">ast</span><span class="op" id="7871572">.</span><span class="ident" id="7871573">ObjKind</span><span class="op" id="7871580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7871584">&#34;p&#34;</span><span class="op" id="7871587">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7871591">ast</span><span class="op" id="7871594">.</span><span class="ident" id="7871595">Bad</span><span class="op" id="7871598">,</span>&nbsp;<span class="comment" id="7871600">//&nbsp;not&nbsp;in&nbsp;a&nbsp;scope</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7871620">&#34;fmt&#34;</span><span class="op" id="7871625">:</span>&nbsp;<span class="ident" id="7871627">ast</span><span class="op" id="7871630">.</span><span class="ident" id="7871631">Bad</span><span class="op" id="7871634">,</span>&nbsp;<span class="comment" id="7871636">//&nbsp;not&nbsp;resolved&nbsp;yet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7871658">&#34;pi&#34;</span><span class="op" id="7871662">:</span>&nbsp;&nbsp;<span class="ident" id="7871665">ast</span><span class="op" id="7871668">.</span><span class="ident" id="7871669">Con</span><span class="op" id="7871672">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7871676">&#34;T&#34;</span><span class="op" id="7871679">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7871683">ast</span><span class="op" id="7871686">.</span><span class="ident" id="7871687">Typ</span><span class="op" id="7871690">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7871694">&#34;x&#34;</span><span class="op" id="7871697">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7871701">ast</span><span class="op" id="7871704">.</span><span class="ident" id="7871705">Var</span><span class="op" id="7871708">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7871712">&#34;int&#34;</span><span class="op" id="7871717">:</span>&nbsp;<span class="ident" id="7871719">ast</span><span class="op" id="7871722">.</span><span class="ident" id="7871723">Bad</span><span class="op" id="7871726">,</span>&nbsp;<span class="comment" id="7871728">//&nbsp;not&nbsp;resolved&nbsp;yet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7871750">&#34;f&#34;</span><span class="op" id="7871753">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7871757">ast</span><span class="op" id="7871760">.</span><span class="ident" id="7871761">Fun</span><span class="op" id="7871764">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7871768">&#34;L&#34;</span><span class="op" id="7871771">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7871775">ast</span><span class="op" id="7871778">.</span><span class="ident" id="7871779">Lbl</span><span class="op" id="7871782">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7871785">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7871789">ast</span><span class="op" id="7871792">.</span><span class="ident" id="7871793">Inspect</span><span class="op" id="7871800">(</span><span class="ident" id="7871801">f</span><span class="op" id="7871802">,</span>&nbsp;<span class="keyword" id="7871804">func</span><span class="op" id="7871808">(</span><span class="ident" id="7871809">n</span>&nbsp;<span class="ident" id="7871811">ast</span><span class="op" id="7871814">.</span><span class="ident" id="7871815">Node</span><span class="op" id="7871819">)</span>&nbsp;<span class="builtintype" id="7871821">bool</span>&nbsp;<span class="op" id="7871826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7871830">if</span>&nbsp;<span class="ident" id="7871833">ident</span><span class="op" id="7871838">,</span>&nbsp;<span class="ident" id="7871840">ok</span>&nbsp;<span class="op" id="7871843">:=</span>&nbsp;<span class="ident" id="7871846">n</span><span class="op" id="7871847">.</span><span class="op" id="7871848">(</span><span class="op" id="7871849">*</span><span class="ident" id="7871850">ast</span><span class="op" id="7871853">.</span><span class="ident" id="7871854">Ident</span><span class="op" id="7871859">)</span><span class="op" id="7871860">;</span>&nbsp;<span class="ident" id="7871862">ok</span>&nbsp;<span class="op" id="7871865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7871870">obj</span>&nbsp;<span class="op" id="7871874">:=</span>&nbsp;<span class="ident" id="7871877">ident</span><span class="op" id="7871882">.</span><span class="ident" id="7871883">Obj</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7871890">if</span>&nbsp;<span class="ident" id="7871893">obj</span>&nbsp;<span class="op" id="7871897">==</span>&nbsp;<span class="ident" id="7871900">nil</span>&nbsp;<span class="op" id="7871904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7871910">if</span>&nbsp;<span class="ident" id="7871913">objects</span><span class="op" id="7871920">[</span><span class="ident" id="7871921">ident</span><span class="op" id="7871926">.</span><span class="ident" id="7871927">Name</span><span class="op" id="7871931">]</span>&nbsp;<span class="op" id="7871933">!=</span>&nbsp;<span class="ident" id="7871936">ast</span><span class="op" id="7871939">.</span><span class="ident" id="7871940">Bad</span>&nbsp;<span class="op" id="7871944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7871951">t</span><span class="op" id="7871952">.</span><span class="ident" id="7871953">Errorf</span><span class="op" id="7871959">(</span><span class="string" id="7871960">&#34;no&nbsp;object&nbsp;for&nbsp;%s&#34;</span><span class="op" id="7871978">,</span>&nbsp;<span class="ident" id="7871980">ident</span><span class="op" id="7871985">.</span><span class="ident" id="7871986">Name</span><span class="op" id="7871990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7871996">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7872002">return</span>&nbsp;<span class="builtintype" id="7872009">true</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7872017">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7872022">if</span>&nbsp;<span class="ident" id="7872025">obj</span><span class="op" id="7872028">.</span><span class="ident" id="7872029">Name</span>&nbsp;<span class="op" id="7872034">!=</span>&nbsp;<span class="ident" id="7872037">ident</span><span class="op" id="7872042">.</span><span class="ident" id="7872043">Name</span>&nbsp;<span class="op" id="7872048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7872054">t</span><span class="op" id="7872055">.</span><span class="ident" id="7872056">Errorf</span><span class="op" id="7872062">(</span><span class="string" id="7872063">&#34;names&nbsp;don&#39;t&nbsp;match:&nbsp;obj.Name&nbsp;=&nbsp;%s,&nbsp;ident.Name&nbsp;=&nbsp;%s&#34;</span><span class="op" id="7872114">,</span>&nbsp;<span class="ident" id="7872116">obj</span><span class="op" id="7872119">.</span><span class="ident" id="7872120">Name</span><span class="op" id="7872124">,</span>&nbsp;<span class="ident" id="7872126">ident</span><span class="op" id="7872131">.</span><span class="ident" id="7872132">Name</span><span class="op" id="7872136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7872141">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7872146">kind</span>&nbsp;<span class="op" id="7872151">:=</span>&nbsp;<span class="ident" id="7872154">objects</span><span class="op" id="7872161">[</span><span class="ident" id="7872162">ident</span><span class="op" id="7872167">.</span><span class="ident" id="7872168">Name</span><span class="op" id="7872172">]</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7872177">if</span>&nbsp;<span class="ident" id="7872180">obj</span><span class="op" id="7872183">.</span><span class="ident" id="7872184">Kind</span>&nbsp;<span class="op" id="7872189">!=</span>&nbsp;<span class="ident" id="7872192">kind</span>&nbsp;<span class="op" id="7872197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7872203">t</span><span class="op" id="7872204">.</span><span class="ident" id="7872205">Errorf</span><span class="op" id="7872211">(</span><span class="string" id="7872212">&#34;%s:&nbsp;obj.Kind&nbsp;=&nbsp;%s;&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7872240">,</span>&nbsp;<span class="ident" id="7872242">ident</span><span class="op" id="7872247">.</span><span class="ident" id="7872248">Name</span><span class="op" id="7872252">,</span>&nbsp;<span class="ident" id="7872254">obj</span><span class="op" id="7872257">.</span><span class="ident" id="7872258">Kind</span><span class="op" id="7872262">,</span>&nbsp;<span class="ident" id="7872264">kind</span><span class="op" id="7872268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7872273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7872277">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7872281">return</span>&nbsp;<span class="builtintype" id="7872288">true</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7872294">}</span><span class="op" id="7872295">)</span><br>
<span class="lineno"></span><span class="op" id="7872297">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7872300">func</span>&nbsp;<span class="ident" id="7872305">TestUnresolved</span><span class="op" id="7872319">(</span><span class="ident" id="7872320">t</span>&nbsp;<span class="op" id="7872322">*</span><span class="ident" id="7872323">testing</span><span class="op" id="7872330">.</span><span class="ident" id="7872331">T</span><span class="op" id="7872332">)</span>&nbsp;<span class="op" id="7872334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7872337">f</span><span class="op" id="7872338">,</span>&nbsp;<span class="ident" id="7872340">err</span>&nbsp;<span class="op" id="7872344">:=</span>&nbsp;<span class="ident" id="7872347">ParseFile</span><span class="op" id="7872356">(</span><span class="ident" id="7872357">fset</span><span class="op" id="7872361">,</span>&nbsp;<span class="string" id="7872363">&#34;&#34;</span><span class="op" id="7872365">,</span>&nbsp;<span class="string" id="7872367">`<br>
<span class="lineno">225</span>package&nbsp;p<br>
<span class="lineno"></span>//<br>
<span class="lineno"></span>func&nbsp;f1a(int)<br>
<span class="lineno"></span>func&nbsp;f2a(byte,&nbsp;int,&nbsp;float)<br>
<span class="lineno"></span>func&nbsp;f3a(a,&nbsp;b&nbsp;int,&nbsp;c&nbsp;float)<br>
<span class="lineno">230</span>func&nbsp;f4a(...complex)<br>
<span class="lineno"></span>func&nbsp;f5a(a&nbsp;s1a,&nbsp;b&nbsp;...complex)<br>
<span class="lineno"></span>//<br>
<span class="lineno"></span>func&nbsp;f1b(*int)<br>
<span class="lineno"></span>func&nbsp;f2b([]byte,&nbsp;(int),&nbsp;*float)<br>
<span class="lineno">235</span>func&nbsp;f3b(a,&nbsp;b&nbsp;*int,&nbsp;c&nbsp;[]float)<br>
<span class="lineno"></span>func&nbsp;f4b(...*complex)<br>
<span class="lineno"></span>func&nbsp;f5b(a&nbsp;s1a,&nbsp;b&nbsp;...[]complex)<br>
<span class="lineno"></span>//<br>
<span class="lineno"></span>type&nbsp;s1a&nbsp;struct&nbsp;{&nbsp;int&nbsp;}<br>
<span class="lineno">240</span>type&nbsp;s2a&nbsp;struct&nbsp;{&nbsp;byte;&nbsp;int;&nbsp;s1a&nbsp;}<br>
<span class="lineno"></span>type&nbsp;s3a&nbsp;struct&nbsp;{&nbsp;a,&nbsp;b&nbsp;int;&nbsp;c&nbsp;float&nbsp;}<br>
<span class="lineno"></span>//<br>
<span class="lineno"></span>type&nbsp;s1b&nbsp;struct&nbsp;{&nbsp;*int&nbsp;}<br>
<span class="lineno"></span>type&nbsp;s2b&nbsp;struct&nbsp;{&nbsp;byte;&nbsp;int;&nbsp;*float&nbsp;}<br>
<span class="lineno">245</span>type&nbsp;s3b&nbsp;struct&nbsp;{&nbsp;a,&nbsp;b&nbsp;*s3b;&nbsp;c&nbsp;[]float&nbsp;}<br>
<span class="lineno"></span>`</span><span class="op" id="7872845">,</span>&nbsp;<span class="num" id="7872847">0</span><span class="op" id="7872848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7872851">if</span>&nbsp;<span class="ident" id="7872854">err</span>&nbsp;<span class="op" id="7872858">!=</span>&nbsp;<span class="ident" id="7872861">nil</span>&nbsp;<span class="op" id="7872865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7872869">t</span><span class="op" id="7872870">.</span><span class="ident" id="7872871">Fatal</span><span class="op" id="7872876">(</span><span class="ident" id="7872877">err</span><span class="op" id="7872880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7872883">}</span><br>
<span class="lineno">250</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7872887">want</span>&nbsp;<span class="op" id="7872892">:=</span>&nbsp;<span class="string" id="7872895">&#34;int&nbsp;&#34;</span>&nbsp;<span class="op" id="7872902">+</span>&nbsp;<span class="comment" id="7872904">//&nbsp;f1a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7872913">&#34;byte&nbsp;int&nbsp;float&nbsp;&#34;</span>&nbsp;<span class="op" id="7872931">+</span>&nbsp;<span class="comment" id="7872933">//&nbsp;f2a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7872942">&#34;int&nbsp;float&nbsp;&#34;</span>&nbsp;<span class="op" id="7872955">+</span>&nbsp;<span class="comment" id="7872957">//&nbsp;f3a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7872966">&#34;complex&nbsp;&#34;</span>&nbsp;<span class="op" id="7872977">+</span>&nbsp;<span class="comment" id="7872979">//&nbsp;f4a</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7872988">&#34;complex&nbsp;&#34;</span>&nbsp;<span class="op" id="7872999">+</span>&nbsp;<span class="comment" id="7873001">//&nbsp;f5a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7873010">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7873015">&#34;int&nbsp;&#34;</span>&nbsp;<span class="op" id="7873022">+</span>&nbsp;<span class="comment" id="7873024">//&nbsp;f1b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7873033">&#34;byte&nbsp;int&nbsp;float&nbsp;&#34;</span>&nbsp;<span class="op" id="7873051">+</span>&nbsp;<span class="comment" id="7873053">//&nbsp;f2b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7873062">&#34;int&nbsp;float&nbsp;&#34;</span>&nbsp;<span class="op" id="7873075">+</span>&nbsp;<span class="comment" id="7873077">//&nbsp;f3b</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7873086">&#34;complex&nbsp;&#34;</span>&nbsp;<span class="op" id="7873097">+</span>&nbsp;<span class="comment" id="7873099">//&nbsp;f4b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7873108">&#34;complex&nbsp;&#34;</span>&nbsp;<span class="op" id="7873119">+</span>&nbsp;<span class="comment" id="7873121">//&nbsp;f5b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7873130">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7873135">&#34;int&nbsp;&#34;</span>&nbsp;<span class="op" id="7873142">+</span>&nbsp;<span class="comment" id="7873144">//&nbsp;s1a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7873153">&#34;byte&nbsp;int&nbsp;&#34;</span>&nbsp;<span class="op" id="7873165">+</span>&nbsp;<span class="comment" id="7873167">//&nbsp;s2a</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7873176">&#34;int&nbsp;float&nbsp;&#34;</span>&nbsp;<span class="op" id="7873189">+</span>&nbsp;<span class="comment" id="7873191">//&nbsp;s3a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7873200">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7873205">&#34;int&nbsp;&#34;</span>&nbsp;<span class="op" id="7873212">+</span>&nbsp;<span class="comment" id="7873214">//&nbsp;s1a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7873223">&#34;byte&nbsp;int&nbsp;float&nbsp;&#34;</span>&nbsp;<span class="op" id="7873241">+</span>&nbsp;<span class="comment" id="7873243">//&nbsp;s2a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7873252">&#34;float&nbsp;&#34;</span>&nbsp;<span class="comment" id="7873261">//&nbsp;s3a</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7873270">//&nbsp;collect&nbsp;unresolved&nbsp;identifiers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7873305">var</span>&nbsp;<span class="ident" id="7873309">buf</span>&nbsp;<span class="ident" id="7873313">bytes</span><span class="op" id="7873318">.</span><span class="ident" id="7873319">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7873327">for</span>&nbsp;<span class="ident" id="7873331">_</span><span class="op" id="7873332">,</span>&nbsp;<span class="ident" id="7873334">u</span>&nbsp;<span class="op" id="7873336">:=</span>&nbsp;<span class="keyword" id="7873339">range</span>&nbsp;<span class="ident" id="7873345">f</span><span class="op" id="7873346">.</span><span class="ident" id="7873347">Unresolved</span>&nbsp;<span class="op" id="7873358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7873362">buf</span><span class="op" id="7873365">.</span><span class="ident" id="7873366">WriteString</span><span class="op" id="7873377">(</span><span class="ident" id="7873378">u</span><span class="op" id="7873379">.</span><span class="ident" id="7873380">Name</span><span class="op" id="7873384">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7873388">buf</span><span class="op" id="7873391">.</span><span class="ident" id="7873392">WriteByte</span><span class="op" id="7873401">(</span><span class="string" id="7873402">&#39;&nbsp;&#39;</span><span class="op" id="7873405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7873408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7873411">got</span>&nbsp;<span class="op" id="7873415">:=</span>&nbsp;<span class="ident" id="7873418">buf</span><span class="op" id="7873421">.</span><span class="ident" id="7873422">String</span><span class="op" id="7873428">(</span><span class="op" id="7873429">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7873433">if</span>&nbsp;<span class="ident" id="7873436">got</span>&nbsp;<span class="op" id="7873440">!=</span>&nbsp;<span class="ident" id="7873443">want</span>&nbsp;<span class="op" id="7873448">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7873452">t</span><span class="op" id="7873453">.</span><span class="ident" id="7873454">Errorf</span><span class="op" id="7873460">(</span><span class="string" id="7873461">&#34;\ngot:&nbsp;&nbsp;%s\nwant:&nbsp;%s&#34;</span><span class="op" id="7873483">,</span>&nbsp;<span class="ident" id="7873485">got</span><span class="op" id="7873488">,</span>&nbsp;<span class="ident" id="7873490">want</span><span class="op" id="7873494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7873497">}</span><br>
<span class="lineno"></span><span class="op" id="7873499">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7873502">var</span>&nbsp;<span class="ident" id="7873506">imports</span>&nbsp;<span class="op" id="7873514">=</span>&nbsp;<span class="keyword" id="7873516">map</span><span class="op" id="7873519">[</span><span class="builtintype" id="7873520">string</span><span class="op" id="7873526">]</span><span class="builtintype" id="7873527">bool</span><span class="op" id="7873531">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7873534">`&#34;a&#34;`</span><span class="op" id="7873539">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7873548">true</span><span class="op" id="7873552">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7873555">&#34;`a`&#34;</span><span class="op" id="7873560">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7873569">true</span><span class="op" id="7873573">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7873576">`&#34;a/b&#34;`</span><span class="op" id="7873583">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7873590">true</span><span class="op" id="7873594">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7873597">`&#34;a.b&#34;`</span><span class="op" id="7873604">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7873611">true</span><span class="op" id="7873615">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7873618">`&#34;m\x61th&#34;`</span><span class="op" id="7873629">:</span>&nbsp;&nbsp;<span class="builtintype" id="7873632">true</span><span class="op" id="7873636">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7873639">`&#34;greek/αβ&#34;`</span><span class="op" id="7873653">:</span>&nbsp;<span class="builtintype" id="7873655">true</span><span class="op" id="7873659">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7873662">`&#34;&#34;`</span><span class="op" id="7873666">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7873676">false</span><span class="op" id="7873681">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7873685">//&nbsp;Each&nbsp;of&nbsp;these&nbsp;pairs&nbsp;tests&nbsp;both&nbsp;``&nbsp;vs&nbsp;&#34;&#34;&nbsp;strings</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7873737">//&nbsp;and&nbsp;also&nbsp;use&nbsp;of&nbsp;invalid&nbsp;characters&nbsp;spelled&nbsp;out&nbsp;as</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7873791">//&nbsp;escape&nbsp;sequences&nbsp;and&nbsp;written&nbsp;directly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7873834">//&nbsp;For&nbsp;example&nbsp;`&#34;\x00&#34;`&nbsp;tests&nbsp;import&nbsp;&#34;\x00&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7873879">//&nbsp;while&nbsp;&#34;`\x00`&#34;&nbsp;tests&nbsp;import&nbsp;`&lt;actual-NUL-byte&gt;`.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7873932">`&#34;\x00&#34;`</span><span class="op" id="7873940">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7873946">false</span><span class="op" id="7873951">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7873954">&#34;`\x00`&#34;</span><span class="op" id="7873962">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7873968">false</span><span class="op" id="7873973">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7873976">`&#34;\x7f&#34;`</span><span class="op" id="7873984">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7873990">false</span><span class="op" id="7873995">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7873998">&#34;`\x7f`&#34;</span><span class="op" id="7874006">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7874012">false</span><span class="op" id="7874017">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7874020">`&#34;a!&#34;`</span><span class="op" id="7874026">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7874034">false</span><span class="op" id="7874039">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7874042">&#34;`a!`&#34;</span><span class="op" id="7874048">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7874056">false</span><span class="op" id="7874061">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7874064">`&#34;a&nbsp;b&#34;`</span><span class="op" id="7874071">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7874078">false</span><span class="op" id="7874083">,</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7874086">&#34;`a&nbsp;b`&#34;</span><span class="op" id="7874093">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7874100">false</span><span class="op" id="7874105">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7874108">`&#34;a\\b&#34;`</span><span class="op" id="7874116">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7874122">false</span><span class="op" id="7874127">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7874130">&#34;`a\\b`&#34;</span><span class="op" id="7874138">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7874144">false</span><span class="op" id="7874149">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7874152">&#34;\&#34;`a`\&#34;&#34;</span><span class="op" id="7874161">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7874166">false</span><span class="op" id="7874171">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7874174">&#34;`\&#34;a\&#34;`&#34;</span><span class="op" id="7874183">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7874188">false</span><span class="op" id="7874193">,</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7874196">`&#34;\x80\x80&#34;`</span><span class="op" id="7874208">:</span>&nbsp;<span class="builtintype" id="7874210">false</span><span class="op" id="7874215">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7874218">&#34;`\x80\x80`&#34;</span><span class="op" id="7874230">:</span>&nbsp;<span class="builtintype" id="7874232">false</span><span class="op" id="7874237">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7874240">`&#34;\xFFFD&#34;`</span><span class="op" id="7874250">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7874254">false</span><span class="op" id="7874259">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7874262">&#34;`\xFFFD`&#34;</span><span class="op" id="7874272">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7874276">false</span><span class="op" id="7874281">,</span><br>
<span class="lineno"></span><span class="op" id="7874283">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="keyword" id="7874286">func</span>&nbsp;<span class="ident" id="7874291">TestImports</span><span class="op" id="7874302">(</span><span class="ident" id="7874303">t</span>&nbsp;<span class="op" id="7874305">*</span><span class="ident" id="7874306">testing</span><span class="op" id="7874313">.</span><span class="ident" id="7874314">T</span><span class="op" id="7874315">)</span>&nbsp;<span class="op" id="7874317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7874320">for</span>&nbsp;<span class="ident" id="7874324">path</span><span class="op" id="7874328">,</span>&nbsp;<span class="ident" id="7874330">isValid</span>&nbsp;<span class="op" id="7874338">:=</span>&nbsp;<span class="keyword" id="7874341">range</span>&nbsp;<span class="ident" id="7874347">imports</span>&nbsp;<span class="op" id="7874355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7874359">src</span>&nbsp;<span class="op" id="7874363">:=</span>&nbsp;<span class="ident" id="7874366">fmt</span><span class="op" id="7874369">.</span><span class="ident" id="7874370">Sprintf</span><span class="op" id="7874377">(</span><span class="string" id="7874378">&#34;package&nbsp;p;&nbsp;import&nbsp;%s&#34;</span><span class="op" id="7874400">,</span>&nbsp;<span class="ident" id="7874402">path</span><span class="op" id="7874406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7874410">_</span><span class="op" id="7874411">,</span>&nbsp;<span class="ident" id="7874413">err</span>&nbsp;<span class="op" id="7874417">:=</span>&nbsp;<span class="ident" id="7874420">ParseFile</span><span class="op" id="7874429">(</span><span class="ident" id="7874430">fset</span><span class="op" id="7874434">,</span>&nbsp;<span class="string" id="7874436">&#34;&#34;</span><span class="op" id="7874438">,</span>&nbsp;<span class="ident" id="7874440">src</span><span class="op" id="7874443">,</span>&nbsp;<span class="num" id="7874445">0</span><span class="op" id="7874446">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7874450">switch</span>&nbsp;<span class="op" id="7874457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7874461">case</span>&nbsp;<span class="ident" id="7874466">err</span>&nbsp;<span class="op" id="7874470">!=</span>&nbsp;<span class="ident" id="7874473">nil</span>&nbsp;<span class="op" id="7874477">&amp;&amp;</span>&nbsp;<span class="ident" id="7874480">isValid</span><span class="op" id="7874487">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7874492">t</span><span class="op" id="7874493">.</span><span class="ident" id="7874494">Errorf</span><span class="op" id="7874500">(</span><span class="string" id="7874501">&#34;ParseFile(%s):&nbsp;got&nbsp;%v;&nbsp;expected&nbsp;no&nbsp;error&#34;</span><span class="op" id="7874543">,</span>&nbsp;<span class="ident" id="7874545">src</span><span class="op" id="7874548">,</span>&nbsp;<span class="ident" id="7874550">err</span><span class="op" id="7874553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7874557">case</span>&nbsp;<span class="ident" id="7874562">err</span>&nbsp;<span class="op" id="7874566">==</span>&nbsp;<span class="ident" id="7874569">nil</span>&nbsp;<span class="op" id="7874573">&amp;&amp;</span>&nbsp;<span class="op" id="7874576">!</span><span class="ident" id="7874577">isValid</span><span class="op" id="7874584">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7874589">t</span><span class="op" id="7874590">.</span><span class="ident" id="7874591">Errorf</span><span class="op" id="7874597">(</span><span class="string" id="7874598">&#34;ParseFile(%s):&nbsp;got&nbsp;no&nbsp;error;&nbsp;expected&nbsp;one&#34;</span><span class="op" id="7874641">,</span>&nbsp;<span class="ident" id="7874643">src</span><span class="op" id="7874646">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7874650">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7874653">}</span><br>
<span class="lineno"></span><span class="op" id="7874655">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7874658">func</span>&nbsp;<span class="ident" id="7874663">TestCommentGroups</span><span class="op" id="7874680">(</span><span class="ident" id="7874681">t</span>&nbsp;<span class="op" id="7874683">*</span><span class="ident" id="7874684">testing</span><span class="op" id="7874691">.</span><span class="ident" id="7874692">T</span><span class="op" id="7874693">)</span>&nbsp;<span class="op" id="7874695">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7874698">f</span><span class="op" id="7874699">,</span>&nbsp;<span class="ident" id="7874701">err</span>&nbsp;<span class="op" id="7874705">:=</span>&nbsp;<span class="ident" id="7874708">ParseFile</span><span class="op" id="7874717">(</span><span class="ident" id="7874718">fset</span><span class="op" id="7874722">,</span>&nbsp;<span class="string" id="7874724">&#34;&#34;</span><span class="op" id="7874726">,</span>&nbsp;<span class="string" id="7874728">`<br>
<span class="lineno"></span>package&nbsp;p&nbsp;/*&nbsp;1a&nbsp;*/&nbsp;/*&nbsp;1b&nbsp;*/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;1c&nbsp;*/&nbsp;//&nbsp;1d<br>
<span class="lineno"></span>/*&nbsp;2a<br>
<span class="lineno"></span>*/<br>
<span class="lineno"></span>//&nbsp;2b<br>
<span class="lineno">335</span>const&nbsp;pi&nbsp;=&nbsp;3.1415<br>
<span class="lineno"></span>/*&nbsp;3a&nbsp;*/&nbsp;//&nbsp;3b<br>
<span class="lineno"></span>/*&nbsp;3c&nbsp;*/&nbsp;const&nbsp;e&nbsp;=&nbsp;2.7182<br>
<span class="lineno"></span><br>
<span class="lineno"></span>//&nbsp;Example&nbsp;from&nbsp;issue&nbsp;3139<br>
<span class="lineno">340</span>func&nbsp;ExampleCount()&nbsp;{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspfmt.Println(strings.Count(&#34;cheese&#34;,&nbsp;&#34;e&#34;))<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspfmt.Println(strings.Count(&#34;five&#34;,&nbsp;&#34;&#34;))&nbsp;//&nbsp;before&nbsp;&amp;&nbsp;after&nbsp;each&nbsp;rune<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;Output:<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;3<br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;5<br>
<span class="lineno"></span>}<br>
<span class="lineno"></span>`</span><span class="op" id="7875040">,</span>&nbsp;<span class="ident" id="7875042">ParseComments</span><span class="op" id="7875055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7875058">if</span>&nbsp;<span class="ident" id="7875061">err</span>&nbsp;<span class="op" id="7875065">!=</span>&nbsp;<span class="ident" id="7875068">nil</span>&nbsp;<span class="op" id="7875072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7875076">t</span><span class="op" id="7875077">.</span><span class="ident" id="7875078">Fatal</span><span class="op" id="7875083">(</span><span class="ident" id="7875084">err</span><span class="op" id="7875087">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7875090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7875093">expected</span>&nbsp;<span class="op" id="7875102">:=</span>&nbsp;<span class="op" id="7875105">[</span><span class="op" id="7875106">]</span><span class="op" id="7875107">[</span><span class="op" id="7875108">]</span><span class="builtintype" id="7875109">string</span><span class="op" id="7875115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7875119">{</span><span class="string" id="7875120">&#34;/*&nbsp;1a&nbsp;*/&#34;</span><span class="op" id="7875130">,</span>&nbsp;<span class="string" id="7875132">&#34;/*&nbsp;1b&nbsp;*/&#34;</span><span class="op" id="7875142">,</span>&nbsp;<span class="string" id="7875144">&#34;/*&nbsp;1c&nbsp;*/&#34;</span><span class="op" id="7875154">,</span>&nbsp;<span class="string" id="7875156">&#34;//&nbsp;1d&#34;</span><span class="op" id="7875163">}</span><span class="op" id="7875164">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7875168">{</span><span class="string" id="7875169">&#34;/*&nbsp;2a\n*/&#34;</span><span class="op" id="7875180">,</span>&nbsp;<span class="string" id="7875182">&#34;//&nbsp;2b&#34;</span><span class="op" id="7875189">}</span><span class="op" id="7875190">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7875194">{</span><span class="string" id="7875195">&#34;/*&nbsp;3a&nbsp;*/&#34;</span><span class="op" id="7875205">,</span>&nbsp;<span class="string" id="7875207">&#34;//&nbsp;3b&#34;</span><span class="op" id="7875214">,</span>&nbsp;<span class="string" id="7875216">&#34;/*&nbsp;3c&nbsp;*/&#34;</span><span class="op" id="7875226">}</span><span class="op" id="7875227">,</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7875231">{</span><span class="string" id="7875232">&#34;//&nbsp;Example&nbsp;from&nbsp;issue&nbsp;3139&#34;</span><span class="op" id="7875260">}</span><span class="op" id="7875261">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7875265">{</span><span class="string" id="7875266">&#34;//&nbsp;before&nbsp;&amp;&nbsp;after&nbsp;each&nbsp;rune&#34;</span><span class="op" id="7875295">}</span><span class="op" id="7875296">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7875300">{</span><span class="string" id="7875301">&#34;//&nbsp;Output:&#34;</span><span class="op" id="7875313">,</span>&nbsp;<span class="string" id="7875315">&#34;//&nbsp;3&#34;</span><span class="op" id="7875321">,</span>&nbsp;<span class="string" id="7875323">&#34;//&nbsp;5&#34;</span><span class="op" id="7875329">}</span><span class="op" id="7875330">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7875333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7875336">if</span>&nbsp;<span class="builtinfunc" id="7875339">len</span><span class="op" id="7875342">(</span><span class="ident" id="7875343">f</span><span class="op" id="7875344">.</span><span class="ident" id="7875345">Comments</span><span class="op" id="7875353">)</span>&nbsp;<span class="op" id="7875355">!=</span>&nbsp;<span class="builtinfunc" id="7875358">len</span><span class="op" id="7875361">(</span><span class="ident" id="7875362">expected</span><span class="op" id="7875370">)</span>&nbsp;<span class="op" id="7875372">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7875376">t</span><span class="op" id="7875377">.</span><span class="ident" id="7875378">Fatalf</span><span class="op" id="7875384">(</span><span class="string" id="7875385">&#34;got&nbsp;%d&nbsp;comment&nbsp;groups;&nbsp;expected&nbsp;%d&#34;</span><span class="op" id="7875421">,</span>&nbsp;<span class="builtinfunc" id="7875423">len</span><span class="op" id="7875426">(</span><span class="ident" id="7875427">f</span><span class="op" id="7875428">.</span><span class="ident" id="7875429">Comments</span><span class="op" id="7875437">)</span><span class="op" id="7875438">,</span>&nbsp;<span class="builtinfunc" id="7875440">len</span><span class="op" id="7875443">(</span><span class="ident" id="7875444">expected</span><span class="op" id="7875452">)</span><span class="op" id="7875453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7875456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7875459">for</span>&nbsp;<span class="ident" id="7875463">i</span><span class="op" id="7875464">,</span>&nbsp;<span class="ident" id="7875466">exp</span>&nbsp;<span class="op" id="7875470">:=</span>&nbsp;<span class="keyword" id="7875473">range</span>&nbsp;<span class="ident" id="7875479">expected</span>&nbsp;<span class="op" id="7875488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7875492">got</span>&nbsp;<span class="op" id="7875496">:=</span>&nbsp;<span class="ident" id="7875499">f</span><span class="op" id="7875500">.</span><span class="ident" id="7875501">Comments</span><span class="op" id="7875509">[</span><span class="ident" id="7875510">i</span><span class="op" id="7875511">]</span><span class="op" id="7875512">.</span><span class="ident" id="7875513">List</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7875520">if</span>&nbsp;<span class="builtinfunc" id="7875523">len</span><span class="op" id="7875526">(</span><span class="ident" id="7875527">got</span><span class="op" id="7875530">)</span>&nbsp;<span class="op" id="7875532">!=</span>&nbsp;<span class="builtinfunc" id="7875535">len</span><span class="op" id="7875538">(</span><span class="ident" id="7875539">exp</span><span class="op" id="7875542">)</span>&nbsp;<span class="op" id="7875544">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7875549">t</span><span class="op" id="7875550">.</span><span class="ident" id="7875551">Errorf</span><span class="op" id="7875557">(</span><span class="string" id="7875558">&#34;got&nbsp;%d&nbsp;comments&nbsp;in&nbsp;group&nbsp;%d;&nbsp;expected&nbsp;%d&#34;</span><span class="op" id="7875600">,</span>&nbsp;<span class="builtinfunc" id="7875602">len</span><span class="op" id="7875605">(</span><span class="ident" id="7875606">got</span><span class="op" id="7875609">)</span><span class="op" id="7875610">,</span>&nbsp;<span class="ident" id="7875612">i</span><span class="op" id="7875613">,</span>&nbsp;<span class="builtinfunc" id="7875615">len</span><span class="op" id="7875618">(</span><span class="ident" id="7875619">exp</span><span class="op" id="7875622">)</span><span class="op" id="7875623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7875628">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7875639">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7875643">for</span>&nbsp;<span class="ident" id="7875647">j</span><span class="op" id="7875648">,</span>&nbsp;<span class="ident" id="7875650">exp</span>&nbsp;<span class="op" id="7875654">:=</span>&nbsp;<span class="keyword" id="7875657">range</span>&nbsp;<span class="ident" id="7875663">exp</span>&nbsp;<span class="op" id="7875667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7875672">got</span>&nbsp;<span class="op" id="7875676">:=</span>&nbsp;<span class="ident" id="7875679">got</span><span class="op" id="7875682">[</span><span class="ident" id="7875683">j</span><span class="op" id="7875684">]</span><span class="op" id="7875685">.</span><span class="ident" id="7875686">Text</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7875694">if</span>&nbsp;<span class="ident" id="7875697">got</span>&nbsp;<span class="op" id="7875701">!=</span>&nbsp;<span class="ident" id="7875704">exp</span>&nbsp;<span class="op" id="7875708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7875714">t</span><span class="op" id="7875715">.</span><span class="ident" id="7875716">Errorf</span><span class="op" id="7875722">(</span><span class="string" id="7875723">&#34;got&nbsp;%q&nbsp;in&nbsp;group&nbsp;%d;&nbsp;expected&nbsp;%q&#34;</span><span class="op" id="7875756">,</span>&nbsp;<span class="ident" id="7875758">got</span><span class="op" id="7875761">,</span>&nbsp;<span class="ident" id="7875763">i</span><span class="op" id="7875764">,</span>&nbsp;<span class="ident" id="7875766">exp</span><span class="op" id="7875769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7875774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7875778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7875781">}</span><br>
<span class="lineno">375</span><span class="op" id="7875783">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7875786">func</span>&nbsp;<span class="ident" id="7875791">getField</span><span class="op" id="7875799">(</span><span class="ident" id="7875800">file</span>&nbsp;<span class="op" id="7875805">*</span><span class="ident" id="7875806">ast</span><span class="op" id="7875809">.</span><span class="ident" id="7875810">File</span><span class="op" id="7875814">,</span>&nbsp;<span class="ident" id="7875816">fieldname</span>&nbsp;<span class="builtintype" id="7875826">string</span><span class="op" id="7875832">)</span>&nbsp;<span class="op" id="7875834">*</span><span class="ident" id="7875835">ast</span><span class="op" id="7875838">.</span><span class="ident" id="7875839">Field</span>&nbsp;<span class="op" id="7875845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7875848">parts</span>&nbsp;<span class="op" id="7875854">:=</span>&nbsp;<span class="ident" id="7875857">strings</span><span class="op" id="7875864">.</span><span class="ident" id="7875865">Split</span><span class="op" id="7875870">(</span><span class="ident" id="7875871">fieldname</span><span class="op" id="7875880">,</span>&nbsp;<span class="string" id="7875882">&#34;.&#34;</span><span class="op" id="7875885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7875888">for</span>&nbsp;<span class="ident" id="7875892">_</span><span class="op" id="7875893">,</span>&nbsp;<span class="ident" id="7875895">d</span>&nbsp;<span class="op" id="7875897">:=</span>&nbsp;<span class="keyword" id="7875900">range</span>&nbsp;<span class="ident" id="7875906">file</span><span class="op" id="7875910">.</span><span class="ident" id="7875911">Decls</span>&nbsp;<span class="op" id="7875917">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7875921">if</span>&nbsp;<span class="ident" id="7875924">d</span><span class="op" id="7875925">,</span>&nbsp;<span class="ident" id="7875927">ok</span>&nbsp;<span class="op" id="7875930">:=</span>&nbsp;<span class="ident" id="7875933">d</span><span class="op" id="7875934">.</span><span class="op" id="7875935">(</span><span class="op" id="7875936">*</span><span class="ident" id="7875937">ast</span><span class="op" id="7875940">.</span><span class="ident" id="7875941">GenDecl</span><span class="op" id="7875948">)</span><span class="op" id="7875949">;</span>&nbsp;<span class="ident" id="7875951">ok</span>&nbsp;<span class="op" id="7875954">&amp;&amp;</span>&nbsp;<span class="ident" id="7875957">d</span><span class="op" id="7875958">.</span><span class="ident" id="7875959">Tok</span>&nbsp;<span class="op" id="7875963">==</span>&nbsp;<span class="ident" id="7875966">token</span><span class="op" id="7875971">.</span><span class="ident" id="7875972">TYPE</span>&nbsp;<span class="op" id="7875977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7875982">for</span>&nbsp;<span class="ident" id="7875986">_</span><span class="op" id="7875987">,</span>&nbsp;<span class="ident" id="7875989">s</span>&nbsp;<span class="op" id="7875991">:=</span>&nbsp;<span class="keyword" id="7875994">range</span>&nbsp;<span class="ident" id="7876000">d</span><span class="op" id="7876001">.</span><span class="ident" id="7876002">Specs</span>&nbsp;<span class="op" id="7876008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7876014">if</span>&nbsp;<span class="ident" id="7876017">s</span><span class="op" id="7876018">,</span>&nbsp;<span class="ident" id="7876020">ok</span>&nbsp;<span class="op" id="7876023">:=</span>&nbsp;<span class="ident" id="7876026">s</span><span class="op" id="7876027">.</span><span class="op" id="7876028">(</span><span class="op" id="7876029">*</span><span class="ident" id="7876030">ast</span><span class="op" id="7876033">.</span><span class="ident" id="7876034">TypeSpec</span><span class="op" id="7876042">)</span><span class="op" id="7876043">;</span>&nbsp;<span class="ident" id="7876045">ok</span>&nbsp;<span class="op" id="7876048">&amp;&amp;</span>&nbsp;<span class="ident" id="7876051">s</span><span class="op" id="7876052">.</span><span class="ident" id="7876053">Name</span><span class="op" id="7876057">.</span><span class="ident" id="7876058">Name</span>&nbsp;<span class="op" id="7876063">==</span>&nbsp;<span class="ident" id="7876066">parts</span><span class="op" id="7876071">[</span><span class="num" id="7876072">0</span><span class="op" id="7876073">]</span>&nbsp;<span class="op" id="7876075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7876082">if</span>&nbsp;<span class="ident" id="7876085">s</span><span class="op" id="7876086">,</span>&nbsp;<span class="ident" id="7876088">ok</span>&nbsp;<span class="op" id="7876091">:=</span>&nbsp;<span class="ident" id="7876094">s</span><span class="op" id="7876095">.</span><span class="ident" id="7876096">Type</span><span class="op" id="7876100">.</span><span class="op" id="7876101">(</span><span class="op" id="7876102">*</span><span class="ident" id="7876103">ast</span><span class="op" id="7876106">.</span><span class="ident" id="7876107">StructType</span><span class="op" id="7876117">)</span><span class="op" id="7876118">;</span>&nbsp;<span class="ident" id="7876120">ok</span>&nbsp;<span class="op" id="7876123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7876131">for</span>&nbsp;<span class="ident" id="7876135">_</span><span class="op" id="7876136">,</span>&nbsp;<span class="ident" id="7876138">f</span>&nbsp;<span class="op" id="7876140">:=</span>&nbsp;<span class="keyword" id="7876143">range</span>&nbsp;<span class="ident" id="7876149">s</span><span class="op" id="7876150">.</span><span class="ident" id="7876151">Fields</span><span class="op" id="7876157">.</span><span class="ident" id="7876158">List</span>&nbsp;<span class="op" id="7876163">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7876172">for</span>&nbsp;<span class="ident" id="7876176">_</span><span class="op" id="7876177">,</span>&nbsp;<span class="ident" id="7876179">name</span>&nbsp;<span class="op" id="7876184">:=</span>&nbsp;<span class="keyword" id="7876187">range</span>&nbsp;<span class="ident" id="7876193">f</span><span class="op" id="7876194">.</span><span class="ident" id="7876195">Names</span>&nbsp;<span class="op" id="7876201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7876211">if</span>&nbsp;<span class="ident" id="7876214">name</span><span class="op" id="7876218">.</span><span class="ident" id="7876219">Name</span>&nbsp;<span class="op" id="7876224">==</span>&nbsp;<span class="ident" id="7876227">parts</span><span class="op" id="7876232">[</span><span class="num" id="7876233">1</span><span class="op" id="7876234">]</span>&nbsp;<span class="op" id="7876236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7876247">return</span>&nbsp;<span class="ident" id="7876254">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7876264">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7876273">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7876281">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7876288">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7876294">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7876299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7876303">}</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7876306">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7876309">return</span>&nbsp;<span class="ident" id="7876316">nil</span><br>
<span class="lineno"></span><span class="op" id="7876320">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7876323">//&nbsp;Don&#39;t&nbsp;use&nbsp;ast.CommentGroup.Text()&nbsp;-&nbsp;we&nbsp;want&nbsp;to&nbsp;see&nbsp;exact&nbsp;comment&nbsp;text.</span><br>
<span class="lineno">400</span><span class="keyword" id="7876397">func</span>&nbsp;<span class="ident" id="7876402">commentText</span><span class="op" id="7876413">(</span><span class="ident" id="7876414">c</span>&nbsp;<span class="op" id="7876416">*</span><span class="ident" id="7876417">ast</span><span class="op" id="7876420">.</span><span class="ident" id="7876421">CommentGroup</span><span class="op" id="7876433">)</span>&nbsp;<span class="builtintype" id="7876435">string</span>&nbsp;<span class="op" id="7876442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7876445">var</span>&nbsp;<span class="ident" id="7876449">buf</span>&nbsp;<span class="ident" id="7876453">bytes</span><span class="op" id="7876458">.</span><span class="ident" id="7876459">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7876467">if</span>&nbsp;<span class="ident" id="7876470">c</span>&nbsp;<span class="op" id="7876472">!=</span>&nbsp;<span class="ident" id="7876475">nil</span>&nbsp;<span class="op" id="7876479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7876483">for</span>&nbsp;<span class="ident" id="7876487">_</span><span class="op" id="7876488">,</span>&nbsp;<span class="ident" id="7876490">c</span>&nbsp;<span class="op" id="7876492">:=</span>&nbsp;<span class="keyword" id="7876495">range</span>&nbsp;<span class="ident" id="7876501">c</span><span class="op" id="7876502">.</span><span class="ident" id="7876503">List</span>&nbsp;<span class="op" id="7876508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7876513">buf</span><span class="op" id="7876516">.</span><span class="ident" id="7876517">WriteString</span><span class="op" id="7876528">(</span><span class="ident" id="7876529">c</span><span class="op" id="7876530">.</span><span class="ident" id="7876531">Text</span><span class="op" id="7876535">)</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7876539">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7876542">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7876545">return</span>&nbsp;<span class="ident" id="7876552">buf</span><span class="op" id="7876555">.</span><span class="ident" id="7876556">String</span><span class="op" id="7876562">(</span><span class="op" id="7876563">)</span><br>
<span class="lineno"></span><span class="op" id="7876565">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span><span class="keyword" id="7876568">func</span>&nbsp;<span class="ident" id="7876573">checkFieldComments</span><span class="op" id="7876591">(</span><span class="ident" id="7876592">t</span>&nbsp;<span class="op" id="7876594">*</span><span class="ident" id="7876595">testing</span><span class="op" id="7876602">.</span><span class="ident" id="7876603">T</span><span class="op" id="7876604">,</span>&nbsp;<span class="ident" id="7876606">file</span>&nbsp;<span class="op" id="7876611">*</span><span class="ident" id="7876612">ast</span><span class="op" id="7876615">.</span><span class="ident" id="7876616">File</span><span class="op" id="7876620">,</span>&nbsp;<span class="ident" id="7876622">fieldname</span><span class="op" id="7876631">,</span>&nbsp;<span class="ident" id="7876633">lead</span><span class="op" id="7876637">,</span>&nbsp;<span class="ident" id="7876639">line</span>&nbsp;<span class="builtintype" id="7876644">string</span><span class="op" id="7876650">)</span>&nbsp;<span class="op" id="7876652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7876655">f</span>&nbsp;<span class="op" id="7876657">:=</span>&nbsp;<span class="ident" id="7876660">getField</span><span class="op" id="7876668">(</span><span class="ident" id="7876669">file</span><span class="op" id="7876673">,</span>&nbsp;<span class="ident" id="7876675">fieldname</span><span class="op" id="7876684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7876687">if</span>&nbsp;<span class="ident" id="7876690">f</span>&nbsp;<span class="op" id="7876692">==</span>&nbsp;<span class="ident" id="7876695">nil</span>&nbsp;<span class="op" id="7876699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7876703">t</span><span class="op" id="7876704">.</span><span class="ident" id="7876705">Fatalf</span><span class="op" id="7876711">(</span><span class="string" id="7876712">&#34;field&nbsp;not&nbsp;found:&nbsp;%s&#34;</span><span class="op" id="7876733">,</span>&nbsp;<span class="ident" id="7876735">fieldname</span><span class="op" id="7876744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7876747">}</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7876750">if</span>&nbsp;<span class="ident" id="7876753">got</span>&nbsp;<span class="op" id="7876757">:=</span>&nbsp;<span class="ident" id="7876760">commentText</span><span class="op" id="7876771">(</span><span class="ident" id="7876772">f</span><span class="op" id="7876773">.</span><span class="ident" id="7876774">Doc</span><span class="op" id="7876777">)</span><span class="op" id="7876778">;</span>&nbsp;<span class="ident" id="7876780">got</span>&nbsp;<span class="op" id="7876784">!=</span>&nbsp;<span class="ident" id="7876787">lead</span>&nbsp;<span class="op" id="7876792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7876796">t</span><span class="op" id="7876797">.</span><span class="ident" id="7876798">Errorf</span><span class="op" id="7876804">(</span><span class="string" id="7876805">&#34;got&nbsp;lead&nbsp;comment&nbsp;%q;&nbsp;expected&nbsp;%q&#34;</span><span class="op" id="7876839">,</span>&nbsp;<span class="ident" id="7876841">got</span><span class="op" id="7876844">,</span>&nbsp;<span class="ident" id="7876846">lead</span><span class="op" id="7876850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7876853">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7876856">if</span>&nbsp;<span class="ident" id="7876859">got</span>&nbsp;<span class="op" id="7876863">:=</span>&nbsp;<span class="ident" id="7876866">commentText</span><span class="op" id="7876877">(</span><span class="ident" id="7876878">f</span><span class="op" id="7876879">.</span><span class="ident" id="7876880">Comment</span><span class="op" id="7876887">)</span><span class="op" id="7876888">;</span>&nbsp;<span class="ident" id="7876890">got</span>&nbsp;<span class="op" id="7876894">!=</span>&nbsp;<span class="ident" id="7876897">line</span>&nbsp;<span class="op" id="7876902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7876906">t</span><span class="op" id="7876907">.</span><span class="ident" id="7876908">Errorf</span><span class="op" id="7876914">(</span><span class="string" id="7876915">&#34;got&nbsp;line&nbsp;comment&nbsp;%q;&nbsp;expected&nbsp;%q&#34;</span><span class="op" id="7876949">,</span>&nbsp;<span class="ident" id="7876951">got</span><span class="op" id="7876954">,</span>&nbsp;<span class="ident" id="7876956">line</span><span class="op" id="7876960">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7876963">}</span><br>
<span class="lineno"></span><span class="op" id="7876965">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7876968">func</span>&nbsp;<span class="ident" id="7876973">TestLeadAndLineComments</span><span class="op" id="7876996">(</span><span class="ident" id="7876997">t</span>&nbsp;<span class="op" id="7876999">*</span><span class="ident" id="7877000">testing</span><span class="op" id="7877007">.</span><span class="ident" id="7877008">T</span><span class="op" id="7877009">)</span>&nbsp;<span class="op" id="7877011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7877014">f</span><span class="op" id="7877015">,</span>&nbsp;<span class="ident" id="7877017">err</span>&nbsp;<span class="op" id="7877021">:=</span>&nbsp;<span class="ident" id="7877024">ParseFile</span><span class="op" id="7877033">(</span><span class="ident" id="7877034">fset</span><span class="op" id="7877038">,</span>&nbsp;<span class="string" id="7877040">&#34;&#34;</span><span class="op" id="7877042">,</span>&nbsp;<span class="string" id="7877044">`<br>
<span class="lineno">425</span>package&nbsp;p<br>
<span class="lineno"></span>type&nbsp;T&nbsp;struct&nbsp;{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp/*&nbsp;F1&nbsp;lead&nbsp;comment&nbsp;*/<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp//<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspF1&nbsp;int&nbsp;&nbsp;/*&nbsp;F1&nbsp;*/&nbsp;//&nbsp;line&nbsp;comment<br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;F2&nbsp;lead<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;comment<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspF2&nbsp;int&nbsp;&nbsp;//&nbsp;F2&nbsp;line&nbsp;comment<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;f3&nbsp;lead&nbsp;comment<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspf3&nbsp;int&nbsp;&nbsp;//&nbsp;f3&nbsp;line&nbsp;comment<br>
<span class="lineno">435</span>}<br>
<span class="lineno"></span>`</span><span class="op" id="7877236">,</span>&nbsp;<span class="ident" id="7877238">ParseComments</span><span class="op" id="7877251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7877254">if</span>&nbsp;<span class="ident" id="7877257">err</span>&nbsp;<span class="op" id="7877261">!=</span>&nbsp;<span class="ident" id="7877264">nil</span>&nbsp;<span class="op" id="7877268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7877272">t</span><span class="op" id="7877273">.</span><span class="ident" id="7877274">Fatal</span><span class="op" id="7877279">(</span><span class="ident" id="7877280">err</span><span class="op" id="7877283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7877286">}</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7877289">checkFieldComments</span><span class="op" id="7877307">(</span><span class="ident" id="7877308">t</span><span class="op" id="7877309">,</span>&nbsp;<span class="ident" id="7877311">f</span><span class="op" id="7877312">,</span>&nbsp;<span class="string" id="7877314">&#34;T.F1&#34;</span><span class="op" id="7877320">,</span>&nbsp;<span class="string" id="7877322">&#34;/*&nbsp;F1&nbsp;lead&nbsp;comment&nbsp;*///&#34;</span><span class="op" id="7877347">,</span>&nbsp;<span class="string" id="7877349">&#34;/*&nbsp;F1&nbsp;*///&nbsp;line&nbsp;comment&#34;</span><span class="op" id="7877374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7877377">checkFieldComments</span><span class="op" id="7877395">(</span><span class="ident" id="7877396">t</span><span class="op" id="7877397">,</span>&nbsp;<span class="ident" id="7877399">f</span><span class="op" id="7877400">,</span>&nbsp;<span class="string" id="7877402">&#34;T.F2&#34;</span><span class="op" id="7877408">,</span>&nbsp;<span class="string" id="7877410">&#34;//&nbsp;F2&nbsp;lead//&nbsp;comment&#34;</span><span class="op" id="7877432">,</span>&nbsp;<span class="string" id="7877434">&#34;//&nbsp;F2&nbsp;line&nbsp;comment&#34;</span><span class="op" id="7877454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7877457">checkFieldComments</span><span class="op" id="7877475">(</span><span class="ident" id="7877476">t</span><span class="op" id="7877477">,</span>&nbsp;<span class="ident" id="7877479">f</span><span class="op" id="7877480">,</span>&nbsp;<span class="string" id="7877482">&#34;T.f3&#34;</span><span class="op" id="7877488">,</span>&nbsp;<span class="string" id="7877490">&#34;//&nbsp;f3&nbsp;lead&nbsp;comment&#34;</span><span class="op" id="7877510">,</span>&nbsp;<span class="string" id="7877512">&#34;//&nbsp;f3&nbsp;line&nbsp;comment&#34;</span><span class="op" id="7877532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7877535">ast</span><span class="op" id="7877538">.</span><span class="ident" id="7877539">FileExports</span><span class="op" id="7877550">(</span><span class="ident" id="7877551">f</span><span class="op" id="7877552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7877555">checkFieldComments</span><span class="op" id="7877573">(</span><span class="ident" id="7877574">t</span><span class="op" id="7877575">,</span>&nbsp;<span class="ident" id="7877577">f</span><span class="op" id="7877578">,</span>&nbsp;<span class="string" id="7877580">&#34;T.F1&#34;</span><span class="op" id="7877586">,</span>&nbsp;<span class="string" id="7877588">&#34;/*&nbsp;F1&nbsp;lead&nbsp;comment&nbsp;*///&#34;</span><span class="op" id="7877613">,</span>&nbsp;<span class="string" id="7877615">&#34;/*&nbsp;F1&nbsp;*///&nbsp;line&nbsp;comment&#34;</span><span class="op" id="7877640">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7877643">checkFieldComments</span><span class="op" id="7877661">(</span><span class="ident" id="7877662">t</span><span class="op" id="7877663">,</span>&nbsp;<span class="ident" id="7877665">f</span><span class="op" id="7877666">,</span>&nbsp;<span class="string" id="7877668">&#34;T.F2&#34;</span><span class="op" id="7877674">,</span>&nbsp;<span class="string" id="7877676">&#34;//&nbsp;F2&nbsp;lead//&nbsp;comment&#34;</span><span class="op" id="7877698">,</span>&nbsp;<span class="string" id="7877700">&#34;//&nbsp;F2&nbsp;line&nbsp;comment&#34;</span><span class="op" id="7877720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7877723">if</span>&nbsp;<span class="ident" id="7877726">getField</span><span class="op" id="7877734">(</span><span class="ident" id="7877735">f</span><span class="op" id="7877736">,</span>&nbsp;<span class="string" id="7877738">&#34;T.f3&#34;</span><span class="op" id="7877744">)</span>&nbsp;<span class="op" id="7877746">!=</span>&nbsp;<span class="ident" id="7877749">nil</span>&nbsp;<span class="op" id="7877753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7877757">t</span><span class="op" id="7877758">.</span><span class="ident" id="7877759">Error</span><span class="op" id="7877764">(</span><span class="string" id="7877765">&#34;not&nbsp;expected&nbsp;to&nbsp;find&nbsp;T.f3&#34;</span><span class="op" id="7877792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7877795">}</span><br>
<span class="lineno"></span><span class="op" id="7877797">}</span>
</div>
</body>
</html>
