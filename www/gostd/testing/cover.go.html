<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>testing</h2>
<ul>
<li><a href="/gostd/testing/allocs.go.html">allocs.go</a></li>
<li><a href="/gostd/testing/allocs_test.go.html">allocs_test.go</a></li>
<li><a href="/gostd/testing/benchmark.go.html">benchmark.go</a></li>
<li><a href="/gostd/testing/benchmark_test.go.html">benchmark_test.go</a></li>
<li><a href="/gostd/testing/cover.go.html">cover.go</a></li>
<li><a href="/gostd/testing/example.go.html">example.go</a></li>
<li><a href="/gostd/testing/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/testing/testing.go.html">testing.go</a></li>
<li><a href="/gostd/testing/testing_test.go.html">testing_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6426338">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6426393">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6426447">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6426498">//&nbsp;Support&nbsp;for&nbsp;test&nbsp;coverage.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6426529">package</span>&nbsp;<span class="ident" id="6426537">testing</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6426546">import</span>&nbsp;<span class="op" id="6426553">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6426556">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6426563">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6426569">&#34;sync/atomic&#34;</span><br>
<span class="lineno"></span><span class="op" id="6426583">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="6426586">//&nbsp;CoverBlock&nbsp;records&nbsp;the&nbsp;coverage&nbsp;data&nbsp;for&nbsp;a&nbsp;single&nbsp;basic&nbsp;block.</span><br>
<span class="lineno"></span><span class="comment" id="6426652">//&nbsp;NOTE:&nbsp;This&nbsp;struct&nbsp;is&nbsp;internal&nbsp;to&nbsp;the&nbsp;testing&nbsp;infrastructure&nbsp;and&nbsp;may&nbsp;change.</span><br>
<span class="lineno"></span><span class="comment" id="6426731">//&nbsp;It&nbsp;is&nbsp;not&nbsp;covered&nbsp;(yet)&nbsp;by&nbsp;the&nbsp;Go&nbsp;1&nbsp;compatibility&nbsp;guidelines.</span><br>
<span class="lineno"></span><span class="keyword" id="6426796">type</span>&nbsp;<span class="ident" id="6426801">CoverBlock</span>&nbsp;<span class="keyword" id="6426812">struct</span>&nbsp;<span class="op" id="6426819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6426822">Line0</span>&nbsp;<span class="builtintype" id="6426828">uint32</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6426836">Col0</span>&nbsp;&nbsp;<span class="builtintype" id="6426842">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6426850">Line1</span>&nbsp;<span class="builtintype" id="6426856">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6426864">Col1</span>&nbsp;&nbsp;<span class="builtintype" id="6426870">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6426878">Stmts</span>&nbsp;<span class="builtintype" id="6426884">uint16</span><br>
<span class="lineno"></span><span class="op" id="6426891">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="6426894">var</span>&nbsp;<span class="ident" id="6426898">cover</span>&nbsp;<span class="ident" id="6426904">Cover</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6426911">//&nbsp;Cover&nbsp;records&nbsp;information&nbsp;about&nbsp;test&nbsp;coverage&nbsp;checking.</span><br>
<span class="lineno"></span><span class="comment" id="6426970">//&nbsp;NOTE:&nbsp;This&nbsp;struct&nbsp;is&nbsp;internal&nbsp;to&nbsp;the&nbsp;testing&nbsp;infrastructure&nbsp;and&nbsp;may&nbsp;change.</span><br>
<span class="lineno">30</span><span class="comment" id="6427049">//&nbsp;It&nbsp;is&nbsp;not&nbsp;covered&nbsp;(yet)&nbsp;by&nbsp;the&nbsp;Go&nbsp;1&nbsp;compatibility&nbsp;guidelines.</span><br>
<span class="lineno"></span><span class="keyword" id="6427114">type</span>&nbsp;<span class="ident" id="6427119">Cover</span>&nbsp;<span class="keyword" id="6427125">struct</span>&nbsp;<span class="op" id="6427132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6427135">Mode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6427151">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6427159">Counters</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6427175">map</span><span class="op" id="6427178">[</span><span class="builtintype" id="6427179">string</span><span class="op" id="6427185">]</span><span class="op" id="6427186">[</span><span class="op" id="6427187">]</span><span class="builtintype" id="6427188">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6427196">Blocks</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6427212">map</span><span class="op" id="6427215">[</span><span class="builtintype" id="6427216">string</span><span class="op" id="6427222">]</span><span class="op" id="6427223">[</span><span class="op" id="6427224">]</span><span class="ident" id="6427225">CoverBlock</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6427237">CoveredPackages</span>&nbsp;<span class="builtintype" id="6427253">string</span><br>
<span class="lineno"></span><span class="op" id="6427260">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6427263">//&nbsp;Coverage&nbsp;reports&nbsp;the&nbsp;current&nbsp;code&nbsp;coverage&nbsp;as&nbsp;a&nbsp;fraction&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;1].</span><br>
<span class="lineno"></span><span class="comment" id="6427344">//&nbsp;If&nbsp;coverage&nbsp;is&nbsp;not&nbsp;enabled,&nbsp;Coverage&nbsp;returns&nbsp;0.</span><br>
<span class="lineno">40</span><span class="comment" id="6427395">//</span><br>
<span class="lineno"></span><span class="comment" id="6427398">//&nbsp;When&nbsp;running&nbsp;a&nbsp;large&nbsp;set&nbsp;of&nbsp;sequential&nbsp;test&nbsp;cases,&nbsp;checking&nbsp;Coverage&nbsp;after&nbsp;each&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="6427485">//&nbsp;can&nbsp;be&nbsp;useful&nbsp;for&nbsp;identifying&nbsp;which&nbsp;test&nbsp;cases&nbsp;exercise&nbsp;new&nbsp;code&nbsp;paths.</span><br>
<span class="lineno"></span><span class="comment" id="6427560">//&nbsp;It&nbsp;is&nbsp;not&nbsp;a&nbsp;replacement&nbsp;for&nbsp;the&nbsp;reports&nbsp;generated&nbsp;by&nbsp;&#39;go&nbsp;test&nbsp;-cover&#39;&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="6427637">//&nbsp;&#39;go&nbsp;tool&nbsp;cover&#39;.</span><br>
<span class="lineno">45</span><span class="keyword" id="6427657">func</span>&nbsp;<span class="ident" id="6427662">Coverage</span><span class="op" id="6427670">(</span><span class="op" id="6427671">)</span>&nbsp;<span class="builtintype" id="6427673">float64</span>&nbsp;<span class="op" id="6427681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6427684">var</span>&nbsp;<span class="ident" id="6427688">n</span><span class="op" id="6427689">,</span>&nbsp;<span class="ident" id="6427691">d</span>&nbsp;<span class="ident" id="6427693">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6427700">for</span>&nbsp;<span class="ident" id="6427704">_</span><span class="op" id="6427705">,</span>&nbsp;<span class="ident" id="6427707">counters</span>&nbsp;<span class="op" id="6427716">:=</span>&nbsp;<span class="keyword" id="6427719">range</span>&nbsp;<span class="ident" id="6427725">cover</span><span class="op" id="6427730">.</span><span class="ident" id="6427731">Counters</span>&nbsp;<span class="op" id="6427740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6427744">for</span>&nbsp;<span class="ident" id="6427748">i</span>&nbsp;<span class="op" id="6427750">:=</span>&nbsp;<span class="keyword" id="6427753">range</span>&nbsp;<span class="ident" id="6427759">counters</span>&nbsp;<span class="op" id="6427768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6427773">if</span>&nbsp;<span class="ident" id="6427776">atomic</span><span class="op" id="6427782">.</span><span class="ident" id="6427783">LoadUint32</span><span class="op" id="6427793">(</span><span class="op" id="6427794">&amp;</span><span class="ident" id="6427795">counters</span><span class="op" id="6427803">[</span><span class="ident" id="6427804">i</span><span class="op" id="6427805">]</span><span class="op" id="6427806">)</span>&nbsp;<span class="op" id="6427808">&gt;</span>&nbsp;<span class="num" id="6427810">0</span>&nbsp;<span class="op" id="6427812">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6427818">n</span><span class="op" id="6427819">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6427825">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6427830">d</span><span class="op" id="6427831">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6427836">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6427839">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6427842">if</span>&nbsp;<span class="ident" id="6427845">d</span>&nbsp;<span class="op" id="6427847">==</span>&nbsp;<span class="num" id="6427850">0</span>&nbsp;<span class="op" id="6427852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6427856">return</span>&nbsp;<span class="num" id="6427863">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6427866">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6427869">return</span>&nbsp;<span class="builtintype" id="6427876">float64</span><span class="op" id="6427883">(</span><span class="ident" id="6427884">n</span><span class="op" id="6427885">)</span>&nbsp;<span class="op" id="6427887">/</span>&nbsp;<span class="builtintype" id="6427889">float64</span><span class="op" id="6427896">(</span><span class="ident" id="6427897">d</span><span class="op" id="6427898">)</span><br>
<span class="lineno"></span><span class="op" id="6427900">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="6427903">//&nbsp;RegisterCover&nbsp;records&nbsp;the&nbsp;coverage&nbsp;data&nbsp;accumulators&nbsp;for&nbsp;the&nbsp;tests.</span><br>
<span class="lineno"></span><span class="comment" id="6427974">//&nbsp;NOTE:&nbsp;This&nbsp;function&nbsp;is&nbsp;internal&nbsp;to&nbsp;the&nbsp;testing&nbsp;infrastructure&nbsp;and&nbsp;may&nbsp;change.</span><br>
<span class="lineno"></span><span class="comment" id="6428055">//&nbsp;It&nbsp;is&nbsp;not&nbsp;covered&nbsp;(yet)&nbsp;by&nbsp;the&nbsp;Go&nbsp;1&nbsp;compatibility&nbsp;guidelines.</span><br>
<span class="lineno"></span><span class="keyword" id="6428120">func</span>&nbsp;<span class="ident" id="6428125">RegisterCover</span><span class="op" id="6428138">(</span><span class="ident" id="6428139">c</span>&nbsp;<span class="ident" id="6428141">Cover</span><span class="op" id="6428146">)</span>&nbsp;<span class="op" id="6428148">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6428151">cover</span>&nbsp;<span class="op" id="6428157">=</span>&nbsp;<span class="ident" id="6428159">c</span><br>
<span class="lineno"></span><span class="op" id="6428161">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6428164">//&nbsp;mustBeNil&nbsp;checks&nbsp;the&nbsp;error&nbsp;and,&nbsp;if&nbsp;present,&nbsp;reports&nbsp;it&nbsp;and&nbsp;exits.</span><br>
<span class="lineno"></span><span class="keyword" id="6428233">func</span>&nbsp;<span class="ident" id="6428238">mustBeNil</span><span class="op" id="6428247">(</span><span class="ident" id="6428248">err</span>&nbsp;<span class="builtintype" id="6428252">error</span><span class="op" id="6428257">)</span>&nbsp;<span class="op" id="6428259">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6428262">if</span>&nbsp;<span class="ident" id="6428265">err</span>&nbsp;<span class="op" id="6428269">!=</span>&nbsp;<span class="ident" id="6428272">nil</span>&nbsp;<span class="op" id="6428276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6428280">fmt</span><span class="op" id="6428283">.</span><span class="ident" id="6428284">Fprintf</span><span class="op" id="6428291">(</span><span class="ident" id="6428292">os</span><span class="op" id="6428294">.</span><span class="ident" id="6428295">Stderr</span><span class="op" id="6428301">,</span>&nbsp;<span class="string" id="6428303">&#34;testing:&nbsp;%s\n&#34;</span><span class="op" id="6428318">,</span>&nbsp;<span class="ident" id="6428320">err</span><span class="op" id="6428323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6428327">os</span><span class="op" id="6428329">.</span><span class="ident" id="6428330">Exit</span><span class="op" id="6428334">(</span><span class="num" id="6428335">2</span><span class="op" id="6428336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6428339">}</span><br>
<span class="lineno"></span><span class="op" id="6428341">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="6428344">//&nbsp;coverReport&nbsp;reports&nbsp;the&nbsp;coverage&nbsp;percentage&nbsp;and&nbsp;writes&nbsp;a&nbsp;coverage&nbsp;profile&nbsp;if&nbsp;requested.</span><br>
<span class="lineno"></span><span class="keyword" id="6428435">func</span>&nbsp;<span class="ident" id="6428440">coverReport</span><span class="op" id="6428451">(</span><span class="op" id="6428452">)</span>&nbsp;<span class="op" id="6428454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6428457">var</span>&nbsp;<span class="ident" id="6428461">f</span>&nbsp;<span class="op" id="6428463">*</span><span class="ident" id="6428464">os</span><span class="op" id="6428466">.</span><span class="ident" id="6428467">File</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6428473">var</span>&nbsp;<span class="ident" id="6428477">err</span>&nbsp;<span class="builtintype" id="6428481">error</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6428488">if</span>&nbsp;<span class="op" id="6428491">*</span><span class="ident" id="6428492">coverProfile</span>&nbsp;<span class="op" id="6428505">!=</span>&nbsp;<span class="string" id="6428508">&#34;&#34;</span>&nbsp;<span class="op" id="6428511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6428515">f</span><span class="op" id="6428516">,</span>&nbsp;<span class="ident" id="6428518">err</span>&nbsp;<span class="op" id="6428522">=</span>&nbsp;<span class="ident" id="6428524">os</span><span class="op" id="6428526">.</span><span class="ident" id="6428527">Create</span><span class="op" id="6428533">(</span><span class="ident" id="6428534">toOutputDir</span><span class="op" id="6428545">(</span><span class="op" id="6428546">*</span><span class="ident" id="6428547">coverProfile</span><span class="op" id="6428559">)</span><span class="op" id="6428560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6428564">mustBeNil</span><span class="op" id="6428573">(</span><span class="ident" id="6428574">err</span><span class="op" id="6428577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6428581">fmt</span><span class="op" id="6428584">.</span><span class="ident" id="6428585">Fprintf</span><span class="op" id="6428592">(</span><span class="ident" id="6428593">f</span><span class="op" id="6428594">,</span>&nbsp;<span class="string" id="6428596">&#34;mode:&nbsp;%s\n&#34;</span><span class="op" id="6428608">,</span>&nbsp;<span class="ident" id="6428610">cover</span><span class="op" id="6428615">.</span><span class="ident" id="6428616">Mode</span><span class="op" id="6428620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6428624">defer</span>&nbsp;<span class="keyword" id="6428630">func</span><span class="op" id="6428634">(</span><span class="op" id="6428635">)</span>&nbsp;<span class="op" id="6428637">{</span>&nbsp;<span class="ident" id="6428639">mustBeNil</span><span class="op" id="6428648">(</span><span class="ident" id="6428649">f</span><span class="op" id="6428650">.</span><span class="ident" id="6428651">Close</span><span class="op" id="6428656">(</span><span class="op" id="6428657">)</span><span class="op" id="6428658">)</span>&nbsp;<span class="op" id="6428660">}</span><span class="op" id="6428661">(</span><span class="op" id="6428662">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6428665">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6428669">var</span>&nbsp;<span class="ident" id="6428673">active</span><span class="op" id="6428679">,</span>&nbsp;<span class="ident" id="6428681">total</span>&nbsp;<span class="ident" id="6428687">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6428694">var</span>&nbsp;<span class="ident" id="6428698">count</span>&nbsp;<span class="builtintype" id="6428704">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6428712">for</span>&nbsp;<span class="ident" id="6428716">name</span><span class="op" id="6428720">,</span>&nbsp;<span class="ident" id="6428722">counts</span>&nbsp;<span class="op" id="6428729">:=</span>&nbsp;<span class="keyword" id="6428732">range</span>&nbsp;<span class="ident" id="6428738">cover</span><span class="op" id="6428743">.</span><span class="ident" id="6428744">Counters</span>&nbsp;<span class="op" id="6428753">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6428757">blocks</span>&nbsp;<span class="op" id="6428764">:=</span>&nbsp;<span class="ident" id="6428767">cover</span><span class="op" id="6428772">.</span><span class="ident" id="6428773">Blocks</span><span class="op" id="6428779">[</span><span class="ident" id="6428780">name</span><span class="op" id="6428784">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6428788">for</span>&nbsp;<span class="ident" id="6428792">i</span>&nbsp;<span class="op" id="6428794">:=</span>&nbsp;<span class="keyword" id="6428797">range</span>&nbsp;<span class="ident" id="6428803">counts</span>&nbsp;<span class="op" id="6428810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6428815">stmts</span>&nbsp;<span class="op" id="6428821">:=</span>&nbsp;<span class="ident" id="6428824">int64</span><span class="op" id="6428829">(</span><span class="ident" id="6428830">blocks</span><span class="op" id="6428836">[</span><span class="ident" id="6428837">i</span><span class="op" id="6428838">]</span><span class="op" id="6428839">.</span><span class="ident" id="6428840">Stmts</span><span class="op" id="6428845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6428850">total</span>&nbsp;<span class="op" id="6428856">+=</span>&nbsp;<span class="ident" id="6428859">stmts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6428868">count</span>&nbsp;<span class="op" id="6428874">=</span>&nbsp;<span class="ident" id="6428876">atomic</span><span class="op" id="6428882">.</span><span class="ident" id="6428883">LoadUint32</span><span class="op" id="6428893">(</span><span class="op" id="6428894">&amp;</span><span class="ident" id="6428895">counts</span><span class="op" id="6428901">[</span><span class="ident" id="6428902">i</span><span class="op" id="6428903">]</span><span class="op" id="6428904">)</span>&nbsp;<span class="comment" id="6428906">//&nbsp;For&nbsp;-mode=atomic.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6428930">if</span>&nbsp;<span class="ident" id="6428933">count</span>&nbsp;<span class="op" id="6428939">&gt;</span>&nbsp;<span class="num" id="6428941">0</span>&nbsp;<span class="op" id="6428943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6428949">active</span>&nbsp;<span class="op" id="6428956">+=</span>&nbsp;<span class="ident" id="6428959">stmts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6428968">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6428973">if</span>&nbsp;<span class="ident" id="6428976">f</span>&nbsp;<span class="op" id="6428978">!=</span>&nbsp;<span class="ident" id="6428981">nil</span>&nbsp;<span class="op" id="6428985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6428991">_</span><span class="op" id="6428992">,</span>&nbsp;<span class="ident" id="6428994">err</span>&nbsp;<span class="op" id="6428998">:=</span>&nbsp;<span class="ident" id="6429001">fmt</span><span class="op" id="6429004">.</span><span class="ident" id="6429005">Fprintf</span><span class="op" id="6429012">(</span><span class="ident" id="6429013">f</span><span class="op" id="6429014">,</span>&nbsp;<span class="string" id="6429016">&#34;%s:%d.%d,%d.%d&nbsp;%d&nbsp;%d\n&#34;</span><span class="op" id="6429040">,</span>&nbsp;<span class="ident" id="6429042">name</span><span class="op" id="6429046">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6429053">blocks</span><span class="op" id="6429059">[</span><span class="ident" id="6429060">i</span><span class="op" id="6429061">]</span><span class="op" id="6429062">.</span><span class="ident" id="6429063">Line0</span><span class="op" id="6429068">,</span>&nbsp;<span class="ident" id="6429070">blocks</span><span class="op" id="6429076">[</span><span class="ident" id="6429077">i</span><span class="op" id="6429078">]</span><span class="op" id="6429079">.</span><span class="ident" id="6429080">Col0</span><span class="op" id="6429084">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6429091">blocks</span><span class="op" id="6429097">[</span><span class="ident" id="6429098">i</span><span class="op" id="6429099">]</span><span class="op" id="6429100">.</span><span class="ident" id="6429101">Line1</span><span class="op" id="6429106">,</span>&nbsp;<span class="ident" id="6429108">blocks</span><span class="op" id="6429114">[</span><span class="ident" id="6429115">i</span><span class="op" id="6429116">]</span><span class="op" id="6429117">.</span><span class="ident" id="6429118">Col1</span><span class="op" id="6429122">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6429129">stmts</span><span class="op" id="6429134">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6429141">count</span><span class="op" id="6429146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6429152">mustBeNil</span><span class="op" id="6429161">(</span><span class="ident" id="6429162">err</span><span class="op" id="6429165">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6429170">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6429174">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6429177">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6429180">if</span>&nbsp;<span class="ident" id="6429183">total</span>&nbsp;<span class="op" id="6429189">==</span>&nbsp;<span class="num" id="6429192">0</span>&nbsp;<span class="op" id="6429194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6429198">total</span>&nbsp;<span class="op" id="6429204">=</span>&nbsp;<span class="num" id="6429206">1</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6429209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6429212">fmt</span><span class="op" id="6429215">.</span><span class="ident" id="6429216">Printf</span><span class="op" id="6429222">(</span><span class="string" id="6429223">&#34;coverage:&nbsp;%.1f%%&nbsp;of&nbsp;statements%s\n&#34;</span><span class="op" id="6429259">,</span>&nbsp;<span class="num" id="6429261">100</span><span class="op" id="6429264">*</span><span class="builtintype" id="6429265">float64</span><span class="op" id="6429272">(</span><span class="ident" id="6429273">active</span><span class="op" id="6429279">)</span><span class="op" id="6429280">/</span><span class="builtintype" id="6429281">float64</span><span class="op" id="6429288">(</span><span class="ident" id="6429289">total</span><span class="op" id="6429294">)</span><span class="op" id="6429295">,</span>&nbsp;<span class="ident" id="6429297">cover</span><span class="op" id="6429302">.</span><span class="ident" id="6429303">CoveredPackages</span><span class="op" id="6429318">)</span><br>
<span class="lineno"></span><span class="op" id="6429320">}</span>
</div>
</body>
</html>
