<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/format</h2>
<ul>
<li><a href="/gostd/go/format/format.go.html">format.go</a></li>
<li><a href="/gostd/go/format/format_test.go.html" class="current">format_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7379201">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7379256">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7379310">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7379361">package</span>&nbsp;<span class="ident" id="7379369">format</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7379377">import</span>&nbsp;<span class="op" id="7379384">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7379387">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7379396">&#34;go/parser&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7379409">&#34;go/token&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7379421">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7379434">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7379445">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7379455">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="7379458">const</span>&nbsp;<span class="ident" id="7379464">testfile</span>&nbsp;<span class="op" id="7379473">=</span>&nbsp;<span class="string" id="7379475">&#34;format_test.go&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7379493">func</span>&nbsp;<span class="ident" id="7379498">diff</span><span class="op" id="7379502">(</span><span class="ident" id="7379503">t</span>&nbsp;<span class="op" id="7379505">*</span><span class="ident" id="7379506">testing</span><span class="op" id="7379513">.</span><span class="ident" id="7379514">T</span><span class="op" id="7379515">,</span>&nbsp;<span class="ident" id="7379517">dst</span><span class="op" id="7379520">,</span>&nbsp;<span class="ident" id="7379522">src</span>&nbsp;<span class="op" id="7379526">[</span><span class="op" id="7379527">]</span><span class="builtintype" id="7379528">byte</span><span class="op" id="7379532">)</span>&nbsp;<span class="op" id="7379534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7379537">line</span>&nbsp;<span class="op" id="7379542">:=</span>&nbsp;<span class="num" id="7379545">1</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7379548">offs</span>&nbsp;<span class="op" id="7379553">:=</span>&nbsp;<span class="num" id="7379556">0</span>&nbsp;<span class="comment" id="7379558">//&nbsp;line&nbsp;offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7379574">for</span>&nbsp;<span class="ident" id="7379578">i</span>&nbsp;<span class="op" id="7379580">:=</span>&nbsp;<span class="num" id="7379583">0</span><span class="op" id="7379584">;</span>&nbsp;<span class="ident" id="7379586">i</span>&nbsp;<span class="op" id="7379588">&lt;</span>&nbsp;<span class="builtinfunc" id="7379590">len</span><span class="op" id="7379593">(</span><span class="ident" id="7379594">dst</span><span class="op" id="7379597">)</span>&nbsp;<span class="op" id="7379599">&amp;&amp;</span>&nbsp;<span class="ident" id="7379602">i</span>&nbsp;<span class="op" id="7379604">&lt;</span>&nbsp;<span class="builtinfunc" id="7379606">len</span><span class="op" id="7379609">(</span><span class="ident" id="7379610">src</span><span class="op" id="7379613">)</span><span class="op" id="7379614">;</span>&nbsp;<span class="ident" id="7379616">i</span><span class="op" id="7379617">++</span>&nbsp;<span class="op" id="7379620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7379624">d</span>&nbsp;<span class="op" id="7379626">:=</span>&nbsp;<span class="ident" id="7379629">dst</span><span class="op" id="7379632">[</span><span class="ident" id="7379633">i</span><span class="op" id="7379634">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7379638">s</span>&nbsp;<span class="op" id="7379640">:=</span>&nbsp;<span class="ident" id="7379643">src</span><span class="op" id="7379646">[</span><span class="ident" id="7379647">i</span><span class="op" id="7379648">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7379652">if</span>&nbsp;<span class="ident" id="7379655">d</span>&nbsp;<span class="op" id="7379657">!=</span>&nbsp;<span class="ident" id="7379660">s</span>&nbsp;<span class="op" id="7379662">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7379667">t</span><span class="op" id="7379668">.</span><span class="ident" id="7379669">Errorf</span><span class="op" id="7379675">(</span><span class="string" id="7379676">&#34;dst:%d:&nbsp;%s\n&#34;</span><span class="op" id="7379690">,</span>&nbsp;<span class="ident" id="7379692">line</span><span class="op" id="7379696">,</span>&nbsp;<span class="ident" id="7379698">dst</span><span class="op" id="7379701">[</span><span class="ident" id="7379702">offs</span><span class="op" id="7379706">:</span><span class="ident" id="7379707">i</span><span class="op" id="7379708">+</span><span class="num" id="7379709">1</span><span class="op" id="7379710">]</span><span class="op" id="7379711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7379716">t</span><span class="op" id="7379717">.</span><span class="ident" id="7379718">Errorf</span><span class="op" id="7379724">(</span><span class="string" id="7379725">&#34;src:%d:&nbsp;%s\n&#34;</span><span class="op" id="7379739">,</span>&nbsp;<span class="ident" id="7379741">line</span><span class="op" id="7379745">,</span>&nbsp;<span class="ident" id="7379747">src</span><span class="op" id="7379750">[</span><span class="ident" id="7379751">offs</span><span class="op" id="7379755">:</span><span class="ident" id="7379756">i</span><span class="op" id="7379757">+</span><span class="num" id="7379758">1</span><span class="op" id="7379759">]</span><span class="op" id="7379760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7379765">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7379774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7379778">if</span>&nbsp;<span class="ident" id="7379781">s</span>&nbsp;<span class="op" id="7379783">==</span>&nbsp;<span class="string" id="7379786">&#39;\n&#39;</span>&nbsp;<span class="op" id="7379791">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7379796">line</span><span class="op" id="7379800">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7379806">offs</span>&nbsp;<span class="op" id="7379811">=</span>&nbsp;<span class="ident" id="7379813">i</span>&nbsp;<span class="op" id="7379815">+</span>&nbsp;<span class="num" id="7379817">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7379821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7379824">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7379827">if</span>&nbsp;<span class="builtinfunc" id="7379830">len</span><span class="op" id="7379833">(</span><span class="ident" id="7379834">dst</span><span class="op" id="7379837">)</span>&nbsp;<span class="op" id="7379839">!=</span>&nbsp;<span class="builtinfunc" id="7379842">len</span><span class="op" id="7379845">(</span><span class="ident" id="7379846">src</span><span class="op" id="7379849">)</span>&nbsp;<span class="op" id="7379851">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7379855">t</span><span class="op" id="7379856">.</span><span class="ident" id="7379857">Errorf</span><span class="op" id="7379863">(</span><span class="string" id="7379864">&#34;len(dst)&nbsp;=&nbsp;%d,&nbsp;len(src)&nbsp;=&nbsp;%d\nsrc&nbsp;=&nbsp;%q&#34;</span><span class="op" id="7379904">,</span>&nbsp;<span class="builtinfunc" id="7379906">len</span><span class="op" id="7379909">(</span><span class="ident" id="7379910">dst</span><span class="op" id="7379913">)</span><span class="op" id="7379914">,</span>&nbsp;<span class="builtinfunc" id="7379916">len</span><span class="op" id="7379919">(</span><span class="ident" id="7379920">src</span><span class="op" id="7379923">)</span><span class="op" id="7379924">,</span>&nbsp;<span class="ident" id="7379926">src</span><span class="op" id="7379929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7379932">}</span><br>
<span class="lineno"></span><span class="op" id="7379934">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7379937">func</span>&nbsp;<span class="ident" id="7379942">TestNode</span><span class="op" id="7379950">(</span><span class="ident" id="7379951">t</span>&nbsp;<span class="op" id="7379953">*</span><span class="ident" id="7379954">testing</span><span class="op" id="7379961">.</span><span class="ident" id="7379962">T</span><span class="op" id="7379963">)</span>&nbsp;<span class="op" id="7379965">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7379968">src</span><span class="op" id="7379971">,</span>&nbsp;<span class="ident" id="7379973">err</span>&nbsp;<span class="op" id="7379977">:=</span>&nbsp;<span class="ident" id="7379980">ioutil</span><span class="op" id="7379986">.</span><span class="ident" id="7379987">ReadFile</span><span class="op" id="7379995">(</span><span class="ident" id="7379996">testfile</span><span class="op" id="7380004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7380007">if</span>&nbsp;<span class="ident" id="7380010">err</span>&nbsp;<span class="op" id="7380014">!=</span>&nbsp;<span class="ident" id="7380017">nil</span>&nbsp;<span class="op" id="7380021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7380025">t</span><span class="op" id="7380026">.</span><span class="ident" id="7380027">Fatal</span><span class="op" id="7380032">(</span><span class="ident" id="7380033">err</span><span class="op" id="7380036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7380039">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7380043">fset</span>&nbsp;<span class="op" id="7380048">:=</span>&nbsp;<span class="ident" id="7380051">token</span><span class="op" id="7380056">.</span><span class="ident" id="7380057">NewFileSet</span><span class="op" id="7380067">(</span><span class="op" id="7380068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7380071">file</span><span class="op" id="7380075">,</span>&nbsp;<span class="ident" id="7380077">err</span>&nbsp;<span class="op" id="7380081">:=</span>&nbsp;<span class="ident" id="7380084">parser</span><span class="op" id="7380090">.</span><span class="ident" id="7380091">ParseFile</span><span class="op" id="7380100">(</span><span class="ident" id="7380101">fset</span><span class="op" id="7380105">,</span>&nbsp;<span class="ident" id="7380107">testfile</span><span class="op" id="7380115">,</span>&nbsp;<span class="ident" id="7380117">src</span><span class="op" id="7380120">,</span>&nbsp;<span class="ident" id="7380122">parser</span><span class="op" id="7380128">.</span><span class="ident" id="7380129">ParseComments</span><span class="op" id="7380142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7380145">if</span>&nbsp;<span class="ident" id="7380148">err</span>&nbsp;<span class="op" id="7380152">!=</span>&nbsp;<span class="ident" id="7380155">nil</span>&nbsp;<span class="op" id="7380159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7380163">t</span><span class="op" id="7380164">.</span><span class="ident" id="7380165">Fatal</span><span class="op" id="7380170">(</span><span class="ident" id="7380171">err</span><span class="op" id="7380174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7380177">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7380181">var</span>&nbsp;<span class="ident" id="7380185">buf</span>&nbsp;<span class="ident" id="7380189">bytes</span><span class="op" id="7380194">.</span><span class="ident" id="7380195">Buffer</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7380204">if</span>&nbsp;<span class="ident" id="7380207">err</span>&nbsp;<span class="op" id="7380211">=</span>&nbsp;<span class="ident" id="7380213">Node</span><span class="op" id="7380217">(</span><span class="op" id="7380218">&amp;</span><span class="ident" id="7380219">buf</span><span class="op" id="7380222">,</span>&nbsp;<span class="ident" id="7380224">fset</span><span class="op" id="7380228">,</span>&nbsp;<span class="ident" id="7380230">file</span><span class="op" id="7380234">)</span><span class="op" id="7380235">;</span>&nbsp;<span class="ident" id="7380237">err</span>&nbsp;<span class="op" id="7380241">!=</span>&nbsp;<span class="ident" id="7380244">nil</span>&nbsp;<span class="op" id="7380248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7380252">t</span><span class="op" id="7380253">.</span><span class="ident" id="7380254">Fatal</span><span class="op" id="7380259">(</span><span class="string" id="7380260">&#34;Node&nbsp;failed:&#34;</span><span class="op" id="7380274">,</span>&nbsp;<span class="ident" id="7380276">err</span><span class="op" id="7380279">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7380282">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7380286">diff</span><span class="op" id="7380290">(</span><span class="ident" id="7380291">t</span><span class="op" id="7380292">,</span>&nbsp;<span class="ident" id="7380294">buf</span><span class="op" id="7380297">.</span><span class="ident" id="7380298">Bytes</span><span class="op" id="7380303">(</span><span class="op" id="7380304">)</span><span class="op" id="7380305">,</span>&nbsp;<span class="ident" id="7380307">src</span><span class="op" id="7380310">)</span><br>
<span class="lineno"></span><span class="op" id="7380312">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="keyword" id="7380315">func</span>&nbsp;<span class="ident" id="7380320">TestSource</span><span class="op" id="7380330">(</span><span class="ident" id="7380331">t</span>&nbsp;<span class="op" id="7380333">*</span><span class="ident" id="7380334">testing</span><span class="op" id="7380341">.</span><span class="ident" id="7380342">T</span><span class="op" id="7380343">)</span>&nbsp;<span class="op" id="7380345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7380348">src</span><span class="op" id="7380351">,</span>&nbsp;<span class="ident" id="7380353">err</span>&nbsp;<span class="op" id="7380357">:=</span>&nbsp;<span class="ident" id="7380360">ioutil</span><span class="op" id="7380366">.</span><span class="ident" id="7380367">ReadFile</span><span class="op" id="7380375">(</span><span class="ident" id="7380376">testfile</span><span class="op" id="7380384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7380387">if</span>&nbsp;<span class="ident" id="7380390">err</span>&nbsp;<span class="op" id="7380394">!=</span>&nbsp;<span class="ident" id="7380397">nil</span>&nbsp;<span class="op" id="7380401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7380405">t</span><span class="op" id="7380406">.</span><span class="ident" id="7380407">Fatal</span><span class="op" id="7380412">(</span><span class="ident" id="7380413">err</span><span class="op" id="7380416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7380419">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7380423">res</span><span class="op" id="7380426">,</span>&nbsp;<span class="ident" id="7380428">err</span>&nbsp;<span class="op" id="7380432">:=</span>&nbsp;<span class="ident" id="7380435">Source</span><span class="op" id="7380441">(</span><span class="ident" id="7380442">src</span><span class="op" id="7380445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7380448">if</span>&nbsp;<span class="ident" id="7380451">err</span>&nbsp;<span class="op" id="7380455">!=</span>&nbsp;<span class="ident" id="7380458">nil</span>&nbsp;<span class="op" id="7380462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7380466">t</span><span class="op" id="7380467">.</span><span class="ident" id="7380468">Fatal</span><span class="op" id="7380473">(</span><span class="string" id="7380474">&#34;Source&nbsp;failed:&#34;</span><span class="op" id="7380490">,</span>&nbsp;<span class="ident" id="7380492">err</span><span class="op" id="7380495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7380498">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7380502">diff</span><span class="op" id="7380506">(</span><span class="ident" id="7380507">t</span><span class="op" id="7380508">,</span>&nbsp;<span class="ident" id="7380510">res</span><span class="op" id="7380513">,</span>&nbsp;<span class="ident" id="7380515">src</span><span class="op" id="7380518">)</span><br>
<span class="lineno"></span><span class="op" id="7380520">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7380523">//&nbsp;Test&nbsp;cases&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;fail&nbsp;are&nbsp;marked&nbsp;by&nbsp;the&nbsp;prefix&nbsp;&#34;ERROR&#34;.</span><br>
<span class="lineno">75</span><span class="keyword" id="7380597">var</span>&nbsp;<span class="ident" id="7380601">tests</span>&nbsp;<span class="op" id="7380607">=</span>&nbsp;<span class="op" id="7380609">[</span><span class="op" id="7380610">]</span><span class="builtintype" id="7380611">string</span><span class="op" id="7380617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7380620">//&nbsp;declaration&nbsp;lists</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7380642">`import&nbsp;&#34;go/format&#34;`</span><span class="op" id="7380662">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7380665">&#34;var&nbsp;x&nbsp;int&#34;</span><span class="op" id="7380676">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7380679">&#34;var&nbsp;x&nbsp;int\n\ntype&nbsp;T&nbsp;struct{}&#34;</span><span class="op" id="7380709">,</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7380713">//&nbsp;statement&nbsp;lists</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7380733">&#34;x&nbsp;:=&nbsp;0&#34;</span><span class="op" id="7380741">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7380744">&#34;f(a,&nbsp;b,&nbsp;c)\nvar&nbsp;x&nbsp;int&nbsp;=&nbsp;f(1,&nbsp;2,&nbsp;3)&#34;</span><span class="op" id="7380780">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7380784">//&nbsp;indentation,&nbsp;leading&nbsp;and&nbsp;trailing&nbsp;space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7380828">&#34;\tx&nbsp;:=&nbsp;0\n\tgo&nbsp;f()&#34;</span><span class="op" id="7380848">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7380851">&#34;\tx&nbsp;:=&nbsp;0\n\tgo&nbsp;f()\n\n\n&#34;</span><span class="op" id="7380877">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7380880">&#34;\n\t\t\n\n\tx&nbsp;:=&nbsp;0\n\tgo&nbsp;f()\n\n\n&#34;</span><span class="op" id="7380916">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7380919">&#34;\n\t\t\n\n\t\t\tx&nbsp;:=&nbsp;0\n\t\t\tgo&nbsp;f()\n\n\n&#34;</span><span class="op" id="7380963">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7380966">&#34;\n\t\t\n\n\t\t\tx&nbsp;:=&nbsp;0\n\t\t\tconst&nbsp;s&nbsp;=&nbsp;`\nfoo\n`\n\n\n&#34;</span><span class="op" id="7381023">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7381029">//&nbsp;no&nbsp;indentation&nbsp;added&nbsp;inside&nbsp;raw&nbsp;strings</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7381073">&#34;\n\t\t\n\n\t\t\tx&nbsp;:=&nbsp;0\n\t\t\tconst&nbsp;s&nbsp;=&nbsp;`\n\t\tfoo\n`\n\n\n&#34;</span><span class="op" id="7381134">,</span>&nbsp;<span class="comment" id="7381136">//&nbsp;no&nbsp;indentation&nbsp;removed&nbsp;inside&nbsp;raw&nbsp;strings</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7381183">//&nbsp;comments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7381196">&#34;i&nbsp;:=&nbsp;5&nbsp;/*&nbsp;Comment&nbsp;*/&#34;</span><span class="op" id="7381218">,</span>&nbsp;<span class="comment" id="7381220">//&nbsp;Issue&nbsp;5551.</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7381237">//&nbsp;erroneous&nbsp;programs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7381260">&#34;ERROR1&nbsp;+&nbsp;2&nbsp;+&#34;</span><span class="op" id="7381274">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7381277">&#34;ERRORx&nbsp;:=&nbsp;&nbsp;0&#34;</span><span class="op" id="7381291">,</span><br>
<span class="lineno"></span><span class="op" id="7381293">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="keyword" id="7381296">func</span>&nbsp;<span class="ident" id="7381301">String</span><span class="op" id="7381307">(</span><span class="ident" id="7381308">s</span>&nbsp;<span class="builtintype" id="7381310">string</span><span class="op" id="7381316">)</span>&nbsp;<span class="op" id="7381318">(</span><span class="builtintype" id="7381319">string</span><span class="op" id="7381325">,</span>&nbsp;<span class="builtintype" id="7381327">error</span><span class="op" id="7381332">)</span>&nbsp;<span class="op" id="7381334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7381337">res</span><span class="op" id="7381340">,</span>&nbsp;<span class="ident" id="7381342">err</span>&nbsp;<span class="op" id="7381346">:=</span>&nbsp;<span class="ident" id="7381349">Source</span><span class="op" id="7381355">(</span><span class="op" id="7381356">[</span><span class="op" id="7381357">]</span><span class="builtintype" id="7381358">byte</span><span class="op" id="7381362">(</span><span class="ident" id="7381363">s</span><span class="op" id="7381364">)</span><span class="op" id="7381365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7381368">if</span>&nbsp;<span class="ident" id="7381371">err</span>&nbsp;<span class="op" id="7381375">!=</span>&nbsp;<span class="ident" id="7381378">nil</span>&nbsp;<span class="op" id="7381382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7381386">return</span>&nbsp;<span class="string" id="7381393">&#34;&#34;</span><span class="op" id="7381395">,</span>&nbsp;<span class="ident" id="7381397">err</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7381402">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7381405">return</span>&nbsp;<span class="builtintype" id="7381412">string</span><span class="op" id="7381418">(</span><span class="ident" id="7381419">res</span><span class="op" id="7381422">)</span><span class="op" id="7381423">,</span>&nbsp;<span class="ident" id="7381425">nil</span><br>
<span class="lineno"></span><span class="op" id="7381429">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7381432">func</span>&nbsp;<span class="ident" id="7381437">TestPartial</span><span class="op" id="7381448">(</span><span class="ident" id="7381449">t</span>&nbsp;<span class="op" id="7381451">*</span><span class="ident" id="7381452">testing</span><span class="op" id="7381459">.</span><span class="ident" id="7381460">T</span><span class="op" id="7381461">)</span>&nbsp;<span class="op" id="7381463">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7381466">for</span>&nbsp;<span class="ident" id="7381470">_</span><span class="op" id="7381471">,</span>&nbsp;<span class="ident" id="7381473">src</span>&nbsp;<span class="op" id="7381477">:=</span>&nbsp;<span class="keyword" id="7381480">range</span>&nbsp;<span class="ident" id="7381486">tests</span>&nbsp;<span class="op" id="7381492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7381496">if</span>&nbsp;<span class="ident" id="7381499">strings</span><span class="op" id="7381506">.</span><span class="ident" id="7381507">HasPrefix</span><span class="op" id="7381516">(</span><span class="ident" id="7381517">src</span><span class="op" id="7381520">,</span>&nbsp;<span class="string" id="7381522">&#34;ERROR&#34;</span><span class="op" id="7381529">)</span>&nbsp;<span class="op" id="7381531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7381536">//&nbsp;test&nbsp;expected&nbsp;to&nbsp;fail</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7381564">src</span>&nbsp;<span class="op" id="7381568">=</span>&nbsp;<span class="ident" id="7381570">src</span><span class="op" id="7381573">[</span><span class="num" id="7381574">5</span><span class="op" id="7381575">:</span><span class="op" id="7381576">]</span>&nbsp;<span class="comment" id="7381578">//&nbsp;remove&nbsp;ERROR&nbsp;prefix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7381604">res</span><span class="op" id="7381607">,</span>&nbsp;<span class="ident" id="7381609">err</span>&nbsp;<span class="op" id="7381613">:=</span>&nbsp;<span class="ident" id="7381616">String</span><span class="op" id="7381622">(</span><span class="ident" id="7381623">src</span><span class="op" id="7381626">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7381631">if</span>&nbsp;<span class="ident" id="7381634">err</span>&nbsp;<span class="op" id="7381638">==</span>&nbsp;<span class="ident" id="7381641">nil</span>&nbsp;<span class="op" id="7381645">&amp;&amp;</span>&nbsp;<span class="ident" id="7381648">res</span>&nbsp;<span class="op" id="7381652">==</span>&nbsp;<span class="ident" id="7381655">src</span>&nbsp;<span class="op" id="7381659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7381665">t</span><span class="op" id="7381666">.</span><span class="ident" id="7381667">Errorf</span><span class="op" id="7381673">(</span><span class="string" id="7381674">&#34;formatting&nbsp;succeeded&nbsp;but&nbsp;was&nbsp;expected&nbsp;to&nbsp;fail:\n%q&#34;</span><span class="op" id="7381726">,</span>&nbsp;<span class="ident" id="7381728">src</span><span class="op" id="7381731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7381736">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7381740">}</span>&nbsp;<span class="keyword" id="7381742">else</span>&nbsp;<span class="op" id="7381747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7381752">//&nbsp;test&nbsp;expected&nbsp;to&nbsp;succeed</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7381783">res</span><span class="op" id="7381786">,</span>&nbsp;<span class="ident" id="7381788">err</span>&nbsp;<span class="op" id="7381792">:=</span>&nbsp;<span class="ident" id="7381795">String</span><span class="op" id="7381801">(</span><span class="ident" id="7381802">src</span><span class="op" id="7381805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7381810">if</span>&nbsp;<span class="ident" id="7381813">err</span>&nbsp;<span class="op" id="7381817">!=</span>&nbsp;<span class="ident" id="7381820">nil</span>&nbsp;<span class="op" id="7381824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7381830">t</span><span class="op" id="7381831">.</span><span class="ident" id="7381832">Errorf</span><span class="op" id="7381838">(</span><span class="string" id="7381839">&#34;formatting&nbsp;failed&nbsp;(%s):\n%q&#34;</span><span class="op" id="7381868">,</span>&nbsp;<span class="ident" id="7381870">err</span><span class="op" id="7381873">,</span>&nbsp;<span class="ident" id="7381875">src</span><span class="op" id="7381878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7381883">}</span>&nbsp;<span class="keyword" id="7381885">else</span>&nbsp;<span class="keyword" id="7381890">if</span>&nbsp;<span class="ident" id="7381893">res</span>&nbsp;<span class="op" id="7381897">!=</span>&nbsp;<span class="ident" id="7381900">src</span>&nbsp;<span class="op" id="7381904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7381910">t</span><span class="op" id="7381911">.</span><span class="ident" id="7381912">Errorf</span><span class="op" id="7381918">(</span><span class="string" id="7381919">&#34;formatting&nbsp;incorrect:\nsource:&nbsp;%q\nresult:&nbsp;%q&#34;</span><span class="op" id="7381966">,</span>&nbsp;<span class="ident" id="7381968">src</span><span class="op" id="7381971">,</span>&nbsp;<span class="ident" id="7381973">res</span><span class="op" id="7381976">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7381981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7381985">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7381988">}</span><br>
<span class="lineno"></span><span class="op" id="7381990">}</span>
</div>
</body>
</html>
