<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6590371">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6590427">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6590481">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6590532">package</span>&nbsp;<span class="ident" id="6590540">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6590546">import</span>&nbsp;<span class="op" id="6590553">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6590556">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6590565">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6590574">&#34;compress/gzip&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6590591">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6590606">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6590613">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6590619">&#34;io/ioutil&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6590632">&#34;net/http/internal&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6590653">&#34;net/url&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6590664">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6590675">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6590685">&#34;strings&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6590696">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6590706">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6590709">type</span>&nbsp;<span class="ident" id="6590714">respTest</span>&nbsp;<span class="keyword" id="6590723">struct</span>&nbsp;<span class="op" id="6590730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6590733">Raw</span>&nbsp;&nbsp;<span class="builtintype" id="6590738">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6590746">Resp</span>&nbsp;<span class="ident" id="6590751">Response</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6590761">Body</span>&nbsp;<span class="builtintype" id="6590766">string</span><br>
<span class="lineno"></span><span class="op" id="6590773">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6590776">func</span>&nbsp;<span class="ident" id="6590781">dummyReq</span><span class="op" id="6590789">(</span><span class="ident" id="6590790">method</span>&nbsp;<span class="builtintype" id="6590797">string</span><span class="op" id="6590803">)</span>&nbsp;<span class="op" id="6590805">*</span><span class="ident" id="6590806">Request</span>&nbsp;<span class="op" id="6590814">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6590817">return</span>&nbsp;<span class="op" id="6590824">&amp;</span><span class="ident" id="6590825">Request</span><span class="op" id="6590832">{</span><span class="ident" id="6590833">Method</span><span class="op" id="6590839">:</span>&nbsp;<span class="ident" id="6590841">method</span><span class="op" id="6590847">}</span><br>
<span class="lineno"></span><span class="op" id="6590849">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6590852">func</span>&nbsp;<span class="ident" id="6590857">dummyReq11</span><span class="op" id="6590867">(</span><span class="ident" id="6590868">method</span>&nbsp;<span class="builtintype" id="6590875">string</span><span class="op" id="6590881">)</span>&nbsp;<span class="op" id="6590883">*</span><span class="ident" id="6590884">Request</span>&nbsp;<span class="op" id="6590892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6590895">return</span>&nbsp;<span class="op" id="6590902">&amp;</span><span class="ident" id="6590903">Request</span><span class="op" id="6590910">{</span><span class="ident" id="6590911">Method</span><span class="op" id="6590917">:</span>&nbsp;<span class="ident" id="6590919">method</span><span class="op" id="6590925">,</span>&nbsp;<span class="ident" id="6590927">Proto</span><span class="op" id="6590932">:</span>&nbsp;<span class="string" id="6590934">&#34;HTTP/1.1&#34;</span><span class="op" id="6590944">,</span>&nbsp;<span class="ident" id="6590946">ProtoMajor</span><span class="op" id="6590956">:</span>&nbsp;<span class="num" id="6590958">1</span><span class="op" id="6590959">,</span>&nbsp;<span class="ident" id="6590961">ProtoMinor</span><span class="op" id="6590971">:</span>&nbsp;<span class="num" id="6590973">1</span><span class="op" id="6590974">}</span><br>
<span class="lineno">35</span><span class="op" id="6590976">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6590979">var</span>&nbsp;<span class="ident" id="6590983">respTests</span>&nbsp;<span class="op" id="6590993">=</span>&nbsp;<span class="op" id="6590995">[</span><span class="op" id="6590996">]</span><span class="ident" id="6590997">respTest</span><span class="op" id="6591005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6591008">//&nbsp;Unchunked&nbsp;response&nbsp;without&nbsp;Content-Length.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6591055">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6591059">&#34;HTTP/1.0&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="6591081">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6591086">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="6591110">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6591115">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="6591122">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6591127">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="6591140">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6591145">Response</span><span class="op" id="6591153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6591158">Status</span><span class="op" id="6591164">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6591170">&#34;200&nbsp;OK&#34;</span><span class="op" id="6591178">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6591183">StatusCode</span><span class="op" id="6591193">:</span>&nbsp;<span class="num" id="6591195">200</span><span class="op" id="6591198">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6591203">Proto</span><span class="op" id="6591208">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6591215">&#34;HTTP/1.0&#34;</span><span class="op" id="6591225">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6591230">ProtoMajor</span><span class="op" id="6591240">:</span>&nbsp;<span class="num" id="6591242">1</span><span class="op" id="6591243">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6591248">ProtoMinor</span><span class="op" id="6591258">:</span>&nbsp;<span class="num" id="6591260">0</span><span class="op" id="6591261">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6591266">Request</span><span class="op" id="6591273">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6591278">dummyReq</span><span class="op" id="6591286">(</span><span class="string" id="6591287">&#34;GET&#34;</span><span class="op" id="6591292">)</span><span class="op" id="6591293">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6591298">Header</span><span class="op" id="6591304">:</span>&nbsp;<span class="ident" id="6591306">Header</span><span class="op" id="6591312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6591318">&#34;Connection&#34;</span><span class="op" id="6591330">:</span>&nbsp;<span class="op" id="6591332">{</span><span class="string" id="6591333">&#34;close&#34;</span><span class="op" id="6591340">}</span><span class="op" id="6591341">,</span>&nbsp;<span class="comment" id="6591343">//&nbsp;TODO(rsc):&nbsp;Delete?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6591368">}</span><span class="op" id="6591369">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6591374">Close</span><span class="op" id="6591379">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6591389">true</span><span class="op" id="6591393">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6591398">ContentLength</span><span class="op" id="6591411">:</span>&nbsp;<span class="op" id="6591413">-</span><span class="num" id="6591414">1</span><span class="op" id="6591415">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6591419">}</span><span class="op" id="6591420">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6591425">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="6591438">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6591441">}</span><span class="op" id="6591442">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6591446">//&nbsp;Unchunked&nbsp;HTTP/1.1&nbsp;response&nbsp;without&nbsp;Content-Length&nbsp;or</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6591504">//&nbsp;Connection&nbsp;headers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6591528">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6591532">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="6591554">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6591559">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="6591566">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6591571">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="6591584">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6591589">Response</span><span class="op" id="6591597">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6591602">Status</span><span class="op" id="6591608">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6591617">&#34;200&nbsp;OK&#34;</span><span class="op" id="6591625">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6591630">StatusCode</span><span class="op" id="6591640">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6591645">200</span><span class="op" id="6591648">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6591653">Proto</span><span class="op" id="6591658">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6591668">&#34;HTTP/1.1&#34;</span><span class="op" id="6591678">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6591683">ProtoMajor</span><span class="op" id="6591693">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6591698">1</span><span class="op" id="6591699">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6591704">ProtoMinor</span><span class="op" id="6591714">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6591719">1</span><span class="op" id="6591720">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6591725">Header</span><span class="op" id="6591731">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6591740">Header</span><span class="op" id="6591746">{</span><span class="op" id="6591747">}</span><span class="op" id="6591748">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6591753">Request</span><span class="op" id="6591760">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6591768">dummyReq</span><span class="op" id="6591776">(</span><span class="string" id="6591777">&#34;GET&#34;</span><span class="op" id="6591782">)</span><span class="op" id="6591783">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6591788">Close</span><span class="op" id="6591793">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6591803">true</span><span class="op" id="6591807">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6591812">ContentLength</span><span class="op" id="6591825">:</span>&nbsp;<span class="op" id="6591827">-</span><span class="num" id="6591828">1</span><span class="op" id="6591829">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6591833">}</span><span class="op" id="6591834">,</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6591839">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="6591852">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6591855">}</span><span class="op" id="6591856">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6591860">//&nbsp;Unchunked&nbsp;HTTP/1.1&nbsp;204&nbsp;response&nbsp;without&nbsp;Content-Length.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6591920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6591924">&#34;HTTP/1.1&nbsp;204&nbsp;No&nbsp;Content\r\n&#34;</span>&nbsp;<span class="op" id="6591954">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6591959">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="6591966">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6591971">&#34;Body&nbsp;should&nbsp;not&nbsp;be&nbsp;read!\n&#34;</span><span class="op" id="6591999">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6592004">Response</span><span class="op" id="6592012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6592017">Status</span><span class="op" id="6592023">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6592032">&#34;204&nbsp;No&nbsp;Content&#34;</span><span class="op" id="6592048">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6592053">StatusCode</span><span class="op" id="6592063">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6592068">204</span><span class="op" id="6592071">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6592076">Proto</span><span class="op" id="6592081">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6592091">&#34;HTTP/1.1&#34;</span><span class="op" id="6592101">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6592106">ProtoMajor</span><span class="op" id="6592116">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6592121">1</span><span class="op" id="6592122">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6592127">ProtoMinor</span><span class="op" id="6592137">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6592142">1</span><span class="op" id="6592143">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6592148">Header</span><span class="op" id="6592154">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6592163">Header</span><span class="op" id="6592169">{</span><span class="op" id="6592170">}</span><span class="op" id="6592171">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6592176">Request</span><span class="op" id="6592183">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6592191">dummyReq</span><span class="op" id="6592199">(</span><span class="string" id="6592200">&#34;GET&#34;</span><span class="op" id="6592205">)</span><span class="op" id="6592206">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6592211">Close</span><span class="op" id="6592216">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6592226">false</span><span class="op" id="6592231">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6592236">ContentLength</span><span class="op" id="6592249">:</span>&nbsp;<span class="num" id="6592251">0</span><span class="op" id="6592252">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6592256">}</span><span class="op" id="6592257">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6592262">&#34;&#34;</span><span class="op" id="6592264">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6592267">}</span><span class="op" id="6592268">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6592272">//&nbsp;Unchunked&nbsp;response&nbsp;with&nbsp;Content-Length.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6592316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6592320">&#34;HTTP/1.0&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="6592342">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6592347">&#34;Content-Length:&nbsp;10\r\n&#34;</span>&nbsp;<span class="op" id="6592372">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6592377">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="6592401">+</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6592406">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="6592413">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6592418">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="6592431">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6592436">Response</span><span class="op" id="6592444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6592449">Status</span><span class="op" id="6592455">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6592461">&#34;200&nbsp;OK&#34;</span><span class="op" id="6592469">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6592474">StatusCode</span><span class="op" id="6592484">:</span>&nbsp;<span class="num" id="6592486">200</span><span class="op" id="6592489">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6592494">Proto</span><span class="op" id="6592499">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6592506">&#34;HTTP/1.0&#34;</span><span class="op" id="6592516">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6592521">ProtoMajor</span><span class="op" id="6592531">:</span>&nbsp;<span class="num" id="6592533">1</span><span class="op" id="6592534">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6592539">ProtoMinor</span><span class="op" id="6592549">:</span>&nbsp;<span class="num" id="6592551">0</span><span class="op" id="6592552">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6592557">Request</span><span class="op" id="6592564">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6592569">dummyReq</span><span class="op" id="6592577">(</span><span class="string" id="6592578">&#34;GET&#34;</span><span class="op" id="6592583">)</span><span class="op" id="6592584">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6592589">Header</span><span class="op" id="6592595">:</span>&nbsp;<span class="ident" id="6592597">Header</span><span class="op" id="6592603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6592609">&#34;Connection&#34;</span><span class="op" id="6592621">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6592627">{</span><span class="string" id="6592628">&#34;close&#34;</span><span class="op" id="6592635">}</span><span class="op" id="6592636">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6592642">&#34;Content-Length&#34;</span><span class="op" id="6592658">:</span>&nbsp;<span class="op" id="6592660">{</span><span class="string" id="6592661">&#34;10&#34;</span><span class="op" id="6592665">}</span><span class="op" id="6592666">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6592671">}</span><span class="op" id="6592672">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6592677">Close</span><span class="op" id="6592682">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6592692">true</span><span class="op" id="6592696">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6592701">ContentLength</span><span class="op" id="6592714">:</span>&nbsp;<span class="num" id="6592716">10</span><span class="op" id="6592718">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6592722">}</span><span class="op" id="6592723">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6592728">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="6592741">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6592744">}</span><span class="op" id="6592745">,</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6592749">//&nbsp;Chunked&nbsp;response&nbsp;without&nbsp;Content-Length.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6592794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6592798">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="6592820">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6592825">&#34;Transfer-Encoding:&nbsp;chunked\r\n&#34;</span>&nbsp;<span class="op" id="6592858">+</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6592863">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="6592870">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6592875">&#34;0a\r\n&#34;</span>&nbsp;<span class="op" id="6592884">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6592889">&#34;Body&nbsp;here\n\r\n&#34;</span>&nbsp;<span class="op" id="6592907">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6592912">&#34;09\r\n&#34;</span>&nbsp;<span class="op" id="6592921">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6592926">&#34;continued\r\n&#34;</span>&nbsp;<span class="op" id="6592942">+</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6592947">&#34;0\r\n&#34;</span>&nbsp;<span class="op" id="6592955">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6592960">&#34;\r\n&#34;</span><span class="op" id="6592966">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6592971">Response</span><span class="op" id="6592979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6592984">Status</span><span class="op" id="6592990">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6593002">&#34;200&nbsp;OK&#34;</span><span class="op" id="6593010">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6593015">StatusCode</span><span class="op" id="6593025">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6593033">200</span><span class="op" id="6593036">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6593041">Proto</span><span class="op" id="6593046">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6593059">&#34;HTTP/1.1&#34;</span><span class="op" id="6593069">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6593074">ProtoMajor</span><span class="op" id="6593084">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6593092">1</span><span class="op" id="6593093">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6593098">ProtoMinor</span><span class="op" id="6593108">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6593116">1</span><span class="op" id="6593117">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6593122">Request</span><span class="op" id="6593129">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6593140">dummyReq</span><span class="op" id="6593148">(</span><span class="string" id="6593149">&#34;GET&#34;</span><span class="op" id="6593154">)</span><span class="op" id="6593155">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6593160">Header</span><span class="op" id="6593166">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6593178">Header</span><span class="op" id="6593184">{</span><span class="op" id="6593185">}</span><span class="op" id="6593186">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6593191">Close</span><span class="op" id="6593196">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6593209">false</span><span class="op" id="6593214">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6593219">ContentLength</span><span class="op" id="6593232">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6593237">-</span><span class="num" id="6593238">1</span><span class="op" id="6593239">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6593244">TransferEncoding</span><span class="op" id="6593260">:</span>&nbsp;<span class="op" id="6593262">[</span><span class="op" id="6593263">]</span><span class="builtintype" id="6593264">string</span><span class="op" id="6593270">{</span><span class="string" id="6593271">&#34;chunked&#34;</span><span class="op" id="6593280">}</span><span class="op" id="6593281">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6593285">}</span><span class="op" id="6593286">,</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6593291">&#34;Body&nbsp;here\ncontinued&#34;</span><span class="op" id="6593313">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6593316">}</span><span class="op" id="6593317">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6593321">//&nbsp;Chunked&nbsp;response&nbsp;with&nbsp;Content-Length.</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6593363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6593367">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="6593389">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6593394">&#34;Transfer-Encoding:&nbsp;chunked\r\n&#34;</span>&nbsp;<span class="op" id="6593427">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6593432">&#34;Content-Length:&nbsp;10\r\n&#34;</span>&nbsp;<span class="op" id="6593457">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6593462">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="6593469">+</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6593474">&#34;0a\r\n&#34;</span>&nbsp;<span class="op" id="6593483">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6593488">&#34;Body&nbsp;here\n\r\n&#34;</span>&nbsp;<span class="op" id="6593506">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6593511">&#34;0\r\n&#34;</span>&nbsp;<span class="op" id="6593519">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6593524">&#34;\r\n&#34;</span><span class="op" id="6593530">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6593535">Response</span><span class="op" id="6593543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6593548">Status</span><span class="op" id="6593554">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6593566">&#34;200&nbsp;OK&#34;</span><span class="op" id="6593574">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6593579">StatusCode</span><span class="op" id="6593589">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6593597">200</span><span class="op" id="6593600">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6593605">Proto</span><span class="op" id="6593610">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6593623">&#34;HTTP/1.1&#34;</span><span class="op" id="6593633">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6593638">ProtoMajor</span><span class="op" id="6593648">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6593656">1</span><span class="op" id="6593657">,</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6593662">ProtoMinor</span><span class="op" id="6593672">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6593680">1</span><span class="op" id="6593681">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6593686">Request</span><span class="op" id="6593693">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6593704">dummyReq</span><span class="op" id="6593712">(</span><span class="string" id="6593713">&#34;GET&#34;</span><span class="op" id="6593718">)</span><span class="op" id="6593719">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6593724">Header</span><span class="op" id="6593730">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6593742">Header</span><span class="op" id="6593748">{</span><span class="op" id="6593749">}</span><span class="op" id="6593750">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6593755">Close</span><span class="op" id="6593760">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6593773">false</span><span class="op" id="6593778">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6593783">ContentLength</span><span class="op" id="6593796">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6593801">-</span><span class="num" id="6593802">1</span><span class="op" id="6593803">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6593808">TransferEncoding</span><span class="op" id="6593824">:</span>&nbsp;<span class="op" id="6593826">[</span><span class="op" id="6593827">]</span><span class="builtintype" id="6593828">string</span><span class="op" id="6593834">{</span><span class="string" id="6593835">&#34;chunked&#34;</span><span class="op" id="6593844">}</span><span class="op" id="6593845">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6593849">}</span><span class="op" id="6593850">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6593855">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="6593868">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6593871">}</span><span class="op" id="6593872">,</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6593876">//&nbsp;Chunked&nbsp;response&nbsp;in&nbsp;response&nbsp;to&nbsp;a&nbsp;HEAD&nbsp;request</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6593927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6593931">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="6593953">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6593958">&#34;Transfer-Encoding:&nbsp;chunked\r\n&#34;</span>&nbsp;<span class="op" id="6593991">+</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6593996">&#34;\r\n&#34;</span><span class="op" id="6594002">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6594007">Response</span><span class="op" id="6594015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6594020">Status</span><span class="op" id="6594026">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6594038">&#34;200&nbsp;OK&#34;</span><span class="op" id="6594046">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6594051">StatusCode</span><span class="op" id="6594061">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6594069">200</span><span class="op" id="6594072">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6594077">Proto</span><span class="op" id="6594082">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6594095">&#34;HTTP/1.1&#34;</span><span class="op" id="6594105">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6594110">ProtoMajor</span><span class="op" id="6594120">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6594128">1</span><span class="op" id="6594129">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6594134">ProtoMinor</span><span class="op" id="6594144">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6594152">1</span><span class="op" id="6594153">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6594158">Request</span><span class="op" id="6594165">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6594176">dummyReq</span><span class="op" id="6594184">(</span><span class="string" id="6594185">&#34;HEAD&#34;</span><span class="op" id="6594191">)</span><span class="op" id="6594192">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6594197">Header</span><span class="op" id="6594203">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6594215">Header</span><span class="op" id="6594221">{</span><span class="op" id="6594222">}</span><span class="op" id="6594223">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6594228">TransferEncoding</span><span class="op" id="6594244">:</span>&nbsp;<span class="op" id="6594246">[</span><span class="op" id="6594247">]</span><span class="builtintype" id="6594248">string</span><span class="op" id="6594254">{</span><span class="string" id="6594255">&#34;chunked&#34;</span><span class="op" id="6594264">}</span><span class="op" id="6594265">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6594270">Close</span><span class="op" id="6594275">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6594288">false</span><span class="op" id="6594293">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6594298">ContentLength</span><span class="op" id="6594311">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6594316">-</span><span class="num" id="6594317">1</span><span class="op" id="6594318">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6594322">}</span><span class="op" id="6594323">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6594328">&#34;&#34;</span><span class="op" id="6594330">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6594333">}</span><span class="op" id="6594334">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6594338">//&nbsp;Content-Length&nbsp;in&nbsp;response&nbsp;to&nbsp;a&nbsp;HEAD&nbsp;request</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6594387">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6594391">&#34;HTTP/1.0&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="6594413">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6594418">&#34;Content-Length:&nbsp;256\r\n&#34;</span>&nbsp;<span class="op" id="6594444">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6594449">&#34;\r\n&#34;</span><span class="op" id="6594455">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6594460">Response</span><span class="op" id="6594468">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6594473">Status</span><span class="op" id="6594479">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6594491">&#34;200&nbsp;OK&#34;</span><span class="op" id="6594499">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6594504">StatusCode</span><span class="op" id="6594514">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6594522">200</span><span class="op" id="6594525">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6594530">Proto</span><span class="op" id="6594535">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6594548">&#34;HTTP/1.0&#34;</span><span class="op" id="6594558">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6594563">ProtoMajor</span><span class="op" id="6594573">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6594581">1</span><span class="op" id="6594582">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6594587">ProtoMinor</span><span class="op" id="6594597">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6594605">0</span><span class="op" id="6594606">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6594611">Request</span><span class="op" id="6594618">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6594629">dummyReq</span><span class="op" id="6594637">(</span><span class="string" id="6594638">&#34;HEAD&#34;</span><span class="op" id="6594644">)</span><span class="op" id="6594645">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6594650">Header</span><span class="op" id="6594656">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6594668">Header</span><span class="op" id="6594674">{</span><span class="string" id="6594675">&#34;Content-Length&#34;</span><span class="op" id="6594691">:</span>&nbsp;<span class="op" id="6594693">{</span><span class="string" id="6594694">&#34;256&#34;</span><span class="op" id="6594699">}</span><span class="op" id="6594700">}</span><span class="op" id="6594701">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6594706">TransferEncoding</span><span class="op" id="6594722">:</span>&nbsp;<span class="ident" id="6594724">nil</span><span class="op" id="6594727">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6594732">Close</span><span class="op" id="6594737">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6594750">true</span><span class="op" id="6594754">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6594759">ContentLength</span><span class="op" id="6594772">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6594777">256</span><span class="op" id="6594780">,</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6594784">}</span><span class="op" id="6594785">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6594790">&#34;&#34;</span><span class="op" id="6594792">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6594795">}</span><span class="op" id="6594796">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6594800">//&nbsp;Content-Length&nbsp;in&nbsp;response&nbsp;to&nbsp;a&nbsp;HEAD&nbsp;request&nbsp;with&nbsp;HTTP/1.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6594863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6594867">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="6594889">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6594894">&#34;Content-Length:&nbsp;256\r\n&#34;</span>&nbsp;<span class="op" id="6594920">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6594925">&#34;\r\n&#34;</span><span class="op" id="6594931">,</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6594936">Response</span><span class="op" id="6594944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6594949">Status</span><span class="op" id="6594955">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6594967">&#34;200&nbsp;OK&#34;</span><span class="op" id="6594975">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6594980">StatusCode</span><span class="op" id="6594990">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6594998">200</span><span class="op" id="6595001">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6595006">Proto</span><span class="op" id="6595011">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6595024">&#34;HTTP/1.1&#34;</span><span class="op" id="6595034">,</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6595039">ProtoMajor</span><span class="op" id="6595049">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6595057">1</span><span class="op" id="6595058">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6595063">ProtoMinor</span><span class="op" id="6595073">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6595081">1</span><span class="op" id="6595082">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6595087">Request</span><span class="op" id="6595094">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6595105">dummyReq</span><span class="op" id="6595113">(</span><span class="string" id="6595114">&#34;HEAD&#34;</span><span class="op" id="6595120">)</span><span class="op" id="6595121">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6595126">Header</span><span class="op" id="6595132">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6595144">Header</span><span class="op" id="6595150">{</span><span class="string" id="6595151">&#34;Content-Length&#34;</span><span class="op" id="6595167">:</span>&nbsp;<span class="op" id="6595169">{</span><span class="string" id="6595170">&#34;256&#34;</span><span class="op" id="6595175">}</span><span class="op" id="6595176">}</span><span class="op" id="6595177">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6595182">TransferEncoding</span><span class="op" id="6595198">:</span>&nbsp;<span class="ident" id="6595200">nil</span><span class="op" id="6595203">,</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6595208">Close</span><span class="op" id="6595213">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6595226">false</span><span class="op" id="6595231">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6595236">ContentLength</span><span class="op" id="6595249">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6595254">256</span><span class="op" id="6595257">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6595261">}</span><span class="op" id="6595262">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6595267">&#34;&#34;</span><span class="op" id="6595269">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6595272">}</span><span class="op" id="6595273">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6595277">//&nbsp;No&nbsp;Content-Length&nbsp;or&nbsp;Chunked&nbsp;in&nbsp;response&nbsp;to&nbsp;a&nbsp;HEAD&nbsp;request</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6595340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6595344">&#34;HTTP/1.0&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="6595366">+</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6595371">&#34;\r\n&#34;</span><span class="op" id="6595377">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6595382">Response</span><span class="op" id="6595390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6595395">Status</span><span class="op" id="6595401">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6595413">&#34;200&nbsp;OK&#34;</span><span class="op" id="6595421">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6595426">StatusCode</span><span class="op" id="6595436">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6595444">200</span><span class="op" id="6595447">,</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6595452">Proto</span><span class="op" id="6595457">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6595470">&#34;HTTP/1.0&#34;</span><span class="op" id="6595480">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6595485">ProtoMajor</span><span class="op" id="6595495">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6595503">1</span><span class="op" id="6595504">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6595509">ProtoMinor</span><span class="op" id="6595519">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6595527">0</span><span class="op" id="6595528">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6595533">Request</span><span class="op" id="6595540">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6595551">dummyReq</span><span class="op" id="6595559">(</span><span class="string" id="6595560">&#34;HEAD&#34;</span><span class="op" id="6595566">)</span><span class="op" id="6595567">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6595572">Header</span><span class="op" id="6595578">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6595590">Header</span><span class="op" id="6595596">{</span><span class="op" id="6595597">}</span><span class="op" id="6595598">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6595603">TransferEncoding</span><span class="op" id="6595619">:</span>&nbsp;<span class="ident" id="6595621">nil</span><span class="op" id="6595624">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6595629">Close</span><span class="op" id="6595634">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6595647">true</span><span class="op" id="6595651">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6595656">ContentLength</span><span class="op" id="6595669">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6595674">-</span><span class="num" id="6595675">1</span><span class="op" id="6595676">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6595680">}</span><span class="op" id="6595681">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6595686">&#34;&#34;</span><span class="op" id="6595688">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6595691">}</span><span class="op" id="6595692">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6595696">//&nbsp;explicit&nbsp;Content-Length&nbsp;of&nbsp;0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6595730">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6595734">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="6595756">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6595761">&#34;Content-Length:&nbsp;0\r\n&#34;</span>&nbsp;<span class="op" id="6595785">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6595790">&#34;\r\n&#34;</span><span class="op" id="6595796">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6595801">Response</span><span class="op" id="6595809">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6595814">Status</span><span class="op" id="6595820">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6595826">&#34;200&nbsp;OK&#34;</span><span class="op" id="6595834">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6595839">StatusCode</span><span class="op" id="6595849">:</span>&nbsp;<span class="num" id="6595851">200</span><span class="op" id="6595854">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6595859">Proto</span><span class="op" id="6595864">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6595871">&#34;HTTP/1.1&#34;</span><span class="op" id="6595881">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6595886">ProtoMajor</span><span class="op" id="6595896">:</span>&nbsp;<span class="num" id="6595898">1</span><span class="op" id="6595899">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6595904">ProtoMinor</span><span class="op" id="6595914">:</span>&nbsp;<span class="num" id="6595916">1</span><span class="op" id="6595917">,</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6595922">Request</span><span class="op" id="6595929">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6595934">dummyReq</span><span class="op" id="6595942">(</span><span class="string" id="6595943">&#34;GET&#34;</span><span class="op" id="6595948">)</span><span class="op" id="6595949">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6595954">Header</span><span class="op" id="6595960">:</span>&nbsp;<span class="ident" id="6595962">Header</span><span class="op" id="6595968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6595974">&#34;Content-Length&#34;</span><span class="op" id="6595990">:</span>&nbsp;<span class="op" id="6595992">{</span><span class="string" id="6595993">&#34;0&#34;</span><span class="op" id="6595996">}</span><span class="op" id="6595997">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6596002">}</span><span class="op" id="6596003">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6596008">Close</span><span class="op" id="6596013">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6596023">false</span><span class="op" id="6596028">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6596033">ContentLength</span><span class="op" id="6596046">:</span>&nbsp;<span class="num" id="6596048">0</span><span class="op" id="6596049">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6596053">}</span><span class="op" id="6596054">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6596059">&#34;&#34;</span><span class="op" id="6596061">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6596064">}</span><span class="op" id="6596065">,</span><br>
<span class="lineno">295</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6596069">//&nbsp;Status&nbsp;line&nbsp;without&nbsp;a&nbsp;Reason-Phrase,&nbsp;but&nbsp;trailing&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6596130">//&nbsp;(permitted&nbsp;by&nbsp;RFC&nbsp;2616)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6596158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6596162">&#34;HTTP/1.0&nbsp;303&nbsp;\r\n\r\n&#34;</span><span class="op" id="6596185">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6596189">Response</span><span class="op" id="6596197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6596202">Status</span><span class="op" id="6596208">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6596217">&#34;303&nbsp;&#34;</span><span class="op" id="6596223">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6596228">StatusCode</span><span class="op" id="6596238">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6596243">303</span><span class="op" id="6596246">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6596251">Proto</span><span class="op" id="6596256">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6596266">&#34;HTTP/1.0&#34;</span><span class="op" id="6596276">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6596281">ProtoMajor</span><span class="op" id="6596291">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6596296">1</span><span class="op" id="6596297">,</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6596302">ProtoMinor</span><span class="op" id="6596312">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6596317">0</span><span class="op" id="6596318">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6596323">Request</span><span class="op" id="6596330">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6596338">dummyReq</span><span class="op" id="6596346">(</span><span class="string" id="6596347">&#34;GET&#34;</span><span class="op" id="6596352">)</span><span class="op" id="6596353">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6596358">Header</span><span class="op" id="6596364">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6596373">Header</span><span class="op" id="6596379">{</span><span class="op" id="6596380">}</span><span class="op" id="6596381">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6596386">Close</span><span class="op" id="6596391">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6596401">true</span><span class="op" id="6596405">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6596410">ContentLength</span><span class="op" id="6596423">:</span>&nbsp;<span class="op" id="6596425">-</span><span class="num" id="6596426">1</span><span class="op" id="6596427">,</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6596431">}</span><span class="op" id="6596432">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6596437">&#34;&#34;</span><span class="op" id="6596439">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6596442">}</span><span class="op" id="6596443">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6596447">//&nbsp;Status&nbsp;line&nbsp;without&nbsp;a&nbsp;Reason-Phrase,&nbsp;and&nbsp;no&nbsp;trailing&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6596511">//&nbsp;(not&nbsp;permitted&nbsp;by&nbsp;RFC&nbsp;2616,&nbsp;but&nbsp;we&#39;ll&nbsp;accept&nbsp;it&nbsp;anyway)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6596571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6596575">&#34;HTTP/1.0&nbsp;303\r\n\r\n&#34;</span><span class="op" id="6596597">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6596601">Response</span><span class="op" id="6596609">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6596614">Status</span><span class="op" id="6596620">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6596629">&#34;303&nbsp;&#34;</span><span class="op" id="6596635">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6596640">StatusCode</span><span class="op" id="6596650">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6596655">303</span><span class="op" id="6596658">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6596663">Proto</span><span class="op" id="6596668">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6596678">&#34;HTTP/1.0&#34;</span><span class="op" id="6596688">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6596693">ProtoMajor</span><span class="op" id="6596703">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6596708">1</span><span class="op" id="6596709">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6596714">ProtoMinor</span><span class="op" id="6596724">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6596729">0</span><span class="op" id="6596730">,</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6596735">Request</span><span class="op" id="6596742">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6596750">dummyReq</span><span class="op" id="6596758">(</span><span class="string" id="6596759">&#34;GET&#34;</span><span class="op" id="6596764">)</span><span class="op" id="6596765">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6596770">Header</span><span class="op" id="6596776">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6596785">Header</span><span class="op" id="6596791">{</span><span class="op" id="6596792">}</span><span class="op" id="6596793">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6596798">Close</span><span class="op" id="6596803">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6596813">true</span><span class="op" id="6596817">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6596822">ContentLength</span><span class="op" id="6596835">:</span>&nbsp;<span class="op" id="6596837">-</span><span class="num" id="6596838">1</span><span class="op" id="6596839">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6596843">}</span><span class="op" id="6596844">,</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6596849">&#34;&#34;</span><span class="op" id="6596851">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6596854">}</span><span class="op" id="6596855">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6596859">//&nbsp;golang.org/issue/4767:&nbsp;don&#39;t&nbsp;special-case&nbsp;multipart/byteranges&nbsp;responses</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6596936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6596940">`HTTP/1.1&nbsp;206&nbsp;Partial&nbsp;Content<br>
<span class="lineno"></span>Connection:&nbsp;close<br>
<span class="lineno"></span>Content-Type:&nbsp;multipart/byteranges;&nbsp;boundary=18a75608c8f47cef<br>
<span class="lineno"></span><br>
<span class="lineno">340</span>some&nbsp;body`</span><span class="op" id="6597061">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6597065">Response</span><span class="op" id="6597073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6597078">Status</span><span class="op" id="6597084">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6597090">&#34;206&nbsp;Partial&nbsp;Content&#34;</span><span class="op" id="6597111">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6597116">StatusCode</span><span class="op" id="6597126">:</span>&nbsp;<span class="num" id="6597128">206</span><span class="op" id="6597131">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6597136">Proto</span><span class="op" id="6597141">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6597148">&#34;HTTP/1.1&#34;</span><span class="op" id="6597158">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6597163">ProtoMajor</span><span class="op" id="6597173">:</span>&nbsp;<span class="num" id="6597175">1</span><span class="op" id="6597176">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6597181">ProtoMinor</span><span class="op" id="6597191">:</span>&nbsp;<span class="num" id="6597193">1</span><span class="op" id="6597194">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6597199">Request</span><span class="op" id="6597206">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6597211">dummyReq</span><span class="op" id="6597219">(</span><span class="string" id="6597220">&#34;GET&#34;</span><span class="op" id="6597225">)</span><span class="op" id="6597226">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6597231">Header</span><span class="op" id="6597237">:</span>&nbsp;<span class="ident" id="6597239">Header</span><span class="op" id="6597245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6597251">&#34;Content-Type&#34;</span><span class="op" id="6597265">:</span>&nbsp;<span class="op" id="6597267">[</span><span class="op" id="6597268">]</span><span class="builtintype" id="6597269">string</span><span class="op" id="6597275">{</span><span class="string" id="6597276">&#34;multipart/byteranges;&nbsp;boundary=18a75608c8f47cef&#34;</span><span class="op" id="6597325">}</span><span class="op" id="6597326">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6597331">}</span><span class="op" id="6597332">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6597337">Close</span><span class="op" id="6597342">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6597352">true</span><span class="op" id="6597356">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6597361">ContentLength</span><span class="op" id="6597374">:</span>&nbsp;<span class="op" id="6597376">-</span><span class="num" id="6597377">1</span><span class="op" id="6597378">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6597382">}</span><span class="op" id="6597383">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6597388">&#34;some&nbsp;body&#34;</span><span class="op" id="6597399">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6597402">}</span><span class="op" id="6597403">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6597407">//&nbsp;Unchunked&nbsp;response&nbsp;without&nbsp;Content-Length,&nbsp;Request&nbsp;is&nbsp;nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6597469">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6597473">&#34;HTTP/1.0&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="6597495">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6597500">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="6597524">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6597529">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="6597536">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6597541">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="6597554">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6597559">Response</span><span class="op" id="6597567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6597572">Status</span><span class="op" id="6597578">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6597584">&#34;200&nbsp;OK&#34;</span><span class="op" id="6597592">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6597597">StatusCode</span><span class="op" id="6597607">:</span>&nbsp;<span class="num" id="6597609">200</span><span class="op" id="6597612">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6597617">Proto</span><span class="op" id="6597622">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6597629">&#34;HTTP/1.0&#34;</span><span class="op" id="6597639">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6597644">ProtoMajor</span><span class="op" id="6597654">:</span>&nbsp;<span class="num" id="6597656">1</span><span class="op" id="6597657">,</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6597662">ProtoMinor</span><span class="op" id="6597672">:</span>&nbsp;<span class="num" id="6597674">0</span><span class="op" id="6597675">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6597680">Header</span><span class="op" id="6597686">:</span>&nbsp;<span class="ident" id="6597688">Header</span><span class="op" id="6597694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6597700">&#34;Connection&#34;</span><span class="op" id="6597712">:</span>&nbsp;<span class="op" id="6597714">{</span><span class="string" id="6597715">&#34;close&#34;</span><span class="op" id="6597722">}</span><span class="op" id="6597723">,</span>&nbsp;<span class="comment" id="6597725">//&nbsp;TODO(rsc):&nbsp;Delete?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6597750">}</span><span class="op" id="6597751">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6597756">Close</span><span class="op" id="6597761">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6597771">true</span><span class="op" id="6597775">,</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6597780">ContentLength</span><span class="op" id="6597793">:</span>&nbsp;<span class="op" id="6597795">-</span><span class="num" id="6597796">1</span><span class="op" id="6597797">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6597801">}</span><span class="op" id="6597802">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6597807">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="6597820">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6597823">}</span><span class="op" id="6597824">,</span><br>
<span class="lineno">380</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6597828">//&nbsp;206&nbsp;Partial&nbsp;Content.&nbsp;golang.org/issue/8923</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6597875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6597879">&#34;HTTP/1.1&nbsp;206&nbsp;Partial&nbsp;Content\r\n&#34;</span>&nbsp;<span class="op" id="6597914">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6597919">&#34;Content-Type:&nbsp;text/plain;&nbsp;charset=utf-8\r\n&#34;</span>&nbsp;<span class="op" id="6597965">+</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6597970">&#34;Accept-Ranges:&nbsp;bytes\r\n&#34;</span>&nbsp;<span class="op" id="6597997">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6598002">&#34;Content-Range:&nbsp;bytes&nbsp;0-5/1862\r\n&#34;</span>&nbsp;<span class="op" id="6598038">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6598043">&#34;Content-Length:&nbsp;6\r\n\r\n&#34;</span>&nbsp;<span class="op" id="6598071">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6598076">&#34;foobar&#34;</span><span class="op" id="6598084">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6598089">Response</span><span class="op" id="6598097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6598102">Status</span><span class="op" id="6598108">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6598114">&#34;206&nbsp;Partial&nbsp;Content&#34;</span><span class="op" id="6598135">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6598140">StatusCode</span><span class="op" id="6598150">:</span>&nbsp;<span class="num" id="6598152">206</span><span class="op" id="6598155">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6598160">Proto</span><span class="op" id="6598165">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6598172">&#34;HTTP/1.1&#34;</span><span class="op" id="6598182">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6598187">ProtoMajor</span><span class="op" id="6598197">:</span>&nbsp;<span class="num" id="6598199">1</span><span class="op" id="6598200">,</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6598205">ProtoMinor</span><span class="op" id="6598215">:</span>&nbsp;<span class="num" id="6598217">1</span><span class="op" id="6598218">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6598223">Request</span><span class="op" id="6598230">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6598235">dummyReq</span><span class="op" id="6598243">(</span><span class="string" id="6598244">&#34;GET&#34;</span><span class="op" id="6598249">)</span><span class="op" id="6598250">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6598255">Header</span><span class="op" id="6598261">:</span>&nbsp;<span class="ident" id="6598263">Header</span><span class="op" id="6598269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6598275">&#34;Accept-Ranges&#34;</span><span class="op" id="6598290">:</span>&nbsp;&nbsp;<span class="op" id="6598293">[</span><span class="op" id="6598294">]</span><span class="builtintype" id="6598295">string</span><span class="op" id="6598301">{</span><span class="string" id="6598302">&#34;bytes&#34;</span><span class="op" id="6598309">}</span><span class="op" id="6598310">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6598316">&#34;Content-Length&#34;</span><span class="op" id="6598332">:</span>&nbsp;<span class="op" id="6598334">[</span><span class="op" id="6598335">]</span><span class="builtintype" id="6598336">string</span><span class="op" id="6598342">{</span><span class="string" id="6598343">&#34;6&#34;</span><span class="op" id="6598346">}</span><span class="op" id="6598347">,</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6598353">&#34;Content-Type&#34;</span><span class="op" id="6598367">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6598371">[</span><span class="op" id="6598372">]</span><span class="builtintype" id="6598373">string</span><span class="op" id="6598379">{</span><span class="string" id="6598380">&#34;text/plain;&nbsp;charset=utf-8&#34;</span><span class="op" id="6598407">}</span><span class="op" id="6598408">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6598414">&#34;Content-Range&#34;</span><span class="op" id="6598429">:</span>&nbsp;&nbsp;<span class="op" id="6598432">[</span><span class="op" id="6598433">]</span><span class="builtintype" id="6598434">string</span><span class="op" id="6598440">{</span><span class="string" id="6598441">&#34;bytes&nbsp;0-5/1862&#34;</span><span class="op" id="6598457">}</span><span class="op" id="6598458">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6598463">}</span><span class="op" id="6598464">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6598469">ContentLength</span><span class="op" id="6598482">:</span>&nbsp;<span class="num" id="6598484">6</span><span class="op" id="6598485">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6598489">}</span><span class="op" id="6598490">,</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6598495">&#34;foobar&#34;</span><span class="op" id="6598503">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6598506">}</span><span class="op" id="6598507">,</span><br>
<span class="lineno"></span><span class="op" id="6598509">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span><span class="keyword" id="6598512">func</span>&nbsp;<span class="ident" id="6598517">TestReadResponse</span><span class="op" id="6598533">(</span><span class="ident" id="6598534">t</span>&nbsp;<span class="op" id="6598536">*</span><span class="ident" id="6598537">testing</span><span class="op" id="6598544">.</span><span class="ident" id="6598545">T</span><span class="op" id="6598546">)</span>&nbsp;<span class="op" id="6598548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6598551">for</span>&nbsp;<span class="ident" id="6598555">i</span><span class="op" id="6598556">,</span>&nbsp;<span class="ident" id="6598558">tt</span>&nbsp;<span class="op" id="6598561">:=</span>&nbsp;<span class="keyword" id="6598564">range</span>&nbsp;<span class="ident" id="6598570">respTests</span>&nbsp;<span class="op" id="6598580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6598584">resp</span><span class="op" id="6598588">,</span>&nbsp;<span class="ident" id="6598590">err</span>&nbsp;<span class="op" id="6598594">:=</span>&nbsp;<span class="ident" id="6598597">ReadResponse</span><span class="op" id="6598609">(</span><span class="ident" id="6598610">bufio</span><span class="op" id="6598615">.</span><span class="ident" id="6598616">NewReader</span><span class="op" id="6598625">(</span><span class="ident" id="6598626">strings</span><span class="op" id="6598633">.</span><span class="ident" id="6598634">NewReader</span><span class="op" id="6598643">(</span><span class="ident" id="6598644">tt</span><span class="op" id="6598646">.</span><span class="ident" id="6598647">Raw</span><span class="op" id="6598650">)</span><span class="op" id="6598651">)</span><span class="op" id="6598652">,</span>&nbsp;<span class="ident" id="6598654">tt</span><span class="op" id="6598656">.</span><span class="ident" id="6598657">Resp</span><span class="op" id="6598661">.</span><span class="ident" id="6598662">Request</span><span class="op" id="6598669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6598673">if</span>&nbsp;<span class="ident" id="6598676">err</span>&nbsp;<span class="op" id="6598680">!=</span>&nbsp;<span class="ident" id="6598683">nil</span>&nbsp;<span class="op" id="6598687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6598692">t</span><span class="op" id="6598693">.</span><span class="ident" id="6598694">Errorf</span><span class="op" id="6598700">(</span><span class="string" id="6598701">&#34;#%d:&nbsp;%v&#34;</span><span class="op" id="6598710">,</span>&nbsp;<span class="ident" id="6598712">i</span><span class="op" id="6598713">,</span>&nbsp;<span class="ident" id="6598715">err</span><span class="op" id="6598718">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6598723">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6598734">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6598738">rbody</span>&nbsp;<span class="op" id="6598744">:=</span>&nbsp;<span class="ident" id="6598747">resp</span><span class="op" id="6598751">.</span><span class="ident" id="6598752">Body</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6598759">resp</span><span class="op" id="6598763">.</span><span class="ident" id="6598764">Body</span>&nbsp;<span class="op" id="6598769">=</span>&nbsp;<span class="ident" id="6598771">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6598777">diff</span><span class="op" id="6598781">(</span><span class="ident" id="6598782">t</span><span class="op" id="6598783">,</span>&nbsp;<span class="ident" id="6598785">fmt</span><span class="op" id="6598788">.</span><span class="ident" id="6598789">Sprintf</span><span class="op" id="6598796">(</span><span class="string" id="6598797">&#34;#%d&nbsp;Response&#34;</span><span class="op" id="6598811">,</span>&nbsp;<span class="ident" id="6598813">i</span><span class="op" id="6598814">)</span><span class="op" id="6598815">,</span>&nbsp;<span class="ident" id="6598817">resp</span><span class="op" id="6598821">,</span>&nbsp;<span class="op" id="6598823">&amp;</span><span class="ident" id="6598824">tt</span><span class="op" id="6598826">.</span><span class="ident" id="6598827">Resp</span><span class="op" id="6598831">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6598835">var</span>&nbsp;<span class="ident" id="6598839">bout</span>&nbsp;<span class="ident" id="6598844">bytes</span><span class="op" id="6598849">.</span><span class="ident" id="6598850">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6598859">if</span>&nbsp;<span class="ident" id="6598862">rbody</span>&nbsp;<span class="op" id="6598868">!=</span>&nbsp;<span class="ident" id="6598871">nil</span>&nbsp;<span class="op" id="6598875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6598880">_</span><span class="op" id="6598881">,</span>&nbsp;<span class="ident" id="6598883">err</span>&nbsp;<span class="op" id="6598887">=</span>&nbsp;<span class="ident" id="6598889">io</span><span class="op" id="6598891">.</span><span class="ident" id="6598892">Copy</span><span class="op" id="6598896">(</span><span class="op" id="6598897">&amp;</span><span class="ident" id="6598898">bout</span><span class="op" id="6598902">,</span>&nbsp;<span class="ident" id="6598904">rbody</span><span class="op" id="6598909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6598914">if</span>&nbsp;<span class="ident" id="6598917">err</span>&nbsp;<span class="op" id="6598921">!=</span>&nbsp;<span class="ident" id="6598924">nil</span>&nbsp;<span class="op" id="6598928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6598934">t</span><span class="op" id="6598935">.</span><span class="ident" id="6598936">Errorf</span><span class="op" id="6598942">(</span><span class="string" id="6598943">&#34;#%d:&nbsp;%v&#34;</span><span class="op" id="6598952">,</span>&nbsp;<span class="ident" id="6598954">i</span><span class="op" id="6598955">,</span>&nbsp;<span class="ident" id="6598957">err</span><span class="op" id="6598960">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6598966">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6598978">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6598983">rbody</span><span class="op" id="6598988">.</span><span class="ident" id="6598989">Close</span><span class="op" id="6598994">(</span><span class="op" id="6598995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6598999">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6599003">body</span>&nbsp;<span class="op" id="6599008">:=</span>&nbsp;<span class="ident" id="6599011">bout</span><span class="op" id="6599015">.</span><span class="ident" id="6599016">String</span><span class="op" id="6599022">(</span><span class="op" id="6599023">)</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6599027">if</span>&nbsp;<span class="ident" id="6599030">body</span>&nbsp;<span class="op" id="6599035">!=</span>&nbsp;<span class="ident" id="6599038">tt</span><span class="op" id="6599040">.</span><span class="ident" id="6599041">Body</span>&nbsp;<span class="op" id="6599046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6599051">t</span><span class="op" id="6599052">.</span><span class="ident" id="6599053">Errorf</span><span class="op" id="6599059">(</span><span class="string" id="6599060">&#34;#%d:&nbsp;Body&nbsp;=&nbsp;%q&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6599084">,</span>&nbsp;<span class="ident" id="6599086">i</span><span class="op" id="6599087">,</span>&nbsp;<span class="ident" id="6599089">body</span><span class="op" id="6599093">,</span>&nbsp;<span class="ident" id="6599095">tt</span><span class="op" id="6599097">.</span><span class="ident" id="6599098">Body</span><span class="op" id="6599102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6599106">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6599109">}</span><br>
<span class="lineno"></span><span class="op" id="6599111">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="keyword" id="6599114">func</span>&nbsp;<span class="ident" id="6599119">TestWriteResponse</span><span class="op" id="6599136">(</span><span class="ident" id="6599137">t</span>&nbsp;<span class="op" id="6599139">*</span><span class="ident" id="6599140">testing</span><span class="op" id="6599147">.</span><span class="ident" id="6599148">T</span><span class="op" id="6599149">)</span>&nbsp;<span class="op" id="6599151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6599154">for</span>&nbsp;<span class="ident" id="6599158">i</span><span class="op" id="6599159">,</span>&nbsp;<span class="ident" id="6599161">tt</span>&nbsp;<span class="op" id="6599164">:=</span>&nbsp;<span class="keyword" id="6599167">range</span>&nbsp;<span class="ident" id="6599173">respTests</span>&nbsp;<span class="op" id="6599183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6599187">resp</span><span class="op" id="6599191">,</span>&nbsp;<span class="ident" id="6599193">err</span>&nbsp;<span class="op" id="6599197">:=</span>&nbsp;<span class="ident" id="6599200">ReadResponse</span><span class="op" id="6599212">(</span><span class="ident" id="6599213">bufio</span><span class="op" id="6599218">.</span><span class="ident" id="6599219">NewReader</span><span class="op" id="6599228">(</span><span class="ident" id="6599229">strings</span><span class="op" id="6599236">.</span><span class="ident" id="6599237">NewReader</span><span class="op" id="6599246">(</span><span class="ident" id="6599247">tt</span><span class="op" id="6599249">.</span><span class="ident" id="6599250">Raw</span><span class="op" id="6599253">)</span><span class="op" id="6599254">)</span><span class="op" id="6599255">,</span>&nbsp;<span class="ident" id="6599257">tt</span><span class="op" id="6599259">.</span><span class="ident" id="6599260">Resp</span><span class="op" id="6599264">.</span><span class="ident" id="6599265">Request</span><span class="op" id="6599272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6599276">if</span>&nbsp;<span class="ident" id="6599279">err</span>&nbsp;<span class="op" id="6599283">!=</span>&nbsp;<span class="ident" id="6599286">nil</span>&nbsp;<span class="op" id="6599290">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6599295">t</span><span class="op" id="6599296">.</span><span class="ident" id="6599297">Errorf</span><span class="op" id="6599303">(</span><span class="string" id="6599304">&#34;#%d:&nbsp;%v&#34;</span><span class="op" id="6599313">,</span>&nbsp;<span class="ident" id="6599315">i</span><span class="op" id="6599316">,</span>&nbsp;<span class="ident" id="6599318">err</span><span class="op" id="6599321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6599326">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6599337">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6599341">err</span>&nbsp;<span class="op" id="6599345">=</span>&nbsp;<span class="ident" id="6599347">resp</span><span class="op" id="6599351">.</span><span class="ident" id="6599352">Write</span><span class="op" id="6599357">(</span><span class="ident" id="6599358">ioutil</span><span class="op" id="6599364">.</span><span class="ident" id="6599365">Discard</span><span class="op" id="6599372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6599376">if</span>&nbsp;<span class="ident" id="6599379">err</span>&nbsp;<span class="op" id="6599383">!=</span>&nbsp;<span class="ident" id="6599386">nil</span>&nbsp;<span class="op" id="6599390">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6599395">t</span><span class="op" id="6599396">.</span><span class="ident" id="6599397">Errorf</span><span class="op" id="6599403">(</span><span class="string" id="6599404">&#34;#%d:&nbsp;%v&#34;</span><span class="op" id="6599413">,</span>&nbsp;<span class="ident" id="6599415">i</span><span class="op" id="6599416">,</span>&nbsp;<span class="ident" id="6599418">err</span><span class="op" id="6599421">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6599426">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6599437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6599440">}</span><br>
<span class="lineno"></span><span class="op" id="6599442">}</span><br>
<span class="lineno">450</span><br>
<span class="lineno"></span><span class="keyword" id="6599445">var</span>&nbsp;<span class="ident" id="6599449">readResponseCloseInMiddleTests</span>&nbsp;<span class="op" id="6599480">=</span>&nbsp;<span class="op" id="6599482">[</span><span class="op" id="6599483">]</span><span class="keyword" id="6599484">struct</span>&nbsp;<span class="op" id="6599491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6599494">chunked</span><span class="op" id="6599501">,</span>&nbsp;<span class="ident" id="6599503">compressed</span>&nbsp;<span class="builtintype" id="6599514">bool</span><br>
<span class="lineno"></span><span class="op" id="6599519">}</span><span class="op" id="6599520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6599523">{</span><span class="builtintype" id="6599524">false</span><span class="op" id="6599529">,</span>&nbsp;<span class="builtintype" id="6599531">false</span><span class="op" id="6599536">}</span><span class="op" id="6599537">,</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6599540">{</span><span class="builtintype" id="6599541">true</span><span class="op" id="6599545">,</span>&nbsp;<span class="builtintype" id="6599547">false</span><span class="op" id="6599552">}</span><span class="op" id="6599553">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6599556">{</span><span class="builtintype" id="6599557">true</span><span class="op" id="6599561">,</span>&nbsp;<span class="builtintype" id="6599563">true</span><span class="op" id="6599567">}</span><span class="op" id="6599568">,</span><br>
<span class="lineno"></span><span class="op" id="6599570">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6599573">//&nbsp;TestReadResponseCloseInMiddle&nbsp;tests&nbsp;that&nbsp;closing&nbsp;a&nbsp;body&nbsp;after</span><br>
<span class="lineno">460</span><span class="comment" id="6599638">//&nbsp;reading&nbsp;only&nbsp;part&nbsp;of&nbsp;its&nbsp;contents&nbsp;advances&nbsp;the&nbsp;read&nbsp;to&nbsp;the&nbsp;end&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="6599707">//&nbsp;the&nbsp;request,&nbsp;right&nbsp;up&nbsp;until&nbsp;the&nbsp;next&nbsp;request.</span><br>
<span class="lineno"></span><span class="keyword" id="6599756">func</span>&nbsp;<span class="ident" id="6599761">TestReadResponseCloseInMiddle</span><span class="op" id="6599790">(</span><span class="ident" id="6599791">t</span>&nbsp;<span class="op" id="6599793">*</span><span class="ident" id="6599794">testing</span><span class="op" id="6599801">.</span><span class="ident" id="6599802">T</span><span class="op" id="6599803">)</span>&nbsp;<span class="op" id="6599805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6599808">for</span>&nbsp;<span class="ident" id="6599812">_</span><span class="op" id="6599813">,</span>&nbsp;<span class="ident" id="6599815">test</span>&nbsp;<span class="op" id="6599820">:=</span>&nbsp;<span class="keyword" id="6599823">range</span>&nbsp;<span class="ident" id="6599829">readResponseCloseInMiddleTests</span>&nbsp;<span class="op" id="6599860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6599864">fatalf</span>&nbsp;<span class="op" id="6599871">:=</span>&nbsp;<span class="keyword" id="6599874">func</span><span class="op" id="6599878">(</span><span class="ident" id="6599879">format</span>&nbsp;<span class="builtintype" id="6599886">string</span><span class="op" id="6599892">,</span>&nbsp;<span class="ident" id="6599894">args</span>&nbsp;<span class="op" id="6599899">...</span><span class="keyword" id="6599902">interface</span><span class="op" id="6599911">{</span><span class="op" id="6599912">}</span><span class="op" id="6599913">)</span>&nbsp;<span class="op" id="6599915">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6599920">args</span>&nbsp;<span class="op" id="6599925">=</span>&nbsp;<span class="builtinfunc" id="6599927">append</span><span class="op" id="6599933">(</span><span class="op" id="6599934">[</span><span class="op" id="6599935">]</span><span class="keyword" id="6599936">interface</span><span class="op" id="6599945">{</span><span class="op" id="6599946">}</span><span class="op" id="6599947">{</span><span class="ident" id="6599948">test</span><span class="op" id="6599952">.</span><span class="ident" id="6599953">chunked</span><span class="op" id="6599960">,</span>&nbsp;<span class="ident" id="6599962">test</span><span class="op" id="6599966">.</span><span class="ident" id="6599967">compressed</span><span class="op" id="6599977">}</span><span class="op" id="6599978">,</span>&nbsp;<span class="ident" id="6599980">args</span><span class="op" id="6599984">...</span><span class="op" id="6599987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6599992">t</span><span class="op" id="6599993">.</span><span class="ident" id="6599994">Fatalf</span><span class="op" id="6600000">(</span><span class="string" id="6600001">&#34;on&nbsp;test&nbsp;chunked=%v,&nbsp;compressed=%v:&nbsp;&#34;</span><span class="op" id="6600038">+</span><span class="ident" id="6600039">format</span><span class="op" id="6600045">,</span>&nbsp;<span class="ident" id="6600047">args</span><span class="op" id="6600051">...</span><span class="op" id="6600054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6600058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6600062">checkErr</span>&nbsp;<span class="op" id="6600071">:=</span>&nbsp;<span class="keyword" id="6600074">func</span><span class="op" id="6600078">(</span><span class="ident" id="6600079">err</span>&nbsp;<span class="builtintype" id="6600083">error</span><span class="op" id="6600088">,</span>&nbsp;<span class="ident" id="6600090">msg</span>&nbsp;<span class="builtintype" id="6600094">string</span><span class="op" id="6600100">)</span>&nbsp;<span class="op" id="6600102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6600107">if</span>&nbsp;<span class="ident" id="6600110">err</span>&nbsp;<span class="op" id="6600114">==</span>&nbsp;<span class="ident" id="6600117">nil</span>&nbsp;<span class="op" id="6600121">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6600127">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6600137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6600142">fatalf</span><span class="op" id="6600148">(</span><span class="ident" id="6600149">msg</span><span class="op" id="6600152">+</span><span class="string" id="6600153">&#34;:&nbsp;%v&#34;</span><span class="op" id="6600159">,</span>&nbsp;<span class="ident" id="6600161">err</span><span class="op" id="6600164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6600168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6600172">var</span>&nbsp;<span class="ident" id="6600176">buf</span>&nbsp;<span class="ident" id="6600180">bytes</span><span class="op" id="6600185">.</span><span class="ident" id="6600186">Buffer</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6600195">buf</span><span class="op" id="6600198">.</span><span class="ident" id="6600199">WriteString</span><span class="op" id="6600210">(</span><span class="string" id="6600211">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span><span class="op" id="6600232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6600236">if</span>&nbsp;<span class="ident" id="6600239">test</span><span class="op" id="6600243">.</span><span class="ident" id="6600244">chunked</span>&nbsp;<span class="op" id="6600252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6600257">buf</span><span class="op" id="6600260">.</span><span class="ident" id="6600261">WriteString</span><span class="op" id="6600272">(</span><span class="string" id="6600273">&#34;Transfer-Encoding:&nbsp;chunked\r\n&#34;</span><span class="op" id="6600305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6600309">}</span>&nbsp;<span class="keyword" id="6600311">else</span>&nbsp;<span class="op" id="6600316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6600321">buf</span><span class="op" id="6600324">.</span><span class="ident" id="6600325">WriteString</span><span class="op" id="6600336">(</span><span class="string" id="6600337">&#34;Content-Length:&nbsp;1000000\r\n&#34;</span><span class="op" id="6600366">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6600370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6600374">var</span>&nbsp;<span class="ident" id="6600378">wr</span>&nbsp;<span class="ident" id="6600381">io</span><span class="op" id="6600383">.</span><span class="ident" id="6600384">Writer</span>&nbsp;<span class="op" id="6600391">=</span>&nbsp;<span class="op" id="6600393">&amp;</span><span class="ident" id="6600394">buf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6600400">if</span>&nbsp;<span class="ident" id="6600403">test</span><span class="op" id="6600407">.</span><span class="ident" id="6600408">chunked</span>&nbsp;<span class="op" id="6600416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6600421">wr</span>&nbsp;<span class="op" id="6600424">=</span>&nbsp;<span class="ident" id="6600426">internal</span><span class="op" id="6600434">.</span><span class="ident" id="6600435">NewChunkedWriter</span><span class="op" id="6600451">(</span><span class="ident" id="6600452">wr</span><span class="op" id="6600454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6600458">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6600462">if</span>&nbsp;<span class="ident" id="6600465">test</span><span class="op" id="6600469">.</span><span class="ident" id="6600470">compressed</span>&nbsp;<span class="op" id="6600481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6600486">buf</span><span class="op" id="6600489">.</span><span class="ident" id="6600490">WriteString</span><span class="op" id="6600501">(</span><span class="string" id="6600502">&#34;Content-Encoding:&nbsp;gzip\r\n&#34;</span><span class="op" id="6600530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6600535">wr</span>&nbsp;<span class="op" id="6600538">=</span>&nbsp;<span class="ident" id="6600540">gzip</span><span class="op" id="6600544">.</span><span class="ident" id="6600545">NewWriter</span><span class="op" id="6600554">(</span><span class="ident" id="6600555">wr</span><span class="op" id="6600557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6600561">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6600565">buf</span><span class="op" id="6600568">.</span><span class="ident" id="6600569">WriteString</span><span class="op" id="6600580">(</span><span class="string" id="6600581">&#34;\r\n&#34;</span><span class="op" id="6600587">)</span><br>
<span class="lineno">490</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6600592">chunk</span>&nbsp;<span class="op" id="6600598">:=</span>&nbsp;<span class="ident" id="6600601">bytes</span><span class="op" id="6600606">.</span><span class="ident" id="6600607">Repeat</span><span class="op" id="6600613">(</span><span class="op" id="6600614">[</span><span class="op" id="6600615">]</span><span class="builtintype" id="6600616">byte</span><span class="op" id="6600620">{</span><span class="string" id="6600621">&#39;x&#39;</span><span class="op" id="6600624">}</span><span class="op" id="6600625">,</span>&nbsp;<span class="num" id="6600627">1000</span><span class="op" id="6600631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6600635">for</span>&nbsp;<span class="ident" id="6600639">i</span>&nbsp;<span class="op" id="6600641">:=</span>&nbsp;<span class="num" id="6600644">0</span><span class="op" id="6600645">;</span>&nbsp;<span class="ident" id="6600647">i</span>&nbsp;<span class="op" id="6600649">&lt;</span>&nbsp;<span class="num" id="6600651">1000</span><span class="op" id="6600655">;</span>&nbsp;<span class="ident" id="6600657">i</span><span class="op" id="6600658">++</span>&nbsp;<span class="op" id="6600661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6600666">if</span>&nbsp;<span class="ident" id="6600669">test</span><span class="op" id="6600673">.</span><span class="ident" id="6600674">compressed</span>&nbsp;<span class="op" id="6600685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6600691">//&nbsp;Otherwise&nbsp;this&nbsp;compresses&nbsp;too&nbsp;well.</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6600734">_</span><span class="op" id="6600735">,</span>&nbsp;<span class="ident" id="6600737">err</span>&nbsp;<span class="op" id="6600741">:=</span>&nbsp;<span class="ident" id="6600744">io</span><span class="op" id="6600746">.</span><span class="ident" id="6600747">ReadFull</span><span class="op" id="6600755">(</span><span class="ident" id="6600756">rand</span><span class="op" id="6600760">.</span><span class="ident" id="6600761">Reader</span><span class="op" id="6600767">,</span>&nbsp;<span class="ident" id="6600769">chunk</span><span class="op" id="6600774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6600780">checkErr</span><span class="op" id="6600788">(</span><span class="ident" id="6600789">err</span><span class="op" id="6600792">,</span>&nbsp;<span class="string" id="6600794">&#34;rand.Reader&nbsp;ReadFull&#34;</span><span class="op" id="6600816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6600821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6600826">wr</span><span class="op" id="6600828">.</span><span class="ident" id="6600829">Write</span><span class="op" id="6600834">(</span><span class="ident" id="6600835">chunk</span><span class="op" id="6600840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6600844">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6600848">if</span>&nbsp;<span class="ident" id="6600851">test</span><span class="op" id="6600855">.</span><span class="ident" id="6600856">compressed</span>&nbsp;<span class="op" id="6600867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6600872">err</span>&nbsp;<span class="op" id="6600876">:=</span>&nbsp;<span class="ident" id="6600879">wr</span><span class="op" id="6600881">.</span><span class="op" id="6600882">(</span><span class="op" id="6600883">*</span><span class="ident" id="6600884">gzip</span><span class="op" id="6600888">.</span><span class="ident" id="6600889">Writer</span><span class="op" id="6600895">)</span><span class="op" id="6600896">.</span><span class="ident" id="6600897">Close</span><span class="op" id="6600902">(</span><span class="op" id="6600903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6600908">checkErr</span><span class="op" id="6600916">(</span><span class="ident" id="6600917">err</span><span class="op" id="6600920">,</span>&nbsp;<span class="string" id="6600922">&#34;compressor&nbsp;close&#34;</span><span class="op" id="6600940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6600944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6600948">if</span>&nbsp;<span class="ident" id="6600951">test</span><span class="op" id="6600955">.</span><span class="ident" id="6600956">chunked</span>&nbsp;<span class="op" id="6600964">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6600969">buf</span><span class="op" id="6600972">.</span><span class="ident" id="6600973">WriteString</span><span class="op" id="6600984">(</span><span class="string" id="6600985">&#34;0\r\n\r\n&#34;</span><span class="op" id="6600996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6601000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6601004">buf</span><span class="op" id="6601007">.</span><span class="ident" id="6601008">WriteString</span><span class="op" id="6601019">(</span><span class="string" id="6601020">&#34;Next&nbsp;Request&nbsp;Here&#34;</span><span class="op" id="6601039">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6601044">bufr</span>&nbsp;<span class="op" id="6601049">:=</span>&nbsp;<span class="ident" id="6601052">bufio</span><span class="op" id="6601057">.</span><span class="ident" id="6601058">NewReader</span><span class="op" id="6601067">(</span><span class="op" id="6601068">&amp;</span><span class="ident" id="6601069">buf</span><span class="op" id="6601072">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6601076">resp</span><span class="op" id="6601080">,</span>&nbsp;<span class="ident" id="6601082">err</span>&nbsp;<span class="op" id="6601086">:=</span>&nbsp;<span class="ident" id="6601089">ReadResponse</span><span class="op" id="6601101">(</span><span class="ident" id="6601102">bufr</span><span class="op" id="6601106">,</span>&nbsp;<span class="ident" id="6601108">dummyReq</span><span class="op" id="6601116">(</span><span class="string" id="6601117">&#34;GET&#34;</span><span class="op" id="6601122">)</span><span class="op" id="6601123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6601127">checkErr</span><span class="op" id="6601135">(</span><span class="ident" id="6601136">err</span><span class="op" id="6601139">,</span>&nbsp;<span class="string" id="6601141">&#34;ReadResponse&#34;</span><span class="op" id="6601155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6601159">expectedLength</span>&nbsp;<span class="op" id="6601174">:=</span>&nbsp;<span class="ident" id="6601177">int64</span><span class="op" id="6601182">(</span><span class="op" id="6601183">-</span><span class="num" id="6601184">1</span><span class="op" id="6601185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6601189">if</span>&nbsp;<span class="op" id="6601192">!</span><span class="ident" id="6601193">test</span><span class="op" id="6601197">.</span><span class="ident" id="6601198">chunked</span>&nbsp;<span class="op" id="6601206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6601211">expectedLength</span>&nbsp;<span class="op" id="6601226">=</span>&nbsp;<span class="num" id="6601228">1000000</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6601238">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6601242">if</span>&nbsp;<span class="ident" id="6601245">resp</span><span class="op" id="6601249">.</span><span class="ident" id="6601250">ContentLength</span>&nbsp;<span class="op" id="6601264">!=</span>&nbsp;<span class="ident" id="6601267">expectedLength</span>&nbsp;<span class="op" id="6601282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6601287">fatalf</span><span class="op" id="6601293">(</span><span class="string" id="6601294">&#34;expected&nbsp;response&nbsp;length&nbsp;%d,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="6601331">,</span>&nbsp;<span class="ident" id="6601333">expectedLength</span><span class="op" id="6601347">,</span>&nbsp;<span class="ident" id="6601349">resp</span><span class="op" id="6601353">.</span><span class="ident" id="6601354">ContentLength</span><span class="op" id="6601367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6601371">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6601375">if</span>&nbsp;<span class="ident" id="6601378">resp</span><span class="op" id="6601382">.</span><span class="ident" id="6601383">Body</span>&nbsp;<span class="op" id="6601388">==</span>&nbsp;<span class="ident" id="6601391">nil</span>&nbsp;<span class="op" id="6601395">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6601400">fatalf</span><span class="op" id="6601406">(</span><span class="string" id="6601407">&#34;nil&nbsp;body&#34;</span><span class="op" id="6601417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6601421">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6601425">if</span>&nbsp;<span class="ident" id="6601428">test</span><span class="op" id="6601432">.</span><span class="ident" id="6601433">compressed</span>&nbsp;<span class="op" id="6601444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6601449">gzReader</span><span class="op" id="6601457">,</span>&nbsp;<span class="ident" id="6601459">err</span>&nbsp;<span class="op" id="6601463">:=</span>&nbsp;<span class="ident" id="6601466">gzip</span><span class="op" id="6601470">.</span><span class="ident" id="6601471">NewReader</span><span class="op" id="6601480">(</span><span class="ident" id="6601481">resp</span><span class="op" id="6601485">.</span><span class="ident" id="6601486">Body</span><span class="op" id="6601490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6601495">checkErr</span><span class="op" id="6601503">(</span><span class="ident" id="6601504">err</span><span class="op" id="6601507">,</span>&nbsp;<span class="string" id="6601509">&#34;gzip.NewReader&#34;</span><span class="op" id="6601525">)</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6601530">resp</span><span class="op" id="6601534">.</span><span class="ident" id="6601535">Body</span>&nbsp;<span class="op" id="6601540">=</span>&nbsp;<span class="op" id="6601542">&amp;</span><span class="ident" id="6601543">readerAndCloser</span><span class="op" id="6601558">{</span><span class="ident" id="6601559">gzReader</span><span class="op" id="6601567">,</span>&nbsp;<span class="ident" id="6601569">resp</span><span class="op" id="6601573">.</span><span class="ident" id="6601574">Body</span><span class="op" id="6601578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6601582">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6601587">rbuf</span>&nbsp;<span class="op" id="6601592">:=</span>&nbsp;<span class="builtinfunc" id="6601595">make</span><span class="op" id="6601599">(</span><span class="op" id="6601600">[</span><span class="op" id="6601601">]</span><span class="builtintype" id="6601602">byte</span><span class="op" id="6601606">,</span>&nbsp;<span class="num" id="6601608">2500</span><span class="op" id="6601612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6601616">n</span><span class="op" id="6601617">,</span>&nbsp;<span class="ident" id="6601619">err</span>&nbsp;<span class="op" id="6601623">:=</span>&nbsp;<span class="ident" id="6601626">io</span><span class="op" id="6601628">.</span><span class="ident" id="6601629">ReadFull</span><span class="op" id="6601637">(</span><span class="ident" id="6601638">resp</span><span class="op" id="6601642">.</span><span class="ident" id="6601643">Body</span><span class="op" id="6601647">,</span>&nbsp;<span class="ident" id="6601649">rbuf</span><span class="op" id="6601653">)</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6601657">checkErr</span><span class="op" id="6601665">(</span><span class="ident" id="6601666">err</span><span class="op" id="6601669">,</span>&nbsp;<span class="string" id="6601671">&#34;2500&nbsp;byte&nbsp;ReadFull&#34;</span><span class="op" id="6601691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6601695">if</span>&nbsp;<span class="ident" id="6601698">n</span>&nbsp;<span class="op" id="6601700">!=</span>&nbsp;<span class="num" id="6601703">2500</span>&nbsp;<span class="op" id="6601708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6601713">fatalf</span><span class="op" id="6601719">(</span><span class="string" id="6601720">&#34;ReadFull&nbsp;only&nbsp;read&nbsp;%d&nbsp;bytes&#34;</span><span class="op" id="6601749">,</span>&nbsp;<span class="ident" id="6601751">n</span><span class="op" id="6601752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6601756">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6601760">if</span>&nbsp;<span class="ident" id="6601763">test</span><span class="op" id="6601767">.</span><span class="ident" id="6601768">compressed</span>&nbsp;<span class="op" id="6601779">==</span>&nbsp;<span class="builtintype" id="6601782">false</span>&nbsp;<span class="op" id="6601788">&amp;&amp;</span>&nbsp;<span class="op" id="6601791">!</span><span class="ident" id="6601792">bytes</span><span class="op" id="6601797">.</span><span class="ident" id="6601798">Equal</span><span class="op" id="6601803">(</span><span class="ident" id="6601804">bytes</span><span class="op" id="6601809">.</span><span class="ident" id="6601810">Repeat</span><span class="op" id="6601816">(</span><span class="op" id="6601817">[</span><span class="op" id="6601818">]</span><span class="builtintype" id="6601819">byte</span><span class="op" id="6601823">{</span><span class="string" id="6601824">&#39;x&#39;</span><span class="op" id="6601827">}</span><span class="op" id="6601828">,</span>&nbsp;<span class="num" id="6601830">2500</span><span class="op" id="6601834">)</span><span class="op" id="6601835">,</span>&nbsp;<span class="ident" id="6601837">rbuf</span><span class="op" id="6601841">)</span>&nbsp;<span class="op" id="6601843">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6601848">fatalf</span><span class="op" id="6601854">(</span><span class="string" id="6601855">&#34;ReadFull&nbsp;didn&#39;t&nbsp;read&nbsp;2500&nbsp;&#39;x&#39;;&nbsp;got&nbsp;%q&#34;</span><span class="op" id="6601894">,</span>&nbsp;<span class="builtintype" id="6601896">string</span><span class="op" id="6601902">(</span><span class="ident" id="6601903">rbuf</span><span class="op" id="6601907">)</span><span class="op" id="6601908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6601912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6601916">resp</span><span class="op" id="6601920">.</span><span class="ident" id="6601921">Body</span><span class="op" id="6601925">.</span><span class="ident" id="6601926">Close</span><span class="op" id="6601931">(</span><span class="op" id="6601932">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6601937">rest</span><span class="op" id="6601941">,</span>&nbsp;<span class="ident" id="6601943">err</span>&nbsp;<span class="op" id="6601947">:=</span>&nbsp;<span class="ident" id="6601950">ioutil</span><span class="op" id="6601956">.</span><span class="ident" id="6601957">ReadAll</span><span class="op" id="6601964">(</span><span class="ident" id="6601965">bufr</span><span class="op" id="6601969">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6601973">checkErr</span><span class="op" id="6601981">(</span><span class="ident" id="6601982">err</span><span class="op" id="6601985">,</span>&nbsp;<span class="string" id="6601987">&#34;ReadAll&nbsp;on&nbsp;remainder&#34;</span><span class="op" id="6602009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6602013">if</span>&nbsp;<span class="ident" id="6602016">e</span><span class="op" id="6602017">,</span>&nbsp;<span class="ident" id="6602019">g</span>&nbsp;<span class="op" id="6602021">:=</span>&nbsp;<span class="string" id="6602024">&#34;Next&nbsp;Request&nbsp;Here&#34;</span><span class="op" id="6602043">,</span>&nbsp;<span class="builtintype" id="6602045">string</span><span class="op" id="6602051">(</span><span class="ident" id="6602052">rest</span><span class="op" id="6602056">)</span><span class="op" id="6602057">;</span>&nbsp;<span class="ident" id="6602059">e</span>&nbsp;<span class="op" id="6602061">!=</span>&nbsp;<span class="ident" id="6602064">g</span>&nbsp;<span class="op" id="6602066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6602071">g</span>&nbsp;<span class="op" id="6602073">=</span>&nbsp;<span class="ident" id="6602075">regexp</span><span class="op" id="6602081">.</span><span class="ident" id="6602082">MustCompile</span><span class="op" id="6602093">(</span><span class="string" id="6602094">`(xx+)`</span><span class="op" id="6602101">)</span><span class="op" id="6602102">.</span><span class="ident" id="6602103">ReplaceAllStringFunc</span><span class="op" id="6602123">(</span><span class="ident" id="6602124">g</span><span class="op" id="6602125">,</span>&nbsp;<span class="keyword" id="6602127">func</span><span class="op" id="6602131">(</span><span class="ident" id="6602132">match</span>&nbsp;<span class="builtintype" id="6602138">string</span><span class="op" id="6602144">)</span>&nbsp;<span class="builtintype" id="6602146">string</span>&nbsp;<span class="op" id="6602153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6602159">return</span>&nbsp;<span class="ident" id="6602166">fmt</span><span class="op" id="6602169">.</span><span class="ident" id="6602170">Sprintf</span><span class="op" id="6602177">(</span><span class="string" id="6602178">&#34;x(repeated&nbsp;x%d)&#34;</span><span class="op" id="6602195">,</span>&nbsp;<span class="builtinfunc" id="6602197">len</span><span class="op" id="6602200">(</span><span class="ident" id="6602201">match</span><span class="op" id="6602206">)</span><span class="op" id="6602207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6602212">}</span><span class="op" id="6602213">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6602218">fatalf</span><span class="op" id="6602224">(</span><span class="string" id="6602225">&#34;remainder&nbsp;=&nbsp;%q,&nbsp;expected&nbsp;%q&#34;</span><span class="op" id="6602254">,</span>&nbsp;<span class="ident" id="6602256">g</span><span class="op" id="6602257">,</span>&nbsp;<span class="ident" id="6602259">e</span><span class="op" id="6602260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6602264">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6602267">}</span><br>
<span class="lineno"></span><span class="op" id="6602269">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">550</span><span class="keyword" id="6602272">func</span>&nbsp;<span class="ident" id="6602277">diff</span><span class="op" id="6602281">(</span><span class="ident" id="6602282">t</span>&nbsp;<span class="op" id="6602284">*</span><span class="ident" id="6602285">testing</span><span class="op" id="6602292">.</span><span class="ident" id="6602293">T</span><span class="op" id="6602294">,</span>&nbsp;<span class="ident" id="6602296">prefix</span>&nbsp;<span class="builtintype" id="6602303">string</span><span class="op" id="6602309">,</span>&nbsp;<span class="ident" id="6602311">have</span><span class="op" id="6602315">,</span>&nbsp;<span class="ident" id="6602317">want</span>&nbsp;<span class="keyword" id="6602322">interface</span><span class="op" id="6602331">{</span><span class="op" id="6602332">}</span><span class="op" id="6602333">)</span>&nbsp;<span class="op" id="6602335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6602338">hv</span>&nbsp;<span class="op" id="6602341">:=</span>&nbsp;<span class="ident" id="6602344">reflect</span><span class="op" id="6602351">.</span><span class="ident" id="6602352">ValueOf</span><span class="op" id="6602359">(</span><span class="ident" id="6602360">have</span><span class="op" id="6602364">)</span><span class="op" id="6602365">.</span><span class="ident" id="6602366">Elem</span><span class="op" id="6602370">(</span><span class="op" id="6602371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6602374">wv</span>&nbsp;<span class="op" id="6602377">:=</span>&nbsp;<span class="ident" id="6602380">reflect</span><span class="op" id="6602387">.</span><span class="ident" id="6602388">ValueOf</span><span class="op" id="6602395">(</span><span class="ident" id="6602396">want</span><span class="op" id="6602400">)</span><span class="op" id="6602401">.</span><span class="ident" id="6602402">Elem</span><span class="op" id="6602406">(</span><span class="op" id="6602407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6602410">if</span>&nbsp;<span class="ident" id="6602413">hv</span><span class="op" id="6602415">.</span><span class="ident" id="6602416">Type</span><span class="op" id="6602420">(</span><span class="op" id="6602421">)</span>&nbsp;<span class="op" id="6602423">!=</span>&nbsp;<span class="ident" id="6602426">wv</span><span class="op" id="6602428">.</span><span class="ident" id="6602429">Type</span><span class="op" id="6602433">(</span><span class="op" id="6602434">)</span>&nbsp;<span class="op" id="6602436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6602440">t</span><span class="op" id="6602441">.</span><span class="ident" id="6602442">Errorf</span><span class="op" id="6602448">(</span><span class="string" id="6602449">&#34;%s:&nbsp;type&nbsp;mismatch&nbsp;%v&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6602479">,</span>&nbsp;<span class="ident" id="6602481">prefix</span><span class="op" id="6602487">,</span>&nbsp;<span class="ident" id="6602489">hv</span><span class="op" id="6602491">.</span><span class="ident" id="6602492">Type</span><span class="op" id="6602496">(</span><span class="op" id="6602497">)</span><span class="op" id="6602498">,</span>&nbsp;<span class="ident" id="6602500">wv</span><span class="op" id="6602502">.</span><span class="ident" id="6602503">Type</span><span class="op" id="6602507">(</span><span class="op" id="6602508">)</span><span class="op" id="6602509">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6602512">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6602515">for</span>&nbsp;<span class="ident" id="6602519">i</span>&nbsp;<span class="op" id="6602521">:=</span>&nbsp;<span class="num" id="6602524">0</span><span class="op" id="6602525">;</span>&nbsp;<span class="ident" id="6602527">i</span>&nbsp;<span class="op" id="6602529">&lt;</span>&nbsp;<span class="ident" id="6602531">hv</span><span class="op" id="6602533">.</span><span class="ident" id="6602534">NumField</span><span class="op" id="6602542">(</span><span class="op" id="6602543">)</span><span class="op" id="6602544">;</span>&nbsp;<span class="ident" id="6602546">i</span><span class="op" id="6602547">++</span>&nbsp;<span class="op" id="6602550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6602554">hf</span>&nbsp;<span class="op" id="6602557">:=</span>&nbsp;<span class="ident" id="6602560">hv</span><span class="op" id="6602562">.</span><span class="ident" id="6602563">Field</span><span class="op" id="6602568">(</span><span class="ident" id="6602569">i</span><span class="op" id="6602570">)</span><span class="op" id="6602571">.</span><span class="ident" id="6602572">Interface</span><span class="op" id="6602581">(</span><span class="op" id="6602582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6602586">wf</span>&nbsp;<span class="op" id="6602589">:=</span>&nbsp;<span class="ident" id="6602592">wv</span><span class="op" id="6602594">.</span><span class="ident" id="6602595">Field</span><span class="op" id="6602600">(</span><span class="ident" id="6602601">i</span><span class="op" id="6602602">)</span><span class="op" id="6602603">.</span><span class="ident" id="6602604">Interface</span><span class="op" id="6602613">(</span><span class="op" id="6602614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6602618">if</span>&nbsp;<span class="op" id="6602621">!</span><span class="ident" id="6602622">reflect</span><span class="op" id="6602629">.</span><span class="ident" id="6602630">DeepEqual</span><span class="op" id="6602639">(</span><span class="ident" id="6602640">hf</span><span class="op" id="6602642">,</span>&nbsp;<span class="ident" id="6602644">wf</span><span class="op" id="6602646">)</span>&nbsp;<span class="op" id="6602648">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6602653">t</span><span class="op" id="6602654">.</span><span class="ident" id="6602655">Errorf</span><span class="op" id="6602661">(</span><span class="string" id="6602662">&#34;%s:&nbsp;%s&nbsp;=&nbsp;%v&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6602683">,</span>&nbsp;<span class="ident" id="6602685">prefix</span><span class="op" id="6602691">,</span>&nbsp;<span class="ident" id="6602693">hv</span><span class="op" id="6602695">.</span><span class="ident" id="6602696">Type</span><span class="op" id="6602700">(</span><span class="op" id="6602701">)</span><span class="op" id="6602702">.</span><span class="ident" id="6602703">Field</span><span class="op" id="6602708">(</span><span class="ident" id="6602709">i</span><span class="op" id="6602710">)</span><span class="op" id="6602711">.</span><span class="ident" id="6602712">Name</span><span class="op" id="6602716">,</span>&nbsp;<span class="ident" id="6602718">hf</span><span class="op" id="6602720">,</span>&nbsp;<span class="ident" id="6602722">wf</span><span class="op" id="6602724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6602728">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6602731">}</span><br>
<span class="lineno"></span><span class="op" id="6602733">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">565</span><span class="keyword" id="6602736">type</span>&nbsp;<span class="ident" id="6602741">responseLocationTest</span>&nbsp;<span class="keyword" id="6602762">struct</span>&nbsp;<span class="op" id="6602769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6602772">location</span>&nbsp;<span class="builtintype" id="6602781">string</span>&nbsp;<span class="comment" id="6602788">//&nbsp;Response&#39;s&nbsp;Location&nbsp;header&nbsp;or&nbsp;&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6602825">requrl</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6602834">string</span>&nbsp;<span class="comment" id="6602841">//&nbsp;Response.Request.URL&nbsp;or&nbsp;&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6602872">want</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6602881">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6602889">wantErr</span>&nbsp;&nbsp;<span class="builtintype" id="6602898">error</span><br>
<span class="lineno">570</span><span class="op" id="6602904">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6602907">var</span>&nbsp;<span class="ident" id="6602911">responseLocationTests</span>&nbsp;<span class="op" id="6602933">=</span>&nbsp;<span class="op" id="6602935">[</span><span class="op" id="6602936">]</span><span class="ident" id="6602937">responseLocationTest</span><span class="op" id="6602957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6602960">{</span><span class="string" id="6602961">&#34;/foo&#34;</span><span class="op" id="6602967">,</span>&nbsp;<span class="string" id="6602969">&#34;http://bar.com/baz&#34;</span><span class="op" id="6602989">,</span>&nbsp;<span class="string" id="6602991">&#34;http://bar.com/foo&#34;</span><span class="op" id="6603011">,</span>&nbsp;<span class="ident" id="6603013">nil</span><span class="op" id="6603016">}</span><span class="op" id="6603017">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6603020">{</span><span class="string" id="6603021">&#34;http://foo.com/&#34;</span><span class="op" id="6603038">,</span>&nbsp;<span class="string" id="6603040">&#34;http://bar.com/baz&#34;</span><span class="op" id="6603060">,</span>&nbsp;<span class="string" id="6603062">&#34;http://foo.com/&#34;</span><span class="op" id="6603079">,</span>&nbsp;<span class="ident" id="6603081">nil</span><span class="op" id="6603084">}</span><span class="op" id="6603085">,</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6603088">{</span><span class="string" id="6603089">&#34;&#34;</span><span class="op" id="6603091">,</span>&nbsp;<span class="string" id="6603093">&#34;http://bar.com/baz&#34;</span><span class="op" id="6603113">,</span>&nbsp;<span class="string" id="6603115">&#34;&#34;</span><span class="op" id="6603117">,</span>&nbsp;<span class="ident" id="6603119">ErrNoLocation</span><span class="op" id="6603132">}</span><span class="op" id="6603133">,</span><br>
<span class="lineno"></span><span class="op" id="6603135">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6603138">func</span>&nbsp;<span class="ident" id="6603143">TestLocationResponse</span><span class="op" id="6603163">(</span><span class="ident" id="6603164">t</span>&nbsp;<span class="op" id="6603166">*</span><span class="ident" id="6603167">testing</span><span class="op" id="6603174">.</span><span class="ident" id="6603175">T</span><span class="op" id="6603176">)</span>&nbsp;<span class="op" id="6603178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6603181">for</span>&nbsp;<span class="ident" id="6603185">i</span><span class="op" id="6603186">,</span>&nbsp;<span class="ident" id="6603188">tt</span>&nbsp;<span class="op" id="6603191">:=</span>&nbsp;<span class="keyword" id="6603194">range</span>&nbsp;<span class="ident" id="6603200">responseLocationTests</span>&nbsp;<span class="op" id="6603222">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6603226">res</span>&nbsp;<span class="op" id="6603230">:=</span>&nbsp;<span class="builtinfunc" id="6603233">new</span><span class="op" id="6603236">(</span><span class="ident" id="6603237">Response</span><span class="op" id="6603245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6603249">res</span><span class="op" id="6603252">.</span><span class="ident" id="6603253">Header</span>&nbsp;<span class="op" id="6603260">=</span>&nbsp;<span class="builtinfunc" id="6603262">make</span><span class="op" id="6603266">(</span><span class="ident" id="6603267">Header</span><span class="op" id="6603273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6603277">res</span><span class="op" id="6603280">.</span><span class="ident" id="6603281">Header</span><span class="op" id="6603287">.</span><span class="ident" id="6603288">Set</span><span class="op" id="6603291">(</span><span class="string" id="6603292">&#34;Location&#34;</span><span class="op" id="6603302">,</span>&nbsp;<span class="ident" id="6603304">tt</span><span class="op" id="6603306">.</span><span class="ident" id="6603307">location</span><span class="op" id="6603315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6603319">if</span>&nbsp;<span class="ident" id="6603322">tt</span><span class="op" id="6603324">.</span><span class="ident" id="6603325">requrl</span>&nbsp;<span class="op" id="6603332">!=</span>&nbsp;<span class="string" id="6603335">&#34;&#34;</span>&nbsp;<span class="op" id="6603338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6603343">res</span><span class="op" id="6603346">.</span><span class="ident" id="6603347">Request</span>&nbsp;<span class="op" id="6603355">=</span>&nbsp;<span class="op" id="6603357">&amp;</span><span class="ident" id="6603358">Request</span><span class="op" id="6603365">{</span><span class="op" id="6603366">}</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6603371">var</span>&nbsp;<span class="ident" id="6603375">err</span>&nbsp;<span class="builtintype" id="6603379">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6603388">res</span><span class="op" id="6603391">.</span><span class="ident" id="6603392">Request</span><span class="op" id="6603399">.</span><span class="ident" id="6603400">URL</span><span class="op" id="6603403">,</span>&nbsp;<span class="ident" id="6603405">err</span>&nbsp;<span class="op" id="6603409">=</span>&nbsp;<span class="ident" id="6603411">url</span><span class="op" id="6603414">.</span><span class="ident" id="6603415">Parse</span><span class="op" id="6603420">(</span><span class="ident" id="6603421">tt</span><span class="op" id="6603423">.</span><span class="ident" id="6603424">requrl</span><span class="op" id="6603430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6603435">if</span>&nbsp;<span class="ident" id="6603438">err</span>&nbsp;<span class="op" id="6603442">!=</span>&nbsp;<span class="ident" id="6603445">nil</span>&nbsp;<span class="op" id="6603449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6603455">t</span><span class="op" id="6603456">.</span><span class="ident" id="6603457">Fatalf</span><span class="op" id="6603463">(</span><span class="string" id="6603464">&#34;bad&nbsp;test&nbsp;URL&nbsp;%q:&nbsp;%v&#34;</span><span class="op" id="6603485">,</span>&nbsp;<span class="ident" id="6603487">tt</span><span class="op" id="6603489">.</span><span class="ident" id="6603490">requrl</span><span class="op" id="6603496">,</span>&nbsp;<span class="ident" id="6603498">err</span><span class="op" id="6603501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6603506">}</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6603510">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6603515">got</span><span class="op" id="6603518">,</span>&nbsp;<span class="ident" id="6603520">err</span>&nbsp;<span class="op" id="6603524">:=</span>&nbsp;<span class="ident" id="6603527">res</span><span class="op" id="6603530">.</span><span class="ident" id="6603531">Location</span><span class="op" id="6603539">(</span><span class="op" id="6603540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6603544">if</span>&nbsp;<span class="ident" id="6603547">tt</span><span class="op" id="6603549">.</span><span class="ident" id="6603550">wantErr</span>&nbsp;<span class="op" id="6603558">!=</span>&nbsp;<span class="ident" id="6603561">nil</span>&nbsp;<span class="op" id="6603565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6603570">if</span>&nbsp;<span class="ident" id="6603573">err</span>&nbsp;<span class="op" id="6603577">==</span>&nbsp;<span class="ident" id="6603580">nil</span>&nbsp;<span class="op" id="6603584">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6603590">t</span><span class="op" id="6603591">.</span><span class="ident" id="6603592">Errorf</span><span class="op" id="6603598">(</span><span class="string" id="6603599">&#34;%d.&nbsp;err=nil;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6603621">,</span>&nbsp;<span class="ident" id="6603623">i</span><span class="op" id="6603624">,</span>&nbsp;<span class="ident" id="6603626">tt</span><span class="op" id="6603628">.</span><span class="ident" id="6603629">wantErr</span><span class="op" id="6603636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6603642">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6603654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6603659">if</span>&nbsp;<span class="ident" id="6603662">g</span><span class="op" id="6603663">,</span>&nbsp;<span class="ident" id="6603665">e</span>&nbsp;<span class="op" id="6603667">:=</span>&nbsp;<span class="ident" id="6603670">err</span><span class="op" id="6603673">.</span><span class="ident" id="6603674">Error</span><span class="op" id="6603679">(</span><span class="op" id="6603680">)</span><span class="op" id="6603681">,</span>&nbsp;<span class="ident" id="6603683">tt</span><span class="op" id="6603685">.</span><span class="ident" id="6603686">wantErr</span><span class="op" id="6603693">.</span><span class="ident" id="6603694">Error</span><span class="op" id="6603699">(</span><span class="op" id="6603700">)</span><span class="op" id="6603701">;</span>&nbsp;<span class="ident" id="6603703">g</span>&nbsp;<span class="op" id="6603705">!=</span>&nbsp;<span class="ident" id="6603708">e</span>&nbsp;<span class="op" id="6603710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6603716">t</span><span class="op" id="6603717">.</span><span class="ident" id="6603718">Errorf</span><span class="op" id="6603724">(</span><span class="string" id="6603725">&#34;%d.&nbsp;err=%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6603746">,</span>&nbsp;<span class="ident" id="6603748">i</span><span class="op" id="6603749">,</span>&nbsp;<span class="ident" id="6603751">g</span><span class="op" id="6603752">,</span>&nbsp;<span class="ident" id="6603754">e</span><span class="op" id="6603755">)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6603761">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6603773">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6603778">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6603789">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6603793">if</span>&nbsp;<span class="ident" id="6603796">err</span>&nbsp;<span class="op" id="6603800">!=</span>&nbsp;<span class="ident" id="6603803">nil</span>&nbsp;<span class="op" id="6603807">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6603812">t</span><span class="op" id="6603813">.</span><span class="ident" id="6603814">Errorf</span><span class="op" id="6603820">(</span><span class="string" id="6603821">&#34;%d.&nbsp;err=%q&#34;</span><span class="op" id="6603833">,</span>&nbsp;<span class="ident" id="6603835">i</span><span class="op" id="6603836">,</span>&nbsp;<span class="ident" id="6603838">err</span><span class="op" id="6603841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6603846">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6603857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6603861">if</span>&nbsp;<span class="ident" id="6603864">g</span><span class="op" id="6603865">,</span>&nbsp;<span class="ident" id="6603867">e</span>&nbsp;<span class="op" id="6603869">:=</span>&nbsp;<span class="ident" id="6603872">got</span><span class="op" id="6603875">.</span><span class="ident" id="6603876">String</span><span class="op" id="6603882">(</span><span class="op" id="6603883">)</span><span class="op" id="6603884">,</span>&nbsp;<span class="ident" id="6603886">tt</span><span class="op" id="6603888">.</span><span class="ident" id="6603889">want</span><span class="op" id="6603893">;</span>&nbsp;<span class="ident" id="6603895">g</span>&nbsp;<span class="op" id="6603897">!=</span>&nbsp;<span class="ident" id="6603900">e</span>&nbsp;<span class="op" id="6603902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6603907">t</span><span class="op" id="6603908">.</span><span class="ident" id="6603909">Errorf</span><span class="op" id="6603915">(</span><span class="string" id="6603916">&#34;%d.&nbsp;Location=%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6603942">,</span>&nbsp;<span class="ident" id="6603944">i</span><span class="op" id="6603945">,</span>&nbsp;<span class="ident" id="6603947">g</span><span class="op" id="6603948">,</span>&nbsp;<span class="ident" id="6603950">e</span><span class="op" id="6603951">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6603955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6603958">}</span><br>
<span class="lineno"></span><span class="op" id="6603960">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6603963">func</span>&nbsp;<span class="ident" id="6603968">TestResponseStatusStutter</span><span class="op" id="6603993">(</span><span class="ident" id="6603994">t</span>&nbsp;<span class="op" id="6603996">*</span><span class="ident" id="6603997">testing</span><span class="op" id="6604004">.</span><span class="ident" id="6604005">T</span><span class="op" id="6604006">)</span>&nbsp;<span class="op" id="6604008">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6604011">r</span>&nbsp;<span class="op" id="6604013">:=</span>&nbsp;<span class="op" id="6604016">&amp;</span><span class="ident" id="6604017">Response</span><span class="op" id="6604025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6604029">Status</span><span class="op" id="6604035">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6604041">&#34;123&nbsp;some&nbsp;status&#34;</span><span class="op" id="6604058">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6604062">StatusCode</span><span class="op" id="6604072">:</span>&nbsp;<span class="num" id="6604074">123</span><span class="op" id="6604077">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6604081">ProtoMajor</span><span class="op" id="6604091">:</span>&nbsp;<span class="num" id="6604093">1</span><span class="op" id="6604094">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6604098">ProtoMinor</span><span class="op" id="6604108">:</span>&nbsp;<span class="num" id="6604110">3</span><span class="op" id="6604111">,</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6604114">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6604117">var</span>&nbsp;<span class="ident" id="6604121">buf</span>&nbsp;<span class="ident" id="6604125">bytes</span><span class="op" id="6604130">.</span><span class="ident" id="6604131">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6604139">r</span><span class="op" id="6604140">.</span><span class="ident" id="6604141">Write</span><span class="op" id="6604146">(</span><span class="op" id="6604147">&amp;</span><span class="ident" id="6604148">buf</span><span class="op" id="6604151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6604154">if</span>&nbsp;<span class="ident" id="6604157">strings</span><span class="op" id="6604164">.</span><span class="ident" id="6604165">Contains</span><span class="op" id="6604173">(</span><span class="ident" id="6604174">buf</span><span class="op" id="6604177">.</span><span class="ident" id="6604178">String</span><span class="op" id="6604184">(</span><span class="op" id="6604185">)</span><span class="op" id="6604186">,</span>&nbsp;<span class="string" id="6604188">&#34;123&nbsp;123&#34;</span><span class="op" id="6604197">)</span>&nbsp;<span class="op" id="6604199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6604203">t</span><span class="op" id="6604204">.</span><span class="ident" id="6604205">Errorf</span><span class="op" id="6604211">(</span><span class="string" id="6604212">&#34;stutter&nbsp;in&nbsp;status:&nbsp;%s&#34;</span><span class="op" id="6604235">,</span>&nbsp;<span class="ident" id="6604237">buf</span><span class="op" id="6604240">.</span><span class="ident" id="6604241">String</span><span class="op" id="6604247">(</span><span class="op" id="6604248">)</span><span class="op" id="6604249">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6604252">}</span><br>
<span class="lineno"></span><span class="op" id="6604254">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6604257">func</span>&nbsp;<span class="ident" id="6604262">TestResponseContentLengthShortBody</span><span class="op" id="6604296">(</span><span class="ident" id="6604297">t</span>&nbsp;<span class="op" id="6604299">*</span><span class="ident" id="6604300">testing</span><span class="op" id="6604307">.</span><span class="ident" id="6604308">T</span><span class="op" id="6604309">)</span>&nbsp;<span class="op" id="6604311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6604314">const</span>&nbsp;<span class="ident" id="6604320">shortBody</span>&nbsp;<span class="op" id="6604330">=</span>&nbsp;<span class="string" id="6604332">&#34;Short&nbsp;body,&nbsp;not&nbsp;123&nbsp;bytes.&#34;</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6604362">br</span>&nbsp;<span class="op" id="6604365">:=</span>&nbsp;<span class="ident" id="6604368">bufio</span><span class="op" id="6604373">.</span><span class="ident" id="6604374">NewReader</span><span class="op" id="6604383">(</span><span class="ident" id="6604384">strings</span><span class="op" id="6604391">.</span><span class="ident" id="6604392">NewReader</span><span class="op" id="6604401">(</span><span class="string" id="6604402">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="6604424">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6604428">&#34;Content-Length:&nbsp;123\r\n&#34;</span>&nbsp;<span class="op" id="6604454">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6604458">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="6604465">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6604469">shortBody</span><span class="op" id="6604478">)</span><span class="op" id="6604479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6604482">res</span><span class="op" id="6604485">,</span>&nbsp;<span class="ident" id="6604487">err</span>&nbsp;<span class="op" id="6604491">:=</span>&nbsp;<span class="ident" id="6604494">ReadResponse</span><span class="op" id="6604506">(</span><span class="ident" id="6604507">br</span><span class="op" id="6604509">,</span>&nbsp;<span class="op" id="6604511">&amp;</span><span class="ident" id="6604512">Request</span><span class="op" id="6604519">{</span><span class="ident" id="6604520">Method</span><span class="op" id="6604526">:</span>&nbsp;<span class="string" id="6604528">&#34;GET&#34;</span><span class="op" id="6604533">}</span><span class="op" id="6604534">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6604537">if</span>&nbsp;<span class="ident" id="6604540">err</span>&nbsp;<span class="op" id="6604544">!=</span>&nbsp;<span class="ident" id="6604547">nil</span>&nbsp;<span class="op" id="6604551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6604555">t</span><span class="op" id="6604556">.</span><span class="ident" id="6604557">Fatal</span><span class="op" id="6604562">(</span><span class="ident" id="6604563">err</span><span class="op" id="6604566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6604569">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6604572">if</span>&nbsp;<span class="ident" id="6604575">res</span><span class="op" id="6604578">.</span><span class="ident" id="6604579">ContentLength</span>&nbsp;<span class="op" id="6604593">!=</span>&nbsp;<span class="num" id="6604596">123</span>&nbsp;<span class="op" id="6604600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6604604">t</span><span class="op" id="6604605">.</span><span class="ident" id="6604606">Fatalf</span><span class="op" id="6604612">(</span><span class="string" id="6604613">&#34;Content-Length&nbsp;=&nbsp;%d;&nbsp;want&nbsp;123&#34;</span><span class="op" id="6604644">,</span>&nbsp;<span class="ident" id="6604646">res</span><span class="op" id="6604649">.</span><span class="ident" id="6604650">ContentLength</span><span class="op" id="6604663">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6604666">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6604669">var</span>&nbsp;<span class="ident" id="6604673">buf</span>&nbsp;<span class="ident" id="6604677">bytes</span><span class="op" id="6604682">.</span><span class="ident" id="6604683">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6604691">n</span><span class="op" id="6604692">,</span>&nbsp;<span class="ident" id="6604694">err</span>&nbsp;<span class="op" id="6604698">:=</span>&nbsp;<span class="ident" id="6604701">io</span><span class="op" id="6604703">.</span><span class="ident" id="6604704">Copy</span><span class="op" id="6604708">(</span><span class="op" id="6604709">&amp;</span><span class="ident" id="6604710">buf</span><span class="op" id="6604713">,</span>&nbsp;<span class="ident" id="6604715">res</span><span class="op" id="6604718">.</span><span class="ident" id="6604719">Body</span><span class="op" id="6604723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6604726">if</span>&nbsp;<span class="ident" id="6604729">n</span>&nbsp;<span class="op" id="6604731">!=</span>&nbsp;<span class="ident" id="6604734">int64</span><span class="op" id="6604739">(</span><span class="builtinfunc" id="6604740">len</span><span class="op" id="6604743">(</span><span class="ident" id="6604744">shortBody</span><span class="op" id="6604753">)</span><span class="op" id="6604754">)</span>&nbsp;<span class="op" id="6604756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6604760">t</span><span class="op" id="6604761">.</span><span class="ident" id="6604762">Errorf</span><span class="op" id="6604768">(</span><span class="string" id="6604769">&#34;Copied&nbsp;%d&nbsp;bytes;&nbsp;want&nbsp;%d,&nbsp;len(%q)&#34;</span><span class="op" id="6604804">,</span>&nbsp;<span class="ident" id="6604806">n</span><span class="op" id="6604807">,</span>&nbsp;<span class="builtinfunc" id="6604809">len</span><span class="op" id="6604812">(</span><span class="ident" id="6604813">shortBody</span><span class="op" id="6604822">)</span><span class="op" id="6604823">,</span>&nbsp;<span class="ident" id="6604825">shortBody</span><span class="op" id="6604834">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6604837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6604840">if</span>&nbsp;<span class="ident" id="6604843">buf</span><span class="op" id="6604846">.</span><span class="ident" id="6604847">String</span><span class="op" id="6604853">(</span><span class="op" id="6604854">)</span>&nbsp;<span class="op" id="6604856">!=</span>&nbsp;<span class="ident" id="6604859">shortBody</span>&nbsp;<span class="op" id="6604869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6604873">t</span><span class="op" id="6604874">.</span><span class="ident" id="6604875">Errorf</span><span class="op" id="6604881">(</span><span class="string" id="6604882">&#34;Read&nbsp;body&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6604905">,</span>&nbsp;<span class="ident" id="6604907">buf</span><span class="op" id="6604910">.</span><span class="ident" id="6604911">String</span><span class="op" id="6604917">(</span><span class="op" id="6604918">)</span><span class="op" id="6604919">,</span>&nbsp;<span class="ident" id="6604921">shortBody</span><span class="op" id="6604930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6604933">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6604936">if</span>&nbsp;<span class="ident" id="6604939">err</span>&nbsp;<span class="op" id="6604943">!=</span>&nbsp;<span class="ident" id="6604946">io</span><span class="op" id="6604948">.</span><span class="ident" id="6604949">ErrUnexpectedEOF</span>&nbsp;<span class="op" id="6604966">{</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6604970">t</span><span class="op" id="6604971">.</span><span class="ident" id="6604972">Errorf</span><span class="op" id="6604978">(</span><span class="string" id="6604979">&#34;io.Copy&nbsp;error&nbsp;=&nbsp;%#v;&nbsp;want&nbsp;io.ErrUnexpectedEOF&#34;</span><span class="op" id="6605026">,</span>&nbsp;<span class="ident" id="6605028">err</span><span class="op" id="6605031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6605034">}</span><br>
<span class="lineno"></span><span class="op" id="6605036">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6605039">func</span>&nbsp;<span class="ident" id="6605044">TestReadResponseUnexpectedEOF</span><span class="op" id="6605073">(</span><span class="ident" id="6605074">t</span>&nbsp;<span class="op" id="6605076">*</span><span class="ident" id="6605077">testing</span><span class="op" id="6605084">.</span><span class="ident" id="6605085">T</span><span class="op" id="6605086">)</span>&nbsp;<span class="op" id="6605088">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6605091">br</span>&nbsp;<span class="op" id="6605094">:=</span>&nbsp;<span class="ident" id="6605097">bufio</span><span class="op" id="6605102">.</span><span class="ident" id="6605103">NewReader</span><span class="op" id="6605112">(</span><span class="ident" id="6605113">strings</span><span class="op" id="6605120">.</span><span class="ident" id="6605121">NewReader</span><span class="op" id="6605130">(</span><span class="string" id="6605131">&#34;HTTP/1.1&nbsp;301&nbsp;Moved&nbsp;Permanently\r\n&#34;</span>&nbsp;<span class="op" id="6605168">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6605172">&#34;Location:&nbsp;http://example.com&#34;</span><span class="op" id="6605202">)</span><span class="op" id="6605203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6605206">_</span><span class="op" id="6605207">,</span>&nbsp;<span class="ident" id="6605209">err</span>&nbsp;<span class="op" id="6605213">:=</span>&nbsp;<span class="ident" id="6605216">ReadResponse</span><span class="op" id="6605228">(</span><span class="ident" id="6605229">br</span><span class="op" id="6605231">,</span>&nbsp;<span class="ident" id="6605233">nil</span><span class="op" id="6605236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6605239">if</span>&nbsp;<span class="ident" id="6605242">err</span>&nbsp;<span class="op" id="6605246">!=</span>&nbsp;<span class="ident" id="6605249">io</span><span class="op" id="6605251">.</span><span class="ident" id="6605252">ErrUnexpectedEOF</span>&nbsp;<span class="op" id="6605269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6605273">t</span><span class="op" id="6605274">.</span><span class="ident" id="6605275">Errorf</span><span class="op" id="6605281">(</span><span class="string" id="6605282">&#34;ReadResponse&nbsp;=&nbsp;%v;&nbsp;want&nbsp;io.ErrUnexpectedEOF&#34;</span><span class="op" id="6605327">,</span>&nbsp;<span class="ident" id="6605329">err</span><span class="op" id="6605332">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6605335">}</span><br>
<span class="lineno"></span><span class="op" id="6605337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6605340">func</span>&nbsp;<span class="ident" id="6605345">TestNeedsSniff</span><span class="op" id="6605359">(</span><span class="ident" id="6605360">t</span>&nbsp;<span class="op" id="6605362">*</span><span class="ident" id="6605363">testing</span><span class="op" id="6605370">.</span><span class="ident" id="6605371">T</span><span class="op" id="6605372">)</span>&nbsp;<span class="op" id="6605374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6605377">//&nbsp;needsSniff&nbsp;returns&nbsp;true&nbsp;with&nbsp;an&nbsp;empty&nbsp;response.</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6605429">r</span>&nbsp;<span class="op" id="6605431">:=</span>&nbsp;<span class="op" id="6605434">&amp;</span><span class="ident" id="6605435">response</span><span class="op" id="6605443">{</span><span class="op" id="6605444">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6605447">if</span>&nbsp;<span class="ident" id="6605450">got</span><span class="op" id="6605453">,</span>&nbsp;<span class="ident" id="6605455">want</span>&nbsp;<span class="op" id="6605460">:=</span>&nbsp;<span class="ident" id="6605463">r</span><span class="op" id="6605464">.</span><span class="ident" id="6605465">needsSniff</span><span class="op" id="6605475">(</span><span class="op" id="6605476">)</span><span class="op" id="6605477">,</span>&nbsp;<span class="builtintype" id="6605479">true</span><span class="op" id="6605483">;</span>&nbsp;<span class="ident" id="6605485">got</span>&nbsp;<span class="op" id="6605489">!=</span>&nbsp;<span class="ident" id="6605492">want</span>&nbsp;<span class="op" id="6605497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6605501">t</span><span class="op" id="6605502">.</span><span class="ident" id="6605503">Errorf</span><span class="op" id="6605509">(</span><span class="string" id="6605510">&#34;needsSniff&nbsp;=&nbsp;%t;&nbsp;want&nbsp;%t&#34;</span><span class="op" id="6605536">,</span>&nbsp;<span class="ident" id="6605538">got</span><span class="op" id="6605541">,</span>&nbsp;<span class="ident" id="6605543">want</span><span class="op" id="6605547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6605550">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6605553">//&nbsp;needsSniff&nbsp;returns&nbsp;false&nbsp;when&nbsp;Content-Type&nbsp;=&nbsp;nil.</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6605607">r</span><span class="op" id="6605608">.</span><span class="ident" id="6605609">handlerHeader</span>&nbsp;<span class="op" id="6605623">=</span>&nbsp;<span class="ident" id="6605625">Header</span><span class="op" id="6605631">{</span><span class="string" id="6605632">&#34;Content-Type&#34;</span><span class="op" id="6605646">:</span>&nbsp;<span class="ident" id="6605648">nil</span><span class="op" id="6605651">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6605654">if</span>&nbsp;<span class="ident" id="6605657">got</span><span class="op" id="6605660">,</span>&nbsp;<span class="ident" id="6605662">want</span>&nbsp;<span class="op" id="6605667">:=</span>&nbsp;<span class="ident" id="6605670">r</span><span class="op" id="6605671">.</span><span class="ident" id="6605672">needsSniff</span><span class="op" id="6605682">(</span><span class="op" id="6605683">)</span><span class="op" id="6605684">,</span>&nbsp;<span class="builtintype" id="6605686">false</span><span class="op" id="6605691">;</span>&nbsp;<span class="ident" id="6605693">got</span>&nbsp;<span class="op" id="6605697">!=</span>&nbsp;<span class="ident" id="6605700">want</span>&nbsp;<span class="op" id="6605705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6605709">t</span><span class="op" id="6605710">.</span><span class="ident" id="6605711">Errorf</span><span class="op" id="6605717">(</span><span class="string" id="6605718">&#34;needsSniff&nbsp;empty&nbsp;Content-Type&nbsp;=&nbsp;%t;&nbsp;want&nbsp;%t&#34;</span><span class="op" id="6605763">,</span>&nbsp;<span class="ident" id="6605765">got</span><span class="op" id="6605768">,</span>&nbsp;<span class="ident" id="6605770">want</span><span class="op" id="6605774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6605777">}</span><br>
<span class="lineno"></span><span class="op" id="6605779">}</span>
</div>
</body>
</html>
