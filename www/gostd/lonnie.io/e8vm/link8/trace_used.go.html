<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="keyword" id="5135656">package</span>&nbsp;<span class="ident" id="5135664">link8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5135671">type</span>&nbsp;<span class="ident" id="5135676">tracer</span>&nbsp;<span class="keyword" id="5135683">struct</span>&nbsp;<span class="op" id="5135690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5135693">lnk</span>&nbsp;&nbsp;<span class="op" id="5135698">*</span><span class="ident" id="5135699">Linker</span><br>
<span class="lineno">5</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5135707">hits</span>&nbsp;<span class="op" id="5135712">[</span><span class="op" id="5135713">]</span><span class="op" id="5135714">[</span><span class="op" id="5135715">]</span><span class="builtintype" id="5135716">bool</span><br>
<span class="lineno"></span><span class="op" id="5135721">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5135724">func</span>&nbsp;<span class="ident" id="5135729">newTracer</span><span class="op" id="5135738">(</span><span class="ident" id="5135739">lnk</span>&nbsp;<span class="op" id="5135743">*</span><span class="ident" id="5135744">Linker</span><span class="op" id="5135750">)</span>&nbsp;<span class="op" id="5135752">*</span><span class="ident" id="5135753">tracer</span>&nbsp;<span class="op" id="5135760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5135763">npkg</span>&nbsp;<span class="op" id="5135768">:=</span>&nbsp;<span class="ident" id="5135771">lnk</span><span class="op" id="5135774">.</span><span class="ident" id="5135775">Npkg</span><span class="op" id="5135779">(</span><span class="op" id="5135780">)</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5135783">ret</span>&nbsp;<span class="op" id="5135787">:=</span>&nbsp;<span class="builtinfunc" id="5135790">new</span><span class="op" id="5135793">(</span><span class="ident" id="5135794">tracer</span><span class="op" id="5135800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5135803">ret</span><span class="op" id="5135806">.</span><span class="ident" id="5135807">lnk</span>&nbsp;<span class="op" id="5135811">=</span>&nbsp;<span class="ident" id="5135813">lnk</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5135818">ret</span><span class="op" id="5135821">.</span><span class="ident" id="5135822">hits</span>&nbsp;<span class="op" id="5135827">=</span>&nbsp;<span class="builtinfunc" id="5135829">make</span><span class="op" id="5135833">(</span><span class="op" id="5135834">[</span><span class="op" id="5135835">]</span><span class="op" id="5135836">[</span><span class="op" id="5135837">]</span><span class="builtintype" id="5135838">bool</span><span class="op" id="5135842">,</span>&nbsp;<span class="ident" id="5135844">npkg</span><span class="op" id="5135848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5135851">for</span>&nbsp;<span class="ident" id="5135855">i</span>&nbsp;<span class="op" id="5135857">:=</span>&nbsp;<span class="num" id="5135860">0</span><span class="op" id="5135861">;</span>&nbsp;<span class="ident" id="5135863">i</span>&nbsp;<span class="op" id="5135865">&lt;</span>&nbsp;<span class="ident" id="5135867">npkg</span><span class="op" id="5135871">;</span>&nbsp;<span class="ident" id="5135873">i</span><span class="op" id="5135874">++</span>&nbsp;<span class="op" id="5135877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5135881">p</span>&nbsp;<span class="op" id="5135883">:=</span>&nbsp;<span class="ident" id="5135886">lnk</span><span class="op" id="5135889">.</span><span class="ident" id="5135890">Pkg</span><span class="op" id="5135893">(</span><span class="ident" id="5135894">i</span><span class="op" id="5135895">)</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5135899">ret</span><span class="op" id="5135902">.</span><span class="ident" id="5135903">hits</span><span class="op" id="5135907">[</span><span class="ident" id="5135908">i</span><span class="op" id="5135909">]</span>&nbsp;<span class="op" id="5135911">=</span>&nbsp;<span class="builtinfunc" id="5135913">make</span><span class="op" id="5135917">(</span><span class="op" id="5135918">[</span><span class="op" id="5135919">]</span><span class="builtintype" id="5135920">bool</span><span class="op" id="5135924">,</span>&nbsp;<span class="builtinfunc" id="5135926">len</span><span class="op" id="5135929">(</span><span class="ident" id="5135930">p</span><span class="op" id="5135931">.</span><span class="ident" id="5135932">symbols</span><span class="op" id="5135939">)</span><span class="op" id="5135940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5135943">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5135947">return</span>&nbsp;<span class="ident" id="5135954">ret</span><br>
<span class="lineno"></span><span class="op" id="5135958">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="5135961">func</span>&nbsp;<span class="op" id="5135966">(</span><span class="ident" id="5135967">t</span>&nbsp;<span class="op" id="5135969">*</span><span class="ident" id="5135970">tracer</span><span class="op" id="5135976">)</span>&nbsp;<span class="ident" id="5135978">hit</span><span class="op" id="5135981">(</span><span class="ident" id="5135982">pkg</span>&nbsp;<span class="op" id="5135986">*</span><span class="ident" id="5135987">Package</span><span class="op" id="5135994">,</span>&nbsp;<span class="ident" id="5135996">sym</span>&nbsp;<span class="builtintype" id="5136000">uint32</span><span class="op" id="5136006">)</span>&nbsp;<span class="builtintype" id="5136008">bool</span>&nbsp;<span class="op" id="5136013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5136016">i</span>&nbsp;<span class="op" id="5136018">:=</span>&nbsp;<span class="ident" id="5136021">t</span><span class="op" id="5136022">.</span><span class="ident" id="5136023">lnk</span><span class="op" id="5136026">.</span><span class="ident" id="5136027">PkgIndex</span><span class="op" id="5136035">(</span><span class="ident" id="5136036">pkg</span><span class="op" id="5136039">.</span><span class="ident" id="5136040">path</span><span class="op" id="5136044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5136047">pt</span>&nbsp;<span class="op" id="5136050">:=</span>&nbsp;<span class="op" id="5136053">&amp;</span><span class="ident" id="5136054">t</span><span class="op" id="5136055">.</span><span class="ident" id="5136056">hits</span><span class="op" id="5136060">[</span><span class="ident" id="5136061">i</span><span class="op" id="5136062">]</span><span class="op" id="5136063">[</span><span class="ident" id="5136064">sym</span><span class="op" id="5136067">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5136070">ret</span>&nbsp;<span class="op" id="5136074">:=</span>&nbsp;<span class="op" id="5136077">*</span><span class="ident" id="5136078">pt</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5136082">*</span><span class="ident" id="5136083">pt</span>&nbsp;<span class="op" id="5136086">=</span>&nbsp;<span class="builtintype" id="5136088">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5136094">return</span>&nbsp;<span class="ident" id="5136101">ret</span><br>
<span class="lineno"></span><span class="op" id="5136105">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5136108">func</span>&nbsp;<span class="ident" id="5136113">traceUsed</span><span class="op" id="5136122">(</span><span class="ident" id="5136123">lnk</span>&nbsp;<span class="op" id="5136127">*</span><span class="ident" id="5136128">Linker</span><span class="op" id="5136134">,</span>&nbsp;<span class="ident" id="5136136">p</span>&nbsp;<span class="op" id="5136138">*</span><span class="ident" id="5136139">Package</span><span class="op" id="5136146">,</span>&nbsp;<span class="ident" id="5136148">index</span>&nbsp;<span class="builtintype" id="5136154">uint32</span><span class="op" id="5136160">)</span>&nbsp;<span class="op" id="5136162">[</span><span class="op" id="5136163">]</span><span class="ident" id="5136164">pkgSym</span>&nbsp;<span class="op" id="5136171">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5136174">t</span>&nbsp;<span class="op" id="5136176">:=</span>&nbsp;<span class="ident" id="5136179">newTracer</span><span class="op" id="5136188">(</span><span class="ident" id="5136189">lnk</span><span class="op" id="5136192">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5136196">cur</span>&nbsp;<span class="op" id="5136200">:=</span>&nbsp;<span class="op" id="5136203">[</span><span class="op" id="5136204">]</span><span class="ident" id="5136205">pkgSym</span><span class="op" id="5136211">{</span><span class="op" id="5136212">{</span><span class="ident" id="5136213">p</span><span class="op" id="5136214">,</span>&nbsp;<span class="ident" id="5136216">index</span><span class="op" id="5136221">}</span><span class="op" id="5136222">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5136225">var</span>&nbsp;<span class="ident" id="5136229">next</span>&nbsp;<span class="op" id="5136234">[</span><span class="op" id="5136235">]</span><span class="ident" id="5136236">pkgSym</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5136244">var</span>&nbsp;<span class="ident" id="5136248">ret</span>&nbsp;<span class="op" id="5136252">[</span><span class="op" id="5136253">]</span><span class="ident" id="5136254">pkgSym</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5136263">//&nbsp;BFS&nbsp;traverse&nbsp;all&nbsp;the&nbsp;symbols&nbsp;used&nbsp;by&nbsp;the&nbsp;symbol</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5136315">for</span>&nbsp;<span class="builtinfunc" id="5136319">len</span><span class="op" id="5136322">(</span><span class="ident" id="5136323">cur</span><span class="op" id="5136326">)</span>&nbsp;<span class="op" id="5136328">&gt;</span>&nbsp;<span class="num" id="5136330">0</span>&nbsp;<span class="op" id="5136332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5136336">for</span>&nbsp;<span class="ident" id="5136340">_</span><span class="op" id="5136341">,</span>&nbsp;<span class="ident" id="5136343">ps</span>&nbsp;<span class="op" id="5136346">:=</span>&nbsp;<span class="keyword" id="5136349">range</span>&nbsp;<span class="ident" id="5136355">cur</span>&nbsp;<span class="op" id="5136359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5136364">ret</span>&nbsp;<span class="op" id="5136368">=</span>&nbsp;<span class="builtinfunc" id="5136370">append</span><span class="op" id="5136376">(</span><span class="ident" id="5136377">ret</span><span class="op" id="5136380">,</span>&nbsp;<span class="ident" id="5136382">ps</span><span class="op" id="5136384">)</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5136390">typ</span>&nbsp;<span class="op" id="5136394">:=</span>&nbsp;<span class="ident" id="5136397">ps</span><span class="op" id="5136399">.</span><span class="ident" id="5136400">Type</span><span class="op" id="5136404">(</span><span class="op" id="5136405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5136410">if</span>&nbsp;<span class="ident" id="5136413">typ</span>&nbsp;<span class="op" id="5136417">==</span>&nbsp;<span class="ident" id="5136420">SymFunc</span>&nbsp;<span class="op" id="5136428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5136434">f</span>&nbsp;<span class="op" id="5136436">:=</span>&nbsp;<span class="ident" id="5136439">ps</span><span class="op" id="5136441">.</span><span class="ident" id="5136442">Func</span><span class="op" id="5136446">(</span><span class="op" id="5136447">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5136454">for</span>&nbsp;<span class="ident" id="5136458">_</span><span class="op" id="5136459">,</span>&nbsp;<span class="ident" id="5136461">link</span>&nbsp;<span class="op" id="5136466">:=</span>&nbsp;<span class="keyword" id="5136469">range</span>&nbsp;<span class="ident" id="5136475">f</span><span class="op" id="5136476">.</span><span class="ident" id="5136477">links</span>&nbsp;<span class="op" id="5136483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5136490">pkg</span>&nbsp;<span class="op" id="5136494">:=</span>&nbsp;<span class="ident" id="5136497">ps</span><span class="op" id="5136499">.</span><span class="ident" id="5136500">Import</span><span class="op" id="5136506">(</span><span class="ident" id="5136507">link</span><span class="op" id="5136511">.</span><span class="ident" id="5136512">pkg</span><span class="op" id="5136515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5136522">if</span>&nbsp;<span class="ident" id="5136525">t</span><span class="op" id="5136526">.</span><span class="ident" id="5136527">hit</span><span class="op" id="5136530">(</span><span class="ident" id="5136531">pkg</span><span class="op" id="5136534">,</span>&nbsp;<span class="ident" id="5136536">link</span><span class="op" id="5136540">.</span><span class="ident" id="5136541">sym</span><span class="op" id="5136544">)</span>&nbsp;<span class="op" id="5136546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5136554">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5136568">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5136576">item</span>&nbsp;<span class="op" id="5136581">:=</span>&nbsp;<span class="ident" id="5136584">pkgSym</span><span class="op" id="5136590">{</span><span class="ident" id="5136591">pkg</span><span class="op" id="5136594">,</span>&nbsp;<span class="ident" id="5136596">link</span><span class="op" id="5136600">.</span><span class="ident" id="5136601">sym</span><span class="op" id="5136604">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5136611">next</span>&nbsp;<span class="op" id="5136616">=</span>&nbsp;<span class="builtinfunc" id="5136618">append</span><span class="op" id="5136624">(</span><span class="ident" id="5136625">next</span><span class="op" id="5136629">,</span>&nbsp;<span class="ident" id="5136631">item</span><span class="op" id="5136635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5136641">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5136646">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5136650">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5136655">cur</span>&nbsp;<span class="op" id="5136659">=</span>&nbsp;<span class="ident" id="5136661">next</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5136668">next</span>&nbsp;<span class="op" id="5136673">=</span>&nbsp;<span class="ident" id="5136675">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5136680">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5136684">return</span>&nbsp;<span class="ident" id="5136691">ret</span><br>
<span class="lineno"></span><span class="op" id="5136695">}</span>
</div>
</body>
</html>
