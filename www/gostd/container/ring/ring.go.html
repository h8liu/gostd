<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>container/ring</h2>
<ul>
<li><a href="/gostd/container/ring/ring.go.html">ring.go</a></li>
<li><a href="/gostd/container/ring/ring_test.go.html">ring_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4964830">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4964885">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4964939">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4964990">//&nbsp;Package&nbsp;ring&nbsp;implements&nbsp;operations&nbsp;on&nbsp;circular&nbsp;lists.</span><br>
<span class="lineno"></span><span class="keyword" id="4965047">package</span>&nbsp;<span class="ident" id="4965055">ring</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4965061">//&nbsp;A&nbsp;Ring&nbsp;is&nbsp;an&nbsp;element&nbsp;of&nbsp;a&nbsp;circular&nbsp;list,&nbsp;or&nbsp;ring.</span><br>
<span class="lineno"></span><span class="comment" id="4965114">//&nbsp;Rings&nbsp;do&nbsp;not&nbsp;have&nbsp;a&nbsp;beginning&nbsp;or&nbsp;end;&nbsp;a&nbsp;pointer&nbsp;to&nbsp;any&nbsp;ring&nbsp;element</span><br>
<span class="lineno">10</span><span class="comment" id="4965185">//&nbsp;serves&nbsp;as&nbsp;reference&nbsp;to&nbsp;the&nbsp;entire&nbsp;ring.&nbsp;Empty&nbsp;rings&nbsp;are&nbsp;represented</span><br>
<span class="lineno"></span><span class="comment" id="4965256">//&nbsp;as&nbsp;nil&nbsp;Ring&nbsp;pointers.&nbsp;The&nbsp;zero&nbsp;value&nbsp;for&nbsp;a&nbsp;Ring&nbsp;is&nbsp;a&nbsp;one-element</span><br>
<span class="lineno"></span><span class="comment" id="4965324">//&nbsp;ring&nbsp;with&nbsp;a&nbsp;nil&nbsp;Value.</span><br>
<span class="lineno"></span><span class="comment" id="4965350">//</span><br>
<span class="lineno"></span><span class="keyword" id="4965353">type</span>&nbsp;<span class="ident" id="4965358">Ring</span>&nbsp;<span class="keyword" id="4965363">struct</span>&nbsp;<span class="op" id="4965370">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4965373">next</span><span class="op" id="4965377">,</span>&nbsp;<span class="ident" id="4965379">prev</span>&nbsp;<span class="op" id="4965384">*</span><span class="ident" id="4965385">Ring</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4965391">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4965402">interface</span><span class="op" id="4965411">{</span><span class="op" id="4965412">}</span>&nbsp;<span class="comment" id="4965414">//&nbsp;for&nbsp;use&nbsp;by&nbsp;client;&nbsp;untouched&nbsp;by&nbsp;this&nbsp;library</span><br>
<span class="lineno"></span><span class="op" id="4965462">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4965465">func</span>&nbsp;<span class="op" id="4965470">(</span><span class="ident" id="4965471">r</span>&nbsp;<span class="op" id="4965473">*</span><span class="ident" id="4965474">Ring</span><span class="op" id="4965478">)</span>&nbsp;<span class="ident" id="4965480">init</span><span class="op" id="4965484">(</span><span class="op" id="4965485">)</span>&nbsp;<span class="op" id="4965487">*</span><span class="ident" id="4965488">Ring</span>&nbsp;<span class="op" id="4965493">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4965496">r</span><span class="op" id="4965497">.</span><span class="ident" id="4965498">next</span>&nbsp;<span class="op" id="4965503">=</span>&nbsp;<span class="ident" id="4965505">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4965508">r</span><span class="op" id="4965509">.</span><span class="ident" id="4965510">prev</span>&nbsp;<span class="op" id="4965515">=</span>&nbsp;<span class="ident" id="4965517">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4965520">return</span>&nbsp;<span class="ident" id="4965527">r</span><br>
<span class="lineno"></span><span class="op" id="4965529">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="4965532">//&nbsp;Next&nbsp;returns&nbsp;the&nbsp;next&nbsp;ring&nbsp;element.&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno"></span><span class="keyword" id="4965592">func</span>&nbsp;<span class="op" id="4965597">(</span><span class="ident" id="4965598">r</span>&nbsp;<span class="op" id="4965600">*</span><span class="ident" id="4965601">Ring</span><span class="op" id="4965605">)</span>&nbsp;<span class="ident" id="4965607">Next</span><span class="op" id="4965611">(</span><span class="op" id="4965612">)</span>&nbsp;<span class="op" id="4965614">*</span><span class="ident" id="4965615">Ring</span>&nbsp;<span class="op" id="4965620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4965623">if</span>&nbsp;<span class="ident" id="4965626">r</span><span class="op" id="4965627">.</span><span class="ident" id="4965628">next</span>&nbsp;<span class="op" id="4965633">==</span>&nbsp;<span class="ident" id="4965636">nil</span>&nbsp;<span class="op" id="4965640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4965644">return</span>&nbsp;<span class="ident" id="4965651">r</span><span class="op" id="4965652">.</span><span class="ident" id="4965653">init</span><span class="op" id="4965657">(</span><span class="op" id="4965658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4965661">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4965664">return</span>&nbsp;<span class="ident" id="4965671">r</span><span class="op" id="4965672">.</span><span class="ident" id="4965673">next</span><br>
<span class="lineno"></span><span class="op" id="4965678">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4965681">//&nbsp;Prev&nbsp;returns&nbsp;the&nbsp;previous&nbsp;ring&nbsp;element.&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno"></span><span class="keyword" id="4965745">func</span>&nbsp;<span class="op" id="4965750">(</span><span class="ident" id="4965751">r</span>&nbsp;<span class="op" id="4965753">*</span><span class="ident" id="4965754">Ring</span><span class="op" id="4965758">)</span>&nbsp;<span class="ident" id="4965760">Prev</span><span class="op" id="4965764">(</span><span class="op" id="4965765">)</span>&nbsp;<span class="op" id="4965767">*</span><span class="ident" id="4965768">Ring</span>&nbsp;<span class="op" id="4965773">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4965776">if</span>&nbsp;<span class="ident" id="4965779">r</span><span class="op" id="4965780">.</span><span class="ident" id="4965781">next</span>&nbsp;<span class="op" id="4965786">==</span>&nbsp;<span class="ident" id="4965789">nil</span>&nbsp;<span class="op" id="4965793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4965797">return</span>&nbsp;<span class="ident" id="4965804">r</span><span class="op" id="4965805">.</span><span class="ident" id="4965806">init</span><span class="op" id="4965810">(</span><span class="op" id="4965811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4965814">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4965817">return</span>&nbsp;<span class="ident" id="4965824">r</span><span class="op" id="4965825">.</span><span class="ident" id="4965826">prev</span><br>
<span class="lineno"></span><span class="op" id="4965831">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="4965834">//&nbsp;Move&nbsp;moves&nbsp;n&nbsp;%&nbsp;r.Len()&nbsp;elements&nbsp;backward&nbsp;(n&nbsp;&lt;&nbsp;0)&nbsp;or&nbsp;forward&nbsp;(n&nbsp;&gt;=&nbsp;0)</span><br>
<span class="lineno"></span><span class="comment" id="4965906">//&nbsp;in&nbsp;the&nbsp;ring&nbsp;and&nbsp;returns&nbsp;that&nbsp;ring&nbsp;element.&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno"></span><span class="comment" id="4965973">//</span><br>
<span class="lineno"></span><span class="keyword" id="4965976">func</span>&nbsp;<span class="op" id="4965981">(</span><span class="ident" id="4965982">r</span>&nbsp;<span class="op" id="4965984">*</span><span class="ident" id="4965985">Ring</span><span class="op" id="4965989">)</span>&nbsp;<span class="ident" id="4965991">Move</span><span class="op" id="4965995">(</span><span class="ident" id="4965996">n</span>&nbsp;<span class="builtintype" id="4965998">int</span><span class="op" id="4966001">)</span>&nbsp;<span class="op" id="4966003">*</span><span class="ident" id="4966004">Ring</span>&nbsp;<span class="op" id="4966009">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4966012">if</span>&nbsp;<span class="ident" id="4966015">r</span><span class="op" id="4966016">.</span><span class="ident" id="4966017">next</span>&nbsp;<span class="op" id="4966022">==</span>&nbsp;<span class="ident" id="4966025">nil</span>&nbsp;<span class="op" id="4966029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4966033">return</span>&nbsp;<span class="ident" id="4966040">r</span><span class="op" id="4966041">.</span><span class="ident" id="4966042">init</span><span class="op" id="4966046">(</span><span class="op" id="4966047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4966050">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4966053">switch</span>&nbsp;<span class="op" id="4966060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4966063">case</span>&nbsp;<span class="ident" id="4966068">n</span>&nbsp;<span class="op" id="4966070">&lt;</span>&nbsp;<span class="num" id="4966072">0</span><span class="op" id="4966073">:</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4966077">for</span>&nbsp;<span class="op" id="4966081">;</span>&nbsp;<span class="ident" id="4966083">n</span>&nbsp;<span class="op" id="4966085">&lt;</span>&nbsp;<span class="num" id="4966087">0</span><span class="op" id="4966088">;</span>&nbsp;<span class="ident" id="4966090">n</span><span class="op" id="4966091">++</span>&nbsp;<span class="op" id="4966094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4966099">r</span>&nbsp;<span class="op" id="4966101">=</span>&nbsp;<span class="ident" id="4966103">r</span><span class="op" id="4966104">.</span><span class="ident" id="4966105">prev</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4966112">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4966115">case</span>&nbsp;<span class="ident" id="4966120">n</span>&nbsp;<span class="op" id="4966122">&gt;</span>&nbsp;<span class="num" id="4966124">0</span><span class="op" id="4966125">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4966129">for</span>&nbsp;<span class="op" id="4966133">;</span>&nbsp;<span class="ident" id="4966135">n</span>&nbsp;<span class="op" id="4966137">&gt;</span>&nbsp;<span class="num" id="4966139">0</span><span class="op" id="4966140">;</span>&nbsp;<span class="ident" id="4966142">n</span><span class="op" id="4966143">--</span>&nbsp;<span class="op" id="4966146">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4966151">r</span>&nbsp;<span class="op" id="4966153">=</span>&nbsp;<span class="ident" id="4966155">r</span><span class="op" id="4966156">.</span><span class="ident" id="4966157">next</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4966164">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4966167">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4966170">return</span>&nbsp;<span class="ident" id="4966177">r</span><br>
<span class="lineno"></span><span class="op" id="4966179">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="4966182">//&nbsp;New&nbsp;creates&nbsp;a&nbsp;ring&nbsp;of&nbsp;n&nbsp;elements.</span><br>
<span class="lineno"></span><span class="keyword" id="4966219">func</span>&nbsp;<span class="ident" id="4966224">New</span><span class="op" id="4966227">(</span><span class="ident" id="4966228">n</span>&nbsp;<span class="builtintype" id="4966230">int</span><span class="op" id="4966233">)</span>&nbsp;<span class="op" id="4966235">*</span><span class="ident" id="4966236">Ring</span>&nbsp;<span class="op" id="4966241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4966244">if</span>&nbsp;<span class="ident" id="4966247">n</span>&nbsp;<span class="op" id="4966249">&lt;=</span>&nbsp;<span class="num" id="4966252">0</span>&nbsp;<span class="op" id="4966254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4966258">return</span>&nbsp;<span class="ident" id="4966265">nil</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4966270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4966273">r</span>&nbsp;<span class="op" id="4966275">:=</span>&nbsp;<span class="builtinfunc" id="4966278">new</span><span class="op" id="4966281">(</span><span class="ident" id="4966282">Ring</span><span class="op" id="4966286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4966289">p</span>&nbsp;<span class="op" id="4966291">:=</span>&nbsp;<span class="ident" id="4966294">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4966297">for</span>&nbsp;<span class="ident" id="4966301">i</span>&nbsp;<span class="op" id="4966303">:=</span>&nbsp;<span class="num" id="4966306">1</span><span class="op" id="4966307">;</span>&nbsp;<span class="ident" id="4966309">i</span>&nbsp;<span class="op" id="4966311">&lt;</span>&nbsp;<span class="ident" id="4966313">n</span><span class="op" id="4966314">;</span>&nbsp;<span class="ident" id="4966316">i</span><span class="op" id="4966317">++</span>&nbsp;<span class="op" id="4966320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4966324">p</span><span class="op" id="4966325">.</span><span class="ident" id="4966326">next</span>&nbsp;<span class="op" id="4966331">=</span>&nbsp;<span class="op" id="4966333">&amp;</span><span class="ident" id="4966334">Ring</span><span class="op" id="4966338">{</span><span class="ident" id="4966339">prev</span><span class="op" id="4966343">:</span>&nbsp;<span class="ident" id="4966345">p</span><span class="op" id="4966346">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4966350">p</span>&nbsp;<span class="op" id="4966352">=</span>&nbsp;<span class="ident" id="4966354">p</span><span class="op" id="4966355">.</span><span class="ident" id="4966356">next</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4966362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4966365">p</span><span class="op" id="4966366">.</span><span class="ident" id="4966367">next</span>&nbsp;<span class="op" id="4966372">=</span>&nbsp;<span class="ident" id="4966374">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4966377">r</span><span class="op" id="4966378">.</span><span class="ident" id="4966379">prev</span>&nbsp;<span class="op" id="4966384">=</span>&nbsp;<span class="ident" id="4966386">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4966389">return</span>&nbsp;<span class="ident" id="4966396">r</span><br>
<span class="lineno">75</span><span class="op" id="4966398">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4966401">//&nbsp;Link&nbsp;connects&nbsp;ring&nbsp;r&nbsp;with&nbsp;ring&nbsp;s&nbsp;such&nbsp;that&nbsp;r.Next()</span><br>
<span class="lineno"></span><span class="comment" id="4966456">//&nbsp;becomes&nbsp;s&nbsp;and&nbsp;returns&nbsp;the&nbsp;original&nbsp;value&nbsp;for&nbsp;r.Next().</span><br>
<span class="lineno"></span><span class="comment" id="4966514">//&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno">80</span><span class="comment" id="4966538">//</span><br>
<span class="lineno"></span><span class="comment" id="4966541">//&nbsp;If&nbsp;r&nbsp;and&nbsp;s&nbsp;point&nbsp;to&nbsp;the&nbsp;same&nbsp;ring,&nbsp;linking</span><br>
<span class="lineno"></span><span class="comment" id="4966587">//&nbsp;them&nbsp;removes&nbsp;the&nbsp;elements&nbsp;between&nbsp;r&nbsp;and&nbsp;s&nbsp;from&nbsp;the&nbsp;ring.</span><br>
<span class="lineno"></span><span class="comment" id="4966647">//&nbsp;The&nbsp;removed&nbsp;elements&nbsp;form&nbsp;a&nbsp;subring&nbsp;and&nbsp;the&nbsp;result&nbsp;is&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4966706">//&nbsp;reference&nbsp;to&nbsp;that&nbsp;subring&nbsp;(if&nbsp;no&nbsp;elements&nbsp;were&nbsp;removed,</span><br>
<span class="lineno">85</span><span class="comment" id="4966765">//&nbsp;the&nbsp;result&nbsp;is&nbsp;still&nbsp;the&nbsp;original&nbsp;value&nbsp;for&nbsp;r.Next(),</span><br>
<span class="lineno"></span><span class="comment" id="4966821">//&nbsp;and&nbsp;not&nbsp;nil).</span><br>
<span class="lineno"></span><span class="comment" id="4966838">//</span><br>
<span class="lineno"></span><span class="comment" id="4966841">//&nbsp;If&nbsp;r&nbsp;and&nbsp;s&nbsp;point&nbsp;to&nbsp;different&nbsp;rings,&nbsp;linking</span><br>
<span class="lineno"></span><span class="comment" id="4966889">//&nbsp;them&nbsp;creates&nbsp;a&nbsp;single&nbsp;ring&nbsp;with&nbsp;the&nbsp;elements&nbsp;of&nbsp;s&nbsp;inserted</span><br>
<span class="lineno">90</span><span class="comment" id="4966951">//&nbsp;after&nbsp;r.&nbsp;The&nbsp;result&nbsp;points&nbsp;to&nbsp;the&nbsp;element&nbsp;following&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4967010">//&nbsp;last&nbsp;element&nbsp;of&nbsp;s&nbsp;after&nbsp;insertion.</span><br>
<span class="lineno"></span><span class="comment" id="4967048">//</span><br>
<span class="lineno"></span><span class="keyword" id="4967051">func</span>&nbsp;<span class="op" id="4967056">(</span><span class="ident" id="4967057">r</span>&nbsp;<span class="op" id="4967059">*</span><span class="ident" id="4967060">Ring</span><span class="op" id="4967064">)</span>&nbsp;<span class="ident" id="4967066">Link</span><span class="op" id="4967070">(</span><span class="ident" id="4967071">s</span>&nbsp;<span class="op" id="4967073">*</span><span class="ident" id="4967074">Ring</span><span class="op" id="4967078">)</span>&nbsp;<span class="op" id="4967080">*</span><span class="ident" id="4967081">Ring</span>&nbsp;<span class="op" id="4967086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4967089">n</span>&nbsp;<span class="op" id="4967091">:=</span>&nbsp;<span class="ident" id="4967094">r</span><span class="op" id="4967095">.</span><span class="ident" id="4967096">Next</span><span class="op" id="4967100">(</span><span class="op" id="4967101">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4967104">if</span>&nbsp;<span class="ident" id="4967107">s</span>&nbsp;<span class="op" id="4967109">!=</span>&nbsp;<span class="ident" id="4967112">nil</span>&nbsp;<span class="op" id="4967116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4967120">p</span>&nbsp;<span class="op" id="4967122">:=</span>&nbsp;<span class="ident" id="4967125">s</span><span class="op" id="4967126">.</span><span class="ident" id="4967127">Prev</span><span class="op" id="4967131">(</span><span class="op" id="4967132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4967136">//&nbsp;Note:&nbsp;Cannot&nbsp;use&nbsp;multiple&nbsp;assignment&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4967186">//&nbsp;evaluation&nbsp;order&nbsp;of&nbsp;LHS&nbsp;is&nbsp;not&nbsp;specified.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4967233">r</span><span class="op" id="4967234">.</span><span class="ident" id="4967235">next</span>&nbsp;<span class="op" id="4967240">=</span>&nbsp;<span class="ident" id="4967242">s</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4967246">s</span><span class="op" id="4967247">.</span><span class="ident" id="4967248">prev</span>&nbsp;<span class="op" id="4967253">=</span>&nbsp;<span class="ident" id="4967255">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4967259">n</span><span class="op" id="4967260">.</span><span class="ident" id="4967261">prev</span>&nbsp;<span class="op" id="4967266">=</span>&nbsp;<span class="ident" id="4967268">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4967272">p</span><span class="op" id="4967273">.</span><span class="ident" id="4967274">next</span>&nbsp;<span class="op" id="4967279">=</span>&nbsp;<span class="ident" id="4967281">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4967284">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4967287">return</span>&nbsp;<span class="ident" id="4967294">n</span><br>
<span class="lineno">105</span><span class="op" id="4967296">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4967299">//&nbsp;Unlink&nbsp;removes&nbsp;n&nbsp;%&nbsp;r.Len()&nbsp;elements&nbsp;from&nbsp;the&nbsp;ring&nbsp;r,&nbsp;starting</span><br>
<span class="lineno"></span><span class="comment" id="4967364">//&nbsp;at&nbsp;r.Next().&nbsp;If&nbsp;n&nbsp;%&nbsp;r.Len()&nbsp;==&nbsp;0,&nbsp;r&nbsp;remains&nbsp;unchanged.</span><br>
<span class="lineno"></span><span class="comment" id="4967422">//&nbsp;The&nbsp;result&nbsp;is&nbsp;the&nbsp;removed&nbsp;subring.&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno">110</span><span class="comment" id="4967481">//</span><br>
<span class="lineno"></span><span class="keyword" id="4967484">func</span>&nbsp;<span class="op" id="4967489">(</span><span class="ident" id="4967490">r</span>&nbsp;<span class="op" id="4967492">*</span><span class="ident" id="4967493">Ring</span><span class="op" id="4967497">)</span>&nbsp;<span class="ident" id="4967499">Unlink</span><span class="op" id="4967505">(</span><span class="ident" id="4967506">n</span>&nbsp;<span class="builtintype" id="4967508">int</span><span class="op" id="4967511">)</span>&nbsp;<span class="op" id="4967513">*</span><span class="ident" id="4967514">Ring</span>&nbsp;<span class="op" id="4967519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4967522">if</span>&nbsp;<span class="ident" id="4967525">n</span>&nbsp;<span class="op" id="4967527">&lt;=</span>&nbsp;<span class="num" id="4967530">0</span>&nbsp;<span class="op" id="4967532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4967536">return</span>&nbsp;<span class="ident" id="4967543">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4967548">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4967551">return</span>&nbsp;<span class="ident" id="4967558">r</span><span class="op" id="4967559">.</span><span class="ident" id="4967560">Link</span><span class="op" id="4967564">(</span><span class="ident" id="4967565">r</span><span class="op" id="4967566">.</span><span class="ident" id="4967567">Move</span><span class="op" id="4967571">(</span><span class="ident" id="4967572">n</span>&nbsp;<span class="op" id="4967574">+</span>&nbsp;<span class="num" id="4967576">1</span><span class="op" id="4967577">)</span><span class="op" id="4967578">)</span><br>
<span class="lineno"></span><span class="op" id="4967580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4967583">//&nbsp;Len&nbsp;computes&nbsp;the&nbsp;number&nbsp;of&nbsp;elements&nbsp;in&nbsp;ring&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="4967633">//&nbsp;It&nbsp;executes&nbsp;in&nbsp;time&nbsp;proportional&nbsp;to&nbsp;the&nbsp;number&nbsp;of&nbsp;elements.</span><br>
<span class="lineno">120</span><span class="comment" id="4967696">//</span><br>
<span class="lineno"></span><span class="keyword" id="4967699">func</span>&nbsp;<span class="op" id="4967704">(</span><span class="ident" id="4967705">r</span>&nbsp;<span class="op" id="4967707">*</span><span class="ident" id="4967708">Ring</span><span class="op" id="4967712">)</span>&nbsp;<span class="ident" id="4967714">Len</span><span class="op" id="4967717">(</span><span class="op" id="4967718">)</span>&nbsp;<span class="builtintype" id="4967720">int</span>&nbsp;<span class="op" id="4967724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4967727">n</span>&nbsp;<span class="op" id="4967729">:=</span>&nbsp;<span class="num" id="4967732">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4967735">if</span>&nbsp;<span class="ident" id="4967738">r</span>&nbsp;<span class="op" id="4967740">!=</span>&nbsp;<span class="ident" id="4967743">nil</span>&nbsp;<span class="op" id="4967747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4967751">n</span>&nbsp;<span class="op" id="4967753">=</span>&nbsp;<span class="num" id="4967755">1</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4967759">for</span>&nbsp;<span class="ident" id="4967763">p</span>&nbsp;<span class="op" id="4967765">:=</span>&nbsp;<span class="ident" id="4967768">r</span><span class="op" id="4967769">.</span><span class="ident" id="4967770">Next</span><span class="op" id="4967774">(</span><span class="op" id="4967775">)</span><span class="op" id="4967776">;</span>&nbsp;<span class="ident" id="4967778">p</span>&nbsp;<span class="op" id="4967780">!=</span>&nbsp;<span class="ident" id="4967783">r</span><span class="op" id="4967784">;</span>&nbsp;<span class="ident" id="4967786">p</span>&nbsp;<span class="op" id="4967788">=</span>&nbsp;<span class="ident" id="4967790">p</span><span class="op" id="4967791">.</span><span class="ident" id="4967792">next</span>&nbsp;<span class="op" id="4967797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4967802">n</span><span class="op" id="4967803">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4967808">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4967811">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4967814">return</span>&nbsp;<span class="ident" id="4967821">n</span><br>
<span class="lineno">130</span><span class="op" id="4967823">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4967826">//&nbsp;Do&nbsp;calls&nbsp;function&nbsp;f&nbsp;on&nbsp;each&nbsp;element&nbsp;of&nbsp;the&nbsp;ring,&nbsp;in&nbsp;forward&nbsp;order.</span><br>
<span class="lineno"></span><span class="comment" id="4967896">//&nbsp;The&nbsp;behavior&nbsp;of&nbsp;Do&nbsp;is&nbsp;undefined&nbsp;if&nbsp;f&nbsp;changes&nbsp;*r.</span><br>
<span class="lineno"></span><span class="keyword" id="4967948">func</span>&nbsp;<span class="op" id="4967953">(</span><span class="ident" id="4967954">r</span>&nbsp;<span class="op" id="4967956">*</span><span class="ident" id="4967957">Ring</span><span class="op" id="4967961">)</span>&nbsp;<span class="ident" id="4967963">Do</span><span class="op" id="4967965">(</span><span class="ident" id="4967966">f</span>&nbsp;<span class="keyword" id="4967968">func</span><span class="op" id="4967972">(</span><span class="keyword" id="4967973">interface</span><span class="op" id="4967982">{</span><span class="op" id="4967983">}</span><span class="op" id="4967984">)</span><span class="op" id="4967985">)</span>&nbsp;<span class="op" id="4967987">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4967990">if</span>&nbsp;<span class="ident" id="4967993">r</span>&nbsp;<span class="op" id="4967995">!=</span>&nbsp;<span class="ident" id="4967998">nil</span>&nbsp;<span class="op" id="4968002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4968006">f</span><span class="op" id="4968007">(</span><span class="ident" id="4968008">r</span><span class="op" id="4968009">.</span><span class="ident" id="4968010">Value</span><span class="op" id="4968015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4968019">for</span>&nbsp;<span class="ident" id="4968023">p</span>&nbsp;<span class="op" id="4968025">:=</span>&nbsp;<span class="ident" id="4968028">r</span><span class="op" id="4968029">.</span><span class="ident" id="4968030">Next</span><span class="op" id="4968034">(</span><span class="op" id="4968035">)</span><span class="op" id="4968036">;</span>&nbsp;<span class="ident" id="4968038">p</span>&nbsp;<span class="op" id="4968040">!=</span>&nbsp;<span class="ident" id="4968043">r</span><span class="op" id="4968044">;</span>&nbsp;<span class="ident" id="4968046">p</span>&nbsp;<span class="op" id="4968048">=</span>&nbsp;<span class="ident" id="4968050">p</span><span class="op" id="4968051">.</span><span class="ident" id="4968052">next</span>&nbsp;<span class="op" id="4968057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4968062">f</span><span class="op" id="4968063">(</span><span class="ident" id="4968064">p</span><span class="op" id="4968065">.</span><span class="ident" id="4968066">Value</span><span class="op" id="4968071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4968075">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4968078">}</span><br>
<span class="lineno"></span><span class="op" id="4968080">}</span>
</div>
</body>
</html>
